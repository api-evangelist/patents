---
title: Dynamic RDF groups
abstract: Described are techniques used in dynamically modifying RDF groups. A system call is issued by a host computer system to execute a remote system call on a first data storage system to create, remove, or modify an RDF group between the first data storage system and another data storage system that is remotely connected to the first data storage system in an RDF switched environment. As part of executing the remote system call, data is pushed from the first to the second data storage systems without having an established link between the data storage systems. Each data storage system performs processing to make the necessary modifications in all directors in accordance with the dynamic RDF group. A status indicating success or failure of the remote system call is returned to the host computer system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06910075&OS=06910075&RS=06910075
owner: EMC Corporation
number: 06910075
owner_city: Hopkinton
owner_country: US
publication_date: 20021002
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF EMBODIMENT(S)"],"p":["This application is a continuation-in-part of U.S. patent application Ser. No. 09\/997,810 filed on Nov. 30, 2001, now U.S. Pat. No. 6,862,632 entitled \u201cDYNAMIC RDF\u201d, which claims priority to U.S. Provisional Patent Application No. 60\/332,991 filed on Nov. 14, 2001, all of which are incorporated by reference herein.","1. Technical Field","This application generally relates to a computer system, and more particularly to techniques used computer system configuration.","2. Description of Related Art","Computer systems may include different resources used by one or more host processors. Resources and host processors in a computer system may be interconnected by one or more communication connections. These resources may include, for example, data storage devices such as the Symmetrix\u2122 family of data storage systems manufactured by EMC Corporation. These data storage systems may be coupled to one or more host processors and provide storage services to each host processor. An example data storage system may include one or more data storage devices, such as those of the Symmetrix\u2122 family, that are connected together and may be used to provide common data storage for one or more host processors in a computer system.","A host processor may perform a variety of data processing tasks and operations using the data storage system. For example, a host processor may perform basic system I\/O operations in connection with data requests, such as data read and write operations and also administrative tasks, such as data backup and mirroring operations.","Host processor systems may store and retrieve data using a storage device containing a plurality of host interface units, disk drives, and disk interface units. Such storage devices are provided, for example, by EMC Corporation of Hopkinton, Mass. and disclosed in U.S. Pat. No. 5,206,939 to Yanai et al., U.S. Pat. No. 5,778,394 to Galtzur et al., U.S. Pat. No. 5,845,147 to Vishlitzky et al., and U.S. Pat. No. 5,857,208 to Ofek. The host systems access the storage device through a plurality of channels provided therewith. Host systems provide data and access control information through the channels to the storage device and storage device provides data to the host systems also through the channels. The host systems do not address the disk drives of the storage device directly, but rather, access what appears to the host systems as a plurality of logical disk units. The logical disk units may or may nor correspond to the actual disk drives. Allowing multiple host systems to access the single storage device unit allows the host systems to share data stored therein.","In some instances, it may be desirable to copy data from one storage device to another. For example, if a host writes data to a first storage device, it may be desirable to copy that data to a second storage device provided in a different location so that if a disaster occurs that renders the first storage device inoperable, the host (or another host) may resume operation using the data of the second storage device. Such a capability is provided, for example, by the Remote Data Facility (RDF) product provided by EMC Corporation of Hopkinton, Mass. Data storage device communication between Symmetrix\u2122 data storage systems using RDF is described, for example, in U.S. Pat. Nos. 5,742,792 and 5,544,347, both of which are incorporated by reference herein. With RDF, a user may denote a first storage device as a master storage device and a second storage device as a slave storage device. Other incarnations of RDF may provide a peer to peer relationship between the local and remote storage devices. The host interacts directly with the local storage device, but any data changes made to the local storage device are automatically provided to a remote storage device using RDF. The local and remote storage devices may be connected by a data link, such as an ESCON link or a Fiber Channel link. The RDF functionality may be facilitated with an RDF adapter (RA) provided at each of the storage devices.","In some instances, it may be desirable to modify the RDF configuration system. However, in many cases, such modifications require skilled technicians using special software and non-standard connections to the local storage devices. It may be desirable to automate the RDF configuration modification process to allow a host to modify the RDF configuration. In addition, it may be desirable that allowing dynamic modifications to RDF configuration will not effect operation of the storage device when individual devices therein need to access the dynamic configuration information.","In accordance with one aspect of the invention is a method for dynamically modifying a communication path between a first group of devices in a first data storage system and a second group of devices in a second data storage system. A command request is issued to the first data storage system to dynamically modify the communication path. Setup data is pushed from the first data storage system to a second data storage system using a communication link that is not ready to transmit user data. A first part of a connection to the first group of devices is prepared. After successfully preparing the first part, preparing a second part of the connection to the second group of devices. After successfully preparing the first and second parts of the connection, indicating that the communication path is ready to transmit user data.","In accordance with another aspect of the invention is a computer program product for dynamically modifying a communication path between a first group of devices in a first data storage system and a second group of devices in a second data storage system including: machine executable instructions for issuing a command request to said first data storage system to dynamically modify said communication path; machine executable instructions for pushing setup data from said first data storage system to a second data storage system using a communication link that is not ready to transmit user data; machine executable instructions for preparing a first part of a connection to said first group of devices; machine executable instructions for, after successfully preparing said first part, preparing a second part of said connection to said second group of devices; and machine executable instructions for, after successfully preparing said first and second parts of said connection, indicating that said communication path is ready to transmit user data.","Referring now to , shown is an example of an embodiment of a computer system according to the present invention. The computer system  includes a data storage system  connected to host systems -, and a data manager system  through communication medium . In this embodiment of the computer system , the N hosts -and the data manager system  may access the data storage system , for example, in performing input\/output (I\/O) operations or data requests. The communication medium  may be any one of a variety of networks or other type of communication connections as known to those skilled in the art. The communication medium  may be a network connection, bus, and\/or other type of data link, such as a hardwire or other connections known in the art. For example, the communication medium  may be the Internet, an intranet, network or other connection(s) by which the host systems -, and the data manager system may access and communicate with the data storage system , and may also communicate with others included in the computer system .","Each of the host systems -, the data manager system , and the data storage system  included in the computer system  may be connected to the communication medium  by any one of a variety of connections as may be provided and supported in accordance with the type of communication medium . The processors included in the host computer systems -and the data manager system  may be any one of a variety of commercially available single or multi-processor system, such as an Intel-based processor, IBM mainframe or other type of commercially available processor able to support incoming traffic in accordance with each particular embodiment and application.","It should be noted that the particulars of the hardware and software included in each of the host systems -and the data manager system , as well as those components that may be included in the data storage system  are described herein in more detail, and may vary with each particular embodiment. Each of the host computers -, as well as the data manager system , may all be located at the same physical site, or, alternatively, may also be located in different physical locations. Examples of the communication medium that may be used to provide the different types of connections between the host computer systems, the data manager system, and the data storage system of the computer system  may use a variety of different communication protocols such as SCSI, ESCON, Fibre Channel, or GIGE (Gigabit Ethernet), and the like. Some or all of the connections by which the hosts, data manager system  and data storage system  may be connected to the communication medium  may pass through other communication devices, such as a Connectrix or other switching equipment that may exist such as a phone line, a repeater, a multiplexer or even a satellite.","Each of the host computer systems as well as the data manager system may perform different types of data operations in accordance with different types of administrative tasks. In the embodiment of , any one of the host computers -may issue a data request to the data storage system  to perform a data operation. For example, an application executing on one of the host computers -may perform a backup, mirroring or other administrative operation and may do so while performing data requests to the data storage system .","Referring now to , shown is an example of an embodiment of the data storage system  that may be included in the computer system  of FIG. . Included in the data storage system  of  are Symmetrix\u2122 storage systems -as manufactured by EMC Corporation of Hopkinton, Mass. In this particular example, each of the Symmetrix\u2122 storage systems -may be inter-connected (not shown) as well as to the host and data manager systems through any one or more communication connections  that may vary with each particular embodiment and device in accordance with the different protocols used in a particular embodiment. Additionally, the type of communication connection used may vary with certain system parameters and requirements, such as those related to bandwidth and throughput required in accordance with a rate of I\/O requests as may be issued by the host computer systems, for example, to the data storage system . In this example as described in more detail in following paragraphs, reference is made to the more detailed view of element . It should be noted that a similar more detailed description may also apply to any one or more of the other elements, such as , but have been omitted for simplicity of explanation. It should also be noted that an embodiment may include other types of data storage systems in combination with one or more Symmetrix\u2122 systems. Each of -may be resources included in an embodiment of the computer system  to provide storage services to, for example, host computer systems and\/or the data manager system.","Each of the Symmetrix\u2122 systems, such as , may include a plurality of disk devices or volumes, such as the arrangement  consisting of n rows of disks or volumes -. In this arrangement, each row of disks or volumes may be connected to a disk adapter (\u201cDA\u201d) or director responsible for the backend management of operations to and from a portion of the disks or volumes . In the Symmetrix\u2122 system , a single DA, such as , may be responsible for the management of a row of disks or volumes, such as row . Each of the DAs -are connected, for example, by a bus  to a cache that includes a particular portion designated as global memory . The DAs -may perform data operations to and from the cache that may be included in the global memory , for example, in communications with other disk processors or directors, and other components of the system . Generally, the global memory may be used in facilitating communications between components in the system . The other portion is that portion of memory that may be used in connection with other designations that may vary in accordance with each embodiment.","An embodiment of the Symmetrix\u2122 system may include a service processor used to manage and monitor the system . In one embodiment, the service processor may be used in collecting performance data, for example, regarding the I\/O performance in connection with system . This performance data may relate to, for example, performance measurements in connection with a data request as may be made from the different host computer systems -. This performance data may be gathered and stored, for example, in the global memory and\/or other storage area.","The system may also include one or more host adapters (\u201cHAs\u201d) or directors -. Each of these HAs may be used to manage communications and data operations between one or more host systems and the global memory.","The particular data storage system as described in this embodiment, such as a Symmetrix\u2122 system by EMC Corporation or a disk, should not be construed as a limitation. Other types of commercially available data storage systems, as well as processors and hardware controlling access to these particular devices, may be also be included in an embodiment.","Also shown in the storage system is an RA or remote adapter . The RA may be hardware including a processor used to facilitate communication between data storage systems, such as between two Symmetrix data storage systems. The RA may be used with the Remote Data Facility (RDF) product provided by EMC Corporation of Hopkinton, Mass.","Host systems provide data and access control information through channels to the storage systems, and the storage systems may also provide data to the host systems also through the channels. The host systems do not address the disk drives of the storage systems directly, but rather access to data may be provided to one or more host systems from what the host systems view as a plurality of logical devices or logical volumes (LVs). The LVs may or may not correspond to the actual disk drives. For example, one or more LVs may reside on a single physical disk drive. Data in a single storage system may be accessed by multiple hosts allowing the hosts to share the data residing therein. The HAs may be used in connection with communications between a Symmetrix data storage system and a host system. The RAs may be used in facilitating communications between two Symmetrix data storage systems. The DAs may be used in connection with facilitating communications to the associated disk drive(s) and LV(s) residing thereon.","The DA may cause I\/O operations to be performed on a volume or device. In the following description, data may be accessed by LV in which a single DA manages data requests in connection with I\/O operations of multiple LVs that may reside on a disk. The DA may accomplish this by creating job records for the different LVs associated with the particular DA. These different job records may be associated with the different LVs in a data structure stored and managed by each DA.","Referring now to , shown is an example of an embodiment of a computer system  illustrating the relationship between a host , a first data storage system and a second data storage system . It should be noted that the embodiment illustrated in  is a simplified view of components of a computer system, for example, including only some detail in data storage systems and for the sake of simplicity. The host  may issue a command to data storage system over connection using the HA . Communications between data storage systems and may be facilitated over connection using RA and RA included in, respectively, data storage systems and . The link may be an RDF link causing data from data storage system to be copied to the remote data storage system . Data from a device, such as , may be copied to the storage device in a remote data storage system using the RDF link causing the data on the remote storage device to be identical to the data on the local storage device ","Providing an RDF mapping between portions of devices included in data storage system and devices included in data storage system may be done by setting up LVs on the remote data storage system that mirror those included in the data storage system . The host  may read and write data using the logical device on data storage system . An RDF mapping may cause the modified data to be transferred from data storage system to a corresponding device identified via the RDF mapping on data storage system . In a steady state of operation, logical devices on the remote data storage system contain identical data to that which is included in the corresponding device via the RDF mapping and data storage system . The logical device on the data storage system accessed by the host may be referred to as the \u201cR\u201d volume while the corresponding logical device on a remote data storage system such as may be referred to as the \u201cR\u201d volume. In operation, the host  may read and write data using an R volume in , and RDF may handle the automatic copying and updating of data from the R volume to the R volume in ","R\/R pairs may be defined in a variety of different ways. R\/R pairs may be defined in accordance with static configuration data in which a configuration data file may exist, for example, in global memory. This may be referred to as static information in that the data file is read at initialization of the data storage system such as and remains in existence as an R\/R pair that can not be modified. Using a static configuration file, the only way to modify, including creating and destroying, R\/R pairs is to modify the static configuration file and initialize the data storage system again. Additionally, the configuration data file may need to be modified using special software and may also require the assistance of a technician familiar with the particular configuration data file.","In addition to static configuration data, a data storage system may include dynamic configuration data that may also be stored in a portion of global memory. In some embodiments, dynamic configuration data may override any information included in the static configuration data. In other embodiments, dynamic configuration data may only be additive such that, for example, it may only be used in instances in which there is no entry in the static configuration data file having a corresponding item. In addition to having a dynamic and a static configuration technique, an embodiment may also include the concept of an RDF group in which zero or more RDF devices on a data storage system are associated with a particular group under the control of a single RA which services the devices included therein. An embodiment may allow for the existence of an empty group including no devices. An RDF group may be defined statically, such as using a static configuration file, and also dynamically.","In some situations, it may be beneficial to allow the host  to create and destroy RDF volumes dynamically during operation of the system. Such techniques are described, for example, in U.S. patent application Ser. No. 09\/997,810, filed Nov. 30, 2001, entitled \u201cDYNAMIC RDF\u201d, which is incorporated herein by reference. Note that RDF volumes may be created and destroyed in pairs so that an R\/R pair may be destroyed or an R\/R pair may be created. Creating or destroying R\/R pairs may be initiated by the host . The host may send a multihop system command. The multihop system command is a single system command that is provided to multiple storage devices and indicates operations to be performed by the multiple storage devices. For example, the host  may send a multihop system command requesting that a particular R\/R pair be destroyed where the R volume is on data storage system and the R volume is on the remote data storage system by having each of the storage systems  and locally modify a table that is used internally by each of the storage devices to govern setting up and managing RDF volumes. Creating an R\/R pair involves creating the R volume on one storage device and creating the R volume on another storage device.","An embodiment may also include a switched RDF environment in which a single RA may service multiple RDF groups. In a switched RDF environment, RAs are connected and communicate using a switch. Communication points on the switch may be dynamically modified as well as the links therebetween. This is in contrast, for example, to a point-to-point type of connection which may be characterized as static having defined endpoints and a link that are not modifiable. A switched RDF environment may utilize, for example, fiber switch and GigE connections.","Techniques are described in following paragraphs for dynamically creating, destroying and otherwise modifying RDF groups in a switched RDF environment in which RDF links may be dynamically added or removed using remote system calls. The following description also provides for the creation of an empty RDF group in which a group may have a name associated with it but not have any associated data storage devices. In connection with the following description for creating, destroying and otherwise modifying RDF groups, a pair of RDF groups is defined in which a first RDF group on a local data storage system has a corresponding RDF group on a remote data storage system. This is analogous to the R\/R pair except that each of the R and R refers to an RDF group.","Additionally, the techniques described herein do not require that a link be initialized and allocated between any two RDF groups. Rather, the techniques described herein require only that a physical link exist between the RDF groups.","The embodiment described in the following paragraph includes certain requirements or restrictions. The particular requirements and\/or restrictions included in an embodiment may vary in accordance with the details of each particular embodiment. When using the system call, RDF groups are added or removed in pairs to both a local and a remote data storage system. Each system call is allowed to create or remove only one group in each data storage system. Only one instance of the system call to modify a dynamic RDF group is allowed to execute at any given time. As described above, the creation or removal of an RDF group pair does not assume that there is already a link established between the data storage systems of interest. The dynamic group information is stored in non-volatile memory in the event, for example, of a power failure. The system call for a dynamic RDF group is allowed to add or remove only a dynamic RDF group. Accordingly, for example, this command may not be allowed to change any proper use of groups included in the static configuration file. The dynamic RDF group system command affects the contents of the dynamic configuration file as described elsewhere herein. This command may not be used to update values included in the static configuration data file. An RDF group which is not empty may not be removed by using the dynamic RDF group system command.","A dynamic group lock may be used as a mechanism for insuring that only one single instance of this dynamic RDF group command executes at a single time. In this embodiment, the dynamic group lock may be characterized as a bit flag serving as a signal as to when one instance of the dynamic RDF group command is executing. This bit flag may be stored in global memory on each data storage system. This technique does not place a software or hardware lock guaranteeing exclusivity. Rather, this flag serves as a signaling technique which is observed by all processes. Other embodiments may use other techniques.","As described herein, a nonexistent group may use a global system queue or GST within the data storage system for communication with one or more other RDF groups. Existing dynamic groups may have static queues already defined in connection with initializing the system. Accordingly, in connection with communicating with RAs while managing RDF groups for the dynamic RDF group system command that will be described herein, the GST queue may be used as a means for communications between RAs within the same data storage system.","An embodiment may provide for the dynamic RDF group command using only a single call for adding and removing a dynamic group rather than define multiple calls. A modification to a dynamic system group includes adding or removing support for a group by some or all of the relevant directors or RAs. In connection with removing a dynamic RDF group, this particular embodiment causes a failure if the last director is removed and the group is not empty. When a group is removed, the associated link is also removed. In case this is the last link for the group, the group information is also be removed.","A special task may be used to transfer group information for creating and removing a group on a remote data storage system without having a link between a local and a remote data storage system. The two data storage systems have a physical link between them, for example, such as being connected through a switch. The general technique employed by the special task is to start a link discovery process for an unused link and terminate the link discovery process prior to completing initialization immediately after the remote data storage system receives the dynamic group information, and accordingly returns a status to the local data storage system. This link is once again made uninitialized. An unused link may refer to an existing physical connection which is currently not allocated or in use as a communication between two RAs or other types of user applications. The process of link initialization is started on a local data storage system and information regarding the dynamic group data as communicated by a remote system call is pushed to a remote data storage system. Once the information has been pushed to the remote data storage system and the local data storage system receives a status regarding this information as being received by the remote data storage system, the local data storage system indicates the link as uninitialized. This special task and its processing are described in more detail below.","Each director, RAs, DAs and HAs, all include information that may be stored locally related to an RDF group. Some of the variables relating to an RDF group may only be initialized in the static configuration file. It may be necessary to update group information as maintained by HAs, DAs and the like in addition to those RAs directly involved in the creation of the RDF group. If there is a change dynamically to the RDF group information, all directors including directors not directly involved in the addition or removal of a group may be accordingly notified.","In connection with ensuring that non-RDF directors such as HAs and DAs receive the updated information in connection with a dynamic RDF group change, several different mechanisms may be used in an embodiment. First as described in following paragraphs, the dynamic RDF group RA responsible for the change may send a GST queue request to inform other directors about the change in connection with RDF groups. However, as described below, the RA responsible does not verify that each of the directors actually performs this update in reading the new information from global memory. Added for execution on each director may be a low priority task instructing each of the directors to download from global memory the latest copy of the RDF group dynamic group table or DRGT and to build the required group masks in any data maintained locally on each director. It should be noted that if a low priority task finds out that a dynamic RDF group system call command is currently executing within a data storage system, such as by examining the global memory lock, the low priority task may wait until the lock is released prior to continuing execution.","What will now be described are some data structures used in processing steps described in more detail in following paragraphs to perform the dynamic RDF group modification command.","Referring now to , shown is an example of an embodiment of a Dynamic RDF Group Table (DRGT). Each director has a DRGT identifying information particular to the data storage system in which the director resides. The DRGT includes an entry for each possible RDF group. In one embodiment, the maximum number of possible RDF groups managed by a single director is sixty-four (64). Accordingly, the table in this embodiment includes sixty-four entries. The maximum number of RDF groups that may be managed in any particular embodiment may vary and is not limited to the particular number of sixty-four as described herein. Also described are other specific numbers and values used in the examples described herein. These specific values should not be construed as limitations upon the concepts, techniques and principles described herein but rather are factors that may vary in accordance with each embodiment.","Each director's local copy of the DRGT is stored in a portion of non-volatile memory. As described herein, a director may be, for example, an RA, DA or HA as described elsewhere herein. A copy of the DRGT table is also stored in global memory such as described elsewhere herein in connection with FIG. . It should be noted that the copy of the DRGT stored in global memory is considered to be the most up to date and correct copy of the DRGT table. In this embodiment, the copy of the DRGT table stored in each director's non-volatile memory portion is a complete copy of the table from global memory.","Referring now to , shown is a more detailed example of an embodiment of an entry of the DRGT table . In this particular embodiment, each entry in the DRGT of a data storage system includes information from the static configuration file, a bitmap of the directors in the data storage system that support the group corresponding to the entry, implementation specific information, and validity flags. In more detail, an entry  in this example includes group configuration information , a list of directors in this data storage system that support the current group , other supported directors , anchor director at the remote site , a valid flag , and any additional fields in this particular entry . The particular group configuration information included in the field  of the record entry  will be described in more detail in following paragraphs. It should be noted that the copy of the information included in the group configuration information entry  is the same as the group configuration information that may also be included in a static configuration file for other types of configuration information describing the group stored elsewhere in the system. In one embodiment, a copy of the static configuration file data may be stored in global memory on each data storage system. Each director within a data storage system may locally store a copy of all or portions of this static configuration data. The field  lists those directors in this data storage system that support the group currently being described by this record entry . The data storage system may be for example a symmetric data storage system that may include a plurality of directors such as RAs HAs and the like. The field  lists those directors in this particular data storage system that support the current group. The field  may be an encoded bitmap or other type of representation to identify the directors.","Fields  and  are used in connection with a particular embodiment using a GigE connection. Particular use of these fields is described elsewhere herein in more detail. The other supported directors field  includes a list such as a bitmap similar to field  identifying directors at a remote site. Field  is a particular director that may be referred to as the anchor director at the remote site with whom communications may be directed in connection with establishing a dynamic RDF group. In this particular embodiment, field  is used only for the GigE implementation. Similarly, other embodiments may require the use of other implementation specific fields than as described herein.","Field  includes a valid flag which may be implemented as a bit flag that contains a 1 indicating that the information included in the record or entry  is valid, and is 0 otherwise. Other fields  may also be included in each entry of the DRGT. These other fields may include, for example, additional information that may vary in accordance with each particular embodiment as well as padding characters that may be used in connection with performing any alignment requirements for a particular embodiment.","It should be noted that entries in local copies of the DRGT may be updated by directors in connection with processing steps described below.","Referring now to , shown is an example of more detailed information of the group configuration information described previously in connection with FIG. . In this particular embodiment, the group configuration information includes configuration flags , group label data , group number information , device link specific information  and any other information . The configuration flags  as well as the group label  and the group number  may function as common fields used in connection with different types of communication links. As described elsewhere herein, communication links are connections that may include, for example, fiber switch or GigE connections. The configuration flags  may include information for configuring the particular group. The group label and group number in, respectively, fields  and  include identifying information about an RDF group. In this particular example, an RDF group as noted by the group number in field  may have a 0 for example corresponding to a group A, a 1 corresponding to a group B and the like where each particular RDF group refers to the group of devices serviced by this particular RA director. The group label in this particular example may refer to a character string of up to ten characters. The group label is the same in both data storage systems involved in a connection. The group label may also be characterized as a nickname for the serial numbers and group numbers of the data storage systems in the connection.","Referring now to , shown is an example of embodiment  of two data storage systems and . Two RDF groups are defined in this example. The first group is defined as LABEL between RDF groups A and C having connection . A second RDF group defined as LABEL is associated with connection  between RDF groups B and D. Group A and group B are in data storage system and group C and group D are included in data storage system . An RDF group may be characterized as a bundle of zero or more RDF devices which is assigned a particular RA director that services the group.","An embodiment may include different restrictions in connection with defining and implementing groups. An embodiment may also include different restrictions and naming conventions for device labels. For example, a default label name may be used if no particular name is specified. An embodiment may include the restriction, for example, that a group using the default label name may not be an empty group. Other embodiments may have different restrictions in connection with naming and other types of specifications that may vary with each particular embodiment. In this particular example, the default RDF group label name may not be used in connection with empty groups as may be associated with initializing a new dynamic RDF group. An empty group may be characterized as not including any devices.","Referring back to , the group label , such as \u201cLABEL\u201d or \u201cLABEL\u201d, may be associated with a pair of RDF groups as in  in which each RDF group is included in a different data storage system. Similarly, the group number  may be an encoding to represent each particular group such as A, B, C and D described in connection with FIG. . Field  may include different types of link specific information that vary with the communication connection used. For example, in connection with , the link or communication connection  between RDF groups A and C in different data storage systems may be a fiber switch link. Using a fiber switch link, a serial number may be used to obtain an address of a director. As also described in more detail elsewhere herein, other types of information may be used for different types of connections and links to obtain addresses of RAs servicing different RDF groups. The types of connections and techniques used to obtain RA address information may vary with each particular embodiment.","An embodiment may support any one or more types of communication connections between remote directors of different data storage systems, such as fiber switch and GigE connections. The different types of communication connections may utilize different techniques in obtaining a remote address of an RA or other director. Information included in the link specific information , for example, may be used in the process of determining such addresses. For fiber switch connections, a world wide naming service (WWN) may be used to obtain an address of a director given a serial number. For other types of connections, such as GigE, other techniques may be used since, for example, naming services such as WWN may not be available.","What will now be described is one technique that may be used in connection with obtaining director addresses in an embodiment supporting GigE connections.","Referring now to , shown is an example of an embodiment  of tables that may be used with a GigE connection for facilitating communication between directors in remote data storages systems, such as Symmetrix data storage systems. In connection with a fiber switch connection, a naming service may be used to obtain the address of the target director given its serial number. In connection with a GigE connection, alternative techniques may be used to determine the particular address of directors. The tables  and  included in  may be used in connection with determining the IP address of a director. Instances of table  and  may be defined and stored in each data storage system, for example, in global memory or other portion of memory where configuration information may be stored. These tables may be stored in non-volatile memory.","Table  may be referred to as a Remote Box Table that includes an entry with the serial number of all other data storage systems included in a customer's environment. Table  may include an entry with a serial number for every other data storage system to which, for example, the current data storage system is able to remotely connect.","Each data storage system may also store in its global memory, for example, an instance of the Table . Table  may include information on all of the GigE director numbers and associated IP addresses. Table  may be organized such that all of the GigE director numbers and associated IP addresses for each data storage system are grouped together. The serial number obtained from Table  may be used as index into Table  to obtain addresses of one or more GigE directors located within a particular data storage system. By using the particular serial number of the data storage system paired with a particular GigE director number, the corresponding IP address may be obtained and used in connection with establishing a connection. In this embodiment, the particular director in a GigE embodiment to whom communications are directed may be specified as an input parameter in the dynamic RDF group system call.","It should be noted that an embodiment may include system calls or define an application programming interface (API) in order to provide information regarding the particular IP address of a GigE or other director. In other words, instead of directly accessing the values in the Tables  as described herein, a software facility included within a data storage system may provide an API, for example, with the input parameters of a serial number and a director number and return as an output parameter a particular address, such as a network address. This may be used as an alternative to the WWN service as may be used for example in connection with the fiber channel embodiment described also herein.","Referring now to , shown is an example of an embodiment  of an entry of the DRGT as may be included in global memory of a particular data storage. This structure is created and used when a temporary structure is created in processing, such as for steps  and  described elsewhere herein. It should be noted that an entry in the DRGT stored in global memory is a super set of information of an entry of the DRGT as may be stored locally by each director. The Global Memory (GM) temporary Structure  corresponding to a particular entry in the global memory version of the DRGT includes the DRGT entry  as described elsewhere herein in connection with element  of FIG. . Additionally, each entry in the global memory version of the DRGT includes additional metadata .","The additional metadata  may include the RDF group number. This group number may be used by a director to ensure that the correct entry in the static configuration file has been obtained for a particular group. The director creating the GM temporary structure  is passed a particular group number in the system call and places this in the additional metadata field . The director then copies other data from the global memory table DRGT entry and verifies that the group number of the DRGT matches that group number specified in the parameter. The group number in area  as described herein may be used for protection and data verification in processing steps, for example, to verify that the group number of a call parameter in the temporary structure as created by a first director matches the group number as received and used by another director in subsequent processing. It should be noted that other embodiments may include additional information in the global memory temporary structure in addition to that as described here. This may vary in accordance with each particular embodiment.","Referring now to , shown is an example of an embodiment of components of a computer system  that may be used in connection with creating and modifying a dynamic RDF group. As described elsewhere herein, an RDF group may be characterized as zero or more RDF devices. Generally, a particular RA as described in connection with  services a particular set of one or more groups. Although there may be other embodiments and configurations used in connection with defining and modifying a dynamic RDF group, described in following paragraphs and figures is an example in which remote system calls are used. For example, referring to the embodiment of configuration , the host  is connected to data storage device X. The host  may use remote procedure calls in connection with creating a dynamic RDF group pair between data storage system Xn\u22121  and data storage system Xn . There may be zero or more other data storage systems intervening between data storage system  and . Although the techniques described herein are used in connection with remote system calls where a host is not directly connected to the device , the techniques used herein may also be used in connection with procedure calls used to establish a dynamic RDF group where there is also a direct connection between the host  and the data storage system such as .","In connection with the host  creating an RDF group pair between data storage system  and , the multihop procedure call as described in U.S. patent application Ser. No. 09\/591,827, filed on Jun. 12, 2000, entitled \u201cMULTIHOP SYSTEM CALLS\u201d, which is incorporated herein by reference, may be used. Using a multihop system call, the host  may use remote procedure calls to establish an RDF dynamic group between data storage system  and  through an indirect connection to data storage system . In this instance, using the multihop system call, there are links in place between data storage system  and data storage system . The bit map included in the multihop system call indicates that only data storage system Xn\u22121  executes the remote system call. Additionally, included as a parameter in the multihop system call is an identifier of the remote director on data storage system  Xn\u22121 that is designated to execute the multihop system call. It should be noted that although a multihop system call may be used as described herein, remote system calls may be used in connection with dynamic RDF group commands. An embodiment using remote system calls, for example, may include host  directly issuing a remote procedure call to data storage system  rather than issue the system call through intermediate data storage systems indirectly connecting host  to .","Within data storage system , as well as other data storage systems included in the embodiment , there may be more than one RA. The multihop system call is forwarded from the host  through one or more intervening data storage systems until data storage system  is reached. A director RA specified by parameters of the multihop system call on data storage system  receives and executes the remote system call. The data storage system  waits for the remote system call to complete execution. Subsequently, after the remote system call finishes execution creating and\/or modifying the dynamic RDF groups, the status of execution of this remote system call between systems  and  is returned back up the chain to the multihop system call to the host .","Referring now to , shown is the flowchart  summarizing processing steps described previously in connection with FIG. . At step , the host issues a multihop system call through data storage system X. As described in connection with the embodiment , the host is directly connected to data storage system X and desires to execute a dynamic RDF group modification command remotely on another data storage system not directly connected to the host. At step , the multihop system call is communicated to data storage system Xn\u22121. It should be noted that in connection with processing of step , the multihop system call may be communicated through one ore more intermediate data storage systems as well. At step , data storage system Xn\u22121 executes a remote system call directed to an RA located on data storage system Xn\u22121. At step , a determination is made as to whether the remote system call for the dynamic RDF group is complete. If not, control proceeds back up to wait in a loop formed at step . When the remote system call for the dynamic RDF group has been completed, control proceeds to step  where a status of the remote system call in connection with the dynamic RDF group operation is returned through the series of one or more intermediate nodes back to the host computer system that issued the remote system call command.","Referring now to , shown is an example of an embodiment illustrating in more detail the processing steps of the data storage systems Xn\u22121 and Xn. Data storage system Xn\u22121 receives and executes the remote system call to modify or create a dynamic RDF group between data storage system Xn\u22121  and data storage system Xn . Included in the data storage system  are two directors noted as Director X and Director Y. Director X initially receives the remote system call for the dynamics RDF group operation. The Director X determines that it is actually a remote system call to be executed by another director. Subsequently, Director X creates a record in a queue called the global system (GST) queue in order to communicate information to another director which in this instance is Director Y. The queue record is a request for a remote system call to be executed in connection with the creation of the dynamic RDF group. The execution mask indicates the target director as Director Y specified in the parameters of the remote system call. Director X then goes into a wait state. The Director X may time out or return an error status or other type of completion status upon receiving return status information from Director Y regarding the operation. The execution mask indicates that Director Y is the designated recipient of the GST record created and placed in the GST queue. Director Y then contacts another director in the data storage system Xn  to transmit data from the system call. As described in more detail in following paragraphs, both Directors A and Y may also use their respective GSTs to communicate with other directors as needed in performed processing steps for the dynamic RDF group command and associated status information.","Director Y receives the GST queue record and performs a verification or check prior to attempting to execute the remote system call for the creation of the dynamic RDF group. In this embodiment, for example, Director Y may verify the following: that this particular RDF group is not already defined as a static RDF group for any director, that the group is not already defined for a director for which a requested group is being added, that the directors that need to create this group only of the specified types allowed in this particular embodiment, for example a fiber switch or a GigE connection. Additionally, the Y director may also perform any checks in connection with the group label and restrictions in connection with this embodiment, such as the group label is not a default group label since this operation may involve empty groups and the default group label may not be specified in this embodiment for empty groups. The Director Y may also check the serial number of Xn=1 data storage system  to see if it's serial number matches the serial number specified in the physical parameters of the system call. Director Y may also perform other checks in connection with restriction in a particular embodiment, such that no other instance the dynamic RDF group modification command is executing in this particular data storage system. In this embodiment, the Director Y will fail to execute the system call if the dynamic RDF group command is a command to remove the last director supporting a group and the group is not empty. It should be noted that the particular items verified initially by the Director Y may vary in accordance with each particular embodiment. Other embodiments may provide for performing other verifications in accordance with specifics of each embodiment.","Subsequent to successfully verifying the set of initial checks, Director Y marks the dynamic group lock in global memory locking the particular DRGT entries for this operation. Director Y then updates its own local copy of the DRGT stored in non-volatile memory using the copy included in global memory and then adding to its local copy the requested RDF dynamic group modification operation. As described elsewhere herein, the copy in global memory is deemed to be the most up-to-date copy in the system. Director Y also modifies appropriate group bits to prevent the link discovery process from starting prior to data storage system Xn being initialized with the appropriate group information.","Director Y creates a temporary global memory structure to store information regarding the dynamic RDF group operation. It should be noted that the global memory DRGT is not yet updated. The information for the dynamic group modification is placed in the temporary global memory copy by Director Y using information included in the system call parameters and also from other locations.","The following data may be included as input parameters in the multihop system call: the serial numbers of data storage systems Xn and Xn\u22121, the group label, a group number on Xn and another group number on Xn\u22121 defining this RDF group, a bit mask of directors on Xn\u22121 that support the group being modified (our_supported_dir), and a bit mask of directors on Xn that support the group being modified (other_supported_dir). Additionally, in a GigE embodiment, the data may include a particular director number on Xn to whom a director on Xn\u22121 communicates (gige_other_side_dir_anchor). Other embodiments may communicate different portions of the data using other techniques. Other embodiments may also include additional data in the than as described herein.","The multihop system call indicates director Y as the recipient director to execute this remote system call. Director Y may create the entry in the DRGT corresponding to this request for the dynamic RDF group command using data communicated in the system call parameters as described above, and also by copying information from global memory, such as the static configuration file data.","Director Y then executes steps in connection with notifying other RAs regarding the dynamic RDF group modification. Director Y may perform this operation by creating another record and placing it in the GST queue. The record is directed to all RAs which need to create this new dynamic group. The other RAs that need to create this group receive the GST record and verify that the record was issued by the same director, director Y, that actually locked the dynamic group lock on the DRGT stored in global memory. If each of the other RAs successfully verifies this condition or conditions, then each of the RAs accordingly updates a local copy of the DRGT stored in non-volatile memory using the system call parameter information residing in the temporary global memory structure.","If, however, the RA verification test fails, the RA detecting the verification failure does nothing and returns a failure message to Director Y. Director Y waits until all of the RAs have been notified and return a confirmation to Director Y regarding successful completion of the verification test. In the instance where any of the directors or RAs returns a failure to Director Y, the creation of the RDF dynamic group operation may be \u201cundone\u201d. This operation may be \u201cundone\u201d, for example, by not updating the DRGT in global memory with the information stored in the temporary global memory structure. Additionally, Director Y may issue to each of the RAs a message, such as using the GST queue, to update local DRGT copies using data from the DRGT table in global memory.","Assuming all RAs have successfully updated their own copies of the RDF information in connection with the dynamic group request, Director Y moves out of the wait state and creates a special task to perform the dynamic RDF group modification request in accordance with the remote system call.","Before describing processing in connection with creating or removing a dynamic group on a remote box, two flowcharts in  will now be described in connection with summarizing the processing just described as may be performed by data storage system Xn\u22121. Referring now to , shown is a flowchart  of steps of one embodiment as may be performed by Director X in connection with processing a dynamic RDF group modification command. At step , Director X receives a command for updating the dynamic RDF group table. This update may be, for example, in connection with adding or deleting a new RDF group as well as modifying an existing group. Control proceeds to step  where Director X makes a determination as to whether the right command received is a remote system call. If it is not a remote system call, control proceeds to step  where Director X performs other processing. Otherwise, control proceeds to step  where Director X creates a GST record using a queue for communicating to other directors within the data storage system Xn\u22121 . The GST record created identifies or is directed to the director identified in the system call execution mask In this particular embodiment, the GST record and queue of the communication technique used for issuing commands between directors as well as communicating information and data there between. Other embodiments may use other techniques in connection with communications between and within data storage systems.","Control proceeds to step  where a determination is made by Director X as to whether the remote system call completes or times out. The Director X remains in a wait state until one or the other occurs. Accordingly, control proceeds to step  after either a completion status is returned indicating success or failure or a time-out has occurred. At step  status information may be returned to the other directors included in the call chain as well as the host computer system initially issuing the call. It should be noted that in connection with performing the wait operation in step  as well as other processing steps herein, a director may not remain in an idle state while waiting. An embodiment may use other techniques such as, for example, creating a wait task signaled when a completion status is returned for a particular job using an interrupt mechanism. Other embodiments may use other techniques in connection with performing the wait operations and processing steps in connection with step  and other described herein.","Referring now to , shown is a flowchart  of steps of an embodiment that may be performed by a second director, Director Y, included in the data storage system  Xn\u22121 in connection with a dynamic RDF group operation. At step , Director Y receives the GST queue record sent by Director X. Director Y then verifies test conditions to see if the dynamic RDF group operation may be performed. In step , a determination is made as to whether the test conditions were successful. If not, control proceeds to step  where a failure status may be returned. Otherwise, control proceeds to step  where Director Y locks the dynamic group record or records within global memory of the DRGT corresponding to the particular dynamic group request change, updates its local DRGT to reflect the modified group operation and modifies group bits to prevent the link discovery process from starting before data storage system Xn is set up with the correct group information. Control proceeds to step  where Director Y creates a temporary global memory structure for holding the dynamic group information request as obtained from the system call parameters. The temporary structure is initialized with this information accordingly.","Control proceeds to step  where a GST queue record is created to notify all other RAs that need to create the dynamic RDF group in connection with this operation. In other words, processing in step  is a message to all of the other RA to accordingly update their copies of the DRGT to reflect the requested change. Additionally, as described elsewhere herein, each of the RAs notified in connection with step  may also perform other test verification steps such as, for example, the director that issued the GST queue request in step  is the same director that locked the DRGT in global memory. Additionally, each of the RAs receiving the GST queue record created in step  updates its copy of the DRGT stored in its local memory. As part of this updating process, the DRGT from global memory is initially copied and accordingly updated with the dynamic group information for the current dynamic RDF group request using the temporary global memory structure. Each of the RAs sends a message back to Director Y indicating completion. Until Director Y has received a return status from all of the other RAs, or alternatively timed-out while waiting for such return status, Director Y proceeds waiting at step . When a completion status or time-out has been received in connection with all RAs, control proceeds to step  where a determination is made as to whether there has been a successful completion of this GST queue record request by all of the other RAs. If so, control proceeds to step  where a special task is created and executed in connection with transferring the new RDF group request information to another director in data storage system Xn. Otherwise, if there has not been a successful completion or update of the DRGT included locally in each of the RAs, control proceeds to step  where processing steps are taken in connection with \u201cundoing\u201d the operation with respect to the local copy of the DRGT stored on each of the RAs. At step , the global memory copy of the DRGT is not updated. At step , a GST queue record is created and issued to all of the other RAs to update their local copies of the DRGT using the unmodified global memory copy of the DRGT. At step , Director Y returns a failure status.","What will now be described are processing steps that may be taken by Director Y in connection with updating RDF group information included in data storage system Xwithout having a link up between data storage systems Xn\u22121  and Xn . A physical connection exists between data storage system Xn and Xn\u22121. However, processing steps have not been taken in connection with initializing this physical connection as being actively used for communications between the two directors.","As described previously in connection with step  processing, a task is initiated on Director Y to begin transferring group information in connection with the RDF group modification command to the remote data storage system Xn. The processing steps take into consideration the fact that a group may be an empty group. Group information may be transferred between data storage systems Xn and Xn\u22121 using parameters to include the necessary group information as communicated in the multihop system call. The general technique described in following paragraphs is to initially begin the link discovery process to search for an unused link between the data storage system Xn and Xn\u22121 and then to terminate this initialization or starting process prior to completion of the initialization steps after it is discovered that the data storage system Xn received the updated group information and returned a status. Subsequently, Director Y indicates this particular link as not being initialized again. The following description assumes that there is at least one link that is not initialized and available for use.","A number of usable links may be reserved and made available for use in connection with dynamically modifying and\/or creating RDF groups. For example, in one embodiment 64 usable links may exist and the last two links may be reserved for use by this technique described herein. The number of usable links available for other purposes such as by a user is 62. Other embodiments may have different numbers of available and reserved links and may utilize other techniques in connection with this processing.","Prior to Director Y executing the special task, a new target is created in data storage system Xn\u22121 using a designated link index associated with one of the reserved available links between data storage systems X and Xn\u22121. As part of the processing to create a new target, the Director Y may initialize system data structures necessary to define the link between director Y and a target director in data storage system Xn. Director Y may utilize, for example, the tables  and  in a GigE embodiment, or a naming service in a fiber switch embodiment in obtaining the target director address to be included in the necessary data structures. A link index in this particular example is associated with each of the particular communication connections available for use between the data storage systems. A physical connection may exist, however, it may already be in use in connection with other communications. A link index may be associated with a link considered \u201cavailable\u201d if the link is currently not in use or allocated, but is up and running. Director Y attempts to connect to a director in the data storage system Xn. A device identifier associated with the director in data storage system Xn may be obtained using, for example, routine calls included in an API. Director Y tries to connect to the remote data storage system and may wait for a period of time until success occurs. Director Y may otherwise abort after failure or after a time-out period.","It should be noted that in a fiber switch embodiment, director Y may transmit the necessary parameter information to set up the RDF group to any one of the directors of Xn specified by the bitmask (other_supported_dir). In the GigE embodiment, communications from Director Y may be directed to the Xn director number indicated above in gige_other_side_anchor. In a fiber switch embodiment, it should be noted that the bitmask in the received system call data may be 0. In this instance, the director may use a non-zero mask from a previous corresponding entry. In the event that this previous mask is also zero, the director Y may determine, using the WWN for example, which directors are on the remote data storage system Xn and select one for use as the \u201canchor\u201d in communications. If no directors are determined, then system call fails since the Director Y is unable to communicate with the remote data storage system.","Once a connection is established, Director Y prepares the extended parameter information of the new group and an indication if this is a creation or deletion operation. Director Y sends this information to a responder included in the data storage system Xn. The data storage system Xn receives this command, recognizes it as the first command on this link, and recognizes this command as an attempt to create a new group. The data storage system Xn receiving the new group command knows that Director Y of data storage system Xn\u22121 is executing the special task for the dynamic group modification and accordingly stops the link discovery process portion of initialization on the data storage system Xn. The responder may set appropriate hardware and\/or software settings to indicate the link as uninitialized. The responder may also create a GST queue record request to execute the received dynamic group change which is executed by a director at some point later. The director makes the link uninitialized in data storage system Xn. The director then returns a status response to Director Y in data storage system Xn\u22121.","Director Y receives the response, indicates the link as uninitialized in data storage system Xn\u22121, and invalidates the target. The target may be invalidated, for example, by invalidating the appropriate data structures previously initialized. This may include, for example, setting appropriate bits indicating \u201cunused\u201d system data structures and\/or returning the data structures to a pool of available data structures. Data storage system Xn\u22121 resumes with processing steps performed after special task processing.","A flowchart of  will now be described summarizing processing steps just described in connection with the special task execution of Director Y and steps executed when Director A receives the dynamic group command creation data.","Referring now to , shown is a flowchart of processing steps performed by both the data storage systems Xn and Xn\u22121 without having a link between the data storage system initialized when communicating the dynamic group command information to Xn. At step , prior to execution of the special task on data storage system Xn\u22121, Director Y creates a new target. At step , a determination is made as to whether a link is available. If there is none available, control proceeds to step  where a failure is returned in connection with this operation. Otherwise, control proceeds to step  where the new connection parameters are set up for this particular link and an attempt is made to connect to data storage system Xn.","At step , Director Y waits until a connection status has been returned for the particular link of interest. If success is not indicated, control proceeds to step  where there is a failure status returned. Otherwise, control proceeds from step  to step  where extended parameter information is prepared and sent to the data storage system Xn","It should be noted that steps  through  inclusively as included in flowchart  are performed in this example by Director Y of data storage system Xn\u22121. Control proceeds to step  where execution of steps may be performed by data storage system Xn upon receiving the information from Director Y. A director of Xn, such as Director A, also recognizes that this is a new connection attempt since this is a first command sent on this particular link. Control proceeds to step  where the responder director on Xn determines that a link is being created for a dynamic group change command. The responder, Director A of Xn determines that this link is being created for a dynamic group change operation and the link is being used to communicate information in connection with this operation. Director A makes the link not initialized. Director A may also create a GST queue record for the dynamic group change command which is then processed at some point later in step  resulting in the new group being created in Xn with the new group information. It should also be noted that failure may otherwise be indicated by this operation failing.","At step , Director A of data storage system Xn returns a status response to Director Y data storage system Xn\u22121 regarding the outcome of the dynamic group update command. Director Y also indicates this link as not initialized on data storage system Xn. At step , Director Y receives the response regarding the status and also indicates the link as not being initialized and invalidates the target.","What will now be described are more detailed processing steps of what occurs within data storage system Xn when the responder receives the command request and parameters from Director Y during execution of the special task In connection with processing on data storage system Xn, the responder receives the new group information and the extended parameters as transmitted from the Director Y. In following paragraphs, the responder within data storage system Xn may be referred to as Director A.","Director A on data storage system Xn verifies that the group can be created by testing for conditions similar to those, for example, described previously in connection with processing by Director Y of data storage system Xn\u22121. If all of the conditions are successfully verified, Director A locks the dynamic group lock in global memory. Similarly, as described elsewhere herein, in connection with data storage system Xn\u22121, Director A updates its local copy of the DRGT in nonvolatile memory using the copy of DRGT from global memory. Director A may take steps to synchronize processing steps ongoing between data storage systems Xn and Xn\u22121. For example, in one embodiment, Director A may set a group bit to prevent the link discovery process from starting within data storage system Xn before data storage system Xn\u22121 has the appropriate group information set up. In this embodiment, a bit mask corresponding to each group may also be stored in global memory. The bit mask may indicate settings for each particular group. In this instance, the group bit enabling link discovery may be disabled until when all processing steps are complete for defining a new group, for example, all directors needed for defining the new group as specified in the system command have updated local DRGT entries, and the like as described herein.","Director A then disconnects from the special task executing on Director Y. This disconnect is performed in this embodiment rather than return a status value to Director Y. Director A then copies the extended parameters sent by the special task executing on Director Y to a temporary global memory structure. Director A creates a GST queue record request for other RAs needed to create this new group regarding the dynamic group change information communicated in the extended parameters and then goes into a wait state. The GST queue record requests that all designated RAs needed to create this new group information perform a verification step and then, upon successful verification, update their local copy of the DRGT to include the new group information. The verification step in this embodiment may include determining if the director that issued the GST record request is the same director that locked the dynamic group lock in global memory.","Each of the RAs returns a status response to Director A. If Director A receives a successful status response from the other RAs needed to create the group, Director A then: updates the DRGT in global memory to include the new group information, turns off the group bit to enable the link discovery process, issues a GST queue record request to all other directors, including RAs, HAs and DAs, to update their local DRGT copies and create and update any required group masks in accordance with this dynamic group change.","Alternatively, if any of the RAs fail individually, they return a status failure to the Director A. Director A proceeds with processing steps to \u201cundo\u201d the creation of the group, for example, by not updating the DRGT copy in global memory and issuing a request for all RAs involved to overwrite their local DRGT copy with the unmodified DRGT from global memory.","If any one of the directors failed, the creation of the dynamic group information is undone similar to as described herein in which GSTQ records are issued to all of the other RA's who undo the information stored in their local DRGT. In other words, each of the RA's has their local DRGT restored to the copy in global memory that was untouched not reflecting the current RDF group change. Director A included in data storage system Xn responds to Director Y of data storage system Xn\u22121 with a success or failure indication with some additional information in the case of a failure. This may vary in accordance with each type of embodiment as to exactly what information is passed and actions taken.","Referring now to , shown is the flowchart  of steps of one embodiment that includes more detailed processing steps that may be performed by Director A previously described in connection with steps , ,  and  upon receiving the new group information. At step , the responder Director A in the data storage system Xn receives the new group information. At step , Director A verifies that the group can be created. At step , a determination is made as to whether this verification process was successful. If it was not, control proceeds to step  where failure is returned. Otherwise, control proceeds from step  to step  where the DRGT in the global memory is locked and Director A's local DRGT copy is updated using information from the global memory copy. Additionally, Director A's local DRGT copy is updated to include the new group information. At step , the appropriate group bit is set to prevent the link discovery process from starting and Director A disconnects from the special task executing on Director Y. At step , a temporary global memory structure is created and initialized with the system call information. At step , a GST queue record is created and sent to other RAs needed to create the new group regarding the new dynamic group information passed to Director A. The RAs perform initial verification checking and, if successful, update their local DRGT copy and return a status to Director A. Director A waits to receive a completion status or a time-out from all of the other RA's at step . Upon receiving a completion status or time-out from all of the other RA's, control proceeds to step  where a determination is made as to whether a successful status has been received for all of the RAs. If so, control proceeds from step  to step  where the DRGT in global memory is updated with the new group information, appropriate group bits are modified to enable link discovery process, and any other directors, such as HAs, other RAs or DAs, are also requested to update local DRGT copies regarding this new or modified RDF group. As described elsewhere herein, these directors may update local DRGT using the global memory copy of the DRGT and the temporary global memory structure. Control proceeds to step  where a status of success is returned from Director A to Director Y","As described herein, enabling the link discovery process may cause an automatic process within the data storage system to be executed at some later point in time to complete processing in connection with the particular RDF links allocated for the dynamic group making the RDF links and RDF groups available for use.","If at step , any one of the RAs do not return success, control proceeds to step  where the global memory DRGT is not updated, and, at step , commands are issued to undo the previous DRGT updates to the local copies of those RAs notified at step . This may be performed, for example, in this embodiment by instructing each of the local RAs to copy the DRGT of global memory. At step , a status of failure is returned to Director Y of data storage system Xn\u22121.","Subsequent to data storage system Xn\u22121 receiving a return status from data storage system Xn, processing by Director Y of data storage system Xn\u22121 resumes. Director Y performs a determination as to whether the status of the dynamic group creation was successful. In the event that the status indicates that all directors were successful such that all of the directors in both data storage systems Xn and Xn\u22121 have been updated, the DRGT in global memory of the data storage system Xn\u22121 is updated. Additionally, any necessary hardware and\/or software bits and flags are modified appropriately to enable the link discovery process for the newly established or newly defined RDF link as being available. Additionally, when all directors which were asked to update their tables in connection with this operation have been successful, the remaining directors, including for example HAs, DAs and any remaining RAs, are requested utilizing a GST queue record to update local DRGT copies and create the required masks as may also be maintained locally in accordance with the new group information.","If any one of the directors has failed, the creation of the group is \u201cundone\u201d, for example, by not updating the DRGT in global memory on Xn\u22121 and issuing to all of the RAs that have already updated their local DRGTs an override operation to update local DRGTs with a copy of the DRGT from global memory. The director Y of data storage system Xn\u22121 returns status information to Director X. Director X similarly returns status information as in connection with a multihop system call until the results are propagated back to the host computer system which issued the command.","Referring now to , shown is a flowchart of processing steps summarizing the steps performed by Director Y when Director A of data storage system Xn sends return status information to Director. At step , data storage system Xn\u22121 receives a response from data storage system Xn. A determination is made on data storage system Xn as to whether the dynamic group operation was successful. If not, control proceeds to step , where the creation of the group is undone on data storage system Xn\u22121 by not updating the global memory copy of the DRGT. At step  a GST queue record is created requesting that all of the RAs that had previously modified local DRGT copies replace the local DRGT copies with the unmodified DRGT from global memory.","If at step  it is determined that the dynamic group creation was successful, control proceeds to step  where the DRGT in global memory is updated using the copy stored previously in the temporary structure created. Additionally, control proceeds to step  where any necessary hardware and\/or software settings are modified to indicate the new link as available by enabling the link discovery process. Additionally, at step , any remaining directors, including, for example, HAs, DAs and remaining RAs, are requested via a GST queue record to update their local copies of the DRGT to reflect the new dynamic RDF group.","It should be noted that the foregoing description includes a dynamic group lock, for example as used in connection with step  and  processing, in each data storage system in global memory. Although not explicitly stated in any subsequent processing steps, the dynamic group lock is released within each data storage system when the processing associated with the dynamic RDF group system call is complete within each respective data storage system. For example, the lock may be released prior to returning a success or failure status to another director in another data storage system as indicated in various processing steps described above.","Timestamps may also be associated with each copy of the DRGT stored in local non-volatile memory of each director and the global memory copy as well. In the event that there is a power failure, for example, the DRGT having the latest timestamp may be used to synchronize other versions of the DRGT in global memory and between the other local directors.","A dynamic group may be initially created, and devices and links may be dynamically added to this group using a dynamic configuration file, for example, using the dynamic RDF techniques as described in U.S. patent application Ser. No. 09\/997,810 filed on Nov. 30, 2001. In connection with the foregoing dynamic group command, various dynamic group operations may be performed. For example, a director servicing a group on one or both of data storage systems Xn and Xn\u22121 may be removed, and a director servicing a group on one or both of data storage systems Xn and Xn\u22121 may be added.","It should be noted that in the foregoing description, a single group may be serviced by more than one director in the same data storage system.","The foregoing provides a flexible and efficient technique for performing a dynamic RDF group command without requiring a link between the two data storage systems to be initialized and ready to transmit user data. The physical link exists between the two systems but is not allocated and established for communications between the two systems. Partial initialization processing steps are performed to initially push information, such as setup and command data, from the first to the second system and return an acknowledgement to the first system. The link is then indicated as uninitialized until both first and second data storage system perform the remaining setup and initialization processing prior to enabling the link between the two systems as being recognized and used in communications between the two systems for transmitting user data.","In the foregoing description, it should be noted that a first link used to transmit the dynamic group configuration information may be different from a second link used in transmitting user data. For example, as described herein, links 62 and 63 may be used for passing the group information with the remaining links 0 through 61 inclusively available for transmitting user data. Other embodiments may use other link determinations in transmitting user and\/or group configuration data.","While the invention has been disclosed in connection with preferred embodiments shown and described in detail, their modifications and improvements thereon will become readily apparent to those skilled in the art. Accordingly, the spirit and scope of the present invention should be limited only by the following claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Features and advantages of the present invention will become more apparent from the following detailed description of exemplary embodiments thereof taken in conjunction with the accompanying drawings in which:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 3","FIGS. 1 and 2"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 6","FIG. 5"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIGS. 8 and 9"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIGS. 11","b":["13","17"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 12","FIG. 10"]}]},"DETDESC":[{},{}]}
