---
title: HSS fault recovery for non-3GPP access
abstract: A method for restoring faulty subscriber-related data in an Evolved Packet System (EPS) network including a Home Subscriber Server (HSS) and a 3GPP AAA server, be characterized by comprising the following steps performed at the 3GPP AAA server: receiving an indicator from the HSS, the indicator identifying one or more subscribers having the faulty subscriber-related data stored in the HSS; and for an interaction with an access from a non-3GPP network, if the access corresponding to one of the identified subscribers, instructing the HSS to restore the faulty subscriber-related data for one or all of the identified subscribers.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09049562&OS=09049562&RS=09049562
owner: Telefonaktiebolaget LM Ericsson (publ)
number: 09049562
owner_city: Stockholm
owner_country: SE
publication_date: 20110810
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is the U.S. national phase of International Application No. PCT\/CN2011\/001320, filed 10 Aug. 2011, which designated the U.S. and claims the benefit of U.S. Provisional Application No. 61\/609,033, filed 9 Mar. 2012, the entire contents of each of which are hereby incorporated by reference.","The present invention generally relates to non 3GPP accesses to an Evolved Network Core (EPC). More particularly, the present invention relates to methods for recovering faulty subscriber-related data stored in a Home Subscriber Server (HSS) in non-3GPP access scenarios. The present invention also relates to apparatus adapted for the same purpose.","At present, HSS supports both LTE (E-UTRAN) access and Non-3GPP access in accordance with 3GPP Evolved Packet System (EPS) specifications, which provides for mechanisms for subscription, authentication and mobility management.","In accordance with 3GPP TS 23.402 chapter 12 \u201cInteractions between HSS and AAA Server\u201d, a 3GPP AAA can be used in Non-3GPP access scenarios to authenticate and authorize a UE connecting from a Non-3GPP access network (e.g. CDMA2000) to an EPC network via the SWx interface towards HSS. In this respect, 3GPP TS 29.273 chapter 8 \u201cSWx description\u201d describes the interface SWx. These 3GPP specifications are incorporated by reference in its entirety.",{"@attributes":{"id":"p-0006","num":"0005"},"figref":["FIG. 1","FIG. 1"],"b":["110","120","150","150","150","120"],"i":["a","b ","c "]},"Conventionally through the SWx interface, 3GPP AAA retrieves security and authorization information stored in HSS. The HSS keeps track of the AAA Identity currently serving a user in the Non-3GPP access network. SWx is also used to update the HSS with PDN-GW Identity information to facilitate handover (HO) between 3GPP and Non-3GPP accesses.","When a HSS suffers a restart or data reload after failure, this HSS may lose dynamic data such as 3GPP AAA registration information for a number of users, or any PDN-GW identity used as mobility anchor for user sessions in 3GPP and Non-3GPP accesses.","In this situation, the HSS does not have valid information to identify subscribers and 3GPP AAA servers serving the subscribers, and this can cause severe consequences. A first consequence may be that the HSS can not update user contexts stored in the 3GPP AAA server or De-Register users due to administrative reasons. A second consequence may be a rejection by such HSS of subscriber profile retrieval, PDN GW Identity updates and\/or Deregistration initiated from a 3GPP AAA server, especially, where there is no information or obsolete information stored in such HSS. A third consequence may be that UE authentication would be allowed if no binding information is stored, whilst there may be other 3GPP AAA server already serving the user. A still fourth consequence may be that there may be multiple 3GPP AAA servers serving a same user and this makes the situation being even worse.","However, in the Non-3GPP Access scenario, there is no fault recovery procedure between a 3GPP AAA server and a HSS when a HSS failure happens, and this will cause problems for 3GPP AAA during the UE attach, detach or handover.","In light of the above, one of the objects of the present invention is to provide a solution for HSS fault recovery which can be conveniently implemented in Non-3GPP access scenarios.","According to one aspect of the invention, a method for restoring faulty subscriber-related data in an Evolved Packet System (EPS) network including a Home Subscriber Server (HSS) and a 3GPP AAA server, be characterized by comprising the following steps performed at the 3GPP AAA server:\n\n","In a preferred embodiment according to the present invention, wherein upon receiving the indicator, the method further comprising:\n\n","In a preferred embodiment according to the present invention, the method may further comprise:\n\n","In a preferred embodiment according to the present invention, the indicator may be represented in form of a Push-Profile-Request (PPR) command, in which an information element \u201cIMSI or User Id List\u201d indicates the one or more subscribers having the faulty subscriber-related data stored in the HSS. Particularly for this embodiment, the information element \u201cIMSI or User Id List\u201d may contain a predefined symbol for indicating that the faulty subscriber-related data occur for all of the subscribers, and the leading digits of an IMSI for indicating that the faulty subscriber-related data occur for a set of the subscribers whose IMSIs begin with the leading digits.","In a preferred embodiment according to the present invention, the reporting step may be performed by sending a Push-Profile-Answer (PPA) command, in which an information element \u201cResult\u201d contains the result of the marking step.","In a preferred embodiment according to the present invention, the instructing step may be performed by sending a Server-Assignment-Request (SAR) command, in which an information element \u201cIMSI\u201d indicates the one or more subscribers whose subscriber-related data need to be restored, and an information element \u201cServer Assignment Type\u201d is set as \u201cRestoration\u201d.","In a preferred embodiment according to the present invention, the reply from the HSS may be represented in form of Server-Assignment-Answer (SAA) command, in which an information element \u201cIMSI\u201d indicates the one or more subscribers whose subscriber-related data need to be restored, and an information element \u201cRegistration Result\u201d contains the restoring result.","Particularly useful for the sake of simplicity, the SAR command, the SAA command, or both may preferably refer to just one subscriber, that is, the SAR command, the SAA command, or both may preferably just include the IMSI of one subscriber affected by restoration. Nevertheless, nothing in this specification precludes the combination of identifiers for more than one subscriber in any of the SAR command, the SAA command, or both. On the other hand, the PPR\/PPA command pair can refer to a plurality of subscribers, namely those subscribers of the recovering HSS who are assumed to be served by the 3GPP AAA server.","According to another aspect of the invention, an apparatus for Access Authentication and Authorization (AAA) in an Evolved Packet System (EPS) network, be characterized by comprising:\n\n","According to another aspect of the invention, a method for restoring faulty subscriber-related data in an Evolved Packet System (EPS) network including a Home Subscriber Server (HSS) and a 3GPP AAA server, be characterized by comprising the following steps performed at the HSS:\n\n","In a preferred embodiment, according to the present invention, for an interaction with an access from a non-3GPP network, if the access corresponding to one of the identified subscribers, the 3GPP AAA server may generate the instruction.","In a preferred embodiment, according to the present invention, the method may further comprise a step of:\n\n","In a preferred embodiment, according to the present invention, the indicator may be represented in form of a Push-Profile-Request (PPR) command, in which an information element \u201cIMSI or User Id List\u201d indicates the one or more subscribers having the faulty subscriber-related data stored in the HSS. Particularly for this embodiment, the information element \u201cIMSI or User Id List\u201d may contain a predefined symbol for indicating that the faulty subscriber-related data occur for all of the subscribers, and the leading digits of an IMSI for indicating that the faulty subscriber-related data occur for a set of the subscribers whose IMSIs begin with the leading digits.","In a preferred embodiment, according to the present invention, the instruction may be represented in form of a Server-Assignment-Request (SAR) command, in which an information element \u201cIMSI\u201d indicates the one or more subscribers whose subscriber-related data need to be restored, and an information element \u201cServer Assignment Type\u201d is set as \u201cRestoration\u201d.","In a preferred embodiment, according to the present invention, the reporting step may be performed by sending a Server-Assignment-Answer (SAA) command to the 3GPP AAA server, in which an information element \u201cIMSI\u201d indicates the one or more subscribers whose subscriber-related data need to be restored, and an information element \u201cRegistration Result\u201d contains the restoring result.","According to another aspect of the invention, a Home Subscriber Server (HSS) in an Evolved Packet System (EPS) network, be characterized by comprising:\n\n","According to another aspect of the invention, there is provided a method of fault recovery between a 3GPP AAA server and a Home Subscriber Server (HSS) in an Evolved Packet System (EPS) network, the method characterized by comprising the steps of:\n\n","In accordance with an embodiment of the invention, upon marking all the subscribers of the HSS as restoration pending, this method may further comprise a step of confirming the restoration pending by sending a Push-Profile-Answer (PPA) command from the 3GPP AAA server to the HSS, in which an information element \u201cResult\u201d contains the result of the marking step.","In accordance with an embodiment of the invention, where the 3GPP AAA registration information indicates a different 3GPP AAA server than a previously registered 3GPP AAA server for the at least one subscriber, this method may further comprise a step of submitting from the HSS a de-registration message for the at least one subscriber towards the previously registered 3GPP AAA server.","In accordance with an embodiment of the invention, where a Packet Data Network Gateway (PDN GW) identity is received in the registration message, this method may further comprise a step of storing at the HSS the received PDN GW identity and, where the PDN GW identity is different than a previously stored PDN GW identity, notifying a Mobility Management Entity (MME) of the received PDN GW identity.","In accordance with an embodiment of the invention, the reset indication submitted to each 3GPP AAA server may include a set of user identities identifying subscribers served by said 3GPP AAA server. In other embodiment, the reset indication may be submitted without identifiers of subscribers for the 3GPP AAA server marking all subscribers belonging to the HSS that has submitted the reset indication as restoration pending.","According to another aspect of the invention, there is provided a Home Subscriber Server (HSS) holding subscriber data for subscribers of an Evolved Packet System (EPS) network, the HSS comprising:\n\n","According to another aspect of the invention, there is provided an apparatus for Access Authentication and Authorization (AAA) in an Evolved Packet System (EPS) network, the apparatus comprising:\n\n","According to the present invention, the HSS is able to recover the previous lost dynamic data and reduce the risks to block the following Non-3GPP IP Access\/UE initiated attach, detach, additional PDN connectivity and so on procedures. Additionally, according to the present invention, the fault recovery procedure in Non-3GPP Accesses Scenario is implemented within the current 3GPP frame, and thus is easily applied.","While the invention covers various modifications and alternative constructions, embodiments of the invention are shown in the drawings and will hereinafter be described in detail. However, it should be understood that the specific description and drawings are not intended to limit the invention to the specific forms disclosed. On the contrary, it is intended that the scope of the claimed invention includes all modifications and alternative constructions thereof falling within the scope of the invention as expressed in the appended claims.","Unless defined in the context of the present description, otherwise, all technical and scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art to which this invention belongs.","For illustrative purpose, the following embodiments are described in the context of the above architecture as shown in . However, one skilled artisan in the art would recognize that the present invention are applicable to any other architecture.","According to one embodiment of the present invention, a fault recovery procedure between 3GPP AAA and HSS is provided in case of HSS failure happens, so that, when HSS detects 3GPP AAA and UE registration is lost, it sends an indication to 3GPP AAA. Upon reception of the indication from HSS, 3GPP AAA marks all the affected subscriber records as \u201crestoration pending flag\u201d, and thus at the next subscriber control signaling, 3GPP AAA can trigger the restoration procedure towards HSS, e.g. registration procedure to restore the registration data in the HSS.",{"@attributes":{"id":"p-0047","num":"0073"},"figref":"FIG. 2"},"With reference to , at step S, the 3GPP AAA server  as shown in  receives an indicator from the HSS  via SWx interface. The indicator identifies one or more subscribers having the faulty subscriber-related data which need to be restored. Preferably, the indicator is represented in form of a SWx command Push-Profile-Request (PPR) specified in 3GPP TS 29.273. To adapt to the reporting of a HSS failure, some modifications are made to the PPR command. An example of modified PPR command is given in Table I. For illustrative purpose, this table only shows the information elements relevant to the reporting.",{"@attributes":{"id":"p-0049","num":"0075"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"Table I"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"User Profile Update Request (PPR)"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Information","Mapping to ",{},{}]},{"entry":["element","Diameter",{},{}]},{"entry":["name","AVP","Cat.","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["IMSI or User","User-Name","M","This information element shall"]},{"entry":["Id List",{},{},"contain the user IMSI, formatted"]},{"entry":[{},{},{},"according to 3GPP TS 23.003 [14],"]},{"entry":[{},{},{},"clause 2.2. For indicating that"]},{"entry":[{},{},{},"faulty data occur in HSS, this IE"]},{"entry":[{},{},{},"shall contain \u201c*\u201d indicating all"]},{"entry":[{},{},{},"users are affected, or the leading"]},{"entry":[{},{},{},"digits of an IMSI (i.e. MCC, MNC)"]},{"entry":[{},{},{},"and it shall identify the set of"]},{"entry":[{},{},{},"subscribers whose IMSIs begin"]},{"entry":[{},{},{},"with the User-Id if the occurred"]},{"entry":[{},{},{},"failure is limited to subscribers"]},{"entry":[{},{},{},"identified by one or more User-Ids."]},{"entry":["User profile ","Non-3GPP-","M","For restoration procedure, the"]},{"entry":[{},"User-Data",{},"content of this AVP may be empty."]},{"entry":["Supported","Supported-","O","If present, this information element"]},{"entry":["Features","Features",{},"shall contain the list of features"]},{"entry":[{},{},{},"supported by the origin host. \u201cHSS"]},{"entry":[{},{},{},"restoration procedure\u201d is a new"]},{"entry":[{},{},{},"optional feature to be included in"]},{"entry":[{},{},{},"the Feature List for SWx."]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"As shown in Table I, in normal case, the information element \u201cIMSI or User Id List\u201d will be formatted according to 3GPP TS 23.003, and if intending to reporting the faulty subscriber-related data in the HSS, it will contain a symbol \u201c*\u201d for indicating that the faulty subscriber-related data occur for all of the subscribers, and the leading digits of an IMSI for indicating that the faulty subscriber-related data occur for a set of the subscribers whose IMSIs begin with the leading digits. As for the information element \u201cUser profile\u201d, while reporting the faulty subscriber-related data, the content of this AVP may be empty. The information element \u201cSupported Feature\u201d contains the list of features supported by the original host. To adapt to the present invention, the reporting feature is included in the Feature List for SWx.","Then, at step , the 3GPP AAA server  marks the identified subscribers in the PPR command as those in a restoration pending status by e.g., marking all of the records corresponding to the identified subscribers with a \u201crestoration pending flag\u201d. Note that if the received PPR command is not intended for indicating the faulty data occurring in the HSS, e.g., the PPR command is formatted according to 3GPP TS 23.003 [14], clause 2.2, the 3GPP AAA server  will process the command in normal mode.","At step , the 3GPP AAA server  reports the completion of the marking to the HSS  via SWx interface. Preferably, the reporting is performed by sending to the HSS  a SWx command Push-Profile-Answer (PPA) specified in 3GPP TS 29.273. Also, to adapt to the present invention, some modifications are made to the PPA command. An example of modified PPA command is given in Table II. For illustrative purpose, this table only shows the information elements relevant to the reporting.",{"@attributes":{"id":"p-0053","num":"0079"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE II"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"User Profile Update Response (PPA)"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Information",{},{},{}]},{"entry":["element","Mapping to Diameter",{},{}]},{"entry":["name","AVP","Cat.","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Result","Result-Code\/","M","This IE shall contain the"]},{"entry":[{},"Experimental-Result",{},"result of the operation."]},{"entry":[{},{},{},"The Result-Code AVP"]},{"entry":[{},{},{},"shall be used to indicate"]},{"entry":[{},{},{},"success\/errors as defined in"]},{"entry":[{},{},{},"the Diameter Base Protocol."]},{"entry":[{},{},{},"The Experimental-Result"]},{"entry":[{},{},{},"AVP shall be used for SWx"]},{"entry":[{},{},{},"errors. This is a grouped"]},{"entry":[{},{},{},"AVP which shall contain"]},{"entry":[{},{},{},"the 3GPP Vendor ID in the"]},{"entry":[{},{},{},"Vendor-Id AVP, and the"]},{"entry":[{},{},{},"error code in the"]},{"entry":[{},{},{},"Experimental-Result-Code"]},{"entry":[{},{},{},"AVP."]},{"entry":["Supported","Supported-Features","O","If present, this information"]},{"entry":["Features",{},{},"element shall contain the"]},{"entry":[{},{},{},"list of features supported"]},{"entry":[{},{},{},"by the origin host. \u201cHSS"]},{"entry":[{},{},{},"restoration procedure\u201d is a"]},{"entry":[{},{},{},"new optional feature to be"]},{"entry":[{},{},{},"included in the Feature"]},{"entry":[{},{},{},"List for SWx."]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"As shown in Table II, the information element \u201cResult\u201d contains the result of the marking operation. The Result-Code AVP shall be used to indicate success\/errors as defined in the Diameter Base Protocol. The Experimental-Result AVP shall be used for SWx errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP. The information element \u201cSupported Feature\u201d contains the list of features supported by the original host. To adapt to the present invention, the reporting feature is included in the Feature List for SWx.","Next, at step S, while an interaction with an access from a non-3GPP network occurs, the 3GPP AAA server  determines whether the access corresponds to one of the identified subscribers, and if it is the case, the procedure proceeds to step S, where the 3GPP AAA server  initiates a restoration procedure to restore the faulty subscriber-related data for one or all of the identified subscribers.","Preferably, the Restoration procedure is mapped to a pair of commands, i.e., Server-Assignment-Request\/Answer (SAR\/SAA), which are defined in the diameter application of SWx reference point specified in 3GPP TS 29.273. In particular, the 3GPP AAA server  initiates the restoration procedure by sending a registration message in form of a SAR command to the HSS . As a response, the HSS  performs a restoration operation for the faulty subscriber-related data based on the subscriber-related data and 3GPP Registration information in the received registration message and returns a command SAA to the 3GPP AAA server . To adapt to the present invention, some modifications are made to these commands. Examples of modified SAR and SAA commands are given in Table III and IV, respectively. For illustrative purpose, these tables only show the relevant information elements.",{"@attributes":{"id":"p-0057","num":"0083"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE III"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Non-3GPP IP Access Registration Request (SAR)"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Information ","Mapping to",{},{}]},{"entry":["element","Diameter ",{},{}]},{"entry":["name","AVP","Cat.","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["IMSI","User-Name","M","This information element shall"]},{"entry":[{},{},{},"contain the user IMSI"]},{"entry":["Server","Server-","M","This IE shall contain the type of"]},{"entry":["Assignment","Assignment-",{},"procedure the 3GPP AAA Server"]},{"entry":["Type","Type",{},"requests in the HSS."]},{"entry":[{},{},{},"In this case, this IE contains"]},{"entry":[{},{},{},"\u201cRESTORATION\u201d value, the HSS"]},{"entry":[{},{},{},"shall perform a restoration"]},{"entry":[{},{},{},"procedure for the subscriber and"]},{"entry":[{},{},{},"3GPP AAA registration whenever"]},{"entry":[{},{},{},"\u201cHSS restoration procedure\u201d is"]},{"entry":[{},{},{},"supported by HSS."]},{"entry":["Active APN","Active-APN","O","This Information Element, if"]},{"entry":[{},{},{},"present, contains the list of active"]},{"entry":[{},{},{},"APNs stored by the MME or SGSN,"]},{"entry":[{},{},{},"including the identity of the PDN"]},{"entry":[{},{},{},"GW assigned to each APN. The"]},{"entry":[{},{},{},"following information shall be"]},{"entry":[{},{},{},"present:"]},{"entry":[{},{},{},"Context-Identifier: context id of"]},{"entry":[{},{},{},"subscribed APN in use"]},{"entry":[{},{},{},"Service-Selection: name of"]},{"entry":[{},{},{},"subscribed APN in use"]},{"entry":[{},{},{},"MIP6-Agent-Info: including PDN"]},{"entry":[{},{},{},"GW identity in use for subscribed"]},{"entry":[{},{},{},"APN"]},{"entry":[{},{},{},"Visited-Network-Identifier:"]},{"entry":[{},{},{},"identifies the PLMN where the PDN"]},{"entry":[{},{},{},"GW was allocated"]},{"entry":[{},{},{},"Specific-APN-Info: list of APN-in"]},{"entry":[{},{},{},"use and related PDN GW identity"]},{"entry":[{},{},{},"when the subscribed APN is the"]},{"entry":[{},{},{},"wildcard APN"]},{"entry":[{},{},{},"It may be included if the"]},{"entry":[{},{},{},"Server-Assignment-Type is set to"]},{"entry":[{},{},{},"RESTORATION."]},{"entry":["Supported","Supported-","O","If present, this information element"]},{"entry":["Features","Features",{},"shall contain the list of features"]},{"entry":[{},{},{},"supported by the origin host. \u201cHSS"]},{"entry":[{},{},{},"restoration procedure\u201d is a new"]},{"entry":[{},{},{},"optional feature to be included in the"]},{"entry":[{},{},{},"Feature List for SWx."]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0058","num":"0084"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE IV"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Non-3GPP IP Access Registration Answer (SAA)"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Information",{},{},{}]},{"entry":["element","Mapping to Diameter",{},{}]},{"entry":["name","AVP","Cat.","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["IMSI","User-Name","M","This information element"]},{"entry":[{},{},{},"shall contain the user IMSI"]},{"entry":["Registration","Result-Code\/","M","This IE contains the result"]},{"entry":["Result","Experimental-Result",{},"of the operation."]},{"entry":[{},{},{},"The Result-Code AVP shall"]},{"entry":[{},{},{},"be used for errors defined"]},{"entry":[{},{},{},"in the Diameter Base"]},{"entry":[{},{},{},"Protocol."]},{"entry":[{},{},{},"The Experimental-Result"]},{"entry":[{},{},{},"AVP shall be used for SWx"]},{"entry":[{},{},{},"errors. This is a"]},{"entry":[{},{},{},"grouped AVP which shall"]},{"entry":[{},{},{},"contain the 3GPP Vendor"]},{"entry":[{},{},{},"ID in the Vendor-Id"]},{"entry":[{},{},{},"AVP, and the error code in"]},{"entry":[{},{},{},"the"]},{"entry":[{},{},{},"Experimental-Result-Code"]},{"entry":[{},{},{},"AVP."]},{"entry":["Supported","Supported-Features","O","If present, this information"]},{"entry":["Features",{},{},"element shall contain the"]},{"entry":[{},{},{},"list of features supported"]},{"entry":[{},{},{},"by the origin host. \u201cHSS"]},{"entry":[{},{},{},"restoration procedure\u201d is a"]},{"entry":[{},{},{},"new optional feature to be"]},{"entry":[{},{},{},"included in the Feature List"]},{"entry":[{},{},{},"for SWx."]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"As shown in Table III, for the Restoration procedure, the information element \u201cServer Assignment Type\u201d in the Server-Assignment-Request (SAR) command is set as \u201cRestoration\u201d to inform the HSS  that all or some subscriber-related data need to be restored, and the information element \u201cIMSI\u201d indicates which subscribers whose subscriber-related data need to be restored.","As shown in Table IV, the information element \u201cRegistration Result\u201d in the Server-Assignment-Answer (SAA) command contains the restoring result, and the information element \u201cIMSI\u201d indicates the subscribers to which the restoring result is directed.","At step , the 3GPP AAA server  determines whether a SAA command reporting a successful restoration is received from the HSS . If it is the case, the procedure proceeds to step S.","At step S, upon receiving the SAA command from the HSS , the 3GPP AAA server  clears the \u201crestoration pending flag\u201d for the records corresponding to the restored subscriber-related data.",{"@attributes":{"id":"p-0063","num":"0089"},"figref":"FIG. 3"},"With reference to , at step S, the HSS  as shown in  sends an indicator to the 3GPP AAA server  via SWx interface. As described above, the indicator is tended for identifying one or more subscribers having the faulty subscriber-related data which need to be restored, and preferably, is represented in form of a SWx command PPR as shown in Table I.","Then, at step S, the HSS  determines whether an instruction for restoring is received from the 3GPP AAA server . If it is the case, the procedure proceeds to step S.","At step S, the HSS  performs the restoring operation in response to an instruction for restoring the faulty subscriber-related data from the 3GPP AAA server . Preferably, the instruction is represented as a registration message in form of a SAR command as shown in Table III and the HSS  restores the faulty subscriber-related data based on the subscriber-related data and 3GPP Registration information in the received registration message.","Next, at step , upon performing the restoration operation for the faulty subscriber-related data, the HSS  returns a command SAR as shown in Table IV, which indicates the restoring result and the subscribers to which the restoring result is directed.",{"@attributes":{"id":"p-0068","num":"0094"},"figref":"FIG. 4"},"With reference to , at step , the HSS  determines dynamic data for a user, such as 3GPP AAA registration, may have been lost due to, e.g. un-predictable restart.","Then, at step , the HSS  sends a reset indication or an indicator towards the impacted 3GPP AAA server, e.g., 3GPP AAA server , which may optionally include a set of affected user identities. Preferably, the indicator is represented in form of PPR command as shown in Table I.","At step , upon receiving the reset indication, the 3GPP AAA server  marks all the affected users with a \u201crestoration pending flag\u201d, and then replies back a reset response to the HSS  by returning a PPA command as shown in Table II.","At step , there is a STA\/SWa\/SWm\/S6b interaction between the 3GPP AAA server and a non-3GPP IP access. Note this interaction can be triggered by the network of by the AAA (e.g. re-authorization procedure).","At step , the 3GPP AAA server  determines whether the user corresponding to the non-3GPP IP access is marked with the \u201crestoration pending flag\u201d.","Next, at step , the 3GPP AAA server  initiates a restoration procedure via a registration message with \u201cServer-Assignment-Type\u201d being set as \u201cRESTORATION\u201d.","At step , the HSS  restores the faulty subscriber-related data. In case an obsolete AAA server was registered, the HSS  will initiate De-registration procedure towards the obsolete AAA server. In case PDN GW identity is received, the HSS  will store the new information received and will notify MME only if new PDN GW Id information is included.","At step , after restoration, the HSS  will return a SAA command to the 3GPP AAA server. This indicates that the restoration procedure for certain user is finished and thus the 3GPP AAA server shall clear the \u201crestoration pending flag\u201d for the user.",{"@attributes":{"id":"p-0077","num":"0103"},"figref":"FIG. 5"},"With reference to , the apparatus  comprises a communicating unit , an interacting unit , and a processing unit . The unit  is configured to communicate with network entities within HPLMN or non-3GPP networks, such as HSS, PDN Gateway, ePDG, trusted non-3GPP IP access point and untrusted non-3GPP IP access point. For example, it can receive a PPR or SAA command from a HSS. It can also interact with an access from a non-3GPP IP network. Moreover, this unit can send a SAR or PPA command to the HSS. The unit  is configured to interact with an access from a non-3GPP network. The unit  is configured to determine whether the access corresponds to one of the identified subscribers and to generate a SAR command instructing the HSS to restore the faulty subscriber-related data for one or all of the identified subscribers if it is the case. This unit is also configured to perform the following operations: marking the identified subscribers in the PPR command with a restoration pending flag; generating a PPA command reporting the completion of the marking; and clearing the restoration pending flag in response to a SAA command from the HSS.",{"@attributes":{"id":"p-0079","num":"0105"},"figref":"FIG. 6"},"With reference to , the HSS  comprises a communicating unit , a restoring unit , and a reporting unit . The unit  is configured to communicate with network entities such as 3GPP AAA server. For example, it can receive a PPA or SAR command from a 3GPP AAA server. Moreover, this unit can send a PPR or SAA command to the 3GPP AAA server. The unit  is configured to restore the faulty subscriber-related data for one or all of the identified subscribers in response to the receipt of the SAR command from the 3GPP AAA server. The unit  is configured to generate the PPR and SAA commands.","It should be noted that the aforesaid embodiments are illustrative of this invention instead of restricting this invention, substitute embodiments may be designed by those skilled in the art without departing from the scope of the claims enclosed. The wordings such as \u201cinclude\u201d, \u201cincluding\u201d, \u201ccomprise\u201d and \u201ccomprising\u201d do not exclude elements or steps which are present but not listed in the description and the claims. It also shall be noted that as used herein and in the appended claims, the singular forms \u201ca\u201d, \u201can\u201d, and \u201cthe\u201d include plural referents unless the context clearly dictates otherwise. This invention can be achieved by means of hardware including several different elements or by means of a suitably programmed computer. In the unit claims that list several means, several ones among these means can be specifically embodied in the same hardware item. The use of such words as first, second, third does not represent any order, which can be simply explained as names."],"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing and other objects, features, and advantages of the invention will be apparent from the following more particular description of preferred embodiments as illustrated in the accompanying drawings in which:",{"@attributes":{"id":"p-0037","num":"0063"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0038","num":"0064"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0039","num":"0065"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0040","num":"0066"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0041","num":"0067"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0042","num":"0068"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
