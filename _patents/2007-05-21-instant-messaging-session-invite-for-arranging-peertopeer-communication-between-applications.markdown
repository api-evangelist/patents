---
title: Instant messaging session invite for arranging peer-to-peer communication between applications
abstract: Arrangements and procedures for arranging peer-to-peer communications sessions between applications are described. In one implementation, a first application executing at a first device utilizes online presence information of an instant messaging service to select a second application with which to engage in the peer-to-peer session. The second application is associated with a second device and registered with the instant messaging service as being peer-to-peer session invite capable. The first application arranges the peer-to-peer session via components of the instant messaging service. The arranged peer-to-peer session is functionally independent of the instant messaging service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07584265&OS=07584265&RS=07584265
owner: Microsoft Corporation
number: 07584265
owner_city: Redmond
owner_country: US
publication_date: 20070521
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION","An Exemplary Session Invite API","Session Invite Application  Registration","Launching Peer-to-Peer Communications","CONCLUSION"],"p":["This non-provisional U.S. patent application is a continuation of and claims the benefit of priority to U.S. patent application Ser. No. 10\/172,716, filed on Jun. 14, 2002, the disclosure of which is incorporated by reference herein. Furthermore, this non-provisional U.S. patent application claims the benefit of priority to provisional U.S. patent application Ser. No. 60\/363,985, which was filed on Mar. 14, 2002, the disclosure of which is incorporated by reference herein. U.S. patent application Ser. No. 10\/172,716 claimed the benefit of priority of and was converted from provisional U.S. patent application Ser. No. 60\/363,985.","The following description pertains to the arrangement of peer-to-peer communication sessions between networked applications.","A peer-to-peer network is a type of network in which each workstation has substantially equivalent capabilities and responsibilities. This differs from client\/server architectures, in which some computers are dedicated to serving the others. A peer-to-peer session consists of two or more of users or applications connected to one-another over a network. A peer-to-peer session can be established in a number of conventional ways including, for example, by hardwiring specific communication details (e.g., network addresses and protocols) into clients and\/or adding complex specialized lobby support code into a client to obtain necessary communication implementation details from a proprietary third party server. Thus, direct peer-to-peer session establishment generally requires each session client to be specifically designed to communicate with the other session client(s) based on each respective client's specific communication implementation details.","Such rigid design requirements typically result in applications that are not very robust or easily ported across platforms or implementations. For instance, hardwiring a particular network address into an application is not a very robust technique to communicate with another device since the network address used to access the device may change if the device is moved to a domain using a Network Address Translators (NATs) that multiplexes a single IP address across multiple machines.","To avoid hardwiring communication specifics such as network addresses and protocols into applications, conventional peer-to-peer session arrangement techniques allow a client to arrange a peer-to-peer session with another client using \u201clobby support\u201d. Lobby support's primary purpose is to enable users to meet and exchange network connection information to establish peer-to-peer sessions. Unfortunately, enabling application lobby support is substantially burdensome for application developers that desire to use lobby support to arrange peer-to-peer sessions because a considerable amount of dedicated lobby support code (e.g., the DirectPlay\u00ae, ActiveX\u00ae libraries, and\/or the like) must be implemented in each application. Such implementation requirements are time consuming and typically result in an undesirable increase in code size and code complexity.","Moreover, lobby support implementations are substantially burdensome because application developers or a third party are\/is also required to implement a lobby support infrastructure. The lobby support infrastructure includes a non-generic lobby server to interface with specialized lobby support client code to communicate device communication specifics. Additionally, another specialized client based piece code must be developed, loaded, and installed on each client device to communicate with the lobby server\u2014using whatever protocols are appropriate. Each of these respective tasks is substantially daunting in itself.","Accordingly, conventional techniques to arrange peer-to-peer sessions are considerably problematic in that they either involve rigid design requirements that hardwire communication specifics into application code, or require considerable specialized lobby support code in an application along with 3party development efforts to generate a server communication infrastructure.","These and other limitations of traditional systems and procedures to establish peer-to-peer communication sessions between various applications are addressed by the following described arrangements and procedures.","Arrangements and procedures for arranging peer-to-peer communications sessions between applications are described. In one implementation, a first application executing at a first device utilizes online presence information of an instant messaging service to select a second application with which to engage in the peer-to-peer session. The second application is associated with a second device and registered with the instant messaging service as being peer-to-peer session invite capable. The first application arranges the peer-to-peer session via components of the instant messaging service. The arranged peer-to-peer session is functionally independent of the instant messaging service.","The following description sets forth exemplary subject matter to arrange peer-to-peer communication between networked applications via an instant messaging system. The subject matter is described with specificity to meet statutory requirements. However, the description itself is not intended to limit the scope of this patent.","An Exemplary System",{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 1","b":["100","100"]},"The system  includes a switchboard or relay server  executing an instant messaging system. The relay server  is coupled across a network  (e.g., an organizational intranet or the Internet) to one or more client computing devices -, -, - . . . , and -N. The relay server  is a contact point for all computing devices . More particularly, the relay server  is a contact point for instant messenger client platform applications  and\/or client modules  (e.g., a word processor, a spreadsheet, a graphics program, a multimedia application, and so on\u2014the types of client modules  are virtually unlimited), which are hosted by respective client devices . The relay server  dispatches online presence and communication specifics such as direct session connection context data (e.g., network addresses and protocol information) between such applications.","The combination of services provided by the relay server  and the messenger client platform applications  provide the instant messaging service of the system . The client modules  leverage a session invite (SI) application programming interface (API)  (e.g., SIAPIs - and -) exposed by respective messenger platform applications  to programmatically arrange peer-to-peer communications.","A client device  includes a processor  that is coupled to a system memory . Each client device  is operational as any one of a number of different computing devices such as a personal computer, an image server computer, a thin client, a thick client, a hand-held or laptop device, a multiprocessor system, a microprocessor-based system, a set top box, programmable consumer electronics, a wireless phone, an application specific integrated circuit (ASIC), a network PC, minicomputer, mainframe computer, and so on.","The system memory  includes any combination of volatile and non-volatile computer-readable media for reading and writing. Volatile computer-readable media includes, for example, random access memory (RAM). Non-volatile computer-readable media includes, for example, read only memory (ROM), magnetic media such as a hard-disk, an optical disk drive, a floppy diskette, a flash memory card, a CD-ROM, and so on.","The processor  is configured to fetch and execute computer program instructions from program modules  or applications portion of memory , and further configured to fetch data from the data  portion of system memory  while executing program modules . Program modules  typically include routines, programs, objects, components, and so on, for performing particular tasks or implementing particular abstract data types. In this implementation, program modules  include, for example, an instant messaging client platform module , an SIAPI enabled module , a session module , and other applications  such as an operating system (OS), Web browser, etc. Data  includes, for example, session\/invitation data , registration data , and other data  such as device and application configuration data, messages, etc. Aspects of each these program modules  and data  are now described in greater detail.","Messenger client platform module  provides real-time communication messaging services between respective clients . Such communication services include transmitting notifications (e.g., client  online presence or status and messages) to clients  in a scalable fashion such as within an organizational intranet and\/or across a loosely coupled or federated constellation of servers . Each platform module  exposes a number of SIAPI interfaces  to enable two networked client programs (e.g., messenger platform clients  and\/or non-messenger platform clients ) to programmatically arrange peer-to-peer sessions. Virtually any type of application  (e.g., word processing, e-mail, image processing, etc.) can implement SIAPI  to arrange a peer-to-peer session over the instant messaging capabilities of system .","Such a peer-to-peer session is illustrated as communication path , which may or may not be bi-directional in nature. Depending on the details of the arranged session, an established peer-to-peer session may pass through network . Additionally, although a peer-to-peer session may be arranged through the network , the session itself may not pass through the network if the devices  participating in the session (represented by path ) are otherwise coupled together (e.g., through a serial or parallel interface, an infrared connection, and so on). Thus, although peer-to-peer communication path  and others (e.g., those described in greater detail below in reference to ) are illustrated as bypassing network , this exemplary communication path is shown only for purposes of clearly pointing out that a peer-to-peer session does not need to rely on the switchboard server after the peer-to-peer session has been arranged.","The SIAPI  is essentially a platform that is built on top of instant messaging aspects of messaging client platform module . The SIAPI  leverages instant messaging presence information corresponding to other instant messaging modules  on other clients devices  to exchange client  specific communication details (e.g., network addresses, communication protocols, and so on) and\/or other application  and  defined data  between devices .","For example, instant messaging module - (or another SIAPI enabled application -) leverages presence information corresponding to messaging module - on client - to arrange a peer-to-peer communication session with either the messaging application - or between other respective SIAPI enabled applications - and -. To accomplish this, the SIAPI enabled messaging module  publishes or exposes SIAPI  for access by other applications  and\/or .","The exposed SIAPI  provides a programmatic interface for other applications to leverage data sending capabilities of the messaging application  to send data from one device  to another device  so that the client application  (e.g., -) may initiate a peer-to-peer or other session (e.g., an application sharing session, a remote assistance session, and so on) with another client application  (e.g., -). The other client application, in this example, is not required to use or otherwise involve the messaging application  or the switchboard server  to participate in such a peer-to-peer session arrangement.","Although  illustrates system  in a client\/server based architecture, the peer-to-peer session arranging aspects of the system  are also applicable to other computing system architectures such as peer-to-peer system, multi-point system, and other computing system architectures.","SIAPI  is exposed by messenger platform . Messenger platforms  and\/or other applications  utilize SIAPI  to access the SI capability of the messaging service (e.g., messaging platforms  in combination with a relay server ) and to thereby establish respective peer-to-peer sessions with other instant messaging enabled applications. In one implementation, messenger platform  is based on an object-oriented programming model such as the Component Object Model (COM).","TABLE 1 illustrates an exemplary SIAPI  interfaces.",{"@attributes":{"id":"p-0032","num":"0031"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"AN EXEMPLARY SESSION INVITE API"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\/\/ IMsgrSessionManager Interface"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"["]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"uuid(305D86C6-6896-4099-91F5-CB7BA7733563), \/\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"IID_IMsgrSessionManager"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"helpstring(\u201cMessenger Session Manager Interface\u201d),"]},{"entry":[{},"dual,"]},{"entry":[{},"oleautomation"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"]"]},{"entry":[{},"interface IMsgrSessionManager : IDispatch"]},{"entry":[{},"{"]},{"entry":[{},"[id(0),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"helpstring(\u201cCreate a new Session object.\u201d), helpcontext(0)]"]},{"entry":[{},"HRESULT CreateSession("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] IDispatch **ppSession);"]},{"entry":[{},"[id(1),"]},{"entry":[{},"helpstring(\u201cRetrieves\u2002the\u2002session\u2002which\u2002launched"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"the application.\u201d), helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT GetLaunchingSession("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] LONG lProcessID,"]},{"entry":[{},"[out, retval] IDispatch **ppSession);"]},{"entry":[{},"[id(2),"]},{"entry":[{},"\u2002helpstring(\u201cRegister an app for use with Session"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Manager.\u201d), helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT RegisterApplication("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppGUID,"]},{"entry":[{},"[in] BSTR bstrAppName,"]},{"entry":[{},"[in] BSTR bstrAppURL,"]},{"entry":[{},"[in] BSTR bstrPath,"]},{"entry":[{},"[in] LONG ulFlags);"]},{"entry":[{},"[id(3),"]},{"entry":[{},"\u2002helpstring(\u201cRemove an app from the list.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT UnRegisterApplication("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppGUID);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(4),"]},{"entry":[{},"\u2002helpstring(\u201cGet\u2002the\u2002collection\u2002of\u2002applications.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Applications("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[out, retval] IDispatch **ppDisp);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ DMsgrSessionManagerEvents Interface"]},{"entry":[{},"["]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"uuid(52AC8B62-8F88-46ca-902A-1F1166B0A9F4),","\/\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"DIID_DMsgrSessionManagerEvents"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"helpstring(\u201cMessenger\u2002Events\u2002for\u2002Session\u2002Manager"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Interface\u201d) ]"]},{"entry":[{},"dispinterface DMsgrSessionManagerEvents"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"properties:"]},{"entry":[{},"methods:"]},{"entry":[{},"[id(DISPID_ONINVITATION),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"helpstring(\u201cA new session invitation has been received.\u201d),"]},{"entry":[{},"helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnInvitation("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] IDispatch *pSession,"]},{"entry":[{},"\u2002[in] BSTR bstrAppData,"]},{"entry":[{},"[in, out] VARIANT_BOOL *pfHandled);"]},{"entry":[{},"[id(DISPID_ONAPPREGISTERED),"]},{"entry":[{},"\u2002helpstring(\u201cA\u2002new\u2002application\u2002has\u2002been"]},{"entry":[{},"\u2002registered.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnAppRegistered("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppGUID);"]},{"entry":[{},"[id(DISPID_ONAPPUNREGISTERED),"]},{"entry":[{},"\u2002helpstring(\u201cAn\u2002application\u2002has\u2002been\u2002unregistered.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnAppUnRegistered("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppGUID);"]},{"entry":[{},"[id(DISPID_ONLOCKCHALLENGE),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpstring(\u201cChallenge from server received.\u201d), helpcontext(0x0000)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnLockChallenge("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] long 1Cookie,"]},{"entry":[{},"[in] BSTR bstrChallenge );"]},{"entry":[{},"[id(DISPID_ONLOCKRESULT),\u2003helpstring(\u201cResult"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"from server lock and key service.\u201d), helpcontext(0x0000)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnLockResult("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] long 1Cookie,"]},{"entry":[{},"[in] VARIANT_BOOL fSucceed);"]},{"entry":[{},"[id(DISPID_ONLOCKENABLE),"]},{"entry":[{},"helpstring(\u201cEnable\/disable"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"lock and key.\u201d), helpcontext(0x0000)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnLockEnable("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] VARIANT_BOOL fEnable);"]},{"entry":[{},"[id(DISPID_ONAPPSHUTDOWN),"]},{"entry":[{},"helpstring(\u201cMessenger"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"is shutting down.\u201d), helpcontext(0x0000)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnAppShutdown( );"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/\/------------------------------------------------------------------------"]},{"entry":[{},"\/\/ IMsgrSession Interface"]},{"entry":[{},"["]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"uuid(42D7CAFC-0167-4941-A5D8-9FD7F104C41A),","\/\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"IID_IMsgrSession"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"helpstring(\u201cMessenger Session Interface\u201d),"]},{"entry":[{},"oleautomation,"]},{"entry":[{},"dual"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"]"]},{"entry":[{},"interface IMsgrSession : IDispatch"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(0),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"helpstring(\u201cObtains the application GUID set by the inviter for"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"this session.\u201d), helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Application("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[out, retval] BSTR *pbstrAppGUID);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[propput,"]},{"entry":[{},"\u2002id(0),"]},{"entry":[{},"\u2002helpstring(\u201cSets the application GUID for the session.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Application("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppGUID);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(1),"]},{"entry":[{},"\u2002helpstring(\u201cGets\u2002the\u2002current\u2002state\u2002of\u2002the\u2002session.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT State("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] SESSION_STATE *pState);"]},{"entry":[{},"[id(2),"]},{"entry":[{},"\u2002helpstring(\u201cInvites user to this session.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Invite("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] IDispatch *pUser,"]},{"entry":[{},"[in] BSTR bstrAppData);"]},{"entry":[{},"[id(3),"]},{"entry":[{},"\u2002helpstring(\u201cDecline an invitation.\u201d), helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Decline("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppData);"]},{"entry":[{},"[id(4),"]},{"entry":[{},"\u2002helpstring(\u201cCancel an invitation.\u201d), helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Cancel("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] long hr,"]},{"entry":[{},"[in] BSTR bstrAppData);"]},{"entry":[{},"[id(5),"]},{"entry":[{},"\u2002helpstring(\u201cAccept an invitation.\u201d), helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Accept("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppData);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(6),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the IP address of the other"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"party in the session.\u201d), helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT RemoteAddress("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrRemoteAddress);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(7),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve session ID.\u201d), helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT SessionID("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrSessionID);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(8),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve\u2002the\u2002app-specific\u2002context\u2002data.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT ContextData("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrData);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(9),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the application name.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT ApplicationName("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrName);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(10),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the application URL.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT ApplicationURL("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrURL);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(11),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the session flags.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Flags("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] LONG *p1Flags);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(12),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the other user.\u201d), helpcontext(0)]"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT User("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] IDispatch **ppUser);"]},{"entry":[{},"[propput,"]},{"entry":[{},"\u2002id(13),"]},{"entry":[{},"\u2002helpstring(\u201cSet the local IP address of the session.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT LocalAddress("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrLocalAddress);"]},{"entry":[{},"[propget,"]},{"entry":[{},"\u2002id(13),"]},{"entry":[{},"\u2002helpstring(\u201cRetrieve the local IP address of the"]},{"entry":[{},"\u2002session.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT LocalAddress("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[out, retval] BSTR *pbstrLocalAddress);"]},{"entry":[{},"[id(14),"]},{"entry":[{},"\u2002helpstring(\u201cSend\u2003app-specific\u2003context\u2003data.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT SendContextData("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[in] BSTR bstrData);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/\/-----------------------------------------------------------------------"]},{"entry":[{},"\/\/ DMsgrSessionEvents Interface"]},{"entry":[{},"["]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"uuid(1847A74F-2E7F-43af-B7F9-55A4DE3276F5),","\/\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"DIID_DMsgrSessionEvents"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"helpstring(\u201cMessenger Events for Session Interface\u201d)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"]"]},{"entry":[{},"dispinterface DMsgrSessionEvents"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"properties:"]},{"entry":[{},"methods:"]},{"entry":[{},"[id(DISPID_ONSTATECHANGED),"]},{"entry":[{},"\u2002helpstring(\u201cThe session state has changed from"]},{"entry":[{},"\u2002prevState.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnStateChanged("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[in] SESSION_STATE prevState);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[id(DISPID_ONAPPNOTPRESENT),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002app\u2002for\u2002the\u2002invitation\u2002is\u2002not"]},{"entry":[{},"\u2002present.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnAppNotPresent("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] BSTR bstrAppName,"]},{"entry":[{},"[in] BSTR bstrAppURL);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[id(DISPID_ONACCEPTED),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002invitee\u2002has\u2002accepted\u2002the"]},{"entry":[{},"\u2002invitation.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"void OnAccepted([in] BSTR bstrAppData);"]},{"entry":[{},"[id(DISPID_ONDECLINED),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002invitee\u2002has\u2002declined\u2002the"]},{"entry":[{},"\u2002invitation.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"void OnDeclined([in] BSTR bstrAppData);"]},{"entry":[{},"[id(DISPID_ONCANCELLED),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002session\u2002has\u2002been\u2002cancelled.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"void OnCancelled([in] BSTR bstrAppData);"]},{"entry":[{},"[id(DISPID_ONTERMINATION),"]},{"entry":[{},"\u2002helpstring(\u201cThe session has ended.\u201d), helpcontext(0)]"]},{"entry":[{},"void OnTermination("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[in] long hr,"]},{"entry":[{},"[in] BSTR bstrAppData);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[id(DISPID_ONREADYTOLAUNCH),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002session\u2002is\u2002approved\u2002for\u2002launch.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"void OnReadyToLaunch( );"]},{"entry":[{},"[id(DISPID_BEFOREAPPLAUNCH),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002session's\u2002application\u2002is\u2002about\u2002to\u2002be"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"launched.\u201d), helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void\u2002BeforeAppLaunch([in,\u2002out]\u2002VARIANT_BOOL"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"*pfEnableDefault);"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[id(DISPID_ONCONTEXTDATA),"]},{"entry":[{},"\u2002helpstring(\u201cNew context data has arrived.\u201d),"]},{"entry":[{},"\u2002helpcontext(0)]"]},{"entry":[{},"void OnContextData("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[in] BSTR bstrContextData);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[id(DISPID_ONSENDERROR),"]},{"entry":[{},"\u2002helpstring(\u201cThe\u2002last\u2002operation\u2002failed\u2002"]},{"entry":[{},"\u2002when\u2003sending.\u201d),"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"helpcontext(0)]"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"void OnSendError("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"[in] long hr);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/\/-----------------------------------------------------------------------"]},{"entry":[{},"\/\/ Messenger session manager class definition"]},{"entry":[{},"["]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"uuid(E3A3B1D9-5675-43c0-BF04-37BE12239FB7),","\/\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"CLSID_MsgrSessionManager"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"helpstring(\u201cMessenger Session Manager Object\u201d)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"]"]},{"entry":[{},"coclass MsgrSessionManager"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"[default] interface IMsgrSessionManager;"]},{"entry":[{},"[default, source] dispinterface"]},{"entry":[{},"DMsgrSessionManagerEvents;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"};"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"The exemplary SIAPI  of TABLE 1 and objects that implement them are also documented in a Messenger Service API Reference file that can be downloaded from the following Web site: http:\/\/download.microsoft.com\/download\/windowsmessenger\/Install\/4.6\/WIN98M eXP\/EN-US\/Messenger.exe, and which is hereby incorporated by reference.","An installed application  registers itself with a messenger platform client . For instance, application - registers with its respective messenger platform client -. Application registration information  of  includes, for example, a GUID, a Universal Resource Identifier (URI), a path, and an application  name\u2014each respectively represented by registration data  of . The GUID is a key identifier for the application  that is substantially unique as compared to other identifiers for other applications . The other three values are the strings that identify the key. The URI identifies a server that hosts a download site (e.g., the database  of ) from which a user can retrieve the application . In one implementation, an application  identifies its own download site(s) when installed onto a device . The path is an absolute or relative path of the application  to be executed. The application name is used as an identifier for the application. The key can be stored in a portion of an operating system's registry information.","Once an SIAPI enabled application  registers with the messenger platform , the messenger  adds menu items and buttons to one or more of the application's windows so that an end-user can initiate a peer-to-peer session using user interface (UI) elements of the client application . In other words, by registering an application , a user\/device  can invite other users\/devices  to participate (e.g., accept) in a peer-to-peer session with the registered application  from an invite menu, dialog box, command line, or other user interface. In this example, the messenger platform client  provides a list of registered applications  to a requesting application . Additionally, application  registration allows other applications  to programmatically\/automatically (i.e., with or without user interaction) (a) identify registered application(s) as being peer-to-peer session capable, and (b) initiate a peer-to-peer session with the registered application.","Devices  that are already communicating through respective messenger clients - and - can arrange a peer-to-peer session between various combinations of applications  and\/or  by performing the following operations. Registering the SIAPI application  with the messenger platform client  enables the application to participate in peer-to-peer session invites. Indicating, programmatically or otherwise (e.g., a dialog box, command line, interacting with user interface controls added to the application window responsive to application registration, etc.) by the inviter, the particular registered application  to be used in the session invitation.","Next, programmatically or otherwise (e.g., a dialog box, command line, etc.) the inviter indicates an invitee or device  to receive the session invitation. The potential invitees are provided by the client platform messaging module's  presence information. Next, a session object  is generated at the invitee  by the messenger platform  to manage both inviter and invitee session specific information. For instance, the session object  listens for incoming messages and interprets them to see if they pertain to the given session; if so, then it will send events out to handlers that are listening for events for the given session. To facilitate these actions, the session objects  stores session data ","Session data  includes, for example, inviter and invitee sign-in names, respective inviter and invitee device  network addresses, a download location (e.g., a URL) for the selected application , and other registration data  (e.g., the GUID, etc.). In one implementation, a download location is obtained by the inviter device  from a registry. Hereinafter, session data is often referred to as \u201ccontext data\u201d.","Inviter and the invitee applications  may represent same applications or different applications. For example, the inviter application may be a spreadsheet application and the invitee application may be a work processor application. The various combinations of possible inviter and invitee applications that may engage in a peer-to-peer session via SIAPI  are virtually unlimited in number.","A client  can arrange any number of peer-to-peer sessions, thus there can be any number of session objects  to manage arranged sessions. A new session object  is created each time an invitation  is generated and communicated to another client . TABLE 2 shows an example of how to create a session object\u2014\u201cMsgrSessionManager object\u201d.",{"@attributes":{"id":"p-0041","num":"0040"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Exemplary Session Object Generation"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u2032MsgrSessionManager object."},{"entry":"Public WithEvents MsgrSSM As MessengerPrivate.MsgrSessionManager"},{"entry":"\u2032MsgrSession object."},{"entry":"Public WithEvents MsgrSession As MessengerPrivate.MsgrSession"},{"entry":"\u2032Create the session object."},{"entry":"Set MsgrSession = MsgrSSM.CreateSession"},{"entry":"\u2018Upon creating the session, the State property changes and a"},{"entry":"SessionID property is created. The state property takes the format of"},{"entry":"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX} and can"},{"entry":"be one of multiple possible SESSION_STATE values."},{"entry":"The following refers to the preceding code snippet and demonstrates how"},{"entry":"to access the SessionID and State properties."},{"entry":"\u2032Retrieve the SessionID of the Session object."},{"entry":"MsgBox \u201cSession ID: \u201c & MsgrSession.SessionID"},{"entry":"\u2032Retrieve the State of the Session object."},{"entry":"MsgBox \u201cState: \u201c & MsgrSession. State"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"Peer-to-peer session invitation , which includes the session object , is communicated to the invitee device  via relay server . The specific application  that is going to be involved in the session can, for example, supply portions of invite text displayed at the invitee device . TABLE 3 shows an exemplary set of code to communicate a session invitation  to an invitee device .",{"@attributes":{"id":"p-0043","num":"0042"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 3"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EXAMPLE OF A SESSION INVITE"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Private Sub InviteMember( )"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u20321. Create a context data variable to be used."]},{"entry":[{},"\u20322. Create and assign a value for the sign-in name to a"]},{"entry":[{},"variable."]},{"entry":[{},"\u20323. Create and assign a value for the ServiceID of the"]},{"entry":[{},"user to be invited."]},{"entry":[{},"\u20324. Set the MsgrContact object to the variables created"]},{"entry":[{},"in actions 2 and 3."]},{"entry":[{},"Set MsgrContact = Nothing"]},{"entry":[{},"\u2032Set MsgrContact to the variables created for steps"]},{"entry":[{},"2 and 3."]},{"entry":[{},"Set MsgrContact = MsgrUIA.GetContact(strSigninName,"]},{"entry":[{},"strServiceID)"]},{"entry":[{},"\u2032Set the GUID of the application to be used for the"]},{"entry":[{},"session. For this"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"example, NetMeeting."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"MsgrSession.Application","=","\u201c{44BBA842-CC51-"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"11CF-AAFA-00AA00B6015C}\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2032Invites user to the session with the context data"]},{"entry":[{},"created in step 1."]},{"entry":[{},"MsgrSession.Invite MsgrContact, strContextAppData"]},{"entry":[{},"MsgBox\u2003\u201cSending\u2003NetMeeting\u2003Invitation\u2003to\u2003=\u2003\u201c\u2003&"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CStr(MsgrContact.SigninName)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"End Sub"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"A session invite involves at least two (2) devices , a session inviting or \u201cinviter\u201d device and a device being invited to participate in the session, the invitee device. The intermediate messenger client platform module , which is hosted by the target device, facilitates connection to the application  hosted by the target device. Depending on which application  or  is initiating the session, the target of the session invitation  can be the remote messenger platform - of , or the remote SIAPI enabled application -. For instance, if the peer-to-peer session inviter is the messenger platform -, the invitee is the remote messenger platform -. If the session inviter is the registered SIAPI application -, the invitee is the remote SIAPI enabled application -.","When an application - (or the messenger -) on the invitee requests an invitation to an invitee or contact device -, the messenger - encodes the invitation into a special message  that gets sent to the invitee device -. All other interactions with the session, such as sending new client-application-specific data or canceling the invitation, are also encoded into special messages that are then sent to the invitee device -. The invitee or target of the session invitation  is always remote and depends on what is currently executing on the target device.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 2","b":["108","1","108","2","202","102","112","108","110","104","204","206","108","110","102"]},"For example, messenger clients - and -, which are in communication with one another, can arrange both respective sides of the following peer-to-peer sessions: (a) the messenger platforms - and - as shown by peer-to-peer communication pathway ; and, (b) applications - and - as shown by peer-to-peer communication pathway -this session is arranged via the exposed SIAPI interfaces .","For purposes of this discussion, device - is shown as the inviter device. When an application - (or the messenger -) on the inviter device - requests an invitation to an invitee or contact device -, the inviter's messenger platform - encodes the invitation into a session invite message (e.g. session invite message of ) that gets sent to the invitee device - as one or more electronic files . All other interactions with the session, such as sending new client-application-specific data or canceling the invitation, are also encoded into special messages that are then sent as one or more electronic files  to the invitee device -. The invitee or target of the session invitation  is always remote.","Referring to , responsive to receiving a session invitation, the invitee's messenger platform module generates a local session object  to handle all of the operations to arrange the particular peer-to-peer session, and allows the user\/invitee device to accept or decline the session invitation . Responding to the invitation can be done programmatically or via a dialog box, command line, and so on. For instance, if no client invitee application event handler handles the received invitation, the invitee messenger  will show a message to the end user that can be used by the end user to accept or decline the peer-to-peer session invitation.","If the invitee\/recipient declines or cancels the received session invitation, the response is communicated back to the inviter's application  or  and the requested session is terminated. Otherwise, if the target application is an SIAPI enabled application , the invitee's messenger client platform  confirms that the application  is installed on the invitee's device . If the application  is not installed on the invitee's device , the invitee's messenger client platform  declines the session invitation and launches a Web browser (e.g., Microsoft\u00ae Internet Explorer, Netscape Navigator, or the like) such that it is directed  to a site indicated in the session invite  from which the recipient can download the application .","If the inviter initiated the session with the client device via a registered application , (as compared to through the inviter's messenger platform module ) and the exposed SIAPI , then the inviter application is already executing. Otherwise, the inviter's messenger platform module  initiated the session and thus, launches the inviter application  (if it is not already executing) to communicate corresponding session data  to the invitee. At this point, the application  is running on both inviter and invitee computers  and each application  is aware of the specific parameters needed to communicate in a peer-to-peer session with the other respective application . In this manner, the instant messaging components of system  have arranged peer-to-peer communications between different applications .","Accordingly, SIAPI  allows an application  that is not a messenger platform application to programmatically communicate an invitation through an instant messaging service (a combination of platform application  and relay server ) to arrange into a peer-to-peer session with any other SIAPI enabled application .","An Exemplary Procedure to Exchange Peer-to-Peer Session Information",{"@attributes":{"id":"p-0053","num":"0052"},"figref":["FIG. 3","FIG. 1"],"b":["300","300","100","302","106","108","102","108","112"]},"At block , an SIAPI  enabled application , which is hosted by the first client device , is registered with the messaging service. Such registration may be performed by the application  or by some other application such as by an install program during application  install operations. For purposes of this discussion, the registered application is referred to as the inviter application. At block , the inviter application is selected or launched. This can be accomplished in a number of ways such as via a shortcut, a drop down menu or dialog box provided by a messenger client application , and so on.","At block , the inviter application leverages instant messaging service presence information to select, with or without user intervention, an invitee application . At block , a session invitation  including, for example, the network address of the client device  that is hosting the inviter application, and\/or other data is communicated as one or more electronic files  to a messenger client platform module  executing at an invitee device . Such other data includes, for example, session specific data and registration data . In one implementation, methods of the \u201cIMsgrSession\u201d object of TABLE 1 are used to communicate session invitation(s), acceptance(s), and decline(s) between target platforms.","At block , the inviter determines via respective IMsgrSession based messages whether the invitee has accepted or declined the invitation to engage in a peer-to-peer session with the inviter If the invitation to engage has been declined, the procedure  ends, and the requested peer-to-peer session is not established.","In one implementation discussed in greater detail below in reference , a session non-acceptance response may indicate that the invitee device  is in the process of downloading or attempting to download the session target SIAPI enabled application  from a remote site (e.g., identified via a session data  provided URI). The request to engage in a peer-to-peer session between the inviter and the target application may subsequently be accepted by a messenger platform responsive to successful download of the session target application .","At block , the invitation to engage in the peer-to-peer session has been accepted by the invitee. The inviter messenger platform  determines whether an instance of the SIAPI enabled application  (identified in the context data communicated to the invitee device  (block )) is executing on the inviter device . At block  it has been determined that the target application  is either available but not executing on the inviter device  or presently not loaded on one or more storage media coupled to the inviter device . If the target application  is available, block  operations launch the application. Otherwise, block  operations download, install, and then execute the application .","At block , session context data  is communicated to the executing application  on the inviter device . If the application  was already available and executing on the inviter device , block  of procedure  can be executed at any time immediately before or after the operation of communicating session information to the recipient (block ). A set of exemplary operations to communicate data using an exemplary SIAPI  to arrange a peer-to-peer session are shown above in TABLE 1 and below in reference to APPENDIX A.",{"@attributes":{"id":"p-0060","num":"0059"},"figref":["FIG. 4","FIG. 4","FIG. 3","FIG. 4","FIG. 1"],"b":["300","312","402","418","106","126","108"]},"At block , the invitee device \/messenger client platform  receives a session invitation  to arrange a peer-to-peer session with an indicated application  or . At block , a user of the invitee device  indicates whether the received invitation is accepted (e.g., via a dialog box response, command line, etc.). At block , the session invitation having been declined, the invitee's message platform client  communicates a session invitation declined message as one or more electronic files  to the inviter . At this point, procedure  ends","Otherwise, the session invite message having been accepted by the user, at block , the invitee messenger platform  determines whether the target SIAPI application  is available for execution. An SIAPI application  is available for execution if it is loaded or otherwise stored in non-volatile or volatile RAM comprising the invitee device .","If the target application  is not available, operations of block , communicate a session invite declined response as one or more electronic files  to the inviter device . At block , the invitee messenger platform client  attempts to download the SIAPI application from a network address supplied in the received session invitation (block ). At this point, procedure  ends.","Otherwise, if block  operations determine that the target application  is available, block  operations communicate a session invite acceptance response as one or more electronic files  to the inviter device . The invitee device  launches the available SIAPI application  at block . At block , the invitee device  communicates corresponding session context information (e.g. a combination of some portion of the session data  and the registration data  of ) received in the session invitation  (block ). In this example, the communicated session context information is represented as one or more electronic files .","At this point, respective SIAPI enabled applications  are executing at respective inviter and invitee devices . Each executing application has utilized communicated session context information (e.g., network address data and network protocol information) to configure itself to communicate with the other application  over a corresponding peer-to-peer connection . The peer-to-peer connection  and corresponding application  communications are now functionally independent of the instant messaging service components that initially facilitated configuration of the peer-to-peer communications between the two applications .","Although not shown in , messaging client platform applications  may also utilize presence information of the instant messaging system , of which they both respectively play a part, to engage in peer-to-peer communications with one another independent of the relay server . In this manner, the instant messaging components of system  have arranged peer-to-peer communications between different applications  or between respective instant messaging components  themselves.","An Exemplary Computing Environment",{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 5","b":["500","500","500","500"]},"An exemplary system and procedure using an instant messaging service to arrange a peer-to-peer communication session between networked applications may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc., that perform particular tasks or implement particular abstract data types. An exemplary system and procedure to arrange a peer-to-peer session may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","As shown in , the computing environment  includes a general-purpose computing device in the form of inviter and invitee computing devices . For purposes of this discussion, exemplary aspects of inviter and invitee computing devices are described in reference to the computing device , unless otherwise indicated. Respective inviter and invitee computers  may include some portion or all of the elements and features described herein relative to computer . The components of computer  may include, by are not limited to, one or more processors or processing units , a system memory , and a bus  that couples various system components including the system memory  to the processor .","Bus  represents one or more of any of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, and a processor or local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnects (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer-readable media. Such media may be any available media that is accessible by the computer , and it includes both volatile and non-volatile media, removable and non-removable media. For example, the system memory  includes computer readable media in the form of volatile memory, such as random access memory (RAM) , and\/or non-volatile memory, such as read only memory (ROM) . A basic input\/output system (BIOS) , containing the basic routines that help to transfer information between elements within computer , such as during start-up, is stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently be operated on by processor .","Computer  may further include other removable\/non-removable, volatile\/non-volatile computer storage media. By way of example only,  illustrates a hard disk drive  for reading from and writing to a non-removable, non-volatile magnetic media (not shown and typically called a \u201chard drive\u201d), a magnetic disk drive  for reading from and writing to a removable, non-volatile magnetic disk  (e.g., a \u201cfloppy disk\u201d), and an optical disk drive  for reading from or writing to a removable, non-volatile optical disk  such as a CD-ROM, DVD-ROM or other optical media. The hard disk drive , magnetic disk drive , and optical disk drive  are each connected to bus  by one or more interfaces .","The drives and their associated computer-readable media provide nonvolatile storage of computer readable instructions, data structures, program modules, and other data for computer . Although the exemplary environment described herein employs a hard disk, a removable magnetic disk  and a removable optical disk , it should be appreciated by those skilled in the art that other types of computer readable media which can store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, random access memories (RAMs), read only memories (ROM), and the like, may also be used in the exemplary operating environment.","A number of program modules may be stored on the hard disk, magnetic disk , optical disk , ROM , or RAM , including, by way of example, and not limitation, an OS , one or more application programs , other program modules , and program data . Each such OS , one or more application programs , other program modules , and program data  (or some combination thereof) may include an embodiment of an exemplary system and procedure to arrange peer-to-peer communication sessions.","A user may enter commands and information into computer  through input devices such as keyboard  and pointing device  (such as a \u201cmouse\u201d). Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, serial port, scanner, or the like. These and other input devices are connected to the processing unit  through a user input interface  that is coupled to bus , but may be connected by other interface and bus structures, such as a parallel port, game port, or a universal serial bus (USB).","A monitor  or other type of display device is also connected to bus  via an interface, such as a video adapter . In addition to the monitor, personal computers typically include other peripheral output devices (not shown), such as speakers and printers, which may be connected through output peripheral interface .","Computer  operates in a networked environment using logical connections any number of other remote computers , as well as to a relay server . Logical connections shown in  are a local area network (LAN)  and a general wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet. Remote computer  may include many or all of the elements and features described herein relative to computer .","When used in a LAN networking environment, a computer  is connected to LAN  via network interface or adapter . When used in a WAN networking environment, a computer typically includes a modem  or other means for establishing communications over the WAN . The modem , which may be internal or external, may be connected to the system bus  via the user input interface  or other appropriate mechanism.","Depicted in  is a specific implementation of a WAN via the Internet. Computer  typically includes a modem  or other means for establishing communications over the Internet . Modem , which may be internal or external, is connected to bus  via interface .","In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in a remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on a memory device of remote computer . The network connections shown and described are exemplary and other means of establishing a communications link between the computers may be used.","Computer Readable Media","An implementation of exemplary subject matter using an instant messaging service to arrange a peer-to-peer communication session between networked applications may be stored on or transmitted across some form of computer-readable media. Computer-readable media can be any available media that can be accessed by a computer. By way of example, and not limitation, computer readable media may comprise \u201ccomputer storage media\u201d and \u201ccommunications media.\u201d","\u201cComputer storage media\u201d include volatile and non-volatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules, or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by a computer.","\u201cCommunication media\u201d typically embodies computer readable instructions, data structures, and program modules. Communication media also includes any information delivery media.","The described arrangements and procedures provide an instant messaging service to arrange a peer-to-peer communication session between networked applications. Although the arrangements and systems using an instant messaging service to arrange a peer-to-peer communication session between networked applications have been described in language specific to structural features and methodological operations, it is to be understood that the arrangements and procedures as defined the appended claims are not necessarily limited to the specific features or operations described. Rather, the specific features and operations are disclosed as preferred forms of implementing the claimed subject matter. \n\n\n\n\n\n"],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The same numbers are used throughout the drawings to reference like features and components.",{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 4","FIG. 3","FIG. 4"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5","b":"500"}]},"DETDESC":[{},{}]}
