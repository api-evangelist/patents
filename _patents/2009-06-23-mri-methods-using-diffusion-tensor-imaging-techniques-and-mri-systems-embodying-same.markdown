---
title: MRI methods using diffusion tensor imaging techniques and MRI systems embodying same
abstract: Featured is a method for automatically evaluating acquired MRI data, determining the quality of the acquired images and removing the image data when it is determined that an image is corrupted so the imaged data for the corrupted image is removed from the subsequent tensor fitting. In further embodiments, such determining includes judging the quality of the image data to determine if the image data satisfies a quality threshold criteria and if determined not to be satisfied adjudging the image to be corrupted. Such methods include performing said evaluating, determining and removing in real time and in the case where an image is determined to be corrupted, such methods further includes re-acquiring additional image data corresponding to each of the one or more images removed as being corrupted. Also featured are MRI systems embodying such methods.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08577112&OS=08577112&RS=08577112
owner: The John Hopkins University
number: 08577112
owner_city: Baltimore
owner_country: US
publication_date: 20090623
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a continuation in part of co-pending PCT Application No. PCT\/US2007\/026321, filed Dec. 26, 2007, which application claims the benefit of U.S. Provisional Application Ser. No. 60\/877,311 filed Dec. 27, 2006, the teachings of all being incorporated herein by reference.","The present invention was supported by grants from the National Institute of Health, grant number RR015241. The U.S. Government may have certain rights to the present invention.","The present invention relates to a methods of magnetic resonance imaging and more particularly to magnetic resonance imaging using diffusion tensor imaging techniques. The present invention also relates to computer readable mediums and MRI systems with applications programs embodying such methods.","Diffusion tensor imaging (DTI) is a relatively new modality in Magnetic Resonance Imaging (MRI). The DTI Magnetic Resonance Imaging (DTI-MRI) technique is used because of the capability to depict white matter tracts and for its sensitivity to micro-structural and architectural features of brain tissue. As such, because of the ability of DTI-MRI to delineate detailed anatomy of the white matter, it is becoming a widely-used imaging method in research and clinical studies.","According to this method, diffusion constant of water molecules are measured along multiple orientations. If the imaged sample has ordered anatomical structures, such as axonal bundles in the brain, water tends to diffuse along such structures. Consequently, results of diffusion constant measurements of the brain are not the same depending on the orientations of the measurements. This is called anisotropic diffusion. The extent of the anisotropy and the orientation of the largest diffusion constant, assuming that it represent the orientations of the axonal bundles, carry unique anatomical information, which has not been accessible by conventional MRI.","In the conventional DTI-MRI method, diffusion tensor maps are typically computed by fitting the signal intensities from diffusion weighted images as a function of their corresponding b-matrices [Mattiello J, Basser P J, Le Bihan D. The b matrix in diffusion tensor echo-planar imaging. Magn Reson Med 1997; 37:292-300] according to the multivariate least-squares regression model proposed by Basser et al. [Basser P J, Mattiello J, LeBihan D. Estimation of the effective self-diffusion tensor from the NMR spin echo. J Magn Reson B 1994; 103: 247-254]. The least-squares (LS) regression model takes into account the signal variability produced by thermal noise by including the assumed signal variance as a weighting factor in the tensor fitting.","While it is a highly useful MRI technique to investigate normal and abnormal brain anatomy, it has several drawbacks. Signal variability in diffusion weighted imaging (DWI) is influenced not only by thermal noise but also by spatially and temporally varying artifacts. Such artifacts originate from the so called \u201cphysiologic noise\u201d such as subject motion and cardiac pulsation, as well as from acquisition-related factors such as system instabilities. The multivariate least-squares regression model assumes that the signal variability in the DWI is affected only by thermal noise and does not account for signal perturbations and potential outliers that originate from artifacts. While the signal variability produced by thermal noise is approximately Gaussian distributed [Henkelman R M. Measurement of signal intensities in the presence of noise in MR images. Med Phys 1985; 12:232-233], signal variability produced by physiologic noise and other artifacts does not have a known parametric distribution and thus currently cannot be modeled.","For example, one of the most significant issues is the technique's sensitivity to tissue motion. Because water molecules moves 5-10 \u03bcm during the measurement and the image contrast is sensitized to such a small motion, the image could be easily corrupted by even a small amount of brain motion, such as cardiac pulsation. To ameliorate this issue, single-shot rapid imaging is usually used for DTI-MRI data acquisition. However, even with such rapid imaging, it is very common that the dataset contains several corrupted images such as that shown in, for example, .","In the DTI technique only 7 images (one non-diffusion weighted image and six different diffusion weighting orientations) are required to perform the diffusion tensor fitting. However, to enhance signal-to-noise ratio (SNR) one acquires raw images far more than necessary; for the tensor fitting, typically on the order of 12-90 images are acquired by repeating the six different diffusion weighted imaging conditions or by acquiring diffusion weighted images with more than six different weighting orientations.","A couple of techniques or schemes have been described which use or apply a routine fitting outlier detection scheme to DTI-MRI. These techniques have been described as the use of \u201crobust\u201d estimators, which are less sensitive to the presence of outliers. One robust tensor estimation approach, as proposed by Mangin et al. [Mangin J F, Poupon C, Clark C, Le Bihan D, Bloch I. Distortion correction and robust tensor estimation for MR diffusion imaging. Med Image Anal 2002; 6:191-198], is based on the well-known Geman-McClure M-estimator [Geman S, McClure D E. Statistical methods for tomographic image reconstruction. Bull Int Stat Inst 1987; 52:5-21]. Mangin's approach is referred to herein as GMM. This approach uses an iteratively re-weighted least-squares fitting in which the weight of each data point is set to a function of the residuals of the previous iteration. The GMM method ensures that potentially artifactual data points having large residuals are given lower weights in the estimation of the tensor parameters. Clearly, this approach is statistically more robust than the standard least squares methods in the presence of outliers. However, by using the residuals as the only determinants of the weights, it discards the information contained in the known distribution of errors related to thermal noise.","The other technique or \u201crobust\u201d estimator for robust diffusion tensor estimation, referred to as RESTORE (for robust estimation of tensors by outlier rejection) uses iteratively re-weighted least-squares regression to identify potential outliers and subsequently exclude them. Results from both simulated and clinical diffusion data sets indicate that the RESTORE method improves tensor estimation compared to the commonly used linear and nonlinear least-squares tensor fitting methods and a recently proposed method based on the Geman-McClure M-estimator. The RESTORE method could potentially remove the need for cardiac gating in DWI acquisitions and should be applicable to other MR imaging techniques that use univariate or multivariate regression to fit MRI data to a model [Lin-Ching Chang, Derek K. Jones, and Carlo Pierpaoli, \u201cRESTORE: Robust Estimation of Tensors by Outlier Rejection\u201d, Magn. Reson. Med. 53: 1088-1095 (2005)].","As is known to those skilled in the art, MRI data of a volume is usually acquired by essentially dividing the volume into a plurality of slices and performing 2-D imaging in each slice. When performing DTI-MRI, one would acquire one non-diffusion image and the 6 or more diffusion weighted images for each slice, where one slice of MR images typically consists of 64\u00d764\u02dc256\u00d7256 pixels. The tensor fitting is performed for every pixel independently and in the RESTORE technique, the handling of outliers, is done for each pixel separately as well. In other words, in RESTORE one estimates the tensor in the presence of data and does not attempt to eliminate corrupted images. As can from a comparison of the corrupted and uncorrupted images of  and B, when an image is corrupted the corruption for example by tissue motion does not affect the image each pixel independently but rather there are clusters of pixels that that loose or gain abnormal pixel intensity. This is simply because tissue motion happens independent of the pixel size.","There also is a manual technique in which every image that is acquired is visually inspected by a clinician or person knowledgeable in interpreting the particular anatomical images to determine if any of the images display corruption. If corruption of an image is detected, the clinician can exclude the acquired image from being used further in the DTI-MRI process. Needless to say the visual inspection process is time consuming and subject to error given the large number of images that would have to be evaluated when SNR is taken into consideration. For example, if the volume was divided into 50 slices and 60 diffusion weighted images where acquired for each slice, then about 3000 (50\u00d760) images would be acquired and evaluated. There presently is no existing technique by which corrupted images are detected other than by such a manual visual inspection process.","It thus would be desirable to provide methods and MRI systems that automatically evaluate the quality of the acquired raw images and remove corrupted images from the subsequent tensor fitting. It also would be particularly desirable to provide such methods and MRI systems that would allow such an evaluation to be performed post acquisition of image data and\/or during the image data acquisition process (i.e., essentially in real time). It also would be particularly desirable to provide such methods and MRI systems that would allow the image acquisition process to acquire additional image data to replace image data that is determined to be corrupted by such an evaluation. It also would be particularly desirable to provide MRI systems that embody computer applications programs or computer implemented methods that embody such methods that automatically evaluate the quality of the acquired raw images and remove corrupted images from the subsequent tensor fitting. It also would be desirable to provide such methods and MRI systems that would not require users having greater skills or abilities than those who routinely perform MRI processed and operate magnetic resonance imaging apparatuses and systems.","The present invention features a method for automatically evaluating acquired MRI data and determining the quality of the acquired images and for removing the image data for corrupted images from the subsequent tensor fitting based on such evaluating and determining.","In further embodiments, such evaluating includes performing LMSE tensor estimation, DWI fitting, residual error mapping and creation of quality maps.","In further embodiments, such determining includes judging the quality of the image data to determine if the image data satisfies a quality threshold criteria and if determined not to be satisfied, adjudging the image to be corrupted. Such methods also include generating a tensor map if it is adjudged and determined that all of the image data satisfies a quality threshold criteria. In further embodiments, such methods include generating a tensor map from the image data of the images remaining after said determining and adjudging.","Such methods include performing said evaluating, determining and removing in real time and in the case where an image is determined to be corrupted, such methods further includes re-acquiring additional image data corresponding to each of the one or more images removed as being corrupted. In this way, the imaging process can respond to a decision to remove an image as being corrupted and acquire additional image data corresponding to a particular image that was removed as being corrupted. In other words, the medical personnel operating the MRI scanner can appropriately configure the MRI scanner to acquire the image data corresponding to a particular image that was removed as being corrupted (i.e., scanner does not have to be configured to re-acquire all the image data all over).","Also featured are MRI scanning systems or MRI systems that embody such methods as well as featuring applications programs for implementing such methods. Also such applications programs can include instructions and criteria as well as code segments for implementing such methods so that such systems are operated or controlled to acquire image data for images determined to be corrupted and removed for purposes of creating a tensor map.","The above-described methods and systems differ from the prior art in that the evaluation for corrupted images is done on an image-by-image basis, whereas the prior art attempts such an evaluation on a pixel by pixel basis. When an image is corrupted, it does not affect the image of each pixel independently. Instead, there should be a cluster of pixels that loose or gain abnormal pixel intensity, because tissue motion happens independent of the pixel size. In the present invention while tensor fitting is performed on a pixel-by-pixel basis, the evaluation of the corruption of the acquired image data is done on an image-by-image basis. This method to perform the image quality assurance is an entirely new approach from the pixel by pixel approach of the prior art as described herein.","In the above-described methods and systems detection is based on identification of outliers in the tensor fitting. While this approach works for many cases, it is possible that the above-described method may not detect outliers when there are more than a certain number of outliers, which could lead the fitting to start to deviate from the real value. According to another aspect\/embodiment, the present invention features another technique that is not based on the fitting results.","In this aspect\/embodiment, the technique utilizes the continuity or discontinuity of image intensity. In DTI, each imaging slice is acquired independently and the image corruption occurs independent of adjacent image slices. An erroneous signal intensity in one slice causes through-slice intensity \u201cdiscontinuity\u201d (hereafter interslice intensity discontinuity). In this technique, this discontinuity is quantified and used as one of the parameters to judge corrupted pixels and images. This approach works in a pixel-by-pixel basis but similar to the above-described methodology, clustering can be performed to remove the corrupted pixels or images.","In the present invention, the quality of the raw images is automatically evaluated and corrupted images are removed (automatically removed) from the subsequent tensor fitting. Currently, this type of image quality assurance is not performed in conventional DTI-MRI techniques. The present invention is expected to dramatically improve the quality assurance of DTI-MRI. This method of the present invention is applied to acquired images to improve the quality of the tensor fitting, but it also is within the scope of the present invention to integrate the methodology of the present invention with an MRI scanner or scanning system to perform real-time image quality assurance.","Other aspects and embodiments of the invention are discussed below.","The instant invention is most clearly understood with reference to the following definitions:","A computer readable medium shall be understood to mean any article of manufacture that contains data that can be read by a computer or a carrier wave signal carrying data that can be read by a computer. Such computer readable media includes but is not limited to magnetic media, such as a floppy disk, a flexible disk, a hard disk, reel-to-reel tape, cartridge tape, cassette tape or cards; optical media such as CD-ROM and writeable compact disc; magneto-optical media in disc, tape or card form; paper media, such as punched cards and paper tape; or on carrier wave signal received through a network, wireless network or modem, including radio-frequency signals and infrared signals.","DTI-MRI shall be understood to mean a diffusion-weighted tensor magnetic resonance image technique or a diffusion-weighted tensor imaging magnetic resonance image technique.","DWI shall be understood to mean diffusion weighted image and DWIs shall be understood to mean diffusion weighted images.","Interslice intensity discontinuity shall be understood to be describing the case where an erroneous signal intensity in one slice causes a discontinuity in through-slice intensity.","LMSE shall be understood to mean a least square mean error fitting technique.","The present invention is directed to a method that evaluates the quality of raw images acquired for diffusion tensor imaging (DTI). Because of the high sensitivity of the raw images to subject motion, one or more of the large number of raw images that are typically acquired, are often corrupted. Currently, such corrupted images are used for the subsequent tensor fitting, leading to severe artifacts such as that shown in . As described herein, there are techniques used that in effect attempt to eliminate the effect of an outliers of the corruption numerically. If corrupted images are removed from the subsequent fitting calculation, however, then the DTI images can be corrected as is shown in . The present invention also is directed to MRI scanning systems that embody such a methodology, particularly so that such an evaluation can be performed in real time and not be limited to post data acquisition processing.","Such methods and systems are such as to automatically detect corrupted images in raw images (diffusion-weighted images). It also is desirable for the method to yield a report as to the frequency and mode of corrupted images. When a detection of a corrupted image(s) occurs, the method of the present invention also automatically removes the corrupted image(s) from the tensor fitting calculation so as to thereby also correct the resultant corruption-affected DTI images. When the methodology and detection scheme of the present invention is implemented in an MRI scanner, such scanners also can perform real-time monitoring of image quality. This real time monitoring can provide a mechanism during the MRI data acquisition process to identify the need to perform additional scanning so as to in effect reacquire image data corresponding to the removed corrupted image set(s).","Referring now to the various figures of the drawing wherein like reference characters refer to like parts, there is shown in , B flow charts illustrating methodologies of the present invention. The flow charts herein illustrate the structure of the logic of the present invention as embodied in computer program software for execution on a computer, digital processor or microprocessor. Those skilled in the art will appreciate that the flow charts illustrate the structures of the computer program code elements, including logic circuits on an integrated circuit, that function according to the present invention. As such, the present invention is practiced in its essential embodiment(s) by a machine component that renders the program code elements in a form that instructs a digital processing apparatus (e.g., computer) to perform a sequence of function step(s) corresponding to those shown in the flow diagrams.","Either methodology of the present invention is applied to data for diffusion tensor imaging (DTI), which typically consists of acquiring non-diffusion-weighted images (b0 images) and diffusion-weighted images (DWIs), Step . As is known in the art, MRI image data for a volume can be acquired by in effect dividing the volume into two-dimensional slices, acquiring image data for the two dimensional slice and combining the image data of the slices to create the three-dimensional image representative of the volume. As such, there would be non-diffusion-weighted images (b0 images) and diffusion-weighted images (DWIs) for each slice.","As is known to those skilled in the art, at least 6 DWIs are needed to compute a tensor at each pixel. Typically, 12-90 DWIs with various diffusion encoding orientations are acquired for purposes of enhancing signal-to-noise ratio (SNR). As image data acquired may be excluded during such processing as being corrupted, the number of DWIs acquired also might be increased to limit the effect that the elimination of corrupted images would have on SNR.","All the data (b0s and DWIs) are used for pixel-by-pixel tensor calculation, which yields 3\u00d73 diffusion tensor at each pixel. Multi-variate linear least-square fitting is widely used, although non-linear fitting can also be used. For example, diffusion tensor can be calculated using;",{"@attributes":{"id":"p-0046","num":"0045"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"ln","mo":"\u2061","mrow":{"mo":["[","]"],"mfrac":{"mi":"S","msub":{"mi":"S","mn":"0"}}}},{"mo":"-","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"t"},"mo":"\u2062","mrow":{"mrow":[{"mrow":[{"msup":{"mi":"\u03b3","mn":"2"},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msubsup":{"mo":"\u222b","mn":"0","msup":{"mi":["t","\u2032"]}},"mo":"\u2062","mrow":{"mover":{"mrow":{"mi":"G","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":["t","\u2033"]}}},"mi":"_"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mo":"\u2146","mi":"t"}}}}},{"mo":["[","]"],"mrow":{"msubsup":{"mo":"\u222b","mn":"0","msup":{"mi":["t","\u2032"]}},"mo":"\u2062","mrow":{"mover":{"mrow":{"mi":"G","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":["t","\u2033"]}}},"mi":"_"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mo":"\u2146","msup":{"mi":["t","\u2033"]}}}}}],"mo":["\u00b7","\u00b7"],"mover":{"mi":"D","mo":"="}},{"mo":"\u2146","msup":{"mi":["t","\u2032"]}}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}}],"mo":"="}}}},"However, the invention is applicable to any form of diffusion-weighted images with or without the above mentioned tensor calculation.","Referring now to , residual error maps are calculated using for example the following calculations\/calculational process (Steps -).","First, the b-matrix was computed from known diffusion orientation vectors g=(g, g, g) (k=1 . . . K, |g|=1),",{"@attributes":{"id":"p-0050","num":"0049"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"bMatrix","mo":"=","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"msubsup":{"mi":"g","mrow":{"mn":"1","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"x"},"mn":"2"}},{"msubsup":{"mi":"g","mrow":{"mn":"1","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"y"},"mn":"2"}},{"msubsup":{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"z"},"mn":"2"}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"x"}},{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"y"}}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"x"}},{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"z"}}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"y"}},{"mi":"g","mrow":{"mn":"1","mo":"\u2062","mi":"z"}}]}}]},{"mtd":[{"msubsup":{"mi":"g","mrow":{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"x"},"mn":"2"}},{"msubsup":{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"y"},"mn":"2"}},{"msubsup":{"mi":"g","mrow":{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"z"},"mn":"2"}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"x"}},{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"y"}}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"x"}},{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"z"}}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"y"}},{"mi":"g","mrow":{"mn":"2","mo":"\u2062","mi":"z"}}]}}]},{"mtd":[{"mi":"\u2026"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"\u2026"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"\u2026"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"msubsup":{"mi":["g","Kx"],"mn":"2"}},{"msubsup":{"mi":["g","Ky"],"mn":"2"}},{"msubsup":{"mi":["g","Kz"],"mn":"2"}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":["g","kx"]},{"mi":["g","Ky"]}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":["g","Kx"]},{"mi":["g","Kz"]}]}},{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"msub":[{"mi":["g","Ky"]},{"mi":["g","Kz"]}]}}]}]}}}}}},"Second, the LSME method was implemented on the over-determined linear equations for the diffusion tensor estimation by:",{"@attributes":{"id":"p-0052","num":"0051"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":["D","xx"]}}},{"mtd":{"msub":{"mi":["D","yy"]}}},{"mtd":{"msub":{"mi":["D","zz"]}}},{"mtd":{"msub":{"mi":["D","xy"]}}},{"mtd":{"msub":{"mi":["D","xz"]}}},{"mtd":{"msub":{"mi":["D","yz"]}}}]}},{"msup":{"mi":"bMatrix","mo":"+"},"mo":"\u2061","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":"ADC","mn":"1"}}},{"mtd":{"msub":{"mi":"ADC","mn":"2"}}},{"mtd":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},{"mtd":{"mi":"\u2026"}},{"mtd":{"mi":"\u2026"}},{"mtd":{"msub":{"mi":["ADC","K"]}}}]}}}],"mo":"="}}}},"Where, D, D, D, Dand D, are 6 independent components of the tensor matrix, bMatrix is the pseudo-inverse of the b-matrix, and ADC(k=1 . . . K) is the apparent diffusion constant derived from the DWIs.","Before the tensor estimation, if multiple repetition was employed, the standard derivation of multiple-repetition scanning will be calculated for the purpose of image quality judgment later.","Next, the DWI-fitting procedure was performed using the estimated tensor and b-matrix by following equation:",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":"fDWI","mn":"1"}}},{"mtd":{"msub":{"mi":"fDWI","mn":"2"}}},{"mtd":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},{"mtd":{"mi":"\u2026"}},{"mtd":{"mi":"\u2026"}},{"mtd":{"msub":{"mi":["fDWI","K"]}}}]}},{"mi":"bMatrix","mo":"\u2061","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":["D","xx"]}}},{"mtd":{"msub":{"mi":["D","yy"]}}},{"mtd":{"msub":{"mi":["D","zz"]}}},{"mtd":{"msub":{"mi":["D","xy"]}}},{"mtd":{"msub":{"mi":["D","xz"]}}},{"mtd":{"msub":{"mi":["D","yz"]}}}]}}}],"mo":"="}}}},"Where, fDWI stands for fitted-DWI.","The results of this fitting step were then subtracted against the original DWIs over all pixels of each slice, resulting in so called error maps.","After the error maps are created, there are several ways to create \u201cQuality maps\u201d Step , with which image quality can be judged by simple thresholds. This quality map can be a single scalar map or multiple maps with multiple thresholds. For example, the following procedures can be used separately or combined.","Clustering Analysis with Autocorrelation:","Let I(i,j) be the intensity of the error-map at the point (i,j), if the error-map has mean value \u03bc and standard derivation \u03c3 then the definition of n-lag auto-correlation is:",{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"AutoCorr","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"n"}},"mo":"=","mfrac":{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mo":["(",")"],"mrow":{"mrow":{"mi":"I","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["i","j"],"mo":","}}},"mo":"-","mi":"\u03bc"}},{"mo":["(",")"],"mrow":{"mrow":{"mi":"I","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["i","n"],"mo":"\u00b1"},{"mi":["j","n"],"mo":"+"}],"mo":","}}},"mo":"-","mi":"\u03bc"}}],"mo":"\u2062"}}},"msup":{"mi":"\u03c3","mn":"2"}}}}},"br":{}},"The outlier is supposed to have higher coefficient values due to the residuals error clustering caused by the corruption. In this way, an image quality criterion is defined according to the statistics of the auto-correlation functions over all error-maps to judge the outliers. For example, let \u03bcand \u03c3be the mean value and standard derivation of AutoCorr(.) over all error-maps, and Threshold a pre-defined threshold value,\n\nIf(AutoCorr()\u2212\u03bc)>(Threshold*\u03c3)\n\nCreation of Standard Deviation Maps of the Error Maps:\n","A standard deviation map can be calculated from the error maps (Stdev(Error map)). For example, if there are 12 DWIs, there will be 12 error maps. If one of the DWIs is corrupted, there should be areas with very high standard deviation. A normalized Stdev(Error map) can be calculated;\n\nNormalized Stdev(Error map)=Stdev(Error map)\/Error map\n","By applying a threshold, for example, 10%, a binary mask of outlier pixels can be generated. This map can be fed into the cluster analysis described above.","Creation of Difference or Standard Deviation Maps of Repeated Measurements","If there are repeated datasets, various quality maps can be generated by using the fact that the repeated measurements should be identical. For example, difference (two repetitions) or standard deviation (more than 3 repetitions) can be generated, in which image corruption can be clearly identified because of its non-reproducible nature.","After the quality maps are generated and thresholds are set, all DWIs are evaluated to adjudge the quality of the images that were acquired, Step . The DWIs are evaluated either by absolute criteria (e.g., rejected if there are bad pixels more than thresholds) or by relative criteria (e.g., sort the DWIs and reject the worst one). If as a result of the evaluation it is determined that all of the DWIs are acceptable (Yes, Step ), the tensor fitting is performed iteratively and a tensor map is generated, Step .","If as a result of the evaluation it is determined that one or more of the DWIs or pixels being evaluated are not acceptable and thus, considered to be a corrupted DWI (No, Step ), then each of the one or more rejected DWI(s) or pixel(s) is identified, Step  and the identified DWI(s) or pixel(s) is removed, Step . As such removal, the imaged data corresponding to the rejected DWI or pixel can be deleted, or flagged as not to be used, or otherwise prevented from being used in the tensor fitting procedure using any of a number of techniques known to those skilled in the art.","According to further embodiment of the present invention, after removing the corrupted image or DWI (Step ), a decision is made to determine if more image data or DWI(s) should be acquired to replace each specific DWI(s) that was removed because it had been determined to be corrupted, Step . If the decision is to reacquire additional image data for a given removed DWI, then raw data for the specific DWI(s) is acquired, Step . In other words, the MRI scanner is configured to establish the same conditions (e.g., same gradient fields) that were present when the image data was acquired for each of the removed DWIs. After acquiring the image data (Step ), or after deciding that image data is not to be acquired (No, Step ) or after removing the corrupted image(s) if the process does not include steps -, the process returns to Step  and the process continues until a favorable decision is reached in step .","Referring now to , there is shown another methodology of the present invention that is applied to data for diffusion tensor imaging (DTI). Reference should be made to the discussion above for details of the method step(s) that are commonly numbered with  that is\/are not otherwise discussed below. As indicated above, such a methodology typically consists of acquiring non-diffusion-weighted images (b0 images) and diffusion-weighted images (DWIs), Step . In this methodology the residual error map(s) are calculated using for example the following process of assessing interslice intensity discontinuity (Step ), tensor fitting (Step ) and residual error mapping (Step ) in which interslice intensity discontinuity is incorporated in the tensor fitting. The fitting routine for such tensor fitting can be any of a number of routines known to those skilled in the art or hereinafter developed and include for example a simple tensor fitting routine such as linear fitting as well as robust fitting.","For the judgment of the intensity discontinuity, there are several ways for quantification. For example, simple subtraction between the adjacent slices could detect large discontinuity. Another effective way is to create an average DWI from all DWIs, which serves as a reference image and subtract individual DWIs. These images can be served as the error map in . Here we also demonstrate a more sophisticated approach. For each DWI image which includes multislice 2D slices (referred to herein as I), a nonlinear interpolation of the intensity through the slices is performed to remove sudden intensity changes between slices. The interpolated image is referred to herein I. The difference of interpolated and original image (referred to herein as I) is called the intensity discontinuity map of I. To eliminate the intensity discontinuity caused by real (non-artifact) anatomical changes between slices, the I is further abstracted from a reference image (referred to herein as Ir), where Ir is the intensity discontinuity map of non-diffusion-weighted image (referred to herein as b0 image). This intensity discontinuity map of non-diffusion-weighted image is not sensitive to subject motions as much as the DWIs.","The Ir image is generated in the same way as the generation of I except the input is b0 not DWI. A corrected intensity discontinuity map (referred to herein as I) is created using the following relationship I=|I\u2212Ir|. The value at each pixel of the corrected intensity discontinuity map is used in the tensor estimation or fitting procedure as a weighting factor. For example, the formula of the fitting\n\n\u03c1(\u03b5)=\u03b5\/(\u03b5)\n\nas provided in Mangin et al. [Mangin J F, Poupon C, Clark C, Le Bihan D, Bloch I. Distortion correction and robust tensor estimation for MR diffusion imaging. Med Image Anal 2002; 6:191-198] is modified to be\n\n\u03c1(\u03b5)=\u03b5\/((()+1)(\u03b5))\n\nwhere a is a preset normalization factor, Iis the value of the corrected intensity discontinuity map value of the ith diffusion gradient. Thereafter, the estimated DWI is subtracted from the original DWI to generate an error map (Step ).\n","A thresholding method is used to detect the points with large error and thus generate a binary mask. The connected components in the mask are evaluated to determine if the area of the connected components is greater than a preset threshold (Step ). Alternatively, the DWIs are evaluated either by absolute criteria (e.g., rejected if there are bad pixels more than thresholds) or by relative criteria (e.g., sort the DWIs and reject the worst one). If as a result of the evaluation it is determined that all of the DWIs are acceptable (Yes, Step ), the tensor fitting is performed iteratively and a tensor map is generated, Step .","If as a result of the evaluation it is determined that one or more of the DWIs or pixels being evaluated are not acceptable and thus, considered to be a corrupted DWI (No, Step ), then each of the one or more rejected DWI(s) is identified, Step  and the identified DWI(s) or pixel(s) is\/are removed, Step . As indicated above, the imaged data corresponding to the rejected DWI or pixels can be deleted, or flagged as not to be used, or otherwise prevented from being used in the tensor fitting procedure.","In further embodiments, after removing the corrupted image or DWI (Step ), a decision is made to determine if more image data or DWI(s) should be acquired to replace each specific DWI(s) that was removed because it had been determined to be corrupted, Step . If the decision is to reacquire additional image data for a given removed DWI, then raw data for the specific DWI(s) is acquired, Step . After acquiring the image data (Step ), or after deciding that image data is not to be acquired (No, Step ) or after removing the corrupted image(s) if the process does not include steps -, the process returns to Step  and the process continues until a favorable decision is reached in step .","Referring now to , there is shown a schematic view of an exemplary scanning system  including an assembly  including among other things the main magnet, gradient coils, detection coil(s) and related receivers, and excitation RF transmitter all of which cooperate to create the conditions necessary for acquiring magnetic resonance signals from the object, patient or person being imaged. Typically, the object, patient or person to be imaged is placed on a table, bed  or other structure that is moved into the area of effect of the main and gradient magnets when MRI data is to be acquired and removed therefrom for example upon completion of data acquisition.","The assembly  is operably coupled to the host computer  on which an applications program(s) is stored or loaded for execution on the host computer . The applications program(s) controls operation of the gradient coils, RF transmitter and detection receivers for acquisition of data and controls processing of acquired data, where applicable. Also operably and communicatively coupled to the host computer  are a display  (e.g., CRT, LCD) and one or more input devices  (e.g., keyboard. mouse).","In further embodiments of the present invention, an applications program is provided for execution on the host computer  for processing acquired DWI data. Such an applications program includes instructions and criteria as well as code segments for processing the DWI data as described herein to automatically evaluate and assess the acquired DWIs to determine if any of the acquired DWIs are corrupted and to provide an output, for example to the operator of the scanning system , identifying the corrupted DWI(s). In addition, the applications program further includes instructions to remove the corrupted DWI(s).","In further embodiments, the applications program includes instructions and criteria for also positing an inquiry to the system operator whether to perform additional scans at the conditions under which image data had been previously acquired for the corrupted DWI(s), in other words whether to acquire image data under these conditions. In response to an affirmative response, the applications program further includes instructions and criteria to cause such additional scans to be performed and to acquire additional image data. In yet further embodiments, the applications program also would again evaluate and assess the additionally acquired DWI(s) to determine if any of the additional acquired DWI(s) was corrupted, essentially repeating the process described above. In alternate embodiments, the applications program further includes instructions and criteria for causing such performing of additional scans, acquiring additional image data and such evaluating and assessing to be performed automatically.","Introduction:","Diffusion tensor imaging (DTI) and DTI-based axonal mapping are used increasingly as important tools in clinical research for their ability to study brain white matter anatomy and abnormalities. Diffusion tensor maps are typically calculated by the least square mean error (LSME) fitting of signal intensities from diffusion weighted images as a function of the corresponding b-matrices derived for the diffusion orientation vectors. In practice, diffusion weighted images (DWIs) are usually influenced by both thermal acquisition noise and varying artifacts. The LSME fitting takes into account the thermal noise which is assumed additive and is modeled approximately by a zero-mean Gaussian distribution. However, the signal variability is influenced not only by thermal noise but also by varying artifacts such as temporally and spatially subject motions and cardiac pulsations which do not follow Gaussian distributions. Noisy DWIs can cause the estimated diffusion tensor to be erroneous. In this example, we introduced the feedback theory into tensor fitting procedure and proposed a novel approach to improve the robustness of the tensor estimation by automatic outlier rejection.","Methods:","An algorithm embodying the methodology of the present invention was implemented on a computer and MRI image data including image data obtained using a DTI-MRI technique was processed using such an algorithm and the acquired image data. In particular, the algorithm was implemented on a Windows platform with a user-friendly interface and had been incorporated into our in-house program DTI-Studio. In accordance with the computer implemented algorithm\/method the following steps were performed.","First, the b-matrix was computed from known diffusion orientation vectors. Second, the LSME method was implemented on the over-determined linear equations for the diffusion tensor estimation. Next, the DWI-fitting procedure was performed using the estimated tensor and b-matrix. The results of this fitting step were then subtracted against the original DWIs over all pixels of each slice, resulting in so called error-maps.","Afterwards, the goodness-of-fitting was evaluated based on the statistic measurements of the error-maps. Auto-correlation coefficients were used as the measurements for this evaluation. Outliers are supposed to have higher coefficient values due to the residuals error caused by varying artifacts. If the goodness of fitting criterion was not satisfied, the outliers were identified and the iterative tensor estimating process was launched again after the outliers were excluded.","The whole procedure continued iteratively until the goodness criterion was satisfied or reached a pre-defined maximum iteration number.","Results and Discussion:","There is shown in , a screen shot of the program in action. The outlier being diagnosed in the first iteration is crossed out with an X in this example.","Artifacts are common in clinical DWIs due to the intrinsic low resolution and related imaged distortions of the image acquisition techniques. Of these, the subject motion when scanning uncooperative patients and residual error from cardiac pulsation are the dominant sources of the observed motion-related artifacts. These artifacts do not follow Gaussian distributions. When no corrupted data were included, all fitting methods showed similar results. In the presence of outliers, especially those orienting from non-Gaussian temporally varying artifacts, the computer implemented algorithm\/method embodying the methodology of the present invention proved to be a good approach to improve the accuracy of the estimated tensor with respect to the commonly used fitting methods. It also was noted that the computation time was not increased significantly as compared with the linear LS methods that we used before.","Despite the good performance of the algorithm, this approach or method relies on data redundancy. Thus, to avoid problems from arising, the original dataset should have enough orientations or repetitions to correctly identify and exclude the outliers. The number of good data can be also an influence factor on the performance of the algorithm.","Although a preferred embodiment of the invention has been described using specific terms, such description is for illustrative purposes only, and it is to be understood that changes and variations may be made without departing from the spirit or scope of the following claims.","All patents, published patent applications and other references disclosed herein are hereby expressly incorporated by reference in their entireties by reference.","Those skilled in the art will recognize, or be able to ascertain using no more than routine experimentation, many equivalents of the specific embodiments of the invention described herein. Such equivalents are intended to be encompassed by the following claims."],"GOVINT":[{},{}],"heading":["STATEMENT REGARDING FEDERALLY-SPONSORED RESEARCH","FIELD OF INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DEFINITIONS","DESCRIPTION OF THE PREFERRED EMBODIMENT","EXAMPLE","INCORPORATION BY REFERENCE","EQUIVALENTS"],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWING","p":["For a fuller understanding of the nature and desired objects of the present invention, reference is made to the following detailed description taken in conjunction with the accompanying drawing figures wherein like reference character denote corresponding parts throughout the several views and wherein:","FIGS. A,B are illustrations of a corrupted image () and an uncorrupted image ();",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 2B","FIG. 2A"]},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3A"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
