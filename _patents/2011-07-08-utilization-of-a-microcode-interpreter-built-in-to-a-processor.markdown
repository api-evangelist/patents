---
title: Utilization of a microcode interpreter built in to a processor
abstract: Augmented processor hardware contains a microcode interpreter. When encrypted microcode is included in a message from a service, the microcode may be passed to the microcode interpreter. Based on decryption and execution of the microcode taking place at the processor hardware, extended functionality may be realized.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09032186&OS=09032186&RS=09032186
owner: BlackBerry Limited
number: 09032186
owner_city: Waterloo
owner_country: CA
publication_date: 20110708
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","FIELD","BACKGROUND","DETAILED DESCRIPTION"],"p":["The present application claims priority to U.S. Provisional Patent Application 61\/362,814, filed Jul. 9, 2010, the contents of which are hereby incorporated herein by reference.","The present application relates generally to device security and, more specifically, to securing components prior to manufacture of devices and, more specifically, to utilization of a microcode interpreter built in to a processor.","There was a time when a manufacturer directly controlled production of each component that would later be combined into a single device. Indeed, often all components and the single device could be manufactured under the same roof. However, when the device is a complex electronic device, the practicality and cost savings of sourcing the manufacture of myriad components of the device to multiple manufacturers becomes more attractive. Even if security concerns are present, especially in the manufacture of the final device from all of the components. Copycat or counterfeit devices can be an unfortunate result of failing to secure steps along the manufacturing path.","Augmented processor hardware, which may comprise, for example, a baseband processor, an applications processor, a Universal Integrated Circuit Card (UICC) or an embedded Universal Integrated Circuit Card (eUICC), etc., contains a microcode interpreter. When encrypted microcode is included in a message from a service, the microcode may be passed to the microcode interpreter. Based on decryption and execution of the microcode taking place at the processor hardware, extended functionality may be realized.","According to an aspect of the present disclosure, there is provided a method of responding to a query. The method includes receiving a query, the query including microcode, passing the microcode to a microcode interpreter, receiving a result of execution of the microcode, based on the result, generating a response and transmitting the response. In other aspects of the present application, a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor to carry out this method.","According to an aspect of the present disclosure, there is provided a method of responding to a control message. The method includes receiving a control message, the control message including microcode, passing the microcode to a microcode interpreter, receiving a result of execution of the microcode, based on the result, generating a response and transmitting the response. In other aspects of the present application, a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor to carry out this method.","According to an aspect of the present disclosure, there is provided a method of responding to a historical data retrieval message. The method includes receiving a historical data retrieval message, the historical data retrieval message including microcode, passing the microcode to a microcode interpreter, receiving a result of execution of the microcode, based on the result, generating a response and transmitting the response. In other aspects of the present application, a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor to carry out this method.","Other aspects and features of the present disclosure will become apparent to those of ordinary skill in the art upon review of the following description of specific implementations of the disclosure in conjunction with the accompanying figures.","The production of consumer goods often requires coordination of disparate manufacturing facilities that produce components of the finished product and delivery of the components to a final manufacturing facility where the final product is produced by assembling the components.","See , which schematically illustrates a distributed manufacturing process for an example consumer product, namely, a mobile communication device . A first manufacturing facility A produces a processor , a second manufacturing facility produces a communication subsystem , a third manufacturing facility C produces a keyboard  and a fourth manufacturing facility D produces a display . A fifth manufacturing facility E receives the components output from the other manufacturing facilities A, B, C, D and components from many additional manufacturing facilities, and produces the mobile communication device .","An example schematic configuration of the mobile communication device  is illustrated in .","The mobile communication device  includes a housing, an input device (e.g., a keyboard  having a plurality of keys) and an output device (e.g., a display ), which may comprise a full graphic, or full color, Liquid Crystal Display (LCD). In some embodiments, the display  may comprise a touchscreen display. In such embodiments, the keyboard  may comprise a virtual keyboard. Other types of output devices may alternatively be utilized. A processing device (the processor ) is shown schematically in  as coupled between the keyboard  and the display . The processor  controls the operation of the display , as well as the overall operation of the mobile communication device , in part, responsive to actuation of the keys on the keyboard  by a user. The processor  includes a processor memory .","The housing may be elongated vertically, or may take on other sizes and shapes (including clamshell housing structures). In the case in which the keyboard  includes keys that are associated with at least one alphabetic character and at least one numeric character, the keyboard  may include a mode selection key, or other hardware or software, for switching between alphabetic entry and numeric entry.","In addition to the processor , other parts of the mobile communication device  are shown schematically in . These may include a communications subsystem , a short-range communications subsystem , the keyboard  and the display . The mobile communication device  may further include other input\/output devices, such as a set of auxiliary I\/O devices , a serial port , a speaker  and a microphone . The mobile communication device  may further include memory devices including a flash memory  and a Random Access Memory (RAM)  and various other device subsystems . The mobile communication device  may comprise a two-way radio frequency (RF) communication device having voice and data communication capabilities. In addition, the mobile communication device  may have the capability to communicate with other computer systems via the Internet.","Operating system software executed by the processor  may be stored in a computer readable medium, such as the flash memory , but may be stored in other types of memory devices, such as a read only memory (ROM) or similar storage element. In addition, system software, specific device applications, or parts thereof, may be temporarily loaded into a volatile store, such as the RAM . Communication signals received by the mobile device may also be stored to the RAM .","The processor , in addition to its operating system functions, enables execution of software applications on the mobile communication device . A predetermined set of software applications that control basic device operations, such as a voice communications module A and a data communications module B, may be installed on the mobile communication device  during manufacture. A challenge\/response module C may also be installed on the mobile communication device  during manufacture, to implement aspects of the present disclosure. As well, additional software modules, illustrated as an other software module N, which may be, for instance, a PIM application, may be installed during manufacture. The PIM application may be capable of organizing and managing data items, such as e-mail messages, calendar events, voice mail messages, appointments and task items. The PIM application may also be capable of sending and receiving data items via a wireless carrier network  represented by a radio tower. The data items managed by the PIM application may be seamlessly integrated, synchronized and updated via the wireless carrier network  with the device user's corresponding data items stored or associated with a host computer system.","Communication functions, including data and voice communications, are performed through the communication subsystem  and, possibly, through the short-range communications subsystem . The communication subsystem  includes a receiver , a transmitter  and one or more antennas, illustrated as a receive antenna  and a transmit antenna . In addition, the communication subsystem  also includes a processing module, such as a digital signal processor (DSP) , and local oscillators (LOs) . The specific design and implementation of the communication subsystem  is dependent upon the communication network in which the mobile communication device  is intended to operate. For example, the communication subsystem  of the mobile communication device  may be designed to operate with the Mobitex\u2122, DataTAC\u2122 or General Packet Radio Service (GPRS) mobile data communication networks and also designed to operate with any of a variety of voice communication networks, such as Advanced Mobile Phone Service (AMPS), Time Division Multiple Access (TDMA), Code Division Multiple Access (CDMA), Personal Communications Service (PCS), Global System for Mobile Communications (GSM), Enhanced Data rates for GSM Evolution (EDGE), Universal Mobile Telecommunications System (UMTS), Wideband Code Division Multiple Access (W-CDMA), High Speed Packet Access (HSPA), LTE (Long Term Evolution) etc. Other types of data and voice networks, both separate and integrated, may also be utilized with the mobile communication device .","Network access requirements vary depending upon the type of communication system. Typically, an identifier is associated with each mobile device that uniquely identifies the mobile device or subscriber to which the mobile device has been assigned. The identifier is unique within a specific network or network technology. For example, in Mobitex\u2122 networks, mobile devices are registered on the network using a Mobitex Access Number (MAN) associated with each device and in DataTAC\u2122 networks, mobile devices are registered on the network using a Logical Link Identifier (LLI) associated with each device. In networks such as GPRS, UMTS, and LTE, however, network access is associated with a subscriber or user of a device. A GPRS, UMTS, or LTE device therefore uses a subscriber identity module (SIM) or a universal identity module (USIM). Other networks and other SIM equivalents are within the scope of the present disclosure. The USIM comprises applications contained or stored in a Universal Integrated Circuit Card (UICC) or an embedded Universal Integrated Circuit Card (eUICC). These applications contain the various parameters that enable a device to operate on a GPRS, UMTS or LTE network. Mobile devices within GSM\/GPRS networks are uniquely identified using an International Mobile Equipment Identity (IMEI) number.","When required network registration or activation procedures have been completed, the mobile communication device  may send and receive communication signals over the wireless carrier network . Signals received from the wireless carrier network  by the receive antenna  are routed to the receiver , which provides for signal amplification, frequency down conversion, filtering, channel selection, etc., and may also provide analog to digital conversion. Analog-to-digital conversion of the received signal allows the DSP  to perform more complex communication functions, such as demodulation and decoding. In a similar manner, signals to be transmitted to the wireless carrier network  are processed (e.g., modulated and encoded) by the DSP  and are then provided to the transmitter  for digital to analog conversion, frequency up conversion, filtering, amplification and transmission to the wireless carrier network  (or networks) via the transmit antenna .","In addition to processing communication signals, the DSP  provides for control of the receiver  and the transmitter . For example, gains applied to communication signals in the receiver  and the transmitter  may be adaptively controlled through automatic gain control algorithms implemented in the DSP .","In a data communication mode, a received signal, such as a text message or web page download, is processed by the communication subsystem  and is input to the processor . The received signal is then further processed by the processor  for output to the display , or alternatively to some auxiliary I\/O devices . A device user may also compose data items, such as e-mail messages, using the keyboard  and\/or some other auxiliary I\/O device , such as a touchpad, a rocker switch, a thumb-wheel, a trackball, a touchscreen, or some other type of input device. The composed data items may then be transmitted over the wireless carrier network  via the communication subsystem .","In a voice communication mode, overall operation of the device is similar to the data communication mode, except that received signals are output to the speaker , and signals for transmission are generated by a microphone . Alternative voice or audio I\/O subsystems, such as a voice message recording subsystem, may also be implemented on the mobile communication device . In addition, the display  may also be utilized in voice communication mode, for example, to display the identity of a calling party, the duration of a voice call, or other voice call related information.","The short-range communications subsystem  enables communication between the mobile communication device  and other proximate systems or devices, which need not necessarily be similar devices. For example, the short-range communications subsystem may include an infrared device and associated circuits and components, a Bluetooth\u2122 communication module, a RFID (Radio-Frequency Identification) module, or a NFC (near field communication) module that includes an NFC controller, etc. to provide for communication with similarly-enabled systems and devices.","It is sometimes the case that the fifth manufacturing facility E is not an entirely secure facility and a short time after a new product is assembled at the fifth manufacturing facility E and introduced to the public, counterfeit versions of the new product surface. Often the producers of the counterfeit versions acquire components of the new product from the fifth manufacturing facility E and reverse engineer the components so that their own manufacturing facilities may closely approximate the components of the new product. From the perspective of the consumer, or even the network on which the devices are deployed, the counterfeit versions of the new product may be indistinguishable from the new product.","For the producer of the new product, the loss of revenue attributable to the presence, in the market, of the counterfeit version, is related to the value of the intellectual property associated with the individual components. For the example case of the mobile communication device , the value of the intellectual property associated with the processor  may be primary among the totality of components. However, it should be understood that, in other example devices, the intellectual property associated with other components may have greater value.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 3","b":["300","300","306","110","110","306","110","110","110","110","110","100","308","302"]},{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 4","FIG. 3"],"b":["300","402","270"]},"In overview, by securing a component within a product, before the component is delivered to the final product manufacturing facility, the device manufacturing process can be made provably secure.","The processor  of the mobile communication device  may be specifically configured by the first manufacturing facility A before shipping the processor  to the fifth manufacturing facility E. For example, the processor  may be configured in such a way that the processor  will only execute appropriately signed software. Additionally, the processor  of the mobile communication device  may be configured in such a way that the processor  can appropriately respond to a cryptographic challenge. Furthermore, the processor  of the mobile communication device  may be configured in such a way that the processor  is locked down from further change or debug.","In operation, the processor  securely executes key assignor code  to generate an asymmetric key pair and an identifier for the processor  (a \u201cprocessor ID\u201d ). The asymmetric key pair may, for example, include a processor private key  and a processor public key . The processor , while executing the key assignor code , may, for example, bind the asymmetric processor key pair ,  to itself by storing, in the processor memory , the asymmetric processor key pair ,  in conjunction with the processor ID  assigned to the processor . In addition to storing the asymmetric processor key pair ,  and the processor ID  locally in the processor memory , the processor  also transmits a report  to the MAS  in the internal environment . The report , for example, includes the processor ID , the processor public key  and additional security characteristic data relating to security settings of the processor . The MAS  provides secure data storage and management within the internal environment .","The key assignor code  executed by the processor  at the first manufacturing facility A may initialize a \u201cSecure Boot\u201d feature of the processor  by providing the code signing public key  to the processor . In conjunction with providing the code signing public key  to the processor , the first manufacturing facility A may configure the processor  so that only executable code that has been signed using the code signing private key corresponding to the code signing public key  can be executed by the processor . Furthermore, the first manufacturing facility A may configure the processor  so that the processor  is locked from future alteration.","One manner in which the first manufacturing facility A may lock the processor  from future alteration comprises configuring the processor  so that each bit of the processor private key  is associated with a one-time programmable (OTP) fuse. That is, the processor memory  may be implemented as OTP fuses.","The first manufacturing facility A may also disable debug interfaces of the processor  to prevent circumvention of the Secure Boot feature or access to the processor private key .","Upon completion of manufacturing and configuring the processor , the first manufacturing facility A may arrange shipment of the processor  to the fifth manufacturing facility E.","At the fifth manufacturing facility E, the mobile communication device  may be assembled to include the processor  and other components. Upon successful assembly, the mobile communication device  may be shipped, by the fifth manufacturing facility E, to the market and finally to a network operator which will manage the device.","In conjunction with the mobile communication device  being shipped to the market, the MAS  may configure the relay  to allow secure communication between the mobile communication device  and the relay . Communicating with the relay may, for example, be required for secure transmission of messages from and reception of messages to the mobile communication device . In addition, the network operator of the mobile communication device may want to enable, disable or features on the mobile communication device, the processor memory, the UICC or the eUICC. Therefore it may configure a trusted network entity to allow secure communication with the processor. Using this secure channel, microcode can be transmitted to the processor to be executed to apply the changes sent by the network operator.","The processor  may be tested during manufacturing of the mobile communication device  at the fifth manufacturing facility E. Such testing may involve requiring the processor  to correctly generate a response to a given challenge. Generation of a correct response, as will be described hereinafter, may be considered evidence that the device being manufactured is secure. For the device being manufactured to be considered secure, it should be confirmable that security validation steps in the production flow have not been skipped or otherwise tampered with. In an example secure manufacturing process, a step to cryptographically verify the identity of each processor is included.","In addition to testing the processor  at stages of the manufacturing process, an operating system arranged for execution on the processor  may be configured to only execute signed applications.","In general, the processor  may be configured to support the execution of applications and support, where appropriate, the applications accessing Application Programming Interfaces (APIs) for the mobile communication device . The operating system may include a security handler element.","Each application executed by the processor  may be required to be a secure application. Ensuring that executing a secure application does not violate a defined security policy may involve determining that the application has been signed with a suitable signature. Such determining can happen at various times, for example, during boot-up or on-the-fly.","During boot-up, the security handler can analyze the application, as well as any other applications that have been loaded onto a device. The security handler can verify, in a manner to be discussed hereinafter, that the application has been appropriately cryptographically signed.","The security handler may, for example, access the code signing public key . In general, application developers submit a request, specific to a given application, to the internal environment  of the organization that has contracted the production of the mobile communication device . Responsive to the request, and assuming the requested is granted, the code signing server  of the internal environment  signs the given application with the code signing private key.","To cryptographically sign application code, the code signing server  may, first, provide the code of the given application as input to a hash function to obtain a digital signature. Subsequently, the code signing server  may encode the digital signature using the code signing private key. The code signing server  may then append the encoded digital signature, which may be called a cryptographic signature or cryptographic identifier (\u201cID\u201d), to the application file.","Later, the given application is loaded onto the mobile communication device . At boot, the security handler may obtain, perhaps from a predetermined memory location, the code of the given application and one of the cryptographic IDs that are associated with the given application. The security handler may then provide the code of the given application as input to the same hash function used by the code signing server . As a result of providing the application code to the hash function, the security handler receives a local digital signature as the output of the hash function. The security handler then checks the local digital signature with the code signing public key  to confirm that the same hash of the code was signed by the internal environment . If the security handler confirms that the same hash of the code was signed by the internal environment , then the security handler allows the processor to execute the application. If the security handler fails to confirm that the same hash of the code was signed by the internal environment , then the security handler denies the processor  the ability to execute the application.","At any point in the manufacturing process and at any point during the lifetime of the product, the MAS  may generate a challenge that is specific to the processor  and transmit the challenge to the mobile communication device . The MAS  may generate the challenge in such a way that the response is verifiable, by the MAS , and may only be generated by the mobile communication device  if the installed processor is the processor  that has been securely configured by the first manufacturing facility A.","A simple challenge-response mechanism that allows the MAS  to confirm that the processor  has possession of the processor private key  proceeds as follows. The MAS  generates some random data and sends the random data to the mobile communication device . The mobile communication device  signs the random data with the processor private key  and sends the signed data to the MAS . The MAS  validates the signed data using the processor public key .","An alternate mechanism that allows the MAS  to confirm that the processor  has possession of the processor private key  proceeds as follows. The MAS  encrypt some random data with the processor public key , thereby generating encrypted random data. The MAS  transmits the encrypted random data to the mobile communication device . Responsive to receiving the encrypted random data, the mobile communication device  performs a decryption, using the processor private key  to obtain the random data. The mobile communication device  then transmits, to the MAS , the random data. Upon receiving the random data correctly decrypted, the MAS  may be considered to have confirmed that the processor  possesses the processor private key .","Upon failing to validate the signed data, or upon receiving incorrectly decrypted random data, the MAS  may arrange that the mobile communication device  be blocked from being shipped from the fifth manufacturing facility E. In conjunction with being blocked from being shipped from the fifth manufacturing facility E, the MAS  may also arrange that the mobile communication device  is not activated on the relay . That is, the MAS  may passively not configure the relay  for secure communication with the mobile communication device .","Upon failing to validate the signed data, or upon receiving incorrectly decrypted random data, the MAS  may actively arrange that the mobile communication device  be blocked from communicating with the relay . It can also block the device from accessing any network access parameters from its memory, the UICC or the eUICC and therefore blocking complete access to the wireless network.","In view of , for additional security, the mobile communication device  may generate a further cryptographic key. The processor  may independently initiate the generation of the further cryptographic key. However, in another case, the processor  initiates the generation of the further cryptographic key responsive to a request  from the MAS .","Perhaps as part of a test of the security of the mobile communication device , the MAS  may transmit the request  to collect an authenticated set of data from the mobile communication device . If the further cryptographic key has not yet been generated at time of the receipt of the request  at the mobile communication device , the processor  initiates the generation of the further cryptographic key.","Responsive to the request , the processor  may encrypt the further cryptographic key to form an encrypted further cryptographic key . For the encrypting, the mobile communication device  may use a public key associated with the relay . The processor  may then form a signed block . The signed block  includes the request  and a response  to the request . The response  contains an indication of device identity and the encrypted further cryptographic key . The processor  may then sign, with the processor private key , the block containing the request  and the response  so that the mobile communication device  may then transmit the signed block  to the MAS . In turn, the MAS  may forward the encrypted further cryptographic key  to the relay . Because the further cryptographic key  has been encrypted using the public key associated with the relay , the relay  can decrypt the encrypted further cryptographic key  to produce the further cryptographic key specific to the mobile communication device .","Later, the mobile communication device  may transmit a request  to the relay  to register therewith. The mobile communication device  can utilize a further cryptographic key in the registration request, thereby allowing the relay  to use its foreknowledge of the further cryptographic key to confirm that the registration request has originated at the mobile communication device . The further cryptographic key may be a symmetric key or an asymmetric key pair.","A typical challenge\/response mechanism will merely validate that the authenticating device (e.g., the processor ) is in possession of a specific private key (i.e., the processor private key ). It is not, generally, possible to validate the operation of, or integrity of, the software to be executed on the authenticating device. A rogue authenticating device may, for example, be in possession of the processor private key  after having stolen the processor private key  from the processor .","In a countermeasure to such processor private key theft, it is proposed herein to augment the processor , as illustrated in , to contain a microcode interpreter .","The simple challenge\/response mechanism outlined above may be altered as follows. The MAS  generates a block of microcode, encrypts the block of microcode and sends a challenge that includes the encrypted microcode to the mobile communication device .",{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 6","b":["128","100","602","604","502","502","100","100"]},"Upon having executed the microcode, the microcode interpreter  returns a result of the execution of the microcode so that the software on the processor  receives (step ) the result. Based on the result, the processor  generates (step ) a response to the challenge. The processor  then encrypts the response and transmits (step ) the encrypted response to the MAS .","Conveniently, by arranging that the microcode be decrypted and executed entirely within the hardware, it has been considered that any tampering by potentially abusive device software may be prevented.","Because the challenge comprises microcode that requires interpretation, complex, or even state-based, challenge\/response mechanisms are possible.","In one example, the microcode may validate the identity of the processor . For one example, the processor  may be identified using a unique processor identifier (ID), which ID may be assigned by the silicon manufacturer of the processor . For another example, the processor  may be identified using a physically unclonable function (PUF).","In another example, the microcode may validate the software on the processor . Indeed, the software may be validated using a secure hash function or digital signature.","In a further example, the microcode may validate data available to the processor . For example, the microcode may arrange formation of a secure hash function to validate memory contents.","In still further examples, the microcode may function to: reorder a chain of encrypted data; perform a functional computation on data available to the processor ; or recall a sequence of data that has been previously sent to the mobile communication device .","In an even further example, a given challenge can contain encrypted data and instructions to maintain the encrypted data for future use in generating a response to a subsequent challenge. The processor public key  may be used to encrypt the data.","By leveraging a secure hardware component (e.g., the processor ) that includes a microcode interpreter (e.g., microcode interpreter ), general functions can be executed by a service on the mobile communication device  in a secure manner. Such execution of general functions may allow the mobile communication device  to have arbitrarily extendable functionality.","In one example of extended functionality, when the mobile communication device  has been misplaced (e.g., lost or stolen), a location determination device (not shown) may transmit a query to the mobile communication device . The query may include encrypted microcode for interpretation by the microcode interpreter .",{"@attributes":{"id":"p-0079","num":"0078"},"figref":"FIG. 7","b":["128","100","702","704","502","502"]},"Upon having executed the microcode, the microcode interpreter  returns a result of the execution of the microcode so that the software on the processor  receives (step ) the result. Based on the result, the processor  generates (step ) a response to the query. The processor  then encrypts the response and transmits (step ) the encrypted response to the location determination device.","For example, the response may include an indication of the location of the mobile communication device . The indication of the location of the mobile communication device , returned by the microcode interpreter , may comprise latitude and longitude coordinates. Alternatively, the indication of the location of the mobile communication device , returned by the microcode interpreter , may comprise an address number on a particular street in a particular municipality in a state or province of a particular country.","Indeed, to determine its location, the microcode interpreter  may execute the encrypted microcode, where the microcode includes instructions to use information received from cellular base stations to determine a location based on methods of triangulation.","Alternatively, to determine its location, the microcode interpreter  may execute encrypted microcode, where the microcode includes instructions to employ an application programming interface (API) to an application, such as Google\u2122 Maps for Mobile, that can determine location and report back an indication of the determined location. Indeed, rather than use the API for Google\u2122 Maps for Mobile, the microcode may utilize an API to Global Positioning System (GPS) software designed to use on-board GPS hardware (not shown) to determine and report a current location.","It may be that, for reasons unrelated to instructions from microcode, the mobile communication device  has previously determined its location using methods of which those methods described above are examples. The mobile communication device  may have stored the location determined as a \u201clast known location\u201d.","Accordingly, to determine its location, the microcode interpreter  may execute encrypted microcode, where the microcode includes instructions to access the stored \u201clast known location\u201d and report the \u201clast known location\u201d as a current location.","An indication of the location of the mobile communication device  may not always be latitude and longitude coordinates. Indeed, the microcode interpreter  may execute encrypted microcode, where the microcode includes instructions to utilize an API for a digital camera (not shown) among the auxiliary I\/O devices  of the mobile communication device . The microcode may include instructions to employ the digital camera to capture a digital image. The microcode interpreter  may return the digital image as location information.","Based on a result of execution of the encrypted microcode, the processor  may generate a response to the query. For example, the response may include an indication of the location of the mobile communication device . Upon receiving a response including a digital image, the location determination device may process the digital image to determine whether the digital image is representative of a unique location.","Notably, a lens (not shown) of the digital camera may typically be located on a posterior side of the mobile communication device , where the display  and the keyboard  are located on an anterior side of the mobile communication device . However, digital camera lenses are increasingly located on the anterior side of mobile communication devices. Accordingly, the digital image, captured according to instructions in the microcode, may comprise an image of a face of a thief.","In a further example of extended functionality, when the mobile communication device  has been misplaced (e.g., lost or stolen), a privacy control device (not shown) may transmit a control message to the mobile communication device . The control message may include encrypted microcode and the encrypted microcode may comprise instructions to put into place controls to limit a manner in which responses are generated to received queries. The instructions may implement the limit as a time period. The instructions may implement the limit as a total number of queries. The instructions may implement the limit as a number of queries per unit of time.",{"@attributes":{"id":"p-0090","num":"0089"},"figref":"FIG. 8","b":["128","100","802","804","502","502"]},"Upon having executed the microcode, the microcode interpreter  returns a result of the execution of the microcode so that the software on the processor  receives (step ) the result. Based on the result, the processor  generates (step ) a response to the control message. The processor  then encrypts the response and transmits (step ) the encrypted response to the privacy control device.","In a further example of extended functionality, the control message may include encrypted microcode and the encrypted microcode may comprise instructions to implement a remote \u201chard-kill\u201d. The encrypted microcode sent to the device could instruct the processor  to blow a fuse that would disable the mobile communication device  at the hardware level. Such a harsh measure may be implemented if a challenge has failed. The privacy control device may transmit a hard-kill control message automatically after a predetermined duration, say, a predetermined number of units of time, following a failure, on the part of the mobile communication device , to produce an appropriate response to a received challenge. Notably, an override may be set while the privacy control device is awaiting expiry of the predetermined duration.","In an even further example of extended functionality, an historical data retrieval device may transmit an historical data retrieval message to the mobile communication device . The historical data retrieval message may include encrypted microcode for interpretation by the microcode interpreter . Responsive to receiving the query, the processor  may pass the encrypted microcode to the microcode interpreter . Based on a result of execution of the encrypted microcode, the processor  may generate a response to the historical data retrieval message. For example, the response may include historical data related to the operation of the mobile communication device .",{"@attributes":{"id":"p-0094","num":"0093"},"figref":"FIG. 9","b":["128","100","902","904","502","502"]},"Upon having executed the microcode, the microcode interpreter  returns a result of the execution of the microcode so that the software on the processor  receives (step ) the result. Based on the result, the processor  generates (step ) a response to the historical data retrieval message. The processor  then encrypts the response and transmits (step ) the encrypted response to the historical data retrieval device.","In one example, the historical data may comprise a count of the number of times the mobile communication device  been touched by manufacturing.","In another example, the historical data may comprise an indication of the location of each of the times the mobile communication device  been come into contact with a manufacturing facility with the ability to trigger, within the mobile communication device , recordation of such historical data.","In still further example, the historical data may comprise an indication of the receipt of, use of and renewal of a digital certificate.","In still further example, the historical data may comprise an indication of a software load history.","A hardware-based microcode interpreter has been disclosed hereinbefore. In an alternative implementation, aspects of the present application may be implemented as a software-based microcode interpreter. Such a software-based microcode interpreter may be implemented in ROM on an internal secure processor (not shown) that is separate from the main processor .","The above-described implementations of the present application are intended to be examples only. Alterations, modifications and variations may be effected to the particular implementations by those skilled in the art without departing from the scope of the application, which is defined by the claims appended hereto."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Reference will now be made, by way of example, to the accompanying drawings which show example implementations; and in which:",{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0010","num":"0009"},"figref":["FIG. 5","FIG. 1"]},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 9"}]},"DETDESC":[{},{}]}
