---
title: Method and system for distribution of map content to mobile communication devices
abstract: A system and method are set forth for distributing map content from a server to a communication device by transmitting a request from the communication device to the map server for a maplet index of map data covering a specified area and identified by coordinates for defining the map data, receiving the request at the map server and in response transmitting the maplet index to the communication device, wherein the maplet index defines content available the maplet without including all of the data points therein.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08788613&OS=08788613&RS=08788613
owner: BlackBerry Limited
number: 08788613
owner_city: Waterloo
owner_country: CA
publication_date: 20060707
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATION","COPYRIGHT NOTICE","FIELD","BACKGROUND","DETAILED DESCRIPTION"],"p":["This application claims the benefit of U.S. Provisional Patent Application No. 60\/787,541, filed Mar. 31, 2006, the contents of which are incorporated herein by reference.","A portion of this specification contains material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document, as it appears in the Patent and Trademark Office patent file or records, but otherwise reserves all copyrights whatsoever.","The following is directed in general to mobile communication devices, and more particularly to a method for distribution of map content to mobile devices.","Mobile communication devices have become popular for business and personal use due to a relatively recent increase in number of services and features that the devices and mobile infrastructures support. Handheld mobile communication devices, sometimes referred to as mobile stations, are essentially portable computers having wireless capability, and come in various forms. These include Personal Digital Assistants (PDAs), cellular phones and smart phones.","More recently, global positioning system (GPS) receivers have been integrated within such mobile communication devices for providing enhanced location-based services (LBS). In operation, a map application within the mobile communication device sends a request to a map server for information relating to a city, restaurant, street address, route, etc. If the device is \u201clocation aware\u201d, the request includes the current location of the device. The map server extracts generic map content from a Geographical Information Systems (GIS) map database (e.g. Navtech\u00ae, TelAtlas\u00ae, etc.) at a specified level of resolution (zoom level). Custom graphics associated with the query, such as highlighted route, pushpin for current position or street address, etc. are post-processed and merged by the server with the generic map content. Relevant screen graphics are then labeled, and the merged map graphic is compressed and delivered to the device for display.","One problem associated with the foregoing technical approach to providing mobile mapping service is that the delivered map graphic (DMG) is in the form of a bit-mapped flat file at a specific zoom level that is not scalable (in either lateral (pan) or vertical (zoom) contexts). After the map graphic has been downloaded to the device, subsequent pan or zoom operations from the device will result in further requests to the server. For example, if a DMG is delivered to the device as a 2 Kbyte map at the lowest level (Level 0) resolution field of view (e.g. 1 meter\/pixel), then if the user wishes to zoom in to the next highest level (Level 1) resolution field of view the server is required to deliver four 2 Kbytes maps (e.g. 2 meters\/pixel). If the user requests Level 2, then 16 2 Kbyte maps of data must be downloaded to the device, and so on. From the foregoing, it is evident that the inability to provide scaling of bit map data according to conventional techniques gives rise to non-linear growth in the amount of data that is required to be downloaded to the device. Also, by merging the labels with the delivered map graphic any labeling that extends between two DMG files is cut off when one of the files is displayed at the device. Furthermore, shipping label sets with all DMG's only to have them discarded by the device is a waste of bandwidth. A relatively low percentage of map graphics actually get labeled, particularly on the small size screen of a mobile device, thereby causing label clutter\/collisions.","It will also be appreciated that the downloading of large amounts of map data according to conventional techniques consumes significant over-the-air (OTA) bandwidth requiring considerable time to complete the download. Furthermore, the storing of such large amounts of map data on the device undermines device capability to cache the data.","Moreover, the DMG often is not geocoded with latitude\/longitude association, thereby inhibiting implementation of device features like dynamic updating of current position while the device is in motion, or position resolution of any location tag information on the device, such as personal points of interest, etc. In addition, features on DMG that haven't been labeled cannot be queried.","As set forth in greater detail below, a method, apparatus and data structure are provided for efficient rendering of map artifacts while minimizing connection time of a mobile communication device to a map server. Preferably, map data on the server is accessed by the device on demand, and the device uses local caching and applies context filtering of map data on the server.","According to an aspect of this specification, a Maplet data structure is provided that contains all of the graphic and labeled content associated with a geographic area (e.g. map features such as restaurants (point features), streets (line features), or lakes (polygon features)). Maplets are structured in Layers of \u201cDEntries\u201d (Data Entries) identified by a \u201cLayer ID\u201d to enable data from different sources to be deployed to the device and meshed for proper rendering. Each DEntry is representative of one or more artifact or label (or a combination of both) and includes coordinate information (also referred to a \u201cbounding box\u201d or \u201cbounding area\u201d) to identify the area covered by the DEntry and a plurality of data Points that together represent the artifact or label. For example, a DEntry may be used to represent a street on a city map (or a plurality of streets), wherein the various Points within the DEntry are separated into different parts representing various portions of the artifact (e.g. portions of a street). As discussed in greater detail below, a mobile device may issue a request for the map server to download only those DEntries that are included within a specified area or bounding box representing an area of interest that can be represented by, for example, a pair of bottom left, top right coordinates.","As discussed in greater detail below with reference to , the mobile device issues one or more AOI (Area of Interest) requests, DEntry or data requests and Maplet Index requests to the map server, as set forth in greater detail below, for selective downloading of map data based on user context. Thus, rather than transmitting the entire map data with each request from the device, local caching may be used within the mobile device in conjunction with context filtering of map data on the server. For example, if a user's mobile device is GPS enabled and the user is traveling in an automobile at 120 km\/hr along a freeway then context filtering can be employed to prevent downloading of map data relating to passing side streets. Or, if the user is traveling in an airplane at 30,000\u2032 then context filtering can be employed to prevent downloading of map data for any streets whatsoever. Also, a user's context can be defined, for example, in terms of occupation (e.g. a user whose occupation is transport truck driver can employ context filtering to prevent downloading of map data for side streets on which the user's truck is incapable of traveling, or a user whose occupation is to replenish supplies of soft drink dispensing machines can employ context filtering to download public map data showing the user's geographical area of responsibility with irrelevant features such as lakes or parks filtered out and private map data containing the location of soft drink dispensing machines superimposed on the public map data.","The Maplet Index request results in a Maplet Index (i.e. only a portion of the Maplet that provides a table of contents of the map data available within the Maplet rather than the entire Maplet) being downloaded from the map server to the device, thereby conserving OTA (Over-the-Air) bandwidth and device memory caching requirements. The Maplet Index conforms to the same data structure as a Maplet, but omits the data Points. Consequently, the Maplet Index is small (e.g. 300-400 bytes) relative to the size of a fully populated Maplet or a conventional bit map, and includes DEntry bounding boxes and attributes (size, complexity, etc.) for all artifacts within the Maplet. As the field of view changes (e.g. for a location-aware device that displays a map while moving), the device (client) software assesses whether or not it needs to download additional data from the server. Thus, as discussed above, if the size attribute or complexity attribute of an artifact that has started to move into the field of view of the device (but is not yet being displayed) is not relevant to the viewer's current context, then the device can choose not to display that portion of the artifact. On the other hand, if the portion of the artifact is appropriate for display then the device accesses its cache to determine whether the DEntries associated with that portion of the artifact have already been downloaded, in which case the cached content is displayed. Otherwise, the device issues a request for the map server to download all of the DEntries associated with the artifact portion.","By organizing the Maplet data structure in Layers, it is possible to seamlessly combine and display information obtained from public and private databases. For example, it is possible for the device to display an office building at a certain address on a street (e.g. 1z-order attribute from public database), adjacent a river (e.g. 2z-order attribute from public database), with a superimposed floor plan of the building to show individual offices (e.g. 11z-order attribute from a private database, accessible through a firewall).",{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 1","FIG. 11","FIG. 11"],"b":["100","103","105","107","100","107","109","111","113","115","117","119","121","121","123","125","115","100"]},"Alternatively, where no corporate servers provided, the request from a device  may be passed via relay  to a public MDS server , which sends the request to the LBS load-balancing server , and therefrom to one of the plurality of public LBS servers  providing location-based services (LBS) to handle the request.","A person of skill in the art will understand that the architecture depicted in  is illustrative only of an exemplary embodiment and that numerous other architecture configurations are possible which for example may include or exclude secure communication channels, replace or omit specific servers or nodes (e.g. the relay ) in certain implementations, etc.","In the example of , all of the map data for the entire world is divided and stored as a grid within the various map servers  according to various levels of resolution (zoom), as set forth below in Table A. Thus, a single A level Maplet represents a 0.05\u00d70.05 degree grid area; a single B level Maplet represents a 0.5\u00d70.5 degree grid area; a single C level Maplet represents a 5\u00d75 degree grid area; a single D level Maplet represents a 50\u00d750 degree grid area and a single E level Maplet represents the entire world in a single Maplet. It is understood that Table 1 is only an example of a particular Maplet grid configuration. Other or different grid configurations can also be developed. As discussed in greater detail below, a Maplet comprises of a set of Layers, with each Layer containing a set of DEntries, and each DEntry containing a set of Points.",{"@attributes":{"id":"p-0035","num":"0034"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE A"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},{},"# of","# of","# of"]},{"entry":[{},{},"Maplets","Maplets","Maplets"]},{"entry":[{},"Grid","to cover","to cover","to cover"]},{"entry":["Level","(degrees)","the World","North America","Europe"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"char","char":"."}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"char","char":"."}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["A","0.05 \u00d7 0.05","25,920,000","356,000","100,000"]},{"entry":["B","0.5 \u00d7 0.5","259,200","6,500","1000"]},{"entry":["C","5 \u00d7 5","2,592","96","10"]},{"entry":["D","50 \u00d7 50","32","5","5"]},{"entry":["E","World","1","1","1"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"As discussed above and in greater detail with reference to , three types of requests may be generated by a mobile communication device  for receipt by map server : AOI requests, DEntry requests and Maplet Index requests. The requests may be generated separately or in various combinations, as discussed in greater detail below. An AOI (area of interest) request calls for all DEntries in a given area (bounding box) for a predetermined or selected set of z-order Layers. The AOI request is usually generated when the device  moves to a new area so as to fetch DEntries for display before the device client knows what is available in the Maplet. The Maplet Index has the exact same structure as a Maplet but does not contain complete DEntries (i.e. the data Points actually representing artifacts and labels are omitted). Thus, a Maplet Index defines what Layers and DEntries are available for a given Maplet. A data or DEntry request is a mechanism to bundle together all of the required Dentries for a given Maplet. Additional details of an exemplary message exchange between device  and map server  are provided in , as discussed in greater detail below.","Typically, AOI and Maplet Index requests are paired together in the same message, although they need not be, while DEntry requests are generated most often. For example, when a device  moves into an area in connection with which no information has been stored on the device client, the Maplet Index request returns a Maplet Index that indicates what data the client can specifically request from the server , while the AOI request returns any DEntries within the area of interest for the specified Layers (if they exist). In the example requests shown on , the desired Maplet is identified within a DEntry request by specifying the bottom-left Maplet coordinate. In addition, the DEntry request may include a layer mask so that unwanted Layers are not downloaded, a DEntry mask so that unwanted data Points are not downloaded, and zoom values to specify a zoom level for the requested DEntry. Once the device client has received the requested Maplet Index, the client typically then issues multiple DEntry requests to ask for specific DEntries (since the client knows all of the specific DEntries that are available based on the Maplet Index).","According to an exemplary embodiment, a collection of 20\u00d720 A-level Maplets (representing a 1\u00d71 degree square) is compiled into a Maplet Block File (.mbl). An .mbl file contains a header which specifies the offset and length of each Maplet in the .mbl file. The same 20\u00d720 collection of Maplet index data is compiled into a Maplet Index file (.mbx). The .mbl and .mbx file structures are set forth in Tables B and C, respectively.",{"@attributes":{"id":"p-0039","num":"0038"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE B"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Address Offset","Offset","Length"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["0x000","Maplet # 0 Offset (4 bytes)","Maplet # 0 Length (4 bytes)"]},{"entry":["0x008","Maplet # 1 Offset","Maplet # 1 Length"]},{"entry":["0x010","Maplet # 2 Offset","Maplet # 2 Length"]},{"entry":[". . .",". . .",". . ."]},{"entry":["0xC78","Maplet # 399 Offset","Maplet # 399 Length"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["0xC80","Beginning of Maplet # 0"]},{"entry":["0xC80 + Size","Beginning of Maplet # 1"]},{"entry":["of Maplet # 0",{}]},{"entry":["0xC80 + Size","Beginning of Maplet # 2"]},{"entry":["of Maplet",{}]},{"entry":["# 0 + # 1",{}]},{"entry":[". . .",". . ."]},{"entry":["0xC80 + \u03a3 of","Beginning of Maplet # 399"]},{"entry":["Size of Maplets",{}]},{"entry":"(# 0:# 398)"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"In Table B, the offset of Maplet #0 is 0x00000000 since, according to the illustrated embodiment, the data structure is based on the assumption that the base address for the actual Maplet data is 0x00000C80. Therefore the absolute address for Maplet #0 data is: Maplet #0 Address=Base Address (0x00000C80)+Maplet #0 Offset (0x00000000), and additional Maplet addresses are calculated as: Maplet # (n+1) Offset=Maplet # (n) Offset+Maplet #(n) Length. If a Maplet has no data or does not exist, the length parameter is set to zero (0x00000000).",{"@attributes":{"id":"p-0041","num":"0040"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE C"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Address Offset","Offset (4 bytes)","Length (4 bytes)"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["0x000","Maplet Index # 0 Offset","Maplet Index # 0 Length"]},{"entry":["0x008","Maplet Index # 1 Offset","Maplet Index # 1 Length"]},{"entry":["0x010","Maplet Index # 2 Offset","Maplet Index # 2 Length"]},{"entry":[". . .",". . .",". . ."]},{"entry":["0xC78","Maplet Index # 399 Offset","Maplet Index # 399 Length"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["0xC80","Beginning of Maplet Index # 0"]},{"entry":["0xC80 + Size","Beginning of Maplet Index # 1"]},{"entry":["of Maplet",{}]},{"entry":["Index # 0",{}]},{"entry":["0xC80 + Size","Beginning of Maplet Index # 2"]},{"entry":["of Maplet",{}]},{"entry":["Index",{}]},{"entry":["# 0 + # 1",{}]},{"entry":[". . .",". . ."]},{"entry":["0xC80 + \u03a3","Beginning of Maplet Index # 399"]},{"entry":["of Size of",{}]},{"entry":["Maplet",{}]},{"entry":["Indices",{}]},{"entry":"(# 0:# 399)"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"In Table C, the offset of Maplet Index #0 is 0x00000000 since, according to an exemplary embodiment the data structure is based on the assumption that the base address for the actual Maplet index data is 0x00000C80. Therefore the absolute address for Maplet Index #0 data is: Maplet Index #0 Address=Base Address (0x00000C80)+Maplet Index #0 Offset (0x00000000), and additional Maplet index addresses are calculated as: Maplet Index # (n+1) Offset=Maplet Index # (n) Offset+Maplet Index #(n) Length. If a Maplet Index has no data or does not exist, the length parameter is set to zero (0x00000000).",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 3"},"Table D provides a high \u201cbyte-level\u201d description of a Maplet, where the specific field descriptions for the Layer Entry, DEntry, and Points are set forth in greater detail below.",{"@attributes":{"id":"p-0045","num":"0044"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"91pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE D"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Data","Quantity","Total # of Bytes"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Map ID","1","4 bytes"]},{"entry":["# of Layers","1","4 bytes"]},{"entry":["Layer Entrys","# of Layers","20 bytes \u00d7 (# of Layers)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["DEntry of a","\u00d7 (# of","# of Layers","12 bytes \u00d7 (\u03a3 of the #"]},{"entry":["Layer","DEntrys",{},"of DEntrys in each Layer) +"]},{"entry":["Points for","in a Layer)",{},"4 bytes \u00d7 (\u03a3 of the #"]},{"entry":["DEntry",{},{},"of Points in each DEntry"]},{"entry":["of a Layer",{},{},"in each layer) +"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"91pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Layer",{},"4 bytes \u00d7 (# of Layers"]},{"entry":"Separator"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0046","num":"0045"},"figref":["FIGS. 4A and 5","FIG. 4A"]},{"@attributes":{"id":"p-0047","num":"0046"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"right"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE E"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Map ID","4","bytes"]},{"entry":[{},"# of Layers","4","bytes"]},{"entry":[{},"Layer Entry #1","20","bytes"]},{"entry":[{},"Layer Entry #2","20","bytes"]},{"entry":[{},"DEntry #1 of Layer #1","12","bytes"]},{"entry":[{},"Points for DEntry #1 of Layer #1","24","bytes"]},{"entry":[{},"Layer #1 Separator","4","bytes"]},{"entry":[{},"Dentry #1 of Layer #2","12","bytes"]},{"entry":[{},"Points for DEntry #1 of Layer #2","16","bytes"]},{"entry":[{},"Dentry #2 of Layer #2","12","bytes"]},{"entry":[{},"Points for DEntry #2 of Layer #2","412","bytes"]},{"entry":[{},"Separator for Layer #2","4","bytes"]},{"entry":[{},"Total for Maplet","544","bytes"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"For purposes of explanation,  shows the complete data set for Maplet #0, including the Layer Entrys, DEntrys and Points, and Maplet size. However, in practice, only the graphical map data is displayed on mobile device  for ease of viewing and in order to reduce clutter.","As shown in , the Points of each DEntry are divided into parts. For example the last DEntry (Layer #2, DEntry #2) has a total of 103 Points divided into 3 parts, one part of 88 Points, one of 2 Points and one of 13 Points. With graphical map data, a series of Points may represent one line connecting all of the Points, or alternatively a series of lines (parts). Parts are represented by setting a bit in the Points data structure to indicate the end of a Part (i.e. the Most Significant Bit (MSB) in the exemplary embodiment of ), as described in greater detail below.",{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 4B","FIGS. 14 and 15"],"b":["100","100"]},"As discussed above, the Maplet Index Data Structure is identical to the Maplet Data Structure except that the DEntries contain no Points (i.e. set of data Points (oPoints) or Labels) and are therefore all exactly 12 bytes.  and Table F show the equivalent Maplet Index for the Maplet shown in , including the size of the Maplet Index file (92 bytes), which is significantly less than the size of the complete Maplet (544 bytes).",{"@attributes":{"id":"p-0052","num":"0051"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"center"}}],"thead":{"row":[{"entry":[{},"TABLE F"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Map ID","\u20024 bytes"]},{"entry":[{},"# of Layers","\u20024 bytes"]},{"entry":[{},"Layer Entry #1","20 bytes"]},{"entry":[{},"Layer Entry #2","20 bytes"]},{"entry":[{},"DEntry #1 of Layer #1","12 bytes"]},{"entry":[{},"Layer #1 Separator","\u20024 bytes"]},{"entry":[{},"Dentry #1 of Layer #2","12 bytes"]},{"entry":[{},"Dentry #2 of Layer #2","12 bytes"]},{"entry":[{},"Separator for Layer #2","\u20024 bytes"]},{"entry":[{},"Total for Maplet Index","92 bytes"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}}},"In this example, each Layer Entry is 20 bytes long and consists of 6 fields as shown in  and Table G, below, including attributes used for rendering DEntries associated with that Layer Entry on a display of mobile device . In this example, the DEntry rendering attributes are part of and associated with a particular Layer Entry but could alternatively be located within a different portion of the Maplet Index data structure and be associated with either more than one or all of the Layer Entries or specific DEntries of a particular Maplet. In the example of Table G, the rendering attributes include a zoom index, a shape type, a line type and a color field but it is understood that the number and type of attributes used may be customized to meet different rendering requirements. Also, in Table G, it should be noted that Latitude and Longitude are specified in decimal degrees with 5 decimal places of accuracy ( 1\/100,000of a degree). The Bottom Left Latitude and Longitude of the Layer are identical to the Bottom Left Latitude and Longitude of the Maplet. The address of the 1DEntry of the Layer is calculated as follows: 1DEntry Address for Layer=Maplet Base Address+8+(# of Layers)*20+DOFFSET.",{"@attributes":{"id":"p-0054","num":"0053"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE G"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},{},{},"#",{}]},{"entry":[{},{},{},"of",{}]},{"entry":["Field","Type","Sub-Field","bits","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["LID","Unsigned 16",{},{},"Layer ID. See Table below for IDs."]},{"entry":[{},"bit word",{},{},{}]},{"entry":["ATTR1","Unsigned 16","DECNT","8","DEntry Count. # of DEntrys in this Layer."]},{"entry":[{},"bit word",{},{},{}]},{"entry":[{},{},"DETYPE","4","DEntry Type. One of the following:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DETYPE","Value","Description"]},{"entry":[{},"DETYPE_OPOINT","0","DEntry is a set of Points"]},{"entry":[{},"DETYPE_LABEL","1","DEntry is a Label"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},"RESERVED","4","Reserved for Future Use"]},{"entry":["BL_X","Signed 32 bit","\u2014",{},"Longitude of Bottom Left corner of the Layer"]},{"entry":[{},"word",{},{},{}]},{"entry":["BL_Y","Signed 32 bit","\u2014",{},"Latitude of Bottom Left corner of the Layer"]},{"entry":[{},"word",{},{},{}]},{"entry":["DOFFSET","Signed 32 bit",{},{},"Relative Offset of the 1DEntry of the Layer"]},{"entry":[{},"word",{},{},{}]},{"entry":["ATTR2","Unsigned 32","ZORDER","7","Range = [0:127]"]},{"entry":[{},"bit word",{},{},"ZORDER determines the order of rendering the Layer. Layers"]},{"entry":[{},{},{},{},"are rendered from ZORDER = 0 first to ZORDER = 127 last."]},{"entry":[{},{},"ZOOMOFF","5","Range = [0:31]"]},{"entry":[{},{},{},{},"ZOOMOFF specifies the ZOOM LEVEL that the Layer Data is no"]},{"entry":[{},{},{},{},"longer displayed."]},{"entry":[{},{},"ZOOMON","5","Range = [0:31]"]},{"entry":[{},{},{},{},"ZOOMON specifies the ZOOM LEVEL that the Layer Data is first"]},{"entry":[{},{},{},{},"displayed."]},{"entry":[{},{},"ZOOMINDEX","4","ZOOMINDEX is used to scale the Point Data for the Layer. All"]},{"entry":[{},{},{},{},"Points within a DEntry are scaled as follows:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ZOOMINDEX","Scaling","Left Shift"]},{"entry":[{},"0","\u00d74","\u20022 bits"]},{"entry":[{},"1","\u00d764","\u20026 bits"]},{"entry":[{},"2","\u00d71024","10 bits"]},{"entry":[{},"3","\u00d716384","14 bits"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"STYPE","3","Shape Type. Determines how to render the DEntry data. Point,"]},{"entry":[{},{},{},"Arc and Polygon types consist of a set of Points and Label"]},{"entry":[{},{},{},"consists of a Label Data Structure (see DEntry)."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"STYPE","Value","Description"]},{"entry":[{},"SHPT_POINT","1","DEntry is a Point"]},{"entry":[{},"SHPT_ARC","3","DEntry is a Line"]},{"entry":[{},"SHPT_POLYGON","5","DEntry is a Polygon"]},{"entry":[{},"SHPT_LABEL","7","DEntry is a Label"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LTYPE","4","Line Type. Determines how to render the line. Currently this"]},{"entry":[{},{},{},"represents a thickness."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LTYPE","Value","Description"]},{"entry":[{},"LINE_TYPE_1PXL","0","1 pixel line width"]},{"entry":[{},"LINE_TYPE_2PXL","1","2 pixel line width"]},{"entry":[{},"LINE_TYPE_3PXL","2","3 pixel line width"]},{"entry":[{},"LINE_TYPE_NULL","3","No Line Type"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"COLOR","4","Rendering Color. Specifies the color used to draw the Layer data."]},{"entry":[{},{},{},"Currently there are 16 colors available which map to RGB 16 bit"]},{"entry":[{},{},{},"values as shown in the table."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Color","Value","RGB16( )"]},{"entry":[{},"CLEAR","0","(00, 00, 00)"]},{"entry":[{},"DRED","1","(24, 00, 00)"]},{"entry":[{},"LGREEN","2","(18, 31, 18)"]},{"entry":[{},"WATERBLUE","3","(16, 20, 31)"]},{"entry":[{},"BLACK","4","(00, 00, 00)"]},{"entry":[{},"GREY","5","(26, 26, 26)"]},{"entry":[{},"LRED","6","(31, 28, 28)"]},{"entry":[{},"DGREY","7","(18, 18, 18)"]},{"entry":[{},"LGREY","8","(28, 28, 28)"]},{"entry":[{},"RED","9","(31, 00, 00)"]},{"entry":[{},"GREEN","10","(00, 28, 00)"]},{"entry":[{},"YELLOW","11","(31, 31, 00)"]},{"entry":[{},"BLUE","12","(00, 00, 31)"]},{"entry":[{},"MAGENTA","13","(31, 00, 31)"]},{"entry":[{},"CYAN","14","(00, 31, 31)"]},{"entry":[{},"WHITE","15","(31, 31, 31)"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"Table H depicts a list of exemplary Layers and respective Layer IDs.",{"@attributes":{"id":"p-0056","num":"0055"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}}],"thead":{"row":[{"entry":[{},"TABLE H"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]},{"entry":[{},{},"LAYER ID","Value"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},"LID_ROOT","0xDE00"]},{"entry":[{},{},"LID_PARKING","0xDE01"]},{"entry":[{},{},"LID_AUTOSVC","0xDE02"]},{"entry":[{},{},"LID_SHOPPING","0xDE03"]},{"entry":[{},{},"LID_BANKS","0xDE04"]},{"entry":[{},{},"LID_HOSPITALS","0xDE05"]},{"entry":[{},{},"LID_PARKS","0xDE06"]},{"entry":[{},{},"LID_PLACES_1K","0xDE07"]},{"entry":[{},{},"LID_PLACES_BIG","0xDE08"]},{"entry":[{},{},"LID_PLACES","0xDE09"]},{"entry":[{},{},"LID_MAPLETS","0xDE0A"]},{"entry":[{},{},"LID_RAILROADS","0xDE0B"]},{"entry":[{},{},"LID_RESTAURANTS","0xDE0C"]},{"entry":[{},{},"LID_DESTINATIONS","0xDE0D"]},{"entry":[{},{},"LID_TRANSPORTATION","0xDE0E"]},{"entry":[{},{},"LID_LANDMARKS","0xDE0F"]},{"entry":[{},{},"LID_WATERPOLY","0xDE10"]},{"entry":[{},{},"LID_WATERSEG","0xDE11"]},{"entry":[{},{},"LID_DEFAULT","0xDE12"]},{"entry":[{},{},"LID_AREAS","0xDE13"]},{"entry":[{},{},"LID_STREETS","0xDE14"]},{"entry":[{},{},"LID_SECHWYS","0xDE15"]},{"entry":[{},{},"LID_MAJHWYS","0xDE16"]},{"entry":[{},{},"LID_GRID1","0xDE17"]},{"entry":[{},{},"LID_GRID2","0xDE18"]},{"entry":[{},{},"LID_GRID3","0xDE19"]},{"entry":[{},{},"LID_OCEANS","0xDE1A"]},{"entry":[{},{},"LID_MAJHWYSHIELD","0xDE1B"]},{"entry":[{},{},"LID_SECHHWYSHIELD","0xDE1C"]},{"entry":[{},{},"LID_AREA","0xDE1D"]},{"entry":[{},{},"LID_STREETS_12","0xDE1E"]},{"entry":[{},{},"LID_STREETS_34","0xDE1F"]},{"entry":[{},{},"LID_STREETS_5","0xDE20"]},{"entry":[{},{},"LID_C1_LABELS","0xDE21"]},{"entry":[{},{},"LID_C2_LABELS","0xDE22"]},{"entry":[{},{},"LID_C3_LABELS","0xDE23"]},{"entry":[{},{},"LID_C4_LABELS","0xDE24"]},{"entry":[{},{},"LID_C5_LABELS","0xDE25"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"In this example, the DEntry data structure consists of 12 bytes as shown in  and further described in Table I, below. A DEntry specifies the number of Points, the type of Points (i.e. set of data points (oPoints) or a Label) and the bounding box for these Points, with different types of DEntry data being provided (Labels and Points), as described in greater detail below.",{"@attributes":{"id":"p-0058","num":"0057"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"161pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE I"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},{},{},"# of",{}]},{"entry":["Field","Type","Sub-Field","bits","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"char","char":"."}},{"@attributes":{"colname":"5","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ATTR1","Unsigned 32","RESERVED","8","Reserved for Future Use"]},{"entry":[{},"bit word",{},{},{}]},{"entry":[{},{},"NPOINTS","12","# of Points in the DEntry"]},{"entry":[{},{},"DETYPE","4","DEntry Type. One of the following:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DETYPE","Value","Description"]},{"entry":[{},"DETYPE_OPOINT","0","DEntry is a set of"]},{"entry":[{},{},{},"Points"]},{"entry":[{},"DETYPE_LABEL","1","DEntry is a Label"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"char","char":"."}},{"@attributes":{"colname":"5","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},"KEY","8","0xA1 Identifies Structure as a DEntry"]},{"entry":["OBL_X","Signed 16 bit","\u2014",{},"Offset Longitude of Bottom Left corner of the DEntry"]},{"entry":[{},"word",{},{},{}]},{"entry":["OBL_Y","Signed 16 bit","\u2014",{},"Offset Latitude of Bottom Left corner of the DEntry"]},{"entry":[{},"word",{},{},{}]},{"entry":["OTR_X","Signed 16 bit","\u2014",{},"Offset Longitude of Top Right corner of the DEntry"]},{"entry":[{},"word",{},{},{}]},{"entry":["OTR_Y","Signed 16 bit","\u2014",{},"Offset Latitude of Top Right corner of the DEntry"]},{"entry":[{},"word"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"It should be noted that in this example, the offset Latitude and Longitude representing the boundary box are specified in decimal degrees with 5 decimal places of accuracy ( 1\/100,000of a degree). The Bottom Left Latitude and Longitude of a DEntry are added to the Bottom Left Latitude and Longitude of the Layer to obtain the absolute Latitude and Longitude.","According to an exemplary embodiment, there are two types of data (specified by the DETYPE field): oPoints and strLabels. oPoints are used to represent and reconstruct a point, line or polygon, whereas the strLabel data structure is used to represent label data.","The oPoint data structure is illustrated in  and described in Table J, below, while the strLabel data structure is illustrated in  and described in Table L.",{"@attributes":{"id":"p-0062","num":"0061"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"63pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE J"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},{},{},"# of",{}]},{"entry":["Field","Type","Sub-Field","bits","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"char","char":"."}},{"@attributes":{"colname":"5","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["TTX","Unsigned 16 bit","X","15","Relative Offset"]},{"entry":[{},"word",{},{},"Longitude of Point"]},{"entry":[{},{},{},{},"from previous Point"]},{"entry":[{},{},"ENDOFPART","1","1 = End of Part"]},{"entry":["TTY","Unsigned 16 bit","Y","15","Relative Offset"]},{"entry":[{},"word",{},{},"Latitude of Point"]},{"entry":[{},{},{},{},"from previous Point"]},{"entry":[{},{},"ENDOFGREF","1","1 = End of GREF or"]},{"entry":[{},{},{},{},"End of"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"In  and Table J, X and Y are relative offsets in Longitude and Latitude respectively from the previous oPoint. The first oPoint is relative to the bottom left coordinates of the DEntry. It should be noted that the X and Y co-ordinates are first scaled by a Zoom Scale which is determined by the ZOOMINDEX of the Layer Entry. The ZOOMINDEX and scaling (Zoom Scale) are shown in Table K, below (extracted from Table G).",{"@attributes":{"id":"p-0064","num":"0063"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"91pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE K"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["ZOOMINDEX","Scaling","Left Shift"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["0","\u00d74","\u20022 bits"]},{"entry":["1","\u00d764","\u20026 bits"]},{"entry":["2","\u00d71024","10 bits"]},{"entry":["3","\u00d716384","14 bits"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The ENDOFPART bit is used to separate the individual Points in the series of Points of a DEntry. When the ENDOFPART bit is set it indicates that a particular Point is the last in a series of connected Points. This informs the map application within device  that instead of drawing a line to the next point, it should move to the next point (without drawing a line). The reason this bit is needed is because within a DEntry (which is essentially an area) there will be multiple lines or polygons or points with the DEntry. This bit is used to separate the shapes.","The ENDOFGREF bit is used only for a series of points that represent a polygon (STYPE=SHPT_POLYGON) to indicate that the next part is a \u201cHole Polygon\u201d, rather than a regular Polygon. A Hole Polygon is needed since certain areas (represented by polygons) may have holes in them (e.g. a section of a river (represented by a polygon) with an island in the middle (represented by a hole polygon)).","If both ENDOFPART and ENDOFGREF are set then the next polygon is a hole polygon. If only the ENDOFPART bit is set then the next polygon is a regular polygon.","Table L describes the fields depicted in the strLabels data structure of , as follows:",{"@attributes":{"id":"p-0069","num":"0068"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"63pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE L"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},{},"Sub-","# of",{}]},{"entry":["Field","Type","Field","bits","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"char","char":"."}},{"@attributes":{"colname":"5","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["X","Signed 32 bit word",{},"32","Longitude of Label"]},{"entry":["Y","Signed 32 bit word",{},"32","Latitude of Label"]},{"entry":["FAC_TYPE","Unsigned 16 bit word",{},"16","Reserved"]},{"entry":["PRIORITY","Unsigned 16 bit word",{},"16","Reserved"]},{"entry":["TEXT","Character Array",{},"192","Label"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"In this example, the strLabel Point consists of an X and Y Longitude and Latitude value and 24 Characters of the Label Text. The X and Y co-ordinates provide an exact location to plot the label.","According to an exemplary embodiment, the typedef statements for the Layer Entry, DEntry, Point, and Label data structures are as follows:",{"@attributes":{"id":"p-0072","num":"0071"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Layer Entry:"]},{"entry":[{},"\u2003\u2003typedef struct {"]},{"entry":[{},"\u2003\u2003\u2003u16 id;"]},{"entry":[{},"\u2003\u2003\u2003union {"]},{"entry":[{},"\u2003\u2003\u2003\u2003u16 attr1;"]},{"entry":[{},"\u2003\u2003\u2003\u2003struct{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u16","unused:","4;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u16","detype:","4;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u16","decnt:","8;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003s32 \u2003\u2003bl_x;"]},{"entry":[{},"\u2003\u2003\u2003s32 \u2003\u2003bl_y;"]},{"entry":[{},"\u2003\u2003\u2003s32 \u2003\u2003doffset;"]},{"entry":[{},"\u2003\u2003\u2003union {"]},{"entry":[{},"\u2003\u2003\u2003\u2003u32 attr2;"]},{"entry":[{},"\u2003\u2003\u2003\u2003struct{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","color:","4;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","ltype:","4;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","stype:","3;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","zoomindex:","4;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","zoomon:","5;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","zoomoff:","5;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u32","zorder:","7;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003} strLayerEntry;"]},{"entry":[{},"DEntry:"]},{"entry":[{},"\u2003\u2003typedef struct {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003union {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003u32 \u2003attr1;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003struct{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003u32","key:","8;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003u32","detype:","\u2003\u20034;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003u32","npoints:","12;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003u32","AliasEnable:","1;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003u32","AliasDEntry:","5;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003union {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003s16","obl_x;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003s16","Maplet_x;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003};"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u2003\u2003\u2003\u2003\u2003union {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003s16","obl_y;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003s16","Maplet_y;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003s16","otr_x;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003s16","otr_y;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003} strDEntry;"]},{"entry":[{},"Point:"]},{"entry":[{},"\u2003\u2003\u2003typedef struct {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003union {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"u16 \u2003\u2003ttx;"]},{"entry":[{},"struct{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"u16","EndOfPart: 1;"]},{"entry":[{},"u16","x: 15;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"};"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003union {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"u16 tty;"]},{"entry":[{},"struct{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"u16","EndOfGRef: 1;"]},{"entry":[{},"u16","y: 15;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"};"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003\u2003\u2003\u2003};"]},{"entry":[{},"\u2003\u2003\u2003} oPoint;"]},{"entry":[{},"Label:"]},{"entry":[{},"\u2003\u2003\u2003typedef struct {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003s32 \u2003x;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003s32 \u2003y;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u16 \u2003fac_type;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003u16 \u2003priority;"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003char \u2003text[24];"]},{"entry":[{},"\u2003\u2003\u2003} strLabel;"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 11","b":["100","121"]},"The provision of location based services (LBS) uses a client-service architecture where the client component comprises a map application  running on the mobile device  for providing the end-user with the capability to perform location-related tasks. Although the server component is shown residing on public LBS server , it may also reside either on a corporate enterprise server (such as server  shown in ), or a corporate LBS server (such as server  shown in ). The server component houses location-related data, contains the business logic to manipulate this data and fulfills LBS requests from the client . Also, as shown in , the map application  is capable of meshing map data from multiple servers .","Communications between the mobile communication device  and each server  are either http-based or TCP\/IP socket-based. The former is used for LBS data requests and device location reporting initiated by the device  and are exchanged as messages over the network carrier , Internet connection and the public Network Operations Center (NOC) or corporate enterprise server  (). These communications adhere to a set of well-to find LBS communications protocols supporting both single and batch requests, as discussed in greater detail below.","In addition, the LBS system preferably interfaces with external systems such as a Data Authority (not shown) to obtain and synchronize location data, as well as to provide an administrative interface for a system administrator to configure the LBS server .","As discussed briefly above in connection with , mobile communication device  is preferably a two-way communication device having at least voice and advanced data communication capabilities, including the capability to communicate with other computer systems. Depending on the functionality provided by mobile communication device , it may be referred to as a data messaging device, a two-way pager, a cellular telephone with data messaging capabilities, a wireless Internet appliance, or a data communication device (with or without telephony capabilities). Mobile communication device  may communicate with any one of a plurality of LBS servers  within its geographic coverage area, as discussed above in connection with .","Mobile communication device  will normally incorporate a transceiver , which includes a receiver, a transmitter, and associated components, such as an antenna . As will be apparent to those skilled in the field of communications, particular design of transceiver  depends on the communication network in which the mobile communication device  is intended to operate.","Mobile communication device  may send and receive communication signals over the network after required network registration or activation procedures have been completed. Signals received by antenna  through the network are input to transceiver , which may perform such common receiver functions as signal amplification, frequency down conversion, filtering, channel selection, analog-to-digital (A\/D) conversion, and the like. A\/D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed. In a similar manner, signals to be transmitted or processed, including modulation and encoding, for example via a Digital Signal Processor (not shown). These DSP-processed signals are input to transceiver  for digital to analog (D\/A) conversion, filtering, amplification and transmission over communication network via antenna .","Network access is associated with a subscriber or user of a mobile communication device , and therefore mobile communication device  requires a Subscriber Identity Module or \u201cSIM\u201d card  to be inserted in a SIM interface (not shown) in order to operate in the network. Mobile communication device  is a battery-powered device so it also includes a battery interface for receiving one or more rechargeable batteries . Such a battery  provides electrical power to most if not all electrical circuitry in mobile communication device , and the battery interface (not shown) provides for a mechanical and electrical connection.","Mobile communication device  includes a microprocessor  which controls overall operation. Communication functions, including at least data and voice communications, are performed through transceiver . Microprocessor  also interacts with additional device subsystems such as a display , a flash memory , a random access memory (RAM) , a keyboard , a speaker , a microphone , and any other device subsystems that may be desirable such as auxiliary input\/output (I\/O) subsystems, serial port, and\/or short-range communications.","Operating system software  used by microprocessor  is preferably stored in a persistent store such as flash memory , which may alternatively be a read-only memory (ROM) or similar storage element (not shown). Those skilled in the art will appreciate that the operating system, specific device applications, or parts thereof, may be temporarily loaded into a volatile store such as RAM .","Microprocessor , in addition to its operating system functions, preferably enables execution of software applications on mobile communication device . A predetermined set of applications which control basic device operations, including at least data and voice communication applications, will normally be installed on mobile communication device  during its manufacture. A preferred application that may be loaded onto mobile communication device  may be a personal information manager (PIM) application having the ability to organize and manage data items relating to the user such as, but not limited to, e-mail, calendar events, voice mails, appointments, and task items. Naturally, one or more memory stores are available on mobile communication device  and SIM  to facilitate storage of PIM data items and other information.","As discussed above, memory  includes a plurality of applications or routines (associated with visually displayed icons) for the processing of data. These applications may be in any of a variety of forms such as, without limitation, software, firmware, and the like, including, for example, an e-mail application , a calendar application , an address book application , a tasks application , a memo application , and a search application . An operating system (OS) program  also resides in memory . The mobile communication device  of the present disclosure is also adapted to render visual maps in its visual display , and utilizes a map application  stored in memory  to facilitate map rendering and related functionality. Preferably, map application  incorporates several functional modules including a Map Viewer , a Route Module , and a Locate Module , as shown in .","Map Viewer  receives Latitude and Longitude data as inputs from any one or more of multiple sources, such as Point of Interest (POI) servers, local cache, embedded GPS units, etc. The Map Viewer  uses the Latitude and Longitude data as arguments to render map graphics (either cached or requested from server , as discussed above).","Locate Module  converts street or civic addresses to Latitude and Longitude coordinates through a Locate Server or other device that may or may not be part of LBS server .","Route Module converts a pair of \u201cto\u201d and \u201cfrom\u201d coordinates (i.e. civic or street addresses) to a pair of Latitude and Longitude coordinates, and also generates a set of decision points (e.g. left, right, etc.) at relevant intersections to enable rendering by way of graphics on Map Viewer , or to provide turn-by-turn directions in text format.","The Map Viewer , Route Module  and Locate Module  constitute but one example of a number of possible implementations of Map Application , all of which would be obvious to a person of ordinary skill in the art.","As shown in , a user may search for an address book entry (), click the device thumbwheel to select and view a home map for that address book entry ((), which results in the Map Viewer Module  displaying the home address for the address book entry ((). If the user clicks the thumbwheel again and selects to review the work map for that address book entry ((), the Map Viewer Module  displays the work address for the address book entry (().","With reference to , user interaction with a graphical user interface is described for the purpose of displaying map data embedded in an e-mail message. In , an e-mail is received. The user opens the e-mail () by manipulating a thumbwheel or other user input device. In the event that the e-mail contains a map URL (), the user can select the map URL () and click a \u201cView Map\u201d menu item (), in response to which the Map Viewer Module  displays the map embedded in the e-mail ().","In , user interaction with the device client graphical user interface is shown for the purpose of embedding map data into an e-mail message. In , the user is viewing a displayed map on device . The user selects an \u201cE-Mail Location\u201d menu item () by manipulating a thumbwheel or other user input device. An e-mail message is then created with the map URL embedded in the body of the message (). The e-mail is addressed () and then sent to its intended recipient ().","Returning briefly to , the Map Viewer Module  links all other LBS modules (i.e. Locate Module , Route module ) together for the purpose of displaying a map with points of interest to the user; labeling and highlighting the map data; supporting interactive map use (e.g. pan\/zoom, search, etc.); supporting integration with LBS-enabled applications (Address Book , Email ); and maintaining a persistent storage (cache) of previously viewed maps. Map data is stored into the local cache store prior to exiting the module. If a map of a location requested for a particular zoom level is not available in the local cache store but a map of the same or generally the same location is available at another, for example, coarser zoom level (i.e. the device may have previously cached map data at a different zoom level but the map data requested is for a zoom level that is not available in the cache), Map Viewer Module , takes the best available map (e.g. coarser map for another zoom level, if available) and displays it to the user while querying the server  with a Maplet Index request and optionally an AOI request for the detailed map (background process). If there are no maps to display, Map Viewer Module  depicts an hour glass with a modal message box (e.g. \u201cAwaiting response from server . . . \u201d). Map Viewer Module  is also responsible for managing waypoints and querying the LBS server  for map data.","As discussed above in connection with , the following three query scenarios may be supported in this example, wherein Map Application  running on mobile device  queries the LBS server  for map data: (1) Maplet Index request: Get Maplet Indexes within an indicated field of view or bounding box (2) DEntry or data request: Get DEntry data for these Maplet Indexes and (3) AOI data request: Get all map data at predetermined or selected layers within an area of interest or bounding box which is typically the current field of view for device  (independently of obtaining the Maplet Indexes).","In operation, with reference to  in conjunction with , in response to a new \u201cgo to\u201d request (step ), the Map Application  checks its local store (i.e. cache ) to see if it already has the Maplet Index for a particular location (step ). The new \u201cgo to\u201d request may be generated in response to the user of mobile communication device  moving into a new geographical area, selection of the \u201cView Map\u201d menu item in the Address Book , or other action). Also, it will be understood that the map application  may require Maplet Indexes for more than one Maplet. Thus, with reference to the exemplary scenario of  the user's field of view overlaps four Maplets such that Maplet Indexes are required from each of the four Maplets.","If the requested map data is not already stored in the local cache, the Map Application  takes the best available map and displays it to the user and at the same time generates a Maplet Index request (step ). Optionally, the map application  may also simultaneously generate an AOI request for DEntries for a specified set of Layers (if they exist) in a given area (bounding box) specified in the request from mobile communication device , which results in faster downloading and rendering of coarse-level map data. An advantage of generating the AOI request simultaneously with the Maplet Index request is that map server  is accessed only once.","The map server (or multiple servers)  retrieves the requested Maplet Indexes (and optionally the AOI data) for the four maplets from its associated location data repository, and collates the results to build the \u201cMaplet Index (and optionally the AOI) Response Message\u201d (). Finally, the server  returns the Maplet Index with\/without the AOI Response Message to the device .","After rendering map data resulting from an AOI request, the downloaded Maplet Index data may be used to further refine the rendered map information through subsequent DEntry requests.","Specifically, upon receiving the Maplet Index Response Message, or in the event the cache  already contains the Maplet Indexes, the Map Application  determines what DEntries (map data) it needs (based, for example, on user context, preferences, etc., as discussed above), and then generates the list of the DEntries associated with the specified field of view (step ).","For each DEntry in the cache (step ) the Map Application  assembles the data and displays the map of the selected location on the screen of device  (step ), as shown for example in , E, etc.","If the requested DEntries are not already stored in the local cache , then the Map Application  generates a DEntry request (step ) and, upon receipt of the requested DEntries then renders the map graphic (step ).","To summarize the operational steps set forth above, a Maplet Index request is first generated, followed by specific DEntry requests based on knowledge of the Maplets resulting from the contents of the downloaded Maplet Indexes. In some instances (such as when the mobile device  moves into a new geographical area), the Maplet Index request may be accompanied by an AOI request so that a coarse map graphic may be quickly rendered within the new field of view (e.g. for particular layers of the Maplet) followed by additional DEntry requests based on the downloaded Maplet Index, for further refining the rendered map graphic (e.g. to obtain data Points representing artifacts and labels from additional layers of the Maplet).","A person skilled in the art, having read this description may conceive of variations and alternative embodiments. For example, it is contemplated that Maplet Indexes may be pre-loaded onto mobile communication device  so as to be available at all times, rather than requiring downloading from the server .","All such variations and alternative embodiments are believed to be within the ambit of the claims appended hereto."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["A detailed description of an exemplary embodiment is set forth in detail below, with reference to the following drawings, in which:",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 4A","FIG. 4B"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 6","FIGS. 4 and 5"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIG. 7","FIG. 3"]},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 8","FIG. 3"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 9","FIG. 3"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 10","FIG. 3"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 11A","FIG. 11B"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIGS. 12A-12E","FIG. 11"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIGS. 13A-13K","FIG. 11"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 15","FIG. 14"]}]},"DETDESC":[{},{}]}
