---
title: Systems and methods for detecting a process to establish a backdoor connection with a computing device
abstract: A computer-implemented method for detecting a process to establish a backdoor connection with the computer is described. An application programming interface (API) is hooked. Calls to the hooked API are monitored. A call directed to the hooked API is intercepted. The call instructs the API to initiate a user interface. Structures included in the intercepted call are analyzed. The intercepted call is prevented from arriving at the hooked API if the structures are directed to a socket on the computer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08683576&OS=08683576&RS=08683576
owner: Symantec Corporation
number: 08683576
owner_city: Mountain View
owner_country: US
publication_date: 20090930
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY","DETAILED DESCRIPTION OF EXEMPLARY EMBODIMENTS"],"p":["The use of computer systems and computer-related technologies continues to increase at a rapid pace. This increased use of computer systems has influenced the advances made to computer-related technologies. Indeed, computer systems have increasingly become an integral part of the business world and the activities of individual consumers. Computer systems may be used to carry out several business, industry, and academic endeavors. The wide-spread use of computers has been accelerated by the increased use of computer networks, including the Internet. Many businesses use one or more computer networks to communicate and share data between the various computers connected to the networks. The productivity and efficiency of employees often requires human and computer interaction.","Computer technologies used by consumers and by the business world continue to demand that the efficiency of these technologies increase. These demands have included demands to improve security related to sensitive information that may be shared between users of computers. For example, a user may desire to protect certain content that is shared with other users such that the content is not altered, deleted, shared with unauthorized users, etc.","Malicious users of computing devices may attempt to remotely control another computing device. These users may desire to gain control of another device in order to obtain access to sensitive information that may be stored within the attacked computing device. Remote control of a computing device may be achieved through backdoor connections such that the user of the controlled device is not aware that a malicious user has gained access to his\/her computing device.","From the above discussion, benefits may be realized by providing systems and methods for detecting and preventing unwanted control of a computing device by another device. In particular, benefits may be realized by providing systems and methods for detecting a process to establish a backdoor connection with a computing device.","According to at least one embodiment, a computer-implemented method for detecting a process to establish a backdoor connection with the computer is described. An application programming interface (API) is hooked. Calls to the hooked API are monitored. A call directed to the hooked API is intercepted. The call instructs the API to initiate a user interface. Structures included in the intercepted call are analyzed. The intercepted call is prevented from arriving at the hooked API if the structures are directed to a socket on the computer.","In one embodiment, the hooked API may be a CreateProcess API. The structures included in the intercepted call may include STARTUPINFO structures. In one embodiment, the STARTUPINFO structures include standard input (hStdInput), standard output (hStdOutput), and standard error (hStdError) structures.","The user interface may be a shell command prompt. The occurrence of the intercepted call may be reported to a security product. In one configuration, the security product is installed on a server in communication with the computer via a network connection. The intercepted call may be used to implement a bindshell process.","A computer system configured to detect a process to establish a backdoor connection with the computer system is also described. The computer system may include a processor and memory in electronic communication with the processor. The computer system may also include a detection module configured to hook an application programming interface (API), and monitor calls to the hooked API. The detection module may also be configured to intercept a call directed to the hooked API. The call may instruct the API to initiate a user interface. The detection module may be further configured to analyze structures included in the intercepted call, and prevent the intercepted call from arriving at the hooked API if the structures are directed to a socket on the computer.","A computer-program product for detecting a process to establish a backdoor connection with a computer is also described. The computer-program product may include a computer-readable medium having instructions thereon. The instructions may include code programmed to hook an application programming interface (API), and code programmed to monitor calls to the hooked API. The instructions may also include code programmed to intercept a call directed to the hooked API. The call may instruct the API to initiate a user interface. The instructions may further include code programmed to analyze structures included in the intercepted call, and code programmed to prevent the intercepted call from arriving at the hooked API if the structures are directed to a socket on the computer.","Features from any of the above-mentioned embodiments may be used in combination with one another in accordance with the general principles described herein. These and other embodiments, features, and advantages will be more fully understood upon reading the following detailed description in conjunction with the accompanying drawings and claims.","While the embodiments described herein are susceptible to various modifications and alternative forms, specific embodiments have been shown by way of example in the drawings and will be described in detail herein. However, the exemplary embodiments described herein are not intended to be limited to the particular forms disclosed. Rather, the instant disclosure covers all modifications, equivalents, and alternatives falling within the scope of the appended claims.","Bindshell is a technique that may be used by malicious parties to open a back door channel (or establish a connection) with an unsuspecting computing device. In one example, this technique may allow the malicious party to gain remote access to the computing device in order to carry out certain malicious attacks on the device. The attacking entity, for example, may call a specific application programming interface (API) to launch a shell user interface on the unsuspecting computing device. The call may include instructions that instruct certain data structures used by the shell user interface to be pointed to a particular socket within the computing device. The attacking computing device may then bind to that particular socket in order to have remote access to the filesystem of the unsuspecting computing device. The present systems and methods may provide a technique to intercept the calls to the API to launch the shell user interface. The present systems and methods may also analyze the data structures associated with the call in order to determine if the shell user interface is directed to point the data structures to a socket within the unsuspecting computing device.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1","b":["102","104","104","102","124","102","104"]},"In one example, the second computing device  may include a call generation module  that may generate a call to send to the first computing device . In one configuration, the call generation module  may include a structure specification module . In one embodiment, the structure specification module  may specify or insert data structures or other instructions in the message being sent to the first computing device .","The first computing device  may include application programming interfaces (APIs) . The APIs  may include a socket  that may be used by the first computing device  to connect to a network, another device to receive\/transmit information, and the like. The APIs  may launch or execute various applications and\/or processes within the first computing device . For example, the APIs  may launch a shell user interface . The shell user interface  may interact with a user to receive commands to execute on the first computing device . In addition, the first computing device  may include a filesystem  that may be an organization of directories and subdirectories stored within the first computing device .","In one embodiment, the first computing device  may also include a detection module . The detection module  may detect calls sent from the second computing device . In one example, the detection module  may include a hooking module  and an analyzing module . The hooking module  may hook into the APIs  in order to intercept calls sent from the second computing device  before the calls reach the APIs . The analyzing module  may analyze certain data structures included with the intercepted call.",{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2","b":["204","202","204","212","202","224","204","220","220","226","226","222","226","228"]},"The first computing device  may include one or more APIs . Examples of APIs may include a CreateProcess API . The APIs  may also include a socket  for receiving and transmitting information. In one embodiment, the CreateProcess API  may launch a shell user interface . An example of a shell user interface that may be launched with a CreateProcess API  may be a \u201ccmd.exe\u201d executable program.","In one configuration, the first computing device  may also include a detection module  that may detect calls originating from the second computing device . For example, the detection module  may detect \u201cbindshell\u201d calls sent from the second computing device . In one embodiment, the detection module  may include a hooking module  that may allow the detection module  to hook the APIs . In particular, the hooking module  may include a CreateProcess hook  that hooks the CreateProcess API . In addition, the detection module  may include an analyzing module  that analyzes certain structures included with calls generated by the second computing device . In one embodiment, the analyzing module  may include a STARTUPINFO structure Analyzer . The structure analyzer  may analyze the STARTUPINFO  included with the CreateProcess call . Examples of the STARTUPINFO structures  may include standard input (hStdInput), standard output (hStdOutput), and standard error (hStdError).",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 3","b":["302","340","324","302","314","314","316","330","314","318","318","332","332"]},"In a further embodiment, the detection module  may include a reporting module . The reporting module  may transmit information regarding the call received from the other computing device (not shown) to the server . In one configuration, the server  may include security protocols . In one configuration, the security protocols  may include a bindshell identifying module . The identifying module  may identify shell back door channels that may exist or potentially exist on the computing device . In other words, the bindshell identifying module  may allow security protocols  to become aware of the other computing device (not shown) that sent the call. In one configuration, the protocols  may then take appropriate action to prevent the other computing device (not shown) from remotely controlling the computing device  over the network .",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 4","b":["400","114"]},"In one embodiment, an application program interface (API) may be hooked . For example, a CreateProcess API may be hooked  so that calls to the CreateProcess API may be intercepted. In one configuration, calls to the hooked API may be monitored . A call directed to the hooked API in order initiate a shell user interface may be intercepted . For example, a CreateProcess call may be directed to the CreateProcess API. The CreateProcess call may instruct the CreateProcess API to launch or initiate a shell user interface. An example of the shell user interface may be a \u201ccmd.exe\u201d executable program.","In one embodiment, structures included with the call may be analyzed . A determination  may be made as to whether these structures are directed to a socket. For example, the STARTUPINFO structures may be included with the CreateProcess call. The structures may be analyzed  to determine if they are being directed to a socket. Examples of the structures may include hStdInput, hStdOutput, and hStdError. In one embodiment, if it is determined  that the structures included in the call are directed to a socket, the call may be prevented  from arriving at the API. In other words, the CreateProcess call to the hooked CreateProcess API may be blocked. In addition, the occurrence of the intercepted call may be reported  to a security product. In one example, the security product may reside on a computing device  or on a server in communication with the computing device .","If, however, it is determined  that the structures included with the intercepted call are not being redirected to a socket, the method  may return to monitor for calls directed to the API. As a result, bindshell techniques may be detected via hooking an API, such as a CreateProcess API, and analyzing the STARTUPINFO structures included with the call to determine if a shell process is directed or instructed to redirect hStdInput, hStdOutput, and\/or hStdError to a socket of the computing device . If the STARTUPINFO structures are successfully redirected to a socket of the computing device, an attacking computing device may remotely control the filesystem of the computing device.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 5","b":["510","510","512","510","514","517","518","520","522","524","526","528","530","532","533","534","537","538","535","590","535","539","540","542","546","512","528","547","512","530","548","512"]},"Bus  allows data communication between central processor  and system memory , which may include read-only memory (ROM) or flash memory (neither shown), and random access memory (RAM) (not shown), as previously noted. The RAM is generally the main memory into which the operating system and application programs are loaded. The ROM or flash memory can contain, among other code, the Basic Input-Output system (BIOS) which controls basic hardware operation such as the interaction with peripheral components. For example, the detection module  to implement the present systems and methods may be stored within the system memory . Applications resident with computer system  are generally stored on and accessed via a computer readable medium, such as a hard disk drive (e.g., fixed disk ), an optical drive (e.g., optical drive ), a floppy disk unit , or other storage medium. Additionally, applications can be in the form of electronic signals modulated in accordance with the application and data communication technology when accessed via network modem  or interface .","Storage interface , as with the other storage interfaces of computer system , can connect to a standard computer readable medium for storage and\/or retrieval of information, such as a fixed disk drive . Fixed disk drive  may be a part of computer system  or may be separate and accessed through other interface systems. Modem  may provide a direct connection to a remote server via a telephone link or to the Internet via an internet service provider (ISP). Network interface  may provide a direct connection to a remote server via a direct network link to the Internet via a POP (point of presence). Network interface  may provide such connection using wireless techniques, including digital cellular telephone connection, Cellular Digital Packet Data (CDPD) connection, digital satellite data connection or the like.","Many other devices or subsystems (not shown) may be connected in a similar manner (e.g., document scanners, digital cameras and so on). Conversely, all of the devices shown in  need not be present to practice the present disclosure. The devices and subsystems can be interconnected in different ways from that shown in . The operation of a computer system such as that shown in  is readily known in the art and is not discussed in detail in this application. Code to implement the present disclosure can be stored in computer-readable storage media such as one or more of system memory , fixed disk , optical disk , or floppy disk . The operating system provided on computer system  may be MS-DOS\u00ae, MS-WINDOWS\u00ae, OS\/2\u00ae, UNIX\u00ae, Linux\u00ae, or another known operating system.","Moreover, regarding the signals described herein, those skilled in the art will recognize that a signal can be directly transmitted from a first block to a second block, or a signal can be modified (e.g., amplified, attenuated, delayed, latched, buffered, inverted, filtered, or otherwise modified) between the blocks. Although the signals of the above described embodiment are characterized as transmitted from one block to the next, other embodiments of the present disclosure may include modified signals in place of such directly transmitted signals as long as the informational and\/or functional aspect of the signal is transmitted between blocks. To some extent, a signal input at a second block can be conceptualized as a second signal derived from a first signal output from a first block due to physical limitations of the circuitry involved (e.g., there will inevitably be some attenuation and delay). Therefore, as used herein, a second signal derived from a first signal includes the first signal or any modifications to the first signal, whether due to circuit limitations or due to passage through other circuit elements which do not change the informational and\/or final functional aspect of the first signal.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 6","b":["600","610","620","630","640","640","610","650","114","640","640","640","660","1","640","660","1","670","680","1","640","640","610","620","630","650","690","670"]},"With reference to computer system , modem , network interface  or some other method can be used to provide connectivity from each of client computer systems ,  and  to network . Client systems ,  and  are able to access information on storage server A or B using, for example, a web browser or other client software (not shown). Such a client allows client systems ,  and  to access data hosted by storage server A or B or one of storage devices A()-(N), B()-(N), ()-(N) or intelligent storage array .  depicts the use of a network such as the Internet for exchanging data, but the present disclosure is not limited to the Internet or any particular network-based environment.","While the foregoing disclosure sets forth various embodiments using specific block diagrams, flowcharts, and examples, each block diagram component, flowchart step, operation, and\/or component described and\/or illustrated herein may be implemented, individually and\/or collectively, using a wide range of hardware, software, or firmware (or any combination thereof) configurations. In addition, any disclosure of components contained within other components should be considered exemplary in nature since many other architectures can be implemented to achieve the same functionality.","The process parameters and sequence of steps described and\/or illustrated herein are given by way of example only and can be varied as desired. For example, while the steps illustrated and\/or described herein may be shown or discussed in a particular order, these steps do not necessarily need to be performed in the order illustrated or discussed. The various exemplary methods described and\/or illustrated herein may also omit one or more of the steps described or illustrated herein or include additional steps in addition to those disclosed.","Furthermore, while various embodiments have been described and\/or illustrated herein in the context of fully functional computing systems, one or more of these exemplary embodiments may be distributed as a program product in a variety of forms, regardless of the particular type of computer-readable media used to actually carry out the distribution. The embodiments disclosed herein may also be implemented using software modules that perform certain tasks. These software modules may include script, batch, or other executable files that may be stored on a computer-readable storage medium or in a computing system. In some embodiments, these software modules may configure a computing system to perform one or more of the exemplary embodiments disclosed herein.","The foregoing description, for purpose of explanation, has been described with reference to specific embodiments. However, the illustrative discussions above are not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations are possible in view of the above teachings. The embodiments were chosen and described in order to best explain the principles of the present systems and methods and their practical applications, to thereby enable others skilled in the art to best utilize the present systems and methods and various embodiments with various modifications as may be suited to the particular use contemplated.","Unless otherwise noted, the terms \u201ca\u201d or \u201can,\u201d as used in the specification and claims, are to be construed as meaning \u201cat least one of.\u201d In addition, for ease of use, the words \u201cincluding\u201d and \u201chaving,\u201d as used in the specification and claims, are interchangeable with and have the same meaning as the word \u201ccomprising.\u201d"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings illustrate a number of exemplary embodiments and are a part of the specification. Together with the following description, these drawings demonstrate and explain various principles of the instant disclosure.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
