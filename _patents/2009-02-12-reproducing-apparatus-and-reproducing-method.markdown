---
title: Reproducing apparatus and reproducing method
abstract: A reproducing apparatus has three reproducing modes that are a first mode, a second mode, and a third mode. In the first mode, when a program that has been reproduction restricted is tried to be reproduced, the reproducing operation is paused and the user is asked whether he or she wants to reproduce the program. Corresponding to the user's reply, the reproducing operation is performed or prohibited. In the second mode, a program that has been reproduction restricted is prohibited from being reproduced. In the third mode, a program that has been reproduction restricted is unconditionally reproduced. When the power of the apparatus is turned on at step S, a prompt that causes the user to select one of the first mode, the second mode, and the third mode is displayed. At step S, a process for designating a mode is performed. Information of the designated mode is stored in a nonvolatile memory.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08755671&OS=08755671&RS=08755671
owner: Sony Corporation
number: 08755671
owner_city: Tokyo
owner_country: JP
publication_date: 20090212
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND ART","DISCLOSURE OF THE INVENTION","BEST MODES FOR CARRYING OUT THE INVENTION","DESCRIPTION OF REFERENCE NUMERALS"],"p":["This is a continuation of application Ser. No. 10\/203,122, filed Nov. 25, 2002, which is a national stage filing under 35 U.S.C. \u00a7371 of PCT\/JP01\/10711, filed Dec. 7, 2001, and claims priority to Japanese Patent Application No. 2000-373153, filed Dec. 7, 2000, all of which are incorporated herein by reference.","The present invention relates to a reproducing apparatus and a reproducing method that are suitable for reproducing a program from a record medium on which both a program that has been reproduction restricted and a program that has not been reproduction restricted (namely, a program that can be freely reproduced) have been recorded.","EEPROM (Electrically Erasable Programmable ROM) that is an electrically rewritable memory requires a large space because each bit is composed of two transistors. Thus, the Integration of EEPROM is restricted. To solve this problem, a flash memory that allows one bit to be accomplished with one transistor using all-bit-erase system has been developed. The flash memory is being expected as a successor of conventional record mediums such as magnetic disks and optical discs.","A memory card using a flash memory is also known. The memory card can be freely attached to an apparatus and detached therefrom. A digital audio recording\/reproducing apparatus that uses a memory card instead of a conventional CD (Compact Disc: Trademark) or MD (Mini Disc: Trademark) can be accomplished.","When a user buys commercially available package software for example a CD, he or she is assured of unlimited duration of reproduction and unlimited number of reproduction times for the package software. On the other hand, as audio and video information is digitized and used as multi media, in recent years, the copyright protection has become important. In the field of information service, digitized audio and video information is recorded on a record medium in such a manner that some restriction information is added thereto. In such a format, information is provided to a user. In addition, a service of which digitized audio and video information to which some reproduction restriction information is added is distributed to each user through a digital broadcast or the Internet has been studied. In such a circumstance, for an advertisement, free audio and video information that has been reproduction restricted with respect to the duration of reproduction and the number of reproduction times may be distributed to each user. In this case, each user can reproduce the audio and video information (called a program or a content) for the duration and the number of reproduction times represented in the reproduction restriction information. When a user wants the audio and video information, he or she can record it to a memory card at a predetermined price.","In such a situation, there is a possibility of which both a program that has not been reproduction restricted (that can freely reproduced) and a program that has been reproduction restricted are recorded on one record medium. When a program is reproduced from such a record medium by a conventional reproducing apparatus, the user will face an inconvenient problem. When the user repeatedly reproduces programs, he or she can freely reproduce a program that has not been reproduction restricted. In contrast, when a program that has been reproduction restricted is reproduced with respect to the number of reproduction times, after the number of reproduction times of the program that has been reproduction restricted exceeds the designated number of reproduction times, the program cannot be reproduced. Thus, there is a case that it is preferred to exclude a program that has been reproduction restricted from a program repeat reproducing operation. In addition, there is a method for asking the user whether or not he or she wants to reproduce a program that has been reproduction restricted. However, when a program that has been reproduction restricted is tried to be reproduced, the reproducing operation is stopped and the user is asked whether or not he or she wants to reproduce it. Thus, the operability of the apparatus deteriorates.","Therefore, an object of the present invention is to provide a reproducing apparatus and a reproducing method that allow the user to designate an operating method for a program that has been reproduction restricted.","To solve the forgoing problem, claim a first aspect of the present disclosure is directed to a reproducing apparatus for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the number of reproduction times and a program that has not been reproduction restricted with respect to the number of reproduction times have been recorded, the record medium having a management area for managing an identifier that represents whether or not a program has been reproduction restricted with respect to the number of reproduction times, the reproducing apparatus comprising:","a determining means for determining whether or not a program to be reproduced has been reproduction restricted with respect to the number of reproduction times corresponding to the identifier managed in the management area,","wherein the reproducing apparatus has a mode designating function that allows at least two of a first mode, a second mode, and a third mode to be designated, when the determined result of the determining means represents that the program to be reproduced has been reproduction restricted with respect to the number of reproduction times, the first mode asking the user whether or not he or she wants to reproduce the program, the second mode forcedly prohibiting the program from being reproduced, the third mode causing the program to be unconditionally reproduced.","A second aspect of the present disclosure is directed to a reproducing apparatus for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the number of reproduction times and a program that has not been reproduction restricted with respect to the number of reproduction times have been recorded, the record medium having a management area for managing an identifier that represents whether or not a program has been reproduction restricted with respect to the number of reproduction times, the reproducing apparatus comprising:","a determining means for determining whether or not a program repeat reproducing operation has been designated; and","a controlling means for causing the reproducing apparatus to repeatedly reproduce a program except for a program that has been reproduction restricted with respect to the number of reproduction times when the determined result of the determining means represents that the program repeat reproducing operation has been designated.","A third aspect of the present disclosure is directed to a reproducing apparatus for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the duration of reproduction has been recorded, the reproducing apparatus comprising:","a date and time counting means for counting the date and time;","an operating means for allowing the user to input date and time information;","a memory means for storing date and time information that is input by the operating means;","a determining means for determining whether or not the date and time information has been stored in the memory means; and","a controlling means for prohibiting a program that has been reproduction restricted with respect to the duration of reproduction from being reproduced when the determined result of the determining means represents that the date and time information has not been stored in the memory means.","A fourth aspect of the present disclosure is directed to a reproducing method for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the number of reproduction times and a program that has not been reproduction restricted with respect to the number of reproduction times have been recorded, the record medium having a management area for managing an identifier that represents whether or not a program has been reproduction restricted with respect to the number of reproduction times, the reproducing method comprising the steps of:","determining whether or not a program to be reproduced has been reproduction restricted with respect to the number of reproduction times corresponding to the identifier managed in the management area,","wherein the reproducing method has a mode designating function that allows at least two of a first mode, a second mode, and a third mode to be designated, when the determined result at the determining step represents that the program to be reproduced has been reproduction restricted with respect to the number of reproduction times, the first mode asking the user whether or not he or she wants to reproduce the program, the second mode forcedly prohibiting the program from being reproduced, the third mode causing the program to be unconditionally reproduced.","A fifth aspect of the present disclosure is directed to a reproducing method for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the number of reproduction times and a program that has not been reproduction restricted with respect to the number of reproduction times have been recorded, the record medium having a management area for managing an identifier that represents whether or not a program has been reproduction restricted with respect to the number of reproduction times, the reproducing method comprising the steps of:","determining whether or not a program repeat reproducing operation has been designated; and","causing a program except for a program that has been reproduction restricted with respect to the number of reproduction times to be repeatedly reproduced when the determined result at the determining step represents that the program repeat reproducing operation has been designated. A sixth aspect of the present disclosure is directed to a reproducing method for reproducing a program from a record medium on which a program that has been reproduction restricted with respect to the duration of reproduction has been recorded, the reproducing method comprising the steps of:","allowing the user to input date and time information;","storing date and time information that is input to memory means;","determining whether or not the date and time information has been stored in the memory means; and","prohibiting a program that has been reproduction restricted with respect to the duration of reproduction from being reproduced when the determined result at the determining step represents that the date and time information has not been stored in the memory means.","According to the above-mentioned aspects of the present disclosure, in a mode that the user has designated, a program that has been reproduction restricted can be reproduced. Thus, a program that has been reproduction restricted can be prevented from being reproduced against the user's will.","Next, an embodiment of the present invention will be described.  is a block diagram showing the structure of a digital audio recorder\/player using a memory card according to an embodiment of the present invention. The digital audio recorder\/player records and reproduces a digital audio signal using a detachable memory card. In reality, the recorder\/player composes an audio system along with an amplifying unit and a speaker. However, it should be noted that the present invention can be applied to other audio recorders. In other words, the present invention can be applied to a portable recording\/reproducing apparatus. In addition, the present invention can be applied to a set top box that records a digital audio data that is circulated as a satellite data communication, a digital broadcast, or Internet. Moreover, the present invention can be applied to a system that records\/reproduces moving picture data and still picture data rather than audio data. The system according to the embodiment of the present invention can record and reproduce additional information such as picture and text other than a digital audio signal.","The recording\/reproducing-apparatus has an audio encoder\/decoder IC , a security IC , a DSP (Digital Signal-Processor) . Each of these devices is composed of a one-chip IC. The recording\/reproducing apparatus has a detachable memory card . The one-chip IC of the memory card  has flash memory (nonvolatile memory), a memory control block, and a security block. The security block has a DES (Data Encryption Standard) encrypting circuit. According to the embodiment, the recording\/reproducing apparatus may use a microcomputer instead of the DSP .","The audio encoder\/decoder IC  has an audio interface  and an encoder\/decoder block . The encoder\/decoder block  encodes a digital audio data corresponding to a highly efficient encoding method and writes the encoded data to the memory card . In addition, the encoder\/decoder block  decodes encoded data that is read from the memory card . As the highly efficient encoding method, the ATRAC3 format that is a modification of the ATRAC (Adaptive Transform Acoustic Coding) format used in Mini-Disc is used.","In the ATRAC3 format, audio data sampled at 44.1 kHz and quantized with 16 bits is highly efficiently encoded. In the ATRAC3 format, the minimum data unit of audio data that is processed is a sound unit (SU). 1 SU is data of which data of 1024 samples (1024\u00d716 bits\u00d72 channels) is compressed to data of several hundred bytes. The duration of 1 SU is around 23 msec. In the highly efficient encoding method, the data amount of audio data is compressed to data that is around 10 times smaller than that of original data. As with the ATRAC1 format used in Mini-Disc, the audio signal compressed and decompressed corresponding to the ATRAC3 format less deteriorates in the audio quality.","A line input selector  selectively supplies the reproduction output signal of an MD, the output signal of a tuner, or a reproduction output signal of a tape to an A\/D converter . The A\/D converter  converts the input line signal to a digital \u201caudio signal (sampling frequency=44.1 kHz; the number of quantizing bits=16). A digital input selector  selectively supplies a digital output signal of an MD, a CD, or a CS (Satellite Digital Broadcast) to a digital input receiver . The digital input signal is transmitted through for example an optical cable. An output signal of the digital input receiver  is supplied to a sampling rate converter . The sampling rate converter  converts the digital input signal into a digital audio signal (sampling frequency=44.1 kHz; the number of quantizing bits=16).","The encoder\/decoder block  of the audio encoder\/decoder IC  supplies encoded data to a DES encrypting circuit  through an interface  of the security IC . The DES encrypting circuit  has a FIFO . The DES encrypting circuit  is disposed so as to protect the copyright of contents. The memory card  also has a DES encrypting circuit. The DES encrypting circuit  of the recording\/reproducing apparatus has a plurality of master keys and an apparatus-unique storage key. The DES encrypting circuit  also has a random number generating circuit. The DES encrypting circuit  can share an authenticating process and a session key with the memory card  that has the DES encrypting circuit. In addition, the DES encrypting circuit  can re-encrypt data with the storage key of the DES encrypting circuit.","The encrypted audio data that is output from the DES encrypting circuit  is supplied to a DSP (Digital Signal Processor) . The DSP  communicates with the memory card  through an interface. In this example, the memory card  is attached to an attaching\/detaching mechanism (not shown) of the recording\/reproducing apparatus. The DSP  writes the encrypted data to the flash memory of the memory card . The encrypted data is serially transmitted between the DSP  and the memory card . In addition, an external SRAM (Static Random Access Memory)  is connected to the DSP . The SRAM  provides the recording\/reproducing apparatus with a sufficient storage capacity so as to control the memory card .","In addition, encrypted ATRAC3 data is supplied from an external personal computer (not shown) to the DSP  through an interface . When predetermined application software is installed to the external personal computer, it can capture audio file and so forth compressed corresponding to EMD (Electronic Music Distribution), music CD, or MP3 (MPEG1 Audio Layer III) to a hard disk, converts the captured data into ATRAC3 format data, encrypts the converted data, and outputs the encrypted data.","Reference numeral  represents a system controller that controls the operation of the entire audio system shown in  and supplies data such as a record command, a reproduction command, and so forth generated in the operation portion corresponding to a user's operation. The system controller  is composed of a CPU (Central Processing Unit). The system controller  has a nonvolatile memory . In addition, data of additional information for video information and character information is supplied to the DSP  through the system controller .","The encrypted ATRAC3 data that, is read from the memory card  by the DSP  is decrypted by the security IC . The audio encoder\/decoder IC  decodes the encoded data corresponding to the ATRAC3 format. Output data of the audio encoder\/decoder  is supplied to a D\/A converter . The D\/A converter  converts the output data of the audio encoder\/decoder  into an analog audio signal. The analog audio signal is supplied to a line output terminal . The analog audio signal is supplied to an amplifying unit (not shown) through the line output terminal . The analog audio signal is reproduced from a speaker or a head set. The external controller supplies a muting signal to the D\/A converter . When the muting signal represents a mute-on state, the external controller prohibits the audio signal from being output from the line output terminal .","In addition, encrypted ATRAC3 data that is read from the memory card  is supplied from the DSP  to the external personal computer through an interface . The ATRAC3 data is stored in a hard disk of the personal computer.",{"@attributes":{"id":"p-0081","num":"0080"},"figref":["FIG. 2","FIG. 2"],"b":["30","30","34","35","36","37","38","30","34","35","30","36","31"]},"The DSP  controls a writing process for writing encrypted audio data and additional information to the memory card  corresponding to an operation signal such as a record command received from the system controller  and a reading process for reading them therefrom. In other words, the DSP  is disposed between the application software side of the audio system that records\/reproduces audio data and additional information and the memory card . The DSP  is operated when the memory card  is accessed. In addition, the DSP  is operated corresponding to software such as a file system.","The DSP  manages files stored in the memory card  with the FAT system used in conventional personal computers. In addition to the file system, according to the embodiment of the present invention, a management file is used. The management file will be descried later. The management file is used to manage data files stored in the memory card . The management file as the first file management information is used to manage audio data files. On the other hand, the FAT as the second file management information is used to manage all files including audio data files and management files stored in the flash memory of the memory card . The management file is stored in the memory card . The FAT is written to the flash memory along with the route directory and so forth before the memory card  is shipped. The details of the FAT will be described later.","According to the embodiment of the present invention, to protect the copyright of data, audio data that has been compressed corresponding to the ATRAC3 format is encrypted. On the other hand, since it is not necessary to protect the copyright of the management file, it is not encrypted. There are two types of memory cards that are an encryption type and anon-encryption type. However, a memory card for use with the recorder\/player that records copyright protected data is limited to the encryption type. Voice data and image data that are recorded by users are recorded on non-encryption type memory cards.",{"@attributes":{"id":"p-0085","num":"0084"},"figref":"FIG. 3","b":["40","40","41","42","30","40"]},"The clock line SCK is used for transmitting a clock signal in synchronization with data. The status line SBS is used for transmitting a signal that represents the status of the memory card . The data line DIO is used for inputting and outputting a command and encrypted audio data. The interrupt line INT is used for transmitting an interrupt signal that causes the memory card  to interrupt the DSP  of the recorder\/player. When the memory card  is attached to the recorder\/player, the memory card  generates the interrupt signal. However, according to the embodiment of the present invention, since the interrupt signal is transmitted through the data line DIO, the interrupt line INT is grounded.","A serial\/parallel converting, parallel\/serial converting, and interface block (S\/P, P\/S, I\/F block)  is an interface disposed between the DSP  of the recorder\/player and the control block  of the memory card . The S\/P, P\/S, and IF block  converts serial data received from the DSP  of the recorder\/player into parallel data and supplies the parallel data to the control block . In addition, the S\/P, P\/S, and IF block  converts parallel data received from the control block  into serial data and supplies the serial data to the DSP . When the S\/P, P\/S, and IF block  receives a command and data through the data line DIO, the S\/P, P\/S, and IF block  separates them into these that are normally accessed to the flash memory  and those that are encrypted.","In the format of which data is transmitted through the data line DIO, after a command is transmitted, data is transmitted. The S\/P, P\/S, and IF block  detects the code of a command and determines whether the command and data are those that are normally accessed or those that are encoded. Corresponding to the determined result, the S\/P, P\/S, and IF block  stores a command that is normally accessed to a command register  and stores data that is normally accessed to a page buffer  and a write register . In association with the write register , the memory card  has an error correction code encoding circuit . The error correction code encoding circuit  generates a redundant code that is an error correction code for data temporarily stored in the page buffer .","Output data of the command register , the page buffer , the write register , and the error correction code encoding circuit  is supplied to a flash memory interface and sequencer, (hereinafter, referred to as memory I\/F and sequencer) . The memory IF and sequencer  is an interface disposed between the control block  and the flash memory  and controls data exchanged therebetween. Data is written to the flash memory through the memory IF and sequencer .","Audio data that has been compressed corresponding to the ATRAC3 format and written to the flash memory (hereinafter, this audio data is referred to as ATRAC3 data) is encrypted by the security IC  of the recorder\/player and the security block  of the memory card  so as to protect the copyright of the ATRAC3 data. The security block  comprises a buffer memory , a DES encrypting circuit , and a nonvolatile memory .","The security block  of the memory card  has a plurality of authentication keys and a unique storage key for each memory card. The nonvolatile memory  stores a key necessary for encrypting data. The key stored in the nonvolatile memory  cannot be analyzed. According to the embodiment, for example, a storage key is stored in the nonvolatile memory . The security block  also has a random number generating circuit. The security block  authenticates an applicable recorder\/player and shares a session key therewith. In addition, the security block  re-encrypts contents with the storage key through the DSE encrypting circuit .","For example, when the memory card  is attached to the recorder\/player, they are mutually authenticated. The security IC  of the recorder\/player and the security block  of the memory card  mutually authenticate. When the recorder\/player has authenticated the attached memory card  as an applicable memory card and the memory card  has authenticated the recorder\/player as an applicable recorder\/player, they are mutually authenticated. After the mutual authenticating process has been successfully performed, the recorder\/player and the memory card  generate respective session keys and share them with each other. Whenever the recorder\/player and the memory card  authenticate each other, they generate respective session keys.","When contents are written to the memory card , the recorder\/player encrypts a contents key with a session key and supplies the encrypted data to the memory card . The memory card  decrypts the contents key with the session key, re-encrypts the contents key with a storage key, and supplies the contents key to the recorder\/player. The storage key is a unique key for each memory card . When the recorder\/player receives the encrypted contents key, the recorder\/player performs a formatting process for the encrypted contents key, and writes the encrypted contents key and the encrypted contents to the memory card .","In the above section, the writing process for the memory card  was described. In the following, the reading process for the memory card  will be described. Data that is read from the flash memory  is supplied to the page buffer , the read register , and the error correction circuit  through the memory IF and the sequencer . The error correcting circuit  corrects an error of the data stored in the page buffer . Output data of the page buffer  that has been error-corrected and the output data of the read register  are supplied to the S\/P, P\/S, and IF block . The output data of the S\/P, P\/S, and IF block  is supplied to the DSP  of the recorder\/player through the above-described serial interface.","When data is read from the memory card , the contents key encrypted with the storage key and the contents encrypted with the block key are read from the flash memory . The security block  decrypts the contents key with the storage key. The security block  re-encrypts the decrypted content key with the session key and transmits the re-encrypted contents key to the recorder\/player. The recorder\/player decrypts the contents key with the received session key and generates a block key with the decrypted contents key. The recorder\/player successively decrypts the encrypted ATRAC3 data.","A config. ROM  is a memory that stores partition information, various types of attribute information, and so forth of the memory card . The memory card  also has an erase protection switch . When the switch  is in the erase protection position, even if a command that causes the memory card  to erase data stored in the flash memory  is supplied from the recorder\/player side to the memory card , the memory card  is prohibited from erasing the data stored in the flash memory . An OSC cont.  is an oscillator that generates a clock signal that is the reference of the timing of the process of the memory card .",{"@attributes":{"id":"p-0097","num":"0096"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0098","num":"0097"},"figref":"FIG. 5","b":["42","40","42","42","0","42","42"]},"One page is composed of a data portion of 512 bytes and a redundant portion of 16 bytes. The first three bytes of the redundant portion is an overwrite portion that is rewritten whenever data is updated. The first three bytes successively contain a block status area, a page status area, and an update status area. The remaining 13 bytes of the redundant portion are fixed data that depends on the contents of the data portion. The 13 bytes contain a management flag area (1 byte), a logical address area (2 bytes), a format reserve area (5 bytes), a dispersion information ECC area (2 bytes), and a data ECC area (3 bytes). The dispersion information ECC area contains redundant data for an error correction process against the management flag area, the logical address area, and the format reserve area. The data ECC area contains redundant data for an error correction process against 512-byte data.","The management flag area contains a system flag (: user block, : boot block), a conversion table flag (: invalid, : table block), a copy prohibition flag (: OK, : NG), and an access permission flag (: free, : read protect). The first two blocks\u2014blocks  and  are boot blocks. The block  is a backup of the block . The boot blocks are top blocks that are valid in the memory card. When the memory card is attached to the recorder\/player, the boot blocks are accessed at first. The remaining blocks are user blocks. Page  of the boot block contains a header area, a system entry area, and a boot and attribute information area. Page  of the boot block contains a prohibited block data area. Page  of the boot block contains a CIS (Card Information Structure)\/IDI (identify Drive Information) area.","The header area of the boot block contains a boot block ID and the number of effective entries. The system entries are the start position of prohibited block data, the data size thereof, the data type thereof, the data start position of the CIS\/IDI area, the data size thereof, and the data type thereof. The boot and attribute information contains the memory card type (read only type, rewritable type, or hybrid type); the block size, the number of blocks, the number of total blocks, the security\/non-security type, the card fabrication data (date of fabrication), and so forth.","Since the flash memory has a restriction for the number of rewrite times due to the deterioration of the insulation film, it is necessary to prevent the same storage area (block) from being concentratedly accessed. Thus, when data at a particular logical address stored at a particular physical address is rewritten, updated data of a particular block is written to a non-used block rather than the original block. Thus, after data is updated, the relation between the logical address and the physical address changes. This process is referred to as swap process. Consequently, the same block is prevented from being concentratedly accessed. Thus, the service life of the flash memory can be prolonged.","The logical address associates with data written to the block. Even if the block of the original data is different from the block of updated data, the address on the FAT does not change. Thus, the same data can be properly accessed. However, since the swap process is performed, a conversion table that correlates logical addresses and physical addresses is required (this table is referred to as logical-physical address conversion table). With reference to the logical-physical address conversion table, a physical address corresponding to a logical address-designated on the FAT is obtained. Thus, a block designated with a physical address can be accessed.","The DSP  stores the logical-physical address conversion table in the SRAM. When the storage capacity of the RAM is small, the logical-physical address conversion table can be stored to the flash memory. The logical-physical address conversion table correlates logical addresses (2 bytes) sorted in the ascending order with physical addresses (2 bytes). Since the maximum storage capacity of the flash memory is 128 MB (8192 blocks), 8192 addresses can be assigned with two bytes. The logical-physical address conversion table is managed for each segment. Thus, the size of the logical-physical address conversion table is proportional to the storage capacity of the flash memory. When the storage capacity of the flash memory is 8 MB (two segments), two pages are used as the logical-physical address conversion table for each, of the segments. When the conversion, table is stored in the flash memory, a predetermined one bit of the management flag area in the redundant portion in each page represents whether or not the current block is a block containing the logical-physical address conversion table.","The above-described memory card can be used with the FAT system of a personal computer system as with the disc shaped record medium. The flash memory has an IPL area, a FAT area, and a route directory area (not shown in ). The IPL area contains the address of a program to be initially loaded to the memory of the recorder\/player. In addition, the IPL area contains various types of memory information. The FAT area contains information with respect to blocks (clusters). The FAT has defined unused blocks, next block number, defective blocks, and last block number. The route directory area contains directory entries that are a file attribute, an update date [day, month, year], file size, and so forth.","Next, with reference to , a managing method using the FAT table will be described.  is a schematic diagram showing a memory map. The top area of the memory map is a partition table portion. The partition table portion is followed by a block area, a boot sector, a FAT area, a FAT backup area, a root directory area, a sub directory area, and a data area. On the memory map, logical addresses have been converted into physical addresses corresponding to the logical-physical address conversion table.","The boot sector, the FAT area, the FAT backup area, the root directory area, the sub directory area, and the data area are collectively referred to as FAT partition area.","The partition table portion contains the start address and the end address of the FAT partition area. The FAT used for a conventional floppy disk does not have such a partition table. Since the first track has only a partition table, there is a blank area.","The boot sector contains the size of the FAT structure (12 bit FAT or 16 bit FAT), the cluster size, and the size of each area. The FAT is used to manage the position of a file recorded in the data area. The copy area of the FAT is a backup area of the FAT. The route directory area contains file names, start cluster addresses thereof, and various attributes thereof. The route directory area uses 32 bytes per file.","The sub directory area is a directory attribute file as a directory. In the embodiment shown in , the sub directory area has four files named PBLIST.MSF, CAT.MSA, DOG.MSA, and MAN.MSF. The sub directory area is used to manage file names and their record positions on the FAT. In other words, the slot of the file name CAT.MSA is assigned address \u201c\u201d on the FAT. The slot of the file name DOG.MSA is assigned address \u201c\u201d on the FAT.","An area after cluster  is used as a data area. In this embodiment, audio data that has been compressed corresponding to the ATRAC3 format is recorded in the data area. A slot of the file name MAN.MSA is assigned address \u201c\u201d on the FAT.","According to the embodiment of the present invention, audio data that has been compressed corresponding to the ATRAC3 format and that has the file name CAT.MSA is recorded in clusters , , , and . Audio data of DOG- as the first half of a file that has been compressed corresponding to the ATAC3 format and that has the file name DOG.MSA is recorded in clusters , , and . Audio data DOG- as the second half of the file that has been compressed corresponding to the ATRAC3 format and that has the file name DOG.MSA is recorded in clusters  and . Audio data that has been compressed corresponding to the ATRAC3 format and that has the file name MAN.MSA is recorded in clusters  and .","According to the embodiment of the present invention, an example of which a single file is divided into two portions and dispersedly recorded is described. In the example, an area \u201cEmpty\u201d in the data area is a recordable area.","An area after cluster  is used for managing file names. The file CAT.MSA is recorded in cluster . The file DOG.MSA is recorded in cluster . The file MAN.MSA is recorded in cluster . When the positions of the files are changed, the area after cluster  is rearranged.","When the memory card is attached at the first time, the beginning and the end of the FAT partition area are recorded with reference to the top partition table portion. After the boot sector portion is reproduced, the root directory area and the sub directory area are reproduced. The slot of the reproduction management information PBLIST.MSF in the sub directory area is detected so as to reference the address of the end portion of the slot of the file PBLIST.MSF.","According to the embodiment, since address \u201c\u201d is recorded at the end of the slot of the file PBLIST.MSF, cluster  is referenced. The area after cluster  is used for managing file names and the reproduction order thereof. According to the embodiment, the file CAT.MSA is the first program. The file DOG.MSA is the second program. The file MAN.MSA is the third program.","After all the areas after cluster  are referenced, in the subdirectory, slots of the files CAT.MSA, DOG.MSA, and MAN.MSA are referenced. In , the end of the slot of the file name CAT.MSA is assigned address \u201c\u201d. The end of the slot of the file DOG.MSA is assigned address \u201c\u201d. The end of the slot of the file MAN.MSA is assigned address \u201c\u201d.","When an entry address is searched on the FAT with the address \u201c\u201d recorded at the end of the slot of the file name CAT.MSA, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, code \u201cFFF\u201d that represents the end is obtained.","Thus, the file CAT.MSA uses clusters , , , and . With reference to clusters , , , and  in the data area, an area of ATRAC3 data with the file name CAT.MSA can be accessed.","Next, a method for searching the file DOG.MSA that has been dispersedly recorded will be described. The end of the slot of the file DOG.MSA is assigned address \u201c\u201d. When an entry address is searched on the FAT with address \u201c\u201d, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, code \u201cFFF\u201d that represents the end is obtained.","Thus, the file DOG.MSA uses clusters , , , , and . When clusters , , and  of the data area are referenced, an area of ATRAC3 data corresponding to the first part of the file DOG.MSA can be accessed. When clusters  and  of the data area are referenced, an area of ATRAC3 data corresponding to the second part of the file DOG.MSA can be accessed.","In addition, when an entry address is searched on the FAT with address \u201c\u201d recorded at the end of the slot of the file name MAN.MSA, cluster address \u201c\u201d is obtained. When an entry address is searched on the FAT with address \u201c\u201d, code \u201cFFF\u201d that represents the end is obtained.","Thus, the file MAN.MSA uses clusters  and . When clusters  and  of the data area are referenced, an area of ATRAC3 data of the file MAN.MSA can be accessed.","As described above, a data file dispersed in the flash memory can be linked and sequentially reproduced.","According to the embodiment of the present invention, in addition to the file management system defined in the format of the memory card , a management file is used for managing tracks as music files and parts thereof. The management file is recorded in the flash memory  using a user block of the memory card . Thus, as will be described later, even if the FAT of the memory card  is destroyed, a file can be recovered.","The management file is created by the DSP . For example, when the power of the recorder\/player is turned on at the first time, the DSP  determines whether or not the memory card  has been attached to the recorder\/player. When the memory card has been attached, the DSP  authenticates the memory card . When the DSP  has successfully authenticated the memory card , the DSP  reads a boot block of the flash memory . Thereafter, the DSP  reads a physical address-logical address conversion table and stores the read data to the SRAM. The data that has been read to the DSP  is stored in an SRAM. Before the memory card is shipped, the FAT and the route directory have been already written to the flash memory of the memory card . On the other hand, when data is recorded to the memory card , the management file is created.","In other words, a record command issued by the user's remote controller or the like is supplied from the system controller  to the DSP . The encoder\/decoder IC  compresses the received audio data and supplies the resultant ATRAC3 data to the security IC . The security IC  encrypts the ATRAC3 data. The encrypted ATRAC3 data is recorded to the flash memory  of the memory card . Thereafter, the FAT and the management file are updated. Whenever a file is updated (in reality, whenever the recording operation of audio data is started and completed), the FAT and the management file stored in the SRAMs  and  are rewritten. When the memory card  is detached from the recorder\/player or its power is turned off, the latest FAT and management file that are supplied from the SRAMs  and  are recorded to the flash memory . Alternatively, whenever the recording operation of audio data is started and completed, the FAT and the management file stored in the flash memory  may be rewritten. In addition, when audio data is edited, the contents of the management file are updated.","In the data structure according to the embodiment, additional information is created and updated in the management file. The additional information is recorded to the flash memory . In another data structure of the management file, an additional information management file is independently created besides the track management file. The additional information is supplied from the system controller  to the DSP . The additional information received by the DSP  is recorded to the flash memory  of the memory card . Since the additional information is not supplied to the security IC , it is not encrypted. When the memory card  is detached from the recorder\/player or its power is turned off, the additional information is written from the SRAM of the DSP  to the flash memory .",{"@attributes":{"id":"p-0129","num":"0128"},"figref":"FIG. 7","b":["40","40","3","3"]},{"@attributes":{"id":"p-0130","num":"0129"},"figref":["FIG. 8","FIG. 9"]},"The reproduction management file shown in  is composed of a header, a memory card name NM-S (for one byte code), a memory card name NM-S (for two byte code), a program reproduction sequence table TRKTBL, and memory card additional information INF-S. The attribute header (shown in ) at the beginning of the data file is composed of a header, a program name NM (for one byte code), a program name NM (for two byte code), track information. TRKINF (such as track key information), part information PRTINF, and track additional information INF. The header contains information of the number of total parts, the attribute of the name, the size of the additional information, and so forth.","The attribute data is followed by ATRAC3 music data. The music data is block-segmented every 16 KB. Each block starts with a header. The header contains an initial value for decrypting encrypted data. Only music data of an ATRAC3 data file is encrypted. Thus, other data such as the reproduction management file, the header, and so forth are not encrypted.","Next, with reference to , the relation between music programs and ATRAC3 data files will be described. One track is equivalent to one music program. In addition, one music program is composed of one ATRAC3 data (see ). The ATRAC3 data file is audio data that has been compressed corresponding to the ATRAC3 format. The ATRAC3 data file is recorded as a cluster at a time to the memory card . One cluster has a capacity of 16 KB. A plurality of files are not contained in one cluster. The minimum data erase unit of the flash memory  is one block. In the case of the memory card  for music data, a block is a synonym of a cluster. In addition, one cluster is equivalent to one sector.","One music program is basically composed of one part. However, when a music program is edited, one music program may be composed of a plurality of parts. A part is a unit of data that is successively recorded. Normally, one track is composed of one part. The connection of parts of a music program is managed with part information PRTINF in the attribute header of each music program. In other words, the part size is represented with part size PRTSIZE (4 bytes) of the part information PRTINF. The first two bytes of the part size PRTSIZE represents the number of total clusters of the current part. The next two bytes represent the positions of the start sound unit (SU) and the end sound unit (SU) of the beginning and last clusters, respectively. Hereinafter, a sound unit is abbreviated as SU. With such a part notation, when music data is edited, the movement of the music data can be suppressed. When music data is edited for each block, although the movement thereof can be suppressed, the edit unit of a block is much larger than the edit unit of a SU.","SU is the minimum unit of a part. In addition, SU is the minimum data unit in the case that audio data is compressed corresponding to the ATRAC3 format. 1 SU is audio data of which data of 1024 samples at 44.1 kHz (1024\u00d716 bits\u00d72 channels) is compressed to data that is around 10 times smaller than that of original data. The duration of 1 SU is around 23 msec. Normally, one part is composed of several thousand SU. When one cluster is composed of 42 SU, one cluster allows a sound of one second to be generated. The number of parts composing one track depends on the size of the additional information. Since the number of parts is obtained by subtracting the header, the program name, the additional data, and so forth from one block, when there is no additional information, the maximum number of parts (645 parts) can be used.",{"@attributes":{"id":"p-0136","num":"0135"},"figref":"FIG. 10A","b":["1","2","1","1","2","1"]},"There are four types of edit processes that are a divide process, a combine process, an erase process, and a move process. The divide process is performed to divide one track into two portions. When the divide process is performed, the number of total tracks increases by one. In the divide process, one file is divided into two files on the file system. Thus, in this case, the reproduction management file and the FAT are updated. The combine process is performed to combine two tracks into one track. When the combine process is performed, the number of total tracks decreases by one. In the combine process, two files are combined into one file on the file system. Thus, when the combine process is performed, the reproduction management file and the FAT are updated. The erase process is performed to erase a track. The track numbers after the track that has been erased decrease one by one. The move process is performed to change the track sequence. Thus, when the erase process or the move process is performed, the reproduction management file and the FAT are updated.",{"@attributes":{"id":"p-0138","num":"0137"},"figref":["FIG. 10B","FIG. 10A","FIG. 10C"],"b":["1","2","1","2","1","0","1","2","2","2","3","4"]},"As described above, according to the embodiment of the present invention, since the part notation is defined, as the combined result (see ), the start position of the part , the end position of the part , and the end portion of the part  can be defined with SU. Thus, to pack the space due to the combined result, it is not necessary to move the music data of the part . In addition, as the divided result (see ), it is not necessary to move data and pack the space at the beginning of the file .",{"@attributes":{"id":"p-0140","num":"0139"},"figref":["FIG. 11","FIGS. 12A and 12B","FIG. 12A","FIG. 12B"],"b":["1","2"]},"The first 32 bytes of (0x0000) to (0x0010) shown in  are used for the header. In the file, 16-byte areas are-referred to as slots. Referring to , the header are placed in the first and second slots. The header contains the following areas. An area denoted by \u201cReserved\u201d is an undefined area. Normally, in a reserved area, a null (0x00) is written. However, even if any data is written to a reserved area, the data written in the reserved is ignored. In a future version, some reserved areas may be used. In addition, data is prohibited from being written to a reserved area. When an option area is not used, it is treated as a reserved area.","BLKID TLO (4 bytes)\n\n","MCode (2 bytes)\n\n","REVISION (4 bytes)\n\n","SN1C+L (2 bytes)\n\n","SN2C+L (2 bytes)\n\n","SINFSIZE (2 bytes)\n\n","T TRK (2 bytes)\n\n","VerNo (2 bytes)\n\n","NM S\n\n","NM S\n\n","CONTENTS KEY\n\n","MAC\n\n","TRK nnn\n\n","INF S\n\n","S YMDhms (4 bytes) (Option)\n\n","As the last slot of the reproduction management file, the same BLKID TLO, Mode, and REVISION as those in the header are written.","While data is being recorded to a memory card, it may be mistakenly or accidentally detached or the power of the recorder\/player may be turned off. When such an improper operation is performed, a defect should be detected. As described above, the REVISION area is placed at the beginning and end of each block. Whenever data is rewritten, the value of the REVISION area is incremented. If a defect termination takes place in the middle of a block, the value of the REVISION area at the beginning of the block does not match the value of the REVISION area at the end of the block. Thus, such a defect termination can be detected. Since there are two REVISION areas, the abnormal termination can be detected with a high, probability. When an abnormal termination is detected, an alarm such as an error message is generated.","In addition, since the fixed value BLKID.TLO is written at the beginning of one block (16 KB), when the FAT is destroyed, the fixed value is used as a reference for recovering data. In other words, with reference to the fixed value, the type of the file can be determined. Since the fixed value BLKID TLO is redundantly written at the header and the end portion of each block, the reliability can be secured. Alternatively, the same reproduction management file can be redundantly recorded.","The data amount of an ATRAC3 data file is much larger than that of the track information management file. In addition, as will be described later, a block number BLOCK SERIAL is added to ATRAC3 data file. However, since a plurality of ATRAC3 data files are recorded to the memory card, to prevent them from become redundant, both CONNUM and BLOCK SERIAL are used. Otherwise, when the FAT is destroyed, it will be difficult to recover the file. In other words, one ATRAC3 data file may be composed of a plurality of blocks that are dispersed. To identify blocks of the same ATRAC3 data file, CONNUM is used. In addition, to identify the order of blocks in the ATRAC3 data file, BLOCK SERIAL is used.","Likewise, the maker code (Mcode) is redundantly recorded at the beginning and the end of each block so as to identify the maker and the model in such a case that a file has been improperly recorded in the state that the FAT has not been destroyed.",{"@attributes":{"id":"p-0162","num":"0235"},"figref":"FIG. 12C"},"INF\n\n","ID\n\n","SIZE\n\n","MCode\n\n","C+L\n\n","DATA\n\n",{"@attributes":{"id":"p-0169","num":"0260"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0170","num":"0261"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0171","num":"0262"},"figref":["FIG. 15","FIG. 15"]},"Next, with reference to , real examples of additional information will be described. As with ,  shows the data structure of the additional information. In , key code ID=3 (artist name as additional information). SIZE=0x1C (28 bytes) representing that the data length of additional information including the header is 28 bytes; C+L representing that character code C=0x01 (ASCII) and language code L=0x09 (English). Variable length data after byte  represents one byte data \u201cSIMON & GARFUNKEL\u201d as artist name. Since the data length of the additional information should be a multiple of 4 bytes, the rest is filled with (0x00).","In , key code ID=97 representing that ISRC (International Standard Recording Code: Copyright code) as additional information. SIZE=0x14 (20 bytes) representing that the data length of the additional information is 20 bytes. C=0x00 and L=0x00 representing that characters and language have not been set. Thus, the data is binary code. The variable length data is eight-byte ISRC code representing copyright information (nation, copyright owner, recorded year, and serial number).","In , key code ID=97 representing recorded date and time as additional information. SIZE=0x10 (16 bytes) representing that the data length of the additional information is 16 bytes. C=0x00 and L=0x00 representing that characters and language have not been set. The variable length data is four-byte code (32 bit) representing the recorded date and time (year, month, day., hour, minute, second).","In , key code ID=107, representing a reproduction log as additional information. SIZE=0x10 (16 bytes) representing that the data length of the additional information is 16 bytes. C=0x00 and L=0x00 representing that characters and language have not been set. The variable length data is a four-byte code representing a reproduction log (year, month, day, hour, minute, second). When the recorder\/player has a reproduction log function, it records data of 16 bytes whenever it reproduces music data.",{"@attributes":{"id":"p-0176","num":"0267"},"figref":["FIG. 17","FIG. 17","FIG. 17","FIG. 18"],"b":["3","1","2"]},"BLKID HDO (4 bytes)\n\n","MCode (2 bytes)\n\n","BLOCK SERIAL. (4 bytes)\n\n","N1C+L (2 bytes)\n\n","N2C+L (2 bytes)\n\n","INFSIZE (2 bytes)\n\n","T PRT (2 bytes)\n\n","T SU (4 bytes)\n\n","INX (2 bytes) (Option)\n\n","XT (2 bytes) (Option)\n\n","NMl\n\n","NM\n\n","CONTENTS KEY (8 bytes)\n\n","MAC (8 bytes)\n\n","A (1 byte)\n\n","In the following description, monaural mode (N=0 or 1) is defined as a special joint mode of which bit -, sub signal=0, main signal=(L+R). A non-copyright protection type player may ignore information of bits  and .","Bit  of the area A represents information of emphasis on\/off state. Bit  of the area A represents information of reproduction skip or normal reproduction. Bit  represents information of data type such as audio data, FAX data, or the like. Bit  is undefined. By a combination of bits , , and , mode information of ATRAC3 is defined as shown in . In other words, N is a mode value of 3 bits. For five types of modes that are monaural (N=0 or 1), LP (N=2), SP (N=4), EX (N=5), and HQ (N=7), record duration (64 MB memory card only), data transmission rate, and the number of SU per block are listed. The number of bytes of 1 SU depends on each mode. The number of bytes of 1 SU in the monaural mode is 136 bytes. The number of bytes of 1 SU in the LP mode is 192 bytes. The number of bytes of 1 SU in the SP mode is 304 bytes. The number of bytes of 1 SU in the EX mode is 384 bytes. The number of bytes of 1 SU in the HQ mode is 512 bytes. Bit  represents ATRAC3 modes (0: Dual, 1: JOint).","For example, an example of which a 64 MB memory card is used in the SP mode will be described. A 64-MB memory card has 3968 blocks. In the SP mode, since 1 SU is 304 bytes, one block has 53 SU. 1 SU is equivalent to (1024\/44100) seconds. Thus, one block is (1024\/44100)\u00d753\u00d7(3968 16)=4863 seconds=81 minutes.","The transmission rate is (44100\/1024)\u00d7304\u00d718=104737 bps.","LT (one byte)\n\n","FNo (2 bytes)\n\n","MG(D) SERIAL nnn (16 bytes)\n\n","CONNUM (4 bytes)\n\n","YMDhms S (4 bytes) (Option)\n\n","YMDhms E (4 bytes) (Option)\n\n","MT (1 byte) (Option)\n\n","CT (1 byte) (Option)\n\n","CC (1 byte).\n\n","CN (1 byte) (Option)\n\n","The track information area TRKINF is followed by a 24-byte part management information area (PRTINF) starting from 0x0370. When one track is composed of a plurality of parts, the values of areas PRTINF of the individual parts are successively arranged on the time axis.  shows a part of the area PRTINF. Next, areas in the area PRTINF will be described in the order of the arrangement.","PRTSIZE (4 bytes)\n\n","PRTKEY (8 bytes)\n\n","CONNUMO (4 bytes)\n\n","As shown in , the attribute header of an ATRAC3 data file contains additional information INF. The additional information is the same as the additional information INF S (see ). of the reproduction management file except that the start position is not fixed. The last byte position (a multiple of four bytes) at the end of one or a plurality of parts is followed by data of the additional information INF.","INF\n\n","The above-described attribute header is followed by data of each block of an ATRAC3 data file. As shown in , a header is added for each block. Next, data of each block will be described.","BLKID AD (4 bytes)\n\n","MCode (2 bytes)\n\n","CONNUMO (4 bytes)\n\n","BLOCK SERIAL (4 bytes)\n\n","BLOCK-SEED (8 bytes)\n\n","INITIALIZATION VECTOR (8 bytes)\n\n","SU nnn\n\n","In , since N=384, 42 SU are written to one block. The first two slots (4 bytes) of one block are used as a header. In the last slot (two bytes), the areas BLKID AD, MCode, CONNUMO, and BLOCK SERIAL are redundantly written. Thus, M bytes of the remaining area of one block is (16,384 384\u00d742 16\u00d73=208) bytes. As described above, the eight-byte area BLOCK SEED is redundantly recorded.","When the FAT area is destroyed, all blocks of the flash memory are searched. It is determined whether the value of the block ID BLKID of the top block is TL, HD, or AD. Next, with reference to a flow chart shown in , the determining process will be described. At step SP, it is determined whether or not the value of the block ID BLKID of the top block is TL.","When the determined result at step SP represents that the value of the block ID BLKID of the top block is not TL, the flow advances to step SP. At step SP, the block number is incremented. Thereafter, the flow advances to step SP. at step SP, it is determined whether or not the last block has been searched. When the determined result at step SP represents that the last block has not been searched, the flow returns to step SP.","When the determined result at step SP represents that the value of the-block ID BLKID of the top block is TLO, the flow advances to step SP. At step SP, it is determined that the searched block is 1 the reproduction management file PBLIST. Thereafter, the flow advances to step SP. At step SP, with reference to the number of total tracks T TRK contained in the reproduction management file PBLIST, the number of total tracks N is stored to the register. For example, when the memory stores 10 ATRAC3 data files (10 music programs), the value of T-TRK is 10.","Next, at step SP, with reference to the value of the number of total tracks T TRK, TRK  to TRK  of blocks are successively referenced. In this example, since 10 music programs have been recorded, only TRK  to TRK  of blocks are referenced.","Since a file number FNO is recorded in TRK XXX (where X=1 to 400), a table that represents the relation of the track numbers TRK XXX and the file numbers FNO is stored to the memory at step SP.","At step SP, the value of N stored in the register is decremented. At step SP, a loop of steps SP, SP, and SP is repeated until the value of N becomes 0. When the determined result at step SP represents that the value N is 0, the flow advances to step SP. At step SP, the pointer is reset to the top block. The searching process is repeated from the top block.","Thereafter, the flow advances to step SP. At step SP, it is determined whether or not the value of the block ID BLKID of the top block is BLKID HD. When the determined result at step SP represents that the block ID BLKID of the top block is not BLKID HD, the flow advances to step SP. At step SP, the block number is incremented. At step SP, it is determined whether or not the last block has been searched.","When the determined result at step SP represents that the last block has not been searched, the flow returns to step SP.","The searching process is repeated until the determined result at step SP represents that the value of the block ID BLKID of the top block is BLKID HD. When the determined result at step SP represents that the value of the block ID BLKID of the top block is BLKID HDO, the flow advances to step SP. At step SP, it is determined that the block is the attribute header (see ) at the beginning of the ATRAC3 data file, the attribute header being from 0x0000 to OxO3FFF shown in .","Next, at step SP, with reference to the file number FNO, the sequence number BLOCK SERIAL of the ATRAC-data file, and the content cumulation number key CONNUMO contained in the attribute header, they are stored to the memory. When 10 ATRAC3 data files (10 music programs) have been recorded, since there are 10 blocks whose block ID BLKID is BLKID TLO, the searching process is continued until they are searched.","When the determined result at step SP represents that the last block has been searched, the flow advances to step SP. At step SP, the pointer is reset to the top block. The searching process is repeated from the top block.","At step SP, it is determined whether or not the value of the block ID BLKID of the top block is BLKID AD. When the determined result at step SP represents that the value of the block ID BLKID of the top block is not BLKID AD, the flow advances to step SP. At step SP, the block number is incremented. Thereafter, the flow advances to step SP. At step SP, it is determined whether or not the last block has been searched. When the determined result at step SP represents that the last block has not been searched, the flow returns to step SP.","When the determined result at step SP represents that the value of the block ID BLKID of the top block is BLKID AM, the flow advances to step SP. At step SP, it is determined that the block is a block in which the ATRAC3 data file has been recorded.","At step SP, with reference to the serial number BLOCK SERIAL and the contents cumulation number key CONNUMO recorded in the ATRAC3 data block, they are stored in the memory. In the same ATRAC3 data file, the same content cumulation number key CONNUMO is assigned. In other words, when one ATRAC3 data file is composed of 10 blocks, the same number is assigned to CONNUMO of each block.","In addition, when one ATRAC3 data file is composed of 10 blocks, serial numbers  to  are successively assigned to BLOCK SERIALS of the 10 blocks. With CONNUMO, it is determined whether or not the current block composes the same content. With BLOCK SERIAL, the reproduction order of the current block in the same content (namely, the connection sequence) can be obtained.","According to the embodiment of the present invention, when 10 ATRAC3 data files (namely, 10 music programs) have been recorded and each of the ATRAC3 data files is composed of 10 blocks, there are 100 data blocks. With reference to CONNUMO and BLOCK SERIAL, the reproduction order of music programs of 100 data blocks and the connection order thereof can be obtained.","When the determined result at step SP represents that the last block has been searched, all the blocks have been searched for the reproduction management file, the ATRAC3 data file, and the attribute file. Thus, at step SP, based on CONNUMO, BLOCK SERIAL, FNO, and TRK XXX stored in the memory corresponding to block numbers, a link state of a file are obtained. After the link state is obtained, the FAT may be created in a free non-destroyed area of the memory.","Next, a management file according to a second embodiment of the present invention will be described. FIG.  shows the file structure of a memory card  according to the second embodiment of the present invention. Referring to , a music directory contains a track information management file TRKLIST.MSF (hereinafter, referred to as TRKLIST), a backup track information management file TRKLISTB.MSF (hereinafter, referred to as TRKLISTB), an additional information file INFLIST.MSF (that contains an artist name, an ISRC code, a time stamp, a still picture data, and so forth (this file is referred to as INFIST)), an ATRAC3 data file ADnnnn.MSA (hereinafter, referred to as ADnnnn). The file TRKLIST contains two areas NAME and NAME. The area NAME is an area that contains the memory card name and the program name (for one byte code corresponding to ASCII\/8859 1 character code). The area NAME is an area that contains the memory card name and the program name (for two byte code corresponding to MS JIS\/Hanku1\/Chinese code).",{"@attributes":{"id":"p-0239","num":"0457"},"figref":"FIG. 26","b":["1","2","3","1","2","1","2"]},"The track information area TRKINF nnnn and part information area PRTINF nnnn of the track information management file TRKLIST are used to manage the data file ADnnnn and the additional information INFLIST. Only the ATRAC3 data file ADnnnn is encrypted. In , the data length in the horizontal direction is 16 bytes (0 to F). A hexadecimal number in the vertical direction represents the value at the beginning of the current line.","According to the second embodiment, three files that are the track management file TRKLIST (including a program title, file), the additional information management file INFLIST, and the data file ADnnnn are used. According to the first embodiment (see , , and ), two files that are the reproduction management file PBLIST for managing all the memory card and the data file ATRAC3 for storing programs are used.","Next, the data structure according to the second embodiment will be described. For simplicity, in the data structure according to the second embodiment, the description of similar portions to those of the first embodiment is omitted.",{"@attributes":{"id":"p-0243","num":"0461"},"figref":"FIG. 27","b":["0","1"]},"YMDhms (4 bytes)\n\n","N (1 byte) (Option)\n\n","N (1 byte) (Option)\n\n","MSID (2 bytes) (Option)\n\n","S TRK (2 bytes).\n\n","PASS (2 bytes) (Option)\n\n","APP (2 bytes) (Option)\n\n","INF S (2 bytes) (Option)\n\n","The last 16 bytes of the file TRKLIST are used for an area BLKID TL, an area Mode, and an area REVISION that are the same as those of the header. The backup file TRKLISTB contains the above-described header. In this case, the header contains an area BLKID TL, an area Mode, and an area REVISION.","The header is followed by a track information area TRKINF for information with respect to each track and a part information area PRTINF for information with respect to each part of tracks (music programs).  shows the areas preceded by the area TRKLIST. The lower portion of the area TRKLISTB shows the detailed structure of these areas. In , a hatched area represents an unused area.","The track information area TRKINF nnn and the part information area PRTINF nnn contain areas of an ATRAC3 data file. In other words, the track information area TRKINF nnn and the part information area PRTINF nnn each contain a reproduction restriction flag area LT (1 byte), a contents key area CONTENTS KEY (8 bytes), a recorder\/player security block serial number area MG(D) SERIAL (16 bytes), an area XT (2 bytes) (option) for representing a feature portion of a music program, an area INX (2 bytes) (option), an area YMDhms S (4 bytes) (option), an area YMDhms E (4 bytes) (option), an area MT (1 byte) (option), an area CT (1 byte) (option), an area CC (1 byte) (option), an area CN (1 byte) (option) (these areas YMDhms S, YMDhms E, MT, CT, CC, and CN are used for reproduction restriction information and copy control information), an area A (1 byte) for part attribute, a part size area PRTSIZE (4 bytes), a part key area PRTKEY (8 bytes), and a contents cumulation number area CONNUM (4 bytes). The meanings, functions, and values of these areas are the same as those of the first embodiment. In addition, the track information area TRKINF nnn and the part information area PRTINF nnn each contain the following areas.","T (1 byte)\n\n","INF nnn (Option) (2 bytes)\n\n","FNM nnn (4 bytes)\n\n","APP CTL (4 bytes) (Option)\n\n","P nnn (2 bytes)\n\n","PR (1 byte)\n\n","Next, the areas NAME (for one byte code) and NAME (for two byte code) for managing names will be described.  shows the detailed structure of the area NAME (for one byte code area). Each of the areas NAME and NAME (that will be described later) is segmented with eight bytes. Thus, their one slot is composed of eight bytes. At 0x8000 that is the beginning of each of these areas, a header is placed. The header is followed by a pointer and a name. The last slot of the area NAME contains the same areas as the header.","BLKID NM (4 bytes)\n\n","PNM nnn (4 bytes) (Option)\n\n","PNM S\n\n","NM nnn (Option)\n\n",{"@attributes":{"id":"p-0266","num":"0506"},"figref":"FIG. 29","b":["2","2"]},"BLKID NM (4 bytes)\n\n","PNM nnn (4 bytes) (Option)\n\n","NM nnn (Option)\n\n",{"@attributes":{"id":"p-0270","num":"0516"},"figref":["FIG. 30","FIG. 30","FIG. 17"],"b":["3","3","3"]},{"@attributes":{"id":"p-0271","num":"0517"},"figref":"FIG. 31"},"BLKID INF (4 bytes)\n\n","T DAT (2 blocks)\n\n","MCode (2 bytes)\n\n","YMDhms (4 bytes)\n\n","DataSlot 0000 (0x0800)\n\n",{"@attributes":{"id":"p-0277","num":"0533"},"figref":["FIG. 32","FIG. 12C"]},"According to the second embodiment of the present invention, in addition to the file system defined as a format of the memory card, the track information management file TRKLIST for music data is used. Thus, even if the FAT is destroyed, the file can be recovered.  shows a flow of a file recovering process. To recover the file, a computer that operates with a file recovery program and that can access the memory card and a storing device (hard disk, RAM, or the like) connected to the computer are used. The computer has a function equivalent to the DSP30. Next, a file recovering process using the track management file TRKLIST will be described with reference to .","All blocks of the flash memory whose FAT has been destroyed are searched for TL  as the value (BLKID) at the top position of each block. In addition, all the blocks are searched for NM  as the value (BLKID) at the top position of each block. Thereafter, all the blocks are searched for NM  as the value (BLKID) at the top position of each block. All the contents of the four blocks (track information management file) are stored to for example a hard disk by the recovery computer.","The number of total tracks is obtained from data after the fourth byte of the track information management file. The 20-th byte of the track information area TRKINF , the value of the area CONNUM  of the first music program, and the value of the next area P  are obtained. The number of parts is obtained with the value of the area P . The values of the areas PRTSIZE of all parts of the track  of the area PRTINF is obtained. The number of total blocks (clusters) n is calculated and obtained.","After the track information management file is obtained, the flow advances to step . At step , a voice data file (ATRAC3 data file) is searched. All blocks of other than the management file is searched from the flash memory. Blocks whose top value (BLKID) is AD are collected.","A block of which the value of the area CONNUM at the 16-th byte of ADnnnn is the same as that of the area CONNUM  of the first music program of the track information management file and of which the value of the area BLOCK SERIAL that starts from 20-th byte is 0 is searched. After the first block is obtained, a block (cluster) with the same value of the area CONNUM value as the first block and of which the value of BLOCK SERIAL is incremented by 1 (1=0+1) is searched. After the second block is obtained, a block with the same value of the area CONNUMO as the second block and of which the value of the area BLOCK SERIAL is incremented by 1 (2=1+1) is searched.","By repeating the process, the ATRC3 data file is searched until n blocks (clusters) of the track  are obtained. When all the blocks (clusters) are obtained, they are successively stored to the hard disk.","The same process for the track  is performed for the track . In other words, a block of which the value of the area CONNUMO is the same as that of the area CONNUM  of the first music program of the track information management file and of which the value of the area BLOCK SERIAL that starts at the 20-th byte is searched. Thereafter, in the same manner as the track , the ATRAC3 data file is searched until the last block (cluster) n\u2032 is detected. After all blocks (clusters) are obtained, they are successively stored to the hard disk.","By repeating the above-described process for all tracks (the number of tracks: m), all the ATRAC3 data is stored to the hard disk controlled by the recovering computer.","At step , the memory card whose the FAT has been destroyed is re-initialized and then the FAT is reconstructed. A predetermined directory is formed in the memory card. Thereafter, the track information management file and the ATRAC3 data file for m tracks are copied from the hard disk to the memory card. Thus, the recovery process is finished.","In the management file and data file, important parameters (in particular, codes in headers) may be recorded triply rather than doubly. When data is redundantly recorded, the same data may be recorded at any positions as long as they are apart from each other for one page or more.","According to the present invention, as was described above, when a data file for example an audio file recorded on the memory card  is reproduced therefrom, even if a file that has been reproduction restricted and a file that has not been reproduction restricted have been stored on the memory card , they can be reproduced in a user's desired method. The system controller  and the operation portion (not shown) designate an audio file to be reproduced from the memory card  and a reproducing method thereof.","The following reproducing method can be applied for both the first format shown in  and the second format shown in . Next, data causing a reproducing operation to be restricted in the first format will be described once again.","Bits  and  of LT (one byte) of the track information area TRKINF shown in  represent that the current track has a restriction (bit : 0=not restricted; 1=restricted) and (bit : 0=not expired, 1=expired). YMDhms S (4 bytes) represents reproduction start date and time of a track that has been reproduction restricted. YMDhms E (4 bytes) represents reproduction end date and time of a track that has been reproduction restricted. CT (1 byte) represents the number of times of which the track can be reproduced in the number of permitted reproduction times. Whenever the track is reproduced, the value of CT is decremented. The value of CT is in the range from 0x00 to 0XFF. When the track has not been used, the value of CT is 0x00. When bit  of LT is 1 and the value of CT is 00, they represent that the track has been prohibited from being reproduced.",{"@attributes":{"id":"p-0291","num":"0547"},"figref":"FIG. 34"},"In the first mode, when a program that has been reproduction restricted is tried to be reproduced, the reproducing operation is paused, the user is informed that the program has been reproduction restricted, and the user is asked whether or not he or she wants to reproduce the program. Corresponding to the user's reply, the program is reproduced or prohibited from being reproduced. However, when the number of reproduction times of the program reaches the number of permitted reproduction times, the program is prohibited from being reproduced. In the second mode, when a program has been reproduction restricted, it is prohibited from being reproduced. In other words, in the second mode, a program that has been reproduction restricted is treated as if it were not present on the medium. In the third mode, a program that has been reproduction restricted is unconditionally reproduced. However in the third mode, when the number of reproduction times reaches the number of permitted reproduction times, the program is prohibited from being reproduced.","When a program (track) is prohibited from being reproduced, the program (track) is skipped. Alternatively, the program can be substantially prohibited from being reproduced in such a manner that the reproducing operation is stopped, that the reproduced output is muted, or that the program is erased from the medium. In the following description, term \u201creproduction prohibition\u201d has the forgoing meaning. However, where appropriate, term \u201cskip\u201d may be used.","In , when the power of the recorder is turned on at step S, the flow advances to step S. At step S, a prompt that causes the user to select one of the first, second, and third modes is displayed. At step S, a process for designating one mode is performed. At step S, the mode selected by the user is stored in the nonvolatile memory of the system controller . The power-on operation at step S represents a first power-on operation. A mode change is performed by another switch. However, whenever the power-on operation is performed, modes may be changed. At factory, as default, the first mode that causes the user to select one of the three modes has been designated.","At step S, it is determined whether or not the reproduction button has been pressed. When the determined result at step S represents that the reproduction button has been pressed, the flow advances to step S. At step S, it is determined whether or not the program to be reproduced has been reproduction restricted. When the determined result at step S represents that the program has not been reproduction restricted, the flow advances to step S. At step S, the program is normally reproduced. After one program has been reproduced, the flow advances to step S. At step S, it is determined whether or not the next program has been reproduction restricted.","When the determined result at step S represents that the program to be reproduced has been reproduction restricted, the flow advances to step S. At step S, a reproducing operation is performed corresponding to the mode stored in the nonvolatile memory . Thereafter, the flow advances to step S. At step S, in any mode, the reproducing operation of the program that can be reproduced is completed. Thereafter, the next program is processed. After the program that has been reproduction restricted with respect to the number of reproduction times has been reproduced, a reproduction log file is recorded in additional information INF for the track, the additional information INF having been described in the attribute header of the reproduced data file. Thereafter, the flow returns to step S.","Although the additional information INF has been described with reference to , data structure of the additional information INF in which a reproduction log is recorded will be described with reference to . A fixed value (0x69) is added at the beginning of the additional information INF. The fixed value (0x69) is followed by a key code that represents a category of additional information. In the example shown in , the key code is value  that represents a reproduction log. Next, the value  is followed by a code (for example 0x10) that represents the size of the additional information. The code 0x10 is followed by a maker code (MCode) that identifies the maker and model of the recording apparatus. The maker code is followed by null of three bytes (0x00). Null is a value that is meaningless.","The three-byte null is followed by data of one byte representing the number of reproduction times. In reality, the data of one byte is the value (eight bits) of CT. The value of CT before the program is reproduced or the value of CT after the program is reproduced is recorded. The value of CT is followed by data of reproduction date and time (YMDhms) of four bytes. The value of year (for example, 1980 to 2079) is recorded with seven bits. The value of month is recorded with four bits. The value of day (0 to 31) is recorded with five bits. The value of hour (0 to 23) is recorded with five bits. The value of minute (0 to 59) is recorded with six bits. The value of second (at intervals of two seconds) is recorded with five bits.","Whenever a program that has been reproduction restricted is reproduced, one reproduction log is recorded. At a result, with reproduction logs, the reproduction history of the program can be obtained. When management information such as additional information or track information is changed, the memory card  is attached to the recorder\/player. The management information is read to the RAM of the system controller . The system controller  rewrites the management information stored in the RAM and records the changed management information to the memory card . When the memory card  is detached from the recorder\/player or when the power thereof is turned off, rewritten management information may be recorded to the memory card .",{"@attributes":{"id":"p-0300","num":"0556"},"figref":["FIG. 36","FIG. 34"],"b":["38","41","6","6","42","6","43"]},"When the determined result at step S represents that bit =0, the flow advances to step S. At step S, by comparing the reproduction start date and time YMDhms S with the reproduction end date and time YMDhms E, it is determined whether or not the program has been reproduction restricted with respect to the duration of reproduction (the program has been expired). When the determined result at step S represents that the program has been reproduction restricted with respect to the duration of reproduction (the program has been expired), the flow advances to step S. At step S, the program is prohibited from being reproduced. When the determined result at step S represents that the program has not been reproduction restricted with respect to the duration of reproduction (the program has not been expired), the flow advances to step S. At step S, it is determined whether or not bit  of LT is 0.","Since (bit : 0=not restricted; 1=restricted), when the determined result at step S represents that bit  is 0, the flow advances to step S. At step S, the program is reproduced. When the determined result at step S represents that bit  is not 0, the flow advances to step S. At step S, it is determined whether or not the value of CT is 0. When the determined result at step S represents that the value of CT is 0, since the number of permitted reproduction times is 0, the program is prohibited from being reproduced (at step S).","When the determined result at step S represents that the value of CT is not 0, the flow advances to step S. At step S, it is determined whether or not the designated mode is the second mode. To determine the designated mode, the system controller  reads a code corresponding to the mode from the nonvolatile memory . When the determined result at step S represents that the designated mode is the second mode, the flow advances to step S. At step S, the program is skipped.","When the determined result at step S represents that the designated mode is not the second mode, the flow advances to step S. At step S, it is determined whether or not the designated mode is the first mode. When the determined result at step S represents that the designated mode is not the first mode, it is determined that the designated mode is the third mode. In the third mode, since a program that has been reproduction restricted is unconditionally reproduced, the flow advances to step S. At step S, the number of reproduction times CT is decremented. Thereafter, the flow advances to step S. At step S, the reproducing operation is performed.","When the determined result at step S represents that the designated mode is the first mode, the flow advances to step S. At step S, the user is informed that the program has been reproduction restricted with for example a message displayed on the monitor. Thereafter, the user is asked whether or not he or she wants to reproduce the program. For example, a message \u201cTrack Tr Play?\u201d is displayed. In this case, it is not always necessary to inform the user that the program has been reproduction restricted. When the user replies that he or she does not want to reproduce the program, the flow advances to step S. At step S, the program is skipped. When the user replies that he or she wants to reproduce the program, the flow advances to step S. At step S, the value of CT is decremented. Thereafter, the flow advances to step S. At step S, the program is reproduced.",{"@attributes":{"id":"p-0306","num":"0562"},"figref":"FIG. 37"},"In a combination of those reproducing methods and the first mode or the third mode, a reproducing method is automatically designated. In the process shown in , when the program repeat reproducing operation is performed, a reproducing method for automatically skipping a program that has been reproduction restricted is designated. In , for simplicity, similar blocks to those in  are omitted. In addition, their description will be omitted. As was described above, when the determined result at step S represents that the first mode has been designated, when the determined result at step S represents that the user wants to reproduce the program, when the determined result at step S represents that the designated mode is not the first mode, but the third mode, the flow advances to step S. At step S, it is determined whether or not the program repeat reproducing operation (endless repeat reproducing operation) has been designated.","When the determined result at step S represents that the program repeat reproducing operation has not been designated, the flow advances to step S through step S. At step S, the program is reproduced. When the determined result at step S represents that the program repeat reproducing operation has been designated, the flow advances to step S. At step S, the program is skipped. Thereafter, the flow returns to a reproducing process for the next program. For example, the flow returns to step S (see ). In the program repeat reproducing operation, there is a possibility of which a program will be reproduced a plurality of number of times. When the program has been reproduction restricted, there is a possibility of which the program cannot be reproduced soon. However, when the reproducing operation for the program is skipped, such a possibility can be avoided.","The flow chart of  shows only the program repeat reproducing operation. However, the reproducing method of the first mode or the third mode and the program shuffle reproducing operation can be combined. In other words, in the program shuffle reproducing operation, a program that has been reproduction restricted is skipped. Moreover, in the program pre-set reproducing operation, even if a program has been reproduction restricted, only when the first mode is selected, the program can be reproduced.",{"@attributes":{"id":"p-0310","num":"0566"},"figref":["FIG. 38","FIG. 38","FIG. 1"],"b":["71","72","72","78","71","78","79"]},"In the system, when predetermined application software is installed to the personal computer , digital audio data is stored to a hard disk of the personal computer . For example, music data is downloaded by the EMD system through the Internet. In addition, a CD ROM drive of the personal computer  reproduces a program from a music CD and records the reproduced program to the hard disk. In addition, a music file in the MP3 format is converted into an ATRAC3 format. The music file in the ATRAC3 format is recoded to the hard disk. In addition, the recorder  can record encrypted ATRAC3 data that is received from the personal computer  to the memory card. Moreover, music data can be prohibited from being recorded from the recorder  to the memory card.","The recorder  has a memory card slot  and a displaying device . The displaying device  is composed of for example a liquid crystal display. In addition, the recorder  has a power switch , an audio volume controller knob , an AMS\/JOG knob , and switch buttons to . The AMS\/JOG knob  is used to detect the beginning of a program. In addition, the recorder  can be operated by a remote control commander (not shown).","Next, an operation associated with the present invention will be described. First of all, a method for designating a reproducing mode for a program that has been reproduction restricted will be described. First, a MENU\/NO button is pressed. The AMS\/JOG knob  is rotated. \u201cRESTRICT\u201d is selected from a menu displayed on the displaying device . Thereafter, an ENTRY\/YES button is pressed.","On the displaying device , a menu for selecting one of the first mode, the second mode, and the third mode is displayed. The AMS\/JOG knob  is rotated. One of the three modes is selected. Thereafter, the ENTRY\/YES button is pressed. With such a sequence of operations, a desired mode has been designated.","As was described above, when a program has been reproduction restricted with respect to the duration of reproduction, by comparing the reproduction start date and time with the reproduction end date and time, it is determined whether or not the program has been expired. Thus, it is necessary to correctly set the time of the clock of the recorder . The date and time are input by the user and stored in the RAM of the system controller . When the system controller  has determined that the date and time information that was input by the user is not stored in the RAM, the system controller  prohibits a program that has been reproduction restricted with respect to the duration of reproduction from being reproduced.","Next, an operation for designating the date and time of the recorder  will be described. First, the MENU\/NO button is pressed. The AMS\/JOG knob  is rotated. \u201cDATE ADJ\u201d is selected from a menu displayed on the displaying device . Thereafter, the ENTRY\/YES button is pressed.","The AMS\/JOG knob  is rotated. A correct value (for example, low order two digits of Christian year) is set to \u201cyear\u201d that blinks. Thereafter, the ENTRY\/YES button is pressed. Thereafter, \u201cmonth\u201d blinks. The AMS\/JOG knob  is rotated. A correct value is set to \u201cmonth\u201d. Thereafter, the ENTRY\/YES button is pressed. Thereafter, \u201cday\u201d blinks. The AMS\/JOG knob  is rotated. A correct value is set to \u201cday\u201d. Thereafter, the ENTRY\/YES button is pressed. In the same manner as \u201cyear\u201d, \u201cmonth\u201d, and \u201cday\u201d, correct values are set to \u201chour\u201d and \u201cminute\u201d. In the forgoing operations, the date and time have been set.","In the forgoing, the case that the present invention is applied to a digital audio recorder was described. Likewise, the present, invention can be applied to an apparatus that deals with video data, another type of audio data, and\/or program data. In addition, the present invention can be applied to a reproducing apparatus that uses a record medium such as a writable optical disc as well as a memory card.","According to the present invention, when a program is reproduced from a record medium on which both a program that has been reproduction restricted and a program that has not been reproduction restricted have been recorded, a program that has been reproduction restricted is reproduced in a method that the user has designated. Thus, the user can select a method for reproducing a program that has been reproduction restricted. Consequently, whenever a program that has been reproduction restricted is reproduced, a situation of which the reproducing operation is paused can be prevented. In addition, a situation of which the user fails to notice that the number of permitted reproduction times becomes 0 can be prevented. In addition, when a program that has been reproduction restricted is reproduced, a log file is automatically created. Thus, the user can know the reproduction history of the program with the created log files. Consequently, the user can use the reproduction logs to prevent a trouble from taking place.",{"@attributes":{"id":"p-0320","num":"0000"},"ul":{"@attributes":{"id":"ul0172","list-style":"none"},"li":[{"@attributes":{"id":"ul0172-0001","num":"0576"},"b":"10"},{"@attributes":{"id":"ul0172-0002","num":"0577"},"b":"20"},{"@attributes":{"id":"ul0172-0003","num":"0578"},"b":"30"},{"@attributes":{"id":"ul0172-0004","num":"0579"},"b":"40"},{"@attributes":{"id":"ul0172-0005","num":"0580"},"b":"42"},{"@attributes":{"id":"ul0172-0006","num":"0581"},"b":"52"},"PBLIST REPRODUCTION MANAGEMENT FILE","TRKLIST TRACK INFORMATION MANAGEMENT FILE","INFLIST ADDITIONAL INFORMATION MANAGEMENT FILE","ADnnn AUDIO DATA FILE",{"@attributes":{"id":"ul0172-0011","num":"0586"},"b":"71"},{"@attributes":{"id":"ul0172-0012","num":"0587"},"b":"73"},{"@attributes":{"id":"ul0172-0013","num":"0588"},"b":"78"},"Sp BLKID-TL?","SP INCREMENT BLOCK","SP LAST BLOCK?","SP SEARCHED BLOCK IS PBLIST","SP NUMBER OF TOTAL TRK WITH REFERENCE TO T-TRK CONTAINED IN PBLIST \u2192N","SP SUCCESSIVELY SEARCH FOR TRK-XXX OF PBLIST","SP CORRELATE TRK-XXX AND FNO AND STORE CORRELATED TABLE IN MEMORY","SP N\u2190N\u22121","SP N=0?","SP RETURN POINTER TO TOP BLOCK","SP BLKID-HD?","SP INCREMENT BLOCK","SP LAST BLOCK?","SP DETERMINED RESULT REPRESENTS THAT SEARCHED BLOCK IS ATTRIBUTE FILE","SP CORRELATE FNO, BLOCKSERIAL, AND CONNUM CORRESPONDING TO BLOCK NUMBERS AND STORE CORRELATED TABLE TO MEMORY","SP RETURN POINTER TO TOP BLOCK","SP BLKID-AD?","SP INCREMENT BLOCK","SP LAST BLOCK?","SP DETERMINED RESULT REPRESENTS THAT SEARCHED BLOCK IS ATRAC FILE","SP CORRELATE BLOCK N, CONNUM, AND BLOCK SERIAL AND STORE CORRELATED TABLE TO MEMORY","SP OBTAIN LINK STATE OF FILE CORRESPONDING TO EACH TABLE STORED IN MEMORY","SP POWER ON","SP SELECT REPRODUCING MODE FROM FIRST, SECOND, AND THIRD MODES","SP SELECT ONE FROM THREE MODES","SP STORE SELECTED MODE TO NVM","SP REPRODUCTION BUTTON PRESSED?","S HAS PROGRAM BEEN REPRODUCTION RESTRICTED?","S PERFORM NORMAL REPRODUCING OPERATION FOR ONE PROGRAM","S PERFORM REPRODUCING OPERATION CORRESPONDING TO MODE STORED IN NVM","S COMPLETE REPRODUCING OPERATION OF REPRODUCIBLE PROGRAM AND PROCESS NEXT PROGRAM. AFTER PROGRAM THAT HAS BEEN REPRODUCTION RESTRICTED WITH RESPECT TO NUMBER OF REPRODUCTION TIMES IS REPRODUCED, LOG FILE IS RECORDED IN INF.","S LT BIT =0?","S PROGRAM HAS NOT BEEN EXPIRED","S PROGRAM IS PROHIBITED FROM BEING-REPRODUCED","S LT BIT =0?","S REPRODUCE PROGRAM","S CT=0?","S PROHIBIT PROGRAM FROM BEING REPRODUCED","S SECOND MODE?","S SKIP PROGRAM","S FIRST MODE?","S CT=CT-","S WHETHER USER WANTS TO REPRODUCE PROGRAM?","S SKIP PROGRAM","S REPEAT REPRODUCING OPERATION?","S SKIP PROGRAM"]}}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":[{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 25","b":"40"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 26","b":"3"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 28","b":"1"},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 29","b":"2"},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 30","b":"3"},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 31"},{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 32"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 33"},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 34"},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIG. 35"},{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 36"},{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 37"},{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIG. 38"}]},"DETDESC":[{},{}]}
