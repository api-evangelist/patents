---
title: Method and system for zooming in and out of paginated content
abstract: A method and system for changing the zoom applied to a document. A request is received to change the zoom of a document displayed in a viewing area. A focal point is determined based on whether an insertion point or active selection is currently displayed in the viewing area. Then, the viewable area of the document is displayed in the viewing area based on the focal point and the zoom change.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07434174&OS=07434174&RS=07434174
owner: Microsoft Corporation
number: 07434174
owner_city: Redmond
owner_country: US
publication_date: 20050304
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The invention relates generally to computers, and more particularly to displaying information.","Computer displays are quickly becoming a viable viewing source for many types of activities. One such activity is the viewing of documents. A computer can allow great flexibility in viewing a document including jumping to hyperlinked locations in the document, zooming in and out, allowing a user to jump to a page by indicating a desired page number, and a host of other document viewing options. When zooming in and out in viewing a document, a user may become frustrated or confused by the behavior of current document viewing implementations.","What is needed is an improved method and system for zooming in and out of paginated content.","Briefly, the present invention provides a method and system for changing the zoom applied to a document. A request is received to change the zoom of a document displayed in a viewing area. A focal point is determined based on whether an insertion point or active selection is currently displayed in the viewing area. Then, the viewable area of the document is displayed in the viewing area based on the focal point and the zoom change.","In one aspect, a user making zoom changes is provided with a better and more consistent experience when viewing the document.","In another aspect, dead space in the viewing area is minimized or reduced during zooming.","Other aspects will become apparent from the following detailed description when taken in conjunction with the drawings, in which:","Exemplary Operating Environment",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microcontroller-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, and so forth, which perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general-purpose computing device in the form of a computer . Components of the computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer-readable media. Computer-readable media can be any available media that can be accessed by the computer  and includes both volatile and nonvolatile media, and removable and non-removable media. By way of example, and not limitation, computer-readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer-readable instructions, data structures, program modules, or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by the computer . Communication media typically embodies computer-readable instructions, data structures, program modules, or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer-readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media, discussed above and illustrated in , provide storage of computer-readable instructions, data structures, program modules, and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers herein to illustrate that, at a minimum, they are different copies. A user may enter commands and information into the computer  through input devices such as a keyboard  and pointing device , commonly referred to as a mouse, trackball or touch pad. Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, a touch-sensitive screen of a handheld PC or other writing tablet, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface  or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Zooming into Paginated Content",{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 2","FIG. 1"],"b":["200","205","200","110","205"]},"The document viewing control may expose several properties and commands. Below is a definition of some exemplary properties and commands that may be exposed by the document viewing control .",{"@attributes":{"id":"p-0028","num":"0027"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"namespace System.Windows.Controls"},{"entry":"{"},{"entry":"\u2003public class DocumentViewer : Control, IServiceProvider,"},{"entry":"IAutomationPatternProvider, IAddChild, IEnsureVisible"},{"entry":"\u2003{"},{"entry":"\u2003\u2003\/\/Public Properties"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["\u2003\u2003\/\/Page layout & display controls",{}]},{"entry":["\u2003\u2003public int","PageCount { get; }"]},{"entry":["\u2003\u2003public int","FirstVisiblePage { get; set; }"]},{"entry":["\u2003\u2003public int","LastVisiblePage { get; }"]},{"entry":["\u2003\u2003public double","HorizontalOffset { get; set; }"]},{"entry":["\u2003\u2003public double","VerticalOffset { get; set; }"]},{"entry":["\u2003\u2003public double","ExtentWidth { get; }"]},{"entry":["\u2003\u2003public double","ExtentHeight { get; }"]},{"entry":["\u2003\u2003public double","ViewportWidth { get; }"]},{"entry":["\u2003\u2003public double","ViewportHeight { get; }"]},{"entry":["\u2003\u2003public bool","ShowPageBorders { get; set; }"]},{"entry":["\u2003\u2003public DocumentLayout","DocumentLayout { get; set; }"]},{"entry":["\u2003\u2003public double","ZoomPercentage { get; set; }"]},{"entry":["\u2003\u2003public int","GridColumnCount { get; set; }"]},{"entry":["\u2003\u2003public double","VerticalPageSpacing { get; set; }"]},{"entry":["\u2003\u2003public double","HorizontalPageSpacing { get; set; }"]},{"entry":"\u2003\u2003\/\/The document content"},{"entry":["\u2003\u2003public IDocumentPaginator","Content { get; set; }"]},{"entry":"\u2003\u2003\/\/Useful flags (for Styling purposes)"},{"entry":["\u2003\u2003public bool","IsAtStart { get; }"]},{"entry":["\u2003\u2003public bool","IsAtEnd { get; }"]},{"entry":["\u2003\u2003public bool","CanZoomIn { get; }"]},{"entry":["\u2003\u2003public bool","CanZoomOut { get; }"]},{"entry":["\u2003\u2003public bool","IsToolbarMaximized { get; set; }"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\u2003\u2003\/\/Attached Dependency Property for Styling requirements"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["\u2003\u2003public DependencyProperty","ContentHostProperty;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\/\/Public Commands exposed by DocumentViewer (i.e. not in CommandLibrary)"},{"entry":"\u2003\u2003\/\/Toolbar"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["\u2003\u2003public Command","ToggleToolbar;"]},{"entry":"\u2003\u2003\/\/Layout related"},{"entry":["\u2003\u2003public Command","ReflowDocument;"]},{"entry":["\u2003\u2003public Command","ViewThumbnails;"]},{"entry":["\u2003\u2003public Command","ViewFitToWidth;"]},{"entry":["\u2003\u2003public Command","ViewFitToHeight;"]},{"entry":"\u2003}"},{"entry":"}"},{"entry":"namespace System.Windows.Documents"},{"entry":"{"},{"entry":"\u2003\u2003\/\/Document Layout specification"},{"entry":"\u2003\u2003public struct DocumentLayout"},{"entry":"\u2003\u2003{"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u2003\u2003\u2003\/\/Constructor assuming Value = 1.0 and Text=\u201c \u201d"},{"entry":"\u2003\u2003\u2003public DocumentLayout(DocumentLayoutType type);"},{"entry":"\u2003\u2003\u2003\/\/Constructor assuming Default Text=\u201c \u201d."},{"entry":"\u2003\u2003\u2003public DocumentLayout(DocumentLayoutType type, double value);"},{"entry":"\u2003\u2003\u2003\/\/Constructor assuming nothing."},{"entry":"\u2003\u2003\u2003public DocumentLayout(DocumentLayoutType type, double value,"},{"entry":"string text);"},{"entry":"\u2003\u2003\u2003public DocumentLayoutType DocumentLayoutType { get; set; }"},{"entry":"\u2003\u2003\u2003public double Value { get; set; }"},{"entry":"\u2003\u2003\u2003public string Text { get; set; }"},{"entry":"\u2003\u2003}"},{"entry":"\u2003\u2003public enum DocumentLayoutType"},{"entry":"\u2003\u2003{"},{"entry":"\u2003\u2003\u2003Zoom,"},{"entry":"\u2003\u2003\u2003FitToWidth,"},{"entry":"\u2003\u2003\u2003FitToHeight,"},{"entry":"\u2003\u2003\u2003ThumbnailView,"},{"entry":"\u2003\u2003\u2003GridColumnCount"},{"entry":"\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"The properties and commands of the document viewing control  may be accessed by the application . Properties that indicate \u201cget\u201d are readable. Properties that indicate \u201cset\u201d are writable. Properties that indicate \u201cget\u201d and \u201cset\u201d are both readable and writable. It will be readily recognized that other properties and commands may be included and\/or that some of the properties and commands above may be deleted or modified without departing from the spirit or scope of the present invention. Furthermore, the above-described properties and commands are exemplary, and it will be readily recognized that other data structures, definitions, techniques, and methods may be used to implement various aspects of the document viewing control  without departing from the spirit or scope of the present invention.",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 3","b":["205","310","315","310","321","325","320","321","322","323","324","325","205"]},"Of particular interest, zoom-in button , zoom combobox , and zoom-out button  provide a mechanism for changing the zoom percentage (hereinafter \u201czoom\u201d) applied to a document in the viewing area . By selecting zoom-in button , a user may decrease the zoom applied to a document. By selecting the zoom-out button , a user may increase the zoom applied to a document. The zoom combobox  may include various predefined \u201cZoom Stops\u201d and other zoom-related settings (e.g., \u201c100%\u201d, \u201c50%\u201d, \u201c1 Page\u201d and the like) and may also allow a user to type in a zoom for changing the zoom applied to a document.","Ideally, the document viewing control  includes most or all the functionality for displaying a document based on selections to the toolbar items. For example, if the zoom-out button  is selected, the document viewing control  may zoom the document in the view area  as appropriate without additional instruction by the application hosting the document viewing control .",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 4","b":["405","410","405","405","410","410"]},"In some senses, for zooming purposes, the IP may be considered and treated as an active selection of zero length starting at the IP. When there is no active selection or IP visible in the viewing area, the center of the viewing area may be used as the focal point. It will be recognized that other locations may also be used as the focal point, including the center, top, bottom, end, or left or right side of an active selection, for example, without departing from the spirit or scope of the present invention.","When zooming in, the focal point is centered in the window as much as possible while keeping the dead space around the page grid to a minimum. Dead space is border space around displayed pages in which no portion of the document is displayed.  illustrates several exemplary views of a viewing area of a document viewing control as the zoom increases in accordance with various aspects of the invention.","A view  shows the document displayed in a grid with one of the pages having an active selection. When the zoom is increased, since there is an active selection that is viewable, the beginning of this active selection is used as the focal point.","A view  shows the document when the zoom has increased. As the zoom increases, the focal point moves towards the center of the viewing area in a manner to avoid excessive dead space around the document in the viewing area. For example, in the view , the focal point is not yet at the center of the viewing area as to do so at this zoom level would introduce dead space at the right and possibly bottom of the viewing area.","At some time as the zoom increases, the focal point moves to the center of the viewing area. Thereafter, as the zoom continues to increase, the focal point remains in the center of the viewing area. This can be seen in views , , , and  as the zoom increases.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 6","b":["605","610","635"]},"Zooming in and out with an IP is handled similarly to zooming in and out with an active selection. In this case, if the IP is in a page that is displayed in the viewing area, the IP becomes the focal point. After that point, displaying the document in response to changes in zoom proceeds as described previously.","Zooming in an out when neither an IP nor an active selection is displayed in the viewable area proceeds by using the center of the viewable area as the focal point and then displaying the document in response to changes in zoom as described previously.","It should be noted that changing the zoom does not change the layout of the page grid but may change the number of pages displayed. For example, if two rows of pages of a grid having two columns are originally displayed and zoom out is selected, the beginning of the third row of pages may be displayed, but no new columns are added.","Changing the zoom may change the content size of flow content to keep it in sync with the size of the page element, but it may not affect the flow of the content. Rather, an application may initiate a reflow of content on the pages.","When a request to change the number of grid columns is made, the page containing the IP may be placed in the first row of the page grid but may not necessarily be the first visible page. For example, if page  has the IP and the user asks for 3 grid columns, page  may be the first visible page but page  is still in the first row. If there is no IP (i.e., read only content), the first visible page may be used to determine the layout of the grid columns.","Additionally, when selecting a number of columns to display, the number of rows may not be needed since the number of rows in the page grid is based directly on the number of columns and the window size. For example, if the request is for 5 columns and the document has 15 pages, the zoom may be set to a percentage that allows a second row of 5 pages (or possibly a third) to be displayed.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 7","b":"605"},"At block , a zoom change is received. This may be received, for example, in response to a user selecting a button or a program calling an API or setting a property of the document viewing control.","At block , a determination is made as to whether the zoom change is a zoom out or a zoom in. If the zoom change is a zoom out, processing continues at block ; otherwise, processing continues at block .","At block , because a goal when zooming out is to keep the focal point at the vertical center, the focal point is kept at the vertical center of the viewing area. The horizontal position at which the focal point is displayed may change to attempt to minimize dead space around the page that contains the focal point. For example, if the focal point is in the right edge of a grid of pages and originally the focal point is displayed at the center of the viewing area, the focal point may be displayed closer to the right edge of the viewing area with each subsequent zoom out. This is shown, for example, in conjunction with .","Block  is reached when zooming in. At block , a determination is made as to whether the focal point is already displayed at the center of the viewable area. If so, processing branches to block ; otherwise, processing branches to block .","At block , a calculation is performed as to where to display the focal point. When zooming in, the focal point is displayed closer and closer to the center of the display area until it is displayed as the center of the display area. In subsequent zoom-ins, the focal remains displayed in the center of the viewable area. The calculation performed at block  determines where the focal point should be displayed so as to reduce or minimize dead space around the page including the focal point as described previously.","At block , the focal point is not moved in the viewing area when the document is displayed using the new zoom.","At block , the viewable area of the document is displayed in the viewing area in accordance with the new zoom. At block , the actions end. The actions described above may be repeated each time a zoom changes.","It will be recognized that aspects of the invention may be practiced with or without a document viewing control. For example, a standard word processor, spreadsheet, presentation application, web browser, operating system component, or other kind of document viewer may zoom in and out on a document as described above without having a document view control.","It will also be recognized that different zooming behaviors may be implemented for zooming in and out on a document without departing from the spirit or scope of the present invention. For example, when zooming in when no insertion point or active selection is viewable, the focal point may be set to the page having the most area displayed and that is closest to the center of the viewable area.","As can be seen from the foregoing detailed description, there is provided a method and system for zooming in an out of paginated content. While the invention is susceptible to various modifications and alternative constructions, certain illustrated embodiments thereof are shown in the drawings and have been described above in detail. It should be understood, however, that there is no intention to limit the invention to the specific forms disclosed, but on the contrary, the intention is to cover all modifications, alternative constructions, and equivalents falling within the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
