---
title: Power management for passive optical networks
abstract: A power manager for a passive optical network, including a network statistics collector, for collecting data regarding traffic in a passive optical network (PON) including a plurality of optical network units (ONUs) on the downstream side of the PON, wherein each ONU can be in at least a sleep state and an active state, and wherein the PON transmits data in packets of data frames, a buffer for storing downstream data frames for each ONU while the ONU is in the sleep state, an activity detector for processing the data collected by the network statistics collector to generate indicators of activity levels for each ONU, and a protocol manager including a plurality of state machines for the respective plurality of ONUs, wherein each state machine governs state transition of its respective ONU to the sleep state when the activity detector indicates a low activity level for the ONU, and to the active state when the activity detector indicates a high level of activity for the ONU.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08477650&OS=08477650&RS=08477650
owner: Oliver Solutions Ltd.
number: 08477650
owner_city: Herzliya
owner_country: IL
publication_date: 20110613
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCES TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE DESCRIPTION","DETAILED DESCRIPTION"],"p":["This application claims priority benefit of U.S. Provisional Application No. 61\/381,452, entitled NOVEL APPROACH TO POWER SAVE IN PASSIVE OPTICAL NETWORKS, filed on Sep. 10, 2010 by inventors Danny Greenberg and Oren Spector.","The present invention relates to passive optical networks.","A passive optical network (PON) is a point-to-multipoint fiber-optic network, in which unpowered optical splitters are used to enable a single optical fiber to service multiple premises, typically 16-128 homes. Reference is made to , which is a simplified diagram of a prior art PON . As seen in , PON  includes a central office node, referred to as an optical line terminal (OLT) , a number of user nodes, referred to as optical network units (ONUs) , which are near user premises , and fibers  and splitters  between them.","Data is transmitted within PON  in packets referred to as data frames. Downstream signals (i.e., signals transmitted from left to right in ) originate from network services, such as an Internet service A, a voice over IP service B, a cable TV service C and other such services D. The downstream signals are broadcast to all premises  that share a single fiber. Bandwidth for upstream signals (i.e., signals transmitted from right to left in ) is allocated by time-division multiplexing among ONUs . Current PONs  operate at 1 Gbit\/s and 2.5 Gbit\/s rates, and 10 Gbit\/s PONs will be available in the near future.","A drawback of conventional PONs  is the large amounts of power that they consume. Moreover, as traffic rates in a PON increase, the power consumption of the PON also increases. As such, as PONs improve to operate at higher rates, the need to reduce their power consumption is ever more pressing.","Aspects of the present invention relate to methods and systems for managing power for PONs, so as to save energy, reduce heat dissipation, meet power limit regulations, and save operational expenses. The present invention includes a novel hardware architecture, a novel software architecture and application programming interface, and a novel protocol for power management.","Embodiments of the present invention include a distributed power management protocol that runs on the OLT side and on the ONU side of a PON. These embodiments track PON activity, and transition ONUs in and out of power saving states based on activity statistics and configurable parameters.","There is thus provided in accordance with an embodiment of the present invention a power manager for a passive optical network, including a network statistics collector, for collecting data regarding traffic in a passive optical network (PON) including a plurality of optical network units (ONUs) on the downstream side of the PON, wherein each ONU can be in at least a sleep state and an active state, and wherein the PON transmits data in packets of data frames, a buffer for storing downstream data frames for each ONU while the ONU is in the sleep state, an activity detector for processing the data collected by the network statistics collector to generate indicators of activity levels for each ONU, and a protocol manager including a plurality of state machines for the respective plurality of ONUs, wherein each state machine governs state transition of its respective ONU to the sleep state when the activity detector indicates a low activity level for the ONU, and to the active state when the activity detector indicates a high level of activity for the ONU.","There is additionally provided in accordance with an embodiment of the present invention a method for managing power of a passive optical network, including collecting data regarding traffic in a passive optical network (PON) including a plurality of optical network units (ONUs) on the downstream side of the PON, wherein each ONU can be in at least a sleep state and an active state and wherein the PON transmits data in packets of data frames, storing downstream data frames for each ONU in a buffer, while the ONU is in the sleep state, processing the data collected by the collecting to generate indicators of activity levels for each ONU, and determining state transitions of each ONU, wherein an ONU transitions to the sleep state when the indicators of activity level for the ONU indicate a low activity level for the ONU, and an ONU transitions to the active state when the indicators of activity level for the ONU indicate a high level of activity for the ONU.","There is further provided in accordance with an embodiment of the present invention a system for power management of a passive optical network, including a plurality of optical network units (ONUs) on the downstream side of a passive optical network (PON), wherein each ONU transmits data in packets of data frames, wherein each ONU can be in at least a sleep state and an active state, and wherein each ONU includes an ONU network statistics collector, for collecting data regarding traffic at the ONU, an ONU activity detector for processing the data collected by the network statistics collector to generate indicators of activity level of the ONU, and an ONU protocol manager including a state machine for the ONU, wherein the state machine governs state transition of the ONU to the sleep state when the ONU activity detector indicates a low activity level for the ONU, and an optical line terminal (OLT) on the upstream side of the PON, including an OLT network statistics collector, for collecting data regarding traffic at each of the ONUs, an OLT buffer for storing downstream data frames for each ONU while the ONU is in the sleep state, an OLT activity detector for processing the data collected by the OLT network statistics collector to generate indicators of activity levels for each ONU, and an OLT protocol manager including a plurality of state machines for the respective plurality of ONUs, wherein each state machine governs state transition of its respective ONU to the active state when the OLT activity detector indicates a high level of activity for the ONU.","Aspects of the present invention relate to power management of PONs.","Reference is made to , which is a simplified block diagram of an enhanced PON , with power management in accordance with an embodiment of the present invention. PON  includes an OLT  with a novel power management (PM) module , and ONUs  with novel PM modules .","Each ONU PM module  maintains its own state machine, and OLT PM module  maintains separate state machines for each ONU . Each ONU  may operate in one of three possible states; namely, an \u201cActive\u201d state, which is its normal operational state, a \u201cSleep\u201d state, which is a low-power mode, and an interim \u201cWaking Up\u201d state, during which ONU PM module  sends a report regarding its upstream buffer occupancy to OLT PM module , and OLT PM module  and ONU PM module  jointly decide whether ONU  should transition to Sleep state or to Active state. The state machines in OLT PM module  and ONU PM module  are activated periodically. The inputs to each ONU PM state machine include the current state of the ONU, various PON activity statistics described hereinbelow, and system-wide configurable parameters described hereinbelow. The output of each ONU PM state machine includes the next state that the ONU should transition to, and relevant control signals as described hereinbelow.","While one or more ONUs  are in Sleep state, downstream, data for the ONUs is stored in one or more buffers\/queues in PM module , and upstream data for the ONUs is stored in buffers\/queues in PM module . OLT PM module  and ONU PM modules  implement logic of a power management protocol described hereinbelow with reference to .","Reference is made to , which is a simplified block diagram of OLT PM module , in accordance with an embodiment of the present invention. As seen in , OLT PM module  includes one or more controllable buffers\/queues , for storing downstream data for each ONU that is in Sleep state. Storage of data in buffers\/queues  and extraction of data from buffers\/queues  is controlled by control signals of the power management protocol described hereinbelow with reference to .","OLT PM module  further includes a management data frames receiver channel  and a management data frames transmitter channel . In accordance with an embodiment of the present invention, power management protocol messages are encapsulated within management data frames. Channels  and  are hardware buffers for receiving and transmitting such management data frames. OLT PM module  writes a management data frame, for downstream transmission to a destination ONU PM module , into transmitter channel . After writing the complete management data frame, OLT PM module  indicates to transmitter channel  that the data frame is ready for transmission. Channel  then transmits the data frame downstream to the destination ONU PM module , at a higher than standard priority.","OLT PM module  writes management frame data, arriving from an ONU PM module , into receiver channel . OLT PM module  polls a hardware flag to determine when a complete management data frame is available in receiver channel . Alternatively, OLT PM module  is interrupted by receiver channel  when a complete management data frame is available in receiver channel . OLT PM module  then reads the content of the received management data channel, and parses the content to extract a power management protocol message.","OLT PM module  further includes a statistics collector . Statistics collector  uses counters and accumulators to track PON data, including the following time series statistics.","Upstream received bytes\u2014bytes received by each ONU  from OLT ","Incoming frames\u2014frames received by each ONU  from OLT ","Downstream received bytes\u2014bytes received by each ONU  from premises ","Outgoing frames\u2014frames prepared by each ONU  for upstream transmission","PON clock\u2014time, measured in units of time quanta","OLT Downstream buffer occupancy\u2014number of bytes in downstream data buffer\/queue ","ONU upstream buffer occupancy\u2014number of bytes in each ONU upstream buffer, obtained by parsing each ONU's report messages","OLT PM module  further includes a downstream activity detector  and an upstream activity detector , for calculating respective downstream and upstream metrics from the statistical data collected by statistics collector . Downstream activity detector  generates the following metrics for each ONU .","Downstream rate\u2014a decaying time series average of the ONU downstream received bytes, as described hereinbelow","Downstream frames gap\u2014a decaying time series average of gaps between ONU outgoing frames, as described hereinbelow","Similarly, upstream activity detector  generates the following metrics for each ONU .","Upstream rate\u2014a decaying time series average of the ONU upstream received bytes, as described hereinbelow","Upstream frames gap\u2014a decaying time series average of gaps between ONU incoming frames, as described hereinbelow","The downstream and upstream rates are calculated by respective activity detectors  and  according to the following function.",{"@attributes":{"id":"p-0033","num":"0032"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"calc_rate( current_rx_bytes, prev_rx_bytes, prev_average )"]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003new_bytes = current_rx_bytes \u2212 prev_rx_bytes;"]},{"entry":[{},"\u2003\u2003prev_rx_bytes = rx_bytes;"]},{"entry":[{},"\u2003\u2003prev_average = smoothing_factor * new_bytes +"]},{"entry":[{},"\u2003\u2003\u2003\u2003(1 \u2212 smoothing_factor) * prev_average;"]},{"entry":[{},"\u2003\u2003rate = 8 * prev_average \/ time_step \/\/ in bits per second"]},{"entry":[{},"\u2003\u2003return rate;"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"The downstream and upstream frame gaps are calculated by respective activity detectors  and  according to the following function.",{"@attributes":{"id":"p-0035","num":"0034"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"calc_gap( current_rx_bytes, prev_rx_bytes, prev_gap,"]},{"entry":[{},"prev_average )"]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003if (current_rx_bytes > prev_rx_bytes ) {"]},{"entry":[{},"\u2003\u2003\u2003\u2003if (smoothing factor == 1.0 ) {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003prev_average = 0;"]},{"entry":[{},"\u2003\u2003\u2003\u2003} else {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003prev_average = smoothing_factor * prev_gap +"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003(1 \u2212 smoothing_factor) * prev_average;"]},{"entry":[{},"\u2003\u2003\u2003\u2003}"]},{"entry":[{},"\u2003\u2003\u2003\u2003current_average = prev_average;"]},{"entry":[{},"\u2003\u2003\u2003\u2003prev_gap = 0;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003else {"]},{"entry":[{},"\u2003\u2003\u2003\u2003prev_gap = prev_gap + time_step;"]},{"entry":[{},"\u2003\u2003\u2003\u2003current_average = prev_average;"]},{"entry":[{},"\u2003\u2003if ( prev_gap > current_average )"]},{"entry":[{},"\u2003\u2003\u2003\u2003current_average = smoothing_factor * prev_gap +"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2002(1 \u2212 smoothing_factor) * current_average;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003gap = current_average; \/\/ in seconds"]},{"entry":[{},"\u2003\u2003return gap:"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"The function calc_rate is also called every time_step seconds. If a new data frame has arrived since the previous call to calc_rate, then prev_gap is reset to zero. Otherwise, prev_gap is incremented by time_step.","Activity detectors  and  determine state transitions for ONUs  based on thresholds of activity. Specifically, an ONU  is deemed to have sufficiently low activity to transition to Sleep state at a given time, if the above metrics for ONU  at the given time satisfy all of the following conditions.",{"@attributes":{"id":"p-0038","num":"0037"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Sleep Conditions"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"upstream_rate < upstream_rate_threshold"]},{"entry":[{},"downstream_rate < downstream_rate_threshold"]},{"entry":[{},"upstream_frame_gap > upstream_frame_gap_threshold"]},{"entry":[{},"downstream_frame_gap > downstream_frame_gap_threshold"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":{}},"An ONU  is deemed to have accumulated a sufficient backlog of activity to transition to Active state at a given time, if the statistics for ONU  at the given time satisfy both of the following conditions.",{"@attributes":{"id":"p-0040","num":"0039"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Wakeup Conditions"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"upstream_buffer_occupancy > upstreamoccupancy_threshold"},{"entry":"downstream_buffer_occupancy > downstreamoccupancy_threshold"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"The various threshold parameters, upstream_rate_threshold, downstream_rate_threshold, upstream,_frame_gap_threshold, downstream_frame_gap_threshold, upstream_occupancy_threshold and downstream_occupancy_threshold are configurable parameters which control transitions of ONUs  into Sleep and Active states.","Reference is made to , which is a simplified block diagram of an OLT-side power management framework , in accordance with an embodiment of the present invention. As seen in , power management framework  includes an OLT API , which provides methods and data structures for use by OLT PM module .","TABLE I describes methods and TABLES II and III describe respective parameter and statistical data structures provided by OLT API .",{"@attributes":{"id":"p-0044","num":"0043"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE I"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Methods used by OLT PM Module 260"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Protocol initialization","Used to initialize internal states and variables of"]},{"entry":[{},"the PM protocol"]},{"entry":["Message handling","Used to process protocol messages transmitted"]},{"entry":[{},"from ONU PM modules 280 to OLT PM module"]},{"entry":[{},"260"]},{"entry":["State machine process","Used to decide whether to transition an ONU"]},{"entry":[{},"220 from one state to another state. OLT PM"]},{"entry":[{},"module 260 is responsible to subsequently call"]},{"entry":[{},"the state machine of ONU PM module 280 when"]},{"entry":[{},"this method is called."]},{"entry":["Get parameters","Read the protocol parameters"]},{"entry":["Get statistics","Read the statistics and decisions of activity"]},{"entry":[{},"detectors 262 and 263"]},{"entry":["Send message","Send a protocol message from OLT PM module"]},{"entry":[{},"260 to an ONU PM module 280"]},{"entry":["Set downstream buffer","Enable or disable downstream buffer 261 for a"]},{"entry":[{},"specific ONU. Buffer 261 is enabled for ONUs"]},{"entry":[{},"that are in Sleep state and disabled for ONUs"]},{"entry":[{},"that are in Active state."]},{"entry":["Set ONU state","Used to set the next state of an ONU 220."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0045","num":"0044"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE II"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Parameter Data Structures used by OLT PM Module 260"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Data Structure","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["ONU List","List of ONUs for which the PM protocol is"]},{"entry":[{},"implemented"]},{"entry":["Number of ONUs","Size of the ONU List"]},{"entry":["PM cycle time","Time between consecutive sleep cycles when a"]},{"entry":[{},"periodic PM protocol is implemented"]},{"entry":["Initiator","Flag indicating whether OLT 240 or an ONU 220"]},{"entry":[{},"initiates a PM cycle"]},{"entry":["Downstream","Threshold for bytes in downstream buffer 261."]},{"entry":["occupancy threshold","Used to decide if an ONU 220 should transition"]},{"entry":[{},"to Active state."]},{"entry":["Downstream buffer","Flag indicating if downstream buffer occupancy"]},{"entry":["occupancy enable","should be used by the PM protocol logic"]},{"entry":["Upstream","Threshold for bytes in an ONU 220 upstream"]},{"entry":["occupancy threshold","buffer 281. Used to decide if ONU 220 should"]},{"entry":[{},"transition to Active state. The occupancy of"]},{"entry":[{},"ONU 220 upstream buffer is known to PM"]},{"entry":[{},"module 260 via the ONU reporting mechanism"]},{"entry":[{},"and report frames."]},{"entry":["Upstream buffer","Flag indicating if upstream buffer occupancy"]},{"entry":["occupancy enable","should be used by the PM protocol logic"]},{"entry":["Rate threshold","Threshold rate (in bits\/s) used to decide if an"]},{"entry":[{},"ONU 220 should transition to Active state."]},{"entry":[{},"Upstream and downstream rate thresholds may"]},{"entry":[{},"have the same or different values."]},{"entry":["Rate threshold enable","Flag indicating if rate threshold should be used"]},{"entry":[{},"by the PM protocol logic"]},{"entry":["Gaps between frames","Threshold gap between consecutive frames"]},{"entry":["threshold","going downstream or coming upstream from an"]},{"entry":[{},"ONU 220, measured in units of PON time"]},{"entry":[{},"quanta. Used to decide if an ONU 220 should"]},{"entry":[{},"transition to Active state."]},{"entry":["Gaps between frames","Flag indicating if gaps between frames should be"]},{"entry":["enable","used by the PM protocol logic"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0046","num":"0045"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE III"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Statistical Data Structures used by OLT PM Module 260"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Data Structure","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Downstream buffer","Number of bytes in downstream buffer 261 for"]},{"entry":["occupancy","a given ONU 220"]},{"entry":["Reported bytes","Number of bytes in an ONU 220 upstream"]},{"entry":[{},"buffer 281, as reported by ONU 220"]},{"entry":["Upstream rate","Arrival rate of upstream data for a given ONU"]},{"entry":[{},"220"]},{"entry":["Downstream rate","Arrival rate of downstream data for a given ONU"]},{"entry":[{},"220"]},{"entry":["Gaps between","Gaps between arrivals of upstream data frames"]},{"entry":["upstream frames","for a given ONU 220, measured in units of PON"]},{"entry":[{},"time quanta"]},{"entry":["Gaps between","Gaps between arrivals of downstream data"]},{"entry":["downstream frames","frames for a given ONU 220, measured in units"]},{"entry":[{},"of PON time quanta"]},{"entry":["ONU active","Flag indicating decision of activity detectors 262"]},{"entry":[{},"and 263 for a given ONU 220"]},{"entry":["ONU state","Current state of a given ONU 220"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"As seen in , power management framework  further includes a protocol frames composer . Protocol frames composer  generates a PON management frame, having a PM protocol message as its payload. Reference is made to , which is a simplified diagram of a protocol message structure, in accordance with an embodiment of the present invention. Shown in  is a PON management frame  that carries a PM protocol message. PON management frame  has a management frame header , and a management Frame Check Sequence (FCS) . As seen in , the protocol management payload includes an OPCODE A and a data block B. The OPCODE indicates one of the following frames: SLEEP_INITIATE, SLEEP, WAKE_REQ, SLEEP_READY and WAKE_ACK. Use of these frames is described hereinbelow with reference to . The data block of the payload stores the next wake-up time for an ONU that is in Sleep state.","Use of protocol frames composer  ensures that the PM protocol is independent of management frame type. As such, the frame type may be an ethernet Operations Administration and Maintenance (OAM) frame, a Mufti-Channel Pulse Code Modulation (MPCM) frame, an ONU Management and Control Interface (OMCI) frame, a Physical Layer Operations Administration and Maintenance (PLOAM) frame or such other type of frame.","As seen in , power management framework  further includes a protocol frames parser . Protocol frames parser  extracts a PM protocol message from management frame , and passes it to the PM protocol.","As seen in , power management framework  further includes an event timer . Event timer  serves as the clock for the protocol state machines. OLT PM module  calls the process function of the protocol once per time period measured by this clock. The time period is set to be approximately an order of magnitude shorter than the quickest event period. Generally, the time period is on the order of 100 microseconds.","As seen in , power management framework  further includes a statistics and activity detection manager . Statistics and activity detection manager  is used to configure PON statistics and detection hardware in accordance with user and system defined parameters. Such parameters include:","enable upstream rate measurement;","enable downstream rate measurement;","enable upstream frames gaps measurements;","enable downstream frames gap measurements; and","set rate thresholds.","As seen in , power management framework  further includes a downstream buffer manager . Downstream buffer manager  is used to enable and disable downstream buffer\/queue  for a given ONU .","Reference is made to , which is a simplified block diagram of ONU PM module  for an ONU , in accordance with an embodiment of the present invention. As seen in , ONU PM module  includes an upstream data buffer , a downstream activity detector , an upstream activity detector , a management frames receiver channel , and a management frames transmitter channel . Upstream data buffer  stores incoming data from ingress ports while ONU  is in Sleep state. The other ONU-side components are similar to respective OLT-side components , ,  and  of OLT PM module , which are described hereinabove.","Reference is made to , which is a simplified block diagram of an ONU-side power management framework  for an ONU , in accordance with an embodiment of the present invention. As seen in , power management framework  includes an ONU API , which provides methods and data structures for use by ONU PM module .","TABLE IV describes methods and TABLES V and VI describe respective parameter and statistical data structures provided by ONU API .",{"@attributes":{"id":"p-0056","num":"0055"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE IV"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Methods used by ONU PM Module 280"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Protocol initialization","Used to initialize internal states and variables of"]},{"entry":[{},"the PM protocol"]},{"entry":["Message handling","Used to process protocol messages transmitted"]},{"entry":[{},"from OLT PM modules 260 to ONU PM module"]},{"entry":[{},"280"]},{"entry":["State machine process","Used to decide whether to transition ONU 220"]},{"entry":[{},"from one state to another state"]},{"entry":["Get parameters","Read the protocol parameters"]},{"entry":["Get statistics","Read the statistics and decisions of activity"]},{"entry":[{},"detectors 282 and 283"]},{"entry":["Send message","Send a protocol message from ONU PM module"]},{"entry":[{},"280 to an OLT PM module 260"]},{"entry":["Set ONU state","Used to set the next state of ONU 220."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0057","num":"0056"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE V"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Parameter Data Structures used by ONU PM Module 280"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Data Structure","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Initiator","Flag indicating whether OLT 240 or ONU 220"]},{"entry":[{},"initiates a PM cycle"]},{"entry":["Upstream","Threshold for bytes in an ONU 220 upstream"]},{"entry":["occupancy threshold","buffer 281. Used to decide if ONU 220 should"]},{"entry":[{},"transition to Active state."]},{"entry":["Upstream buffer","Flag indicating if upstream buffer occupancy"]},{"entry":["occupancy enable","should be used by the PM protocol logic"]},{"entry":["Rate threshold","Threshold rate (in bits\/s) used to decide if an"]},{"entry":[{},"ONU 220 should transition to Active state."]},{"entry":[{},"Upstream and downstream rate thresholds may"]},{"entry":[{},"have the same or different values."]},{"entry":["Rate threshold enable","Flag indicating if rate threshold should be used"]},{"entry":[{},"by the PM protocol logic"]},{"entry":["Gaps between frames","Threshold gap between consecutive frames"]},{"entry":["threshold","going downstream or coming upstream from an"]},{"entry":[{},"ONU 220, measured in units of PON time"]},{"entry":[{},"quanta. Used to decide if an ONU 220 should"]},{"entry":[{},"transition to Active state."]},{"entry":["Gaps between frames","Flag indicating if gaps between frames should be"]},{"entry":["enable","used by the PM protocol logic"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0058","num":"0057"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE VI"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"API Statistical Data Structures used by ONU PM Module 280"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Data Structure","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Upstream rate","Arrival rate of upstream data for ONU 220"]},{"entry":["Bytes in upstream","Occupancy (in bytes) of ONU upstream buffer"]},{"entry":[{},"buffer"]},{"entry":["Downstream rate","Arrival rate of downstream data for ONU 220"]},{"entry":["Gaps between","Gaps between arrivals of upstream data frames"]},{"entry":["upstream frames","for ONU 220, measured in units of PON time"]},{"entry":[{},"quanta"]},{"entry":["Gaps between","Gaps between arrivals of downstream data"]},{"entry":["downstream frames","frames for ONU 220, measured in units of PON"]},{"entry":[{},"time quanta"]},{"entry":["ONU state","Current state of ONU 220"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"As seen in , power management framework  further includes a statistics and activity detection manager , an event timer , a protocol frames parser , and a protocol frames composer . These ONU-side components are similar to respective OLT-side components , ,  and  of power management framework , which are described hereinabove.","Reference is made to , which is a simplified flow chart of a PM protocol, in accordance with an embodiment of the present invention. The PM protocol runs on the OLT-side and the ONU-side of PON . OLT PM module  and ONU PM modules  use the PM protocol via the respective OLT API  and ONU API . The PM protocol on the OLT-side includes protocol state machines for the respective ONUs , and protocol message handlers and senders for the respective ONUs. Each PM protocol on the ONU-side includes a protocol state machine and a protocol message handler and sender.","Each ONU may be in one of three states; namely, an Active state, which is its normal operational mode, a Sleeping state, which is a low power mode, and a \u201cWaking Up\u201d state, which is an intermediate state between sleep cycles. During the Waking Up state, ONU PM module  sends a report regarding its upstream buffer occupancy to OLT PM module . The PM protocol includes the following messages, used for communication between OLT  and an ONU .","SLEEP_INITIATE\u2014sent by OLT  to a specific ONU  to indicate that OLT  is initiating a sleep cycle for ONU ","SLEEP\u2014sent by OLT  to a specific ONU  to instruct ONU  to transition to Sleep state","WAKE_REQ\u2014sent by OLT  to a specific ONU  to transition to Active state","SLEEP_READY\u2014sent by an ONU  to OLT  to indicate that ONU  is ready to transition to Sleep state","WAKE_ACK\u2014sent by an ONU  to OLT  in indicate that ONU  has transitioned to Active state",{"@attributes":{"id":"p-0062","num":"0061"},"figref":["FIG. 8","FIG. 8"],"b":["240","220"]},"The top portion of  shows the PM protocol for an OLT-initiated sleep transition for an ONU  (operations -), and an ONU-initiated sleep transition for ONU  (operations  and ). At operation , OLT  checks the sleep conditions described hereinabove with reference to activity detectors  and . If the sleep conditions are satisfied, OLT  sends a SLEEP_INITIATE message to ONU . At operation , ONU  receives the SLEEP_INITIATE message and checks the sleep conditions. If the sleep conditions are satisfied, ONU  sends a SLEEP_READY message to OLT . If the sleep conditions are not satisfied, ONU  ignores the SLEEP_INTIIATE message. At operation , OLT  receives the SLEEP_READY message. OLT  checks the sleep conditions. If the sleep conditions are satisfied, OLT  sends a SLEEP message to ONU , with a next wakeup time. When ONU  receives the SLEEP message, it transitions to Sleep state until the next wakeup time. If the sleep conditions are not satisfied, OLT  ignores the SLEEP_READY message.","At operation , an ONU  checks the sleep conditions. If the sleep conditions are satisfied, ONU  sends a SLEEP_READY message to OLT . At operation , OLT  receives the SLEEP_READY message. OLT  checks the sleep conditions. If the sleep conditions are satisfied, OLT  sends a SLEEP message to ONU , with a next wakeup time. When ONU  receives the SLEEP message, it transitions to Sleep state until the next wakeup time. If the sleep conditions are not satisfied, OLT  ignores the SLEEP_READY message.","When ONU  is in Sleep state, it remains in this state until the next wakeup time, at which time ONU  transitions to Waking Up state.","The bottom portion of  shows the PM protocol when ONU  is in Waking Up state. At operation , ONU  checks the sleep conditions. If the sleep conditions are satisfied, ONU sends a SLEEP-READY message to OLT . At operation , OLT  receives the SLEEP_READY message. OLT  checks the sleep conditions. If the sleep conditions are satisfied, OLT  sends a SLEEP message to ONU , with a next wakeup time. When ONU  receives the SLEEP message, it transitions to Sleep state until the next wakeup time. If the sleep conditions are not satisfied, OLT  ignores the SLEEP_READY message.","At operation , ONU  checks the wakeup conditions described hereinabove with reference to activity detectors  and . If the wakeup conditions are satisfied, ONU  sends a WAKE_ACK message to OLT  and transitions to Active state. When OLT  receives the WAKE_ACK message, it knows that ONU  is in Active state.","At operation , OLT  checks the wakeup conditions. If the wakeup conditions are satisfied, OLT  sends a WAKE_REQ message to ONU . At operation , ONU  receives the WAKE_REQ message. ONU  checks the wakeup conditions. If the wakeup conditions are satisfied, ONU  transitions to Active state, and sends a WAKE_ACK message to OLT . When OLT  receives the WAKE_ACK message, it knows that ONU  is in Active state. If the wakeup conditions are not satisfied, ONU  ignores the WAKE_REQ message.","If a timeout period has elapsed and OLT  has still not received an expected SLEEP_READY or WAKE_ACK message from ONU , then at operation  OLT  checks the sleep conditions. If the sleep conditions are satisfied, OLT  sends a SLEEP message to ONU . Otherwise, OLT  checks the wakeup conditions. If the wakeup conditions are satisfied, OLT  sends a WAKE_REQ message to ONU . At operation , ONU  receives the WAKE_REQ message. ONU  checks the wakeup conditions. If the wakeup conditions are satisfied, ONU  transitions to Active state, and sends a WAKE_ACK message to OLT . When OLT  receives the WAKE_ACK message, it knows that ONU  is in Active state. If the wakeup conditions are not satisfied, ONU  ignores the WAKE_REQ message.","Reference is made to , which is a simplified power management state transition diagram for an ONU , in accordance with an embodiment of the present invention. Shown in  are the three ONU states; namely, Active state , Sleep state  and Waking Up state . While in Active state , ONU downstream and upstream activity detectors  and  track the respective upstream and downstream data traffic rates for ONU , and the respective upstream and downstream frame gaps for ONU , and use the rates and gaps to check whether or not the sleep conditions for ONU  are satisfied. OLT activity detectors  and  also track these respective rate and gaps, and use the rates and gaps to check whether or not the sleep conditions for ONU  are satisfied. When either activity detectors  and , or activity detectors  and , determine that the sleep conditions are satisfied, then ONU  transitions into Sleep state  by a respective OLT-initiated or ONU-initiated transition. The transition to Sleep state  includes designation of a next wakeup time.","While in Sleep state , ONU  is in a low power mode. Buffer  stores downstream data for ONU , and buffer  stores upstream data for ONU . When the wakeup time for Sleep state  arrives, or when ONU PM module  receives a wakeup request from OLT PM module , ONU  transitions to Waking Up state .","While in Waking Up state , ONU PM module  sends a report to OLT PM module  regarding the occupancy of ONU upstream data buffer . Activity detectors  and , and activity detectors  and  use this information to determine if the wakeup conditions are satisfied. If so, then ONU  transitions into Active state . Otherwise, ONU  transitions back into Sleep state .","As seen in , when ONU  is in Waking Up state, ONU PM module  sends a report regarding its upstream buffer occupancy to OLT PM module . Thus OLT PM module  is able to determine whether or not the upstream buffer occupancy exceeds its threshold, which is one of the wakeup conditions.","In an alternative embodiment of the present invention ONU  undergoes a \u201cfast wakeup\u201d, which is a direct transition from Sleep state  to Active state , if local wakeup conditions are satisfied. Upon waking up, ONU PM module  responds to report requests from OLT PM module . As such, OLT PM module  may send report requests to ONU PM module  while ONU  is in Sleep state , for ONU PM module  to report occupancy of upstream buffer . Such a fast wakeup mechanism enables ONU PM module  to respond to local events in the middle of a sleep cycle. Such a fast wakeup is indicated by a dashed arrow between states  and  in .","The present invention has broad application to power management for point-to-multipoint networks. Such applications include inter alia:","security camera networks, wherein cameras are similar to ONUs and the control center is similar to an OLT;","sensory arrays, wherein smart sensors are similar to ONUs and the control center is similar to an OLT; and","smart house management, wherein home appliances are similar to ONUs and the main control computer is similar to an OLT.","In the foregoing specification, the invention has been described with reference to specific exemplary embodiments thereof. It will, however, be evident that various modifications and changes may be made to the specific exemplary embodiments without departing from the broader spirit and scope of the invention as set forth in the appended claims. Accordingly, the specification and drawings are to be regarded in an illustrative rather than a restrictive sense."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention will be more fully understood and appreciated from the following detailed description, taken in conjunction with the drawings in which:",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 9"}]},"DETDESC":[{},{}]}
