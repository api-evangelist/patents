---
title: Operational state transition and event logging system for an RF transmitter
abstract: The operational state transitions and events of an RF transmitter having a plurality of operational states are monitored and recorded. A plurality of ports are provided that each receive an indication of an occurrence of an event that can cause a transition from one state to another of the plurality of states. A transition status memory stores transition status data representing the status of each associated state. A micro-controller is programmed so that it determines, for each state, from the indications whether a state transition has occurred and, if so, it causes an appropriate change in the associated transition state data stored in the memory.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07391821&OS=07391821&RS=07391821
owner: Harris Corporation
number: 07391821
owner_city: Melbourne
owner_country: US
publication_date: 20050308
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF A PREFERRED EMBODIMENT"],"p":["The present invention is directed to RF transmitters and, more particularly, to monitoring and recording operational state transitions and events thereof.","RF transmitters include AM, FM and TV transmitters. Such transmitters typically include a group of RF amplifiers and power supplies with a plurality of components. Such a transmitter has different operational modes. Some systems have a very sophisticated turn-on and turn-off process or sequence. The sequence may include a dozen or more steps or stages and the operation will be switched from one state to another during the process. The timing between the various states of operation may be very critical; otherwise it may cause damage to the system. A typical IOT (Inductive Output Tube) transmitter, for example, may include a plurality of states such as four main states and each main state may have several sub-states such as fourteen sub-states. These sub-states operate the on, off or standby processes as the system advances from one state to another in precise timing. The processes may be interrupted by an external event such as a command or one of many possible faults.","It is desirable that all state transition and mode switching be recorded along with the time of happening for system operation diagnosing and monitoring. All commands or faulty events that happen during the operation to cause system state change should be recorded with the time of occurrence. The recording (or logging) could record operator activities on the system operation, such as issuing a command to turn on or off the system or the subsystem or to raise or lower the power or to switch exciters.","The present invention provides for monitoring and recording operational state transitions and events of an RF transmitter having a plurality of operational states. The apparatus includes a plurality of ports that each receive an indication of an occurrence of an event that can cause a transition from one state to another. A transition status memory stores transmission status data representing the status of each associated state. A microcontroller is programmed to respond and it determines, for each state, as to whether a state transition has occurred and, if so, it causes an appropriate change in the associated transition state data stored in the memory.","In accordance with another aspect of the present invention, the events that may cause a transition may be external events or internal events. Such external events may be due to commands from front panel button pressing or from a remote serial communications bus or from another controller. Also, the events may be the result of critical faults that could change the system operational state.","Still further in accordance with another aspect of the invention, the indications of an occurrence of an event may represent internal or external events.","Still further in accordance with another aspect of the invention, the stored status data includes data representing the current and previous status of each associated state.","Still further in accordance with the present invention, the plurality of states may include main states as well as sub-states wherein each main state has a plurality of sub-states, for example.","Reference is now made to the drawings and the showings are for purposes of illustrating a preferred embodiment of the invention only and not for purposes of limiting same.","As illustrated in , there is provided a plurality of ports including digital input ports  for receiving fault inputs, digital ports  for receiving other external event inputs and analog input ports  for receiving other external event inputs. The inputs for the digital input ports  may be received from monitored events by way of interlocks or by way of comparators or they may take the form of discreet faults. Also, the event inputs to the digital input ports  may be received from remote commands or system commands or from interconnections with subsystems. The inputs to the analog input ports  may be received as, for example, voltages V-Vwhich may be representative of power, voltage, current, temperature and the like. These signals are indications from various comparators, interlocks, command, etc. and may provide indications of the occurrence of an event that can cause a transition from one state to another within a plurality of states of operation of the transmitter. The digital input ports  and  and the analog input ports  all provide corresponding digital data to the system controller SC which may include a suitably programmed micro-computer. The system controller is connected by a suitable control network with other subsystem controllers such as subsystem controllers SC-, SC- through SC-N. This is all connected by means of a control network CN.","The system controller SC is provided with a memory  that may take a form of a flash memory or an EEPROM which may serve as the operation-event-state log. A real time clock RTC is provided and is used for recording the time of occurrence of the various events being recorded.","A log is a record of the faults and may be displayed as with an LCD display . Access may be with a PC . Suitable output ports  provide various outputs including those for analog control or a debug output or a status\/meter output and the like. Additional memory may be stored by a suitable RAM memory . The data in the log may be displayed and may also be provided to an output printer, if desired. The data stored may appear in a printout or a video display in a manner so as to present data such as that illustrated in Table I presented below:",{"@attributes":{"id":"p-0017","num":"0016"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"center"}},"thead":{"row":{"entry":"TABLE I"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"OPERATION\/EVENT\/STATE LOG"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"84pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["INDEX","EVENT","MAIN STATE","SUB-STATE","TIME"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"char","char":"."}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","AC_RESTART","STANDBY","AC\/Intlk VRF","17:44:07","Mar. 15, 2005"]},{"entry":["2","NO","STANDBY","Cooling on CMD","17:44:07","Mar. 15, 2005"]},{"entry":["3","NO","STANDBY","Cooling Verify","17:44:18","Mar. 15, 2005"]},{"entry":["4","NO","STANDBY","HVPS on CMD","17:44:18","Mar. 15, 2005"]},{"entry":["5","NO","STANDBY","HVPS on Verify","17:44:32","Mar. 15, 2005"]},{"entry":["6","NO","STANDBY","Fila. Rdy","17:44:47","Mar. 15, 2005"]},{"entry":[{},{},{},"Verify"]},{"entry":["7","NO","STANDBY","Filament Ready","17:46:24","Mar. 15, 2005"]},{"entry":["8","VT100_CMD","BEAM ON","System Verify","17:47:57","Mar. 15, 2005"]},{"entry":["9","FPS_I_FAULT","BEAM OFF","HPA Off","17:47:57","Mar. 15, 2005"]},{"entry":["10","FP_CMD","BEAM ON","AC\/Intlk VRF","17:47:57","Mar. 15, 2005"]},{"entry":["11","NO","BEAM ON","Cooling on CMD","17:48:08","Mar. 15, 2005"]},{"entry":["12","NO","BEAM ON","Cooling Verify","17:48:08","Mar. 15, 2005"]},{"entry":["13","NO","BEAM ON","HVPS on CMD","17:48:08","Mar. 15, 2005"]},{"entry":["14","VT100_CMD","BEAM ON","HVPS on CMD","17:48:08","Mar. 15, 2005"]},{"entry":["15","NO","BEAM ON","HVPS on Verify","17:48:08","Mar. 15, 2005"]},{"entry":["16","NO","BEAM ON","Fila. Rdy","17:48:23","Mar. 15, 2005"]},{"entry":[{},{},{},"Verify"]},{"entry":["17","NO","BEAM ON","System Verify","17:49:17","Mar. 15, 2005"]},{"entry":["18","NO","BEAM ON","Stepstart on","17:49:17","Mar. 15, 2005"]},{"entry":[{},{},{},"CMD"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}}},"The information presented in Table I is for illustration purposes only and may be helpful in understanding the description of the invention as presented hereinbelow.","The operation of the system is designed and organized as a state-machine, also called Finite State Machine (FSM). The main operation modes, such as turning-on, turning-off and any mode switching transition, are defined as individual main states. Each step or stage between the transitions of the main states or the operational modes is defined as sub-state, refer to Appendix A. Thus at any given time for any given operational condition, the system is operated in one of the predetermined main states and one of the sub-states. Any transition between any two main states or any sub-states of a main state will be recorded with the time in the log, refer to Appendix A and B. The state, the event, fault and commands are predefined as follows:","1. State Definition",{"@attributes":{"id":"p-0020","num":"0000"},"ul":{"@attributes":{"id":"ul0001","list-style":"none"},"li":{"@attributes":{"id":"ul0001-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0002","list-style":"none"},"li":["1. The system main operation modes are defined as main state.","2. The steps for each operational process, such as steps during turning-on process, are defined as sub-states."]}}}},"Both main state and sub-state are defined by a unique numerical identifier, which is used as an index number ranged from 0 to a pre-defined value. And there is a one to one correspondent relationship between the state and the index number.","2. Event Definition","All events, such as commands from front panel button pressing, or commands from a remote serial communication bus or a command from another controller are defined as a unique numerical identifier, which are used as an index number, refer to the Appendix C.","3. Fault Definition","All critical faults, which could change the system operational state, are organized as a group of unique events as well. And every fault has a unique identifier numerically represented by an index number, refer to the Appendix D.","4. Log Definition","Since at any given time at any given condition, the system's operational state will be uniquely defined and predetermined by system designer using these numerical identifiers to present the main states, sub-states, events and faults to organize a logging system, the system operator or user can determine the system's operation condition and system performance for any given time. The logging system uses this information to organize the format for each logging entry; each entry is a record in the log and it has the correspondent fields of the main state, sub-state, event and time of the transition. Each record is indexed by the sequential order as it happens with the elapse time.","5. Logging Method","The logging system includes three main modules and they are:\n\n","The log is embedded into the system or any sub-system, which requires such a log system for system maintenance or diagnostics. The log could be stored either in RAM (Random Access Memory) or EPROM (Erasable Programmable Read-Only Memory), such as flash memory. The log could be viewed or monitored via some kind of serial links, such as RS232, RS484, Ethernet or CAN. In the design the log is viewed by connecting the controller serial port to a serial port of a PC by using Hyper-Terminal. The log could be uploaded to any PC via a serial link for remote monitoring.","The method has the following advantages.\n\n","Reference is made to Table I. Note as follows:\n\n","The above discussion relative to the log illustrated in Table I is just an example of the type of data that is stored in the log and which can be displayed or presented as a printout, for example. It should be noted that the log illustrates transition status data representing both the current as well as the previous status of each state. The manner in which a computer functions and the various states and events including external events and critical faults is presented in the appendices that are presented below in Appendix A, Appendix B, Appendix C and in Appendix D.","Appendix A: State Machine Design",{"@attributes":{"id":"p-0030","num":"0000"},"ul":{"@attributes":{"id":"ul0009","list-style":"none"},"li":["1. State Function\n\n()=((), (), ());\n","2. State Machine Response Action Function (Output Function)\n\n()=((), () ());\n","3. State Machine Function\n\n[[(), (), ()];\n\nNotes:\n","S: Function of the state machine","R: Function of the response to the states, events and fault variation.","G: State Transition Matrix, which describes the relationship among the states, event and output.","X: Main state","X: The next main state (or the main state at time period K)","X: The current main state (or the main state at time period K-)","X: The previous main state (or the main state at time period K-)","Y: Sub-state","Y: The next sub-state (or the sub-state at time period K)","Y: The current sub-state (or the sub-state at time period K-)","Y: The previous sub-state (or the sub-state at time period K-)","E: External Event including commands from front panel, remote port and serial port","E: Event indexed 1 at time period K-","E: Event indexed M at time period K-","F: Faults in the system","F: Fault indexed 1 at time period K-","F: Fault indexed N at time period K-\n\nAppendix B: Designed Transmitter System States\n","1. System States (main states)\n    \n    ","2. The all Sub-State of Off Process (transition from other state to HPA_OFF state)\n    \n    ","3. The all Sub-State of HPA Beam ON Process (transition from other states to HPA_BEAM_ON state)\n    \n    ","4. The all Sub-State of HPA Standby ON Process (transition from other state to HPA_STANDBY_ON state)\n    \n    ","5. The all Sub-State of HPA BG Heat ON Process (transition from other state to HPA_BG_HEAT_ON state)\n    \n    ","1. NO_CHANGE","2. AC_RESTART","3. THREE_STRIKE (Fault Three Recovery)","4. SYS_CAN_CMD (System Control Area Network Command)","5. SYS_BUS_CMD (System Bus Command)","6. FNT_PNL_CMD (Front Panel push button Command)","7. VT100_CMD (HyperTerminal VT100 Command)","8. STDBY_TIME_LMT (Standby Time Limit)","9. FP_RS485_CMD (Front Panel RS485 Bus Command)","10. THREE_STRIKE_OUT (Fault Three Strike End)","11. SYS_BUS_MUTE (System Bus Mute Command)","12. SYS_BUS_UNMUTE (System Bus Un-Mute Command)","13. RFU_RF_MUTE (RF Unit RF Mute Command)","14. RFU_RF_UNMUTE (RF Unit RF Un-Mute Command)","15. REMOTE_CMD (Remote control Command)\n\nAppendix D: Critical Faults (Which Will Cause System State Changing)\n","1. RFLD_PWR_OL (Reflected Power Overload)","2. FWD_PWR_OL (Forward Power Overload)","3. DRV_PWR_OL (Driver Power Overload)","4. PRI_CAV_ARC (Primary Cavity Arc fault)","5. SEC_CAV_ARC (Primary Cavity Arc fault)","6. BS_AC_FAULT (Beam Supply AC Fault)","7. CAB_AC_FAULT (Cabinet AC Fault)","8. AC480_FAULT (AC480 V Fault)","9. AC110_FAULT (AC110 V Fault)","10. S_START_FAULT (Step-Start Fault)","11. CROWBAR_FAULT_OFF (Crowbar Off Fault)","12. COOL_FAULT_OFF (Cooling Off Fault)","13. HVPS_FAULT_OFF (High Voltage Power Supply Off Fault)","14. ARC_DET_FAULT (Arc Detector Fault)","15. SYS_FAULT_OFF (System Bus Fault Off)","16. COL_N_OV_FAULT (Collector N[1 to 5] Over Voltage Fault)","17. COL_N_UV_FAULT (Collector N[1 to 5] Under Voltage Fault)","18. COL_N_I_FAULT (Collector N[1 to 5] Current Fault)","19. FPS_V_FAULT (Focus Power Supply Voltage Fault)","20. FPS_I_FAULT (Focus Power Supply Current Fault)","21. RTN_I_FAULT (Step-Start Fault)","22. GND_I_FAULT (Grounding Current Fault)","23. CTHD_I_FAULT (Cathode Current Fault)","24. DRV_PWR_LOSS (Drive Power Fault)","25. RF_MUTE_FAIL (RF Mute Fail Fault)","26. SS_CABLE_INTLK (Step-Start Cable Interlock Fault)","27. GNDG_SW_INTLK (Grounding Switch Interlock Fault)","28. OIL_LEVEL_INTLK (Tank Oil Level Interlock Fault)","29. GNDG_STICK_INTLK Grounding Stick Interlock (Fault)","30. BS_DOOR_INTLK (Beam Supply Interlock Fault)","31. HPA_INTLK (High Power Amplifier Interlock Fault)","32. HANDLE_INTLK (Handle Interlock Fault)","33. TUBE_INTLK (Tube Interlock Fault)","34. CAV1_CABLE_INTLK (Cavity 1 Interlock Fault)","35. CAV2_CABLE_INTLK (Cavity 2 Interlock Fault)","36. PS_CAB_DR_INTLK (Power Supply Cabinet Door Interlock Fault)","37. FRNT_PANEL_INTLK (Front Panel Interlock Fault)","38. SYS_BUS_INTLK (System Bus Interlock Fault)","39. BS_PHS_IMB (Beam Supply Phase Imbalance Fault)","40. BS_PHS_SEQ (Beam Supply Phase Sequence Fault)","41. CAB_PHS_IMB (Cabinet Phase Imbalance Fault)","42. CAB_PHS_SEQ (Cabinet Phase Sequence Fault)","43. VCR_PS1_AC (Vicor Supply 1 AC Fault)","44. VCR_PS1_DC Vicor Supply 1 DC Fault)","45. VCR_PS2_AC (Vicor Supply 2 AC Fault)","46. VCR_PS2_DC Vicor Supply 2 DC Fault)","47. QUIESC_CURR (Quiescent Current Fault)"]}},"Attention is now specifically directed to  which illustrates a flow diagram for a state transition monitor procedure  and which is programmed in the system controller. This procedure commences with step   and advances to step  to determine whether or not a system state change has taken place. If not, it returns to have this determination made again. If a state change has taken place, the procedure advances to step  during which a determination is made as to whether any event is happening. If so, the procedure advances to step  during which the procedure solves the state function equation described in section 3 of Appendix A and based on the results thereof, it takes immediate response or action for the event (generates a state-machine output). Thereafter a change is made in the system state. If an event is not happening at step , the procedure advances to step  during which a determination is made as to whether a fault is happening. If this type of event is happening, the procedure advances to step  which is similar to that of step  described above.","If no fault is happening during the determination at step , the procedure advances to step . This step is similar to step  or  described above. After step  or step  or step  has taken place, the procedure will advance to step . This a recording process and during this step a recording takes place of the system state transition and the time that the transition happened. Also, the system records the event and the time along with the system state, if an event happened. Also, any fault is recorded along with the fault time. Thereafter, the procedure returns to the determination step .","Although the invention has been described with respect to a preferred embodiment, it is to be appreciated that various modifications may be made without departing from the spirit and scope of the invention as defined by the appended claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing and other features of the present invention will become apparent to one skilled in the art to which the present invention relates upon consideration of the following description of the invention with reference to the accompanying drawings, wherein:",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"}]},"DETDESC":[{},{}]}
