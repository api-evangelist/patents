---
title: Apparatus and method for transmitting command
abstract: There are provided an apparatus and method for transmitting commands in a network to which a plurality of communication protocols may be applied. A first command that supports a plurality of communication protocols is input. One of the plurality of communication protocols is selected in accordance with the input first command. The first command is converted into a corresponding second command in the selected communication protocol. The converted second command is transmitted using the selected communication protocol.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07809845&OS=07809845&RS=07809845
owner: Canon Kabushiki Kaisha
number: 07809845
owner_city: Tokyo
owner_country: JP
publication_date: 20040910
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS","CLAIM OF PRIORITY"],"p":["The present invention relates to an apparatus and method for transmitting commands and, more particularly, to an apparatus and method for transmitting commands in a network to which a plurality of communication protocols may be applied.","Along with the advance of the digital computer technology, even in office devices and general home appliances which have simple functions and cannot be organically connected to each other, functions such as connection of these devices, cooperation of processes, and the like can be implemented via a network. In order to connect a plurality of devices to each other via a network and to attain data transfer and operation control, a device control protocol is required. Device control protocols with various specifications have been proposed.","Office devices and home electronic appliances can be controlled via a network. As a result, device control applications which appropriately remotely control these devices to add new values continue to come on the market.","When a plurality of device control protocols of different types are used together, a device control application must individually support these device control protocols. As a technique that weakens coupling between such device control application processes and device control protocol processes, a prior art disclosed in, e.g., Japanese Patent Laid-Open No. 2001-306416 is known. In this prior art, even when there are differences depending on different vendors and versions (e.g., different communication protocols, different axial configurations of robots, and the like), common application software can be developed by simple replacement of processing commands.","However, in the aforementioned device control protocols, various specifications and proposals are available. That is, in device control protocols, specifications and bylaws are specified in correspondence with the types of devices to be controlled and the contents of expected cooperation processes. For this reason, with increasing number of classes of devices having cooperation functions via a network, the number of types of device control protocols increases. On the other hand, as shown in , since a device control application  and device  to be controlled are directly connected via a device control protocol , if the number of classes of devices to be controlled increases, the device control application must individually support a plurality of device control protocols.","It is an object of the present invention to make it unnecessary for a device control application to individually support a plurality of device control protocols.","It is another object of the present invention to implement an appropriate device cooperation process.","According to the present invention, an apparatus and method for transmitting commands in a network to which a plurality of communication protocols may be applied are provided. A first command that supports a plurality of communication protocols is input. One of the plurality of communication protocols is selected in accordance with the input first command. The first command is converted into a second command in the selected communication protocol. The converted second command is transmitted using the selected communication protocol.","Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings, in which like reference characters designate the same or similar parts throughout the figures thereof.","Preferred embodiments of the present invention will be described hereinafter with reference to the accompanying drawings. In the following description, a practical arrangement example will be explained. However, the present invention is not limited to such practical arrangement example.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["101","105","102","102"]},"In this embodiment, the device control application  and device control protocols A to C have an indirect connection relationship via a virtual protocol . That is, a device control request output from the device control application  is supplied to the virtual protocol processor  via the virtual protocol  that generalizes functions required for device control, and is then supplied from the processor  to the devices A to C to be controlled via the plurality of device control protocols A to C.",{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2"},"Note that the device control apparatus is an information processing apparatus which comprises a CPU, ROM, RAM, and the like, and components  to  of the device control apparatus to be described below correspond to functions which are implemented when the CPU executes a control program stored in the ROM.","In , reference numeral  denotes a device control application (corresponding to the device control application  in ), which implements a process that cannot be achieved by a single device by controlling a plurality of device network-compatible devices. A plurality of device control applications  may be present in the device control apparatus.","Modules  to  form the virtual protocol processor  shown in .","Reference numeral  denotes a virtual protocol providing module which provides a virtual protocol (corresponding to the virtual protocol  in ) to the device control application . In other words, the module  provides an application programming interface via the virtual protocol.","Reference numeral  denotes a virtual protocol execution module which receives and interprets a device control request sent from the device control application  using the virtual protocol (corresponding to the virtual protocol  in ) provided by the virtual protocol providing module , and determines control contents.","Reference numeral  denotes a virtual protocol conversion module, which converts the processing contents of the virtual protocol into those of a device control protocol used in device control. A plurality of virtual protocol conversion modules  are present in correspondence with the number of devices to be controlled, and can be arbitrarily added or deleted at the time of startup and during operation of the device control apparatus.","Reference numeral  denotes a virtual protocol transfer module which transfers the control contents determined by the virtual protocol execution module  to the virtual protocol conversion module . If there are a plurality of virtual protocol conversion modules , the virtual protocol transfer module  transfers the control contents determined by the virtual protocol execution module  to a corresponding one of the virtual protocol conversion modules .","As a communication protocol used in a communication route between each virtual protocol conversion module  and device to be controlled (corresponding to devices A to C to be controlled in ), Internet protocol (IP) is used. As the IP version, both IPv4 and IPv6 can be used. A medium actually used as the communication route is a wired or wireless medium. Note that communication protocols such as TCP, UDP, HTTP, SMTP, SNMP, FTP, and the like may also be used in accordance with target device control protocols of the virtual protocol conversion modules . In order to assure communication security, IPsec, SSL, and the like may be used in correspondence with device control protocols.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 3","FIG. 2"],"b":"203"},"Reference numeral  denotes a status information holding unit which holds status information that indicates the status of a device to be controlled.","Reference numeral  denotes a profile information holding unit which holds profile information indicating the specifications of a device to be controlled.","Reference numeral  denotes a set information holding unit which holds information of a set of devices that can be manipulated in a device network.","Reference numeral  denotes an interpretation unit which interprets processing contents (a device control request sent from the device control application ) expressed by the virtual protocol.","Reference numeral  denotes a determination unit which determines actual control contents on the basis of the interpretation result of the interpretation unit .",{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 4"},"The virtual protocol aims at providing means that generalizes functions required for device control, and is specified by extracting and reconstructing functions which may be required in device control from those of various protocols.","The virtual protocol includes a set of commands that command device control. Each command includes a plurality of pieces of information: a command name, input parameter list, output parameter list, and processing attribute. The command name is an identification name of a command as the most basic element that forms the virtual protocol. The input parameter list is a list of information required on the device control application side upon executing a command. The output parameter list is a list of information of processing results obtained after execution of a command. The processing attribute guide information upon developing a command to a plurality of actual device control protocols. A command is developed by the determination unit  shown in  on the basis of the processing attribute.","For example, UPnP, JXTA, and the like have common functions such as search and the like, but these functions are processed using different names and parameters.  laps (abstracts) to process such functions by identical names and parameters. However, since a peer-to-peer protocol such as JXTA includes functions such as message routing and the like, which are not related to device control, these functions are omitted. Since the virtual protocol itself is \u201cvirtual definition of device-to-device exchange\u201d, specifications of \u201cname\u201d (command name) of each function, \u201cinput\u201d for that function, and \u201coutput\u201d of the result are defined in .",{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 4"},"In , a \u201cplayer list acquisition\u201d command is one of device information acquisition commands, and is used to acquire set information of available devices which are present on the device network. The acquired device set information is held by the set information holding unit  shown in . An execution result of this command is acquired as a list of identification codes ID indicating available devices present on the device network (this list includes the acquired identification codes ID and device control protocols used to acquire these identification codes ID). As the processing attribute of this command, \u201cparallel\u201d is appended. With this attribute, when there are a plurality of virtual protocol conversion modules  corresponding to a plurality of different types of actual device control protocols, a player list acquisition instruction is parallelly and simultaneously issued to all the virtual protocol conversion modules .","In , a \u201cstatus acquisition\u201d command is also one of device information acquisition commands, and is used to acquire status information which indicates the status of a device corresponding to an ID designated in the input parameter list. The status information is held by the status information holding unit  shown in . The device ID is designated by the input parameter list, and status information of the device with the designated ID is input to the output parameter list. As the processing attribute of this command, \u201cindependent\u201d is appended. With this attribute, even when there are a plurality of virtual protocol conversion modules  corresponding to a plurality of different types of actual device control protocols, a status acquisition instruction is issued to only the virtual protocol conversion module  corresponding to the device with the designated ID.","In , a \u201cprofile acquisition\u201d command is also one of device information acquisition commands, and is used to acquire profile information which indicates the specification of a device corresponding to an ID designated in the input parameter list. The profile information is held by the profile information holding unit  shown in . The device ID is designated by the input parameter list, and profile information of the device with the designated ID is input to the output parameter list. As the processing attribute of this command, \u201cindependent\u201d is appended. With this attribute, even when there are a plurality of virtual protocol conversion modules  corresponding to a plurality of different types of actual device control protocols, a profile acquisition instruction is issued to only the virtual protocol conversion module  corresponding to the device with the designated ID.","In , a \u201csearch\u201d command is used to search for a device with the designated performance\/specification (described in profile) or status (described in status). Status information, profile information, and a flag indicating information to be used in a search are input to the input parameter list. Only one device ID obtained as a result of the search is input to the output parameter list. As the processing attribute of this command, \u201cserial\u201d is appended. With this attribute, when there are a plurality of virtual protocol conversion modules  corresponding to a plurality of different types of actual device control protocols, a search instruction is issued in turn to each of the plurality of virtual protocol conversion modules  until a device with the designated performance\/specification or status is found.",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 5"},"The status information is used to indicate the status of a device, and includes a ready flag and busy flag.","The ready flag indicates whether or not a corresponding device is ready to use. For example, if a device is ON, the ready flag is \u201cOK\u201d; otherwise, it is \u201cNO\u201d.","The busy flag indicates whether or not the process of a corresponding device is now in progress. For example, if a device is a printer and its print process is in progress, the busy flag is \u201cNG\u201d; otherwise, it is \u201cOK\u201d.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 6"},"The profile information is used to publish the specification indicating performance and the like of a device, and includes, e.g., ID, model name, model number, vendor, address, and owner data.","The ID data is a character string used to uniquely identify a physical entity of a device. For example, the ID data is \u201curn:abc-magnet:12345678\u201d.","The model name data is a character string indicating the type of device. For example, the model name data is \u201cprinter\u201d.","The model number data is a character string indicating the model number of a device. For example, the model number data is \u201cABC Printer X123\u201d.","The vendor data is a character string indicating the vendor of a device. For example, the vendor data is \u201cABC corporation\u201d.","The address data indicates an address of the device n the device network. For example, when TCP\/IP is used, the address data is \u201c150.61.1.2\u201d.","The owner data indicates the owner of a device. For example, if an e-mail address is used, the owner data is \u201cUser-name@abc.co.jp\u201d.",{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 7"},"In step S, a processing request (device control request) sent from the device control application  is accepted using the virtual protocol provided by the virtual protocol providing module .","In step S, the virtual protocol execution module  interprets the processing request (processing contents expressed by the virtual protocol) sent from device control application  via the virtual protocol. Especially, this process is executed by the interpretation unit  in the virtual protocol execution module . For example, when a \u201cstatus acquisition\u201d command is issued as the virtual protocol from the device control application , the unit  determines with reference to the virtual protocol table shown in  that the device ID is required as an input parameter of the command, and status information is required as an output parameter.","In step S, the virtual protocol execution module  determines actual control contents on the basis of the interpretation result of the interpretation unit . Especially, this process is executed by the determination unit  in the virtual protocol execution module . That is, in the above example, on the basis of the interpretation result, i.e., \u201cinput=device ID\u201d and \u201coutput=status information\u201d in the status acquisition command interpreted by the interpretation unit , the unit  searches the set information holding unit  using the device ID to determine a device control protocol actually used by the device with that ID, and determines that the corresponding virtual protocol conversion module  is selected to issue a status acquisition processing request according to the determined device control protocol.","In step S, the control contents determined by the determination unit  are converted into the processing contents of the device control protocol used in actual device control. This process is executed by a corresponding one of the plurality of virtual protocol conversion modules , which receives the control contents via the virtual protocol transfer module .","It is checked in step S on the basis of the control contents determined in step S if an end condition is met. If the end condition is not met, the flow advances to step S to execute the same process for another device control protocol. On the other hand, if the end condition is met, this device control process ends.","Note that the end condition reflects the contents (parallel, independent, serial) of the processing attribute shown in , and is checked by the determination unit . In case of this \u201cstatus acquisition\u201d command, since the processing attribute is \u201cindependent\u201d, the process ends.","For example, if there are two device control protocols, i.e., UPnP and JXTA, and if a \u201cplayer list acquisition\u201d command, which instructs to \u201clist up currently ready devices\u201d, as one of device information acquisition commands, is issued, both the UPnP and JXTA protocols are selected. The corresponding protocol conversion modules  convert the device information acquisition command into a UPnP device discovery command and JXTA peer discovery command. At this time, since an action to \u201cdiscover a device\u201d has no order of superiority between the protocols, both the UPnP and JXTA protocols \u201csimultaneously (parallelly)\u201d issues device discovery commands (UPnP device discovery command and JXTA peer discovery command).","By contrast, when a \u201csearch\u201d command, which instructs to \u201csearch for a device\u201d, as one of the device information acquisition commands, is issued, both the UPnP and JXTA protocols are selected. However, if the corresponding device is found, the process can be aborted at that time. Hence, the process is \u201csequentially (serially)\u201d executed so that a search is conducted using the UPnP protocol as one of the selected protocols, and a search is conducted using the other JXTA protocol if a device cannot be found. Or if a command (profile acquisition) that instructs to \u201cacquire predetermined information of a device\u201d comes from the virtual protocol, since this command need only be issued by the protocol that can connect the device, a process is independently (if the protocol that can connect the device is UPnP, UPnP alone) (the process is done based on the processing attribute of ).","In this manner, in an environment in which a plurality of device control protocols of different types are used together, when a process is converted from one virtual protocol into a plurality of actual protocols (device control protocols), these actual protocols are executed parallelly, serially, or independently, thereby controlling the order or contents of processes.",{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 8","b":"201"},"In this embodiment, virtual protocol conversion modules , which respectively correspond to three different device control protocols \u201cplug & play\u201d, \u201cpeer 2 peer\u201d, and \u201cdirectory server\u201d, are prepared.",{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 8","b":["201","801","802","803"]},"The list  corresponds to the device ID list which is input to the output parameter list upon execution of the \u201cplayer list acquisition\u201d command shown in . In this case, the window indicates that devices with device IDs=network camera, printer 1, printer 2, printer, scanner 1, and scanner 2 are ready to use. The profile information  and status information  are displayed using profile information () and status information () which are input to the output parameter lists as a result of execution of the \u201cprofile acquisition\u201d command and \u201cstatus acquisition\u201d command shown in  on the basis of a device (printer 1) selected from those displayed on the list .","The user selects and designates a desired device from a list of controllable devices displayed as the list , and can enjoy a service provided by that device.",{"@attributes":{"id":"p-0076","num":"0075"},"figref":"FIG. 9","b":"201"},"A plurality of device control protocols have different properties and performances. A user interface suited to the user who wants to manipulate the device control application while utilizing the characteristics unique to each individual device control protocol is that shown in .  also shows a window which is displayed on the image display device of the information processing apparatus on which the device control application  runs. This window displays a device list , profile information , and status information . The device list  displays devices that form a device network while being classified into corresponding device control protocols (protocols 1, 2, and 3). In , devices corresponding to protocol 1 are displayed. The profile information  and status information  display profile information and status information associated with \u201cprinter 1\u201d displayed on the device list .","In this manner, the user can select a device in consideration of the profile\/status information of devices to be controlled in addition to the identification information of the device control protocol.","As described above, since the relationship between the device control protocol and device control application is changed to loose coupling via the virtual protocol, devices which support different types of device control protocols can form a device network.","Since the order and contents of processes in an environment in which a plurality of device control protocols of different types are used together can be controlled, more appropriate device cooperation processes can be realized.","Furthermore, the device control application need not independently support a plurality of device control protocols of different types.","The present invention has been described by way of its preferred embodiments. However, the present invention is not limited to the above embodiment, and various modifications can be made within the scope of the claims.","In the above embodiment, Internet protocol (IP) is used as the communication protocol used in the communication route between each virtual protocol conversion module  and device to be controlled. Instead of this protocol, other communication protocols that can connect devices each other may be used. For example, IPX may be used.","In the above embodiment, a single device control apparatus controls a plurality of devices to be controlled. Alternatively, a plurality of device control apparatuses and a plurality of devices to be controlled may be present on a single device network.","In the above embodiment, one device control protocol corresponds to one virtual protocol conversion module . Alternatively, a plurality of device control protocols may correspond to one virtual protocol conversion module . Or an arrangement that allow a plurality of virtual protocol conversion modules  to implement control of one device control protocol may be adopted.","Note that the present invention may be applied to either a system constituted by a plurality of devices (e.g., an AV device, home electronic appliance, computer device, interface device, and the like), or a single apparatus.","The objects of the present invention are also achieved by supplying a storage medium, which records a program code of a software program that can implement the functions of the above-mentioned embodiments to the system or apparatus, and reading out and executing the program code stored in the storage medium by a computer (or a CPU or MPU) of the system or apparatus.","In this case, the program code itself read out from the storage medium implements the functions of the above-mentioned embodiments, and the storage medium which stores the program code constitutes the present invention.","As the storage medium for supplying the program code, for example, a flexible disk, hard disk, optical disk, magneto-optical disk, CD-ROM, CD-R, CD-RW, DVD-ROM, DVD-RAM, DVD-RW, DVD+RW, magnetic tape, nonvolatile memory card, ROM, and the like may be used.","The functions of the above-mentioned embodiments may be implemented not only by executing the readout program code by the computer but also by some or all of actual processing operations executed by an OS (operating system) running on the computer on the basis of an instruction of the program code.","Furthermore, the functions of the above-mentioned embodiments may be implemented by some or all of actual processing operations executed by a CPU or the like arranged in a function extension board or a function extension unit, which is inserted in or connected to the computer, after the program code read out from the storage medium is written in a memory of the extension board or unit.","As many apparently widely different embodiments of the present invention can be made without departing from the spirit and scope thereof, it is to be understood that the invention is not limited to the specific embodiments thereof except as defined in the claims.","This application claims priority from Japanese Patent Application No. 2003-320261 filed on Sep. 11, 2003, which is hereby incorporated by reference herein."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate embodiments of the invention and, together with the descriptions, serve to explain the principle of the invention.",{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 10"}]},"DETDESC":[{},{}]}
