---
title: Secured views for a CRM database
abstract: The claims of the present application recite a method and system for accessing information in an otherwise inaccessible application database of a DBMS using view definitions that implement a security protocol.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07562092&OS=07562092&RS=07562092
owner: Microsoft Corporation
number: 07562092
owner_city: Redmond
owner_country: US
publication_date: 20041222
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The present invention generally relates to methods of providing secure access to database tables in a database management system.","In a database management system (DBMS), data is stored in one or more data containers. Each container contains records and the data within each record is organized into one or more fields. In a relational database system, the data containers are referred to as tables, the records are referred to as rows, and the fields are referred to as columns. In object oriented databases, the data containers are referred to as object classes, the records are referred to as objects, and the fields are referred to as attributes. Other database architectures may use different terminology. The claims of the present application are not limited to any particular type of data container or database architecture.","Many applications having extensive data handling requirements often rely on an independent DBMS to help manage application data. Such applications may include business applications, including customer relationship management (\u201cCRM\u201d) systems and enterprise resource planning (\u201cERP\u201d) systems. Using a separate, independent DBMS allows application designers to rely on the DBMS to handle complicated bulk data storage functions, while freeing designers to focus on creating application specific functions. In addition to the division of labor benefit, such a dual system model provides a simple and commonly used security framework where security functionality is localized to the application system. For example, many proprietary business applications, including CRM systems using a DBMS, provide access to CRM data only through the CRM system, thereby ensuring that data access and data security are managed through security functions provided by the CRM application. In this model, it is common for the CRM system to implement a closed, private database instance that can only be accessed from the CRM application or by a system administrator for maintenance purposes.","The security model used in prior art systems is shown in . In this security model, the DBMS is setup to deny general access to the application database, allowing only the software system itself to access the database, or perhaps, a system administrator. In this manner, all access to the application system data is controlled by the application.","One reason that security is channeled away from the DBMS and localized within the business application is that the security functionality of a typical DBMS is often unsuited to handle application specific security requirements. For example, Microsoft SQL Server, a DBMS, provides protection of data to the table level only. Many business applications, such as Microsoft CRM, may require specific row-level protection. In row-level security, result sets are returned with hidden or withheld data rows based on a user's role and privileges. CRM systems such as Microsoft CRM commonly perform this row-level security through the application software either using a general software executable or programmatically through application programming interfaces (\u201cAPIs\u201d).","Another reason that many independent software vendors do not want to utilize DBMS level security is that this may require vendor specific design considerations and support for a particular DBMS. This would make cross-compatibility of the software more difficult to implement. In a system in which database security is channeled through the application software itself, there would be much less consideration for the specific DBMS being used with an application.","While this common security system makes it convenient for CRM system designers to implement localized security, there is often a desire or need to perform analysis on the data stored in an application database that the application itself is not suited, or designed, to perform. In the example of a CRM system, such as Microsoft CRM, there may be a desire to analyze customer data for trends, marketing patterns, demand statistics, budgeting considerations, operating considerations, etc., that the CRM system is not designed to perform. Moreover, there is also no convenient way of sharing Microsoft CRM data with other related business applications, such as enterprise resource planning (\u201cERP\u201d) applications.","Under the existing security model, one option for providing access to the CRM data is to design an interface to the CRM system for extracting necessary data through the CRM system. This can be done by providing APIs to a user to retrieve the data via the CRM system. However, depending on the CRM system, this procedure can be excruciatingly time consuming and complex, as one would need to be adept at programming code to communicate through the application interface. This approach is not a process many data analysts would be suited to perform.","Many applications, including the Microsoft suite of office products, e.g. Microsoft Word, Microsoft Excel, Microsoft PowerPoint, etc., are able to access any DBMS supporting SQL and ODBC. Thus, another more convenient option for providing access to a Microsoft CRM database is to open the database for access to a group of users via the DBMS. However, as mentioned above, a DBMS usually only allows protection down to the table level and does not allow for micro-level protection of row specific information in the tables. A particular business may not want data analysts to see all the row data but only a subset of the rows. If this option were to be implemented, additional business process changes may need to be made in terms of changing employee business roles and creating new business roles, something that many independent software vendors (\u201cISVs\u201d) would not like to burden consumers with. Moreover allowing an open database connection would increase the risk of corruption of application data which could greatly harm a business. While opening the database to a system administrator would be reasonable, opening a database for full access to a group of data analysts creates problems in security that would make a database such as a CRM database susceptible to compromise.","Therefore, there is a need for an improved method and system of accessing data in a secured application database via the DBMS without compromising the security intentions of the secured application.","The claims of the present application recite a method and system for accessing information in an otherwise inaccessible application database of a DBMS using view definitions that implement a security protocol. While the specific method and system will be described to apply to a CRM system embodiment, specifically, Microsoft CRM, it is emphasized that this system may be applied to other secure application databases as well.","The claimed method and system may be a tiered security access model in which the DBMS is set to allow discrete access to a CRM database. Users may log on to a DBMS using, for example, an integrated DBMS-operating system authentication protocol and obtain access to an instance of an application database. However, further access to objects contained in the database is restricted to database views. Moreover, this model may only allow for accessing the views to obtain a listing of view identifiers, to obtain a listing of view attributes, and to execute the views.","The view acts as a secured proxy to a particular table of the database for which it corresponds. Furthermore, security is enabled in a relatively easy way by attaching to the view, simple query conditions that match user role and user privilege to table-row associations and privileges. Additionally, because access is being performed via the DBMS, no further interface methods need to be coded to provide interoperability with secondary applications used to process the CRM data. In this way, efficient data base extraction and query filtering may be performed without the need for code savvy data analysts.","Although the following text sets forth a detailed description of numerous different embodiments, it should be understood that the legal scope of the description is defined by the words of the claims set forth at the end of this patent. The detailed description is to be construed as exemplary only and does not describe every possible embodiment since describing every possible embodiment would be impractical, if not impossible. Numerous alternative embodiments could be implemented, using either current technology or technology developed after the filing date of this patent, which would still fall within the scope of the claims.","It should also be understood that, unless a term is expressly defined in this patent using the sentence \u201cAs used herein, the term \u2018______\u2019 is hereby defined to mean . . . \u201d or a similar sentence, there is no intent to limit the meaning of that term, either expressly or by implication, beyond its plain or ordinary meaning, and such term should not be interpreted to be limited in scope based on any statement made in any section of this patent (other than the language of the claims). To the extent that any term recited in the claims at the end of this patent is referred to in this patent in a manner consistent with a single meaning, that is done for sake of clarity only so as to not confuse the reader, and it is not intended that such claim term be limited, by implication or otherwise, to that single meaning. Finally, unless a claim element is defined by reciting the word \u201cmeans\u201d and a function without the recital of any structure, it is not intended that the scope of any claim element be interpreted based on the application of 35 U.S.C. \u00a7 112, sixth paragraph.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["100","100","100","100"]},"The blocks of the claimed method and apparatus are operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the methods or apparatus of the claims include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The blocks of the claimed method and apparatus may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The methods and apparatus may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the blocks of the claimed method and apparatus includes a general purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies. A user may enter commands and information into the computer  through input devices such as a keyboard  and pointing device , commonly referred to as a mouse, trackball or touch pad. Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 2","b":["200","210","215","200","220","230","240","230","250","230"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 2","FIG. 2"],"b":["210","250","260","251","261","200","210","250","250","240","250","200","230"]},"An embodiment of a business process of the claims may be illustrated in , which illustrates the use of Microsoft Excel  accessing a CRM database . Microsoft Excel is a common tool for analyzing application data. Because the Microsoft suite provides connection capabilities to any DBMS using SQL and ODBC, Microsoft Excel may connect to a Microsoft SQL Server  and subsequently connect to a Microsoft CRM database . In fact, many third party systems  that provide connection capabilities to a DBMS using SQL and ODBC may connect to Microsoft SQL Server . Microsoft Excel may then query for available views , which correspond to particular CRM tables , and request information. Moreover, this request may provide row filtered results based on role and privilege information of a user . Prior art systems may continue to require either a completely open database, or a custom interface into the CRM system itself. Also, prior art systems may not provide the unique row-filtering capabilities of certain embodiments of the claimed system, where rows may be filtered based on roles and privileges assigned to the particular user and row.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3","b":["310","340","350","350","350","360","340","350","340"]},{"@attributes":{"id":"p-0037","num":"0036"},"figref":["FIG. 4","FIG. 4"]},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 5","b":["500","501","502","503","503","502","509","505","504","507","506","508"]},"CRM systems may integrate a business hierarchy into its security implementation and often include fields in their data entities that correspond to an owner and a business unit. An operating system, such as Microsoft Windows, may also contain a hierarchical structure affiliating user roles with groups, where the roles have a set of privileges. In an embodiment of claims, the secured views may be designed to return rows based on a hierarchical ownership structure that leverages an existing CRM application and operating system environment. This potential security checking model is illustrated in . A SQL statement implementing the security model is further described below, where a user may be an owner of a record, and thus a user ID may be contained in an owner attribute of the record. Access checking procedure  first determines if the user is an owner of the object, as illustrated in block . If so, then the user has complete access in block . If the user is not an object owner, routine  determines the required privilege depth to access the object based on the object's ownership affiliation. If the user and object belong to the same business unit, block , then the minimum depth is Local . If the object's owning business unit is the same as the user's business unit, block , then the minimum required depth is Deep . If the object is in the same organization as the user, block , then the minimum required depth is Global . Once the minimum privilege depth is calculated, blocks , , and  check to see if the user's privileges have the minimum required depth. If the user's privileges have minimum required depth or greater, as determined in blocks , , and , access is granted in block . If not, routine  then determines, in block , if the object is explicitly shared to the user or a team of which the user is a member. If so, then access is granted in block , otherwise access is denied in block .","The privilege depth illustrated in  is categorized as basic, local, deep, or global. A user with a basic privilege depth has rights to any objects that are owned by that user, shared to that user, or shared to a team of which the user is a member. A user with a local privilege depth has rights of a basic privilege depth and also has rights to any objects that are in the user's business unit. A user with a deep privilege depth has rights of a local privilege depth and also has rights to any objects that are in sub-businesses of the business-unit to which the user belongs. This includes sub-businesses at any depth, not just an immediate level sub-business, and thus, includes sub-businesses of sub-businesses. A user with a global privilege depth has rights to any objects in the user's organization (and thus global is a superset of all the other privilege levels).","A SQL statement that may be used to implement the security process of  is shown below:",{"@attributes":{"id":"p-0042","num":"0041"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u2003\u2003SELECT [Account columns to retrieve]"},{"entry":"\u2003\u2003FROM Account"},{"entry":"\u2003\u2003WHERE"},{"entry":"\u2003\u2003("},{"entry":"\u2003\u2003\u2003-- object owned by the user"},{"entry":"\u2003\u2003\u2003Account.OwningUser = [Current User ID]"},{"entry":"\u2003\u2003\u2003\u2003or"},{"entry":"\u2003\u2003\u2003-- object owned by business unit of user - local access"},{"entry":"\u2003\u2003\u2003Account.OwningBusinessUnit = [Current User Business ID]"},{"entry":"\u2003\u2003\u2002-- role based access"},{"entry":"\u2003\u2003\u2003\u2003or"},{"entry":"\u2003\u2003\u2003\u2003-- deep access"},{"entry":"\u2003\u2003\u2003\u2003(Account.OwningBusinessUnit in Select biz.SubBusinessId from"},{"entry":"BusinessUnitMap as biz where biz.BusinessId = u.BusinessUnitId) and PrivilegeDepth ="},{"entry":"[Deep]"},{"entry":"\u2003\u2003\u2003\u2003or"},{"entry":"\u2003\u2003\u2003\u2003-- global access"},{"entry":"\u2003\u2003\u2003\u2003(Account.OwningBusinessUnit in Select org.SubBusinessId from"},{"entry":"OrganizationMap org where org.OrganizationId = u.OrganizationId) and PrivilegeDepth ="},{"entry":"[Global]"},{"entry":"\u2003\u2003\u2003\u2003or"},{"entry":"\u2003\u2003)"},{"entry":"\u2003\u2003\u2002-- object shared to the user"},{"entry":"\u2003\u2003\u2002or"},{"entry":"\u2003\u2003\u2002Account.AccountId in"},{"entry":"\u2003\u2003\u2002("},{"entry":"\u2003\u2003\u2003select POA.ObjectId from PrincipalObjectAccess POA"},{"entry":"\u2003\u2003\u2003join SystemUserPrincipals sup on POA.PrincipalId = sup.PrincipalId"},{"entry":"\u2003\u2003\u2003\u2002where sup.SystemUserId = [Current User ID] and"},{"entry":"\u2003\u2003\u2003\u2003POA.ObjectTypeCode = 2 AND"},{"entry":"\u2003\u2003\u2003\u2003(POA.AccessRightsMask & 1) = 1"},{"entry":"\u2003\u2003\u2002)"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"Unlike existing security models that use a security descriptor field to provide bulk instructions for API-based security processing, the present claims may rely on a security model that only references discrete ownership attributes of each database object, attributes that are often already part of the general attribute structure of the object. As described above, security privileges may be processed in sets that are based on ownership affiliations. In this way, processing may be faster. Furthermore, because the security model of the claimed method and system processes the rows completely in a DBMS, rather than relying on an API, processing may be faster because a dedicated DBMS processing internal instructions will most often be faster than an API retrieving a set of rows over a communication channel and interpreting a large security descriptor.","In addition, users of a CRM-DBMS system may now interface with database tables via virtual tables provided by the secured views. Users may perform data analysis with a host of other analysis tools that are compatible with SQL-ODBC drivers using a security system integrated with the operating system. It provides seamless integration for application suites like Microsoft Office because a user can now use a tool like a query wizard to open views, similar to opening a database table, without the user needing to be aware of the underlying implementation.","As an example, a user could use secured views to import CRM related data into a spreadsheet program such as Excel where numerous statistical operations may be performed on the data. This may be accomplished without knowing any computer coding language because a simple pop-up query wizard type tool may be used. In addition, the importation may be accomplished without having to proceed through a separate security procedure to access the database because the security is localized to the DBMS. Finally, the importation and analysis may be accomplished without modifying the underlying data in the database by operating on a view of the data rather than the actual data.","Although the forgoing text sets forth a detailed description of numerous different embodiments, it should be understood that the scope of the patent is defined by the words of the claims set forth at the end of this patent. The detailed description is to be construed as exemplary only and does not describe every possible embodiment because describing every possible embodiment would be impractical, if not impossible. Numerous alternative embodiments may be implemented, using either current technology or technology developed after the filing date of this patent, which would still fall within the scope of the claims.","Thus, many modifications and variations may be made in the techniques and structures described and illustrated herein without departing from the spirit and scope of the present claims. Accordingly, it should be understood that the methods and apparatus described herein are illustrative only and are not limiting upon the scope of the claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
