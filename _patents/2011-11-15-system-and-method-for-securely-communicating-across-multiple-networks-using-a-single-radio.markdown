---
title: System and method for securely communicating across multiple networks using a single radio
abstract: A communications module for facilitating secure communications on a first network and a second network includes: a single transceiver for receiving and transmitting first network messages from and to the first network and at least transmitting second network messages to the second network; at least a first processor connected to the single transceiver for processing one or more first network messages and second network messages; the at least a first processor including first network logic for processing first network messages and second network logic for processing second network messages; and the second network logic including instructions for securing second network messages such that decryption of the second network messages is limited to a particular receiving device on the second network. The second network messages may include commodity pricing and use information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08832428&OS=08832428&RS=08832428
owner: Trilliant Holdings Inc.
number: 08832428
owner_city: Redwood City
owner_country: US
publication_date: 20111115
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY","DETAILED DESCRIPTION"],"p":["The present application claims benefit of U.S. provisional patent application No. 61\/413,538 titled \u201cSYSTEMS AND METHODS FOR SINGLE RADIO USE ACROSS MULTIPLE NETWORKS\u201d filed Nov. 15, 2010, which is incorporated herein by reference in its entirety and U.S. provisional patent application No. 61\/441,375 titled \u201cDEVICE AND METHOD FOR FACILITATING SECURE COMMUNICATIONS OVER A CELLULAR NETWORK\u201d filed Feb. 10, 2011, also incorporated by reference herein in its entirety.","1. Field of Embodiments","The present embodiments relate generally to a system and process that utilizes a single radio, i.e., a single transceiver, to bridge communications between multiple independent networks and facilitates secure one-way communication of information to devices on a single-hop network. More particularly, the various embodiments relate to making use of a single radio existing within a node of a network to facilitate secure communication from a back-end processor to both the node as part of a first network, e.g., neighbourhood area network (\u201cNAN\u201d), and end-use devices that are part of a second network, e.g., home area network (\u201cHAN\u201d). Additionally, various embodiments relate generally to a system and process that facilitates secure one-way and two-way communication of private information over a one-hop network such as a home area network (HAN).","2. Description of Related Art","In the utility delivery space, there have been numerous advances in technology in efforts to provide improved methods and systems for monitoring and controlling the delivery and use of various utilities, e.g., electricity, water, gas, etc. By way of specific example, advanced metering infrastructures (\u201cAMIs\u201d) have been developed which incorporate smart meters or existing meters retrofitted with a communications component that include at least a radio, i.e., transceiver, and configurable microprocessor. These meters may be more generically referred to as nodes and are configured to communicate using predetermined protocols with other nodes in the AMI across what is commonly referred to as a neighbourhood area network (\u201cNAN\u201d). One primary function of the AMI is to monitor delivery, i.e., is delivery occurring at all as in the case of power outages, as well as reporting back meter readings to back-end systems. The ability to achieve this monitoring automatically and wirelessly is an important advancement over the wired, drive by or house-to-house meter reading methodologies of the past.","While the AMIs have vastly improved the flow of information to the utility companies regarding utility usage based on the meter readings, the utility usage associated with a single meter, e.g., within a particular residence or building can theoretically be further broken down according to individual load, e.g., by appliance. With the development of smart appliances, consumers are able to monitor and even control energy usage within their homes and businesses. Such appliances are also referred to as demand-side management (\u201cDSM\u201d) devices or in-home devices (\u201cIHDs\u201d). A network of multiple smart appliances or individual load monitors is often referred to as a home area network (\u201cHAN\u201d).","Various protocols, methodologies and system configurations have been developed in order to facilitate information and data transmission within the NAN, within the HAN and to and from aback-end system, usually requiring either a wired connection or transmission over another network, e.g., wide area network (\u201cWAN\u201d). Due to the differing protocols and methodologies, the hardware is quite often different or duplicative or requires complex programming in order to facilitate secure communication across varying devices and multiple networks.","It is desired to provide and request\/receive communications including data related to utility consumption, rates and cost in real-time or quasi-real-time. Current configurations for facilitating such communication require additional components and\/or software installation and complex routing in order to bridge the NAN-HAN. For example, U.S. Pat. No. 7,317,404 requires the addition of a specific transmitter to utility meters in order to transmit consumption data to a display module within the HAN. Further, U.S. Pat. No. 7,545,285 requires a master controller to listen in on communications between a meter and a reading system and perform in various actions, such as load interrupt, depending on the communication particulars. Further still, U.S. Pat. No. 7,427,927 requires a display with separate radio for listening to or requesting communications between a meter and a reading system and capturing certain meter data in a memory of the display for display to the user. Heretofore, all configurations for bridging the HAN-NAN communication gap require at least three radios: two in the meter (NAN and HAN) and one in a home device (HAN) for an architecture wherein the meter acts as the gateway; or one in meter (NAN) and two in the home device (HAN and NAN) for an architecture wherein a HAN device acts as the gateway.","Additionally, the Zigbee Smart Energy Profile (ZSE) version 1.0 supports a method for delivering information to DSM devices called Inter-PAN. This method consists of an IEEE 802.15.4 point to point communication between an Inter-PAN ZSE server and Inter-PAN ZSE clients. In version 1.0, this mechanism is limited to the transmission of public pricing information and public messages using a polling method. This means that each Inter-PAN ZSE client needs to request the information needed from one of the accessible Inter-PAN ZSE servers. There are no criteria in the selection of the Inter-PAN ZSE server used by an Inter-PAN client. This Inter-PAN configuration does not utilize any security, it is dependent on client requests to pull information from the server, information is limited to public messages and there is no guarantee that this server is associated the same premise.","The existing systems for providing and\/or requesting communications including data related to utility consumption, rates and cost do not provide for secure wireless communication, electricity pricing information, premise association, and use of existing infrastructure. Accordingly, there is a need in the art for a method and system to provide price and energy usage information from an AMI network into the HAN in a way that reduces complexity, increases cybersecurity, and preserves consumer privacy.","Additionally, there is a need in the art for a mechanism to allow for secure, wireless communication between field tools and one or more nodes of a secure one-hop network, e.g., HAN, in an ad hoc fashion for performance of various tasks, e.g., operations and maintenance services (O&M services such as installations, configuration changes, firmware upgrades, etc.). There is a need in the art for a process and system for facilitating secure connection and communication with networked devices without requiring joinding with or creation of a network.","In a first embodiment, a communications module for facilitating secure communications on a first network and a second network includes: a single transceiver for receiving and transmitting first network messages from and to the first network and at least transmitting second network messages to the second network; at least a first processor connected to the single transceiver for processing one or more first network messages and second network messages; the at least a first processor including first network logic for processing first network messages and second network logic for processing second network messages; and the second network logic including instructions for securing second network messages such that decryption of the second network messages is limited to a particular receiving device on the second network.","In a second embodiment, a process for registering a device located on a home area network with a communications module to facilitate receipt at the device of messages from the communications module that originated outside of the home area network includes: receiving a device registration key that is unique to the device at a head end system that is not on the home area network; receiving at the communications module the device registration key from the head end system; transmitting by the communications module a registration message encrypted with a version of the device registration key on multiple communication channels; listening by the device for registration messages on a particular communication channel within the multiple communication channels; and upon receiving on the particular communication channel the registration message encrypted with the device's registration key, decrypting the registration message to retrieve a shared link key for decrypting application messages from the communications module.","In a third embodiment, a process for registering multiple devices located on a home area network with a communications module to facilitate receipt at the multiple devices of messages from the communications module that originated outside of the home area network includes: receiving a unique device registration key for each of the multiple devices at a head end system that is not on the home area network; receiving at the communications module each of the unique device registration keys from the head end system; transmitting by the communications module on multiple communication channels individual registration messages each encrypted with a version of one the multiple device registration keys; listening by each of the multiple devices for registration messages on a particular communication channel within the multiple communication channels; upon receiving on the particular communication channel the registration message encrypted with an individual of the multiple device's registration key, decrypting the registration message to retrieve one of a first or second shared link key for decrypting application messages encrypted with one of the first or second shared link keys from the communications module; wherein each of the multiple devices on the home area network receives either the first or the second shared link key, but not both.","This document includes the following acronyms.",{"@attributes":{"id":"p-0029","num":"0028"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["AES","Advanced Encryption Standard"]},{"entry":["AMI","Advanced Metering Infrastructure"]},{"entry":["API","Application Programming Interface"]},{"entry":["APS","Application support sub-layer"]},{"entry":["CBKE","Certificate-based Key Establishment"]},{"entry":["CCM*","Modified \u2018Counter with Cipher Block Chaining Message"]},{"entry":[{},"Authentication Code\u2019 mode of operation for"]},{"entry":[{},"cryptographic block ciphers"]},{"entry":["CPP","Critical Peak Pricing"]},{"entry":["CSS","Customer Service System"]},{"entry":["ECC","Elliptic Curve Cryptography"]},{"entry":["EMS","Energy Management System"]},{"entry":["ENC-MIC-","32-bit encryption mode composed of a combination"]},{"entry":["32","of Encryption (ENC) and Message Integrity Code"]},{"entry":[{},"(MIC) modes."]},{"entry":["UESI","Utility Energy Services Interface"]},{"entry":["ESP","Energy Services Portal - a ZSE embodiment of an ESI"]},{"entry":["EUI64","Extended Universal Identifier-64"]},{"entry":["HAN","Home Area Network"]},{"entry":["HES","Head-End Server (or System)"]},{"entry":["IHD","In-Home Display"]},{"entry":["ISO","Independent System Operator"]},{"entry":["LED","Light Emitting Diode"]},{"entry":["LSB","Least Significant Bit"]},{"entry":["MAC","Medium Access Control (referring to protocol stack"]},{"entry":[{},"sublayer)"]},{"entry":["MMO","Matyas-Meyer-Oseas one way hash function"]},{"entry":["NAN","Neighborhood Area Network"]},{"entry":["NWK","Network"]},{"entry":["OOB","Out-of-band"]},{"entry":["PAN","Personal area network"]},{"entry":["PCT","Programmable Communicating Thermostat"]},{"entry":["PEV","Plug-in Electric Vehicle"]},{"entry":["PHY","Physical Layer (referring to protocol stack sublayer)"]},{"entry":["RF","Radio Frequency"]},{"entry":["SE","Smart Energy"]},{"entry":["TOU","Time of Use pricing schedule"]},{"entry":["UTC","Coordinated Universal Time standard"]},{"entry":["UTF-8","8-bit Unicode Transformation Format Unicode"]},{"entry":[{},"Transformation Format"]},{"entry":["ZCL","ZigBee Cluster Library"]},{"entry":["ZSE","ZigBee Smart Energy"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"The following documents are incorporated herein by reference in their entirety: \u201cUCAIug Home Area Network System Requirements Specification: A Work Product of the OpenHAN Task Force formed by the SG Systems Working Group under the Open Smart Grid (OpenSG) Technical Committee of the UCA International Users Group,\u201d Version 2.0\u2014Aug. 30, 2010 (OHP Document); \u201cZigBee Smart Energy Profile Specification,\u201d ZigBee Profile: 0x0109; Revision 15, Dec. 1, 2008, Document 075356r15 (SEP Document); ZigBee Smart Energy Test Specification, May 2008 ZigBee Document 075384r17; ZigBee Cluster Library Specification, ZigBee Document 075123r02ZB; and Institute of Electrical and Electronics Engineers, Inc., IEEE Std. 802.15.4-2003 & 2006, IEEE Standard for Information Technology\u2014Telecommunications and Information Exchange between Systems\u2014Local and Metropolitan Area Networks\u2014Specific Requirements\u2014Part 15.4: Wireless Medium Access Control (MAC) and Physical Layer (PHY) Specifications for Low Rate Wireless Personal Area Networks (WPANs).","Additionally, throughout the document, the terms and phrases HAN device, client device, Inter-PAN client device, Inter-PAN client and client are used interchangeably. Similarly, the terms and phrases Inter-PAN server and UESI are used interchangeably.","Referring to , a simplified schematic illustrates the various networks utilized in a system of the present invention, including wide area network (WAN)\/neighbourhood area network (NAN) (also referred to as an AMI network) and home area network (HAN) and representative components within each network. For example, the WAN\/NAN communicates with the head end server (HES) for requesting, processing, transmitting communications to\/from nodes including, e.g., a meter (also referred to as an AMI node), shown in as an electric meter; and the HAN includes end user devices such as thermostats. As discussed further below, the system has at least the following features: a single radio for both NAN and HAN communications; HAN device may exist on a separate logically secure HAN network; uses same MAC\/PHY layer in both NAN and HAN; secure links between NAN nodes (e.g., meters, stand-alone, thermostats that are retrofitted or originally manufactured to include the Utility Energy Service Interface (UESI) hardware and logic described herein) into the HAN; secure communications between meter and NAN; and simplified commissioning process.","In operation, the AMI node receives a security key from AMI network that itself is encrypted using the AMI security which is at the application layer as described further in pending U.S. patent application Ser. No. 12\/554,135 entitled: A SYSTEM AND METHOD FOR IMPLEMENTING MESH NETWORK COMMUNICATIONS USING A MESH NETWORK PROTOCOL which is incorporated herein by reference in its entirety. The AMI node uses this security key to authenticate and encrypt communications to the HAN devices at the MAC layer. The encryption and authentication mechanisms may be different as between the AMI network and the HAN network.","Information is pushed from the AMI node using a single radio that simultaneously operates the AMI network and the HAN network. Information is automatically sent to the associated HAN devices using one-way communication (or two way communication in accordance with a particular embodiment). The transmission of information to HAN devices occurs even if these devices are not capable of sending messages back to the sending AMI node. The AMI node sends messages into the HAN on all channels in the communication band and this operation occurs simultaneously with AMI network communications. The communication is performed by a single radio in the AMI node, where the AMI network and the HAN operate on the same MAC\/PHY layers but different routing protocols. In this configuration, a single radio in an AMI node (e.g. electric, gas, water meter) is used to transmit information into the HAN and potentially receive information from the HAN, where the single radio simultaneously supports communication protocols for both the NAN network and HAN network. The reduction from two to a single radio reduces costs for parts as well complexity of electronics. Additionally, the communications with the HAN are secured because the HAN key is not transmitted in the clear per secure key establishment using the pre-existing secure AMI communications. Secure communications between the AMI node and the HAN devices protect consumer information. Further, in one configuration, the flow of information is one-way from the AMI node into the HAN. This prevents unintended data flow of personal information from the HAN and into the AMI network.","Certain exemplary embodiments presented herein describe a Utility Energy Service Interface (UESI) that enables one-way (and two-way communications) of, e.g., private consumer-specific information to registered home area network (HAN) devices. Referring again to , the UESI  is part of an electric (or other utility) meter  capable of securely broadcasting information, e.g., price and energy usage information, to a HAN device . Specific embodiments further describe HAN device requirements for interaction with the UESI. In a representative embodiment, various ZigBee components used in this implementation include: ZigBee SEP Inter-PAN, ZigBee ZCL attribute reporting, the ZigBee SEP 1.0 Price cluster, and the Simple Meter cluster. Secure, originator-authenticated communication is achieved through the use of the ZigBee pre-configured application layer security.","Referring to , an exemplary UESI  includes at least a radio , a processor  which includes separate communications logic for communicating with the NAN and HAN , a memory  which includes at least one database for storing table data, and a clock  for synchronization. Optionally, the UESI  is in communication with a user input component and a display device which are part of the node  (or other host device, e.g., stand-alone box, smart thermostat, etc.). Alternatively, the UESI  could include separate processors and databases for the NAN and HAN communications as shown in . The UESI clock is synchronized in accordance with the WAN\/NAN clock as described in, for example, U.S. patent application Ser. No. 13\/275,682 entitled \u201cMETHOD FOR SYNCHRONIZING METER CLOCKS IN A NETWORK\u201d which is incorporated herein by reference in its entirety.","Coordination by the UESI of both NAN and HAN communications may occur autonomously in accordance with randomization processes implemented at the UESI or may be the result of predetermined coordination instructions passed down from, for example, the HES. Many messages are not based on relative time but on an absolute time mark. In an exemplary Time of Use (TOU) plan, tier switch occurs at, for example 5 PM and with it, a publish price message is broadcasted by UESIs currently using this TOU plan. Using randomization, a reduction of the strain on the WAN\/NAN network of having all UESIs broadcasting and going \u201coff the WAN\/NAN network\u201d simultaneously is achieved by introducing a random offset specific to each UESI for all transmissions. This offset is randomly generated between, for example, 0 and 60 seconds, and is applied to all transmissions so as to evenly spread out the transmission over the minute following the transmission request. An offset between 0 and 120 seconds is applied to registration packets as their impact on the network is greater considering they have to broadcast on all channels and that, under normal circumstances they request rebroadcasts less often than application messages.","Additionally, the UESI may be programmed with a soft switch, allowing for switching over from WAN\/NAN only to dual use WAN\/NAN and one-way HAN, or dual use WAN\/NAN plus two-way HAN. The embodiments described herein are focused on descriptions of one-way HAN commissioning, registration and communications. Accordingly, the UESI can exist in three separate operational states controlled by the soft switch.","As described in the applicable OpenHAN 2.0 protocol (OHP), the UESI enables secure one-way interactions between commissioned HAN devices registered to the particular UESI and the UESI utility's advanced metering infrastructure (AMI). Security on this interface is robust and comprehensive in order to protect Utility assets (e.g. electric grid, AMI, etc.) and consumer information. The UESI is an interface for providing real-time energy usage information from the AMI meter or other node to HAN devices and is protected with cryptographic methods. The UESI is based on a secure one-way model where real-time information only flows from the UESI to registered HAN devices\u2014an approach that inherently provides protection of Utility assets, as no HAN originated traffic flows upstream from the UESI into the AMI network.","The UESI is designed to do at least the following: register HAN devices, i.e., facilitate the OHP Commissioning process and Registration process for client devices to be able to successfully receive broadcast messages from the UESI; including updating the security keys and network parameters; broadcast price signals, i.e., broadcast electricity price information as received from the HES, or optionally based on a configured local schedule (e.g. every 10 minutes); broadcast energy usage, i.e., periodically broadcast energy usage information based on a configured local schedule (e.g. every 1 minute).","Implementation of an OHP compliant UESI that supports private broadcasts of consumer-specific information into a premise, requires some extensions to the current version of ZigBee SEP, as detailed below. UESI communications with client devices are based on the Inter-PAN transmission mechanism, which allows for communications via a special \u201cstub\u201d of the Application Support Sub-Layer, accessible through a special Service Access Point (SAP). Inter-PAN lends itself very well for this function because of its simplicity and effectiveness to address HAN devices. Unlike previous implementations wherein Inter-PAN was optional, it is a mandatory component of the processes described herein. Table 1 below lists the extensions which facilitate secure Inter-PAN communications to support private broadcasts. Table 1 highlights differences between existing ZigBee Smart Energy (ZSE) Inter-PAN features and extensions required for UESI implementation pursuant to OHP requirements.",{"@attributes":{"id":"p-0042","num":"0041"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"112pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Feature","ZSE version 1.0 Inter-PAN","Extensions"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Communications","Uses IEEE 802.15.4 point-to-","Uses IEEE 802.15.4 point-to-"]},{"entry":["mode","point communications between an","multipoint communications"]},{"entry":[{},"Inter-PAN ZSE server and Inter-","between a UESI and Inter-PAN"]},{"entry":[{},"PAN ZSE client.","client."]},{"entry":["Security","Inter-PAN communications do","Communications are secured using"]},{"entry":[{},"not utilize security.","the OOB Pre-Configured Link Key"]},{"entry":[{},{},"Process defined in the ZigBee"]},{"entry":[{},{},"Smart Energy Profile 1.0"]},{"entry":[{},{},"specification, and uses AES-"]},{"entry":[{},{},"128\/CCM* authenticated"]},{"entry":[{},{},"encryption to provide originator"]},{"entry":[{},{},"authentication as specified by the"]},{"entry":[{},{},"OHP specification security"]},{"entry":[{},{},"requirement for registered HAN"]},{"entry":[{},{},"devices."]},{"entry":["Pull vs. Push","Inter-PAN communications rely","Information is automatically pushed"]},{"entry":[{},"on the ZSE client device to pull","to the associated Inter-PAN clients."]},{"entry":[{},"information from the ZSE server."]},{"entry":[{},"This means that each Inter-PAN","This approach allows for"]},{"entry":[{},"ZSE client needs to request the","transmission of information to"]},{"entry":[{},"information needed from one of","Inter-PAN clients, even if these"]},{"entry":[{},"the accessible Inter-PAN ZSE","clients are not capable of sending"]},{"entry":[{},"servers.","messages back to the server"]},{"entry":["Smart Energy","In ZSE version 1.0, the Inter-","Enables the support for private"]},{"entry":["application","PAN mechanism is limited to:","consumer information:"]},{"entry":[{},"Public Pricing information and","Pricing information using the Price"]},{"entry":[{},"Public Messages","Cluster PublishPrice command."]},{"entry":[{},{},"Energy usage information using the"]},{"entry":[{},{},"ZCL report attribute format to"]},{"entry":[{},{},"transmit Simple Metering Cluster"]},{"entry":[{},{},"server attributes."]},{"entry":["Addressing","Inter-PAN supports the use of","All communication is from the"]},{"entry":[{},"PAN ID in addition to MAC","UESI to the Inter-Pan client device,"]},{"entry":[{},"Address.","using the PAN ID, client device's"]},{"entry":[{},{},"MAC Address, and short broadcast"]},{"entry":[{},{},"MAC Address."]},{"entry":[{},"Initial communications from the","No direct communications from the"]},{"entry":[{},"ZSE client device to ZSE server","client device to the server"]},{"entry":[{},"are broadcast to both the PAN ID"]},{"entry":[{},"and Destination Address, and are"]},{"entry":[{},"intended to facilitate the ZSE"]},{"entry":[{},"client device finding a ZSE server"]},{"entry":[{},"with the appropriate resource (i.e."]},{"entry":[{},"availability to provide pricing or"]},{"entry":[{},"message information)."]},{"entry":[{},"Subsequent communications from"]},{"entry":[{},"the ZSE client device to the ZSE"]},{"entry":[{},"server may be unicast to both the"]},{"entry":[{},"PAN ID and Destination Address"]},{"entry":[{},"of the ZSE server."]},{"entry":[{},"However, all communications"]},{"entry":[{},"from the ZSE server to the ZSE"]},{"entry":[{},"client device are unicast."]},{"entry":["Client-server","There are no defined criteria in","A defined registration mechanism"]},{"entry":["binding within a","the selection of the Inter-PAN","enables service association with a"]},{"entry":["premise","ZSE server used by an Inter-PAN","specific premise"]},{"entry":[{},"client device, and no guarantee"]},{"entry":[{},"that the selected server is"]},{"entry":[{},"associated with the same premise"]},{"entry":[{},"as the ZSE client device."]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"Referring to in a first embodiment facilitating one-way secure Inter-PAN communication to devices on a HAN, including a HES  which communicates over a WAN and NAN with a UESI (also referred to as a master smart energy information server)  which communicates information securely to one or more target devices  on a HAN. In this embodiment, the UESI provides secure smart energy information, e.g., publish price, energy usage information, load control information, text messages, directly to an subscribed target device. In the one-way Inter-PAN process, the objective is to provide sender authentication and confidentiality via encryption (as compared to two-way Inter-PAN, where the objective is to provide mutual authentication and confidentiality). As described further herein, for both one-way and two-way scenarios, there is an authentication phase followed by a phase where both parties arrive at a shared link key, which is then used to encrypt communications during the authorized session, and is valid until it times out.","Referring to , for one-way Inter-PAN, sender authentication and key distribution is achieved via an out-of-band registration process (\u201cOOB\u201d) S using a pre-configured link key (PLK) which is unique to each target device. During registration, a shared link key (\u201cSLK\u201d) is sent from the UESI to each registered target device as part of the payload of the registration message which is encrypted with the PLK S. The SLK is then used by the sender, e.g., UESI, to encrypt each application message S. An optional step S includes a filter for verifying at the target device the MAC address of the UESI. The target device times out if it cannot process an application message with a predetermined amount of time S. Optionally the sender could also sign its messages using its private key, if a public\/private key system is supported (public keys could be embedded in target devices during manufacturing).","The prior art ZigBee processes and components provide for a stand-alone Energy Services Interface (ZEST) that communicates information to ZigBee HAN devices. In accordance with embodiments herein, the ZEST and the UESI are able to coexist in the same premises, in compliance with OHP. In this scenario, a HAN device (e.g., IHD) can communicate independently with two physically different devices: a UESI in meter and a standalone ZESI. The registering process between the UESI, ZEST and HAN devices is as follows: The ZEST registers with the UESI and receives a Shared Link Key, Channel Mask and PAN-ID. The ZEST shall avoid any channels reserved by the UESI, as indicated via the Channel Mask. The ZEST shall avoid the PAN-ID used by the UESI. One or more HAN devices can register with the UESI and receive the Shared Link Key, Channel Mask and PAN-ID. After the ZEST is registered with the UESI, each HAN device can register with the ZEST and negotiate to receive a Network Key, a different PAN-ID and channel, the Trust Center Link Key, and optional Application Link Keys. A HAN device that communicates with both the UESI and the ZESI requires support of frequency agility to switch between channels. Whenever the ZESI receives a Registration message from the UESI requiring changes to the Shared Link key, Channel Mask, and\/or PAN-ID, the ZEST shall initiate updates of its client devices via procedures described in the SEP Document which is incorporated herein by reference.","Alternatively, as shown in , the ZESI may act as an intermediate smart energy server, communicating with the UESI using two-way secure inter-PAN while using one-way secure inter-PAN to communicate with other HAN devices.","Clients of the UESI shall support the Commissioning and Registration states that comply with the OHP as described further herein. Generally, commissioning refers to the process by which a HAN device obtains access to a specific physical network and allows the device to be discovered on that network. The process may involve the exchange of information based on security credentials required to establish network coordination, assign device addresses, and to route packets. Admission to the network allows the HAN device to communicate with peer devices on a network and receive public information from the UESI, but not information reserved for Registered devices. Generally, registration refers to the process by which a commissioned HAN device is authorized to communicate on a logical network. This involves the exchange of information based on security credentials with a UESI. The registration process is required for the exchange of information based on security credentials between a registered device and the UESI and among other devices registered to that UESI.",{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 3","b":["10","15","20","25"]},"In accordance with a one-way broadcast model, in , the UESI  (i.e., Inter-PAN server) receives messages from a Utility HES  that are directed to one or more HAN devices  (i.e., Inter-PAN client) and broadcasts the messages on multiple IEEE 802.15.4 channels. This is a point-to-multipoint communication. This approach eliminates the need for explicit channel management and allows the HAN devices to select the most appropriate channel based on their own proprietary selection algorithms. The specific 802.15.4 channels, on which the UESI transmits each message, depend on whether it is a registration message or an application message.","Two types of messages are supported: registration messages for client registration and network parameter updates, i.e., channel mask and PAN ID, and application messages including the publish price and energy usage messages, as well as text messages. Each registration message is sent on all 802.15.4 channels in order to sequentially reach all client devices, regardless of the channels on which the individual client devices are listening. This registration message includes a two byte channel mask field that informs the client devices about the channels on which the application messages will be sent. Each application message, i.e., publish price or energy usage message, is sequentially broadcast on all 802.15.4 channels identified by the channel mask field. The client device must listen to one or more of the identified channels. In certain embodiments, the UESI has the possibility to change its channel and PAN ID if the need arises in order to work with a specific AMI network. A change in its channel selection or PAN ID will result in registration messages including a new channel mask field and PAN ID for the devices. Messages are addressed to Inter-PAN clients based on a combination of the RF Channel Mask, Destination PAN ID, and 802.15.4 Destination Address fields. In a particular exemplary embodiment, an addressing strategy is summarized as set forth in Table 2.",{"@attributes":{"id":"p-0051","num":"0050"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Message",{},{},"Destination"]},{"entry":["type","RF Channel","Destination PAN-ID","Address"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Registration","All","Client's default PAN ID","Client's"]},{"entry":[{},{},"which is the CRC16 of","MAC"]},{"entry":[{},{},"its MAC Address","Address"]},{"entry":["Application","As specified","Server's selected PAN ID","0xFFFF"]},{"entry":[{},"via the RF"]},{"entry":[{},"Channel Mask"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"Exemplary values for the different communication intervals are shown in Table 3 below:",{"@attributes":{"id":"p-0053","num":"0052"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 3"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":[{},{},"Value"]},{"entry":["Interval","Description","(minutes)"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Client Registration","Period during which a Commissioned","180"]},{"entry":["timeout","client waits for an initial Registration"]},{"entry":[{},"message. After this time expires, the"]},{"entry":[{},"client may need to be triggered again"]},{"entry":[{},"(e.g., via a reset or pushbutton)"]},{"entry":["Registration","Period between Registration messages","60"]},{"entry":"message period"},{"entry":["Publish Price","Period between Publish Price messages","5-15"]},{"entry":"message period"},{"entry":["Energy Usage","Period between Energy Usage messages","1"]},{"entry":"message period"},{"entry":["Application message","Period after which a Registered client","30"]},{"entry":["timeout","stops waiting for Application messages"]},{"entry":[{},"and resets to the Commissioned State to"]},{"entry":[{},"hunt for Registration messages"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"The Physical layer is defined in section 6.5 (2450 MHz PHY specifications) of the IEEE 802.15.4-2006 standard, the specification of which is incorporated herein by reference. Tables contain the list of fields in their order of transmission; the first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB). The definition of each field is not provided in this document but can be found in the different documents referenced herein which are incorporated by reference in their entirety. Table 4 is representative of physical layer parameters.",{"@attributes":{"id":"p-0055","num":"0054"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 4"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Field names","Data type","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Preamble","4 bytes",{}]},{"entry":["Start-of-Frame Delimiter (SFD)","1 byte"]},{"entry":["Frame structure",{},"See Data link layer"]},{"entry":[{},{},"defined below"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The Data link layer is defined in section 7 (MAC sub-layer specification) of the IEEE 802.15.4-2006 standard. As indicated earlier, all messages are sent by the UESI and\/or the ZESI in the particular embodiment wherein the ZESI is registered with the UESI as described previously herein. Two frame types are defined: (1) Registration and (2) Application. Tables contain the list of fields in their order of transmission; the first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB). The definition of each field is not provided in this document but can be found in the different documents referenced herein which are incorporated by reference in their entirety. The frame format used by the Registration message is sent unicast to each client's MAC Address and default PAN ID which is the CRC16 of the client's MAC Address. Table 5a is representative of physical layer parameters.",{"@attributes":{"id":"p-0057","num":"0056"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"98pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 5a"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Fields name","Data type","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Frame control","2 bytes",{}]},{"entry":["Frame type","Bits 0 to 2","Data (001)"]},{"entry":["Security enabled","Bit 3","False (0)"]},{"entry":["Frame pending","Bit 4","False (0)"]},{"entry":["Ack. request","Bit 5","False (0)"]},{"entry":["Intra-PAN","Bit 6","False (0)"]},{"entry":["Dest. Addressing mode","Bits 10 to 11","Long address (11)"]},{"entry":["Source addressing mode","Bits 14 to 15","Long address (11)"]},{"entry":["Sequence number","1 byte","Unique identifier"]},{"entry":"Addressing fields"},{"entry":["Destination PAN","2 bytes","Client's default PAN ID"]},{"entry":"identifier"},{"entry":["Destination address","8 bytes","MAC address of the Inter-PAN"]},{"entry":[{},{},"client"]},{"entry":["Source PAN identifier","2 bytes","Pan ID of the Inter-PAN server"]},{"entry":["Source address","8 bytes","MAC address of the Inter-PAN"]},{"entry":[{},{},"server"]},{"entry":["Frame Payload",{},"See Network layer defined"]},{"entry":[{},{},"below"]},{"entry":["MIC","4 bytes","Authenticator"]},{"entry":["FCS","2 bytes","Frame Check Sequence"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"Table 5b contains the list of fields in their order of transmission for the application layer message format for registration messages. The first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB).",{"@attributes":{"id":"p-0059","num":"0058"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"119pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 5b"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Fields name","Data type","Description and value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ZigBee APS Header",{},{}]},{"entry":["APS frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Inter-PAN transmission (11)"]},{"entry":["Delivery Mode","Bits 2 to 3","Unicast (00)"]},{"entry":["Security","Bit 5","True (1)"]},{"entry":["ACK request","Bit 6","False (0)"]},{"entry":["Extended Header","Bit 7","False (0)"]},{"entry":"Present"},{"entry":["Cluster identifier","2 bytes","(0xfc00)"]},{"entry":["Profile identifier","2 bytes","ZigBee Smart Energy (0x0109)"]},{"entry":"Auxiliary Header"},{"entry":"Security control"},{"entry":["Security level","Bits 0 to 2","ENC-MIC-32 (101)"]},{"entry":["Key identifier","Bits 3 to 4","A data key(00)"]},{"entry":["Extended nonce","Bit 5","(0)"]},{"entry":["Frame counter","4 bytes"]},{"entry":"ZCL header"},{"entry":["Frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Command is specific to a cluster (01)"]},{"entry":["Manufacturer specific","Bit 2","True(1)"]},{"entry":["Direction","Bit 3","From the server(1)"]},{"entry":["Disable default response","Bit 4","True(1)"]},{"entry":["Manufacturer code","2 bytes","0x10C7 (Trilliant)"]},{"entry":["Transaction sequence number","1 byte","Unique ID generated by the Inter-PAN"]},{"entry":[{},{},"server"]},{"entry":["Command identifier","1 byte","0x00"]},{"entry":"ZCL payload"},{"entry":["PAN ID","2 bytes","PAN ID assigned to this Premise and"]},{"entry":[{},{},"used for Application messages"]},{"entry":["Channel Mask","2 byte bitmap","Bitmap representing IEEE 802.15.4"]},{"entry":[{},{},"channel IDs (11 to 26) that the server"]},{"entry":[{},{},"will use for this Premise (LSB = 11)"]},{"entry":["Shared Link key","16 bytes","AES-128 key assigned to this Premise"]},{"entry":[{},{},"and used for subsequent"]},{"entry":[{},{},"communications"]},{"entry":["Publish Price Message Period","2 bytes","Interval between Publish Price"]},{"entry":["(seconds)",{},"messages, configured at the Server"]},{"entry":["Energy Usage Message Period","2 bytes","Interval between Energy Usage"]},{"entry":["(seconds)",{},"messages, configured at the Server"]},{"entry":["Registration Message Period","2 bytes","Interval between Registration"]},{"entry":["(seconds)",{},"messages, configured at the Server"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"This frame format is used for SE broadcast messages, i.e., Publish Price and Energy Usage Messages, which are sent from the Inter-PAN server to Inter-PAN clients. Tables contain the list of fields in their order of transmission; the first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB). The definition of each field is not provided in this document but can be found in the different documents referenced herein which are incorporated by reference in their entirety. Table 6 is representative of application message parameters.",{"@attributes":{"id":"p-0061","num":"0060"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"98pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 6"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Fields name","Data type","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Frame control","2 bytes",{}]},{"entry":["Frame type","Bits 0 to 2","Data (001)"]},{"entry":["Security enabled","Bit 3","False (0)"]},{"entry":["Frame pending","Bit 4","False (0)"]},{"entry":["Ack. request","Bit 5","False (0)"]},{"entry":["Intra-PAN","Bit 6","False (0)"]},{"entry":["Dest. Addressing mode","Bits 10 to 11","Short address (10)"]},{"entry":["Source addressing mode","Bits 14 to 15","Long address (11)"]},{"entry":["Sequence number","1 byte","Unique identifier"]},{"entry":"Addressing fields"},{"entry":["Destination PAN","2 bytes","PAN ID assigned to this Premise"]},{"entry":["identifier",{},"and used for subsequent"]},{"entry":[{},{},"application messages"]},{"entry":["Destination address","2 bytes","Broadcast address (0xFFFF)"]},{"entry":["Source PAN identifier","2 bytes","Pan ID of the Inter-PAN server"]},{"entry":["Source address","8 bytes","MAC address of the Inter-PAN"]},{"entry":[{},{},"server"]},{"entry":["Frame Payload",{},"See Network layer defined"]},{"entry":[{},{},"bellow"]},{"entry":["MIC","4 bytes","Authenticator"]},{"entry":["FCS","2 bytes","Frame Check Sequence"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The Network layer is defined in Annex B.4 (Frame Formats) of the ZigBee Smart Energy Profile version 1.0 revision 15 which is incorporated herein by reference it its entirety. The complete descriptions of each field contained in the list below can also be found in section 3.3.1 (General NPDU Frame Format) of the ZigBee Specification (053474r17). Tables contain the list of fields in their order of transmission; the first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB). The definition of each field is not provided in this document but can be found in the different documents referenced herein which are incorporated by reference in their entirety. Table 7 is representative of network layer parameters.",{"@attributes":{"id":"p-0063","num":"0062"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"112pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 7"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Fields name","Data type","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["NWK frame control","2 bytes","(0x0b00)"]},{"entry":["Frame type","Bits 0 to 1","Inter-PAN transmission (11)"]},{"entry":["Protocol version","Bits 2 to 5","2 (0010)"]},{"entry":["Application Payload",{},"See Application layer defined bellow"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The UESI supports a variety of HAN devices, including battery-supported \u2018sleepy\u2019 devices. Sleepy devices are not always available to receive registration messages. When a non-commissioned sleepy device first starts up, it shall stay awake until it hears the registration message addressed to it (it may time-out after a reasonable long timeout period). The registration message provides three parameters that inform the client of message periodicities; allowing it to synchronize its wake cycles: registration message period, publish price message period, and energy usage message period. Typical values are shown in Table 4 above.","The security of the UESI is based on two types of Link Keys: one pre-configured Link Key to secure individual Registration messages, and a shared Link Key to secure broadcast Application messages. The shared Link Key is distributed via the Registration message.","The security model utilizes features from ZSE 1.0 security, while simplifying the model as appropriate to achieve originator-authenticated communication as required by OHP. A comparison to the full ZSE 1.0 security is shown in the Table 8.","The Registration process establishes the authentication and security between the UESI and the device.",{"@attributes":{"id":"p-0068","num":"0067"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}}],"thead":{"row":[{"entry":[{},"TABLE 8"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"Prior Art","Present Embodiments"]},{"entry":[{},"ZigBee SEP 1.0 CBKE","Secure ZigBee SEP 1.0 Inter-PAN"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Authentication","Mutual authentication","Sender authentication"]},{"entry":["Key","OOB Pre-Configured Link Key","OOB Pre-Configured Link Key"]},{"entry":["Establishment","Process; CBKE","Process"]},{"entry":["Encryption","CCM*\/AES-128","CCM*\/AES-128"]},{"entry":["Security Layers","Network Layer security via a shared","n\/a"]},{"entry":[{},"Network Key"]},{"entry":[{},"Application Layer Security via","Application Layer Security via"]},{"entry":[{},"Application Link Keys:","Application Link Keys:"]},{"entry":[{},"One Trust Center link key per","One Pre-configured Link key per"]},{"entry":[{},"ZigBee client","ZigBee client"]},{"entry":[{},"Multiple application link keys","One Shared Link Key per UESI"]},{"entry":[{},"between application pairs","server"]},{"entry":["Key updates","Supported","Supported"]},{"entry":["Temporary","MMO of ZigBee client's Installation","MMO of ZigBee client's Installation"]},{"entry":["Link key to","Code","Code"]},{"entry":"secure initial"},{"entry":"Link key"},{"entry":"distribution"},{"entry":["Key to secure","Network Key + Trust Center Link","MMO of ZigBee client's"]},{"entry":["subsequent key","Key","Installation Code"]},{"entry":"updates"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"The process of establishing security keys uses the out-of-band (OOB) pre-configured Link Key process and is summarized as follows (see also ). Initially, the HAN device is pre-commissioned. During the manufacturing process, a random Installation Code is created for each HAN device. This Installation Code is provided for the device (e.g., as a label on the packaging of the HAN device and\/or configured into the device) to be referenced to during Commissioning and Registration of the HAN device to the UESI. The HAN device looks up the \u2018Pre-configured Link Key\u2019, or derives it using the MMO hashing function. During installation, the installer provides the Installation Code and MAC Address to the Utility's HES. These are then forwarded to the UESI, where they are stored. The UESI calculates the Pre-configured Link key as needed from the Installation Code and uses it to protect the distribution of the Shared Link Key to the associating HAN device. The Shared Link Key is in turn used to secure the distribution of network-wide application messages. Periodically, the UESI shall update the Shared Link Key by distributing a new one to registered HAN devices. All HAN devices receiving the key update (i.e., in the Commissioned state) will start using the new key immediately to process Application messages. Notice that this mechanism is also used to de-register HAN devices if needed, by only updating the key of the remaining registered HAN devices.","The registration process establishes an association between an Inter-PAN server (UESI) and an Inter-PAN client, i.e., HAN device. Registration messages are used to: Commission and Register a HAN device to the UESI; De-Register a HAN device from a UESI; and update network parameters on the HAN device. The Registration message is sent by the UESI to each registered device's MAC Address, on all the IEEE 802.15.4 channels. The Registration process distributes the Shared Link Key (used by the UESI to encrypt Application messages), the PAN ID, and the Channel Mask. The HAN device, upon reception of a Registration message, shall immediately update its PAN ID, Channel Mask, and the Shared Link Key contained in the Registration message to process subsequent Application messages.",{"@attributes":{"id":"p-0071","num":"0070"},"figref":["FIG. 6","FIG. 7"],"b":["15","20","30","35","40","45","50"]},"In an exemplary embodiment, Inter-PAN devices provide an indication of current state so that the end user of the device has an understanding of the state of the client device. For example, an LED indicator could be used during the Registration process to verify the status of the operation, and during the normal life of the device to verify the health of its communications. Table 9 provides exemplary indicator parameters.",{"@attributes":{"id":"p-0073","num":"0072"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 9"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":[{},{},"Exemplary",{}]},{"entry":[{},{},"LED"]},{"entry":["State","Meaning","indication","Explanation"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Non-Commissioned","The device has not been","n\/a","A device cannot join the"]},{"entry":[{},"Commissioned",{},"UESI until it is"]},{"entry":[{},{},{},"Commissioned with its"]},{"entry":[{},{},{},"pre-configured Link Key"]},{"entry":[{},{},{},"or Installation code."]},{"entry":["Commissioned","The device has been","n\/a","The device needs to be"]},{"entry":[{},"Commissioned but is not",{},"triggered (e.g., powered-"]},{"entry":[{},"Registering",{},"on) to start its"]},{"entry":[{},{},{},"Registration process"]},{"entry":["Commissioned and","A device in the","Slow","Refer to the OOB"]},{"entry":["Registering","Commissioned state and","(1000 ms)","registration process"]},{"entry":[{},"listening for Registration","red LED or"]},{"entry":[{},"messages","equivalent"]},{"entry":["Registered & Active","A device is in the","Medium","In OHP, a Registered"]},{"entry":[{},"Registered state and","(500 ms)","device is by definition"]},{"entry":[{},"receiving messages","green LED","also Commissioned."]},{"entry":[{},{},"or"]},{"entry":[{},{},"equivalent"]},{"entry":["Registered &","A device is in the","Fast","In OHP, a Registered"]},{"entry":["Communicating","Registered state that is","(250 ms)","device is by definition"]},{"entry":[{},"actively receiving a","green LED","also Commissioned."]},{"entry":[{},"message","or"]},{"entry":[{},{},"equivalent"]},{"entry":["Registered & Inactive","A device is in the","Fast","This could indicate that"]},{"entry":[{},"Registered state that is not","(250 ms) red","e.g., the RF signal is"]},{"entry":[{},"receiving messages","LED or","weak, or that the device is"]},{"entry":[{},{},"equivalent","de-registered"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"The initial registration message is authenticated using the device-specific encryption key derived from the installation code using the MMO hash function, as indicated by the Key Identifier field present at the data link, and is processed only by the owner of this key. This message flow is shown in . The Registration process flow includes the following steps: the HAN device  automatically enters a state ready to accept Registration commands from the Inter-PAN server (i.e., UESI)  when it is first powered-on (e.g. the Installer  plugs in an Inter-PAN client, e.g., IHD, into the wall socket for the first time). The Installation Code and MAC Address are provided by OOB methods to the Utility HES , S (e.g. using an Internet consumer portal or a Call Center). The Installation Code is defined in section \u201c5.4.8.1 Out of Band Pre-Configured Link Key Process\u201d of the SEP Document. More specifically, during manufacturing, each client may provide a random Installation Code (unique per device for each vendor). This code is configured into the device, either as-is or through its MMO Hash, depending on the capabilities of the device, which will be required to (calculate and) use the MMO Hash to decrypt and authenticate registration messages directed to it as described herein. Additionally, the Installation Code is also provided, e.g., as a label on the packaging of each client device to facilitate the Registration process, where this code is presented out-of-band to the management tools that support provisioning it to the meter. The meter uses the stored Installation Codes to on-the-fly calculate the Pre-configured Link keys that are required to encrypt its Registration messages to specific clients.","The Utility HES first configures the Shared Link Key into the UESI (not shown). For each HAN device that is Registered, the Utility HES must also send the MAC Address and MMO Hash of the Installation Code to the UESI (not shown); alternatively the HES can send the Installation Code to the UESI where the MMO Hash is calculated S. For each HAN device the UESI encrypts a Registration message using each client's MMO Hash, and then transmits it to the clients MAC Address and clients default PAN-ID, on all IEEE 802.15.4 channels S. The Inter-PAN client locates the preconfigured link key that was pre-installed during manufacturing or calculates it via the MMO hash of its own Installation Code and uses that to decrypt the Registration message S. Only the associated client that is able to authenticate and decrypt the received Registration message can receive the Shared Link key which is required to process Application messages.","Upon successful decryption of the Registration message, the Inter-PAN client immediately sets the PAN ID using the value specified in the Registration message. Pursuant to Table 9, an indicator may be set so that a user (e.g. homeowner or installer) knows that the device is registered S. Then, the Inter-PAN client uses the Channel Mask field provided by the Inter-PAN server to select an available channel to receive its messages. This field represents a bitmap of channels that the server will broadcast SE Information messages on. The Inter-PAN client must use one of the enabled channels listed in the Channel Mask field. The Channel Mask field is a bit field of 15 bits where the least significant bit represents the channel 11. For example, if the Channel Mask value is represented in hexadecimal by the value Ox20D8 or in binary by the value 0010 0000 1101 1000, then the following channels are safe to listen on: 14, 15, 17, 18 and 24. Further to channel selection processes, in a particular embodiments, a UESI may have the ability to calculate the optimal Channel Mask field and PAN ID which will be provided to the Inter-PAN clients along with the Shared Link key to be used for Application messages. The optimal Channel Mask field excludes all channels which should not be used by the UESI's communications and thus indicates to the Inter-PAN clients which channels they should not listen on.","Since the one-way communication model does not allow for acknowledgement or confirmation of receipt of transmitted messages, if a listening device misses a message, the embodiments described herein do not provide a mechanism for the UESI to track the success of each transmission and resend messages as needed. As described herein, when a device is unable to hear Application messages for a preconfigured period, it times-out and returns to its Commissioned & Registering state, ready to accept Registration messages from the Inter-PAN server. Registration messages are periodically transmitted at intervals as configured in the UESI. With this mechanism in place, a client that misses an update is able to re-sync, simply by listening to the next available Registration message. Registration messages also include three parameters that inform the clients of message transmission periods set by the server: Publish Price Message Period, Energy Usage Message Period, and Registration Message Period. These parameters can be used by a client for optimization purposes, e.g., a sleepy client can be programmed to synchronize its wake times with these periods.","Alternatively, in a specific implementation, UESI supports a configurable time period parameter for Registration messages, wherein a user at the HES can modify the broadcast time period parameter of the UESI, and then use the AMI network to send the update to the UESI. Further still, an on-demand feature may be provided through the HES to invoke an asynchronous Registration message. The HES user interface supports a button for each registered device to immediately invoke a Registration message to that device. This is in addition to the configurable periodic broadcast of the Registration messages. This on-demand feature is integrated to facilitate installation and troubleshooting of a device.",{"@attributes":{"id":"p-0079","num":"0078"},"figref":"FIG. 8","b":["10","15","15","15","10"],"i":["a","b","n"]},"Periodic repetition of registration messages works to avoid the need for out-of-band re-registration, should a device miss a critical update. Per , messages are transmitted on all channels, repeated over a preconfigured interval for each registered node, and secured via their respective pre-configured Link keys (i.e., MMO hash of pre-configured Installation codes). Whenever re-registration is required, the UESI will immediately send the new Registration messages, thereby restarting the inter-message intervals, repeating the new values until new changes are needed. From a device perspective, whenever it gets out of sync with these parameters, it times out and waits for the next Registration message protected with its own encryption key derived from the Installation code using MMO hash function. In order to de-register a device, the server does the following: sends a Registration message with Shared Link key=0x0000 (all zeros) to that device, causing it to reset its registration state (optional step); sends an updated Shared Link key to the remaining clients; removes the pre-configured Link key of the de-registered client from its registration table.","Once registered, a client device is capable of receiving smart energy (SE) Application messages transmitted from the UESI on selected channels. A registered client device shall receive all SE Application messages, i.e., there is no selective registration required for published pricing or energy usage messages. Upon receiving an SE Application message, the client device will read the Destination MAC (D-MAC) Address. If the D-MAC Address is the client device's own MAC Address, the client device shall process the message with the devices PLK. If the D-MAC Address is the broadcast short MAC Address, the client device shall process the message with the SLK.","Using the systems and processes described herein, the UESI may send at least the following infoimation to all Inter-PAN clients: Electricity price using the Publish Price Command in the Price Cluster and Energy usage using the Simple Metering Cluster server attributes.","Referring to , the registration and subsequent communication processes and intervals pursuant to an exemplary embodiment wherein the UESI  is part of the utility meter as shown. In this example, target device (Inter-PAN devices) is not yet available to receive registration messages, target devices are available to receive registration messages (R) and target devices are registered and available to receive published price (P) and energy (E) application messages. The time (T) is indicated and an exemplary table of time intervals is also shown representing the interval between clusters of Registration messages.","In an alternative approach to support a registration, the UESI sends the registration messages on a single, e.g., channel X (or a few) channel(s) as compared to all, and the registering clients scan all or a subset of channels for registration messages sent to their own MAC addresses. Once a client finds such a registration message it retrieves the SLK and Channel mask, and the process proceeds as described. A benefit of this approach is that is can significantly reduce the traffic associated with registration messages (e.g., down to 1\/16) that are periodically repeated. (See ).","Further still, in another alternative embodiment, all communications (i.e., both registration and application messages) are supported on the same channel and the channel mask is not needed. When a UESI needs to change channels, the UESI starts using the new channel. The clients eventually time out when they stop receiving messages on the original channel and start scanning again, hunting for their registration messages. (See ).","While descriptions above detail a process for distributing a single SLK, in an alternative embodiment, multiple SLKs could be used to extend to multiple groups of target devices to confidentially send different smart energy information to devices within a premise. For example, referring to , two sets of target devices on a single HAN can be addressed individually and receive different sets of energy information by the UESI  in accordance with different SLKs and\/or different PAN IDs. In this example, SET  includes the refrigerator and theimostat and is established for energy data push from the UESI  using either SLK or PAN IDI, whereas SET  includes the wash machine and server and is established for energy data push from the UESI  using either SLK or PAN ID.","Referring to , an alternative embodiment to the one-way communication system describer with respect to the is shown. In , the UESI  provides secure smart energy information to a registered target device , indirectly via an intermediate energy information server IEIS  (e.g., a full function HAN device). The UESI  communicates with the IEIS  via a secure two-way HAN and provisions it to communicate with the target device  on its behalf. Using two-way secure Inter-PAN, the HAN device requests data from a meter by first contacting the meter via a beacon request. Once it locates the meter, it then requests data via an Inter-PAN message, which is then provided by the meter in response. The benefit of this architecture is that it provides extended coverage via the HAN, as Inter-PAN is limited to a single hop. The IEIS  thus extends the reach of the UESI  and provides a secure way of distributing smart energy information to one-way target devices.","The embodiments described to this point have generally been directed to one-way secure communications or combinations of one-way and two-way secure communications. and illustrate systems wherein secure two-way communications are implemented. More particularly, as shown in , a smart energy device , e.g., IHD or meter, communicates wirelessly with a field tool using secure two-way Inter-PAN, e.g., ZigBee. In this configuration, the Field Tool  is able to ascertain information from the smart energy device  to determine the need for and initiate operation, maintenance and configuration interactions as needed.","Referring to , the underlying communications from Field Tool  to an UESI  are two-way secured Inter-PAN, but the data flow from the UESI  to the HAN device  is one-way. The field tool first establishes a secure two-way Inter-PAN connection with the UESI which serves as a proxy, and in turn establishes a secure connection with the Smart Energy device via standard ZigBee security procedures.","The ability to add a Field Tool in an ad hoc fashion using the processes described herein avoids the requirement that the Field Tool actually join the HAN in order to communicate with a target device. This process can be expanded to other ad hoc device such as smart phones which can use the processes to communicate with the target devices.","In accordance with the embodiments described above, there are both one-way and two-way processes for securing Inter-PAN communications. While these processes have underlying similarities, there are differences. The steps of the one-way process are generally outlined in which is described above. The steps of the two-way process are generally outlined in . In both scenarios, there is an authentication phase followed by a phase where both parties arrive at an SLK, which is then used to encrypt communications during the authorized session, and is valid until it times out. More particularly, for two-way Inter-PAN, mutual authentication is achieved via the Certificate Based Key Exchange (CBKE) S process as described in the SEP Document incorporated herein by reference. After mutual authentication and exchange of ephemeral data, both parties derive a shared link key S, the server verifies the client's MAC address versus a trusted list S and the SLK is used by both client and server to encrypt each message S. A prior art CBKE flow is illustrated in .","As shown in -, the secure Inter-PAN communications are utilized as part of a larger system. Referring to , in a specific example, the UESI  is hosted on an existing meter  at a customer location which communicates with the HES  through the NAN. This infrastructure enables secure over-the-air remote registration and key management via the HES, as well as locally from the field using radio-enabled communications with the meter (e.g., via USB adapter connected to field operator laptop ). More specifically, the HES supports a Web Services API to accept Installation Codes and MAC Addresses, one pair for each target client's registration (multiple per meter). The Installation Codes and MAC Addresses are stored at the HES and configured in the meters which use these to on-the-fly calculate the individual Pre-configured Link Keys to encrypt Inter-PAN Registration messages and forward them to targets using their individual MAC Addresses. The HES allows for the generation, storage, and distribution of SLKs (generally one per meter, but multiple possible in accordance with ). Keys are distributed over-the-air via the NAN. Additionally, the field computer  also supports the capability to accept an entered Installation Code and MAC Address and write it to the meter. Such configurations are synchronized with the HES, when it is part of the deployment.","The present embodiments support as an application message, the Publish Price message in the SEP Documents incorporated herein by reference. Table 10 is an exemplary application message format for Publish Price messages. Fields are listed in their order of transmission; the first field listed is transmitted first. All multi-bytes fields are encoded Least Significant Byte first (LSB).",{"@attributes":{"id":"p-0094","num":"0093"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"63pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 10"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":[{},{},"Description"]},{"entry":["Fields name","Data type","and value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ZigBee APS Header",{},{}]},{"entry":["APS frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Inter-PAN (11)"]},{"entry":["Delivery Mode","Bits 2 to 3","Unicast (00)"]},{"entry":["Security","Bit 5","True (1)"]},{"entry":["ACK request","Bit 6","False (0)"]},{"entry":["Extended Header Present","Bit 7","False (0)"]},{"entry":["Cluster identifier","2 bytes","Price (0x0700)"]},{"entry":["Profile identifier","2 bytes","ZigBee Smart"]},{"entry":[{},{},"Energy (0x0109)"]},{"entry":"Auxiliary Header"},{"entry":"Security control"},{"entry":["Security level","Bits 0 to 2","ENC-MIC-32 (101)"]},{"entry":["Key identifier","Bits 3 to 4","A data key(00)"]},{"entry":["Extended nonce","Bit 5","(0)"]},{"entry":["Frame counter","4 bytes"]},{"entry":"ZCL header"},{"entry":["Frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Command is"]},{"entry":[{},{},"specific to a"]},{"entry":[{},{},"cluster (01)"]},{"entry":["Manufacturer specific","Bit 2","False(0)"]},{"entry":["Direction","Bit 3","From the server(1)"]},{"entry":["Disable default response","Bit 4","True(1)"]},{"entry":["Transaction sequence","1 byte","Unique ID"]},{"entry":["number",{},"generated by the"]},{"entry":[{},{},"Inter-PAN server"]},{"entry":["Command identifier","1 byte","Identify (0x00)"]},{"entry":"ZCL payload"},{"entry":["Provider ID","Unsigned 32 bit Integer"]},{"entry":["Rate Label","Octet String"]},{"entry":["Issuer Event ID","Unsigned 32 bit Integer"]},{"entry":["Current Time","UTC Time"]},{"entry":["Unit of Measure","8 bits enumeration"]},{"entry":["Currency","Unsigned 16 bit Integer"]},{"entry":[{},"8 bit BitMap"]},{"entry":"Price Trailing Digit"},{"entry":"Price Tier"},{"entry":[{},"8 bit BitMap"]},{"entry":"Number of Price Tiers"},{"entry":"Register Tier"},{"entry":["Start Time","UTC Time"]},{"entry":["Duration In Minutes","Unsigned 16 bit Integer"]},{"entry":["Price","Unsigned 32 bit Integer"]},{"entry":["Price Ratio","Unsigned 8 bit Integer"]},{"entry":["Generation Price","Unsigned 32 bit Integer"]},{"entry":["Generation Price Ratio","Unsigned 8 bit Integer"]},{"entry":["Alternate Cost Delivered","Unsigned 32 bit Integer"]},{"entry":["Alternate Cost Unit","8 bits enumeration"]},{"entry":["Alternate Cost","8 bit BitMap"]},{"entry":"Trailing Digit"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The UESI supports time-of-use (TOU) rates and critical peak pricing events (CPP). It may receive information for Publish Price messages from the Utility HES, or possibly generate the messages using locally configured parameters. The UESI transmits price messages per the ZigBee Smart Energy Profile guidelines for the Publish Price Command when an update to the pricing information is available from the commodity (e.g., gas, electricity, water) provider. The UESI transmits price messages in pairs: the current price and then the next price. In the case of the Publish Price message related to the current price, the fields CURRENT TIME and START TIME are identical. In the case of the Publish Price message related to the next price, the field CURRENT TIME will be before the field START TIME. The UESI meter may have a real-time clock and use the UTC time shared across the AMI network to populate the field CURRENT TIME of the Publish Price message. The UTC time shared across the AMI network is provided by an NTP server via the HES. It is possible for HAN devices to approximately synchronize time with the UESI meter using the CURRENT TIME message field. The UESI transmits the price message as a broadcast addressed message on the IEEE 802.15.4 channels specified in the Channel Mask field (see ).","Since this UESI is based on a one-way model, there is a probability that a listening client may occasionally not successfully receive the price messages (since there is no mechanism to request retransmissions). Missing a Publish Price message update could potentially let a device use out of date price information for long periods of time. The UESI may therefore optionally transmit Publish Price messages periodically between changes in the price from when an update to the pricing information is available from the commodity provider. With this mechanism in place, a client that misses an update is able to re-synchronize, simply by listening to the subsequent periodic price message transmissions. As discussed above, in a specific implementation, the UESI supports a configurable time period parameter for price messages. The HES user interface allows the utility operator to modify the broadcast time period parameter of the UESI meter, and then use the AMI network to send the update to the UESI meter. The default time period parameter may be predetermined, e.g., 10 minutes.","The embodiments described herein assume that the HAN devices are able to manage Publish Price messages. In addition to requirements set forth in the SEP Document which is incorporated herein by reference, the embodiments require the HAN devices handle two instances of Publish Price messages. As described above, the first instance is related to current price and the second instance is related to next price. This approach gives more robustness to the system in the case the HAN device is missing a price update. In that case, the client must apply the next price at the appropriated time. Additionally, as described, the Publish Price message related to current price can be used to perform time synchronization, the HAN device needs to be able to handle the UTC to local time conversion.","The systems and processes described herein depict a mechanism for providing utility usage information. An exemplary message format for a meter cluster application message prepared by the UESI for an Inter-PAN device is illustrated in Table 11.",{"@attributes":{"id":"p-0099","num":"0098"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 11"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Fields name","Data type","Description and value"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ZigBee APS Header",{},{}]},{"entry":["APS frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Inter-PAN (11)"]},{"entry":["Delivery Mode","Bits 2 to 3","Unicast (00)"]},{"entry":["Security","Bit 5","True (1)"]},{"entry":["ACK request","Bit 6","False (0)"]},{"entry":["Extended Header Present","Bit 7","False (0)"]},{"entry":["Cluster identifier","2 bytes","Simple Metering"]},{"entry":[{},{},"(0x0702)"]},{"entry":["Profile identifier","2 bytes","ZigBee Smart Energy"]},{"entry":[{},{},"(0x0109)"]},{"entry":"Auxiliary Header"},{"entry":"Security control"},{"entry":["Security level","Bits 0 to 2","ENC-MIC-32 (101)"]},{"entry":["Key identifier","Bits 3 to 4","A data key(00)"]},{"entry":["Extended nonce","Bit 5","(0)"]},{"entry":["Frame counter","4 bytes"]},{"entry":"ZCL header"},{"entry":["Frame control","1 byte"]},{"entry":["Frame type","Bits 0 to 1","Command acts across"]},{"entry":[{},{},"the entire profile (00)"]},{"entry":["Manufacturer specific","Bit 2","False(0)"]},{"entry":["Direction","Bit 3","From the server(1)"]},{"entry":["Disable default response","Bit 4","True(1)"]},{"entry":["Transaction sequence number","1 byte","Unique ID generated"]},{"entry":[{},{},"by the Inter-PAN"]},{"entry":[{},{},"server"]},{"entry":["Command identifier","1 byte","Report attributes"]},{"entry":[{},{},"(0x0a)"]},{"entry":"ZCL payload"},{"entry":"CurrentSummationDelivered"},{"entry":["Attribute identifier","2 bytes","0x0000"]},{"entry":["Attribute data type","1 byte","Unsigned 48 bit"]},{"entry":[{},{},"Integer (0x25)"]},{"entry":["Attribute data","6 bytes"]},{"entry":"InstantaneousDemand"},{"entry":["Attribute identifier","2 bytes","0x0400"]},{"entry":["Attribute data type","1 byte","Signed 24 bit Integer"]},{"entry":[{},{},"(0x2A)"]},{"entry":["Attribute data","3 bytes"]},{"entry":"CurrentDayConsumptionDelivered"},{"entry":["Attribute identifier","2 bytes","0x0401"]},{"entry":["Attribute data type","1 byte","Unsigned 24 bit"]},{"entry":[{},{},"Integer (0x22)"]},{"entry":["Attribute data","3 bytes"]},{"entry":"PreviousDayConsumptionDelivered"},{"entry":["Attribute identifier","2 bytes","0x0403"]},{"entry":["Attribute data type","1 byte","Unsigned 24 bit"]},{"entry":[{},{},"Integer (0x22)"]},{"entry":["Attribute data","3 bytes"]},{"entry":"UnitofMeasure"},{"entry":["Attribute identifier","2 bytes","0x0300"]},{"entry":["Attribute data type","1 byte","8-bit Enumeration"]},{"entry":[{},{},"(0x30)"]},{"entry":["Attribute data","1 byte"]},{"entry":"Multiplier"},{"entry":["Attribute identifier","2 bytes","0x0301"]},{"entry":["Attribute data type","1 byte","Unsigned 24 bit"]},{"entry":[{},{},"Integer (0x22)"]},{"entry":["Attribute data","3 bytes"]},{"entry":"Divisor"},{"entry":["Attribute identifier","2 bytes","0x0302"]},{"entry":["Attribute data type","1 byte","Unsigned 24 bit"]},{"entry":[{},{},"Integer (0x22)"]},{"entry":["Attribute data","3 bytes"]},{"entry":"SummationFormatting"},{"entry":["Attribute identifier","2 bytes","0x0303"]},{"entry":["Attribute data type","1 byte","8 bit BitMap (0x18)"]},{"entry":["Attribute data","1 byte"]},{"entry":"DemandFormatting"},{"entry":["Attribute identifier","2 bytes","0x0304"]},{"entry":["Attribute data type","1 byte","8 bit BitMap (0x18)"]},{"entry":["Attribute data","1 byte"]},{"entry":"HistoricalConsumptionFormatting"},{"entry":["Attribute identifier","2 bytes","0x0305"]},{"entry":["Attribute data type","1 byte","8 bit BitMap (0x18)"]},{"entry":["Attribute data","1 byte"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The UESI uses the local meter data to generate the energy usage message. The UESI follows the Simple Metering server cluster guidelines as set forth in the SEP Document which is incorporated herein by reference. The UESI periodically transmits the energy usage message. A UESI may support a configurable time period. Once the end of the time period is met, the UESI generates and transmits an energy usage message, e.g., every 60 seconds. The UESI transmits the energy usage message as a broadcast addressed message on the IEEE 802.15.4 channels specified in the Channel Mask field.","The systems and methods described herein support \u201csilent\u201d joining via a commissioning or pre-provisioned method. All data required to enter the network is already provided to the node, i.e., client device, so that no joining procedure itself is required. A client device thus creates its own network and joins it. The client can enter the commissioning & registering state by using the silent join mode with default network and security parameters, and join the network as a router device. By way of example, the relevant default values are shown in Table 12 below:",{"@attributes":{"id":"p-0102","num":"0101"},"tables":{"@attributes":{"id":"TABLE-US-00014","num":"00014"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"91pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 12"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Parameter","Value","Comment"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Startup Control","0x00","0x00 means that the node will"]},{"entry":[{},{},"\u2018silently join\u2019 with the"]},{"entry":[{},{},"commissioned settings"]},{"entry":["PAN ID","CRC16 of its own MAC","This value will be overwritten"]},{"entry":[{},"Address","based on the PAN ID received"]},{"entry":[{},{},"in the Registration message"]},{"entry":["Channel","Randomly selected by","This value may be overwritten"]},{"entry":[{},"the application","based on the Channel mask"]},{"entry":[{},{},"received in the Registration"]},{"entry":[{},{},"message"]},{"entry":["Pre-configured","MMO Hash of the"]},{"entry":["Link key","configured Installation"]},{"entry":[{},"Code"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"The client then listens for a Registration message on the selected channel that is (1) sent to its own MAC address and default PAN ID, and (2) can be successfully processed with its own Pre-configured Link key. When it successfully decrypts this message, the client saves the server's MAC Address, and updates the PAN ID, channel mask, and Shared Link key, accordingly. At this point the client is capable of receiving and decrypting application messages.","Notice that if two clients end up on the same channel (with the same PAN ID), even though a PAN ID conflict is detected, it is not resolved because clients are not Coordinators and only the Coordinator (which is the Network Manager as well) can change the PAN ID of the network. (The client device will attempt to send a conflict report to the Coordinator, but because there is no Coordinator node nothing happens). Accordingly, multiple clients can co-exist on the same channel with the same PAN ID.","The embodiments described herein are intended to be exemplary. One skilled in the art will recognize variations thereof that are clearly with the scope of the embodiments described."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE FIGURES","p":[{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIGS. 1","i":["a ","e "],"b":"1"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIGS. 2","i":["a ","b "],"b":"2"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIGS. 4","i":["a ","b "],"b":"4"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 12"}]},"DETDESC":[{},{}]}
