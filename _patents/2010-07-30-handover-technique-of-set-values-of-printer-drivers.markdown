---
title: Handover technique of set values of printer drivers
abstract: A control method of an information processing apparatus in which a plurality of printer drivers for setting set values in setting items of print data to be output by a printing apparatus are installed, the method comprises: under the control of an operating system having a function of controlling the plurality of printer drivers to share set values set using the plurality of printer drivers, a setting item determination step of determining, upon switching of output target printing apparatuses between a plurality of printing apparatuses corresponding to the plurality of printer drivers, whether or not setting items according to a printing apparatus before switching and setting items according to a printing apparatus after switching include common setting items.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08482775&OS=08482775&RS=08482775
owner: Canon Kabushiki Kaisha
number: 08482775
owner_city: Tokyo
owner_country: JP
publication_date: 20100730
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENTS","First Embodiment","Second Embodiment","Third Embodiment","Other Embodiments"],"p":["1. Field of the Invention","The present invention relates to a handover technique of set values of printer drivers.","2. Description of the Related Art","Conventionally, some methods or inventions have been proposed in association with handling of print settings when the user switches printer drivers in an environment in which a plurality of printer drivers are installed in an information processing apparatus. When the user switches printer drivers on the information processing apparatus in which the plurality of printer drivers are installed, operations associated with print settings are different depending on operating systems (OSs). That is, for those operations multiple methods exist.","On certain OS's, printer drivers operate as independently. In this case, when the user switches a printer driver, print values of a printer driver set before switching are independent of those after switching. For this reason, when the user changes the print set values of the printer driver before switching, the altered print values are not reflected after the printer driver is switched. Japanese Patent Laid-Open No. 2003-131832 has proposed a method of handing over print settings upon switching printer drivers premised on the OS which performs such operation. In this invention, upon switching printer drivers, it is determined if the printer drivers before and after switching are of an identical type. If it is determined that these printer drivers are of the identical type, the print set values of the printer driver before switching are handed over intact to those after switching.","On another OS different from the aforementioned OS, once a printer driver is selected, the OS itself holds crossover print settings for a plurality of switchable printer drivers until a print job is complete or canceled later. When the user switches printer drivers, the OS intervenes to hand over the print settings of the printer drivers before and after switching, thus sharing the same settings.","A problem to be solved by the present invention is premised on a print system in which an OS (to be also referred to as a given OS hereinafter) holds crossover print set values for printer drivers, as described in the related arts.","In a scene in which after the user makes print settings on a certain printer driver, an output target printer is not a desired one of the user, and he or she switches printer drivers, there is a merit of this system. That is, in case of a print system in which an OS does not hold any crossover print settings for printer drivers (print settings of respective printer drivers are independent from each other), the user has to perform operations in order to set the same print settings again on a printer driver after switching. By contrast, in this system, since the print settings made on a certain printer driver are handed over to a printer driver after switching, there is a merit in that the user need not perform operations in order to set the same print settings again.","However, in this system, as for common print setting items to printer drivers before and after switching, when their default set values are different, this mechanism poses a problem in some cases. For example, a case will be examined below wherein in association with two printer drivers A and B which allow both monochrome and color settings, a default set value is \u201cmonochrome\u201d for driver A, and \u201ccolor\u201d for driver B. At this time, the user does not change the monochrome\/color setting before switching a printer driver. Under this precondition, when the user switches the printer driver from A to B, since the default set value of printer driver B is \u201ccolor\u201d, it is expected that the monochrome\/color setting is also switched to \u201ccolor\u201d. However, since the print settings of printer driver A are handed over, the monochrome\/color setting after switching to printer driver B is still \u201cmonochrome\u201d.","The user can name and save a combination of setting items and set values of print settings in advance, and such a combination is called a preset. When the user sets a preset, he or she can easily perform an output operation using print settings which are defined in advance. However, when the user switches printer drivers after he or she sets a preset, some settings of the preset are invalidated in some cases. For example, a case will be examined below wherein a monochrome\/color setting in a certain preset is \u201ccolor\u201d, printer driver A allows to select both monochrome and color settings, and printer driver B is exclusive for a monochrome setting. In this case, when the user applies that preset to printer driver A first, the monochrome\/color setting is \u201ccolor\u201d, which follows the user's intention. In this situation, a case will be examined below wherein the user switches the printer driver to B, and then returns it to A later. When the user switches the printer driver to B, the monochrome\/color setting is forcibly set to be \u201cmonochrome\u201d, and even when the user returns the printer driver to A later, that monochrome setting is unwantedly handed over. For this reason, although the preset is intended to color printing, if the user executes a print operation in that state, a monochrome image is output.","That is, when the user repetitively switches printer drivers without changing settings, unexpected print settings may be made.","As described above, when print settings are handed over between different printer drivers according to the specification of the given OS, a print operation may be made to have settings against the user's intention or the user has to carefully confirm and reset set values of respective setting items, thus causing a disadvantageous situation. As a result, usability and efficiency are impaired.","The present invention solves the aforementioned problems in an environment in which a given OS holds crossover print settings for printer drivers.","According to one aspect of the present invention, there is provided a control method of an information processing apparatus in which a plurality of printer drivers for setting set values in setting items of print data to be output by a printing apparatus are installed, the method comprising: under the control of an operating system having a function of controlling the plurality of printer drivers to share set values set using the plurality of printer drivers, a setting item determination step of determining, upon switching of output target printing apparatuses between a plurality of printing apparatuses corresponding to the plurality of printer drivers, whether or not setting items according to a printing apparatus before switching and setting items according to a printing apparatus after switching include common setting items; a set value determination step of determining, in association with the common setting items determined in the setting item determination step, whether or not default set values in the printing apparatus before switching match set values set upon switching of the printing apparatuses; a handover step of handing over the set value set upon switching of the printing apparatuses in association with the setting item which is determined in the set value determination step that the set value of the setting item does not match the default set value; and a setting step of setting a default set value in the printing apparatus after switching in association with the setting item which is determined in the set value determination step that the set value of the setting item matches the default set value.","According to another aspect of the present invention, there is provided a control method of an information processing apparatus in which a plurality of printer drivers for setting set values in setting items of print data to be output by a printing apparatus are installed, the method comprising: under the control of an operating system having a function of controlling the plurality of printer drivers to share set values set using the plurality of printer drivers, a storage step of storing a preset which defines, in advance, print setting items and set values to be set in the print data; a preset setting item determination step of determining, upon switching of output target printing apparatuses between a plurality of printing apparatuses corresponding to the plurality of printer drivers, whether or not setting items according to a printing apparatus after switching and setting items included in the stored preset include common setting items; and an overwriting step of overwriting set values of the common setting items determined in the preset setting item determination step by the set values in the preset.","According to another aspect of the present invention, there is provided an information processing apparatus in which a plurality of printer drivers for setting set values in setting items of print data to be output by a printing apparatus are installed, the apparatus comprising: under the control of an operating system having a function of controlling the plurality of printer drivers to share set values set using the plurality of printer drivers, a setting item determination unit which determines, upon switching of output target printing apparatuses between a plurality of printing apparatuses corresponding to the plurality of printer drivers, whether or not setting items according to a printing apparatus before switching and setting items according to a printing apparatus after switching include common setting items; a set value determination unit which determines, in association with the common setting items determined by the setting item determination unit, whether or not default set values in the printing apparatus before switching match set values set upon switching of the printing apparatuses; a handover unit which hands over the set value set upon switching of the printing apparatuses in association with the setting item which is determined by the set value determination unit that the set value of the setting item does not match the default set value; and a setting unit which sets a default set value in the printing apparatus after switching in association with the setting item which is determined by the set value determination unit that the set value of the setting item matches the default set value.","According to another aspect of the present invention, there is provided an information processing apparatus in which a plurality of printer drivers for setting set values in setting items of print data to be output by a printing apparatus are installed, the apparatus comprising: under the control of an operating system having a function of controlling the plurality of printer drivers to share set values set using the plurality of printer drivers, a storage unit which stores a preset which defines, in advance, print setting items and set values to be set in the print data; a preset setting item determination unit which determiners, upon switching of output target printing apparatuses between a plurality of printing apparatuses corresponding to the plurality of printer drivers, whether or not setting items according to a printing apparatus after switching and setting items included in the stored preset include common setting items; and an overwriting unit which overwrites set values of the common setting items determined by the preset setting item determination unit by the set values in the preset.","According to the present invention, even in an environment in which the given OS is used, print settings can be flexibly handed over to reflect the user's intention associated with the print settings upon switching output target printers.","Further features of the present invention will become apparent from the following description of exemplary embodiments (with reference to the attached drawings).","The best mode for carrying out the present invention will be described hereinafter using the drawings.","[System Arrangement]",{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 1","b":["104","101","102","103","101","101","102","103"]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 2","FIG. 2","FIG. 1"],"b":["101","201","101","203","204","205","206","207","208","209","210","211","212","213","201","206","207","201","214","208","201","215","209","216","210","104","211"]},"Normally, an initial program required to activate the client computer , and a basic program required to control respective modules of the client computer  are saved in the ROM . Also, the OS, applications, and printer drivers are saved in the external storage device . When the power switch of the client computer  is turned on, a program (boot loader) which is saved in the ROM  and is required to activate the computer is executed. That program loads the OS saved in the external storage device  onto the RAM , and then passes a control right to the OS. The OS further loads required modules and drivers from the external storage device  onto the RAM . Also, the OS loads a required application from the external storage device  onto the RAM  in response to a user instruction, and executes the loaded program. Printer drivers and their installers to be described in this embodiment are provided using external media such as CD-ROMs, each of which is set in the external media reader . Then, the CPU  loads such printer driver or installer into the RAM  or saves it in the external storage device  as needed. The OS used as a condition in the present invention includes, for example, \u201cMac OS X\u201d (trademark) available from Apple.","[Printer Driver Installation and Print Queue Registration]","A printer driver will be described below with reference to . The printer driver includes modules, as shown in . A printer driver  includes a graphic rendering module , UI control module , printer specification description file , color processing module , and input\/output control module . Note that the present invention is not limited to such specific configuration, and the printer driver may include other modules depending on its function.","The printer driver has some generation methods. For example, in one method, in order to support a plurality of printers by a single printer driver, the graphic rendering module  and UI control module  are generated to be able to support the plurality of printers. The printer specification description file  is supplied with a printer driver in accordance with a printer to be supported. In this method, the UI control module  displays or controls a UI in correspondence with the printer specification description file . The graphic rendering module  is configured to issue a page description language and printer control commands in correspondence with each printer.","The sequence for installing the printer driver with the above configuration in the client computer  will be described below with reference to . Assume that the user prepares a storage medium such as a CD-ROM which stores a printer driver, or acquires a printer driver installer via the network. In step S, the user launches the acquired printer driver installer. In response to this action, the installer stores printer driver modules at a predetermined location of the external storage device in step S. Storage locations are different depending on print systems. For example, a CUPS (Common Unix Printing System) is set to store printer driver modules for respective vendors under the following directory:","\/Library\/Printers\/","Furthermore, printer drivers can be stored in correspondence with their types under the directory for each vendor. For example, when different printer drivers PDL1 and PDL2 of vendor \u201cABC\u201d are available, the following directories are created, and these printer drivers can be stored under these directories.","\/Library\/Printers\/ABC\/PDL1\/","\/Library\/Printers\/ABC\/PDL2\/","In step S, the installer stores printer driver modules under the aforementioned directory in the external storage device . The installation of the printer driver is complete. However, in order to output data using a desired printer in practice, the user has to register a print queue corresponding to the desired printer using a program which is provided by, for example, the OS and is required to register a print queue.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 5"},"In step S, the user opens a printer registration dialog  required to register a print queue. In this step, the OS reads out a program code for printer registration from the external storage device  onto the RAM , and executes the readout program.  shows an example of a user interface (to be abbreviated as a UI hereinafter) of the printer registration dialog displayed by the OS. This dialog includes a registered print list  used to display a list of printers, print queues of which are currently registered, and a print queue detailed display area  used to display detailed information of a printer selected on the registered print list . Also, the dialog includes a print queue add button  used to add a new print queue, a button  used to delete a print queue currently selected on the registered print list , and a button  used to close this dialog.","In step S, the user clicks the print queue add button  on the printer registration dialog . In response to this user operation, the OS displays an add printer dialog  in step S. The user enters required information in the add printer dialog  in step S to add a printer.  shows an add printer dialog displayed by the OS. The add printer dialog  includes a setting field  used to designate a network address (an IP address in this example) of a connected printer, a setting field  used to input a name required to identify a print queue, and a setting field  used to input an installation location of the printer. The name  and printer location  include character strings used when they are displayed on the registered print list  and print queue detailed display area  of the printer registration dialog. The add printer dialog  also includes a setting field  used to designate a printer driver used upon registration of a print queue. Note that the configuration of the add printer dialog  shown in  is an example, and additional information (for example, information of a license key) may be input as needed. The registered print queue is displayed in the registered print list shown in . In the setting field , the OS lists up printer drivers stored under the printer driver storage directory (\/Library\/Printers\/) of the OS described above.","The example of  shows a state in which the user inputs an IP address \u201c192.168.1.10\u201d, a printer name \u201cPrinterC\u201d, and a printer location \u201c2F\u201d, and selects a printer driver \u201cABC PDL1\u201d. When the user clicks the add button  in this state, the OS adds a print queue. As a result, a new printer is additionally registered as an available printer. When the user wants to close this dialog without adding any printer, he or she clicks a button .","In step S, the OS registers the print queue designated by the user and the printer specification description file in the system. This step will be described in detail below using .",{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIG. 7","FIG. 7","FIG. 5"],"b":["803","302","805","303","804","305","808","306","806","304","807","803","808","809","810","811"]},"In step S, an OS  acquires information input to the add printer dialog , and executes print queue registration processing. This registration is executed as follows. Descriptions of  shows a file which describes information of a print queue to be registered, and is described in a markup language. A line  indicates an identifier of the print queue, which is described by tying a printer name and printer address by an underscore. Lines  and  respectively describe a printer name and location. Furthermore, a line  includes a description of an address of the print queue, and indicates to transmit data to an address \u201c192.168.1.10\u201d via the 1pd protocol in this example. A line  describes a printer driver name (ABC PDL1 in this case) used by this printer. A line  corresponds to the line , and indicates the end of the description. The OS creates this description file in step S, and additionally records this printer registration information in a predetermined file in the external storage device . As this predetermined file, for example, the OS describes information in a printers.conf file stored under a \/etc\/cups\/ directory in the CUPS (Common Unix Printing System). This is the print queue registration information . When a plurality of print queues are registered, the printers.conf file repetitively includes descriptions of  corresponding to respective printers for respective print queues.","In step S, the OS then registers the printer specification description file in the system. In , the OS  acquires the printer specification description file  of the printer to be registered from the UI control module of the printer driver, and then registers a generated printer specification description file  at a predetermined location of the system.","Prior to the description of the registration method of the printer specification description file , the printer specification description file will be explained. Descriptions of  shows an example of the printer specification description file. This file is described according to a specification description format of the printer. The file will be described below based also on the format.","A line  describes a comment. The comment includes \u201c*%\u201d at the line head. A line  describes a vendor name. A line  describes a printer name supported by this printer specification description file. A line  describes a page description language supported by this printer specification description file. A line  describes a version of the printer driver. A line  and subsequent lines describe function specifications of this printer. In the function specifications, one function is defined in lines  to .","The line  includes a function name with a prefix \u201c*\u201d after \u201c*OpenUI\u201d, and a type of a print set value used upon selecting the function, which is delimited by \u201c:\u201d after the function name. The type of the print set value includes \u201cPickOne\u201d and \u201cBoolean\u201d. \u201cPickOne\u201d expresses a function of selecting one from options. \u201cBoolean\u201d expresses that this function is controlled by On\/Off.","The line  expresses that a function \u201c*PageSize\u201d is available, and is to select one from options. A line  describes a default set value (to be referred to as a default value hereinafter) of this function. This line starts with \u201c*Default\u201d, and the function name defined in the previous line  is appended after \u201c*Default\u201d. This line indicates that the default value of the function \u201cPageSize\u201d is \u201cA4\u201d. From the line  until \u201c*CloseUI\u201d in a line , each of options of this function is described per line. For example, a line  expresses that \u201cA3\u201d is available as one of options of \u201cPageSize\u201d. Note that these lines describe the function of selecting a page size, and since there are many options of the page size, descriptions of some options are not shown. A last description of this function is the line , which describes the function name described in \u201c*PageSize\u201d after \u201c*CloseUI\u201d. These lines express one function.","Subsequently, lines  to  include descriptions of another function. A repetitive description will be avoided. This block expresses that a function \u201cDuplex\u201d is available, and is to select one of options (PickOne), which include \u201cNone\u201d, \u201cSimplex\u201d, and \u201cDuplex\u201d. In practice, this expresses a duplex print designation function: \u201cNone\u201d follows a default setting of the printer without any designation; \u201cSimplex\u201d means simplex printing; and \u201cDuplex\u201d means duplex printing.","The method of registering this printer specification description file by the OS will be described below. The OS acquires this printer specification description file  corresponding to the printer from the UI control module , and stores it at a predetermined location of the system.  shows the storage location and that file. The storage location is under a \/etc\/cups\/ppd\/ directory in the external storage device , and the stored file has a file name obtained by appending the printer name and printer address which are tied by an underscore. For example, a printer specification description file added in this case is \u201cPrinterC192.168.1.10_.ppd\u201d in a line .  indicates that the OS  stores the printer specification description file in the printer specification description file . With the aforementioned steps, the registration of the print queue is complete.","[Print Queue and Preset Settings]","The print queue and preset settings will be described below.  shows a screen associated with print settings of the registered print queue. This screen is a dialog displayed when the user selects a menu \u201cprint\u201d included in, for example, a file menu of an application .","On a print setting dialog , the system commonly provides setting fields  to . This dialog allows the user to select an output target printer (print queue) and a preset (to be described later), to set the number of copies, and to designate a paper size as basic functions. Also, the user can additionally set functions unique to each of various printers. When the printer includes many functions, all the functions are not displayed at the same time, but a function group is switched using a setting field . This dialog shows a display state of functions related to \u201cfinishing\u201d. The finishing related functions include a simplex\/duplex designation in a setting field , a staple designation in a setting field , and a booklet print designation in a setting field . Note that the present invention is not limited to the functions listed in this case, but various other functions are available and can be selectively displayed by designating another group using the setting field . Also, the present invention is not limited to the configuration of the dialog shown in , and setting items may be added or deleted as needed.","When the user wants to switch an output destination printer on the print setting dialog , he or she switches a printer using a print selection setting field . On the print setting dialog , a print queue \u201cPrinterA\u201d is currently selected. When the user selects, for example, \u201cPrinterB\u201d from this setting field , a print queue \u201cPrinterB\u201d is selected on this dialog. When the user clicks a print button  in this state, print data is output to \u201cPrinterB\u201d.","Default settings and a preset saved by the OS will be described below. Descriptions of  shows a file which saves a print queue (printer) selected as a default. Lines  and  include descriptions indicating a default print queue. The print queue selected as a default is described within these tags using a key \u201cDefaultPrintQueue\u201d, and a line  indicates that \u201cPrinterA\u201d is selected. Note that this file is saved to have a file name \u201cdefaultprinter.plist\u201d under the following directory, since it is saved for each user (in case of a user name \u201cUSER_A\u201d).","\/Users\/USER_A\/Library\/Preferences\/","Descriptions of  shows a file which saves setting contents of a preset. The preset is used to save print settings frequently used by the user to have a specific name. For example, assume that default settings of a certain print queue include \u201csimplex\u201d and \u201c1-up print\u201d. When the user frequently uses \u201cduplex\u201d and \u201c2-up print\u201d, he or she sets \u201cduplex\u201d and \u201c2-up print\u201d by opening the print setting dialog , and saves these settings as a preset by giving an appropriate name. When the user wants to use these settings, he or she selects the saved preset in a preset selection setting field , thus reproducing the saved settings. The setting and saving processes of this preset will be described below.","In the descriptions of , setting contents of a plurality of presets are described between \u201cCustomPresetList\u201d tags described in correspondence with lines  and . One preset is described within \u201cPresetSettings\u201d tags, as described in lines  and . Note that a preset name is described as a parameter of \u201cPresetSettings\u201d. The lines  and  describe that the preset indicated by these lines has a preset name \u201cStandard\u201d and setting contents of this preset are \u201cNULL\u201d. The preset description file shown in the descriptions of  describes another preset, that is, a preset with a name \u201cPreset1\u201d described in lines  to . The setting contents of this preset are described in lines  to . The line  indicates ColorMode=\u201cColor\u201d, the line  indicates Duplex=\u201cSimplex\u201d, and the line  indicates Resolution=\u201c600\u201d. A line  indicates LastQueue=\u201cNULL\u201d. Note that an identifier \u201cABC.\u201d is appended in front of each item. This identifier is appended to distinguish respective setting items for respective vendors since the presets are managed by the OS and are used common to each vendor. As described above, the types and setting contents of presets can be revealed by this preset description file.","Descriptions of  shows a file that shows a default preset. Assume that this file is saved as \u201cdefaultpreset.plist\u201d under the same \/Users\/USER_A\/Library\/Preferences\/ directory as that of the file shown in the descriptions lib of . A default preset is described between \u201cPresetInfo\u201d tags in lines  and . The descriptions of  indicates that a preset with a name \u201cPreset1\u201d is selected as a default, as described in a line .","Descriptions of  shows print settings held by the OS. These settings are saved in the RAM  for each application process, and are exchanged with the print queue via an API (Application Programming Interface) of the OS. In the descriptions of , print setting contents are described between lines  and . Within \u201cCurrentPrintQueueInfo\u201d tags in lines  and , the currently selected print queue is described. As can be seen from a line , a print queue \u201cPrinterC\u201d is described, and is currently selected. Within \u201cCurrentPresetInfo\u201d tags in lines  and , a currently selected preset is described. As can be seen from a line , a preset \u201cStandard\u201d is described, and is currently selected. Between lines  and , currently set print settings are described. Since the description method is the same as that of the print settings of each preset shown in the descriptions of , a description thereof will not be given. The OS builds up the print settings shown in the descriptions of  for each application process. With the above processes, the printer drivers share information under the control of the OS having the input\/output function of printing items and set values.","[Sequence of Print Processing]","The sequence when the user performs a print operation will be described below.  are flowcharts showing print processing.","When the print processing starts, the system (OS) acquires a default print queue and default preset with reference to the file shown in the descriptions of , which saves the print queue selected as a default, and that shown in the descriptions of , which indicates the default preset (S). The system describes the acquired print queue and preset in the print settings shown in the descriptions of  (S). The system determines if the default preset is \u201cStandard\u201d (S). Note that \u201cStandard\u201d does not indicate any specific preset, but it means that no preset is designated. If the default preset is \u201cStandard\u201d (YES in step S), the system acquires default values in the default print queue with reference to the printer specification description file shown in the descriptions of  (S). The system describes the acquired values in the print settings shown in the descriptions of  as current settings (S).","On the other hand, if the default preset is not \u201cStandard\u201d (NO in step S), the system acquires values of the default preset with reference to the file shown in the descriptions lib of , which saves the setting contents of the preset (S). Then, the system describes the acquired values in the print settings shown in the descriptions of  as current settings (S).","After the print settings to be displayed first are built, the system displays the print setting dialog  shown in  based on these print settings (S). After the print setting dialog  is displayed, the system accepts an arbitrary print setting change instruction from the user (S). This process implements a first acceptance step. In step S, the system accepts a print queue re-selection instruction in addition to a set value change instruction of the print settings, and displays a setting screen based on setting items and set values after switching. Handover processing of set values before and after switching of the print queue will be described in detail later using .","After that, the system determines based on a user instruction whether or not to execute print processing (S). If it is determined that the print processing is executed (YES in step S), the system executes the print processing based on the print settings (S). Then, the system updates the file shown in the descriptions of  indicating the default preset by the preset at that time (S). The system then discards the print settings, and closes the print dialog (S). On the other hand, if the print processing is not executed, and is canceled (NO in step S), the system discards the print settings, and closes the print dialog (S).","[Print Setting Handover Method]","How to hand over the print settings when the user switches the print queue on the print setting dialog  in step S in , which technique is especially a characteristic feature of the present invention, will be described below.",{"@attributes":{"id":"p-0084","num":"0083"},"figref":"FIGS. 13A and 13B"},"Print queue related processing will be described first.","In step S, the system accepts a print queue switching instruction from the user via the print queue selection setting field  in . In step S, the printer driver of the print queue selected so far describes information of the print queue before switching in the corresponding line  in the print settings shown in the descriptions of .","After that, the system launches a printer driver of a print queue after switching in step S. At this time, the system updates information in the line  indicating the print queue in the descriptions of . As for other print settings, set values before switching of the print queue are handed over intact.","In step S, the printer driver acquires setting items of the print queue after switching with reference to the printer specification description file (the descriptions of ) of the print queue after switching. In step S, the printer driver compares the setting items of the print queue before switching with those of the print queue after switching, and determines whether or not common setting items are included. This process implements setting item determination processing.","If it is determined that common setting items are included (YES in step S), the printer driver acquires default values of the print queue before switching with reference to the printer specification description file (the descriptions of ) of the print queue before switching in step S. Note that the information of the print queue before switching can be obtained with reference to the line  of the print settings shown in the descriptions of . In step S, the printer driver compares the default values of the print queue before switching with the current set values in association with common items.","Note that the \u201ccurrent set values\u201d mean set values of respective setting items which are set in the print queue before switching at the time of switching. This process implements set value determination processing.","As a result of comparison of the set values, if a setting item whose default value does not match the current set value is included (NO in step S), the printer driver hands over the current set value intact in association with the setting item whose default value does not match the current set value in step S. Then, the printer driver updates, for the setting items other than that whose default value does not match the current set value, the corresponding fields of the print settings in the descriptions of  by the default values of the print queue after switching with reference to the printer specification description file (the descriptions of ) of the print queue after switching. Note that the information of the print queue after switching can be obtained with reference to the line  as the corresponding field in the print settings. The process then advances to step S.","If NO in step S, or if YES in step S, the printer driver updates the print settings by the default values of the print queue after switching in step S. After that, the process advances to step S.","Preset related processing will be described below. In step S, the printer driver acquires the current preset with reference to the line  in the print settings shown in the descriptions of . The \u201ccurrent preset\u201d means a preset which is held by the OS, and is set to be applied in the corresponding printer driver. The printer driver determines in step S if the current preset is \u201cStandard\u201d. This process implements a preset determination step.","If it is determined that the current preset is not \u201cStandard\u201d (NO in step S), the printer driver acquires print settings of the current preset with reference to the preset description file shown in the descriptions of  in step S. In step S, the printer driver compares the setting items of the print queue after switching with those of the current preset to determine if common setting items are included. This process implements preset setting item determination processing.","If common setting items are included (YES in step S), the printer driver overwrites and updates the corresponding fields of the print settings shown in the descriptions of  by the set values of the current preset acquired in step S in association with the common print setting items in step S. If YES in step S, or if NO in step S, the printer driver skips the preset related processing, and the process jumps to step S.","In step S, the printer driver updates, by \u201cNULL\u201d, the line  corresponding to the information of the print queue before switching in the print settings shown in the descriptions of .","[Practical Handover Example of Set Values]","The aforementioned handover method will be explained below using practical examples of print queues and presets.  show preconditions associated with the print queues and presets in this case.","Referring to , assume that as print queues, \u201cPrinterA\u201d as a print queue , \u201cPrinterB\u201d as a print queue , and \u201cPrinterC\u201d as a print queue  are registered.  shows print settings of respective print queues and set values which can be set in respective items. Note that underlined items in  mean default values. That is, for \u201cPrinterA\u201d, \u201cMono\u201d or \u201cColor\u201d is selectable as a ColorMode item, and its default value is \u201cColor\u201d. Also, \u201cSimplex\u201d or \u201cDuplex\u201d is selectable as a Duplex item, and its default value is \u201cSimplex\u201d. \u201c600\u201d or \u201c1200\u201d is selectable as a Resolution item, and its default value is \u201c1200\u201d. A set value of a LastQueue item is not displayed on the print dialog (), and its initial value is \u201cNULL\u201d. Also, the print settings and set values of \u201cPrinterB\u201d and \u201cPrinterC\u201d are as described in the table in .","Note that  shows some of the functions of printers, and functions to be handed over are not limited to these functions.","On the other hand, as for settings associated with presets, \u201cStandard\u201d and \u201cPreset1\u201d are registered, as shown in . \u201cStandard\u201d as a preset  is a standard preset, and includes set values \u201cNULL\u201d for all print settings.","On the other hand, \u201cPreset1\u201d as a preset  includes ColorMode=\u201cColor\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cNULL\u201d.","A case will be examined below wherein the user opens the print setting dialog  by selecting \u201cprint\u201d from a menu of an application, and changes print settings for the purpose of processing of the following cases under the above preconditions. Note that the cases to be described below are merely examples, and do not limit setting items, set values, and description formats.","[Case 1]\n\n","The sequence for handing over set values of this case 1 will be described below along .","In step S, the system accepts a switching instruction from \u201cPrinterA\u201d as a default setting of the print queue to \u201cPrinterB\u201d from the user. In step S, the printer driver describes the print queue \u201cPrinterA\u201d before switching in the corresponding line  in the print settings shown in the descriptions of . After that, the system launches a printer driver of the print queue \u201cPrinterB\u201d after switching in step S. At this time, the system updates, by \u201cPrinterB\u201d, the line  associated with the print queue in the print settings shown in the descriptions of . Since set values before switching of other print settings are handed over intact, ColorMode=\u201cColor\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c1200\u201d, and LastQueue=\u201cPrinterA\u201d.","In step S, the printer driver acquires setting items of the print queue after switching with reference to the printer specification description file (the descriptions of ) of the print queue \u201cPrinterB\u201d after switching.","In step S, the printer driver compares the setting items of the print queue \u201cPrinterA\u201d before switching with those of the print queue \u201cPrinterB\u201d after switching to determine if common setting items are included. In this case, since common setting items are included, YES is determined in step S, and the printer driver refers to the printer specification description file (the descriptions of ) of the print queue \u201cPrinterA\u201d before switching in step S. Then, the printer driver acquires default values (set values of the print queue  shown in ) of the print queue \u201cPrinterA\u201d before switching.","In step S, the printer driver compares the default values of the print queue \u201cPrinterA\u201d before switching with the current set values in association with the common items. In this case, since no setting item whose default value does not match the current set value is included, the printer driver updates the print settings by the default values (respective set values of the print queue  shown in ) of the print queue \u201cPrinterB\u201d after switching in step S.","Subsequently, in step S, the printer driver acquires the current preset with reference to the corresponding line  in the print settings shown in the descriptions of . The printer driver determines in step S if the current preset is \u201cStandard\u201d. In this case, since the current preset is \u201cStandard\u201d, the printer driver skips the preset related processing. Finally, in step S, the printer driver updates, by \u201cNULL\u201d, the line  corresponding to the information of the print queue \u201cPrinterA\u201d before switching in the print settings shown in the descriptions of . As a result of the aforementioned processes, the print settings include ColorMode=\u201cColor\u201d, Duplex=\u201cDuplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cNULL\u201d. In this way, upon switching the print queues, the set values can be handed over while reflecting the default values of the print queue after switching.","A case will be examined below wherein the user opens the print setting dialog  by selecting \u201cprint\u201d from a menu of an application, and changes print settings for the purpose of the following processing under the same preconditions ().","[Case 2]\n\n","The sequence for handing over set values of this case 2 will be described below along .","Print settings before the print queue is switched include ColorMode=\u201cMono\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c1200\u201d, and LastQueue=\u201cNULL\u201d.","In this state, in step S, the system accepts a switching instruction from \u201cPrinterA\u201d as a default setting of the print queue to \u201cPrinterB\u201d from the user. In step S, the printer driver describes information of the print queue \u201cPrinterA\u201d before switching in the corresponding line  in the print settings shown in the descriptions of . After that, the system launches a printer driver of the print queue \u201cPrinterB\u201d after switching in step S. At this time, the system updates the line  associated with the print queue in the print settings shown in the descriptions of . Since set values before switching of other print settings are handed over intact, ColorMode=\u201cMono\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c1200\u201d, and LastQueue=\u201cPrinterA\u201d.","In step S, the printer driver acquires setting items of the print queue \u201cPrinterB\u201d after switching with reference to the printer specification description file (the descriptions of ) of the print queue \u201cPrinterB\u201d after switching.","In step S, the printer driver compares the setting items of the print queue \u201cPrinterA\u201d before switching with those of the print queue \u201cPrinterB\u201d after switching to determine if common setting items are included. In this case, since common setting items are included, YES is determined in step S, and the printer driver refers to the printer specification description file (the descriptions of ) of the print queue \u201cPrinterA\u201d before switching in step S. Then, the printer driver acquires default values (set values of the print queue  shown in ) of the print queue \u201cPrinterA\u201d before switching.","In step S, the printer driver compares the default values of the print queue \u201cPrinterA\u201d before switching with the current set values in association with the common items. In this case, since the setting item ColorMode whose default value does not match the current set value is included, the printer driver hands over the set value (Mono) intact in association with the ColorMode item in step S. Then, as for other setting items, the printer driver updates the print settings by the default values of the print queue \u201cPrinterB\u201d after switching with reference to the printer specification description file (the descriptions of ) of the print queue \u201cPrinterB\u201d after switching.","Subsequently, in step S, the printer driver acquires the current preset with reference to the corresponding line  in the print settings shown in the descriptions of . The printer driver determines in step S if the current preset is \u201cStandard\u201d. In this case, since the current preset is \u201cStandard\u201d, the printer driver skips the preset related processing. In step S, the printer driver updates, by \u201cNULL\u201d, the line  corresponding to the information of the print queue \u201cPrinterA\u201d before switching in the print settings shown in the descriptions of .","As a result of the aforementioned processes, the print settings include ColorMode=\u201cMono\u201d, Duplex=\u201cDuplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cNULL\u201d.","In this way, upon switching the print queues, the set value of the print setting, which is changed by the user, can be handed over, and set values of other print settings can be handed over while reflecting the default values of the print queue after switching.","Furthermore, a case will be examined below wherein the user opens the print setting dialog  by selecting \u201cprint\u201d from a menu of an application, and changes print settings for the purpose of the following processing under the same preconditions ().","[Case 3]\n\n","The sequence for handing over set values of this case 3 will be described below along .","Print settings upon switching the print queue from \u201cPrinterA\u201d to \u201cPrinterC\u201d include ColorMode=\u201cMono\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cNULL\u201d. The reason why ColorMode=\u201cMono\u201d is that the print queue \u201cPrinterC\u201d can select only \u201cMono\u201d as the ColorMode item. In such case, the set value is forcibly set to be \u201cMono\u201d which can be set.","In this state, in step S, the system accepts a print queue switching instruction from \u201cPrinterC\u201d to \u201cPrinterA\u201d from the user. In this case, as in case 1, the processes in steps S, S, S, S, and S are executed in turn. As a result, print settings at that time include ColorMode=\u201cMono\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cPrinterC\u201d.","Subsequently, in step S, the printer driver acquires the current preset with reference to the corresponding line  in the print settings shown in the descriptions of . The printer driver then determines in step S if the current preset is \u201cStandard\u201d. In this case, since the current preset is not \u201cStandard\u201d, the printer driver acquires the print settings of the current preset \u201cPreset1\u201d with reference to the preset description file shown in the descriptions of  in step S.","In step S, the printer driver compares the setting items of the print queue \u201cPrinterA\u201d after switching with those of the current preset \u201cPreset1\u201d to determine if common setting items are included. In this case, common setting items are included. Hence, in step S, the printer driver updates the common print setting items by the set values (ColorMode=\u201cColor\u201d) of the current preset \u201cPreset1\u201d acquired in step S. Then, in step S, the printer driver updates the line  corresponding to the information of the print queue \u201cPrinterC\u201d before switching in the print settings by \u201cNULL\u201d.","As a result of the aforementioned processes, the print settings include ColorMode=\u201cColor\u201d, Duplex=\u201cSimplex\u201d, Resolution=\u201c600\u201d, and LastQueue=\u201cNULL\u201d.","As described above, upon switching the print queues, when the preset is other than \u201cStandard\u201d, values can be handed over while reflecting the set values of that preset.","The sequences for handing over print settings have been explained using the practical cases. According to this embodiment, the set values of the print settings can be handed over as intended by the user in correspondence with situations of the set values of the respective setting items.","The second embodiment which adopts the same method as in the aforementioned first embodiment will be described below.  shows a print dialog when the user selects \u201cother\u201d in a setting field  shown in  as a function group that controls the method of the first embodiment.","Since setting fields  to  and buttons  and  on a print setting dialog  are the same as the setting fields  to  and buttons  and  on the print setting dialog  shown in , a description thereof will not be repeated.",{"@attributes":{"id":"p-0134","num":"0139"},"figref":"FIG. 15A","b":["2106","2107","2108","2109","2107","2108","2109","2107","2109"]},{"@attributes":{"id":"p-0135","num":"0140"},"figref":["FIG. 16","FIG. 13A","FIG. 13B"],"b":["2204","1802","1808","1809","2206","1810","1815"]},"In step S, the system accepts a print queue switching instruction from the user via the setting field  in . This process implements a second acceptance step. Then, the system determines in step S whether or not to use this handover method, with reference to the setting designated by the user via the setting field  in association with ON\/OFF of application of the set value handover processing. If it is determined that this handover method is not used (NO in step S), this sequence ends. That is, only the conventional print queue switching processing is executed without any special processing.","If it is determined that this handover method is used (YES in step S), the system determines in step S whether or not to use default values of the print queue in the set value handover processing. In this case, whether or not to use default value is determined with reference to the setting designated by the user via the setting field . If it is determined that default values are used (YES in step S), the system executes the default value related processing in step S. Otherwise (NO in step S), the system skips the processing in step S, and the process jumps to step S.","The system determines in step S whether or not to preferentially use the settings of a preset. In this case, whether or not to preferentially use the preset is determined with reference to the setting designated by the user via the setting field . If it is determined that the preset is preferentially used (YES in step S), the system executes the preset related processing in step S. Otherwise (NO in step S), the system skips the processing in step S, and ends this sequence.","As described above, the setting handover processing in print settings can be set according to the user's intention, thus improving the usability in print processing.","The third embodiment which adopts the same method as in the first embodiment will be described below.",{"@attributes":{"id":"p-0141","num":"0146"},"figref":["FIG. 17","FIG. 16"],"b":["2301","2306","2201","2206"]},"A printer driver determines in step S if print setting items have changed before and after switching of print queues. If it is determined that the print settings have changed (YES in step S), the printer driver displays a change notification dialog shown in  to notify the user that the print settings have changed in step S. If the print settings have not changed (NO in step S), this sequence ends.","In this way, even when setting changes which are not intended by the user have occurred upon switching of the print queues, the user can recognize these changes since he or she receives a message that advises accordingly. Thus, the usability in print processing can be improved.","The three embodiments have been described. The present invention is not limited to these embodiments, and various other embodiments may be made. For example, in the first embodiment, information of a print queue before switching is used as one of hidden parameters of print settings. Alternatively, equivalent information may be stored in an external file. In the second and third embodiments, the dialog is used as means for notifying the user of print setting changes. Alternatively, equivalent information may be displayed as one option of the setting field  shown in .","Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment(s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).","While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.","This application claims the benefit of Japanese Patent Application No. 2009-211027, filed Sep. 11, 2009, which is hereby incorporated by reference herein in its entirety."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIGS. 6A and 6B"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIGS. 12A and 12B"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIGS. 13A and 13B"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIGS. 14A and 14B"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIGS. 15A and 15B"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 17"}]},"DETDESC":[{},{}]}
