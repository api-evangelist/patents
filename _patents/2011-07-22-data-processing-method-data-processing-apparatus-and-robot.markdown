---
title: Data processing method, data processing apparatus and robot
abstract: A data processing method includes generating a data storing area in a memory space. An area address of the data storing area is designated to a basic I/O control on the user space in a memory. The memory has a user space and a kernel space. A function is called in the kernel space using the basic I/O control. Whether the data storing area is inside the memory space is determined. The area address of the data storing area is set as an argument of the function in a case where it is determined that the data storing area is included in the memory space.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08533376&OS=08533376&RS=08533376
owner: Kabushiki Kaisha Yaskawa Denki
number: 08533376
owner_city: Kitakyushu-Shi
owner_country: JP
publication_date: 20110722
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENTS"],"p":["1. Field of the Invention","The present invention relates to a data processing method, a data processing apparatus and a robot.","2. Discussion of the Background","One aspect of an industrial robot has a robot body, a controller, and an input apparatus that are connected to each other. The controller generates control commands on the basis of operation designations input by the input apparatus, and the robot body operates on the basis of the control commands. The robot body has moving parts such as actuators and hinges, and each moving part is driven by a drive motor such as a servo motor.","According to one aspect of the present invention, a data processing method includes generating a data storing area in a memory space. An area address of the data storing area is designated to a basic I\/O control on the user space in a memory. The memory has a user space and a kernel space. A function is called in the kernel space using the basic I\/O control. Whether the data storing area is inside the memory space is determined. The area address of the data storing area is set as an argument of the function in a case where it is determined that the data storing area is included in the memory space.","According to another aspect of the present invention, a data processing apparatus includes a storing area generating device, an address designating device, a function calling device, a determining device and an argument setting device. The storing area generating device is configured to generate a data storing area in a memory space. The address designating device is configured to designate an area address of the data storing area to a basic I\/O control on the user space in a memory. The memory has a user space and a kernel space. The function calling device is configured to call a function in the kernel space using the basic I\/O control. The determining device is configured to determine whether the data storing area is inside the memory space. The argument setting device is configured to set the area address of the data storing area as an argument of the function in a case where it is determined that the data storing area is included in the memory space.","According to further aspect of the present invention, a robot includes a robot body, an input apparatus and a controller. The robot body includes a plurality of hinges and a plurality of drive motors to drive the plurality of hinges. The input apparatus includes an operation device configured to accept an input of an operation designation to operate the robot body. The controller includes a data processing apparatus. The data processing apparatus includes a storing area generating device, an address designating device, a function calling device, a determining device and an argument setting device. The storing area generating device is configured to generate a data storing area in a memory space. The address designating device is configured to designate an area address of the data storing area to a basic I\/O control on a user space in a memory. The memory has the user space and a kernel space. The function calling device is configured to call a function in the kernel space using the basic I\/O control. The determining device is configured to determine whether the data storing area is inside the memory space. The argument setting device is configured to set the area address of the data storing area as an argument of the function in a case where it is determined that the data storing area is included in the memory space.","The embodiments will now be described with reference to the accompanying drawings, wherein like reference numerals designate corresponding or identical elements throughout the various drawings.  is an entire block diagram of a robot S according to an embodiment of the present invention. The robot S is an industrial robot used in a welding operation for a production line in a factory. The robot S is roughly configured by a programming pendant (to be referred to as a pendant hereinafter)  serving as an input apparatus, a controller , and a robot body .","The pendant  has a display unit , operation buttons (operation device) , a CPU (not shown), and a memory (not shown). The operation buttons  are to accept input operations to operate the robot body  by a user. Input data input from the operation buttons  by the user is designed to be displayed on the display unit . The display unit  displays other various pieces of information. For example, the display unit displays an initial setting menu of the robot S or an operation designation menu of the robot body .","The CPU and the memory function as a computer. In the memory, the contents of a menu configuration displayed on the display unit , commands to designate an operation to the robot body , and the like are stored.","The CPU is a processor to perform various arithmetic processing, and is substantially connected to the controller  through a communication interface (not shown). For example, the CPU executes an arithmetic processing to display necessary information on the display unit  on the basis of an input from the operation buttons . For example, the CPU executes an arithmetic processing to send an operation designation to operate the robot body  to the controller . The pendant  and the controller  may be connected through an interface such as RS232C such that the pendant  and the controller  can serially communicate with each other. Some of the operation buttons  of the pendant  are allocated to an emergency stop switch (not shown) and enable switch (not shown). When these switches are operated, designation signals such as for the emergency stop or the enable operation are sent to the controller .","In the embodiment, the pendant  includes, for example, a memory slot (memory loading device)  for a flash memory such as a compact flash (registered trademark in the U.S.). When a flash memory  is loaded in the memory slot , it is possible to transmit data in the flash memory  to the controller .","The controller  is connected to the robot body  and the pendant . The controller  generates control commands for servo motors  on the basis of the operation designations from the pendant . The control commands are sent to the robot body .",{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 2","b":["200","200","210","220","230","240","250","260"]},"The main CPU  is an arithmetic processing unit to execute input\/output operations of various data and arithmetic processings. The main CPU  functions as, for example, a system control unit , an operation control unit , a file system unit , an I\/O control unit  by various application programs such as a system program and an operation program.","In this case, the system control unit  exerts a function of integrating operation controls of the overall robot S. The operation control unit  exerts a function of executing operation control of the servo motors  on the robot body  on the basis of an operation designation (for example, an operation designation by an operation program) from the pendant . The operation control unit  has a function of executing operation control of the servo motors  on the robot body  on the basis of an operation designation by an application program (will be described later). The file system unit  exerts a function of executing data communication with the memory . The I\/O control unit  exerts a function of controlling data input\/output operations between the main CPU and various sensors and switches arranged on or around the robot body  through the I\/O board .","The servo CPU  controls an operation of the servo motors  included in the robot body  on the basis of control commands from the main CPU . More specifically, for example, when the servo CPU  receives data (target positions, moving speed data, and the like of servo motors of hinges for each predetermined control cycle) required for an operation from the operation control unit  of the main CPU , the servo CPU  generates control signals required to drive the servo motors  on the basis of the data. On the basis of feedback signals from the servo motors , the servo CPU  also generates control signals to correct (feed back) the operation of the servo motors .","The converter  and the servo amplifiers  configure driver circuits of the servo motors . The converter  and the servo amplifiers , on the basis of the control signals from the servo CPU , generate drive signals (drive currents) to drive the servo motors  and send the drive signals to the servo motors .","The I\/O board  is a relay board that can communicate with the I\/O control unit  of the main CPU . The I\/O board , for example, receives sensor signals from various sensors on the robot body . The received sensor signal is transmitted to the I\/O control unit  of the main CPU .","The robot body  is, for example, a main part of an industrial robot, and is called a manipulator. For example, a plurality of arms are rotatably connected to the manipulator with hinges. The hinges are designed to be controllably rotated by the servo motors . A configuration of the robot body  will not be described in detail.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 3","b":["210","230","200"]},"The main CPU  exerts functions of a storing area generating device , an address designating device , a function calling device , a determining device , and an argument setting device . These functions are main functions exerted by the CPU  through the system program of the robot S or application programs created by a user. The system control unit , the operation control unit , the file system unit , and the I\/O control unit  of the main CPU  may exert the functions of the devices of reference symbols  to  in cooperation with each other, or the system control unit  may mainly exert the functions of the devices of reference symbols  to .","A storing area in the memory  has a user space  and a kernel space . In the user space , for example, a user application (application program) UAP, that is created by a user herself\/himself by using a program language such as C language and compiled, is stored.","The user application UAP is an application program to execute operation control of the robot body  on the basis of the function of the user application UAP. When, on the basis of an operation from the pendant , the user application UAP is loaded on a nonvolatile memory (not shown) and started, the user application UAP calls functions from an API library KLIB (will be described later) as needed. On the basis of the functions, a control command is transmitted to the servo motors  of the robot body  to control an operation of the robot body .","The operation control of the robot body is performed by using an API (Application Programming Interface: an assembly of functions) stored in the kernel space  of the memory . In the past, when a control program based on a dedicated language (so-called robot language) is designated by an operation of the pendant , the API in the kernel space  is called on the basis of the control program, and the control commands are transmitted to the robot body .","In contrast to this, in the embodiment, the operation of the robot body is controlled by using an application program using a versatile program language such as C language. According to this, there is no need to translate robot languages for each command, and fast processing speed, various operation controls, and easy coping with hardware can be achieved. Since the application program can be created by a user herself\/himself, the embodiment can rapidly and simply cope with various operation controls advantageously.","In the past, in order to directly call an API in the kernel space , the application program is stored in the kernel space . However, in the configuration, when an area address of a storing area (data storing area) that stores an argument of the API is erroneously designated, the system software in the kernel space  is unnecessarily accessed, and a drawback may occur in the operation of the robot system.","In the embodiment, a user application (user application program) UAP is stored in the kernel space  of the memory , and the API in the kernel space  can be called while protecting important data in the kernel space .","In the user space , system software USYS on a user space and an API library ULIB on a user space are also stored. The API library ULIB is an assembly of functions that can be directly called by the user application UAP. A real time process (RTP) includes the user application UAP, the system software USYS, and the API library ULIB.","The kernel space  is an address space in the memory  in which the kernel of an operating system (OS) operates. The user space  and the kernel space  are structured in the memory  by the function of the main CPU .","System software KSYS on the kernel space is stored in the kernel space . In the kernel space , the API library KLIB on the kernel space is also stored. The API library KLIB is an assembly of functions like the API library ULIB. However, since the API library KLIB is stored in the kernel space, the API library KLIB cannot be directly called from the user application UAP. A kernel module includes system software KSYS and the API library KLIB.","The user application UAP can be created by, for example, a user herself\/himself using C language. The user application UAP which is completed the compile process may be temporarily stored in the flash memory  by a PC. The flash memory  may be loaded in the memory slot  to store the user application UAP in the memory  of the controller .","The main CPU  functions as the storing area generating device . When the user application UAP is activated, the storing area generating device  generates a data storing area  in the user space . The data storing area  in the user space  cannot be generally referred from the kernel space .","The main CPU  functions as the address designating device . When the data storing area  is generated in the user space , the area address of the data storing area  is designated by the address designating device . The area address is designated by a basic I\/O control . The basic I\/O control  is a process used for making the data storing area  in the user space  capable of being referred temporarily from the kernel space , and making the user application in the user space  capable of calling the API in the kernel space .","The main CPU  functions as the function calling device . When an area address is set in the basic I\/O control , on the basis of the function of the main CPU  serving as the function calling device , the basic I\/O control  accesses the API library KLIB in the kernel space . An API (function) designated by the user application UAP is called from the API library KLIB.","On the basis of the function of the system software KSYS on the kernel space , the main CPU  functions as the determining device . The determining device  determines whether the area address designated by the basic I\/O control  that accesses the kernel space  designates an address in the user space . More specifically, the determining device  determines whether data storing area  set by the basic I\/O control  is included in the user space .","As a result, when the data storing area  is included in the user space , as an argument of the function called by the basic I\/O control , the area address of the data storing area  is set.","After the data storing area  is included in the user space , a function in the API library KLIB is executed. Therefore, an unexpected operation of the system software caused by an error such as an address violation, overwriting of data, or the like is effectively prevented to make it possible to assure security in execution of the user application.","In the above description, as a specific memory space that generates the data storing area , the user space  is exemplified. However, the specific memory area may be a common memory  different from memory  or the common memory  using a part of the memory .  show examples in which common memories  different from the memory  are used as specific memory spaces. Since a function is executed after the data storing area  is included in the common memory , the kernel space  and the user space  can be prevented from being unexpectedly accessed to make it possible to protect the spaces.","A data processing procedure in the memory in the robot S will be described below with reference to a flow chart in . In the following flow chart, an example in which the data storing area  is not generated in the common memory  but in the user space  of the memory  will be described.","A user creates the user application UAP to perform a series of operation controls of the robot S by the PC in advance, and stores the user application UAP in the flash memory . The flash memory  is loaded in the memory slot  of the pendant , and the user application UAP is stored in the user space  in the memory  of the controller .","When, on the basis of an operation of the pendant  by the user, the user application UAP is activated by being loaded on a nonvolatile memory (not shown), the data storing area  is generated in the user space  (S). An area address of the data storing area  is designated to the basic I\/O control  (S), and the basic I\/O control  calls the API in the kernel space  (S). In this case, processing in the user space  is given with a privileged mode by an OS to make it possible to access resources in the kernel space  (S).","On the kernel space , it is determined whether the data storing area  is included in the user space  (S). When, as the determination result, it is determined that the data storing area  is included in the user space , the area address of the data storing area  is given to the API as an argument (S). Data (stored data) in the data storing area  is read by the API on the kernel space , and the API is executed by using the stored data (S). A calculated value serving as a result of the executed operation is stored in the data storing area  again (S).","In this case, the privileged mode ends, and the resources in the user space  and the resources in the kernel space  cannot be accessed to each other (S). The user application UAP refers to the calculation result stored in the data storing area  (S). In (S), when it is determined as the result that the data storing area  is not included in the user space , error handling is executed (S). The error handling may be processing that returns, for example, an error code that designates an \u201caddress exception handling error\u201d to the user application UAP on the user space .","In this manner, the data storing area  can be avoided from being set in the kernel space . As a result, the backbone portion such as the system software KSYS in the kernel space  of the robot system can be advantageously protected.","The embodiment of the present invention has been described above. However, the present invention is not limited to the embodiment, and various changes and modifications can be effected without departing from the spirit and scope of the invention.","Obviously, numerous modifications and variations of the present invention are possible in light of the above teachings. It is therefore to be understood that within the scope of the appended claims, the invention may be practiced otherwise than as specifically described herein."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["A more complete appreciation of the invention and many of the attendant advantages thereof will be readily obtained as the same becomes better understood by reference to the following detailed description when considered in connection with the accompanying drawings, wherein:",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
