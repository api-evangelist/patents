---
title: Programmable object model for extensible markup language markup in an application
abstract: A programmable object model allows a user/programmer to programmatically access the Extensible Markup Language (XML) functionality of a software application. The programmable object model is comprised of a plurality of object-oriented message calls or application programming interfaces for allowing a user to access the XML functionality of an application by sending one or more object-oriented message calls or application programming interfaces to the XML functionality of a given application along with any required parameters for customizing or otherwise manipulating XML markup applied to a document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07404195&OS=07404195&RS=07404195
owner: Microsoft Corporation
number: 07404195
owner_city: Redmond
owner_country: US
publication_date: 20031209
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["RELATED APPLICATIONS","COPYRIGHT NOTICE","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT"],"p":["United States Utility patent application by applicant matter number 60001.0263US01\/MS303917.1, entitled \u201cProgrammable Object Model for Extensible Markup Language Schema Validation,\u201d and United States Utility patent application by applicant matter number 60001.0270US01\/MS303919.1, entitled \u201cProgrammable Object Model for Namespace or Schema Library Support in a Software Application,\u201d are hereby incorporated by reference.","A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure, as it appears in the United States Patent and Trademark Office patent file or records, but otherwise reserves all copyright rights whatsoever.","The present invention relates to programmable object models. More particularly, the present invention relates to a programmable object model for Extensible Markup Language markup in a software application.","Computer software applications allow users to create a variety of documents to assist them in work, education, and leisure. For example, popular word processing applications allow users to create letters, articles, books, memoranda, and the like. Spreadsheet applications allow users to store, manipulate, print, and display a variety of alphanumeric data. Such applications have a number of well known strengths including rich editing, formatting, printing, calculation and on-line and off-line editing.","Most computer software applications do not contain all necessary programming for providing functionality required or desired by every potential user. Many programmers often wish to take advantage of an existing application's capabilities in their own programs or to customize the functionality of an application and make it more suitable for a specific set of users or actions. For example, a programmer working in the financial industry may wish to customize a word processor for a user audience consisting of financial analysts editing financial reports. In recent years, the Extensible Markup Language has been used widely as an interchangeable data format for many users. A word processor or other application capable of receiving and editing XML data provides great value to its users. However, because the native .XML functionality of such an application is not exposed to users\/programmers wishing to customize the functionality to further take advantage of the functionality for their own programs, such users\/programmers are limited in their ability to utilize the XML functionality.","Accordingly, there is a need in the art for a programmable object model for allowing users\/programmers to programmatically access the XML functionality of a software application in order to customize or otherwise modify the XML functionality to enhance their utilization of the functionality. It is with respect to these and other considerations that the present invention has been made.","The present invention provides methods and systems for allowing a user to programmatically access the Extensible Markup Language (XML) functionality of a software application by providing a programmable object model. According to one aspect of the present invention, a programmable object model comprised of a plurality of object-oriented message calls or application programming interfaces is provided for allowing a user to access the XML functionality of an application by sending one or more object-oriented message calls or application programming interfaces to the XML functionality of a given application along with any required parameters for customizing or otherwise manipulating XML markup applied to a document. Once the user has access to the XML functionality of a given application, the user may insert or delete XML markup in arbitrary locations in the document, the user may access richly formatted contents in areas contained inside an XML element or node, the user may locate specific XML nodes or elements in a document using queries, and the user may control or otherwise manipulate the application's XML-related settings and properties.","These and other features, advantages, and aspects of the present invention may be more clearly understood and appreciated from a review of the following detailed description of the disclosed embodiments and by reference to the appended drawings and claims.","Embodiments of the present invention are directed to methods and systems for allowing a user to programmatically call the Extensible Markup Language (XML) functionality of a software application for customizing, utilizing, and otherwise manipulating objects and properties of the XML functionality and for customizing, manipulating and enhancing the utilization of XML markup in a document. These embodiments may be combined, other embodiments may be utilized, and structural changes may be made without departing from the spirit or scope of the present invention. The following detailed description is therefore not to be taken in a limiting senses and the scope of the present invention is defined by the appended claims and their equivalents.","Referring now to the drawings, in which like numerals represent like elements through the several figures, aspects of the present invention and the exemplary operating environment will be described.  and the following discussion are intended to provide a brief, general description of a suitable computing environment in which the invention may be implemented. While the invention will be described in the general context of program modules that execute in conjunction with an application program that runs on an operating system on a personal computer, those skilled in the art will recognize that the invention may also be implemented in combination with other program modules.","Generally, program modules include routines, programs, components, data structures, and other types of structures that perform particular tasks or implement particular abstract data types. Moreover, those skilled in the art will appreciate that the invention may be practiced with other computer system configurations, including hand-held devices, multiprocessor systems, microprocessor-based or programmable consumer electronics, minicomputers, mainframe computers, and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote memory storage devices.","Turning now to , an illustrative computer architecture for a personal computer  for practicing the various embodiments of the invention will be described. The computer architecture shown in  illustrates a conventional personal computer, including a central processing unit  (\u201cCPU\u201d), a system memory , including a random access memory  (\u201cRAM\u201d) and a read-only memory (\u201cROM\u201d) , and a system bus  that couples the memory to the CPU . A basic input\/output system containing the basic routines that help to transfer information between elements within the computer, such as during startup, is stored in the ROM . The personal computer  further includes a mass storage device  for storing an operating system , application programs, such as the application program , and data.","The mass storage device  is connected to the CPU  through a mass storage controller (not shown) connected to the bus . The mass storage device  and its associated computer-readable media, provide non-volatile storage for the personal computer . Although the description of computer-readable media contained herein refers to a mass storage device, such as a hard disk or CD-ROM drive, it should be appreciated by those skilled in the art that computer-readable media can be any available media that can be accessed by the personal computer .","By way of example, and not limitation, computer-readable media may comprise computer storage media and communication media. Computer storage media includes volatile and non-volatile, removable and non-removable media implemented in any method or technology for storage of information such as computer-readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EPROM, EEPROM, flash memory or other solid state memory technology, CD-ROM, DVD, or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by the computer.","According to various embodiments of the invention, the personal computer  may operate in a networked environment using logical connections to remote computers through a TCP\/IP network , such as the Internet. The personal computer  may connect to the TCP\/IP network  through a network interface unit  connected to the bus . It should be appreciated that the network interface unit  may also be utilized to connect to other types of networks and remote computer systems. The personal computer  may also include an input\/output controller  for receiving and processing input from a number of devices, including a keyboard or mouse (not shown). Similarly, an input\/output controller  may provide output to a display screen, a printer, or other type of output device.","As mentioned briefly above, a number of program modules and data files may be stored in the mass storage device  and RAM  of the personal computer , including an operating system  suitable for controlling the operation of a networked personal computer, such as the WINDOWS XP operating system from MICROSOFT CORPORATION of Redmond, Wash. The mass storage device  and RAM  may also store one or more application programs. In particular, the mass storage device  and RAM  may store an application program  for creating and editing an electronic document . For instance, the application program  may comprise a word processing application program, a spreadsheet application, a contact application, and the like. Application programs for creating and editing other types of electronic documents may also be used with the various embodiments of the present invention. A schema file  and a namespace\/schema library , described below, are also shown.","Exemplary embodiments of the present invention are implemented by communications between different software objects in an object-oriented programming environment. For purposes of the following description of embodiments of the present invention, it is useful to briefly to describe components of an object-oriented programming environment.  is a simplified block diagram illustrating interaction between software objects according to an object-oriented programming model. According to an object-oriented programming environment, a first object  may include software code, executable methods, properties, and parameters. Similarly, a second object  may also include software code, executable methods, properties, and parameters.","A first object  may communicate with a second object  to obtain information or functionality from the second object  by calling the second object  via a message call . As is well know to those skilled in the art of object-oriented programming environment, the first object  may communicate with the second object  via application programming interfaces (API) that allow two disparate software objects ,  to communicate with each other in order to obtain information and functionality from each other. For example, if the first object  requires the functionality provided by a method contained in the second object , the first object  may pass a message call  to the second object  in which the first object identifies the required method and in which the first object passes any required parameters to the second object required by the second object for operating the identified method. Once the second object  receives the call from the first object, the second object executes the called method based on the provided parameters and sends a return message  containing a value obtained from the executed method back to the first object .","For example, in terms of embodiments of the present invention, and as will be described below, a first object  may be a third party customized application that passes a message to a second object such as an Extensible Markup Language schema validation object whereby the first object identifies a method requiring the validation of a specified XML element in a document where the specified XML element is a parameter passed by the first object with the identified method. Upon receipt of the call from the first object, according to this example, the schema validation object executes the identified method on the specified XML element and returns a message to the first object in the form of a result or value associated with the validated XML element. Operation of object-oriented programming environments, as briefly described above, are well known to those skilled in the art.","As described below, embodiments of the present invention are implemented through the interaction of software objects in the use, customization, and application of components of the Extensible Markup Language (XML).  is a block diagram illustrating interaction between a document, an attached schema file, and a schema validation functionality module. As is well known to those skilled in the art, the Extensible Markup Language (XML) provides a method of describing text and data in a document by allowing a user to create tag names that are applied to text or data in a document that in turn define the text or data to which associated tags are applied. For example referring to , the document  created with the application  contains text that has been marked up with XML tags , , . For example, the text \u201cGreetings\u201d is annotated with the XML tag <title>. The text \u201cMy name is Sarah\u201d is annotated with the <body> tag. According to XML, the creator of the <title> and <body> tags is free to create her own tags for describing the tags to which those tags will be applied. Then, so long as any downstream consuming application or computing machine is provided instructions as to the definition of the tags applied to the text, that application or computing machine may utilize the data in accordance with the tags. For example, if a downstream application has been programmed to extract text defined as titles of articles or publications processed by that application, the application may parse the document  and extract the text \u201cGreetings,\u201d as illustrated in  because that text is annotated with the tag <title>. The creator of the particular XML tag naming for the document , illustrated in , provides useful description for text or data contained in the document  that may be utilized by third parties so long as those third parties are provided with the definitions associated with tags applied to the text or data.","According to embodiments of the present invention, the text and XML markup entered into the document  may be saved according to a variety of different file formats and according to the native programming language of the application  with which the document  is created. For example, the text and XML markup may be saved according to a word processing application, a spreadsheet application, and the like. Alternatively, the text and XML markup entered into the document  may be saved as an XML format whereby the text or data, any applied XML markup, and any formatting such as font, style, paragraph structure, etc. may be saved as an XML representation. Accordingly, downstream or third party applications capable of understanding data saved as XML may open and consume the text or data thus saved as an XML representation. For a detailed discussion of saving text and XML markup and associated formatting and other attributes of a document  as XML, see U.S. patent application entitled \u201cWord Processing Document Stored in a Single XML File that may be Manipulated by Applications that Understanding XML,\u201d U.S. Ser. No. 10\/187,060, filed Jun. 28, 2002, which is incorporated herein by reference as if fully set out herein.","In order to provide a definitional framework for XML markup elements (tags) applied to text or data, as illustrated in , XML schema files are created which contain information necessary for allowing users and consumers of marked up and stored data to understand the XML tagging definitions designed by the creator of the document. Each schema file also referred to in the art as a Namespace or XSD file preferably includes a listing of all XML elements (tags) that may be applied to a document according to a given schema file. For example, a schema file , illustrated in , may be a schema file containing definitions of certain XML elements that may be applied to a document  including attributes of XML elements or limitations and\/or rules associated with text or data that may be annotated with XML elements according to the schema file. For example, referring to the schema file  illustrated in , the schema file is identified by the Namespace \u201cintro\u201d the schema file includes a root element of <intro card>.","According to the schema file , the <intro card> element serves as a root element for the schema file and also as a parent element to two child elements <title> and <body>. As is well known to those skilled in the art, a number of parent elements may be defined under a single root element, and a number of child elements may be defined under each parent element. Typically, however, a given schema file  contains only one root element. Referring still to , the schema file  also contains attributes  and  to the <title> and <body> elements, respectfully. The attributes  and  may provide further definition or rules associated with applying the respective elements to text or data in the document . For example, the attribute  defines that text annotated with the <title> element must be less than or equal to twenty-five characters in length. Accordingly, if text exceeding twenty-five characters in length is annotated with the <title> element or tag, the attempted annotation of that text will be invalid according to the definitions contained in the schema file .","By applying such definitions or rules as attributes to XML elements, the creator of the schema may dictate the structure of data contained in a document associated with a given schema file. For example, if the creator of a schema file  for defining XML markup applied to a resume document desires that the experience section of the resume document contain no more than four present or previous job entries, the creator of the schema file  may define an attribute of an <experience> element, for example, to allow that no more than four present or past job entries may be entered between the <experience> tags in order for the experience text to be valid according to the schema file . As is well known to those skilled in the art, the schema file  may be attached to or otherwise associated with a given document  for application of allowable XML markup defined in the attached schema file to the document . According to one embodiment, the document  marked up with XML elements of the attached or associated schema file  may point to the attached or associated schema file by pointing to a uniform resource identifier (URI) associated with a Namespace identifying the attached or associated schema file .","According to embodiments of the present invention, a document  may have a plurality of attached schema files. That is, a creator of the document  may associate or attach more than one schema file  to the document  in order to provide a framework for the annotation of XML markup from more than one schema file. For example, a document  may contain text or data associated with financial data. A creator of the document  may wish to associate XML schema files  containing XML markup and definitions associated with multiple financial institutions. Accordingly, the creator of the document  may associate an XML schema file  from one or more financial institutions with the document . Likewise, a given XML schema file  may be associated with a particular document structure such as a template for placing financial data into a desirable format.","According to embodiments of the present invention, a collection of XML schema files and associated document solutions may be maintained in a Namespace or schema library located separately from the document . The document  may in turn contain pointers to URIs in the Namespace or schema library associated with the one or more schema files attached to otherwise associated with the document . As the document  requires information from one or more associated schema files, the document  points to the Namespace or schema library to obtain the required schema definitions. For a detailed description of the use of an operation of Namespace or schema libraries, see U.S. patent application entitled \u201cSystem and Method for Providing Namespace Related Information,\u201d U.S. Ser. No. 10\/184,190, filed Jun. 27, 2002, and U.S. patent application entitled \u201cSystem and Method for Obtaining and Using Namespace Related Information for Opening XML Documents,\u201d U.S. Ser. No. 10\/185,940, filed Jun. 27, 2002, both U.S. patent applications of which are incorporated herein by reference as if fully set out herein. For a detailed description of a mechanism for downloading software components such as XML schema files and associated solutions from a Namespace or schema library, see US patent application entitled Mechanism for Downloading Software Components from a Remote Source for Use by a Local Software Application, U.S. Ser. No. 10\/164,260, filed Jun. 5, 2002.","Referring still to , a schema validation functionality module  is illustrated for validating XML markup applied to a document  against an XML schema file  attached to or otherwise associated with the document , as described above. As described above, the schema file  sets out acceptable XML elements and associated attributes and defines rules for the valid annotation of the document  with XML markup from an associated schema file . For example, as shown in the schema file , two child elements <title> and <body> are defined under the root or parent element <intro card>. Attributes ,  defining the acceptable string length of text associated with the child elements <title> and <body> are also illustrated. As described above, if a user attempts to annotate the document  with XML markup from a schema file  attached to or associated with the document in violation of the XML markup definitions contained in the schema file , an invalidity or error state will be presented. For example, if the user attempts to enter a title string exceeding twenty-five characters, that text entry will violate the maximum character length attribute of the <title> element of the schema file . In order to validate XML markup applied to a document , against an associated schema file , a schema validation module  is utilized. As should be understood by those skilled in the art, the schema validation module  is a software module including computer executable instructions sufficient for comparing XML markup and associated text entered in to a document  against an associated or attached XML schema file  as the XML markup and associated text is entered in to the document .","According to embodiments of the present invention, the schema validation module  compares each XML markup element and associated text or data applied to the document  against the attached or associated schema file  to determine whether each element and associated text or data complies with the rules and definitions set out by the attached schema file . For example, if a user attempts to enter a character string exceeding twenty-five characters annotated by the <title> elements , the schema validation module will compare that text string against the text string attribute  of the attached schema file  and determine that the text string entered by the user exceeds the maximum allowable text string length. Accordingly, an error message or dialogue will be presented to the user to alert the user that the text string being-entered by the user exceeds the maximum allowable character length according to the attached schema file . Likewise, if the user attempts to add an XML markup element between the <title> and the <body> elements, the schema validation module  will determine that the XML markup element applied by the user is not a valid element allowed between the <title> and <body> elements according to the attached schema file . Accordingly, the schema validation module  will generate an error message or dialogue to the user to alert the user of the invalid XML markup.","Programmable Object Model for XML Markup in an Application","As described above with reference to , an application  may allow a user to apply Extensible Markup Language (XML) elements to a document . Further, a schema file  may be attached to or associated with the document  for providing a framework of definitions and rules for applying XML markup elements to the document  in accordance with a schema file . According to embodiments of the present invention, a user is allowed to programmatically call the XML functionality of an application  for gaining access to XML markup applied to a document and for editing XML markup applied to the document. Further, the user may call the XML functionality of the application  for setting and adding attributes on XML elements, and adding elements, in spite of an attached or associated schema file . Access to the XML functionality of the application  also allows a user to access richly formatted text or data contents contained within an XML node or to find specific XML nodes (elements) in the document  by using one or more XML XPath queries.","According to embodiments of the present invention, a user may access the XML functionality of an application by sending one or more object-oriented message calls or application programming interfaces to the XML functionality of the application  as described above with reference to . By exposing the user to the XML functionality of the application , the user may programmatically call the XML functionality of the application , directly through use of provided message calls or API's or from a third party software application capable of communicating with the .XML functionality of the application  via object-oriented message calls or API's. The user may prepare a third party application according to a variety of different programming languages such as C, C++, C#, Visual Basic, and the like.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 4","FIG. 4","FIG. 3","FIG. 4"],"b":["305","305","310","315","320","325","310","405","410","310","420","430","440","450","460","480","470","460","305","310"]},"According to embodiments of the present invention, and as described above, the user may programmatically access the XML functionality of the software application to customize or otherwise manipulate the application of XML elements from the associated or attached schema file  to the document . For example, the user may desire to programmatically insert additional XML markup into the document at a specified range by sending an object-oriented message call specifying a method for inserting a given XML markup element into a particular range within the document. For another example, the user may desire to apply an Extensible Stylesheet Language Transformation (XSLT) to the document  in order to transform the document  to a format required by the user, for example HTML format. In order to effect such a transformation, the user is provided an object-oriented message call for calling the XML functionality of the application  and for providing the location of a desired XSLT transformation file for applying to the document .","The following is a description of objects and associated properties comprising object-oriented message calls (application programming interfaces) provided to a user for allowing the user to directly access the XML functionality of the software application , as described above. Following each of the objects or associated properties set out below is a description of the operation and functionality of the object or associated property.","Application Object","The following are properties and methods of this object related to XML markup.",".PrintXMLTag Property\n\n","The following are properties and methods of this object related to XML markup.",".TranformDocument\n\n",".XMLAfterInsert Event\n\n",".XMLBeforeDelete Event\n\n",".XMLHideNamespaces Property\n\n","XMLNodes Property\n\n",".XMLSaveDataOnly Property\n\n",".XMLSaveThroughXSLT Property\n\n",".XMLUseXSLTWhenSaving Property\n\n","The following are properties and methods of this object related to XML markup.",".ShowXMLMarkup Property\n\n",".ShowPlaceholderText Property\n\n",".InsertXML( ) Method\n\n",".XML Property\n\n",".XMLNodes Property\n\n",".XMLParentNode Property\n\n",".InsertXML( ) Method\n\n",".XML Property\n\n",".XMLNodes Property\n\n",".XMLParentNode Property\n\n",".Add( ) Method\n\n",".Application Property\n\n",".Count Property\n\n",".Creator Property\n\n",".Item( ) Method\n\n",".Parent Property\n\n",".Application Property\n\n",".Attributes Property\n\n",".BaseName Property\n\n",".ChildNodes Property\n\n",".Copy( ) Method\n\n",".Creator Property\n\n",".Cut( ) Method\n\n",".Delete( ) Method\n\n",".FirstChild Property\n\n",".HasChildNodes Property\n\n",".LastChild Property\n\n",".Level Property\n\n",".NamespaceURI Property\n\n",".NextSibling Property\n\n",".NodeType Property\n\n",".NodeValue Property\n\n","OwnerDocument Property\n\n",".Parent Property\n\n",".Parentnode Property\n\n",".PlaceholderText Property","A property controlling the placeholder text that shows up in place of elements when those elements are empty and their tags are not visible.",".PreviousSibling Property\n\n",".Range Property\n\n",".RemoveChild( ) Method\n\n",".SelectNodes( ) Method\n\n",".SelectSingleNode( ) Method\n\n",".SmartTag Property\n\n",".Text Property\n\n",".XML Property\n\n","As described herein, methods and systems are provided for allowing a user to programmatically access the Extensible Markup Language (XML) functionality of an application for accessing and customizing XML markup applied to a document created by the application and for controlling XML markup definitions and rules applied to the document by one or more associated or attached XML schema files. It will be apparent to those skilled in the art that various modifications or variations may be made in the present invention without departing from the scope or spirit of the invention. Other embodiments of the invention will be apparent to those skilled in the art from consideration of the specification and practice of the invention disclosed herein."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
