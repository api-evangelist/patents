---
title: Using patterns to perform personal identification data substitution
abstract: The present invention is directed toward using patterns in APDU to perform identification data substitution. According to one or more embodiments of the present invention, a user inserts a smart card into a card reader connected to a client computing device. Then, the user enters a PIN. The PIN is embedded into an APDU which is sent to the card reader and is presented to the smart card. The APDU contains special patterns that specify to the card reader where and in what format the PIN should be embedded into a prototype APDU that is constructed in the card reader and presented to the card for verification.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07039952&OS=07039952&RS=07039952
owner: Sun Microsystems, Inc.
number: 07039952
owner_city: Santa Clara
owner_country: US
publication_date: 20010518
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION","EXAMPLE"],"p":["1. Field of the Invention","The present invention relates to network security. More specifically, the invention relates to using patterns to perform identification data substitution.","Portions of the disclosure of this patent document contain material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure as it appears in the Patent and Trademark Office file or records, but otherwise reserves all copyright rights whatsoever.","2. Background Art","When logging in to a distributed network of computing devices, it is typical for a security measure to be in place which insures the identity of the individual logging in. One manner where this occurs is on a system that uses a smart card. The user inserts the card into a card reading device attached to the computing system and enters a personal identification number (PIN) onto a keyboard or other input device of the computing system. Alternatively, the user might provide biometric identification to the system in the form of a fingerprint or retinal scan. If the identification data is authenticated then the user logs in and begins using the distributed network.","As will be further explained below, the manner in which identification data (such as PINs or biometric identifiers) is currently authenticated is vulnerable to snooping attacks from untrusted third parties that might use the data to compromise the network. Before further describing the problems associated with current techniques which authenticate identification data, an example computing environment where this problem occurs is describe below.","Multi-Tier Application Architecture","In the multi-tier application architecture, a client communicates requests to a server for data, software and services, for example, and the server responds to the requests. The server's response may entail communication with a database management system for the storage and retrieval of data. The multi-tier architecture includes at least a database tier that includes a database server, an application tier that includes an application server and application logic (i.e., software application programs, functions, etc.), and a client tier. The application server responds to application requests received from the client. The application server forwards data requests to the database server.",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1","b":["100","110","110"]},"Further application functionality is provided by application logic managed by application server  in application tier . The apportionment of application functionality between client tier  and application tier  is dependent upon whether a \u201cthin client\u201d or \u201cthick client\u201d topology is desired. In a thin client topology, the client tier (i.e., the end user's computer) is used primarily to display output and obtain input, while the computing takes place in other tiers. A thick client topology, on the other hand, uses a more conventional general purpose computer having processing, memory, and data storage abilities. Database tier  contains the data that is accessed by the application logic in application tier . Database server  manages the data, its structure and the operations that can be performed on the data and\/or its structure.","Application server  can include applications such as a corporation's scheduling, accounting, personnel and payroll applications, for example. Application server  manages requests for the applications that are stored therein. Application server  can also manage the storage and dissemination of production versions of application logic. Database server  manages the database(s) that manage data for applications. Database server  responds to requests to access the scheduling, accounting, personnel and payroll applications' data, for example.","Connection  is used to transmit data between client tier  and application tier , and may also be used to transfer the application logic to client tier . The client tier can communicate with the application tier via, for example, a Remote Method Invocator (RMI) application programming interface (API) available from Sun Microsystems\u2122. The RMI API provides the ability to invoke methods, or software modules, that reside on another computer system. Parameters are packaged and unpackaged for transmittal to and from the client tier. Connection  between application server  and database server  represents the transmission of requests for data and the responses to such requests from applications that reside in application server .","Elements of the client tier, application tier and database tier (e.g., client , application server  and database server ) may execute within a single computer. However, in a typical system, elements of the client tier, application tier and database tier may execute within separate computers interconnected over a network such as a LAN (local area network) or WAN (wide area network).","Security Measures","Smart cards and other identification techniques are used in environments like the multi-tier application architecture as a security measure to insure of the user when he\/she logs into a computing device on the client tier. Once identified, data on the database tier and applications on the application tier may be used. One advantage associated with using a smart card or other identification technique is that no matter where the computing device is located on the client tier, the same data and applications that the user needs, or was using before his\/her last log-off, can be retrieved.","In many cases, the identification technique involves the presentation of a secret that only the cardholder knows. Sometimes this secret is called a PIN. Since the smart card itself has no mechanism for interacting with a human being (i.e., no keyboard or display), it requires the system it is being used with to provide the human I\/O facilities to prompt the cardholder for a PIN and to accept the cardholder's input of the PIN, typically on a keyboard or other suitable input device.","Application Protocol Data Units (APDU)","Application communicate with smart cards using a data encapsulation protocol called APDU. The format of an APDU is described in the ISO standards document ISO-7816. In general, an APDU comprises a header, instructions that tell the smart card what to do, and information regarding whether data is supposed to be returned. A PIN is generally presented to the smart card as a part of an APDU transaction. The PIN is embedded in the APDU in a format that the card understands. By understanding the format, the card is able to verify the PIN and can perform some function for the user, such as releasing data out of the smart card or otherwise performing a calculation for the user.","Since the PIN is a very sensitive piece of information that is ideally known only by the cardholder, the PIN must be protected from interception. One solution is to provide a smart card reader with a built in key pad used to enter the PIN. The PIN is retained inside he reader for the duration of the transaction required to format an APDU with the PIN embedded in it and to send that APDU to the smart card. This solution, however, only solves part of the problem. In particular, it does not permit an application executing outside of the card reader to send an APDU to the reader that the smart card requires for presentation of the PIN, without actually specifying the PIN itself in the APDU. This is disadvantageous because specifying the PIN itself makes it vulnerable to interception. In addition, there are multiple types of smart card families, and each requires presentation of the PIN in a different manner, which makes compatibility difficult.","The present invention is directed toward using patterns in APDU to perform identification data substitution. According to one embodiment of the present invention, a user inserts a smart card into a card reader connected to a client computing device. Then, the client device constructs an APDU by removing the portions in the APDU where the PIN goes and replacing those portions with patterns.","Next, the user enters a PIN to the card reading device when prompted. The PIN is embedded into a new APDU constructed by the card reading device by using the patterns and replacing them with the actual PIN. The new APDU is then presented to the smart card where it can be verified without ever being sent from the application to the card reader where it might be compromised.","In one embodiment, a generic application executing outside the card reader is used to construct an APDU by locating the areas in the APDU where the PIN goes and substituting a pattern there. In one embodiment, the pattern comprises an instruction telling the card reader to put the APDU in most significant bytes first. In another embodiment, the pattern comprises an instruction telling the card reader to put the APDU in ASCII versus binary.","The APDU is then sent to the reader, where the reader itself prompts the user for entry of the PIN and verifies the PIN by applying it to the original APDU having the patterns. Using the APDU with patterns and the PIN, a new prototype APDU is constructed inside the card reader and presented to the smart card. In one embodiment, the invention is applied to other verification techniques, such as biometric identification, where the biometric data is transformed into digital information and embedded into the APDU as well.","The invention relates to using patterns in APDU to perform identification, data substitution. In the following description, numerous specific details are set forth to provide a more thorough description of embodiments of the invention. It will be apparent, however, to one skilled in the art, that the invention may be practiced without these specific details. In other instances, well known features have not been described in detail so as not to obscure the invention.","APDU Patterns","One embodiment of the present invention is shown in . At step  a user inserts a smart card into a card reader connected to a client computing device. The client computing device may be a general purpose computer, a thin-client computing device, a personal digital assistant, or any other computing device that may be coupled to a card reader an exchange information to and from the card reader. The client device constructs an APDU at step .","The APDU contains special patterns where the identification data is normally embedded. The patterns specify to the card reader where and in what format the PIN should be embedded into a prototype APDU that the card reader constructs. At step , the card reader prompts the user for entry of the PIN. At step , the APDU is examined by the card reading device for the special patterns. At step , the prototype APDU is constructed by replacing the PIN in the areas where the patterns existed in the old APDU, and the new APDU is presented to the smart card for verification at step .","Generic Application","Another embodiment of the present invention allows a generic application to interface with the card reader. A generic application is a computer program that executes outside the smart card reader and interfaces with the card reader in a secure manner. This embodiment is shown in . At step  a user inserts a smart card into a card reader connected to a client computing device. Then, the user accesses a generic application at step  which constructs an APDU at step  which contains the special patterns where the PIN normally goes. At step , the card reader prompts the user for entry of the PIN. At step , the APDU is examined by the card reading device for the special patterns. At step , a prototype APDU is constructed by replacing the PIN in the areas where the patterns existed in the old APDU, and the new APDU is presented to the smart card for verification at step .","Another embodiment of the present invention is shown in . At step  a user inserts a smart card into a card reader connected to a client computing device. Then, the user accesses a generic application at step  which constructs an APDU at step  which contains special patterns with instructions telling the reader to put the prototype APDU in most significant bytes first. At step , the card reader prompts the user for entry of the PIN. At step , the APDU is examined by the card reading device for the special patterns. At step , a prototype APDU is constructed by replacing the PIN in the areas where the patterns existed in the old APDU, and the new APDU is presented to the smart card for verification at step .","Another embodiment of the present invention is shown in . At step  a user inserts a smart card into a card reader connected to a client computing device. Then, the user accesses a generic application at step  which constructs an APDU at step  which contains special patterns with instructions telling the reader to put the prototype APDU in ASCII versus binary. At step , the card reader prompts the user for entry of the PIN. At step , the APDU is examined by the card reading device for the special patterns. At step , a prototype APDU is constructed by replacing the PIN in the areas where the patterns existed in the old APDU, and the new APDU is presented to the smart card for verification at step .","Biometric Identification","One embodiment of the present invention uses a biometric identification as the form of identification data. This embodiment is shown in . At step  a user presents a biometric form of identification to a verification device connected to the client computing device. The biometric identification may be a fingerprint, a retinal scan, a voice identification, or other technique. The client device constructs an APDU at step . The APDU contains special patterns where the identification data is normally embedded. At step , the APDU is examined by the verification device for the special patterns. At step , the prototype APDU is constructed by replacing the PIN in the areas where the patterns existed in the old APDU, and the new APDU is verified at step .","Smart Card Architecture",{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 6","b":["600","605","610","615","620","625","630","635","650"]},"In one embodiment, the smart card has the ability to have software downloaded into its non-volatile memory where it can execute the program by moving it to RAM where the smart card will act according to the instructions of the computer software. The smart card further has a communications channel  between the processor and an external source  such as a host computer, for instance, to receive an APDU from a smart card reader.","The processor in the smart card is configured to retain information within the smart card that is secret. For instance, a secret key in the smart card will never be divulged cross the communications channel . The smart card will, however, allow information to come in across the communication channel and use the data. For instance, the smart card is configured to receive data from an external source across the communications channel, to use the secret key in the smart card, for example to sign and encrypt the incoming data, and to send the results out along the communications channel  to the external source .","Virtual Desktop System Architecture",{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 7","b":["700","710"]},"The functionality of the virtual desktop system is partitioned between a display and input device such as a remote system and associated display device, and data sources or services such as a host system interconnected to the remote system via a communication link. The display and input device is a human interface device (HID). The system is partitioned such that state and computation functions have been removed from the HID and reside on data sources or services. One or more services communicate with one or more HIDs through a communication link such as network. An example of such a system is illustrated in , wherein the system comprises computational service providers  communicating data through communication link  to HIDs .","The computational power and state maintenance are provided by the service providers or services. The services are not tied to a specific computer, but may be distributed over one or more traditional desktop systems such as described in connection with , or with traditional servers. One computer may have one or more services, or a service may be implemented by one or more computers. The service provides computation, state and data to HIDs and the service is under the control of a common authority or manager. In , the services are provided by computers , , and . In addition to the service , a central data source can provide data to the HIDs from an external source such as for example the Internet or world wide web. The data source can also be broadcast entities such as those that broadcast data (e.g., television and radio signals).","Examples of services include X11\/Unix services, archived or live audio or video services, Windows NT service, Java\u2122 program execution service and others. A service herein is a process that provides output data and response to user requests and input. The service handles communication with an HID currently used by a user to access the service. This Includes taking the output from the computational service and converting it to a standard protocol for the HID. The data protocol conversion is handled by a middleware layer, such as the X11 server, the Microsoft Windows interface, video format transcoder, the OpenGL\u00ae interface, or a variant of the java.awt.graphics class within the service producer machine. The service machine handles the translation to and from a virtual desktop architecture wire protocol described further below.","Each service is provided by a computing device optimized for its performance. For example, a machine, such as an Enterprise class machine, may be used to provide X11\/Unix service, a Sun MediaCenter\u2122 may be used to provide video service, a Hydra based NT machine may provide applet program execution services. The service providing computer system can connect directly to the HIDs through the interconnect fabric. It is also possible for the service producer to be a proxy for another device providing the computational service, such as a database computer in a three-tier architecture, where the proxy computer might only generate queries and execute user interface code.","The interconnect fabric can comprise any of multiple suitable communication paths for carrying data between the services and the HIDs. In one embodiment the interconnect fabric is a local area network implemented as an Ethernet network. Any other local network may also be utilized. The invention also contemplates the use of wide area networks, the Internet, the world wide web, and others. The interconnect fabric may be implemented with a physical medium such as a wire or fiber optic cable, or it may be implemented in a wireless environment.","The interconnect fabric provides actively managed, low-latency, high-bandwidth communication between the HID and the services being accessed. One embodiment contemplates a single-level, switched network, with cooperative (as opposed to completing) network traffic. Dedicated or shared communications interconnects maybe used in the present invention.","The HID is the means by which users access the computational services provided by the services.  illustrates HIDs ,  and . Each HID comprises a display , a keyboard , mouse , and audio speakers . The HID includes the electronics need to interface these devices to the interconnection fabric and to transmit to and receive data from the services.","A block diagram of an example embodiment of the HID is illustrated in . The components of the HID are coupled internally to a bus . Network control block  communicates to the interconnect fabric, such as an Ethernet, through line . An audio codec  receives audio data on interface  and is coupled to network control block . Universal serial bus (USB) data communication is provided on lines  to a USB controller . The HID further comprises a embedded processor  such as a Sparc2ep processor with coupled flash memory  and dynamic random access memory (DRAM) . The USB controller , the network control block  and the embedded processor  are all coupled to the internal bus . A video controller , also coupled to the internal bus , can include an ATI RagePro+ frame buffer controller which provides. Super video graphics array (SVGA) output on the line . National television standards committee (NTSC) data is provided in and out of the video controller through video decoder  and encoder  respectively. A smartcard interface  may also be coupled to the video controller .","Alternatively, the HID can comprise a single chip implementation as illustrated in . The single chip includes the necessary processing capability implemented via CPU  and graphics renderer . Chip memory  is provided, along with video controller\/interface . Universal serial bus (USB) controller  is provided to permit communication to a mouse, keyboard and other local devices attached to the HID. A sound controller  and interconnect interface  are also provided. The video interface shares memory  with the CPU  and graphics renderer . The software used in this embodiment may reside locally in non-volatile memory or it can be loaded through the interconnection interface when the device is powered.","The operation of the virtual desktop system architecture is described in co-pending U.S. patent application Ser. No. 09\/063,335, filed Apr. 20, 1998, entitled \u201cMethod and Apparatus for Providing A Virtual Desktop System Architecture\u201d and assigned to the present assignee, and incorporated herein by reference.","APDU Patterns Message Format","In one embodiment, a server issues a READ command to an SCbus drive in a desktop unit (DTU) or HID. One example of a message format for embedding PIN patterns obtained from the user during a PIN entry operation based on this command is shown below. In the example, the HexDump format is used. This format is a human readable 2 byte ASCII representation of 1 binary byte. Literally any of the 2 bytes concatenations generated by choosing two characters from the following:\n\n","Using this scheme, the decimal value 131 is represented as \u201c59\u201d.","During PIN entry mode, a keytable mapping keys to ASCII characters should be downloaded sot that the three buffers available to applications will contain ASCII values for the PIN the use typed. The purpose of the ADPU message is to allow different PIN formats to be sent to smart cards in an application defined and flexible manner.","First, a command for exchanging an APDU is made. The command is:\n\n","The argument to APDU=follows the HexDump format, with the exception of even length substrings consisting of one of the following REGEX:\n\npattern=bufpat|bufpat|bufpat\n\nbufpat=()+\n\nbufpat=()+\n\nbufpat=()+\n\n","A substring pattern is considered to be any chain of pairs that begins with \u2018P[XYZP]\u2019 and whose every other single character is still a \u2018P\u2019.","The number of pairs \u201cPX\u201d, \u201cPY\u201d, \u201cPZ\u201d present in each pattern specifies how many bytes from the buffer and in which position they will be replaced. The first pair \u201cP[XYZ]\u201d determines the position of byte index zero in the buffer to be replaced. Subsequent pairs for the same buffer increase the index in the buffer. If the number of characters present in the buffer is smaller than the number of pairs \u201cP[XYZ]\u201d, the remaining pairs in the pattern will be considered as \u201cPP\u201d. Vice versa, substitution will occur only for those bytes as specified by the pattern.","Since there is no specific separator between patterns, if references to a buffer are intermixed with references to other buffers in the same substring, they will be considered as a continuation pattern for that buffer.","Another independent sequence has been defined consisting of the following character:","\u2018L\u2019\u2014substitutes the length of the APDU. The sequence \u201cLL\u201d is admissable in an example embodiment.","Smart Card Reader Protocol","The protocol makes use of a device manager\/remote device driver (DM\/DD) layer as transport mechanism. When the host wants to communicate with the smartcard, the EXCHANGE primitive is used, and the transfer of data follows these rules:","a) Commands are specifed as \u201cCMD=xxx\u201d as header of the string.","b) All parameters, if any, follow in the string.","c) Each parameter is a key\/value pair.","Not all operations are atomic, for example changing the PIN on a card could require asking for the old PIN, the new PIN and a second copy of the PIN as confirmation . Only if the two copies match will the APDU for writing the new PIN on the card be sent. All the while, the user may want to do other things. To address this, a small \u201clanguage\u201d is defined. All commands are atomically and sequentially executed, no two commands are in execution at the same time.","One feature is to type a PIN without sending it to the Host, but directly to the smartcard, in a sort of loopback mode. Again, this is not always possible right away, so we need a way to type a PIN and temporarily store it until it can be embedded in an APDU to the card. Some operations, like entering\/exiting the loopback keyboard mode and downloading the keymaps, are accomplished via control callback.","Typical operation requires the service to enter secure mode, download a keytable, and operate. In case a keytable has not been specified, some commands cannot execute, notably READ, CMP, APDU. The latter is a special case, since an APDU could be sent to the card independently of Secure Mode. In that case the keytable error is generated when reference to a buffer is made in the APDU itself.","An LED near the smartcard reader will blink according to the following rules as described by the Sun Service Indicator Standard which covers user-visable indicators on Sun platforms:","No LED activity","There is no readable card in the reader.","Green LED blinking","While in Secure PIN Entry Mode the blink rate should be 3\u20135 Hertz at a 50% on, 50% off duty cycle for the duration that the mode is active.","While data is being exchanged with the card, the LED shall flash at a random or intermittent rate for no less than 1 full second with the LED ending in the lit state.","Green LED fully lit","The smart card has been read and is ready (i.e. The card is still able to be accessed).","There is another primitive available via RDD, CONTROL. This call is used to initiate\/terminate Secure PIN Entry Mode, download the keytable and to signal cancellation of an operation.","For operations to be successfully carried on, the DM notification facilities are used to tell the DM service about card properties, keyboard attached to the unit and keypresses. These internal properties are embedded in a message in the format described below.",{"@attributes":{"id":"p-0088","num":"0093"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Key\/value Description for EXCHANGE"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"A sample transaction could be:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Host","DTU"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u201cCMD=APDU APDU=00B0000008\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u201cRES=760833EF PB=60 STATUS=9000\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(values random)"]},{"entry":[{},"Where I asked for a certain APDU to be sent to the card and the"]},{"entry":[{},"result is sent back along with the procedure bytes and status."]},{"entry":[{},"All described parameter and return keys have a"]},{"entry":[{},"<Key>=<value> syntax."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"CMD=","Description and values"]},{"entry":[{},"APDU","Asks for a certain APDU to be sent to the card."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Key"]},{"entry":[{},"APDU \u2003\u2003APDU's bytes as"]},{"entry":[{},"an HexDump string. Buffers are"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"referred to by \u2019X' for buffer 0, \u2019Y' for buffer 1"]},{"entry":[{},"\u2019Z' for buffer 2. Each buffer specification is"]},{"entry":[{},"prepended by \u2019P'. a byte specified as \u201cPP\u201d means"]},{"entry":[{},"a pad byte."]},{"entry":[{},"For more information, see APDUpatterns.txt"]},{"entry":[{},"\u2019L' means substitute the apdu lenght."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This pair is mandatory."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"FP","\u2003specifies in HexDump format the byte to use as pad"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This pair is optional."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"RES","the hexdump bytes from the card"]},{"entry":[{},"PB","procedure bytes"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"STATUS the status bytes"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"All return pairs are mandatory unless an error has occurred"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"READ","reads a series of keystrokes from the keyboard"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"BN","The number of the buffer where henceforth"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"keycodes will be stored. \u2019S' will be used"]},{"entry":[{},"to signal \u201cstop buffering keycodes\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"EP","Specifies options to report keypresses."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Default behaviour is to report keypresses"]},{"entry":[{},"belonging to the downloaded keytable only."]},{"entry":[{},"Values for this keyword are as follows:"]},{"entry":[{},"\u2003KS Does not send notifications back on keys"]},{"entry":[{},"\u2003\u2003presses for any key except Enter,"]},{"entry":[{},"\u2003\u2003backspace and escape"]},{"entry":[{},"\u2003NP Sends a notification each time a key not"]},{"entry":[{},"\u2003\u2003belonging to the specified key-table"]},{"entry":[{},"\u2003\u2003has been pressed"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This pair is optional."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"READ","the current buffer number."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CMP \u2003\u2003compares two the translated keycode buffers"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"BN1","first buffer number"]},{"entry":[{},"BN2","second buffer number"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Example:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CMD=CMP BN1=0 BN2=1"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CMP","\u201c1\u201d is ther is a match. \u201c0\u201d no match."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Exactly one of the two pair is acceptable."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CLR \u2003\u2003clears a buffers."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"BN","a buffer number"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"If absent all buffers are cleared."]},{"entry":[{},"Example:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CMD=CLR BN=1"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Key"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"CLR","\u201cOK\u201d."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"PAUSE \u2003Suspends keyboard loopback mode."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"No input parameters."]},{"entry":[{},"Returns:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"key"]},{"entry":[{},"PAUSE \u201cOK\u201d."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"RESUME","Re-enters keyboard loopback mode."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"No input parameters."]},{"entry":[{},"Returns:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"key"]},{"entry":[{},"RESUME \u201cOK\u201d."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Error codes for EXCHANGE"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"Some error return values are defined for cases in which parameters do not comply with the protocol. So instead of the return keyvalue pairs described above, a keypair ERR=<. . . >is returned with the following values defined:",{"@attributes":{"id":"p-0090","num":"0095"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ERR=","\u2003Description"]},{"entry":[{},"NOKT","\u2003No keytable is present. command cannot"]},{"entry":[{},{},"\u2003continue."]},{"entry":[{},"PE","In case the command is not recognized, or general"]},{"entry":[{},{},"\u2002parsing error."]},{"entry":[{},"NB","No buffer number has been specified in a READ"]},{"entry":[{},{},"command."]},{"entry":[{},"WB","An illegal buffer number has been specified."]},{"entry":[{},{},"one or more BN=xx keypairs will specify which"]},{"entry":[{},{},"buffer number is illegal."]},{"entry":[{},"MB","in case of a CMP command, one buffer number has"]},{"entry":[{},{},"not been specified."]},{"entry":[{},"NO","The unit is not operating in Secure Pin entry mode."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Key\/value Description for CONTROL"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"A sample transaction could be:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Host","DTU (Desk Top Unit)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u201cCTRL=ON\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u201cKT=060021\u201d"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"An attempt has been mad to enter Secure PIN ENtry Mode, and the unit sent back the Keytable necessary for entering a PIN.","All described parameter and return keys have a <Key>=<value> syntax.",{"@attributes":{"id":"p-0093","num":"0098"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CTRL=","\u2003\u2003Description and values"]},{"entry":["ON","\u2003Enter Secure PIN Entry Mode (this is also referred"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"to as \u201cloopback mode\u201d)."]},{"entry":[{},"Parameters:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(none)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Key"]},{"entry":[{},"KT \u2003Required Keytables,"]},{"entry":[{},"See KeytableDownloadFormat.txt"]},{"entry":[{},"for more information."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["OFF","Exit Secure PIN Entry Mode"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(none)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(none)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["KT","Downloads a Keytable"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Parameters:"]},{"entry":[{},"\u2003Key"]},{"entry":[{},"\u2003KT \u2002a keytable specification, as described in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"KeytableDownloadFormat.txt"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Returns:"]},{"entry":[{},"\u2003(none)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["INT","Interrupts the current operation"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Parameters:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(none)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Returns:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(none)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Error codes for CONTROL"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"With the exception of CTRL=ON, CONTROL messages do not use the channel to send results back, but set the return message return value as follows",{"@attributes":{"id":"p-0095","num":"0100"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["UT_SUCCESS","\u2003Command completed ok."]},{"entry":["UT_FAILURE","Keytable download did not succeed. Bad KT=syntax"]},{"entry":["UT_ACCESS","Could not enter Sesure PIN Mode."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["UT_EIO","Cannot interrupt current operation."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Keytable download did not succeed."]},{"entry":[{},"not in Secure PIN entry"]},{"entry":[{},"Mode"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["UT_NOTSUP","Wrong command"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0096","num":"0101"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Messages to the DM have the following DM format:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"sc.props=<SCBus properties>"]},{"entry":[{},"<SCBus properties> follow a format similar to the"]},{"entry":[{},"key\/value pairs as descrbied before, but since they are"]},{"entry":[{},"embedded in a more general framework, values are separated"]},{"entry":[{},"from keys by a \u2019:' instead of \u2019=' and pairs are"]},{"entry":[{},"separated by \u2019_' instead of spaces."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":{}},{"@attributes":{"id":"p-0097","num":"0000"},"ul":{"@attributes":{"id":"ul0004","list-style":"none"},"li":["device term=IEEE802.080020f56dc7 bus=sc addr=smartcard\\sc.props=sc.sn:03_sc.kbd:060021","reports a USB type 6 keyboard, US keymap."]}},{"@attributes":{"id":"p-0098","num":"0104"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"<SCBus properties>"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["sc.","Description"]},{"entry":["sn","Internal serial number."]},{"entry":["kbd","\u2003Reports keyboard suitable for downloading a keytable"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"via CTRL=KT. it is keyboard spec that appears"]},{"entry":[{},"in that control"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["keypress","\u2003\u2003Reports a keypress notification. Possible values are:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2032*\u2032 character belonging to the PIN has"]},{"entry":[{},"been pressed"]},{"entry":[{},"\u2032E\u2032 ENTER has been pressed"]},{"entry":[{},"\u2032Q\u2032 ESCAPE has been pressed"]},{"entry":[{},"\u2032B\u2032 BACKSPACE has been pressed"]},{"entry":[{},"\u2032N\u2032 a character not belonging to the PIN has"]},{"entry":[{},"been pressed"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["status","Tells SmartCard reader status. Values:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"in \u2003a smartcard is in the reader or recognized"]},{"entry":[{},"out \u2003a smartcard is not present or has"]},{"entry":[{},"been removed"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["atr","Reports the SmartCard ATR in HexDump format"]},{"entry":["atr.hs","\u2003ATR History, HexDump format."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and other features, aspects and advantages of the present invention will become better understood with regard to the following description, appended claims and accompanying drawings where:",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 11"}]},"DETDESC":[{},{}]}
