---
title: Control device, control method and medium
abstract: The using circumstances of a control object device are detected, and controlling of the control object device is carried out on the basis of the detected result. Thereby, where control equipment in conformity to a fixed standard, control equipment not in conformity to a fixed standard, and a control object device are mixed in a network, there can be avoided inconvenience in which the respective control equipment control the control object devices simultaneously.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06925500&OS=06925500&RS=06925500
owner: Sony Corporation
number: 06925500
owner_city: Tokyo
owner_country: JP
publication_date: 20001010
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND ART","DISCLOSURE OF THE INVENTION","BEST MODE FOR CARRYING OUT THE INVENTION","INDUSTRIAL APPLICABILITY"],"p":["The present invention relates to control apparatus and method, medium, and to control apparatus and method, medium, for example, for carrying out the resource management when equipment connected to an IEEE1394 bus is controlled.","Recently, the IEEE (Institute of Electrical and Electronic Engineers) 1394 high speed serial bus has been popularized. A plurality of nodes (for example, such as a digital AV (audio visual) equipment can be connected to the IEEE (Institute of Electrical and Electronic Engineers) 1394 high speed serial bus (hereinafter merely referred to as IEEE1394 bus), and information can be delivered and received between the nodes. Out of nodes connected to the IEEE1394, the node for controlling other nodes is called a controller, and the node controlled by the controller is called a target.","In the transmission standard of IEEE1394, a signal format and an AV\/C command for controlling equipment are provided. However, in the transmission standard of IEEE1394 alone, for example, where two pieces of digital AV equipment are connected one to one, no problem occurs, but where three pieces or more are connected one another, there gives rise to a problem. For example, where there is simultaneous control of three nodes or more, and there is a plurality of nodes (controllers) for controlling other equipment (target), there gives rise to a problem that it is difficult or realize to offer mediation between the control nodes (controllers) and to attain development of application softwares in which compatibility is present between nodes.","On the other hand, recently, for the purpose of making the most of characteristics of IEEE1394 capable of actually providing data transmission speed at a high speed and at relatively low cost and capable of solving the problem, the technique called HAVi (Home Audio\/Video interoperability) has ben developed.","The HAVi will be described briefly hereinafter.","With the recent conspicuous growth of digital AV equipment market, it is expected that the time will come in future when users can connect the equipment to construct a network in individual home. Accordingly, in order that the equipment on the home network cooperate and operate, each equipment need be provided with a middle ware for control and management of the network. Further, even where equipment of different makers are connected, in order that the network normally operates and the equipment can be used mutually, a common specification to which the middle ware should conform is indispensable thereto.","The HAVi is contemplated as a specification for AV equipment corresponding to the home network making use of IEEE1394. The software in conformity to the HAVi functions as a middle ware arranged between an application and OS (Vendor Specific Platform) in collecting functions used in common for an application as shown in , and in digital AV equipment in conformity to the HAVi on which the former is mounted, mutual use between equipment and mutual utilization of function become enabled. The HAVi has characteristics having a plug and play, mutual operability of equipment, and expandability of a network. Accordingly, when equipment in conformity to HAVi is connected to a network, the software in conformity to HAVi immediately detects the connection of equipment automatically due to the pug and play function, whereby the procedure as the network is taken to realize the expandability with respect to the function of equipment connected.","That is, in the HAVi, a user merely connects various equipment, due to the plug and play function, by a digital interface such as IEEE1394 to enable construction of a home network. Accordingly, even where for example, new equipment is connected to or removed from the network, the equipment can communicate each other to recognize that the network be updated, so that the network can correspond to an arrangement of new equipment without stopping the function.","Further, in the equipment based on the HAVi specification, not only mutual connection and mutual operation between equipment but also co-owning of function between equipment on the network become enabled due to the mutual operability of equipment. For example, by operating certain equipment, it is possible to make use of function of other equipment not possessed by the former.","Furthermore, in the HAVi, the expansion of function is possible such that a new function used in a future new home network application is used on the home network already used by a user, due to the expandability of the network. That is, the specification of HAVi defines the function that usable application programs and user interface softwares in other equipment are incorporated into the own through the network to use them, enhancing the way of pleasure and the convenience of new AV equipment as home network equipment, and having the expandability corresponding to the function to be effective in future. Accordingly, where new equipment or function is developed, that equipment is merely connected to the network already constructed to enable operation thereof.","As described above, the HAVi is possible to detect or control equipment in conformity to HAVi despite the difference in equipment makers, and further, the HAVi application is possible to control individual devices in different equipment. For example, as equipment such as a digital VTR and an audiophile, there can be listed a tuner, a display, an Amp, a stream converter, a clock function, an internet access function, and a modem. According to HAVi, for example, these devices can be operated directly from an application such as a set top box (STB).","The HAVi specification is determined in order to correspond to various requests of the home network in the digital AV environment based on the IEEE1394, and the basic specification thereof defines the exchange of messages and events on the IEEE1394, the ability detection of devices over the whole network and registration, and softwares for management of a digital AV stream and control of devices. As a byte code of the HAVi, Java (Trademark) is employed in order to realize the devices on the network and functions thereof, without depending on a platform, and a bidirectional application and a user interface can be provided. The application in conformity to HAVi based on the Java is loaded on the device to enable download through the modem and the internet. Further, in the HAVi, a resource manager is loaded to process a conflict of the using right of devices, manage a scheduled event such as reserved telerecordings of digital VTR, and monitor a network whether or not a device is removed after registration.","Main software elements defined in the HAVi basic specification include, as shown in , CMM (IEEE1394 Communication Media Manager), EM (Event Manager), Registry, MS (Messaging System), DCM (Device Control Module), DCM manager, DDI controller (Data Driven Interaction Controller), SMGR (Stream Manager), and Resource Manager.","The CMM functions as an interface between the IEEE1394 and each software element.","The EM informs other software elements about the status change of the network (for example, equipment is newly connected to or disconnected from the network).","The MS functions as an API (Application Programming Interface) in which software elements of equipment on the network communicate each other. It is noted that API is an interface positioned between an application and OS or a middle ware.","The DCM control equipment. An application program controls equipment through the DCM. For this reason, the application program itself need not consider the difference between the individual equipment.","The DCM manager updates DCM. When new equipment is additionally connected to the network, DCM necessary for the equipment is newly added to automatically correspond to updating of the network.","The registry controls and store information about the software module.","The DDI controller takes charge of GUI (Graphical User Interface) of a display bock of equipment. This corresponds to a variety of displays from a display of a text alone to a display of graphics.","The SMGR monitors and manages a flow of stream data of IEEE1394 such as a picture and a voice or sound on the network.","The resource manager manages the resource of the network.","The HAVi classifies the device on the network into four categories, i.e. FAV (Full AV Device), IAV (Intermediate AV Device), BAV (Base AV Device), and LAV (Legacy AV Device).","That is, as shown in , the FAV is a device provided with all software elements (all elements marked by check marks in the figure) of HAVi; the IAV is a device provided with software elements (elements marked by check marks in the figure) other than the executing environment of the byte code of Java; the BAV is a device for supporting only HAVi SDD (HAVi Self Describing Device) data and DCM; and LAV is a device other than IEEE1394 not corresponding to HAVi or IEEE1394. It is noted that in the figure, softwares in which a check mark is surrounded by [ ] are option, indicating that the software element may not be provided as the case may be.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 23","FIG. 23"]},"Incidentally, there is contemplated a case where a target corresponding to LAV mentioned in HAVi capable of delivering and receiving an AV\/C command of IEEE1394, a controller corresponding to LAV mentioned in HAVi capable of delivering and receiving an AV\/C command of IEEE1394, and a controller corresponding to FAV and LAV mentioned in HAVi are present in the same network.","For example, where the controller corresponding to the LAV and the controller in conformity to the HAVi simultaneously control a single LAV on the network as a target, the LAV as the target is to be controlled by a plurality of controllers to possibly give rise to inconvenience.","For example, as shown in , where STB (Set Top Box)  which is LAV mentioned in HAVi, STB  which is FAV mentioned in HAVi, and digital VTR (for example, such as digital VHS)  which is LAV mentioned in HAVi are such that in the network connected by the IEEE1394 bus, both the STB  and STB  operate as a controller, and the digital VTR  is a target, when these two STB  and  attempt to carry out operation of the digital VTR  simultaneously, confliction occurs. That is, since STB  operated as a controller is LAV, it is not put under an obligation to have a resource manager, and since LAV is not a model in conformity to HAVi, it is not put under an obligation to carry out communication between controllers, thus giving rise to confliction. For example, where in the midst of telerecording by the digital VTR  by the control from one STB , a stop command is supplied from the other STB , the digital VTR  becomes stopped despite the telerecording is in the midst.","Accordingly, where a plurality of controllers capable of controlling a single target are present on the network, and a controller which is LAV not in conformity to HAVi is present in the controllers, there occurs inconvenience that the single target is controlled by the plurality of controllers unless some resource managements are carried out.","Also in the case of network as shown, for example, in , in addition to the  example, confliction occurs.","That is, where a controller  which is FAV having FCM for LAV corresponding to a reserve command, a controller  which is FAV, and a target  which is LAV not corresponding to a reserve command are a network connected by IEEE1394 bus, as shown in the example of , since the target  is LAV and does not correspond to the reserve command, even if the controller should have a resource manager, resource management could not be done. Accordingly, when these two controllers  and  attempt to carry out operation of the target , confliction similar to that mentioned above occurs.","Where a controller  having FCM for BAV not corresponding to a reserve command, a controller  which is FAV, and a target  which is BAV not corresponding to a reserve command are a network connected by IEEE1394 bus, as shown in the example of , since the target  is BAV of a model in conformity to HAVi but does not correspond to the reserve command, even if the controller should have a resource manager, resource management could not be done. Accordingly, even if all the networks should be constructed by the model in conformity to HAVi, when these two controllers  and  attempt to carry out operation of the target , confliction similar to that mentioned above occurs.","Further, where in a network in which a controller  which is LAV without resource manager, a controller  which is likewise IAV without resource manager, and a target  which is LAV or BAV (BAV having own DCM, FCM) are connected by IEEE1394 bus, as shown in the example of , the controllers make reservations at a target, since both the controllers  and  are LAV and have not source manager, the resource management cannot be done. Accordingly, when these two controllers  and  attempt to carry out operation of the target , confliction similar to that mentioned above occurs.","Where a control object device which is a target is under the control of single equipment which is a controller, all control request from other control equipment are eliminated whereby confliction of control between control equipment can be avoided. However, by the mere response of the elimination to the control requests, the aforementioned other control equipment cannot distinguish whether the state that the control equipment occupies the control object device or the state that the control object device cannot be controlled for separate reasons. For example, where the digital VTR  in the  example receives a control request of reproduction in a power-off state, it repeats a response representative of rejection despite control is not occupied by anybody. Accordingly, the control equipment is necessary to know the state of the control object device in further detail.","Further, in the case of a network constructed by merely by LAV on which a resource manager is not actually mounted, since the respective LAV has no resource manager representative of the occupied state of a control object device, it is not possible to know whether or not certain control equipment obtains possessory rights to control the control object device.","Moreover, in the case of a network system having no equipment in conformity to HAVi, since a function representative of the occupied state of the control object device is not present, the respective control equipment cannot know easily the occupied state of control of the control object device.","The present invention has been accomplished in view of the circumstances noted above, and has its object to provide a control apparatus and method, medium wherein even in the case where control equipment in conformity to a fixed standard, control equipment not in conformity to a fixed standard, and a control object device capable of being controlled by the control equipment are mixed on a network, inconvenience that these control equipment simultaneously control the control object device not in conformity to a fixed standard can be avoided.","The control apparatus and method according to the present invention detects the using circumstances of the control object device to control the control object device on the basis of the detected result whereby solving the above-mentioned problem.","As the above-described control object device, there can be listed, as examples, recording and or reproducing equipment, a digital versatile disc device, a digital video cassette recorder, a tape coder, a compact disc device, a minidisc device, office selecting equipment, an amplifier and so on.","Further, the control apparatus and method according to the present invention judges whether or not the control object device is usable on the basis of the detected result, and when judged to be unusable, an alarm signal is produced, the alarm signal capable of being displayed. In judging whether usable or unusable, it is possible to judge whether or not the control object device is usable on the basis of the result of decision of presence or absence of the setting of the possessory rights or of the detected result.","Further, in the control apparatus and method according to the present invention, the status change of the control object device is detected, and the using circumstances of the control object device is detected in accordance with the detected result of the status change. Or, the using circumstances of the control object device may be detected from the status itself of the control object device. As the status change of the control object device, there can be listed a change of a control status value of a disc device or a change of a control status value of a tape device or a change of a control status value of a semiconductor device, a change of a value of a record passage time counter or a change of a value of a reproducing passage time counter, a change of a value of a tape counter or a change of a field value or a change of a track number, and an office number as the status itself.","Furthermore, in the control apparatus and method according to the present invention, the detection of the using circumstances of the control object device can be carried out every given time. Further, the control apparatus and method according to the present invention decide the presence or absence of the setting of possessory rights with respect to the control object device, and when the decision of possessory rights with respect to the control object device cannot be done, the detection of the using circumstances of the control object device is also carried out. Further, whether or not the control object device is usable is judged on the basis of the result of decision of the presence or absence of the setting of the possessory rights or the detected result. The decision of the presence or absence of the setting of the possessory rights is carried out on the basis of a fixed standard. As the fixed standard, there can be listed an IEEE1394 Standard, and the network can be an IEEE1394 bus.","Further, in detecting the using circumstances, performed are that ON\/OFF of a power supply of the control object device is judged, and in accordance with the result of the judgment of the state of a power supply, the using circumstances of the control object device is detected; that whether the control object device is recording and\/or reproducing equipment is judged, and the using circumstances of the control object device is detected in accordance with the result of the equipment judgment; and that whether or not the control object device is office selecting equipment is judged, and the using circumstances of the control object device is detected in accordance with the result of the equipment judgment. When the control object device is the recording and\/or reproducing equipment, whether or not the status of the recording and\/or reproducing equipment is decided is judged whereby the using circumstances of the recording and\/or reproducing equipment is detected, and when the control object device is the office selecting equipment, whether or not the office selecting status of the office selecting equipment is decided is judged whereby the using circumstances of the office selecting equipment is detected.","The control object device is one or all equipment except the own connected on the network.","Next, the medium according to the present invention causes an information processing apparatus to execute a program which includes a step of detecting the using circumstances of a control object device and a step of controlling the control object device on the basis of the result of the detection.","The preferred embodiments of the present invention will be describe hereinafter with reference to the drawings.",{"@attributes":{"id":"p-0075","num":"0074"},"figref":["FIG. 1","FIG. 1"],"b":["24","22","23","21"]},"In this constitution, the digital VTR  is a target, and the set top box  and the LAV controller  are controllers for controlling the digital VTR .","The set top box  receives an electric wave broadcast from a satellite not shown through a parabola antenna  to output it to an IRD (Integrated Receiver\/Decoder) module . The IRD module  decodes and processes a signal supplied from the parabola antenna . An application module  controls The IRD module  and an IEEE1394 module  in response to an operating signal generated when a remote controller (not shown) or an operating panel  provided on the main body of the set top box  is operated by a user. The IEEE1394 module  executes interface processing with respect to the IEEE1394 bus . The application module , the IRD module. , and the IEEE1394 module  are respectively modules in conformity to HAVi, and in , the modules in conformity to HAVi are shown collectively as a HAVi module group .","Further, the set top box  is provided with a control object device monitoring function section  for monitoring the control status of a control object device such as LAV connected to the IEEE1394 bus . The detailed operation of the control object device monitoring function section  will be described later.",{"@attributes":{"id":"p-0079","num":"0078"},"figref":"FIG. 2","b":["24","23","41","24","51","31","71","52","52","51","53"]},"The descramble circuit  descrambles data supplied from the front end part  on the basis of code key information of a contract channel stored in an IC card (not shown) mounted on the IRD module , and outputs it to a demultiplexer . The demultiplexer  rearranges data supplied from the descramble circuit  every channel, removes a component of the channel corresponding to a command from CPU  (a command from a user), outputs a video stream comprising a video packet to a MPEG (Moving Picture Experts Group) video decoder , and outputs an audio stream comprising an audio packet to a MPEG audio decoder .","The MPEG video decoder  decodes the video stream input and outputs it to a NTSC encoder . The NTSC encoder  converts video data input from the MPEG video decoder  into video data of the NTSC system, further D\/A converts it into a D\/A converter circuit , and outputs it to a monitor .","The MPEG audio decoder  decodes the audio stream supplied from the demultiplexer  in the MPEG system, restores PCM (Pulse Code Modulation) audio data before being compressed and coded, and outputs it to a D\/A converter circuit . The D\/A converter circuit  converts the PCM audio data into an analog audio signal of a left channel and an analog audio signal of a right channel to supply them to a loudspeaker (not shown) of the monitor .","The output of the MPEG audio decoder  is input into an IEEE1394 interface  of the IEEE1394 module , and enables outputting it to the IEEE1394 from the IEEE1394 interface , if necessary.","In this embodiment, the application module  is composed of a CPU for controlling parts of the set top box , a RAM (Random Access Memory) , and a work RAM .","In the RAM , programs processed by the CPU  are suitably developed. In the work RAM  are suitably stored data required in executing various processes by the CPU .","In this embodiment, the IEEE1394 is composed of an IEEE1394 interface .","On the other hand, in the digital VTR , a mechanical section  is provided with a mechanism for recording and reproducing a digital audio signal and a digital video signal, operation of which is controlled by a mechanical control CPU .","The digital audio signal and the digital video signal reproduced from a video tape in the mechanical section  are sent to a signal processing circuit .","Further, in the digital VTR , an analog video signal, a ground wave television signal, and for example a BS (satellite broadcast) signal can be input into a terminal , a terminal , and a terminal , respectively. The ground wave television signal and the BS signal are suitably selected by a changeover switch  and received by a BS\/ground wave tuner . A BS signal or a ground wave television signal output from the BS\/ground wave tuner  and an analog video signal are sent to the signal processing circuit  suitably selected by a changeover switch .","The signal processing circuit  applies signal processing corresponding to a signal selected out of the analog vide signal, BS signal and ground wave television signal, or a digital audio signal and a digital video signal reproduced from a video tape by the mechanical section , and a digital audio signal and a digital video signal supplied through the IEEE1394 if necessary to produce an audio signal and a video signal to be output to a television set. Where the digital VTR  is a VTR provided with a function corresponding to the MPEG encode and decode processing, the signal processing circuit  also takes charge of the MPEG encode and decode processing. The audio signal and the video signal produced by the signal processing circuit  is sent to a television set connected to a terminal .","A mode control CPU  of the digital VTR  control parts of the digital VTR . The mode control CPU  executes various processes on the basis of data and programs suitably stored in RAM.","An IEEE1394 interface  executes interface processing with respect to the IEEE1394 bus . The IEEE1394 interface  delivers control data supplied, for example, from the set top box  and the LAV controller  to the mode control CPU  through the IEEE1394 bus . The IEEE1394 interface  outputs a digital audio signal and a digital video signal supplied, for example, from the set top box  to the signal processing circuit  through the IEEE1394 bus .","It is noted that both the set top box  as a controller and the LAV controller  which is LAV are possible to control the digital VTR  which is LAV. Accordingly, where the set top box  and the LAV controller  simultaneously control the digital VTR  as a target, there possibly occurs inconvenience that the digital VTR  is simultaneously controlled by the set top box  and the LAV controller .","In view of the above, in the present embodiment, by the provision of the control object device monitoring function section  in the set top box  corresponding to FAV and IAV mentioned in HAVi, it is possible to avoid the occurrence of simultaneous control with respect to LAV as mentioned above.","That is, in the present embodiment, the control object device monitoring function section  of the set top box  inquires about statuses of devices connected to the IEEE1394 bus  to thereby monitor whether the present status of a device (a control object device) intended to be controlled as a target by the set top box  is the status placed under the control (under the operation) of other equipment, result of which is fed back to the HAVi module group , and further, the HAVi module group  displays, upon receipt of the monitoring result, to give a user on the set top box  side a warning, for example, thereby enabling avoidance of occurrence of the above-described inconvenient in advance.","Now, the control object device monitoring function section  performs, as an example of a concrete procedure for realizing the control object device monitoring function, detection if, by polling the status of a target, the target is controlled by the other equipment at present. The control object device monitoring function section  in the present embodiment also performs judgment, prior to the above-described detection, if the possessory rights of equipment caused by a reserve command out of AV\/C commands in the IEEE1394 are already set to the target. If the possessory rights caused by the AV\/C reserve command is not set, the above-described detection is carried out. In the case of the present embodiment, where whether or not the control object device caused by the reserve command is reserved is unclear, monitoring of the using circumstances of the control object device becomes more positive by using the above-described detecting means, but the monitoring of the using circumstances of the control object device is enabled even merely by the above-described detecting means. The reserve command in the AV\/C command will be described in detail later.",{"@attributes":{"id":"p-0097","num":"0096"},"figref":"FIG. 3","b":["40","24"]},"In , the control object device monitoring function section  inquires, first, as the processing of Step S, of the individual control object devices connected to the IEEE1394 bus  about the possessory state by the reserve status command, and then, judges, as the processing of Step , if being occupied, or not occupied, or unclear, or making re-inquiry, depending on the contents of the response from the individual control object devices. Where the response is stable, and the return value within the response packet is one other than \u201c0\u201d which is a value defined in the AV\/C command, judgment is made to be occupied. On the other hand, where the response is stable, and the return value within the response packet is \u201c0\u201d which is a value defined in the AV\/C command, judgment is made not to be occupied. On the other hand, where the response is \u201cnot implement\u201d and \u201crejected\u201d, and where the response is not returned and the fixed response-waiting time has passed, judgment is made to be unclear. Where the response is in transition, an inquiry is made again by the reserve status command.","In the Step S, where the control object device having been judged to be reserved is present, that is, where the control object device is present which is judged that the response to the issue of the reserve status command is stable, the return value within the response packet is a value other than \u201c0\u201d and the possessory rights of equipment is already set, the control object device monitoring function section  puts up, as the processing of Step S, \u201c1\u201d on a flag showing that the control object device is already controlled by other equipment (called a flag during control in the present embodiment).","On the other hand, where in the Step S, in the case of the control object device having been judged not to be reserved by the reserve status command, that is, in the case of the judgment in which the return value within the response packet with respect to the reserve status command is \u201c0\u201d and the possessory rights of equipment is not set, the control object device monitoring function section  proceeds to the processing of Step S, and puts up a flag during control showing that the control object device is not controlled.","Further, in Step S, where the control object device is present which cannot be judged, depending on the reserve status command, whether or not the reservation is made, that is, where the response is \u201cnot implemented\u201d and \u201crejected\u201d, or where the response is not returned to make judgment that the fixed waiting time has passed and being unclear, the control object device monitoring function section  proceeds to the processing of Step S. Where the response is \u201cin transition\u201d, the procedure proceeds to Step  in order to make reinquiry by the reserve status command.","In the processing of Step S, the control object device monitoring function section  judges, by the detection, whether or not the control object device is controlled by other equipment. That is, in this case, the control object device monitoring function section  tries to make polling the status of the control object device thereby making detection whether or not the device is controlled by other equipment. The detailed flow of the Step  will be described later. In the Step S, where judgment is made such that the device is controlled by other equipment (where detection is made that control is present), the control object device monitoring function section  puts up, as the processing of Step S, \u201c1\u201d on a flag during control showing that the control object device is already controlled by other equipment.","On the other hand, in the Step S, where judgment is made such that the device is not controlled by other equipment (where detection is made that control is absent), the control object device monitoring function section  puts up, as the processing of Step S, \u201c0\u201d on a flag during control showing that the control object device is not controlled by other equipment.","Next,  shows a detailed flow of the processing of Step  in .","First, the control object device monitoring function section  clears (initializes), as Step  of , both values of a status change counter for counting the status change of the control object device and a detection counter for counting the number of times of monitoring operation to \u201c0\u201d. The status change of the control object device is different depending on to which the control object device belongs. For example, where the control object device is a disc device, the status change is a change of control status value of the disc device, where the control object device is a tape device, the status change is a change of control status value of the tape device, and where the control object device is a semiconductor device, the status change is a change of control status value of the semiconductor device. As more concrete examples of the status changes of the control object device, there can be listed, for example, such as a change of a recording passage time counter in a recording and reproducing device, a change of a reproducing passage time counter, a change of a frame value, a change of a field value, a change of a track number, a change of a tape counter value in case of a tape device, and an office number in case of a tuner.","Next, with respect to the control object device judged to be unclear in Step S in , the control object device monitoring function section  obtains, as the processing of Step  in , the present mode information of the control object device by reception of AV\/C commands to judge the using circumstances. Mode information here include, where the control object device is a digital VTR, a value of a tape counter in a mechanical mode (mechanical states (such as play, and stop)), and a value of power ON\/OFF. The control object device monitoring function section  obtains these values. After the processing of Step S, The control object device monitoring function section  proceeds to the processing of Step S.","When proceeding to Step S, the control object device monitoring function section  compares the thus obtained mode information with the previous value already obtained. In the present embodiment, as the mode information, for example, a tape counter value of a digital VTR is obtained for comparison. Where the mode information is obtained for the first time, the processing of the Step S is passed. In the Step S processing, where as the result of comparison between the previous mode information and the mode information obtained this time, judgment is made that the value changed, the procedure proceeds to the processing of Step S, and where judgment is made that there is no change, the procedure proceeds to the processing of Step S.","The control object device monitoring function section  proceeds, when proceeded to the processing of Step S, to the processing of Step S after the internal status change counter value has been incremented by 1, and when proceeded to the processing of Step S, proceeds to the processing of Step S leaving the internal status change counter value. The status change counter is prepared for all the control object devices judged to be unclear in Step S of .","When proceeds to the processing of Step S, the control object device monitoring function section  judges whether or not the status change counter value is larger than a fixed value (for example, 5); where judgment is made to be larger than the fixed value, the procedure proceeds to Step S, and where judgment is made to be smaller than the fixed value, the procedure proceeds to Step S.","When proceeds to Step S upon judgment that the status change counter value is larger than the fixed value in the processing of Step S, the control object device monitoring function section  decides that the control object device corresponding to the status change counter value is controlled by other equipment (for example, the LAV controller  in ).","On the other hand, when proceeds to Step S upon judgment that the status change counter value is smaller than the fixed value in the processing of Step S, the control object device monitoring function section  decides that the control object device corresponding to the status change counter value is not controlled by other equipment (for example, the LAV controller  in ).","By the judgment of these Steps S and S, the control object device monitoring function section  obtains the result of judgment as to the presence or absence of control in the processing of Step S in . That is, where in Step S, decision is made that the control object device is controlled by the other controller, the result of judgment (predicted result) that the control is present is obtained in Step S in , whereby in Step S of , \u201c1\u201d is put up on a flag during control. On the other hand, where in Step S, decision is made that the control object device is not controlled by the other controller, the result of judgment (detected result) that the control is absent is obtained in Step S in , whereby in Step S of , \u201c0\u201d is put up on a flag during control.","After the processing of the Steps S and S, the control object device monitoring function section  judges, as the processing of Step S, whether or not a fixed time set to be longer time than the time intervals where the status change of the control object device occurs has passed. For example, the time twice of the time required for incrementing a tape counter by 1 is set. After the passage of the fixed time in Step S, the control object device monitoring function section  judges, as the processing of Step S, a value of the detection counter is increased (increment) by 1 (+1). Then, the control object device monitoring function section  judges, as the processing of Step S, whether the detection processing whether or not the state changed is repeated, or is returned to the original processing. That is, the control object device monitoring function section  returns, as the processing of Step S, to the processing of Step S if the value of the detection counter is, for example, smaller than 6, returns to the original processing if the value of the detection counter is larger than 6, and performs the branch processing to Step S an Step S in  according to the detected results obtained in Step S and Step S (whether or not the control object device is controlled by other control equipment).","While the aforementioned  flow chart has been described taking up the digital VTR as the control object device, as an example, it is noted that the present invention can be also applied to other equipment not limiting to the digital VTR. In the following, a disc drive (such as a disc recorder and a disc player), VTR, other various players, a tuner, and an amplifier are taken up as examples of the control object devices, and in the case of these control object devices, a concrete example of the processing carried out in Step S in a flow chart of  is shown in .","In , the control object device monitoring function section  first inquires, as the processing of Step S, about the power supply state of the control object device, and then judges, as the processing of Step S, whether the power supply of the control object device is ON or OFF. Where judgment is made in Step S that the power supply of the control object device is OFF, the processing of the control object device monitoring function section  directly proceeds to Step S (not shown in ), whereas where judgment is made that the device is ON, proceeds to the processing of Step .","When proceeds to the processing of Step S, the control object device monitoring function section  judges whether the control object device is, equipment having recording function and\/or reproducing function, for example, such as a disc drive, VTR, and a player or equipment other than the former, and where judgement is made that it is equipment having recording function and or reproducing function, the procedure proceeds to the processing of Step S, otherwise the procedure proceeds to Step S.","When proceeds to the processing of Step S, the control object device monitoring function section  inquires about the present mechanical state of the control object device of the equipment having recording function and or reproducing function, and then judges, as the processing of Step S, whether or not the mechanical state is decided.","As the processing of judgment whether or not the mechanical state in Step S is decided, the control object device monitoring function section  judges that the mechanical state of the equipment is decided or unclear according to the contents of the response from the control object device, for example.","That is, the control object device monitoring function section  first transmits a status command which is one of AV\/C commands for inquiring about the mechanical state of the equipment to equipment (for example, VTR) having recording function and\/or reproducing function. When the response to this inquiry is stable, the control object device monitoring function section  judges that the mechanical state is decided. Where the response is not obtained and the response waiting time has passed, it judges to be unclear.","On the other hand, where the state is \u201cIn Transition\u201d, other responses are received, or \u201cNot Implemented\u201d or \u201cRejected\u201d is returned, and the response is not obtained and the response waiting time has passed, the control object device monitoring function section  judges to be unclear.","Where in Step S, judgment is made that the mechanical state is decided, the processing of the control object device monitoring function section  proceeds to Step S of . On the other hand, Where in Step S, judgment is made that the mechanical state is not decided, the processing of the control object device monitoring function section  directly proceeds to Step S of  (not shown in ).","With respect to the above-described \u201cStable\u201d, \u201cIn Transition\u201d, \u201cNot Implemented\u201d, and \u201cRejected\u201d, there is described in detail in Reference 1, \u201cAV\/C Digital Interface Command Set General Specification Version 3.0 (issued by 1394TA AVWG), page 17 (7.3 Status commands), description of which is therefore omitted.","When in the Step S, judgment is made of equipment other than equipment having recording function and\/or reproducing function, and the procedure proceeds to the processing of Step S, the control object device monitoring function section  judges whether or not the control object device is, for example, a tuner. Where judgment is made in Step S that the control object device is not a tuner (for example, an amplifier is included here), the processing of the control object device monitoring function section  proceeds to Step S of , and where judgment is made that the device is not a tuner, the procedure proceeds to the processing of Step S.","When the procedure proceeds to the processing of Step S, the control object device monitoring function section  inquires of the control object device (tuner) about the present office selecting state, and judges, as the processing of Step S, whether or not the state of the office selection is coincided.","For judging whether or not the state of the office selection is coincided, the control object device monitoring function section  first obtains the access right to a tuner subunit status descriptor as data base having the state of the tuner described therein by an open descriptor control command which is one of AV\/C commands. Next, the control object device monitoring function section  reads out a source plug status area having office selecting information described therein by a read descriptor control command which is one of AV\/C commands.","The control object device monitoring function section  judges the state of the office selection by the response of the inquiring commands.","That is, for example, when the response of a command for obtaining the access right of data base in which the first tuner state is described is \u201cAccepted\u201d, the control object device monitoring function section  obtains the access right of the data base, and the procedure proceeds to next command processing.","On the other hand, when the response is \u201cRejected\u201d or \u201cNot Implemented\u201d, the control object device monitoring function section  cannot obtain the access right and judges that the office selecting state is unclear. Then, the procedure proceeds directly to Step S (not shown in ).","Further, when the response is \u201cInterim\u201d, the control object device monitoring function section  awaits till the response is returned. However, where the response is not returned and the response waiting time has passed, judgment is made of unclear, and the procedure proceeds directly to Step S (not shown in ).","Next, when the response of a command for reading out a source plug status in which office selecting information is present is \u201cAccepted\u201d, the control object device monitoring function section  can obtain office selecting information, and evaluates the data status and the information type status of a source plug status area in which the read-out office selecting information is present to decide the office selecting state.","Judgment is made whether or not the office being already used by the control object device is coincided with the office desired to be used by the control equipment. In the case of the same, judgment is made to be controllable, and the procedure proceeds directly to Step S (not shown in ). On the other hand, in the case of difference, the control is regarded to be impossible, and the procedure proceeds directly to Step S (not shown in ).","The above-described open descriptor control command is described in detail in Reference 1, page 49, \u201c10.1 OPEN DESCRIPTOR Command\u201d, details of which are omitted. The above-described read descriptor control command is described in detail in Reference 1, page 55, \u201c10.2 READ DESCRIPTOR Command\u201d. The-above described tuner subunit status descriptor is described in detail in Reference 1, page 26 \u201c4.3 Tuner subunit descriptor\u201d, and page 28, \u201csource plug status [x] fields\u201d. The \u201cAccepted\u201d, \u201cInterim\u201d, \u201cNot Implement\u201d, and \u201cRejected\u201d are described in detail in Reference 1, \u201cAV\/CDigital Interface Command Set General Specification Version 3.0 issued by 1394TA AVWG, page 16 (7.2 Control commands).","Next,  shows a flow of the processing where a set top box  (a HAVi module group , particularly an application module ) provided with the control object device monitoring function section  control the desired control object device as a target.","In , the HAVi module group  of the set top box  judges, as the result of a report as to the occupation of each control object device obtained by the monitoring of the individual object devices conducted by the control object device monitoring function section  as mentioned above, that is, using the flag during control, as the processing of Step S, whether the flag during control of the control object device as a target is \u201c1\u201d or \u201c0\u201d.","Where in Step S, judgement is made that the flag during control of the control object device as a target is \u201c0\u201d, the HVI module group  controls the control object device according to the normal control routine since the control object device is not controlled by other equipment (for example, the LAV controller  in ).","On the other hand, where in Step S, judgement is made that the flag during control of the control object device as a target is \u201c1\u201d, the HVI module group  produces a warning indicating signal, for example, \u201cThis device is used for others and cannot be used.\u201d to output it to a monitor  or the like, since the control object device is controlled by other equipment (for example, the LAV controller  in ) and cannot be controlled. Thereby, the user of the set top box  is possible to know that the device cannot be controlled.","As described above, according to the present embodiment, it is possible that one equipment cannot be operated simultaneously by a plurality of controllers.","While in the example of  described above, the control object device monitoring function is provided within the device (set top box ) in conformity to the HAVi, and the control object device monitoring function section  is prepared separately from the HAVi module group  so that the report of the monitored result by the control object device monitoring function section  is notified to the HAVi module group , it is noted that the control object device monitoring function can be also included in DCM as one function of the HAVi.","Further, according to the present embodiment, in the control object device monitoring function, the monitoring operation as described above is carried out whereby for example, even in the constitution as shown in ,  and , confliction can be avoided.","Furthermore, also, for example, in the network constituted merely by equipment corresponding to only the conventional AV\/C command, if means for monitoring devices (control object device monitoring function section) within the network is provided, the monitoring operation similar to that mentioned above can be similarly realized.","A series of processings as described above can be executed by the hardware, but can be also executed by the software. Where the series of processings are executed by the software, a computer in which a program constituting the software is incorporated into the set top box  as an exclusive-use hardware, or various programs are installed, whereby they can be installed in, for example, a general-use personal computer capable of executing various functions.","A reserve command of AV\/C commands will be described hereinafter.","The reserve command and the response corresponding thereto are provided as one kind of the AV\/C command and the response. The AV\/C command and the response are transmitted by FCP (Function Control Protocol provided by IEC-1883. FCP is provided to capsule a command for controlling equipment and a response within asynchronous block write transactions of IEEE standard 1394-1995, format of which is constitute as shown in .","As shown in , at the head is arranged a packet header, a FCR frame is then arranged, and finally, data CRC is arranged.","At the head of the packet header is arranged destination ID. The destination ID represents ID of a node to which the packet is transferred. In the figure, t indicates a transaction label, representing a unique tag added to the packet from the node. In the figure, rt indicates a retry code, representing a code relating to retry.","In , tcode represents a transaction code, value of which is 0001 in this example. This 0001 represents that this block is a write-in request for the data block.","In , pri represents a priority, by which value, arbitration in a link layer is carried out.","Source ID represents ID of a node for delivering the packet. A destination offset represents an address of a register in which a command or a response of the packet is written.","That is, for example, as shown in , the set top box  connected to an IEEE1394 bus has a register 1.41 within an IEEE1394, and a digital VTR has a register  within an IEEE1394 interface . For example, the digital VTR  allows a command and a response transferred through the IEEE1394 bus  from the other node to hold in an address of the register  provided by the destination offset. Similarly, the set top box  also allows a command and a response transferred from the other node to store in an address provided by the destination offset of the register . The set top box  and the digital VTR  read out the command or response stored in these registers  and .","In , a data length represents a data length in a data field. In the succeeding 2 bytes, a value 0 is described. The final header CRC represents an erroneous detection symbol within the packet header.","In the FCP frame in a pay-load portion is arranged a CTS (Command\/Transaction Set) as first 4 bits. In the case of the V\/C transaction, the CTS has a value of 0000. Next, FCP data are arranged. The details of th FDP data are shown in .  shows a FCP frame of an AV\/C command frame, and  shows a FCP frame of an AV\/C response frame.","In , ctype indicates a command type, and values provided therein means as shown in FIG., . That is, the value  means CONTROL, and the value  represents STATUS.","A subunittype represents a kind of subunit which is an object of this command, value  thereof means that the kind of subunit is a video monitor, and value  represents a disc recorder or player, as shown in .","A subunit ID is used as an instant number in case where an expansion subunit type is defined. Values  to  represent instant numbers, and a value  represents that the subunit ID represents that the subunit ID is expanded to next byte, as shown in .","In , opcode represents an operation cord, and in case of reserve, its value is , as shown in . Next to the opcode, operand [0] to operand [n], and in case of , n=1 are arranged. A priority is arranged in the operand [0]. This priority provides a relative priority order incidental to a command. The value  means that no controller reserves its node. Values I to F mean that a target has reservation for a controller. The value  of priority is a standard priority used by a controller.","A target in a free state (not reserved) is reserved by a controller which issues a reserve control command. The target stores a row of texts incidental to the priority reserved, and node ID of 16 bits of a controller. ASCII characters are inserted up to 12 bytes into a text following the priority.","A value held when the value of priority is received by the target is converted as shown in . For example, values  and  are held as the priority. Values  to E (16 antilogarism) are held as priority and value E. Value F is held as priority.","The node (target) rejects, when reservation of a fixed controller is held, a control command other than the command type reserve of a control issued from other controllers.","When a reserve control command is received from one and the same controller holding reservation, it is accepted. This allows an original controller to make priority resulting from the reservation higher or lower.","When a reserve control command is received from a controller other than controllers having made reservation, the target rejects its command as long as the priority is not higher than the priority of the present reservation. When a new priority is higher than the present priority, a new reservation is established.","Where a reserve control command is issued to an AV unit having a subunit holding reservation of equal or higher priority, the reserve control command returns a rejected response.","Where a reserve control command is issued to an AV unit not including a subunit having equal or higher priority, the reservation is established.","Where a control command is issued to a subunit within the AV unit reserved by a controller other than controllers which issued a control command, its control command is rejected.","The AV unit resets, when a bus reset is detected, priority of the reservation to 0, and set all of reservation node ID and reservation text to 1. The AV unit rejects all commands of a command type of a control except the reserve command till the reservation is established or till 10 seconds pass. This procedure allows an original reservation holder to re-establish reservation after the bus reset.","Each controller never issue a reserve control command within 10 seconds from the bus reset except the case where reservation has been established for the target prior to the bus reset. Since the node ID of the AV unit is changed after the bus reset, a controller which desires to establish the reservation examines the node unique ID.","From the these circumstances, the target presumes that a reserve command received within 10 seconds of the bus reset to receive the reservation.","The controller is able to request the present state of reservation by issuing a reserve command having a field of a command type of STATUS shown in .","The AV\/C response frame shown in  is also basically constituted similarly to the AV\/C command frame shown in , but a response is arranged in place of ctype in . This response means a response code, and values  to F represents the meaning shown in . For example, there represents that the value  is not adapted (not implemented) to the command request, and that the value  accepted the command requested. Further, there represents that the value A rejected the corresponding command.","As shown in , when a controller issues an AV\/C command to a target, the target issues it where a response can be issued within 100 ms to the command.","On the other hand, as shown in , where after receipt of a command, corresponding processing cannot be completed within 100 ms, an INTERIM response is issued before 100 ms pass. Afterwards, when the processing is completed, the target issues a final response.","In the following, a medium used for the purpose of installing a program for executing a series of processings described above, for example, in a computer to place it executable by the computer will be described with reference to  taking as an example the case where the computer is a general-use personal computer.","A program can be presented for a user in the state being preinstalled in a hard disc  and a semiconductor memory  as a recording medium housed in a personal computer, as shown in .","Alternatively, a program may be stored temporarily or permanently in recording media such as a floppy disc  shown in , CD-ROM (Compact Disc-Read Only Disc)  shown in , MO (Magneto-Optical) disc . shown in , DVD (Digital Versatile Disc)  shown in , a magnetic disc  shown in , and a semiconductor memory  shown in , and can be presented as a package software.","Further, the program can be, as shown in FUG, H, transferred by way of wireless from a download site  to a personal computer  through a man-made satellite  for digital satellite broadcasting, and transferred by way of wire to a personal computer  through a network  such as a local area network and an internet; and in the computer , the program can be stored in a hard disc  housed therein.","The medium termed in the present embodiment means a conception in a broad sense including all these media.","It is noted in the present embodiment that the steps of described programs presented by the media include a processing carried out in a manner of time series in order described, of course, and a processing executed in parallel or individually even not always being processed in a manner of time series.","According to the control apparatus and method, medium of the present invention, the using circumstances of a control object device is detected, and control of the control object device is carried out on the basis of the detected result, whereby even where for example, a control apparatus in conformity to a fixed standard, a control apparatus not in conformity to a fixed standard, and a control object device that can be controlled by the respective control apparatuses are mixed, for example, on a network, there can be avoided inconvenience the control object devices not in conformity to a fixed standard are controlled by the respective control apparatuses simultaneously."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 4","FIG. 3"],"b":"4"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 5","FIG. 4"],"b":"10"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIGS. 20A"},{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 25"},{"@attributes":{"id":"p-0072","num":"0071"},"figref":"FIG. 26","b":["214","214","215"]},{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 27"}]},"DETDESC":[{},{}]}
