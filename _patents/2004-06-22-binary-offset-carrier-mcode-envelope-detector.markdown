---
title: Binary offset carrier M-code envelope detector
abstract: An M code envelope detector receives an incoming binary offset carrier (BOC) signal, such as the M code signal, and generates inphase BOC and quadraphase BOC signals, separated by an offset, that have respective ambiguous correlation envelopes, that when combined, provide a near unimodal correlation function with respect to code phase error of the BOC signal having an inherent multimodal autocorrelation function, with the near unimodal correlation envelope being tracked by early and late code replicas at broad one chip phases for providing unambiguous but nonlinear code phase error tracking, which detector is then further improved with the use of code replicas having narrow partial chip phases, such as â…› chip phases, for providing near linear code phase error tracking for unambiguous and accurate code tracking of the BOC signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07555033&OS=07555033&RS=07555033
owner: The Aerospace Corporation
number: 07555033
owner_city: El Segundo
owner_country: US
publication_date: 20040622
---

{"@attributes":{"id":"description"},"GOVINT":[{},{}],"heading":["STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT"],"p":["The invention was made with Government support under contract No. F04701-00-C-0009 by the Department of the Air Force. The Government has certain rights in the invention.","The invention relates to the field of spread spectrum communication systems. More particularly, the present invention relates to code phase tracking of spreading codes of received signals, such as an M code signal, having binary offset carrier (BOC) modulation.","Spread spectrum signals are used in modern communication and navigation systems. In the transmitter, spread spectrum modulation of the carrier signal spreads a narrowband baseband signal into a broadband spectrum. There are numerous advantages to using spread spectrum signal modulation with the primary advantage being the ability to detect the transmitted spread spectrum signal when the overall signal to noise ratio is significantly below unity, that is, where the noise level is much greater than the signal level. In the receiver, a replica of the same spread spectrum modulation is used to correlate with the received spread spectrum signal that results in despreading and subsequent detection of the transmitted signal. If there was a digital data message transmitted along with the spread spectrum signal, this narrowband baseband data signal remains on the carrier after despreading the spread spectrum signal. Typically, the digital data is detected by phase locking to the carrier signal, then detecting the digital data transitions when phase reversals of the carrier signal take place.","Spread spectrum signals that are generated by pseudo random noise (PRN) code generators are called non-return to zero (NRZ) signals. Even though the theoretical bandwidth of the spread signal is infinite, most of the signal energy is within the double-sided bandwidth contained between the null frequencies located symmetrically on both sides of the carrier frequency. These nulls occur at the chipping frequency of the NRZ PRN chipping rate that is the clock frequency of the code generator. For example, in the Global Positioning System (GPS) satellite navigation system, the NRZ PRN chipping rate of the military NRZ precision encrypted code or P(Y) code is 10.23 million chips per second (Mcps). Therefore, the two-sided bandwidth to the first nulls is 20.46 MHz. The chipping rate of the coarse\/acquisition (C\/A) code is 1.023 Mcps. Therefore, the two-sided bandwidth to the first nulls is 2.046 MHz. The peak power of the NRZ spread spectrum is located near the center frequency, that is, near the zero offset from the carrier frequency. Most of the energy of the C\/A code is within the first null. The same is true for the P(Y) code.","However, there is another class of spread spectrum signals that require the peak power distribution to be off-center, that is, not near the carrier frequency. This off-center split spectrum utilizes the available power in the outer bands of the allocated spectrum bandwidth. Even though the spread spectrum signal minimizes correlation between signals at similar power levels occupying the same bandwidths, the split spectrum permits much larger signal powers in one bandwidth sector from interfering with lower signal powers in another sector of the same allocated bandwidth. To create power spectra in off-center portions of the bandwidth, a binary signal is multiplied with the NRZ signal along with the data signal and the result modulates the carrier signal. This spread spectrum signal modulation technique is called binary offset carrier (BOC) modulation. The resulting spread spectrum energy distribution of signal power symmetrically around the carrier frequency depends on the ratio between the binary signal and the chipping rate of the NRZ code generator. For example, in GPS, a new split spectrum has been introduced for use by the military called the M code. Because the lowest GPS chipping rate signal is the coarse\/acquisition code or C\/A code at 1.023 Mcps, the BOC notation adopted for GPS is based on integer multiples of the C\/A code chipping rate. For GPS, the symbolic notation is BOC(M,N), where M is the binary signal multiple and N is the NRZ signal multiple. For the M code, the integer notation is BOC(10,5). Thus, the binary signal is 10.23 MHz and the NRZ code generator clock is 5.115 MHz. The spread spectrum that results from the M code BOC(10,5) modulation is well known. The peak power is split into two bands centered at plus and minus the binary signal frequency, that is, plus and minus 10.23 MHz from the carrier frequency. Because the chipping rate for M code is 5.115 MHz, the bandwidth of both sides of the split spectrum is 10.23 MHz.","Traditional code division multiple access (CDMA) spread spectrum systems code-tracking loops are usually based on steepest ascent algorithms. The code-tracking loop is used to align the replica code with the incoming code of the received signal. The steepest ascent algorithms work for traditional CDMA spread spectrum signals because the code autocorrelation signals are unimodal. That is, the unimodal autocorrelation function has a single peak that is tracked using the steepest ascent algorithm. As is well known, the correlation envelope of current GPS spread spectrum signals, such as C\/A-code and P(Y)-code is approximately a triangle having rounded peak amplitude that corresponds to perfect correlation of the GPS receiver replica code with the received code. The extremities of the base of this envelope triangle have approximately zero amplitudes that correspond to a plus or minus 1-chip offset of the replica code with respect to the incoming code where the replica code becomes effectively uncorrelated with the received code. The modernized military M code signal is a BOC(10,5) spread spectrum signal. The Galileo navigation satellite system also plans to use BOC spread spectrum signals. The M code autocorrelation is a multimodal function of code phase error and makes demodulation and tracking difficult. For BOC signals, of which M code is a particular instance, the code autocorrelation function is multimodal. Using steepest ascent algorithms with a BOC signal would result in ambiguity because it could be tracking the wrong peak of the BOC code correlation function.","The problem occurring in a BOC signal receiver during the detection process of a BOC signal is that the correlation envelope does not result in a single or unimodal correlation peak as is the case with the NRZ signal. As a result, multiple, that is, multimodal, stable code-tracking states occur for the BOC signal. However, only the central correlation peak is the correct one. In other words, the BOC code tracking loop can be ambiguous when the code phase tracking loop locks onto an off-center peak of the multimodal correlation function. Hence, BOC code phase tracking is subject to errors when the code phase tracking locks onto an incorrect code phase when tracking an off-center peak of the correlation function.","The correlation envelope for a typical BOC signal, in this case BOC(10,5) or M code has seven correlation peaks, the center one of which is the correct correlation peak with the remaining peaks decreasing in amplitude in equal amounts from both sides of the center peak. For example, consider the output of an early minus late (E\u2212L) code discriminator in the code-tracking loop with the nearly optimal \u215b-chip E\u2212L correlator spacing for BOC(10,5). This E\u2212L discriminator would output seven positive slope zero crossings corresponding to these seven correlation peaks if the replica code were shifted plus and minus one M code chip with respect to perfect alignment with the incoming M code (zero error input). Only the central discriminator output is the true one, with a tracking range of plus and minus one-sixteenth (0.0625) chip. The remaining six are also stable tracking regions of plus and minus 0.0625 chip, but are offset with respect to the true code tracking position. This ambiguity problem is caused by the multimodal BOC signal producing multiple zero crossings along the input error axis of the code loop discriminator.","The normal correlation envelope for the M code signal is a set of tapered triangles with both positive and negative peaks. Only the central positive peak corresponds to perfect correlation of the GPS receiver replica M code with the received code. The BOC signals in space provide numerous benefits, but the BOC signals create code tracking problems during signal acquisition and code tracking due to the multimodal peaks of the autocorrelation function of the BOC signal. Each of the multiple correlation peaks corresponds to signal detection during the acquisition process and to a stable code loop state during the tracking process. However, only the central peak is the correct state. In other words, the result of correlation with the BOC spread spectrum signals is ambiguous when based on tracking a peak because the BOC correlation function results in multiple peaks, the center one of which is the correct peak for use during signal acquisition and tracking. Hence, there are problems associated with the tracking of only the correct center peak of the M code correlation function because of the presence of multiple peaks of the multimodal autocorrelation function.","One method to track the ambiguous offset carrier signal is called the bump-jumping algorithm that does not continuously resolve the ambiguity problem. The bump-jumping algorithm requires the use of a very early and very late correlator. The very early correlator is typically placed one-quarter chip early with respect to the punctual or prompt correlator. The very late correlator is placed late by the same amount. The decision to \u201cbump\u201d is made whenever the very early correlation or the very late correlation appears to be greater than the prompt correlation. This would be the case if the prompt correlator slipped into a false correlation region. This has the disadvantage of requiring the tracking loop to actually slip into a false tracking state before this technique can decide to jump over to the next peak in a search for the correct center peak. In other words, the bump-jumping algorithm does not continuously track and correct the code loop error after that error exceeds the narrow central true tracking region. Another approach involves combining the ambiguous code discriminator output of a conventional M code delay lock loop with the output of an unambiguous code discriminator. The unambiguous discriminator is generated from the combination of the two M code sidebands each down-converted to the carrier (center) frequency. The upper sideband is converted to an NRZ code by down-converting it to the center frequency. This is accomplished by multiplying the incoming signal with a \u221210.23 MHz signal. Likewise, the lower sideband is up-converted by multiplying with a +10.23 MHz signal. Each NRZ signal is separately filtered, then correlated with wide (1-chip) early and late correlators derived from the replica NRZ code generator. The envelopes of the two early components are combined and the two late component envelopes are combined, then processed through an E\u2212L discriminator. However, this implementation is complicated. These and other disadvantages are solved or reduced using the invention.","An object of the invention is to provide an envelope detector of a binary offset carrier signal.","Another object of the invention is to provide an envelope detector of an M code binary offset carrier (BOC) signal.","Another object of the invention is to provide an M code envelope detector for unambiguous detection of the correct code phase of a received BOC signals.","Yet another object of the invention is to provide a correlation envelope detector for generating code despread and carrier demodulated received centered and offset BOC signals, offset from each other and having respective correlation functions for unambiguous code phase tracking.","A further object of the invention is to provide a correlation envelope detector for generating code despread and carrier demodulated received inphase centered and quadraphase offset BOC signals, offset from each other and having respective correlation functions that when combined provide a near unimodal correlation function for unambiguous code phase tracking.","A further object of the invention is to provide a correlation envelope detector for generating code despread and carrier demodulated received centered and offset BOC signals, offset from each other and having respective correlation functions that when combined provide a near unimodal correlation function for unambiguous code phase tracking.","Yet a further object of the invention is to provide a correlation envelope detector for generating code despread and carrier demodulated received centered and offset BOC signals, offset from each other and having respective correlation functions that when combined provide a near unimodal correlation function tracked by broad and narrow chip phase code replicas for providing a linear code phase tracking function for unambiguous code phase tracking of the received BOC signal.","The invention is directed to an envelope detector for detecting the autocorrelation envelope of a BOC signal, such as the M code signal, for preferred use in a spread spectrum communication system for improved unambiguous coherent code phase tracking. A near unimodal code autocorrelation function is generated from the BOC signal having an inherent multimodal autocorrelation function characterized as having multiple peaks with an ambiguous code phase offset. The near unimodal M code autocorrelation function can be unambiguously tracked in a narrow pull-in region of code phase error offsets between the incoming code and the replica code during code phase tracking. In a first embodiment, the received BOC signal is firstly code despread with one set of replica codes, quadraphase split, and then carrier demodulated. In a second embodiment, the received BOC signal is firstly carrier demodulated, quadraphase split, and then despread using two sets of inphase and quadraphase replica codes. These two different processes are equivalent, as both serve to demodulate, despread and quadraphase split the received BOC signal.","The envelope detector generates two sets of quadrature demodulated signals, including I and Q inphase BOC signals and I and Q quadraphase BOC (QBOC) signals from the received signal. The inphase and quadraphase BOC and QBOC signals are separated by a phase offset that is preferably a \u03c0\/2 (90 degree) offset. When the squares of the two sets of BOC and QBOC signals are combined, a near unimodal correlation function is generated with respect to code phase error of a received BOC signal that otherwise has an inherent multimodal autocorrelation function with inherent ambiguous code phase tracking. The near unimodal correlation function is characterized as having a single major center peak at correct code phase between the incoming code of the BOC signal and a prompt code replica. The near unimodal autocorrelation function can be broadly tracked by early and prompt code replicas at one chip phase separation for providing unambiguous but nonlinear code phase error tracking function. The code phase tracking is unambiguous near the correct code phase for improved code phase tracking.","In a further improvement, narrow code replicas are generated and have narrow partial chip phases, that along with broad code replicas, provide a near linear unambiguous code phase tracking function for unambiguous and accurate tracking of the BOC signal, with accurate code phase tracking across the tracking code phase pull-in region centered about the correct code phase. The narrow code replicas are used for generating narrow correlation envelopes of only the inphase BOC signal. The ambiguous narrow correlation envelopes are added to the broad combined correlation envelops for providing composite correlation envelopes comprising combined broad correlation envelops and narrow uncombined correlation envelopes. The early and late composite correlation envelopes are used for generating the code phase error that is linear respecting an input error being the early and late composite correlation envelopes. The linear code phase error function can be used for improved code phase tracking in a code-tracking loop. As such, unambiguous and ambiguous correlation envelopes are combined for improved code phase tracking. The detector can be used for improved acquisition of the incoming spreading code in the presence of Doppler uncertainty. The envelope detector can be used, for examples, in GPS or Galileo tracking loops or communication systems communicating BOC signals. These and other advantages will become more apparent from the following detailed description of the preferred embodiment.","An embodiment of the invention is described with reference to the figures using reference designations as shown in the figures. Referring to , a c(t)s(t)cos\u03b8 IF signal  is received and despread by a prompt c(t+\u03c4) PRN code signal  by multiplication using mixer  for producing a despread received signal. The despread received signal is then fed into two branches including a BOC branch and a QBOC branch. The despread signal on the BOC branch is multiplied by a prompt square wave clock fsP signal  by mixer  producing a BOC signal. The fsP signal  is phase shifted by a ninety-degree phase shifter  that can be, for example, a shift register for providing a phase shifted fsP signal communicated to a mixer . The despread signal in the QBOC branch is multiplied by the phase shifted signal from the phase shifter  by mixer  for producing a QBOC signal. The BOC signal is then demodulated in quadrature by the carrier signal fc using mixer  and mixer  using a ninety-degree phase shifter  for respectively providing I and Q demodulated BOC signals. The QBOC signal is also concurrently demodulated in quadrature by the carrier signal fc using mixer  and mixer  with a ninety-degree phase shifter  for respectively providing I and Q demodulated QBOC signals. The demodulated I and Q BOC signals are respectively filtered by filters  and  for providing an in phase BOC signal IB  and a quadrature BOC signal QB  respectively communicated to squarer  and  for providing a squared in phase BOC signal IB and a squared quadrature BOC signal QB. The demodulated I and Q QBOC signals are respectively filtered by filters  and  for providing an in phase QBOC IQ signal  and a quadrature QBOC signal  respectively communicated to squarers  and  for providing a squared in phase QBOC signal and a squared quadrature QBOC signal. The squared IB, QB, IQ, and QQ signals are summed by a summer  for providing a sum signal being the sum of the squares of the IB, QB, IQ, and QQ signals, which sum signal is fed into a square rooter  for providing a prompt MenvP M code envelope signal  that is equal to the square root of the sum of the squares of the IB, QB, IQ, and QQ signals , , , and , respectively. The prompt MevnP M code envelope signal is an envelope detection output signal.","Referring to , the M code envelope detector is used in a coherent receiver that provides code phase tracking of the M code envelope. A front end down converter  provides the IF received signal  that is down converted from a received RF signal. The received signal IF signal  is fed into a prompt M code envelope detector , an early M code envelope detector  and a late M code envelope detector  for respectively providing an early M code envelope signal MenvE and a late M code envelope signal MenvL. The detectors , , and  would also generate IB and QB BOC signals, and IQ, and QQ QBOC signals. The IB, QB, IQ, and QQ signals from the prompt detector  are fed into a carrier phase and frequency controller  for generating an estimated carrier frequency error signal \u03c6\u2032 that is a time derivative of a carrier phase error signal \u03c6. The early and late envelope detection signals MenvE and MenvL from the detectors  and , as well as the estimated carrier frequency error signal \u03b8\u2032 are fed into a coarse mode code phase and frequency controller  for generating a code error rate signal \u03c4\u2032 that is a time derivative of a code phase error \u03c4.","The estimated carrier frequency error signal \u03c6\u2032 and the code error rate signal \u03c4\u2032 are derivatives of the estimated carrier phase error \u03c6 and the estimated code phase error \u03c4, respectively. The carrier frequency error \u03c6\u2032 and the code error rate \u03c4\u2032 signals are fed into a coarse code and carrier replica generator  that generates the prompt square wave signal fsP  and prompt code replica signal c(t+\u03c4)  that is fed into the prompt envelope detector , generates an early square wave signal fsE and early code replica signal c(t+\u03c4\u2212\u0394\u03c4) that are fed into the early envelope detector , and generates a late square wave signal fsL and late code replica signal c(t+\u03c4+\u0394\u03c4) that are fed into the late envelope detector . As such, the M code envelope tracker coherently operates in a closed loop. The MenvE and MenvL signals and the estimated carrier frequency error signal \u03c6\u2032 are fed into the coarse mode code phase and frequency controller  that adjusts the estimated code phase error \u03c4 using the estimated carrier frequency error signal \u03c6\u2032 and the difference in value between MenvE and MenvL envelopes. The estimated code error rate signal \u03c4\u2032 and the estimated carrier frequency error signal \u03c6\u2032 are inputs to the coarse mode code and carrier replica generator  to produce the fsP, fsE, and fsL square waves, the prompt code replica, the early code replica, and the late code replica.","Referring to , A, and B, and more particularly to , the carrier phase and frequency controller  includes four delays , , , and  for respectively delaying IB  for producing a delayed DIA signal, while QB  is delayed by the delay  for producing the a delayed DIB signal, while IQ  is delayed by the delay  for producing a delayed DIQ signal, and while QQ  is delayed by the delay  for producing a delayed DQQ signal. The QB and DIA signals are multiplied at mixer  to produce a QB\u00d7DIA signal. The IB and DQB signals are multiplied by mixer  to produce an IB\u00d7DQB signal. The QQ and DIQ signals are multiplied by mixer  to produce a QQ\u00d7DIQ signal. The IQ and DQQ signals are multiplied by mixer  to produce an IQ\u00d7DQQ signal. The product IB\u00d7DQB signal is subtracted from the product QB\u00d7DIB signal by subtractor  for providing a QB\u00d7DIB\u2212IB\u00d7DQB difference signal. The product IB\u00d7DQQ signal is subtracted from the product QB\u00d7DIB signal by subtractor  for providing a QB\u00d7DIB\u2212IQ\u00d7DQQ difference signal. The QB\u00d7DIB\u2212IB\u00d7DQB difference and QB\u00d7DIB\u2212IQ\u00d7DQQ difference are summed by a summer  producing a [QB\u00d7DIB\u2212IB\u00d7DQB]+[QB\u00d7DIB\u2212IQ\u00d7DQQ] sum signal as a carrier phase sum signal that is filtered by a low pass filter  for providing the estimated carrier frequency error signal \u03c6\u2032.","Referring to , A, B, and C, and more particularly to , the coarse mode code phase and frequency controller  generates the estimated code error rate \u03c4\u2032. The estimated carrier frequency error signal \u03c6\u2032  is amplified by a conversion amplifier  to produce a first nominal code phase error signal. The gain of conversion amplifier  is equal to the ratio of the number of PRN code chips per second divided by the number of radians per second. The first nominal code phase error signal from the conversion amplifier  is scaled by a 1-k amplifier  for providing a first scaled code phase error signal. Concurrently, the MenvE envelope signal  is filtered by low pass filter  to produce a filtered MenvE signal. The MenvL envelope signal  is filtered by low pass filter  to produce a filtered MenvL signal. The filtered MenvL signal is subtracted from the filtered MenvE signal by a subtractor  to produce a second nominal code phase error rate signal. The second nominal code error rate signal is scaled by a k amplifier  to produce a second scaled code phase error rate signal. The first and second scaled code phase error rate signals are added by summer  to produce the estimated code error rate signal \u03c4\u2032 . When the MenvE and MenvL envelop signals are normalized to have unity peak amplitudes, the 1-k amplifier  and the k amplifier  will have gains that sum to unity, where [k+(1\u2212k)=1.","Referring to , A, B, C, and D, and more particularly to , the estimated carrier frequency error signal \u03c6\u2032  is fed into a carrier NCO  that adjusts the frequency of the carrier frequency signal fc . Concurrently, the code error rate signal \u03c4\u2032  is fed into a code NCO  that provides fco and 4fco clock signals. The fco signal is fed into a code generator  that outputs the replica NRZ M code at the fco clock-chipping rate. The code generator  generates an early code replica c(t+\u03c4\u2212\u0394\u03c4)  that is fed into a two-bit shift register  for generating the prompt code replica c(t+\u03c4) , and for generating the late code replica c(t+\u03c4+\u0394\u03c4) . The 4fco clock signal is fed into a 2fco flip flop  that divides the 4fco signal by two and generates a square wave signal 2fco. The 2fco signal is the early square wave signal fsE . The 2fco early clock signal  clocks the code two-bit shift register  and clocks the square wave two-bit shift register . The square wave two bit shift register  generates the prompt clock signal fsP  and generates a late square wave signal fsL . While shown as digital square wave signals with one bit precision, the fsP, fsL, and fsE could be digital sinusoidal signals with multi bit precision. In the exemplar form, the square wave signals fsP, fsL, and fsE are one bit sine signals, where fsE=sin(\u03c9(t+\u03c4\u2212\u0394\u03c4)), fsL=sin(\u03c9(t+\u03c4+\u0394\u03c4)), and fsP=sin(\u03c9(t+\u03c4)) with \u03c9 being the frequency of twice the chipping rate. The estimated code phase error \u03c4 is equal to \u03c4+\u03c4\u2032\u0394t where \u03c4is the code phase error at an end of the previous chip period having duration of \u0394t. As such, the closed loop operation of the M code envelope tracking serves to adjust the local carrier fc and the fsP, fsE, fsL, square waves, the early, the late, and the prompt code replicas, and the estimated carrier frequency error signal \u03c6\u2032 to maintain coherent despreading and demodulation of the received signal .","The incoming signal which for a particular satellite can be viewed as c(t)s(t)cos\u03b8 plus noise where c(t) is the chipping code and s(t) is a modulating square wave, the binary offset carrier. The replica of the code is shifted by an unknown amount with respect to the incoming code signal c(t+\u03c4). The phase and frequency of the replica code corresponds to the estimate of the position and velocity of the receiver antenna phase center with respect to the satellite transmitter antenna phase center. The line of sight velocity between the satellite and the receiver antenna phase centers causes a Doppler shift, so the replica code must be corrected according to the estimate of the code Doppler in the incoming code c(t+\u03c4) signal. A sine wave fs whose frequency is the same as that of the square-wave, s(t), is also corrected according to the estimate of the Doppler effect on the incoming s(t). A sine wave fc whose frequency is that of the carrier is also corrected according to the estimate of the Doppler effect on the incoming carrier frequency.","For the tracking region where two PRN codes are within a chip, the autocorrelation of a PRN is unimodal with a peak value at the point where the codes are perfectly aligned, the square of the correlation is also unimodal and positive with a single peak at the point where the codes are aligned provided the two codes are within slightly less than one chip from each other. Outside of this region, the PRN code correlation is approximately zero. Traditional PRN code tracking algorithms look to drive the code replica to a position where a term proportional to either the code autocorrelation, or the corresponding squares of the code autocorrelation is locally maximized. Because the PRN code autocorrelation function and the squared version are unimodal over the code phase errors, and the peak value of autocorrelation corresponds to perfect alignment of the codes, PRN code tracking can be accomplished using conventional PRN code tracking algorithms.","The code for the M code, z(t), can be expressed as z(t)=c(t)s(t) where c(t) is an NRZ PRN code with a chipping rate of 5.115 M Chips and s(t) is a square wave with a frequency of 10.23 MHz. Because M code is the product of a PRN code and a square wave, the autocorrelation function of the M code is no longer unimodal when the codes are within a chip of each other, but has several peaks and valleys. The highest peak of the autocorrelation function corresponds to the place where the codes are perfectly aligned but there are other local decreasing peaks. The square of the autocorrelation function has even more local peaks in the area of code phase alignment. Therefore, traditional code tracking algorithms which drive the code replica to a local maxima of a term proportional to either the code autocorrelation or corresponding square version will only guarantee convergence to the correct solution when the code phase error is sufficiently small between the replica code and the incoming code. The autocorrelation of the NRZ PRN code can be expressed by the term E(c(t)c(t+\u03c4)). The term E(c(t) c(t+\u03c4)) expresses an ideal M code envelope. Determining the value of E(c(t) c(t+\u03c4)) enables resolving ambiguities in tracking the M code signal, and allows for a larger number of chips as an increased pull-in region. The ability to determine the NRZ M code envelope is useful during signal acquisition. The ideal envelope function is unimodal and does not oscillate between positive and negative values so as to allow for detectable correlation in the presence of decreased accuracy in the estimate of the code phase and code frequency. After using the envelope detector to determine a rough estimate of the code phase error, the estimate is refined by tracking the sharp peaks resulting from the autocorrelation of the M code signal.","The envelope detection function is an approximation of the ideal envelope detection function that possesses the same benefits. To obtain the envelope function at a given point, the replica code is correlated with the incoming signal with the following two signal codes c(t+\u03c4) sin(\u03c9(t+\u03c4)) and c(t+\u03c4) cos(\u03c9(t+\u03c4)). The terms sin(\u03c9(t+\u03c4)) and cos(\u03c9(t+\u03c4)) are not to be confused with the carrier replicas, which are sin(2\u03c0ft) and cos(2\u03c0ft). Thus, the incoming signal is correlated against the replicas c(t+\u03c4)sin(\u03c9(t+\u03c4))cos(2\u03c0ft), c(t+\u03c4)sin(\u03c9(t+\u03c4)) sin(2\u03c0ft), c(t+\u03c4)cos(\u03c9(t+\u03c4))cos(2\u03c0ft), and c(t+\u03c4)cos(\u03c9(t+\u03c4))sin(2\u03c0ft). The result of the correlation processes are IB=LP[c(t)s(t)cos \u03b8c(t+\u03c4)sin(\u03c9(t+\u03c4))cos(2\u03c0ft)], QB=LP[c(t)s(t)cos \u03b8c(t+\u03c4)sin(\u03c9(t+\u03c4))sin(2\u03c0ft)], IQ=LP[c(t)s(t)cos \u03b8c(t+\u03c4)cos(\u03c9(t+\u03c4))cos(2\u03c0ft)], QQ=LP[c(t)s(t)cos \u03b8c(t+\u03c4)cos(\u03c9(t+\u03c4))sin(2\u03c0ft)]. The square wave s(t) can be represented by a series of sine waves whose frequencies are multiples of that of the square wave, realizing this and taking into account the effect of the low pass filters that reject the high frequency components, IB is proportional to E[c(t) c(t+\u03c4)]sin(\u03b3)cos(\u03c6), QB is proportional to E[c(t) c(t+\u03c4)]sin(\u03b3)sin(\u03c6), IQ is proportional to E[c(t) c(t+\u03c4)]cos(\u03b3)cos(\u03c6), QQ is proportional to E[c(t) c(t+\u03c4)]cos(\u03b3)cos(\u03c6), where \u03c6 is the carrier phase error, \u03b3 is the phase difference between s(t) and fsP.","The envelope function Menv is proportional to the ideal envelope function, E[c(t) c(t+\u03c4)]. Because the envelope function is similar to the ideal envelope function, the envelope function can be used in place of M code correlators in a conventional tracking scheme to track the code phase of a BOC signal. A code tracker using an envelope detector is a course mode BOC signal code tracker. The course mode BOC code tracker can ensure that a traditional code tracking algorithm starts with a replica that is sufficiently close to the code phase of the incoming signal so as to ensure that the local maxima which it converges to corresponds to the point where the code phases are equal.","The envelope detection enables tracking any BOC signal, such as the M code signal. The M code envelope detector can be used in place of a code correlator in a code-tracking loop. The M code envelope detector can also be used in conjunction with an M code correlator to resolve the ambiguity in the tracking. The M code envelope detector could be used in place of an M code correlator in a coarse tracking mode, once the coarse tracking had converged to a sufficient accuracy where ambiguity was not an issue. A BOC correlator could be used along with the standard steepest-ascent tracking algorithm. Even when the standard BOC correlator is used in tracking, the M code envelope detector could be used to make sure the replica had not jumped off to another correlation peak.","Referring to , a broad and narrow replica code generator is used for generating multiple replicas of a BOC spreading code, such as the M code. The replica generator receives a code phase rate signal  that is accumulated by the code NCO  at the clock frequency fck derived from a clock generator . Each time the code NCO  is clocked by fck the accumulator adds the digital value of the code phase signal  output to the previous code NCO  accumulator contents. Each time the code NCO  accumulator overflows it produces an epoch that clocks the broad and narrow shift register  and the broad shift register . In this M code design example the shift registers  and  clock rate is 16fco and 16fco is ultimately divided by 16 to produce fco from the NRZ flip-flop  as the code chipping rate input for the replica NRZ code generator . For M code this chipping rate is 5.115 Mcps plus code Doppler. The 16fco clocking signal is fed into an 8fco flip flop  for generating an 8fco clocking signal that is in turn fed to a 4fco flip flop  having complementary outputs for providing a 4fco clock signal and a 4fco\\clock signal respectively fed into a BOC flip flop  and a QBOC flip flop . The BOC flip flop  and the QBOC flip flop  provide BOC, which is identical to 2fco and QBOC clock signals, respectively, fed to mixers  and . The 2fco signal is an inphase BOC square wave and the QBOC is a quadraphase BOC square wave, that is, phase shifted by 90 degrees with respect to the BOC square wave. The 2fco clock signal is further fed to NRZ flip flop  to complete the divide by 16 chain described earlier.","The NRZ code is fed into the mixers  and  that multiply the NRZ code with BOC which is equal to 2fco and with QBOC providing a replica inphase M code signal and a replica quadraphase M code signal, respectively. The replica inphase M code and replica quadraphase M code signals are respectively fed into data inputs of a broad and narrow shift register  and a broad shift register  that are clocked by the 16fco clock signal. The broad and narrow shift register  provides an Eearly replica M code signal at the data input being bit zero, provides an Eearly narrow replica M code signal at bit seven, provides an Eprompt replica M code signal at a center bit eight, provides an Llate narrow replica M code signal at bit nine, and provides an Llate replica M code signal at bit sixteen, all of which being replicas of the M code signal, but phase shifted by delayed with respect to the input by one-sixteenth of an M code chip times the respective bit number. Concurrently, the broad shift register  provides an Eearly replica quadra M code signal at the data input being bit zero, provides a Pprompt replica quadra M code signal at bit eight, and provides an Llate replica quadra M code signal at bit sixteen, all of which replicas being replicas of the quadra M code signal, but each delayed in time by the shift register delay of 1\/16M code chip times the respective bit number. The time differential between the early and late replicas Eand L, or the early and late replicas Eand L, at bits zero and sixteen, is a broad duration of one M code chip, whereas the time differential between the early and late narrow replicas Eand L, at bits seven and nine, is a narrow duration of \u215b M code chip. As such, the broad shift register  defines a broad correlator spacing of one chip for the quadra M code replicas, and, the broad and narrow shift register  defines both the broad correlator spacing of one chip and a narrow correlator spacing of \u215bchip for the M code replicas.","The phase shifted replica codes are provided by sixteen bit shift registers  and  so that register  shifts the replica M code (BOC\u00d7NRZ) and the other register  shifts the replica quadra M code (QBOC\u00d7NRZ). The (BOC\u00d7NRZ) signal is an inphase M code signal and the (QBOC\u00d7NRZ) replica code is a quadra-phase M code signal. The inphase M code signal and quadra-phase M code signal are applied to the data inputs of the shift registers  and , respectively. These shift registers  and  are clocked for code phase shifting at 16fco, which is applied to the clock inputs of the shift registers  and . In the exemplar form, 16fco is used, though any number could be used for various narrow time durations by multiplying two by the reciprocal of the desired narrowest E\u2212L correlator spacing. The narrowest correlator spacing between E and L is one-eighth chip so the shift registers  and  are sixteen bits long. For the M code, the nearly optimal narrow correlator spacing is one-eighth chip. Broad correlators are typically separated by a one-chip duration.","The code NCO input is controlled by the output of the code discriminator plus code loop filter baseband functions. This code NCO input signal is depicted as a code phase increment per clock. The NCO input signal is typically a digital word that is updated at the beginning of each integrate and dump period representing the value that the NCO clock will add to itself each epoch such that the NCO will overflow on the average at the required code clock rate plus Doppler effect at the fco output signal. Because each overflow at NCO output represents the advancement of the NRZ code generator by one chip, at any point in time the contents of the NCO represents the precise fractional part of the replica code state. This fraction along with the integer phase shift of the replica code generator is used to determine the transmit time of the GPS satellite signal. In order to generate the quadrature signal of QBOC, the required signal is 8fco or eight times the required replica NRZ-code generator chipping rate. For M code, the chipping rate is 5.115 Mcps plus the required code Doppler frequency referenced to 5.115 MHz. The flip-flop with the 4fco output divides the 8fco signal by two producing two complementary 4fco phases that are exactly 180 degrees out of phase with respect to each other. One of these two complementary outputs is divided by two by the flip-flop producing 2fco, which is identical to the M code BOC square wave signal. The second complementary output is divided by two by the flip-flop producing the QBOC output modulating signal. As a result, QBOC is always exactly ninety degrees out of latent phase with respect to BOC regardless of the code Doppler value. Thus, the QBOC clock signal is in perfect phase quadrature with respect to the BOC clock signal.","Referring to , and more particularly to , the M code and quadra M code time-staggered replicas E, E, P, L, L, E, P, and Lcan be used for code phase error tracking by generating the code phase error signal  in a broad and narrow M code phase generator. A carrier tracking loop  provides a carrier phase signal to a carrier NCO  for generating sine and cosine carrier replicas. A received digital IF signal  is fed into a carrier wipe-off demodulator  receiving the sine and cosine carrier replicas for demodulating an IF carrier for generating inphase (I) and quadra-phase (Q) baseband signals. Baseband processing occurs downstream of the carrier and code wipe-off and integrate and dump functions, and is usually performed in a receiver or navigation processor. Baseband processing includes the carrier and code loop discriminator function plus loop filtering. The carrier discriminator operates on the I and Q baseband signals with the two quadrant arc-tangent discriminator for signals with data modulation. The code discriminator typically operates on the E and L baseband signals, but can also use the P baseband signals. For example, the dot product power code loop discriminator uses all the replica codes, the early, prompt and late I and Q replicas. Therefore, the P replica codes are also provided to the code discriminator  along with the E and L replica codes in case the dot product code discriminator is used.","The broad and narrow M code phase generator includes a code loop discriminator  for providing a code discriminator error signal that is filtered by a loop filter  for providing the code phase signal  and fed back to the code NCO input . The I and Q baseband signals output from the carrier wipe-off demodulator  are correlated with the code replica signals E, E, P, L, L, E, P, and Lusing a plurality of correlators through feeding a respective plurality of integrate and dump (I\/D) accumulators through for providing integrated I and Q signals fed into the code loop discriminator . Specifically, the Ereplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Ereplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Ereplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Ereplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Lreplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Lreplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Lreplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Lreplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Ereplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Ereplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Lreplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, the Lreplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Preplica is correlated with the I baseband signal by correlator and integrated by integrating dumper for providing an integrated Isignal, the Preplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal, the Preplica is correlated with the I baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Isignal, and the Preplica is correlated with the Q baseband signal by correlator and integrated by I\/D accumulator for providing an integrated Qsignal. The integrated I, I, Q, Q, I, I, Q, Q, I, I, Q, Q, Q, I, I, and Qsignals are fed into the code loop discriminator  that first detects the BOC signal envelopes by generating operating points on the unimodal correlation envelope at respective broad early, narrow early, prompt, narrow late, and broad late phase error times and provides the code discriminator error signal so that the code phase signal will adjust the code phase at the peak operating point of the prompt error time on the unimodal correlation envelope. Operating point differentials between early and late, and narrow early and narrow late code phases indicate the up or down direction of adjustment to the code phase error signal . The discriminator  can use various combinations of the integrated signals for determining the adjustments to the code phase error signal . The integrated I and Q baseband signals can be further used to adjust the carrier phase signal provided by the carrier tracking loop . Particularly, the Q, I, I, and Qsignals are fed into carrier tracking loop  for adjusting the carrier replica from the sine generator  and cosine generator  for precise coherent carrier demodulation wipe-off by the carrier wipe-off demodulator .","The integrate and dump integration period is usually matched to the predetection integration time period of the navigation data message modulation. The integrate and dump process reduces the digital process sample rate from the IF analog-to-digital sample rate of the order of 50.0 MHz for M code, to the navigation symbol rate of the order of 100.0 Hz for M code, which significantly reduces the baseband processing rate. Part of the M code is dataless, every other code chip, so the integrate and dump process can be extended when only the dataless code epochs are processed.","Referring to , the correlation envelopes of the inphase M code, the BOC(10,5) code, is characterized as multimodal having a plurality of peaks across a broad chip phase of one chip duration on each side of the zero phase point with a maximum center peak and three peaks of decreasing amplitude extending on each side from the center peak, as is well known, using a sum of the squares function. The correlation envelopes of the quadra-phase M code, the QBOC(10,5) code, is characterized also as multimodal having a plurality of peaks across a broad chip phase of one chip duration on each side of the zero phase point with a null at center zero phase point and with four peaks of decreasing amplitude extending on each side from the center null.","Referring to , and more particularly to , when the inphase (BOC) and quadra-phase (QBOC) correlation envelopes are appropriately combined they form a near unimodal correlation envelope that is characterized as having a single center peak with a decreasing amplitude extending from the center zero phase position. The combined correlation envelope is characterized and near unimodal by virtue of having a center peak with ripples appearing in the envelope.","Referring to , B, and A, and more particularly to , the code phase error is depicted as a function of the input error that changes as a function of the code phase between the incoming code and the prompt replica code. The input error is a function of an early correlation amplitude and a late correlation amplitude of the combined correlation envelope where the time differential between the early replica and late replica is a broad one-chip duration. That is, the code phase error is computed equal to (\u00bd)(Ec\u2212Lc)\/(Ec+Lc), where Ec is the combined early code envelope and Lc is the combined late code envelope with an effective correlator separation of one chip. To compute Ec and Lc, the broad integrated I, I, Q, Q, I, I, Q, and Qsignals are processed as Ec=\u221a[I+Q], where I=\u221a[I+I] and Q=\u221a[Q+Q], and as Lc=\u221a[I+Q], where I=\u221a[I+I] and I=\u221a[Q+Q], with these early and late replica are separated by a one chip duration. That is, the normalized broad unambiguous BOC(10,5) code loop discriminator output is based on the squares of the integrated I, I, Q, Q, I, I, Q, and Qsignals. Although the envelope computation is optimal, the power terms Eand Lcan also be used in the code discriminator algorithm to reduce the processing load by eliminating the square root computation. The code discriminator computes the code phase error by detecting the correlation envelope from the integrated I, I, Q, Q, I, I, Q, and Qsignals using sum of squares computations. However, while the code phase error is unambiguous and conveniently computed from only the I, I, Q, Q, I, I, Q, and Qsignals there exist three small, but undesirable, error reversals occurring in a quarter-chip duration at the zero input error point and at the plus and minus one-quarter chip input error points.","Referring to , B, A, and B to minimize the error reversals in a quarter-chip duration pull-in region surrounding the zero input error axis, the code loop discriminator can use the narrow integrated signals I, I, Q, and Qin connection with the BOC(10,5) correlation envelope shown  to implement an ambiguous normalized narrow code loop discriminator whose output is added to the output of the normalized combined broad discriminator output shown in .","The normalized ambiguous BOC(10,5) code loop discriminator function would have a nearly optimal narrow correlator one-eighth chip spacing duration. Only the narrow correlator BOC early and late signals Eand Lare used. These Eand Lsignals are used in the conventional code wipe-off demodulator to generate the narrow integrated signals I, I, Q, and Q. The normalized ambiguous narrow code phase error is computed equal to ( 1\/16)(En\u2212Ln)\/(En+Ln), where the early narrow envelope En=\u221a[I+Q] with I=\u221a[I+I] and Q=\u221a[Q+Q], and the late narrow envelope Ln=\u221a[I+Q] with I=\u221a[I+I] and Q=\u221a[Q+Q]. The normalized ambiguous narrow code phase error is added to the unambiguous combined broad code phase error to produce the nearly linear unambiguous code phase error shown in .","As observed in  when the ambiguous and unambiguous code loop discrimination functions are added together, most of the ripple of  has been removed and the resulting discriminator output has a near linear function about the zero axis point so that the resulting loop discriminator output is nearly a true representation of the input error. The code phase error output has been normalized by dividing the E\u2212L discriminator with the E+L signals to remove amplitude sensitivity of the code loop discriminator, which is important when operating in varying signal amplitude environments such as jamming. This code loop discriminator function can be used to solve the ambiguity problem for any BOC spread spectrum communications or navigation application, such as the M code BOC(10,5) signal.","The invention is directed to providing an unambiguous code phase error function base upon generating a quadra-phase BOC signal from a conventional inphase BOC signal, which may be an M code signal, and can be applied to both digital and analog front-end receivers. For example, the invention could be applied to a generic GPS N-channel digital receiver, where N is the number of digital channels implemented in a GPS receiver. The carrier frequency may be, for example the L frequency. For multiple frequency receivers, a separate down converter stage per frequency is required. The digital signal containing the digitized signals in space plus noise can be fed to all N digital channels. Each channel tracks one of the GPS signals in space by replicating the carrier signal plus any Doppler effects and a unique PRN code plus any Doppler effects. Using the replica carriers and PRN codes, these signals in space are despread and tracked, thereby producing the transmitted code phase and carrier phase observables and demodulating the navigation data message. The receiver or navigation processor controls the N digital receiver channels search and tracking processes, incorporates the observables and utilizes the navigation message data to locate all N satellites, to correct the measurements as required to navigate the phase center of the receiving antenna.","The addition of quadra-phase BOC replica signal for use in a code loop discriminator provides continuous ambiguity resolution in communications or navigation receivers operating with transmitted binary offset carrier modulated spread spectrum signals. The code loop discriminator can provide a normalized code phase error signal. The QBOC is used to solve the BOC code tracking ambiguity problem by the generation of a QBOC code replica. The combination of QBOC replica code with the replica BOC code produces a unimodal correlation characteristic with only one correlation peak occurring for all phase shifts within one chip period of the PRN chipping code sequence generator, thereby continuously removing all ambiguity in the code discriminator output signal for any spread spectrum receiver designed to operate with an incoming BOC signal.","The invention is applicable to combinations of code correlator spacing and all forms of unambiguous code discriminators. In particular, the correlator spacing and code discriminator combination optimizes the output error to the input error. The unambiguous code discriminator output uses a one-chip early minus late (E\u2212L) correlator spacing and a normalized (\u00bd)(E\u2212L)\/(E+L) code discriminator. The synthesis of inphase I and quadra-phase Q components resulting from code wipe-off with respect to the incoming BOC signals using the replica codes. In particular, the synthesis of QBOC I and Q signals. Various combinations of code correlator spacings for various forms of an ambiguous code discriminator having an output that can be added to the output of an unambiguous code discriminator. In particular, the ambiguous narrow correlator spacing that, when added to the unambiguous code correlator results in an unambiguous output error that best optimizes the output error to best equal the input error, such as the sum of the ambiguous code discriminator output and the unambiguous code discriminator. The loop discriminator function could be further enhanced for computation efficiency while using other integrated quadrature signals. Those skilled in the art can make enhancements, improvements, and modifications to the invention, and these enhancements, improvements, and modifications may nonetheless fall within the spirit and scope of the following claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2C"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 2D"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 3A"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 4A"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 4B"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 5A"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 5B"}]},"DETDESC":[{},{}]}
