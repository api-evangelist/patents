---
title: Method of noise reduction using correction and scaling vectors with partitioning of the acoustic space in the domain of noisy speech
abstract: A method and apparatus are provided for reducing noise in a training signal and/or test signal. The noise reduction technique uses a stereo signal formed of two channel signals, each channel containing the same pattern signal. One of the channel signals is “clean” and the other includes additive noise. Using feature vectors from these channel signals, a collection of noise correction and scaling vectors is determined. When a feature vector of a noisy pattern signal is later received, it is multiplied by the best scaling vector for that feature vector and the best correction vector is added to the product to produce a noise reduced feature vector. Under one embodiment, the best scaling and correction vectors are identified by choosing an optimal mixture component for the noisy feature vector. The optimal mixture component being selected based on a distribution of noisy channel feature vectors associated with each mixture component.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07003455&OS=07003455&RS=07003455
owner: Microsoft Corporation
number: 07003455
owner_city: Redmond
owner_country: US
publication_date: 20001016
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"p":["The present invention relates to noise reduction. In particular, the present invention relates to removing noise from signals used in pattern recognition.","A pattern recognition system, such as a speech recognition system, takes an input signal and attempts to decode the signal to find a pattern represented by the signal. For example, in a speech recognition system, a speech signal (often referred to as a test signal) is received by the recognition system and is decoded to identify a string of words represented by the speech signal.","To decode the incoming test signal, most recognition systems utilize one or more models that describe the likelihood that a portion of the test signal represents a particular pattern. Examples of such models include Neural Nets, Dynamic Time Warping, segment models, and Hidden Markov Models.","Before a model can be used to decode an incoming signal, it must be trained. This is typically done by measuring input training signals generated from a known training pattern. For example, in speech recognition, a collection of speech signals is generated by speakers reading from a known text. These speech signals are then used to train the models.","In order for the models to work optimally, the signals used to train the model should be similar to the eventual test signals that are decoded. In particular, the training signals should have the same amount and type of noise as the test signals that are decoded.","Typically, the training signal is collected under \u201cclean\u201d conditions and is considered to be relatively noise free. To achieve this same low level of noise in the test signal, many prior art systems apply noise reduction techniques to the testing data. In particular, many prior art speech recognition systems use a noise reduction technique known as spectral subtraction.","In spectral subtraction, noise samples are collected from the speech signal during pauses in the speech. The spectral content of these samples is then subtracted from the spectral representation of the speech signal. The difference in the spectral values represents the noise-reduced speech signal.","Because spectral subtraction estimates the noise from samples taken during a limited part of the speech signal, it does not completely remove the noise if the noise is changing over time. For example, spectral subtraction is unable to remove sudden bursts of noise such as a door shutting or a car driving past the speaker.","In another technique for removing noise, the prior art identifies a set of correction vectors from a stereo signal formed of two channel signals, each channel containing the same pattern signal. One of the channel signals is \u201cclean\u201d and the other includes additive noise. Using feature vectors that represent frames of these channel signals, a collection of noise correction vectors are determined by subtracting feature vectors of the noisy channel signal from feature vectors of the clean channel signal. When a feature vector of a noisy pattern signal, either a training signal or a test signal, is later received, a suitable correction vector is added to the feature vector to produce a noise reduced feature vector.","Under the prior art, each correction vector is associated with a mixture component. To form the mixture component, the prior art divides the feature vector space defined by the clean channel's feature vectors into a number of different mixture components. When a feature vector for a noisy pattern signal is later received, it is compared to the distribution of clean channel feature vectors in each mixture component to identify a mixture component that best suits the feature vector. However, because the clean channel feature vectors do not include noise, the shapes of the distributions generated under the prior art are not ideal for finding a mixture component that best suits a feature vector from a noisy pattern signal.","In addition, the correction vectors of the prior art only provided an additive element for removing noise from a pattern signal. As such, these prior art systems are less than ideal at removing noise that is scaled to the noisy pattern signal itself.","In light of this, a noise reduction technique is needed that is more effective at removing noise from pattern signals.","A method and apparatus are provided for reducing noise in a training signal and\/or test signal used in a pattern recognition system. The noise reduction technique uses a stereo signal formed of two channel signals, each channel containing the same pattern signal. One of the channel signals is \u201cclean\u201d and the other includes additive noise. Using feature vectors from these channel signals, a collection of noise correction and scaling vectors is determined. When a feature vector of a noisy pattern signal is later received, it is multiplied by the best scaling vector for that feature vector and the product is added to the best correction vector to produce a noise reduced feature vector. Under one embodiment, the best scaling and correction vectors are identified by choosing an optimal mixture component for the noisy feature vector. The optimal mixture component being selected based on a distribution of noisy channel feature vectors associated with each mixture component.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, FR, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way o example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in FIG. , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.","Under the present invention, a system and method are provided that reduce noise in pattern recognition signals. To do this, the present invention identifies a collection of scaling vectors, S, and correction vectors, r, that can be respectively multiplied by and added to a feature vector representing a portion of a noisy pattern signal to produce a feature vector representing a portion of a \u201cclean\u201d pattern signal. A method for identifying the collection of scaling vectors and correction vectors is described below with reference to the flow diagram of  and the block diagram of . A method of applying scaling vectors and correction vectors to noisy feature vectors is described below with reference to the flow diagram of  and the block diagram of .","The method of identifying scaling vectors and correction vectors begins in step  of , where a \u201cclean\u201d channel signal is converted into a sequence of feature vectors. To do this, a speaker  of , speaks into a microphone , which converts the audio waves into electrical signals. The electrical signals are then sampled by an analog-to-digital converter  to generate a sequence of digital values, which are grouped into frames of values by a frame constructor . In one embodiment, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second and frame constructor  creates a new frame every 10 milliseconds that includes 25 milliseconds worth of data.","Each frame of data provided by frame constructor  is converted into a feature vector by a feature extractor . Examples of feature extraction modules include modules for performing Linear Predictive Coding (LPC), LPC derived cepstrum, Perceptive Linear Prediction (PLP), Auditory model feature extraction, and Mel-Frequency Cepstrum Coefficients (MFCC) feature extraction. Note that the invention is not limited to these feature extraction modules and that other modules may be used within the context of the present invention.","In step  of , a noisy channel signal is converted into feature vectors. Although the conversion of step  is shown as occurring after the conversion of step , any part of the conversion may be performed before, during or after step  under the present invention. The conversion of step  is performed through a process similar to that described above for step .","In the embodiment of , this process begins when the same speech signal generated by speaker  is provided to a second microphone . This second microphone also receives an additive noise signal from an additive noise source . Microphone  converts the speech and noise signals into a single electrical signal, which is sampled by an analog-to-digital converter . The sampling characteristics for A\/D converter  are the same as those described above for A\/D converter . The samples provided by A\/D converter  are collected into frames by a frame constructor , which acts in a manner similar to frame constructor . These frames of samples are then converted into feature vectors by a feature extractor , which uses the same feature extraction method as feature extractor .","In other embodiments, microphone , A\/D converter , frame constructor  and feature extractor  are not present. Instead, the additive noise is added to a stored version of the speech signal at some point within the processing chain formed by microphone , A\/D converter , frame constructor , and feature extractor . For example, the analog version of the \u201cclean\u201d channel signal may be stored after it is created by microphone . The original \u201cclean\u201d channel signal is then applied to A\/D converter , frame constructor , and feature extractor . When that process is complete, an analog noise signal is added to the stored \u201cclean\u201d channel signal to form a noisy analog channel signal. This noisy signal is then applied to A\/D converter , frame constructor , and feature extractor  to form the feature vectors for the noisy channel signal.","In other embodiments, digital samples of noise are added to stored digital samples of the \u201cclean\u201d channel signal between A\/D converter  and frame constructor , or frames of digital noise samples are added to stored frames of \u201cclean\u201d channel samples after frame constructor . In still further embodiments, the frames of \u201cclean\u201d channel samples are converted into the frequency domain and the spectral content of additive noise is added to the frequency-domain representation of the \u201cclean\u201d channel signal. This produces a frequency-domain representation of a noisy channel signal that can be used for feature extraction.","The feature vectors for the noisy channel signal and the \u201cclean\u201d channel signal are provided to a noise reduction trainer  in . At step  of , noise reduction trainer  groups the feature vectors for the noisy channel signal into mixture components. This grouping can be done by grouping feature vectors of similar noises together using a maximum likelihood training technique or by grouping feature vectors that represent a temporal section of the speech signal together. Those skilled in the art will recognize that other techniques for grouping the feature vectors may be used and that the two techniques listed above are only provided as examples.","After the feature vectors of the noisy channel signal have been grouped into mixture components, noise reduction trainer  generates a set of distribution values that are indicative of the distribution of the feature vectors within the mixture component. This is shown as step  in . In many embodiments, this involves determining a mean vector and a standard deviation vector for each vector component in the feature vectors of each mixture component. In an embodiment in which maximum likelihood training is used to group the feature vectors, the means and standard deviations are provided as by-products of identifying the groups for the mixture components.","Once the means and standard deviations have been determined for each mixture component, the noise reduction trainer  determines a correction vector, r, and a scaling vector Sk, for each mixture component, k, at step  of . Under one embodiment, the vector components of the scaling vector and the vector components of the correction vector for each mixture component are determined using a weighted least squares estimation technique. Under this technique, the scaling vector components are calculated as: \n\n\nand the correction vector components are calculated as: \n\n","Where Sis the ivector component of a scaling vector, S, for mixture component k, ris the ivector component of a correction vector, r, for mixture component k, Yis the ivector component for the feature vector in the tframe of the noisy channel signal, xis the ivector component for the feature vector in the tframe of the \u201cclean\u201d channel signal, T is the total number of frames in the \u201cclean\u201d and noisy channel signals, and p(k|y) is the probability of the kmixture component given the feature vector component for the tframe of the noisy channel signal.","In equations 1 and 2, the p(k|y) term provides a weighting function that indicates the relative relationship between the kmixture component and the current frame of the channel signals.","The p(k|y) term can be calculated using Bayes' theorem as: \n\n","Where p(y|k) is the probability of the ivector component in the noisy feature vector given the kmixture component, and p(k) is the probability of the kmixture component.","The probability of the ivector component in the noisy feature vector given the kmixture component, p(y|k), can be determined using a normal distribution based on the distribution values determined for the kmixture component in step  of . In one embodiment, the probability of the kmixture component, p(k), is simply the inverse of the number of mixture components. For example, in an embodiment that has 256 mixture components, the probability of any one mixture component is 1\/256.","After a correction vector and a scaling vector have been determined for each mixture component at step , the process of training the noise reduction system of the present invention is complete. The correction vectors, scaling vectors, and distribution values for each mixture component are then stored in a noise reduction parameter storage  of .","Once the correction vector and scaling vector have been determined for each mixture, the vectors may be used in a noise reduction technique of the present invention. In particular, the correction vectors and scaling vectors may be used to remove noise in a training signal and\/or test signal used in pattern recognition.",{"@attributes":{"id":"p-0054","num":"0053"},"figref":["FIG. 5","FIG. 5"],"b":"500","br":{},"in-line-formulae":[{},{}],"i":["arg","c","N","y;\u03bc"],"sub":["k ","k","k","k"]},"Where {circumflex over (k)} is the best matching mixture component, cis a weight factor for the kmixture component, N(y;\u03bc,\u03a3) is the value for the individual noisy feature vector, y, from the normal distribution generated for the mean vector, \u03bc, and the standard deviation vector, \u03a3, of the kmixture component. In most embodiments, each mixture component is given an equal weight factor C.","Note that under the present invention, the mean vector and standard deviation vector for each mixture component is determined from noisy channel vectors and not \u201cclean\u201d channel vectors as was done in the prior art. Because of this, the normal distributions based on these means and standard deviations are better shaped for finding a best mixture component for a noisy pattern vector.","Once the best mixture component for each input feature vector has been identified at step , the corresponding scaling and correction vectors for those mixture components are (element by element) multiplied by and added to the individual feature vectors to form \u201cclean\u201d feature vectors. In terms of an equation:\n\n\u2003\u2003EQ. 5\n","Where xis the ivector component of an individual \u201cclean\u201d feature vector, yis the ivector component of an individual noisy feature vector from the input signal, and Sand rare the ivector component of the scaling and correction vectors, respectively, both optimally selected for the individual noisy feature vector. The operation of Equation 5 is repeated for each vector component. Thus, Equation 5 can be re-written in vector notation as:\n\n\u2003\u2003EQ. 5\n\n",{"@attributes":{"id":"p-0059","num":"0059"},"figref":["FIG. 6","FIG. 6"]},"In , a speaker , either a trainer or a user, speaks into a microphone . Microphone  also receives additive noise from one or more noise sources . The audio signals detected by microphone  are converted into electrical signals that are provided to analog-to-digital converter . Although additive noise  is shown entering through microphone  in the embodiment of , in other embodiments, additive noise  may be added to the input speech signal as a digital signal after A-to-D converter .","A-to-D converter  converts the analog signal from microphone  into a series of digital values. In several embodiments, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second. These digital values are provided to a frame constructor , which, in one embodiment, groups the values into 25 millisecond frames that start 10 milliseconds apart.","The frames of data created by frame constructor  are provided to feature extractor , which extracts a feature from each frame. The same feature extraction that was used to train the noise reduction parameters (the scaling vectors, correction vectors, means, and standard deviations of the mixture components) is used in feature extractor . As mentioned above, examples of such feature extraction modules include modules for performing Linear Predictive Coding (LPC), LPC derived cepstrum, Perceptive Linear Prediction (PLP), Auditory model feature extraction, and Mel-Frequency Cepstrum Coefficients (MFCC) feature extraction.","The feature extraction module produces a stream of feature vectors that are each associated with a frame of the speech signal. This stream of feature vectors is provided to noise reduction module  of the present invention, which uses the noise reduction parameters stored in noise reduction parameter storage  to reduce the noise in the input speech signal. In particular, as shown in , noise reduction module  selects a single mixture component for each input feature vector and then multiplies the input feature vector by that mixture component's scaling vector and adding that mixture component's correction vector to the product to produce a \u201cclean\u201d feature vector.","Thus, the output of noise reduction module  is a series of \u201cclean\u201d feature vectors. If the input signal is a training signal, this series of \u201cclean\u201d feature vectors is provided to a trainer , which uses the \u201cclean\u201d feature vectors and a training text  to train an acoustic model . Techniques for training such models are known in the art and a description of them is not required for an understanding of the present invention.","If the input signal is a test signal, the \u201cclean\u201d feature vectors are provided to a decoder , which identifies a most likely sequence of words based on the stream of feature vectors, a lexicon , a language model , and the acoustic model . The particular method used for decoding is not important to the present invention and any of several known methods for decoding may be used.","The most probable sequence of hypothesis words is provided to a confidence measure module . Confidence measure module  identifies which words are most likely to have been improperly identified by the speech recognizer, based in part on a secondary acoustic model (not shown). Confidence measure module  then provides the sequence of hypothesis words to an output module  along with identifiers indicating which words may have been improperly identified. Those skilled in the art will recognize that confidence measure module  is not necessary for the practice of the present invention.","Although  depicts a speech recognition system, the present invention may be used in any pattern recognition system and is not limited to speech.","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
