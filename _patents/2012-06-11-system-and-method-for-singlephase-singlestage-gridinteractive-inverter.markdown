---
title: System and method for single-phase, single-stage grid-interactive inverter
abstract: The present invention provides for the integration of distributed renewable energy sources/storages utilizing a cascaded DC-AC inverter, thereby eliminating the need for a DC-DC converter. The ability to segment the energy sources and energy storages improves the maintenance capability and system reliability of the distributed generation system, as well as achieve wide range reactive power compensation. In the absence of a DC-DC converter, single stage energy conversion can be achieved to enhance energy conversion efficiency.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09124136&OS=09124136&RS=09124136
owner: The Florida State University Research Foundation, Inc.
number: 09124136
owner_city: Tallahassee
owner_country: US
publication_date: 20120611
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","STATEMENT OF GOVERNMENT INTEREST","BACKGROUND OF THE INVENTION","SUMMARY OF INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["This application claims priority to currently co-pending U.S. Provisional Patent Application No. 61\/495,458, entitled \u201cSystem and Method for Single-Phase, Single-Stage Grid-Interactive Converter\u201d, filed on Jun. 10, 2011, and incorporated herein by reference.","This invention was made with Government support under DE-FC26-07NT43221 awarded by the Department of Energy. The Government has certain rights in the invention.","Distributed generation, also commonly referred to as on-site generation, dispersed generation, embedded generation, decentralized generation, decentralized energy or distributed energy, generates electricity from multiple small energy sources. The distributed power generation system comprising the multiple small energy sources is interconnected with the same transmission grid as the larger central power generation stations. Various technical and economic issues arise in the integration of these distributed generation resources into the grid, such as power quality, voltage stability, presence of harmonics and reliability.","Grid-interactive converters\/inverters with energy storage system (ESS) for distributed power generation (DG) systems have been gaining popularity in response to the requirements for energy source\/storage diversity, environmental concerns, desired cost reduction, improvements in efficiency, etc. One main challenge in DG systems is determining how to improve the efficiency, reduce the cost and improve the power quality of the current DG systems known in the art.","Traditionally, AC link systems and DC link systems have been employed in distributed generation systems known in the art. In the DC link system, as shown in ), multiple DC-DC converters are used to interface different energy sources\/storages. In order to achieve the DC-AC energy conversion, the DC-DC converters are usually connected to one inverter with a common DC bus. As a result, the DC link system configuration still requires DC-DC and DC-AC conversion stages. Limited switching frequency on the common inverter results in the requirement for a large AC filter and large electrolyte capacitors, which seriously impacts the overall system efficiency, cost and lifetime of the inverter. Furthermore, in order to achieve desired wide range reactive power compensation, the DC capacitor and inverter must be oversized to generate the possible AC output voltage.","As shown with reference to , in the traditional AC link system, multiple DC-DC converters and DC-AC inverters are used to interface different energy sources\/storages as shown in ). Though the real and reactive power can be distributed flexibly between different energy sources\/storages utilizing the AC link system, the system requires multiple energy conversion stages. Moreover, due to the common AC bus used in the AC link system, the power flow control must to be carefully designed, particularly to address the needs of weak power systems. In an AC link system, the overall system cost will increase due to the need for multiple converters and inverters and large passive components. In addition, the transformer utilized in both the DC link and the AC link systems described above will increase the overall system size and reduce the power density.","Accordingly, what is needed in the art is a distributed generation (DG) system that exhibits high power density, high power efficiency, high power quality and high system reliability.","The present invention provides for the integration of distributed renewable energy sources\/storages utilizing a cascaded DC-AC inverter, thereby eliminating the need for a DC-DC converter. The ability to segment the energy sources\/storages will improve the maintenance capability and system reliability. In the absence of a DC-DC converter, single stage energy conversion can be achieved.","A system in accordance with the present invention integrates scalable cascaded architecture, an advanced Discrete Fourier Transform (DFT) Phase Locked Loop (PLL) method, a hybrid modulation technique and a sophisticated power allocation strategy to achieve wide range reactive power compensation, improve the system power density, and enhance energy conversion efficiency.","In a specific embodiment of the invention, an inverter for a distributed generation system is provided. The inverter may include a main DC to AC inverter to be coupled to the at least one distributed energy source, the main DC to AC inverter to provide a real power of the inverter and to provide a first portion of a reactive power of the inverter and at least one auxiliary DC to AC inverter in cascade with the main DC to AC inverter, each of the at least one auxiliary DC to AC inverters to be coupled to one of each of the at least one energy storages and each of the at least one auxiliary DC to AC inverters to provide a remaining portion of the reactive power of the inverter, wherein the sum of the first portion of the reactive power from the main inverter and each of the remaining portions of the reactive power from each of the auxiliary inverters equals a total reactive power of the inverter for the distributed generation system.","In a particular embodiment, the main DC to AC inverter and the auxiliary DC to AC inverters may be H-bridge cells.","In an additional embodiment, the main DC to AC inverter may switch at a fundamental frequency and the auxiliary DC to AC inverters may switch at a pulse-width-modulated frequency.","In operation, a method for inverting DC to AC in a distributed generation system, is provided by the present invention. The method may include calculating a reactive power allocation coefficient, providing a real power and a first portion of a reactive power of the inverter from a main DC to AC inverter coupled to the at least one distributed energy source, wherein the first portion of the reactive power is dependent upon the reactive power allocation coefficient and providing a remaining portion of the reactive power of the inverter from each of at least one auxiliary DC to AC inverters coupled in cascade to the main DC to AC inverter and coupled to each of the at least one energy storages, wherein the remaining portion of the reactive power is dependent upon the reactive power allocation coefficient and wherein the sum of the first portion of the reactive power from the main inverter and the remaining portion of the reactive power from each of the auxiliary inverters equals a total reactive power of the inverter.","The present invention can achieve high power efficiency, high power density, high power quality and high system reliability as a result of the single stage energy conversion, transformer-free structure, wide range reactive power compensation, multilevel AC output with equivalent high frequency, possible low frequency for each switching device, and redundant capability. Additionally, the incorporation of the present invention into future smart grid implementations is promising.","With reference to , an embodiment of the present invention in a distributed generation (DG) system  having distributed energy sources (DES)  and energy storages (ES)  is illustrated. The output of the distributed energy sources (DES)  and the energy storages (ES)  are coupled to a cascaded DC-AC inverter . The output of the cascaded DC-AC inverter  is coupled to the grid  through an appropriate filter .","In an exemplary embodiment of the present invention, one distributed energy source (DES)  and two energy storages (ES) , are interfaced to the inverter  utilizing three cascaded H-bridge cells , , , as illustrated with reference to ). In the single-phase single-stage DG system  in accordance with the exemplary embodiment of the present invention, as shown in ), the \u201cmain\u201d inverter cell is coupled to the distributed energy source  and the \u201cauxiliary\u201d inverter cells , are coupled to the energy storages , . In a particular embodiment, the energy storages , may be ultra-capacitors. In additional embodiments, the energy storages , may include battery storage, flow batteries, flywheel, superconducting magnetic energy storage (SMES), compressed air energy storage (CAES), or other various energy storages solutions known in the art. The different energy sources and energy storages integrating with the cascaded inverter can be selected based upon a specific application. In a particular embodiment, the voltage ratio between V, associated with the main inverter cell , and Vand V, associated with the auxiliary inverter cells , , may be 2:1:1, respectively. The \u201cmain\u201d and \u201cauxiliary\u201d inverters may switch at the fundamental and a pulse-width modulated (PWM) frequency, respectively.","The real and reactive power allocation between the distributed energy sources  and the energy storages , is shown with reference to ). P_grid  and Q_grid  are representative of the real power P and the reactive power Q delivered to the grid . P_main  and Q_main  represent the real power P and reactive power Q generated from the main inverter cell . Q_auxi  and Q_auxi  represent the reactive power Q from the auxiliary inverter cells , . As such, in the present invention, the main inverter cell provides all of the real power  and a portion of the reactive power Q  to the grid and the auxiliary inverters , provide the remaining portion of the reactive power . P_auxi  and P_auxi  are delivered from the main inverter to the auxiliary inverter cells , to charge the energy storages , during start-up, compensate the for power loss and maintain the energy storages , voltage during grid-connected mode. In addition, the low-order harmonic voltages  generated by the main inverter resulting from the fundamental switching frequency are cancelled by the equivalent negative harmonic voltages ,  generated from the auxiliary inverters , . The distributed power generation system  is able to operate in both stand-alone mode and grid-connected mode through a static transfer switch (STS) .","One advantage of the cascaded inverter structure of the present invention is that the DC voltage of each inverter cell can be reduced. However, the reduced DC voltage will affect the reactive power generation capability. In order to achieve wide range reactive power compensation, it is desired that the reactive power is provided by all the inverter cells instead of a single inverter cell. The desired distribution of the reactive power among the inverter cells , , is based upon a proposed reactive power allocation (RPA) strategy.","A vector diagram is shown in  illustrating the reactive power distribution between the distributed energy source  and the energy storages , . The rotation frequency of the pq frame is the system frequency. ,  and  and are the vectors of i, v, and vrespectively where the latter can be identified with reference to ).  is the fundamental component of the main inverter output voltage.  and  is the q-axis and p-axis component of  respectively in the vector diagram. Since the real power is entirely provided by the main inverter , the p-axis component of  is the same as that of . k is defined as reactive power allocation coefficient (RPAC). \u03b1 is the phase shift angle between  and . \u03b2 is the angle between  and . \u03b4 is the phase shift between  and . \u03b8 is the switching angle of main inverter.","In grid-connected mode, the real and reactive power delivered to the grid , as well as grid voltage, are known. The average real and reactive power delivered to the grid  can be given by:",{"@attributes":{"id":"p-0043","num":"0042"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mo":"{","mtable":{"mtr":[{"mtd":{"mrow":{"mi":"P_grid","mo":"=","mrow":{"mfrac":{"mrow":[{"msub":[{"mi":["V","g"]},{"mi":["V","inv"]}],"mo":"\u2062"},{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c9","L"]}]},"mo":["\u2062","\u2062","\u2062"],"mi":["sin","\u03b4"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"mtd":{"mrow":{"mi":"Q_grid","mo":"=","mrow":{"mfrac":{"msub":{"mi":["V","g"]},"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c9","L"]}},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mrow":{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062","\u2062"],"mi":["cos","\u03b4"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","msub":{"mi":["V","g"]}}}}}}}]}}},{"mrow":{"mo":["(",")"],"mn":"1"}}]}}}}},"where Vis the amplitude of the grid voltage; Vis the amplitude of the cascaded inverter output voltage; \u03c9 is the fundamental frequency; L=L+Lis the total filter inductor. The filter capacitor is neglected.","According to (1), the phase shift between grid voltage and cascaded inverter output voltage can be calculated as:",{"@attributes":{"id":"p-0046","num":"0045"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"\u03b4","mo":"=","mrow":{"msup":{"mi":"tan","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":[{"mi":["P_grid","\u03c9","L"],"mo":["\u00d7","\u2062","\u2062","\u2062","\u2062"],"mn":"2","mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"mrow":{"mi":["Q_grid","\u03c9","L"],"mo":["\u00d7","\u2062","\u2062","\u2062","\u2062"],"mn":"2","mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"mo":"+","msubsup":{"mi":["V","g"],"mn":"2"}}]}}}}},{"mrow":{"mo":["(",")"],"mn":"2"}}]}}}}},"The average real and reactive power delivered to grid can also be represented in (3):",{"@attributes":{"id":"p-0048","num":"0047"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mo":"{","mtable":{"mtr":[{"mtd":{"mrow":{"mi":"P_grid","mo":"=","mrow":{"mfrac":{"mrow":{"msub":[{"mi":["V","g"]},{"mi":"I","mrow":{"mi":"L","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"}}],"mo":"\u2062"},"mn":"2"},"mo":["\u2062","\u2062","\u2062"],"mi":["cos","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"mtd":{"mrow":{"mi":"Q_grid","mo":"=","mrow":{"mfrac":{"mrow":{"msub":[{"mi":["V","g"]},{"mi":"I","mrow":{"mi":"L","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"}}],"mo":"\u2062"},"mn":"2"},"mo":["\u2062","\u2062","\u2062"],"mi":["sin","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}}]}}},{"mrow":{"mo":["(",")"],"mn":"3"}}]}}}}},"where Iis the amplitude of the inductor current.","So, the angle between grid voltage and inductor current can be obtained in (4):",{"@attributes":{"id":"p-0051","num":"0050"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"\u03b2","mo":"=","mrow":{"msup":{"mi":"tan","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["Q_grid","P_grid"]}}}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]}}}}},"The phase shift between cascaded inverter output voltage and inductor current can be obtained by adding (2) to (4) as:\n\n\u03b1=\u03b2+\u03b4\u2003\u2003(5)\n","Based on (1), the Vcan be derived in (6):",{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["V","inv"]},"mo":"=","msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"mfrac":{"mrow":{"mi":["Q_grid","\u03c9","L"],"mo":["\u00d7","\u2062","\u2062","\u2062","\u2062"],"mn":"2","mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"msub":{"mi":["V","g"]}},"mo":"+","msub":{"mi":["V","g"]}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mi":["P_grid","\u03c9","L"],"mo":["\u00d7","\u2062","\u2062","\u2062","\u2062"],"mn":"2","mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"msub":{"mi":["V","g"]}}},"mn":"2"}],"mo":"+"}}}},{"mrow":{"mo":["(",")"],"mn":"6"}}]}}}}},"The Fourier series expansion of the quasi-square-wave of main inverter output voltage is given by:",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["v","main"]},"mo":"=","mrow":{"mrow":[{"munderover":{"mo":"\u2211","mrow":{"mrow":{"mi":"n","mo":"=","mn":"1"},"mo":[",",",",","],"mn":["3","5"],"mi":"\u2026"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mfrac":{"mrow":[{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["V","dc"]}},{"mi":["n","\u03c0"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},"mo":["\u2062","\u2062"],"mrow":[{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["n","\u03b8"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"n","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03c6"}}}}}]}},{"msub":[{"mi":"v","mrow":{"mi":["main","_","F"],"mo":["\u2062","\u2062"]}},{"mi":"v","mrow":{"mi":["main","_","h"],"mo":["\u2062","\u2062"]}}],"mo":"+"}],"mo":"="}}},{"mrow":{"mo":["(",")"],"mn":"7"}}]}}}}},"Where \u03c6 is phase-shift angle between  and , Vis the main inverter dc input voltage,",{"@attributes":{"id":"p-0058","num":"0057"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"v","mrow":{"mi":["main","_","F"],"mo":["\u2062","\u2062"]}},"mo":"=","mrow":{"mfrac":{"mrow":{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["V","dc"]}},"mi":"\u03c0"},"mo":["\u2062","\u2062"],"mrow":[{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03b8"}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03c6"}}}]}}}},"br":{},"sub":"main"},{"@attributes":{"id":"p-0059","num":"0058"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"v","mrow":{"mi":["main","_","h"],"mo":["\u2062","\u2062"]}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mrow":{"mi":"n","mo":"=","mn":"1"},"mo":[",",",",","],"mn":["3","5"],"mi":"\u2026"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mfrac":{"mrow":[{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["V","dc"]}},{"mi":["n","\u03c0"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},"mo":["\u2062","\u2062"],"mrow":[{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["n","\u03b8"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"n","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03c6"}}}}}]}}}}},"br":{},"sub":"main"},"According to , the transient fundamental component of the main inverter output voltage can be given as:",{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"msub":{"mi":"v","mrow":{"mi":["main","_","F"],"mo":["\u2062","\u2062"]}},"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":[{"msub":[{"mi":["v","invp"]},{"mi":["kv","invq"]}],"mo":"+"},{"mrow":[{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mi":["cos","\u03b1"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mrow":{"mi":"\u2022sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03b2"}}}},{"mi":["k","sin"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mi":["V","inv"]},"mrow":{"mi":"\u03b1\u2022cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03b2"}}}}],"mo":"+"}],"mo":"="}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062"],"msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"mi":["cos","\u03b1"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"mi":["k","sin","\u03b1"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}},"mn":"2"}],"mo":"+"}},"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":["-","+"],"mi":["\u03b2","\u03b3"]}}}}}}}]}},{"mrow":{"mo":["(",")"],"mn":"8"}}]}}}}},"Where,",{"@attributes":{"id":"p-0063","num":"0062"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"\u03b3","mo":"=","mrow":{"mi":"arcsin","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mi":["k","sin","\u03b1"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"mi":["cos","\u03b1"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"mi":["k","sin","\u03b1"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}},"mn":"2"}],"mo":"+"}}}}}},{"msub":{"mi":["v","invp"]},"mo":"=","mrow":{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062","\u2062"],"mi":"cos","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03b1\u2022sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03b2"}}}}},{"msub":{"mi":["v","invq"]},"mo":"=","mrow":{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062","\u2062"],"mi":"sin","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03b1\u2022cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"-","mi":"\u03b2"}}}}}],"mo":[",",","]},"mo":"\u2062","mstyle":{"mtext":{}}}}}},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0065","num":"0064"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"\u03b8","mo":"=","mrow":{"msup":{"mi":"cos","mrow":{"mo":"-","mn":"1"}},"mo":["[","]"],"mrow":{"mfrac":[{"msub":[{"mi":["V","inv"]},{"mi":["V","dc"]}]},{"mi":"\u03c0","mn":"4"}],"mo":["\u00d7","\u00d7"],"msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"mi":["cos","\u03b1"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"mi":["k","sin","\u03b1"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}},"mn":"2"}],"mo":"+"}}}}}},{"mrow":{"mo":["(",")"],"mn":"9"}}]}}}}},"where Vis the main inverter DC input voltage.","Based on the vector analysis of , extracting the real and reactive components of vis essential to establish the desired power allocation. In order to extract the real and reactive components of v, a Discrete Fourier Transform (DFT) Phase-Locked Loop (PLL) method is proposed, as shown in .","The DFT PLL method of the present invention can extract the phase, frequency and amplitude information from any signal. The DFT PLL method of the present invention is capable of extracting the fundamental component from any input signal without damping. This is in contrast to the prior art in which the harmonic components of the input signal degrades the PLL performance. As such, the proposed DFT PLL method is immune to the degradation effect resulting from the harmonic components. Additionally, in the DFT PLL method of the present invention, the controlled DC component is only related to the angle of the input signal which allows the control system for the PLL to be applicable within a wide range, and moreover the amplitude change of the input signal will not have an impact on the DFT PLL performance. This is in contract to the prior art, in which one DC component is related to amplitude and angle of the input signal and is controlled to be zero and used to achieve the PLL. As such, the proposed DFT PLL method is immune to harmonics and signal amplitude which may affect the PLL performance. As illustrated in , any signal including harmonic components can be expressed as follows:",{"@attributes":{"id":"p-0069","num":"0068"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mrow":[{"msub":{"mi":["u","o"]},"mo":"+","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["u","k"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"mo":"+","msub":{"mi":["\u03b8","k"]}}}}}}}},{"msub":{"mi":["u","o"]},"mo":"+","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"mrow":[{"msub":{"mi":["u","ky"]},"mo":"\u2062","mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}}},{"msub":{"mi":["u","kx"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}}}],"mo":"+"}}}}],"mo":"="}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"10"}}]}}}}},"Where uis the dc component; \u03c9 is the fundamental frequency,",{"@attributes":{"id":"p-0071","num":"0070"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["u","kx"]},"mo":"=","mrow":{"mfrac":{"mn":"2","mi":"T"},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"T"},"mo":"\u2062","mrow":{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["k\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}}},{"msub":{"mi":["u","ky"]},"mo":"=","mrow":{"mfrac":{"mn":"2","mi":"T"},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"T"},"mo":"\u2062","mrow":{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mo":["(",")"],"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mi":"cos","mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}]}}}},{"msub":{"mi":["\u03b8","k"]},"mo":"=","mrow":{"msup":{"mi":"tg","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["u","ky"]},{"mi":["u","kx"]}],"mo":"\/"}}}},{"mi":"T","mo":"=","mrow":{"mn":"2","mo":"\u2062","mrow":{"mi":"\u03c0","mo":"\/","mrow":{"mi":"\u03c9","mo":"."}}}}],"mo":[";","\u2062",";",";"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},"For PLL, only the fundamental component is of concern. The fundamental component is converted to a DC component by (9):",{"@attributes":{"id":"p-0073","num":"0072"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},"mo":"="}},{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mrow":[{"mo":["[","]"],"mrow":{"msub":{"mi":["u","o"]},"mo":"+","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["u","k"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"mo":"+","msub":{"mi":["\u03b8","k"]}}}}}}}}},{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},"mo":"="}}},{"mtd":{"mrow":{"mrow":[{"mfrac":{"msub":{"mi":"u","mn":"1"},"mn":"2"},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03b8","mn":"1"}}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["u","kt"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"mo":"+","msub":{"mi":["\u03c6","k"]}}}}}}}],"mo":"+"}}}]}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},"mo":"="}},{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mrow":[{"mo":["[","]"],"mrow":{"msub":{"mi":["u","o"]},"mo":"+","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["u","k"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["k","\u03c9t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"+","msub":{"mi":["\u03b8","k"]}}}}}}}}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},"mo":"="}}},{"mtd":{"mrow":{"mrow":[{"mfrac":{"msub":{"mi":"u","mn":"1"},"mn":"2"},"mo":"\u2062","mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03b8","mn":"1"}}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["[","]"],"mrow":{"msubsup":{"mi":["u","kt","\u2032"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["k","\u03c9","t"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},"mo":"+","msubsup":{"mi":["\u03c6","k","\u2032"]}}}}}}}],"mo":"+"}}}]}}]}]}}},{"mrow":{"mo":["(",")"],"mn":"11"}}]}}}}},"Where uis the desired fundamental component; \u03b8is the phase angle of fundamental component; uis the kth order harmonic component; \u03b8is the phase angle of the kth order harmonic component;","And then the DC component is extracted by (12)",{"@attributes":{"id":"p-0076","num":"0075"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mo":"{","mtable":{"mtr":[{"mtd":{"mrow":{"msub":{"mi":"u","mrow":{"mn":"1","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"p"}},"mo":"=","mrow":{"mrow":[{"mfrac":{"mn":"2","mi":"T"},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"T"},"mo":"\u2062","mrow":{"mrow":[{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}},{"msub":{"mi":"u","mn":"1"},"mo":"\u00b7","mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03b8","mn":"1"}}}}],"mo":"="}}}},{"mtd":{"mrow":{"msub":{"mi":"u","mrow":{"mn":"1","mo":"\u2062","mi":"q"}},"mo":"=","mrow":{"mrow":[{"mfrac":{"mn":"2","mi":"T"},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"T"},"mo":"\u2062","mrow":{"mrow":[{"mrow":[{"mi":"u","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00b7"},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}},{"msub":{"mi":"u","mn":"1"},"mo":"\u00b7","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03b8","mn":"1"}}}}],"mo":"="}}}}]}}},{"mrow":{"mo":["(",")"],"mn":"12"}}]}}}}},"Based on (10)-(12), the \u03b8can be derived in (13):\n\n\u03b8=tan()\u2003\u2003(13)\n","Once the \u03b8is extracted from u(t), it can be treated as the regulated error signal as shown in . The proportional integral (PI) controller can control \u03b8to be zero in real time to achieve the PLL of u(t).","Experimental results are shown in  to verify the performance of the proposed DFT PLL method under different conditions. ) shows the performance of the DFT PLL when the input signal is a square wave, which includes all-order harmonic components. With a square wave input, the output signal is the sinusoidal signal extracted from the square wave. It can be seen that the sinusoidal output signal can track the input signal within three cycles. ) illustrates the performance of the DFT PLL when the input signal is a triangular wave, which includes abundant low-order harmonic components. When the input signal is a triangular wave, the output signal is the sinusoidal signal extracted from the triangular wave. In the beginning, the output signal is opposite in phase with the input signal, but the sinusoidal signal can still track the input signal within five cycles. ) and () show the dynamic response when the frequency of the input sinusoidal signal increases from 60 Hz to 70 Hz and decreases from 60 Hz to 50 Hz, respectively. As illustrated with reference to , it is obvious that the output sinusoidal signal can track the input signal within only one cycle.","As mentioned above, the output voltage of the cascaded inverter  dominates the power allocation between DES  and ES , because the same inductor current iflows through the cascaded inverter . Accordingly, a preferred dual-stage DFT PLL approach is developed to synchronize the inductor current iand extract the active and reactive components of vrelative to i, as shown with reference to . In the first stage, v, which is u(t) in , is used for the PLL signal. The phase angle \u03c9t corresponding to vis obtained and used for the synchronization of iand v. In the second stage, iand vare synchronized with vby exploiting the same approach as shown in (11)-(13). The phase angles \u03b2 and \u03b4 of iand vrelative to vcan be derived and then synthesize the \u03b1, which is the phase shift angle between iand v. After obtaining the voltage amplitude V, \u03b1 and \u03c9t, the vand v, which are the components of the vin phase with iand leading 90\u00b0 to irespectively, can be obtained and matched with (8). The derived vcombing with the selected k may then be used to conduct the reactive power from distributed energy sources  and energy storages , ","The reactive power allocation strategy with hybrid fundamental and PWM control, in accordance with the present invention, is illustrated with reference to . In order to effectively achieve the desired power allocation, it is vital to accurately calculate the v, vand v. In ), the iv, and vare firstly measured and sent to the \u201cDual-stage DFT PLL\u201d module as shown in , which generates the \u03b1, V, vand v. The detected PV voltage V, \u03b1, V, and k dedicate together to generate the switching angle of main inverter \u03b8 presented in (9). After obtaining \u03b8, the main inverter outputs the quasi-square-wave voltage v, including real power component v, reactive power component kvand harmonic component vas described in (7)-(8). The two auxiliary inverters , generate the voltage v, which is separated into vand v. Therefore, vand vsynthesize the desired inverter voltage v. ) shows the voltage synthesis of vand V. The \u03b8 indicates the relationship between vand its fundamental component v=v+kv. The vincludes two components: (1\u2212k)vand \u2212v. The vfrom main inverter can be canceled by \u2212vfrom auxiliary inverters , to improve the cascaded inverter output voltage quality. The auxiliary inverters , also supply the rest of the reactive power component (1\u2212k)vof v. In this way, the reactive power can be distributed between main and auxiliary inverter cells , ","In the present invention, k decides the weighted q-axis voltage component in the main inverter cell and auxiliary inverter cells , , and therefore determines the reactive power in each cell. k can be varied from 0\u02dc1 to generate a wide range Q_grid under a required P_grid. However, inappropriate k will cause duty cycle saturation or over modulation resulting in degraded power quality. In addition, the appropriate range of k varies with P_grid. The design guidelines for selecting k are described as follows when P_grid and Q_grid vary from 0\u02dc1 pu, respectively.","Firstly, in order to avoid the duty cycle saturation, the assigned q component of v, i.e., kv, should be no bigger than the available maximum magnitude of the q component of v, which is calculated as \u221a{square root over ((4V\/\u03c0)\u2212(Vcos \u03b1))}{square root over ((4V\/\u03c0)\u2212(Vcos \u03b1))}. That is the fundamental switching angle \u03b8 shown in (9) should be controlled within [0, \u03c0\/2]. The inequality condition in (14) is therefore derived and needs to be satisfied as the first limitation condition defined as Cond.1:",{"@attributes":{"id":"p-0084","num":"0083"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mn":["0","1"],"mo":["\u2264","\u2264"],"mfrac":{"mrow":{"msub":{"mi":["kV","inv"]},"mo":["\u2062","\u2062","\u2062"],"mi":["sin","\u03b1"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["V","dc"]},"mo":"\/","mi":"\u03c0"}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["V","inv"]},"mo":["\u2062","\u2062","\u2062"],"mi":["cos","\u03b1"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mn":"2"}],"mo":"-"}}}}},{"mrow":{"mo":["(",")"],"mn":"14"}}]}}}}},"Secondly, in order to avoid over modulation, the peak value of v+vshould be no bigger than V+V, as the second limitation condition defined as Cond.2, which is shown in (15).",{"@attributes":{"id":"p-0086","num":"0085"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mfrac":{"mrow":[{"mi":"max","mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"mrow":{"mrow":{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"k"}},"mo":"\u2062","msub":{"mi":["V","invq"]}},"mo":"-","msub":{"mi":"V","mrow":{"mi":["main","_","h"],"mo":["\u2062","\u2062"]}}}}},{"mo":["(",")"],"mrow":{"msub":[{"mi":"V","mrow":{"mi":"cap","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"}},{"mi":"V","mrow":{"mi":"cap","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"}}],"mo":"+"}}]},"mo":"\u2264","mn":"1"}},{"mrow":{"mo":["(",")"],"mn":"15"}}]}}}}},"An appropriate k can be obtained based on (14-15). Four cases with different k values are shown in -, -, -, and -) which illustrates Cond.1 variation as P_grid and Q_grid varies from 0 to 1.0 pu. -, -, -, and -) illustrates Cond.2 variation with different k under a wide P_grid and Q_grid variation range. As shown in the 3D plot, when \u2018k\u2019=0, 0.4 and 1, (14) and (15) can not be satisfied simultaneously. As such, the \u2018k\u2019=0.7 is a proper reactive power allocation coefficient under wide real and reactive power ranges.","In order to verify the above analysis further, the grid real power P_grid is fixed to 1.0 pu with varied grid reactive power Q_grid and \u2018k\u2019 as depicted in . The \u2018k\u2019 changes from 0 to 1 by 0.1. As shown in ), the allowable range of Cond.1 is in the interval [0, 1]. In this case, the reactive power allocation with \u2018k=0.9\u2019 and \u2018k=1.0\u2019 can not meet duty cycle saturation limitation condition in the whole grid reactive power. ) shows the allowable range of Cond.2 is in the interval [, ]. If the \u2018k\u22660.6, the over modulation limitation condition can not be satisfied in the whole grid reactive power.",{"@attributes":{"id":"p-0089","num":"0088"},"figref":["FIG. 11","FIG. 8"],"b":"10","sub":["g",{"sub2":"\u2014"},"ref ","g",{"sub2":"\u2014"},"ref ","g ","g",{"sub2":"\u2014"},"ref ","inv",{"sub2":"\u2014"},"ref ","main","auxi1 ","auxi2","cap1 ","cap2","cap",{"sub2":"\u2014"},"ref","L1 ","cmp1 ","cmp2","cmp","cmp1","cmp2 ","main","auxi1","cmp1 ","auxi2","cmp2 "]},"The performance of the proposed reactive power allocation (RPA) strategy is firstly tested in simulation. The system parameters are shown in Table I. In order to investigate the effect of \u2018k\u2019 on power quality, the grid current and its FFT results with different \u2018k\u2019 are compared as real and reactive power delivered to the grid are fixed to 0.5 pu and 1.0 pu, respectively in . As shown in ), the grid current with \u2018k\u2019=0.4 has a total harmonic distortion (THD) of 16.37%. However, THD can be decreased to 0.47% as \u2018k\u2019=0.7 in ). It is clear that \u2018k\u2019=0.7 is a proper reactive power allocation coefficient.",{"@attributes":{"id":"p-0091","num":"0090"},"figref":["FIG. 13-FIG","FIG. 13","FIG. 13"],"b":"15","sub":["cmp1 ","cmp2"]},{"@attributes":{"id":"p-0092","num":"0091"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0093","num":"0092"},"figref":["FIG. 15","FIG. 15(","FIG. 15("],"b":["25","40","40","40","40","25","40","40","25","40","40","40"],"i":["a ","b","c","a ","a","b","c ","b","a ","b","c "]},"A 3.5 kW hardware prototype has been built in the laboratory as shown in . In this exemplary embodiment of the present invention, the IGBT FMG2G100US60 has been chosen as the main inverter switch operating at the fundamental frequency and the MOSFET SUP85N15-21 has been used in the auxiliary inverters operating at 2.5 kHz. The control algorithms are implemented in dSPACE DS1104 controller. The experimental results at 350 W with \u2018k\u2019=0.7 are presented with reference to  through .",{"@attributes":{"id":"p-0095","num":"0094"},"figref":["FIG. 17","FIG. 18","FIG. 18(","FIG. 19(","FIG. 19("],"b":["40","40","40"],"i":["a ","b","c ","a","a","b"]},"In accordance with the present invention, a novel DFT PLL technique is developed to separate the real and reactive power between different energy sources\/storages. The DFT PLL technique is immune to harmonics, signal amplitude, frequency and phase which may affect the PLL performance. The hybrid modulation technique and sophisticated power allocation strategy integrating the proposed DFT PLL method are developed to achieve wide range reactive power compensation and optimized real power distribution.","It will be seen that the advantages set forth above, and those made apparent from the foregoing description, are efficiently attained and since certain changes may be made in the above construction without departing from the scope of the invention, it is intended that all matters contained in the foregoing description or shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.","It is also to be understood that the following claims are intended to cover all of the generic and specific features of the invention herein described, and all statements of the scope of the invention which, as a matter of language, might be said to fall therebetween. Now that the invention has been described,"],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["For a fuller understanding of the invention, reference should be made to the following detailed description, taken in connection with the accompanying drawings, in which:",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 8","sub":["main ","auxi12 "]},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 20"}]},"DETDESC":[{},{}]}
