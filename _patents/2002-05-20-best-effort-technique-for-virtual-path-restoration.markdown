---
title: Best effort technique for virtual path restoration
abstract: A method and apparatus for restoring a virtual path are disclosed. The method includes identifying an alternate physical path and determining whether the alternate physical path is able to support the virtual path by determining whether each node of the second subset of nodes has sufficient resources necessary to support the virtual path. The virtual path is over a physical path in an optical network, and the optical network includes a number of nodes. The physical path includes a first subset of nodes of the nodes. The alternate path includes a second subset of nodes of the nodes and is between a first node and a second node of the first subset of nodes.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07428212&OS=07428212&RS=07428212
owner: Cisco Technology, Inc.
number: 07428212
owner_city: San Jose
owner_country: US
publication_date: 20020520
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCES TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY","DETAILED DESCRIPTION OF THE INVENTION"],"p":["This application is continuation-in-part of patent application Ser. No. 09\/891,022, filed Jun. 25, 2001, currently pending, and entitled \u201cA METHOD FOR RESTORING A VIRTUAL PATH IN AN OPTICAL NETWORK USING DYNAMIC UNICAST,\u201d having H. M. Zadikian, A. N. Saleh, Z. Baghdasarian, and V. Parsi as inventors (which is a continuation-in-part of patent application Ser. No. 09\/858,743, filed May 16, 2001 and entitled \u201cA RESOURCE RESERVATION SCHEME FOR PATH RESTORATION IN AN OPTICAL NETWORK,\u201d now U.S. Pat. No. 7,352,692, having the same inventors; which, in turn, is a continuation-in-part of patent application Ser. No. 09\/232,397, filed Jan. 15, 1999, now U.S. Pat. No. 6,856,627, issued Feb. 15, 2005, and entitled \u201cA METHOD FOR ROUTING INFORMATION OVER A NETWORK,\u201d having the same inventors), which are assigned to Cisco Technology, Inc., the assignee of the present invention, and are hereby incorporated by reference, in their entirety and for all purposes.","1. Field of the Invention","This invention relates to the field of information networks, and more particularly relates to a protocol for configuring routes over a network.","2. Description of the Related Art","Today's networks carry vast amounts of information. High bandwidth applications supported by these networks include streaming video, streaming audio, and large aggregations of voice traffic. In the future, these bandwidth demands are certain to increase. To meet such demands, an increasingly popular alternative is the use of lightwave communications carried over fiber-optic cables. The use of lightwave communications provides several benefits, including high bandwidth, ease of installation, and capacity for future growth.","Optical infrastructures are capable of transmission speeds in the gigabit range, which helps address the ever-increasing need for bandwidth mentioned above. Such infrastructures employ various topologies, including ring and mesh topologies. In order to provide fault protection, ring topologies normally reserve a large portion (e.g. 50% or more) of the network's available bandwidth for use in restoring failed circuits.","Traditionally, the networks allocate bandwidth and resources for the transmission of data and assign certain priorities to data paths such as the Quality of Service and like. These priorities only guarantee that if and whenever a data path is available, the high priority data will be transmitted first. In case of a data path failure, the transmission and data path priorities do not guarantee the restoration of data traffic. The high-level transmission protocol generally relies on the underlying physical architecture to restore the data paths. Thus, a user can only configure the data transmission priority for the data and depend upon the physical network architecture to restore data paths in case of a failure.","Ring topologies are capable of quickly restoring failed circuits. This capability is important in providing reliable service to customers, and is particularly important in telephony applications, where a failure can result in alarms, dropped calls, and, ultimately, customer dissatisfaction and lost revenue. In a similar vein, because of bandwidth demands, protocol overhead related to provisioning, restoration, and other functions should be kept to a minimum, to make the maximum amount of bandwidth available for use by customers.","An alternative to the ring topology, the mesh topology reduces the amount of bandwidth needed for protection. The mesh topology is a point-to-point topology, with each node in the network coupled to one or more other nodes. Because a circuit may be routed through various combinations of the network's nodes and over the various links which connect them, excess capacity through a given node or over a given link can serve to protect several circuits. However, the restoration of a circuit following a failure in a mesh topology can consume a relatively large amount of time.","Particularly, each of the various uses of such a network can have their own requirements as to bandwidth, restoration time, restoration guarantees and so on. With specific regard to restoration, certain low-priority services have only minimal requirements, and so restoration may simply consist of waiting for failures to be repaired, which allows such service to be economically priced (e.g., bulk data transfer). Alternatively, certain high-priority applications demand a high level of availability, and must be restored as quickly as possible, under all (or substantially all) circumstances, with cost being of little consequence (e.g., voice traffic). Often, however, network traffic is at neither of these extremes (e.g., internet service). In this case, greater up-time than a low-priority application, but at more reasonable costs than allowed by a high-priority service, is desired.","In one embodiment, a method and apparatus for restoring a virtual path are disclosed. The method includes identifying an alternate physical path and determining whether the alternate physical path is able to support the virtual path by determining whether each node of the second subset of nodes has sufficient resources necessary to support the virtual path. The virtual path is over a physical path in an optical network, and the optical network includes a number of nodes. The physical path includes a first subset of nodes of the nodes. The alternate path includes a second subset of nodes of the nodes and is between a first node and a second node of the first subset of nodes.","The foregoing is a summary and thus contains, by necessity, simplifications, generalizations and omissions of detail; consequently, those skilled in the art will appreciate that the summary is illustrative only and is not intended to be in any way limiting. Other aspects, inventive features, and advantages of the present invention, as defined solely by the claims, will become apparent in the non-limiting detailed description set forth below.","The following is intended to provide a detailed description of an example of the invention and should not be taken to be limiting of the invention itself. Rather, any number of variations may fall within the scope of the invention which is defined in the claims following the description.","Introduction","A network can employ various restoration schemes to restore a virtual path (VP) in case of a failure. To guarantee the restoration of a VP, each VP is assigned a restoration priority level. The restoration priority level determines a VP's relative priority with regard to restoration in the event of a failure within the network. The present invention provides a method of restoring a virtual path using dynamic unicast. In such a dynamic unicast method, a VP is assigned a single path when provisioned. The restoration of the VP is guaranteed. The VP is restored by creating a new physical path and provisioning the virtual path on the new physical path.","Network Configuration",{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 1","FIG. 1","FIG. 1","FIG. 1"],"b":["100","101","104","111","117","121","126","131","136","141","147","101","104","1","4","100","113","117","122","124","134","135","141","142"]},"Provisioning of Network Nodes","Once a mesh network topology has been defined (e.g., the zoned topology of ), the user can configure one or more end-to-end connections that can span multiple nodes or zones, an operation is referred to herein as provisioning. For each virtual path to be provisioned, a physical path must be selected and configured. Each set of physical connections that are provisioned creates an end-to-end connection between the two end nodes that supports a virtual point-to-point link (referred to herein as a virtual path or VP). The resulting VP has an associated capacity and an operational state, among other attributes.","In a network, VPs may be provisioned statically or dynamically. For example, a user can identify the nodes that will comprise the virtual path and manually configure each node to support the given virtual path. The selection of nodes may be based on any number of criteria, such as Quality of Service (QoS), latency, cost, distance traveled in the network and the like. Alternatively, the VP may be provisioned dynamically using any one of a number of methods. The provisioning information may then be forwarded to all the nodes in the network to store information in node's network topology database. Each node periodically updates this information to efficiently maintain resources and in case of path failure, effectively allocate appropriate resources needed for specific virtual path for path restoration. The method of routing information in such networks is described in a commonly-assigned U.S. patent application Ser. No. 09\/232,395, entitled \u201cA CONFIGURABLE NETWORK ROUTER,\u201d filed Jan. 15, 1999, which is hereby incorporated by reference, in its entirety and for all purposes.","The end nodes of a VP can be configured to have a master\/slave relationship. The terms source and destination are also used herein in referring to the two end-nodes. In such a relationship, the node with a numerically lower node ID typically assumes the role of the master (or source) node, while the other assumes the role of the slave (or destination) node, although the opposite arrangement is also acceptable. An intermediate node is referred to herein as tandem node. Typically, the source node assumes the provisioning responsibilities and the destination node simply waits for a message from the source node informing the destination node of the VP's new physical path (although again, this need not necessary be the case). This information includes node identifiers of tandem nodes, if any, within the path. In a zoned mesh topology, if a virtual path spans over multiple zones, the border node or proxy node of each zone acts as source node for their particular zone. As will be apparent to one of skill in the art, the opposite convention or another paradigm can easily be employed.","Typically, during provisioning, each VP is assigned a performance and restoration priority level. The priority, referred to herein as Class of Service (CoS), determines VP's relative priority for performance within the network and restoration in the event of a failure within the network. The method of assigning CoS to a VP is described in commonly-assigned U.S. patent application Ser. No. 09\/858,743, filed on May 16, 2001, entitled \u201cA RESOURCE RESERVATION SCHEME FOR PATH RESTORATION IN AN OPTICAL NETWORK,\u201d as incorporated by reference previously. In case of a VP failure at a node in the network, the node determines how to restore the VP based on the CoS assigned to the VP. The assigned CoS defines the restoration method used by the node to restore failed VP.","Class of Service","To guarantee the restoration of a VP in case of a failure, each VP is assigned a restoration priority level. The restoration priority level, also referred to herein as the VP's Class of Service (CoS), determines the VP's relative priority with regard to performance within the network and restoration in the event of a failure within the network. A VP is typically assigned a CoS during provisioning, although in some cases, the CoS can be assigned after the provisioning. Depending upon the CoS assigned to a VP during provisioning, the resources for restoration can be reserved at the time of provisioning. Resources can include, for example, bandwidth, ports, inbound\/outbound links, inbound\/outbound wavelengths, internal storage and other such resources. In case of a path failure, a failed VP's CoS is used to determine whether and how the failed VP will be restored. If the failed VP is to be restored, the failed VP's CoS can be used to determine which restoration scheme to employ and the amount of time allocated for the restoration. In one scenario, four CoS levels (-) are nominally defined, although a larger or smaller number of CoS levels can be used. According to one embodiment of current invention, CoS  is defined as the lowest CoS, with CoS  being the highest. The resources for restoration of a VP are reserved according to the VP's CoS. The restoration priority spans from no resources (i.e. an unprotected path) for a VP with the lowest CoS, to redundant VP resources for a VP with the highest CoS. An example for a CoS scheme having four classes is now described in detail.","CoS \u2014Low-Priority Traffic","CoS  is assigned to a VP that carries low-priority information. VPs from this class are typically not restored upon network failure. The user can control, on a VP-by-VP basis, whether a given VP should be protected from a failure. Upon failure of a CoS  VP, a network alarm is generated. However, the VP remains inactive until all other failures along the working path have been repaired.","A basic characteristic of a CoS  VP is that its working bandwidth is pre-emptible; the VP's resources can be reclaimed for use by other, higher-priority VPs (higher CoS VPs). So, in case of a failure of a high-CoS VP, if additional bandwidth is not available to restore that VP for restoration purposes, the network will tear down the traffic on the CoS  VP and assign the CoS  VP's bandwidth resources to the alternate path of another failed higher-CoS VP in the network. Another configurable attribute of VPs with CoS  is protection channel access (PCA). The PCA allows the access to standby physical paths of other VP's in the network. A VP with a CoS of 0 can be allowed to use the standby physical paths of other VP's in the network. If a standby physical path is available in the network, the network may allow backed-up information traffic on CoS  VP to temporarily use the available resources to relieve congestion and more quickly move information across the network.","CoS \u2014Best Effort Traffic","VPs having a CoS of 1 are assigned a single path when provisioned but are restorable in case of a failure. Restoration is not guaranteed, although it is understood that best efforts will be expended to restore the failed CoS  VP. Moreover, the restoration time can be longer than what might be needed for critical path traffic (e.g., voice traffic).","In one embodiment, a dynamic unicast method of restoration is employed. In this approach, the node that discovers the failure initiates a restoration request and forwards the request to an upstream node (i.e., a node towards the VP's source node). This node can be the source node of the VP, or, if zones are used, a proxy node for the source node in the given zone (and so this node may not actually be the source node for the entire VP), or simply the next upstream node. This upstream node is referred to subsequently herein as a source node or proxy node to simplify the discussion. The source node initiates a restoration process by generating a resource request (e.g., by generating an Add_Path request, described elsewhere herein), based on the new route computed by the source node, and then forwarding the request to the next node in the new path. Upon receiving the request, the downstream node allocates the requested bandwidth on the specified input and output links, and forwards the request to the next downstream node. This continues along the computed path until the request reaches the intended downstream node, where the new path is saved and a positive response is returned to the source node. This downstream node can be the destination node of the VP, or, if zones are used, a proxy node for the destination node in the given zone (and so this node may not actually be the destination node for the entire VP), or simply the next downstream node. This upstream node is referred to subsequently herein as a source node or proxy node to simplify the discussion. If the request reaches a node that doesn't have enough resources (e.g., bandwidth on either the input or output link), that node sends back a negative response to the source node, which is then computes a new route and retries the operation. Thus, there is only one restoration request outstanding at any given time in the network. A dynamic unicast restoration method is described in commonly-assigned U.S. patent application Ser. No. 09\/891,022, entitled \u201cA METHOD FOR RESTORING A VIRTUAL PATH IN AN OPTICAL NETWORK USING DYNAMIC UNICAST\u201d, as incorporated by reference previously.","The \u201crestoration time guarantees\u201d for CoS  depend on the network configuration and available bandwidth. One of skill in the art will appreciate that a combination of another set of performance and implementation related attributes such as PCA, releaseability of resources and others can also be defined for this CoS based on network configuration and planning, user need, and other such requirements.","CoS \u2014Premium Traffic","VPs having a CoS of CoS , in an embodiment employing what is referred herein as dynamic broadcast restoration method, are provisioned on a single physical path but preferably are restored using all possible resources available at all or substantially all nodes to ensure fast recovery of the VP. Certain quantitative guarantees can be made on the restoration time of CoS  VPs, depending on network configuration. For example, according to one embodiment of present invention, this class of service can be configured to guarantee recovery in less than 50 ms, as is often required of telecommunications related network connections, without having to pre-compute or pre-establish the alternate route. In case of a failure, the source node \u2018floods\u2019 the network with path restoration request to find an alternate path. This method is described in commonly-assigned U.S. patent application Ser. No. 09\/750,668, filed on Dec. 29, 2000, and entitled \u201cA VIRTUAL PATH RESTORATION SCHEME USING FAST DYNAMIC MESH RESTORATION IN AN OPTICAL NETWORK\u201d, which is hereby incorporated by reference, in its entirety and for all purposes.","The restoration request is sent to tandem nodes that may provide a path to the destination node while also offering enough bandwidth capacity to satisfy the failed VP's needs. Each request is processed individually by the tandem nodes. If the resources are available, the tandem node accepts only the first successful request to avoid multiple allocation of resource for the alternate path. The source node accepts first successful response to path restoration request as the alternate path. The VP is then switched to this newly-created alternate path.","CoS \u2014Mission Critical Traffic","VPs having a CoS of 3 are used for mission-critical application, where virtually no disruption of traffic can be tolerated. At the time of path provisioning, CoS  VPs are assigned two distinct paths, a primary path and a secondary path. Each path is preferably link-and-node disjoint. Only one of these paths is active at any time, while the other is in standby mode. A failure along the active path will cause traffic to be switched over to the standby path. The paths are provisioned by two independent provisioning commands. Each CoS  VP has an alternate VP to provide support in the case of a failure. The switching of paths can be done by either the source or destination node, independently, based on the error rate each node receives. There should be virtually no down time on CoS  VPs. This method is referred to herein as 1+1 protection. This method is described in commonly-assigned U.S. patent application Ser. No. 09\/859,166, filed May 16, 2001, and entitled \u201cA METHOD FOR RESTORING A VIRTUAL PATH IN AN OPTICAL NETWORK USING 1+1 PROTECTION\u201d, which is hereby incorporated by reference, in its entirety and for all purposes.","One variation on such a scheme is 1:N protection, which allows a group of N VPs to share one or more alternate protection paths. In this scheme, the bandwidth of alternate path is share by multiple CoS  VPs based on their maximum bandwidth requirements. The reservation of resources is done at the time of provisioning of the paths. The network can also dynamically alter the bandwidth use of the alternate path for each VP based on the traffic analysis at the time of failure while guaranteeing the maximum bandwidth initially allocated and so maintaining network efficiency.","Yet another variation of this scheme is 1:1 protection. This scheme reserves an alternate path for CoS  VP in a manner similar to 1+1 protection. However, with 1:1 protection, the alternate path is not always available as a secondary path. When CoS  VP is not using this secondary path, certain VP's with lower CoS are allowed to use the alternate path. In case of a failure on the primary path of CoS  VP, the network removes any lower-CoS traffic from the alternate path and generates appropriate alarms. Then, the traffic of CoS  is switched on to the alternate path. This ensures maximum efficiency of the network yet guarantees meeting maximum acceptable restoration time for mission-critical information (e.g., voice and data information) on CoS  VPs. These methods are described in commonly assigned U.S. patent application Ser. No. 09\/876,380, filed Jun. 7, 2001, and entitled \u201cA METHOD FOR RESTORING A VIRTUAL PATH IN AN OPTICAL NETWORK USING 1:N PROTECTION\u201d, which hereby incorporated by reference, in its entirety and for all purposes.","Class of Service Attributes","Each CoS typically includes certain restoration-related attributes. Examples of classes-of-service (CoS's) and the attributes that can be used in identifying such CoS's, as well as a description of the attributes used in defining a class of service. These attributes can include, for example, restoration method, releasability of resources, protection channel access and predefined restoration time. Other attributes, such as reliability, latency, availability, and the like, can be added to each class on an implementation-by-implementation basis, as the network planning, user needs and other constraints dictate.","Failure Detection, Propagation, and Path Restoration Using a \u201cBest Efforts\u201d Technique","CoS VPs are restored using a quality-of-service-based (QoS-based) shortest-path technique, referred to herein as a QoS-based shortest path first (or QSPF) algorithm. Restoration involves three basic steps: route calculation using the procedure outlined subsequently, path establishment (which involves the exchange of an Add Path packet, described below), and conflict resolution using backtracking. CS VPs are restored using the best efforts of the network management infrastucture, but their restoration is not guaranteed. The actions performed in restoring CoS VPs are similar to those used to create a new virtual path, but need not originate with the VP's source node or terminate at the VP's destination node (e.g., if used in a zoned environment, proxy nodes localize restoration to the zone containing the affected link(s) and\/or node(s)). An example of the actions thus performed discussed below.","Failure Detection and Propagation","In networks, failures are typically detected using the mechanisms provided by the underlying physical network. The failure detection mechanism in a mesh optical network is described in commonly-assigned U.S. patent application Ser. No. 09\/232,397, entitled \u201cA METHOD FOR ROUTING INFORMATION OVER A NETWORK,\u201d as incorporated by reference previously.","Path Calculation","Routes are computed using a QoS-based shortest-path (QSPF) technique, as noted. The route selection process relies on configured metrics and an up-to-date view of the topology to find the shortest paths between any two nodes. The topology database contains information about all network nodes, their links, and available capacity. A detailed description of such techniques is provided in U.S. patent application, Ser. No. 09\/478,235, filed Jan. 4, 2000, and entitled \u201cMETHOD FOR PATH SELECTION IN A NETWORK,\u201d which is hereby incorporated by reference, in its entirety and for all purposes","Path Restoration","A CoS VP employs dynamic unicast as its method of restoration. The restoration is not guaranteed, and the restoration time can be longer than what might be needed for critical path traffic such as a voice call. Moreover, the restoring nodes can be proxy nodes. The \u201crestoration time guarantees\u201d for a VP using dynamic unicast method depend on the network configuration and provisioning attributes (e.g., bandwidth requirement, QoS, latency and the like) of the VP. The source node of failed VP (or its proxy within the zone) initiates the restoration process. The tandem node that discovers the path failure, initiates a path failure notification for the source node (or its proxy) and waits for a response. The destination (or its proxy) node preferably responds to restoration process initiated by the source node (or its proxy). As used herein, the use of the terms \u201csource node\u201d and \u201cdestination node\u201d contemplate their proxies within the affected zone, as well as simply the next upstream or downstream node, respectively.","Initiating Restoration","Once a node detects a path failure, the node initiates a path restoration request for the source node (or proxy) of the failed VP using a Restore_I request. The method of generating Restore_I requests and responses is described in commonly-assigned U.S. patent application Ser. No. 09\/750,668, entitled \u201cA VIRTUAL PATH RESTORATION SCHEME USING FAST DYNAMIC MESH RESTORATION IN AN OPTICAL NETWORK\u201d, and filed Dec. 29, 2000, and is hereby incorporated by reference in its entirety and for all purposes.","When the source node receives a Restore_I request, the source node determines the type of restoration scheme assigned to the failed VP. Upon determining that the failed VP is to use the dynamic unicast restoration scheme, the source node creates an Add Path Request packet with appropriate contents and transmits the request to other nodes in the network.","Alternatively, if the node that detects the failure determines that a path from that node to another node along the VP's existing physical path exists, that node can go forward with path restoration on its own. Further, if the next node in the physical path fails and the detecting node can initiate restoration, such a restoration can be effected as well.","Add Path Request Packet",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 2","b":["200","200","200","210","220","3","230","240"]},"A physical instance field  stores a 16-bit physical instance identifier for the VP. The source node of the VP maintains physical instance field , which is associated with the path (i.e., set of link IDs) of the VP and is part of APR packet  and all restoration-related packets. Preferably, the source node updates physical instance field . The first path of a VP that is successfully provisioned (as seen by the source node) has a physical instance identifier of 1. All future path messages should have the correct value of this identifier. If a new path is selected for the VP, the physical instance identifier is incremented (e.g., by 1) by the source node. Due to the distributed nature of path selection and multiple failures, several physical instances of the same VP may temporarily exist in the network at any given time. However, only one instance ultimately survives.","An attempt count field  is the attempt count of the current physical instance of the VP. The source node increments this field every time the source node resends the same request. Since APR packets are retransmitted periodically, different attempts preferably should be distinguished from one another. Attempt count field  allows retransmitted requests to be distinguished from one another. Attempt count field  starts at a given point (e.g., from 1) and is incremented (e.g., by 1) with each retransmission. Because given APR packets may traverse different paths to get to the same intermediate node, attempt count field  allows the intermediate node to differentiate among multiple request attempts for restoration of the same physical instance of the same VP.","A path length field  indicates the number of links in the VP. Path length field  determines the number of link identifications that appear at the end of the packet. A hops field  indicates the number of hops traversed by a given APR packet. Hops field  is incremented (e.g., by 1) at each receiving node in the given APR packet. During the transmission of the given APR packet, the value of hops field  is incremented (e.g., from 0 to (Path Length-1)). Upon the return of a response, hops field  is decremented (e.g., by 1) by each node that forwards the response to the source node. During the transmission of a response, the value of hops field  is decremented from the maximum number of hops traversed to zero by the time the response reaches the source node (e.g., from (Path Length-1) to 0). A link ID field  is a 32-bit long field for the link IDs of the VP. The number of link IDs depends upon the path length set by the source node.","Upon sending APR packet , the source node sets a timer. If a positive response is not received before the timer expires, the source node generates another APR packet. Each time the APR packet is generated, attempt count field  is incremented (e.g., by 1). The APR packets are preferably generated for only a certain number of times, after which the source node generates a network alarm.","Receiving an Add Path Request Packet at a Tandem Node",{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 3","b":["305","310","360","315","320","325","330","340","345","350","355"]},"If the APR packet is valid and no errors are found, the tandem node determines if sufficient resources are available to support the virtual path (step ). If there are insufficient resources (such as memory, bandwidth on input and\/or output links, unavailability of ports and the like), the tandem node responds with a NAK (NO RESOURCES) (step ). However, if sufficient resources are available, the tandem node makes bandwidth reservations on input and output links, increments the hops field in the APR packet and forwards the request to the next appropriate link (step ). The tandem node sets the path-state to \u2018path adding\u2019 and waits for response from the next link (step ).","Receiving an Add Path Request Packet at a Destination Node",{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 4","b":["405","410","445","415","420","425","430","435","440"]},"If no errors are found in the APR packet (step ), the destination node determines if sufficient resources are available to support the virtual path (step ). If sufficient resources (such as memory, bandwidth and like) are not available, the destination node responds with a NAK (NO RESOURCES) (step ). If sufficient resources are available, the destination node allocates resources and makes appropriate connections in a cross-connect matrix for the virtual path (step ). The destination node reformats an Add Path Response packet with a list of ports assigned to the virtual path and sends the Add Path Response packet upstream (step ).","Add Path Response Packet",{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 5","b":["500","500","200","500","510","500","500"]},"For positive responses, the responding node copies the contents of the APR packet  and appends a port index  (e.g., Port IDs ()-(n)) and decrements hops field . For negative responses, the responding node copies the contents of the APR packet and instead of a list of assigned Port IDs, the node appends a reason code for rejection in place of port index  and decrements hops field .","Receiving Add Path Response Packet at the Source Node",{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 6A","b":["605","610","615","620","625","630"]},"If no errors are indicated in the response packet (i.e., the response is a positive response), the source node determines if the port index in the response packet contains valid Port IDs (step ). If the port index contains one or more invalid port IDs, the source node generates a network alarm (step ). If the port IDs in the port index are valid, the source node terminates any timer the source node had to monitor the response time (step ). The source node stops generating new APRs (step ). The source node ignores any further response from previously generated APR packets (step ). The source node restores the virtual path by provisioning the virtual path on the ports allocated by the tandem nodes and the destination node (step ).","Receiving Add Path Response Packet at the Tandem Node",{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 6B","b":["662","665","670","673","675","678","680"]},"If the response packet contains no errors, the tandem node determines if the port index in the response packet contains valid port IDs (step ). If the port index in the response packet contains one or more invalid port IDs, the tandem node releases the resources allocated to the VP (step ). The tandem node forwards a negative response, NAK (INVALID PORT), upstream (step ). If the port IDs in the response packet are valid, the tandem node terminates any timer the tandem node had to monitor the response time (step ). The tandem node makes appropriate connections in the cross-connect matrix (step ). After making the connections, the tandem node forwards the response packet to next node in the VP (step ).","An Example of Path Restoration Using Dynamic Unicast Method","The following description is intended to be illustrative of the invention and should not be taken to be limiting. Other embodiments within the scope of the present invention are possible.",{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 7","b":["700","700","701","707","0","0","701","702","705","707","712","725","757","701","0","707","0","701","0","701","707"]},"Add Path Request Packet Flow","In the present example, the configuration requires that the path through nodes  and  be considered to restore VP . Node  (the source node) generates an APR packet that traverses through nodes  and  to reach node  (the destination node). Node  sets the path length field to three to indicate the number of hops to be traversed by the APR packet. Node  updates the path field by adding link  to the list. Link  is used to send the APR packet to node . Node  sends the APR packet to node . Node  increments the hops field (e.g., by 1) to indicate the number of hops traversed by the APR packet and adds the next link ID, link , in the path field and forwards the APR Packet to node . Node  adds link ID, link , in the path field, increments the hops field (e.g., by 1) and forwards the APR packet to node , the destination node. Table 1 shows the values of some of the fields in the APR packet at each node.",{"@attributes":{"id":"p-0067","num":"0066"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 1"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Some of the field values for the APR packet."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Path Length field",{},"Path field"]},{"entry":["Packet Flow","value","Hops field value","value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Node 701 \u2192 702","3","0","Link 712"]},{"entry":["Node 702 \u2192 705","3","1","Link 725"]},{"entry":["Node 705 \u2192 707","3","2","Link 757"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}},"br":{}},"Node  determines from the APR packet header that node  is the target (destination) node for the APR packet. Node  generates a response packet and copies the contents of APR packet to the response packet and decrements the hops field. Node  allocates one or more ports for VP  and appends the remote port ID of each allocated port to the port index field of the response packet. The remote port ID of allocated port at node  is the local ID of that port at node . For example, node  allocates ports with local IDs  and  to VP . However, port  at node  is recognized as port  by node  and port  at node  is recognized as port  by node . Thus, for local port  at node , the remote port ID is 1 and for local port  at node , the remote port ID is 5. By appending remote port IDs of corresponding local ports to the response packet, node  indicates which ports should be allocated by node . Each node exchanges the information regarding the remote IDs of local ports during a periodic network topology update process. The port list in the response packet is updated at every hop along the path to the source node. Table 2 shows the values of some of the fields in the response packet at each node.",{"@attributes":{"id":"p-0069","num":"0068"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 2"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Some of the field values for response packet."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Path Length","Hops field","Path field","Port Index"]},{"entry":["Packet Flow","field value","value","value","value"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":["Node 707 \u2192","3","2","Link 757","1, 5\u2002"]},{"entry":"705"},{"entry":["Node 705 \u2192","3","1","Link 725","7, 10"]},{"entry":"702"},{"entry":["Node 702 \u2192","3","0","Link 712","4, 9\u2002"]},{"entry":"701"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"After receiving the response packet, node  (the source node) provisions VP  to the new physical path including links ,  and . The new physical path for VP  uses ports  and  on link  at node , ports  and  on link  at node , ports  and  on link  at node  and corresponding ports  and  at node . The network topology at each node is updated to reflect the new physical path for VP .","Conflict Resolution Using Backtracking","If the source node is other than the source node for the entire VP, there will be additional upstream nodes that can be tasked with restoring the failed VP, in the case where the node originally tasked with restoring the VP is unable to successfully complete this task. The availability of such functionality can be set as a default, subject to user preference, or performed automatically.","If backtracking is enabled, the original node responsible for restoration in this scenario determines that restoration has been unsuccessful, and thus indicates to an upstream node that the original node has been unsuccessful in restoring the VP, and requests that the upstream node attempt to restore the VP. The original node accomplishes this by initiating a path restoration request for the upstream node of the failed VP using a Restore_I request. As noted previously, the method of generating Restore_I requests and responses is described in U.S. patent application Ser. No. 09\/750,668.","When the upstream node receives a Restore_I request, the upstream node determines the type of restoration scheme assigned to the failed VP. Upon determining that the failed VP is to use the dynamic unicast restoration scheme, the upstream node creates an Add Path Request packet with appropriate contents and transmits the request to other nodes in the network, in the manner previously described.","While particular embodiments of the present invention have been shown and described, it will be obvious to those skilled in the art that, based upon the teachings herein, changes and modifications may be made without departing from this invention and its broader aspects and, therefore, the appended claims are to encompass within their scope all such changes and modifications as are within the true spirit and scope of this invention. Moreover, while the invention has been particularly shown and described with reference to these specific embodiments, it will be understood by those skilled in the art that the foregoing and other changes in the form and details may be made therein without departing from the spirit or scope of the invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention may be better understood, and numerous objects, features, and advantages made apparent to those skilled in the art by referencing the accompanying drawing.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6A"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 6B"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
