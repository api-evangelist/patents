---
title: Computer-implemented image acquisition system
abstract: An image acquisition system has a computer and one or more imaging devices coupled thereto. Each imaging device has a device memory and is capable of capturing and storing a digital image in its memory. An image device manager is implemented in software on the computer to control imaging device operation. The image device manager presents a user interface (UI) within the familiar graphical windowing environment. The UI has a context space to a particular imaging context (e.g., scanning, photography, and video). The UI also has a persistently-visible imaging menu positioned within the context space that lists options particular to the imaging context. The image acquisition system also includes a set of application program interfaces (APIs) that enable applications to manage loading and unloading of imaging devices, monitor device events, query device information properties, create device objects, capture images using the devices, and store or manipulate the captured images.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06889364&OS=06889364&RS=06889364
owner: Microsoft Corporation
number: 06889364
owner_city: Redmond
owner_country: US
publication_date: 20011019
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This is a divisional of U.S. patent application Ser. No. 09\/153,432, filed Sep. 14, 1998, entitled \u201cComputer-implemented image acquisition system\u201d and listing Camara et al. as inventors, which is now U.S. Pat. No. 6,373,507.","This invention relates to computer-implemented systems for managing imaging devices, such as digital cameras, scanners, and the like. This invention also relates to graphical window user interfaces, and particularly to user interfaces used to facilitate capture and storage management of digital images. This invention if further relates to operating systems and browsers that incorporate image device managers and user interfaces.","Digital imaging devices, such as scanners, cameras, video cameras, have been experiencing rapid growth in popularity as their price tags continue to decrease. Recreational photographers enjoy capturing pictures and videos and placing the digital files onto their computers for printing or emailing to friends and relatives. Businesses use scanners to digitally record documents used in day-to-day operation for archival purposes.","Other solutions to this problem already exist. For example, TWAIN and ISIS are two image acquisition systems that are available today. However, both of these solutions have problems. TWAIN lacks robustness and interoperability. ISIS is a proprietary design that renders it difficult to use with other applications.","Accordingly, a task set before the inventor was to create an image acquisition system that was based on an open architecture model and could be integrated with existing applications and operating systems to provide a convenient environment for the user.","This invention concerns an image acquisition system that offers an open architecture to integration with existing operating systems and other applications.","In an exemplary implementation, the image acquisition system is implemented on computer, such as a desktop personal computer, having a processing, unit, memory, and operating system. One or more imaging devices are coupled to the computer. Examples of the imaging devices include a scanner, a digital camera, a digital video camera, and so forth. Some imaging devices, such as digital cameras, have a device memory and are capable of capturing a digital image and storing the image on its memory. Other imaging devices, such as scanners, may not have their own device memory.","The image acquisition system further includes an image device manager that is implemented in software on the computer to control operation of the imaging devices. The image acquisition system presents a user interface (UI) within the familiar graphical windowing environment. The UI presents a graphical window having a context space that pertains to a particular imaging context (e.g., scanning, photography, and video). In the camera context, the is context space presents image files stored on the camera memory and\/or on the computer memory. In the scanner context, the context space includes a preview scan area that reveals a preview of the image in the scanner. In the video context, the context space presents video clips stored on the computer memory, but logically represented as belonging to the video camera.","The UI also has a persistently visible imaging menu positioned within the context space that lists options particular to an imaging context. For example, if the context space pertains to the camera context, the menu lists options to take a picture, store a captured image on the computer, send the image in an email, and so on. In the scanner context, the menu lists options to select an image type, review an image, send the image to a particular destination, and scan the image.","The image acquisition system also includes a set of application program interfaces, (APIs) that expose image management functionality to applications. The APIs enable applications to manage loading and unloading of imaging devices, monitor device events, query device information properties, create device objects, capture images using the devices, and store or manipulate the images after their capture.","This invention concerns a computer-implemented image acquisition system that manages imaging devices (such as digital cameras, scanners, digital video cameras, and the like) and the images captured by them. In a preferred implementation, the image acquisition system is implemented in a general-purpose computer (e.g., personal computer, laptop, etc.) to manage imaging devices a attached locally to the computer or coupled remotely via a network. The image acquisition system supports a graphical user interface windowing environment that integrates image device management with the same look and feel of familiar browsing user interfaces for conventional file systems. In this manner, a user encounters a familiar experience when managing the imaging devices and image files from his\/her computer.","Exemplary System Architecture",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1","b":["20","22","24","30","22","22","40","42","44","46","48","50","52","46","40","52","50"]},"The imaging devices - are coupled to the computer via a serial connection to the USB . Illustrated examples of the imaging devices include a scanner , a video camera , and a digital camera . However, other imaging devices (e.g., copiers, facsimile machines, etc.) may also be used in conjunction with aspects of this invention, as represented by the generic imaging device . Some of the imaging devices have their own memory, as represented by memory  in imaging device . For example, the digital camera may have its own memory, whereas the scanner typically does not have a memory.","The image acquisition system  includes an image device manager , which is implemented as a software component loaded on the computer . More particularly, the image device manager  is stored in program memory  and runs on processing unit  during execution. The image device manager  may be integrated into the operating system  (as shown), executed as a set of services, or implemented as a separate self-contained program.","The image acquisition system  also has a user interface , which is preferably a graphical user interface that presents a graphical window having a context space pertaining to the imaging context. Depending upon the particular context, the context space may list available imaging devices for which device drivers have been loaded onto the computer, or list digital image files captured by one or more of the imaging devices, or show an image being scanned in by the scanner.","The user interface  further presents a persistently visible imaging menu positioned within the context space. The imaging menu lists options that are particular to controlling the various imaging devices. For instance, when the context space pertains to the camera context, the menu lists a \u201cTake Picture\u201d option that is specific to operating the digital camera . Upon user selection of \u201cTake Picture\u201d, the image device manager  directs the digital camera  to record the current image obtained through the camera lens. In the scanner context, the menu lists a \u201cScan\/Open\u201d option that is particular to operating the scanner. Upon selection of this option, the image device manager  directs the scanner to scan the current image.","The image device manager  has an image device driver  and a set of APIs (application program interfaces) . The image device driver  controls operation, of the imaging device in response to selected options in the context-specific menu. The driver  is the code that facilitates communication with the imaging device over the USB  and passes commands to capture an image, to read image files from the device's local memory, to obtain the device's properties, and so forth.","The APIs  define a set of interfaces that can be used to access the functionality of the image device manager . These APIs are described below in a section entitled \u201cImage Acquisition API\u201d.","Exemplary Software Architecture",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2","b":["70","70","72","50"]},"At the user level, a device driver  is loaded for the particular imaging device connected to the computer. The device driver  includes a device object, an optional UI, and optional image processing capabilities. An image device manager object  is called to initialize and select an image device, and create the device interface. The image device manager object  performs such tasks as instantiating a device driver object , determining the device status, monitoring events from the device, and so forth.","A COM (component object model) layer  exposes the device driver object  and image device manager object  to an upper level application . The application layer  represents both traditional TWAIN based applications that utilize a TWAIN compatibility layer , as well as new applications that support the APIs . Unlike the traditional TWAIN model, however, the TWAIN compatibility layer  interacts with the COM-based objects  and  rather than TWAIN-based devices.","Image Acquisition User Interface","The image acquisition system may be incorporated into the operating system, exist as a set of services, or be run as a separate, self-contained application. For discussion purposes, the image acquisition system is described as being integrated into an operating system that supports a graphical user interface windowing environment.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 3","b":["100","48","100","100"]},"Of interest to the image acquisition system is the integration and treatment of the imaging devices as a folder  organized with the other general computer components. This provides a convenient starting point for the user to access the imaging devices - that are coupled to the computer .","When the user activates the \u201cImaging Devices\u201d folder icon  for the first time, an installation Wizard comes up to guide the user through the installation of an imaging device. Suppose, for example, the user has installed two scanning devices and a digital camera. Activating the \u201cImaging Devices\u201d icon  navigates to a new \u201cImaging Devices\u201d window.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 4","b":["110","48","110","112","114","116","118","112"]},"The \u201cImaging Devices\u201d window  distinguishes between devices that are currently available and those that are not available (e.g., offline, physically removed, etc.). Devices that are not available are dimmed and the user has the option of uninstalling them. In , the second scanner identified as \u201cJake's Scanner\u201d is not available and hence the icon  is dimmed.","Activating one of the imaging devices listed in window  causes the image acquisition system to present different windows exhibiting contexts that are specific to the selected imaging device. Within these device-oriented windows, the image, acquisition system presents context-specific menus that contain items or a options pertinent and relevant to the particular imaging device.",{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 5","b":["120","114","4","120","122","122","124","126","120"]},"The context-specific menu  is always visible in the scanner window . The menu  offers options that are tailored to operating the scanner attached to the computer or remotely coupled to the computer via a network. While some of the options may be included in a context menu (i.e., a menu that appears near the pointer following a right mouse click), the persistently-visible menu  lists operating specific options tailored to the scanner that are not included elsewhere in the user interface.","The menu  includes an image type selection  that has a pull-down list of various image types from which a user may select. A non-exhaustive list of image types includes color photograph, black and white photograph, color line art, black and white line art, and text. The image types included in the pull-down list  are specific to the device. Some imaging devices may not provide support for a given format and hence the format is omitted in that particular list.","A destination selection  has a pull-down list of various choices on what to do with the scanned image. For instance, the list  might include using the image in an application, faxing the image, printing the image, copying the image to a clipboard, and saving the image in a file. The destination selection simplifies the output operation for the user. For example, selection of a choice directly affects the acquisition parameters and image quality without requiring the user to know what parameters to set.","The persistently-visible context-specific menu  also has a \u201cNew Preview\u201d command  that directs scanners to create a preview image of an image that is currently in the scanning bed. The image is presented in the preview scan space . When the image appears in the scan space , a preview control  is provided to allow the user to select a region of the image for a final scan. In the illustrated implementation, the control  is shown as a dashed rectangular box framing the picture. The user can manipulate the box  to capture all or less than all of the image. Upon selection of the region, the control can proportionally resize the image to reflect the size of the scanner bed and automatically configure the scanner to make the appropriate adjustments to capture the selected image portion.","The menu  includes a \u201cScan\/Open\u201d command  to direct the scanner to capture the image. When this command is selected, the scanner scans the image in its bed. Concurrently with this scanning action, the image progressively appears in the preview scan space  to visually convey that the scanner is scanning the image. In one implementation, the image is progressively displayed row-by-row from top to bottom of the image.","The menu  includes a \u201cSave\u201d option , which directs the scanner to capture the image as a file and store the file in the computer memory. The last listed option is a \u201cSend to\u201d option , which allows the user to send thee image to various locations (or applications) on the PC, such as for packaging in a facsimile or email.",{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 6","b":["150","116","4","150","152","152","154","156","150"]},"The context-specific menu  is always visible in the camera window  and offers options that are tailored to operating the digital camera  attached to the computer. While some of the options may be included in a context menu (i.e., a menu that appears near the pointer following a right mouse click), the persistently-visible menu  lists operating specific options tailored to the camera that are not included elsewhere in the user interface.","The menu  is illustrated as having two tabs: a pictures tab  and a camera tab . Table 1 contains the options and corresponding functions available on the pictures tab .",{"@attributes":{"id":"p-0050","num":"0049"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Option","Function"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Open","Opens a picture with a default"]},{"entry":[{},"registered application."]},{"entry":["Save in \u201cMy Pictures\u201d folder","Downloads the images from the"]},{"entry":[{},"camera and copies them to \u201cMy"]},{"entry":[{},"Pictures\u201d directory on computer"]},{"entry":[{},"memory."]},{"entry":["Zoom","Changes the window view and allows"]},{"entry":[{},"the user to select one picture at a"]},{"entry":[{},"time and zoom in\/out of the picture"]},{"entry":[{},"once it is copied locally."]},{"entry":["Send to","Allows the user to send the picture to"]},{"entry":[{},"various locations (or applications) on"]},{"entry":[{},"the PC. For example, the user may"]},{"entry":[{},"choose to \u201csend\u201d the picture to an"]},{"entry":[{},"\u201cemail recipient\u201d."]},{"entry":["Lock on Camera","Allows the user to lock a picture to"]},{"entry":[{},"prevent accidental deletion."]},{"entry":["Delete from Camera","Allows the user to permanently"]},{"entry":[{},"remove the picture from the camera"]},{"entry":[{},"after a confirmation."]},{"entry":["Rotate to the Right","Allows the user to rotate the picture 90"]},{"entry":[{},"degrees to the right."]},{"entry":["Rotate to the Left","Allows the user to rotate the picture 90"]},{"entry":[{},"degrees to the left."]},{"entry":["View Properties","Allows the user to view properties"]},{"entry":[{},"associated with the selected picture(s)."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Table 2 contains the options and corresponding functions available on the camera tab .",{"@attributes":{"id":"p-0052","num":"0051"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Option","Function"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Take Picture","Triggers the camera to take a picture."]},{"entry":["Copy all Pictures","Copies all the pictures to designated"]},{"entry":[{},"location on the PC."]},{"entry":["Remove all Pictures","Deletes all pictures in the camera."]},{"entry":["Share","Brings up a wizard for the local user to"]},{"entry":[{},"share the camera."]},{"entry":["Initialize Memory Card","Enables user to initialize the storage"]},{"entry":[{},"card in the camera."]},{"entry":["View Properties","Allows the user to view a summary of"]},{"entry":[{},"the camera properties."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"The file space  lists files and\/or folders that pertain to digital images taken by the digital camera. The files are the images themselves (e.g., JPG files) and the folders contain image files and\/or other folders with image files in them.","The file space  presents the files that are currently stored on the camera. In this manner, the user can easily view the camera memory as if it were another memory of the computer. The UI allows easy integration of the camera control into the familiar windowing environment.","To add a picture to the file space, the user captures a picture using the \u201cTake Picture\u201d command in the camera menu . The picture then appears as a file in the file space . The user can then select the image file by clicking on the file and manipulating the picture using the commands on the pictures menu , such as \u201cRotate to the Left\u201d, \u201cRotate to the Right\u201d, \u201cZoom\u201d, and \u201cSend to\u201d. The user can also save the image file to the computer memory using the command \u201cSave in My Pictures folder\u201d.",{"@attributes":{"id":"p-0056","num":"0055"},"figref":["FIG. 7","FIG. 6"],"b":["170","170","116","4","150","172","174","176","176","178","26"]},"Notice also that one of the files in the file space  is a play-in-place video file . This play-in-place video file  can be actuated to play a video clip or stream within the small area depicted as box . That is, the static video icon in box  is replaced with a streaming video at the same location in the file space. Play-in-place video files  were first introduced in Media Manager, a multimedia application available from Microsoft Table 3 contains the options and corresponding functions available on the video tab .",{"@attributes":{"id":"p-0058","num":"0057"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"thead":{"row":[{"entry":[{},"TABLE 3"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"Option","Function"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Play","Plays back a video stream from the"]},{"entry":[{},{},"video camera."]},{"entry":[{},"Open","Opens a video file with a default"]},{"entry":[{},{},"application."]},{"entry":[{},"Capture Frame","Directs the video camera to record a"]},{"entry":[{},{},"single still-image frame."]},{"entry":[{},"Capture Video","Directs the video camera to record a"]},{"entry":[{},{},"video clip."]},{"entry":[{},"View Properties","Allows the user to view a summary of"]},{"entry":[{},{},"the video camera properties."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}}},"Other commands may be added to the menu. For instance, a \u201cstop\u201d command may be employed to halt the capture of live video.","Image Acquisition API","The image acquisition API  enables applications to manage loading and unloading of all imaging devices, monitor device events, query device information properties, create device objects, capture images using the devices, and store or manipulate the images after their capture.","The interfaces are accessible by high level languages (e.g., Visual Basic) as well as lower level ones (e.g., C, C++, etc.). COM is a suitable interface. In this context, each device is exposed as a COM object, whereby the object provides a number of methods and properties associated with the imaging device.","As one exemplary implementation, there are three general objects: a device manager object, a camera object, and a scanner object. The objects are described generally below. A more detailed description of the objects and methods are provided at the end of this section.","The device object contains device context and status information for a physical device. Once a device object is created for a physical device, the physical device controls what device properties are available and what values the properties may assume. There may be multiple device objects created for any physical device. However, a device object has exclusive access to a physical device before any operation (i.e., scan, take a picture, etc.) is performed. Exclusive access to a physical device is made available through a locking\/unlocking mechanism.","The device manager is implemented as three objects that perform the following functions:\n\n","ImageIn Device Manager","The ImageIn device manager provides interfaces for enumerating devices, querying properties of installed ImageIn devices and creating ImageIn device objects. The device manager has three objects.\n\n","Device information properties are distinct from normal device properties in that they are read from the registry and can be queried without forcing the device object to be created.\n\n","IImageInDevMgr Interface","EnumImageInDevInfo",{"@attributes":{"id":"p-0071","num":"0105"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::EnumImageInDevInfo("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"IEnumIMAGEIN_DEV_INFO**","ppIEnum);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}},"ul":{"@attributes":{"id":"ul0016","list-style":"none"},"li":{"@attributes":{"id":"ul0016-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0017","list-style":"none"},"li":"EnumImageInDevInfo creates a standard enumerator for CImageInDevInfo objects. The enumerator itself is a CEnumImageInDevInfo object that has a single interface IEnumIMAGEIN_DEV_INFO. Applications can use this API to obtain device information properties from available ImageIn devices."}}}},{"@attributes":{"id":"p-0072","num":"0107"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1Flags","Specifies the type of device to enumerate."]},{"entry":["ppIEnum","Enumeration interface for cEnumImageInDevInfo objects."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"GetImageInDevInfo",{"@attributes":{"id":"p-0074","num":"0109"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::GetImageInDevInfo("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"BSTR","bstrDeviceID,"]},{"entry":[{},"IPropertyStorage**","ppIPropStg);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Given a device ID GetImageInDevInfo returns an IPropertyStorage interface to CImageInDevInfo objects. This API gives applications a quick way to retrieve device information properties from a stored device ID.\n\n","CreateImageInDev",{"@attributes":{"id":"p-0077","num":"0115"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::CreateImageInDev("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"BSTR","bstrDeviceID,"]},{"entry":[{},"IUnknown**","ppDevice);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"CreateImageInDev creates a device object identified by bstrDeviceID and returns an IUnknown interface to the object. The application can use QueryInterface on this IUnknown to access the other interfaces on a device.",{"@attributes":{"id":"p-0079","num":"0117"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"bstrDeviceID","Device ID string returned from device info object."]},{"entry":[{},"ppDevice","IUnknown interface pointer returned."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"SelectImageInDev",{"@attributes":{"id":"p-0081","num":"0119"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::SelectImageInDev("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"IUnknown**","ppDevice);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"SelectImageInDev displays UI for the selection of ImageIn devices. When the user selects a device, the device object is created and an IUnknown interface is returned. The application can then use QueryInterface on this IUnknown to access the other interfaces on a device. Returns S_FALSE if the user cancels the selection dialog without making a device selection, S_OK if the user makes a device selection or an error value if the method fails.",{"@attributes":{"id":"p-0083","num":"0121"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags"]},{"entry":[{},"ppDevice","IUnknown interface pointer returned"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"GetImage",{"@attributes":{"id":"p-0085","num":"0123"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::GetImage("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"LONG","1Intent,"]},{"entry":[{},"LONG","cfFormat,"]},{"entry":[{},"STGMEDIUM*","pMedium);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"GetImage displays device selection UI allowing a user to select a device. If the user selects a device, a device is created and device UI is displayed to capture the image. Image data is returned in the pMedium structure. Image format and default image capture properties may be specified using the Intent and cfFormat parameters. Returns S_FALSE if the user cancels the selection dialog without to making a device selection, S_OK if the user makes a device selection and the data is transferred or an error value if the method fails.",{"@attributes":{"id":"p-0087","num":"0125"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags"]},{"entry":[{},"1Intent","Intent, default image capture properties"]},{"entry":[{},"cfFormat","Clipboard format desked by application"]},{"entry":[{},"pMedium","Image is returned through this medium."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"EnumDestinationInfo",{"@attributes":{"id":"p-0089","num":"0127"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::EnumDestinationInfo("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"IUnknown*","pDevice,"]},{"entry":[{},"IEnumIMAGEIN_DEST_INFO**","ppIEnum);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"EnumImageInDestInfo creates a standard enumerator for CImageInDestInfo objects. The enumerator itself is a CEnumImageInDestInfo object that has a single interface IEnumIMAGEIN_DEST_INFO. Applications can use this API to obtain device destination properties from an ImageIn device. Destination applications are registered using RegisterDestinationApplication.",{"@attributes":{"id":"p-0091","num":"0129"},"tables":{"@attributes":{"id":"TABLE-US-00014","num":"00014"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1Flags","Enumeration flags."]},{"entry":["pDevice","Device object. If null destination applications for all devices"]},{"entry":[{},"are enumerated."]},{"entry":["ppIEnum","Enumeration interface for CEnumImageInDestInfo objects."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"RegisterDestinationApplication",{"@attributes":{"id":"p-0093","num":"0131"},"tables":{"@attributes":{"id":"TABLE-US-00015","num":"00015"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IImageInDevMgr::RegisterDestinationApplication("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"LONG","1Intent,"]},{"entry":[{},"IUnknown*","pDevice,"]},{"entry":[{},"BSTR","bstrEvent,"]},{"entry":[{},"BSTR","bstrAppName,"]},{"entry":[{},"BSTR","bstrCommandLine);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"This method is called when an application wishes to register as an ImageIn destination.",{"@attributes":{"id":"p-0095","num":"0133"},"tables":{"@attributes":{"id":"TABLE-US-00016","num":"00016"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1Flags","Registration flags."]},{"entry":["1Intent","Intent, default image capture properties."]},{"entry":["pDevice","Device object. If null, destination application is"]},{"entry":[{},"registered for all devices."]},{"entry":["bstrEvent","Optional event name."]},{"entry":["bstrAppName","Friendly name of Application. This name will be"]},{"entry":[{},"displayed to the user in UI."]},{"entry":["bstrCommandLine","Full path to the executable for this application."]},{"entry":[{},"Additional command line arguments may be added"]},{"entry":[{},"to this command."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"UnregisterDestinationApplication",{"@attributes":{"id":"p-0097","num":"0135"},"tables":{"@attributes":{"id":"TABLE-US-00017","num":"00017"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESTUL IImageInDevMgr::UnregisterDestinationApplication"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"IUnknown*","pDevice,"]},{"entry":[{},"BSTR","bstrAppName);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"This method is called when an application that has registered an ImageIn destination wishes to be uninstalled or no longer known as an ImageIn destination",{"@attributes":{"id":"p-0099","num":"0137"},"tables":{"@attributes":{"id":"TABLE-US-00018","num":"00018"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags."]},{"entry":[{},"pDevice","Device object. If null, destination application is"]},{"entry":[{},{},"unregistered for all devices."]},{"entry":[{},"bstrAppName","Friendly name of Application, used to register"]},{"entry":[{},{},"application."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"IEnumIMAGEIN_DEV_INFO Interface","The IEnumIMAGEIN_DEV_INFO interface is a standard OLE enumeration interface that supports per device enumeration of device information properties.","Next",{"@attributes":{"id":"p-0103","num":"0141"},"tables":{"@attributes":{"id":"TABLE-US-00019","num":"00019"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IEnumIMAGEIN_DEV_INFO::Next("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ULONG","celt,"]},{"entry":[{},"IPropertyStorage**","rgelt,"]},{"entry":[{},"ULONG","*pceltFetched);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Next returns an array of IPropertyStorage interfaces to CImageInDevInfo objects. Applications can use the returned of IPropertyStorage interfaces to obtain device information properties from available ImageIn devices.",{"@attributes":{"id":"p-0105","num":"0143"},"tables":{"@attributes":{"id":"TABLE-US-00020","num":"00020"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["celt","Specifies the number of elements requested."]},{"entry":["rgelt","Address of an array in which to return the IPropertyStorage"]},{"entry":[{},"interfaces."]},{"entry":["pceltFetched","Address of a value that receives a count of the item"]},{"entry":[{},"identifiers actually returned in rgelt."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"Skip\n\n","Skip skips device objects in the enumeration.\n\n","Reset\n\n","Reset sets the enumeration back to the first device.","Clone\n\n","Clone creates another IEnumIMAGEIN_DEV_INFO enumeration object and returns an interface pointer to it.\n\n","IEnumIMAGEIN_DEST_INFO Interface","The IEnumIMAGEIN_DEST_INFO interface is a standard OLE enumeration interface that supports enumeration of device destination properties.","Next",{"@attributes":{"id":"p-0115","num":"0160"},"tables":{"@attributes":{"id":"TABLE-US-00021","num":"00021"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT IEnumIMAGEIN_DEST_INFO::Next("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ULONG","celt,"]},{"entry":[{},"IPropertyStorage**","rgelt,"]},{"entry":[{},"ULONG","*pceltFetched);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Next returns an array of IPropertyStorage interfaces to CImageInDestInfo objects. Applications can use the returned of IPropertyStorage interfaces to obtain destination information properties from available ImageIn devices.\n\n","Skip\n\n","Skip skips destination objects in the enumeration.\n\n","Reset\n\n","Reset sets the enumeration back to the first device.","Clone\n\n","Clone creates another IEnumIMAGEIN_DEST_INFO enumeration object and returns an interface pointer to it.\n\n","IPropertyStorage Interface","The IPropertyStorage interface is used to query the device information and destination properties. IPropertyStorage is a standard OLE interface and is documented in the OLE Programmers Reference. All device information properties are read only. Any attempt to modify the device information properties will result in a failure with access denied. The methods of this interface are:\n\n","Device Information Properties","All ImageIn devices support the following basic device information properties:\n\n","Image Scanner Device Object","ImageIn device objects support interfaces for querying and setting device properties, displaying device UI and transferring data. ImageIn devices are required to support a small number of standard interfaces that allow applications to deal with all devices in a common manner and transfer data from the devices in a manner that is native to the (COM) application. Device objects may also support more specialized interfaces to implement custom functions. Since the application has a direct connection to the device object, this architecture does not place any strict limits on the interfaces a device object can export. Practically speaking though, applications must know about an interface for it to be useful.","IScan Interface","ScanDlg",{"@attributes":{"id":"p-0131","num":"0209"},"tables":{"@attributes":{"id":"TABLE-US-00022","num":"00022"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT ScanDlg("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"LONG","1Intent);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"ScanDlg presents the system or device UI needed to prepare a device for scanning. If the dialog successfully completes, the scan object will be ready to begin data transfer via the IDataObject or IimageTransfer interfaces. The default image capture properties may be specified using the optional lIntent parameter. Returns S_FALSE if the user cancels the selection dialog without making a device selection, S_OK if the user makes a device selection or an error value if the method fails.",{"@attributes":{"id":"p-0133","num":"0211"},"tables":{"@attributes":{"id":"TABLE-US-00023","num":"00023"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags"]},{"entry":[{},"1Intent","Intent, default image capture properties"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"IPropertyStorage Interface","The standard IPropertyStorage interface is used to query and set all scan device properties. IPropertyStorage is a standard OLE interface and is documented in the OLE Programmers Reference. The methods of this interface are:\n\n","All ImageIn scanner devices support the following basic device properties:\n\n","ImageIn scan devices may support additional device properties depending on hardware configuration.","IDevPropStream Interface","The IDevPropStream interface is used to query\/set all current device properties from\/to a named, non-volatile, registry based storage. The methods of this interface are:","ReadDevPropStream\n\n","ReadDevPropStream reads a device property stream from the specified value and initializes the device with these properties. The properties are per user and per device.\n\n","WriteDevPropStream\n\n","WriteDevPropStream writes the current device property stream to the specified value. The properties are per user and per device.\n\n","ListDevPropStreams\n\n","ListDevPropStreams lists the device property stream names present in non-volatile storage. The list is returned in an allocated BSTR which the application must free using SysFreeString.\n\n","DeleteDevPropStream\n\n","DeleteDevPropStream deletes a device property stream from non-volatile storage.\n\n","IDataObject Interface","The IDataObject interface is a standard OLE data transfer mechanism. This interface is used to provide an easy and natural way for applications to transfer data from a scan device. The full IDataObject interface description can be found in the OLE2 Programmer's Reference. The methods of this interface are:\n\n","IImageTransfer Interface","The IImageTransfer is a high performance data transfer interface. This interface uses a shared memory window to transfer data from the device object to the application, eliminating unnecessary data copies during marshalling. For Simplicity, this interface uses the same format negotiation method as IDataObject. IImageTransfer uses two different mechanisms to transfer data.","Banded Transfers","The device breaks a large image transfer up into smaller transfers, which are performed sequentially into an application-specified buffer.","Data Callback","The device does a single large transfer, while calling back to the application as the transfer progresses.","itAllocateTransferBuffer",{"@attributes":{"id":"p-0157","num":"0276"},"tables":{"@attributes":{"id":"TABLE-US-00024","num":"00024"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT itAllocateTransferBuffer("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"LONG","1Size,"]},{"entry":[{},"ULONG","hSection,"]},{"entry":[{},"ULONG","ProcessID);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Allocates a buffer to use for scanning data from the device. The buffer is mapped into the address space of both the client and server process.",{"@attributes":{"id":"p-0159","num":"0278"},"tables":{"@attributes":{"id":"TABLE-US-00025","num":"00025"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags."]},{"entry":[{},"1Size","Size in bytes of the requested buffer."]},{"entry":[{},"hSection","Mapped section handle"]},{"entry":[{},"ProcessID","Caller process ID"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"itFreeTransferBuffer\n\n","Free the buffer created by itAllocateTransferBuffer. This buffer is also freed when the device object is destroyed.","itBeginTransfer",{"@attributes":{"id":"p-0163","num":"0283"},"tables":{"@attributes":{"id":"TABLE-US-00026","num":"00026"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT itBeginTransfer("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LPFORMATETC","pFormatEtc,"]},{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"IDataCallback*","pIDataCallback);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Reset a device object context to begin an IImageTransfer.",{"@attributes":{"id":"p-0165","num":"0285"},"tables":{"@attributes":{"id":"TABLE-US-00027","num":"00027"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"pFormatEtc","Format specification."]},{"entry":[{},"1Flags","Operation flags."]},{"entry":[{},"pIDataCallback","Optional transfer progress notification entry point."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"ItGetImage",{"@attributes":{"id":"p-0167","num":"0287"},"tables":{"@attributes":{"id":"TABLE-US-00028","num":"00028"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT itGetImage("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","1Flags,"]},{"entry":[{},"LONG*","p1SrcOffset,"]},{"entry":[{},"LONG*","pcbWritten);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Perform an image transfer.",{"@attributes":{"id":"p-0169","num":"0289"},"tables":{"@attributes":{"id":"TABLE-US-00029","num":"00029"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1Flags","Operation flags."]},{"entry":[{},"p1SrcOffset","Source pointer for transfer."]},{"entry":[{},"pcbWritten","Actual number of bytes written during transfer."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"itGetImageCB\n\n","Perform an image transfer using a user specified callback.\n\n","itEndTransfer\n\n","Cleanup a device object context after an image transfer\n\n","itQueryGetData\n\n","Check to see if a device supports a given format in an image transfer.\n\n","itEnumFormatEtc",{"@attributes":{"id":"p-0177","num":"0306"},"tables":{"@attributes":{"id":"TABLE-US-00030","num":"00030"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT itEnumFormatEtc("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DWORD","dw,"]},{"entry":[{},"LPENUMFORMATETC*","lpEnum);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Create a format enumerator.",{"@attributes":{"id":"p-0179","num":"0308"},"tables":{"@attributes":{"id":"TABLE-US-00031","num":"00031"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["dw","Reserved"]},{"entry":["lpEnum","Indirect pointer to the IEnumFORMATETC interface"]},{"entry":[{},"on the new enumerator object."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"ImageIn Camera Device Object","The ImageIn Camera is a hierarchical object. The top-level camera object is used to get basic device information and also to get access to individual images or image folders. The CCameraItem object represents images and Image folders.","ICamera Interface","TakePicture","HRESULT TakePicture ( );","The TakePicture method instructs a camera to take a new picture.","GetCameraRootItem\n\n","This method returns an interface to the root CCameraItem object. Using the IcameraItem interface it is possible to enumerate all images on the camera.\n\n","GetCameraItemByHandle",{"@attributes":{"id":"p-0189","num":"0321"},"tables":{"@attributes":{"id":"TABLE-US-00032","num":"00032"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT GetCameraItemByHandle("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ULONG","ulItemHandle,"]},{"entry":[{},"ICameraItem**","\u2003\u2003pICameraItem);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"This method returns an ICameraItem interface to the specified CCameraItem object. A handle for a CCameraItem object can only be obtained through the ICameraItem interface.",{"@attributes":{"id":"p-0191","num":"0323"},"tables":{"@attributes":{"id":"TABLE-US-00033","num":"00033"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ulItemHandle","Handle to camera item, previously returned by"]},{"entry":[{},"CameraItem interface"]},{"entry":["pICameraItem","Interface pointer to Camera Item specified by handle"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"CameraDlg",{"@attributes":{"id":"p-0193","num":"0325"},"tables":{"@attributes":{"id":"TABLE-US-00034","num":"00034"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT CameraDlg("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LONG","lFlags,"]},{"entry":[{},"LONG","lIntent,"]},{"entry":[{},"ICameraItem**","pICameraItem);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Display the camera UI. UI will select an image on a device and prepare for image transfer. The UI returns a ICameraItem interface to a CCameraItem ready for data transfer. IDataObject or IImageTransfer interfaces are then used to transfer image data.",{"@attributes":{"id":"p-0195","num":"0327"},"tables":{"@attributes":{"id":"TABLE-US-00035","num":"00035"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Parameters:"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["lFlags","Operational flags"]},{"entry":["lIntent","High level intent"]},{"entry":["pICameraItem","Interface pointer to Camera Item selected by Dlg"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"ICameraItem Interface","A CCameraItem object is created for every image and directory on the camera. This is done to support full and flexible hierarchical image storage on cameras. A ICameraItem pointer is returned for each CCameraItem object. ICameraItem methods are defined below.","GetItemType\n\n","GetItemType returns the type of camera item the object represents. The two types of camera items are:\n\n","GetItemHandle\n\n","Parameters:","PItemHandle Item handle returned. This handle may be used by the GetCameraItemByHandle method of the ICamera interface to obtain an IcameraItem pointer.","OpenImagePropertyStorage\n\n","Returns an IPropertyStorage interface to the CCameraItem object.\n\n","EnumChildItems\n\n","Creates a CEnumCameraItem object and returns a IEnumCameraItem interface to it. This method only works if the camera item is a folder and the folder is not empty, as shown in the figure above.\n\n","IEnumCameraItem Interface","IEnumCameraItem is a standard OLE enumerator interface with the usual four methods Next, Skip, Clone and Reset. This enumerator will return an ICameraInterface for each camera item in the current camera folder (that was used in the call to EnumChildItems).","Next",{"@attributes":{"id":"p-0210","num":"0355"},"tables":{"@attributes":{"id":"TABLE-US-00036","num":"00036"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"HRESULT Next("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ULONG","celt,"]},{"entry":[{},"ICameraItem**","ppICameraItem,"]},{"entry":[{},"ULONG*","pceltFetched);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Return an ICameraItem interface for each CCameraItem contained by the current folder.",{"@attributes":{"id":"p-0212","num":"0357"},"tables":{"@attributes":{"id":"TABLE-US-00037","num":"00037"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]},{"entry":[{},"Parameters:"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"celt","number of camera items to get"]},{"entry":[{},"ppICameraItem","List of iCameraItem interface pointers returned."]},{"entry":[{},"pceltFetched","Number of interface pointers returned"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Skip\n\n","Skip celt CCameraItem objects.\n\n","Reset\n\n","Begin at the first CCameraItem object.\n\n","Clone","HRESULT Clone(IEnumCameraItem **ppIEnumCameraItem );","Create a new CEnumCameraItem object and return a IEnumCameraItem interface.\n\n","Camera Download Manager","The camera download manager monitors the connection status of camera devices. When a camera device is connected to the system, the Download Manager will attempt to immediately download all the images from the camera onto the system hard disk. The camera download manager will also maintain a data base of all images previously downloaded from a given camera and not download images that are already cached.\n\n","In order for the camera download manager to work effectively, camera events must be detectable. For example, it should be easy to detect when a camera is connected or disconnected from the system. This should be detectable without loading the entire camera driver. Also any activity performed directly on the camera (through camera controls) must be reported to software so an accurate internal model of the state of the camera can be kept.","Sample Code","Get an image from an ImageIn device. Use the ImageIn device manager device selection UI and the device image acquisition UI.",{"@attributes":{"id":"p-0225","num":"0381"},"tables":{"@attributes":{"id":"TABLE-US-00038","num":"00038"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\/************************************************************"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["*",{}]},{"entry":["*","GetImageFromImageIn"]},{"entry":"*"},{"entry":["*","DESCRIPTION:"]},{"entry":["*","\u2002Use the ImageIn device manager to select a device and acquire an"]},{"entry":["*","\u2002image using the device UI."]},{"entry":"*"},{"entry":["*","PARAMETERS:"]},{"entry":["*","\u2002pszDIBfileName - Name of the DIB file which contain the"]},{"entry":["*","\u2002image data."]},{"entry":"*"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"************************************************************\/"},{"entry":"HRESULT GetImageFromImageIn (LPOLESTR pszDIBfileName)"},{"entry":"{"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"126pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"HRESULT","hr;"]},{"entry":[{},"IImageInDevMgr","*pIImageInDevMgr;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/\/ Get ImageIn device manager object."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"hr = CoCreateInstance","(CLSID_ImageInDevMgr,"]},{"entry":[{},{},"NULL,"]},{"entry":[{},{},"CLSCTX_LOCAL_SERVER,"]},{"entry":[{},{},"IID_IImageInDevMgr,"]},{"entry":[{},{},"(void**)&pIImageInDevMgr);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (SUCCEEDED(hr)) ("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"STGMEDIUM StgMedium;"]},{"entry":[{},"\/\/ Fill in the storage medium spec and get the image."]},{"entry":[{},"StgMedium.tymed = TYMED_FILE;"]},{"entry":[{},"StgMedium.lpszFileName = pszDIBfileName;"]},{"entry":[{},"StgMedium.pUnkForRelease = NULL;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"hr = pIImageInDevMgr\u2212>GetImage","(0,"]},{"entry":[{},{},"0,"]},{"entry":[{},{},"CF_DIB,"]},{"entry":[{},{},"&StgMedium);"]},{"entry":[{},"pIImageInDevMgr\u2212>Release ( );"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"return hr;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"Enumerate all installed ImageIn devices and get the device ID of a specific device:",{"@attributes":{"id":"p-0227","num":"0383"},"tables":{"@attributes":{"id":"TABLE-US-00039","num":"00039"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"287pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\/*******************************************************************************"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"273pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["*",{}]},{"entry":["*","GetDeviceIDfromDescription"]},{"entry":"*"},{"entry":["*","DESCRIPTION:"]},{"entry":["*","\u2002Get the unique device ID of an ImageIn device based on it's description."]},{"entry":"*"},{"entry":["*","PARAMETERS:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["*","\u2002pszDescription","- Requested device description, from device into properties."]},{"entry":["*","\u2002pszDeviceID","- Buffer for the returned device ID."]},{"entry":["*","\u2002cbDeviceIDSize","- Size of the returned device ID buffer in bytes."]},{"entry":"*"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"287pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"*******************************************************************************\/"},{"entry":"HRESULT GetDeviceIDfromDescription("}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LPOLESTR","pszDescription,"]},{"entry":[{},"LPOLESTR","pszDeviceID,"]},{"entry":[{},"UINT","cchDeviceID)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"287pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"{"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"HRESULT","hr;"]},{"entry":[{},"IImageInDevMgr","*pIImageInDevMgr;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if","(pszDeviceID && cchDeviceID) {"]},{"entry":[{},{},"*pszDeviceID = \u2018\\0\u2019;"]},{"entry":[{},"}"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"else {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return E_INVALIDARG;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/\/ Get ImageIn device manager object."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"hr = CoCreateInstance","(CLSID_ImageInDevMgr,"]},{"entry":[{},{},"NULL,"]},{"entry":[{},{},"CLSCTX_LOCAL_SERVER,"]},{"entry":[{},{},"IID_IImageInDevMgr,"]},{"entry":[{},{},"(void**)&pIImageInDevMgr);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if","(SUCCEEDED(hr)) {"]},{"entry":[{},{},"IEnumIMAGEIN_DEV_INFO *pIEnumIMAGEIN_DEV_INFO;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"PROPSPEC","PropSpec[1];"]},{"entry":[{},"PROPVARIANT","PropVarDesc[1], PropVarID[1];"]},{"entry":[{},"UINT","cbSize;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ Get an enumerator for the ImageIn device information."]},{"entry":[{},"hr = pIImageInDevMgr\u2212>EnumImageInDevInfo(0, &pIEnumIMAGEIN_DEV_INFO);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"245pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if","(SUCCEEDED(hr)) {"]},{"entry":[{},{},"IPropertyStorage *pIPropStg;"]},{"entry":[{},{},"ULONG \u2003\u2003\u2003ul;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"245pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ Enumerate the ImageIn devices, getting a IImageInDevInfo"]},{"entry":[{},"\/\/ pointer for each. Use this interface to query the registry"]},{"entry":[{},"\/\/ based properties for each installed device."]},{"entry":[{},"ul = 1;"]},{"entry":[{},"while ((hr = pIEnumIMAGEIN_DEV_INFO\u2212>Next(1,"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"203pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"&pIPropStg,"]},{"entry":[{},"&ul)) == S_OK) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ Read the device description for the current device."]},{"entry":[{},"PropSpec[0] .ulKind = PRSPEC_PROPID;"]},{"entry":[{},"PropSpec[0] .propid = DIP_DEV_DESC;"]},{"entry":[{},"hr = pIPropStg\u2212>ReadMultiple(1, PropSpec, PropVarDesc);"]},{"entry":[{},"if (SUCCEEDED(hr)) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ Test for a description match."]},{"entry":[{},"if (!wcscmp(PropVarDesc[0] .pwszVal, pszDescription)) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ Read the device ID."]},{"entry":[{},"PropSpec[0] .propid = DIP_DEV_ID;"]},{"entry":[{},"hr = pIPropStg\u2212>ReadMultiple(1, PropSpec, PropVarID);"]},{"entry":[{},"if (SUCCEEDED(hr)) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"wcsncpy(pszDeviceID, PropVarID[0] .pwszVal, cchDeviceID);"]},{"entry":[{},"PropVariantClear(PropVarID);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"PropVariantClear(PropVarDesc);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"pIPropStg\u2212>Release( );"]},{"entry":[{},"if (*pszDeviceID) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"break;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"pIEnumIMAGEIN_DEV_INFO\u2212>Release ( );"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"pIImageInDevMgr\u2212>Release ( );"]},{"entry":[{},"if (!*pszDeviceID) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"hr = E_FAIL;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"return hr;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"287pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"Although the invention has been described in language specific to structural features and\/or methodological steps, it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features or steps described. Rather, the specific features and steps are disclosed as preferred forms of implementing the claimed invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
