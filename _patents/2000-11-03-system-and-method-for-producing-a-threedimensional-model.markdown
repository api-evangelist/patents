---
title: System and method for producing a three-dimensional model
abstract: A shape of a medical device to be implanted into a subject is verified by acquiring a plurality of inter-fiduciary marker dimensions from the subject. Three-dimensional image data of the markers and a tissue of interest, included in the subject, is obtained. Respective measurements between the fiduciary markers around the subject and in the image data are confirmed. The tissue of interest and the fiduciary markers are identified in the image data. Points of the tissue of interest and the fiduciary markers are rendered as a 3-dimensional surface representation. A 3-dimensional model of the tissue of interest and the fiduciary markers is generated as a function of the surface representation. A shape of the medical device to be implanted into the subject is determined as a function of the 3-dimensional model.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07702380&OS=07702380&RS=07702380
owner: Case Western Reserve University
number: 07702380
owner_city: Cleveland
owner_country: US
publication_date: 20001103
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims the benefit of U.S. Provisional Application No. 60\/163,323, filed Nov. 3, 1999.","The present invention relates to fabricating implants to replace bony structures. More specifically, the invention relates to a system and methodology for fabricating a \u201cdrop in\u201d (i.e., the prosthetic's fit is prefabricated taking into account all of the subject's anatomy surrounding the site where it will sit) quality replacement for a particular segment of missing bony structure, in which the implant fits precisely replacing the contours of the missing segment and thus minimizes length and complications during the surgical procedure to install the implant, and subsequently facilitates the healing process. Current standard of care is to mass produce a \u201cshape\u201d that matches the patient's anatomy in only few dimensions that are obtained by external measurements. Often parts of the patient's anatomy must be removed to get a good fit. Anything else is referred to as a \u201ccustom tooling\u201d device by the FDA. This patent presents a method to prefabricate a custom (i.e., fits all dimensions of the defect site) prosthetic from imaging data. The implant requires only placement and minimal fixation by the attending clinician. It will be appreciated, however, that the invention is also amenable to other like applications.","Various systems and methods of fabricating prosthetic implants are known in the prior art. Examples of such prior systems and methods include U.S. Pat. Nos. 4,436,684; 5,274,565; 5,357,429; 5,554,190; 5,741,215; and 5,768,134. Each of these patents, however, suffer from many disadvantages that have collectively limited the usefulness of their methods and implants to the relevant field.","The primary disadvantage of these methods is that they do not provide a mechanism for ensuring that the implant will be a \u201cdrop in\u201d replacement for the missing bony material. More specifically, the implant may not be the correct shape and\/or size and, therefore, not properly fit the prosthetic into the patient. Without a proper fit, there can be a wide variety of complications with the implant, including complications that arise during the surgical process as well as during the healing process. Ultimately, these complications may result in the patient experiencing pain, disuse, atrophy, implant or surrounding structure mechanical failure, and\/or the body rejecting the implant. Thus, it is a critical disadvantage of these prior art systems and methods that they do not provide the ability to ensure a custom fit, \u201cdrop in\u201d replacement for the missing body segment.","The present invention provides a new and improved apparatus and method which overcomes the above-referenced problems and others.","A method for creating a 3-dimensional model of a tissue of interest, included within a subject, and a plurality of fiducials positions the fiducials in a fixed relationship to the subject. Data representing a volume image of the fiducials and the tissue of interest is obtained. Respective measurements between the fiducials in the fixed relationship to the subject and in the image data are validated. The tissue of interest and the fiducials are segmented from the image data. Points of the tissue of interest and the fiducials are rendered as a 3-dimensional surface representation. The 3-dimensional model of the tissue of interest and the fiducials is created as a function of the surface representation.","In accordance with one aspect of the invention, the positioning of the fiducials includes placing markers on the subject. The markers have a density for creating an identifiable spot in the volume image.","In accordance with another aspect of the invention, the positioning of the fiducials includes placing a frame of markers, which have a density for creating an identifiable spot in the volume image, around the tissue of interest.","In accordance with another aspect of the invention, the validating includes comparing distances between the markers in the fixed relationship to the subject and in the image data.","In accordance with another aspect of the invention, positional errors detected in the validating step are mathematically corrected.","In accordance with another aspect of the invention, respective measurements between the fiducials in the fixed relationship to the subject and in the surface representation are validated.","In accordance with a more limited aspect of the invention, respective measurements between the fiducials in the fixed relationship to the subject and in the 3-dimensional model are validated.","In accordance with another aspect of the invention, the image data is interpolated for smoothing the surface representation.","In accordance with another aspect of the invention, the fiducials are bridged to the tissue of interest.","One advantage of the present invention is that a drop in implant is created.","Another advantage of the present invention is that an implant having substantially the correct shape and\/or size is created.","Still further advantages of the present invention will become apparent to those of ordinary skill in the art upon reading and understanding the following detailed description of the preferred embodiments.","With reference to , a method for creating a 3-dimensional model  of a hard tissue of interest , which is included within a subject , and a plurality of fiducials , , begins in a step A. The hard tissue of interest  may include bony structure (e.g., a skull) in the subject . The frameless approach to creating fiduciary distances is to position fiducial markers , in a step B, in a fixed relationship to the subject . In the preferred embodiment (i.e., a frameless technique), the fiducials  are spherical markers (e.g., about 1.5 mm thick and including a lead material) placed (adhesed) around a defect  on the subject . In the preferred embodiment, three (3) fiducials  are used. However, additional fiducials may be used, especially if there is any concern that muscles of the subject's  facial expression might twitch the marker site during a scan. Alternatively, with reference to , which will be discussed in more detail below, fiducials  are included as markers secured to a frame  that is placed around the hard tissue of interest . In either embodiment, it is to be understood that the fiducials ,  have a density that is high enough to create an identifiable spot in an image volume. Once the fiducials ,  are positioned, precise measurements of the distances between the markers is recorded using, for example, calipers.","With reference again to , a processing system  obtains and processes data for producing images of the subject  and an implant, which will be discussed below. Data, which represents a volume (3-dimensional) image of the fiducials  and the hard tissue of interest , is obtained during a scan in a step C. Because the image data represents a 3-dimensional image, it may be referred to as voxel data. Preferably, the step C of obtaining the image data includes imaging the subject , which is positioned on a table  in a gantry , using a computerized-tomography (CT) scanner according to a particular protocol. The table  and gantry  are controlled by the processing system . In the preferred embodiment, selected parameters of the protocol include: a 1.5 mm slice thickness with a 1.5 mm table increment; 256 mm field-of-view; gantry tilt of zero (0) degrees; and kVp and mAs settings chosen by a trained technician to highlight hard tissue (e.g., bone) details in the subject . Other aspects of the scan are also part of the preferred protocol. The CT data is typically about 512\u00d7512 by 100 slices at 12-bit resolution and represents about 50 MBytes of data. It is important to realize that subject movement during the step C (i.e., during the imaging process), may cause positional errors between the fiducials  in the image data. Therefore, if a subject is restless or likely to fidget (e.g., if the subject is a young child or unable to hold sufficiently still), twilight sleep (e.g., light sedation), or if necessary general anesthetic, may be used.","Once the image data (e.g., the CT image data) is captured in the step C, it is stored on a transportable medium in a step D. Alternatively, the image data are also transferred over a network where physically possible and security concerns allow. Then, the image data is imported, in a step E, into a computerized 3-dimensional segmentation process, which occurs here in the AUTO program. More details of the AUTO program will be discussed in more detail below. It is to be understood that the image data is typically converted into a form that is compatible with the AUTO program.","Respective measurements between the fiducials , or on an imaging frame, in the fixed relationship to the subject  and in the image data are validated (confirmed) in a step F. More specifically, comparisons of respective distances are made between the markers  in the fixed relationship to the subject  and in the image data to insure that the segmentation exercise has not introduced any inaccuracies in the image data that proceeds to the next step. The comparisons made during the step F may indicate that positional errors are present in the image data (e.g., if the distances between the fiducials  in the image data do not correspond to the distances between the fiducials  around the subject ). If such inaccuracies are present in the image data, mathematical operations are performed, in a step G, for correcting the positional errors.","The tissue, in this example the bony skull, of interest  and the fiducials  are segmented (identified) from the image data in a step H. More specifically, an operator uses the AUTO program to segment the hard tissue of interest  (bony structure) of the subject  and the fiducials  away from the non-hard tissue material (non-bony structure). An operator of the system  manually marks (identifies) (e.g., with a pointing device such as a mouse) pixels within the image data that represent the hard tissue , fiducials , and\/or frame . In, for example, the image shown in , only pixels included in the skull  are marked while the pixels included in interior sinus surfaces, the cranial base, zygoma, etc. are unmarked.","The operator may use a 3-D region-growing algorithm to segment the bony objects in the volume and to label the fiducial markers . The operator reviews the segmentation results slice-by-slice. If needed, the operator uses 2-D region growing algorithms and manual methods to add or remove regions from the 3-D automatic segmentation. The operator adds bridges to connect the segmented fiducial markers to the segmented skull. Initially, the region-growing algorithms will be based on voxel intensity. A later algorithm will use the zero-crossing of the second derivative of voxel intensity. Initially, the segmentation will be voxel-by-voxel. Since the resolution of the CT data is artificially increased, this simulates sub-pixel segmentation. Later methods will use vectors to describe the segmented region boundaries. These later methods will permit sub-pixel segmentation without artificially increasing the resolution.","The AUTO program includes additional operations that apply to the entire image volume:\n\n","Although the AUTO program is predominately run in a \u201cmanual mode,\u201d the program includes several algorithmic techniques for speeding the segmentation process (e.g., volume editing). Volume editing may include volumetric region growing, volume ROI and volume non-ROI, and replanarization:\n\n","The AUTO program includes many options for an operator to display and manipulate an image:","Look-Up Tables","A plurality of Look-up Tables (LUTs) are used to map the image data values to the colors displayed on the screen. A Normal LUT maps ascending data values to grayscale values from black to white; a Pseudo LUT maps ascending data values to a color ramp that varies smoothly from black to rose to blue to violet to green to yellow to cyan to white. Reversed versions of both of these LUTs are available.","MPR Views","The volume data is presented in three orthogonal views, commonly called an orthogonal Multi-Planar Reconstruction (MPR). The X-Y plane presents the individual slices from the volume. The Y-Z and X-Z planes show orthogonal planes perpendicular to the X-Y plane and aligned with the image matrix axes. The Y-Z and X-Z planes are scaled according to the value of the slice-per-pixel ratio. Linear interpolation is used to expand the orthogonal views if the volume is non-isotropic.","The operator can scroll or loop through the volume in any of the MPR views. The operator may also automatically scroll through the volume in any of the MPR views. The operator may select the range of slices (or cross-sections) covered by the scrolling operations.","The operator may get a quick, reduced resolution view of all of the slices in the volume. The slices are shown starting with the first slice of the scroll range.","Any image in any one of the MPR views may be \u201cported\u201d to the image work window for editing.","Working View","The working view, also referred to as the work window, is where all image editing operations are performed. The work window has controls for:\n\n","Histogram View","The histogram view shows both a cumulative histogram and a binning histogram of the image in the work window. The cumulative histogram shows a plot of the percentage of pixels at a given pixel value or lower. The binning histogram shows a plot of the pixels at a given pixel value.","The operator may select the pixel data value range depicted by the histogram plots. When adjusting the range, the image in the work window is modified to show only the pixels in that range. Pixels with data values below the selected range are displayed as a first color and pixels with data values above the selected range are displayed as a second color.","Image Operations","These operations pertain to the image slice in the image work window.\n\n","Image Editing\n\n","Isolated points of the hard tissue of interest  and the fiducials  are rendered as a 3-dimensional surface representation in a step I. The rendering algorithm used in the preferred embodiment creates a manifold surface (e.g., iso-surface) image using triangulation imaging techniques. In an alternate embodiment, ray tracing or volume rendering is also contemplated. Furthermore, it is also contemplated to render other objects along with the surface of interest (e.g., an external surface of the hard tissue of interest  and the fiducials ) to judge the fit of the implant within the defect site. For example, it is important not to excessively press on the brain or protrude the overlying scalp, either may result in failure to heal, pain, and eventual extrusion of the implant. The surface of the segmented voxels are abstracted and converted to a triangular mesh representation. Triangle simplification methods are used to reduce the number of triangles. It is expected that this will produce an anti-aliased, triangulated surface mesh.","To assist the triangulation process, the slice data may be interpolated so as to increase the number of slices by a factor of four (4) or more. Linear interpolation is preferably used because of the convex-hull property. To assist the segmentation process, the slice data may be interpolated so as to increase the pixel resolution by a factor of four (4) or more. A cubic interpolation method, such as B-spline or cubic-spline, is contemplated. In order to reduce the machine requirements, it is contemplated to perform these operations on-the-fly during the segmentation process.","Optionally, the respective measurements between the fiducials  in the fixed relationship to the subject  and in the surface representation are validated in a step J in order to verify that the surface rendering process has not compromised the image's accuracy. After the surface representation is rendered, the voxel data corresponding to the surface representation is prepared to produce a physical rendering, a hard model, of the defect site and as much surrounding anatomy as is necessary to design the prosthesis. This hard model is produced by a stereolithography (STL) process. As will be described below, the STL process is used for building a physical model of a medical device  (e.g., an implant), which fits (i.e., \u201cdrops\u201d) into a defect  of the hard tissue of interest . The implant is typically about 100 cmand has tapered edges. Manual repair methods suffice for most defects less than half this size, however these methods are optimum for defects this size or larger. The implants have tapered edges to provide unambiguous seating and ease of fixation by microplating or suturing.","Then, a 3-dimensional model  of the hard tissue of interest  and the fiducials  is created in a step K. It is to be understood that the model  substantially represents the hard tissue of interest , including the defect ; therefore, the reference numeral  has been included in . Optionally, the respective measurements between the fiducials  in the fixed relationship to the subject  and in the 3-dimensional model are validated in a step L to insure accuracy for the last time of the STL produced patient model with dimensions taken from the patient prior to imaging. Then, a 3-dimensional model of the medical device  (e.g., an implant), which is to be implanted into the subject, is created in a step M. The process stops in a step N. The process of creating the implant  is discussed in more detail below.","Once created, the model of the implant  is given to a skilled anaplast for preparation of an implant, that may be seated in the subject , using an acrylic material, PMMA (polymethylmethacrylate). These methods apply to any material that the surgeon and anaplast agree to use. Currently only bioinert (biocompatible) materials such as silastic, titanium, or PMMA have been considered appropriate, however the correct implant configuration for tissue engineered (i.e., resorbable) implants can be obtained with the same methods. The anaplast feathers the edge of the implant so that it fits unambiguously against the defect  in the subject's tissue of interest . The thickness of a PMMA implant is typically about six mm thick. The curvature of the implant  is designed to conform to the subject's anatomy . A good fit is necessary for cranial implants in order to insure protection of the underlying brain from trauma and infection and that the overlying scalp receives a sufficient blood supply. Optionally, the implant  and model  of the hard tissue of interest  are gas sterilized for later use by a surgeon. Sterilization would not be necessary if a sterile production process were used.","The anaplast manually identifies and labels anatomical landmarks. It is expected that later techniques will use computer-assisted landmark labeling. As time permits, the anatomical ridge curves and geodesics are also identified. The SASE program uses landmarks, ridge curves, and geodesics.","To warp a mirrored skull, three-dimensional regions containing the landmarks are constructed to create a mirrored version of the skull. The mirrored version to the original skull shape and matching landmarks are warped (morphed). This will get the surfaces close to their desired position. The warp is refined to fit the surfaces to each other. As time permits, the ridge curves and geodesics in the skull shape (and its mirror image) are also identified. This information is used to warp (morph) the mirrored skull to the original. This will give a better initial fit. This method, or similar methods, have been implemented in the SASE program.","If the defect spans the midline, standard skull data is warped (morphed) to the subject skull shape and matching landmarks. As time permits, the ridge curves and geodesics are also used in addition to the landmarks. Standard skull data may be used in place of, or as a supplement to, mirrored skull data.","An implant shape is defined by finding a defect margin in a skull surface and transferring the defect margin to the warped skull surface. The warped skull surface is pinned down at the defect margin and all points exterior to the defect region. The warped skull surface tangents are also pinned down at the defect margin. An outer surface shape is determined by using the warped skull surface in the defect region to estimate the original patient skull surface. The maximum curvature is reduced while keeping the internal volume constant. If the subject has reduced brain volume and correspondingly less overlaying skin, the defect surface is flattened, thereby reducing the internal volume.","Optionally, an inner, ball-bearing surface that is about 6 mm from the warped outer surface is determined to add thickness treatment.","Edge Seating and taper treatment are applied at the defect margin by trimming the outer surface where the subject's skull falls about 1 mm below the warped outer surface. From this point, a smooth taper is made to the inner, ball-bearing surface. The taper is about 1 cm long. Walls are formed at the edges for resulting in the desired implant shape.","During an implantation process, the surgeon first test-fits the implant  against the defect . If necessary, the surgeon adjusts the dimensions of the implant  by grinding away excess material. Tapered edges facilitate these types of adjustments. If desired, the surgeon drills pairs of holes in a middle portion of the implant  for a suturing thread. For example, holes in the implant allow placement of sutures through the subject's tissue , the suture thread is pulled tight and tied, thus raising dura mater (internally) or the temporalis muscle cleave (externally) to the implant , or placement of temporary or permanent drains into the implant site. The implant  is secured to the subject's tissue  using titanium buttress plates and screws or sutures. Screw holes are optionally pre-drilled to reduce stress on the tissue  (e.g., bone) and the implant.","It is to be understood that the image data is converted to respective file formats at appropriate steps in the method discussed above. For example, image data is converted to a format for the rendering algorithm before the rendering step I. Also, the data representing the surface representation is formatted to the STL machine, using appropriate software, before the 3-dimensional models are created.","It is to be understood that corrections may be made (e.g., mathematically) to the 3-dimensional surface representation and the 3-dimensional model if it is determined that inaccuracies (image acquisition errors) are included in the measurements between the fiducials after the respective steps. As a general rule, however, the earlier the corrections are made in the process, the less expensive it is to implement. For example, it is less expensive to correct image acquisition errors in the 3-dimensional surface representation than in the 3-dimensional model. Corrections avoid the expense and inconvenience of acquiring a new volume image.","It is contemplated in alternative embodiments to create a computerized model of the implant from the segmentation data created by the AUTO program, thereby eliminating the need to create a physical model of the part of the body where the implant  is to be installed. One way in which this may be accomplished is to transmit the data created by the segmentation step H to an algorithm that uses normative sampling data (e.g., from humans) on a particular part of the subject where the implant  is to be installed. Such an algorithm best fits or warps the normalized data sampling to the scanned, segmented data from the segmentation algorithm to create a computer model of the implant . Then, the implant  (or a mold of the implant ) is created using a 3-dimensional manufacturing tool.","Normative images are used by first gathering appropriate information about the subject (e.g., sex, race, and date of birth). Then, an operator locates appropriate x-ray images. Fiducial pin-holes are placed in a known geometry in the lateral and frontal x-ray images. The operator aligns a reference grid associated with the subject to the fiducial pin-holes in lateral and front views of the image. Landmark registration is performed by causing a mesh of anatomical reference points to be superimposed upon the lateral and frontal x-ray images. More specifically, using a knowledge of the anatomy depicted in the x-ray image, the operator moves the vertices of the mesh to the appropriate anatomical features. Alternatively, automatic landmark detection is available. Furthermore, it is contemplated to use previously stored images and\/or permit the current image (or portions thereof) to be stored.","The key aspect of the preferred protocol that enables the development of a precisely aligned implant (i.e., a \u201cdrop-in\u201d implant) is the use of the fiducials . Note, however, that the invention is not specifically limited to lead fiducials as described here, but also encompasses other techniques of providing a precise reference marker on the subject's image, which can be subsequently used to verify the dimensions of the implant. The imaging of the fiducials and the data representing the geometry of these elements with respect to each other is used by the steps in the method to ensure that the implant has proper dimensions.","With reference again to , the frame  provides a defined geometrical reference for three-dimensional Computed Tomography (3D CT) to be used to create verified 3D spatial coordinates. 3D CT is a medical imaging technique that uses x-ray radiation to view cross sectional slices of the subject's  anatomy. The slices are assembled to form a 3D representation of the subject's  anatomy. To ensure that the digital representation of the subject's  anatomy is the correct size, the defined reference frame  is established within the imaged field of view. This reference frame  requires no relative movement between markers . The frame  is rigidly attached to the subject  so that movement can be detected. Movement of the subject  during a scan may result in inaccuracies. The defined reference frame  is used to verify anatomical dimensions used for the production of correctly sized implants. Due to the scheduling of the scans, simple pre-scan patient preparation is desired. Post-scan confirmation of the measurements of the reference frame should be easy. The geometrical reference frame  is preferably used on the subject's  head or face, for use with the design of cranial-facial implants.","The practice of comparing the physical model produced by the STL machine with inter-fiducial distances measured on the subject  must be revised accordingly because the new fiducials are not as close to the skull. As discussed below, bridges are created between each fiducial  and the hard tissue of interest  (skull) so that the inter-fiducial distances may be verified on the model  produced by the STL machine. With the use of the fiducials  that are further away from the skull , pseudo-fiducials are added by the operator during segmentation so that those inter-pseudo-fiducial measurements may be verified on the 3D model . After the inter-fiducial distances are verified to be correct, pseudo-fiducials are created and compared throughout the remainder of the model production procedure.","The frame  may be assembled using an existing dental facebow  (WhipMix), which may be made of aluminum. Modifications are made to rigidly attach at least four (4) non-coplanar radiographic points . The fiducials  (e.g., lead spots) (Beekley) or other markers are attached to the points . Rigid attachment of the fiducials  may present a problem as the width and height of the facebow  varies to accommodate sizing for different subjects. A separate assembly can be attached to the facebow  that would define fiducials with out reference to the geometry of the facebow . Rods  and\/or cross-rods  may be attached to the facebow to help detect subject motion.","The facebows  are readily available from various dental supply companies. The point markers , which are attached to the facebow , must not move in relation to each other and, when the scan is taking place, cannot move with respect to the subject . The relative location of the markers  may vary from subject to subject. Facebows  typically attach to the subject on the nasion  (bridge of nose) and external auditory meati . A hand tightening screw preferably secures the nasion attachment. By tightening the nasion pad to the nasion, the external auditory meati (external ear holes) pads are pulled forward and secured by pressure.","Optionally, with reference to , in addition to the segmentation step H, the operator marks the position of the fiducials  for creating a bridge . It is to be understood that  represents an exaggerated depiction of the subject  including the hard tissue of interest . The bridges  represent links or leads between the fiducials , which are located on or above the surface of the subject's skin, and the hard tissue of interest , which may be located below the surface of the skin.","The invention has been described with reference to the preferred embodiment. Obviously, modifications and alterations will occur to others upon reading and understanding the preceding detailed description. It is intended that the invention be construed as including all such modifications and alterations insofar as they come within the scope of the appended claims or the equivalents thereof."],"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The invention may take form in various components and arrangements of components, and in various steps and arrangements of steps. The drawings are only for purposes of illustrating a preferred embodiment and are not to be construed as limiting the invention.",{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
