---
title: Print relay system, print relay system control method, and storage medium
abstract: A print relay system capable of executing a communication between a print service system configured to provide a print setting screen to an information terminal operated by a user, to receive a print setting set by the user via the provided print setting screen, and to generate a print job based on the received print setting and stored settings for an image forming apparatus configured to output image data based on the print job includes a receiving unit configured to receive a print job, which is transmitted in a case that a print instruction is input by the information terminal to the print service system, a job updating unit configured to update the print job received by the receiving unit, and a job transmission unit configured to transmit the print job updated by the job updating unit to the image forming apparatus.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08860988&OS=08860988&RS=08860988
owner: Canon Kabushiki Kaisha
number: 08860988
owner_city: Tokyo
owner_country: JP
publication_date: 20110929
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENTS"],"p":["1. Field of the Invention","The present invention relates to a print relay system configured to receive a print job from a print server, a method for controlling the print relay system, and a storage medium therefor.","2. Description of the Related Art","In a conventional technique, a client transmits a print instruction to a server and the server that has received the print instruction converts a content to be printed into print data. Japanese Patent Application Laid-Open No. 2003-216367 discusses a system in which a client downloads web content data to be printed and a print format setting screen from a print server and the client transmits print data to an image forming apparatus to print the print data thereon.","As described above, in a conventional system, a server provides a service to a client. In a cloud computing system, which has recently attracted much attention, a server provides a service to a client. In cloud computing, data conversion and data processing are executed as distributed processing with using a large number of computing resources, as characteristic thereto, to process a plurality of requests from a large number of clients at the same time. Recently, very many vendors that provide various types of services have been established and have been providing web services on a cloud computing environment that implements the cloud computing described above.","In particular, Google (registered trademark) is one of the most active vendors. Google (registered trademark) has established very many large-scale data centers. Further, Google (registered trademark) has proposed a service to be provided in association with a device and has developed a method for data communication between a device and a service in a positive manner. For example, Google (registered trademark) has developed a data communication method for providing a service in association with an image forming apparatus. Furthermore, Google (registered trademark) has publicized an interface for implementing data communication between an image forming apparatus and the cloud computing environment provided by Google (registered trademark). If a user desires to utilize the service, the user is required to register information about an image forming apparatus to the cloud computing environment, i.e., a service environment that provides the service. The information about the image forming apparatus can be completely registered to the service environment by storing the information about the image forming apparatus in the environment of the service provider.","According to an aspect of the present invention, a print relay system capable of executing a communication between a print service system configured to provide a print setting screen to an information terminal operated by a user, to receive a print setting set by the user via the provided print setting screen, and to generate a print job based on the received print setting and stored settings for an image forming apparatus configured to output image data based on the print job includes a transmission unit configured to transmit to the information terminal, a detailed print setting screen via which a detailed print setting that cannot be set via the print setting screen can be set, a receiving unit configured to receive a print job, which is transmitted in a case that a print instruction is input by the information terminal to the print service system, a job changing unit configured to receive the detailed print setting set by the user via the detailed print setting screen transmitted by the transmission unit and to convert the print job received by the receiving unit into a new print job based on the receive detailed print setting, and a job transmission unit configured to transmit the new print job which has been converted by the job changing unit to the image forming apparatus.","Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.","Various exemplary embodiments, features, and aspects of the invention will be described in detail below with reference to the drawings.","The present invention is directed to a print relay system provided between an environment of a vendor that provides an interface and an image forming apparatus.","To begin with, a configuration of a content printing system  according to a first exemplary embodiment of the present invention will be described in detail below with reference to .  illustrates the configuration of the content printing system . Referring to , the content system  includes a client computer  and an image forming apparatus . The client computer  and the image forming apparatus  are installed in a user environment and can communicate with each other via a network . The network  is connected to the Internet . In addition, the content printing system  includes a web application server group  and a print server group . The web application server group  and the print server group  are server groups provided by the same vendor and are in communication with each other via the network . The network  is connected to the Internet . The client computer  is equivalent to an information terminal operated by a user. The print server group  is equivalent to a print service system.","In the present exemplary embodiment, the two server groups are in communication with each other via the network  as described above. However, alternatively, the web application server group  and the print server group  can be connected via the Internet . In addition, the content printing system  includes a print relay server . The print relay server  is connected to the network . The network  is connected to the Internet . Each apparatus and each server group included in the content printing system  can be connected to one another via the Internet to implement a bidirectional data communication. In the present exemplary embodiment, it is supposed that one apparatus is provided as each of the above-described apparatuses. However, a plurality of apparatuses can be used for each of the above-described apparatuses. Further, in the present exemplary embodiment, it is supposed that each server group is constituted by a plurality of servers. However, one server can constitute each server group. The print relay server  is equivalent to the print relay system.","A hardware configuration of each apparatus and each server group included in the content printing system  will be described in detail below with reference to .  illustrates the hardware configuration of each apparatus and each server group which constitute the content printing system . Each apparatus and each server group  is included in the content printing system . A central processing unit (CPU)  executes various programs to implement various functions. A read-only memory (ROM)  is a unit configured to store various programs. A random access memory (RAM)  is used by the CPU  to load and execute the program stored in the ROM  on the RAM .","In addition, the RAM  can be used as a temporary work and storage area of the CPU . An input\/output (I\/O) interface  is an interface unit configured to transmit data to a display (not illustrated), which is connected to each apparatus and each server group and receive data input via a pointing device (not illustrated). A network interface card (NIC)  is a unit configured to connect each apparatus and each server group included in the content printing system  to the network . The above-described units can execute bidirectional data communication via a bus . he image forming apparatus  includes a printing unit (not illustrated). The printing unit can transmit and receive data to and from each of the above-described units via the bus . The printing unit is capable of printing various types of image data, such as a raster image, on a recording medium or transmitting the image data to an external apparatus.","Functions of each apparatus and each server group included in the content printing system  will be described in detail below with reference to .  illustrates a software configuration of each apparatus and each server group, which are included in the content printing system . A program that can implement the function of each software configuration illustrated in  is stored on the ROM  of each apparatus and each server group. The CPU  loads and executes the program on the RAM  to implement the function.","The functions of each apparatus and each server group will be described. The functions described below are categorized into the following two categories in a large sense. The functions of the first category are functions categorized in a registration function category, which are configured to register the image forming apparatus  to the print relay server , implement a relay virtual printer  on the print relay server , and register the relay virtual printer  to a print service . The functions of the second category are functions categorized in a print function category, which are configured to transmit an instruction to print a content generated by the web application server group  to the print server group  and print the print data transmitted by the print server group  on the image forming apparatus . In printing the print data transmitted by the print server group  on the image forming apparatus , the print server group  transmits the print data to the image forming apparatus  via the print relay server , which functions as a data transfer server, and the print data is printed by the image forming apparatus .","The functions which are categorized into the registration function category will be described in detail below. More specifically, in the following description, the functions of the image forming apparatus , which are categorized into the registration function category, will be described. The image forming apparatus  includes a print control unit . The print control unit  implements each function illustrated in . Referring to , the display unit  displays various screens. A print service information storage unit  includes print service information.  illustrates an example of the print service information. In the example illustrated in , information about a plurality of print services is illustrated, and a print service  according to the present exemplary embodiment is equivalent to a Print Service A.","If it is instructed by the user to register the image forming apparatus  to the print service , a display unit  generates and displays a UI for registering the image forming apparatus  to the print service illustrated in , based on the information illustrated in . The user selects a print service to which the user desires to register the image forming apparatus  via the UI screen illustrated in  by using a pull-down .","In the present exemplary embodiment, only one print service, i.e., the print service , exists. Accordingly, the user cannot select a print service other than the Print Service A. The user inputs a user identification data (ID) and a password for the selected print service in fields  and  () and presses a registration button . When the registration button  is pressed by the user, a registration unit  issues registration information. Further, the registration unit  transmits the issued registration information to a request receiving unit  included in a relay virtual printer management service , which will be described in detail below. The functions not described above will be described in detail below.","The registration information will be described in detail below. A print service name is included in the registration information. The print service name is information for identifying the print service selected by the user. Further, the print service name is information for identifying the print service  provided by the print server group . Further, the user ID and the password are included in the registration information. The user ID and the password are information required for the user to utilize the print service  and the web application server group . In the following description, the user ID and the password are collectively referred to as \u201cuser information\u201d.","In the present exemplary embodiment, it is supposed that the same vendor provides the web application server group  and the print server group . Accordingly, if the user utilizes a service provided by both the web application server group  and the print server group , the user can use the same user information. In the present exemplary embodiment, it is supposed that the user has previously registered the user information to the web application server group .","In addition, the registration information includes a real printer ID (RPID), which is unique identification information assigned to the image forming apparatus . Unique identification information is assigned to each image forming apparatus (not illustrated) including the image forming apparatus . Each image forming apparatus can be identified by the identification information. In the present exemplary embodiment, the installation location of the image forming apparatus can be identified by identifying the RPID. Further, an element <PrinterKind>, which is model information about the image forming apparatus , is included in the registration information.","Image forming apparatuses of the same model are assigned with the same model information. More specifically, if two image forming apparatuses are provided with the same communication module B\u2032, the image forming apparatuses are determined as the same model. The communication module B\u2032, a communication module A, a communication module A\u2032, and a communication module B will be described in detail below. In addition, a printer name of the image forming apparatus  is included in the registration information. The printer name is the name assigned to the image forming apparatus  and is used as the name of the image forming apparatus . Unlike the identification information, the printer name may be the same for each image forming apparatus. Further, an element <Capabilities> is included in the registration information.","The element <Capabilities> includes various information, such as information about whether the image forming apparatus  can execute two-sided print setting, whether the image forming apparatus  can execute color print setting, whether the image forming apparatus  can execute a bookbinding print setting, and the size of paper that can be output on the image forming apparatus . The element <Capabilities> is transmitted to the request receiving unit  in the XML format as illustrated in . Referring to , an element <Item> describes the capacity of the image forming apparatus . More specifically, in the example illustrated in , the image forming apparatus  is capable of executing two-sided printing and color printing, and outputting using the paper of B5, A4, A3, and letter sizes.","In addition, it is described in the element <Capabilities> that the image forming apparatus  can execute bookbinding printing. Further, it is also described that an input of a billing code is required. Furthermore, for paper feeding, an auto sheet feeder and cassettes  and  can be utilized, and for finishing functions, Z-folding and stapling are available. The billing code is used in a law firm, for example, for executing printing with designating a charging target client information \u201cbilling code\u201d to charge the costs of printing executed according to a request by the client. The billing code and a print result are mutually associated and recorded. The billing code is utilized to summarize the total charge amount for each client (charging target client) according to the recorded result.","The functions of the print relay server , which are categorized in the registration function category, will be described in detail below. The print relay server  includes the relay virtual printer management service unit . The relay virtual printer management service unit  implements each function illustrated in . The request receiving unit  receives the registration information. A control unit  acquires the registration information received by the request receiving unit  and interprets the registration information. Further, the control unit  inputs an instruction to a virtual printer generation unit  and a print service printer generation unit  for executing a following two types of processing. The first processing is processing executed by the virtual printer generation unit  to implement the function of the relay virtual printer . The second processing is processing executed by the print service printer generation unit  to register information about the relay virtual printer  to the print service .","The first processing, i.e., the processing executed by the virtual printer generation unit  to implement the function of the relay virtual printer  will be described in detail below. The relay virtual printer  implements each function illustrated in , which will be described in detail below. The virtual printer generation unit  identifies and acquires a communication module B , which is stored on an interface information management unit  based on the element <PrinterKind> transmitted from the control unit . The virtual printer generation unit  identifies and acquires a communication module A\u2032 , which is stored on the interface information management unit  based on the print service name.","The communication module B is a module for executing a communication with the image forming apparatus . As described above, the same model has the same communication module B, the communication module B can be identified by referring to the element <PrinterKind>. The communication module B communicates with a communication module B\u2032  included in the print control unit . The communication module A\u2032  is a module for executing a communication with the print server group . The communication module A\u2032  can communicate with a communication module A  included in the print service . After acquiring the two communication modules, the virtual printer generation unit  implements a process (thread) in which the two communication modules are loaded. The process is equivalent to the relay virtual printer .","After implementing the relay virtual printer , the virtual printer generation unit  issues a virtual printer ID (VPID), which is identification information for identifying the implemented relay virtual printer . The issued VPID is transmitted to the control unit . The relay virtual printer  is implemented every time the registration information is transmitted from the image forming apparatus . Each of the implemented relay virtual printers is assigned with a VPID, which is a unique identifier. In the present exemplary embodiment, by identifying the VPID, the installation location of the relay virtual printer can be identified.","The second processing, i.e., the processing executed by the print service printer generation unit  for registering information about the relay virtual printer  to the print service  will be described in detail below. The control unit  transmits the user information to the print service printer generation unit . The print service printer generation unit  executes an authentication of the print server group  based on the received user information. If the authentication is successful, the print service printer generation unit  transmits the printer name, the element <Capabilities> () that can be processed by the print service , and the VPID to the print service .","Among the elements <Capabilities> of the image forming apparatus , the element <Capabilities> that can be processed by the print service  only can be registered to the print service . This is because even if the element <Capabilities> that the print service  does not support can be registered to the print service , the print service  cannot utilize the registered element <Capabilities>. In response to the transmitted information, the print service printer generation unit  receives a service printer ID (SPID). The SPID will be described in detail below.","The control unit  acquires the VPID and the SPID from the virtual printer generation unit  and the print service printer generation unit . After receiving the VPID and the SPID, the control unit  instructs a print service information management unit  to store the information thereon. The print service information management unit  stores the VPID, the SPID, and the registration information in association with one another as illustrated in . In the example illustrated in , the VPID is stored in a field . The print service name is stored in a field . The RPID is stored in a field . The element <PrinterKind> is stored in a field . The SPID is stored in a field . The printer name is stored in a field . The element <Capabilities> is stored in a field .","The functions of the print server group , which are categorized in the registration function category, will be described in detail below. The print server group  includes the print service . The print server group  virtualizes a plurality of servers and regards the plurality of servers as one server. The virtually provided one server implements the functions of the print service . More specifically, the print server group  activates a plurality of virtual machines in one server to implement the function of the print service  on each virtual machine. The print service  illustrated in  illustrates one of the virtual machines.","The print service  implements a function illustrated in . Referring to , a printer information registration unit  receives the user information from the print service printer generation unit . The printer information registration unit  reads the user information stored in a web application  included in the web application server group  to determine whether the received user information exists. If it is determined that the received user information exists, the printer information registration unit  recognizes that the authentication has been successfully completed. The printer information registration unit  receives the printer name, the element <Capabilities>, and the VPID from the print service printer generation unit . Further, the printer information registration unit  instructs the printer information storage unit  to store the received VPID.","The printer information registration unit  issues an SPID corresponding to the VPID and transmits the issued SPID to the printer information storage unit  and the print service printer generation unit . The printer information storage unit  stores the printer name, the element <Capabilities>, the VPID, the SPID, the user ID, and the password in association with one another.","In the example illustrated in , the printer information storage unit  stores various information, such as the SPID in a field , the printer name in a field , the VPID in a field , the user name in a field , the password in a field , and the element <Capabilities> in a field . The other functions not described above will be described in detail below. The above-described functions are categorized into the registration function category, which includes functions for registering the image forming apparatus  to the print relay server , implementing the relay virtual printer  within the print relay server , and registering the relay virtual printer  to the print service .",{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 14","b":["702","103","101","702","1","1401","2","1402","101","2","1402","3","1403","702","103","103"]},"As illustrated in , the element <Capabilities> that the print server  can store and the element <Capabilities> that the image forming apparatus  actually stores do not match. The elements <Capabilities> included in the element ()  can match. The elements <Capabilities> included in the element ()  and that can match each other will be hereafter referred to as a \u201ccommon setting item\u201d . The value thereof corresponds to that illustrated in . The elements <Capabilities> that do not match, which are included in the element () , includes a required setting item  and an image forming apparatus unique setting item . The required setting item  is the element <Capabilities> required to be set to the image forming apparatus. Printing cannot be executed unless the element <Capabilities> corresponding to the required setting item  has been set. For example, the billing code is an example of the required setting item . The image forming apparatus unique setting item  is the element <Capabilities> that is dependent on a setting uniquely set to each image forming apparatus and an externally provided peripheral apparatus, such as a finisher. For example, paper feeding or a finisher is an example of the image forming apparatus unique setting item .","If the present invention is not applied, if any element <Capabilities> that the print server  cannot store exists although the image forming apparatus includes various functions, the user cannot utilize the function of the image forming apparatus. Further, if the element <Capabilities> required to be set to the image forming apparatus  is not stored by the print server  as the element <Capabilities> that the print server  can store, the printing may not be available because the condition for activating the image forming apparatus  is not satisfied. Furthermore, if the print setting is executed according to a setting that can be set related to the print service only, the image forming apparatus  cannot output an output result desired by the user.","The functions categorized into the print function category will be described in detail below. First, the function of the client computer  will be described in detail below. The client computer  includes a web browser . The web browser  includes a web browser plug-in . The web browser plug-in  is an expansion function of the web browser . The web browser  transmits an instruction to print the content stored in the web application server group  to the web application server group .","The web browser  receives a command for accessing the print server group , i.e., a redirect instruction, from the web application server group . The web browser  accesses the print server group  according to the received redirect instruction. Further, the web browser  acquires a list of the image forming apparatuses available to the user of the web browser  for printing from the print server group  to which the web browser  has been accessing. Moreover, the web browser  displays the list of the image forming apparatuses.","The web browser  acquires, from the print server group , a print setting screen corresponding to an image forming apparatus selected by the user from the list and displays the acquired print setting screen.  illustrates an example of the print setting screen corresponding to the image forming apparatus selected by the user, which is displayed by the web browser , and the web browser plug-in .","The web browser  transmits a print setting value set by the user set via the print setting screen to the print server group . The web browser plug-in  detects that the print setting value set by the user has been transmitted to the print server  and transmits setting information to the relay virtual printer . The setting information includes the print setting value () set by the user via the print setting screen, the SPID corresponding to the selected image forming apparatus, and the plug-in setting information. The plug-in setting information is information for setting which of an image forming apparatus unique setting and a setting via a screen of the image forming apparatus during printing is to be executed. By pressing a detailed setting button , the setting can be executed via a plug-in setting screen illustrated in . The plug-in setting information set by the user is stored within the web browser plug-in .","If a uniform resource locator (URL) of the detailed print setting screen has been received from the relay virtual printer , the web browser plug-in  requests the web browser  to display the detailed print setting screen URL. To display the detailed print setting screen, the web browser  transmits a display request to the relay virtual printer . The detailed print setting screen is displayed by the web browser .  illustrates an example of the detailed print setting screen. The web browser  transmits detailed print setting information set by the user via the detailed print setting screen to the relay virtual printer . The web browser  and the web browser plug-in  included in the client computer  operate as described above. Via the detailed print setting screen, the user can set a detailed print setting that cannot be set via the print setting screen provided by the print server .","The function of the web application server group  will be described in detail below. The web application server group  includes the web application . The web application server group  virtualizes a plurality of servers and regards the plurality of servers as one server. The virtually provided one server implements the function of the web application . More specifically, the web application server group  activates a plurality of virtual machines in one server to implement the function of the web application  on each virtual machine.","The web application  provides a document generation service. For example, when the user is to distribute documents in a corporate meeting, the user can utilize the document generation service to generate the documents. If the client computer  utilizes the web application , it is not necessary to install the application into the client computer . In other words, in this case, the client computer  only has to install the web browser plug-in  and include the web browser . The web application  transmits screen information used for generating the document to the web browser .","The web application  authenticates the user based on the user information including the user ID and the password input by the user. If the user is normally authenticated, the web application  transmits the screen information for generating the document. After receiving the screen information, the web browser  displays a document generation screen for generating the document based on the screen information. Thus, the user can generate the document to be distributed in the meeting using the document generation screen.","The web application  receives the information about the document generated by the user using the document generation screen and generates a content of the document based on the received information. Further, the web application  stores the generated content on a storage device of the web application server group . The web application  provides an e-mail service and a schedule service as well as the document generation service.","If the user desires to print the content generated by utilizing the document generation service, the user can execute the printing by pressing a print button displayed on the document generation screen.  illustrates an exemplary screen displayed when a print button  is pressed. Referring to , the screen displays a content , which has been generated by the user. The web application  receives information indicating that the print button has been pressed and transmits an access command for accessing to the print server group , i.e., a redirect instruction, to the web browser . The redirect instruction includes a request for acquiring the list corresponding to the user who is utilizing the above-described web browser , content identification information for identifying the content instructed by the user to be printed, and the user information.","Further, if a request for acquiring a content is received from the print server group , the web application  transmits the requested content to the print server group , which is identified based on the content identification information for identifying the content received together with the content acquisition request. The web application  included in the web application server group  operates in the above-described manner.","The functions of the print server group  that are categorized into the print function category will be described in detail below. Referring to , the print service  included in the print server group  includes a printer information presentation unit . When the list acquisition request is received from the web browser , the printer information presentation unit  transmits the requested list to the web browser .","The printer information presentation unit  identifies the SPID and the printer name stored by the printer information storage unit  based on the user information. Then, the printer information presentation unit  generates a list of the image forming apparatuses available to the user based on the SPID and the printer name. Further, the printer information presentation unit  receives the SPID of a symbol corresponding to the image forming apparatus selected by the user from the list. The symbol refers to an icon for the image forming apparatus displayed as the list. The printer information presentation unit  identifies the element <Capabilities> stored by the printer information storage unit  based on the received SPID. Further, the printer information presentation unit  generates a print setting screen and transmits the generated print setting screen to the web browser .","The printer information storage unit  generates a print setting screen illustrated in  based on the information described in the element <Capabilities> illustrated in . Referring to , the printer information storage unit  generates the print setting screen via which the user can select the print setting described in the element <Capabilities> that the print service  can process only.","A print instruction receiving unit  () receives the print setting set via the print setting screen and the SPID from the web browser . If the web browser  has accessed the print service  based on the redirect instruction, the print instruction receiving unit  receives content identification information for identifying the content instructed by the user to be printed.","A print data generation unit  receives the content identification information from the print instruction receiving unit  and acquires the content to be printed from the web application  based on the received content identification information. Further, the print data generation unit  receives the print setting input by the user via the print instruction receiving unit  and the SPID corresponding to the image forming apparatus selected by the user. Furthermore, the print data generation unit  converts the content into print data based on the content and the print setting acquired from the web application .","The control unit  acquires the print data, the print setting, and the SPID from the print data generation unit . The print setting is described in the XML format as illustrated in . Referring to , in the present exemplary embodiment, it is supposed that the user has set the two-sided setting, the monochromatic printing, and the letter paper size.","The communication module A  can communicate with an apparatus having the communication module A\u2032 . The communication module A  is an interface for data communication with the apparatus having the communication module A\u2032 . The communication module A\u2032  cannot communicate with the communication module A, and the reasons thereof will be described after describing the functions of the communication module A .","The communication module A  includes a print data storage unit , a print setting information storage unit , and a print job notification unit . The print data storage unit  receives and stores the print data from the control unit . The print setting information storage unit  receives and stores the print setting from the control unit . The print data storage unit  and the print setting information storage unit  receive a storage instruction from the control unit  and execute storage processing. When it is notified from the print data storage unit  and the print setting information storage unit  that the storage has been completed, the control unit  instructs the print job notification unit  to transmit notification information.","When the instruction to transmit notification information is received from the control unit , the print job notification unit  acquires the SPID from the control unit  and identifies the VPID based on the information stored on the printer information storage unit . In the present exemplary embodiment, information about a transmission destination corresponding to the SPID, i.e., the VPID in the present exemplary embodiment is referred to as a \u201ctarget\u201d. The user designates the VPID by selecting the SPID. The print job notification unit  acquires the storage locations of the print data and the print setting from the control unit , and generates notification information A. Further, the print job notification unit  transmits the notification information A to the registered image forming apparatus.","The print job notification unit  is equivalent to a first transmission unit. The information transmitted by the print job notification unit  is equivalent to information about data. The information about the data according to the present exemplary embodiment is the notification information A. However, the information about the data may include information and data other than the notification information A according to a specification of the communication. This applies to notification information B, which will be described in detail below. In the present exemplary embodiment, the registered image forming apparatus refers to a relay virtual printer, which corresponds to the VPID. The notification information A is expressed in the XML format illustrated in . Referring to , an element <Item>  describes the storage location of the print data. An element <Item>  describes the storage location of the print setting.","The communication module other than the communication module A\u2032  cannot communicate with the communication module A  due to the following reason. More specifically, the communication module other than the communication module A\u2032  cannot interpret the notification information A, which is received from the print job notification unit  and expressed in the XML format.","In addition, in the following case, the communication module other than the communication module A\u2032  cannot communicate with the communication module A . For example, if the communication module A  does not include the print job notification unit  and if the communication module A\u2032  acquires the print data and the print setting by a different method, the communication module A\u2032 , which acquires the notification information A, cannot acquire the print data and the print setting. This is because the communication module A\u2032 , which acquires the notification information A, has been currently waiting for the notification information A to be transmitted from the communication module A  and the print data and the print setting cannot be acquired until the notification information A is notified. It is required for the communication module A\u2032  that can communicate with the communication module A to have a configuration for inquiring the communication module A  whether data to be acquired exists.","As described above, if the communication module A\u2032  does not comply with the data communication specification of the communication module A , the communication module A  cannot communicate with the communication module A\u2032 . In the present exemplary embodiment, a method that enables the communication between the communication module A  and the communication module A\u2032  is referred to as a specification of a vendor that provides the print server group . The specification greatly depends on the vendor that manages the print server group .","The vendor that manages the print server group  implements the communication module A  on the print server group  and publicizes an application programming interface (API) for communicating with the communication module A . In fact, the above-described system has been actually established. The vendor that manages the print server group  has publicized a unique specification that enables a data communication between the print server group  and a device. Under these circumstances, it is required for a device vendor of the image forming apparatus  to install the communication module A\u2032 , in which the API is implemented, on the image forming apparatus  to enable the image forming apparatus  to communicate with the print server group .","Suppose that the vendor that manages the print server group  has changed the configuration of the communication module A . In other words, suppose that the vendor that manages the print server group  has changed the specification. In this case, the device vendor is required to change the communication module A\u2032  of the image forming apparatus  due to the change in the specification. The load of the communication module changing operation is very high. This is because the image forming apparatuses may be installed in various customer environments and in order to enable the communication between the print server group  and the image forming apparatus again, it is required that a service person visits the various customer environments to change the communication module A\u2032 .","If the above-described problem is to be solved by distributing the communication module A\u2032  without sending the service person to each customer environment, the load on the communication band may become high because it is required to transmit the communication module A\u2032  to a plurality of image forming apparatuses. The above-described problem can be solved by using the functions of the print relay server  categorized in the print function category described below. The specification of the data communication that the vendor that manages the print server group  publicizes is equivalent to a first specification. The interfaces for the communication between the communication module A  and the communication module A\u2032  is generated in compliance with the first specification.","The functions categorized in the print function category of the print relay server , which implement the functions illustrated in , will be described in detail below. Referring to , the relay virtual printer  includes the communication module A\u2032  and the communication module B . A print notification receiving unit  of the communication module A\u2032  receives the notification information A transmitted from the print job notification unit . Because the relay virtual printer , instead of the RPID of the image forming apparatus , has been registered to the print service , the notification information A is transmitted to the print notification receiving unit .","Because the communication module A\u2032  is used as a pair of modules with the communication module A , the print notification receiving unit  can interpret the notification information A. The print notification receiving unit  is equivalent to a first acquisition unit. The print notification receiving unit  verifies the storage locations of the print data and the print setting described in the notification information A and notifies the these pieces of the information to a print setting acquisition unit  and a print data acquisition unit . The print setting acquisition unit  acquires the print setting from the print setting storage unit  based on the notified print setting storage location.","On the other hand, a plug-in status receiving unit  receives the print setting value () set by the user via the print setting screen of the web browser  from the web browser plug-in , the SPID corresponding to the selected image forming apparatus, and the plug-in setting information. Then, the plug-in status receiving unit  notifies a control unit  of the received information. The control unit  identifies the element <Capabilities> of the image forming apparatus  according to the plug-in setting information, the print setting transmitted to the print server , and the SPID and determines whether it is necessary to execute a detailed print setting. Processing for the determination will be described in detail below. If it is determined that an additional print setting is necessary, the plug-in status receiving unit  transmits a URL of the detailed print setting screen to the web browser plug-in .","When a request for a detailed print setting screen is received from the web browser , a printer information presentation unit  generates a detailed print setting screen and transmits the generated detailed print setting screen to the web browser . Subsequently, a print instruction receiving unit  receives the detailed print setting information input by the user via the detailed print setting screen.","The print data acquisition unit  acquires the print data from the print data storage unit  based on the notified print data storage location and notifies the acquired print data to the control unit . The control unit  instructs a print data generation unit  to store the print data acquired by the print data acquisition unit .","However, if the user has issued an instruction to execute a detailed print setting and if the detailed print setting has not been executed yet at this timing, the print data is reserved at the print data generation unit . Accordingly, the print data is not transmitted to the image forming apparatus  until the user executes the detailed print setting. After storing the print setting, a print setting storage unit  notifies the control unit  of the storage location.","When the notification of the storage location is received from a print data storage unit  and the print setting storage unit , the control unit  generates notification information B.  illustrates an example of the notification information B, which is expressed in the XML format. Referring to , an element <Item>  describes the storage location of the print data, and an element <Item>  describes the storage location of the print setting. The control unit  instructs a print job notification unit  to transmit the notification information B to the print control unit . The print job notification unit  transmits the notification information B to the print control unit .","The print job notification unit  is equivalent to a second transmission unit. In the above-described manner, the communication module A\u2032 , which is the former communication module, transfers the print data and the print setting to the communication module B , which is the latter communication module. In this manner, the inter-module communication is implemented.","The communication module B\u2032, which corresponds to the communication module B, is implemented on the image forming apparatus . As described above, the image forming apparatus  acquires print job notification from the print relay server  via the print server group . Further, the image forming apparatus  acquires the print data from the print data storage location described in the job notification information.","The function categorized in the print function category of the image forming apparatus  will be described in detail below. Referring to , the print control unit  includes the communication module B\u2032 . A print notification receiving unit  of the communication module B\u2032  receives notification information B or C, which is transmitted from the print job notification unit . The print notification receiving unit  is equivalent to a second acquisition unit. Because the communication module B\u2032  is used as a pair of modules with the communication module B , the print notification receiving unit  can interpret the notification information B and C.","The specification specified by the device vendor to provide the data communication between the relay virtual printer  or the print service  and the image forming apparatus  is equivalent to a second specification and is the specification that can be handled by the device vendor. The interfaces for the communication between the communication module B  and the communication module B\u2032  is generated in compliance with the second specification.","The print notification receiving unit  verifies the storage location of the print data described in the notification information B. and notifies the information to a print setting acquisition unit  and a print data acquisition unit . The print setting acquisition unit  acquires the print setting from the print setting storage unit  based on the notified print setting storage location. The print data acquisition unit  acquires the print data from the print data storage unit  and the print data storage unit  based on the notified print data storage location. The acquired print setting and the print data are transmitted to a job management unit  via the print notification receiving unit .","The job management unit  acquires the print data and the print setting information and instructs a print execution unit  to execute printing. After receiving the print instruction, the print execution unit  instructs the printing unit to generate a raster image based on the print setting and the print data and to print the generated raster image. In the above-described manner, the functions included in the print function category that for printing of the print data transmitted from the print server group  by the image forming apparatus according to an instruction transmitted to the print server group  for printing the contents generated by the web application server group .","Processing for registering the image forming apparatus  to the print relay server , for implementing the relay virtual printer  within the print relay server , and for registering the relay virtual printer  to the print service  will be described in detail below with reference to .","Referring to , in step S, the user selects a print service to be registered via the UI of the image forming apparatus  and inputs the user ID and the password. In step S, the print control unit  of the image forming apparatus  requests the relay virtual printer management service  to register the printer. In requesting the registration of the printer, the print control unit  transmits the above-described registration information to the relay virtual printer management service .","In step S, the relay virtual printer management service  implements the relay virtual printer  based on the registration information. In step S, the relay virtual printer  transmits the VPID to the relay virtual printer management service  in a reply as a success in generation of the relay virtual printer.","In step S, the relay virtual printer management service  transmits the user ID and the password to the print service  and to authenticate the user. If the user is normally authenticated by the print service , then in step S, the print service  notifies the relay virtual printer management service  that the user has been normally authenticated.","In step S, the relay virtual printer management service  requests the print service  to register the VPID as the printer (service printer) provided by the print service . In step S, after registering the VPID as the service printer, the print service  issues an SPID and transmits the SPID to the relay virtual printer management service .","In step S, the relay virtual printer management service  instructs the print service information storage unit  to store the SPID and notifies the relay virtual printer  that the setting has been completed. In step S, the relay virtual printer  accesses and connects to the communication module A  of the print service  based on the SPID and waits until the notification information A is transmitted.","In step S, the relay virtual printer management service  notifies the print control unit  that the registration of the printer has been completed. In step S, the print control unit  issues an instruction to display a message indicating that the image forming apparatus has been completely registered on the UI of the image forming apparatus . In step S, the print control unit  accesses and connects to the relay virtual printer  based on the VPID and waits until the notification information B is transmitted. The image forming apparatus is registered in the above-described manner.","Processing for printing the print data transmitted from the print server group  by the image forming apparatus according to an instruction transmitted to the print server group  for printing the contents generated by the web application server group  will be described in detail below with reference to  (including  and ).","Referring to , in step S, the web browser  requests the web application  to display the content that the user desires to edit. In step S, the web application  transmits a content screen corresponding to the requested content to the web browser .","In step S, when the user inputs a print instruction via the content screen, the web browser  requests a list screen of image forming apparatuses (service printers) registered to the print service .","In step S, the print service  transmits the list screen of service printers corresponding to the user who utilizes the web browser  to the web browser . In step S, when the user has selected the desired image forming apparatus from the list screen, the web browser  requests the print service  to transmit a print setting screen corresponding to the selected image forming apparatus.","In step S, the print service  transmits the print setting screen to the web browser . In step S, the web browser  transmits the print setting that has been input by the user via the print setting screen to the print service . In step S, the web browser  causes the web browser plug-in  to start processing for acquiring print information.","In step S, the print service  acquires the content whose printing has been instructed by the user from the web application  and converts the acquired content into print data based on the received print setting.","Further, the print service  combines the converted print data and the print setting and generates a print job based on the combined data and information about the data. Accordingly, the print job at least includes the print data and the print setting information.","A flow of print processing in steps S through S and in step S and beyond will be described in detail below with reference to the flow chart of . Referring to , in step S, the print service  notifies the relay virtual printer  that a job has been generated.","In step S, after receiving the notification from the print service , the control unit  of the relay virtual printer  acquires the RPID based on the SPID. In step S, the communication module B  makes an inquiry for a status of the image forming apparatus  thereto corresponding to the RPID. In step S, the print control software  of the image forming apparatus  transmits the status of the image forming apparatus  to the relay virtual printer .","In step S, the control unit  ends the processing if the image forming apparatus  is in a paper shortage state, a network disconnected state, or a power-off state. In these cases, the plug-in status receiving unit  stores information about the failed printing by using the SPID as a key. In addition, in response to the request from the web browser plug-in  in step S, the plug-in status receiving unit  transmits a message indicating that the printing has failed. The web browser plug-in  controls the web browser  to display a print failure message.  illustrates an example of a message to be displayed on the web browser  if printing has failed.","In step S, the print setting acquisition unit  requests the print service  to acquire the print setting. In step S, the print data acquisition unit  acquires the print data from the print service .","In step S, the control unit  determines whether the detailed print setting has already been executed by the user. If it is determined that the user has already instructed the detailed print setting (Yes in step S), then the processing advances to step S. In step S, the control unit  executes setting item verification processing. The setting item verification processing will be described in detail below.","In step S, the control unit  determines whether any additional setting item exists. If it is determined that any additional setting item exists (Yes in step S), then the processing advances to step S. In step S, the print data generation unit  temporarily reserves the print data acquired by the print data acquisition unit . In steps S and S, the control unit  monitors a detailed print setting to be set by the user.","On the other hand, if it is determined that no detailed print setting has been instructed (NO in step S) and after executing the processing in step S, in step S, the relay virtual printer  transmits the print job and instructs printing of the print job.","If the detailed print setting has been set by the user, the control unit  replaces the print setting information () received by the print setting acquisition unit  with the information illustrated in  based on the print setting set by the user via the detailed print setting screen. The print job illustrated in  can be converted into a format illustrated in . After the print setting information received from the print server  is rewritten according to the user instruction in the above-described manner, a new print job is transmitted to the image forming apparatus .","In the present exemplary embodiment, a new print job is generated by rewriting the print setting information. However, a new print job can be generated by rewriting the print data or the notification information. For example, a new print job is generated if it is necessary to change the layout of the print data or modify the method for converting the communication protocol.","Detailed print setting processing, which is executed by the web browser , the web browser plug-in , and the relay virtual printer  in step S and steps S through S will be described in detail below with reference to the flow chart of .","Referring to , in step S, the web browser plug-in  monitors a print instruction input by the web browser  to the print service . In step S, if the web browser plug-in  detects the print instruction input by the web browser  to the print service  (YES in step S), then in step S, the web browser plug-in  acquires the SPID and the print setting information from the print instruction (print request).","In step S, the web browser plug-in  transmits the SPID, the print setting information, and the plug-in setting information to the plug-in status receiving unit  of the relay virtual printer . In addition, the web browser plug-in  requests URL information about the detailed print setting screen. In step S, the control unit  executes setting item verification processing. The setting item verification processing will be described in detail below.","In step S, the control unit  determines whether any item to be set by the user during the setting item verification processing exists. If it is determined that any item to be set by the user during the setting item verification processing exists (Yes in step S), then the processing advances to step S. In step S, the control unit  determines whether the detailed print setting is to be set via the screen of the image forming apparatus by referring to the plug-in setting information.","If it is determined that the detailed print setting is to be set via the screen of the image forming apparatus (Yes in step S), then the processing advances to step S. In step S, the control unit  inquires the print service information management unit , via the control unit , as to whether the detailed print setting can be set via the screen of the image forming apparatus. The print service information management unit  refers to a table  illustrated in  to verify whether the detailed print setting can be set via the screen of the image forming apparatus. If it is determined that the detailed print setting can be set via the screen of the image forming apparatus (Yes in step S), then the processing illustrated in  ends because the detailed print setting is to be executed via the screen of the image forming apparatus.","In this case, the plug-in status receiving unit  transmits processing end information to the web browser plug-in . In step S, the plug-in status receiving unit  returns the URL of the detailed print setting screen to the web browser plug-in . The detailed print setting screen is generated based on information included in the table  in  or is provided by combining already provided screens together. The detailed print setting screen includes a print setting item that cannot be set by the print service .","In step S, the web browser plug-in  acquires the URL of the detailed print setting screen. In step S, the web browser plug-in  transmits a request for displaying the detailed print setting screen to the web browser . In step S, the web browser  requests the relay virtual printer  to transmit the setting screen having the URL of the above-described detailed print setting screen. In step S, the printer information presentation unit  transmits the detailed print setting screen.  illustrates an example of the detailed print setting screen.","Referring to , a common setting display field  is a display field for prompting the user to execute the print setting again if any conflict in the common setting item  arises. A required setting display field  is a display field for displaying a setting item that is required to be set when the printing is executed by the image forming apparatus. An image forming apparatus unique setting display field  displays the image forming apparatus unique setting item .","In step S, the web browser  displays the detailed print setting screen. After the user has executed the setting via the detailed print setting screen and pressed an OK button, the processing advances to step S. In step S, the web browser  transmits the detailed print setting information to the relay virtual printer . In step S, the control unit  of the relay virtual printer  acquires the detailed print setting information.","After acquiring all pieces of the detailed print setting information, the control unit  executes processing in step S. In other words, the relay virtual printer  overwrites the current print job to generate a new print job and transmits the new print job to the image forming apparatus .","The setting item verification processing in steps S and S will be described in detail below with reference to the flow chart of  (including  and ).","Referring to , in step S, the control unit  reads the print setting information. In step S, the control unit  verifies the common setting item  by referring to the print setting information ().","In step S, the control unit  analyzes whether any conflict exists in the print setting. In analyzing whether any conflict exists, the control unit  identifies the RPID based on the SPID and refers to a conflict table illustrated in , which is managed by the print service information management unit , to determine whether any conflict exists. In other words, conflict analysis is to determine whether any combination of the common setting items  that is not supported by the image forming apparatus exists.","The combination not supported by the image forming apparatus is different for different image forming apparatuses. In , it is illustrated that the setting of the letter size paper setting cannot be combined with the two-sided printing setting.","In step S, if the control unit  determines that any conflict exists (Yes in step S), then the processing advances to step S. In step S, the printer information presentation unit  generates the common setting display field . In step S, the control unit  sets a value \u201c1\u201d to the additional setting flag.","In step S, according to the plug-in setting information, the control unit  determines whether the image forming apparatus unique setting item  is to be set. If it is determined that the image forming apparatus unique setting item  is to be set (Yes in step S), then the processing advances to step S. In step S, the control unit  verifies whether any image forming apparatus unique setting item  exists.","In step S, the control unit  refers to the table managed by the print service information management unit  based on the RPID and verifies a finisher setting  and a paper feed setting  illustrated in .","In step S, if the control unit  determines that any image forming apparatus unique setting item  exists (Yes in step S), then the processing advances to step S. In step S, the printer information presentation unit  generates the image forming apparatus unique setting display field . In step S, the control unit  sets a value \u201c1\u201d to the additional setting flag.","In step S, the control unit  verifies whether any required setting item  exists. In step S, the control unit  refers to the table managed by the print service information management unit  via the control unit  and verifies whether any required setting item  exists.","In step S, the control unit  refers to a billing code  in  to determine whether any required setting item  exists. If it is determined that any required setting item  exists (Yes in step S), then the processing advances to step S. In step S, the printer information presentation unit  generates the required setting display field . In step S, the control unit  sets a value \u201c1\u201d to the additional setting flag. If the additional setting flag has the value \u201c1\u201d, it is indicated that the setting of the detailed print setting is required.","According to the value set to the above-described flag, items to be displayed on the detailed print setting screen vary. For example, in the above-described case, only the detailed print setting that cannot be set via the print setting screen provided by the print server  can be set via the detailed print setting screen. In another example, both the detailed print setting that cannot be set via the print setting screen provided by the print server  and the print setting that can be set via the print setting screen provided by the print server  can be set via the detailed print setting screen.","In step S, the relay virtual printer  notifies the print control unit  that the job has been generated. In step S, the print control unit  requests the relay virtual printer  to acquire the print setting.","In step S, the print control unit  acquires the print setting from the relay virtual printer . In step S, the print control unit  requests the relay virtual printer  to acquire the print data.","In step S, the print control unit  acquires the print data from the relay virtual printer . In step S, the print control unit  draws a raster image based on the acquired print setting and print data and controls the image forming apparatus  to print the raster image.","With the above-described configuration, the present exemplary embodiment can implement the printing that utilizes the functions of the image forming apparatus  even if the functions of the print server  differ from the functions of the image forming apparatus . In particular, in the present invention, it is assumed that the vendor of the print server and the vendor of the image forming apparatus  differ from each other. More specifically, the present invention having the above-described configuration can absorb any functional inferiority of the print server within the print relay system. Accordingly, the user can sufficiently utilize the functions of the image forming apparatus .","In the cases supposed in the present invention, the user cannot execute print settings for sufficiently utilizing the functions of the image forming apparatus  via the print setting screen provided by the print server because the vendor that provides the print server may not have sufficiently understood the configuration applied to the image forming apparatus . With the above-described configuration, the present invention can allow the vender of the web service that develops a method for providing a print service and the device vendor of the image forming apparatus  to respectively perform the divided labor of developing or designing the service or the device.","According to another aspect of the present invention, the present invention can allow the user to sufficiently utilize the functions of the image forming apparatus  without requiring the print server to change the specification thereof.","In the first exemplary embodiment described above, the print server  generates the print setting screen by using the element <Capabilities> described in the XML format. However, any other format can be used for describing the element <Capabilities>. For example, the print server  can acquire the element <Capabilities> expressed in the JSON format () from the image forming apparatus .","Further, in the first exemplary embodiment, the client computer  transmits the print setting expressed in the XML format to the print server . However, the print setting can be expressed in any other format. For example, the client computer  can transmit a print setting expressed in the JSON format () to the print server .","Furthermore, in the first exemplary embodiment, the notification information A and the notification information B are generated in the same format (the XML format). However, the notification information A and B can be generated in different formats. For example, the notification information A can be expressed in the JSON format (). In the example illustrated in , the storage location of the print data is described in an element <dataUrl>  while the storage location of the print setting is described in an element <settingUrl> .","The formats of the notification information A and the notification information B can be selected vice versa. For example, the notification information A can be expressed in the XML format while the notification information B can be expressed in the JSON format illustrated in . In the example illustrated in , the storage location of the print data is described in an element <dataUrl>  while the storage location of the print setting is described in an element <settingUrl> .","Program codes, which are installed to a computer and configured to implement the functional processing of the present invention with the computer, can also implement the present invention. To paraphrase this, the present invention also includes the computer program configured to implement the functional processing of the present invention. Accordingly, the program can be configured in any form, such as object code, a program executed by an interpreter, and script data supplied to an operating system (OS).","Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or a micro processing unit (MPU)) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment (s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).","While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications, equivalent structures, and functions.","This application claims priority from Japanese Patent Application No. 2010-256316 filed Nov. 16, 2010, which is hereby incorporated by reference herein in its entirety."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate exemplary embodiments, features, and aspects of the invention and, together with the description, serve to explain the principles of the present invention.",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 8A","FIG. 8B","FIG. 8C","FIG. 8D","FIG. 8E"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 9A","FIG. 9B"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 10A","FIG. 10B","FIG. 10C","FIG. 10D","FIG. 10E"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 11A","FIG. 11B","FIG. 11C","FIG. 11D"],"b":"11"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 15","FIG. 15A","FIG. 15B"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 18","FIG. 18A","FIG. 18B"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 19A","FIG. 19B","FIG. 19C"]}]},"DETDESC":[{},{}]}
