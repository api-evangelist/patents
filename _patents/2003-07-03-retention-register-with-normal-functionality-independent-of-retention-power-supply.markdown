---
title: Retention register with normal functionality independent of retention power supply
abstract: State retention registers for use in low-power standby modes of digital IC operation are provided, wherein: a differential circuit (M–M; M–M) is used to load the shadow latch from the normal functional latch; the signal (REST, RESTZ) used to restore data from the shadow latch to the normal functional latch is a “don't care” signal while the shadow latch is retaining the data during low-power standby mode; retained data from the shadow latch is restored to the normal functional latch via a transistor gate connected to anode (N) of the shadow latch where the retained data is provided; a power supply (VDD) other than the shadow latch's power supply (VRETAIN) powers the data restore operation; and the normal functional latch is operable independently of the operational states of the high Vtransistors (M, M, M and M; M, M, M and M) used to implement the state retention functionality. In addition, an isolation apparatus is provided to retain an output of a logic module while the logic module is powered-down.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06989702&OS=06989702&RS=06989702
owner: Texas Instruments Incorporated
number: 06989702
owner_city: Dallas
owner_country: US
publication_date: 20030703
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims the priority under 35 U.S.C. 119(e)1 of now abandoned U.S. Provisional Application Nos. 60\/395,123 filed on Jul. 11, 2002, 60\/405,902 filed on Aug. 26, 2002, 60\/437,079 filed Dec. 30, 2002, and 60\/437,061 filed on Dec. 30, 2002, all of which are incorporated herein by reference.","The invention relates generally to digital integrated circuits and, more particularly, to reducing leakage current in power-saving standby modes of digital integrated circuit operation.","The demand for higher clock-rates and lower power supply voltages in digital integrated circuits such as CMOS circuits results in rapidly increasing levels of standby leakage current (i.e., the current consumed by a CMOS circuit when the clock is not active). As an example, multi-million gate I.C.s operating in the Gigahertz region with supply voltages below 1.5V can have standby leakage of 100 mA or higher. This level of leakage current represents a significant problem for portable (battery operated) applications. This problem is conventionally addressed by introducing products that feature state-retentive, low-leakage standby modes.","Most conventional state retention schemes collapse the power supplies partially or entirely while maintaining the state of all the register elements. Upon restoration of the power, all circuit nodes return to their previous state since all nodes can be derived directly from the state of the register elements.","In conventional power-down applications, power supply to circuits can be turned off in order to reduce the standby power consumption. The state retention flip-flops that store the status of operation of the circuit need to store the data in latches with low leakage current during power-down phase. The retention latch (called a shadow latch hence forth) is formed with thick-oxide (low leakage) transistors and is powered by a separate permanent power supply to retain data in power-down or retention mode. Some disadvantages of such a scheme are: the additional circuitry required for such a shadow latch implementation is magnified at chip level when a large number of retention flip-flops are required; generation of additional control signals required to drive the flip-flop in and out of retention mode not only increase the flip-flop area, but also pose routing problems at block level; and additional shadow latch and control circuitry can load the speed-critical path of the flip-flop worsening the propagation delay of the flip-flop.","As mentioned above, some conventional approaches use retention registers (including shadow latches) to retain state while lowering the device leakage. One such scheme has two supplies, a permanent supply for retention and a virtual supply for conventional logic power. Low V(leaky) devices are powered by the virtual supply, while High-V(low leakage) devices are used for retention and powered from the permanent supply. This architecture has limitations. Both supplies must be present for normal operation. This introduces a physical design overhead of routing an additional power rail to all the registers. Also, minimum operating voltage is limited by the High-Vdevices, effectively prohibiting conventional Vbox-min testing.","It is desirable in view of the foregoing to provide state retention registers which avoid the aforementioned disadvantages of conventional approaches. The various disadvantages of the conventional approaches can be avoided by various exemplary embodiments of the present invention, wherein: a differential circuit is used to load the shadow latch from the normal functional latch; the signal used to restore data from the shadow latch to the normal functional latch is a \u201cdon't care\u201d signal while the shadow latch is retaining the data during low-power standby mode; retained data from the shadow latch is restored to the normal functional latch via a transistor gate connected to a node of the shadow latch where the retained data is provided; a power supply other than the shadow latch's power supply powers the data restore operation; and the normal functional latch is operable independently of the operational states of the high Vtransistors used to implement the state retention functionality. In addition, an isolation apparatus is provided to retain an output of a logic module while the logic module is powered-down.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 1","FIG. 1"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 2","FIG. 2","FIG. 1","FIG. 1","FIG. 2","FIG. 2"],"b":["10","11"]},"The complementary clock signals CLK and CLKZ are used in conventional fashion to operate the normal functional flip-flop circuitry. A save signal SAVE and restore signal REST (and its inverse RESTZ) are used to transition the  flip-flop between active and state retention modes of operation. During the active mode of operation (i.e., the normal functional flip-flop operation), the SAVE and REST signals are maintained at a logic zero level.","Prior to disconnecting VDD from VCC (see also ), the data stored in the normal functional flip-flop circuit must be saved into the shadow latch. To accomplish this, the SAVE signal is strobed high, thereby activating a differential pull-down network at M, M and M. The pull-down network includes a pair of legs respectively connected to the complementary storage nodes at the input and output of the inverter  of the slave latch of the normal functional flip-flop. Depending on the logic state of the normal functional flip-flop, one of the legs of the differential pull-down network is activated to save the data into the shadow latch. The pull-down network can be designed to fight off the weak thick-oxide PMOS transistors of the shadow latch. In some embodiments, the transistors at M, M and M, and the transistors of the shadow latch are sized in order to ensure that the contents of the normal functional flip-flop are written into the shadow latch at the worst case process corner scenario. In the worst case scenario, the NMOS transistors M and M in the weak process corner need to fight off the associated PMOS transistors of the shadow latch in the strong process corner. The flip-flop of  can be made even more robust and reliable in some embodiments by designing for the aforementioned worst case process corner scenario at low temperature and low power supply voltage.","After the SAVE signal has been strobed and the data from the normal functional flip-flop has been stored into the shadow latch, the  flip-flop is ready to go into retention mode. The header switch of  is used to cut off VDD from VCC, so all nodes in the logic module that are powered by VDD decay to almost zero volts. However, the shadow latch is still powered by the separate power supply VRETAIN, so the data is retained in the shadow latch. In order to reduce the leakage current while the shadow latch is retaining data with the normal functional flip-flop circuitry powered-down, the shadow latch data storage nodes N and N should be isolated from the powered-down circuitry. This is accomplished by thick oxide transistors M, M, M and M. The transistor stack at M\u2013M switchably connects the state retention storage node N to the node N of the normal functional flip-flop. The use of this transistor stack arrangement rather than, for example, a pass gate arrangement between node N and node N, permits the storage node N to be connected to the gates of transistors M and M, rather than having the storage node N connected to the sources (or drains) of a pass gate arrangement. Connection of node N to the gates of thick oxide transistors M and M advantageously reduces the possibility of current leakage from the shadow latch.","The complementary signals REST and RESTZ are used to restore the data from the shadow latch to the normal functional flip-flop. As VDD is re-connected to VCC (see also ), the signal REST is driven to a logic 1 voltage. This activates thin oxide transistors M and M to power the inverter at M\u2013M, which creates a read-back path from the shadow latch to the slave latch of the normal functional flip-flop for restoring the retained data. Also, when the signal REST is driven to a logic 1 voltage, the thin oxide transistors at M and M disable the feedback path of the slave latch of the normal functional flip-flop. Upon re-connection of VDD to VCC, only the shadow latch drives node N, via the inverter at M\u2013M. This ensures that the node N is restored to the voltage that was present there prior to disconnecting VDD from VCC. After the shadow latch has driven node N to its previous voltage, VDD is re-connected to VCC, after which the REST signal is returned to logic zero. At this point, the shadow latch is isolated from the normal functional flip-flop portion of , which is now ready to resume its normal functional DQ flip-flop operation.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIG. 3","FIG. 3","FIG. 2","FIG. 2","FIG. 3","FIG. 2"],"b":["4","7","8","5","4","6","7","4","7"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 8","FIG. 8","FIGS. 9 and 10","FIGS. 2 and 3","FIGS. 2 and 3","FIG. 8","FIG. 2","FIG. 8","FIG. 2","FIGS. 1 and 2","FIG. 8","FIG. 2","FIG. 8","FIG. 2"],"b":["1","2","10","11","10","11"]},"As in , prior to disconnecting VDD from VCC (see also ), the data stored in the normal functional flip-flop circuit must be saved into the shadow latch. To accomplish this, the SAVE signal is strobed high, thereby activating a differential pull-down network which includes transistors M, M, M and M. The pull-down network includes a pair of legs respectively connected to the complementary storage nodes at the input and output of the inverter  of the slave latch of the normal functional flip-flop. Depending on the logic state of the normal functional flip-flop, one of the legs of the differential pull-down network is activated in response to the SAVE signal, in order to save the data from the normal functional flip-flop into the shadow latch. The pull-down network can be designed to fight off the weak thick-oxide PMOS transistors of the shadow latch. In some embodiments, the transistors M\u2013M and the transistors of the shadow latch are sized in order to ensure that the contents of the normal functional flip-flop are written into the shadow latch at the worst case process corner scenario. In the worst case scenario, the NMOS transistors M and M in the weak process corner need to fight off the PMOS transistors of the shadow latch in the strong process corner. The flip-flop of  can be made even more robust and reliable in some embodiments by designing for the worst case process corner scenario at low temperature and low power supply voltage.","After the SAVE signal has been strobed and the data from the normal functional flip-flop has been stored into the shadow latch, the  flip-flop is ready to go into retention mode. The header switch of  is used to cutoff VDD from VCC, so all modes in the logic module that are powered by VDD decay to almost 0 volts. However, the shadow latch is still powered by the separate power supply VRETAIN (not explicitly shown in ), so the data is retained in the shadow latch. In order to reduce the leakage current while the shadow latch is retaining data with the normal functional flip-flop circuitry powered-down, the shadow latch data storage nodes N and N should be isolated from the powered-down circuitry. This is accomplished by thick oxide transistors M, M, M and M. The transistors M, M, M and M form a differential pull-down structure which permits restoration of the data stored at nodes N and N to nodes N and N, respectively. The use of this pull-down network rather than, for example, a pass gate arrangement between the nodes that N, N and the nodes at N, N, permits the storage nodes at N and N to be connected to the gates of transistors M and M, rather than having the storage nodes N and N connected to the sources (or drains) of a pass gate arrangement. Connection of nodes N and N to the gates of the thick oxide transistors M and M, respectively, advantageously reduces the possibility of current leakage from the shadow latch.","The REST signal is used to restore the data from the shadow latch to the normal functional flip-flop. Before VDD is re-connected to VCC (see also ), the signal REST is driven to a logic 1 voltage. This activates the pull-down network at M\u2013M, and transistors M and M provide positive feedback to latch the data that has been retained in the shadow latch. This creates a read-back path from the shadow latch to the slave latch of the normal functional flip-flop for restoring the retained data. Also, when the signal REST is driven to a logic 1 voltage, the thin oxide transistor at M disables the feedback path of the slave latch of the normal functional flip-flop. Upon re-connection of VDD to VCC, only the shadow latch drives the nodes N and N. This ensures that the nodes N and N are restored to the respective voltages that were present there prior to disconnecting VDD from VCC. After the shadow latch has driven the nodes N and N to their previous voltages, VDD is re-connected to VCC, after which the REST signal is returned to logic 0. At this point, the shadow latch is isolated from the normal functional flip-flop portion of , which is now ready to resume its normal functional DQ flip-flop operation.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 9","FIG. 9","FIGS. 2 and 8","FIG. 9","FIG. 8","FIG. 9"],"b":["2","3","1","4","5","10","91"]},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 10","FIG. 10","FIG. 10","FIG. 8","FIG. 10","FIG. 8"],"b":["3","3","9","8","1","4","9","8","7","9","9","3","8","8","7","2","4","1","2","9","3","3"]},"In some exemplary embodiments, the transistors M and M each can have a 0.2 um width and a 0.4 um length. The flip-flop of  also includes the transistor  described above with respect to , so that activation of the REST signal disables the feedback path of the master latch.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 4","FIG. 4"],"b":["41","42","43","42","43","41","44","43"]},"The data processing apparatus  includes a plurality of logic modules that include logic for performing data processing operations, and state retention registers for storing data associated with the data processing operations. These registers are constructed from corresponding pluralities of state retention flip-flops, for example the state retention flip-flops illustrated in ,  and \u2013. The data processing apparatus  further includes a power state controller  which, in some embodiments, utilizes state machines to provide appropriate control signals to the header switches and logic modules. As shown in , the power state controller provides control signals UP\/DN to the respective header switches, and provides control signals REST, RETZ (described hereinbelow) and SAVE for distribution to each of the logic modules. The power state controller  activates these control signals appropriately to implement the exemplary operations described above with respect to ,  and \u2013.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":["FIG. 5","FIG. 5","FIG. 4"],"b":"45"},"In some embodiments, high level control logic  orders the power state controller  to implement the low-power standby (state retention) mode of operation, whereupon the power state controller  can perform the exemplary signalling described above to implement the standby mode and then report this back to the high level control logic . The logic  and controller  can be powered by VRETAIN in some embodiments.","The wireless communication apparatus of  can be, for example, a cellular or other mobile telephone, a laptop computer, a personal digital assistant, etc. In some embodiments, the data processing apparatus  is provided as a single integrated circuit such as a microprocessor, microcontroller or digital signal processor.","Referring again to FIGS.  and \u2013, the SAVE signal must be guaranteed to be low during state retention. In some embodiments, SAVE is distributed using a buffer tree powered by the retention supply VRETAIN (also referred to herein as VRET). In these embodiments, the buffer tree that distributes SAVE to the state retention circuitry of a given logic module includes a plurality of buffer cells buried in a region of the integrated circuit where the associated logic module is located. These buffer cells are interconnected appropriately to route SAVE to the state retention circuitry. In some embodiments, each buffer cell is located directly under un-switched VDD metal, that is, a metal layer connected to VRET. Each buffer cell is connected to the un-switched VDD metal by a vertical stack of all metal and via layers. An example of this arrangement is illustrated generally in .","Referring now to , an exemplary buffer cell includes thick-oxide transistors  and  interconnected at  and  to form an inverter. A metal layer MET connected to the retention voltage VRET is also connected to the transistor  (e.g., a PMOS transistor) by a vertical stack of all metal and via layers illustrated generally at . The vertical stack at  extends between the metal layer MET and a further metal layer MET. The metal layer MET provides connectivity to the gates, sources and drains of the transistors  and . The vertical stack at  connects VRET to the transistor . The N-well  that contains the transistor  is electrically isolated from adjacent cells as illustrated generally at . In the arrangement of , the N-well  observes a 570 nm spacing rule relative to the N-wells in adjacent buffer cells.","In , the vertical stack  is routing track-centered on horizontal track . Further optimization of the horizontal alignment of vertically adjacent buffer cells is used in some embodiments to prevent long-run jogging in the routes of metal layers between layers MET and MET. In some embodiments, minimum area rules with respect to the metal in the metal layers are observed in a manner that does not block more than one track in the preferred routing direction. This can reduce the impact of the vertical stack  on routability.","The buffer cell arrangement illustrated in  permits the SAVE signal and the RETZ signal (described hereinbelow) to be distributed throughout a given logic module by a buffer tree which has the same general structure as illustrated in , but which is powered by the retention power supply VRET.","Some embodiments use a VDD-powered buffer tree to distribute SAVE (and\/or RETZ). In such embodiments, because VDD is removed from the logic module during state retention, only a single inverter can be placed between the power state controller  (see ) and the state retention circuitry of the logic module. This is illustrated generally in . The power state controller  produces SAVE\u2032 or RET (respective inverses of SAVE and RETZ) for the  arrangement. If the signal SAVE\u2032 (or RET) is high, the SAVE (or RETZ) signal will remain low (as desired), even while the inverters of  are not receiving power.","The exemplary embodiments described above provide numerous advantages, some examples of which follow. Only 8 of the larger thick oxide transistors are needed for each state retention flip-flop: four transistors in the shadow latch; two transistors for writing to the shadow latch; and two transistors for reading the shadow latch. Only 2 thick oxide PMOS transistors are contained in separate N-wells, namely the PMOS transistors of the shadow latch inverters (see also FIGS.  and \u2013). Current leakage during state retention is reduced, because only thick oxide (low leakage) transistors remain biased during state retention.","The REST signal can be undefined during the state retention mode. This advantageously permits use of a fully active buffer tree (powered by VDD) to distribute the REST signal to the state retention registers, as illustrated generally in . The REST signal can therefore propagate very quickly (for example in a few nanoseconds) when VDD is re-connected to VCC, so the data from the shadow latch can be restored into the normal functional flip-flop very quickly, for example in around 100 nanoseconds. With a restoration time in the 100 nanoseconds range, a logic module can be placed into the low-power state retention mode at any time, because the restoration operation happens quickly enough to be undetectable by system software or hardware. Thus, the state retention mode is transparent to the data processing system.","Transistors M and M of , and transistors M\u2013M of  do not draw switching current from the VRETAIN power supply during state retention or during the transition from state retention to normal operation. This advantageously permits the VRETAIN power supply voltage to be routed as a conventional logic signal (e.g., to be routed to many registers in parallel as shown in ), thus eliminating the need for a conventional power grid to distribute VRETAIN. If routed as a logic signal, the VRETAIN power supply can collapse when the SAVE signal is asserted, but sufficient time can be allowed for VRETAIN to return to its DC level before the SAVE signal is de-asserted. Although this increases the time required to perform a state save operation, the state save operation does not limit the system response time.","All of the thick oxide (high V, low leakage) transistors of ,  and \u2013 can be inoperable (i.e., at any level of conductance\/resistance) without affecting the normal operation of the normal functional flip-flop. This advantageously permits conventional Vbox-min testing at low Vlevels, even though operation of the high Vtransistors is unpredictable at such low Vlevels.","Referring again to , in some applications, it may be desirable to power-down one or more of the logic modules independently of the remaining logic modules, in order to reduce current consumption. In these situations, the output signal voltages of the powered-down logic module(s) should be maintained in order to ensure that any powered-up logic module that is driven by an output signal of a powered-down logic module will not be affected by the powering-down of the driving logic module(s).",{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 11","FIG. 11","FIG. 11"],"sub":["A","B ","C","A"]},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 12","FIG. 11","FIG. 12","FIGS. 2","FIGS. 2","FIG. 12","FIGS. 2","FIG. 12","FIGS. 8\u201310","FIG. 12","FIGS. 2"],"b":["1","2","3","8","10","3","8","10","3","8","10","1","2","5","6","3","4","7","5","6","121","121","1","2","1","2","3","8","10","12","14"],"sub":"A "},"The output node  of the shadow latch drives the input of an inverting driver stage M\u2013M. In particular, transistors M and M form an inverter between node  and the OUT node. The transistors M and M provide the capability of selectively disabling the inverter M, M by disconnecting it from its power supply inputs, namely VRET and ground. All of the transistors M\u2013M are thick oxide transistors.","During normal, powered-up operation of the logic module A, the signal RET is low and the, complementary signal RETZ is high. Under these conditions, the parallel combination of transistors M and M, together with transistor M, provide a connection between the second stage inverter MS, M and its power supply inputs, namely VDDand ground. During retention mode, when RET is high and RETZ is low to disable the second stage inverter, there may be some leakage through transistor M. In order to reduce the impact of such leakage, the width-to-length (W\/L) ratio of transistor M can be selected to be relatively small, for example, in a range from about 3 to about 10. Conversely, because leakage during retention mode is not a problem with respect to the thick oxide transistor M (or M), the width-to-length ratio of M (and M) can be relatively large. for example in a range from about 30 to over 100, in order to increase speed.","Transistor M has a lower Vthan does transistor M, thereby permitting normal operation of the arrangement of , even when VDDis very low, for example, as low as 0.7 volts. Thus, the arrangement of  can be subjected to Vbox-min testing at low Vlevels, even though operation of the high Vtransistor M is unpredictable at low Vlevels.","After the data signal defined at IN and INZ is latched into the shadow latch at  by strobing the SAVE signal high, the signal RETZ is taken low, in order to invoke the retention mode of operation. The strobing of SAVE also latches the data signal into an internal shadow latch within logic module A, for example, the shadow latch of one of the state retention flip-flops described above relative to ,  and \u2013. With RETZ low and its complement RET high, the second stage inverter M, M is disabled, and the output inverter driver M, M is enabled, thereby providing the contents of the shadow latch at  to an input of another powered-up logic module, such as module B or module C of .","After the data signal from the logic module A is restored at node IN (by operation of the restore signal REST in the corresponding state retention flip-flop of module A), then the signal RETZ can be taken high again, thereby disabling the inverter M, M and enabling the inverter M, M to re-institute normal output operation of module A.",{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIG. 13","FIG. 4","FIG. 12","FIGS. 2\u201310","FIG. 13","FIG. 5","FIG. 7","FIG. 4"],"b":["45","45"],"sub":"A "},"Although exemplary embodiments of the invention are described above in detail, this does not limit the scope of the invention, which can be practiced in a variety of embodiments."],"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","DETAILED DESCRIPTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIGS. 6","b":["6","7"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 13","FIG. 4"]}]},"DETDESC":[{},{}]}
