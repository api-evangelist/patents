---
title: Method and apparatus for semantic processing engine
abstract: A method for evaluating contents of a message is provided. The method initiates with characterizing a message segment. Then, the message is scanned to define tokens associated with the message segment. Next, the tokens are parsed to define substructures. Then, the rules associated with the tokens are determined, wherein the rules define actions. At the same time determining the session or meta session associated with the communication. Then, the actions associated with the message are executed. Next, the message is queued to be sent out. A method for providing content based security, a computer readable media, an adapter card and a network device configured to provide content based security and an intrusion protection system are provided.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07548848&OS=07548848&RS=07548848
owner: Xambala, Inc.
number: 07548848
owner_city: San Jose
owner_country: US
publication_date: 20040107
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["This application claims priority from U.S. Provisional Patent Application No. 60\/438,931 filed Jan. 8, 2003 and entitled \u201cMethod and Apparatus for Semantic Processing Engine.\u201d This provisional application is herein incorporated by reference in its entirety for all purposes.","1. Field of the Invention","This invention relates generally to content and context based analysis of messages and documents in the area network security infrastructure and web services, more specifically to microprocessors configured to provide security through content based evaluation of incoming messages for packet based networks.","2. Description of the Related Art","Network bandwidth has dramatically increased to support the gigabit speeds enabling the enterprise systems and high volume electronic commerce (e-commerce) sites associated with the advent of the Internet. However, security systems configured to protect these networks from internal or external attacks have not developed in either sophistication or speed to provide adequate protection.","Intrusion detection systems (IDS) for high bandwidth packet based networks provide security by analyzing the wrapper or header of a message. However, a move is underway to provide security by looking at the actual content of the message rather than looking at the network layer header information or through encryption for packet based networks. Accordingly, devices in the middle of the network must understand the content of a message in the context of a sequence of message transactions to provide adequate security from hackers or insiders.  is a simplified schematic diagram of the security infrastructure for an enterprise system. External client  communicates with server  through distributed network , such as the Internet. Access to network  may be provided by an Internet service provider (ISP). Server side  includes middle devices such as, firewall , router  and switch . Switch  is in communication with server . Server  has access to database . Alternatively, the data path may proceed through IDS  through switch . It should be appreciated that it is desired to protect server  from internal clients, such as client , which may be used to hack into the server. Currently, there are not many available protections from internal clients. One skilled in the art will appreciate that the architecture of the security infrastructure can vary, however, each of the architectures employ some type of IDS for security, i.e., some type of architecture incorporating the middle devices described above.","One of the shortcomings with the intrusion detection systems typically employed to provide security for gigabit speed networks is that the IDS works at the packet level only and can not handle the Internet Protocol (TCP\/IP) traffic fast enough to provide adequate protection as the network speed increases. As the intrusion detection system reaches its maximum processing capacity, a large number of packets are dropped. Consequently, the possibility of missing attacks significantly increases due to the dropped packets. Additionally, current intrusion detection systems may be overwhelmed by hacker tools that generate numerous suspicious events so that a hacker may sneak through the system. These tools can also cause the IDS to completely break down. Furthermore, when looking at the packet by packet information, only pieces of a message are being looked at. Thus, the pieces may get through the IDS separately and then be reassembled downstream to execute an unwanted intrusion. Firewalls do not cure the deficiencies of the IDS, because packets such as web traffic, i.e., traffic transferred via hypertext transfer protocol (HTTP), are generally allowed to pass through the firewall. Enterprise networks are actually being configured to include IDS's, without addressing any of the deficiencies.","Another shortcoming of the intrusion detection systems is that they analyze the encapsulation of the transmitted data, e.g., packet headers for packet based protocols, to detect attack signatures. Providing security through detection of the attack signatures leaves the system vulnerable to newly developed attack signatures constantly being thrown at networks by hackers. Thus, the content of the packet is unknown to the IDS. Additionally, systems based on regular expression searches, that are typically performed on level 7 (L7) string signatures, have limited capabilities with respect to content based evaluation for the IDS. Because of the limitations of regular expression searches many false positives are generated. For example, instructions for finding a .exe file in a GET request will generate matches for .exel files, exempt files, and .exe in parameters or comments of files. Even as the regular expression is refined further to handle the .exe files false positives still occur and real intrusions become buried among a large number of incorrect alerts that can be used purposely by a hacker to create and leverage security holes. Moreover, as the number of regular expression rules increase the memory requirements significantly expand, e.g., for 500,000 regular expression rules more than 1 gigabyte of memory may be required. Furthermore, if one of the rules changes the entire gigabyte + of memory for the regular expression rules must be rewritten, which requires that the system be brought down for some period of time. Furthermore, the processors supporting the IDS's can not analyze the grammar and contextual information or handle state information which has to be maintained across sessions that is required to create robust content based security devices. In short, current processors are unable to handle the in-line processing demands posed by content based security systems.",{"@attributes":{"id":"p-0010","num":"0009"},"figref":["FIG. 2","FIG. 2"],"b":["130","132","134","136","132","134","136","134"]},"Web services (and resource virtualization) are increasingly taking over the computing paradigm and enterprise application with the advent of such architectures as MICROSOFT.NET, grid computing, and peer-to-peer networking. Each of these stress the processing resources of the network infrastructure as they require devices in the network to understand the content of messages and documents embedded within them. Use of XML and meta-data allow for efficient routing to appropriate servers as well as correct visualization by a client based on interpreting the message content.","As a result, there is a need to solve the problems of the prior art to provide a method and apparatus that allows for the evaluation of the content of a message based on the grammar that generated the message, and which will be used by the server to understand the message, and simultaneously minimizes the false positives generated by current systems. In addition, a processor or processing device configured to support a content based security system is needed.","Broadly speaking, the present invention fills these needs by providing a intrusion prevention system configured to provide content based security in an efficient manner for high speed networks. It should be appreciated that the present invention can be implemented in numerous ways, including as a method, a system, computer readable media or a device. Several inventive embodiments of the present invention are described below.","In one embodiment, a method for evaluating contents of a message is provided. The method initiates with characterizing a message segment. Then, the message is scanned to define tokens associated with the message segment. Next, the tokens are parsed to define substructures. Then, the rules associated with the tokens are determined, wherein the rules define actions. At the same time determining the session or meta session associated with the communication. Then, the actions associated with the message are executed. Next, the message is queued to be sent out.","In another embodiment, a method for performing semantic operations with contents of a message is provided. The method initiates with receiving a message. Then, a grammar associated with the message is identified. Next, the message is converted into a token stream. Then, a parse tree defined by tokens of the token stream is created. Next, rules associated with the tokens are identified. Meta sessions may be used here to relate different messages. Next, actions defined by the rules are executed. Then, the message is forwarded to a destination.","In yet another embodiment, a computer readable media having program instructions for evaluating the contents of a message is provided. The computer readable media includes program instructions for characterizing a message segment. Program instructions for scanning the message segment to define tokens associated with the message segment and program instructions for parsing the tokens to define substructures are included. Program instructions for determining rules associated with the tokens, wherein the rules define actions are provided. Program instructions for executing the actions associated with the message and program instructions for queuing the message to be sent out are included.","In still yet another embodiment, a processor configured to identify message contents is provided. The processor includes a message characterization engine configured to characterize a message through analysis of header information associated with the message. A semantic processing engine configured to translate the message into tokens associated with segments of the message is included. The semantic processing block identifies rules associated with each of the tokens and the semantic processing block is configured to apply the identified rules to the message. A queuing engine configured to queue the message to be transmitted from the processor is included.","In another embodiment, a processor configured to perform semantic operations on high speed traffic is provided. The processor includes a characterization block configured to determine a grammar associated with a message. A parsing block configured to parse the message into tokens, wherein the tokens are associated with segments of the message is provided. A state and rule block configured to maintain states across sessions and apply a set of rules associated with each of the tokens to each of the segments of the message is included. A queuing block configured to queue the message for transmission to a destination is provided.","In yet another embodiment, an adapter card for providing intrusion prevention for a network is provided. The adapter card includes a semantic processing unit (SPU) configured to provide content based security for communications through a packet based network. The SPU includes a message characterization engine configured to characterize a message through analysis of header information associated with the message. A semantic processing engine configured to parse the message into tokens associated with segments of the message through grammar based parsing is included in the SPU. The semantic processing block identifies rules associated with each of the tokens. The semantic processing block is configured to apply the identified rules to the message. A queuing engine configured to queue the message to be transmitted from the SPU is provided.","In still yet another embodiment, a network device configured to provide content based security is provided. The network device includes circuitry for scanning a message to define tokens associated with the message. Circuitry for extracting substructures from the tokens and circuitry for identifying rules associated with the tokens are included. Circuitry for executing the identified rules is included.","In another embodiment, an intrusion prevention system configured to provide a secure network environment is provided. The intrusion prevention system includes a security monitor central processing unit (CPU). A semantic processing unit (SPU) being managed by the security monitor CPU is included. The SPU is configured to provide content based security for communications through a packet based network. The SPU includes a message characterization engine configured to characterize a message through analysis of header information associated with the message. A semantic processing engine configured to parse the message into tokens associated with segments of the message through grammar based parsing is included in the SPU. The semantic processing block identifies rules associated with each of the tokens. The semantic processing block is configured to apply the identified rules to the message. A queuing engine configured to queue the message to be transmitted from the SPU is included in the SPU.","Other aspects and advantages of the invention will become apparent from the following detailed description, taken in conjunction with the accompanying drawings, illustrating by way of example the principles of the invention.","An invention is described for a system, apparatus and method for performing semantic processing to provide security and implement web services based upon message content. It will be obvious, however, to one skilled in the art, that the present invention may be practiced without some or all of these specific details. In other instances, well known process operations have not been described in detail in order not to unnecessarily obscure the present invention.  are described in the \u201cBackground of the Invention\u201d section.","The embodiments described herein provide a method and system that employs a programmable processor configured to perform semantic operations on high speed network traffic. The programmable processor, referred to as a semantic processing unit (SPU), is designed to work in conjunction with general purpose central processing units (CPUs) and network processing units (NPUs), TCP offload engines, (TOE), Secure sockets layer (SSL) accelerators, etc., through standard interfaces. In one embodiment, the programmable processor accelerates the processing of parameters for application-to-application communication, storage and data center solutions, in addition to the security applications discussed herein. Rather than parse and process fixed size integer fields in the headers of packets, as performed by existing packet processing devices, the semantic processing engine referred to herein parses and processes the actual message of the packet in order to understand the meanings associated with the message. Thus, the processing engine is configured to accommodate the variable size message fields in the character fields as opposed to fixed size integers. The ability to understand the meaning of the messages associated with packet based networks allows for a more powerful Intrusion Detection System (IDS,) referred to herein as an Intrusion Prevention System (IPS).",{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 3","b":["140","142","144"]},"Semantic processing as used herein may be defined with reference to the following example. If an individual accesses a web site for a newspaper through the Internet and wishes to access a restricted section of the website, e.g., a paid subscription is required for access to the restricted section, then the following exemplary hypertext transfer protocol (HTTP) message is transmitted on the network pipe:","Get \/ restrictedaccessnews.html HTTP\/1.1","Host: online.newspaper.com","Referrer: http:\/\/www.newspaper.com\/cgi-bin\/phf","User-Agent: Mozilla\/2.0","Here, an IDS not capable of semantic processing would have to determine if this is a request for a restricted page. Then, based upon the individuals session history access may be blocked or the individual may be forwarded to the securely located site that contains the restricted information or page. However a semantic processor would perform semantic processing to yield the following information:","Method = GET","Http_URL = \/restrictedaccessnews.html","Directory = BASE","Filename = restrictedaccessnews","FileExtension = html","Version = HTTP\/1.1","HTTP_HOST = online.newspaper.com","HTTP_REFERRER = http:\/\/www.newspaper.com\/cgi-bin\/phf","HTTP_USERAGENT = Mozilla\/2.0","Here, the meaning of the left hand side label, e.g., Method, Http_URL, Version, etc., are semantically well understood structures by the IPS device. That is, a mapping is made between the incoming string and the left hand side labels described above.","Accordingly, semantic processing recognizes structures within messages based on grammars and context. Rules are applied and actions performed based upon the recognized structures. In addition, states are accumulated and associated with a meta session, that is persistent across transactions sessions and packets. The states associated with a meta session may mirror the states of the communicating applications. It should be appreciated that by looking at the content of the message, rather than the packet header, more specific information corresponding to the nature of the communication is able to be extracted as illustrated above. While the semantic processor described herein refers to specific examples of use with content based security, the processor may be employed with extensible markup language (XML), web acceleration, content based storage at high speeds, etc.",{"@attributes":{"id":"p-0064","num":"0063"},"figref":["FIG. 4A","FIG. 3"],"b":["150","152","152","160","150","152","152","150","158","158","154","154","156","156","150","150","152","152","150"],"i":["a ","b","a ","b","a ","b ","a","b","a ","b","a ","b ","a ","b","c "]},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 4B","b":["162","164","166","168","169","164","166","168","169"]},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIG. 5A","b":["170","172","170","172","172","174","176","172","170","172","172"]},{"@attributes":{"id":"p-0067","num":"0066"},"figref":["FIG. 5B","FIG. 5A","FIG. 21"],"b":["180","182","172","182","182","184","186","188","190","184","194","196","196","172","194","190","192","192","194","170","194","172","184","194","172","170","194","170","170","170"]},"Initialization Rules\n\n","For example, when a client sends a GET request to a server incorporating the IPS described herein, the SPU of the IPS sets up a session identification (ID). The server may generate a response with SET COOKIE headers. The SPU, such as SPU  with reference to , deletes all SET COOKIE headers from a response to the client and saves the session ID state with an ID number. The ID number is then added as a parameter to all the URL's associated with the response. The client then clicks on one of the URL's to generate a new get request. The SPU then identifies the session ID state of the new request with the ID number. The ID number is removed from the URL parameter and all COOKIEs are restored unless a COOKIE has expired. Thus, the server uses the COOKIEs as if the SPU system does not exist, as illustrated further with reference to .","It should be appreciated that CPU  of  responds to interrupts from SPU  and uses SPUDataTransfer calls to set up any periodic or event based data transfers from the SPU. CPU  may stop the security monitor application by SPUStopApplication and delete the security monitor application by SPUDeleteApplication or SPUDeleteInstance commands.","Upon initialization, characterization rules are applied to each incoming message. In one embodiment, the characterization rules identify a type of grammar used to build the incoming message by examining header information. Exemplary characterization rules are provided below:","Characterization Rules\n\n","It should be appreciated that any type of grammar may be identified by characterization rules similarly configured as the rules provided above to identify hypertext markup language (HTML).","Still referring to , it should be appreciated that each of blocks , , ,  and  are configured as programmable engines. In another embodiment, each of the programmable engines are static random access memory (SRAM) based engines that initialize each time upon startup. Thus, initialization rules are applied each time the SPU comes out of reset.","Grammar based parsing block  includes a lexical analysis engine where token identifications are created and a grammar parsing block where tokenization information associated with the message is created. As used herein tokenization is a process where a list of keywords is searched for and the structure of sub-strings between the key words are inferred to create semantical interpretations of the message. Tokenization allows for smaller regular expression sets on subsections of a message and results in simple hardware acceleration compared to a regular expression search across all patterns and complete messages. It will be apparent to one skilled in the art that the grammars need to be defined. In one embodiment, a lexical analyzer generator (LEX) and yet another compiler-compiler (YACC) are tools used to read the source program and determine its structure. Here, LEX creates the tokens and YACC takes the created tokens and reorganizes a sub-structure of the message. That is, LEX generates programs to be used in simple lexical analysis of text. The input files (standard input default) contain regular expressions to be searched for and actions written in C programming language to be executed when expressions are found. YACC converts a context-free grammar and translation code into a set of tables for a parser and translator. It is possible that a grammar may be ambiguous in which case specified precedence rules are used to break ambiguities.","Grammar rules are applied in grammar based parsing block . It should be appreciated that grammar rules include lexical rules and parsing rules. Exemplary lexical and parsing rules are provided below:",{"@attributes":{"id":"p-0077","num":"0095"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"LEXICAL RULES"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"bit","0 | 1"]},{"entry":[{},"digit","[0-9]"]},{"entry":[{},"CR","% x0D"]},{"entry":[{},"LF","% x0A"]},{"entry":[{},"SP","% X20"]},{"entry":[{},"HT","% X09"]},{"entry":[{},"lower_case_alpha","[a-z]"]},{"entry":[{},"upper_case_alpha","[A-Z]"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0078","num":"0096"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["HTTP_Request",": Request_Line_Array Header_options CRLF"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"maybe_message_body;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Request_Line_Array",": Request_Line_Array Request_Line | ;"]},{"entry":["Header_options_CRLF:","Header_options CRLF ;"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}},"br":{},"figref":"FIG. 7"},"State and rule execution block  of  extracts state information from message. State and rule execution block  also creates a rule index from all parameters and determines the pointer to the rule body. As will be explained further below, SPU system  is capable of maintaining states, i.e., keep certain portions of information and match it to returning messages from the same sender. Meta session and state rules are executed through state and rule execution block . Meta session and state rules include a set of rules to define a meta session, which includes associate states and transitions among the associated states. In addition, a state accumulation policy is defined through the meta session state rules.","Action execution block  processes the rules defined in block  to perform an action with respect to the message. It should be appreciated that the semantic rules, e.g., defining the state, defining the rules, defining the actions, etc., for semantic processing block  can be written in C code using a string library, such as the string library provided in Table 1. Accordingly, the software executed by SPU system  can be built in a manner in which programmers can easily program. Semantic rules include condition statements expressed in terms of message grammar, states, and defining associated actions. Exemplary semantic rules include:","Semantic Rules\n\n","Queuing engine block of  is associated with queuing and traffic management rules. In one embodiment, queuing and traffic management rules define a set of rules specifying the policies for sharing output link bandwidth.",{"@attributes":{"id":"p-0083","num":"0110"},"figref":["FIG. 6A","FIG. 5A"],"b":["200","172","200","172","172","202","172"]},{"@attributes":{"id":"p-0084","num":"0111"},"figref":"FIG. 6B","b":["1","210","212","174","212","214","1","172","212","170","214","212","212","174","214","174","212","216","218","216","216","200","202","216","172","200","218","1","210","1","210","218","1","210","218","224","216","1","210","220","216","1","210","220","218","1","210","216","218","220","174","218","222","216","172","220","218","222","174","174","2","226","200","224","172"]},{"@attributes":{"id":"p-0085","num":"0112"},"figref":"FIG. 7","b":["230","230","232","230","230","230","230","230","230","242","242","234","236","238","240"],"i":["a","b","c","d","e"]},{"@attributes":{"id":"p-0086","num":"0113"},"figref":"FIG. 8A","b":["250","254","254","254","252","252","252","256","258","252","260","262","264","254","264","266","268","270","272","254","256","270","274","268","276"],"i":["a","b ","c","a","b ","c ","a","c ","a","c ","a","c "]},{"@attributes":{"id":"p-0087","num":"0114"},"figref":["FIG. 8B","FIG. 8B"],"b":["194","194","194","254","256","7","280","194","254","256","280","194","194","254","282","194","282","194","194"],"i":"a"},{"@attributes":{"id":"p-0088","num":"0115"},"figref":"FIG. 9","b":["182","290","292","290"]},{"@attributes":{"id":"p-0089","num":"0116"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ToE Header >>",{}]},{"entry":[{},"1","\/\/ Direction, 0 = S2C; 1 = C2S"]},{"entry":[{},"12.168.0.16","\/\/ SourceIPAddress"]},{"entry":[{},"234.45.0.4","\/\/ DestinationIPAddress"]},{"entry":[{},"1028","\/\/ SourcePortAddress"]},{"entry":[{},"80","\/\/ DestinationPortAddress"]},{"entry":[{},"422","\/\/ MessageLength"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Lexeme Stream >>"]},{"entry":[{},"GET\/exec\/cgi-bin\/public\/perl.exe"]},{"entry":[{},"HTT\/1.1"]},{"entry":[{},"Host: online.wsj.com"]},{"entry":[{},"Referrer: http:\/\/www.wsj.com\/cgi-bin\/phf"]},{"entry":[{},"User-Agent: Mozilla\/2.0"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"Base ID lookup block  assigns a base ID number and writes the information to base ID memory . Alternatively, if an ID number exists for this message, e.g., if this data flow has been seen previously, the base ID number is retrieved from base ID memory . The grammar type can be indicated by the device port number or an early token recognition. Once the type of grammar is known from descriptor analysis block , the lexical code associated with the identified grammar is downloaded to grammar lex memory . Alternatively, the grammar tables may be read from the memory or cache and executed. It should be appreciated that the blocks described in  are pipelined. That is, first in-first out (FIFO) buffers in between the blocks. The message segment is then transmitted to grammar based parsing engine  which includes tokenizer  and parser . Tokenizer  converts the message into a token stream, such as the token stream with reference to . Parser  identifies non-terminals and valid strings and creates a parse tree. An exemplary parse tree is shown below:","Method = GET","HTTP_URL = \/exec\/cgi-bin\/public\/perl.exe\n\n","Version = HTTP\/1.1","HTTP_HOST = online.wsj.com","HTTP_REFERRER =","http:\/\/www.wsi.com\/cgi-bin\/phf","HTTP_USERAGENT = Mozilla\/2.0","An alternative parse tree is shown below through the symbol table structure (SYMTAB) illustrated below:",{"@attributes":{"id":"p-0098","num":"0128"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\/\/ SYMTAB FOR HTTP\/HTML"},{"entry":"\/****************************************************************\/"},{"entry":"\/\/--------------- URL -----------------"},{"entry":"struct httpRequestUrl {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Identifies the XPU Event","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","xpuEvent;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! The Meta-Session Id associated with the Message","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","metaSessionId;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! The rule header for the","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry ruleHeader;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! A general purpose ptr. Right now used as a filler.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","genPurposePtr;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","HTTP_REQUEST_URL_ST_LENGTH;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! HTTP Method Token.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","methodToken;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Un-Normalized URL String.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","unNorUrlString;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Normalized URL String","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","normUrlString;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! URL Scheme","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlScheme;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Hostname in the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlHost;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Port number in the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlPort;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Directory string in the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlDirectory;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Full filename in the URL string","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlFullFilename;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Filename only from the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlFileNameOnly;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! File extension from the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlFileExt;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Parameters in the URL string.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlParams;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Parameter names in the URL string","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlParameterNames;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Paramater values in the URL","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlParameter Values;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Path to document in the URL string.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlPath;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Protocol string in the HTTP message","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlProtocol;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Method in the HTTP message","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","urlMethod;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/*! Exception codes, if any, in this symbol table.","*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry","httpUrlException;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"} ;"},{"entry":"\/\/--------------- HTTP REQUEST HEADER -----------------"},{"entry":"\/************************\/"},{"entry":"struct httpRequestHeaders {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry","xpuEvent;"]},{"entry":[{},"symtab_entry","metaSessionId;"]},{"entry":[{},"symtab_entry","ruleHeader;"]},{"entry":[{},"symtab_entry","genPurposePtr;"]},{"entry":[{},"symtab_entry","HTTP_REQUEST_HDRS_ST_LENGTH;"]},{"entry":[{},"symtab_entry","allHeaders;"]},{"entry":[{},"symtab_entry","dayInDate;"]},{"entry":[{},"symtab_entry","dateInDate;"]},{"entry":[{},"symtab_entry","timeInDate;"]},{"entry":[{},"symtab_entry","timezoneInDate;"]},{"entry":[{},"symtab_entry","cookies;"]},{"entry":[{},"symtab_entry","httpReqHdrException;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"};"},{"entry":"\/\/--------------- HTTP RESPONSE HEADER -----------------"},{"entry":"\/********************************\/"},{"entry":"struct httpResponseHeaders {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry","xpuEvent;"]},{"entry":[{},"symtab_entry","metaSessionId;"]},{"entry":[{},"symtab_entry","ruleHeader;"]},{"entry":[{},"symtab_entry","genPurposePtr;"]},{"entry":[{},"symtab_entry","HTTP_RESPONSE_HDRS_ST_LENGTH;"]},{"entry":[{},"symtab_entry","statusCode;"]},{"entry":[{},"symtab_entry","statusMessage;"]},{"entry":[{},"symtab_entry","allHeaders;"]},{"entry":[{},"symtab_entry","dayInDate;"]},{"entry":[{},"symtab_entry","dateInDate;"]},{"entry":[{},"symtab_entry","timeInDate;"]},{"entry":[{},"symtab_entry","timezoneInDate;"]},{"entry":[{},"symtab_entry","cookies;"]},{"entry":[{},"symtab_entry","anchorHrefs;"]},{"entry":[{},"symtab_entry","httpRespHdrException;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"};"},{"entry":"\/\/--------------- HTML BODY SYMTAB -----------------"},{"entry":"\/************************\/"},{"entry":"struct htmlBody {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry","xpuEvent;"]},{"entry":[{},"symtab_entry","metaSessionId;"]},{"entry":[{},"symtab_entry","ruleHeader;"]},{"entry":[{},"symtab_entry","genPurposePtr;"]},{"entry":[{},"symtab_entry","HTML_BODY_ST_LENGTH;"]},{"entry":[{},"symtab_entry","htmlFormsParameterNames;"]},{"entry":[{},"symtab_entry","htmlFormsParameterValues;"]},{"entry":[{},"symtab_entry","htmlFormsHiddenFieldsNames;"]},{"entry":[{},"symtab_entry","htmlFormsHiddenFieldsValues;"]},{"entry":[{},"symtab_entry","body;"]},{"entry":[{},"symtab_entry","htmlBodyException;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"};"},{"entry":"\/\/ SYMTAB FOR SMTP"},{"entry":"\/****************************************************************\/"},{"entry":"\/\/--------------- EMAIL CMD -----------------"},{"entry":"typedef struct {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry xpuEvent;","\/\/holds the smtpEvent SMTP_CMD"]},{"entry":[{},"symtab_entry metaSessionId;","\/\/session id not important for the initial test"]},{"entry":[{},"symtab_entry ruleServiceQ;"]},{"entry":[{},"symtab_entry genPurposePtr;"]},{"entry":[{},"symtab_entry CMDST_LENGTH;","\/\/length of the symbol table itself"]},{"entry":[{},"symtab_entry cmdToken;","\/\/command reduced to an integer token"]},{"entry":[{},"symtab_entry fullCmdString;","\/\/ ptr to string"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry cmd;","\/\/ptr to null-terminated string for command alone"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry smtpCmdException; \/\/no exceptions regarding the SMTP command"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry cmdParams;","\/\/ ptr to null-terminated string containing"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"command \/\/parameters"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry cmdStringLen;","\/\/length of SMTP command with params"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"and CRLF"},{"entry":"} smtpCmdST;"},{"entry":"\/\/--------------- EMAIL HEADER -----------------"},{"entry":"typedef struct {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry xpuEvent;\/\/holds the smtpEvent EMAIL_HEADERS_END"]},{"entry":[{},"symtab_entry metaSessionId;"]},{"entry":[{},"symtab_entry ruleServiceQ;"]},{"entry":[{},"symtab_entry genPurposePtr;"]},{"entry":[{},"symtab_entry HDRST_LENGTH;"]},{"entry":[{},"symtab_entry receivedHdr; \/\/ string as it appears in the header"]},{"entry":[{},"symtab_entry mailFromHdr;\/\/ full header string null-terminated"]},{"entry":[{},"symtab_entry mailFromUsername;\/\/ null-terminated string of username only"]},{"entry":[{},"symtal_entry mailFromDomain;\/\/ null-term string of domain only"]},{"entry":[{},"symtab_entry numFromAddresses;\/\/ total number of From addresses"]},{"entry":[{},"symtab_entry to;"]},{"entry":[{},"symtab_entry dstDomains; \/\/array of domain strings from CC, BCC, TO"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry dstUsernames;","\/\/array of username strings from CC, BCC, TO"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry numDstAddresses;\/\/ combined size of TO, CC, BCC"]},{"entry":[{},"symtab_entry cc;"]},{"entry":[{},"symtab_entry bcc;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry dstAddresses;","\/\/array of full emailaddr strings from CC, BCC, TO"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry returnPath;"]},{"entry":[{},"symtab_entry replyTo;"]},{"entry":[{},"symtab_entry subject;"]},{"entry":[{},"symtab_entry messageId;"]},{"entry":[{},"symtab_entry date;"]},{"entry":[{},"symtab_entry dayInDate; \/\/ day string from Date hdr"]},{"entry":[{},"symtab_entry dateInDate; \/\/ date string from Date hdr"]},{"entry":[{},"symtab_entry timeInDate; \/\/time string from Date hdr"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry timezoneInDate;","\/\/ timezone string from Date hdr"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry allHeaders; \/\/ all chars in all headers in sequence"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry contentType;","\/\/content-type converted to an Id"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry\u2003\u2003hdrException;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry boundaryMarker;","\/\/NULL if not present"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry contentXferEnc; \/\/header transfer encoding converted to an Id."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"} mailHdrST;"},{"entry":"\/\/--------------- EMAIL BODY -----------------"},{"entry":"typedef struct {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry xpuEvent;\/\/holds the smtpEvent EMAIL_BODY_END"]},{"entry":[{},"symtab_entry metaSessionId;"]},{"entry":[{},"symtab_entry ruleServiceQ;"]},{"entry":[{},"symtab_entry genPurposePtr;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry BODYST_LENGTH;","\/\/length of sym table"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry contentType;","\/\/body content type as int"]},{"entry":[{},"symtab_entry contentXferEnc;","\/\/body transfer encoding as int"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry size;","\/\/length of email body excluding attachments"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry bodyException;","\/\/exception code while processing body in Yantra"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry body;","\/\/linked list of buffers holding body text"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"} mailBodyST;"},{"entry":"\/\/--------------- EMAIL ATTACHMENT -----------------"},{"entry":"typedef struct {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry xpuEvent;\/\/ ;\/\/holds the smtpEvent EMAIL_ATTACHMENT_END"]},{"entry":[{},"symtab_entry metaSessionId;"]},{"entry":[{},"symtab_entry ruleServiceQ;"]},{"entry":[{},"symtab_entry genPurposePtr;"]},{"entry":[{},"symtab_entry ATTST_LENGTH; \/\/length of sym table"]},{"entry":[{},"symtab_entry contentType;"]},{"entry":[{},"symtab_entry contentXferEnc;"]},{"entry":[{},"symtab_entry attachmentFilename;\/\/ null if not present"]},{"entry":[{},"symtab_entry attachmentFileExt;\/\/ null if not present"]},{"entry":[{},"symtab_entry fullFilename;\/\/ null if not present"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry isLastAttachment;","\/\/l if this is the symbol table for the last attachment"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry size;","\/\/length of attachment"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"symtab_entry attException;","\/\/exception codes in processing attachment in Yantra"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"symtab_entry attachment;","\/\/linked list of buffers holding body text"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"Still referring to , the message is then transmitted to state and rule execution block . State and rule execution block  includes meta session lookup block , rule lookup block , state update block  and rule execute block . Meta session lookup block  is associated with meta session state index , state update block  is associated with meta session database memory , rule lookup block  is associated with rules index memory  and rule execute block is associated with rules database memory . In one embodiment, the state and rule execution block includes four processors, where each processor is a multithreaded processor and each processor is configured to execute the rules as illustrated with reference to . Exemplary rules and actions associated with semantic processing are listed below in Tables 1 and 2. It should be appreciated that each of the processors of the SPU system has access to the primitive instructions of TABLES 1 and 2, which are built around strings. In one embodiment, the primitives are built into hardware and translate into a single semantic processing unit instruction. Furthermore, the lists of primitive instructions is exemplary and not meant to be exhaustive.",{"@attributes":{"id":"p-0100","num":"0130"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"STRING OPERATIONS"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"StringInString"]},{"entry":[{},"StringCompare"]},{"entry":[{},"FindInList"]},{"entry":[{},"FindInRegExList"]},{"entry":[{},"StringLength"]},{"entry":[{},"StringCopy"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0101","num":"0131"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"ACTIONS"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"InsertString"]},{"entry":[{},"DeleteString"]},{"entry":[{},"InsertCookie"]},{"entry":[{},"Drop"]},{"entry":[{},"Redirect"]},{"entry":[{},"Shun"]},{"entry":[{},"Log"]},{"entry":[{},"Alert"]},{"entry":[{},"SendMessage"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"Meta session lookup block  creates a session ID and index for a new meta session. Additionally, space is allocated in meta session state index memory . Alternatively, if the meta session is associated with an old meta session, then the new authentication event is associated with the old meta session.  is a schematic diagram of a meta session model in accordance with one embodiment of the invention. It should be appreciated that a meta session maintains information that is invariant across different connections or physical sessions. As  illustrates, multiple TCP\/IP connections  are included in one HTTP, SMTP, etc. session . Then on top of the physical sessions, meta session  may include multiple HTTP, SMTP, etc. sessions . For example, multiple physical sessions from a hacker may be associated into a meta session or meta session  may be associated with a shopping cart transaction related to an e-commerce application. That is, even if an HTTP session  has timed out, the next time the same user logs in, the previous transactions of the user are available through the association with the meta session and the storage in meta session state index . It should be appreciated that a meta session may be based on cookies being exchanged, a host name, a client name, a URL, a HTTP session ID, etc. Accordingly, authentication events  associated with these bases (cookies, host name, client name, URL, HTTP session ID, etc.) may initiate a meta session. During meta session  it may be decided to associate a new authentication event from a second physical session with a previous (old) meta session as indicated at point  where a service context is maintained between physical session and . Exemplary meta session end events , i.e., rules for ending a persistent connection, include HTTP_CONN_CLOSE, HTIP_RESP_GE_, a timeout, an event triggered by rule execution block or action execution block, etc.","Returning to , Rule lookup block  is executed simultaneously with meta session lookup block . Here, a rule parameter is created from all the parameters and a pointer to the rule body is determined. In one embodiment, procedural\/declarative rule predicates are looked up here.  is a schematic diagram representing a decision tree associated with an HTTP GET command in accordance with one embodiment of the invention. Here, by examining the tokens of a URL, such as the tokens associated with the URL of , a subset of rules is identified. The subset of rules is typically a small subset of the many rules defined in the rules index memory, thereby allowing for the efficient determination of applicable rules for a message. HTTP command  is examined according to the various directory names  of the HTTP command. Filenames  associated with directory names  further define an applicable set of rules. Certain parameters or file extensions may also be looked at to eventually reach blocks -which define a subset of rules to be applied to the message, thereby defining a tree type structure for rule index memory  of .",{"@attributes":{"id":"p-0104","num":"0134"},"figref":["FIG. 12","FIG. 7","FIG. 7"],"b":["350","352","354","352"]},"Continuing with , a hash value of the host address may be used to arrive at box . The URL directory is then looked at, which points to box . Then the filename and the file extension are evaluated which results in moving to box  and pointer , pointing to rule subset . In one embodiment, the file extension may have a suitable number of pointers associated with the file extension so that a full compare may be used to define pointer  leading to rule subset . Thus, a combination of hashing and full compares are utilized to arrive at the applicable rule subset, i.e., parse through the index tree.","Returning to , state update block  updates the communication state and writes to meta session database memory  to update an existing meta session or initiate a new meta session. Rule execution block  evaluates the rule predicates and finds a match in rule database memory . Action execution engine  performs actions on the message per the identified rules. For example, if the message contains a suspect .exe file or practical extraction and reporting language (Perl) script, the action may be to drop the message or quarantine the message and send an alert message to the server, through Queue block . It will be apparent to one skilled in the art that the message can be sent to a trash bin when the message is dropped in one embodiment of the invention. Queue state memory  is configured to store items to be sent out through queue . It should be appreciated that during the grammar based processing and the state and rile execution processing, a copy of the message is held in message buffer memory  for retrieval by action execution engine  and queue block . In one embodiment, the rules engine provides direct access to any variable within the payload of a message through grammar based access by pre-pending the key word message, e.g., message.smtpCommand.",{"@attributes":{"id":"p-0107","num":"0137"},"figref":"FIG. 13","b":["364","366","384","384","366","368"]},{"@attributes":{"id":"p-0108","num":"0138"},"figref":["FIG. 14","FIG. 7","FIG. 12"],"b":["380","382","2","2","1","388","1","384","1","390","392","388","1","386","1","1","392","2","394","3","396"]},{"@attributes":{"id":"p-0109","num":"0139"},"figref":"FIG. 15","b":["400","404","404","406","412","408","402","400","412","408","404","408","410","408","410","422","422","410","414","420","414","412","412","416","416","406","418","182","418","400"]},{"@attributes":{"id":"p-0110","num":"0140"},"figref":["FIG. 16","FIG. 15","FIG. 15","FIG. 16"],"b":["418","182","430","294","430","442","458","440","442","430","434","434","432","434","444","452","444","448","450","452","454","438","438","436","434","436","460","460","460","446"]},{"@attributes":{"id":"p-0111","num":"0141"},"figref":["FIG. 17","FIG. 16"],"b":["454","470","296","454","470","478","474","472","470","476","492","492","484","482","482","474","474","480","476","480","490","480","488","494","480","486","496","496","490","498"]},{"@attributes":{"id":"p-0112","num":"0142"},"figref":"FIG. 18","b":["502","500","500","504","508","504","508","506","510","516","504","508","518","514","512","504","514","520","508","512","512","522"]},{"@attributes":{"id":"p-0113","num":"0143"},"figref":["FIG. 19","FIG. 18","FIG. 17","FIG. 18"],"b":["520","530","316","530","532","542","534","530","542","544","552","550","548","544","498","536","316","544","538","544","522","540"]},{"@attributes":{"id":"p-0114","num":"0144"},"figref":["FIG. 20","FIG. 19","FIG. 17"],"b":["552","560","190","562","566","566","568","568","574","574","498","564","566","566","576","576","566","572","572","572","316","573","572"]},{"@attributes":{"id":"p-0115","num":"0145"},"figref":"FIG. 21","b":["182","422","294","460","296","496","304","516","518","586","294","296","304","592","594","584","294","594","584"]},{"@attributes":{"id":"p-0116","num":"0146"},"figref":"FIG. 22A","b":["174","210","210","172","511","609","174","210","172"]},{"@attributes":{"id":"p-0117","num":"0147"},"figref":["FIG. 22B","FIG. 22A"],"b":["182","603","294","296","296","304","592","304","592","593","609","182","295","182","294","304","421","422","459","461","605","607","601","294","294","304","592","294","296","304","592"],"i":["a","a","a","a"]},{"@attributes":{"id":"p-0118","num":"0148"},"figref":["FIG. 22C","FIGS. 21A and 21B","FIG. 5"],"b":["609","511","644","609","630","630","636","636","632","634","640","634","642","640","640","638","638","511"]},{"@attributes":{"id":"p-0119","num":"0149"},"figref":["FIG. 23","FIG. 5B"],"b":["602","194","590","602","604","596","172","182","184","600","460","496","516","422","584","518","172","588"]},{"@attributes":{"id":"p-0120","num":"0150"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0121","num":"0151"},"figref":["FIG. 25","FIG. 5B","FIG. 7","FIG. 10"],"b":["620","622","623","624","625","624","625"]},"Continuing with , the method then advances to operation  where the actions associated with the message are executed dependent on the state information associated with the corresponding meta session. For example, the history of the message is considered here through the meta session information. For instance, spam may be identified through the history tracked by the meta session data. In one embodiment, the actions that need to be taken are queued. Here, the action execution engine as discussed with respect to  is a suitable engine for executing the actions. As mentioned above, semantic rules may be used to define the actions. The method then proceeds to operation  where the message to be sent out is queued. For example, a set of rules specifying the policies for sharing the output link bandwidth are executed by a queue block here, as discussed with reference to .","In summary, the above described invention provides an intrusion prevention system configured to provided security for enterprise systems or any transactional based system, through content based evaluation. That is the content of an incoming message is used to fully understand the meaning of the message in order to provide a higher level of security. The SPU system described herein has many advantages as compared to a multiple CPUs\/multiple thread approach and a accelerated single function approach. The simple compilers, built-in ability to support streaming functions, and available debug mechanisms offer a distinct advantage to the SPU system described herein.","The state information is maintained across sessions as described above. The segmentation of the message further adds to the importance of maintaining states. For example, the message characterization block (MCB) needs to reassemble the segments from multiple streams, however, the MCB does not hold segments. The tokenizer holds partial token match state as well as portions of strings. The parser holds stack and look ahead character, machine state and partial parse data. The rule engine holds thread context for each of the stalled processes. As discussed in the embodiments described above the state is maintained with respect to each of the blocks of the system in order to prevent unwanted intrusions in an efficient manner.","With respect to exception handling, such as unrecognizable grammar or tokens, missing TCP segments, inability to complete parsing, missing tokens, etc., the system addresses these items in order to prevent errors from accumulating. In one embodiment, a daemon, i.e., a machine in the background, that detects these items to prevent an error build up associated with segmentation garbage collection, grammar garbage collection and so on. Additionally, due to the streaming nature of the semantic processing system, everything becomes transient, therefore, the environment around a breakpoint is frozen to capture traffic which is especially helpful for debugging purposes. In one embodiment, hardware trace buffers associated with state machines and processors provide the ability to keep prior transactional records to look back in the case of an error.","With the above embodiments in mind, it should be understood that the invention may employ various computer-implemented operations involving data stored in computer systems. These operations include operations requiring physical manipulation of physical quantities. Usually, though not necessarily, these quantities take the form of electrical or magnetic signals capable of being stored, transferred, combined, compared, and otherwise manipulated. Further, the manipulations performed are often referred to in terms, such as producing, identifying, determining, or comparing.","The above described invention may be practiced with other computer system configurations including hand-held devices, microprocessor systems, microprocessor-based or programmable consumer electronics, minicomputers, mainframe computers and the like. The invention may also be practiced in distributing computing environments where tasks are performed by remote processing devices that are linked through a communications network.","The invention can also be embodied as computer readable code on a computer readable medium. The computer readable medium is any data storage device that can store data which can be thereafter read by a computer system. Examples of the computer readable medium include hard drives, network attached storage (NAS), read-only memory, random-access memory, CD-ROMs, CD-Rs, CD-RWs, magnetic tapes, and other optical and non-optical data storage devices. The computer readable medium can also be distributed over a network coupled computer system so that the computer readable code is stored and executed in a distributed fashion.","Although the foregoing invention has been described in some detail for purposes of clarity of understanding, it will be apparent that certain changes and modifications may be practiced within the scope of the appended claims. Accordingly, the present embodiments are to be considered as illustrative and not restrictive, and the invention is not to be limited to the details given herein, but may be modified within the scope and equivalents of the appended claims. In the claims, elements and\/or steps do not imply any particular order of operation, unless explicitly stated in the claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention will be readily understood by the following detailed description in conjunction with the accompanying drawings, and like reference numerals designate like structural elements.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4A"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 4B"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 5A"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 5B","FIG. 5A"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 6A","FIG. 5A"]},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 6B"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 8A"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 8B"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 22A"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 22B","FIG. 22A"]},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 22C","FIGS. 21A and 21B"]},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 25"}]},"DETDESC":[{},{}]}
