---
title: Secure programming of vehicle modules
abstract: A method for programming a vehicle module via a secure programming system. The method carried out by the system involves generating a credentials media containing one or more secure credentials. Then, a credentials programmer programs one or more vehicle modules using the credentials media. During each stage of the vehicle module programming, the programming status is securely updated in the credential media. In case of a programming failure, the credentials media is used in a secondary credentials programmer to program the vehicle modules.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08844047&OS=08844047&RS=08844047
owner: General Motors LLC
number: 08844047
owner_city: Detroit
owner_country: US
publication_date: 20091211
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["The present invention generally relates to vehicle module programming and, more particularly, to methods for securely programming of vehicle modules.","When programming a multitude of vehicle modules (e.g., thousands or millions of such modules) with uniquely identifying parameters, there is always a possibility of programming one or more modules with the same parameters. For example, after a programming system stoppage due to a system failure, a programmer may unintentionally re-start programming of the next vehicle module with a previously programmed vehicle module parameters or at a minimum may not recognize at what stage the programming system stopped. Furthermore, there is always a need to minimize or prevent fraudulent programming of vehicle modules.","According to one aspect of the invention, there is provided a method for programming a vehicle module. The method comprises the steps of: (a) providing a credentials media containing a plurality of secure credentials; (b) utilizing the credentials media in a credentials programmer to program a plurality of vehicle modules; (c) recording the status of the vehicle module programming in the credentials media; and (d) in case of a programming failure, utilizing the credentials media in a secondary credentials programmer to program a vehicle module.","According to another aspect of the invention, there is provided a method for programming a vehicle module. The method comprises the steps of: (a) providing a credentials media containing a plurality of secure credentials; (b) utilizing the credentials media in a credentials programmer to program a plurality of vehicle modules; (c) updating the status of vehicle module programming each time a vehicle module is programmed with one of the credentials; and (d) in case of a programming failure, utilizing the credentials media in a secondary credentials programmer to program a vehicle module.","The systems and methods described below are directed to different embodiments of an approach for programming a vehicle module. The disclosed methods provide a programming mechanism which consists of providing a credentials media containing a plurality of secure credentials. Later, a credentials programmer programs a plurality of vehicle modules using the credentials media. During each stage of the vehicle module programming, the programming status is securely updated in the credential media. In case of a programming failure, the credentials media is used in a secondary credentials programmer to program the vehicle modules. This approach allows the system to securely track the status of vehicle module programming so if there is a failure requiring use of a different programming computer, the credentials media can be easily moved to another computer to continue programming without risk of skipping or duplicating any particular set of credentials from the media.","With reference to , there is shown an exemplary programming system  that can be used to implement the methods disclosed herein. Programming system  generally includes a credentials generator , a credentials media , a credentials programmer , one or more auxiliary programmers , one or more vehicle modules , and a secondary programmer . It should be understood that the disclosed method can be used with any number of different systems and is not specifically limited to the operating environment shown here. Also, the architecture, construction, setup, and operation of the system  and its individual components are generally known in the art. Thus, the following paragraphs simply provide a brief overview of one such exemplary system ; however, other systems not shown here could employ the disclosed methods as well.","Credentials generator  can be one of a number of computers accessible via a private or public network such as the Internet. It can be used for one or more purposes, such as generating credentials media . It can be implemented using any suitable type of computer (e.g., a desktop computer or portable computer) that stores any cryptographic tool including cryptographic application programming interface. Apart from a computer, other types of credentials generators  can be used. For example, a third party credentials authority can be used to generate credentials media .","Credentials media  is a computer-readable medium and can be any of a number of different storage media. Its main uses are storage and ability to be updated by credentials programmer  or others. A list of possible credentials media  includes digital versatile disc (DVD) (e.g., DVD-RW, DVD+RW, DVD-RAM), high definition media (e.g., Blu-ray, HD DVD), compact disc (CD) (e.g., CD-RW), universal serial bus (USB) (e.g., USB flash drive), memory card (e.g., secure card), external hard disk, data tape, floppy disk, etc. The above list is by no means an exhaustive list of all of the possible credentials media , but it is simply provides few examples of credentials media  as others will become more evident to skilled artisans.","Credentials programmer  can be any type of device capable of reading and updating media  and processing electronic instructions including computers, microprocessors, microcontrollers, host processors, controllers, and application specific integrated circuits (ASICs). It may also be referred to as an injector in the sense that it is used to inject credentials into the system for use in programming a vehicle module. It can be a dedicated programmer used only for vehicle modules  or can be used with other vehicle systems. Credentials programmer  executes various types of digitally-stored instructions, such as software or firmware programs stored in it, which enable vehicle modules  to be programmed. For instance, credentials programmer  can communicate with auxiliary programmer  and may execute programs or process data to carry out at least a part of the method discussed herein.","Auxiliary programmer  can be any type of device capable of programming vehicle module . It can be operated automatically by credentials programmer , by digitally-stored instructions within programmer , etc. It can be also operated by an operator and in this case can take the form, for example, of a computer terminal or interface that runs a programming application. Auxiliary programmer  can be connected to module  through a communication cable (e.g., serial, USB, Ethernet, etc.) or wirelessly. Other options are possible, for instance, in one embodiment, module  can be housed inside auxiliary programmer  while it is being programmed.","Vehicle module  includes any vehicle module that is located throughout a vehicle. As examples, one vehicle module can be a telematics unit that enables wireless voice and\/or data communication over a wireless carrier system and via wireless networking so that the vehicle can communicate with a call center, other telematics-enabled vehicles, or some other entity or device. Another vehicle module can be an engine control module (ECM) that controls various aspects of engine operation such as fuel ignition and ignition timing. Another vehicle module can be a powertrain control module that regulates operation of one or more components of the vehicle powertrain, and another vehicle module can be a body control module that governs various electrical components located throughout the vehicle, like the vehicle's power door locks and headlights. As will be appreciated by those skilled in the art, the above-mentioned vehicle modules are only examples of some of the modules that may be used in system  or , as numerous others are also possible. Furthermore, it should be understood that at least some of the aforementioned modules could be implemented in the form of software instructions saved inside a vehicle (not shown), they could be hardware components located inside the vehicle or a vehicle module (e.g., chip, EEPROM, flash, PAL, etc.), to cite but a few possibilities.",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 2","b":["100","100","20","30","140","60","170","100","10","140","100","40","50","10","170","100","50","70","10","60","140","170","100"]},"Turning now to , there is shown a method  for programming a vehicle module. The method  starts at step  and begins by generating the secure credentials media . There are several options to generate the credentials media  including in-house, third party generation, or any combination of these. In one embodiment, media  is generated in-house by an original equipment manufacturer (OEM) automotive company or supplier using any suitable cryptographic tool including a cryptographic application programming interface. In a second embodiment, media  is generated by a third party including an application service provider, managed service provider, etc. In either case, one or more cryptography techniques can be used including, public key cryptography (e.g., asymmetric public key-private key, symmetric private key, etc.), strong authentication, one or more factors authentication (i.e., at least a factor or a combination from \u201csomething you know\u201d, \u201csomething you have\u201d, and \u201csomething you are\u201d) (e.g., one factor, two-factor authentication (T-FA), etc.), or others. A list of factors that can be used includes tokens (e.g., virtual and\/or physical tokens), smart cards, USB, biometrics, magnetic cards, phones, SMS, passwords, etc. Therefore, in addition to generating media  with\/without its own embedded security factors, one or more additional factors can be also generated. In one embodiment, media  is generated with software or firmware prompting a user to type a password, or use biometric data. In another embodiment, media  is generated in conjunction with a USB drive that is necessary to operate media . Skilled artisans will appreciate that other techniques can be used. The credentials generated include digital certificate, one or more keys (e.g., private key, public key, etc.), phone numbers (e.g., cellular numbers), identifiers (e.g., module serial number, vehicle identification number (VIN)), etc. This collection of credentials can be logically related and grouped in one or more tables or any other formats contained in one or more files and consolidated in one or more databases. For instance, in one embodiment the data can be related as a separate set of credentials for each separate module (e.g., digital certificate, security keys, phone number, VIN, etc.). In a second embodiment, the data can be related as sets of similar data type (e.g., set-1 list of digital certificates, set 2-list of security keys, set 3-list of phone numbers, set 4-list of VINs, etc.).","Once generated, the credentials media  is inserted into the primary injector , as indicated at step . Next, primary injector  reads a (next) selected set of credentials from the credentials media  per step . The set of credentials includes any data to be programmed in a vehicle module . In addition, it may include the necessary security data to preserve the security aspect of the process. In one embodiment, the set of credentials contains a key certificate (e.g., X.509), a private key, a shared key, a phone number, and a serial number. In method , the next time the process loops back to step , the next set of credentials will be read from credential media .","At step , the selected credentials validity is checked. In one embodiment, primary injector  can check the credentials validity. One or more checks can be performed here including wholeness (i.e., does the set include all the credentials?), accuracy (e.g., is each credential complete and has all of its alphanumeric digits?), unique (e.g., is the appropriate credential unique and not used before?), and\/or other checks. This can involve use of one or more digital certificates to ensure confidentiality and\/or authenticity of the credentials. In case the credentials are valid, method  proceeds to step . However, if the credentials are not valid then method  proceeds to step . Both steps will be described below.","If the selected credentials are valid, at step , primary injector  updates the credential media . At this step, method  keeps track of which set of credentials are in use. Hence, if the process stops at this step, a user will recognize efficiently and in a timely fashion which set of credentials to use next. In addition, keeping track of which set of credentials are in use will provide transparency of the process and its performance. This tracking of the current credentials can be done via an acknowledgement written to the credentials media ; for example, by writing to the media  (e.g., in a separate file) the set of selected credentials currently being used (or a unique identifier thereof). This acknowledgement can also include a list of all the credentials used thus far. Primary injector  can also digitally sign the acknowledgement using a message authentication code (MAC) including a keyed-hashed message authentication code (HMAC or KHMAC) such as HMAC-MD (e.g., MD4, MD5, etc.), HMAC-SHA (e.g., SHA-0, SHA-1, SHA-2, SHA-3, etc.), or others. In one embodiment, primary injector  digitally signs the acknowledgement that the selected set of credentials is being used using HMAC-SHA-256. A person skilled in the art will recognize that other message authentication codes can be used.","Later, primary injector  sends the selected credentials to auxiliary programmer  (step ). The credentials can be sent automatically from injector  through a network to auxiliary programmer  or an operator may perform this task by providing a command through injector  to send the credentials to auxiliary programmer . Then, auxiliary programmer  programs module  with the selected credentials per step . During this step and any other steps, even though the discussion involves only one module and one auxiliary programmer, however, a plurality of modules and auxiliary modules may be used. In one embodiment, several auxiliary programmers are used, however, each auxiliary programmer programs only one module at a time. In a second embodiment, one auxiliary programmer programs several modules at a time. These are only few options as others are possible. There are several programming strategies that can be employed. In one embodiment, auxiliary programmer  tries to program module  one time and does not depend on the outcome of module  programming status, then, later method  proceeds to the next step . In another embodiment, auxiliary programmer  may try to program module  several times if it notices a programming failure (e.g., one or more credentials not programmed) before method  proceeds to the next step . The programming period can be limited by a period of time where several trials are performed in case of a programming failure until a certain period of time expires. In another embodiment, the programming period is limited by the number of programming trials in case of a programming failure. These are only few examples as others are possible, for example, a combination of a number of trials and maximum programming time period can be used.","Next, auxiliary programmer  sends a programming status to primary injector  per step . The status can be either pass or fail status. The pass status can be established if module  programming is successful. The fail status can be established if module  programming is determined to be unsuccessful. Among other things, this step provides method  with process transparency so a user or others can easily monitor, evaluate, correct and\/or improve system .","At step , primary injector  records and counts module  programming status. At this stage, injector  records and counts module  programming status received from auxiliary programmer  (e.g., number of passes, number of failures, etc.). In addition, it records and counts the credentials invalid status per step . Recording of successful programming (pass status) can be done by securely writing to the credentials media  either the actual credentials just successfully programmed, or a unique indicator of that, and\/or a list of all the credentials programmed successfully thus far. And, this confirmation can be signed digitally for authentication.","At step , primary injector  failure status is checked. The status can be either failure or no failure (success). A failure can be determined by one or more factors including one count of invalid selected credentials returned by primary injector , a predetermined number count of invalid selected credentials returned by primary injector , primary injector  inability to communicate with programmer , media , or others, etc. The failure status can also comprise a failure status of one or more auxiliary programmers  as described earlier. In a case of a failure, method  proceeds to step  where credentials media  is used in a different injector such as injector  which will become the main injector and method  loops back to step  where injector  reads next selected set of credentials from credentials media . However, if there is no failure status then injector  updates credential media that module  is programmed successfully and securely signs the communication. Then, method  loops back to step  where injector  reads next selected set of credentials from credentials media .","When, at step  the system switches to the secondary programmer , the credentials media  is accessed by that secondary injector which determines the point at which successful programming by the primary injector stopped. Then, the secondary injector can continue with the first set of credentials that were not successfully programmed by the first injector. This process can be carried out automatically through suitable programming of the secondary injector . Thus, for example, the secondary injector can read from the media  the digitally signed file identifying the last credentials used and, based on that, proceed at the step  using the first unused credentials from the media .","Method  with few modifications can be employed with system  illustrated in  and depicting a second exemplary embodiment of a programming system that is capable of programming a vehicle module. In this case, in addition to reading and updating credentials , primary injector  programs vehicle module . Hence, steps  and  are omitted and step  is performed by primary injector . In a case of failure, secondary injector  will replace injector .","It is to be understood that the foregoing description is not a definition of the invention, but is a description of one or more preferred exemplary embodiments of the invention. The invention is not limited to the particular embodiment(s) disclosed herein, but rather is defined solely by the claims below. Furthermore, the statements contained in the foregoing description relate to particular embodiments and are not to be construed as limitations on the scope of the invention or on the definition of terms used in the claims, except where a term or phrase is expressly defined above. Various other embodiments and various changes and modifications to the disclosed embodiment(s) will become apparent to those skilled in the art. All such other embodiments, changes, and modifications are intended to come within the scope of the appended claims.","As used in this specification and claims, the terms \u201cfor example,\u201d \u201cfor instance,\u201d \u201csuch as,\u201d and \u201clike,\u201d and the verbs \u201ccomprising,\u201d \u201chaving,\u201d \u201cincluding,\u201d and their other verb forms, when used in conjunction with a listing of one or more components or other items, are each to be construed as open-ended, meaning that that the listing is not to be considered as excluding other, additional components or items. Other terms are to be construed using their broadest reasonable meaning unless they are used in a context that requires a different interpretation."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Preferred exemplary embodiments of the invention will hereinafter be described in conjunction with the appended drawings, wherein like designations denote like elements, and wherein:",{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
