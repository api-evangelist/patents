---
title: Automated image analysis with GUI management and control of a pipeline workflow
abstract: Automated image screening operations of pipelined image processing systems and methods are controlled with a graphical user interface enabling user control of screening analysis process setup and execution and user viewing of results. A gating interface is provided to include and/or exclude cells in an aggregation of individual cell data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08861810&OS=08861810&RS=08861810
owner: Vala Sciences, Inc.
number: 08861810
owner_city: San Diego
owner_country: US
publication_date: 20100105
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["PRIORITY","RELATED APPLICATIONS","STATEMENT OF GOVERNMENT INTEREST","BACKGROUND","SUMMARY","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS","Example of Method"],"p":["This application claims priority to U.S. Provisional Application for Patent 61\/204,506 filed Jan. 6, 2009 and to U.S. Provisional Application for Patent 61\/212,992 filed Apr. 17, 2009, both commonly owned herewith.","The following applications contain subject matter related to this application. Both applications are incorporated herein by this reference:","U.S. patent application Ser. No. 11\/285,691, filed Nov. 21, 2005 for \u201cSystem, Method, And Kit For Processing A Magnified Image Of Biological Material To Identify Components Of A Biological Object\u201d; and,","PCT application PCT\/US2006\/044936, filed Nov. 17, 2006 for \u201cSystem, Method, And Kit For Processing A Magnified Image Of Biological Material To Identify Components Of A Biological Object\u201d, published as WO 2007\/061971 on May 31, 2007;","The following applications contain subject matter related to this application.","U.S. patent application Ser. No. 12\/454,081, filed May 12, 2009 for \u201cUser Interface Method And System For Management And Control of Automated Image Processing In High Content Screening Or High Throughput Screening\u201d; and,","U.S. patent application Ser. No. 12\/459,146, filed Jun. 26, 2009 for \u201cUser Interface Method And System With Image Viewer For Management And Control Of Automated Image Processing In High Content Screening Or High Throughput Screening\u201d.","Inventions described herein were made in part with government support under Grant No. 1R03 DA026213-01, Grant No. 5R42 HL086076-03, Grant No. 1R41 DK082087-01, and Grant No. 1R41 AR055604-01A2, all awarded by the National Institutes of Health. The US government has certain rights in this invention.","The technical field concerns image processing. More particularly, the technical field covers automated analysis of magnified images. More particularly still, the technical field concerns an instrumentation system in which magnified images of material are subjected to image processing in an image processing system with a graphical user interface that enables a user to selectively select and initialize an image analysis algorithm and to screen results.","Magnified images of biological material are obtained for purposes of study, diagnosis, or determination of experimental results. Such images may be obtained by instrument systems from material disposed in multi-well plates, plastic or glass culture dishes, cells disposed on plastic or glass slides, and\/or tissue sections mounted to plastic or glass slides. The magnified images are subjected to analysis by means of an automated image processing system constructed to execute image processing algorithms in order to determine characteristics of the material important to the intended purposes.","An automated image processing system incorporating inventions described in U.S. patent application Ser. No. 12\/454,081 and U.S. patent application Ser. No. 12\/459,146 has contributed a number of key advances to image cytometry, high-content screening, and high-content analysis software packages. The system is designed for ease of use, accessibility and scalability and includes a graphical user interface (\u201cGUI\u201d) for analysis and data viewing that is much more accessible for the non-expert user than previous tools. The image input and numerical data structures of the system conform to standard open formats and the system works natively on commercially-available versions of standard operating systems. Multithreading support enables speed and straightforward scale up. This system is designed to automate the analysis of images from digital microscope cameras and high-content screening analysis instruments. For most assays, an assay development step is required to determine the best image analysis settings and biological preparation. It is an iterative plate-by-plate and well-by-well process cycling between image acquisition, image analysis and statistics. Once the assay conditions and image processing conditions are set, these settings are applied in more routine conditions.","In the automated image analysis of the pending applications, analysis starts by breaking down each image into core biological component masks for cells and tissues. Then measurements are aggregated as needed for experiments with slides, wells, plates etc. First, all of the nuclei available from the nuclear images are identified. A nuclear mask for each cell is established where the mask contains all of the pixels locations automatically identified as nuclear for a given cell. Then a second image is analyzed. Presuming an RNA image for example, analysis assigns RNA spots in the image to an RNA mask. These masks are determined by the algorithm but roughly correspond to the brightest pixels in the RNA image. A rich set of data parameters are then calculated on a \u201cper cell basis\u201d.","As per , an RNA example of the cell is analyzed, wherein Nm is a nuclear mask and corresponds to the number of pixels that make up the nuclei, Cm is a cytoplasmic mask, which extends from the cell boundaries to the nucleus, and Rm is an RNA mask and corresponds to the number of pixels found within RNA dots.","In an automated image analysis system incorporating inventions of the pending '081 and '146 applications, system functionality is presented to users through a GUI including a main window, an image window, and a data viewer.","The main window, seen in , is what users see at launch. The image viewer and data are accessed from this main window. As may be appreciated, the main window constitutes a simple, easily understood and operated interface. This simplicity is especially stark relative to other similar packages. The steps required to analyze a slide, a single well, a multi-well plate, or an arbitrarily large batch of multi-well plates are similar. In the simplest case, a user selects an appropriate image processing algorithm, indicates a storage location of an image or images to be processed, and clicks a \u2018run\u2019 button.","The \u2018Thread\u2019 count displayed in this window refers to how many of the computer's processors are to be used for analysis. This multithreading capability is useful in providing speed and scalability for larger data sets and more sophisticated image analysis. Multithreading is useful for common multi-core laptops and workstations as well as for larger scale dedicated servers with many processors.","Once the initial analysis is complete, image processing results may be inspected in an image viewer. See  in this regard. This window displays raw unprocessed images overlaid with masks created by automated image processing. an original image. Here again, the emphasis is on usability and simplicity. Every cell is identified with a unique number and the results of the image segmentation are clearly displayed. The controls offer instant updates as to which image, well, mask or mask edge is displayed and transparently integrate well with image zooming, contrast enhancement, screenshot, pseudo-color control features. The result is a facile interface enabling a user to verify image segmentation and inspect areas of interest within a screen. The example shown in  is a two-color RNA example with automatically generated cell masks, unique cell IDs and control dialog windows.","The numbers derived from the segmentation are then viewed and manipulated through a data viewer. See . Though hundreds of measurements may be routinely available during image processing, a far smaller number may be relevant to any one experiment. To afford ease of use, the data viewer is built to offer access to measurements of interest without overwhelming users. Users can create and export raw data tables, histograms, scatter plots. All of the data can be filtered through a very powerful gating interface.","Per , automated image analysis generates a number of measurements for each cell within an image. These data are aggregated and analyzed as required by the experiment within the data viewer.","The data viewer of  enables inspection of numerical data for each individual cell, well, plate and experiment. For example, the automated image processing systems of the referenced provisional applications may work with plates up to 3456 in size, and may store an experimental condition for each well. Such conditions may include, for example, time points in a time course or chemistry dose information. All the data are stored and can be exported into commonly used text formats (csv, jpeg files).","While the automated image analysis system incorporating inventions of the pending '081 and '146 applications provides fast, intuitive user control and management of automatic image processing, data calculation, and result presentation in high content screening and\/or high throughput screening, further functionality and adaptability are desirable in order to enrich the results produced.","It is desirable for a gating interface to be able to take advantage of automatic segmentation of the raw images into an aggregation of individual cell data. Once the data is transformed into cytometry data, the ability to filter the cells into subpopulations provides a useful analysis tool.","It is desirable to be able to selectively initialize image processing by selecting or assembling an image processing algorithm from a library of routines.","It is desirable to be able to selectively establish parameters for execution of the algorithm.","It is desirable to be able to screen images by visual inspection before, during, and after image and data processing by the algorithm in order to assess the quality of results obtained.","Automated image processing operations of pipelined image processing systems and methods are controlled with a graphical user interface enabling user control of setup and execution of an image processing algorithm and user viewing of results.","The graphical user interface enabling a user to control setup and execution of an image processing algorithm and to view results remove with a gating function that removes outliers and artifacts from the image analysis results.","Cell-by-cell, well and experiment data are easily manipulated by tools accessed via a tools window such as is shown in . For example, tools for image analysis may include gating, histogram and scatter-plotting. Any combination of raw or gated numerical cell data can be viewed and exported into common Excel compatible formats.","With reference to , gating may be used routinely to remove outliers and artifacts from the image analysis results. When imaging hundreds of cells per well over thousands of wells, it is frequently desirable to view results based solely on data from relevant cells.","Gating may be used broadly in a wide variety of situations to include and exclude cells based on the values of one of more measurements. Some representative examples include: cells with protein expression beyond a certain level; successfully transfected cells in a transient transfection; removal of outliers and artifacts from images; studying only dividing cells; and finding rare cells that express a unique combination of size, shape and fluorescent markers. Most interesting cell biology involves heterogeneous populations of cells. Combining image analysis with a powerful gating tool helps scientists access more subtle data.","The gating interface provides a significant step forward in usability. Previous implementations of gating required a detailed understanding of how to logically construct an interesting gate, the result of which was a long character string of \u201cANDs\u201d and \u201cNOTs\u201d. Such a gating interface is very difficult for routine use by biologists. The gating interface demonstrated and illustrated herein is driven by easily manipulated and understood drop down lists and buttons. Additional steps within a gate are created by pressing the \u201c+\u201d and removed by pressing the \u201c\u2212\u201d buttons.","A system and a method for processing an original image of biological material to identify components of a biological object may be implemented in a software program written in the C++ and\/or Java programming languages and a counterpart system may be a general purpose computer system programmed to execute the method. Of course, the method and the programmed computer system may also be embodied in a special purpose processor provided as a set of one or more chips. Further, there may be a program product constituted of a program of computer or software instructions or steps stored on a tangible article of manufacture that causes a computer to execute the method. The tangible article of manufacture may be constituted of one or more real and\/or virtual data storage articles.",{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 7","b":["100","110","112","116","110","116","116","118","110","120","122","112","110","126","126","126","127","128","127","128","128","128","128","130"]},"With further reference to , the processor  may be a programmed general purpose digital processor having a standard architecture, such as a computer work station. The processor  includes a processing unit (CPU)  that communicates with a number of peripheral devices by way of a bus subsystem . The peripheral devices include a memory subsystem (MEMORY) , a file storage subsystem (FILE) , user interface devices (USER) , an input device (INPUT) , and an interface device (INTERFACE) . It is not necessary that the processor  be connected directly to the microscope ; it may receive magnified images produced by the microscope from a portable storage device, or by way of a local or wide area network. For example, magnified images obtained by a microscope may be transported to the processor over the internet.","The bus subsystem  includes media, devices, ports, protocols, and procedures that enable the processing unit  and the peripheral devices , , , , and  to communicate and transfer data. The bus subsystem  provides generally for the processing unit and peripherals to be collocated or dispersed","The memory subsystem  includes read-only memory (ROM) for storage of one or more programs of instructions that implement a number of functions and processes. One of the programs is an automated image process for processing a magnified image of biological material to identify one or more components of an image. The memory subsystem  also includes random access memory (RAM) for storing instructions and results during process execution. The RAM is used by the automated image process for storage of images generated as the process executes. The file storage subsystem  provides non-volatile storage for program, data, and image files and may include any one or more of a hard drive, floppy drive, CD-ROM, and equivalent devices","The user interface devices  include interface programs and input and output devices supporting a graphical user interface (GUI) for entry of data and commands, initiation and termination of processes and routines and for output of prompts, requests, screens, menus, data, images, and results.","The input device  enables the processor  to receive digital images directly from the camera , or from another source such as a portable storage device, or by way of a local or wide area network. The interface device  enables the processor  to connect to and communicate with other local or remote processors, computers, servers, clients, nodes and networks. For example, the interface device  may provide access to an output device  by way of a local or global network .","Methods and apparatuses for practicing the teachings of this specification may be constituted in whole or in part of a program product with a computer-readable storage medium, network, and\/or node that enables a computer, a processor, a fixed or scalable set of resources, a network service, or any equivalent programmable real and\/or virtual entity to execute a GUI and\/or perform image processing as described and illustrated below. The program product may include a portable medium suitable for temporarily or permanently storing a program of software instructions that may be read, compiled and executed by a computer, a processor, or any equivalent article. For example, the program product may include a programmed CD such as is seen in , or a network-accessible site, node, center, or any equivalent article.","Image Acquisition","Known means acquire, format, and store magnified images in digital formats. For ease of illustration and explanation, the magnified images may be acquired from multi-well plates containing biological, chemical, and\/or pharmaceutical material. The magnified images are stored for processing. The system of  includes capabilities to process magnified images and to conduct analysis of the image processing results.","Description of Processing Workflow","It is desirable to provide a user with a simple, intuitive graphical user interface (\u201cGUI\u201d) giving the user the power of a plug-in processing architecture in which algorithmic procedures for image processing may be added to and deleted from a processing pipeline to enable it to process various image components or features. A user may begin working quickly using established routines embodying image processing algorithms. A user may also create complex \u201cpipelines\u201d of plug-in routines to do advanced image processing without having to write any source code.","The desirable simplicity of the solution depends on the fact that nearly all of the complexity in image processing, especially for biological applications, happens in one place\u2014at the point where several image \u201cchannels\u201d must be overlaid, segmented into cells, and measured for biological properties.","Inputs for the complex part of an image processing operation may be constituted of a set of grayscale images. The outputs may include images including a set of labeled masks (which identify, for example, the \u201cinteresting\u201d parts of cells) and data in a variety of formats, for example a table of measurements on each cell.","The GUI provides the user with a simple way to define the input grayscale images. It then automatically runs the exact same complex image analysis on every image in every designated well of every designated plate of a batch, producing labeled masks and databases of measurements. Once this analysis has been performed, the GUI gives the user access to image and data viewer tools to view the images and masks, along with tools to examine the measurements.","In order to do such complex image analysis, it is desirable that certain common operations be \u201cfactored out\u201d. In this regard:\n\n",{"@attributes":{"id":"p-0078","num":"0083"},"figref":"FIG. 9","b":["200","210","200","212","214","216","218","212","214","216","218","210","210","200","210","218"]},"Data Types: data types that manage different tasks include:\n\n","DataTable: an object which contains either the set of all measurements on all cells in a well or contains a statistical summary of another DataTable.","Functions: the following processor- or computer-executed functions manage the analysis of batches of plates:\n\n",{"@attributes":{"id":"p-0082","num":"0095"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"analyzeBatch("]},{"entry":[{},"\u2003\u2003ImageWellPlateBatch batch,"]},{"entry":[{},"\u2003\u2003ImageNameScheme nameScheme,"]},{"entry":[{},"\u2003\u2003WellScanManager scanManager,"]},{"entry":[{},"\u2003\u2003File outputFolder,"]},{"entry":[{},"\u2003\u2003AlgorithmChannelInfoList channelInfoList,"]},{"entry":[{},"\u2003\u2003AlgorithmGateInfoList gateInfoList)"]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003for all ImageWellPlate plate in batch"]},{"entry":[{},"\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003lookup File plateInputFolder from plate;"]},{"entry":[{},"\u2003\u2003\u2003\u2003create new File plateOutputFolder in outputFolder;"]},{"entry":[{},"\u2003\u2003\u2003\u2003analyzePlate(plate, nameScheme, scanManager,"]},{"entry":[{},"\u2003\u2003\u2003\u2003plateInputFolder,"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003plateOutputFolder, channelInfoList, gateInfoList);"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"analyzePlate: As seen in , this function creates an empty DataTable that will hold a statistical summary of the measurements performed on every well in the plate. It then examines the list of gates that will be applied to each well's DataTables and creates a similar empty DataTable for the corresponding statistical summary of each gated DataTable. The function then loops through every well in the plate. For each well, an output folder is created and the well is analyzed using the function analyzeWell, which returns a list of statistical summary DataTables for the well. These are then appended to the corresponding DataTables for the plate. When all wells have been analyzed, the list of summary DataTables are saved to the output folder. This function is implemented in a programmable processor or computer as follows:",{"@attributes":{"id":"p-0084","num":"0097"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"analyzePlate("},{"entry":"\u2003\u2003ImageWellPlate plate,"},{"entry":"\u2003\u2003ImageNameScheme nameScheme,"},{"entry":"\u2003\u2003WellScanManager scanManager,"},{"entry":"\u2003\u2003File inputFolder,"},{"entry":"\u2003\u2003File outputFolder,"},{"entry":"\u2003\u2003AlgorithmChannelInfoList channelInfoList,"},{"entry":"\u2003\u2003AlgorithmGateInfoList gateInfoList)"},{"entry":"{"},{"entry":"\u2003\u2003create new DataTable statsTable;"},{"entry":"\u2003\u2003create new DataTableList statsTableList;"},{"entry":"\u2003\u2003add statsTable to statsTableList;"},{"entry":"\u2003\u2003for all AlgorithmGateInfo info in gateInfoList"},{"entry":"\u2003\u2003{"},{"entry":"\u2003\u2003\u2003\u2003create new DataTable statsGateTable;"},{"entry":"\u2003\u2003\u2003\u2003add statsGateTable to statsTableList;"},{"entry":"\u2003\u2003}"},{"entry":"\u2003\u2003for all ImageWell well in plate"},{"entry":"\u2003\u2003{"},{"entry":"\u2003\u2003\u2003\u2003create new File wellOutputFolder in outputFolder;"},{"entry":"\u2003\u2003\u2003\u2003DataTableList tableList = analyzeWell(well, nameScheme,"},{"entry":"scanManager, inputFolder, wellOutputFolder, channelInfoList);"},{"entry":"\u2003\u2003\u2003\u2003append each DataTable in tableList to corresponding statsTable;"},{"entry":"\u2003\u2003}"},{"entry":"\u2003\u2003write each DataTable in statsTableList to outputFolder;"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"analyzeWell: As seen in , this function creates an empty DataTable that will hold the complete set of measurements for all cells in the well. In general, it is impossible to analyze all images in the well at once, because there may be hundreds of images in a well, arranged in a rectangular \u201cscan\u201d that may be very large. The WellScanManager provides tools to sew these into \u201cclusters\u201d of adjacent images and takes care of the logic at the edges. It loops through each \u201ccluster\u201d of images and also loop through each channel, loading the cluster for each channel and analyzing them as an overlaid set of images using the function analyzeImage. This function returns a set of labeled masks, which we save to the output folder. It also inserts data into our DataTable. When all \u201cclusters\u201d have been analyzed for the well, the DataTable is saved to the output folder. Any gating operations are then performed on this DataTable, and all resulting DataTables are also saved. For each of the DataTables that we produce, we also create a statistical summary, which is saved to the output folder. These summary DataTables are returned to the calling function. This function may be implemented in a programmable processor or computer as follows:",{"@attributes":{"id":"p-0086","num":"0099"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DataTableList analyzeWell("]},{"entry":[{},"\u2003\u2003ImageWell well,"]},{"entry":[{},"\u2003\u2003ImageNameScheme nameScheme,"]},{"entry":[{},"\u2003\u2003WellScanManager scanManager,"]},{"entry":[{},"\u2003\u2003File inputFolder,"]},{"entry":[{},"\u2003\u2003File outputFolder,"]},{"entry":[{},"\u2003\u2003AlgorithmChannelInfoList channelInfoList,"]},{"entry":[{},"\u2003\u2003AlgorithmGateInfoList gateInfoList)"]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003create new DataTable dataTable;"]},{"entry":[{},"\u2003\u2003for all image clusters provided by scanManager"]},{"entry":[{},"\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003for all AlgorithmChannelInfo channel in channelInfoList"]},{"entry":[{},"\u2003\u2003\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003load image cluster from inputFolder into channel;"]},{"entry":[{},"\u2003\u2003\u2003\u2003}"]},{"entry":[{},"\u2003\u2003\u2003\u2003LabeledMaskList maskList = analyzeImage(wellName,"]},{"entry":[{},"wellDataTable, channelInfoList);"]},{"entry":[{},"\u2003\u2003\u2003\u2003for all LabeledMask labeledMask in maskList"]},{"entry":[{},"\u2003\u2003\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003write labeledMask to outputFolder;"]},{"entry":[{},"\u2003\u2003\u2003\u2003}"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003write dataTable to outputFolder;"]},{"entry":[{},"\u2003\u2003DataTable dataTableStats = dataTable.computeStats( );"]},{"entry":[{},"\u2003\u2003write dataTableStats to outputFolder;"]},{"entry":[{},"\u2003\u2003DataTableList tableList = applyGates(dataTable, dataTableStats,"]},{"entry":[{},"\u2003\u2003gateInfoList);"]},{"entry":[{},"\u2003\u2003return tableList;"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"analyzeImage: As seen in , this function segments a set of grayscale images to produce labeled masks, where the labeling provides a unique ID for each cell. The function also computes any required measurements and appends the results into a DataTable, which grows each time this function is called, until the entire well has been analyzed. In general, different algorithms will perform different segmentation operations and compute different measurements, so this analyzeImage function is unique to each algorithm. Some algorithms implement this with hard-wired code, but there is also an option to simply apply a pipeline of plug-ins directly to the images. This pipeline makes certain assumptions: it assumes it will take grayscale images as inputs, perform segmentation on them to produce labeled masks as outputs, and will also perform measurements on the images using the labeled masks and insert the results into a DataTable. In this way, we restrict the set of pipelines to a very useful subset of all possible pipelines. By doing this, we have a very simple user interface and yet still have a powerful plug-in architecture for doing complex image processing. This function may be implemented in a programmable processor or computer as follows:",{"@attributes":{"id":"p-0088","num":"0101"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"LabeledMaskList analyzeImage("]},{"entry":[{},"\u2003\u2003String wellName,"]},{"entry":[{},"\u2003\u2003DataTable dataTable,"]},{"entry":[{},"\u2003\u2003AlgorithmChannelInfoList channelInfoList)"]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003create new LabeledMaskList maskList;"]},{"entry":[{},"\u2003\u2003for all AlgorithmChannelInfo channelInfo in channelInfoList"]},{"entry":[{},"\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003lookup image in channelInfo;"]},{"entry":[{},"\u2003\u2003\u2003\u2003segment image to produce LabeledMask mask;"]},{"entry":[{},"\u2003\u2003\u2003\u2003add mask to maskList;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003create new ImageMeasurementList measurementList;"]},{"entry":[{},"\u2003\u2003for all measurements specified by algorithm"]},{"entry":[{},"\u2003\u2003{"]},{"entry":[{},"\u2003\u2003\u2003\u2003compute measurement on images and masks;"]},{"entry":[{},"\u2003\u2003\u2003\u2003add measurement to measurementList;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003add measurementList to dataTable;"]},{"entry":[{},"\u2003\u2003return maskList;"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"applyGates: As seen in , this function applies a set of gates to a DataTable to produce a set of gated DataTables. The gates can be \u201cchained\u201d together so that the output DataTable of one gate becomes the input DataTable for another one. This function takes care of the logic of connecting them together and returning all the DataTables in a list. This function may be implemented in a programmable processor or computer as follows:",{"@attributes":{"id":"p-0090","num":"0103"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DataTableList applyGates("},{"entry":"\u2003\u2003DataTable dataTable,"},{"entry":"\u2003\u2003DataTable dataTableStats,"},{"entry":"\u2003\u2003AlgorithmGateInfoList gateInfoList)"},{"entry":"{"},{"entry":"\u2003\u2003create new DataTableList tableList;"},{"entry":"\u2003\u2003add dataTableStats to tableList;"},{"entry":"\u2003\u2003for all AlgorithmGateInfo gateInfo in gateInfoList"},{"entry":"\u2003\u2003{"},{"entry":"\u2003\u2003\u2003\u2003lookup Gate for info;"},{"entry":"\u2003\u2003\u2003\u2003lookup DataTable sourceTable for info;"},{"entry":"\u2003\u2003\u2003\u2003apply gate to sourceTable to produce DataTable resultTable;"},{"entry":"\u2003\u2003\u2003\u2003add resultTable to tableList;"},{"entry":"\u2003\u2003}"},{"entry":"\u2003\u2003return tableList;"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"As seen in , , , and  the GUI includes a pipeline editor having a dialog with four tabs that match the conceptual workflow of creating a new pipeline. The tabs are: Inputs, Pipeline, Details, and Test.","Inputs Tab: As is evident with reference to , the GUI enables a user to define the input channels for an image processing algorithm with the following fields:","Name of Algorithm: Alphanumeric string that is the name of the created algorithm.","Number of Channels: Integer spinner field that allows the user to specify the number of channels. Changing this value changes the number of rows in the table \u201cChannels and Their Default Values.\u201d","Channels and Their Default Values: A table in which each row represents a channel. Each column is editable by clicking the field. The names, data types, and edit controls include:","Channel Name: Alphanumeric string editor that is the name of the channel","Channel Image Abbreviation: Alphanumeric string editor that is used as the abbreviation for this channel.","Required: checkbox (Boolean) value","Prefilter: Menu choice currently of \u2018None,\u2019 \u2018Median,\u2019 or \u2018Average.\u2019","Filtering Radius: Integer spinner control with a value greater then zero.","Threshold: Menu choice of supported threshold techniques.","Size Parameter: Alphanumeric string editor","Size Value Numeric: value editor that turns red when non-valid strings are entered","Pipeline Tab: As is evident with reference to , the GUI enables a user to assemble a pipeline image process using selected plug-in functions and the following fields:","Input Type: Combo box control that filters the \u201cAvailable Plugins\u201d list based upon their input types.","Output Type: Combo box control that filters the \u201cAvailable Plugins\u201d list based upon their output types.","Add >>: Button that adds the selected \u2018Available Plugin\u2019 into the \u2018Pipeline Plugins\u2019 control.","Available Plugins: List of available plugins that can be added to the pipeline.","Pipeline Inputs Table of the pipeline inputs based upon the \u201cChannels and Their Default Values\u201d table on the \u201cInputs\u201d tab. Note that each row on the \u201cChannels and Their Default Values\u201d table contributes several rows to this table.","Pipeline Plugins: List of plugins that make up the current pipeline. The plugins appear in order from top to bottom. The inputs for the currently selected plugin appear in the \u201cPlugin Inputs\u201d table on the right. Note that plugins with properly connected inputs appear in black, while improperly connected plugins are indicated in red.","Details . . . : Button that brings up the \u201cPlugin Resource Editor\u201d dialog for the selected plugin. This button is disabled when no plugin is selected. See section below.","Remove: Button that removes the selected plugin in the \u201cPipeline Plugins\u201d list. The list is then updated removing the selected plugin and updating any plugins that relied on the output of the deleted plugin so that they now have an invalid connection and appear in red. This button is disabled when no plugin is selected.","Move Up: Button that moves the currently selected plugin up by one position in the \u201cPipeline Plugins\u201d list. The list is then updated updating any plugins that now has invalid connections so they appear in red. This button is disabled when no plugin is selected or when the top item on the list is selected.","Move Down: Button that moves the currently selected plugin down by one position in the \u201cPipeline Plugins\u201d list. The list is then updated updating any plugins that now have invalid connections so they appear in red. This button is disabled when no plugin is selected or when the bottom item on the list is selected.","Plugin Inputs: Table with columns \u201cPlugin Inputs\u201d and \u201cConnections\u201d That represent the inputs for the currently selected plug-in. The values in the connections column are editable with a combo box that shows all valid options for that input (i.e. of the same type that are pipeline inputs or are outputs of a previous pipeline.) Note that when all inputs are set, the plug-in will appear in black on the \u201cPipeline Plugins\u201d list. Plug-ins that do have unconnected inputs will appear in red.","Pipeline Types: List of possible types of outputs for the pipeline as a whole.","Add: Button that creates a new output of the type selected on the list \u201cPipeline Types\u201d and adds it to the \u201cConnect Outputs\u201d table. This button is disabled when no item is selected on the \u201cPipeline Types\u201d list.","Remove: Button that removes the selected row from the \u201cConnect Outputs\u201d table. This item is disabled when no items are selected on the \u201cConnect Outputs\u201d table.","Connect Outputs: Table with three columns \u201cType of Output,\u201d \u201cName,\u201d and \u201cConnection.\u201d The name and connection columns are editable. Name is an alphanumeric field that is simply the name of the output. Connection is a menu of items, of based on the type column, from the pipeline plug-ins or pipeline inputs.","Plugin Resource Editor dialog: As is evident with reference to , the GUI enables a user to assemble a pipeline image process using selected plug-in functions and the following fields. This dialog appears in response to the \u201cDetails\u201d button on the pipeline tab and it contains the details of the currently selected plug-in.","Plugin Class: The java class of the associated plug-in.","Plugin Name: Alphanumeric name of the associated plug-in. This field can be edited to change the name.","Comment: Alphanumeric field to allow the user to comment about this plugin.","Short Description: The short description of this plugin.","Long Description: The long description of this plugin.","Input Types: Table with the columns \u201cInput Types,\u201d \u201cInput Names,\u201d and \u201cModified In-Place?,\u201d none of which are editable. Information associated with the currently selected row appears in the \u201cSelected Resource\u201d group.","Output Types: Table with the columns \u201cOutput Types\u201d and \u201cOutput Names,\u201d neither of which are editable. Information associated with the currently selected row appears in the \u201cSelected Resource\u201d group.","Selected Resource: Group of controls that represent the current state of the selected row in either the input types or output types tables. Note only one item on both those list can be selected at one time.","Name: Editable alphanumeric name of the currently selected resource.","Info: Editable alphanumeric field of the currently selected resource.","Clone From Context Before Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","View After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","View In Debug Mode: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Write To File After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Write To File In Debug Mode: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Save To Context After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Remove From Context After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Default: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource. Controls associated with this checkbox appear depending on the resource type selected.","Details Tab: As is evident with reference to , the GUI Details tab plays the same role for the plugin as a whole as the Plugin resource editor above does for a single plugin within the pipeline. Thus it has the same controls and behaves the same.","Plugin Class: The java class of the associated plugin.","Plugin Name: Alphanumeric name of the associated plugin. This field can be edited to change the name.","Comment: Alphanumeric field to allow the user to comment about this plugin.","Short Description: The short description of this plugin.","Long Description: The long description of this plugin.","Input Types: Table with the columns \u201cInput Types,\u201d \u201cInput Names,\u201d and \u201cModified In-Place?,\u201d none of which are editable. Information associated with the currently selected row appears in the \u201cSelected Resource\u201d group.","Output Types: Table with the columns \u201cOutput Types\u201d and \u201cOutput Names,\u201d neither of which are editable. Information associated with the currently selected row appears in the \u201cSelected Resource\u201d group.","Selected Resource: Group of controls that represent the current state of the selected row in either the input types or output types tables. Note only one item on both those list can be selected at one time.","Name: Editable alphanumeric name of the currently selected resource.","Info: Editable alphanumeric field of the currently selected resource.","Clone From Context Before Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","View After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","View In Debug Mode: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Write To File After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Write To File In Debug Mode: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Save To Context After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Remove From Context After Plugin Executes: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource.","Default: Checkbox that is only enabled and can only be checked when it applies to the currently selected resource. Controls associated with this checkbox appear depending on the resource type selected.","Test Tab: As is evident with reference to , the GUI Test tab allows the user to test the current pipeline.","Imaging Naming Convention: Combo box with list of known or applicable naming conventions. Naming conventions are naming format of source folders","Source Folder: The string path to the folder that contains the source images. The browse button associated with this control brings up a dialog to allow the user to traverse the file system and select a source folder. Selecting a folder using this dialog will fill in the source folder field path.","Destination Folder: The string path to the folder that contains or will contain the data and images created by running this algorithm. The browse button associated with this control brings up a dialog to allow the user to traverse the file system and select a destination folder. Selecting a folder using this dialog will fill in the destination folder field path.","Channel table: Table that allows the user to specify the input fields for each channel of this algorithm for the test run. It has the following columns:","Channel Name: Not editable","Channel Folder: Menu of valid selections","Analyze: checkbox (Boolean) value","Prefilter: Menu choice currently of \u2018None,\u2019 \u2018Median,\u2019 or \u2018Average.\u2019","Filtering Radius: Integer spinner control with a value greater then zero.","Threshold: Menu choice of supported threshold techniques.","Sensitivity %: Integer spinner control with a value greater then zero","Size Parameter: Not editable.","Size Value Numeric value editor that turns red when non-valid strings are entered","Well: List of wells for this test.","Test Pipeline: Button that allows the user to test this pipeline. Only enabled when all folders and channels values are valid.","View Images: Button that brings up image dialog with images associated with this test.","View Data: Button that brings up data viewer dialog with data associated with this test.","The processing workflow and GUI features disclosed above enable a user to select and initialize an image processing algorithm, establish and configure processing channels for features in the images to be processed, and specify parameters for performing data analysis of the image processing results. With reference to , an example of a method for performing automated image analysis with GUI management and control of an image processing pipeline workflow and data analysis is discussed. In the form of a workflow, the method includes the following acts:\n\n","Initially, presume that a user creates a hypothesis about how a certain type of biological cell or tissue sample will respond to a new set of conditions. In , an example image is made of cells in an experiment measuring hormone regulation of pHSLserine660. The representative image has nuclei shown in blue, lipid droplets shown in green and the pHSLserine660 shown in red. An antibody was used that specifically recognizes hormone sensitive lipase that has been phosphorylated on amino acid #660, which is a serine. Hormone Sensitive Lipase (HSL) is phosphorylated on serine 660 by cAMP-dependent protein kinase, and likely by other kinases that are regulated by hormones. The hormone that was used was Lys-gamma-Melanocyte Stimulating Hormone and the concentrations are in nM. There is increasing interest in this hormone in adipocyte biology.","A biologist would like to measure the exact nature of this response. Presume that she can visualize the qualitative response but can't readily systematically quantify the response. The quantification requires a prohibitive amount of time and is error prone, if possible at all. The tissues of interest are prepared such that a digital microscope such can acquire and save an image of the relevant features can be acquired and saved for further processing. In this case, lipids and pHSLserine660 are tagged with fluorescent labels and imaged with a standard fluorescent digital microscope. Using a GUI Opening screen seen in  the user is able to select, initialize, and launch an image processing algorithm. Then, using one or both of an image viewer and a data viewer selected from the Opening screen drop down menu of , the user can view and assess image processing results and view data analysis of those results.","With reference to , if a validated algorithm for this type of sample already exists, there is a Define Algorithm interface for the user to choose the correct algorithm. The user may optimize one or two basic parameters for the specific experiment. Due to variable staining and imaging conditions, an algorithm's sensitivity may need adjusting using the GUI menu of . Using the Opening screen Wells to Run Algorithm On, , the wells whose images are to be processed are identified. Given a known algorithm, the analysis is executed.","Once the image processing algorithm processing is complete, the user may want to visually verify that the masks created match her expectations. An image with masks created by the algorithm is viewed using the Image Viewer entry in the menu seen in ; the image is viewed as in . In the image, an overlay of yellow and red outlines of the automatically generated masks of the nuclei and lipids are assessed by the user. If the masks do not meet expectations, then the user may elect to have the designated images reprocessed with new sensitivity settings. This may be repeated heuristically until the user is either satisfied with how well the algorithm is generating a representative mask or decides that a more sophisticated algorithm is required.","If the user believes the masks are good enough, she may proceed to the numerical analysis of the biological question: How does the biology vary with respect to different conditions?","With the image processing algorithm processing completed, many measurements are now available for every cell, well and sub-cellular region defined algorithm generated masks, and the user may select the Data Viewer via the Opening screen menu seen in . Some of the data viewer outputs are seen in .","In this regard,  image shows two representative bar graphs comparing groups of wells that share the same experimental conditions. In this case, the response is with respect to Melanocyte Stimulating Hormone. The user may not know exactly which measurement will be the most reliable or responsive. She may explore and select from the data viewer outputs set forth in the list of measurements displayed in the left most column to see what kind of data is generated.","The summary statistics viewed in  constitute a final snapshot of the experiment in question. It may be important to understand how different the two populations of wells represented in  are with respect to one another. It may be important to describe how reliable the measurement will be in a large scale screening environment. The scope and manner that users may want to interrogate their data can be very broad.","If the statistical results aren't good enough for the experiment to be considered complete, opportunities for improvement are:","Gating: are the correct cells being used for the experiment?","Is the correct measurement being used?","Is the selected algorithm performing well enough?","Can the selected algorithm be improved with new settings or is a new algorithm required?","During image processing, the algorithm has identified every cell in the image and assigned a cell ID.  demonstrates that each cell has a unique ID and that each unique cell has a set of unique measurements. Using the gating screen of , an arbitrary set of filters can be set up so that only the cells of interest are used in the numerical analysis of image processing results. If changing the settings and adjusting the gating of an existing algorithm doesn't give the needed results, a new algorithm may be required. The user then returns to the Input screen as per .","One set of algorithms may comprise combinations of core functions from the other algorithms. For example, for an arbitrary number of colors, the nuclear segmentation function of one algorithm might be combined with cell border segmentation of another algorithm and the sub-cellular body segmentation of a third known algorithm. All of the names and default parameters are set to fit the experiment. An algorithm to measure lipid droplets may only require minor naming and key parameter adjustments to be suitable measure myofibrils in heart cells. Sometimes a completely new algorithm is required. These are characterized by the use of well established image processing techniques to manipulate the images. The core architecture of managing the images, results, masks, statistics, gating and graphing are all maintained but novel core segmentation or analysis technique may need development.","Although the invention has been described with reference to presently preferred embodiments, it should be understood that various modifications can be made without departing from the spirit of the invention. Accordingly, the invention is limited only by the following claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 6","FIG. 6"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 23","FIG. 20"]},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":["FIG. 25","FIG. 20"]},{"@attributes":{"id":"p-0054","num":"0053"},"figref":["FIG. 26","FIG. 20"]},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 30"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 31","FIG. 20"]}]},"DETDESC":[{},{}]}
