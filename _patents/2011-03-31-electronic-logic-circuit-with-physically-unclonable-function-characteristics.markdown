---
title: Electronic logic circuit with physically unclonable function characteristics
abstract: A physically unclonable function (PUF) device, with corresponding method, is provided for characterizing an integrated circuit. The PUF device includes a digital clock manager (DCM), a Butterfly circuit incorporated within the integrated circuit, and a shift register. The DCM receives a clock input signal (CLK) and imposes a temporal offset to produce a phase-shift signal (PS). The Butterfly circuit receives a first excite signal as said CLK and a second excite signal as said PS. In response, the Butterfly circuit produces an output that shifts state in response to a non-concurrent change in the CLK and PS. The shift register increments a shift count in response to the output.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08274306&OS=08274306&RS=08274306
owner: The United States of America as represented by the Secretary of the Navy
number: 08274306
owner_city: Washington
owner_country: US
publication_date: 20110331
---

{"@attributes":{"id":"description"},"GOVINT":[{},{}],"heading":["STATEMENT OF GOVERNMENT INTEREST","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The invention described was made in the performance of official duties by one or more employees of the Department of the Navy, and thus, the invention herein may be manufactured, used or licensed by or for the Government of the United States of America for governmental purposes without the payment of any royalties thereon or therefor.","The invention relates generally to physically unclonable function (PUF) circuits. In particular, the invention relates to incorporation of a Butterfly circuit in conjunction with a Digital Clock Manager (DCM) to provide a PUF.","The United States Armed Forces require processes to render a Field Programmable Gate Array (FPGA) used in military hardware to be secure from tampering. An FPGA represents a configurable type of integrated circuit (IC) whereby the detailed logic design is programmed in after manufacturing by the customer. Selectable programming code for the FPGA can be designed so as to operate only on authorized hardware.","Conventional integrated circuits yield disadvantages addressed by various exemplary embodiments of the present invention. In particular, various exemplary embodiments provide a physically unclonable function (PUF) device provided for characterizing an integrated circuit. The PUF device includes a digital clock manager (DCM), a Butterfly circuit incorporated within the integrated circuit, and a shift register. The DCM receives a clock input signal (CLK) and imposes a temporal offset to produce a phase-shift signal (PS).","In various exemplary embodiments, the Butterfly circuit receives a first excite signal as said CLK and a second excite signal as said PS. Correspondingly, the Butterfly circuit produces an output that shifts state from a non-concurrent change in the CLK and PS. The shift register increments a shift count in response to the output.","In the following detailed description of exemplary embodiments of the invention, reference is made to the accompanying drawings that form a part hereof, and in which is shown by way of illustration specific exemplary embodiments in which the invention may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention. Other embodiments may be utilized, and logical, mechanical, and other changes may be made without departing from the spirit or scope of the present invention. The following detailed description is, therefore, not to be taken in a limiting sense, and the scope of the present invention is defined only by the appended claims.","In accordance with a presently preferred embodiment of the present invention, the components, process steps, and\/or data structures may be implemented using various types of operating systems, computing platforms, computer programs, and\/or general purpose machines. In addition, those of ordinary skill in the art will readily recognize that devices of a less general purpose nature, such as hardwired devices, or the like, may also be used without departing from the scope and spirit of the inventive concepts disclosed herewith. General purpose machines include devices that execute instruction code. A hardwired device may constitute an application specific integrated circuit (ASIC) or a floating point gate array (FPGA) or other related component.","Various exemplary embodiments utilize at least one Physically Unclonable Function (PUF) to achieve such security. The PUF constitutes a physical circuit feature that can be embedded in its mechanical structure. Such techniques can be relatively straightforward to evaluate, but difficult to characterize. Such features can be useful in challenge-response type authentication.","For a given model, identical ICs have small unpredictable differences due to random variations in the manufacturing process. These differences can manifest themselves in gate delays. The PUF may be implemented as circuits with built-in race conditions, designed to be sensitive to variation in gate delay from manufacturing process. Each circuit employing a PUF has a unique output for the same input.","A bi-stable circuit known as the \u201cButterfly\u201d has been proposed for, inter alia, identifying a specific FPGA chip. Conventionally, a Butterfly circuit requires symmetric interconnections which may limit the number of usable FPGA cells that can be utilized to implement the Butterfly circuit. Various exemplary embodiments provide an improved use of a Butterfly circuit whereby the FPGA's Digital Clock Manager (DCM) provides for a phase-shifted excite signal to compensate for asymmetric interconnections. In addition to utilizing all FPGA cells, the approach enables multiple bits of characterization information for each Butterfly circuit as a separate component.","The Butterfly circuit originated by Kumar et al. represents an implementation of a Physical Unclonable Function (PUF). See Sandeep S. Kumar, Jorge Guajardo, Roel Maes, Geert-Jan Schrijen and Pim Tuyls \u201cExtended Abstract: The Butterfly PUF Protecting IP on every FPGA\u201d, -(June 2008), pp. 67-70 at https:\/\/www.cosic.esat.kuleuven.be\/publications\/article-1154.pdf.","The PUF has been a subject of interest in the security engineering community, as noted by Daihyun Lim, Jae W. Lee, Blaise Gassend, G. Edward Suh, Marten van Dijk and Srinivas Devadas, \u201cExtracting Secret Keys From Integrated Circuits\u201d, () , v. 13, no. 10 (October 2005), pp. 1200-1205, being available at http:\/\/www.csl.comell.edu\/\u02dcsuh\/papers\/tvlsi05.pdf, as well as by G. Edward Suh and Srinivas Devadas, \u201cPhysical Unclonable Functions for Device Authentication and Secret Key Generation\u201d, 44(June 2007), pp. 9-14, available at http:\/\/www.csl.comell.edu\/\u02dcsuh\/papers\/dac07.pdf.","The PUF can be employed for the purpose of uniquely identifying a specific electronic circuit such as for detection of counterfeit products, protection against software piracy, and protection of FPGA design Intellectual Property (IP). The PUF may be relevant to prevent cloning and\/or reverse engineering of military CT, as described at http:\/\/at.dod.mil\/docs\/AT_Brochure.pdf.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["100","110","120","130","110","120","110","112","114","116","118","120","122","124","126","128"]},"The operation of the Butterfly circuit  begins with an excite signal  that provides simultaneous high input to both the PRE lead  on the first D-latch  and the CLR lead  on the second D-latch . These denote the exterior-facing leads. The CLR lead  on the first D-latch  and the PRE lead  on the second D-latch  constitute the interior-facing leads. Inputs to the interior-facing CLR and PRE leads ,  are set to zero via respective signal pathways. Artisans of ordinary skill will recognize that this represents the \u201clogic\u201d zero, although some physical electronic realizations may represent logical zero with a non-zero quantity of potential or current, e.g., negative voltage. A step decrease  (or step increase) in signal voltage represents an exemplary such excitation source that proceeds along control input paths  and  to the leads for their respective D-latches  and . The combined output  joins both Q-output values ,  from the first and second D-latches  and .","For typical signaling in a digital system, the excite signal  ideally terminates with a precipitous fall-off, such as shown by the decrease . Upon cessation of the excite signal , the Butterfly circuit  occupies an unstable state, eventually attaining an equilibrium whereby the latch Q-output values are either both high or else both low. Because the respective excite signals on the two arms of the circuit  cease concurrently, proper function of the Butterfly's circuitry dynamics necessitates that both the excite leads and the cross feedback connections be symmetric with regard to time delay paths.","During this unstable phase, the Butterfly circuit  utilizes mutual feedback to provide competitive dynamics between the two latches ,  as arms of the circuit . For example, one arm can push the outputs high while the other pushes them low. Variations in the semiconductor manufacturing process, affecting the gate delays, can cause one arm to have a slight temporal advance over the other arm, in the competitive dynamics.","These variations should be unique to a specific FPGA circuit because, like a snowflake, no two circuits of the same product type or model are exactly alike. In particular, a group of Butterfly circuits can be implemented on an FPGA. These Butterflies can be used to identify that specific FPGA by their unique pattern of output bits produced by execution thereon.","This above capability can have significant security engineering applications. For instance, the Butterflies, as part of a challenge-response type system, can be used to prevent execution of proprietary code on another FPGA, and to inhibit software or Intellectual Property (IP) piracy or else reverse engineering of IP. See Ross Anderson, , ch. 2: Protocols, John Wiley (2001), available at http:\/\/www.cl.cam.ac.uk\/\u02dcrja14\/Papers\/SE-02.pdf.","This imposes strict conditions on the layout of interconnects and the number of gates in the FPGA interconnect switch matrix, called a switch box or S-box. However, FPGA matrices may not usually provide for symmetric interconnections as illustrated in . This situation can either affect the Butterfly circuit with regard to the excite signals  or the cross coupling signals  (or both).",{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 2A","FIG. 2B"],"b":["200","210","140","110","220","120","230","240","110","120","250","120","110"]},"Not only can the absolute lengths of the respective arms vary, but also the number of gates in the interconnection matrix (switch box) may vary from one arm to the other, thereby increasing the effective length of one arm with respect to the other with associated differences in propagation delays. This situation arises because the FPGA designers, due to the inherent trade-off design requirements choose to forego having symmetric interconnections available to every possible pair of FPGA cells, because this would require an impractically large switching matrix that yields too much precious chip real estate devoted to interconnections.","The ability to generate interconnection pathways that comprise a comparatively limited number of switch gates and routing paths of standard lengths, with existing FPGA design practices, enables smaller switch boxes and smaller areas devoted to interconnect pathways. This technique saves space for other circuitry on the FPGA, albeit not usually resulting in symmetric interconnections. This situation appears to limit the number of FPGA cells that can be used to implement Butterfly circuits on some FPGAs.","The restrictive timing tolerances for the Butterfly circuit  (and possibly other types of PUFs) are not necessary for the vast majority of circuits implemented on FPGAs. Feed-forward circuits have signals that originate from widely separate locations on the chip and thus may require clock skew compensation for synchronization. This is because Butterflies belong to a class of circuits that incorporate feedback whereas the vast majority of FPGA circuits are of feed-forward architectures. In fact, standard accepted FPGA design methodologies discourage incorporation of these types of feedback circuits, which exhibit undesirable behaviors known as race conditions. Often, these race conditions lead to unpredictable behavior when trigged by inputs of variable timing.","The very feedback architectures with associated race conditions represent the essential component for the characterization and identification function as provided in various exemplary embodiments, being driven by the inherent manufacturing variability of ICs. Therefore to provide for the ability to do characterization and identification that can utilize every possible FPGA cell, preferred embodiments overcome the inherent limitations of conventional FPGA architectures with regard to use of circuits containing feedback.","The disclosed embodiments describe an implementation on an FPGA containing a DCM. For additional information on the DCM, See -4 , ch. 2, UG070 (v2.6), Xilinx\u00ae Corp. (1 Dec. 2008) available at http:\/\/www.xilinx.com\/support\/documentation\/user_guides\/ug070.pdf. Advanced FPGA designs such as the Xilinx Virtex series (e.g., Virtex-4) use the DCM, for among other things, clock frequency synthesis, clock skew correction and jitter correction.","As a byproduct for supporting some of the aforementioned functions, the DCM can implement a phase-shifted version of the clock signal using a Digital-delay Locked Loop (DLL). Phase-shifting applied to one arm of the Butterfly circuit  can correct for the asymmetry of the interconnection. The Xilinx Virtex-4 DCM can support up to 1024 discrete increments of clock phase-shift.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 3","b":["300","300","310","320","330","340","350","360"]},"A first delay  temporally separates the leading CLKIN  and following PSEN  signals. An analogous similar delay  separates the CLKIN  and PSINCDEC . A second delay  temporally separates the leading PSCLK and following CLKIN . This process supports variable phase-shift. On the Virtex-4 FPGA, up to 1023 discrete phase increments can execute across the entire 2\u03c0 (i.e., 0\u00b0 to 360\u00b0) phase-shift, with \u02dc260 clock cycles to implement phase-shift increment.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 4","b":["400","110","120","140","100"]},"An upper arm latch signal  for the upper latch  exhibits a clock (CLK) unshifted signal , an enable signal  and an excite signal . A lower arm latch signal  for the lower latch  exhibits a CLK phase-shifted signal , an enable signal  and an excite signal . A phase-shift  distinguishes the CLK and excite signals between the latches  and  by a temporal offset. This illustrates respective effects of latch input CLK signals, input enable signals and output excite signals for latches of upper and lower arms, whereby the output of the lower arm excite signal is phase-shifted with respect to upper arm.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 5","b":["500","510","520","200","530","140","110","540","120","530","540","580"]},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 6","b":["600","600","500","600"]},"In this circuit , an input clock signal  can be conveyed directly by first branching signal pathways  to a DCM , a controller  and to the upper arm latch . The circuit  uses the DCM  to correct for asymmetric interconnection delays by inducing a range of phase delays on the lower input arm of the Butterfly circuit  under characteristic evaluation. A corresponding lower arm latch  receives output from the DCM  through which a phase-shifted clock signal conveys to the lower latch  by a first direct signal pathway .","The DCM  is controlled by the aforementioned controller  containing a register  holding a value that represents the number of phase-shift increments. During an operational run, at the beginning of a phase increment cycle, the controller  initiates a clock phase-shift change signal through a second direct signal pathway . A third signal pathway  may serve for auxiliary functions. Upon completion of the phase-shift, the controller  receives an acknowledgment signal through a third direct signal pathway , whereby the controller  increments the counter register .","Via second and third branching signal pathways  and , the controller  affects the latches  and  connected respectively to the upper and lower inputs of the Butterfly circuit . The latches  and  are asynchronously gated D-type latches with PRE gate inputs. The latches  and  provide the Butterfly circuit's excite signal  with the controller  connected to the respective clock or clock-enable inputs.","These connections operate via the second branching signal pathway  and the respective PRE gate inputs via the third branching signal pathway  with clock (CLK) inputs un-shifted from the first branching signal pathways  and phase-shifted from the first direct signal pathway  through the latches  and . This provides respectively for excite signals that are in phase with the corresponding un-phase-shifted and phase-shifted clock signals.","The aforementioned D-type latches  and  are distinct, being in addition to latches contained within the Butterfly circuit . Eventually during a cycle, about the time a phase-shift is initiated, a signal to raise the Butterfly circuit's excite signal  to high asserts for a limited period (approximately the clock cycle's duration) to the PRE inputs of the latches  and  via the aforementioned third branching signal pathway , the excite signals being conveyed to respective upper and lower input arms of the circuit  via fourth and fifth direct signal pathways  and .","Immediately after completion of the phase-shift, a gate (or clock) enable signal for the latches  and  can be imposed for a finite time (about the duration of a clock period) to the gate enable inputs via the second branching signal pathway . This sets the excite signals  on the fourth and fifth and direct signal pathways  and  to low at the respective instants that their corresponding un-shifted and shifted clock signals are input to latches  and  via the first and second respective direct signal pathways  and .","Upon the switching off of the excite signals, with one arm having delay relative to the other to compensate for interconnection asymmetries, the Butterfly circuit  undergoes competitive dynamics converging on a stable output state sometime shortly after the initiation of the operation of the circuit . As described in Kumar et al., upon attaining equilibrium, the circuit  outputs either a high or low voltage signal.","Upon proceeding through a range of phase-shifts, when the Butterfly circuit's output changes from high to low (or the converse), the process stops. A two-bit shift register  receives an output from the Butterfly circuit  from a sixth direct signal pathway , having each bit connected to an XNOR gate  used to detect the change in output of the circuit .","The shift register  stores the current output and the previous output, corresponding to the previous phase-shift increment. In a special initialization example, the beginning of an operative execution over a range of DCM increments, the output of both bits in the shift register  may be set to the output of the Butterfly circuit . For each subsequent DCM increment, only the leftmost bit sets to the output of the Butterfly circuit  as conveyed by the signal pathway . The specific count of phase-shift increments characterizes a particular implementation for the Butterfly circuit . Upon detecting a change in output, the XNOR gate  sends a signal back to the controller  via a seventh direct signal pathway , stopping the process. The value contained in register  can be read out by a data bus .","These embodiments provide multiple bits of characterization information that correspond to the number a phase increments required to change the output of the Butterfly circuit . Many of the bits (particularly the high value bits) represent the gross delay imposed by the interconnection architecture's asymmetry, but some of the bits (particularly those having low value) represent the specific chip delay due to the unique chip manufacturing variation.","Because the phase-shifting of the DCM  compensates for the interconnection asymmetry, any combination of FPGA cells can be utilized without concern for asymmetry delays in the Butterfly circuit's cross connections . Thus, the gate input (or clock input) on the Butterfly circuit's latches  and  of  may be optional.","A group of multiple circuits in the manner of the above can be implemented on a single FPGA and should provide some number of bits for characterization that can be used in a manner such as a unique identifier. A test program could be accomplished using implementations of the above circuits to provide sufficient characterization and identification information to the required number of bits for security, anti-piracy and anti-tamper applications such as challenge-response algorithms.","Because FPGAs have many cells and multiple DCMs, the challenge involves incorporating the specific FPGA cells for the Butterfly circuits and\/or the specific DCMs. The output bits from multiple circuits of the above type implemented on a single, specific FPGA may be combined and manipulated by mathematical formula to provide for various functions such as error correction due to random noise and hashing to emphasize the unique bits due to manufacturing variation from the bits due to the architecturally imposed delay. The phase relationship versus the number of phase-shift increments of the DCM may depart from a perfect linear relationship.","Each FPGA may have multiple DCMs, each of which has a non-linear component of its phase response. These non-linear responses may be incorporated as an alternate mechanism to provide specific FPGA characterization and identification information. For instance the phase response as a function of the increment value may be a polynomial function, the set of representative polynomial coefficients of which would characterize the specific DCM of a specific FPGA to be used for identification bits.","Conventional designs indicated the following problems:","(a) Asymmetric interconnections;","(b) Non-uniform signal delays between arms;","(c) FPGA Architectural characteristics overwhelm manufacturing variability; and","(d) Same output for any FPGA on most implementations of Butterfly circuits.","Exemplary embodiments provide an FPGA DCM to compensate for asymmetry. The advantages include:","(a) Modern FPGAs have DCMs to support clock de-skew;","(b) Phase-shift can be induced;","(c) Compensation for asymmetric interconnection signal delay variability can be performed;","(d) Measurement of manufacturing variability can be enabled; and","(e) More than one bit ID info per Butterfly circuit can be included.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 7","b":["700","600","710","610","620","410","720","620","610","450","730","630","410","450","740","410","440","450","480","500","675"]},"At a logic query for the fifth step , if the output signal has changed from the previous clock cycle, then the shift register  increments a circuit counter in response at a sixth step . Otherwise, the process returns to the first clocking step . The number of counts in a shift register for a particular series of clock cycles constitutes a unique value for each circuit  to be evaluated. The value can be reported via the bus  to a database for resource compilation.","Preliminary results have shown high accuracy for the approach described herein. Two identical Virtex-4 FPGAs have been tested. On multiple FPGAs, the error between matching butterflies implemented on matching FPGA cells is about two orders of magnitude less than the non-matching cells.","The Butterfly circuit incorporated in combination with the Digital Clock Manager (DCM) enables differences in arms to provide electronic distinctions, such as by phase-shifted excite and clock signals. A specific FPGA, such as including a Butterfly circuit , may thus be characterized or identified by assessing the number of phase-shift increments that results in a Butterfly circuit changing its output from high to low or conversely, from low to high.","This process includes characterization and\/or identification of a specific IC using an evaluation circuit that implements a race condition in conjunction with a phase-shifted input. For various exemplary embodiments, the input has a variable phase-shifting, such that the evaluation circuit exhibits a change in behavior by a phase-shifted signal at a specific phase-shift increment, such that the specific value of the phase-shift or the specific phase-shift increment is utilized in the characterization and\/or identification of the circuit.","This process can be employed to characterize and\/or identify a specific FPGA or other IC by resulting identification bits in a challenge-response or related security algorithm for the purpose of IP protection, thereby inhibiting software piracy, anti-counterfeiting and\/or as a defense against reverse engineering. This includes any manner of mathematically combining and\/or manipulating said bits from multiple units of the aforementioned circuits to form products, moments, ratios and\/or any kind of characterization via some mathematical formula for the purpose of specifically identifying an FPGA or some type of IC.","Any programming, bit codes or IP implementing the aforementioned circuit on an FPGA. A challenge response having an input \u201cchallenge\u201d involving the selection of specific FPGA cells, routing paths and\/or specific DCMs. Use of any non-linearities in the DCM as a source of identifying information. Upon cessation of excite signal, depending on manufacturing variability, the latches reach equilibrium with both simultaneously having either high or low output at each Q-output lead.","While certain features of the embodiments of the invention have been illustrated as described herein, many modifications, substitutions, changes and equivalents will now occur to those skilled in the art. It is, therefore, to be understood that the appended claims are intended to cover all such modifications and changes as fall within the true spirit of the embodiments."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and various other features and aspects of various exemplary embodiments will be readily understood with reference to the following detailed description taken in conjunction with the accompanying drawings, in which like or similar numbers are used throughout, and in which:",{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIGS. 2A and 2B"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
