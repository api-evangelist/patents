---
title: Hidden conditional random field models for phonetic classification and speech recognition
abstract: A method and apparatus are provided for training and using a hidden conditional random field model for speech recognition and phonetic classification. The hidden conditional random field model uses feature functions, at least one of which is based on a hidden state in a phonetic unit. Values for the feature functions are determined from a segment of speech, and these values are used to identify a phonetic unit for the segment of speech.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07627473&OS=07627473&RS=07627473
owner: Microsoft Corporation
number: 07627473
owner_city: Redmons
owner_country: US
publication_date: 20041015
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"p":["The present invention relates to phonetic classification and speech recognition. In particular, the present invention relates to models used to perform automatic phonetic classification and speech recognition.","In phonetic classification and speech recognition, Hidden Markov Models (HMMs) have been used extensively to model the acoustics of speech. HMMs are generative models that use the concept of a hidden state sequence to model the non-stationarity of the generation of observations from a label. At each frame of an input signal, the HMM determines the probability of generating that state from each possible hidden state. This probability is determined by applying observed values derived from the frame of speech to a set of probability distributions associated with the state. In addition, the HMM determines a probability of transitioning from a previous state to each of the states in the Hidden Markov Model. Using the combined transition probability and observation probability, the Hidden Markov Model selects a state that is most likely to have generated the frame.","One limitation of Hidden Markov Models is that the probabilities of each state are determined using the same observed values, and thus the same collection of observed values are used against each state. This limitation is undesirable because different observed values are more important for certain speech sounds than for others. For example, when distinguishing vowel sounds from each other, the value of the formants are important. However, when distinguishing between fricatives, information as to whether the speech is voiced or unvoiced is informative. Thus, it would be desirable to be able to use different observed values for states associated with different speech sounds. However, HMM systems do not allow this.","In addition, HMM models do not allow a change in the length of between-frame dependencies for the observed values. Thus, at each frame, the observed values provide a fixed amount of information about previous frames. To help distinguish between speech sounds, it would be desirable to allow for different length frame dependencies for states associated with different speech sounds.","In the field of sequence labeling, conditional random field models have been used that avoid some of the limitations of Hidden Markov Models. In particular, conditional random field models allow observations taken across an entire utterance to be used at each frame when determining the probability for a label in the frame. In addition, different labels may be associated with different observed values, thereby allowing a better selection of observed values for each label.","One problem with CRF models is that they have required that the labels be known at the time of training. As such, the CRF models cannot model hidden states since the hidden states are unknown at training. As such, CRF models have not been used in speech recognition and phonetic classification.","Recently, an extension to conditional random field models has been suggested that incorporates hidden states. However, it has not been suggested or shown that this extension of the conditional random field models can be used in speech recognition or phonetic classification. In particular, the hidden states shown in the extension do not correspond to hidden states traditionally used in speech recognition, which are associated with particular phonetic units.","A method and apparatus are provided for training and using a hidden conditional random field model for speech recognition and phonetic classification. The hidden conditional random field model uses features functions, at least one of which is based on a hidden state in a phonetic unit. Values for the features functions are determined from a segment of speech, and these values are used to identify a phonetic unit for the segment of speech.",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well-known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, telephony systems, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention is designed to be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules are located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general-purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in FIG. , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  is operated in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.","Under the present invention, phonetic classification and speech recognition are performed using conditional random field models with hidden states, referred to as hidden conditional random field models. A hidden conditional random field model provides a probability of a label, such as the identity of a phoneme, or a label sequence, such as a word sequence, given a sequence of observations and a set of parameters. Specifically, the hidden conditional random field model defines these probabilities as:",{"@attributes":{"id":"p-0034","num":"0033"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"l","mo":"\u2758","msubsup":{"mi":["o","\u03c4"],"mn":"1"}},"mo":";","mi":"\u03bb"}}},{"mfrac":{"mn":"1","mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mo":";","mi":"\u03bb"}}}},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mrow":{"mrow":{"msubsup":{"mi":["s","\u03c4"],"mn":"1"},"mo":"\u2758","mrow":{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":"s","mrow":{"mo":["(",")"],"mn":"1"}}}}},"mo":"=","mi":"l"}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"exp","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mrow":{"mo":["(",")"],"mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"t","mo":"=","mn":"1"},"mi":"\u03c4"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":[{"mi":"s","mrow":{"mo":["(",")"],"mrow":{"mi":"t","mo":"-","mn":"1"}}},{"mi":"s","mrow":{"mo":["(",")"],"mi":"t"}}],"mo":[",",",",","],"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mi":"t"}}}}}}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"1"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":"\u2758"},"mo":";","mi":"\u03bb"}}},{"mfrac":{"mn":"1","mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mo":";","mi":"\u03bb"}}}},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mrow":{"mrow":{"msubsup":{"mi":["s","\u03c4"],"mn":"1"},"mo":"\u2758","mrow":{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["s","\u03c4"],"mn":"1"}}}},"mo":"=","msubsup":{"mi":["l","n"],"mn":"1"}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"exp","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mrow":{"mo":["(",")"],"mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"t","mo":"=","mn":"1"},"mi":"\u03c4"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":[{"mi":"s","mrow":{"mo":["(",")"],"mrow":{"mi":"t","mo":"-","mn":"1"}}},{"mi":"s","mrow":{"mo":["(",")"],"mi":"t"}}],"mo":[",",",",","],"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mi":"t"}}}}}}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"2"}}]}]}}},"br":{},"sub":["1","1","1","1","1","1","k","1","1","k ","k","1","1","1","1","1"],"sup":["\u03c4","\u03c4","n","\u03c4","n ","\u03c4","(t\u22121)","(t)","\u03c4","(t\u22121)","(t)","\u03c4","th ","\u03c4","(1)","\u03c4","96 ","n ","n"]},{"@attributes":{"id":"p-0035","num":"0034"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mfrac":{"mn":"1","mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mo":";","mi":"\u03bb"}}}}}},"br":{}},"Using EQs. 1 and 2, the probabilities for different labels can be determined from a set of observed values and feature weights, even though the features functions themselves are dependent on hidden variables.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 3","sub":"k "},"In , a speaker  speaks into a microphone , which converts the audio signal into an electrical signal. The electrical signal is provided to an analog-to-digital (A\/D) converter .","A\/D converter  converts the analog signal from microphone  into a series of digital values. In one embodiment, A\/D converter  samples the analog signal at 16 kilohertz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second. These digital values are provided to a frame constructor , which, in one embodiment, groups the values into 25 millisecond frames that start 10 milliseconds apart. In some embodiments, frame constructor  is able to construct multiple frames of different sizes.","The frames of data created by frame constructor  are provided to feature extractor , which extracts observed values from each frame. Examples of feature extraction modules include modules for performing linear predictive coding, LPC derived cepstrum, perceptive linear prediction (PLP) auditory model feature extraction, and Mel-frequency cepstral coefficients (MFCC) feature extraction. In addition, feature extractor  can also extract observed values such as whether a frame is voiced or unvoiced, and values of formants in the frame. Note that the invention is not limited to these feature extraction modules and that other modules and other observed values may be used within the context of the present invention.","Before the hidden conditional random field model of the present invention can be used, it must be trained by a trainer . Trainer  determines the model parameters for hidden conditional random field (CRF) model  based on the features from feature extractor  and a training text . Specifically, trainer  uses a conditional maximum likelihood approach to select parameters for hidden CRF model  that maximize the probability of the labels found in training text  given the features provided by feature extractor  when speaker  pronounces the text in training text .",{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 4","b":["327","400","324","326"]},"For sequence recognition, the constrained trellis can take the form of the trellis of  or .  provides an example of a constrained trellis  for a limited set of phonetic labels ,  and  representing phonemes |p|, |e|, and |t|, respectively, in which the boundaries between phonemes in the training data is known.  provides an example of a constrained trellis  for the same limited set of phonetic labels, ,  and , but without known phoneme boundaries.","In , time is shown along horizontal axes  and , respectively, and hidden states are shown along vertical axes  and , respectively. Each phonetic label, such as phonetic labels ,  and , has three possible states in both figures.","Trellis  is considered constrained since at each time point, only those states associated with a single phonetic label may be occupied. Thus, states from other phonetic labels are invalid at that time point. Although the trellis is constrained, there are a number of different state sequences that can be followed through the trellis based on the observed values generated from feature extractor . Trellis  is also constrained because it limits transitions between states to only those transitions that are consistent with the sequence of phonemes in the training text. For the example of , the transitions between states only permit the phoneme sequence \/p\/ \/e\/ \/t\/.","For classification, a plurality of individual constrained trellises is used, where each trellis is limited to states for a single phoneme. During training, a single phoneme is spoken at a time and the appropriate constrained trellis is selected and used in the method of .","Because the states of the phonetic labels are hidden, the method of  performs a forward backward recursion through all of the states in the constrained trellis thereby performing the summation of states associated with each label as found in EQ. 1. The forward and backward recursions are defined as:",{"@attributes":{"id":"p-0048","num":"0047"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mn":"1"},{"mrow":{"mrow":{"mi":["for","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}},"mo":"=","mn":"0"}}]},{"mtd":[{"mrow":{"munder":{"mo":"\u2211","msup":{"mi":["s","\u2032"]}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"-","mn":"1"}}}},"mo":"\u2062","msup":{"mi":"\u2147","mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":"\u2062","mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":[",",",",","],"mi":["s","t"],"msubsup":{"mi":["o","\u03c4"],"mn":"1"}}}}}}}}}},{"mrow":{"mrow":[{"mi":"for","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"1"},{"mi":"\u03c4","mo":"+","mn":"1"}],"mo":["\u2264","\u2264"],"mi":"t"}}]}]}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"3"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b2","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mn":"1"},{"mrow":{"mrow":[{"mi":["for","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}},{"mi":"\u03c4","mo":"+","mn":"1"}],"mo":"="}}]},{"mtd":[{"mrow":{"munder":{"mo":"\u2211","msup":{"mi":["s","\u2032"]}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msup":{"mi":"\u2147","mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":"\u2062","mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":[",",",",","],"msup":{"mi":["s","\u2032"]},"msubsup":{"mi":["o","\u03c4"],"mn":"1"},"mrow":{"mi":"t","mo":"+","mn":"1"}}}}}}},"mo":"\u2062","mrow":{"mi":"\u03b2","mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"+","mn":"1"}}}}}},{"mrow":{"mrow":{"mi":"for","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"0"},"mo":["\u2264","\u2264"],"mi":["t","\u03c4"]}}]}]}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"4"}}]}]}}},"br":{}},"In Equations 3 and 4, the features \u0192(s\u2032,s,o,t) can be any desired features functions. Under one embodiment, the feature functions include: an indicator function that has a value of one when the current state matches one state value and the previous state matches another state value; an indicator function that is one when the previous state matches the current state, a set of real valued that each take on the value of a respective separate element of the observed values when the previous state matches the current state, and a set of functions that represent the square of respective separate elements of the observed values when the previous state matches the current state. Additional feature functions include real valued feature functions that take on the values of formants when the current state matches a particular state value, such as a state associated with a vowel sound, and binary feature functions that are one if the speech signal is voiced and zero if the speech signal is unvoiced when the current state matches a particular state, such as a state associated with a fricative.","After performing the forward-backward recursion on the constrained trellis at step , the method of  continues by performing a forward-backward recursion on an unconstrained trellis at step .","An example of an unconstrained trellis  is shown in . In , the unconstrained trellis is only shown for the states associated with phonetic units , , and . As in , time is shown along the horizontal axis and the available states are shown along the vertical axis of . Although not shown, the unconstrained trellis contains states for each of the possible phonetic units at each time point.","The forward-backward recursion calculations are the same as those in Equations 3 and 4, except that the forward-backward recursion is applied to the unconstrained trellis instead of the constrained trellis. Under many embodiments, during the forward-backward recursion of step , a beam search is used in which states that have low scores during the forward recursion and the backward recursion are pruned from further consideration. This reduces the number of computations that must be performed at each time point.","At step , the forward-backward recursions applied to the constrained and unconstrained trellises are used to determine a conditional log likelihood and a gradient of the conditional log likelihood. Under one embodiment, the conditional log likelihood is determined as:",{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"L","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03bb"}},{"mrow":[{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mrow":{"mo":["(",")"],"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":"\u2758"}}}}},{"mi":"log","mo":["\u2062","[","]"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mfrac":{"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","F"]},"mo":",","mrow":{"mi":"\u03c4","mo":"+","mn":"1"}}}},{"msup":{"mi":["\u03b1","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","F"]},"mo":",","mrow":{"mi":"\u03c4","mo":"+","mn":"1"}}}}]}}],"mo":"="}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"5"}}]}}}},"br":{},"sub":["F","F ","F","F "]},"The gradient of the conditional log likelihood is determined as:",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mo":"\u2207","mrow":{"mi":"L","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03bb"}}},{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["s","\u03c4"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":[",",","]}}},"mo":"\u2758","msubsup":{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"}},"mo":",","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"t"}}}},{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["s","\u03c4"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":[",",","]}}},"mo":"\u2758","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"t"}}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mi":"where"}],"mo":"-"}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"6"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["s","\u03c4"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":[",",","]}}},"mo":"\u2758","msubsup":{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"}},"mo":",","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"t"}}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"z","mo":"=","mn":"1"},"mi":"\u03c4"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":"s","mrow":{"mi":"z","mo":"-","mn":"1"}},"mo":"=","msubsup":{"mi":["s","k","\u2032"]}},{"msub":{"mi":["s","z"]},"mo":"=","mrow":{"msub":{"mi":["s","k"]},"mo":"\u2758","msubsup":{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"}}}],"mo":[",",","],"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}}},{"msub":{"mi":["g","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"},"mo":",","mi":"z"}}}],"mo":"\u2062"}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"7"}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mi":["l","n"],"mn":"1"},{"mi":["s","\u03c4"],"mn":"1"},{"mi":["o","\u03c4"],"mn":"1"}],"mo":[",",","]}}},"mo":"\u2758"},"mo":",","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"t"}}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"z","mo":"=","mn":"1"},"mi":"\u03c4"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":"s","mrow":{"mi":"z","mo":"-","mn":"1"}},"mo":"=","msubsup":{"mi":["s","k","\u2032"]}},{"msub":{"mi":["s","z"]},"mo":"=","mrow":{"msub":{"mi":["s","k"]},"mo":"\u2758","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}}],"mo":","}}},{"msub":{"mi":["g","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"},"mo":",","mi":"z"}}}],"mo":"\u2062"}}],"mo":"="},"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"8"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":"s","mrow":{"mi":"z","mo":"-","mn":"1"}},"mo":"=","msubsup":{"mi":["s","k","\u2032"]}},{"msub":{"mi":["s","z"]},"mo":"=","mrow":{"msub":{"mi":["s","k"]},"mo":"\u2758","msubsup":{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"}}}],"mo":[",",","],"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}}},{"mfrac":{"mn":"1","mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"},{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}],"mo":","}}}},"mo":["\u2062","\u2062","\u2062","\u2062"],"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"-","mn":"1"}}}},{"mo":["(",")"],"mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":["\u2062","\u2062"],"mrow":[{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":[",",",",","],"mi":["s","t"],"msubsup":{"mi":["o","\u03c4"],"mn":"1"}}}},{"mi":"\u03b2","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}}]}}}],"mi":"exp","mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"9"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":"s","mrow":{"mi":"z","mo":"-","mn":"1"}},"mo":"=","msubsup":{"mi":["s","k","\u2032"]}},{"msub":{"mi":["s","z"]},"mo":"=","mrow":{"msub":{"mi":["s","k"]},"mo":"\u2758","msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}}],"mo":","}}},{"mfrac":{"mn":"1","mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}}},"mo":["\u2062","\u2062","\u2062","\u2062"],"mrow":[{"msup":{"mi":["\u03b1","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"-","mn":"1"}}}},{"mo":["(",")"],"mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":["\u2062","\u2062"],"mrow":[{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":[",",",",","],"mi":["s","t"],"msubsup":{"mi":["o","\u03c4"],"mn":"1"}}}},{"msup":{"mi":["\u03b2","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}}]}}}],"mi":"exp","mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mrow":{"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}],"mo":"\u2062"},"mn":"10"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":[{"mover":{"mi":"l","mo":"^"},"mn":"1","mi":"n"},{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}],"mo":","}}},{"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","F"]},"mo":",","mrow":{"mi":"\u03c4","mo":"+","mn":"1"}}}},{"mi":"\u03b2","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":"s","mn":"0"},"mo":",","mn":"0"}}}],"mo":"="}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"11"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mover":{"mi":"o","mo":"^"},"mn":"1","mi":"\u03c4"}}},{"mrow":[{"msup":{"mi":["\u03b1","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","F"]},"mo":",","mrow":{"mi":"\u03c4","mo":"+","mn":"1"}}}},{"msup":{"mi":["\u03b2","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":"s","mn":"0"},"mo":",","mn":"0"}}}],"mo":"="}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mrow":{"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}],"mo":"\u2062"},"mn":"12"}}]}]}}},"br":{},"sub":["k","1"],"sup":"l"},"Once the conditional log likelihood and the gradient of the conditional log likelihood have been determined at step , they are used in an optimization algorithm to select new values of \u03bbfor each feature function \u0192at step . Under one embodiment, the limited memory-BFGS optimization algorithm is used to select the next values of \u03bbat step . At step , the method determines if the optimization is complete. If it is not complete, the method returns to step  and repeats steps ,  and  using the new values of \u03bb. When the optimization is complete at step , the process ends at step .","Once the model parameters for hidden CRF model  have been trained by trainer  using the process of , phonetic classification and speech recognition may be performed by decoder\/phonetic classifier .","During speech recognition, speaker  pronounces a sequence of words. This audio signal is processed by microphone , A\/D converter , frame constructor  and feature extractor  in the same manner as the training signal to produce a set of observed values. These observed values are provided to decoder . In the case of phonetic classification, the sequence of observed values is limited to those sequences associated with frames for a single phoneme. For speech recognition, the sequence of observed values are for the frames across the entire utterance.","To perform phonetic classification, a separate constrained trellis is formed for each phonetic unit. A forward recursion is performed in each trellis to determine the numerator of the conditional log likelihood of equation 5. The phonetic unit associated with the trellis that provides the greatest value for the numerator is then selected as the phonetic unit for the utterance.","The same technique can be used in speech recognition when there are limited sets of possible phonetic sequences that are to be recognized. In such cases, a constrained trellis, such as the trellis of  can be constructed for each possible phonetic sequence. A forward recursion is then performed in each trellis to determine the numerator of the conditional log likelihood of equation 5. The sequence of phonetic units associated with the trellis that provides the greatest value is then selected as the sequence of phonetic units for the utterance.","To perform speech recognition, an unconstrained trellis, similar to the trellis in  is constructed. A forward recursion is then performed using the following equation:",{"@attributes":{"id":"p-0063","num":"0062"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mn":"1"},{"mrow":{"mrow":{"mi":["for","t"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}},"mo":"=","mn":"0"}}]},{"mtd":[{"mrow":{"munder":{"mi":"max","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"-","mn":"1"}}}},"mo":"\u2062","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":",","mrow":{"mi":"t","mo":"-","mn":"1"}}}},"mo":"\u2062","msup":{"mi":"\u2147","mrow":{"munder":{"mo":"\u2211","mi":"k"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["\u03bb","k"]},"mo":"\u2062","mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["s","\u2032"]},"mo":[",",",",","],"mi":["s","t"],"msubsup":{"mi":["o","\u03c4"],"mn":"1"}}}}}}}}}}},{"mrow":{"mrow":[{"mi":"for","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"1"},{"mi":"\u03c4","mo":"+","mn":"1"}],"mo":["\u2264","\u2264"],"mi":"t"}}]}]}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"13"}}]}}}},"br":{}},"In some embodiments, pruning is performed during the forward recursion by eliminating states at each time frame that have low values for \u03b1(s,t).","In some speech recognition embodiments, the trellis for decoding is constrained to allowed sequences of phonetic units found in a lexicon , which contains the pronunciations for words in the language. In further embodiments, multiple possible sequences of phonetic units are identified using the hidden conditional random field model. The scores determined for each sequence by the hidden conditional random field model are combined with language model scores for the sequences of words represented by the sequences of phonetic units. Such language model scores are generated by a language model . The sequence of phonetic units that provides the highest combined score is selected as the sequence of phonetic units for the speech segment by decoder .","In other speech recognition embodiments, the language model and the lexicon are integrated with the hidden conditional random field model. Under such embodiments, the language model is implemented using features that ignore the acoustics and instead look at transitions between different words. Similarly, the lexicon is implemented by transition features that only allow state sequences that correspond to valid pronunciations. The parameters for the language model features and the lexicon features may be retrained during the hidden conditional random field model training or may set using a separate training process.","Note that if the language model is available during training of the hidden conditional random field model, the weights of the hidden conditional random field model will be trained to discriminate only between word sequences that the language model sees as being equally likely. By training in this manner, modeling power in the acoustic model is not wasted on modeling differences that the language model will resolve.","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
