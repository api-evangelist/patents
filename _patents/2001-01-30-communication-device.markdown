---
title: Communication device
abstract: A communication device wherein path selection is performed taking account of the conditions of individual paths on a network. Storing means stores information relating to a plurality of paths, and selecting means selects the information relating to one of the paths stored in the storing means. Packet generating means generates a packet with a header matching the information relating to the path selected by the selecting means, and transmitting means transmits the packet generated by the packet generating means.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06882648&OS=06882648&RS=06882648
owner: Fujitsu Limited
number: 06882648
owner_city: Kawasaki
owner_country: JP
publication_date: 20010130
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["(1) Field of the Invention","The present invention relates to a communication device, and more particularly, to a communication device for communicating with a remote device by using one of a plurality of paths.","(2) Description of the Related Art","In TCP\/IP (Transmission Control Protocol\/Internet Protocol) communications, for example, basically an IP packet reaches a destination communication device via a plurality of routers, and one path is usually selected from a plurality of paths to carry out communication.","As a method of selecting one path from among multiple paths, a protocol called RIP (Routing Information Protocol) has been in use, for example. In RIP, each router stores the addresses of neighboring devices and hop counts, and sends out a received IP packet to a path with the smallest hop count, thereby selecting an optimum path.","According to RIP, however, a path is selected by looking up only the hop counts, and accordingly, it is not possible to make path selection reflecting congestion conditions.","Also, in cases where a certain device on a network has developed a fault, it is necessary that routing should be changed. Conventionally, however, information indicative of such fault is propagated by means of communications between individual devices, and a problem therefore arises in that considerable time is required before the routing information converges.","The present invention was created in view of the above circumstances, and an object thereof is to provide a communication device which is capable of path selection reflecting path congestion conditions and which also enables routing information to converge promptly in cases where fault has occurred in part of devices constituting a network.","To achieve the above object, the present invention provides a communication device for communicating with a remote device by using one of a plurality of paths. The communication device comprises storing means for storing information relating to the paths, selecting means for selecting the information relating to one of the paths stored in the storing means, packet generating means for generating a packet with a header matching the information relating to the path selected by the selecting means, and transmitting means for transmitting the packet generated by the packet generating means.","The above and other objects, features and advantages of the present invention will become apparent from the following description when taken in conjunction with the accompanying drawings which illustrate preferred embodiments of the present invention by way of example.","An embodiment of the present invention will be hereinafter described with reference to the drawings.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 1","b":["1","1","1","1","1","1","1","2"],"i":["a","b","c","d","e ","f"]},"The storing means stores information (hereinafter referred to as routing information) indicating a plurality of selectable paths through which the communication device  can communicate with other communication devices, not shown, over the network .","The selecting means selects specified routing information from among a plurality of sets of routing information stored in the storing means ","The packet generating means generates a packet with a header matching the routing information selected by the selecting means ","The transmitting means sends out the packet generated by the packet generating means to the network .","The monitoring means monitors the status of a plurality of paths that exist on the network .","The supply means supplies the status of paths obtained by the monitoring means to the storing means to be stored therein.","Operation according to the principle illustrated in the figure will be now described.","The monitoring means monitors availability conditions and congestion conditions of the network , and notifies the supply means of the results of monitoring.","The supply means supplies the storing means with the results of monitoring by the monitoring means , whereupon the monitoring results are stored in the storing means in association with corresponding routing information.","The storing means stores routing information about selectable paths to specified remote communication devices, availability conditions and congestion conditions of the paths in a manner associated with one another. For example, the storing means stores Ra, Rb, Rc and Rd as paths selectable when communicating with a remote communication device S, as well as information indicating that Ra is currently unavailable and that Rb and Rc are congested.","When a remote communication device has been specified, the selecting means selects an optimum path by looking up the information stored in the storing means . In the above example, Rd, which is available and is not congested, is selected.","The packet generating means generates a packet with a header matching the routing information selected by the selecting means . In this example, a packet having a header affixed with information corresponding to the path Rd is generated.","The transmitting means sends out the packet generated by the packet generating means to the network .","Consequently, the packet sent out from the transmitting means is delivered to the remote communication device via the optimum path that reflects the availability and congestion conditions of that moment.","As described above, the communication device  according to the present invention selects an optimum path in accordance with the availability and congestion conditions of paths to transmit and receive packets to and from a remote communication device, so that communications can be performed via an optimum path taking account of ever-changing conditions of the network.","Referring now to , an embodiment of the present invention will be described.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 2","b":"10"},"In the figure, communication devices  and , each embodying the present invention, have IP addresses IPx and IPy, respectively, and exchange information with other communication devices through LANs (Local Area Networks)  and , respectively. The configuration of the communication device  will be described in detail later with reference to FIG. .","LANs  through , which are in-house information communication networks, each interconnect computers installed in a limited area, such as in an office or building, to permit exchange of information with one another.","Connection devices  to , which have IP addresses IPa to IPd, respectively, interconnect networks and send out received packets through optimum paths.","Gateways (GW)  to  also interconnect networks and convert message format, address and protocol to those matching the network to be connected to, to permit exchange of information.","Referring now to , the configuration of the communication device  appearing in  will be described in detail.","As shown in the figure, the communication device  according to the present invention comprises a packet receiving section , an IP packet receiving\/processing section , a UDP (User Datagram Protocol) receiving\/processing section , a routing information management section , a path monitoring\/processing section , a TCP time-out detecting section , a UDP transmitting\/processing section , an IP packet transmitting\/processing section , a packet transmitting section , a TCP receiving\/processing section , a path change detecting section , a path acquiring\/processing section , and a TCP transmitting\/processing section .","The packet receiving section receives a packet destined therefor from the LAN .","The IP packet receiving\/processing section supplies the packet received by the packet receiving section selectively to one of the TCP receiving\/processing section , the UDP receiving\/processing section and the path monitoring\/processing section in accordance with the protocol of the received packet.","The UDP receiving\/processing section receives an independent UDP packet (datagram) according to UDP which is a protocol allowing direct handling by an application. Specifically, the UDP receiving\/processing section receives path-related information transmitted from a remote communication device, and supplies the received information to the routing information management section ","The routing information management section manages all existing paths to specified remote communication devices, availability conditions of the respective paths, and ongoing connection counts of the respective paths in a manner associated with one another.",{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 4","b":["10","11","11","10"]},"In the event that a time-out has occurred during a transmission process (no response is returned from the remote communication device), the path monitoring\/processing section transmits and receives an echo packet conforming to ICMP (Internet Control Message Protocol).","The TCP time-out detecting section detects a time-out occurring at the time of transmission, and notifies the routing information management section of the occurrence of time-out.","The UDP transmitting\/processing section log transmits information indicative of a change of path status to the remote communication device.","The IP packet transmitting\/processing section acquires information from the path monitoring\/processing section , the UDP transmitting\/processing section or from the TCP transmitting\/processing section , and supplies the acquired information to the packet transmitting section ","The packet transmitting section sends out the packet supplied from the IP packet transmitting\/processing section to the LAN .","The TCP receiving\/processing section transfers a packet whose protocol is TCP to an upper-level protocol, and also supplies the routing information affixed to the header of the packet to the path change detecting section ","The path change detecting section compares the routing information (path selected by the remote device) supplied from the TCP receiving\/processing section with the routing information (path selected by the local device) supplied from the TCP transmitting\/processing section , and if the two disagree, the path change detecting section notifies the path acquiring\/processing section that the remote device has changed paths for some reason.","The path acquiring\/processing section performs a process for changing paths.","The TCP transmitting\/processing section supplies the IP packet transmitting\/processing section with a packet received from the upper-level protocol. It also extracts the routing information affixed to the header of the received packet and supplies the extracted information to the path change detecting section ","Operation of the above embodiment will be now described.","Assuming that a request to transmit a packet to the connection device  has been made from the upper-level protocol, the TCP transmitting\/processing section sends an inquiry to the path acquiring\/processing section , to determine whether or not routing information for routing up to the connection device  has already been set. If such routing information has been set, the packet is sent out using the set path; if not, the TCP transmitting\/processing section requests the path acquiring\/processing section to acquire a path.","When requested to acquire a path, the path acquiring\/processing section retrieves routing information relating to the specified remote device from the routing information stored in the routing information management section . From among the routing information thus acquired, a path of which the \u201cSTATUS\u201d shown in  is \u201cAVAILABLE\u201d and which has the smallest \u201cONGOING CONNECTION COUNT\u201d is selected as an optimum path, which is then supplied to the TCP transmitting\/processing section At this time, the ongoing connection count of the selected routing information is incremented by \u201c1\u201d. In the example shown in , a path of which the status is available and which has the smallest ongoing connection count is the third path; accordingly, the third path is selected and its ongoing connection count is changed to \u201c3\u201d,. The path acquiring\/processing section stores the acquired paths and their connections in a manner associated with each other, and supplies the already acquired routing information in response to subsequent inquiries.","The TCP transmitting\/processing section generates a header matching the routing information supplied thereto and affixes the generated header to the packet, which is then supplied to the IP packet transmitting\/processing section . Specifically, the TCP transmitting\/processing section stores the routing information supplied thereto from the path acquiring\/processing section in a fixed area (area for storing a source address and a destination address) and an IP option area (area for storing information indicative of a path between the source address and the destination address) of the IP packet.","In this example, the selected path is the path leading to the communication device  via the connection device , the gateway  and the connection device , and accordingly, the IP addresses IPx and IPd of the communication devices  and  are stored as the source and destination addresses, respectively, as shown in FIG. . Also, the IP addresses IPa and IPy of the connection device  and the communication device , respectively, are stored in the IP option area.","The packet affixed with the header is supplied to the IP packet transmitting\/processing section . On receiving the IP packet, the IP packet transmitting\/processing section sends out the IP packet to the LAN  via the packet transmitting section ","The packet sent out in this manner is first received by the connection device , and then by the connection device  after being transferred via the gateways  and . The header is rewritten in the connection device . Specifically, the destination address IPd is replaced by the next address IPy stored in the IP option area. As a result, a packet as shown in  is obtained.","Consequently, the packet transmitted from the communication device  is transferred via the connection device , the gateways  and , and the connection device , and is received by the communication device .","The communication device  transmits a packet responsive to the received packet via the same path. As a consequence, the communication device  receives the packet, whereupon a communication process is started.","If the communication device  receives no responsive packet, then a time-out is detected by the TCP time-out detecting section of the communication device .","When a time-out has been detected, the routing information management section notifies the path acquiring\/processing section of the occurrence of time-out and requests the same to acquire a new path. Also, the routing information management section decrements the ongoing connection count of the path used until then by \u201c1\u201d. Then, the routing information management section causes the path monitoring\/processing section to perform an echo process for determining whether the path, with respect to which a time-out has occurred, is really unavailable or not and for detecting restoration of the path.","In the echo process, the IP packet transmitting\/processing section sends out an echo packet to the path which has presumably developed a fault, and detects the return of the echo packet to determine whether or not the path is unavailable. Specifically, if the echo packet is not returned within a predetermined time, the path is judged to be abnormal. Accordingly, the \u201cSTATUS\u201d of the corresponding routing information stored in the routing information management section is changed to \u201cUNAVAILABLE\u201d, and the unavailable status is notified to the remote device by the UDP transmitting\/processing section through a different path. On the other hand, if the echo packet is returned within the predetermined time, the path is judged to be normal; accordingly, the \u201cSTATUS\u201d of the path is changed to \u201cAVAILABLE\u201d and the available status is notified to the remote device by the UDP transmitting\/processing section ",{"@attributes":{"id":"p-0076","num":"0075"},"figref":"FIG. 7","b":"4"},"In the above example, abnormality of a path is detected by the communication device . In cases where abnormality of a path is detected by the communication device , it is the communication device  that changes paths, and accordingly, a packet transmitted from the communication device  follows a different path. In such cases, the path change detecting section detects a difference between the path of the packet sent out from the local device and that of the packet received from the communication device .","When such a path difference has been detected by the path change detecting section , the path acquiring\/processing section changes its own path so that subsequent packets may follow the same path. As a result, packets transmitted from the communication device  and those transmitted from the communication device  always follow the same path.","In the case where the remote device has changed paths, a message notifying the path change arrives after a lapse of a predetermined time. Thus, upon receiving the message, the UDP receiving\/processing section causes the path monitoring\/processing section to transmit an echo packet to determine whether the path is unavailable or not. If the path is found to be unavailable, the corresponding path status stored in the routing information management section is changed to \u201cUNAVAILABLE\u201d. In order to detect restoration of the path, the path monitoring\/processing section transmits an echo packet at predetermined intervals of time.","As described above, according to the embodiment of the present invention, all existing paths to remote devices are stored as the routing information, and also ongoing connection counts indicative of degrees of congestion are stored in association with the respective paths, whereby path selection can be made taking account of the degrees of congestion of the paths.","Also, in addition to all existing paths to remote devices stored as the routing information, availability conditions are stored in association with the respective paths. Thus, even in cases where fault has occurred in part of the devices constituting the network, it is possible to make the routing information converge quickly.","Referring now to , examples of processes executed in the above embodiment will be described.",{"@attributes":{"id":"p-0083","num":"0082"},"figref":"FIG. 8"},"[S1] The TCP transmitting\/processing section sends an inquiry to the path acquiring\/processing section , to determine whether or not a connection for the request has already been established. If such a connection has already been established, the flow proceeds to Step S2; if not, the flow proceeds to Step S4.","[S2] The path acquiring\/processing section determines whether or not the path in question is unavailable. If the path is unavailable, the flow proceeds to Step S3; if not, the flow proceeds to Step S8.","[S3] The path acquiring\/processing section decrements the ongoing connection count of the corresponding path, stored in the routing information management section , by \u201c1\u201d.","[S4] The path acquiring\/processing section selects routing information corresponding to the destination address from among the information stored in the routing information management section ","[S5] The path acquiring\/processing section stores the routing information in TCP connection which serves as a pointer pointing to predetermined information in the routing information management section ","[S6] The path acquiring\/processing section creates information for the IP option area, based on the neighboring device addresses of remote and local sides stored in the routing information management section ","[S7] The path acquiring\/processing section increments the corresponding ongoing connection count by \u201c1\u201d.","[S8] The IP packet transmitting\/processing section transmits the packet created by the TCP transmitting\/processing section to the remote destination device.","An example of a process executed when a time-out has been detected by the TCP time-out detecting section after the transmission of a packet will be now described with reference to the flowchart of FIG. . Upon start of the process, the following steps are executed.","[S20] The path monitoring\/processing section starts the echo process.","Details of this process will be described later with reference to FIG. .","[S21] The path monitoring\/processing section decrements, by \u201c1\u201d, the connection count in the routing information associated with the path with respect to which a time-out has occurred.","[S22] The path acquiring\/processing section selects other routing information from among the information stored in the routing information management section . Specifically, the path acquiring\/processing section selects, as a substitute path, a path which is different from the one with respect to which a time-out has occurred, of which the status is \u201cAVAILABLE\u201d and which has the smallest connection count.","[S23] The path acquiring\/processing section updates the routing information of the TCP connection in accordance with the selected substitute path.","[S24] The path acquiring\/processing section updates the information in the IP option area in accordance with the selected substitute path.","[S25] The path acquiring\/processing section increments the ongoing connection count of the substitute path by \u201c1\u201d.","Referring now to , the \u201cECHO PROCESS\u201d appearing in  will be described in detail. Upon start of the process shown in the flowchart, the following steps are executed.","[S30] The path monitoring\/processing section causes the IP packet transmitting\/processing section to transmit an echo packet to the path in question.","[S31] The path monitoring\/processing section starts a path monitoring timer, not shown.","[S32] The path monitoring\/processing section determines whether or not a time-out has occurred. If a time-out has occurred, the flow proceeds to Step S33; otherwise the flow returns and Step S32 is repeated.","[S33] The path monitoring\/processing section changes the status of the corresponding path, stored in the routing information management section , to \u201cUNAVAILABLE\u201d.","[S34] The UDP transmitting\/processing section sends a message to the remote device to notify the same that the path status has changed.","[S35] The path monitoring\/processing section starts a restoration process. This process will be described in detail with reference to FIG. .","Referring now to , details of the \u201cRESTORATION PROCESS\u201d appearing in  will be described. Upon start of the process shown in the flowchart, the following steps are executed.","[S40] The path monitoring\/processing section transmits an echo packet to the remote device in question.","[S41] The path monitoring\/processing section determines whether or not the IP packet receiving\/processing section has received the echo packet. If the echo packet has been received, the flow proceeds to Step S42; if not, the flow returns to Step S40 and repeats the same process.","[S42] The path monitoring\/processing section changes the status of the corresponding path stored in the routing information management section to \u201cAVAILABLE\u201d.","[S43] The UDP transmitting\/processing section notifies the remote device that the path has become available.","Referring now to , an example of a process executed when a change of path status has been notified from the remote device will be described. Upon start of the process shown in the flowchart, the following steps are executed.","[S50] The UDP receiving\/processing section receives a change of the status of routing information.","[S51] If the path status has changed from \u201cUNAVAILABLE\u201d to \u201cAVAILABLE\u201d, the flow proceeds to Step S52; if the change is from \u201cAVAILABLE\u201d to \u201cUNAVAILABLE\u201d, the flow proceeds to Step S53.","[S52] A restoration process #2 for detecting restoration of the path by the echo process is started. Details of this process will be described later with reference to FIG. .","[S53] The IP packet transmitting\/processing section transmits an echo packet to the path in question.","[S54] The path monitoring\/processing section starts the path monitoring timer, not shown.","[S55] The path monitoring\/processing section determines whether or not a time-out has occurred. If a time-out has occurred, the flow proceeds to Step S56; otherwise the flow returns and Step S55 is repeated.","[S56] The path monitoring\/processing section changes the status of the corresponding routing information stored in the routing information management section to \u201cUNAVAILABLE\u201d.","[S57] The path monitoring\/processing section starts the restoration process shown in FIG. .","Referring now to , the \u201cRESTORATION PROCESS #2\u201d appearing in  will be described in detail. Upon start of the process shown in the flowchart, the following steps are executed.","[S60] The IP packet transmitting\/processing section transmits an echo packet.","[S61] If the echo packet is not received by the IP packet receiving\/processing section , the flow returns to Step S60 and repeats the same process; if the echo packet has been received, the flow proceeds to Step S62.","[S62] The path monitoring\/processing section changes the status of the corresponding path stored in the routing information management section to \u201cAVAILABLE\u201d.","The processes described above make it possible to perform the functions already explained with reference to FIG. .","Although the above embodiment is described on the assumption that the number of paths is four, the configuration shown and described is given by way of example only and the present invention is of course not limited to such configuration alone.","Further, in the foregoing embodiment, only the routing information relevant to the communication device  is illustrated by way of example, but in practice similar routing information is prepared for each of remote communication devices.","Finally, the above-described processing functions can be performed by a computer. In this case, the contents of the functions to be accomplished by the communication device are described in a program recorded in a computer-readable recording medium. By executing the program by a computer, it is possible to perform the above-described processes. The computer-readable recording medium includes magnetic recording device, semiconductor memory and the like. To distribute the program to the market, the program may be stored in portable recording media such as CD-ROM (Compact Disk Read Only Memory) or floppy disk. Alternatively, the program may be stored in a storage device of a computer connected to a network and may be transferred to other computers through the network. To execute the program by a computer, the program stored in a hard disk unit or the like of the computer is loaded into the main memory and executed.","As described above, according to the present invention, a communication device for communicating with a remote device by using one of a plurality of paths comprises storing means for storing information relating to the paths, selecting means for selecting the information relating to one of the paths stored in the storing means, packet generating means for generating a packet with a header matching the information relating to the path selected by the selecting means, and transmitting means for transmitting the packet generated by the packet generating means, whereby an optimum path can be selected by looking up the conditions of the individual paths.","The foregoing is considered as illustrative only of the principles of the present invention. Further, since numerous modifications and changes will readily occur to those skilled in the art, it is not desired to limit the invention to the exact construction and applications shown and described, and accordingly, all suitable modifications and equivalents may be regarded as falling within the scope of the invention in the appended claims and their equivalents."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 2"],"b":"10"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIG. 6","FIG. 2"],"b":"23"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7","b":["10","2"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 10","FIG. 9"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 11","FIG. 10"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 13","b":"12"}]},"DETDESC":[{},{}]}
