---
title: Cookie verification methods and apparatus for use in providing application services to communication devices
abstract: In one illustrative example, a method in a communication device adapted for communications using Hypertext Transport Protocol (HTTP) involves setting, at the communication device, an HTTP cookie which includes a user identification of a user of the communication device and a message portion which is signed with a digital signature of the user. The communication device sends, to an application server site via the communication network, a request message which includes the HTTP cookie. If verification of the digital signature at the application server site is successful, the communication device will receive access to an application service of the application server site. In one variation, the HTTP cookie is alternatively set with a group identification of a group with which the user is associated, and the message portion is signed with a digital signature of the group. The group may be a plurality of users associated with a service provider which provides the communication device access to a communication service in the communication network. In this case, the HTTP cookie may be set with a token retrieved from the service provider, where the token includes the digital signature of the service provider.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09059979&OS=09059979&RS=09059979
owner: BlackBerry Limited
number: 09059979
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20090227
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION OF THE DRAWINGS"],"p":["1. Field of the Technology","The present disclosure relates generally to cookie verification methods and apparatus for providing application services to communication devices.","2. Description of the Related Art","A communication device, such as a wireless mobile communication device, may operate in a communication network which provides for data and\/or voice communications. Such communication device may offer a number of different capabilities or features for a user. Many of these capabilities are defined by the different applications which are installed in the communication device. The communication device may have a data or message synchronization application (e.g. for e-mail messages or calendar items), a Web browser or Internet search application, a voice telephony application, as examples, or combinations thereof. With use of an application, such as a Web browser, a communication device operating in the communication network may interface with an application server of another network (e.g. a public network such as the Internet) to access a service or information.","With use of an application, such as a Web browser, a communication device operating in a communication network may interact with an application server of another network (e.g. a public network such as the Internet) to access a service or information. The communication device may be a wireless mobile communication device operative in a wireless communication network. In some cases, it may be beneficial to grant special access privileges only to particular types or groups of devices (e.g. trusted devices) but otherwise deny access.","Additional or other concerns may be that an application server can be vulnerable to automated software from \u201cbots\u201d or the like. In some cases, the application server may utilize means to prevent accessibility to the information or service by such automated software. For example, an application server may utilize a proof-of-work (POW) test, such as a challenge-response test, to prevent such accessibility. One such challenge-response test is a Captcha test (\u201cCompletely Automatic Public Turing test to tell Computers and Humans Apart\u201d). For various reasons, however, such challenge-response tests may be inconvenient or otherwise unsuitable for devices, such as mobile communication devices.","It is preferred that convenient accessibility to application services are provided to entrusted devices with use of efficient techniques. The same or similar problems may exist in connection with other environments, networks, and devices.","According to one illustrative example of the present disclosure, a method in a communication device adapted for communications using Hypertext Transport Protocol (HTTP) involves setting, at the communication device, an HTTP cookie which includes a user identification of a user of the communication device and a message portion which is signed with a digital signature of the user. The communication device sends, to an application server site via the communication network, a request message which includes the HTTP cookie. If verification of the digital signature at the application server site is successful, the communication device will receive access to an application service of the application server site; otherwise, access is denied.","In another embodiment, the HTTP cookie is set with a group identification of a group with which the user is associated, and the message portion is signed with a digital signature of the group. The group may be, for example, a plurality of users associated with a service provider which provides the communication device with access to a communication service in the communication network. In this case, the HTTP cookie may include a token retrieved from the service provider, where the token includes the digital signature of the service provider.","In one particular example, the application service is an e-commerce transaction service, wherein a proof-of-work (POW) test (e.g. a Captcha test) otherwise utilized for the service is bypassed or excluded for the entrusted device.","To illustrate exemplary system architecture of the present disclosure,  shows a block diagram of a communication system  which includes a mobile  station  (one example of a wireless or mobile communication device) which communicates through a wireless communication network . Mobile station  may comprise a visual display , a keyboard , and perhaps one or more auxiliary user interfaces (UI) , each of which are coupled to a controller . Keyboard  may be substituted with a touch screen display or other suitable input mechanism, or enhanced or replaced with a voice-activated input module. Controller  is also coupled to radio frequency (RF) transceiver circuitry  and an antenna . Typically, controller  is embodied as a central processing unit (CPU) which runs operating system software in a memory component (not shown). Controller  will normally control overall operation of mobile station , whereas signal processing operations associated with communication functions are typically performed in RF transceiver circuitry . Controller  interfaces with device display  to display received information, stored information, user inputs, and the like. Keyboard , which may be a telephone type keypad or full alphanumeric keyboard, is normally provided for entering data for storage in mobile station , information for transmission to network , a telephone number to place a telephone call, commands to be executed on mobile station , and possibly other or different user inputs.","Mobile station  sends communication signals to and receives communication signals from network  over a wireless link via antenna . RF transceiver circuitry  performs functions similar to those of a tower station  and a base station controller (BSC)  (described later below), including for example modulation\/demodulation and possibly encoding\/decoding and encryption\/decryption. It is also contemplated that RF transceiver circuitry  may perform certain functions in addition to those performed by BSC . It will be apparent to those skilled in art that RF transceiver circuitry  will be adapted to particular wireless network or networks in which mobile station  is intended to operate. When mobile station  is fully operational, an RF transmitter of RF transceiver circuitry  is typically keyed or turned on only when it is sending to network, and is otherwise turned off to conserve resources. Similarly, an RF receiver of RF transceiver circuitry  is typically periodically turned off to conserve power until it is needed to receive signals or information (if at all) during designated time periods.","Mobile station  may comprise a battery interface  for receiving one or more rechargeable batteries . Battery  electrical power to electrical circuitry in mobile station , and battery interface  provides for a mechanical and electrical connection for battery . Battery interface  is coupled to a regulator  which regulates power to the device. Mobile station  may comprise a portable communication device (e.g. a handheld portable communication device), which includes a housing (e.g. a plastic housing) which carries and contains the electrical components of mobile station  including battery . Mobile station  operates using a Subscriber Identity Module (SIM)  which is connected to or inserted in mobile station  at a SIM interface . SIM  is one type of a conventional \u201csmart card\u201d used to identify an end user (or subscriber) of mobile station  and to personalize the device, among other things. For example, SIM  may alternatively be a Universal SIM (USIM) or Removable User Identity Module (RUIM) depending on the particular technology. Without SIM , the mobile station terminal may not be fully operational for communication through wireless network . By inserting SIM  into mobile station , an end user can have access to any and all of his\/her subscribed services. SIM  generally includes a processor and memory for storing information. Since SIM  is coupled to SIM interface , it is coupled to controller  through communication lines . In order to identify the subscriber, SIM  contains some user parameters such as an International Mobile Subscriber Identity (IMSI). An advantage of using SIM  is that end users are not necessarily bound by any single physical mobile station. SIM  may store additional user information for the mobile station as well, including datebook (or calendar) information and recent call information.","Mobile station  may consist of a single unit, such as a data communication device, a cellular telephone, a multiple-function communication device with data and\/or voice communication capabilities, a personal digital assistant (PDA) enabled for wireless communication, or a computer incorporating an internal modem. As mentioned earlier, mobile station  may comprise a portable communication device (e.g. a handheld portable communication device) which includes a housing (e.g. a plastic housing) which carries and contains the electrical components of mobile station . Alternatively, mobile station  may be a multiple-module unit comprising a plurality of separate components, including but in no way limited to a computer or other device connected to a wireless modem. In particular, for example, in the mobile station block diagram of , RF transceiver circuitry  and antenna  may be implemented as a radio modem unit that may be inserted into a port on a laptop computer. In this case, the laptop computer would include display , keyboard , one or more auxiliary UIs , and controller  embodied as the computer's CPU. It is also contemplated that a computer or other equipment not normally capable of wireless communication may be adapted to connect to and effectively assume control of RF transceiver circuitry  and antenna  of a single-unit device such as one of those described above. Such a mobile station  may have a more particular implementation as described later in relation to mobile station  of .","Mobile station  communicates in and through wireless network . Wireless network  may comprise a cellular telecommunications network. Wireless network  may be owned and\/or operated by a service provider (e.g. a wireless carrier, such as AT&T, Rogers Communications, T-Mobile, etc.) which provides a communication service (e.g. a voice telephony service and or packet data service) for mobile stations. In the embodiment of , wireless network  is configured in accordance with Global Systems for Mobile communication (GSM) and General Packet Radio Service (GPRS) and technologies. Today, such a mobile station may further operate in accordance with Enhanced Data rates for GSM Evolution (EDGE) or Enhanced GPRS (EGPRS). Note that wireless network  may be based on any other suitable network technology or network, such as a Long-Term Evolution (LTE)-based network, an EVolution-Data Only (EV-DO)-based network, a UMTS-based network, or High Speed Packet Access (HSPA). Alternatively, wireless network  may be a wireless local area network (i.e. IEEE 802.11), a Bluetooth-based network, a WiMAX-based network (i.e. IEEE 802.16), or a Ultra-WideBand (UWB)-based network (i.e. IEEE 802.15), as a few examples.","In this environment, wireless network  may include a base station controller (BSC)  with an associated tower station , a Mobile Switching Center (MSC) , a Home Location Register (HLR) , a Serving General Packet Radio Service (GPRS) Support Node (SGSN) , and a Gateway GPRS Support Node (GGSN) . MSC  is coupled to BSC  and to a landline network, such as a Public Switched Telephone Network (PSTN) . SGSN  is coupled to BSC  and to GGSN , which is in turn coupled to a public or private data network  (such as the Internet). HLR  is coupled to MSC , SGSN , and GGSN .","Station  is a fixed transceiver station, and station  and BSC  may be referred to as transceiver equipment. The transceiver equipment provides wireless network coverage for a particular coverage area commonly referred to as a \u201ccell\u201d. The transceiver equipment transmits communication signals to and receives communication signals from mobile stations within its cell via station . The transceiver equipment normally performs such functions as modulation and possibly encoding and\/or encryption of signals to be transmitted to the mobile station in accordance with particular, usually predetermined, communication protocols and parameters, under control of its controller. The transceiver equipment similarly demodulates and possibly decodes and decrypts, if necessary, any communication signals received from mobile station  within its cell. Communication protocols and parameters may vary between different networks. For example, one network may employ a different modulation scheme and operate at different frequencies than other networks.","The wireless link shown in communication system  of  represents one or more different channels, typically different radio frequency (RF) channels, and associated protocols used between wireless network  and mobile station . An RF channel is a limited resource that must be conserved, typically due to limits in overall bandwidth and a limited battery power of mobile station . Those skilled in art will appreciate that a wireless network in actual practice may include hundreds of cells, each served by a station  (i.e. or station sector), depending upon desired overall expanse of network coverage. All pertinent components may be connected by multiple switches and routers (not shown), controlled by multiple network controllers.","For all mobile station's  registered with a network operator, permanent data (such as mobile station  user's profile) as well as temporary data (such as mobile station's  current location) are stored in HLR . In case of a voice call to mobile station , HLR  is queried to determine the current location of mobile station . A Visitor Location Register (VLR) of MSC  is responsible for a group of location areas and stores the data of those mobile stations that are currently in its area of responsibility. This includes parts of the permanent mobile station data that have been transmitted from HLR  to the VLR for faster access. However, the VLR of MSC  may also assign and store local data, such as temporary identifications. Optionally, the VLR of MSC  can be enhanced for more efficient co-ordination of GPRS and non-GPRS services and functionality (e.g. paging for circuit-switched calls which can be performed more efficiently via SGSN , and combined GPRS and non-GPRS location updates).","Serving GPRS Support Node (SGSN)  is at the same hierarchical level as MSC  and keeps track of the individual locations of mobile stations. SGSN  also performs security functions and access control. Gateway GPRS Support Node (GGSN)  provides interworking with external packet-switched networks and is connected with SGSNs (such as SGSN ) via an IP-based GPRS backbone network. SGSN  performs authentication and cipher setting procedures based on algorithms, keys, and criteria (e.g. as in existing GSM). In conventional operation, cell selection may be performed autonomously by mobile station  or by the transceiver equipment instructing mobile station  to select a particular cell. Mobile station  informs wireless network  when it reselects another cell or group of cells, known as a routing area.","In order to access GPRS services, mobile station  first makes its presence known to wireless network  by performing what is known as a GPRS \u201cattach\u201d. This operation establishes a logical link between mobile station  and SGSN  and makes mobile station  available to receive, for example, pages via SGSN, notifications of incoming GPRS data, or SMS messages over GPRS. In order to send and receive GPRS data, mobile station  assists in activating the packet data address that it wants to use. This operation makes mobile station  known to GGSN ; interworking with external data networks can thereafter commence. User data may be transferred transparently between mobile station  and the external data networks using, for example, encapsulation and tunneling. Data packets are equipped with GPRS-specific protocol information and transferred between mobile station  and GGSN .",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 2","b":["202","202","202","202","200"]},"Mobile station  will normally incorporate a communication subsystem , which includes a receiver , a transmitter , and associated components, such as one or more antenna elements  and  (which may be embedded or internal), local oscillators (LOs) , and a processing module such as a digital signal processor (DSP) . Communication subsystem  is analogous to RF transceiver circuitry  and antenna  shown in . As will be apparent to those skilled in field of communications, particular design of communication subsystem  depends on the communication network(s) in which mobile station  is intended to operate.","Mobile station  may send and receive communication signals over the network after required network registration or activation procedures have been completed. Signals received by antenna  through the network are input to receiver , which may perform such common receiver functions as signal amplification, frequency down conversion, filtering, channel selection, and like, and in the example shown in , analog-to-digital (A\/D) conversion. A\/D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in DSP . In a similar manner, signals to be transmitted are processed, including modulation and encoding, for example, by DSP . These DSP-processed signals are input to transmitter  for digital-to-analog (D\/A) conversion, frequency up conversion, filtering, amplification and transmission over communication network via antenna . DSP  not only processes communication signals, but also provides for receiver and transmitter control. For example, the gains applied to communication signals in receiver  and transmitter  may be adaptively controlled through automatic gain control algorithms implemented in DSP .","Network access is associated with a subscriber or user of mobile station , and therefore mobile station  may utilize a Subscriber Identity Module or \u201cSIM\u201d card  which may be inserted in a SIM interface  in order to operate in the network. SIM  includes those features described in relation to . Mobile station  is a battery-powered device so it also includes a battery interface  for receiving one or more rechargeable batteries . Such a battery  provides electrical power to most if not all electrical circuitry in mobile station , and battery interface  provides for a mechanical and electrical connection for it. The battery interface  is coupled to a regulator (not shown) which provides a regulated voltage V to all of the circuitry.","Mobile station  includes a microprocessor  (which is one implementation of controller  of ) which controls overall operation of mobile station . Communication functions, including at least data and\/or voice communications, are performed through communication subsystem . The communication techniques of the present disclosure may generally be controlled by microprocessor  in connection with DSP . Microprocessor  also interacts with additional device subsystems which may include a display , a flash memory , a random access memory (RAM) , auxiliary input\/output (I\/O) subsystems , a serial port , a keyboard , a speaker , a microphone , a short-range communications subsystem , and any other device subsystems generally designated at . Some of the subsystems shown in  perform communication-related functions, whereas other subsystems may provide \u201cresident\u201d or on-device functions. Notably, some subsystems, such as keyboard  and display , for example, may be used for both communication-related functions, such as entering a text message for transmission over a communication network, and device-resident functions such as a calculator or task list. Operating system software used by microprocessor  may be stored in a persistent store such as flash memory , which may alternatively be a read-only memory (ROM) or similar storage element (not shown). Those skilled in the art will appreciate that the operating system, specific device applications, or parts thereof, may be temporarily loaded into a volatile store such as RAM .","Microprocessor , in addition to its operating system functions, enables execution of software applications on mobile station . A predetermined set of applications which control basic device operations, including at least data and\/or voice communication applications, will normally be installed on mobile station  during its manufacture. An exemplary application that may be loaded onto mobile station  may be a personal information manager (PIM) application having the ability to organize and manage data items relating to user such as, but not limited to, e-mail, calendar events, voice mails, appointments, and task items. Naturally, one or more memory stores are available on mobile station  and SIM  to facilitate storage of PIM data items and other information. The PIM application may typically have the ability to send and receive data items via the wireless network. In the present disclosure, PIM data items are seamlessly integrated, synchronized, and updated via the wireless network, with the mobile station user's corresponding data items stored and\/or associated with a host computer system thereby creating a mirrored host computer on mobile station  with respect to such items. This can be especially advantageous where the host computer system is the mobile station user's office computer system. Additional applications may also be loaded onto mobile station  through network, an auxiliary I\/O subsystem , serial port , short-range communications subsystem , or any other suitable subsystem , and installed by a user in RAM  or a non-volatile store (not shown) for execution by microprocessor . Such flexibility in application installation increases the functionality of mobile station  and may provide enhanced on-device functions, communication-related functions, or both. These applications will be described later in relation to  below.","In a data communication mode, a received signal such as a text message, an e-mail message, or web page download will be processed by communication subsystem  and input to microprocessor . Microprocessor  may further process the signal for output to display  or alternatively to auxiliary I\/O device . A user of mobile station  may also compose data items, such as e-mail messages, for example, using keyboard  in conjunction with display  and possibly auxiliary I\/O device . Keyboard  may comprise a complete alphanumeric keyboard and\/or telephone-type keypad. Note that keyboard  may be substituted with a touch screen display or other suitable input mechanism, or enhanced or replaced with a voice-activated input module. The composed data items may be transmitted over a communication network through communication subsystem . For voice communications, the overall operation of mobile station  is substantially similar, except that the received signals would be output to speaker  and signals for transmission would be generated by microphone . Alternative voice or audio I\/O subsystems, such as a voice message recording subsystem, may also be implemented on mobile station . Although voice or audio signal output is typically accomplished primarily through speaker , display  may also be used to provide an indication of the identity of a calling party, duration of a voice call, or other voice call related information, as some examples.","Serial port  in  is normally implemented in a personal digital assistant (PDA)-type communication device for which synchronization with a user's desktop computer is a desirable, albeit optional, component. Serial port  enables a user to set preferences through an external device or software application and extends the capabilities of mobile station  by providing for information or software downloads to mobile station  other than through a wireless network. The alternate download path may, for example, be used to load an encryption key onto mobile station  through a direct and thus reliable and trusted connection to thereby provide secure device communication. Short-range communications subsystem  of  is an additional optional component which provides for communication between mobile station  and different systems or devices, which need not necessarily be similar devices.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 3","FIG. 3","FIG. 3"],"b":["202","202","345","340","335","305","340","202","345","325","340","202","325","202","202","202","340","325"]},"Network entry point  is generally used to multiplex and demultiplex amongst many gateways, corporate servers, and bulk connections such as the Internet, for example. There are normally very few of these network entry points , since they are also intended to centralize externally available wireless network services. Network entry points  often use some form of an address resolution component  that assists in address assignment and lookup between gateways and mobile stations. In this example, address resolution component  is shown as a dynamic host configuration protocol (DHCP) as one method for providing an address resolution mechanism.","A central internal component of wireless data network  is a network router . Normally, network routers  are proprietary to the particular network, but they could alternatively be constructed from standard commercially available hardware. The purpose of network routers  is to centralize thousands of fixed transceiver stations  normally implemented in a relatively large network into a central location for a long-haul connection back to network entry point . In some networks there may be multiple tiers of network routers  and cases where there are master and slave network routers , but in all such cases the functions are similar. Often network router  will access a name server , in this case shown as a dynamic name server (DNS)  as used in the Internet, to look up destinations for routing data messages. Fixed transceiver stations , as described above, provide wireless links to mobile station .","Wireless network tunnels such as a wireless tunnel  are opened across wireless network  in order to allocate necessary memory, routing, and address resources to deliver IP packets. Such tunnels  are activated as part of what are referred to as Packet Data Protocol or \u201cPDP contexts\u201d (i.e. packet data sessions). To open wireless tunnel , mobile station  must use a specific technique associated with wireless network . The step of opening such a wireless tunnel  may require mobile station  to indicate the domain, or network entry point  with which it wishes to open wireless tunnel . In this example, the tunnel first reaches network router  which uses name server  to determine which network entry point  matches the domain provided. Multiple wireless tunnels can be opened from one mobile station  for redundancy, or to access different gateways and services on the network. Once the domain name is found, the tunnel is then extended to network entry point  and necessary resources are allocated at each of the nodes along the way. Network entry point  then uses the address resolution (or DHCP ) component to allocate an IP address for mobile station . When an IP address has been allocated to mobile station  and communicated to gateway , information can then be forwarded from gateway  to mobile station .","In this application, an \u201cIP-based wireless network\u201d (one specific type of wireless network) may be or include but is not limited to: (1) a Code Division Multiple Access (CDMA) network; (2) a General Packet Radio Service (GPRS) network for use in conjunction with Global System for Mobile Communications (GSM) network both developed by standards committee of European Conference of Postal and Telecommunications Administrations (CEPT); and (3) future third-generation (3G) networks like Enhanced Data rates for GSM Evolution (EDGE) and Universal Mobile Telecommunications System (UMTS). It is to be understood that although particular IP-based wireless networks have been described, the techniques of the present application could be utilized in connection with any similar type of network (e.g. IEEE 802.11 based WLAN, or WiMAX, etc.). The infrastructure shown and described in relation to  may be representative of each one of a number of different networks which are provided and available in the same geographic region. One of these communication networks will be selected by the mobile station for communications at any given time.","Referring now to , what is shown is an illustrative representation of an exemplary user interface  of mobile station  of  which includes at least display , keyboard , speaker , microphone , and a cursor or view positioning mechanism such as a positioning wheel  (e.g. a scrollwheel) or a trackball . Although shown enlarged in  for clarity, this mobile station  may be sized to be a handheld portable device in various embodiments. As an alternative to or in addition to positioning wheel  and\/or trackball , a wide range of one or more pointing or cursor\/view positioning mechanisms such as a touch pad a joystick button, a mouse, a touchscreen, a tablet, or other whether presently known or unknown, may be employed. The cursor may be or include a pointer, a movable item or other visual cue used to mark a position or point to another item on a display, in order to, for example, indicate position for data entry or for selection of the other item.","Keys  of keyboard  are disposed on a front face of a housing  and positioning wheel  is disposed at a side of housing . Keyboard  is in the example form of a reduced QWERTY keyboard including a plurality of keys  that serve as input members. It can be seen that the arrangement of the characters  on keys  of keyboard  is generally of the QWERTY arrangement, albeit with many of keys  including two of characters . In the example depiction of keyboard , many of keys  include two characters, such as including a first character  and a second character  assigned thereto. Characters may include letters, digits, symbols and the like and can additionally include ideographic characters, components thereof, and the like. One of keys  of keyboard  includes as the characters  thereof the letters \u201cQ\u201d and \u201cW\u201d, and an adjacent key  includes as the characters  thereof the letters \u201cE\u201d and \u201cR\u201d. Keyboard  may be of other configurations, such as an AZERTY keyboard, a QWERTZ keyboard, a Dvorak keyboard, or other keyboard or keypad arrangement, provided for languages other than English, and either reduced or not reduced (i.e. full). In a \u201cfull\u201d or non-reduced keyboard or keypad arrangement, each key has a single letter (not multiple letters) of the alphabet assigned to it.","Among keys  of keyboard  are a <NEXT> key  and an <ENTER> key . The <NEXT> key , wherein, for example, \u201c<NEXT>\u201d may be a symbol or may be the word \u201cnext\u201d provided (e.g. printed) on the key, may be pressed to provide a selection input to the processor and provides substantially the same selection input as is provided by a rotational input of positioning wheel . Since the <NEXT> key  is provided adjacent a number of other keys  of keyboard , the user can provide a selection input to the processor substantially without moving the user's hands away from the keyboard  during a text entry operation. Another key, the <ESC> key  is disposed on the side of housing  adjacent positioning wheel , although the same or similar key may be disposed as part of keyboard . Among keys  of the keyboard  additionally is a <DEL> key  that can be provided to delete a text entry.","Positioning wheel  may serve as another input member and is both rotatable, as is indicated by an arrow , to provide selection inputs to the processor, and also can be pressed in a direction generally toward housing , as is indicated by an arrow  to provide another selection input to the processor. Display  may include a cursor  that depicts generally where the next input or selection from user interface  will be received. Display  is shown in  as displaying a home screen that represents a number of applications  ( shows some of the example possible applications ) depicted as corresponding discrete icons . Icons  may include, for example, an Electronic Mail (E-Mail) icon , a Calendar icon , an Address Book icon , a Tasks icon , a Messages icon , a MemoPad icon , and a Search icon , respectively.","As shown further in , memory  of mobile station  includes a plurality of applications or routines  associated with the visually displayed icons  of  for the processing of data. Applications  may be in any of a variety of forms such as, without limitation, software, firmware, and the like. Applications  may include, for example, an Electronic Mail (E-Mail) application  () associated with E-mail icon  (), a Calendar application  () associated with Calendar  icon  (), an Address Book application  () associated with Address Book icon  (), a Tasks application  () associated with Tasks icon  (), a MemoPad (Memos) application  () associated with MemoPad icon , a Web Browser application  () associated with Web Browser icon  (), a Voice\/Telephone application  () associated with Voice\/Telephone icon , and a Search application  () associated with Search icon  (). An operating system (OS) program  also resides in memory .","In , the \u201chome\u201d screen output is shown as currently active and constitutes the main \u201cribbon\u201d application for displaying the icons  shown. An application, such as E-mail application  of , may then be initiated (opened or viewed) from user interface  by providing a suitable user input to it. For example, E-mail application  may be initiated (opened or viewed) by rotating positioning wheel  to highlight E-mail icon  and providing a selection input by translating positioning wheel  in the direction indicated by arrow . As another example, display  displays icon  associated with Search application  and accepts input from positioning wheel  to initiate a search from that icon . Applications  may be additionally or alternatively initiated (opened or viewed) from user interface  by providing another suitable input to it, such as by suitably rotating or \u201crolling\u201d trackball  and providing a selection input by, for example, pushing the trackball  (e.g. somewhat similar to positioning wheel  except into the plane of ).","Movement, navigation, and\/or scrolling with use of a cursor\/view positioning mechanism is beneficial given the relatively large size of visually displayed information and the compact size of display  of , and since information and messages are typically only partially presented in the limited view of display  at any given moment. As previously described, positioning wheel  is one helpful cursor\/view positioning mechanism to achieve such movement. Positioning wheel , which may be referred to as a scrollwheel, specifically includes a circular disc which is rotatable about a fixed axis of housing  and may be rotated by the end user's index finger or thumb. When the information or message is being partially displayed, an upwards rotation of positioning wheel  causes an upwards scrolling such that display  presents viewing of an upper portion of the information or message. Similarly, a downwards rotation of positioning wheel  causes a downwards scrolling such that display  presents viewing of a lower portion of the information or message. Positioning wheel  is mounted along a fixed linear axis such that the end user can depress positioning wheel  inwards toward housing  (e.g. with the end user's index finger or thumb) for selection of information. Again, see the direction indicated by an arrow  of positioning wheel  shown.","Although a specific mobile station  has just been described, any suitable mobile device or terminal may be part of the methods and apparatus which will be described in fuller detail below. Note that many components of mobile device  shown and described may not be included. As mentioned earlier, keyboard  and\/or display  may be substituted with a touch screen display and\/or other suitable input mechanism, and\/or enhanced or replaced with a voice-activated input module.",{"@attributes":{"id":"p-0055","num":"0054"},"figref":["FIGS. 6A and 6B","FIGS. 1","FIGS. 6A and 6B","FIG. 6A","FIG. 6B"],"b":["600","2","4","600","602","612","652","604"]},"The e-mail servers  that are shown in  include an e-mail server  which serves a plurality of terminals  of a public network  (e.g. the Internet) and an e-mail server  which serves a plurality of terminals  of a private network . Terminals  shown in public network  include terminals , , and , whereas terminals  shown in private network  include terminals , , and . In this embodiment, the terminals are computers such as desktop or laptop PCs which may be connected to e-mail server  via the Internet using any conventional means (e.g. telephone dial-up, cable, or DSL modem). End-users of the PCs are able to access their appropriate personal e-mail accounts for sending and receiving new e-mail, as well as reviewing, sorting, organizing, and otherwise managing previously received e-mail stored at the e-mail server.","An end-user of each terminal  connected in public network  has an e-mail account on e-mail server  which stores and manages e-mail messages in a local database  of memory for the respective terminal. Each terminal  and\/or its corresponding e-mail account is associated with a respective one of mobile devices  () to which e-mail information is pushed. Similarly, an end-user of each terminal  connected in private network  has an e-mail account on e-mail server  which stores and manages e-mail messages in a local database  of memory for the respective terminal. Each terminal  and\/or its corresponding e-mail account is associated with a respective one of mobile devices  to which e-mail information is pushed.","Terminals  connected in private network  and their respectively e-mail accounts are generally affiliated with each other; that is, they may be associated with the same group, enterprise or business. For example, terminals , , and  may be utilized by the same group and use the same network domain name for e-mail purposes. In private network , e-mail server  and host server  privately serve each end user in the network. On the other hand, terminals  connected to public network  and their respective e-mail accounts are generally unaffiliated with each other; that is, they are not necessarily associated together with the same business or private network. For example, terminals  and  are not utilized by the same company nor are they part of the same private network. When an end user of one of terminals  accesses e-mail, for example, the end user's terminal is used to connect to e-mail server  via the Internet through an Internet Service Provider (ISP) using an appropriate Uniform Resource Locator (URL) (e.g. for a webmail-based service). Using the terminal, the end user sends his\/her individual user name and password to log on to this e-mail server. If this user name and password information matches that stored at the e-mail server, the login is successful and an e-mail session is created so that the end-user can perform e-mail tasks.","Each mobile device  () is portable and includes, for example, a housing with a display and an input mechanism (e.g. keyboard\/keypad), as well as a wireless transceiver, an antenna, and one or more processors which control the operation of the device. For example, see . Each wireless communication network  is coupled to a plurality of base stations for providing wireless coverage for a mobile station. For example, wireless network  is shown to have a plurality of base stations  including a base station  and a base station . Each base station (e.g. base station ) helps establish a wireless coverage area or cell (e.g. a cell ) within which a mobile device (e.g. mobile device ) is able to communicate. Wireless networks  may include, as examples, cellular telecommunication networks and wireless local area networks (WLANs) (e.g. 802.11 based networks). At least some of wireless networks  are different from other wireless networks within communication system .","Each mobile device  has the ability to send and receive e-mail information associated with its e-mail account managed by one of e-mail servers  and . The e-mail information may be received by each mobile device  via a (substantially) real-time automatic \u201cpush\u201d methodology, in contrast to any method requiring devices  to invoke a manual connection for the receipt of e-mail information. The pushing of e-mail information from e-mail servers  and  to mobile devices  is facilitated with use of host servers  and , respectively, which are coupled to a relay network  (). In private network , host server  communicates with relay network  through a firewall  which performs at least the conventional function of preventing unauthorized access into such network . A trigger mechanism is provided so that, when new e-mail messages are received or updated e-mail information is identified, host server  (or host server ) receives a copy of such information from e-mail server  (or e-mail server ) for delivery to a mobile device. Host server  has a local database  in memory for storing (at least temporarily) such e-mail information received from e-mail server , and host server  has a local database  in memory for storing (at least temporarily) such e-mail information received from e-mail server .","Relay network  is communicatively coupled to wireless networks  for relaying messages to mobile devices . Relay network  includes a message server  and a token server . Message server  handles all incoming messages from all host servers into the relay network . In general, when a new e-mail message is received at an e-mail server (e.g. e-mail server ), its corresponding host server (e.g. host server ) is adapted to receive a copy of e-mail information of the e-mail message for delivery in a message to the associated mobile device. Host server  causes this message to be delivered to relay network , which relays the message to the mobile device through the appropriate wireless network. Note that relay network  may serve a very large number of such host servers and networks (which include host servers  and  in networks  and , respectively) for communicating messages generally in this fashion.","Terminals may also be able to interact with application server  which is accessible via a communication network, such as,public network . Application server  may include a server program of a computer that provides business logic for an application program. Application server  may provide, for example, data, content, file documents, etc., to its client terminals. In addition, application server  may provide a service to its client terminals, such as a file storage and retrieval service, a goods and\/or service purchasing service, or an e-commerce transaction service, etc., to its client terminals.","Application server  may part of a three-tier architecture which includes a graphical user interface (GUI) server, an application (business logic) server, and a database and transaction server. More specifically, application server  may be viewed as part of (a) a first-tier, front-end, Web browser-based graphical user interface, usually at a personal computer or workstation; (b) a middle-tier business logic application or set of applications, possibly on a local area network or intranet server; and (c) a third-tier, back-end database and transaction server, oftentimes on a mainframe or large server. As apparent, application server  may be part of a middle structure between browser-based front-ends and back-end databases and\/or legacy systems. Application server  may also be part of or include a Web server (or HTTP server) and be referred to as a Web application server. A Web browser of a client terminal supports an HTML-based front-end, and the Web server operates to forward a request to an application server and respond back with a modified or new Web page. Such approaches may make use of a Common Gateway Interface (CGI), FastCGI, Active Server Pages (ASPs), and Java Server Pages (JSPs). In some cases, the Web application server may support request \u201cbrokering\u201d interfaces, such as the CORBA Internet Inter-Orb Protocol (IIOP). The term \u201capplication server site\u201d refers to any one of these server architectures or similar ones.","With respect to mobile devices, application server  may be further adapted to operate in accordance with a wireless access protocol (WAP). WAP is an open international standard for application layer network communications in a wireless environment. A WAP browser in the mobile device is adapted to facilitate all of the basic services of a computer-based web browser, but is simplified to operate within the restrictions of a small, portable device (e.g. its smaller display screen). WAP sites are websites are typically written in, or dynamically converted to, Wireless Markup Language (WML) and accessed via the WAP browser. Thus, application server  may have applications which provide WML data to mobile devices.","Application server  may also store in its database  a digital certificate of the service provider. The digital certificate has a public key corresponding to the service provider. The digital certificate (public key) may be viewed as being associated with a group of subscribers or mobile devices. Note that application server  may in fact store a plurality of digital certificates\/public keys associated with different service providers.","Referring now to , an illustration of a simplified relevant portion of the system of  is shown.  shows host servers  and , application server , message server  and token server  of relay network , wireless network , and various terminals and mobile devices operating within their associated networks. In relay network , messages containing e-mail information from host servers  and  are received by message server  which, under normal circumstances, will communicate them for delivery to the mobile devices.","The pushing of information to mobile devices as described may be part of a \u201cdata synchronization\u201d of data items between an application program of the host server and a corresponding application program at the mobile device. The host server is operative to maintain data synchronization with the mobile device over the wireless network for user data of the application program associated with a user account. For the data-synchronized communications, the host server maintains storage of a mapping of a user account name or identifier of the user account with a personal identification number (PIN) of the mobile device. Alternatively, the PIN may be or be referred to as a product identification number. When communications are required with the mobile device, the PIN may be used to route the messages to\/from the source device through the system. As described above, the application program may be or include, for example, an e-mail application program for the communication of e-mail messages. In this case, the data synchronization is a message synchronization for the e-mail messages associated with the user account for an e-mail application program. The data synchronization may alternatively or additionally be or include an address book synchronization for address book contacts in an address book organizer, or a calendar appointment synchronization for calendar appointments in a calendar application program.","Wireless network  may be owned and\/or operated by a service provider (e.g. a wireless carrier, such as AT&T, Rogers Communications, T-Mobile, etc.) which provides a communication service (e.g. a voice telephony service and\/or packet data service) for mobile devices. Similarly, relay network  may also be owned and\/or operated by a service provider (e.g. a data service provider) which provides an additional communication service (e.g. a data communication service, such as the data synchronization service for \u201cBlackBerry\u201d products). The service provider for the voice telephony service may be different from the service provider for the data communication service; however, the services providers for these services may be the same.","In order to access and utilize the communication service(s), the mobile device is typically activated and has a valid subscription for the service. After the subscription is setup (e.g. via purchase) and the mobile device is activated, the mobile device is able to gain access to the communication service via the wireless network upon registration or access. At this time, the mobile device sends its identity and\/or credentials for verification and\/or authentication by the service provider via the wireless network. The information may be or include, for example, information on a SIM of the mobile device, a subscriber identity, a subscriber key, a PIN, a telephone number, an e-mail address, or combinations thereof. The network may perform verification and\/or authentication techniques which may be or include a database or memory check for a valid subscription stored in association with the information; an authentication, authorization and accounting (AAA) procedure; extensible authentication protocol (EAP) procedure; or variations or combinations of the same. If the verification and\/or authentication by the service provider in the network is successful, the mobile device gains access to and may utilize the communication service. The mobile device may also gain access to and utilize any networks and servers (e.g. token server ) of the service provider. If unsuccessful, the mobile device cannot gain access to the communication service of the service provider and it associated networks and servers.","Certificate authority  has a server which maintains and interacts with a database  of digital certificates, each of which is uniquely associated with a respective owner. Digital certificates typically contain an identity of the owner (e.g. a service provider of a communication service) and a public key. The matching private key is not similarly made available publicly, but is kept secret by the owner. As is known, a digital certificate is based on a cryptographic system that uses two keys, a public key which is publicly available and a private (or secret) key known only to the holder of the digital certificate. A digital certificate includes a collection of data used to verify the identity of the holder of the certificate. A digital certificate (e.g. a X.509 based certificate) may contain information which includes identifiers or indicators of a version, a serial number, a certificate issuer, a certificate holder, a validity period (the certificate is not valid before or after this period), attributes (known as certificate extensions, that contain additional information such as allowable uses for this certificate), a digital signature from a certification authority (CA) (to ensure that the certificate has not been altered and to indicate the identity of the issuer), a public key of the owner of the certificate, and a message digest algorithm used to create the signature. The digital signature identifies or indicates the digital certificate of the signer, and the digital certificate contains a digital signature which further identifies or indicates another digital certificate. In general, each digital certificate is verified through the use of another digital certificate, creating a chain of digital certificates that ends with the root digital certificate. The owner of the root certificate is the root certification authority. Thus, a digital certificate may be considered an attestation by the certificate authority that the public key contained in the certificate belongs to the identified owner. A certificate authority's obligation in such schemes is to verify an applicant's credentials, so that users and relying parties can trust the information in the certificate authority's certificates. Certificate authorities use a variety of standards and tests to do so. If the recipient trusts the certificate authority and can verify the certificate authority's signature, then the user can confirm that the public key does indeed belong to the owner.","More specifically, one of the digital certificates maintained by certificate authority  in database  is associated with the data service provider of the data communication service (e.g. the data synchronization service). A private key corresponding to and uniquely associated with the data service provider may be securely held and stored in database  of token server , and used for digitally signing each token. When an authorized mobile device requests a token from token server , token server  generates a token and digitally signs the token with use of the private key. The token server  sends the token to the mobile device, but note that the private key of the data service provider is not (and in some embodiments, preferably never) passed to the mobile device. The mobile device includes the received token in a message(s) sent to application server . Since application server  has previously received the digital certificate of the data service provider from certificate authority  by request via the network, application server  is able to verify the digital signature of the token with use of the public key corresponding to the data service provider.","In another embodiment, or in combination with the above, one of the digital certificates maintained by certificate authority  in database  is associated with the wireless carrier of the voice telephony service. A private key corresponding to and uniquely associated with the wireless carrier may be securely held and stored in a database  of a token server , and used for digitally signing each token. When an authorized mobile device requests a token from token server , token server  generates a token and digitally signs the token with use of the private key. The token server  sends the token to the mobile device, but note that the private key of the wireless carrier is not (and in some embodiments, preferably never) passed to the mobile device. The mobile device includes the received token in a message(s) sent to application server . Since application server  has previously received the digital certificate of the wireless carrier from certificate authority  by request via the network, application server  is able to verify the digital signature of the token with use of the public key corresponding to the wireless carrier.","According to one aspect of the present disclosure, if mobile device  successfully accesses a communication service via the wireless network , it is able to gain access to at least some of the network(s) and server(s) of the service provider. Such access includes access to the token server of the service provider's network (e.g. token server  or ). Thus, mobile device  may request and successfully receive a token from token server  of the service provider. The token includes a digital signature of the service provider. Mobile device  then sends a message to application server  which includes the token having the digital signature of the service provider. Application server  receives the message and, in response, performs token validation. The token validation at application server  includes at least a verification step for verifying the digital signature of the token with a public key corresponding to the service provider. If the token validation is successful, application server  grants the mobile device  access to an application service of application server  via wireless network . On the other hand, if the token validation is unsuccessful, application server  denies access to the application service. For example, application server  may be adapted to provide an e-commerce transaction service for mobile device  if token validation is successful; otherwise the e-commerce transaction service is denied. In a more particular example, application server  may be adapted to provide a proof-of-work (POW) test for performing an e-commerce transaction via the application server , but will bypass or exclude the POW test for mobile device  if the token validation is successful.",{"@attributes":{"id":"p-0074","num":"0073"},"figref":"FIG. 8A","b":["800","624","624"]},"Prior to operation and use, mobile device  is activated and has a valid subscription for a communication service. Thereafter, mobile device  is able to gain access to the communication service via the wireless network upon registration or access. At this time, mobile device  sends its identity and\/or credentials for verification and\/or authentication by the service provider via the wireless network (e.g. as described earlier above). If the verification and\/or authentication by the service provider in the network is successful, mobile device  gains access to and may utilize the communication service via the wireless network. Mobile device  may also gain access to and utilize any networks and servers (e.g. token server ) of the service provider. If unsuccessful, mobile device  cannot gain access to the communication service of the service provider and its associated networks and servers.","During operation of mobile device  in the wireless network, a user of mobile device  wishes to access data or a service of application server . The user may therefore utilize the user interface of mobile device  to invoke or initiate access to the data or service of application server  (e.g. typing in a Uniform Resource Locator (URL) of application server  or clicking on an icon), to thereby initiate a request (step  of ). In response, mobile device  identifies whether it has a valid token (already) stored in memory to submit to application server  for proper access. If a valid token is already stored in its memory, the process flow will continue at step . Otherwise, if there is no valid token stored in its memory, mobile device  sends, via the wireless network, a request message for a token to token server  (step  of ) in response to the user's request.","In response to the request message for the token, token server  produces a token for the mobile device  (step  of ) and sends the token to mobile device  via the wireless network in a response message (step  of ). Mobile device  receives the token and stores it in its memory (step  of ). The token may include information such as a sequence number for uniquely identifying the token, an identification of mobile device  (e.g. its PIN), and a timestamp of the current date and\/or time. The token is also digitally signed by token server  with use of the private key of the service provider. Steps  to  may be performed without user intervention or knowledge of the same.","Below is Table 1 which illustrates an example of token information in the token which his provided in the HTTP cookie. The token may include one or more of the following items of information.",{"@attributes":{"id":"p-0079","num":"0078"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"center"}},"thead":{"row":{"entry":"TABLE 1"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"One example of token information."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Minimum","Maximum",{},{},{}]},{"entry":[{},"Length","Length"]},{"entry":["Name","(Bytes)","(Bytes)","Format","Example","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"char","char":"."}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"char","char":"."}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["VER","1","7","UTF-8","1.0.0.0","Protocol Version"]},{"entry":[{},{},{},{},{},"Number"]},{"entry":["KEYID","1","7","UTF-8","1","Key Version"]},{"entry":["TIME","19","19","ISO 8601","2008-05-","Token Generation"]},{"entry":[{},{},{},{},"28T16:23:15Z","Date And Time"]},{"entry":["PIN","10","10","64-bit","0xFFFFFFFF","Device's PIN"]},{"entry":[{},{},{},"hex integer",{},"Number"]},{"entry":["SEQID","1","10","64 bit long","285896","Sequence Number"]},{"entry":[{},{},{},"integer"]},{"entry":["SIG","\u2014","\u2014","CMS\/PKCS7","\u2014","Digital Signature"]},{"entry":["PARTID","variable","Variable","UTF-8\/X509","BlackBerry","Identifies"]},{"entry":[{},{},{},"Name\/X509",{},"Provider\/Partner"]},{"entry":[{},{},{},"Certificate"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}},"br":{}},"Once the valid token is received or confirmed, mobile device  causes an HTTP cookie in the (browser) application to be set (step  of ). In particular, the HTTP cookie is set to be or include the received token from the token server. Mobile device  may initiate the cookie setting by submitting a \u201cSet-Cookie\u201d request to the application via an Application Programming Interface (API) of the application.","Note that traditionally, cookies are set in a Web browser upon receipt of a \u201cSet-Cookie\u201d header string from the server in response to a HTTP request, where the server is the originator of the name and value (e.g. randomly selected) for the cookie. As apparent, the HTTP cookie in the present technique is initialized by mobile device , and at least has a group identification of a group with which the user is associated (e.g. a plurality of subscribers of the service provider) as well as a message portion which is signed with a digital signature of the group. Next, mobile device  produces and sends a message to application server  as part of the device's response to the user's initial input request from step  (step  of ). Mobile device  formats the message to include the HTTP cookie having the token in a predetermined field (e.g. header field) of the message.","Application server  receives the message from mobile device  and processes it. For one, application server  may perform validation of the message. For example, application server  may test whether a token is identified in the HTTP cookie within the predetermined field of the message (step  of ). If a token exists as identified by application server , then this verification step is successful; otherwise, if no valid token is identified in the predetermined field, the verification step fails. Further, the application server  may determine whether the token is signed by the service provider (step  of ). Such a positive verification identifies that the mobile device is indeed a subscriber of the service provider (and e.g. not a subscriber of a different service provider). Here, application server  attempts to verify the digital signature with a public key corresponding to the service provider (which may be obtained from certificate authority ). If the digital signature is successfully verified by application server  with the public key, then this verification step is successful; otherwise the verification step fails.","The specific actions taken for verification of the digital signature will depend on the protocol or algorithm selected and utilized for its creation. The underlying algorithm may be or be based on Digital Signature Algorithm (DSA), RSA, or other suitable algorithm. For example, Elliptic Curve Digital Signature Algorithm (ECDSA) may be utilized. In one particular example, ECDSA with P521 is utilized for It producing and verifying signatures; if ECC technology is not available, RSA 3072 may be utilized.","If all such verifications are successful (e.g. in steps , ), then validation is successful. Application server  sends a response message with access to the data or service as requested (step  of ), operating to perform session management and control with use of the HTTP cookie (step  of ). Thus, application server  grants mobile device  access to the application service via the wireless network if the validation is successful and denies mobile device access  to the application service if the validation is unsuccessful.","As indicated, application server  operates to perform session control and management with use of the HTTP cookie. In itself, HTTP is a stateless protocol; that is, it does not inherently correlate request\/response messages with earlier transactions between the same client and server. Here, the cookie is utilized to indicate a specific client state for better session control and management in relation to different users. The browser application stores the cookie and, each time the application requests a page from the server, the cookie is sent to the server. When a subsequent request for another page of the same server is submitted (in the same or different communication session), the server identifies that the request is related to the previous one to maintain coherency of the session.","Although the exact format of the cookie may vary, the cookie typically includes information which includes a name, a value, a domain, and a path. The \u201cname\u201d relates to the name of the cookie variable (for example, \u201cUserID\u201d). The \u201cvalue\u201d is the string value assigned to the cookie variable. For example, the cookie variable named \u201cUserID\u201d could be set to a value of \u201c334\u201d. The \u201cdomain\u201d instructs the browser application to which web domain the cookie should be sent. On the other hand, the \u201cpath\u201d specifies a directory where the cookie is active; it is the top level of the subtree within the domain for which the cookie is valid, and returned upon access to a page within the subtree. The cookie may also be provided with an expiration date which instructs the browser application when to delete the cookie. If no expiration date is provided, the cookie is deleted at the end of the session, when the browser application is exited. The expiration date is a means for making cookies survive across different sessions.","Application server  may further utilize the HTTP cookie to provide user or group personalization or preferences. For example, application server  may allow the user or group (via an administrator) to select and store how data is to be displayed (personalizing the pages). These preferences may be maintained across multiple sessions of the user or group. A user or group (via an administrator) may select one or more preferences by indicating or entering preference data in a form and submitting it to the server. The preference data may be stored at application server  in relation to the user\/group identification.","Even further, application server  may provide additional authentication in relation to the HTTP cookie through use of additional authentication information. For example, a login requirement may be required of mobile device  for authentication on the first visit or session at application server . In this case, the user may insert a username and password in the text fields of a login page and send them to the server. Application server  receives username and password, and checks them; if they are correct, application server  provides access and sends back a page confirming that the login was successful (and otherwise denying the access). Here, note that the cookie may be made valid for only the current browser session. Alternatively, the cookie may be set to expire at a future date, in which case the same cookie may be provided on future visits for without any login requirement.","In one embodiment, the message in step  is a request message of data, and specifically may be a Hypertext Transfer Protocol (HTTP) request message. The token may be included in an HTTP header field, or alternatively an HTTP footer field or an HTTP body field, as examples. In response to the HTTP request message, application server  will generate and send display data for mobile device . Upon receipt of the display data, mobile device  renders text, graphics, images, other information, or combinations of the same based on the display data. The display data may be, for example, Hypertext Markup Language (HTML) data, eXtensible Markup Language (XML) data, Simple Object Access Protocol (SOAP), or data having another suitable format.","Again, mobile device  may send the same HTTP cookie in each one of a plurality of subsequent messages of the same communication session submitted to application server . Here, application server  may expect to receive and process the HTTP cookie as described herein for each such message. In one variation, mobile device  sends the same HTTP cookie in each one of the plurality of subsequent messages (at least of the same communication session) submitted to application server , but an initial single validation by application server  is deemed sufficient so that application server  may refrain from validating each subsequent request message (at least of the same communication session). Here, application server  still processes the HTTP cookie in each subsequent message for session control and management.",{"@attributes":{"id":"p-0091","num":"0090"},"figref":"FIG. 8B","b":["850","624"]},"In this embodiment, and referring back to , one of the digital certificates maintained by certificate authority  in database  is associated with the user of mobile device . In fact, each one of the plurality of users having mobile It devices may have a digital certificate maintained by certificate authority . A private key corresponding to and uniquely associated with the user of mobile device  may be securely held and stored in memory of mobile device , and used for digitally signing messages by mobile device . As discussed below, mobile device  may operate to digitally sign a message portion of an HTTP cookie with use of its private key, and provide it in a message(s) sent to application server . Since application server  may receive the digital certificate (e.g. public key) of mobile device  from certificate authority  by request via the network, application server  is able to verify the digital signature in the HTTP cookie with use of the public key corresponding to mobile device . Note that application server  may in fact store in its database  a plurality of digital certificates\/public keys associated with different users having communication devices.","Referring again to , during operation of mobile device  in the wireless network, a user of mobile device  wishes to access data or a service of application server . The user may therefore utilize the user interface of mobile device  to invoke or initiate access to the data or service of application server  (e.g. typing in a Uniform Resource Locator (URL) of application server  or clicking on an icon), to thereby initiate a request (step  of ). In response, mobile device  identifies whether it has a cookie set in memory to submit to application server  for proper access. If a valid cookie is already set, the process flow will continue at step .","If there is no valid cookie set, mobile device  causes an HTTP cookie in the (browser) application to be set (step  of ). In this embodiment, the HTTP cookie is set to include at least a user identification of a user of mobile device  as well as a message portion which is signed with a digital signature of the user. Mobile device  may initiate the cookie setting by submitting a \u201cSet-Cookie\u201d request to the application via an Application Programming Interface (API) for the application. Traditionally, cookies are set in a Web browser in response to receipt of a \u201cSet-Cookie\u201d header string from the server in response to a HTTP request, where the server is the originator of the cookie's name and value (typically a random number). Here, the HTTP cookie used in the present technique is initialized or set by mobile device  and not the server.","Next, mobile device  produces and sends a message to application server  as part of the device's response to the user's initial input request from step  (step  of ). Mobile device  formats the message to include the HTTP cookie in a predetermined field (e.g. header field) of the message.","Application server  receives the message from mobile device  and processes it. For one, application server  may perform validation of the message. For one, application server  may test whether the HTTP cookie is included within the predetermined field of the message (step  of ). If the HTTP cookie exists as identified by application server , then this verification step is successful; otherwise, if no valid token is identified in the predetermined field, the verification step fails.","Further, the application server  may determine whether the message portion of the HTTP cookie is signed by the user (step  of ). Such a positive verification identifies that the user of mobile device  is a valid, existing (human) user. Here, application server  attempts to verify the digital signature with a public key corresponding to the user. The public key may be identified from the user's digital certificate which is obtained from certificate authority  via the network. If the digital signature is successfully verified by application server  with the public key, then this verification step is successful; otherwise the verification step fails. Even further, application server  may identify whether an expiry date\/time of the cookie has expired. If the expiry date\/time has not yet expired, then the verification is successful; otherwise the verification fails.","Again, the actions taken for verification of the digital signature will depend on the protocol or algorithm selected and utilized for its creation. The underlying algorithm may be or be based on DSA, RSA, or other suitable algorithm, such as ECDSA. In one particular example, ECDSA with P521 is utilized for producing and verifying signatures; if ECC technology is not available, RSA 3072 may be utilized.","If all such verifications are successful (e.g. in steps , ), then validation is successful. Application server  sends a response message with access to the data or service as requested (step  of ), and also operates to perform session management and control with use of the HTTP cookie (step  of ). Thus, application server  grants mobile device  access to the application service via the wireless network if the validation is successful and denies mobile device access  to the application service if the validation is unsuccessful.",{"@attributes":{"id":"p-0100","num":"0099"},"figref":"FIGS. 9-13","b":["222","690"]},"In this specific example, application server  is providing a purchasing service for purchasing goods and\/or services via application server . In this example, application server  may offer for sale tickets for anticipated events (sports, theatre, shows, etc.) Such data may include the display of data items (e.g. one or more events  of  of ) pertaining to goods and services to be purchased. This purchasing service may or may not involve an e-commerce transaction service for performing an e-commerce transaction via the application server. In one embodiment, application server  grants the mobile device access to the e-commerce transaction service if validation\/verification is successful; otherwise, application server  denies access to the e-commerce transaction service. In this case, receiving of data and information (e.g. goods and\/or services to be purchased) may be allowed but the e-commerce transaction service may be disallowed (e.g. where the actual purchasing of the goods and\/or services may take place over the telephone). An error message or redirection message may be produced in the display in response.","In a purchasing or e-commerce transaction, data or information that is received and displayed may include an identification of the good or service (e.g. an identification  of an event ticket in ), a quantity of the good or service (e.g. a quantity  of the event ticket(s) in ), and a cost of the good or service (e.g. a cost  of the event ticket(s) in ). Also, data or information that is submitted in the e-commerce transaction may include customer payment information  (e.g. credit card information of the user) along with a total cost , an example of which is shown in . Finally, the data or information that is submitted in the e-commerce transaction may include customer address or shipment information , an example of which is shown in .","Note that access or denial to any suitable type of data or service may be provided by application server  based on these validation techniques. In this context, for example, certain subscribers or subscribers of the service provider may be entitled to offers for (purchasing of) tickets to attend predetermined events upon successful token validation, but otherwise not be entitled to the offerings for (purchasing of) the tickets. As another example, subscribers of the service provider may be entitled to price discounts off of tickets to attend predetermined events, but otherwise not be entitled to such price discounts.","In an alternate embodiment, application server  may be generally operative to provide display data for producing a proof-of-work (POW) test, such as a challenge-response test, to be executed by terminals prior to their gaining access to the application service (e.g. the e-commerce transaction service). The reason is that application server  may be vulnerable to automated software from \u201cbots\u201d or the like, and needs to utilize means to prevent accessibility to the information or service by such automated software. In general, such test involves submitting a question (challenge) to a terminal, receiving an answer (response) from the terminal, and verifying the correctness of the answer (response); the question is difficult to answer unless it is answered by a human or large processing power is utilized. For example, an application server may utilize a challenge-response test such as a Captcha test (\u201cCompletely Automatic Public Turing test to tell Computers and Humans Apart\u201d), an example of which is shown in . Such display data may include a distorted visual image  of alphanumeric text and a user input field  for user input of alphanumeric information corresponding to the alphanumeric text.","In accordance with the various embodiments of the present disclosure, however, application server  bypasses or excludes such challenge-response test for the mobile device (and refrains from producing display data therefor) if the validation\/verification is successful. For example, a request message for purchasing may cause application server  to continue the e-commerce transaction if validation\/verification is successful, but otherwise cause application server  to produce the POW test (e.g. Captcha test) for the terminal to execute.","In a variation of the technique, application server  provides an alternative challenge-response test in lieu of the normal challenge-response test if the token validation is successful. The alternative challenge-response test may be a \u201cmobile-friendly\u201d challenge-response test that is suitable for mobile devices (e.g. in contrast to desktop or laptop computers). Thus, more generally, a first POW test is provided if the validation\/verification is unsuccessful, but a second POW test which may be suitable for mobile devices is provided if the validation\/verification is successful.","In another alternate embodiment, token server  may be generally operative to provide display data for producing a POW test, such as a challenge-response test (e.g. Captcha), to be executed by terminals prior to their receipt of a token. If the POW test is passed, the mobile device receives the token from token server ; otherwise, if the mobile device fails the POW test, it does not receive a valid token from token server . This step may be provided in addition to, or alternatively in lieu of, any POW test requirement by the application server. If additionally provided, it may provide an additional level of verification\/security for mobile device access, or alternatively a more selective authorization of only a subset of all mobile devices associated with the service provider. If alternatively provided, this step may provide a shift in the burden of test processing (e.g. Captcha test processing) from the application server to the service provider; this is especially advantageous where there is more than one application server that utilizes the token verification techniques of the present disclosure.","Thus, special access privileges are granted only to particular users or groups of devices (e.g. trusted devices). Convenient accessibility to these application services are given to entrusted devices in a manner that is simple and efficient. Where \u201cgroup\u201d verification is utilized, the application server need not store and maintain excessive information for each individual subscriber or device associated with a service provider; also, the private key associated with the service provider is, in some embodiments, preferably never passed to the mobile devices, in order to prevent tokens from being replicated by third-parties.","Thus, as described herein, a technique of a communication device adapted for communications using Hypertext Transport Protocol (HTTP) involves setting, at the communication device, an HTTP cookie which includes a user identification of a user of the communication device and a message portion which is signed with a digital signature of the user. The communication device sends, to an application server site via the communication network, a request message which includes the HTTP cookie. If verification of the digital signature at the application server site is successful, the communication device will receive access to an application service of the application server site.","A corresponding technique of an application server site for permitting access to an application service for a communication device over a communication network with use of HTTP involves receiving, from the communication device over the communication network, a request message having an HTTP cookie which includes a user identification and a message portion which is signed with a digital signature. In response, the application server site performs validation of the HTTP cookie, which includes a verification step for verifying the digital signature in the HTTP cookie. If validation of the HTTP cookie is successful, the application server site grants the communication device access to the application service at the application server site via the communication network. Otherwise, if validation of the HTTP cookie is unsuccessful, the application server site denies the communication device access to the application service.","In one variation, the HTTP cookie is set with a group identification of a group with which the user is associated, and the message portion is signed with a digital signature of the group. The group may be a plurality of users associated with a service provider which provides the communication device with access to a communication service in the communication network. In this case, the HTTP cookie may be set with a token retrieved from the service provider, where the token includes the digital signature of the service provider.","The above-described embodiments of the present disclosure are intended to be examples only. For example, although it is described that verifications are performed with respect to specific users or groups, verifications may be performed with respect to the devices themselves (e.g. digital signatures associated with specific devices, servers, or other entities). Those of skill in the art may affect alterations, modifications and variations to the particular embodiments without departing from the scope of the application. The invention described herein in the recited claims intends to cover and embrace all suitable changes in technology."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Embodiments of present disclosure will now be described by way of example with reference to attached figures, wherein:",{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":["FIG. 3","FIGS. 1 and 2"]},{"@attributes":{"id":"p-0010","num":"0009"},"figref":["FIG. 4","FIGS. 1 and 2"]},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIGS. 6A","b":["6","7"]},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 8A"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 8B"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIGS. 9-13"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 14"}]},"DETDESC":[{},{}]}
