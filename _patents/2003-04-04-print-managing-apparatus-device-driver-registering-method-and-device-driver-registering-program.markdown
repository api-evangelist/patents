---
title: Print managing apparatus, device driver registering method, and device driver registering program
abstract: In a system in which a client, a plurality of output devices, and a server are connected via a network, it is an object to enable a device driver to be installed into the server by a remote operation of the client and eliminate troublesomeness upon setting of a construction of a port. A Web server has a port constructing unit and a driver installing unit which operate in response to a remote instruction from the client and its construction is realized by making those units operative under the local system authority.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07461375&OS=07461375&RS=07461375
owner: Canon Kabushiki Kaisha
number: 07461375
owner_city: Tokyo
owner_country: JP
publication_date: 20030404
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["1. Field of the Invention","The invention relates to a technique for installing a device driver of an output device into a server in a system including a client terminal, the server, and the output device connected to a network in response to an instruction from THE client terminal. More particularly, the invention relates to a print managing apparatus as a server for installing a device driver, a device driver registering method, and a device driver registering program.","2. Related Background Art","In recent years, there has existed a mechanism such that documents to be printed or outputted are managed in a server having a Web server function (hereinafter, referred to as a Web server), the Web server is accessed from a browser of a client connected to the Web server via a network, and a printing\/outputting instruction of the documents managed in the Web server is made by the client, thereby printing\/outputting the documents managed in the Web server. According to such a system, since the documents can be unitarily managed in the Web server, the management becomes easy, and since the documents are managed in the Web server and downloading of the documents by the client is not permitted, there is also an advantage in terms of security.","In recent years, since prices of printers and facsimile apparatuses, which are connected to the network for connecting the Web server and the clients have been lowered, a plurality of output devices (an electrophotographic printer, an ink jet printer, a facsimile apparatus, a digital hybrid apparatus, and the like) exist on the network. In this case, for example, in order to use the printer, it is necessary that a printer driver corresponding to the printer on the print destination side has been installed in a computer for forming print data. Generally, since the user of the client (owner of the client) can install the printer driver to be used, the printer driver which is necessary for the printer on the print destination side has properly been installed in each client.","However, in a remote print system such that the Web server manages the documents, the print instruction is made to the Web server by the client, and the forming process of print data based on the documents is executed on the Web server, printer devices which can be used for printing by the client who makes the print instruction are limited to the devices in which the printer driver has previously been installed in the Web server. Also in the case where the client requests the Web server to make remote facsimile transmission, it is necessary that a facsimile driver has been installed in the Web server. However, as mentioned above, many output devices exist on the network, so that, frequently, it is not the case that the device drivers corresponding to the output devices which the clients want to use have always been installed in the Web server for managing the documents.","To add the device, which can be used by such a system, therefore, the device driver (printer driver\/facsimile driver) corresponding to the device has to be installed in the Web server by the operation by an administrator. At the same time, a port corresponding to the device has to be formed and its communication protocol has to be set.","However, as network environments are enlarged, port management becomes complicated, because it is necessary to construct the port by the server operation and set a communication protocol as mentioned above in the conventional procedure, so that it is a large problem.","In consideration of the above circumstances, it is an object of the invention to provide a print managing apparatus, a device driver registering method, and a device driver registering program, in which a device driver can be easily installed in response to a remote instruction from a client without executing a complicated server operation.","According to the invention, there is provided a print managing apparatus connected to a client and an output device via a network, comprising: port constructing means for, when an installing instruction of a device driver is received from the client, constructing a port on the basis of an IP address of the output device included in the installing instruction; and driver installing means for, when the installing instruction of the device driver is received from the client, installing the corresponding device driver on the basis of device identification information included in the installing instruction, wherein the port constructing means and the driver installing means operate under local system authority.","A device driver registering method and a device driver registering program are a method and a program for realizing the above construction.","According to the invention, the user of a client terminal can easily install a device, which he wants to use into a server by a remote operation without executing a complicated operation. If the device is a printer, since the construction of a printer port, setting of a communication protocol, and the like are automatically executed on the server side, troublesomeness upon installing can be eliminated.","Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings, in which like reference characters designate the same or similar parts throughout the figures thereof.","Preferred embodiments of the invention will be described hereinbelow with reference to the drawings.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1"},"According to the remote print system, a client terminal  in which a browser has been installed, a printer B  and a printer C  as output devices, and a server in which a function of a Web server serving as a print managing apparatus of the invention has been installed (hereinafter, such a server is referred to as a Web server)  are connected to a network, and the printer B , the printer C , and the Web server  are connected by different subnets. A driver DB  is connected to the Web server . The driver DB  is a database in which a plurality of printer drivers for printers supported by the present system has been stored. Device drivers have been managed in correspondence to device identification (ID) information (device ID\/device name). The driver DB  can be stored in a memory in the Web server .","Although the embodiments of the invention will be described by using a printer, which is preferable as an output device, the invention is not limited to it. The \u201coutput device\u201d used here is a peripheral apparatus connected to the network and includes an apparatus which is directly or indirectly controlled by the device driver which is installed into a computer. For example, the output devices include an electrophotographic printer, an ink jet printer, a facsimile apparatus, a digital hybrid apparatus, a network scanner, a digital camera which can be connected to the network, and the like. That is, effects of the invention are obtained by other devices so long as they are directly or indirectly controlled by the device driver, which is installed into the computer. Naturally, those devices are incorporated as targets of the embodiments of the invention. However, the printer as a preferred example is used in the following description.","In this system, the Web server  can search the printers  and  in the designated network in response to the search instruction from the browser of the client . The user selects the printer to be used from the printers  and  found by the search. A print instruction of the documents stored in the Web server  is transmitted from the client  to the Web server . In the Web server , the print-instructed document is read out, print data is formed by using the printer driver, and the print data is transmitted to the printer on the output destination side, thereby executing printing by the printer.","First, in the client , when a search execute button of the browser is pressed as a search instruction from the browser, the client  issues a parameter of the search instruction to the Web server  by a POST command of an HTTP. The Web server that received the parameter broadcasts an SNMP to the subnet where its own Web server exists and searches the device connected to the same subnet as that of the Web server . Since a searching method of the device is a known technique, its specific explanation is omitted.",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2","b":"104"},"In the diagram, reference numeral  denotes a client instruction analyzing unit for discriminating the instruction from the client terminal . The client instruction analyzing unit  analyzes the instruction from the client  and discriminates whether it is the search instruction of the printers (output device) or the installing instruction of the printer driver (device driver). Reference numeral  denotes a printer searching unit for searching the printers  and  in the same subnet as that of the Web server  on the basis of the search instruction of the printers from the client terminal . When a reply is returned from the printer in the subnet and the printer is searched by the broadcast of the SNMP, the printer searching unit  notifies a client display data forming unit  of the information of the searched printer. Reference numeral  denotes the client display data forming unit for forming client display data by taking a form of structure display data with a tag (for example, HTML format) from the search result so that a printer list to be displayed onto the client terminal  side is displayed by the browser of the client . Reference numeral  denotes a port constructing unit for forming a port to install the printer driver. The port constructing unit  forms the port on the basis of an IP address of the printer (output device) on the output destination side in response to the installing instruction of the printer driver from the client . Reference numeral  denotes a driver installing unit for installing the driver of the printer. A driver installing process will be described in detail hereinlater. Reference numeral  denotes a printer construction information obtaining\/setting unit for obtaining information of functions provided for the printer.","The operation of the Web server  will now be described.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 3","b":"104"},"In step S, when the Web server  receives some instruction from the client terminal , the instruction is discriminated by the client instruction analyzing unit . If the instruction is the search instruction of the printers, the printer searching unit  executes the broadcast of the SNMP to the same subnet as that of the Web server , thereby starting the search of the printers  and .",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 4","b":["101","102","103","104","102","103","104"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 5","FIG. 3"],"b":["101","104","104","202","102","105","102","103","104"]},"To notify the client terminal  of those information after the search of the printers  and  as mentioned above, the Web server  forms a list of the data by the client display data forming unit  by taking the form of the structure display data with the tag (HTML). The Web server  transfers the client display data to the client terminal . The client display data forming unit  discriminates device names, product names, and IP addresses regarding the searched printers, a registration situation to the system, and support information, respectively, and forms client display data shown in . The client display data forming unit  accesses the driver DB  (also called a device driver database) in  and discriminates whether the printer driver corresponding to the device ID information (device ID) of each of the searched printers exists in the driver DB  or not. If it exists, it is regarded that the corresponding printer has been supported and \u201cNot Restricted\u201d and the support information are displayed as shown in . If it does not exist in the driver DB , it is regarded that the corresponding printer is not supported and \u201cRestricted\u201d and the support information are displayed. Since the printer driver corresponding to the supported printer exists in the driver DB , the printer driver can be installed into the Web server  by a remote instruction as will be explained hereinlater.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 6","b":["101","102","103","102","103","102","103"]},"The user selects the printer serving as a target to be supported by the Web system, that is, the printer in which the support information indicates \u201cNot Restricted\u201d from this list. The printer which is not the target to be supported, that is, the printer in which the support information indicates \u201cRestricted\u201d cannot be selected. If the printer driver corresponding to the selected printer has been installed in the Web server , by marking a \u201cSelect\u201d check box of a list item of the printer and pressing the \u201cNext\u201d button, the output destination is selected. If the printer driver corresponding to the selected printer is not installed in the Web server , that is, if the registration situation is \u201cUnregistered,\u201d in order to install the printer driver into the Web server , the \u201cSelect\u201d check box of the list item of the selected printer is marked and the \u201cNext\u201d button is pressed. In step S in , thus, the Web server  is notified of a printer registering instruction from the client , that is, an installing instruction of the printer driver (POST command of the HTTP including a device type, a device name (corresponding to the device ID), and an IP address). After the instruction is discriminated by the client instruction analyzing unit , the installation of the printer selected by the user into the Web server  is started.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 7","b":"104"},"Reference numeral  denotes an IIS (Internet Information Server) process. The IIS process is Internet server software developed by Microsoft Corporation in U.S.A. Functions of various servers such as Web server, FTP server, SMTP server, limited NNTP server, and the like are integrated in this Internet server software. Since the embodiment is described by using the Windows OS, the IIS process is used. However, if a platform is the UNIX system, a Web server process such as iPlanet, Apache, or the like is used. The invention is not particularly limited to the IIS process.","The IIS process can make an external program operative in an interlocking relational manner by using an ISAPI (Internet Server Application Programming Interface). The ISAPI is a program interface, which is opened to the external program for the purpose of extending the functions by Microsoft Internet Information Server (IIS) as a Web server. For example, in the case of executing a process according to an input from a WWW client, in a general WWW server, a method of activating the external program by using an interface called CGI (Common Gateway Interface) is used. According to this method, however, since the external program is executed as a process different from the WWW server, it is generally accompanied with a process forming process of a large load. Particularly, in the case where accesses from a plurality of clients are simultaneously executed, such a load is a large problem. On the other hand, in the IIS process, a program interface called ISAPI is prepared to thereby enable a program for realizing such an extending function of the Web server to be formed as a DLL (Dynamic Link Library) of Windows NT, thereby enabling it to be executed by the same context (process) as the IIS. By using the ISAPI, there are advantages such that the functions of the Web server can be finely controlled by using an API which is provided by the IIS and, at the same time, the load upon execution can be reduced. As an extending program using the ISAPI, there is an ordinary extending program (called ISAPI extension) of a type for executing some process in accordance with an input from the client.","Therefore, a new application server which is made operative in an interlocking relational manner by using the ISAPI can be formed by a printer vendor or the like. The new application server formed here is a remote printer process . The remote printer process  corresponds to an application server including the port constructing unit , driver installing unit , and printer construction information obtaining\/setting unit  in .","Upon registering instruction of the printer, the printer driver is installed by using the information of the device type, the IP address of the printer, and the device ID information (device ID\/device name) included in the POST command, which is the installing instruction of the printer driver notified from the client terminal  to the Web server .","First, in step S in , the remote printer process  called by the IIS process  as a Web server function (software) by using the ISAPI extension obtains the device driver corresponding to the device ID information (device ID) of a corresponding printer  from a driver group  stored in the driver DB .","Subsequently, the port constructing unit  of the remote printer process  registers the IP address to a TCP\/IP port, thereby forming a printer port and setting its communication protocol. On the basis of the device ID information (device ID\/device name) included in the installing instruction of the device driver, the driver installing unit  of the remote printer process  reads out the corresponding printer drivers from the driver group  in the driver DB , installs them via the OS in association with this port, and finally collects them as a printer object . In the remote print system according to the embodiment, those processing steps are executed by the resident remote printer process , and when the printer driver is installed, permission of the OS to install the printer driver is necessary.","That is, to install the printer driver, it is necessary that a process serving as a principal process has authority as an administrator. However, since the IIS process  as Web server software which receives the installing instruction from the client  by the remote operation operates by a Guess process, the permission of the OS is not obtained, so that the printer driver cannot installed into the Web server . Therefore, the IIS process  of the Web server calls the remote printer process  by using the ISAPI extension. The remote printer process  called by using the ISAPI extension can operate under local system authority under which an access to local resources is possible under authority of the administrator. Therefore, the remote printer process , which was called by the ISAPI extension and has the local system authority (administrator authority) receives a request for installation of the printer driver from the IIS process . The remote printer process  which received the request forms the printer port mentioned above and installs the printer driver via the OS.","After that, in step S in , to obtain the construction information of the device, the printer construction information obtaining\/setting unit  of the remote printer process  inquires of the printer  via the network what kind of function has been equipped for it. For example, if information showing that the printer  has a finisher and can use a function such as staple or punch hole, or the like can be obtained, the function which can be used in the device is recorded into the printer object  of the driver in which the installation has been completed. Since a protocol for inquiring of the printer is a known technique, its detailed explanation is omitted here.","Upon setting of a print style on the client terminal  side, the Web server  inquires of the printer object, so that the construction information of the device is obtained and used to display only the items which can be set by the printer device onto the client terminal . Thus, the user can make a print instruction according to the construction information of the device and print by the printer  just after the installation into the server as his desire.","According to the embodiment as mentioned above, the user can install the printer driver corresponding to the printer  by which he wants to print by the remote operation into the Web server . Moreover, since the construction of the printer port, setting of the communication protocol, and the like are automatically executed on the Web server  side, troublesomeness upon installing can be eliminated.","On the display screen of the client  shown in , \u201cRegistered\u201d showing that the registration situation has already been registered is displayed with respect to the target printer in which the printer driver has been installed.","In the Web server  of the invention, as shown in , a plurality of documents have been stored in a hard disk (HD)  (document storage). In the Web server , when an NIC  receives the print instruction from the client , a CPU  discriminates the printer on the output destination side included in the print instruction. Since the printer driver has already been installed in such a printer as mentioned above, the printer forms print data on the basis of the designated document by using the printer driver and outputs the formed print data to the port on the output destination side set in the printer driver. Thus, the print instruction can be made from the client  to the Web server  by the remote operation, the forming process of the print data is executed in the Web server, and the formed print data is transmitted to the designated printer and printed.","Although the case of using the browser as an application of the client terminal  has been presumed in the embodiment, an ordinary application can be used. In this case, a communication path between the client and the server can be assured by implementing a resident type program such as a service or the like into the server instead of the Web server. The installing process can be also requested to the remote printer process of the server from the implemented program by inter-process communication.","Each function constructing the remote print system and the printer registering method according to the embodiment can be realized by a method whereby a program stored in the RAM, ROM, or the like of the computer operates. Such a program and a computer-readable recording medium in which the program has been recorded are incorporated in the embodiment of the invention.","Specifically speaking, the program is recorded into the recording medium such as a CD-ROM or provided to the computer via various transmitting media. As a recording medium for recording the program, besides the CD-ROM, a flexible disk, a hard disk, a magnetic tape, a magnetooptic disk, a nonvolatile memory card, or the like can be used. As a transmitting medium of the program, it is possible to use a communication medium (a wire line such as an optical fiber or the like, a wireless line, or the like) in a computer network (a LAN, a WAM such as Internet or the like, a wireless communication network, or the like) system for propagating program information as a propagation wave and supplying it can be used.","Such a program is incorporated in the embodiment of the invention not only in the case where the computer executes the supplied program, so that the functions of the embodiments mentioned above are realized but also in the case where the functions of the embodiments mentioned above are realized by the program in cooperation with an OS (Operating System) which is operating in the computer, another application software, or the like, or in the case where all or a part of processes of the supplied program are executed by a function expanding board or a function expanding unit of the computer, so that the functions of the embodiments mentioned above are realized.","For example,  is a schematic diagram showing an internal construction of a general personal user terminal apparatus. In , reference numeral  denotes a computer (PC). The PC  has the CPU , executes device control software which has been stored in a ROM  or the HD  or is supplied from a flexible disk drive (FD) , and integratedly controls the devices connected to a system bus .","As many apparently widely different embodiments of the present invention can be made without departing from the spirit and scope thereof, it is to be understood that the invention is not limited to the specific embodiments thereof except as defined in the appended claims.","According to the embodiments, in the remote print system, since the Web server has the client instruction analyzing unit, printer searching unit, client display data forming unit, port constructing unit, driver installing unit, and further, printer construction information obtaining\/setting unit, the client can install the printer by which he wants to print by the remote operation into the server. Moreover, since the construction of the printer port, setting of the communication protocol, and the like are automatically executed on the server side, troublesomeness upon installing can be eliminated.","As described above, according to the invention, on the basis of the installing instruction of the device driver from the client which is connected via the network, the construction of the port and the installation of the device driver are executed by the processing unit having the local system authority, so that the printer driver can be easily installed into the print managing apparatus by the remote instruction from the client."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
