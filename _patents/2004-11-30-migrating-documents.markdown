---
title: Migrating documents
abstract: A source document set including one or more source documents to be migrated from a source application package to a destination application package can be analyzed for migration issues. The migration issues can be reported to a user and/or resolved prior to migration by software. Software can also be provided for the extraction of a source macro from a source document, parsing of the source macro, mapping of specific source APIs to destination APIs and the generation of destination macro code.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07730025&OS=07730025&RS=07730025
owner: Oracle America, Inc.
number: 07730025
owner_city: Santa Clara
owner_country: US
publication_date: 20041130
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF PARTICULAR EMBODIMENTS"],"p":["The present invention relates to document migration.","Some application packages support the importing, or migration of documents from other application packages. For example, the StarOffice\u2122 application package supports the importation of documents from various other application packages, including Microsoft\u00ae Office application packages from Microsoft Corporation.","In many instances, the importation or migration of the documents can be achieved without any issues. However, sometimes issues may be encountered. Such issues can be caused, for example, due to particular formatting, or the presence of embedded code, macros, etc. Where a single document is to be migrated, this can typically be addressed by appropriate measures before and\/or after the migration.","However, where a large number of documents are to be migrated, potential migration issues and the potential costs associated with such issues may not readily be apparent to the user. To investigate such matters manually would be very time consuming and it would not be possible from such a manual approach to obtain an accurate assessment of the number and extent of such potential migration issues, and also of the cost of addressing such issues.","Accordingly, the present invention seeks to facilitate migration by addressing such issues by assisting in the assessment and consequently the addressing of any such migration issues.","An embodiment of the invention can provide a computer-implemented method of analyzing a source document set to be migrated. The source document set can include one or more source documents of a source document type (e.g., Microsoft Word) associated with a source application package (e.g., Microsoft Office) to be migrated to a respective destination document of a corresponding destination document type associated with a destination application package (e.g., StarOffice). The computer-implemented method can include, for each source document, software opening the source document, analyzing the source document to identify migration issues associated with migration of the source document, closing the source document and generating a record of the result of the analysis.","A further embodiment can provide a method of migrating such documents. The computer-implemented method can include software running an analysis engine to analyze a source document set to be migrated for migration issues. The computer-implemented method can further include software flagging migration issues, performing document migration and generating a log of migrated documents.","The analysis engine can be operable to enable identification of the source document set to be migrated, to open the first source document, to analyze the first source document to identify migration issues associated with migration of the first source document, to close the first source document and to generate a record of the result of the analysis.","Where a specific migration issue has been identified in the source document, a preparation engine may be run to modify the source document so that it will migrate without issue. The preparation engine can take as its set of documents to be prepared, those which have been analyzed and shown to have preparable issues.","Another embodiment of the invention can provide a computer-implemented method of migrating a source document of a source document type associated with a source application package to a destination document of a destination document type associated with a destination application package. The source document can include a source macro in a source language. The computer-implemented method can include software extracting the source macro from the source document, parsing the source macro, mapping specific source application programming interfaces (APIs) to destination APIs and generating destination macro code.","Other embodiments of the invention can provide a computer system operable to implement the aforementioned methods. Further embodiments of the invention can also provide a computer program product for carrying out the aforementioned methods. A computer program product for implementing the invention can be in the form of a computer program on a carrier medium. The carrier medium could be a storage medium, such as a solid state, magnetic, optical, magneto-optical or other storage medium. The carrier medium could be a transmission medium such as broadcast, telephonic, computer network, wired, wireless, electrical, electromagnetic, optical or indeed any other transmission medium.","While the invention is susceptible to various modifications and alternative forms, specific embodiments are shown by way of example in the drawings and are herein described in detail. It should be understood, however, that drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed, but on the contrary, the invention is to cover all modifications, equivalents and alternatives falling within the spirit and scope of the present invention as defined by the appended claims. In this regard, combinations of features from the independent claims with features of dependent claims other than as presented by the dependencies of the claims, and also with features from the description, are envisaged.","The present invention relates to the migration of documents between formats for respective application packages. An example of the invention will be described hereinafter with reference to the migration of Microsoft Office documents as an example of source documents for a source application package, and to StarOffice documents as an example of destination documents for a destination application package. These examples of application packages are not to be taken as limiting, however, and it will be appreciated that the invention could be applied to the migration between respective documents of other application packages. One or more document types may be provided within an application package. For example, different document types for Microsoft Office documents include Word, Excel and Power Point documents.","An overview of a migration process for migrating documents between application packages is illustrated in .","At , a specified set of source documents can be analyzed to identify any potential migration issues prior to migration. An example implementation of this step will be described in more detail with reference to . This analysis can identify any documents having potential migration issues and the cost of rectifying those issues.","At , the source documents can be revised as appropriate using the results of the analysis to rectify migration issues identified at .","At , the source documents to be migrated can be confirmed. For example, it may be determined that not all of the source documents that were analyzed in step  are to be migrated.","At , a migration tool is initialized. In one example, the migration tool is initialized by a command line instruction. Alternatively, it can be initialized by means of a graphical user interface (GUI). The GUI could provide a real time representation of the collection of source documents to migrate, the collection of destination migrated documents, a log file of the migration and a progress window to indicate progress of migration.","At , the migration tool can be operable initially to migrate source document templates into destination document templates. A log recording the document template migration can be maintained. If the analysis performed at  above is arranged to note associations between templates and documents, then the template migration can be configured to occur automatically. Templates may contain macros that are used in user documents. Symbol tables can be built up for the template documents that contain macros and these can be stored for future reference when a source document is being migrated that contains a matching attached or global template. Attached template macros can be copied into migrated documents, whilst global template macros can be saved as external global macro libraries.","At , the migration tool can then be operable to migrate the source documents into destination documents. A log recording the document migration can be maintained.","At , the migration results can be verified using the migration log.","The source documents to be migrated can be scanned for viruses during this process, for example using an external virus scanner. Alternatively, or in addition, during the analysis at , potentially dangerous API calls, such as file manipulation or registry modification calls could be identified and marked.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 2","FIG. 1"],"b":["200","100"]},"The analysis engine  comprises an analysis controller  and a source driver document  for each source document type.","The analysis controller  is responsible for assembling the input parameters for analysis by guiding the user through a process of identifying the documents to be analyzed and a location at which the analysis results are to be stored. The analysis controller can also be configured to enable the user to specify one or more document types to be analyzed. For example, if the source documents are Microsoft Office documents, then the user can be given the option of analyzing one or more of Word documents, Excel documents and PowerPoint documents. After collection of the input parameters, these can be stored in an analysis file .","The analysis controller  can be implemented in the form of a wizard.  is a representation of three different shots of screens , ,  that can be presented to the user by the wizard to provide an introduction to the wizard (screen ), to enable the selection of the documents to be analyzed and the location at which the results are to be stored (screen ) and a summary of the documents selected (screen ).","The analysis controller  is operable to control the invocation of the analysis of the source documents to be analyzed. For each type of document that the user has selected, and for which documents are to be analyzed, the analysis controller  opens an appropriate source driver document and invokes a controlling module  in the source driver document concerned. The analysis of the documents of that type is then carried out by the appropriate source driver document . The source driver for a source document type can be made visible to a user during analysis of a source document of that document type. The analysis of the source documents is performed one by one, with each source document being opened, analyzed and then closed in turn before proceeding to the next source document.","Each source driver document  includes the top level controlling module  and one or more analyzer modules . The controlling module  controls the invocation of the respective analyzer modules . Each of the analyzer modules  is operable to perform an analysis of a source document to identify one or more potential migration issues associated with the migration of that source document. The controlling module  and the analyzer modules  can be written as respective macros in an appropriate source application macro language.","The controlling module  gets the input settings, determines the list of documents to be analyzed and then analyzes each source document in turn by calling the analyzer modules  and identifying one or more results files  into which the analysis results for the document are to be stored.","An analyzer module  opens the source document, determines the general document properties for that document and then analyzes it for all of potential analysis issues, by calling various analysis functions, which can be both application specific and common. The document information is stored in the results file(s) . All of the analysis functions store any analysis issues detected in the results file(s) . When the analysis for a document is completed the document is closed and the function returns to the controlling module .","After all of the documents have been analyzed the controlling module  can then cause the results collected in the results file  to be output in a spreadsheet, or as an XML file, for example.",{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 4","FIG. 2","FIG. 1"],"b":["200","100"]},"At , the analysis step  is started.","At , the analysis controller  (the analysis wizard) prompts the user to identify the documents to be analyzed and a location at which the analysis results are to be stored.","At , a first document is selected.","At , the document is opened.","At , the document is analyzed by the source application macros in the source driver document for the document type concerned.","At , the results are recorded. The results can be collated in, for example, a spreadsheet, or in an eXtended Markup Language (XML) document at the location identified by the user.","At , the document is closed.","At , if there is a next document to be analyzed, then control returns to step . Otherwise the completion of the analysis is reported at , and the user is able to review the analysis results.",{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 5","b":["252","254","256","252","254","256"]},"The overview spreadsheet shown at  in  gives an overview of all the documents analyzed, the modification dates, any possible macro migration issues, any possible document migration issues and their estimated cost to migrate them. Graphs and tables can be used to allow a user easily to understand the data produced. Document modification dates can give an indication of which documents really need to be migrated, and which documents can be archived. For example, documents that are identified as over 1 year old could be suitable for archiving","The macro migrations issues can identify which macros need to be migrated by helping to distinguish various types of macros from simple to more complex macros. The level of macro complexity is relevant to determining the cost of the macro migration. Unique macro modules can be identified, a hash of the macro module can be computed and a list of unique macro hash codes can be built up. In this way the number of unique macro modules to be migrated can be identified. In many cases, macros can be included in a template and if documents are created from the template, these macro modules will be duplicated. If a collection of such documents were analyzed, a very high macro count could be obtained if only occurrences of macro modules were counted, as opposed to unique macro modules across all the documents analyzed.","The document migration issues can identify documents with particular migration issues that may best not be migrated at a particular time, bearing in mind that import filters are always being improved. Although most documents can be migrated without issue or perhaps with a minor cosmetic issue, many minor issues are very simple for a user to fix manually, rather than having specifically to migrate the documents.","The migration costs can indicate cost in terms of time and\/or money needed to migrate documents with migration issues. For manual macro migration costs, costing can be based on a number of lines to be manually modified to make them suitable for migration. A significant proportion of macros with potential migration issues can be migrated automatically. The percentage conversion will typically increase with time as additional mappings are provided for mapping additional source language APIs to destination language APIs, etc.","The spreadsheet shown at  in  summarizing migration issues can give a detailed list of the issues of most concern during a migration. The issues can, for example, be sorted by application and then by issue category. For each issue, a detailed breakdown of its cost, an issue status, a detailed comment and any possible ways of working around the issue can be given. At the end of each application, the total cost for the issues identified in this application can be added together to give a total cost.","The spreadsheet shown at  in  giving details of the migration issues can give detailed guidance on the various issues so they can be addressed. This information can be given for each detected issue. Each issue can have specific information describing where the issue occurred and other attributes and notes relevant to understanding and resolving the issue. The issue can be sorted by using the filters that are in every column. This is helpful to search for certain issues. Columns can give advanced details of each issue. The exact location (document name and path, page number and line number, if applicable) can be stated, the issue category and type can be given and an advanced description of the issue details can be displayed.","In the following some examples of potential document issues are given.","Where blank lines are occur in the body of the document with a header style that is picked up in a table of contents (TOC), this might lead to incorrect numbering in the TOC. The analysis engine can be arranged to detect this and to list the lines in question. The user can then open the document and modify the style settings for these blank lines.","External references can lead to potential migration issues. The analysis engine can be arranged to identify the use of external references in macros to Windows API's and other Windows automation services.","It can happen that graphics and frames of a certain size in headers and footers can become misplaced or out of shape during migration if no action is taken. The analysis engine can enable such issues to be identified.","As an alternative to the detailed spreadsheets shown in , or in addition thereto, information can be displayed in a graphical form, for example using pie charts, as shown in .","Table 1 below represents an example workflow for the analysis process of , employing a Document Analysis Wizard (DAW) as an analysis controller . In this example, input parameters collected by the DAW are saved in a file called DAW install dir>\\resources\\<locale>\\analysis.ini. An analysis driver module called AnalyzeDirectory( ) forms a controlling module  of the source driver document . A MigrationAnalyzer module  called DoAnalyze( ) forms an analysis module in the source driver document . In this example, the results of the analysis are stored as an XML document.",{"@attributes":{"id":"p-0073","num":"0072"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"294pt","align":"left"}},"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Start of Table 1"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DAW is launched"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Input Parameters for Analysis - user follows steps in wizard to specify document"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"input directory, type of documents to process, results directory and name of"]},{"entry":[{},"results file."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Run Analysis - user clicks on Run."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"The input parameters are saved to an analysis.ini file in <DAW install"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"dir>\\resources\\<locale>\\analysis.ini"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"For each type of document which the user has selected and for which"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"documents need to be analyzed the DAW opens the appropriate driver"]},{"entry":[{},"document and invokes the AnalysisDriver module AnalyzeDirectory( ) sub."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"AnalyzeDirectory( )"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This sub gets the input settings, determines the list of documents to be"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"analyzed and then analyzes each in turn by calling the MigrationAnalyzer"]},{"entry":[{},"module DoAnalyze( ) function, passing in a DocumentAnalysis object in"]},{"entry":[{},"which to store the analysis results for the document. The results for all the"]},{"entry":[{},"documents are stored in the AnalyzedDocs collection."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DoAnalyze( )"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This function opens the document, determines its general document"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"properties and then analyzes it for all of the Analysis issues, by calling"]},{"entry":[{},"the various Analysis functions both application specific and common."]},{"entry":[{},"It stores the document information in the DocumentAnalysis object"]},{"entry":[{},"passed into it by the AnalyzeDirectory( ) sub. All of the analysis"]},{"entry":[{},"functions store all of the analysis issues detected in an IssuesInfo object"]},{"entry":[{},"and add it to the DocumentAnalysis objects Issues collection."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"When the analysis for a document is completed the document is closed"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"and the function returns."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"After all of the documents have been analyzed the AnalyzeDirectory( ) then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"calls WriteXMLOutput( ) sub, passing in the AnalyzedDocs results"]},{"entry":[{},"collection, to write out the results as XML output."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"XML is output only if the outputtype=both or outputtype=xml property"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"is set in the analysis.ini file. The DAW does not expose this setting in"]},{"entry":[{},"the UI. The xml file generated is placed at: <results location>\\<results"]},{"entry":[{},"spreadsheet name>_<application>.xml. A separate XML file is"]},{"entry":[{},"generated for each document type, unlike the results spreadsheet which"]},{"entry":[{},"amalgamates all of the document type results into one results"]},{"entry":[{},"spreadsheet."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Once this returns AnalyzeDirectory( ) calls WriteXSLOutput( ) sub to"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"write out the results to the results spreadsheet."]},{"entry":[{},"WriteXSLOutput( )"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Opens the results spreadsheet or creates a new one, then writes out"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"the results to the various sheets of the spreadsheet."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"After all of the documents have been analyzed for this document type and the"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"results written out the AnalyzeDirectory( ) sub returns."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Next document type driver document is opened and its AnalyzeDirectory( ) sub"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"invoked."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"All document types have been analyzed and their results output to the results"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"spreadsheet and\/or xml output files."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"View Results - user clicks on View."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"The results spreadsheet is opened for the user to review."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"User can close the results spreadsheet, navigate back in the DAW to change some"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"settings and rerun the DAW analysis if they wish."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DAW is closed."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"294pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"End of Table 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"Returning to , following the analysis of the source documents in step , the option can be given to the user to revise the source documents as appropriate. This can be done manually by the user, or it can be done, in so far as this is possible, automatically by a preparation engine, which can, for example, form part of or include the analysis engine.",{"@attributes":{"id":"p-0075","num":"0074"},"figref":["FIG. 7","FIG. 3","FIG. 7"],"b":"226"},"Where a specific migration issue has been identified in the source document, an analysis engine that additionally provides for the preparation of documents to mitigate migration issues. An example of such an analysis and preparation engine may be run to modify the source document, or a copy thereof so that it will migrate without issue.","An example of such an analysis and preparation engine can takes as its set of documents to be prepared, those which have been analyzed and shown to have preparable issues. In other words, an analysis can be carried out on a document set before any of the documents are prepared.","Once a preparation set has been identified, the preparation portion of the engine can be run. In one example, the preparation engine copies each of the source documents to be prepared and then runs a set of preparation macros against the document to be prepared using a source driver document, for each preparable issue identified by the analysis. These preparation macros make use of the source document's native API to modify it in such a way that the identified migration issue is removed, without noticeably altering the visible format, layout or content of the document.","For instance, if there is a graphic in a header of the source that is larger than the Header available in the destination document, it might be squashed on migration into the destination document as illustrated, for example in . This issue can be flagged during analysis and can be prepared (that is it can be modified in the source document, or in a copy thereof, in such a way that it can be migrated without an issue into the destination document. The preparation macro will add in additional line returns to the header so the header size matches the size of the graphic. There would be no visible change to the document, but on migration the graphic will appear normally in the header and will not be squashed, as represented, for example, in .","Activation of the prepare button can allow a user optionally to prepare copies of the source documents that have been marked as having preparable issues in the results spreadsheet. In this example, the prepare button is only enabled when there is a results spreadsheet and the view button is enabled.","As described above, an analysis is conducted in respect of a set of documents and then those documents with preparable migration issues can be subjected to preparation (i.e. they can be copied and modified) to rectify the migration issues. However, in another example, each document that is found to have preparable issues could then be subjected to preparation (i.e. it can be copied and modified) to rectify the migration issues before a next document is analyzed.",{"@attributes":{"id":"p-0082","num":"0081"},"figref":["FIG. 10","FIG. 1"],"b":["450","102"]},"The preparation engine  comprises a preparation controller  and a source driver document  for each source document type. In , only one source driver document is shown.","The preparation controller  is responsible for assembling the input parameters for preparation by guiding the user through a process of identifying the documents to be analyzed for preparation and a location at which the analysis results are to be stored. The analysis controller can also be configured to enable the user to specify one or more document types to be analyzed. For example, if the source documents are Microsoft Office documents, then the user can be given the option of analyzing one or more of Word documents, Excel documents and PowerPoint documents. After collection of the input parameters, these can be stored in a preparation file .","The preparation controller  can be implemented in the form of a wizard, of which  represents one of the screens that can be presented to the user by the wizard.","The preparation controller  is operable to control the invocation of the analysis of the source documents to be analyzed for preparation. For each type of document that the user has selected, and for which documents are to be analyzed, the preparation controller  opens an appropriate source driver document and invokes a controlling module  in the source driver document concerned. The analysis of the documents of that type, and also the preparation of those documents that are identified as being preparable to avoid migration issues, is then carried out by the appropriate source driver document .","Each source driver document  includes the top level controlling module , one or more analyzer modules  and one or more preparation modules. The controlling module  can be operable to control the invocation of the analyzer and\/or preparation modules .","The controlling module  gets the input settings, determines the list of documents to be analyzed and then analyzes each source document in turn by calling the analyzer modules and identifying one or more results files  into which the analysis results for the document are to be stored.","Each of the analyzer modules  is operable to perform an analysis of a source document to identify one or more potential migration issues associated with the migration of that source document.","After a document has been analyzed, if it contains any migration issues that are deemed to be preparable (i.e. rectifiable so that on migration the issue is no longer present) the appropriate preparation module  can be operable to prepare the document to rectify the migration issue. The preparation modules  could be invoked by the controlling module  and\/or by one of the analyzer modules . When preparing a document, a copy  of the source document  can be prepared, and then the preparation can be performed on the copy  of the source document.","The controlling module , the analyzer modules  and the preparation modules  can be written as respective macros in an appropriate source application macro language.","The analysis and\/or preparation of the source documents can be performed one by one, with each source document being opened, analyzed and then closed in turn before proceeding to the next source document.","It will be appreciated that the analysis engine  of  and the preparation engine  of  have a lot in common. Indeed, where the present invention is implemented in software, the preparation controller and the analysis controller could be integrated into engine that performs both functions with modules being shared, where appropriate, between functions. Moreover, the term analysis engine could be applied equally to the preparation engine  of . Similarly, the term analysis controller could be applied to the preparation controller  of .",{"@attributes":{"id":"p-0094","num":"0093"},"figref":["FIG. 12","FIG. 1"],"b":"102"},"At , the analysis step  is started.","At , the preparation controller  (the preparation wizard) prompts the user to identify the documents to be analyzed and a location at which the analysis results are to be stored.","At , a first source document is selected.","At , the source document is copied to form a copy document.","At , the copy document is opened.","At , the copy document is analyzed by the source application macros in the source driver document for the document type concerned.","At , the results are recorded.","At , if the copy document is identified as having preparable (i.e. rectifiable migration issues) then the copy document is prepared to rectify the migration issues.","At , the copy document is closed.","At , if there is a next document to be analyzed and possibly prepared, then control returns to step . Otherwise the completion of the preparation is reported at .","In the examples of , therefore, each document that is found to have preparable issues can be subjected to preparation (i.e. it can be copied and modified) to rectify the migration issues before a next document is analyzed.","Table 2 below represents an example workflow for the analysis and preparation of source documents to mitigate migration issues. In this a Preparation and Analysis Wizard (PAW) forms an analysis\/preparation controller . In this example, input parameters collected by the PAW are saved in a file called PAW install dir>\\resources\\<locale>\\analysis.ini. An analysis\/preparation driver module called AnalyzeDirectory( ) forms a controlling module  of the source driver document . A MigrationAnalyzer module  called DoAnalyze( ) forms an analysis module in the source driver document . A MigrationPreparation module called DoPreparation( ) forms a preparation module  in the source driver document .",{"@attributes":{"id":"p-0107","num":"0106"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Start of Table 2"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"PAW is launched"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Input Parameters for Analysis - user follows steps in wizard to specify document"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"input directory, type of documents to process, results directory and name of"]},{"entry":[{},"results file."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Run Analysis - refer to Analysis Workflow"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"If any documents have migration issues detected during the analysis the"]},{"entry":[{},"prepare button is now enabled."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Prepare"]},{"entry":[{},"User clicks on the prepare button"]},{"entry":[{},"A dialog is popped up informing the user that a preparation is going to be run"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"on the analyzed documents which have preparation issues and the resultant"]},{"entry":[{},"prepared documents saved without altering the original source documents in"]},{"entry":[{},"any way."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"The input parameters for the preparation run are saved to an analysis.ini file in"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<PAW install dir>\\resources\\<locale>\\analysis.ini, including a Prepare=True"]},{"entry":[{},"flag."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"For each document type which has preparable issues [determined by querying"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"the results generated by the analysis] the PAW opens the appropriate driver"]},{"entry":[{},"document and invokes the AnalysisDriver module AnalyzeDirectory( ) sub."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"AnalyzeDirectory( )"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"A parameter has been set by clicking on the Wizard Prepare button to"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"indicate that the analysis driver is now running in Preparation mode as"]},{"entry":[{},"opposed to Analysis."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This sub gets the input settings, determines the list of preparable documents"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"to be analyzed and then analyzes and prepares each in turn by calling the"]},{"entry":[{},"MigrationAnalyzer module DoAnalyze( ) function, passing in a"]},{"entry":[{},"DocumentAnalysis object in which to store the analysis and preparation"]},{"entry":[{},"results for the document. The results for all the documents are stored in"]},{"entry":[{},"the AnalyzedDocs collection. The results are only used to determine the"]},{"entry":[{},"success of the preparation; they are not used to generate any output results"]},{"entry":[{},"as they are in analysis."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DoAnalyze( )"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"This function opens the document, determines its general document"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"properties and then analyzes it for all of the Analysis issues, by calling"]},{"entry":[{},"the various Analysis functions both application specific and common."]},{"entry":[{},"It stores the document information in the DocumentAnalysis object"]},{"entry":[{},"passed into it by the AnalyzeDirectory( ) sub. All of the analysis"]},{"entry":[{},"functions store all of the analysis issues detected in an IssuesInfo object"]},{"entry":[{},"and add it to the DocumentAnalysis objects Issues collection."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"An Analysis function, which detects an issue that can be prepared, has"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"code added to the end of it that will call a DoPreparation( ) function"]},{"entry":[{},"when being run in Preparation mode [determined by calling"]},{"entry":[{},"InPreparation( ), which will return true in Preparation mode]. It will"]},{"entry":[{},"pass in the IssuesInfo object to the DoPreparation( ) function along with"]},{"entry":[{},"other data relevant to preparing the issue."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DoPreparation( ) will invoke the specific Preparation( ) function for this"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"issue. It will modify the in memory copy of the document in order to"]},{"entry":[{},"work around the analysis issue detected, always ensuring that the"]},{"entry":[{},"overall appearance of the document remains unaltered. If preparation"]},{"entry":[{},"succeeds a success code is returned, otherwise an appropriate error log"]},{"entry":[{},"entry is written out and a corresponding error code returned."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"When the analysis and preparation for a document is completed the"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"document is saved out to a Prepare sub folder under the results"]},{"entry":[{},"directory location. The source document is then closed without saving"]},{"entry":[{},"any preparation changes. The source document is not altered in any"]},{"entry":[{},"way. At this point the function returns."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"As this is Preparation mode, after all of the documents have been analyzed"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"and prepared the AnalyzeDirectory( ) does not need to write out any"]},{"entry":[{},"analysis results, it simply sets the appropriate return code and returns."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Next preparable document type driver document is opened and its"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"AnalyzeDirectory( ) sub invoked."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"All preparable document types have been analyzed and prepared."]},{"entry":[{},"The user is informed by a popup dialog of the completion of the Preparation and"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"the location of the prepared document copies."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"DAW is closed."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"End of Table 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"Accordingly, by selecting the prepare button, an automatic preparation activity can be started for documents listed in the analysis results spreadsheet that have repairable issues. A query dialog can be presented to the user, telling the user what is about to happen and giving the user the option to click OK to proceed or Cancel to cancel the preparation. Once the preparation of the documents for migration has been completed, an information dialog can be displayed informing the user and telling the user where the prepared copies have been saved.","The prepare function can be operable, for example, to modify the headers in the case of a TOC header style with blank lines to achieve the correct formatting after migration. Similarly, action can be taken to modify headers and footers so that they do not become misplaced or out of shape during migration. The use of the prepare function can thereby automatically reduce the migration issues that might be encountered in a cost-effective manner.","An embodiment of the invention can provide a computer-implemented process for migrating a source document that includes source macros in a source language.  is a flow diagram giving an overview of such a process . Software can be provided for carrying out this process.","At  the source macro can be extracted from the source document using the destination application package (e.g., a VisualBasic macro could be extracted using StarOffice).","At , the source macro can be parsed. The software can be arranged, when parsing the source macro in step , to tokenize the source macro, to convert it to a syntax tree and then to an annotated semantic tree.","At , specific source APIs can be mapped to destination APIs. The software can be arranged, when mapping specific source APIs to destination APIs, to take the annotated semantic tree and generated symbol tables and to map specific source APIs to destination API calls or higher level destination APIs using a source to destination API mapping table. The mapping table can be arranged to map a subset of the source APIs to destination API calls or higher level destination APIs.","At , the destination macro code can be generated. The software can be operable to generate the destination macro code using the annotated semantic tree and the generated, or resolved, symbol table.","The software can further be operable to create an analysis of all API's used in the source macro, which could and could not be mapped and any errors that occurred in processing.",{"@attributes":{"id":"p-0116","num":"0115"},"figref":["FIG. 13","FIG. 13","FIG. 12"],"b":["482","484","486"]},{"@attributes":{"id":"p-0117","num":"0116"},"figref":["FIG. 14","FIG. 14","FIG. 12"],"b":["486","488","490"]},{"@attributes":{"id":"p-0118","num":"0117"},"figref":["FIG. 15","FIG. 15","FIG. 13","FIG. 13"],"b":["482","492","484","494"]},{"@attributes":{"id":"p-0119","num":"0118"},"figref":["FIG. 16","FIG. 12"],"b":"400"},"The transformer  includes a number of functional components, or modules that will be described in the following.","A source extractor  forms a supplier of source code and pre-symbol-information. A migration context  includes an global symbol table  containing symbols for forms and other dependencies and can also include other modules , semantic trees , statistics files  and log files . The symbol table  can contain, after the migration, all declared and unresolved symbols. The semantic trees  are provided for solving types of expressions, collecting symbols and marking all unknown or unresolvable symbols. The modules  can include, for example, various back end modules . The transformer works with a so-called transformer context in which meta information is collected in the statistics file  during a transformation process. This information may be used to present statistics to a user after transformation. The logging file  can contain a log of the migration process.","In operation, the source extractor  supplies an array of instances of java.io.Reader for every module, and classmodule.","A parser  can operate on each macro given by the source extractor  to create an abstract syntax tree (AST) . This AST  is specific to the source macro language and\/or the parser . The AST  contains syntactic information including formatting and remarks. The grammar for the parser  can be mapped as a cheated LL() grammar using Javacc. Javacc comes with a tool named jjtree which is able to create a parser tree . The parser tree  maps the original source into the AST . The parser can be operable to tokenize the source macro.","An AST transformer  uses the AST  generated by the parser  as an input to create a semantic tree , which can be held in the migration context at . The AST transformer  uses and updates the symbol table  contained in the migration context . The AST transformer  performs semantic analysis to enable type detection and to resolve invocation\/field\/array ambiguities and to build the semantic tree .","As represented in , different source languages can be accommodated by providing appropriate parsers \u2032, \u2033 and AST transformers \u2032, \u2033.","In the present example, the semantic tree  provides a substantially source language independent semantic representation. It is substantially source language independent as it covers the language capabilities of source language in a language independent way. The semantic tree could be updated as appropriate for other examples to accommodate other source languages.","In contrast to an abstract syntax tree (AST), the semantic tree  does not represent the syntactic information but rather represents a structure which is adapted to hold type information, references to the symbol table and a generalized view to the original program (respectively module, class, etc.). For example whereas a syntax tree holds a string for a date literal format, the semantic tree holds its actual value as a date object and its type. As a result, the back end processes do not need to know about the format source literals.","In order to preserve the original source formatting and comments, syntactic hints can be added to the semantic tree , such as the indentation of a statement, empty lines and comments. Other formatting aspects (e.g., a space between operators, parenthesis, commas, etc.) would be lost. The back end modules  are operable, however, to insert appropriate formatting in the destination code.","Back end mappers  (\u2032, \u2033) can be provided, if required, to address situations where the back end modules  are unable to map parts of the semantic tree to corresponding destination code. In this case, the back end mappers  can be used to generate a modified semantic tree . This is a rare situation that might occur, for example, where the semantic tree is modified before the API mapper  applies any mappings.","If the semantic tree  supports features that are not supported in the destination language, such mappings can be performed in the back end mappers .","An example of a situation where a back end mapper  (\u2032, \u2033) might be employed is illustrated below for a conversion from VisualBasic as the source language to StarBasic as the destination language.","In this example, it is noted that VisualBasic supports the use of a for-each loop such as:","Dim c as Collection","Set c=new Collection","Dim elem",". . .","For Each elem In c\n\n","Next","However, StarBasic does not support for-each loops, so that a conversion of the loop to a support form can be effected, for example to:","Dim i as Integer","For i=1 To c.Count\n\n","Next i","A StarBasic back end mapper  can be operable to convert the for-each loop in the semantic tree as illustrated and to replace the appropriate node.","The API mapper  is operable to map source language (e.g., Microsoft Office) API calls to destination language (here StarOffice) API calls. Where StarOffice is the destination language, this is a destination code independent action because the StarOffice API is the same for all supported source languages.","The API mapper  accesses multiple mapping tables  and changes the original semantic tree (or the modified semantic tree ) so that a back end process can receive a semantic tree  which is converted to a StarOffice API compliant form. The mapping API tables  provide for direct code replacement of original API calls to wrapper code and provide independence of the destination language by providing for code replacement and complex code definition. Of course it is possible that no mapping was found for a certain API call. In that case one possible action is that the corresponding node in the semantic tree is marked. Another possible action is that a user interface is opened giving the possibility to enter an appropriate mapping for the found case, in which case the user's input can be stored in a separate mapping table.","As the mapping table contains Basic code in the destination mapping, and the API mapper  only receives semantic nodes to map, the API mapper  is provided with access to the parser , the AST transformer  and the StarBasic back end module .","Each back end module  receives as input a source language API-less semantic tree and creates appropriate destination code for a given kind of semantic tree. In the present example the destination code is output to a java.io.Reader. The back end module  can access the abstract syntax tree  to append comments before each original statement where destination code could not be created, for example because the destination language does not support certain features of the semantic tree (e.g. Classes). Back end module specific mapping tables  can be provided to define how the back end modules  are to convert parameters to create compliant destination code (e.g., StarBasic code) and how to convert file IO statements.","Error recovery can be provided for the components of the transformer in the event of errors. Typically, where errors are encountered, these will be reflected in appropriate log entries.",{"@attributes":{"id":"p-0149","num":"0151"},"figref":"FIG. 17","b":["20","22","24","26","28","26","32","34","28","30","38","28","36","40","42"]},"Accordingly, there has been described a method, apparatus and computer program product for analyzing for migration issues, and a source document set including one or more source documents to be migrated from a source application package to a destination application package. The migration issues can be reported to a user and\/or resolved prior to migration by software. Software can also be provided for the extraction of a source macro from a source document, parsing of the source macro, mapping of specific source APIs to destination APIs and the generation of destination macro code.","Although particular embodiments of the invention have been described, it should be understood, that these are not intended to limit the invention to the particular form disclosed, but on the contrary, the invention is to cover all modifications, equivalents and alternatives falling within the spirit and scope of the present invention as defined by the appended claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Embodiments of the present invention will be described hereinafter, by way of example only, with reference to the accompanying drawings in which like reference signs relate to like elements and in which:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 9","FIG. 8"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 17"}]},"DETDESC":[{},{}]}
