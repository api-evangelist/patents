---
title: Systems and methods for authenticating an electronic message
abstract: Systems and methods are disclosed for authenticating electronic messages. A data structure is generated by a computer server which allows for the authentication of the contents and computer server identity of a received electronic message and provides a trusted stamp to authenticate when the message was sent. Data which can authenticate the message, the computer server identity, and the time the message was sent is included into a data structure which is called an Electronic PostMark (EPM).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08095797&OS=08095797&RS=08095797
owner: United States Postal Service
number: 08095797
owner_city: Washington
owner_country: US
publication_date: 20090618
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["This is a division of application Ser. No. 09\/675,677, filed Sep. 29, 2000 now U.S. Pat. No. 7,797,543, which claims priority under 35 U.S.C. \u00a7119 of U.S. Provisional Application No. 60\/157,168, filed on Sep. 30, 1999, and U.S. Provisional Application No. 60\/189,983, filed on Mar. 17, 2000, all of which are expressly incorporated herein by reference.","1. Field of the Invention","The present invention relates to systems and methods for providing electronic communication services to customers. More particularly, the invention relates to systems and methods for providing content and temporal integrity and identification verification to electronic messages shared by users over a network.","2. Description of the Related Art","The use of electronic networks to convey information among networked users has undergone an enormous amount of growth in recent years. The ability to transfer data using computer applications, such as, for example, e-mail and file transfer protocol programs, has become increasingly important in personal, and especially, business communications.","Using computer networks for business communications, including buying and selling goods online, electronic funds transfer, online advertising, and accessing business information resources is known as electronic commerce (E-commerce). E-commerce can improve the efficiencies of current business processes and provide opportunities to widen existing customer bases. Over the next few years, as the number of Internet users continues to expand, E-commerce has the potential to be the source of an extraordinary amount of revenue growth.","In order to realize this potential, a variety of communication services and features will be required for E-commerce which traditionally have been available in physical communication channels. The United States Postal Service (USPS), an independent establishment of the executive branch of the U.S. government, provides such features through a variety of document and package delivery services. The USPS is widely recognized as a secure and reliable means for sending and receiving packages and mail used for both personal and business transactions. Packages and mail sent via the USPS are time-stamped with an official postmark which provides the recipient proof of the time the item was sent. Additionally, once material is placed with the USPS, the document is no longer in the sender's control, and thus cannot be recalled. Furthermore, packages and mail sent through the USPS are protected from third-party tampering by Federal laws. Electronic communication services currently do not provide these features. Additional security enhancements, such as authenticating the identities of the parties involved in a transaction and\/or providing assurance to the recipient that a received message has not been altered may also be required for E-commerce to reach its full potential.","To ensure the vitality and growth of electronic communication and commerce, consumers and businesses need a secure way to communicate and conduct business electronically. Without trustworthy channels of communication, many potential participants in electronic commerce may be unwilling to send sensitive information electronically. In light of the foregoing, it is desirable to provide a system for electronic communication that provides a level of security which meets or exceeds the current level offered by the existing physical mail and package delivery services.","In accordance with the purpose of the present invention, as embodied and broadly described herein, the invention provides methods and apparatuses for authenticating an electronic message. The electronic message containing data and an electronic address is received from a sender. A digest is then created based on the message data and a temporal stamp is appended to this digest. The digest and temporal stamp are signed using a digital signature. The digest, the temporal stamp, and the digital signature are then sent to an electronic address and thereafter authenticated.","Exemplary systems and methods consistent with the present invention are recited in the attached claims. It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory only and are not restrictive of the invention, as claimed.","Reference will now be made in detail to the present preferred embodiments of the invention, examples of which are illustrated in the accompanying drawings. Whenever possible, the same reference numbers will be used throughout the drawings to refer to the same or like parts.",{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 1","b":["50","52","54","56","58","60"]},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 1A","b":["110","115","120","120","120"]},"For this invention, the digital signature ensures the authenticity of the EPM data structure and the identity of the EPM system . Any unauthorized modifications to the temporal-stamp or the digest can be detected through examining the digital signature. Furthermore, any alterations in the electronic message itself may be detected though examining the digest. Therefore, the EPM data structure can afford at least three assurances for an electronic transaction. The first is the electronic message existed at a known point in time. The second assurance is the identification of EPM system  is known to a recipient  of the electronic message. The third assurance is alteration of the contents of the electronic message as received by recipient  is detectable after the generation of the EPM data structure.","Further referring to , the recipient  typically receives the EPM data structure and the electronic message over network  from EPM server . Recipient  may then verify the identity of the signer of the EPM data structure and the integrity of the electronic message using the EPM data structure and verification application. The verification application is discussed in more detail below.","Sender  may elect to have EPM system  forward only the EPM data structure to recipient  and may then send the electronic message itself to recipient  directly over the network. This procedure provides sender  with more control in how the electronic message is routed through EPM system , as will be described below.","Each time an EPM data structure is generated, it is stored in a log located within EPM system . This log provides an actual record which can be used to prove that an EPM data structure was generated for a given message. One advantage of the invention is that electronic messages which have been postmarked by EPM system  may be afforded legal protections under laws which protect official entities, such as the USPS. Therefore, EPM data structures stored in the log file can serve as legal proof of the existence and digest of an electronic message. An EPM data structure of the log file itself may be generated to insure the integrity of the log file.",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 1B","b":["110","130","110","115","120","110","120","110","110","120","110","110","120"]},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 2A","b":["110","215","220","210","205","210","210","205"]},"EPM server  generates an EPM data structure  that includes a digest, a temporal-stamp, and a digital signature as described above. After EPM data structure  has been generated, EPM server  will typically forward the EPM data structure with the electronic message to recipient  over network . Alternatively, sender  may choose to only have EPM data structure  forward by EPM server  to recipient .",{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 2B","FIG. 2"],"b":["110","110","215","205","210","225","220","215","210","110","110","215","240"]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 3A","FIG. 3A","FIG. 2A"],"b":["110","310","320","110","210","210","130","310","320","210","210"]},"Referring again to , sender  submits a request in the form of an electronic message to a sender client  to obtain an EPM. Sender client  may be a separate data processing machine, such as, for example, a personal computer or an Intel-based workstation using Windows NT\u00ae 4.0 as an operating system. Alternatively, sender client  may be a collection of software modules residing in the networked device of sender . In the event sender client  is a separate machine, it will receive the request for an EPM over network . After sender client  accepts the request from sender , it processes the request (in a manner described below in greater detail) and transfers the results to EPM server  over a secure network . If sender client  is in close proximity to EPM server , secure network , could a Local Area Network (LAN) which uses TCP\/IP, or another network protocol known to those skilled in the art. If sender client  is not in close proximity to EPM server , secure network  may be Virtual Private Network (VPN) communicating in a secure manner over the Internet. While only one EPM server  is shown in , multiple servers could be used to provide additional reliability. In this embodiment, EPM server operates in a secure environment whereby it has no insecure connection to an external network such as the Internet.","Further referring to , once EPM server  receives the processed request from sender client , it generates an EPM data structure and forwards the EPM data structure and recipient electronic address data to a recipient client  over secure network . Recipient client  may be a separate data processing machine located practically at any distance from EPM server . Like sender client , it may be, for example, a personal computer or Intel-based workstation using Windows NT\u00ae 4.0 as an operating system. Alternatively, recipient client may be a collection of software modules residing at recipient . If recipient client  is a separate data processing machine, it forwards the EPM data structure to recipient  over network . Recipient  may comprise a user and data processing machine, as described for sender  above, or may be a computer, only, automatically processing the received EPMs. Once the EPM data structure is received, recipient  may authenticate the EPM data structure and the identity of the signer (the EPM server ) and, if the corresponding electronic message is available, the electronic message itself. This authentication process may occur at the data processing machine of recipient , or it may be performed by a separate data processing machine.","In order to properly authenticate the received EPM data structure, a data processing machine typically requires four elements: a verifier application, the EPM data structure, the electronic message, and an authorized public digital key. EPM server  uses a digital signature algorithm to digitally sign EPM data structures. The digital signature is based on public and private digital key pairs. Digital certificates authorize the use of these key pairs used to generate and verify the digital signature. The key authorization process is performed by a Key Signing Authority (KSA) or a Certificate Authority (CA) which issues the digital certificates. These are trusted, separate third party systems which are not directly coupled to EPM server . The KSA is discussed in U.S. Ser. application No. 60\/157,168, filed Sep. 30, 1999, and the CA is discussed in U.S. Ser. application No. 60\/189,983, filed Mar. 17, 2000, the entire disclosures of which are incorporated by reference. The authorized public digital key may exist on a physical media in the personal possession of the recipient user , or it may be embedded in the verifier software or the EPM data structure itself.","The verifier application performs three verification steps. The first step verifies that the EPM data structure is \u201cofficial;\u201d that is, it was generated by an authorized entity such as the USPS. It does this by checking the digital certificate associated with the public digital key used to generate the digital signature. When this verification is complete, recipient  has proof that the EPM data structure was issued by an official EPM entity.","The second verification step is to verify the identification of the EPM server . The digital signature that was used to sign the EPM data structure is verified using the authorized public digital key. When this verification is successful, recipient  has proof that the EPM data structure was generated by a particular authorized server (i.e., the identification of EPM server  is known) and that alterations to the contents of the EPM data structure, from the time it was generated until the time it reached recipient , are detectable. This effectively authenticates the digest and temporal stamp within the EPM data structure.","The third verification step is to authenticate the contents of the electronic message. The verifier application does this by comparing the digest of the message contained in the EPM data structure with a digest generated by the verifier application using the electronic message itself. If the two digests are identical, recipient  has proof the contents of the electronic message were unaltered from the time the EPM data structure was generated until the time the EPM data structure and electronic message were received by recipient .","Digital signature and electronic message verification functionality can be integrated into platform-independent verifier software which may be downloaded from the Internet. For example, such software may be developed into a Java applet for use in a web browser such as Netscape\u00ae, or it could be integrated into an e-mail software application such as Outlook\u00ae Express. Alternatively, the verifier application could take the form of an independent software application, such as, for example, a stand alone Windows-based verification utility. The verifier application can make use of standard Application Programming Interfaces (APIs) to provided authentication functionality to software developers in a convenient manner.",{"@attributes":{"id":"p-0049","num":"0048"},"figref":["FIG. 3B","FIG. 3A","FIG. 4B"],"b":["310","320","110","110","310","205","310","210","305","210","110","305","310","110","210"]},{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 3C","FIGS. 3A and 3B","FIG. 4C"],"b":["110","205","310","310","210","305","210","110","305","310","310","130","205"]},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 4A","FIG. 3A"],"b":["110","215","215","64"]},"Message data  is bundled with a recipient electronic address . If sender client  resides in a separate data processing machine, the bundle is sent over network  to sender client . Otherwise, if sender client  exists as a collection of software modules residing on the networked device of sender , message data  and recipient electronic address  are sent over secure network . Message data  and recipient electronic address  will typically be sent using an e-mail program, such as, for example, Outlook Express, running on a personal computer at sender . However, other types of file transfer programs using different transport protocols, such as WinFTP, may also be used.","Sender client  then produces a hash value  from message data  using a one-way hash function. As known to those skilled in the art, a one-way hash function typically generates a hash value from input data which is substantially smaller than the input data itself. The hash value is generated by an algorithm such that the probability of two different data streams producing the same hash value is extremely small; in fact so small that the hash value is considered unique to the input data. The one-way hash function cannot be reversed; the input data itself cannot be recovered from its corresponding hash value. Hash value  is thus a unique number associated on a one-to-one basis with message data .","Sender client  packages hash value  with recipient electronic address  and transfers them to EPM server  over secure network . Optionally, message data  may also be passed along in this transfer. A time-stamp and\/or a date-stamp are generated by EPM server  and bundled with hash value . EPM server  then generates a digital signature using a Digital Signature Standard algorithm which is known to those skilled in the art. It then applies the digital signature to the bundled data to form an EPM data structure . Additional branding data, discussed in more detail below, may also be included in EPM data structure .","Recipient client  receives EPM data structure  and recipient electronic address  over secure network  from EPM server . Recipient client  uses recipient electronic address  to send EPM data structure  to recipient . If recipient client  is a separate data processing machine, it may use network  for the transfer. If recipient client  is a collection of software modules, for example contained in recipient , it typically uses secure network  for the transfer. Optionally, recipient  may also receive message data  itself, along with EPM data structure  through the recipient client , if sender  decides to route message data  through EPM server . Note that this alternative data flow is shown in the dashed boxes in .",{"@attributes":{"id":"p-0056","num":"0055"},"figref":["FIG. 4B","FIG. 3B","FIG. 4A"],"b":["110","210","210","240","220","110","310","305","220","310","240","110","205"]},"Similarly to the data flow shown in , a copy of message data  itself, along with EPM data structure , may be returned to sender  if desired by the sender. In this instance, message data  may be routed via EPM sever . Another option is to match EPM data structure  with message data  on sender\/recipient client , thus obviating the need to forward message data  to EPM server . Note that these alternative data flow options are shown by the dashed boxes in .",{"@attributes":{"id":"p-0058","num":"0057"},"figref":["FIG. 4C","FIG. 3C","FIG. 4A"],"b":["110","310","310","420","220","210","210","240","220","310","305","220","310","240","215","130","240","215","205"]},{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 5A","FIG. 3A"],"b":["310","210","320","510","520","510","205","520","530","510","520","530","210","530","305","210"]},"EPM server  generates an EPM data structure  in response to a request and places it in an outgoing queue with any associated data for transmission over secure network  to recipient client . Recipient client  also includes a network client module  which receives EPM data structure  and recipient electronic address  and routes it to a front-end module  via a client proxy module . Front end module  sends the EPM data structure  and associated data to recipient  via network .",{"@attributes":{"id":"p-0061","num":"0060"},"figref":["FIG. 5B","FIG. 3B","FIG. 5B","FIG. 5A","FIG. 5A"],"b":["510","520","530","510","520","530","560","550","540"]},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 6","b":["210","210","210","210"]},"EPM Server  preferably comprises a fully multi-threaded server that accepts transactions from an external source, generates an EPM data structure , and forwards EPM data structure  to the entity that made the request. EPM server , upon receiving a sender client  connection, spawns a new thread performs all communication functions with sender client . When sender client  transmits a request, the new thread collects the entire request from sender client  then place this request on an input queue. When a thread associated with generating the actual EPM locates the request in the input queue, it flags the request as \u201cIn Progress\u201d and then proceeds to produce an EPM data structure . Once the EPM generation is complete, EPM data structure  is placed on the outbound queue for pickup by recipient client , as shown in the embodiment of . Alternatively, as shown in the embodiment of  and , EPM data structure  may be picked up by sender\/recipient client .","Network server module  includes a TCP\/IP module  and a transaction processor module . Note the invention is not limited to using TCP\/IP, however this standard is the preferred network protocol. Transaction processor module  uses the services of TCP\/IP module  to process EPM request messages from sender client . Transaction processor module  receives each incoming EPM request and forwards it to an EPM module  for postmark processing. When the EPM module  returns the generated EPM data structure , transaction processor module  sends EPM data structure  it to either sender  or recipient , based upon the incoming request.","EPM module  uses the services of a time module  to obtain highly accurate time-stamps for EPMs. In addition to time and date information, EPM module  may gather other data items, including branding data, from a system registry . Branding data, which contains information regarding the corporate or organizational entity which operates EPM server , can take the form of text or image data. This data may represent names, slogans, logos, or any other type of identifying information, and may be included with hash value  and the temporal stamp.","Services from a cryptographic interface module  are used to generate a digital signature based on the hash value and temporal stamp to create EPM data structure . When the EPM operation is deemed complete, EPM module  uses a log module  to create an entry into a log file  which contains copies of each EPM data structure  generated. Log file  can be used for audit and billing purposes, and provides legal proof that a given EPM data structure  was generated. Given the importance of the log file in the audit process, the entire log file itself is used as the input data for generation of a log file EPM data structure  to ensure its integrity. The log file EPM data structure may be generated automatically, based on a number of criteria including the size of log file  or a fixed interval of time between log file EPMs. This operation may also be done manually at the command of the operator of EPM server .","One or more hardware clocks  are used to obtain and maintain accurate and trusted time information. The time values are typically generated and stored using Universal Time Coordinated (UTC), which is the same as Greenwich Mean Time. By way of example only, a TrueTime model PCI-SG Synchronized Clock Generator with GPS (Global Positioning System), commercially available from TrueTime, Inc. of Santa Rosa, Calif., may be used which has UTC accuracy of approximately one microsecond. A time manager Graphical User Interface (GUI) module  allows an operator to set and reset time-stamp information, synchronize time module  with hardware clock(s) , and visually check the correctness of time from hardware clock(s) .","Cryptographic interface module  uses one or more hardware cryptographic devices  to perform digital signature generation and verification, key generation, and hashing functions. Cryptographic hardware device  is able to support multiple encryption algorithms. By was of example only, an Attalla Websafe\/PCI card commercially available from Compaq Corporation of Houston, Tex., may be used for cryptographic device . Furthermore, the Digital Signature Algorithm (DSA) with the option of Elliptic Curve DSA may be used for the digital signature algorithms. Moreover, EPM server  may generate Digital Signature Standard (DSS) keys and use the Secure Hash Standard FIPS -, and the DSS FIPS . All of these examples are for exemplary purposes only, and are not meant to limit the present invention.","Cryptographic interface module  is controlled by a key manager GUI  in order to allow the generation of new digital key pairs for use by EPM server  and for the export of unauthorized public digital keys. Key manager GUI allows an EPM security officer to choose a location to store the unauthorized public digital key for a new key pair. Once a new pair is generated, the unauthorized public digital key of the pair is transmitted to a KSA or CA in order to transform it into an authorized public digital key. The private key of the key pair is stored within EPM server  and typically is not exported. The unauthorized public digital key is taken to a KSA or CA through secure mechanisms such as actual physical transport by authorized personnel or over a network secured by using encryption techniques. The resulting authorized digital key may be stored within the EPM server for inclusion into digital signatures, may be embedded into the verifier application residing on the data processing machine responsible digital signature authentication, or may be placed on a physical medium and kept by the user at recipient .","EPM server  supports a configuration manager GUI  that allows EPM server  system parameters to be set at the time of initialization and setup. This GUI may also be used to thereafter to update the configuration parameters of an operational EPM server. These system parameters are changed by accessing values stored in system registry .",{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 7","b":["310","210","320","310","710","715","725","710","711","710","510","520","530","720","710","310","715","730","735","310","205","305","740"]},"Recipient client  may have the same hardware configuration as sender client . Memory  will contain operating system , front-end module , client proxy module , and network client module . Each of the modules includes the same function as its counterpart found in memory  of sender client .","EPM server  contains a solid-state memory  which holds instructions which are transferred over a bus  for execution by a CPU . Memory  contains an operating system , such as, for example, Windows NT\u00ae 4.0 Server or Unix. Also included in memory are network server module , log module , EPM module , cryptographic interface module , configuration manager GUI , time manager GUI , and key manager GUI . These instructions are also contained in mass storage device , and are loaded into memory  in whole or in part during initialization of EPM server . Also contained in mass storage  is system registry  and log file . Connected to bus  are user input device interface  and user output device interface . Cryptographic device  and hardware clocks  are also connected to bus  to allow communication with appropriate software modules residing in memory . EPM server  communicates over secure network  through network device interface .",{"@attributes":{"id":"p-0074","num":"0073"},"figref":"FIG. 8A","b":["240","215","420","310","210","420","810","625"]},"As known to those skilled in the art, digital signature  may be produced by first performing a secure hash algorithm by using, for example, the Secure Hash Standard FIPS - on the data to be signed to produce a secure hash value. The secure hash value is then processed using a digital signature algorithm (DSA) and a unique private key to produce two data values. These data values comprise digital signature , which is appended to the hash value, time and data stamp, and branding data to form EPM data structure .","In order to validate the digital signature, a public digital key, which has a unique pairing with the private key, must be used. Methods known to those skilled in the art, such as, for example, the Digital Signature Standard, may be used to produce digital signature .",{"@attributes":{"id":"p-0077","num":"0076"},"figref":["FIG. 8B","FIG. 8A","FIG. 8A"],"b":["240","830","820","130","820","120","830","830","240","130","240"]},"The foregoing description is presented for purposes of illustration and explanation. It is not intended to be exhaustive or to limit the invention to the precise form disclosed, and modifications of variations are possible in light of the above teachings or may be acquired from practice of the invention. The principles of the invention and its practical application enable one skilled in the art to utilize the invention in various embodiments and with various modifications as are suited to the particular use contemplated."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of this specification, illustrate several embodiments of the invention and together with the following description, serve to explain the principles of the invention. In the drawings:",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1A"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1B"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 3A"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 3C"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 4A","FIG. 3A"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 4B","FIG. 3B"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 4C","FIG. 4C"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 5A","FIG. 3A"]},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 5B","FIG. 3B"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 6","FIG. 3A"]},{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIG. 7","FIG. 3A"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 8A"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 8B"}]},"DETDESC":[{},{}]}
