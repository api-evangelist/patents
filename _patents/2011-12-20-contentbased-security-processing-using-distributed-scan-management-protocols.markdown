---
title: Content-based security processing using distributed scan management protocols
abstract: A method and apparatus is provided for processing acquired document data, using distributed scan management protocols, according to a security classification of the data. A scanning device through which the document data is acquired includes a distributed scan management service that implements a distributed scan device protocol and a distributed scan processing protocol. In embodiments of the invention, the distributed scan device protocol and the distributed scan processing protocol are implemented using Web services. The distributed scan management service is configured to receive information for post scan processing instructions. The scanning device also includes a scan service configured to scan a document and generate scan data based on the document scan. The scanning device further includes a security handler service that is configured to identify a security classification for the scan data, and perform one or more actions, associated with the security classification, for the scan data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09124820&OS=09124820&RS=09124820
owner: Ricoh Company, Ltd.
number: 09124820
owner_city: Tokyo
owner_country: JP
publication_date: 20111220
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION","General Overview","Architecture for Processing Acquired Document Data","DSM Communications and Data Processing Flow","Web Services","Processing Acquired Document Data Based on Security Classifications","Security Table","Job Handler Service","Confirmation Requests","Hardware Overview"],"p":["This application is related to U.S. patent application Ser. No. 13\/398,704, filed Feb. 16, 2012, entitled \u201cAdditional Input Sources For Data Acquisition At Distributed Scan Management Systems\u201d. This application is also related to U.S. patent application Ser. No. 13\/406,401, filed Feb. 27, 2012, entitled \u201cQuotas In Distributed Scan Management Systems\u201d.","The present invention relates to controlling processing, of acquired document data by an enterprise scanning system, based at least in part on a security classification of the acquired document data.","An enterprise scanning system implements protocols that allow for entities to route documents that enter the system via a scanning device according to rules determined by system administrators and\/or users of scanning devices. An example enterprise scanning system is Distributed Scan Management (DSM) implemented by Microsoft and deployed in Windows 7\/Windows 2008 Server R2.","An enterprise scanning system that is implemented using DSM (a \u201cDSM system\u201d) allows a user to authenticate user data via a DSM scanning device and to select from one or more sets of post scan processing instructions that are made available to the user. A set of post scan processing instructions (PSP) contains instructions for routing acquired documents, including one or more destinations to which acquired document data should be sent. For example, a PSP may indicate that acquired document data should be emailed to one or more email addresses, copied to one or more specified file servers, uploaded to one or more specified websites, etc. A PSP may also include, among other things, settings for data acquisition such as color style, acquisition resolution, file format type, etc.","After a user is authenticated and has selected a PSP, the user may introduce a document to the system, e.g., by scanning document data into the system at a DSM scanning device. The DSM system routes the acquired document data according to the selected PSP.","DSM systems process and disseminate acquired document data regardless of a security classification of the data, which may be inappropriate if there is a security issue with the acquired data. To illustrate, because scanning currency is illegal, there is a security issue when a user scans currency. In this situation, it would be more appropriate to delete the scanned currency data than to disseminate the scanned currency data according to the PSP selected by the user for the scan data. Thus, it would be advantageous for a DSM system to allow administrators to manage acquired document data according to a security classification of the data.","The approaches described in this section are approaches that could be pursued, but not necessarily approaches that have been previously conceived or pursued. Therefore, unless otherwise indicated, it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section.","An approach is provided for processing acquired document data based, at least in part, on a security classification of the data. A scanning device through which the document data is acquired includes a distributed scan management service that implements a distributed scan device protocol and a distributed scan processing protocol. In embodiments, the distributed scan device protocol and the distributed scan processing protocol are implemented using Web services. The distributed scan management service is configured to receive information for post scan processing instructions. The scanning device also includes a scan service configured to scan a document and generate scan data based on the document scan. The scanning device further includes a security handler service that is configured to identify a security classification for the scan data, and to perform one or more actions, associated with the security classification, for the scan data.","In embodiments, the security handler is further configured to add a job for the scan data into a job queue, which job includes information for the scan data. In such embodiments, the scanning device includes a job handler service configured to identify a status of the job in the job queue and perform one or more actions based on the status of the job. In further embodiments, the job handler service is configured to, responsive to identifying the status of the job as a ready status: cause the scan data and information for the post scan processing instructions to be sent to a scan server; and remove the job from the job queue. In further embodiments, the job handler service is configured to remove the job from the job queue responsive to identifying the status of the job as a cancel status.","Embodiments include the security handler service further configured to identify a particular security rule that is associated with the security classification and perform the one or more actions associated with the security classification based, at least in part, on the particular security rule. In embodiments, the security handler is further configured to request confirmation for processing the scan data, receive confirmation for processing the scan data, and change the status of the job in the job queue to reflect the confirmation for processing the scan data.","In a further embodiment, the security handler service is configured to identify two or more security rules that are associated with the security classification, and select the particular security rule, associated with an instruction included in the post scan processing instructions, from the two or more security rules.","In the following description, for the purposes of explanation, numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent, however, that the present invention may be practiced without these specific details. In other instances, well-known structures and devices are shown in block diagram form in order to avoid unnecessarily obscuring the present invention.","An approach is provided for processing acquired document data based, at least in part, on a security classification of the data. A scanning device through which the document data is acquired includes a distributed scan management service that implements a distributed scan device protocol and a distributed scan processing protocol. In embodiments, the distributed scan device protocol and the distributed scan processing protocol are implemented using Web services. The distributed scan management service is configured to receive information for post scan processing instructions. The scanning device also includes a scan service configured to scan a document and generate scan data based on the document scan. The scanning device further includes a security handler service that is configured to identify a security classification for the scan data, and to perform one or more actions, associated with the security classification, for the scan data.","In embodiments, the security handler is further configured to add a job for the scan data into a job queue, which job includes information for the scan data. In such embodiments, the scanning device includes a job handler service configured to identify a status of the job in the job queue and perform one or more actions based on the status of the job. In further embodiments, the job handler service is configured to, responsive to identifying the status of the job as a ready status: cause the scan data and information for the post scan processing instructions to be sent to a scan server; and remove the job from the job queue. In further embodiments, the job handler service is configured to remove the job from the job queue responsive to identifying the status of the job as a cancel status.","Embodiments include the security handler service further configured to identify a particular security rule that is associated with the security classification and perform the one or more actions associated with the security classification based, at least in part, on the particular security rule. In embodiments, the security handler is further configured to request confirmation for processing the scan data, receive confirmation for processing the scan data, and change the status of the job in the job queue to reflect the confirmation for processing the scan data.","In a further embodiment, the security handler service is configured to identify two or more security rules that are associated with the security classification, and select the particular security rule, associated with an instruction included in the post scan processing instructions, from the two or more security rules.","A user administrator may manage processing of acquired document data based on security classifications of the data through definition of security rules. For example, a security rule may indicate that acquired document data with a first security classification requires email confirmation prior to processing the acquired document data. Further, a security rule may indicate that acquired document data with a second security classification must be cancelled without further processing the data. Thus, processing of acquired document data may be managed in an enterprise scanning system based on security classifications of the data.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 1","b":["100","100","110","120","140","150","130","100","110"]},"DSM device  may be implemented by any type of device that is capable of acquiring document data and implementing a distributed scan device protocol and a distributed scan processing protocol. A description of a distributed scan device protocol may be found at \u201cen-us\/library\/windows\/hardware\/ff540604%28v=VS.85%29.aspx\u201d on the server \u201cmsdn.microsoft.com\u201d, the contents of which are incorporated by reference as if fully set forth herein. Further, a description of a distributed scan processing protocol may be found at \u201cen-us\/library\/windows\/hardware\/ff540624%28v=VS.85%29.aspx\u201d on the server \u201cmsdn.microsoft.com\u201d, the contents of which are also incorporated by reference as if fully set forth herein.","In example network arrangement , DSM device  is configured with a DSM support service , a scan service , a security service , a graphical user interface , and a job handler service . DSM device  may be configured with other mechanisms, processes and functionality, depending upon a particular implementation. The approaches described herein for processing acquired document data are not limited to any particular type of DSM device or network configuration. For example, implementations of DSM device  may include a scanning device and a multi-function peripheral (MFP) that performs any combination of printing, copying, facsimile, and scanning, etc. Any number of devices, including printing devices, scanning devices, client devices, administrative console devices, and other computing devices, may be included in the network.","DSM support service  may be implemented by one or more processes, and communicates with other applications and network devices. These communications include communications via (a) a distributed scan device protocol to communicate with a control point, e.g., control point service  of computing device ; and (b) a distributed scan processing protocol to communicate with a scan server, e.g., scan server  of server device . In an embodiment, one or more of the protocols implemented by DSM support service  are performed using Web services. In an embodiment, all of the communications made by DSM device  is done using Web services. In these embodiments, DSM support service , scan server , Active Directory server , and control point service  implement one or more Web services protocols such as WS-Discovery, WS-Eventing, and WS-MetadataExchange, described in more detail below.","Scan service  is implemented by one or more processes for acquiring document data via a scanning device at DSM device  or made available to DSM device , e.g., via network . Security service  is implemented by one or more processes configured to detect a security classification for acquired document data and perform one or more actions, associated with the security classification, for the document data, as described in further detail below. Job handler service  is implemented by one or more processes configured to manage and dispatch scan data jobs in a job queue, and is also described in further detail below. The services attributed to DSM device  in example network arrangement  are illustrative and the functions attributed to these services may be performed by any logical module at DSM device .","DSM support service , scan service , security service , and job handler service  may be implemented as resident processes on DSM device . Alternatively, one more of DSM support service , scan service , security service , and job handler service  may be made available to DSM device  on removable media or may be implemented at a remote location with respect to DSM device . Also, DSM support service , scan service , security service , and job handler service  may be implemented as plug-ins, or in hardware, software, or any combination of hardware or software, depending upon a particular implementation.","DSM device  is further configured with graphical user interface . Graphical user interface  may be displayed at a display device associated with DSM device . A display device may be a monitor, a screen on DSM device , etc. Graphical user interface  may be implemented in a browser, as a stand-alone application, etc., and may be managed by any service at DSM device .","Network  may be implemented with any type of medium and\/or mechanism that facilitates the exchange of information between DSM device , server device , and computing devices  and . Furthermore, network  may use any type of communications protocol, and may be secured or unsecured, depending upon the requirements of a particular embodiment.","Server device  may be implemented by any type of device that is capable of communicating with DSM device  and\/or computing device  over network . In example network arrangement , server device  is configured with scan server  and Active Directory server , described in further detail below. Server device  may be configured with other mechanisms, processes and functionality, depending upon a particular implementation. In embodiments, scan server  and Active Directory server  are implemented as resident processes on Server device . In other embodiments, one or more of scan server  and Active Directory server  are made available to server device  on removable media or may be implemented at a remote location with respect to server device . Also, scan server  and Active Directory server  may be implemented as plug-ins, or in hardware, software, or any combination of hardware or software, depending upon a particular implementation.","Computing devices  and  may be implemented by any type of computing device that is capable of communicating with DSM device  and\/or server device  over network . In example network arrangement , computing device  is configured with control point service , described in further detail below. Also in example network arrangement , computing device  is configured with a security classification detector service  that may be utilized by security service  on DSM device . In another embodiment, DSM device  is configured with a security classification detector service . As such, descriptions herein of security classification detector service  may refer to either embodiment. Computing devices  and  may be configured with other mechanisms, processes and functionalities, depending upon a particular implementation.","DSM device  is considered to be a DSM-type device because DSM device , via DSM support service , communicates with control point service  using a distributed scan device protocol and with scan server  using a distributed scan processing protocol. In an embodiment, DSM support service  communicates with Active Directory server  via Lightweight Directory Access Protocol (LDAP).","Control point service  allows administrators to define PSPs and associate defined PSPs with one or more users or user groups. Control point service  causes information for the PSPs to be made accessible to Active Directory server . For example, control point service  stores PSP information at memory for server device  that is accessible by Active Directory server . In an embodiment, control point service  communicates with Active Directory server  via LDAP.","A user may input user authentication information (e.g., username and password) into graphical user interface  at DSM device . DSM support service  authenticates the user information with Active Directory server . Once the user is authenticated, DSM support service  retrieves a list of PSPs, which are available to the user, from Active Directory server  and displays the list to the user at graphical user interface .","Through graphical user interface , DSM support service  receives the user's selection of PSP of the list of PSPs, and the selected PSP is designated to be the processing instructions for document data that the user causes DSM device  to acquire. In an embodiment, the user scans a document at a scanning device for DSM device  and scan service  produces scan data for the document. However, embodiments of the invention are not limited to processing document data that is acquired via scanning. For example, DSM device  may acquire document data through electronic transfer of the data from a storage or computing device, through fax, or in any other manner. References herein to scan data do not limit the embodiments of the invention to acquiring data via scanning, but are used for ease of explanation.","Scan service  applies scan settings included in the selected PSP to document scans requested by the user. Also, if the selected PSP includes other data acquisition settings that are applicable to the manner of data acquisition used to acquire the document data, such settings are applied to the data acquisition. As described in further detail below, a component of DSM device , e.g., DSM support service , scan service , security service , job handler service , etc., may send the scan data with the selected PSP to scan server , which processes the scan data according to the selected PSP.","The World Wide Web Consortium (W3C), which is an international consortium that develops standards for the World Wide Web, defines a \u201cWeb service\u201d as a software system that is designed to support interoperable machine-to-machine interaction over a network. This definition encompasses many different systems, but in common usage, the term refers to those services that use Simple Object Access Protocol (SOAP)-formatted Extensible Markup Language (XML) envelopes and that have interfaces described using Web Services Description Language (WSDL). Web services allow devices and applications to communicate with each other over one or more networks without the intervention of any human being, while using the same suite of protocols (e.g., Hypertext Transfer Protocol (HTTP)) that a human being would use to communicate with such devices and applications over the one or more networks.","SOAP is an XML-based, extensible message envelope format, with bindings to underlying protocols (e.g., HTTP and Simple Mail Transfer Protocol (SMTP)). Using XML, SOAP defines how messages should be formatted, so that those messages are formatted in such a way that the recipients of those messages (devices and applications) can understand the messages. SOAP can be used to perform remote procedure calls, for example.","WSDL is an XML format that allows Web service interfaces to be described along with the details of those interfaces' bindings to specific protocols. WSDL is typically used to generate server and client code, and for configuration.","Thus, common core specifications of Web services are SOAP, and WSDL, as well as WS-Discovery, WS-MetadataExchange, WS-Eventing, and WS-Addressing.","Referring to , once DSM device  has acquired the data to be processed, e.g., via scanning a document, security service  detects a security classification for the scan data and performs one or more actions on the scan data based, at least in part, on the security classification.  illustrates a flowchart for detecting a security classification for scan data and performing one or more actions on the data. At step , information for post scan processing instructions are received. For example, DSM support service  receives a user's selection of a PSP as described above. In this example, the selected PSP includes instructions to send scan data to a particular destination for storage, to email the scan data to the authenticated user, and pre-defined scan settings that will cause scan service  to capture the content of the scan data as a black and white Portable Document Format (PDF) file. DSM support service  may receive information for a user's PSP selection before or after scan service  generates scan data based on the document scan.","At step , a document is scanned at a scanning device, wherein the scanning device implements a distributed scan device protocol and a distributed scan processing protocol. Continuing with the previous example, the authenticated user requests DSM device  to scan a document provided to DSM device  by the user. In response to this request, DSM device  scans the document using any pre-defined scan settings in the selected PSP.","At step , scan data is generated based on the document scan. For example, scan service  generates scan data based on the document scan performed at DSM device . Such scan data may include one or more of an image of the scanned document, a reference to a storage location for an image of the scanned document, and other information for the scanned document. According to the previous example, scan service  stores an image of the scanned document as a black and white PDF file.","At step , a security classification for the scan data is identified. For example, scan service  notifies security service  that scan data has been generated based on the document scan and is ready for a security classification. In one embodiment, security service  is associated with an Application Programming Interface (API). According to this embodiment, to notify security service  that scan data is ready for a security classification, scan service  calls an API function of security service  and passes the scan data to security service .","In one embodiment, when security service  is notified of scan data that requires a security classification, security service  requests security classification detector service  to detect a security classification for the scan data. In connection with such a request, security service  may send scan data to security classification detector service , or may send a reference to where the scan data is stored. Upon receipt of the request to classify scan data, security classification detector service  inspects the content of the scanned document represented in the scan data to determine a security classification for the scan data. After security classification detector service  has determined a security classification for the scan data, security classification detector service  returns the security classification to security service .","The following are non-limiting examples of security classifications that may be detected by security classification detector service , and bases for such detections. Security classification detector service  may assign a \u201cCopyrighted\u201d security classification to the scan data, e.g., based on a copyright notice in the content of the scanned document. Security classification detector service  may assign an \u201cillegal\u201d security classification to the scan data based on detecting that the content of the scanned document is not legal to scan, e.g., the content includes currency, or other bank notes. Furthermore, security classification detector service  may assign a \u201cConfidential\u201d security classification to the scan data, e.g., based on a watermark detected in the content of the scanned document, based on detecting that the scanned document contains an email, based on detecting that the scanned document is a legal-style document such as a contract, based on detecting that the scanned document includes a code that marks the document as confidential, etc.","At step , one or more actions, associated with the security classification, are performed for the scan data. To illustrate, in response to receiving the scan data security classification, security service  retrieves a set of rules for performing actions on security-classified scan data. The set of rules may be stored as a security table, and is referred to as such for ease of explanation. In one embodiment, the one or more actions include inserting a job for the scan data into a job queue.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 3","b":["300","312","320","300","118","142","300","110","110","300","110","110","300","300","300"]},"Security rules - include security levels that derive from security classifications that may be returned by a security classification detector service ( of ) and one or more actions to be performed when a rule is mapped to scan data based, at least in part, on a security classification for the scan data. A security level may be derived from a security classification based on a security level table that maps security levels to security classifications returned by security classification detector service . Furthermore, the name of a security level may be the same as the name of the corresponding security classification returned by security classification detector service , and is thus derived from the security classification. In the embodiments described below, for ease of explanation, the name of a security level is the same as the name of the corresponding security classification.","In security table , security code column  stores unique identifiers for security rules -. Security level column  stores security classifications associated with the various security rules -. Security violation column  stores further information identifying scan data (and\/or a selected PSP) that should map to the various security rules -. Action column  stores identifiers of actions to be performed for scan data that maps to the various security rules -. Action code column  stores unique identifiers for associated actions indicated in action column . Action parameters column  stores information that is needed for actions indicated in action column . Security table  may include information not shown in  or may omit columns shown in , depending upon a particular implementation.",{"@attributes":{"id":"p-0056","num":"0055"},"figref":["FIG. 4","FIG. 3"],"b":["312","320","402","404","152","116","116","312","320","300","340","152"]},"Furthermore, the scan data maps to a security level included in one or more rules in security table , but does not match the security violation information for any of the one or more rules with the appropriate security level (as described in further detail below), then it is considered that the security level for the scan data is not found in security table .","Because the security classification returned by security classification detector service  is not associated with any security rule in security table , control passes to step , at which point job information is added into a job queue with a status as \u201cReady\u201d. For example, security service  inserts a job for the scan data into a job queue for DSM device , where the job has a \u201cReady\u201d status.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 5","b":["500","500","512","516","520","512","516","530","512","516","500","540","512","516","540","550","512","516","560","512","516","570","560","580","512","516"]},"Continuing with the example given in connection with step , security service  creates and inserts scan data job  into job queue table  with information for the scan data that received a security classification of \u201cno classification\u201d. After scan data job  is inserted into job queue table , control passes to step  at which point flowchart  ends. Management of job queue table  and dispatch of the jobs therein is described in further detail below.","As another example to illustrate flowchart , security classification detector service  returns a security classification of \u201cillegal\u201d to security service  in connection with the scan data. At step , security service  identifies whether one or more of security rules - () are associated with the returned security classification. In the case of an \u201cillegal\u201d security classification, security service  identifies security rule  as having a security level (column ) of \u201cillegal\u201d. As there is a single security rule identified by the returned security classification, security service  maps the scan data to the identified security rule . Control passes to step .","At step , it is determined whether the scanning needs to be stopped. For example, security service  determines that the action (column ) for security rule  is \u201cStop\u201d, or action code (column ) \u201c0\u201d. Therefore, security service  determines that the scanning needs to be stopped, or in other words, the scan data cannot be processed as instructed by the user. Security service  may determine that other action types require the scanning to be stopped. For example, an action that may be included in action column , \u201cStop\/Email\u201d, may require the scanning to be stopped and an email to be sent out with information about the scan, etc. Control passes to step  as a result of security service  determining that the scanning needs to be stopped.","At step , job information is added into a job queue with a status as \u201cCancel\u201d. For example, security service  creates scan data job  with a status of \u201cCancel\u201d and with information for the scan data and inserts scan data job  into job queue table .","After the scan data job  is inserted into job queue table , control passes to step , at which point a graphical user interface is updated with a warning message. For example, security service  causes graphical user interface  to display a message that indicates that the scan has been stopped. Such a message may include the security classification identified for the scan data (e.g., \u201cIllegal\u201d), and may include any other information, such as contact information for a person that the user may contact for assistance, an image for the scan data, etc. After security service  displays the warning message, control passes to step  at which point flowchart  ends.","As yet another example to illustrate flowchart , security classification detector service  returns a security classification of \u201cCopyrighted\u201d to security service  in connection with the scan data. At step , security service  identifies whether one or more of security rules - () are associated with the returned security classification. For example, security service  identifies security rule  having a security level (column ) of \u201cCopyrighted\u201d.","Since the security classification of the scan data is defined in security table , control passes to step , where it is determined whether the scanning needs to be stopped. Security service  determines that the action (column ) for security rule  is \u201cEmail\u201d, which is not associated with immediately stopping the scan process. Therefore, control passes from step  to step .","At step , it is determined whether the scanning requires further confirmation. Security service  determines that the action \u201cEmail\u201d is an instruction to obtain confirmation of the scan data and associated PSP via email. As such, the scanning requires further confirmation and control passes to step . Depending upon a particular implementation, other action codes may be associated with requiring further confirmation for a scanning, e.g., \u201cFax\u201d, \u201cEmail\/Fax\u201d, \u201cTelephone\u201d, etc., any of which may require confirmation for a scanning via any channel that may provide such a confirmation. To illustrate, an action \u201cTelephone\u201d may require an automated service to call a number included in action parameters column  with auditory information about the scan data. In the description herein, confirmation via email is used as an illustrative example and does not limit the embodiments of the invention thereto.","At step , an email is sent to a contact for further confirmation. For example, in response to detecting that the action for security rule  is \u201cEmail\u201d, security service  sends an email with information about the scan data, and a request for confirmation to proceed with processing the scan data, to one or more email addresses included in the action parameters (column ) for security rule . Such an email may include one or more of an image of the scan data, an identifier of the authenticated user associated with the scan data, the security classification that has been identified for the scan data, any identified security violation (column ), information for the associated PSP, etc. Information in action parameters column  may be labeled or unlabeled, depending upon a particular implementation.","At step , job information is added into a job queue with a status as \u201cTo Be Approved\u201d. For example, security service  creates scan data job  with information for the scan data and inserts scan data job  into job queue table . In one embodiment, after scan data job  is inserted into job queue table , a graphical user interface is updated with a message indicating that confirmation for the scanning is being sought. For example, security service  causes graphical user interface  to display a message that indicates that processing the scan data has been delayed pending confirmation of the scanning. Such a message may include one or more of the security classification identified for the scan data (e.g., \u201cCopyrighted\u201d), contact information for a person that the user may contact for assistance, and any other information.","After security service  inserts a job for the scan data into the job queue, control passes to step  at which point flowchart  ends.","As yet another example to illustrate flowchart , security classification detector service  returns a security classification of \u201cConfidential\u201d to security service  in connection with the scan data. At step , security service  identifies whether one or more of security rules - () are associated with the returned security classification. In the case of a \u201cConfidential\u201d security classification, security service  identifies security rules  and  as having a security level (column ) of \u201cConfidential\u201d.","In one embodiment, when multiple rules match the security classification of scan data, security service  maps, to the scan data, the first security rule that is identified in the security table as matching the information for the scan data. Depending upon a particular implementation, rules may be evaluated in ascending order of security code (column ). For a security rule to match information for scan data, both the security level (column ) and security violation information (column ) for the security rule must match the appropriate aspects of the scan data and associated information, such as the associated PSP, user information for the user that initiated the data acquisition, etc.","Security violation information for a security rule is information identifying aspects of the scan data and associated information, not involving security classifications, that further refines the mapping requirements of the security rule to the scan data. Security violation information may identify any aspect of scan data, PSP, associated user information, etc., that is not derived from a security classification, including one or more of particular destination information (from the PSP), a size of the scan data, a user identifier, and a user group to which the user belongs, etc.","According to this embodiment, security service  evaluates whether security rule  matches information for the scan data before evaluating security rule . Security service  determines that security rule  includes security violation information (column ). The security violation information for security rule  indicates that scan data that maps to this security rule is associated with a PSP that contains an external email address. As such, security service  determines whether the PSP selected for the scan data contains an external email as a destination. If it does, then security rule  is mapped to the scan data.","If not, then security service  determines that security rule  does not map to the scan data and proceeds to the next security rule () that has the appropriate security level. Security service  determines that security rule  does not include security violation information and, thus, no further evaluation of security rule  is needed to map security rule  to the scan data.","In another embodiment, when multiple rules match the security classification of scan data, security service  first attempts to map, to the scan data, a security rule that matches the security classification of the scan data and also includes security violation information (column ). If there is no security rule with security violation information that maps to the scan data, then security service attempts to map, to the scan data, a security rule that matches the security classification of the scan data and that does not include security violation information. In this embodiment, a security rule that is more specifically tailored to the scan data via security violation information is given preference over a security rule that is more general.","For purposes of the example, security service  maps security rule  to the scan data. Since the security classification of the scan data is defined in security table , control passes to step , where it is determined whether the scanning needs to be stopped. Security service  determines that the action (column ) for security rule  is \u201cEmail\u201d, which is not associated with immediately stopping the scan process. Therefore, control passes from step  to step  and proceeds as describe above in connection with security rule .","As yet another example to illustrate flowchart , security classification detector service  returns a security classification of \u201cSensitive\u201d to security service  in connection with the scan data. At step , security service  identifies whether one or more of security rules - () are associated with the returned security classification. In the case of a \u201cSensitive\u201d security classification, security service  identifies security rule  as having a security level (column ) of \u201cSensitive\u201d.","Since the security classification of the scan data is defined in security table , control passes to step , where it is determined whether the scanning needs to be stopped. Security service  determines that the action (column ) for security rule  is \u201cNotify-Fax\u201d, which is not associated with immediately stopping the scan process. Therefore, control passes from step  to step .","At step , it is determined whether the scanning requires further confirmation. Security service  determines that the action \u201cNotify-Fax\u201d associated with security rule  does not require further confirmation prior to proceeding with processing the scan data. As such, control passes from step  to step .","At step , it is determined whether the scanning requires notification. Security service  determines that the action \u201cNotify-Fax\u201d associated with security rule  requires notification to a fax number in the action parameters (column ) for the rule. As such, the scanning requires notification and control passes to step . Other actions may require notification at step , including \u201cNotify-Telephone\u201d, \u201cNotify-Email\u201d, \u201cNotify-Text\u201d, etc. Notifications may be sent in a manner similar to a confirmation request, described in further detail below, but do not include a mechanism to allow the recipient to confirm or deny processing the scan data.","At step , notification is sent as indicated by the action for the security rule. For example, security service  sends a fax to the fax number in the action parameters (column ) for security rule . The fax may include information about the scanning, including one or more of: an image of the scanned document; an identifier of the user that initiated the scan; information from the PSP associated with the scan; etc. However, because a \u201cNotify-Fax\u201d action does not require confirmation, no mechanism is provided to allow the recipient of the fax to confirm or deny processing of the scan data. Control then passes from step  to step .","At step , job information is added into a job queue with a status as \u201cReady\u201d. For example, security service  creates scan data job  with information for the scan data and inserts scan data job  into job queue table . After security service  inserts a job for the scan data into the job queue, control passes to step  at which point flowchart  ends.","In one embodiment, job handler service  monitors job queue table  and executes actions associated with the status of the job. Job handler service  may be a distinct service in DSM device , or may be part of security service .",{"@attributes":{"id":"p-0085","num":"0084"},"figref":["FIG. 6","FIG. 5"],"b":["600","602","500","512","560","500","604"]},"At step , the scan data and PSP associated with each of the one or more \u201cReady\u201d jobs in the job queue are sent to a scan server for processing. Within embodiments of the invention, any service running on DSM device  may send information for the scan data and PSP to a scan server for processing, including Job handler service , security service , scan service , DSM support service , etc.","To illustrate one embodiment, job handler service  sends information for the scan data and PSP to scan server . To illustrate another embodiment, job handler service  notifies DSM support service  of the \u201cReady\u201d job. DSM support service  retrieves the information to be sent to scan server  for the \u201cReady\u201d job and sends the information for the \u201cReady\u201d job to scan server . To illustrate yet another embodiment, job handler service  sends the scan data and PSP to DSM support service , e.g., via an API call, which notifies DSM support service  of the \u201cReady\u201d job and obviates the need for DSM support service  to retrieve the scan data information. DSM support service  sends the received scan data and PSP to scan server . Scan server  processes the scan data and dispatches at least a portion of the scan data to the destinations defined in the accompanying PSP. When information for a job has been sent to the scan server, the job is deleted from the job queue.","If no jobs in the job queue have a \u201cReady\u201d status, or after performance of step , control passes to step . At step , it is determined whether any job in the job queue has a status of \u201cCancel\u201d. For example, scan data job  in job queue table  has a status (column ) of \u201cCancel\u201d. Since one or more jobs in job queue table  have a status of \u201cCancel\u201d, control passes to step  at which point the \u201cCancel\u201d jobs are deleted from the job queue. For example, job handler service  deletes scan data job  from job queue table  without performing any other actions for the job.","At step , a graphical user interface is updated with a status message. For example, job handler service  causes a message to be displayed at graphical user interface  indicating that the job has been cancelled. Such a message may include other information, including an image of the scan data, depending upon a particular implementation.","If there are no \u201cCancel\u201d jobs in the job queue, or after performance of step , control passes to step . At step , it is determined whether any job in the job queue with a status of \u201cTo Be Approved\u201d has timed out. To illustrate, an administrator may set an amount of time that a job, which is pending approval (i.e., with a status of \u201cTo Be Approved\u201d), may remain in the job queue. Once a job that is pending approval has been in the job queue for at least the allotted amount of time, the job is considered timed out. For example, job handler service  determines that scan data job  of job queue table  has a status \u201cTo Be Approved\u201d and compares the amount of time that has passed since the job was created, as recorded in create time column , with the amount of time that the job may be allowed to remain in the queue. If the job has exceeded this allotted amount of time, then the job has timed out and control passes to step .","At step , the job that has timed out is deleted from the job queue. For example, scan data job  is determined to have timed out and job handler service  deletes scan data job  from job queue table .","At step , a graphical user interface is updated with a status message. For example, job handler service  causes a message to be displayed at graphical user interface  indicating that scan data job  has timed out and has been deleted from the queue. Such a message may include information from the scan data and\/or PSP selected for the scan data. Furthermore, an email may be sent to the user that originated the job to notify the user that the job timed out and been cancelled. If a job with a status of \u201cTo Be Approved\u201d is not timed out, then the job remains in the job queue.","If no \u201cTo Be Approved\u201d jobs in the job queue have timed out, or after performance of step , control passes to step . At step , job handler service  sleeps for any amount of time, e.g., determined by an administrator, and then control automatically passes to step .","As previously indicated, when a job is placed in the job queue with a status of \u201cTo Be Approved\u201d, a communication is sent via the format indicated by the applicable security rule. For example, security rule  requires that a confirmation request email is sent to a contact indicated in the action parameters (column ) for the rule. The recipient of the confirmation request email may confirm or deny processing of the scan data via any method that allows the recipient to communicate the confirmation or denial to security service . For example, the confirmation request email may include a voting mechanism whereby the recipient can communicate to security service  a \u201cyes\u201d to confirm processing the scan data or a \u201cno\u201d to deny processing the scan data. As another example, the recipient may respond to the confirmation request email with text that indicates the confirmation or denial, which text may be parsed by security service  or any other service. As yet another example, the confirmation request email may include hyperlinks or visual controls which, when activated, communicate a confirmation or denial of processing the scan data to security service .","A security rule may require a confirmation request fax be sent to a fax number in the associated action parameters (column ). Such a fax may include an image of the scan data, the security classification associated with the scan data, etc. Again, the recipient of the confirmation request fax may confirm or deny processing of the scan data via any method that allows the recipient to communicate the confirmation or denial to security service . For example, the recipient may fax a page with textual instructions to confirm or deny processing the scan data, which may be parsed by security service  or any other service.","A security rule may require a confirmation request telephone call be made to a telephone number in the associated action parameters (column ). As previously indicated, the confirmation request telephone call may be placed by an automated service and provide auditory information about the scan data. This auditory information may include the security classification of the data, an identifier of the user that caused the scan data to be acquired, etc. Again, the recipient of the confirmation request telephone call may confirm or deny processing of the scan data via any method that allows the recipient to communicate the confirmation or denial to security service . For example, the recipient of the telephone call may confirm or deny of processing the scan data via pressing a particular button on the telephone corresponding to confirmation or denial. As another example, the telephone call recipient may speak a particular phrase to the automated service, which is translated into a confirmation or denial using voice recognition.","A security rule may require a confirmation request text message be sent to a telephone number in the associated action parameters (column ). The confirmation request text message may include a description of the security classification of the data, an identifier of the user that caused the scan data to be acquired, etc. The recipient of the confirmation request text message may confirm or deny processing of the scan data via any method that allows the recipient to communicate the confirmation or denial to security service . For example, the recipient of the text message may confirm or deny of processing the scan data via a reply text message with the text \u201cconfirm\u201d or \u201cdeny\u201d.","Furthermore, a security rule may require a confirmation request message be sent to an account identified in the associated action parameters (column ). Such an account may be a general-purpose social media account or a company-based social media account, etc. The confirmation request message may include a description of the security classification of the data, an identifier of the user that caused the scan data to be acquired, etc. The recipient of the confirmation request message may confirm or deny processing of the scan data via any method that allows the recipient to communicate the confirmation or denial to security service . For example, the recipient of the message may confirm or deny of processing the scan data via a reply message with the text \u201cconfirm\u201d or \u201cdeny\u201d. As another example, the confirmation request message may include hyperlinks or visual controls which, when activated, communicate a confirmation or denial of processing the scan data to security service ","Once security service  receives confirmation or denial of processing the scan data, then security service  changes the status of the associated job in the job queue to reflect a \u201cReady\u201d status, or \u201cCancel\u201d status, respectively. For example, security service  receives a confirmation of processing the scan data for scan data job  in job queue table . Security service  changes the status (column ) and status code (column ) of scan data job  to a \u201cReady\u201d status. The next time job handler service  checks for jobs with a status as \u201cReady\u201d, scan data job  will be processed accordingly.","As another example, security service  receives a denial of processing the scan data for scan data job  in job queue table . Security service  changes the status (column ) and status code (column ) of scan data job  to a \u201cCancel\u201d status. The next time job handler service  checks for jobs with a status as \u201cCancel\u201d, scan data job  will be deleted from job queue table  accordingly.","According to one embodiment, the techniques described herein are implemented by one or more special-purpose computing devices. The special-purpose computing devices may be hard-wired to perform the techniques, or may include digital electronic devices such as one or more application-specific integrated circuits (ASICs) or field programmable gate arrays (FPGAs) that are persistently programmed to perform the techniques, or may include one or more general purpose hardware processors programmed to perform the techniques pursuant to program instructions in firmware, memory, other storage, or a combination. Such special-purpose computing devices may also combine custom hard-wired logic, ASICs, or FPGAs with custom programming to accomplish the techniques. The special-purpose computing devices may be desktop computer systems, portable computer systems, handheld devices, networking devices or any other device that incorporates hard-wired and\/or program logic to implement the techniques.","For example,  is a block diagram that illustrates a computer system  upon which an embodiment of the invention may be implemented. Computer system  includes a bus  or other communication mechanism for communicating information, and a hardware processor  coupled with bus  for processing information. Hardware processor  may be, for example, a general purpose microprocessor.","Computer system  also includes a main memory , such as a random access memory (RAM) or other dynamic storage device, coupled to bus  for storing information and instructions to be executed by processor . Main memory  also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor . Such instructions, when stored in non-transitory storage media accessible to processor , render computer system  into a special-purpose machine that is customized to perform the operations specified in the instructions.","Computer system  further includes a read only memory (ROM)  or other static storage device coupled to bus  for storing static information and instructions for processor . A storage device , such as a magnetic disk or optical disk, is provided and coupled to bus  for storing information and instructions.","Computer system  may be coupled via bus  to a display , such as a cathode ray tube (CRT), for displaying information to a computer user. An input device , including alphanumeric and other keys, is coupled to bus  for communicating information and command selections to processor . Another type of user input device is cursor control , such as a mouse, a trackball, or cursor direction keys for communicating direction information and command selections to processor  and for controlling cursor movement on display . This input device typically has two degrees of freedom in two axes, a first axis (e.g., x) and a second axis (e.g., y), that allows the device to specify positions in a plane.","Computer system  may implement the techniques described herein using customized hard-wired logic, one or more ASICs or FPGAs, firmware and\/or program logic which in combination with the computer system causes or programs computer system  to be a special-purpose machine. According to one embodiment, the techniques herein are performed by computer system  in response to processor  executing one or more sequences of one or more instructions contained in main memory . Such instructions may be read into main memory  from another storage medium, such as storage device . Execution of the sequences of instructions contained in main memory  causes processor  to perform the process steps described herein. In alternative embodiments, hard-wired circuitry may be used in place of or in combination with software instructions.","The term \u201cstorage media\u201d as used herein refers to any non-transitory media that store data and\/or instructions that cause a machine to operation in a specific fashion. Such storage media may comprise non-volatile media and\/or volatile media. Non-volatile media includes, for example, optical or magnetic disks, such as storage device . Volatile media includes dynamic memory, such as main memory . Common forms of storage media include, for example, a floppy disk, a flexible disk, hard disk, solid state drive, magnetic tape, or any other magnetic data storage medium, a CD-ROM, any other optical data storage medium, any physical medium with patterns of holes, a RAM, a PROM, and EPROM, a FLASH-EPROM, NVRAM, any other memory chip or cartridge.","Storage media is distinct from but may be used in conjunction with transmission media. Transmission media participates in transferring information between storage media. For example, transmission media includes coaxial cables, copper wire and fiber optics, including the wires that comprise bus . Transmission media can also take the form of acoustic or light waves, such as those generated during radio-wave and infra-red data communications.","Various forms of media may be involved in carrying one or more sequences of one or more instructions to processor  for execution. For example, the instructions may initially be carried on a magnetic disk or solid state drive of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system  can receive the data on the telephone line and use an infra-red transmitter to convert the data to an infra-red signal. An infra-red detector can receive the data carried in the infra-red signal and appropriate circuitry can place the data on bus . Bus  carries the data to main memory , from which processor  retrieves and executes the instructions. The instructions received by main memory  may optionally be stored on storage device  either before or after execution by processor .","Computer system  also includes a communication interface  coupled to bus . Communication interface  provides a two-way data communication coupling to a network link  that is connected to a local network . For example, communication interface  may be an integrated services digital network (ISDN) card, cable modem, satellite modem, or a modem to provide a data communication connection to a corresponding type of telephone line. As another example, communication interface  may be a local area network (LAN) card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation, communication interface  sends and receives electrical, electromagnetic or optical signals that carry digital data streams representing various types of information.","Network link  typically provides data communication through one or more networks to other data devices. For example, network link  may provide a connection through local network  to a host computer  or to data equipment operated by an Internet Service Provider (ISP) . ISP  in turn provides data communication services through the world wide packet data communication network now commonly referred to as the \u201cInternet\u201d . Local network  and Internet  both use electrical, electromagnetic or optical signals that carry digital data streams. The signals through the various networks and the signals on network link  and through communication interface , which carry the digital data to and from computer system , are example forms of transmission media.","Computer system  can send messages and receive data, including program code, through the network(s), network link  and communication interface . In the Internet example, a server  might transmit a requested code for an application program through Internet , ISP , local network  and communication interface .","The received code may be executed by processor  as it is received, and\/or stored in storage device , or other non-volatile storage for later execution.","In the foregoing specification, embodiments of the invention have been described with reference to numerous specific details that may vary from implementation to implementation. The specification and drawings are, accordingly, to be regarded in an illustrative rather than a restrictive sense. The sole and exclusive indicator of the scope of the invention, and what is intended by the applicants to be the scope of the invention, is the literal and equivalent scope of the set of claims that issue from this application, in the specific form in which such claims issue, including any subsequent correction."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["In the drawings:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
