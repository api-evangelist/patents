---
title: Methods and apparatus for replacing cooling systems in operating computers
abstract: An apparatus and method for replacing a CPU cooling system, for example, a fan, while a computer continues to operate has a mechanism for maintenance personnel to signal that cooling fan replacement is about to begin. In response to the signal, a control mechanism causes the CPU to shift into an operating mode in which heat generation is reduced. In some cases, a clock frequency of the affected CPU and/or a duty cycle at which the CPU operates is reduced. After the fan has been replaced the control mechanism returns the CPU to a normal operational mode, for example, by increasing the clock frequency or duty cycle to a normal level. During the fan replacement procedure, the CPU and its software continues to run at lower than normal performance.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07017059&OS=07017059&RS=07017059
owner: Cray Canada Inc.
number: 07017059
owner_city: Burnaby
owner_country: CA
publication_date: 20031212
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND","SUMMARY OF THE INVENTION","DESCRIPTION"],"p":["This invention relates to cooling computers and also to electronic devices generally which require cooling for continuous operation. Particular embodiments of the invention relate to maintaining computer cooling systems. Some specific embodiments of the invention permit the replacement of cooling fans in operating computers.","Computer data processing chips such as CPUs (central processing units), GPUs (graphics processing units) and the like are becoming increasingly powerful. This increase in performance has been accomplished by increasing clock frequencies, shrinking geometries within integrated circuits, and adding additional logic for more features.","Current high performance data processing chips generate significant amounts of heat. For example, some state of the art CPUs generate heat in excess of 80 watts. Since excessive temperatures can damage integrated circuits, it is common to provide active cooling systems to CPUs and similar devices. For example, it is common to attach large heat sinks to CPU chips and to provide a fan to ensure that there is adequate cooling air flow through the heat sink at all times while the computer is operating. If the air flow is interrupted for as little as a minute or two, the CPU can be destroyed by excessive heat buildup.","The fan may be mounted directly on the CPU heat sink to push air past the fins of the heat sink. The fan may alternatively be mounted elsewhere in the computer or on the surface of the computer's case. The fan is typically mounted in such a way that its air flow is directed to the vicinity of the CPU.","Like any other devices with moving mechanical parts, cooling fans can fail. If the cooling fan fails, air flow is interrupted. As a result, heat builds up in the CPU and the CPU's temperature can rise quickly to critical levels. Many modern computers prevent destruction of the CPU in such an eventuality by providing a system for monitoring the die temperature in the CPU. If the temperature of the die increases beyond a threshold temperature, the CPU is shut down. Shutdown of the CPU typically occurs very abruptly with no warning to software. The CPU essentially crashes. After the computer is restarted, it is necessary to return the CPU to an appropriate state and\/or clean up any corrupted data resulting from the CPU crash before the computer can resume its intended role. The computer could be out of service for a significant period of time before a fan failure is detected and corrected.","In recent years, cooling fans have been improved such that incipient failures can be detected. Many cooling fans have voltage sensors and fan speed sensors. If the fan speed drops slowly over time then this may indicate that the fan is becoming clogged with dust and requires cleaning. An increase in the fan voltage which is not accompanied by a corresponding increase in the fan speed may indicate that the fan's bearings are starting to fail. With these improvements, it is sometimes possible to detect emerging problems before the fan fails. Computers are increasingly provided with software that monitors these sensors while the computer is operating. It is possible to shut down the computer gracefully to replace the fan instead of waiting for it to crash after the fan fails. If a graceful shutdown is achieved then the computer will be out of service for a shorter interval.","Some computers are required to operate continuously for long periods, in so-called \u201c24\u00d77\u201d operation. For example, a computer may process sales orders for an online shopping web site. If such a computer is shut down to replace a cooling fan, revenue may be lost in direct proportion to the length of time that the computer is out of service. It is highly desirable to avoid shutting down the computer altogether or at least to minimize the length of time that the computer is out of service.","As another example, modern high performance computing systems (i.e. supercomputers) typically consist of hundreds or thousands of interconnected rack-mounted computers. Such computer systems often run a computer intensive application for hours or days across all of the computers making up such a system. The application runs a program on each of the computers. The programs communicate among themselves to share intermediate results. If one computer fails, the whole application will stop executing or fail. This may result in the loss of several hours or days worth of results.","To satisfy the needs of 24\u00d77 operation, high performance computing systems, and other situations with similar requirements, it is desirable to find a way to change a cooling fan without interrupting the operation of a computer and without risking destruction of the CPU due to excessive heat.","One aspect of this invention provides a method for servicing a cooling system for an electronic device. The electronic device may be a CPU or a GPU in specific embodiments of the invention. The method comprises switching the electronic device from a normal operating mode wherein the electronic device generates heat to a reduced heat generating mode wherein the electronic device generates heat at a reduced rate; continuing to operate the electronic device in the reduced heat generating mode while the cooling system is being serviced; and, subsequently switching the electronic device from the reduced heat generating mode to the normal operating mode.","A further aspect of the invention provides a method for servicing apparatus which includes a cooling system for an electronic device. The method comprises operating the apparatus in a temperature control mode in which temperature rise in the electronic device is reduced; continuing to operate the apparatus in the temperature control mode while the cooling system is being serviced; and, subsequently switching the apparatus back to a normal operating mode. The temperature control mode is a mode in which the electronic device is operated in a reduced heat generating mode, supplementary active cooling is provided to the electronic device, or both.","Another aspect of the invention provides electronic apparatus comprising: a heat generating electronic device, which is a CPU or GPU in some embodiments of the invention; and a cooling system operational to cool the electronic device. In some embodiments of the invention the cooling system comprises a fan. The electronic apparatus comprises a maintenance procedure controller configured to switch the electronic device from a normal operating mode wherein the electronic device generates heat to a reduced heat generating mode wherein the electronic device generates heat at a reduced rate upon detection of a signal indicating that the cooling system is about to be serviced and to switch the electronic device from the reduced heat generating mode to the normal operating mode upon detection of a signal indicating that servicing of the cooling system has been completed. The maintenance procedure controller is a programmable data processor in some embodiments of the invention.","Further aspects of the invention and features of specific embodiments of the invention are described below.","Throughout the following description, specific details are set forth in order to provide a more thorough understanding of the invention. However, the invention may be practiced without these particulars. In other instances, well known elements have not been shown or described in detail to avoid unnecessarily obscuring the invention. Accordingly, the specification and drawings are to be regarded in an illustrative, rather than a restrictive, sense.","This invention provides methods for repairing or replacing cooling systems for data processing chips which do not require the data processing chips to be shut down throughout the repair or replacement procedure. The methods involve temporarily shifting the data processing chips into a mode in which the data processing chips are still operating and yet generate less heat during a period while the cooling system is not operating.","The following description describes the application of the invention to cooling fans for CPUs. The invention may also be applied to other types of data processing chips such as graphics processors and the like. The invention may further be applied in systems which include cooling systems other than, or in addition to, fans.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 1","b":["10","10","20","20","50","50","52","54","20","110","120","30","30","140","150","40"]},"Maintenance procedure controller  receives signals which indicate that a fan replacement procedure is commencing, or will imminently commence. In the illustrated embodiment, maintenance procedure controller  is connected to receive a Start Fan Replacement Procedure command . Maintenance personnel may cause command  to be issued through a user interface (e.g. textual command, GUI) or via a manual control (e.g. a button). Command  may, for example, originate at a console (not shown) which includes mechanisms for the overall administration of a system which includes processor . The system may include many other processors. For example, the system may be a multiprocessor computer system having, for example, several hundred CPUs.","Upon receiving command , maintenance procedure controller  commences performing a method  for permitting replacement of fan . Method  is shown in . Upon receiving signal , maintenance procedure controller  enters a mode in which it waits for an About to Replace Fan signal  from maintenance personnel. Signal  may be provided via a button or control panel on the computer in which processor  is located. Upon block  determining that a signal  has been received, maintenance procedure controller  sends a Decrease Clock Frequency signal  to clock controller  (block ). In response to signal , clock controller  reduces the frequency indicated by Desired Clock Frequency signal . In response to signal , clock generator  reduces the frequency of the clock signal  that it applies to CPU . CPU  generates less heat when the frequency of clock signal  is reduced. The reduced heat generation at least slows the rate at which the die temperature of CPU  increases.","While CPU  is in a reduced heat generation mode, service personnel can remove and replace fan  without the die temperature of CPU  rising so much that CPU  becomes damaged.","While fan  is being replaced, CPU  optionally provides a signal indicating the current CPU temperature  to maintenance procedure controller  (block ). Maintenance procedure controller  indicates the current CPU temperature to maintenance personnel as CPU temperature indication  (block ). Indication  may be audible, visual (either textual or graphical) or the like. For example, maintenance procedure controller  may display the CPU temperature in a user interface on a control panel (not shown) of the computer. The display may be provided by way of any suitable technology. For example, the display may include any of: LCD display panels, LED or LCD displays, GUIs, and the like. The display may be located in any suitable location. In some embodiments, the display is located in a position where it is visible to a technician who is viewing CPU  through an opening in a case within which the cooling system for CPU  is housed.","The displayed temperature may be continuously updated to show the slow rise in temperature that occurs without the cooling air flow provided by the cooling fan. In the alternative or in addition, maintenance procedure controller  may generate warning signals if certain temperature thresholds are exceeded. Maintenance procedure controller may monitor the current temperature of CPU  and a rate at which the temperature of CPU  is increasing and may calculate and display an estimated amount of time remaining before a temperature threshold is reached. The estimated amount of time remaining may be used by maintenance personnel to determine whether the fan replacement is proceeding quickly enough to be completed before the temperature of CPU  rises to an unacceptable level.","After maintenance personnel have replaced fan , a Finished Replacing Fan signal  is provided to maintenance procedure controller . Signal  may be provided by operating a button or control panel on the computer. In response to receiving signal , (as determined at block ) maintenance procedure controller  sends an Increase Clock Frequency signal  (block ) to clock controller . Clock controller  responds by sending a larger Desired Clock Frequency signal  to clock generator . Clock generator  increases the frequency of the clock signal  that it applies to CPU . Once CPU  starts operating at the higher clock frequency , it generates additional heat. Maintenance procedure controller  terminates the fan replacement procedure and optionally issues a Fan Replacement Procedure Completed signal . In some embodiments, signal  is provided to a control console remote from CPU .","While CPU  is being run in the reduced heat generation mode, the frequency of clock signal  is reduced to a low, but non-zero level. As a result, CPU  continues to execute software instructions during the procedure. In some embodiments of the invention, the frequency of the clock signal is reduced to 15% or less, and preferably to 10% or less of its normal value (i.e. the clock frequency is reduced by 85%, and preferably by 90% in switching from the normal operating mode to the reduced heat generating mode). For example, a normal 2.0 GHz clock signal applied to CPU  might be reduced to 100 MHz (5% of its normal value), or less while CPU  is being run in the reduced heat generation mode. For another example, in the normal operating mode the clock frequency may be in excess of 1.5 GHz and in the reduced heat generating mode the clock frequency may be less than 250 MHz.","While cooling fan  is removed, and CPU  is running in the reduced heat generation mode, the temperature of CPU  may continue to rise. Therefore, if the cooling fan is not replaced and put back into operation soon enough even at the reduced clock frequency the temperature of CPU  may rise to an unacceptable level. Most modern CPUs are equipped with thermal protection and will shut down if safe operating temperatures are exceeded. Where CPU  includes such thermal protection, if the maintenance personnel do not replace the cooling fan soon enough, CPU  will be shut down before it is damaged.","Maintenance procedure controller  may optionally be capable of causing CPU  to shut down. Maintenance procedure controller  may monitor a current CPU temperature . If CPU temperature  exceeds a threshold, then maintenance procedure controller  could send a signal to cause CPU  to be shut down. This functionality may be used to particular advantage in cases where CPU  does not have built-in over-temperature protection.","In the apparatus shown in , clock controller  and clock generator  are shown as being separate from CPU . These components could be combined in any suitable combination. By way of example only, clock controller  and clock generator  could be integrated with one another; one or both of clock controller  and clock generator  could be integrated with CPU .",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 3","b":["400","20","150","40","20","430","432","50","430","432","50","430","432","50","430","50","50","432","50","50","50","400","150"]},"As seen in , the periodic HALT  and RESUME  commands impose a duty cycle on clock signal . The result is that CPU  experiences an effective clock signal . In the example of , CPU  is only enabled for one out of every four pulses of clock signal  (i.e. effective clock signal  has a 25% duty cycle\u20143 out of 4 clock pulses have been removed leaving 1 out of 4 clock pulses). In this example, the stream of HALT and RESUME commands cause CPU  to run at 25% of its regular speed. Heat output is reduced. By varying the periodicity of the alternating HALT and RESUME commands, duty cycles of less than or greater than 25% can be achieved. In some embodiments of the invention, running CPU  in the reduced heat generation mode comprises applying HALT and RESUME commands such that the CPU operates at a duty cycle of 25% or less.","Returning to , during the fan replacement, temperature  may be monitored and displayed to the maintenance personnel, as described above. When maintenance procedure controller \u2032 receives a Finished Replacing Fan signal  from the maintenance personnel, maintenance procedure controller \u2032 returns CPU  to a full duty cycle clock signal (for example, by issuing a RESUME command and then ceasing issuing the stream of HALT and RESUME commands). The fan replacement procedure subsequently terminates.","The duty cycle of microprocessor  may be varied in other manners than by issuing HALT and RESUME commands. Existing microprocessors (e.g. Intel Pentium IV\u2122 and AMD Opteron\u2122) have built-in mechanisms for changing the duty cycle in increments of 12.5% as part of their support for the Advanced Configuration and Power Interface (ACPI) management standard. Periodically halting CPU  can provide finer control over the duty cycle of CPU  than is possible by using current ACPI functionality. In some embodiments of the invention, both built-in mechanisms, for example ACPI, and external mechanisms, for example toggling a signal applied to a HALT pin, are used in combination to achieve the reduced heat generating mode.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 5","FIG. 3"],"b":["500","20","400","500","60","500","510","70","70","430","432","512"]},"In block  a HALT command  is sent to CPU . Method  then waits in block  for an interval Tbefore sending a RESUME command  to CPU  in block . If block  determines that a Finished Replacing Fan signal  has been received from the maintenance personnel, then method  optionally sends a Fan Replacement Procedure Completed signal  and terminates. The CPU is running at full duty cycle as a result of the Resume command  issued in the most recent iteration of block .","If block  determines that signal  has not been received, method  proceeds to block  where a current CPU temperature  of CPU  is monitored. In block  method  displays the current CPU temperature. In block  method  waits for a period Tbefore continuing to block . Neglecting the time taken to execute blocks other than blocks  and , method  provides a duty cycle of approximately T\/(T+T).",{"@attributes":{"id":"p-0044","num":"0043"},"figref":["FIG. 6","FIG. 3"],"b":["600","400","600","20","430","432","50","20","430","432","612","612","612","430","432","50","430","432","20","612","612"]},"In some embodiments of the invention a computer system which houses CPU  or a computer system which is physically near to CPU  includes a software configurable control. Upon the receipt of Start Fan Replacement Procedure signal  the control is placed in a first mode such that a first activation of the control causes About to Replace Fan signal  to be generated. The first activation of the control directly or indirectly places the control in a second mode. When the control is in the second mode, activation of the control causes Finished Replacing Fan signal  to be generated.","In apparatus according to other embodiments of the invention About to Replace Fan signal  and\/or Finished Replacing Fan signal  are generated automatically in response to monitoring parameters relating to the fan. For example, upon the receipt of Start Fan Replacement Procedure signal , a maintenance procedure controller may monitor a current draw of the fan. If the fan current draw suddenly drops to zero (as would occur if a technician disconnected the fan from its power source in preparation for removing the fan) the maintenance procedure controller automatically generates About to Replace Fan signal  (for example, by interpreting the current drop as About to Replace Fan signal  or by causing a separate signal to be generated). When the fan current draw returns to a typical value (as would occur when the technician connects a replacement fan)\u2014or when the fan current draw returns to a typical value and the CPU temperature begins to level off or drop\u2014the maintenance procedure controller automatically generates Finished Replacing Fan signal . The portion of the maintenance procedure controller which monitors fan current draw may be physically separated from other parts of the maintenance procedure controller.","In apparatus according to other embodiments of the invention the About to Replace Fan signal  may be generated automatically in response to the opening of a service panel. For example, opening a service panel to access a cooling system for CPU  (e.g. fan ) may change the state of a microswitch which causes About to Replace Fan signal  to be generated.","In any of the implementations of the invention described above, the maintenance procedure controller may comprise: a suitably programmed data processor; hardware logic circuits, which may be provided in the form of an FPGA (Field Programmable Gate Array), ASIC (Application Specific Integrated Circuit), etc.; or some combination thereof. In some embodiments of the invention the functions of the maintenance procedure controller are provided by hardware, or hardware and software resident within a single integrated circuit. Where CPU  is part of a multi-processor computer system, the functions of the maintenance procedure controller may be provided by causing one of the other processors in the multi-processor computer system to act as the maintenance procedure controller.","As an example implementation of the invention, consider a multi-processor computer system  as shown in . System  has hundreds of CPUs  each cooled by a fan or other cooling system. CPUs  are distributed among a number of chassis  which are interconnected by a data communication network . Each chassis  may house one or several CPUs . Computer system  has a control console  which can communicate with each of the chassis. Maintenance staff decide that the cooling system of one CPU A requires replacement. A person at console  causes the console to issue a Start Fan Replacement Procedure to a maintenance procedure controller A associated with CPU A.","Maintenance procedure controller A is connected to detect a signal which results when maintenance personnel activate a control  associated with the chassis A in which CPU A is housed. In this example, control  is a pushbutton on chassis A. In response to the Start Fan Replacement Procedure signal, maintenance procedure controller A configures itself to interpret the signal resulting from the actuation of control  as an About to Replace Fan signal.","A technician proceeds to chassis A. The technician may access CPU A through a service panel  or other suitable opening. When the technician is ready to replace the cooling system for CPU A, the technician actuates control . Maintenance procedure controller A then causes CPU A to operate in a reduced heat generating mode and configures itself to recognize the next actuation of control  as a Finished Replacing Fan signal. The technician replaces or otherwise services the cooling system for CPU A. While the technician is servicing the cooling system for CPU A, maintenance procedure controller A causes the current temperature of CPU A and the estimated time remaining before the cooling system must be placed back in service or the CPU A shut down on a display  located where the technician can see it.","When the technician completes servicing the cooling system for CPU A, the technician actuates control  again. This causes maintenance procedure controller A to place CPU A in its normal operating mode and to send a Fan Replacement Completed signal back to console  where it can be logged.","Commands and other signals may be implemented in any suitable manner including by way of technologies such as:\n\n","Certain implementations of the invention comprise computer processors which execute software instructions which cause the processors to perform a method of the invention. For example, the maintenance procedure controllers in any of the embodiments described herein may comprise one or more processors executing software commands which cause the processors to implement methods of the invention such as, for example, the methods of  or . The invention may also be provided in the form of a program product. The program product may comprise any medium which carries a set of computer-readable signals comprising instructions which, when executed by a data processor, cause the data processor to execute a method of the invention. Program products according to the invention may be in any of a wide variety of forms. The program products may comprise, for example, physical media such as magnetic data storage media including floppy diskettes, hard disk drives, optical data storage media including CD ROMs, DVDs, electronic data storage media including ROMs, flash RAM, or the like or transmission-type media such as digital or analog communication links.","Where a component (e.g. a software module, processor, assembly, device, circuit, etc.) is referred to above, unless otherwise indicated, reference to that component (including a reference to a \u201cmeans\u201d) should be interpreted as including as equivalents of that component any component which performs the function of the described component (i.e., that is functionally equivalent), including components which are not structurally equivalent to the disclosed structure which performs the function in the illustrated exemplary embodiments of the invention.","As will be apparent to those skilled in the art in light of the foregoing disclosure, many alterations and modifications are possible in the practice of this invention without departing from the spirit or scope thereof. For example:\n\n","Accordingly, the scope of the invention is to be construed in accordance with the substance defined by the following claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["In drawings which illustrate non-limiting embodiments of the invention,",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
