---
title: Computing correlated aggregates over a data stream
abstract: Described herein are approaches for computing correlated aggregates. An aspect provides for receiving a stream of data elements at a device, each data element having at least one numerical attribute; maintaining in memory plurality of tree structures comprising a plurality of separate nodes for summarizing numerical attributes of the data elements with respect to a predicate value of a correlated aggregation query, said maintaining comprising: creating the plurality of tree structures in which each node implements one of: a probabilistic counter and a sketch, wherein said probabilistic counter and said sketch each act to estimate aggregated data element numerical attributes to form a summary of said numerical attributes; and responsive to a correlated aggregation query specifying said predicate value, using said plurality of tree structures as a summary of said data element numerical attributes to compute a response to said correlated aggregate query.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08645412&OS=08645412&RS=08645412
owner: International Business Machines Corporation
number: 08645412
owner_city: Armonk
owner_country: US
publication_date: 20111021
---

{"@attributes":{"id":"description"},"GOVINT":[{},{}],"heading":["STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND","BRIEF SUMMARY","DETAILED DESCRIPTION"],"p":["This invention was made with government support under grant numbers CNS0834743 and CNS0831903, awarded by the National Science Foundation. The government has certain rights in the invention.","The subject matter presented herein generally relates to efficiently computing correlated aggregates over a data stream.","Processing a massive data set presented as a large data stream is challenging. The data set may be, for example, network traffic data or streaming data from external memory. A difficulty encountered is that the data set is too large to store in cache for analysis. Because of the size of the data set, processing requires fast update time, use of very limited storage, and possibly only a single pass over the data.","In computing statistics for certain types of data set analysis, a problem is the correlated aggregate query problem. Here, unlike in traditional data streams, there is a stream of two dimensional data items (i,y), where i is an item identifier, and y is a numerical attribute. A correlated aggregate query requires first applying a selection predicate along the y dimension, followed by an aggregation along the first dimension. An example of a correlated query is: \u201cOn a stream of IP packets, compute the k-th frequency moment of all the source IP address fields among packets whose length was more than 100 bytes\u201d. Answering such a query may for example allow a network administrator to identify IP addresses using an excessive amount of network bandwidth.","One aspect provides a method for summarizing attributes of data elements of a data set for computing correlated aggregates, comprising: receiving a stream of data elements at a device, each data element having at least one numerical attribute; maintaining in memory a plurality of tree structures comprising a plurality of separate nodes for summarizing numerical attributes of the data elements with respect to a predicate value of a correlated aggregation query, said maintaining comprising: creating the plurality of tree structures in which each node implements one of: a probabilistic counter and a sketch, wherein said probabilistic counter and said sketch each act to estimate aggregated data element numerical attributes to form a summary of said numerical attributes; and responsive to a correlated aggregation query specifying said predicate value, using said plurality of tree structures as a summary of said data element numerical attributes to compute a response to said correlated aggregate query.","Another aspect provides a computer program product for summarizing attributes of data elements of a data set for computing correlated aggregates, comprising: a computer readable storage medium having computer readable program code embodied therewith, the computer readable program code comprising: computer readable program code configured to receive a stream of data elements at a device, each data element having at least one numerical attribute; computer readable program code configured to maintain in memory a plurality of tree structures comprising a plurality of separate nodes for summarizing numerical attributes of the data elements with respect to a predicate value of a correlated aggregation query, wherein to maintain further comprises: computer readable program code configured to create the plurality of tree structures in which each node implements one of: a probabilistic counter and a sketch, wherein said probabilistic counter and said sketch each act to estimate aggregated data element numerical attributes to form a summary of said numerical attributes; and computer readable program code configured to, responsive to a correlated aggregation query specifying said predicate value, use said plurality of tree structures as a summary of said data element numerical attributes to compute a response to said correlated aggregate query.","A further aspect provides a system for summarizing attributes of data elements of a data set for computing correlated aggregates, comprising: at least one processor; and a memory device operatively connected to the at least one processor; wherein, responsive to execution of program instructions accessible to the at least one processor, the at least one processor is configured to: receive a stream of data elements at a device, each data element having at least one numerical attribute; maintain in memory a plurality of tree structures comprising a plurality of separate nodes for summarizing numerical attributes of the data elements with respect to a predicate value of a correlated aggregation query, wherein to maintain further comprises: create the plurality of tree structures in which each node implements one of: a probabilistic counter and a sketch, wherein said probabilistic counter and said sketch each act to estimate aggregated data element numerical attributes to form a summary of said numerical attributes; and responsive to a correlated aggregation query specifying said predicate value, use said plurality of tree structures as a summary of said data element numerical attributes to compute a response to said correlated aggregate query.","The foregoing is a summary and thus may contain simplifications, generalizations, and omissions of detail; consequently, those skilled in the art will appreciate that the summary is illustrative only and is not intended to be in any way limiting.","For a better understanding of the embodiments, together with other and further features and advantages thereof, reference is made to the following description, taken in conjunction with the accompanying drawings. The scope of the invention will be pointed out in the appended claims.","It will be readily understood that the components of the embodiments, as generally described and illustrated in the figures herein, may be arranged and designed in a wide variety of different configurations in addition to the described example embodiments. Thus, the following more detailed description of the example embodiments, as represented in the figures, is not intended to limit the scope of the claims, but is merely representative of those embodiments.","Reference throughout this specification to \u201cembodiment(s)\u201d (or the like) means that a particular feature, structure, or characteristic described in connection with the embodiment is included in at least one embodiment. Thus, appearances of the phrases \u201caccording to embodiments\u201d or \u201can embodiment\u201d (or the like) in various places throughout this specification are not necessarily all referring to the same embodiment.","Furthermore, the described features, structures, or characteristics may be combined in any suitable manner in different embodiments. In the following description, numerous specific details are provided to give a thorough understanding of example embodiments. One skilled in the relevant art will recognize, however, that aspects can be practiced without certain specific details, or with other methods, components, materials, et cetera. In other instances, well-known structures, materials, or operations are not shown or described in detail to avoid obfuscation.","On a stream of two dimensional data items (i,y) where i is an item identifier, and y is a numerical attribute, a correlated aggregate query requires applying a selection predicate first along the second dimension, y, followed by an aggregation along the first dimension. For selection predicates of the form (y<c) or (y>c), where parameter c is provided at query time, embodiments provide streaming processing and lower bounds for estimating statistics of the resulting substream of elements that satisfy the predicate.","For example, an embodiment can answer the following query: \u201cOn a stream of IP packets, compute the k-th frequency moment F(k=0, 1, 2 or greater) of all the source IP address fields among packets whose length was more than 100 bytes\u201d. A process according to an embodiment for F(basic count) improves previous approaches by roughly a logarithmic factor and is near-optimal. An approach provided according to embodiments for k\u22601 provides the first sublinear space algorithms in this model for these problems. Embodiments also estimate heavy hitters, rarity, and similarity in this model. The memory requirements are significantly smaller than existing linear storage schemes for large data sets, and embodiments simultaneously achieve fast per-record processing time.","The description now turns to the figures. The illustrated example embodiments will be best understood by reference to the figures. The following description is intended only by way of example and simply illustrates certain example embodiments representative of the invention, as claimed.","Referring to , consider a data stream (data set\/stream are used interchangeably herein) of tuples S=(x,y) i=1 . . . n, where xis an item identifier, and ya numerical attribute. A correlated aggregate query C(\u03c3,AGG,S) specifies two functions, a selection predicate \u03c3 along the y dimension. It requires that the selection be applied first on stream S, followed by the aggregation. More formally,\n\n(\u03c3,)=|\u03c3()is true}\n","Importantly, the selection predicate \u03c3 need only be completely specified at query time, and may not be known when the stream is being observed. For example, on a stream of IP packets, with x denoting the source IP address, and y denoting the number of bytes in the packet, on an observed packet stream, a network administrator may ask the query: \u201cWhat is the second frequency moment (F) of all IP addresses for those packets that are less than 1000 bytes\u201d? The selection predicate \u03c3=(y<1000) is completely specified only at query time, giving the network administrator flexibility to perform further queries based on the result of previous queries. For example, if the answer for the above query was \u201cinteresting\u201d (however defined), the network administrator may then refine the next query further by asking for the same aggregate, but giving a different selection predicate, for example \u03c3=(y<500). Note that with this framework, the network administrator could form the query: \u201cWhat is the Fof all IP addresses for those packets whose packet size is smaller than the mean packet size of the stream\u201d, by first determining the mean packet size, say \u03bc, using an aggregated query with section predicate y<\u03bc.","A traditional data stream summary provides an accurate answer to an aggregate query, such as frequency moments, quantiles, and heavy-hitters, over the entire data stream. In contrast, a summary for correlated aggregate provides accurate answers to a family of queries that can be posed on the stream, where different queries in the family specify the same aggregation function, but over different subsets of the input stream. These subsets are selected by the predicate along the primary dimension. Correlated aggregates arise naturally in analytics on multi-dimensional streaming data, and space-efficient methods for implementing such aggregates are useful in streaming analytics systems such as in IBM SYSTEM S.","The summaries for correlated aggregates provided by embodiments allow for more flexible interrogation of the data stream than is possible with a traditional stream summary. For example, consider a data stream of IP flow records, such as those output by network routers equipped with CISCO netflow. Suppose that one is interested in only two attributes per flow record, the destination address of the flow, and the size (number of bytes) of the flow. Using a summary for correlated aggregate AGG, along with a quantile summary for the y dimension (any well known stream quantile summaries may be used), it is possible for a network administrator to execute the following sequence queries on the stream:","(1) First, the quantile summary can be queried to find the median size of the flow. (2) Next, using the summary for correlated aggregates, the network administrator can query the aggregate AGG of all those flow records whose flow size was more than the median flow size. (3) If the answer to query (2) was abnormal in the network administrator's opinion, and the network administrator needed to find properties of the very high volume flows, this may be accomplished by querying for the aggregate of all those flow records whose flow size is in, for example, the 95 percent quantile or above (the 95 percent quantile may be found using the quantile summary).","Thus, a summary that allows for such queries can be used for deeper investigation of larger data streams. Important to this is the flexibility that the parameter for the selection predicate can be specified at query time, which allows the user to iteratively adapt his or her query based on the results of previous queries. For data-intensive analytics systems, such as network management systems and sensor data management, this can be a very powerful tool.","In this description, both processing and lower bounds for summarizing data streams for correlated aggregate queries are provided. Embodiments consider selection predicates of the form (y\u2266y) or (y\u2267y), where yis specified at query time.","Estimation of Basic Count (F)","For estimating the basic count, the x values of the stream elements (x,y) do not matter, hence only considered is the stream Y=y, y, . . . , y. The y's may not be distinct, and do not necessarily arrive in increasing order. The problem is to design a summary that can answer the following query: given a parameter y provided at query time, how many y's are less than or equal to y? In other words, estimate COUNT(y)=|{y\u03b5Y|y<y}|. Given user parameters \u03b5,0<\u03b5<1 and \u03b4,0<\u03b4<1, an embodiment seeks an answer that is within an \u03b5 relative error of the exact answer with probability at least 1\u2212\u03b4.","The starting point for a solution is the \u201csplittable histogram\u201d data structure of prior work. This data structure stores histograms at multiple levels, i=0, 1, 2, . . . , such that the error due to using a data structure at level i is proportional to 2, but as i increases, the set of possible queries that can be answered by the data structure at level i also become larger. The rough intuition here is that if a data structure is used at a large level (a large value of i), though the error is large (proportional to 2), the answer must also be large, hence the relative error is controlled.","It is noted that that the data structures in prior work use many counters that may need to hold very large values. Observe that these counts need not be exact, and hence an embodiment uses probabilistic counters, which provide approximate counts of large numbers using significantly smaller space than exact counters. The error in the counters and the error in the data structures combine to give the total error in the estimate.","There is a technical difficulty in getting the above idea to work, which is that the states of the counters are used to trigger certain actions of the data structures, such as the formation of new nodes in the data structure. Replacing these counters with probabilistic counters leads to dealing with random variables and events that are not all independent of each other, and this dependency has to be handled carefully. Presented herein are further details of the process for doing this and the analysis.","Probabilistic Counters","A probabilistic counter is a data structure for approximate counting that supports two operations: increment and query. For positive integer M and \u03b3>0, let PC(M,\u03b3) denote a probabilistic counter with base (1+\u03b3), that counts until a maximum estimated value of M. Let Cdenote the state of the counter after n increment operations. Using C, it is possible to return an estimate {circumflex over (n)} of n. If {circumflex over (n)}\u2267M, the counter cannot be incremented any further, and the counter is said to be \u201cclosed\u201d. If {circumflex over (n)}<M, then the bucket is said to be \u201copen\u201d.","Theorem 1:","Let {circumflex over (n)} denote the estimated count returned by the counter PC(M,\u03b3) after n increments. Then",{"@attributes":{"id":"p-0043","num":"0042"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"^"}}},"mo":"=","mi":"n"},{"mrow":[{"mi":"and","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"^"}}}},{"mfrac":{"mrow":{"mi":"\u03b3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"n","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"n","mo":"+","mn":"1"}}}},"mn":"2"},"mo":"."}],"mo":"="}],"mo":","}}},"br":{}},{"@attributes":{"id":"p-0044","num":"0043"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["log","log","M"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]},{"mi":"log","mo":"\u2062","mfrac":{"mn":"1","mi":"\u03b3"}}],"mo":"+"}}}},"br":{}},"The above theorem concerns the estimates returned by the probabilistic counter. The number of increments needed for the counter to reach its maximum value need to be analyzed, so a slightly different type of guarantee is required.","Lemma 1:","For C=PC(M,\u03b3), let I(C) denote the number of insertions into C that causes it to be closed. Then E[I(C)]=M+1, and",{"@attributes":{"id":"p-0048","num":"0047"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"\u2110","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"C"}}}},{"mfrac":{"mrow":{"mi":"\u03b3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"M","mo":"+","mn":"1"}}}},"mn":"2"},"mo":"."}],"mo":"="}}},"br":{}},"Data Structure","The data structure consists of histograms S, S, . . . , S, where l=log(2\u03b5U), where U is an upper bound on the value of COUNT(y) for any value of y. Each histogram Sconsists of no more than",{"@attributes":{"id":"p-0051","num":"0050"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"\u03b1","mo":"=","mfrac":{"mrow":{"mn":"4","mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}},"mo":"+","mn":"1"}}},"mi":"\u03b5"}}}},"br":{}},"Each bucket b\u03b5Sis a probabilistic counter",{"@attributes":{"id":"p-0053","num":"0052"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"PC","mo":["(",")"],"mrow":{"mrow":{"msup":{"mn":"2","mi":"i"},"mo":"+","mn":"1"},"mo":",","mfrac":{"mrow":{"msup":{"mi":"\u03b5","mn":"2"},"mo":"\u2062","mi":"\u03b4"},"mi":"\u03b1"}}},"mo":"."}}},"br":{},"sub":"i "},"Every bucket is responsible for a range of y values, which is represented implicitly by the position of the bucket in the tree. The \u201cspan\u201d of a bucket b is the range of timestamps that the bucket b is responsible for. The span of the root of the tree is [0,y]. If the span of node \u03bd is [y,y], then the span of its left child is [y,(y+y\u22121)\/2], and the span of its right child is [(y+y+1)\/2,y]. In a given level l, the span of all buckets at the same depth in the tree are disjoint, but the span of buckets at different depth may overlap with each other. If they do overlap, then the span of one of the buckets must be a proper subset of the span of the other (overlapping) bucket. Each bucket has a probabilistic counter associated with it.","For bucket b, let span(b) denote the span of the bucket. Let left(b) denote the leftmost endpoint of span(b), and right(b) denote the rightmost endpoint of span(b). Let PC(b) to denote the counter associated with the bucket. The process for COUNT is illustrated in .","Lemma 2:","The space complexity of the data structure for Fis",{"@attributes":{"id":"p-0058","num":"0057"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"O","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mfrac":{"mn":"1","mi":"\u03b5"},"mo":["\u2062","\u2062","\u2062"],"mrow":[{"mo":["(",")"],"mrow":{"mi":["log","\u03b5","U"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}},{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}},{"mo":["(",")"],"mrow":{"mrow":[{"mi":["log","log","U"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"mi":"log","mo":"\u2062","mfrac":{"mn":"1","mi":"\u03b5"}},{"mi":"log","mo":"\u2062","mfrac":{"mn":"1","mi":"\u03b4"}}],"mo":["+","+"]}}]}}}}},"br":{},"sub":"max","sup":"2 "},"Proof: The space complexity is the space taken to store O(l\u03b1) buckets. Each bucket b consists of a probabilistic counter PC(M,\u03b5\u03b4\/\u03b1), where the value of M is no more than U. The space complexity of the data structure follows from Theorem 1.","Definition 1: For l=0 . . . l, level l is defined to be incomplete for query y if T<y. If T\u2267y, then level l is said to be complete for query y.","For bucket b, let A(b) denote the number of stream items that were inserted into this bucket. Let EST (b) denote the current estimate of the number of items that were inserted into the bucket. This notation is extended to sets of buckets too. For any set of buckets B, all in the same level, let",{"@attributes":{"id":"p-0062","num":"0061"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munder":{"mo":"\u2211","mrow":{"mi":["b","B"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}],"mo":"="},"mo":","}}},"br":{}},{"@attributes":{"id":"p-0063","num":"0062"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"\u2130\ud835\udcae\ud835\udcaf","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munder":{"mo":"\u2211","mrow":{"mi":["b","B"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mrow":{"mi":"\u2130\ud835\udcae\ud835\udcaf","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},"mo":"."}}],"mo":"="}}}},"Lemma 3","Let Ibe any set of internal nodes in S. Then EST (I)=2|I|, E[A(I)]=2|I|, and",{"@attributes":{"id":"p-0066","num":"0065"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}},{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}}],"mo":"-"}},{"mi":"\u03b5","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}}}],"mo":">"}}},{"mfrac":{"mi":"\u03b4","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"msub":{"mi":["I","l"]}}}},"mo":"."}],"mo":"<"}}}},"Proof: For any b\u03b5I, there is EST(b)=l2. Since",{"@attributes":{"id":"p-0068","num":"0067"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}},{"munder":{"mo":"\u2211","mrow":{"mi":"b","mo":"\u2208","msub":{"mi":["I","l"]}}},"mo":"\u2062","mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}],"mo":"="},"mo":","}}},"br":{},"sub":["l","l"],"sup":["l","l","l"]},{"@attributes":{"id":"p-0069","num":"0068"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}},{"mfrac":{"mrow":{"msup":{"mi":["\u03b32","l"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mn":"2","mi":"l"},"mo":"-","mn":"1"}}},"mn":"2"},"mo":"."}],"mo":"="}}}},{"@attributes":{"id":"p-0070","num":"0069"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}},{"munder":{"mo":"\u2211","mrow":{"mi":"b","mo":"\u2208","msub":{"mi":["I","l"]}}},"mo":"\u2062","mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}],"mo":"="}}}},"Using linearity of expectation yields:",{"@attributes":{"id":"p-0072","num":"0071"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["I","l"]}}}}},{"mrow":[{"munder":{"mo":"\u2211","mrow":{"mi":"b","mo":"\u2208","msub":{"mi":["I","l"]}}},"mo":"\u2062","mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}}},{"msup":{"mn":"2","mi":"l"},"mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"msub":{"mi":["I","l"]}}}],"mo":"="}],"mo":"="}}}},"For each bucket b\u03b5I,",{"@attributes":{"id":"p-0074","num":"0073"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},"mo":"-","msup":{"mn":"2","mi":"l"}}},"mo":">","msup":{"mi":["\u03b52","l"]}}}},"mo":["\u2264","\u2264"],"mfrac":[{"mrow":[{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}},{"msup":[{"mi":"\u03b5","mn":"2"},{"mn":"2","mrow":{"mn":"2","mo":"\u2062","mi":"l"}}],"mo":"\u2062"}]},{"mi":"\u03b3","mrow":{"mn":"2","mo":"\u2062","msup":{"mi":"\u03b5","mn":"2"}}}]}}}},"Using a union bound over all the buckets, and using",{"@attributes":{"id":"p-0076","num":"0075"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"\u03b3","mo":"=","mfrac":{"mrow":{"msup":{"mi":"\u03b5","mn":"2"},"mo":"\u2062","mi":"\u03b4"},"mi":"\u03b1"}},"mo":","}}},"br":{}},"Lemma 4:","Let L be any set of leaves in S, Then E[EST (L)]=A(L), and\n\n()\u2212()|>\u03b5()]<\u03b4\n","Proof: For any b\u03b5L, there is E[EST(b)]=A(B), from Theorem 1. Using Linearity of Expectation,",{"@attributes":{"id":"p-0080","num":"0079"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}},{"mi":"E","mo":["[","]"],"mrow":{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}}}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":[{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}],"mo":"="}}}}]}}}},"For the leaves, after the actual counts A(b)'s have been assigned, the random variables EST(b)'s are all independent. Hence:",{"@attributes":{"id":"p-0082","num":"0081"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}},{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}}}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mfrac":{"mrow":{"mi":"\u03b3","mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},{"mo":["(",")"],"mrow":{"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},"mo":"+","mn":"1"}}]},"mn":"2"}}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mfrac":{"mi":"\u03b3","mn":"2"},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}},{"munder":{"mo":"\u2211","mrow":{"mi":["b","L"],"mo":"\u2208"}},"mo":"\u2062","mrow":{"msup":{"mi":"A","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}],"mo":"+"}}}}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062","\u2264"],"mi":{},"mrow":[{"mfrac":{"mi":"\u03b3","mn":"2"},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}},{"msup":{"mi":"A","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}],"mo":"+"}}},{"mi":"\u03b3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msup":{"mi":"A","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}]}}}]}}}},"Applying Chebyshev's inequality:",{"@attributes":{"id":"p-0084","num":"0083"},"maths":{"@attributes":{"id":"MATH-US-00018","num":"00018"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"mrow":[{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}],"mo":"-"}},{"mi":"\u03b5","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}],"mo":">"}}},"mo":["\u2264","\u2264","<"],"mfrac":[{"mrow":[{"mi":"VAR","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}},{"msup":{"mi":"\u03b5","mn":"2"},"mo":"\u2062","mrow":{"msup":{"mi":"A","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"L"}}}]},{"mi":"\u03b3","msup":{"mi":"\u03b5","mn":"2"}}],"mi":"\u03b4"}}}},"Lemma 5:","If level l is incomplete for query y, then with probability at least",{"@attributes":{"id":"p-0087","num":"0086"},"maths":{"@attributes":{"id":"MATH-US-00019","num":"00019"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mn":"1","mo":"-","mfrac":{"mi":"\u03b4","mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}},"mo":","}}},"br":{},"in-line-formulae":[{},{}],"i":"y","sup":"l\u22121"},"Proof: Since T\u2266y, for each bucket b\u03b5S, it must be true that right(b)<y. Thus each item that was inserted into bucket b in Smust be contained in query y. Let Sdenote the internal nodes in S.\n\nCOUNT()\u2267()\u2267()\n","Using Lemma 3, the following is true with probability at least",{"@attributes":{"id":"p-0090","num":"0089"},"maths":{"@attributes":{"id":"MATH-US-00020","num":"00020"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mn":"1","mo":"-","mrow":{"mfrac":{"mi":"\u03b4","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"msubsup":{"mi":["S","l"],"mn":"1"}}}},"mo":"."}}}},"br":{},"in-line-formulae":[{},{}],"i":["A","S","E[EST","S","|S"],"sub":["l","l","l"],"sup":["1","1","l","1"]},"Since Sis a binary tree with \u03b1 nodes, there are (\u03b1\u22121)\/2 nodes in S. Thus,",{"@attributes":{"id":"p-0092","num":"0091"},"maths":{"@attributes":{"id":"MATH-US-00021","num":"00021"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mo":["(",")"],"mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}],"mo":["\u2062","\u2062"],"msup":{"mn":"2","mrow":{"mi":"l","mo":"-","mn":"1"}}}],"mo":">"}}},{"mn":"1","mo":"-","mfrac":{"mi":"\u03b4","mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}}],"mo":">"}}}},"Lemma 6:","The estimate returned for COUNT(y) by process 3 has a relative error of less than 7\u03b5 with probability at least 1\u22124\u03b4.","Proof: Suppose the process uses level l for its estimate. Let BS denote the set of all nodes b\u03b5Ssuch that the span of b is a subset of [0,y]. The estimator uses the sum of the estimated counts of all nodes in B. Let BBdenote the internal nodes in B, and BBdenote the leaves in B. Let CO\u00dbNT(y) denote the estimate returned by the process. Let BSdenote the set of all buckets b\u03b5Ssuch that the span of b intersects [0,y], but is not a subset of [0,y].\n\nCOU{circumflex over (N)}T()=()=()+()\n\n()\u2266COUNT()\u2266()+()\u2003\u2003(1)\n","The following events are defined:\n\n\u03b5is ()\u2266(1+\u03b5)(log )2\n\n\u03b5is COUNT()\u2267(1\u2212\u03b5)2(\u03b1\u22121)\n\n\u03b5is ()\u2267(1\u2212\u03b5)()\n\n\u03b5is ()\u2267(1\u2212\u03b5)()\n","First consider \u03b5. Bounding A(B), each bucket in Bmust span y. There can be no more than log ybuckets in Sthat can span y, and each such bucket, except for the smallest bucket, must be an internal node of S. Let \u0192denote the leaf bucket in B, if it exists (note that \u0192may not exist). Let B\u2032 denote the internal buckets in B. If \u0192does not exist, then A(\u0192) is defined to be 0.\n\n()=(\u0192)+(\u2032)\n","From Lemma 3, E[A(B\u2032)]=2|B\u2032|, and",{"@attributes":{"id":"p-0099","num":"0098"},"maths":{"@attributes":{"id":"MATH-US-00022","num":"00022"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","\u2032"],"mn":"2"}}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},{"mo":["\uf603","\uf604"],"msubsup":{"mi":["B","\u2032"],"mn":"2"}}],"mo":["\u2062","\u2062"],"msup":{"mn":"2","mi":"l"}}],"mo":">"}}},"mo":"<","mfrac":{"mi":"\u03b4","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"msubsup":{"mi":["B","\u2032"],"mn":"2"}}}}}},{"mrow":{"mo":["(",")"],"mn":"2"}}]}}}}},"Next, it is shown that A(\u0192) is small, with high probability. If \u0192does not exist, then A(\u0192)=0, so it can be assumed that \u0192exists. In such a case, \u0192cannot be a singleton bucket, since then its span would have been completely contained within [0,y]. Consider I(\u0192), which is the number of stream items that need to be inserted into \u0192to close the counter. From Lemma 3: Pr[|Y(\u0192)\u22122|>\u03b52]\u2266\u03b4. Thus, with probability at least (1\u2212\u03b4), it must be true that Y(\u0192)<(1+\u03b5)2. Consequently:\n\n(\u0192)>(1+\u03b5)2]\u2266\u03b4\u2003\u2003(3)\n","Let \u03b5denote the event A(B)\u2266(1+\u03b5)2|B\u2032| and \u03b5denote the event A(\u0192)>(1+\u03b5)2. From Equations 2 and 3:",{"@attributes":{"id":"p-0102","num":"0101"},"maths":{"@attributes":{"id":"MATH-US-00023","num":"00023"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msub":[{"mi":"\u2130","mn":"5"},{"mi":"\u2130","mn":"6"}],"mo":"\u22c0"}}},{"mn":"1","mo":["-","-"],"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"msub":{"mi":"\u2130","mn":"5"},"mi":"_"}}},{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"msub":{"mi":"\u2130","mn":"6"},"mi":"_"}}}]},{"mn":"1","mo":["-","-"],"mi":"\u03b4","mfrac":{"mi":"\u03b4","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"msubsup":{"mi":["B","\u2032"],"mn":"2"}}}}},{"mn":"1","mo":"-","mrow":{"mn":"1.5","mo":"\u2062","mi":"\u03b4"}}],"mo":["\u2265","\u2265","\u2265"]}}}},"Since |B\u2032|<log y, Pr[A(B)>(1+\u03b5)(log y)2]<1.5\u03b4. Thus:\n\n]>1\u22121.5\u03b4\u2003\u2003(4)\n","From Lemma 5:",{"@attributes":{"id":"p-0105","num":"0104"},"maths":{"@attributes":{"id":"MATH-US-00024","num":"00024"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"msub":{"mi":"\u2130","mn":"2"}}},{"mn":"1","mo":"-","mfrac":{"mi":"\u03b4","mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}}],"mo":"\u2265"}},{"mrow":{"mo":["(",")"],"mn":"5"}}]}}}}},"Since Bis a set of internal nodes in S, from Lemma 3,",{"@attributes":{"id":"p-0107","num":"0106"},"maths":{"@attributes":{"id":"MATH-US-00025","num":"00025"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"msub":{"mi":"\u2130","mn":"3"}}},{"mi":"Pr","mo":"[","mrow":{"mrow":[{"mi":"\u2130\ud835\udcae\ud835\udcaf","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}}],"mo":"\u2062"},{"mn":"1","mo":"-","mrow":{"mfrac":{"mi":"\u03b4","mn":"2"},"mo":"."}}],"mo":["\u2265","\u2265","\u2265"],"mfrac":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}},{"mn":"1","mo":"+","mi":"\u03b5"}]}}}],"mo":"="}}},"br":{}},{"@attributes":{"id":"p-0108","num":"0107"},"maths":{"@attributes":{"id":"MATH-US-00026","num":"00026"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"msub":{"mi":"\u2130","mn":"3"}}},{"mn":"1","mo":"-","mfrac":{"mi":"\u03b4","mn":"2"}}],"mo":"\u2265"}},{"mrow":{"mo":["(",")"],"mn":"6"}}]}}}}},"From Lemma 4,\n\n]>1\u2212\u03b4\u2003\u2003(7)\n","Suppose that \u03b5, \u03b5, \u03b5, \u03b5were true. From Equations 4-7, this is true with probability at least",{"@attributes":{"id":"p-0111","num":"0110"},"maths":{"@attributes":{"id":"MATH-US-00027","num":"00027"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mn":"1","mo":["-","-","-","-"],"mi":"\u03b4","mrow":[{"mn":"0.5","mo":"\u2062","mi":"\u03b4"},{"mn":"1.5","mo":"\u2062","mi":"\u03b4"}],"mfrac":{"mi":"\u03b4","mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}},{"mn":"1","mo":"-","mrow":{"mn":"4","mo":"\u2062","mrow":{"mi":"\u03b4","mo":"."}}}],"mo":"\u2265"}}}},{"@attributes":{"id":"p-0112","num":"0111"},"maths":{"@attributes":{"id":"MATH-US-00028","num":"00028"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"COU","mo":["\u2062","\u2062","\u2062"],"mover":{"mi":"N","mo":"^"},"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"T","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}},{"mrow":[{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}},{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","L"],"mn":"1"}}}],"mo":"+"}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["\u2265","\u2062"],"mi":{},"mrow":{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}}],"mo":"\u2062"},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","L"],"mn":"1"}}},{"mo":["(",")"],"mn":"9"}],"mo":["\u2062","\u2062"]}],"mo":"+"}}}},{"mtd":{"mrow":{"mo":["\u2265","\u2062"],"mi":{},"mrow":{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mo":["(",")"],"mn":"10"}],"mo":["\u2062","\u2062"]}}}}]}},{"mrow":{"mo":["(",")"],"mn":"8"}}]}}}}},{"@attributes":{"id":"p-0113","num":"0112"},"maths":{"@attributes":{"id":"MATH-US-00029","num":"00029"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"2"}}}],"mo":"+"},{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}}],"mo":["\u2062","\u2062"],"msup":{"mn":"2","mi":"\u2113"}}],"mo":"+"}],"mo":["\u2264","\u2264"]},"mo":","}}},"br":{},"sub":"1 "},{"@attributes":{"id":"p-0114","num":"0113"},"maths":{"@attributes":{"id":"MATH-US-00030","num":"00030"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mrow":{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},"mo":"\u2062","mfrac":{"mrow":[{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},"mo":["\u2062","\u2062","\u2062","\u2062"],"msup":{"mn":"2","mi":"l"},"mi":"log","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mo":["(",")"],"mrow":{"mi":"\u03b1","mo":"-","mn":"1"}}],"mo":["\u2062","\u2062"],"msup":{"mn":"2","mrow":{"mi":"l","mo":"-","mn":"1"}}}]}}],"mo":"+"},"mo":","}}},"br":{},"sub":"2 "},{"@attributes":{"id":"p-0115","num":"0114"},"maths":{"@attributes":{"id":"MATH-US-00031","num":"00031"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mfrac":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}}},{"mn":"2","mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}}}]},"mo":"\u2062","mrow":{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}}],"mo":"+"},"mo":","}}},"br":{}},{"@attributes":{"id":"p-0116","num":"0115"},"maths":{"@attributes":{"id":"MATH-US-00032","num":"00032"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"\u03b1","mo":"=","mrow":{"mfrac":{"mn":"4","mi":"\u03b5"},"mo":"\u2062","mrow":{"mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":"y","mrow":{"mo":"\u2009","mi":"max"}}},"mo":"+","mn":"1"}},"mo":"."}}}}},"br":{}},{"@attributes":{"id":"p-0117","num":"0116"},"maths":{"@attributes":{"id":"MATH-US-00033","num":"00033"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mfrac":{"mn":"1","mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},"mo":"\u2264","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mi":"\u03b5"}}}},"mo":","}}},"br":{}},{"@attributes":{"id":"p-0118","num":"0117"},"maths":[{"@attributes":{"id":"MATH-US-00034","num":"00034"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mfrac":{"mrow":[{"mn":"1","mo":"+","mi":"\u03b5"},{"mn":"1","mo":"-","mi":"\u03b5"}]},"mo":["\u2264","\u2062","\u2264"],"mi":{},"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mi":"\u03b5"}}},{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}}],"mo":"\u2062"},{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"4","mo":"\u2062","mi":"\u03b5"}}}]}}},{"@attributes":{"id":"MATH-US-00034-2","num":"00034.2"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mfrac":{"mrow":{"mo":["(",")"],"mrow":{"mi":"\u03b5","mo":"+","mrow":{"mn":"4","mo":"\u2062","msup":{"mi":"\u03b5","mn":"2"}}}},"mn":"2"},"mo":"\u2062","mrow":{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}}],"mo":"+"}],"mo":["\u2264","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062"],"mi":{},"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mfrac":{"mrow":{"mn":"3","mo":"\u2062","mi":"\u03b5"},"mn":"2"},"mo":"\u2062","mrow":{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}}],"mo":"+"}}}}]}}}],"br":{}},{"@attributes":{"id":"p-0119","num":"0118"},"maths":{"@attributes":{"id":"MATH-US-00035","num":"00035"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"6","mo":"\u2062","mi":"\u03b5"}}},{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}}],"mo":"\u2062"}],"mo":["\u2264","\u2264"],"mfrac":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"B","mn":"1"}}},{"mn":"1","mo":"-","mrow":{"mn":"1.5","mo":"\u2062","mi":"\u03b5"}}]}}},{"mrow":{"mo":["(",")"],"mn":"11"}}]}}}},"br":{}},{"@attributes":{"id":"p-0120","num":"0119"},"maths":{"@attributes":{"id":"MATH-US-00036","num":"00036"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"COU","mo":["\u2062","\u2062"],"mover":{"mi":"N","mo":"^"},"mrow":{"mi":"T","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}},{"mfrac":{"mrow":[{"mn":"1","mo":"-","mi":"\u03b5"},{"mn":"1","mo":"+","mrow":{"mn":"6","mo":"\u2062","mi":"\u03b5"}}]},"mo":"\u2062","mrow":{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}}],"mo":["\u2265","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["\u2265","\u2062"],"mi":{},"mrow":{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mn":"6","mo":"\u2062","mi":"\u03b5"}}},{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}],"mo":["\u2062","\u2062"]}}}},{"mtd":{"mrow":{"mo":["\u2265","\u2062"],"mi":{},"mrow":{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mn":"7","mo":"\u2062","mi":"\u03b5"}}},{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}],"mo":"\u2062"}}}}]}}}},"This proves that the estimate is within a 7\u03b5 relative error of COUNT. The other direction is proved similarly, by noting the following:",{"@attributes":{"id":"p-0122","num":"0121"},"maths":{"@attributes":{"id":"MATH-US-00037","num":"00037"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"COU","mo":["\u2062","\u2062"],"mover":{"mi":"N","mo":"^"},"mrow":{"mi":"T","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}},{"mrow":[{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","I"],"mn":"1"}}},{"mi":"EST","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":["B","L"],"mn":"1"}}}],"mo":"+"}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062"],"mi":{},"mrow":{"mfrac":{"msubsup":{"mi":["B","I"],"mn":"1"},"mrow":{"mn":"1","mo":"-","mi":"\u03b5"}},"mo":"+","mrow":{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},"mo":"\u2062","msubsup":{"mi":["B","L"],"mn":"1"}}}}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062","\u2264"],"mi":{},"mrow":[{"mrow":[{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mi":"\u03b5"}}},"mo":"\u2062","msubsup":{"mi":["B","I"],"mn":"1"}},{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"msubsup":{"mi":["B","L"],"mn":"1"},"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":["Using","\u03b5"]}],"mo":"+"},{"mn":["1","2"],"mo":["\u2062","\u2062"],"mstyle":{"mtext":"\/"}}]}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062"],"mi":{},"mrow":{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mi":"\u03b5"}}},"mo":"\u2062","msub":{"mi":"B","mn":"1"}}}}},{"mtd":{"mrow":{"mo":["\u2264","\u2062"],"mi":{},"mrow":{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mi":"\u03b5"}}},{"mi":"COUNT","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}}],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":["Using","Equation"],"mn":"1"}}}}]}}}},"Thus, with probability at least 1\u22124\u03b4, the estimated count is within a 7\u03b5 relative error of the actual.","Theorem 2:","processes 1-3 yield an (\u03b5,\u03b4)-approximation for the correlated basic count, using space (in bits)",{"@attributes":{"id":"p-0126","num":"0125"},"maths":{"@attributes":{"id":"MATH-US-00038","num":"00038"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"O","mo":"(","mrow":{"mfrac":{"mn":"1","mi":"\u03b5"},"mo":["\u2062","\u2062"],"mrow":[{"mo":["(",")"],"mrow":{"msup":{"mi":"log","mn":"2"},"mo":"\u2062","mi":"U"}},{"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["log","log","U"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"mi":"log","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":["\u2062","\u2062"],"mstyle":{"mtext":"\/"},"mi":"\u03b5"}}},{"mi":"log","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":["\u2062","\u2062"],"mstyle":{"mtext":"\/"},"mi":"\u03b4"}}}],"mo":["+","+"]}},"mo":"."}]}}}},"br":{},"sub":"max"},"Proof: The space complexity and correctness follow from Lemma 2 and Lemma 6, respectively. In prior work, it was shown that any data structure for basic counting for a (synchronous) sliding window with an \u03b5 relative error needs",{"@attributes":{"id":"p-0128","num":"0127"},"maths":{"@attributes":{"id":"MATH-US-00039","num":"00039"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"\u03a9","mo":["(",")"],"mfrac":{"mrow":{"msup":{"mi":"log","mn":"2"},"mo":"\u2062","mi":"U"},"mi":"\u03b5"}}}},"br":{}},{"@attributes":{"id":"p-0129","num":"0128"},"maths":{"@attributes":{"id":"MATH-US-00040","num":"00040"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"\u03a9","mo":["(",")"],"mfrac":{"mrow":{"msup":{"mi":"log","mn":"2"},"mo":"\u2062","mi":"U"},"mi":"\u03b5"}}}},"br":{},"sub":["0","1","l",{"sub2":"max"},"i ","i","i ","i"],"sup":["\u22121 ","\u22121 ","\u22121 ","\u22121 ","2 ","\u22121 ","\u22121 ","\u22121 ","\u22121 ","2 "]},"General Scheme for Correlated Aggregation","A general scheme for constructing a summary for correlated aggregation for any aggregation function that satisfies a certain set of properties is described. For any such aggregation function, it is described how to reduce the construction of a sketch for correlated aggregation to the construction of a sketch for aggregation over the entire stream. This reduction allows the use of previously known stream summaries for aggregation over streams in constructing summaries for correlated aggregation.","An embodiment employs this scheme to construct small space summaries for estimating correlated frequency moments over a data stream. For k>0, the k-th frequency moment of a stream of identifiers, each assumed to be an integer from {1, . . . , m}, is defined as F=\u03a3\u0192, where \u0192is the number of occurrences of the i-th item. The estimation of the frequency moments over a data stream has been the subject of much study; however, embodiments provide processing for estimating the correlated frequency moments with provable guarantees on the relative error. The memory requirements are optimal up to small factors, namely factors that are logarithmic in m and the error probability \u03b4, and factors that are polynomial in the relative error parameter \u03b5.","The technique for general correlated aggregation described herein builds on prior work for the correlated estimation of the basic count. While the basic data structure used in prior work is an exact counter, embodiments rather employ a \u201csketch\u201d, which can accurately estimate an aggregate on a stream, and provide a (possibly) probabilistic guarantee on the correctness. The error due to the randomized sketches employed by embodiments is analyzed, as well as the combination of different sketches. A central new issue is that of dependency between random variables.","Also presented in detail are approaches for the first space-efficient processing for correlated aggregates of the number of distinct elements (F), and other aggregates related to frequency moments, such as the F-heavy hitters and rarity. A technique for achieving lower amortized update time is provided. For correlated F, the update time is \u00d5(log n) per stream update.","General Streaming Models and Lower Bounds","The case of streams where items can have an associated positive or negative integer weight is described. Allowing negative weights is useful for analyzing the symmetric difference of two data sets, since the items in the first data set can be inserted into the stream with positive weights, while the items from the second data set can be inserted into the stream with negative weights.","In this model, each stream element is a 3-tuple (x,y,z), where zspecifies the weight of the item. It is shown that even if z\u03b5{\u22121,1} for all i, then for a general class of functions that includes the frequency moments, any summary that can estimate correlated aggregates accurately and that is constructed in a single pass must use memory that is linear in the size of the stream. This is to be contrasted with the estimation of frequency moments over a stream in the non correlated case, where it is known how to estimate these aggregates in sublinear space even in the presence of positive and negative weights.","Also described is a model with arbitrary positive and negative weights in which multiple passes over the stream are allowed. This more general model allows the processing to make a small (but more than one) number of passes over the stream and store a small summary of what is seen. At a later time a query is made and must be answered using only the summary. Such a setting arises if data is collected and stored from previous days for the purpose of creating a summary, but is then deleted or archived while only the summary is retained.","In this case, a smooth pass-space tradeoff is obtained for these problems, in that with a logarithmic number of passes there are space-efficient algorithms for a large class of correlated aggregates even with negative weights, but with fewer passes no such space-efficient algorithms can exist.","Aggregation over Asynchronous Streams","A closely related problem is that of computing aggregates over a sliding window on an asynchronous stream. In this scenario, a stream of (\u03bd,t) tuples, where \u03bd is a data item, and t is the timestamp at which it was generated. Due to asynchrony in the transmission medium, it is possible that the stream elements do not arrive in the order of the timestamps. In other words, it is possible that t<t, but that (\u03bd,t) is received later than (\u03bd,t). This was not possible in the traditional definition of count-based or time-based sliding windows. There is a straightforward reduction from the problem of aggregating over asynchronous streams to that of computing correlated aggregates, and vice versa, from previous work. Hence, all of the results for correlated aggregates described herein apply also to aggregation over a sliding window on an asynchronous stream with essentially the same space and time bounds. Thus, embodiments achieve the first low-space solutions for asynchronous streams for a wide class of statistics.","Correlated Estimation of a Class of Statistics","Embodiments provide for the estimation of correlated aggregates for any aggregation function that satisfies a set of properties. Consider an aggregation function \u0192 that takes as input a multi-set of real numbers R and returns a real number \u0192(R). In the following, the term \u201cset of real numbers\u201d is used to mean a \u201cmulti-set of real numbers\u201d. Also, union of sets implies a multi-set union, when the context is clear.","For any set of tuples of real numbers T={(x,y)|1\u2266i\u2266n} and real number y, let \u0192(T,c) denote the correlated aggregate \u0192({x|((x,y)\u03b5T)(y\u2266c)}). For any function \u0192 satisfying the following properties, it is shown herein how a reduction from the problem of space-efficient estimation of correlated aggregate \u0192(T,c) to the problem of space-efficient estimation of \u0192 in an uncorrelated manner on the entire set R.","The following definition of an (\u03b5,\u03b4) estimator is used herein. Definition 2: Given parameters \u03b5,\u03b4, where 0<\u03b5<1, and 0<\u03b4<1, an (\u03b5,\u03b4) estimator for a number Y is a random variable X such that with probability at least 1\u2212\u03b4, the following is true:\n\n(1\u2212\u03b5)\u2266(1+\u03b5)\n","In the following description, the term \u201csketching function\u201d denotes a compression of the input set with certain properties. More precisely, \u0192 has a sketching function sk(\u03bd,\u03b3,R) if:","Using sk(\u03bd,\u03b3,R) it is possible to get an (\u03bd,\u03b3)-estimator of \u0192(R); and","For two sets Rand R, given sk(\u03bd,\u03b3,R) and sk(\u03bd,\u03b3,R), it is possible to compute sk(\u03bd,\u03b3,R\u222aR).","Many functions \u0192 have sketching functions. For instance, the second frequency moment Fand the k-th frequency moment Fhave sketches due to prior work. In these two examples, the sketching function is obtained by taking random linear combinations of the input.","Embodiments require the following conditions from \u0192 in order to construct a sketch for estimating correlated aggregates. These conditions intuitively correspond to \u201csmoothness\u201d conditions of the function \u0192, bounding how much \u0192 can change when new elements are inserted or deleted from the input multi-set. Informally, the less the function value is sensitive to small changes, the easier it is to apply to estimating correlated aggregates.\n\n","For any function \u0192 with a sketch sk with the above properties, it is shown herein how to construct a sketch sk(\u03b5,\u03b4,T) for estimating the correlated aggregate \u0192(T,c) with the following properties:\n\n","Processing Description","Referring to , let \u0192denote an upper bound on the value of \u0192(\u00b7,\u00b7) over all input streams considered. The process () uses a set of levels l=0, 1, 2, . . . , l, where lis such that 2>\u0192for any input stream T and real number c. From Property I, it follows that lis logarithmic in the stream size.","Parameters \u03b1,\u03b3,\u03bd are chosen as follows:",{"@attributes":{"id":"p-0155","num":"0161"},"maths":{"@attributes":{"id":"MATH-US-00041","num":"00041"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"\u03b1","mo":"=","mfrac":{"mrow":[{"mn":"64","mo":"\u2062","mrow":{"msubsup":{"mi":["c","f"],"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"msub":{"mi":["y","max"]}}}}},{"msubsup":{"mi":["c","f"],"mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03b5","mo":["\u2062","\u2062"],"mstyle":{"mtext":"\/"},"mn":"2"}}}]}},{"mi":"v","mo":"=","mfrac":{"mi":"\u03b5","mn":"2"}},{"mi":"\u03b3","mo":"=","mfrac":{"mi":"\u03b4","mrow":{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["y","max"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"l","mo":"+","mn":"1"}}}}}}],"mo":[",","\u2062",",","\u2062",","],"mstyle":[{"mtext":{}},{"mtext":{}}]}}},"br":{},"sub":"max "},"Without loss of generality, assume that yis of the form 21\u22121 for some integer \u03b2. The dyadic intervals within [0,y] are defined inductively as follows:\n\n","Within each level l, from 0 to l, there is a \u201cbucket\u201d for each dyadic interval within [0,y]. Thus, there are 2y\u22121 buckets in a single level. Each bucket b is a triple <k(b),l(b),r(b)>, where [l(b),r(b)] is a dyadic interval that corresponds to a range of y values that this bucket is responsible for, and k(b) is defined below.","When a stream element (x,y) arrives, it is inserted into each level l=0, . . . , l. Within level l, it is inserted into exactly one bucket, as described in Process 5. For a bucket b in level l, let S(b) denote the (multi-)set of stream items that were inserted into b. Then, k(b)=sk(\u03bd,\u03b3,S(b)) is a sketch of S(b).","Within each level, no more than \u03b1 of the 2y\u22121 buckets are actually stored. In the process, Sdenotes the buckets that are stored in level l. The level Sis a special level that just consists of singletons. Among the buckets that are not stored, there are two types of buckets, those that were discarded in Process 5 (see the \u201cCheck for overflow\u201d comment in Process 5), and those that were never used by the process. The above three types of buckets are termed \u201cstored\u201d, \u201cdiscarded\u201d, and \u201cempty\u201d, respectively. Note that S(b) is defined for each of these three types of buckets (if b is an empty bucket, then S(b) is defined as the null set \u03c6).","The buckets in Sare organized into a tree, induced by the relation between the dyadic intervals that these buckets correspond to.","The initialization for the process for a general function is described in Process 4, illustrated in . The update and query processing are described in Processes 5 and 6, illustrated in  and , respectively.","Theorem 3","(Space Complexity): The space complexity of the sketch for correlated estimation is",{"@attributes":{"id":"p-0164","num":"0172"},"maths":{"@attributes":{"id":"MATH-US-00042","num":"00042"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mi":"O","mo":["(",")"],"mrow":{"mfrac":{"mrow":[{"mrow":[{"msubsup":{"mi":["c","f"],"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}}},{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["f","max"]}}}],"mo":"\u00b7"},{"msubsup":{"mi":["c","f"],"mn":"2"},"mo":["(",")"],"mfrac":{"mi":"\u03b5","mn":"2"}}]},"mo":"\u00b7","mi":"len"}},"mo":","}}},"br":{}},{"@attributes":{"id":"p-0165","num":"0173"},"maths":{"@attributes":{"id":"MATH-US-00043","num":"00043"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"len","mo":"=","mrow":{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mi":["sk","f"]},"mo":["(",")"],"mrow":{"mfrac":[{"mi":"\u03b5","mn":"2"},{"mi":"\u03b4","mrow":{"mn":"4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["y","max"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"2","mo":"+","mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["f","max"]}}}}}}}],"mo":[",",","],"mi":"S"}}}}}},"br":{}},"Proof:","There are no more than 2+log \u0192levels and in each level l, Sstores no more than \u03b1 buckets. Each bucket b contains sk(\u03bd,\u03b3,S(b)). The space complexity is \u03b1(2+log \u0192) times the space complexity of sketch sk. Here it is assumed that the space taken by sk is larger than the space required to store l(b) and r(b).","Process Correctness","Let S denote the stream of tuples observed up to a given point. Suppose the required correlated aggregate is \u0192(S,c). Let A be the set\n\n{|(()\u03b5)()}.\n","Thus, \u0192(S,c)=\u0192(A).","For level l,0\u2266l\u2266l, Band Bare defined as follows. Let Bdenote the set of buckets b in level l such that span(b)[0,c]. Let Bdenote the set of buckets b in level l such that span(b)\u2282[0,c], but span(b) has a non-empty intersection with [0,c].","Note that for each level l, Band Bare uniquely determined once the query \u0192(S,c) is fixed. These do not depend on the actions of the process. This is an important property used, which allows the choice of which buckets to use during estimation to be independent of the randomness in the data structures. Further, note that only a subset of Band Bis actually stored in S.","Consider any level l,0\u2266l\u2266l. For bucket b, recall that S(b) denotes the set of stream items inserted into the bucket until the time of the query. For bucket b\u03b5S, let \u0192(b) denote \u0192(S(b)). Let est(b) denote the estimate of \u0192(b) obtained using the sketch k(b). If S(b)=\u03c6, then \u0192(b)=0 and est(b)=0. Thus note that \u0192(b) and est(b) are defined no matter whether b is a stored, discarded, or an empty bucket. Further, for a set of buckets B in the same level, let S(B)=\u222aS(b), and let \u0192(B)=\u0192(S(B)). Let est(B) be the estimate for \u0192(B) obtained through the composition of all sketches in \u222ak(b) (by property V, sketches can be composed with each other).","Definition 3: Bucket b is defined to be \u201cgood\u201d if (1\u2212\u03bd)\u0192(b)\u2266est(b)\u2266(1+\u03bd)\u0192(b). Otherwise, b is defined to be \u201cbad\u201d.","Let G denote the following event: each bucket b in each level b in each level 0 . . . lis good.",{"@attributes":{"id":"p-0176","num":"0184"},"maths":{"@attributes":{"id":"MATH-US-00044","num":"00044"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Lemma","mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mtext":":"},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mn":"7","mrow":{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"G"}}},{"mn":"1","mo":"-","mfrac":{"mi":"\u03b4","mn":"2"}}],"mo":"\u2265"}}}},"Proof:","For each bucket b, note that est(b) is a (\u03bd,\u03b3)-estimator for \u0192(b). Thus, the probability that b is bad is no more than \u03b3. Noting that there are less than 2ybuckets in each level, and l+1 levels in total, and applying a union bound, yields:",{"@attributes":{"id":"p-0179","num":"0187"},"maths":{"@attributes":{"id":"MATH-US-00045","num":"00045"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"Pr","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":["G","_"]}}},{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["y","max"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["l","max"]},"mo":"+","mn":"1"}}}}],"mo":"\u2264"},"mo":"=","mfrac":{"mi":"\u03b4","mn":"2"}}}}},"Lemma 8:","For any level l, S(B)AS(B\u222aB).","Proof:","Every bucket b\u03b5Bmust satisfy span(b)\u03b5[0,c]. Thus every element inserted into Bmust belong in A. Hence S(B)A. Each element in A has been inserted into some bucket in level l (it is possible that some of these buckets have been discarded). By the definitions of Band B, an element in A cannot be inserted into any bucket outside of B\u222aB. Thus AS(B\u222aB).","Using Lemma 8 and Condition II on \u0192 yields the following for any level l:\n\n\u0192()\u2266\u0192()\u2266\u0192().\u2003\u2003(12)\n","Lemma 9:","Conditioned on event G, process 6 does not output FAIL in step 1.","Proof:","Consider l\u00b7Y>c if event G occurs. Observe that Yis initialized to \u221e in Process 4. Its value can only change if the root b of Scloses. For this to happen, there must be est(k(b))\u22672. But 2>2\u0192, which means that est(k(b)) does not provide a (1+\u03b5)-approximation. This contradicts the occurrence of event G. Hence, Y>c and so Process 6 does not output FAIL in step 1.","Let l* denote the level used by Process 6 to answer the query \u0192(S,c).","Lemma 10:","If l*\u22671 and G is true, then\n\n\u0192(*)\u2266(log )2*.\n","Proof:","First, note that there can be no singleton buckets in B* by definition of Bfor a level l. Thus, for each bucket b\u03b5B*, est(b)\u22662*. Because G is true, for every bucket b\u03b5B*, b is good, so that",{"@attributes":{"id":"p-0194","num":"0202"},"maths":{"@attributes":{"id":"MATH-US-00046","num":"00046"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},{"mfrac":{"msup":{"mn":"2","mrow":{"msup":{"mi":"l","mo":"*"},"mo":"+","mn":"1"}},"mrow":{"mn":"1","mo":"-","mi":"v"}},"mo":"."}],"mo":"\u2264"}}}},"Next, note that there are no more than log ybuckets in B*, since there can be only one dyadic interval of a given size that intersects [0,c] but is not completely contained within [0,c].","From Property III:",{"@attributes":{"id":"p-0197","num":"0205"},"maths":{"@attributes":{"id":"MATH-US-00047","num":"00047"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mo":"\u2062","mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":"B","mn":"2","msup":{"mi":"l","mo":"*"}}}},{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mo":"\u22c3","mrow":{"mi":"b","mo":["\u2062","\u2208","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msubsup":{"mi":"B","mn":"2","msup":{"mi":"l","mo":"*"}}}},"mo":"\u2062","mrow":{"mi":"S","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}}}}},{"mrow":[{"msubsup":{"mi":["c","f"],"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}}},{"mfrac":{"msup":{"mn":"2","mrow":{"msup":{"mi":"l","mo":"*"},"mo":"+","mn":"1"}},"mrow":{"mn":"1","mo":"-","mi":"v"}},"mo":"."}],"mo":"\u2062"}],"mo":["\u2264","\u2062"],"mi":{}}],"mo":["=","\u2062"],"mi":{}}}}},"br":{}},"Lemma 11:","If l*\u22671 and G is true, then:\n\n\u0192()\u2267\u03b12*.\n","Proof:","Since the process used level l* for answering the query, it must be the case that there are buckets in Sthat had an intersection with [0,c] but were discarded from the data structure. It follows that there are at most log ybuckets b\u03b5Ssuch that span(b)\u2282[0,c]. For the remaining buckets b\u03b5S, it must be true that span(b)\u2282[0,c]. If Sis viewed as a binary tree with \u03b1 nodes, according to the ordering between the different dyadic intervals, then Smust have (\u03b1\u22121)\/2 internal nodes. Suppose I denoted the set of buckets in b\u03b5Ssuch that b is an internal node, and span(b)\u2282[0,c]. Thus |I|\u2267(\u03b1\u22121)\/2\u2212log y. Since G is true, for any bucket b\u03b5I,",{"@attributes":{"id":"p-0202","num":"0210"},"maths":{"@attributes":{"id":"MATH-US-00048","num":"00048"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"b"}},{"mfrac":{"msup":{"mn":"2","mrow":{"msup":{"mi":"\u2113","mo":"*"},"mo":"-","mn":"1"}},"mrow":{"mn":"1","mo":"+","mi":"v"}},"mo":"."}],"mo":"\u2265"}}},"br":{}},{"@attributes":{"id":"p-0203","num":"0211"},"maths":{"@attributes":{"id":"MATH-US-00049","num":"00049"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"I"}}],"mo":["\u2265","\u2265"],"mfrac":{"mrow":[{"mrow":{"mo":["\uf603","\uf604"],"mi":"I"},"mo":"\u2062","msup":{"mn":"2","mrow":{"msup":{"mi":"\u2113","mo":"*"},"mo":"-","mn":"1"}}},{"mn":"1","mo":"+","mi":"v"}]}}}}},"Using \u03bd<1, and for an appropriately large value of \u03b1, ((\u03b1\u22121)\/2\u2212log y)\u2267\u03b1\/4. Combining the above yields the following:",{"@attributes":{"id":"p-0205","num":"0213"},"maths":{"@attributes":{"id":"MATH-US-00050","num":"00050"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},"mo":"\u2265","mfrac":{"mrow":[{"mi":"a","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"2","msup":{"mi":"\u2113","mo":"*"}}},{"mn":["2","4","2"],"mo":["\u00b7","\u00b7"]}]}},{"msup":{"mn":"2","mrow":{"msup":{"mi":"\u2113","mo":"*"},"mo":"-","mn":"4"}},"mo":"\u2062","mrow":{"mi":"a","mo":"."}}],"mo":"="}}}},"Theorem 4:","When presented with a query for \u0192(S,c), let est denote the estimate returned by the process. Then, with probability at least 1\u2212\u03b4:\n\n(1\u2212\u03b5)\u0192()\u2266\u2266(1+\u03b5)\u0192().\n","Proof:","If l*=0, then all elements (x,y)\u03b5S such that y\u2266c are stored in S. In this case, the theorem follows by the definition of event G and Lemma 1. Otherwise, est=est(B*), and \u0192(S,c)=\u0192(A). First, note that in level l*, none of the buckets in B* have been discarded. Thus each bucket b\u03b5B* is either empty or is stored. Thus, it is possible to execute line 7 in Process 6 correctly to construct a sketch of S(B*). From property (b) of sketching functions yields a sketch sk(\u03bd,\u03b3,S(B*)).","Let \u03b5denote the event (1\u2212\u03bd)\u0192(B*)\u2266est(B*)\u2266(1+\u03bd)\u0192(B*). Thus:\n\n]\u22671\u2212\u03b3\n","The following is conditioned on both \u03b5and G occurring. From Equation 1: \u0192(A)\u2266\u0192(B*\u222aB*). From Lemmas 4 and 5:",{"@attributes":{"id":"p-0212","num":"0220"},"maths":{"@attributes":{"id":"MATH-US-00051","num":"00051"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mfrac":[{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":"B","mn":"2","msup":{"mi":"\u2113","mo":"*"}}}},{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}]},{"mrow":[{"mrow":{"msubsup":{"mi":["c","f"],"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}}},"mo":"\u2062","msup":{"mn":"2","mrow":{"msup":{"mi":"\u2113","mo":"*"},"mo":"+","mn":"2"}}},{"mi":"a","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"2","mrow":{"msup":{"mi":"\u2113","mo":"*"},"mo":"-","mn":"4"}}}]},{"mrow":{"mrow":{"msubsup":{"mi":["c","f"],"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}}},"mo":"\u2062","msup":{"mn":["2","6"]}},"mi":"a"}],"mo":["\u2264","\u2264","\u2264"],"mrow":{"msubsup":{"mi":["c","f"],"mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":"\u03b5","mn":"2"}}}}}},"br":{}},"Since (A\u2212B*)B*, the following is true:",{"@attributes":{"id":"p-0214","num":"0222"},"maths":{"@attributes":{"id":"MATH-US-00052","num":"00052"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mfrac":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"A","mo":"-","msubsup":{"mi":"B","mn":"1","msup":{"mi":"\u2113","mo":"*"}}}}},{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}]},"mo":"\u2264","mrow":{"mrow":{"msubsup":{"mi":["c","f"],"mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":"\u03b5","mn":"2"}}},"mo":"."}}}},"br":{}},{"@attributes":{"id":"p-0215","num":"0223"},"maths":{"@attributes":{"id":"MATH-US-00053","num":"00053"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"msubsup":{"mi":"B","mn":"1","msup":{"mi":"\u2113","mo":"*"}}}},{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"A","mo":"-","mrow":{"mo":["(",")"],"mrow":{"mi":"A","mo":"-","msubsup":{"mi":"B","mn":"1","msup":{"mi":"\u2113","mo":"*"}}}}}}},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mfrac":{"mi":"\u03b5","mn":"2"}}},{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":"\u2062"}],"mo":"\u2265"}],"mo":"="}}}},"Conditioned on \u03b5and G both being true:\n\n(*)\u2267(1\u2212\u03b5\/2)(1\u2212\u03bd)\u0192()\u2267(1\u2212\u03b5)\u0192()\n","This proves that conditioned on G and \u03b5, the estimate returned is never too small. For the other direction, note that conditioned on \u03b5being true:\n\n(*)\u2266(1+\u03bd)\u0192(*)\u2266(1+\u03bd)\u0192()\u2266(1+\u03b5)\u0192()\n\nwhere \u0192(B*)\u2266\u0192(A) has been used, and \u03bd<\u03b5.\n","To complete the proof of the theorem, note that:\n\n\u22671]\n",{"@attributes":{"id":"p-0219","num":"0227"},"maths":{"@attributes":{"id":"MATH-US-00054","num":"00054"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mo":"\u2265","mrow":{"mn":"1","mo":["-","-"],"mfrac":{"mi":"\u03b4","mn":"2"},"mi":"\u03b3"}}}},"br":[{},{}],"in-line-formulae":[{},{}]},"Frequency Moments F","The general technique presented herein can yield a data structure for the correlated estimation of the frequency moments F, k\u22672.","Fact 1: (H\u00f6lder's Inequality) For vectors a and b of the same dimension, and any integer k\u22671, a, b\u2266\u2225a\u2225\u00b7\u2225b\u2225.","Lemma 12:","For sets S, i=1 . . . j, if F(S)\u2266\u03b2 for each i=1 . . . j, then F(\u222aS)\u2266j\u03b2.","Proof:","Fact 1, j-dimensional vectors a and b implies that |a, b|\u2266\u2225a\u2225\u00b7\u2225b\u2225. Setting b=(1, 1, . . . , 1), it follows that (a+ . . . +a)\u2266j(a+ . . . +a). Hence, it follows that",{"@attributes":{"id":"p-0227","num":"0235"},"maths":{"@attributes":{"id":"MATH-US-00055","num":"00055"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mo":"\u22c3","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"j"},"mo":"\u2062","mrow":{"mo":"\u22c3","msub":{"mi":["S","i"]}}}}},{"msup":{"mi":"j","mrow":{"mi":"k","mo":"-","mn":"1"}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"j"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["S","i"]}}}}},{"msup":{"mi":["j","k"]},"mo":"\u2062","mrow":{"mi":"\u03b2","mo":"."}}],"mo":["\u2264","\u2264"]}}}},"Lemma 13:","If F(B)\u2266(\u03b5\/(3k))F(A), then F(A\u222aB)\u2266(1+\u03b5)F(A).","Proof:","Suppose A and B have support on {1, 2, . . . , n}. Let a and b be the characteristic vectors of sets A and B, respectively. Using Fact 1 yields:",{"@attributes":{"id":"p-0232","num":"0240"},"maths":{"@attributes":{"id":"MATH-US-00056","num":"00056"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["A","B"],"mo":"\u22c3"}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["a","i"]},{"mi":["b","i"]}],"mo":"+"}},"mi":"k"}}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"k","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},"mo":["\u2062","\u2062"],"msubsup":[{"mi":["a","i","j"]},{"mi":["b","i"],"mrow":{"mi":["k","j"],"mo":"-"}}]}}}],"mo":["+","+"]}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"k","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msubsup":[{"mi":["a","i","j"]},{"mi":["b","i"],"mrow":{"mi":["k","j"],"mo":"-"}}],"mo":"\u2062"}}],"mo":"\u2062"}}],"mo":["+","+"]},"mo":"\u2264"}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"j","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},"mo":["\u2062","\u2062"],"msup":[{"mrow":{"mo":["(",")"],"mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":[{"mo":["(",")"],"msubsup":{"mi":["a","i","j"]}},{"mi":["k","j"],"mo":"\/"}]}}},"mfrac":{"mi":["j","k"]}},{"mrow":{"mo":["(",")"],"mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":[{"mo":["(",")"],"msubsup":{"mi":["b","i"],"mrow":{"mi":["k","j"],"mo":"-"}}},{"mi":"k","mo":"\/","mrow":{"mo":["(",")"],"mrow":{"mi":["k","j"],"mo":"-"}}}]}}},"mfrac":{"mrow":{"mi":["k","j"],"mo":"-"},"mi":"k"}}]}}],"mo":["+","+"]}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"k","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},"mo":"\u2062","msup":{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"mfrac":{"mi":["j","k"]},"mo":"\u2062","msup":{"mrow":{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},"mfrac":{"mrow":{"mi":["k","j"],"mo":"-"},"mi":"k"}}}]}}}],"mo":["+","+"]}}}}]}}}},{"@attributes":{"id":"p-0233","num":"0241"},"maths":{"@attributes":{"id":"MATH-US-00057","num":"00057"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mo":["\u2264","\u2062","\u2264","\u2062","\u2264","\u2062","\u2264","\u2062","\u2264"],"mrow":[{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"B"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"k","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":["\u2062","\u2062"],"msup":{"mrow":[{"mo":["(",")"],"mfrac":{"mi":"\u03b5","mrow":{"mn":"3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"k"}}},{"mi":["k","j"],"mo":"-"}]}}}],"mo":["+","+"]},{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mi":"\u03b5","mo":"\/","mn":"3"}}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":"\u2062"},{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"j","mo":"=","mn":"1"},{"mi":"k","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"k"}},{"mtd":{"mi":"j"}}]}},"mo":"\u2062","msup":{"mrow":[{"mo":["(",")"],"mrow":{"mi":"\u03b5","mo":"\/","mrow":{"mo":["(",")"],"mrow":{"mn":"3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"k"}}}},{"mi":["k","j"],"mo":"-"}]}}}],"mo":"\u2062"}],"mo":"+"},{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mi":"\u03b5","mo":"\/","mn":"3"}}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":"\u2062"},{"mrow":{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},"mo":"\u2062","msup":{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mi":"\u03b5","mo":"\/","mrow":{"mo":["(",")"],"mrow":{"mn":"3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"k"}}}}},"mi":"k"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":["+","-"]},{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mi":"\u03b5","mo":"\/","mn":"3"}}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":"\u2062"},{"mrow":[{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}},{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mn":"2","mo":"\u2062","mrow":{"mi":"\u03b5","mo":"\/","mn":"3"}}}}],"mo":"\u2062"},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":["+","-"]},{"mrow":[{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mi":"\u03b5"}},{"msub":{"mi":["F","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"A"}}],"mo":"\u2062"}],"mstyle":[{"mtext":{}},{"mtext":{}},{"mtext":{}},{"mtext":{}}]},"mo":","}}},"br":{},"sup":["y","xy ","z"]},"Lemma 14:","If C\u2282D, and F(C)\u2266(\u03b5\/(9k))F(D), then F(D\u2212C)\u2267F(D).","Proof:","It is know that for any two sets A and B, F(A\u222aB)\u22662(F(A)+F(B)).\n\n()=(()\u222a()\n\n\u22662(F(D\u2212C)+F(C)),\n\nwhich leads to:\n\n()\u2267()\/2()\u2267((9\/\u03b5)(\u00bd)\u22121)()\n\n\u2267(3k\/\u03b5)F(C).\n","Thus, F(C)\u2266(\u03b5\/3k)F(D\u2212C). Applying Lemma 7 yields F(C\u222a(D\u2212C))\u2266(1+\u03b5)F(D\u2212C). Thus, F(D\u2212C)\u2267F(D)\/(1+\u03b5)\u2267(1\u2212\u03b5)F(D).","Theorem 5:","For parameters 0<\u03b5<1 and 0<\u03b4<1, there is a sketch for an (\u03b5, \u03b4)-estimation of the correlated aggregate Fon a stream of tuples of total length n, using space npoly(\u03b5log(n\/\u03b4))","Proof:","From Lemma 12, c(j)=j. From Lemma 8, c(\u03b5)=(\u03b5\/(9k)). Using these in Theorem 3 yields c(log y)=(log y), and c(\u03b5\/2)=(\u03b5\/(18k)). Using the sketches for Fand F,k>2 from prior work, the above result is obtained.","The space can be improved to rpoly(\u03b5(log(n\/\u03b4)), where r is the number of distinct x-values in the stream. In the worst-case, though, r could be \u0398(n). The dependence is made more explicit for the case of F.","Lemma 15:","For parameters 0<\u03b5<1 and 0<\u03b4<1, there is a sketch for (\u03b5,\u03b4) error correlated estimation of Fon a stream of tuples of total length n, using space O(\u03b5(log(1\/\u03b4)+log y)(logy)(log\u0192)) bits. The amortized update time is O(log \u0192\u00b7log y).","Proof:","The space taken by a sketch for an (\u03b5,\u03b4) estimator for Fon a stream is O((log \u0192)(1\/\u03b5)log(1\/\u03b4)) bits. From the proof of Theorem 5, c(j)=j, and c(\u03b5)=(\u03b5\/18).","Using the above in Theorem 3, the space is O(\u03b5log\u0192logy(log 1\/\u03b4+log y)) bits.","To get O(log \u0192(log 1\/\u03b4+log y)) amortized processing time, observe that there are O(log \u0192) data structures S, each containing O(\u03b5logy) buckets, each holding a sketch of O(\u03b5log \u0192(log 1\/\u03b4+log y)) bits. A batch of O(\u03b5logy) updates is processed at once. The batch is first sorted in order of non-decreasing y-coordinate. This can be done in O(\u03b5logy(log 1\/\u03b5+log log y)) time. Then, the following processing is done for each S. A pre-order traversal of the buckets in Sis conducted and the appropriate buckets are updated. Importantly, each bucket maintains an update-efficient AMS sketch (shown in prior work), which can be updated in time O(log 1\/\u03b4+log y). Since the updates are sorted in increasing y-value and the list is represented as a pre-order traversal, the total time to update Sis O(\u03b5logy(log 1\/\u03b4+log y)). The time to update all the Sis O(log \u0192) times this. So the amortized time is O(log \u0192(log 1\/\u03b4+log y)).","Other Useful Statistics","While many aggregation functions satisfy the properties described above, some important ones do not. However, in many important remaining cases, these aggregation functions are related to aggregation functions that do satisfy these properties, and the mere fact that they are related in the appropriate way enables efficient estimation of the corresponding correlated aggregate.","The correlated F-heavy hitters can be computed, as well as the rarity (defined below) by relating these quantities to Fand F, respectively.","For example, in the correlated F-heavy hitters problem with y-bound of c and parameters \u03b5,\u03c6, 0<\u03b5<\u03c6<1, letting F(c) denote the correlated F-aggregate with y-bound of c, to return all x for which |{(x,y)|x=xy\u2266c}|\u2267\u03c6F(c), and no x for which |{(x,y)|x=xy\u2266c}|\u2266(\u03c6\u2212\u03b5)F(c). To do this, the same data structures Smay be used as used for estimating the correlated aggregate F. However, for each Sand each bucket in Smaintain a process is maintained for estimating the squared frequency of each item inserted into the bucket up to an additive (\u03b5\/10)\u00b72. To estimate the correlated F-heavy hitters, for each item an additive (\u03b5\/10)\u00b7F(c) approximation to its squared frequency is obtained by summing up the estimates provided for it over the different buckets contained in [0,c] in the data structure Sused for estimating F(c). Since only an \u03b5\/10 fraction of F(c) does not occur in such buckets, the list of all heavy hitters is obtained this way, and no spurious ones.","In the rarity problem, the problem is to estimate the fraction of distinct items that occur exactly once in the multi-set. The ideas for estimating rarity are similar, where the same data structures Sare maintained for estimating the correlated aggregate F, but in each bucket maintain data structures for estimating the rarity of items inserted into that bucket.","Number of Distinct Elements","The number of distinct elements in a stream, also known as the zeroth frequency moment F, is a fundamental and widely studied statistic of the stream. Here, the correlated estimation of the number of distinct elements in a stream is described. Consider a stream of (x,y) tuples, where x\u03b5{1, . . . , m} and y\u03b5{1,y}. The process employed by an embodiment is an adaptation of the process for estimating the number of distinct elements within a sliding window of a data stream, due to prior work. Similar to prior work, the process for correlated estimation of Fis based on \u201cdistinct sampling\u201d, or sampling based on the hash values of the item identifiers. Multiple samples, S, S, . . . , S, are maintained, where k=log m. Suppose that for simplicity, there is a hash function h that maps elements in {1, . . . , m} to the real interval [0,1]. This assumption of needing such a powerful hash function can be removed, as shown in prior work.","The process of prior work proceeds as follows. Stream items are placed in these samples Sin the following manner. (A) Each item (x,y) is placed in S. (B) For i>0, an item (x,y) is placed in level i if",{"@attributes":{"id":"p-0258","num":"0266"},"maths":{"@attributes":{"id":"MATH-US-00058","num":"00058"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mfrac":{"mn":"1","msup":{"mn":"2","mi":"i"}},"mo":"."}],"mo":"<="}}},"br":{}},"Since each level has a limited space budget, say \u03b1, a way to discard elements from each level is needed. The process according to an embodiment differs from prior work in the following aspect of how to discard elements from each level. For correlated aggregates, maintained in Sare only those items (x,y) that (1) have an x value that is sampled into S, and (2) have the smallest values of y among all the elements sampled into S. In other words, it is a priority queue using the y values as the weights, whereas in prior work, each level was a simple FIFO (first-in-first-out) queue.","It can be shown that the above scheme of retaining those elements with a smaller value of y, when combined with the sampling scheme in prior work, yields an (\u03b5,\u03b4) estimator for the correlated distinct counts.","Theorem 6:","Given parameters 0<\u03b5<1 and 0<\u03b4<1, there is a streaming process that can maintain a summary of a stream of tuples (x,y), where x\u03b5{1, . . . , m} and y\u03b5{1,y} such that: (1) The space of the summary is",{"@attributes":{"id":"p-0263","num":"0271"},"maths":{"@attributes":{"id":"MATH-US-00059","num":"00059"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"O","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["log","m"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["y","max"]}}],"mo":"+"}}},{"mn":"1","mo":"\/","mi":"\u03b4"}],"mo":["\u2062","\u2062","\u2062","\u2062"],"mfrac":{"mrow":{"mi":["log","m"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"msup":{"mi":"\u03b5","mn":"2"}},"mi":"log","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},"br":{},"sub":["0","0"]},"Example Implementations","Correlated F2, Second Frequency Moment","An example process for correlated Festimation was implemented in Python. The following four data sets were used for example evaluations. (1) Packet traces of Ethernet traffic on a LAN and a WAN. The relevant data here is the number of bytes in the packet, and the timestamp on the packet (in milliseconds). This data set is referred to as the \u201cEthernet\u201d data set. This data set has 2 million packets, and was constructed by taking two packet traces and combining them by interleaving. (2) The Uniform data set, which is a sequence of tuples (x,y) where x is generated uniformly at random from the set {0, . . . , 10000} and y is generated uniformly at random from the set {0, . . . , 2\u22121}. This maximum size of this data set is 10. (3) The Zipfian data set, with \u03b1=1. Here the x values are generated according to the Zipfian distribution with \u03b1=1, from the domain {0, . . . , 10000}, and the y values are generated uniformly at random from the set {0, . . . , 2\u22121}. The maximum size of this dataset is 10. (4) The Zipfian data set as described above, with \u03b1 set to 2.","For the sketch for F, the implementation used a variant of a process developed in prior work. An observation was that for all cases tested, the relative error of the process was almost always within the desired approximation error \u03b5, for \u03b4<0.2.","Space Usage as a Function of \u03b5","The space consumption of the process was studied. The space depends on a number of factors, including the values of \u03b5, and \u03b4. The space also depends on \u0192, since \u0192determines the maximum size of the data structure at each level. But the most obvious dependence is on \u03b5, and this dependence is explored further.","In , the space taken for the summary for Fis plotted as a function of \u03b5. This is illustrated for all the data sets described above, with each dataset of size 2 million tuples. It is noted that the space taken by the sketch increases rapidly with decreasing \u03b5, and the rate of the growth is similar for all four datasets. For smaller values of \u03b5(\u03b5\u22660.1), the summary data structure took even more space than the input stream itself. This is not surprising since the space increases as the fourth power of",{"@attributes":{"id":"p-0271","num":"0279"},"maths":{"@attributes":{"id":"MATH-US-00060","num":"00060"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mfrac":{"mn":"1","mi":"\u03b5"},"mo":"."}}}},"It can be observed that the space taken for the Ethernet dataset is greater than the space for the Uniform and Zipfian datasets. The reason for this is that the range of the y values in the Ethernet dataset was much larger (0 to 3200000) than in the Uniform and the Zipfian datasets, where the y values ranged from 0 to 8191. The larger range of y values meant that the number of nodes at each level is larger. In addition, a larger value of yalso leads to a larger value of \u0192, for the Ethernet dataset than for the other datasets, and hence also to a larger number of levels of data structures. However, note that the rate of growth of the space with respect to \u03b5 remains similar for all data sets. For smaller values of \u03b5(\u03b5\u22660.15), the summary data structure often took even more space than the input stream itself. This is not surprising since the space increases as the fourth power of",{"@attributes":{"id":"p-0273","num":"0281"},"maths":{"@attributes":{"id":"MATH-US-00061","num":"00061"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mfrac":{"mn":"1","mi":"\u03b5"},"mo":"."}}},"br":{}},"Space Usage as a Function of the Stream Size","Example results are illustrated in  (for \u03b5=0.15),  (for \u03b5=0.2), and  (for \u03b5=0.25). In all cases, as predicted by theory, the space taken by the sketch does not change much, and increases only slightly as the stream size increases. This shows that the space savings of the process is much larger with streams that are larger in size.","The time required for processing the stream of 2 million elements was nearly the same (about 5 minutes) for the Uniform, Zipfian, as well as Ethernet datasets. The processing rate can be improved by using the C\/C++ language, and by using a more optimized implementation.","These example results illustrate that a reasonable processing rate can be achieved for the data structure for F, and that correlated query processing is indeed practical, and provides significant space savings, especially for large data streams (of the order of 10 million tuples or larger).","Correlated F, Number of Distinct Elements","An example of the process for Fin Python and four data sets, as described in the case of F, was also implemented. The only difference was that in the Uniform and Zipfian datasets, the range of x values was much larger (0 . . . 1000000) than in the case of F, where the range of x values was 0 . . . 10000. The reason for this change is that there are much simpler approaches for correlated Festimation when the domain size is small: simply maintain the list of all distinct elements seen so far along the x dimension, along with the smallest value associated with it in the y dimension. Note that such a simplification is not (easily) possible for the case of F.","The variation of the sketch size with E is shown in . Note that while the sketch size decreases with increasing \u03b5, the rate of decrease was not as fast as in the case of F. Further, note that the sketch size for comparable values of \u03b5 was much smaller than the sketch for correlated F. Another point is that the space taken by the sketch for the Ethernet dataset was significantly smaller than the sketch for the other datasets. This is due to the fact that the range of x values in the Ethernet dataset was much smaller (0 . . . 2000) than for the other datasets (0 . . . 1000000). The number of levels in the data structure is proportional to the logarithm of the number of possible values along the x dimension. Note that as explained above, the process of choice for correlated Festimation for the Ethernet-type datasets (where the x range is small) will be different, as explained herein. Thus, the process is particularly useful for datasets where the x range is much larger.","The size of the sketch as a function of the stream size is shown in , for \u03b5=1. It can be seen that the sketch size hardly changed with the stream size. Note however, that for much smaller streams, the sketch will be smaller, since some of the data structures at different levels have not reached their maximum size yet. The results for other values of \u03b5 are similar, and are not shown here.","Accordingly, embodiments provide for computing correlated aggregates over a data stream. Referring to , it will be readily understood that embodiments may be implemented using any of a wide variety of devices or combinations of devices. An example device that may be used in implementing embodiments includes a computing device in the form of a computer . In this regard, the computer  may execute program instructions configured to compute correlated aggregates over a data stream, and perform other functionality of the embodiments, as described herein.","Components of computer  may include, but are not limited to, at least one processing unit , a system memory , and a system bus  that couples various system components including the system memory  to the processing unit(s) . The computer  may include or have access to a variety of computer readable media. The system memory  may include computer readable storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM) and\/or random access memory (RAM). By way of example, and not limitation, system memory  may also include an operating system, application programs, other program modules, and program data.","A user can interface with (for example, enter commands and information) the computer  through input devices . A monitor or other type of device can also be connected to the system bus  via an interface, such as an output interface . In addition to a monitor, computers may also include other peripheral output devices. The computer  may operate in a networked or distributed environment using logical connections (network interface ) to other remote computers or databases (remote device(s) ). The logical connections may include a network, such local area network (LAN) or a wide area network (WAN), but may also include other networks\/buses.","As will be appreciated by one skilled in the art, aspects may be embodied as a system, method or computer program product. Accordingly, aspects of the present invention may take the form of an entirely hardware embodiment, an entirely software embodiment (including firmware, resident software, micro-code, et cetera) or an embodiment combining software and hardware aspects that may all generally be referred to herein as a \u201ccircuit,\u201d \u201cmodule\u201d or \u201csystem.\u201d Furthermore, aspects of the present invention may take the form of a computer program product embodied in at least one computer readable medium(s) having computer readable program code embodied thereon.","Any combination of at least one computer readable medium(s) may be utilized. A computer readable storage medium may be, for example, but not limited to, an","electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system, apparatus, or device, or any suitable combination of the foregoing. More specific examples (a non-exhaustive list) of the computer readable storage medium would include the following: an electrical connection having at least one wire, a portable computer diskette, a hard disk, a random access memory (RAM), a read-only memory (ROM), an erasable programmable read-only memory (EPROM or Flash memory), an optical fiber, a portable compact disc read-only memory (CD-ROM), an optical storage device, a magnetic storage device, or any suitable combination of the foregoing. In the context of this document, a computer readable storage medium may be any non-signal medium that can contain or store a program for use by or in connection with an instruction execution system, apparatus, or device.","Program code embodied on a computer readable medium may be transmitted using any appropriate medium, including but not limited to wireless, wireline, optical fiber cable, RF, etc., or any suitable combination of the foregoing.","Computer program code for carrying out operations for embodiments may be written in any combination of at least one programming language, including an object oriented programming language such as Java, Smalltalk, C++ or the like and conventional procedural programming languages, such as the \u201cC\u201d programming language or similar programming languages. The program code may execute entirely on the user's computer, partly on the user's computer, as a stand-alone software package, partly on the user's computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario, the remote computer may be connected to the user's computer through any type of network, including a local area network (LAN) or a wide area network (WAN), or the connection may be made to an external computer (for example, through the Internet using an Internet Service Provider).","Embodiments are described with reference to figures of methods, apparatus (systems) and computer program products according to embodiments. It will be understood that portions of the figures can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer, special purpose computer, or other programmable data processing apparatus to produce a machine, such that the instructions, which execute via the processor of the computer or other programmable data processing apparatus, create means for implementing the functions\/acts specified.","These computer program instructions may also be stored in a computer readable medium that can direct a computer, other programmable data processing apparatus, or other devices to function in a particular manner, such that the instructions stored in the computer readable medium produce an article of manufacture including instructions which implement the function\/act specified. The computer program instructions may also be loaded onto a computer, other programmable data processing apparatus, or other devices to cause a series of operational steps to be performed on the computer, other programmable apparatus or other devices to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide processes for implementing the functions\/acts specified.","This disclosure has been presented for purposes of illustration and description but is not intended to be exhaustive or limiting. Many modifications and variations will be apparent to those of ordinary skill in the art. The example embodiments were chosen and described in order to explain principles and practical application, and to enable others of ordinary skill in the art to understand the disclosure for various embodiments with various modifications as are suited to the particular use contemplated.","Although illustrated example embodiments have been described herein with reference to the accompanying drawings, it is to be understood that embodiments are not limited to those precise example embodiments, and that various other changes and modifications may be affected therein by one skilled in the art without departing from the scope or spirit of the disclosure. \n\n\n\n"],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIGS. 2-4"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIGS. 5-7"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 14"}]},"DETDESC":[{},{}]}
