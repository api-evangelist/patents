---
title: System and method for establishing a secure communication link
abstract: An enterprise communication system adapted for establishing secure wireless communication sessions, the system comprising: an enterprise platform adapted for establishing communications sessions with one or more wireless devices, and for transmitting signals to and receiving signals from the one or more wireless devices; an platform-side automatic synchronized random key generator associated with the enterprise platform for generating platform-generated synchronized random keys; the enterprise platform being adapted to: receive one or more signals representing a request to establish a communication session between the enterprise platform and at least one wireless device; receive a device-generated synchronized random key from the at least one wireless device; compare the device-generated synchronized random key to a platform-generated synchronized random key synchronized to the device-generated synchronized random key; and based on the comparison, output a signal representing a response to authorize or prohibit establishment of the communication session.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08379860&OS=08379860&RS=08379860
owner: Research In Motion Limited
number: 08379860
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20090226
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD","BACKGROUND","DESCRIPTION OF EXAMPLE EMBODIMENTS"],"p":["The present application relates generally to telecommunications and, more specifically, to systems and methods for establishing secure communication links.","In a communication network, it is often desirable to verify the identity of a caller in an incoming call. This has been done by relying on caller identification (caller ID) from the calling party. However, there has arisen the practice of call spoofing, in which the calling party is able to adopt a spoofed caller ID different from its true caller ID. As a result, the receiving party may unknowingly accept a call from an unwanted caller. Thus, the communication link is not secure, as relying on the caller ID alone is an insecure way of identifying the calling party.","It would be desirable to provide a way to establish a secure communication link.","Similar reference numerals may have been used in different figures to denote similar components.","In one aspect, the present application provides an enterprise communication system adapted for establishing secure wireless communication sessions. The system comprises: an enterprise platform adapted for establishing communications sessions with one or more wireless devices, and for transmitting signals to and receiving signals from the one or more wireless devices; and an platform-side automatic synchronized random key generator associated with the enterprise platform for generating platform-generated synchronized random keys. The enterprise platform is adapted to: receive one or more signals representing a request to establish a communication session between the enterprise platform and at least one wireless device; receive a device-generated synchronized random key from the at least one wireless device; compare the device-generated synchronized random key to a platform-generated synchronized random key synchronized to the device-generated synchronized random key; and based on the comparison, output a signal representing a response to authorize or prohibit establishment of the communication session.","In another aspect, the present application provides a wireless device adapted for establishing secure wireless communication sessions with an enterprise platform and for transmitting signals to and receiving signals from the enterprise platform. The wireless device comprises: a device-side automatic synchronized random key generator for generating device-generated synchronized random keys. The wireless device is adapted to: receive one or more signals representing a request to establish a communication session between the wireless device and the enterprise platform; receive a platform-generated synchronized random key from the enterprise platform; compare the platform-generated synchronized random key to a device-generated synchronized random key synchronized to the platform-generated synchronized random key; and based on the comparison, output a signal representing a response to authorize or prohibit establishment of the communication session.","In another aspect, the present application provides a method, in a server of an enterprise platform, for establishing a secure communication link between a wireless communication device in an enterprise communications system and the enterprise platform. The method comprises: receiving one or more signals representing a request to establish a communication session from the wireless device; receiving a device-generated synchronized random key from the wireless device; receiving a platform-generated synchronized random key from the enterprise platform, the platform-generated synchronized random key being synchronized with the device-generated synchronized random key; comparing the device-generated synchronized random key and the platform-generated synchronized random key; and if the keys match, outputting one or more signals authorizing the establishment of the secure communication link between the wireless device and the platform.","In another aspect, the present application provides a method, in a wireless communication device in an enterprise communications system, for establishing a secure communication link between the wireless device and an enterprise platform. The method comprises: receiving one or more signals representing a request to establish a communication session from the platform; receiving a platform-generated synchronized random key from the platform; receiving a device-generated synchronized random key, the device-generated synchronized random key being synchronized with the platform-generated synchronized random key; comparing the device-generated synchronized random key and the platform-generated synchronized random key; and if the keys match, outputting one or more signals authorizing the establishment of the secure communication link between the wireless device and the platform.","Other aspects of the present application will be apparent to those of ordinary skill in the art from a review of the following detailed description in conjunction with the drawings.","Embodiments of the present application are not limited to any particular operating system, mobile device architecture, server architecture, or computer programming language.","The present application relates to the control and management of communications. Although reference may be made to \u201ccalls\u201d in the description of example embodiments below, it will be appreciated that the described systems and methods are applicable to session-based communications in general and not limited to voice calls. It will also be appreciated that the systems and methods may not be limited to sessions and may be applicable to messaging-based communications in some embodiments.","Reference is now made to , which shows, in block diagram form, an example system, generally designated , for the control and management of communications. The system  includes an enterprise or business system , which in many embodiments includes a local area network (LAN). In the description below, the enterprise or business system  may be referred to as an enterprise network . It will be appreciated that the enterprise network  may include more than one network and may be located in multiple geographic areas in some embodiments.","The enterprise network  may be connected, often through a firewall , to a wide area network (WAN) , such as the Internet. The enterprise network  may also be connected to a public switched telephone network (PSTN)  via direct inward dialing (DID) trunks or primary rate interface (PRI) trunks.","The enterprise network  may also communicate with a public land mobile network (PLMN) , which may also be referred to as a wireless wide area network (WWAN) or, in some cases, a cellular network. The connection with the PLMN  may be made via a relay , as known in the art.","The enterprise network  may also provide a wireless local area network (WLAN) featuring wireless access points. Other WLANs  may exist outside the enterprise network . For example, WLAN may be connected to WAN .","The system  may include a number of enterprise-associated mobile devices  (only one shown). The mobile devices  may include devices equipped for cellular communication through the PLMN , mobile devices equipped for Wi-Fi communications over one of the WLANs , or dual-mode devices capable of both cellular and WLAN communications. WLANs  may be configured in accordance with one of the IEEE 802.11 specifications.","It will be understood that the mobile devices  include one or more radio transceivers and associated processing hardware and software to enable wireless communications with the PLMN  and\/or one of the WLANs . In various embodiments, the PLMN  and mobile devices  may be configured to operate in compliance with any one or more of a number of wireless protocols, including GSM, GPRS, CDMA, EDGE, UMTS, EvDO, HSPA, 3GPP, or a variety of others. It will be appreciated that the mobile device  may roam within the PLMN  and across PLMNs, in known manner, as the user moves. In some instances, the dual-mode mobile devices  and\/or the enterprise network  are configured to facilitate roaming between the PLMN  and a WLAN , and are thus capable of seamlessly transferring sessions (such as voice calls) from a connection with the cellular interface of the dual-mode device  to the WLAN  interface of the dual-mode device , and vice versa.","The enterprise network  typically includes a number of networked servers, computers, and other devices. For example, the enterprise network  may connect one or more desktop or laptop computers  (one shown). The connection may be wired or wireless in some embodiments. The enterprise network  may also connect to one or more digital telephone sets  (one shown).","The enterprise network  may include one or more mail servers, such as mail server , for coordinating the transmission, storage, and receipt of electronic messages for client devices operating within the enterprise network . Typical mail servers include the Microsoft Exchange Server\u2122 and the IBM Lotus Domino\u2122 server. Each user within the enterprise typically has at least one user account within the enterprise network . Associated with each user account is message address information, such as an e-mail address. Messages addressed to a user message address are stored on the enterprise network  in the mail server . The messages may be retrieved by the user using a messaging application, such as an e-mail client application. The messaging application may be operating on a user's computer  connected to the enterprise network  within the enterprise. In some embodiments, the user may be permitted to access stored messages using a remote computer, for example at another location via the WAN  using a VPN connection. Using the messaging application, the user may also compose and send messages addressed to others, within or outside the enterprise network . The messaging application causes the mail server  to send a composed message to the addressee, often via the WAN .","The relay  serves to route messages received over the PLMN  from the mobile device  to the corresponding enterprise network . The relay  also pushes messages from the enterprise network  to the mobile device  via the PLMN .","The enterprise network  also includes an enterprise server . Together with the relay , the enterprise server  functions to redirect or relay incoming e-mail messages addressed to a user's e-mail address within the enterprise network  to the user's mobile device  and to relay incoming e-mail messages composed and sent via the mobile device  out to the intended recipients within the WAN  or elsewhere. The enterprise server  and relay  together facilitate \u201cpush\u201d e-mail service for the mobile device  enabling the user to send and receive e-mail messages using the mobile device  as though the user were connected to an e-mail client within the enterprise network  using the user's enterprise-related e-mail address, for example on computer .","As is typical in many enterprises, the enterprise network  includes a Private Branch exchange  (although in various embodiments the PBX may be a standard PBX or an IP-PBX, for simplicity the description below uses the term PBX to refer to both) having a connection with the PSTN  for routing incoming and outgoing voice calls for the enterprise. The PBX  is connected to the PSTN  via DID trunks or PRI trunks, for example. The PBX  may use ISDN signaling protocols for setting up and tearing down circuit-switched connections through the PSTN  and related signaling and communications. In some embodiments, the PBX  may be connected to one or more conventional analog telephones . The PBX  is also connected to the enterprise network  and, through it, to telephone terminal devices, such as digital telephone sets , softphones operating on computers , etc. Within the enterprise, each individual may have an associated extension number, sometimes referred to as a PNP (private numbering plan), or direct dial phone number. Calls outgoing from the PBX  to the PSTN  or incoming from the PSTN  to the PBX  are typically circuit-switched calls. Within the enterprise, e.g. between the PBX  and terminal devices, voice calls are often packet-switched calls, for example Voice-over-IP (VoIP) calls.","The enterprise network  may further include a Service Management Platform (SMP)  for performing some aspects of messaging or session control, like call control and advanced call processing features. The SMP  may, in some cases, also perform some media handling. Collectively the SMP  and PBX  may be referred to as the enterprise communications platform, generally designated . It will be appreciated that the enterprise communications platform  and, in particular, the SMP , is implemented on one or more servers having suitable communications interfaces for connecting to and communicating with the PBX  and\/or DID\/PRI trunks. Although the SMP  may be implemented on a stand-alone server, it will be appreciated that it may be implemented into an existing control agent\/server as a logical software component. As will be described below, the SMP  may be implemented as a multi-layer platform.","The enterprise communications platform  implements the switching to connect session legs and may provide the conversion between, for example, a circuit-switched call and a VoIP call, or to connect legs of other media sessions. In some embodiments, in the context of voice calls the enterprise communications platform  provides a number of additional functions including automated attendant, interactive voice response (IVR), call forwarding, voice mail, etc. It may also implement certain usage restrictions on enterprise users, such as blocking international calls or 1-900 calls. In many embodiments, Session Initiation Protocol (SIP) may be used to set-up, manage, and terminate media sessions for voice calls. Other protocols may also be employed by the enterprise communications platform , for example, Web Services, Computer Telephony Integration (CTI) protocol, Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions (SIMPLE), and various custom Application Programming Interfaces (APIs), as will be described in greater detail below.","One of the functions of the enterprise communications platform  is to extend the features of enterprise telephony to the mobile devices . For example, the enterprise communications platform  may allow the mobile device  to perform functions akin to those normally available on a standard office telephone, such as the digital telephone set  or analog telephone set . Example features may include direct extension dialing, enterprise voice mail, conferencing, call transfer, call park, etc.","Reference is now made to , which show example embodiments of the enterprise communications system . Again, although references are made below to \u201ccalls\u201d or call-centric features it will be appreciated that the architectures and systems depicted and described are applicable to session-based communications in general and, in some instances, to messaging-based communications.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 2","b":["16","18","60","60","16","18"]},"In this embodiment, the SMP  assumes control over both call processing and the media itself. This architecture may be referred to as \u201cFirst Party Call Control\u201d. Many of the media handling functions normally implemented by the PBX  are handled by the SMP  in this architecture. Incoming calls addressed to any extension or direct dial number within the enterprise, for example, are always first routed to the SMP . Thereafter, a call leg is established from the SMP  to the called party within the enterprise, and the two legs are bridged. Accordingly, the SMP  includes a digital trunk interface  and a digital signal processing (DSP) conferencing bridge . The DSP conferencing bridge  performs the bridging of calls for implementation of various call features, such as conferencing, call transfer, etc. The digital trunk interface  may be implemented as a plurality of telephonic cards, e.g. Intel Dialogic cards, interconnected by a bus and operating under the control of a processor. The digital trunk interface  may also be partly implemented using a processor module such as, for example, a Host Media Processing (HMP) processor.","The SMP  may include various scripts  for managing call processing. The scripts  are implemented as software modules, routines, functions, etc., stored in non-volatile memory and executed by the processor of the SMP . The scripts  may implement call flow logic, business logic, user preferences, call service processes, and various feature applications.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 3","b":["14","16","18","18","18"]},"The call control server  is coupled to the PBX , for example through the LAN, enabling packet-based communications and, more specifically, IP-based communications. In one embodiment, communications between the PBX  and the call control server  are carried out in accordance with SIP. In other words, the call control server  uses SIP-based communications to manage the set up, tear down, and control of media handled by the PBX . In one example embodiment, the call control server  may employ a communications protocol conforming to the ECMA-269 or ECMA-323 standards for Computer Supported Telecommunications Applications (CSTA).",{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 4","b":["14","18","74","74","18","72","76","72","76","72","74"]},"The SIP server  interacts with the media server  using SIP-based media handling commands. For example, the SIP server  and media server  may communicate using Media Server Markup Language (MSML) as defined in IETF document Saleem A., \u201cMedia Server Markup Language\u201d, Internet Draft, draft-saleem-msml-07, Aug. 7, 2008. The media server  may be configured to perform Host Media Processing (HMP).","Other architectures or configurations for the enterprise communications system  will be appreciated by those ordinarily skilled in the art.","Reference is now made to , collectively referred to as , which shows another embodiment of the enterprise communications system  with a Third Party Call Control architecture. In this embodiment, the SMP  is a multi-layer platform that includes a protocol layer , a services layer  and an application layer . The protocol layer  includes a plurality of interface protocols configured for enabling operation of corresponding applications in the application layer . The services layer  includes a plurality of services that can be leveraged by the interface protocols to create richer applications. Finally, the application layer  includes a plurality of applications that are exposed out to the communication devices and that leverage corresponding ones of the services and interface protocols for enabling the applications.","Specifically, the protocol layer  preferably includes protocols which allow media to be controlled separate from data. For example, the protocol layer  can include, among other things, a Session Initiation Protocol or SIP , a Web Services protocol , an Application Programming Interface or API , a Computer Telephony Integration protocol or CTI , and a Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions or SIMPLE protocol . It is contemplated that the interface protocols - are plug-ins that can interface directly with corresponding servers in the enterprise network , which will be further described below.","For the purposes of this disclosure, SIP  will be utilized, although it is appreciated that the system  can operate using the above disclosed or additional protocols. As known by those of ordinary skill in the art, SIP is the IETF (Internet Engineering Task Force) standard for multimedia session management, and more specifically is an application-layer control protocol for establishing, maintaining, modifying and terminating multimedia sessions between two or more endpoints. As further known by those of ordinary skill in the art, the SIP protocol  includes two interfaces for signaling: SIP-Trunk (hereinafter referred to as \u201cSIP-T\u201d) and SIP-Line (hereinafter referred to as \u201cSIP-L\u201d). Specifically, the SIP-T interface is utilized when the endpoint is a non-specific entity or not registered (i.e., when communicating between two network entities). In contrast, the SIP-L interface is utilized when the endpoint is registered (i.e., when dialing to a specific extension). The specific operation of the system  utilizing SIP  will be described in further detail below.","The SMP  also includes a plurality of enablers, among other things, a VoIP enabler , a Fixed Mobile Convergence or FMC enabler , a conference services enabler , a presence enabler  and an Instant Messaging or IM enabler . Each of the enablers - are used by corresponding services in the services layer  that combine one or more of the enablers. Each of the applications in the application layer  is then combined with one or more of the services to perform the desired application. For example, a phone call service may use the VoIP or PBX enabler, and an emergency response application may use the phone call service, an Instant Messenger service, a video call service, and email service and\/or a conference service.","The application layer  may include a conference services application  that, together with the conference services enabler , enables multiple communication devices (including desk telephones and personal computers) to participate in a conference call through use of a centralized conference server . As seen in , the conference server  is provided in the enterprise network  and is in communication with the conference services enabler  preferably through the SIP protocol , although it is recognized that additional protocols that control media separate from data may be appropriate, such as the Web Services protocol  or the CTI protocol . As will be described in further detail below, the conference call server  is configured for directing media and data streams to and from one or more communication devices (i.e., mobile devices , telephones , and computers ).","Turning now to , the general operation of the system  using SIP  as the signaling protocol will be discussed, although it is recognized that the present system is not limited to the processes discussed herein. The signaling descriptions that follow are based on Third Party Call Control architecture, such as that illustrated in  or . It will be appreciated that similar but slightly modified signaling may be used in a First Party Call Control architecture, wherein the PBX  will pass media through to the SMP  for direct media handling by the SMP . Variations in the signaling to adapt to various architectures will be appreciated by those ordinarily skilled in the art.",{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 6A","b":["11","101","16","20","11","101","18","100","12","16","18","11","102","11","16","104","16","18","16","18","106","18","16","108"]},"The SMP  then sets up the outgoing call leg to the destination. It does this by sending an invite over SIP-L to the PBX  with the destination number of the target phone (block ). SIP-L is used so that the call can be correctly attributed to the individual within the organization within any call records that are being maintained by the PBX . When the invite is received, the PBX  dials the destination number to the target phone  (block ), and the target phone  answers the call (block ). When the target phone  is answered, the PBX  sends a 200 OK signal to the SMP  indicating that the target phone  is ready to receive data (block ). The SMP  then sends an invite over SIP-T to the PBX  and shuffles the SDP (Session Description Protocol, as known to those of ordinary skill in the art) to connect the call legs (block ). When the call legs are connected, the PBX  sends a second 200 OK signal to the SMP  (block ), and the users of the device  and target phone  can communicate with each other.","Note that between the cellular call leg being established and the outgoing call leg being answered, the mobile user hears ringing tones. These ringing tones may be provided by the PBX  using the presentation of early media from the outgoing call leg, or they may be generated locally on the device  if early media is not available. In the latter case, it will be necessary to localize the ringing tone to match the tone normally heard with a call through the PBX .","The above description is known as a \u201cmobile initiated\u201d call, because the SMP  provides the mobile device  with the DNIS number into which the mobile device  has called. Alternatively, the mobile originated call could be \u201cPBX initiated\u201d, as shown in . Specifically, in a PBX-initiated call, upon receipt of the mobile originated call request (block ), the SMP  confirms receipt of the call to the mobile device  with an ANI number (block ), which the mobile device uses to identify the incoming call from the PBX . The PBX  then sends an invite over SIP-T to the PBX  with the cellular number of the device and the ANI number that is attached to the outgoing call (block ). Upon receipt of the invite, the PBX  makes a cellular call to the device  (block ), which is answered by the device (block ). The device  checks the ANI number in the incoming call to confirm if the number is actually from the PBX . If the ANI number is stripped for any particular reason, then the device  may be configured to answer the call as a regular cellular call, or it may reject the call as unknown. When the device  answers the PBX-initiated call, the PBX  sends a 200 OK signal to the SMP , indicating that the call leg to the device is established (block ).","In response, the SMP  sends an invite over SIP-L with the destination number of the target phone  to the PBX  (block ). When the invite is received at the PBX , the PBX dials the destination number to the target phone  (block ), the target phone  picks up the call (block ), and a 200 OK signal is sent from the PBX  to the SMP  (block ), indicating that the target phone  is also ready to receive data. In response to the 200 OK, the SMP  sends an invite to the PBX , shuffling the SDP to connect the call legs (block ). Finally, when the call legs are connected, the PBX  sends a second 200 OK signal to the SMP , and the users of the device  and target phone  are able to communicate with each other.","In both instances, the SMP  is performing third party call control of the two call legs, the PBX  remaining in control of the call. The decision of whether to proceed with a mobile-initiated call or a PBX-initiated call can be set by policy. Specifically, the option to select either mobile-initiated or PBX-initiated calls is a feature provided in the SMP , and an administrator for the enterprise network  can determine which setting to use. For example, in some cases it may be more cost effective for the corporation to utilize PBX-initiated calls rather than mobile-initiated calls, and vice versa. However, it is appreciated that the system  is not limited to the above processes.",{"@attributes":{"id":"p-0063","num":"0062"},"figref":["FIGS. 7A and 7B","FIG. 7A"],"b":["80","101","101","16","150","16","16","18","152"]},"In response to the invite, the SMP  sends a call request with the DNIS number and source details to the device  (block ), which is confirmed to the SMP (block ). In addition to confirming the call, the mobile device  sends a cellular call to the DNIS number at the PBX  (block ). Again, as the DNIS number is routed in the dialing plans to the SMP , upon receipt of the cellular call, the PBX  sends an invite over SIP-T to the SMP  with the DNIS number (block ). In response to the invite, a \u201c200 OK\u201d signal is sent over SIP-T from the SMP  to the PBX , acknowledging that the call leg to the mobile device  is established (block ). Finally, the initial invite (block ) is acknowledged with the \u201c200 OK\u201d signal with the cellular SDP, at which point the call legs are joined and the target phone  and device  can communicate with each other on the call.","The diagram shown in  illustrates a \u201cmobile-initiated\u201d call, because, as discussed above with respect to , the SMP  presents the mobile device  with the DNIS number at the PBX  into which to call. However, it is also possible to employ a \u201cPBX-initiated\u201d mobile terminated call, as shown in , where the PBX  sends an incoming call to the device  with the ANI number of the target phone .","Specifically, similar to the mobile initiated call described above and shown in , the target phone  sends an incoming call to the destination number of the device, which is received at the PBX  (block ). Upon receipt of the call, the PBX  sends an invite over SIP-L to the SMP  (block ) with the source number of the target phone . In response to the invite, the SMP  sends a call request with the source number to the device  (block ), with the ANI number the device should expect in the incoming call, the call request being confirmed by the device (block ). At this point in the PBX-initiated call, the SMP  sends an invite over SIP-T to the PBX  with the cellular number and ANI number to use (block ), prompting the PBX  to make a cellular call to the device  with the ANI number (block ), prompting the device to ring. The device  answers the call (block ), and a \u201c200 OK\u201d signal is sent from the PBX  to the SMP , acknowledging that the cellular call leg to the device  is established (block ). In response, a \u201c200 OK\u201d signal is also sent from the SMP  to the PBX , acknowledging that the call leg to the target phone  is also established (block ). The SMP  shuffles the SDP to connect the call legs, the call legs are joined, and the target phone  and device  can communicate with each other on the call.","As discussed above with respect to , the SMP  may remain in control of the signaling between the target phone  and the mobile device  in both the mobile-initiated and PBX-initiated calls. Again, the decision to proceed with a mobile-initiated call or a PBX-initiated call may be based on policy and may be set by a system administrator. In some cases, it may be more efficient or cost effective for the administrator to decide that PBX-initiated calls should be used, and in other cases, it may be more efficient or cost effective for mobile-initiated calls to be utilized. As these policy decisions may vary by organization and are not imperative to the scope of the present application, they will not be discussed in further detail.","Notably, the transmission of the DNIS\/ANI occur prior to establishing a secure communication link between the device and the server. Typically, as described above, this transmission takes place over a secure data connection. However, in situations where a secure data connection is not available (e.g., where the device is in a location with cellular phone service but no available data connection), identification and validation of an incoming call to the device would be limited to the existing ANI (i.e., caller ID) of the incoming call device, which is less secure, as incoming call numbers may be spoofed.","Reference is now made to , showing, in block diagram form, a system which may be used to establish a secure communication link where a data connection is not available. Selected details of the device  and the enterprise communication platform  are shown.","The device  and the enterprise communication platform  are associated with a device-side automatic synchronized random key generator  and a platform-side automatic synchronized random key generator , respectively. The device-side key generator  may be a component of the device  as shown, for example it may be a module stored in the memory of the device ; or the device-side key generator  may be an external component that is securely associated with the device , for example it may be a module stored in a separate device that communicates with the device  via a short-range connection such as Bluetooth. The platform-side key generator  may be a component of the PBX  as shown, for example it may be a module stored in the memory of the PBX . Alternatively, the platform-side key generator  may be a component of the SMP  that communicates with the PBX ; or the platform-side key generator  may be separate from both the PBX  and the SMP  within the enterprise communication platform .","The device-side key generator  and the platform-side key generator  are synchronized to each other, such that each generator ,  generates the same synchronized random key at the same time without needing any communication between the two. By synchronized random key is meant that the key generated may appear to be random, but is predictable based on certain information that is private to the two generators ,  and is synchronized between the two generators ,  so that the two generators ,  separately generate the same key at about the same time. These keys may include alphanumeric characters, symbols, or may be entirely numerical. This synchronized generation may be based on each generator ,  being designed to generate synchronized random keys using a predictable secure method (e.g., this may be programmed and synchronized at the time of manufacture of the device ), synchronized to each other. Suitable methods for generation of the keys include the use of a hash key, the use of random number generators having a degree of predictability, and the use of strange attractors. These methods and their variations would be suitable and known to persons skilled in the art, as well as other methods of securely generating synchronized random keys in a predictable and synchronizable way. The keys may be refreshed by each generator ,  at synchronized time periods. The time period for refreshing may be preset to accommodate the typical time required for initiating a call. For example, the time period may range from a minimum of about 5 seconds to a maximum of about 1 minute. Each refreshed key may be stored in historical data (e.g., in a memory component of the device  and the platform ) until the key is replaced at the next refreshing. The key may be generated by the generator ,  as a series of about 10 digits, for example where the key is dialed like a phone number; or the generator ,  may generate a longer series of digits which is then mapped to a dialable series of digits to create the key. The key generators ,  are automatic in that no input or request is needed for a key to be generated.","In the absence of a data connection, the calling party, the platform  or the device , may call the other using a generated key. This key may be verified by the receiving party, the other of the platform  and the device , against its own key generated by itself. Thus the receiving party may verify that the call is being made from the calling party and is not a spoofed call from a third party. Having verified the identity of the calling party, the receiving party may accept the call and a secure communication link is thus established.","Referring to , methods  and  are shown in flowchart form for establishing a secure communication link in an enterprise communications network in accordance with some embodiments. The methods  and  may be useful, for example, where there is no data connection available between the device  and the enterprise communications platform .","As described above with reference to , there is provided a device-side key generator  and a platform-side key generator , which are synchronized to each other.","Method  begins at block . In this example, a secure communication link is established for a PBX-initiated, or more generally a platform-initiated, call.","At block , a request from the platform  to establish a communication link is received at the device . The request includes a platform-generated synchronized random key generated at the platform-side key generator . Generation of this platform-generated key may be through the use of a hash key known to both the platform-side and the device-side generators ,  or any other method as discussed above. The platform-side key may be newly generated at the time that the call is made. Alternatively, the device-side key may be retrieved from historical data. The historical data may include a record of the last generated key.","At block , the platform-generated key is received at the device  and is compared to a device-generated synchronized random key generated at the device-side key generator . The platform-generated key may be received in the form of a calling party number, for example where the platform-generated key is a dialable series of digits. Common call-ID detection methods may be used. The comparison may be performed by a comparator associated with the device-side key generator . The device-generated key may be generated in response to reception of the request from the platform . Alternatively, the device-generated key may have been generated in parallel with the platform-generated key and may be retrieved from historical data.","At block , the two keys are compared and based on the comparison, establishment of the communication session may be authorized or prohibited. In this example, the keys are verified to be the same. Thus, the identity of the platform  may be verified to the device .","At block , a secure communication link between the device  and the platform  is established. This may include the device  accepting or answering the call from the platform .","Method  begins at block . In this example, a secure communication link is established for a device-initiated call. The steps may be similar to those described for the method , but accordingly mirrored.","At block , a request from the device  to establish a communication link is received at the platform . The request includes a device-generated synchronized random key generated at the device-side key generator . Generation of this device-generated key may be through the use of a hash key known to both the platform-side and the device-side generators ,  or any other method as discussed above. Similar to the method , the device-generated key may be retrieved from historical data.","At block , the device-generated key is received at the platform  and is compared to a platform-generated key generated at the platform key generator . The device-generated key may be received in the form of the number being dialed to the platform, for example where the device-generated key is a dialable series of digits. Common call-ID detection methods may be used. The comparison may be performed by a comparator associated with the platform-side key generator . Similar to the method , the platform-generated key may be retrieved from historical data.","At block , the two keys are compared, and based on the comparison, establishment of the communication session may be authorized or prohibited. In this example, the keys are verified to be the same. Thus, the identity of the device  may be verified to the platform .","At block , a secure communication link between the platform  and the device  is established.","Reference is now made to .  are signaling diagrams showing general processes for establishing a secure communication link in an enterprise communications network in accordance with some embodiments. The  generally may be suitable for carrying out the methods  and , respectively.","Reference is first made to , which shows a general process for establishing a secure communication link for a PBX-initiated, or more generally platform-initiated, call.","At a block , an incoming call request from the target phone  is received at the PBX .","At a block , a platform-generated synchronized random key is generated by the platform-side key generator . As discussed previously, the platform-generated key may alternatively be retrieved from historical data rather than being newly generated. As previously discussed, the platform-side key generator  may, for example, be provided in the PBX , in the SMP , or elsewhere in the enterprise platform .","At a block , the PBX  makes a call to the device  using the platform-generated key. The platform-generated key may be detected by the device .","At a block , a device-generated synchronized random key is generated by the device-side key generator  and is used to verify a match with the platform-generated key. As discussed previously, the device-generated key may alternatively be retrieved from historical data rather than being newly generated.","At a block , having verified a match between the two keys and hence verified the identity of the PBX , the device  answers the call.","At a block , a \u201c200 OK\u201d signal is sent from the PBX  to the SMP , acknowledging that the cellular call leg to the device  is established.","At a block , a \u201c200 OK\u201d signal is sent from the SMP  to the PBX  in response, acknowledging that the call leg to the target phone  is also established.","Reference is now made to , which shows a general process for establishing a secure communication link for a device-initiated call.","At a block , a device-generated synchronized random key is generated by the device-side key generator . As discussed previously, the device-generated key may alternatively be retrieved from historical data rather than being newly generated. As previously discussed, the device-side key generator  may, for example, be a module resident in the memory of the device , or may be a module external to the device .","At a block , the device  makes a call to the PBX  using the device-generated key. The device-generated key may be detected by the PBX .","At a block , a platform-generated synchronized random key is generated by the platform-side key generator  and is used to verify a match with the device-generated key. As discussed previously, the platform-generated key may alternatively be retrieved from historical data rather than being newly generated.","At a block , having verified a match between the two keys and hence verified the identity of the PBX , the PBX  sends an invite over SIP-T to the SMP . The invite may include the number that was dialed, for example where the device-generated key was used to dial in to the platform.","At a block , \u201c2:00 OK\u201d signal is sent over SIP-T from the SMP  to the PBX , acknowledging that the call leg to the mobile device  is established.",{"@attributes":{"id":"p-0100","num":"0099"},"figref":"FIGS. 9A and 9B","b":["11","14","101"]},"Certain adaptations and modifications of the described embodiments can be made. Therefore, the above discussed embodiments are considered to be illustrative and not restrictive."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Reference will now be made, by way of example, to the accompanying drawings which show example embodiments of the present application, and in which:",{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":["FIGS. 5A and 5B","FIG. 3"]},{"@attributes":{"id":"p-0011","num":"0010"},"figref":["FIG. 6A","FIG. 5"]},{"@attributes":{"id":"p-0012","num":"0011"},"figref":["FIG. 6B","FIG. 5"]},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 7A","FIG. 5"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 7B","FIG. 5"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 8A"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 8B"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIG. 9A","FIG. 8A"]},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 9B","FIG. 8B"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 10"}]},"DETDESC":[{},{}]}
