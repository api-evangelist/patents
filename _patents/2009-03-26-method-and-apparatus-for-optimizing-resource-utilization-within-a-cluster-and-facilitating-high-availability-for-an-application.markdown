---
title: Method and apparatus for optimizing resource utilization within a cluster and facilitating high availability for an application
abstract: A method and apparatus for optimizing resource utilization within a cluster and facilitating high availability for an application is described. In one embodiment, the method for optimizing resource utilization within a cluster and facilitating high availability for an application includes accessing configuration information regarding virtual machine nodes within the cluster to identify an active node and at least one passive node that are associated with the application and configuring the at least one passive node to be in a suspended state, wherein a passive node of the at least one passive node is to be in a running state and the active node is to be in a suspended state upon migration of the application to the passive node of the at least one passive node.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08930539&OS=08930539&RS=08930539
owner: Symantec Corporation
number: 08930539
owner_city: Mountain View
owner_country: US
publication_date: 20090326
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","Embodiments of the present invention generally relate to cluster resource management and, more particularly, to a method and apparatus for optimizing resource utilization within a cluster and facilitating high availability for an application.","2. Description of the Related Art","In a typical computing environment, small to large enterprises utilize various virtualization techniques to host mission critical applications. For example, one or more virtual machines may be installed on one or more physical machines (e.g., a computer, a server and\/or the like). Further, the virtual machines are abstract representations of the physical machines and executes like a real physical machine. As such, the mission critical applications (hereinafter, the applications) are required to run continuously, and uninterruptedly. In other words, the applications need to be highly available.","In particular, the one or more virtual machines are linked to each other to form a cluster to provide application services to one or more client computers. As such, certain failures may occur within hardware devices or software components within the cluster. For example, a hard disk of a particular physical machine, which hosts a particular virtual machine, may crash. As a result, the application running on the virtual machine may not operate properly. In such instances, the application is failed over to another virtual machine in order to facilitate high availability of the application.","Currently, clustering software may be employed to manage the virtual machines and failover the applications from one virtual machine to another virtual machine within the cluster. Such clustering software needs to continuously track a state of each virtual machine within the cluster to determine whether a certain virtual machine is alive or dead. In particular, the clustering software sends Transmission Control Protocol\/Internet Protocol (TCP\/IP) heartbeats from a virtual machine to each of the nodes indicating either that the virtual machine is operational or non-operational. In such instance, the application may be failed over from one virtual machine to another virtual machine in case of any failure. However, if the virtual machine is powered off, no heartbeat is communicated and the virtual machine is considered to be dead. Hence, the application cannot be migrated to the powered off virtual machine. As a result, the clustering software requires each and every virtual machine within the cluster to be in a running state. Such a requirement wastes valuable computer resources.","Therefore, there is a need in the art, for a method and apparatus for optimizing resource utilization within a cluster and facilitating high availability for an application.","Embodiments of the present invention generally comprise a method and apparatus for optimizing resource utilization within a cluster and facilitating high availability for an application. In one embodiment, a method for optimizing resource utilization within a cluster and facilitating high availability for an application includes accessing configuration information regarding virtual machine nodes within the cluster to identify an active node and at least one passive node that are associated with the application and configuring the at least one passive node to be in a suspended state, wherein a passive node of the at least one passive node is to be in a running state and the active node is to be in a suspended state upon migration of the application to the passive node of the at least one passive node.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1","b":["100","100","102","104","106"]},"The server  is a type of computing device (e.g., a laptop, a desktop, a Personal Digital Assistant (PDA), a tablet PC, a mobile phone and\/or the like), such as those generally known in the art. The server  includes a Central Processing Unit (CPU) , various support circuits  and a memory . The CPU  may comprise one or more commercially available microprocessors or microcontrollers that facilitate data processing and storage. The various support circuits  facilitate operation of the CPU  and may include one or more clock circuits, power supplies, cache, input\/output circuits and the like. The memory  comprises at least one of Read Only Memory (ROM), Random Access Memory (RAM), disk drive storage, optical storage, removable storage and the like. The memory  includes various software packages, such as a policy master  and cluster software . The memory  further includes various data, such as configuration information .","Generally, the network  comprises a communication system that connects computers by wire, cable, fiber optic and\/or wireless link facilitated by various types of well-known network elements, such as hubs, switches, routers and the like. The network  may employ various well-known protocols to communicate information amongst the network resources. For example, the network  may be a part of the Internet or Intranet using various communications infrastructure, such as Ethernet, Wi-Fi, WiMAX, General Packet Radio Service (GPRS) and\/or the like. Furthermore, the network  may form a portion of a Storage Network Area (SAN) using various communications infrastructure such as Ethernet, Internet Small Computer System Interface (iSCSI), Fibre Channel, Infiniband and\/or the like.","Generally, the plurality of nodes  are computing devices (e.g., virtual machines) that include various resources  (illustrated as resources . . . resources corresponding to the node . . . the node respectively). Furthermore, the resources  may include application resources, replication resources, database resources, network resources, storage resources and\/or the like. In one embodiment, service groups may be configured to utilize various portions of the resources  to provide an application to one or more end users (e.g., a client computer). For example, the application may be a database that depends on various computer resources, such as network resources (e.g., Virtual IP addresses, Network Interface Cards (NICs) and\/or the like), storage resources (e.g., physical disks, magnetic tape drives and\/or the like), software resources (e.g., operating system processes, application processes and\/or the like), file system resources (e.g., mounted volumes, network shared partitions and\/or the like) and\/or the like.","According to various embodiments, the plurality of nodes  may include one or more virtual machine nodes that form a cluster. As such, the one or more virtual machine nodes may be one or more virtual machines that are running on one or more physical machines (e.g., a physical computer). As described further below, an application that is required to be highly available is installed on each virtual machine of the one or more virtual machines. Furthermore, a service group for operating the application is configured on the each virtual machine of the one or more virtual machines.","According to various embodiments, the plurality of nodes  may operate in an active-passive configuration. In other words, a particular node of the plurality of nodes  functions as an active node at a particular time while one or more remaining nodes of the plurality of nodes  are configured to be passive nodes. For example, the active node may be a virtual machine in a running state (i.e., the application is online). Furthermore, the passive nodes (i.e., standby nodes) may be virtual machines in a suspended state. Accordingly, an operating system of each passive node is fully booted but the application (e.g., service group) is offline.","According to one or more embodiments, the policy master  includes software code that is configured to monitor the plurality of nodes  in order to optimize utilization of the resources  and provide high availability to an application. In one embodiment, the policy master  continuously monitors states of one or more passive nodes to maintain each and every passive node in a suspended state. The policy master  examines the configuration information  as explained further below. Furthermore, the policy master  is configured to identify a failure of the resources  on any node of the plurality of nodes . During a subsequent failover operation, the policy master  instructs the cluster software  to migrate the application from the active node to the passive node as explained further below.","The configuration information  indicates a state for each node (e.g., virtual machine node) of the plurality of nodes  within the cluster. In one embodiment, the configuration information  indicates an active node and one or more passive nodes for an application. As such, the configuration information  may be used to identify an active node for operating the application as well as one or more passive nodes amongst the plurality of nodes . In another embodiment, the configuration information  is utilized by the policy master  to select a passive node from the one or more passive nodes to which the application is to be migrated (e.g., failed over) from the active node in an event of any failure (e.g., a software fault).","In one embodiment, the policy master  communicates queries related to the plurality of nodes  to determine and maintain a state of a particular node (e.g., virtual machine node). For example, the policy master  may be coupled with a server that manages a plurality of computers that host the plurality of nodes  (e.g., virtual machines). Accordingly, the policy master  uses an Application Programming Interface (API) associated with the server to determine a state of a particular node of the plurality of nodes . Alternatively, the policy master  is directly coupled with the plurality of host computers and utilizes a host virtual machine management API to determine a state of a particular node of the plurality of nodes . In addition, the policy master  updates the configuration information  in response to any modification to a state associated with the particular node of the plurality of nodes . By maintaining the particular node in the suspended state, the policy master  considers the particular node to be alive and therefore, available as a failover target for the application.","In one or more embodiments, the policy master  and the cluster software  cooperate to optimize resource utilization and provide high availability to an application (e.g., Word processors, spreadsheets, media players, database applications and\/or the like). Generally, the cluster software  operates in accordance with instructions from the policy master . For example, if the policy master  identifies an occurrence of a hardware failure or software fault at a certain active node, the policy master  instructs the cluster software  to migrate the application from the certain active node to a passive node. During the migration, the policy master  configures the active node to be in a suspended state and the passive node to be in a running state. For example, the cluster software  stops the application (e.g., set to offline) and suspends the active node. Then, the cluster software  resumes the passive node and initiates the application (e.g., brings online). Alternatively, the cluster software  resumes the active node from the suspended state and initiates the application on the active node instead of the passive node, if there is no passive node configured.",{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2","b":["202","204","206","208","204","216","210","212","214","204","206","208"]},"Generally, a service group (e.g., a VERITAS CLUSTER SERVER (VCS) ONE service group) includes one or more hardware and\/or software resources at one or more nodes (e.g., the node ), required to run applications (e.g., the application ) on the respective node. In one embodiment, the service group enables control over one or more of the hardware resources (e.g., a network resource, such as a Network Interface Card (NIC)) and software resources (e.g., a process, such as a web application process) associated with operating application (e.g., the application ) as a single unit. On occurrence of a fault, the hardware and software resources do not fail over individually, but the entire service group is failed over.","As an example, the application  may be currently online on the node  and offline at the node  and the node . Generally, the policy master  continuously monitors the node , the node  and the node . In one embodiment, the policy master  sends a query to each of the physical machines that host each of the virtual machines. In one embodiment, the policy master  is connected directly to each of the physical machines and utilizes the virtual machine management Application Programming Interface (API) (e.g., VMware Host Software Development Kit (SDK), Hyper-V Virtualization WMI provider and\/or the like) to determine a state of each of the virtual machines installed on a physical machine. In another embodiment, the policy master  communicates with a server that manages each of the physical machines and utilizes an API provided by such a server to determine a state of each of the virtual machines.","In one or more embodiments, if the policy master  identifies that the application  on the node  is not operating properly, the policy master  selects the node  as a failover target. For example, a software fault may occur within the node , which disrupts the service group . As a result, the application  is inoperable. Accordingly, the application  is migrated to the node .",{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 3","FIG. 1","FIG. 1","FIG. 2"],"b":["300","300","302","304","104","116","202"]},"At step , configuration information (e.g., the configuration information  of ) is examined. At step , a determination is made as to whether there are any passive nodes for the application. In one embodiment, the policy master examines the configuration information to identify an active node for operating the application as well as one or more passive nodes. If at step , it is determined that there are no passive nodes (option \u201cNO\u201d), then the method  proceeds to step . If at step , it is determined that there are one or more passive nodes (option \u201cYES\u201d), then the method  proceeds to step . At step , the one or more passive nodes are suspended. For example, the policy master instructs cluster software (e.g., the cluster software  of ) to suspend the one or more passive nodes. Accordingly, the cluster software suspends the passive nodes.","At step , a determination is made as to whether an application (e.g., the application  of ) is to be migrated. If at step , it is determined that the application is not to be migrated (option \u201cNO\u201d), then the method  proceeds to step . If at step , it is determined that the application is to be migrated (option \u201cYES\u201d), then the method  proceeds to step . At step , the application at an active node is stopped. In one embodiment, the policy master instructs the cluster software to offline the application at the active node. At step , the active node is suspended. In one embodiment, the policy master instructs the cluster software to suspend the active node only after halting the application.","At step , a passive node is resumed. For example, the cluster software resumes the passive node on which the application is to be failed over, as determined by the policy master. After step , the method  proceeds to step , at which the application on the passive node is started. At step , the configuration information is updated. For example, the policy master updates the configuration information to include a current status of nodes. For example, the active node is now passive and in a suspended state. Furthermore, the resumed passive node is now active and in a running state. At step , the method  ends.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 4","FIG. 1","FIG. 1"],"b":["400","400","402","404","118","104"]},"At step , one or more queries related to the one or more passive nodes of the plurality of nodes are communicated. In one embodiment, a policy master (e.g., the policy master  of ) communicates the one or more queries related to the one or more passive nodes. The queries may be sent to a physical computer (i.e., physical server) that is hosting one or more virtual machine nodes. Alternatively, the queries may be sent to a management server for one or more physical computers that host the one or more virtual machine nodes. At step , results of the one or more queries are processed. At step , a state for each passive node is determined. At step , the configuration information is modified. At step , the method  ends.","While the foregoing is directed to embodiments of the present invention, other and further embodiments of the invention may be devised without departing from the basic scope thereof, and the scope thereof is determined by the claims that follow."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["So that the manner in which the above recited features of the present invention can be understood in detail, a more particular description of the invention, briefly summarized above, may be had by reference to embodiments, some of which are illustrated in the appended drawings. It is to be noted, however, that the appended drawings illustrate only typical embodiments of this invention and are therefore not to be considered limiting of its scope, for the invention may admit to other equally effective embodiments.",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
