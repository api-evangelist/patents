---
title: Universal secure messaging for remote security tokens
abstract: An anonymous secure messaging method, system and computer program product for implementation over a wireless connection. The invention allows the securely exchange of information between a security token enabled computer system and an intelligent remote device having an operatively coupled security token thereto over the wireless connection. The invention establishes an anonymous secure messaging channel between the security token and the security token enabled computer system, which allows the intelligent remote device to emulate a locally connected security token peripheral device without requiring a physical connection. A dedicated wireless communications channel is incorporated to prevent several concurrent wireless connections from being established with the security token and potentially compromising the security of the information being sent on concurrent wireless connections.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08209753&OS=08209753&RS=08209753
owner: Activcard, Inc.
number: 08209753
owner_city: Fremont
owner_country: US
publication_date: 20031222
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","FEDERALLY SPONSORED RESEARCH AND DEVELOPMENT","REFERENCE TO A MIRCORFICHE APPENDIX","FIELD OF INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This application is a continuation in part to U.S. patent applications:","Ser. No. 10\/424,783, filed Apr. 29, 2003, entitled, \u201cUniversal Secure Messaging For Cryptographic Modules,\u201d now abandoned and","Ser. No. 09\/880,795, filed Jun. 15, 2001, entitled, \u201cMethod, System And Apparatus For A Portable Transaction Device\u201d now abandoned.","This application is a related application of the application, entitled \u201cIntelligent Remote Device,\u201d by inventors named Eric Le Saint and Dominique Fedronic and which was filed on Dec. 22, 2003.","The three aforementioned co-pending US patent applications are herein incorporated by reference in their entirety.","Not Applicable.","Not Applicable.","The present invention relates generally to a data processing system, method and computer program product and more specifically to a secure end-to-end wireless communications connection between a security token enabled computer system and an intelligent remote device having a security token operatively coupled thereto.","In high security operating environments, the US National Institute of Standards and Technology (NIST) specifies in FIPS PUB 140-2, \u201cSecurity Requirements For Security tokens,\u201d for security levels 3 and 4 that critical security parameters (CSP) such as authentication data, passwords, PINs, CSPs, biometric samples, secret and private cryptographic keys be entered into or output from a security token in an encrypted form, generally using some form of physical and\/or logical trusted path or secure messaging channel to prevent interception of the critical security parameters.","The security tokens referred to in this specification include hardware based security devices such as cryptographic modules, smart cards, integrated circuit chip cards, portable data carriers (PDC), personal security devices (PSD), subscriber identification modules (SIM), wireless identification modules (WIM), USB token dongles, identification tokens, secure application modules (SAM), hardware security modules (HSM), secure multi-media token (SMMC), trusted platform computing alliance chips (TPCA) and like devices.","Attempts at providing a physical trusted path include the use of cryptographic hardware devices installed between input devices such as the keyboard and possibly the mouse. An example of such a cryptographic interface device is disclosed in U.S. Pat. No. 5,841,868 to Helbig. However, the hardware expenditures and added administrative burden greatly increases the cost of the computer system.","In another approach, U.S. Pat. No. 4,945,468 to Carson, et al., a trusted path is generated by providing a new virtual terminal window which allows secure entry of CSPs. The new virtual terminal window is effectively isolated from other running processes. This method is a reasonably secure approach but does not extend the trusted path to peripheral security devices such as cryptography modules, security tokens and biometric scanners.","In yet another approach, US patent application 2002\/0095587 to Doyle, et al. discloses a wireless SSL or equivalent connection which utilizes negotiated time-limited cryptography keys to maintain a chain of trust between interconnected security devices. However, the mechanism disclosed relies heavily on multiple public key cryptography key pairs which is difficult to maintain and may reduce overall performance due to relatively slow transaction processing when employed using a smart card. In addition, negotiation of time-limited cryptography keys relies on devices containing a system clock for changing of cryptographic keys. Smart cards and like devices do not include system clocks and thus are reliant of their host for providing event timing which may introduce security concerns when the host is not trusted.","Cryptographic mechanisms are available in the relevant art which could be adapted to encrypt an incoming CSP with a cryptographic key for secure transport through a security token enabled and eventual decryption by a security executive installed within the security token. However, the cryptographic mechanism employed by the security token enabled computer system must provide a sufficient level of security to prevent interception of the cryptographic keys used in encrypting the CSP and furthermore limits vulnerability to a replay type attack.","Another common vulnerability in the relevant art relates to the lack of ability to bind a CSP to a session, which potentially allows an unlocked security token to be accessed by an unauthorized entity. To address this potential vulnerability, the CSP is typically cached or stored and presented by software to the security token each time access is required. The cached or stored CSPs are likewise vulnerable to interception or compromise by an unauthorized entity.","Therefore, it would be highly advantageous to provide a secure CSP transport system which limits an intruder's ability to intercept a cryptographic key during wireless communications sessions, is relatively invulnerable to a replay type attack, minimizes requests for user input of CSPs already provided within a session and does not store or otherwise cache a CSP.","This invention addresses the limitations described above and provides an efficient secure end-to-end communications connection to securely exchange information between a security token enabled computer system and an intelligent remote device having a security token operatively coupled thereto. The method portion of the invention comprises the steps of performing a first security transaction which authenticates a security token to a security token enabled computer system, establishing a secure communications connection between the security token and the security token enabled computer system which incorporates a shared symmetric key set generated during the first security transaction, assigning at least one key from the shared symmetric key set to a dedicated communications channel accessible to the security token, and performing a second security transaction which authenticates a user to said security token.","In a related embodiment of the invention, additional steps are performed for signaling an affirmative result to the security token enabled computer system if the second security transaction is successful. In a related embodiment of the invention, the second security state is required before the secure communications connection is available for use by said security token.","The first security transaction is accomplished using a challenge\/response protocol which incorporates an asymmetric key pair. A challenge is generated by the security token enabled computer system and encrypted with the public key associated with the security token.","The encrypted challenge is then sent to the security token. The security token decrypts the challenge using the private key counterpart to the public key and returns the clear text challenge to the security token enabled computer system for verification.","The public key is transferred to the security token enabled computer system by way of a digital certificate as part of the establishing the wireless communications connection.","The second security transaction authenticates the user to the security token by the user's critical security parameter which is provided directly or indirectly to the security token via the intelligent remote device. Once the second security transaction has been successfully completed the user is allowed access to one or more secure resources associated with the security token, security token enabled computer system or both.","In related embodiments of the invention, security states are maintained by the security token and security token enabled computer system. The security states are set by the successful completion of the first and second security transactions.","The secure communications connection is established by generating on the security token enabled computer system, a shared symmetric key set, encrypting one of the generated symmetric keys with the public key, sending the encrypted symmetric key to the security token, decrypting the symmetric key with the counterpart private key and assigning the decrypted symmetric key to a dedicated communications channel. The dedicated communications channel prevents the number of wireless secure communications connections with the security token from exceeding a predetermined limit. The predetermined limit is usually set to 1.","In another embodiment of the invention, user feedback is provided by the intelligent remote device which prompts the user to select either a local or remote authentication transaction and provide the critical security parameter.","In another embodiment of the invention authentication of the user is inhibited if outside a predefined range of a proximity sensor coupled to the security token enabled computer system.","In yet another embodiment of the invention, user sensory feedback is provided by the security token enabled computer system which indicates a remote authentication transaction is in progress. The user sensory feedback includes visual, tactile, aural or vibratory feedback.","A first systematic embodiment of the invention comprises a security token enabled computer system in wireless communications with an intelligent remote device having an operatively coupled security token thereto. The security token enabled computer systems includes a first security transaction means for at least authenticating the security token to the security token enabled computer system, and a first secure communications connection means for at least establishing a cryptographically encoded link between the security token enabled computer system and the security token. The first security transaction means includes a challenge\/response protocol means and an asymmetric cryptography means. The first secure communications connection means includes a symmetric key set generation means and a secure symmetric key exchange means.","In a related embodiment of the invention, the security token enabled computer system further includes a first secure access means for allowing a user access to one or more secure resources following a receipt of an affirmative signal.","In another related embodiment of the invention, successful execution of the first security transaction means sets a first computer system security state and receipt of the affirmative result signaling sets a second computer system security state associated with the security token enabled computer system.","The intelligent remote device includes a security token interface means for at least operatively coupling the security token to the intelligent remote device, and a user interface means for at least receiving and routing a critical security parameter provided by the user to the security token interface means. The user interface means includes conditional means for conditionally receiving the critical security parameter. The conditional means is intended to limit or prevent receiving the critical security parameter until the cryptographically encoded link is established. The security token interface means includes security token communications means and electromagnetic power transfer means.","The security token includes a secure communications connection means for at least establishing the cryptographically encoded link in conjunction with the first secure communications connection means, a dedicated communications channel means for preventing a concurrent cryptographically encoded link from being established with the security token, a second security transaction means for at least authenticating the user to the security token using at least the critical security parameter and an affirmative signaling means for sending an affirmative signal to the security token enabled computer system following a successful completion of the second security transactions means. In an embodiment of the invention, the dedicated communications channel means includes a unique channel identifier means which is addressable by the security token enabled computer system.","In a related embodiment of the invention, establishment of the cryptographically encoded link sets a first token security state and successful execution of the second security transaction means sets a second token security state. In a related embodiment of the invention, the second security state is required before the secure communications connection is available for use by the security token.","A second systematic embodiment of the invention comprises a security token enabled computer system in processing communications with an intelligent remote device and a security token coupled to the intelligent remote device. The security token enabled computer system includes a first processor, a first memory coupled to the first processor, at least one remote authentication application operatively stored in a first portion of the first memory having logical instructions executable by the first processor to authenticate the security token, establish a secure end-to-end communications connection with the security token and allow a user access to one or more secure resources following a receipt of an affirmative signal sent from the security token.","The security token enabled computer system further includes a first wireless transceiver functionally coupled to the first processor and a public key associated with the security token retrievably stored in a second portion of the first memory.","The at least one remote authentication application further includes logical instructions executable by the first processor to generate a symmetric key set and perform a secure key exchange with the security token.","The intelligent remote device includes a second processor, a second memory coupled to the second processor, a security token interface coupled to the second processor, a user interface coupled to the second processor and at least one remote device interface application operatively stored in a portion of the second memory. The at least one remote device interface application includes logical instructions executable by the second processor to emulate a security token device interface locally coupled to at least the security token enabled computer system and conditionally receive and route a critical security parameter provided by the user via the user interface to the security token. The intelligent remote device further includes a second wireless transceiver functionally coupled to the second processor.","The communications and electromagnetic power interface includes inductive means, capacitive means or electric contact means to operatively couple the security token to the intelligent remote device. The at least one remote device interface application further includes logical instructions executable by the second processor to prevent receiving the critical security parameter from the user before establishment of the secure end-to-end communications connection.","The security token includes at least a third processor, a third memory coupled to the at least a third processor, a communications and electromagnetic power interface coupled to the at least a third processor and the security token interface and at least one token remote authentication application operatively stored in a first portion of the third memory.","The at least one token remote authentication application includes logical instructions executable by the at least a third processor to establish the secure end-to-end communications connection in conjunction with the security token enabled computer system, restrict the secure end-to-end communications connection to a single wireless secure communications connection, authenticate the user and send the affirmative signal to the security token enabled computer system, if the user is successfully authenticated. The security token further includes an private key retrievably stored in a second portion of the third memory and a reference critical security parameter retrievably stored in a third portion of the third memory. The private key is the counterpart to the public key. The user is authenticated by the at least one token remote authentication application by comparing the user's provided critical security parameter to the reference critical security parameter.","The restriction to the secure end-to-end communications connection is applied to a dedicated communications channel controlled by the at least one token remote authentication application. The dedicated communications channel includes a unique identifier addressable by the security token enabled computer system.","The public and private keys are incorporated into a challenge\/response protocol used to authenticate the security token to the security token enabled computer system and are further used to perform a secure symmetric key exchange from the security token enabled computer system to the security token.","In another embodiment of the invention, a proximity sensor is coupled to the security token enabled computer system which inhibits either authentication or use of the secure communications channel if the security token is outside of a predefined range from the security token enabled computer system.","In a final embodiment of the invention, a computer program product is provided. The computer program product is embodied in a tangible form readable by a security token processor and includes executable instructions stored thereon for causing the security token processor to utilize one or more security token emulation services provided by an intelligent remote device processor, establish a secure end-to-end communications connection in conjunction with a security token enabled computer system processor, restrict the secure end-to-end communications connection to a single wireless secure communications connection, authenticate a user and send an affirmative signal to the security token enabled computer system processor if the user is successfully authenticated.","The computer program product further includes executable instructions stored thereon for causing the security token enabled computer system processor to authenticate the security token, establish the secure end-to-end communications connection with the security token, and allow a user access to one or more secure resources following a receipt of the affirmative signal sent from the security token.","The computer program product further includes executable instructions stored thereon for causing the intelligent remote device processor to provide the one or more security token emulation services to the security token processor, and receive and route a critical security parameter provided by the user via the user interface to the security token.","The tangible form of the computer program product includes magnetic media, optical media or logical media stored in a code format comprising byte code, compiled, interpreted, compilable and interpretable.","This present invention provides an anonymous secure end-to-end communications connection which allows an intelligent remote device to emulate a locally connected security token device without requiring an actual physical connection to a security token enabled computer system. The anonymous secure end-to-end communications connection is established over a wireless communications network or link. The applications are envisioned to be programmed in a high level language using such as Java\u2122, C++, C#, C or Visual Basic\u2122.","Referring to , a block diagram of a security token enabled computer system  is depicted.","The security token enabled computer system  includes a processor , a main memory , a display electrically coupled to a display interface , a secondary memory subsystem electrically coupled to a hard disk drive , a removable storage drive electrically coupled to a removable storage unit and an auxiliary removable storage interface  electrically coupled to an auxiliary removable storage unit ","A communications interface subsystem is coupled to a wireless transceiver and a wireless network or link , an optional security token  electrically coupled to a security token interface and a user input interface including a mouse and a keyboard , an optional biometric scanner electrically coupled to an optional biometric scanner interface and an optional proximity sensor coupled to the communications interface . The proximity sensor prohibits remote authentications to be performed when a security token () is not within either a predefined distance from the proximity sensor or within sensor range of the proximity sensor . An example of suitable proximity systems adaptable for use in the invention is available from Ensure Technologies (Xyloc), 3526 West Liberty Road, Suite 100, Ann Arbor, Mich. 48103. The technical bases for the Xyloc proximity detection systems are disclosed in US patents and patent applications U.S. Pat. Nos. 6,456,958, 6,307,471, 6,070,240, U.S. 20020104012A1, U.S. 20020069030A1, U.S. 20020065625 all assigned to Ensure Technologies and all herein incorporated by reference.","The processor , main memory , display interface secondary memory subsystem and communications interface system are electrically coupled to a communications infrastructure . The security token enabled computer system  includes an operating system, at least one remote authentication application, other applications software, cryptography software capable of performing symmetric and asymmetric cryptographic functions, secure messaging software and device interface software. Referring to , a block diagram of an intelligent remote device  is depicted. The an intelligent remote device  includes a processor , a main memory , a display electrically coupled to a display interface , a secondary memory subsystem electrically coupled to an optional hard disk drive , a virtual storage drive and a removable memory module electrically coupled to a removable memory module interface ","A communications interface subsystem is coupled to a wireless transceiver and a wireless network or link , a security token  electrically coupled to a security token interface and a user input interface including a mouse and a keyboard , and an optional biometric scanner electrically coupled to an optional biometric scanner interface ","The processor , main memory , display interface secondary memory subsystem and communications interface system are electrically coupled to a communications infrastructure . The intelligent remote device includes an operating system, at least one remote device interface application, other applications software, cryptography software capable of performing symmetric and asymmetric cryptographic functions, secure messaging software and device interface software.","Referring to , a block diagram of the security token  is depicted. The security token  includes a wireless, optical and\/or electrical connection means , compatible with the security token interfaces , , a processor , an optional cryptographic co-processor coupled to the processor , volatile memory , non-volatile memory , an electrically erasable programmable read only memory (EEPROM) and a communications interface coupled to the connection means ","The processor , optional cryptographic co-processor , volatile memory , non-volatile memory , electrically erasable programmable read only memory (EEPROM) and communications interface are electrically coupled to a communications infrastructure . The EEPROM further includes a runtime operating environment, cryptography extensions incorporated into the operating system and capable of performing symmetric and asymmetric cryptographic functions compatible with the intelligent remote device and security token enabled cryptography software, at least one token remote authentication application, one or more critical security parameter protected secure resources coupled to the at least one token remote authentication application and a public key infrastructure (PKI) key pair functionally coupled to the at least one token remote authentication application.","The non-volatile memory has operatively stored therein one or more reference critical security parameters which are verified against a user supplied critical security parameter by the at least one token remote authentication application to allow access to the one or more one or more critical security parameter protected secure resources.","Referring to , a generalized arrangement of the invention is depicted. The invention includes an intelligent remote device IRD  in processing communications over a wireless link  with a security token enabled computer system . A security token ST  is operatively coupled to the intelligent remote device IRD  via a security token interface device STI ","The intelligent remote device IRD  includes an operatively coupled wireless transceiver T\/R , a security token interface STI , a user input means UI  and a display DI which provides a user with information related to available authentication options and authentication status.","The security token interface STI includes optical, capacitive, inductive and direct electrical contact type interface devices and provides electromagnetic power and communications continuity with the intelligent remote device IRD . Lastly, at least one remote device interface application RDI  is installed in the intelligent remote device IRD .","The at least one remote device interface application RDI  is generally a middleware application which allows the intelligent remote device IRD  to emulate a local security token device peripheral coupled to the security token enabled computer system CS  without requiring an actual physical connection. When enabled, the at least one remote device interface application RDI  provides security token interface services for exchanging data with the security token enabled computer system, receiving a user's critical security parameter provided using the user interface UI and routing the user's critical security parameter to the security token ST  for user authentication or verification.","The at least one remote device interface application RDI  further provides user prompts and feedback via a display DI ","The security token ST  is operatively coupled to the security token interface device STI by a connection means and includes a public and a private key pair Kpub , Kpri  and a reference critical security parameter CSPr  retrievably stored in the token memory. At least one token remote access application TRA  is likewise installed in the token memory.","The at least one token remote access application TRA  allows the security token ST  to establish a secure end-to-end communications connection in conjunction with the security token enabled computer system CS , restrict the secure end-to-end communications connection to a single wireless secure communications connection by way of a dedicated wireless communications channel Wc , authenticate a user by comparing a user's provided critical security parameter to the reference critical security parameter CSPr  and optionally send an affirmative signal to the security token enabled computer system CS  if the user is successfully authenticated. Local communications channel Lc, Lc, Lcn  allows multiple communications sessions to be established when the ST  is locally connected to either the intelligent remote device IRD  or security token enabled computer system CS .","The dedicated wireless communications channel Wc restricts the number of communications sessions which can be established remotely. The at least one token remote access application TRA  includes an authentication state table ,  which requires fulfillment before access is allowed to one or more secure token resource SRt . In one embodiment of the invention, the communication session is not available to the security token ST  until the authentication state table ,  is properly set by authentication of the user.","The security token enabled computer system  includes a wireless transceiver T\/R compatible with the wireless transceiver T\/R installed on the intelligent remote device IRD  and at least one remote access application RAA . The at least one remote access application RAA  is generally a middleware application which allows the security token enabled computer system CS  to authenticate the security token ST , establish the secure end-to-end communications connection with the security token ST  over the wireless link  and allow the user access to one or more secure resources following a receipt of an affirmative signal sent from the security token ST . In another embodiment of the invention, the affirmative signal is optional.","In one embodiment of the invention, the at least one remote access application RAA  includes an authentication state table ,  which requires fulfillment before access is allowed to the one or more secure computer system resource SRc . . The security token enabled computer system  further includes a display which provides a user with information related at least to authentication status ","The messaging protocol used to communicate with the security token ST  includes an ISO 7816 compliant communications protocol. Protocol conversion between higher level packet communications protocols and the lower level ISO 7816 communications protocol may be accomplished by either the remote access application RAA  installed on the security token enabled computer system CS  or by the remote device interface RDI  installed on the intelligent remote device IRD .","A secure arrangement for exchanging APDU commands and responses between the security token ST  and security token enabled computer system CS  is described in co-pending U.S. patent application Ser. No. 09\/844,246, filed Apr. 30, 2001, entitled, \u201cMethod And System For Establishing A Remote Connection To A Personal Security Device,\u201d which is herein incorporated by reference in its entity.","Extensible authentication protocols (EAP) as described in the internet standards RFC 2284 or RFC 2716 may be incorporated into the communications connection as well.","The authentication state tables , , ,  may be part of a pre-established set of security policies. In one embodiment of the invention, access requirements are determined by the security policies maintained within the security token ST  as is described in co-pending U.S. patent application Ser. No. 10\/402,960 to a common assignee filed on Apr. 1, 2003, entitled \u201cUniform Framework for Security Tokens,\u201d and herein incorporated by reference.","Additional security policies may be combined with the security policies established for the security token as is described in co-pending U.S. patent application Ser. No. 10\/425,028 to a common assignee filed on Apr. 29, 2003, entitled \u201cUniform Modular Framework For A Host Computer System,\u201d and likewise herein incorporated by reference.","Referring to , the secure end-to-end communications connection is initiated by a user selecting a remote authentication option from the display DI associated with the intelligent remote device IRD . The at least one token remote access application  causes the public key Kpub to be sent to the security token enabled computer system CS  from the security token ST .","In an alternate embodiment of the invention, no user interaction is required to initiate the secure end-to-end communications connection. In the alternate embodiment of the invention, the communications handshaking between the two wireless transceivers T\/R , T\/R automatically causes execution of the at least one token remote access application .","In the preferred embodiment of the invention, a public key Kpub or duplicate thereof. Kpub , is sent to the security token enabled computer system CS  in an X.509 certificate where it is retrievably stored. The public key Kpub will be used to authenticate the security token ST  to the security token enabled computer system CS  and to perform a secure symmetric key exchange between the security token enabled computer system CS  and security token ST .","Referring to , the receipt of the public key Kpub causes the at least one remote access application to generate a challenge [C] which is then encrypted using the public key Kpub and the resulting cryptogram [C]Kpub is then sent over the wireless link  to the security token ST .","The display DI associated with the security token enabled computer system CS  provides user feedback that a remote authentication transaction has been initiated. The at least one token remote access application TRA  receives and decrypts the cryptogram [C]Kpub using the counterpart private key Kpri  generating the token clear text response [C] to the challenge.","Referring to , the token response to the challenge [C] is returned to the security token enabled computer system CS  where the remote access application RAA  compares  the returned response [C] to the initial challenge [C] . If the token response [C] matches the initial challenge [C] , the PKI authentication part of the computer systems authentication state table is fulfilled . If the security token ST  fails this first authentication transaction processing ends and a new attempt to establish the secure end-to-end communications connection will need to be performed.","Referring to , a first part of the anonymous secure end-to-end communications connection is initiated by the remote access application RAA  generating a symmetric key set. The symmetric key sets KSt and KSc are identical symmetric keys generated or derived from a random number preferably having sufficient bit strength of at least 64 bits to assure adequate security and performance.","The at least one remote access application RAA  encrypts one of the symmetric keys KSt using the public key Kpub and the resulting cryptogram [KSt]Kpub is then sent over the wireless link  to the security token ST . In one embodiment of the invention, a channel identifier Wc is included in a message header associated with the cryptogram which specifies the dedicated communications channel in which the symmetric key is to be used. The at least one token remote access application TRA  receives and decrypts the cryptogram [KSt]Kpub using the counterpart private key Kpri  restoring the token's shared symmetric key KSt ","Referring to , the token shared symmetric key KSt is assigned to the dedicated communications channel Wc which establishes the secure end-to-end communications connection . The share symmetric keys KSt , KSc are used as block cipher keys during information exchange over the secure end-to-end communications connection. The establishment of the secure end-to-end communications connection  fulfills a first element of the token's authentication state table . The dedicated communications channel restricts the secure end-to-end communications connection to a single wireless secure communications connection  with the security token to prevent unauthorized entities from eavesdropping on subsequent security token transactions.","Referring to , the final security transaction is performed where the user is prompted on the display associated with the intelligent remote device IRD  to provide his or her critical security parameter CSPu . The user's critical security parameter CSPu is inputted  to the intelligent remote device IRD  via the user interface UI  and routed to the security token ST  for authentication.","The user's critical security parameter CSPu  is compared  to the reference critical security parameter CSPr by the token remote access application TRA . If a match is found between the user's critical security parameter CSPu  and the reference critical security parameter CSPr , the critical security parameter CSP  element of the token's authentication state table is fulfilled. If the critical security parameter fails this second authentication transaction processing ends and a new attempt to establish the secure end-to-end communications connection will need to be performed.","Referring to , the final phase of the invention implementation is depicted where an affirmative result signal is transmitted from the security token ST  to the security token enabled computer system via the secure end-to-end communications connection . The receipt of the affirmative result signal fulfills the second element ST  of the computer system's authentication state table which allows access , to the one or more secure resources , associated with the security token ST , security token enabled computer system CS  or both devices.","The user display DI associated with intelligent remote device IRD  optionally provides at least visual indication that a secure messaging session is in progress. Likewise, the user display DI associated with the security token enabled computer system CS  provides at least visual indication that access has been granted remotely. Other types of visual, aural and vibratory feedback are envisioned as well.","Referring to , the major steps for implementing the invention are depicted. The process is initiated  by establishment of a wireless communications connection between a security token enabled computer system and an intelligent remote device having a security token operatively coupled thereto. A public key is sent from the security token via the intelligent remote device to the security token enabled computer system , preferably as part of an X.509 formatted digital certificate. Transfer of the public key may be automatically performed during a communications handshake or by user interaction.","The security token enabled computer system authenticates  the security token using a challenge\/response protocol, whereby a challenge is generated, encrypted using the received public key, then transmitted to the security token over the wireless communications connection. The security token receives the cryptogram and decrypts the challenge using a private key counterpart of the public key. The clear text challenge is then returned to the security token enabled computer system for authentication. If the security token is not authenticated  processing ends . If the security token is authenticated , a symmetric key set is generated on the security token enabled computer system  and a secure key exchange  performed with the security token, whereby at least one of the symmetric keys is encrypted using the public key and sent over the wireless communications connection to the security token.","The received encrypted symmetric key is decrypted using the private key, assigned to a dedicated communications channel and the dedicated communications channel locked if a predetermined limit of preexisting wireless communications connections is not exceeded . If the predetermined limit is exceeded , processing ends . The predetermined limit is usually set to 1 in the preferred embodiment of the invention.","A first security state is set by either or both the security token and\/or security token enabled computer system which indicates that a secure communications channel has been established. In one embodiment of the invention, the secure communications channel is not enabled until the user is authenticated as described below.","If the predetermined limit is not exceeded , the user is prompted  to provide his or her critical security parameter to the intelligent remote device. The provided critical security parameter is then authenticated  by the security token by comparing a reference critical security parameter to the received critical security parameter. If the user is not authenticated , processing ends. If the user is authenticated , an affirmative result signal is optionally generated by the security token and sent to the security token enabled computer system . Receipt of the affirmative result signal allows access to one or more secure resources . Processing ends  normally at the conclusion of the secure communications session by the user, removal of the security token from the intelligent remote device or moving outside of a predetermined proximity range from the security token enabled computer system.","The foregoing described embodiments of the invention are provided as illustrations and descriptions. They are not intended to limit the invention to precise form described. In particular, it is contemplated that functional implementation of the invention described herein may be implemented equivalently in hardware, software, firmware, and\/or other available functional components or building blocks. No specific limitation is intended to a particular security token operating environment. Other variations and embodiments are possible in light of above teachings, and it is not intended that this Detailed Description limit the scope of invention, but rather by the claims that follow herein."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":["The features and advantages of the invention will become apparent from the following detailed description when considered in conjunction with the accompanying drawings. Where possible, the same reference numerals and characters are used to denote like features, elements, components or portions of the invention. It is intended that changes and modifications can be made to the described embodiment without departing from the true scope and spirit of the subject invention as defined by the claims.","FIG. \u2014is a generalized block diagram of a security token enabled computer system.","FIG. A\u2014is a generalized block diagram of an intelligent remote device.","FIG. B\u2014is a generalized block diagram of a security token","FIG. \u2014is a detailed block diagram of one embodiment of the invention where a security token enabled computer system is in processing communications with a security token equipped intelligent remote device over a wireless link.","FIG. A\u2014is a detailed block diagram of the invention where an public key is transferred to the security token enabled computer system.","FIG. B\u2014is a detailed block diagram of the invention where the security token receives an encrypted challenge generated by the security token enabled computer system as an initial part of an authentication challenge\/response protocol.","FIG. C\u2014is a detailed block diagram of the invention where the security token returns the clear text challenge to the security token enabled computer system as a final part of the authentication challenge\/response protocol.","FIG. D\u2014is a detailed block diagram of the invention where a symmetric key set is generated and a secure key exchange is performed between the security token enabled computer system and the security token.","FIG. E\u2014is a detailed block diagram of the invention where a secure end-to-end communications connection is established between the security token enabled computer system and the security token.","FIG. F\u2014is a detailed block diagram of the invention where a user's critical security parameter is provided to the intelligent remote device and routed to the operatively coupled security token to authenticate the user.","FIG. G\u2014is a detailed block diagram of the invention where the intelligent remote device has successfully been authenticated to the security token enabled computer system.","FIG. \u2014is a flow diagram illustrating the major steps associated with establishing the secure end-to-end communications connection between the security token enabled computer system and an intelligent remote device having a security token operatively coupled thereto."]},"DETDESC":[{},{}]}
