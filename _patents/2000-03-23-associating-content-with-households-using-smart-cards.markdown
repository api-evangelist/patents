---
title: Associating content with households using smart cards
abstract: Media content is associated with households using smart cards. The media content is encrypted and/or decrypted based on a household identifier corresponding to a smart card. Media content is encrypted such that it can only be decrypted with the same (or similar) smart card. Thus, the encrypted media content can be safely transferred within a computing device, stored, transferred to other computing devices, etc. because it cannot be decrypted without the smart card.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07080039&OS=07080039&RS=07080039
owner: 
number: 07080039
owner_city: 
owner_country: 
publication_date: 20000323
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","CONCLUSION"],"p":["This application claims the benefit of U.S. Provisional Application No. 60\/125,998, filed Mar. 24, 1999, entitled \u201cTV-Style Broadcast on a Personal Computer Platform\u201d, to David J. Marsh.","This invention relates to smart cards and content security. More particularly, the invention relates to associating content with households using smart cards.","Personal computers are encroaching upon the area occupied by more traditional home entertainment systems. Rendering of audio and\/or video content, such as movies, on personal computers is becoming increasingly popular. For example, personal computers can be equipped with DVD (digital versatile disk) drives that allow the computer to render movies from DVDs. By way of another example, personal computers can be equipped with television tuner expansion cards or other components that allow television signals to be received (e.g., via antenna or cable) by the computer for rendering. This encroachment is expected to continue, resulting in the replacement of traditional separate entertainment system components (e.g., VCR, DVD player, etc.) with a personal computer.","The creators of audio and\/or video content, however, are very concerned with the security of personal computers. Traditional entertainment system components are \u201cclosed\u201d boxes (they cannot be easily opened and components accessed, removed, modified, replaced, etc. while leaving the components operable) and thus relatively secure. Personal computers, in contrast, are \u201copen\u201d boxes\u2014a portion of the housing can be removed and components (e.g., expansion cards) can be removed and replaced, new components can be installed, components (e.g., buses) can be accessed, etc. This creates a significant security risk for the content creators, because even though the personal computer designer\/manufacturer may design the components of the computer to not perform any unauthorized tasks (e.g., inappropriate copying of descrambled content), there is often nothing preventing a malicious user from adding an additional expansion card (e.g., coupled to a bus of the computer) that does perform unauthorized tasks (e.g., copies the descrambled content from the bus for unauthorized distribution). In order for the content manufacturers to trust the security of open systems such as personal computers, a way to ensure the security of such content needs to be provided.","However, an additional factor that needs to be accounted for is the user response to any such security mechanisms. While most users understand, and accept, that they are not supposed to make unauthorized copies of content (e.g., copy movies for their friends, copy movies to the Internet, etc.), most users also do not want to be limited in their own enjoyment of movies and other premium content. For example, when people purchase a movie they may want to be able to watch it on different televisions in their house at different times, or take it to a friend's house and watch it there. Thus, it would be beneficial to provide a way to ensure the security of such content while at the same time not significantly interfering with a user's ability to enjoy the content he or she legitimately acquires.","The invention described below addresses these disadvantages, associating content with households using smart cards.","Associating content with households using smart cards is described herein. Media content is encrypted and\/or decrypted based on a household identifier corresponding to a smart card.","According to one aspect, media content is encrypted by a computing device based on a household identifier corresponding to a smart card. The content is encrypted such that it can only be decrypted with the smart card. Thus, the encrypted media content can be safely transferred within the computing device, stored, transferred to other computing devices, etc. because it cannot be decrypted without the smart card.","According to another aspect, the household identifier is stored on the smart card. The encrypting and decrypting can be performed by the smart card and\/or another module(s) within the system using the key from the smart card.","According to another aspect, the media content can be stored for later use. The media content is stored in encrypted form, securing the content against improper copying or other improper uses.","According to another aspect, the media content is transferred to another computing device. The media content is transferred in encrypted form, so it can only be decrypted and rendered at that other computing device if a smart card with the correct household identifier is also present at that other computing device.","In the discussion below, embodiments of the invention will be described in the general context of computer-executable instructions, such as program modules, being executed by one or more conventional personal computers. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Moreover, those skilled in the art will appreciate that various embodiments of the invention may be practiced with other computer system configurations, including hand-held devices, gaming consoles, multiprocessor systems, microprocessor-based or programmable consumer electronics, network PCs, minicomputers, mainframe computers, and the like. In a distributed computer environment, program modules may be located in both local and remote memory storage devices.","Alternatively, embodiments of the invention can be implemented in hardware or a combination of hardware, software, and\/or firmware. For example, all or part of the invention can be implemented in one or more application specific integrated circuits (ASICs).",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1","b":["100","100","102","104","102","102","106","106","102","106"]},"While audio and video have traditionally been transmitted using analog formats over the airwaves, current and proposed technology allows media content transmission over a wider range of network types, including digital formats over the airwaves, different types of cable and satellite systems (employing both analog and digital transmission formats), wired or wireless networks such as the Internet, etc.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 1","b":["108","110","112","114","116","118","120","122"]},"In one implementation, analog signals are encoded upon receipt by the receiver  in order to put the signals into a computer friendly digital form.","Additional network(s) may also be involved in the distribution of audio, video, and\/or data content to system . By way of example, system  may be included as part of a home network (not shown), with the audio, video, and\/or data content being stored at a server (not shown) prior to transmission to system .","Typically, audio, video, and data content for a particular program (or portion thereof) will be transmitted from the same source (e.g., all of the content for a particular movie may be received from cable transmitter ). Alternatively, the audio, video, and data content for a program may be transmitted from multiple sources (e.g., the audio and video content may be received from cable transmitter , while the data content is received from Internet provider ).",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 2","b":["142","142","102","1","142","144","146","148","146","144"]},"The bus  represents one or more of any of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, and a processor or local bus using any of a variety of bus architectures. The system memory includes read only memory (ROM)  and random access memory (RAM) . A basic input\/output system (BIOS) , containing the basic routines that help to transfer information between elements within computer , such as during start-up, is stored in ROM . Computer  further includes a hard disk drive  for reading from and writing to a hard disk, not shown, connected to bus  via a hard disk driver interface  (e.g., a SCSI, ATA, or other type of interface); a magnetic disk drive  for reading from and writing to a removable magnetic disk , connected to bus  via a magnetic disk drive interface ; and an optical disk drive  for reading from or writing to a removable optical disk  such as a CD ROM, DVD, or other optical media, connected to bus  via an optical drive interface . The drives and their associated computer-readable media provide nonvolatile storage of computer readable instructions, data structures, program modules and other data for computer . Although the exemplary environment described herein employs a hard disk, a removable magnetic disk  and a removable optical disk , it should be appreciated by those skilled in the art that other types of computer readable media which can store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, random access memories (RAMs) read only memories (ROM), and the like, may also be used in the exemplary operating environment.","A number of program modules may be stored on the hard disk, magnetic disk , optical disk , ROM , or RAM , including an operating system , one or more application programs , other program modules , and program data . A user may enter commands and information into computer  through input devices such as keyboard  and pointing device . Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are connected to the processing unit  through an interface  that is coupled to the system bus. A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video adapter . In addition to the monitor, personal computers typically include other peripheral output devices (not shown) such as speakers and printers.","Computer  optionally operates in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be another personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to computer , although only a memory storage device  has been illustrated in FIG. . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet. In the described embodiment of the invention, remote computer  executes an Internet Web browser program (which may optionally be integrated into the operating system ) such as the \u201cInternet Explorer\u201d Web browser manufactured and distributed by Microsoft Corporation of Redmond, Wash.","When used in a LAN networking environment, computer  is connected to the local network  through a network interface or adapter . When used in a WAN networking environment, computer  typically includes a modem  or other component for establishing communications over the wide area network , such as the Internet. The modem , which may be internal or external, is connected to the system bus  via an interface (e.g., a serial port interface ). In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in the remote memory storage device. It is to be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Computer  also optionally includes one or more broadcast tuners . Broadcast tuner  receives broadcast signals either directly (e.g., analog or digital cable transmissions fed directly into tuner ) or via a reception device (e.g., via antenna  or satellite dish  of FIG. ).","Generally, the data processors of computer  are programmed by means of instructions stored at different times in the various computer-readable storage media of the computer. Programs and operating systems are typically distributed, for example, on floppy disks or CD-ROMs. From there, they are installed or loaded into the secondary memory of a computer. At execution, they are loaded at least partially into the computer's primary electronic memory. The invention described herein includes these and other various types of computer-readable storage media when such media contain instructions or programs for implementing the steps described below in conjunction with a microprocessor or other data processor. The invention also includes the computer itself when programmed according to the methods and techniques described below. Furthermore, certain sub-components of the computer may be programmed to perform the functions and steps described below. The invention includes such sub-components when they are programmed as described. In addition, the invention described herein includes data structures, described below, as embodied on various types of memory media.","For purposes of illustration, programs and other executable program components such as the operating system are illustrated herein as discrete blocks, although it is recognized that such programs and components reside at various times in different storage components of the computer, and are executed by the data processor(s) of the computer.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 3","FIG. 1"],"b":["220","220","220","106","142","2"]},"System  includes a descrambling and encrypting module , a demultiplexing module , an example video analyzer module , a viewing delay module , a time shifting module , a home network module , an MPEG (Motion Pictures Experts Group) decoding module , a content rendering module , and a content protection controller module . Each of these modules - can be implemented in software, firmware, hardware, or a combination thereof. Additionally, although illustrated as separate modules, one or more of modules - may be combined into a single module (e.g., rendering delay module  and time shifting module  may be a single module). In one example, the modules - are implemented using filters in accordance with the \u201cDirectShow\u201d architecture, although other architectures can be used in alternative implementations. Additional information regarding the \u201cDirectShow\u201d architecture and \u201cDirectShow\u201d application programming interface is available from Microsoft Corporation of Redmond, Wash. Different ones of the modules - may operate on particular media content, as discussed in more detail below.","An additional control module  manages the operation of the different modules -, informing each of any parameters it needs to perform its function (e.g., how to distinguish between audio and video content, the network address of another computing device that content is to be transferred to, etc.). Control module  also manages the interaction of the different modules -, informing each module which other module(s) it is to input content to and\/or receive content from. Alternatively, rather than a centralized control module , the control functionality may be distributed among one or more of the modules -.","Media content  is received by a set-top box  or module of system  with a similar function (not shown) and input to descrambling and encrypting module . Media content  can include any of a wide variety of content and can include multiple types of media concurrently, including primary content (e.g., audio and video) as well as enhancement data content such as that corresponding to the Advanced Television Enhancement Forum (ATVEF) standard (additional information regarding ATVEF is available from Microsoft Corporation) or other enhanced television standards. Examples of media content  include audio or sound, video, moving graphics or motion pictures, still graphics, animation, textual content, command script sequences, as well as other types of content that can be sensed and\/or perceived by a human.","The manner in which media content  is received by set-top box  can vary depending on the nature of content  as well as the transmitter of content . Set-top box  can be configured to receive content  from a wide variety of sources, such as those discussed above with reference to FIG. .","In the illustrated example, set-top box  implements a conditional access content protection scheme. The conditional access scheme allows set-top box  to limit the type of media content  that can be received and provided to system  for rendering. A variety of different conditional access schemes can be employed on a per-program basis, a per-source basis, etc. By way of example, set-top box  may remove scrambling introduced by the transmitter (or producer, etc.) of content  based on default or programmable settings in set-top box , based on a smart card (not shown) and\/or PCMCIA card (not shown) provided by a service provider with the proper encodings\/settings indicating the user has paid for the content, etc. Alternatively, no conditional access content protection scheme may be implemented by set-top box .","In the illustrated example, set-top box  provides received content  that satisfies the conditional access scheme to descrambling and encrypting module  via a coupling . Set-top box  scrambles the content it passes to module  in order to prevent a malicious user from tapping into the signal passed between box  and module  and inappropriately using the content. Coupling  can be any of a variety of communications mechanisms, including both wired and wireless. In one implementation, coupling  is a USB (Universal Serial Bus) or IEEE 1394 connection. The scrambling introduced by set-top box  can be any of a wide variety of scrambling mechanisms, such as 5C scrambling (as defined in the 5C IEEE 1394 Proposal, rev. 1.0, \u201c5C Digital Transmission Content Protection Specification\u201d, Volume I, Feb. 18, 1999).","Although set-top box  is illustrated as a separate component from system , box  can alternatively be included as part of system . By way of example, the functionality of box  may be implemented on an expansion card that can be added to system  (e.g., a card that \u201cplugs in\u201d to a PCI slot of system ).","Descrambling and encrypting module  receives the scrambled content from set-top box  and descrambles the content. Module  knows (e.g., is programmed with, or has access to multiple additional modules (not shown)) the manner in which content from box  is scrambled and is thus able to descramble such content. Alternatively, some content may be received by module  which is not scrambled, and thus the descrambling process is not necessary.","In order to maintain the security of the de-scrambled content inside system  (e.g., to avoid having a malicious user copy content as it is transferred along a bus (such as a PCI bus) inside system ), the media content is also encrypted by module . This encryption is based on a household identifier corresponding to a smart card , as discussed in more detail below. By so encrypting the media content, the content is tied to a particular household (e.g., a particular person or group of people, such as a family). In one implementation, all content is encrypted by module . Alternatively, only content which is received in scrambled format may be encrypted, or some other indicator of which content to encrypt may be used (e.g., header information in the received content, pre-defined date and\/or time ranges of content to be encrypted, etc.).","Any of a wide variety of encryption algorithms can be used by module  to encrypt the media content. In one implementation, encryption algorithms based on public-key cryptography are used, such as either of the well-known Rivest-Shamir-Adleman (RSA) or Elliptic Curve Cryptography (ECC) encryption schemes. Alternatively, other types of encryption that are not public-key can be used, such as the RC4 encryption scheme (additional information regarding RC4 is available from RSA Security, Inc. of Bedford, Mass.) or the AES (Advanced Encryption Standard) encryption scheme (additional information regard AES is available from the National Institute of Standards and Technology in Washington, D.C.). In situations where public-key cryptography is not used, a public key\/private key pair may still be stored on smart card  for authentication purposes, as discussed in more detail below.","System  is coupled to a smart card reader  (e.g., via a standard connection such as a USB connection), allowing descrambling and encrypting module  to communicate with smart card reader  via content protection controller module . Smart card  can be coupled to smart card reader  in a variety of different manners, including physical touching (e.g., electrical contacts of smart card reader  being placed in physical contact with electrical contacts of smart card ) or without such physical contact (e.g., a wireless connection, such as infrared, radio frequency, etc.). Smart card  is an integrated circuit card (ICC) which is typically the size of a standard credit card and which is capable of storing data and performing some processing. In one implementation, smart card  complies with the ISO 7816 standard. Although discussed herein as a smart card, other types of portable integrated circuit (IC) devices can alternatively be used.","Content protection controller module  includes various functionality to facilitate the protection of media content in system . In one implementation, module  includes software drivers that allow smart card reader  to communicate with other modules in system  and also includes cryptographic functions and processes (e.g., CryptoAPI functions and processes) that can be accessed by other modules in system . Additional information regarding CryptoAPI functions and processes is available from Microsoft Corporation of Redmond, Wash.","In order to encrypt media content, module  works in conjunction with smart card  and content protection controller module  to establish a secure communication channel to smart card . After establishing the secure communication channel, module  and\/or  verifies the authenticity of smart card . Once smart card  is verified, the required key information used by module  to encrypt the media content is communicated along the secure communications channel from smart card  to module .","The secure communication channel established between module  and smart card , and typically in the particular example of the implementation via module , provides an assurance that other components cannot intercept and, modify, replay, decipher, etc. messages being exchanged between smart card  and module  via the channel. This is especially important as other components can also be added to the same bus and could listen to the traffic. A key-exchange protocol such as the well-known Diffie-Hellman key-agreement protocol is used to establish the secure communication channel. Alternatively, other conventional cryptographic techniques can be used to establish the secure channel between smart card  and module  (and, if used in the implementation, between the content protection controller module .","Additionally, in one implementation content protection controller module  requires module  to have an appropriate license or certificate in order to access smart card . Such a requirement prohibits a malicious user from inserting his or her own module into system  and accessing smart card  to decrypt content.",{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 4","b":["246","262","264","266","264","246","264","264","268","270","272","274","276"]},"Key pair  includes both a public key and a private key as used in public key cryptography. The private key from key pair  is combined with household identifier  and the combined value is provided to encrypting module  via the secure communication channel to encrypt the media content. The private key of key pair  and household identifier  can be combined in any of a variety of manners, such as concatenating the values or performing other calculations based on the values (e.g., the private key exponentiated to the power of the household identifier, the two values multiplied or added together, etc.).","Alternatively, the household identifier may not be a value separate from the private key of key pair . In this implementation, the private key from key pair , for example, can act as the household identifier.","In another alternative, the encrypting of the media content is controlled by module , but the actual encryption is performed by processor  on smart card . According to this alternative, the data to be encrypted is passed via the secure communication channel to smart card . Processor  executes the encryption algorithm to encrypt the data based on the private key of key pair  (and household identifier , if separate from the private key) and returns the encrypted data to module  via the secure communication channel. This alternative has the benefit of smart card  not divulging its private key to module .","In another alternative, household identifier  is stored wholly (or in part) within various modules - of  or elsewhere in system . According to this alternative, module  encrypts the media content based on a combination of the part of identifier  stored in modules - and the part of identifier  stored on smart card  (and or the private key of key pair ).","In the illustrated example, smart card  is tamper-resistant, providing secure storage for identifier , certificate , key pair , as well as any other data or information stored on smart card .","Authentication module  operates in conjunction with module  to establish the secure communication channel between module  and smart card . Communications module  manages communication with module  via the secure communication channel. Communications module  also, in various implementations, combines the private key of key pair  with the household identifier , receives data (e.g., media content, a portion of a household identifier, etc.) from module , and\/or transmits a key to be used for encryption to module .","Certificate  is a certificate that is digitally signed by a trusted licensing authority (also referred to as a certificate authority or certifying authority) testifying that the smart card  is authentic. Certificate  includes the public key of key pair , the public key of the licensing authority, and the above testimony, and is digitally signed by the licensing authority using the private key of the licensing authority. This digitally signed certificate allows module , knowing the public key of the licensing authority, to verify that the certificate that is presented by smart card  was indeed digitally signed by the licensing authority.","The certificate can be digitally signed by the licensing authority applying a conventional encryption algorithm along with its private key to the certificate to generate a digital signature. This digital signature is forwarded to module  along with the certificate. The recipient can decrypt the digital signature using the licensing authority's public key and compare the decrypted certificate to the received certificate. If the two certificates match, then the recipient is ensured that the licensing authority did in fact sign the certificate and that the certificate has not been altered since it was signed. Alternatively, rather than applying an encryption algorithm to the certificate itself, the digital signature may be generated by applying the encryption algorithm to a hash value generated based on the certificate and a known hash function. The digital signature can then be verified by module  applying the known hash function to the received certificate and comparing this generated hash value to the decrypted digital signature. If the two hash values match, then module  is ensured that the licensing authority did in fact sign the certificate and that the certificate has not been altered since it was signed.","In addition to receiving the certificate, module  verifies that the licensing authority is itself trustworthy. Module  verifies that the licensing authority is trustworthy by establishing a \u201cchain\u201d of one or more certificates ranging from the licensing authority up to a root certificate. System  maintains a root certificate for each licensing authority that system  trusts. Each root certificate is a self-signed certificate that is implicitly trusted by system . Upon receipt of the smart card certificate , module  attempts to establish a chain of certificates from the certificate  up to one of the trusted root certificates. This chain may include one or more \u201cintermediate\u201d certificates. Each certificate in the chain will have a \u201cparent\u201d certificate that can cryptographically verify the authenticity of the certificate (e.g., by being digitally signed by the parent). Eventually, the chain leads back to a parent certificate that is one of the trusted root certificates. If such a certificate chain can be established by module , then the licensing authority is considered trustworthy. However, if such a certificate chain cannot be established, then the licensing authority is not considered trustworthy and module  will not descramble and encrypt the media content.","The smart card  can be further authenticated by using challenge data. Module  initially sends a challenge (e.g., a random number generated by module ), also referred to as a \u201cchallenge nonce\u201d, to smart card . Upon receiving the challenge nonce, smart card  responds to the challenge by digitally signing the received random number using the private key of key pair . This signed number is then returned to module  as the response.","Upon receiving the response, module  verifies the response. The response is verified using the public key of key pair , which is known to module . The public key can be made known to module  in any of a variety of conventional manners, such as from certificate . As only smart card  knows the private key of key pair , the module  can verify the authenticity of smart card  by evaluating, using the public key of key pair , whether the random number was properly digitally signed with the private key of key pair .","In certain implementations, additional data  is stored on smart card  that is perceived or anticipated to be of value to the user of smart card . By attaching such value to smart card , a user of smart card  is more apt to keep track of smart card . Without such value attached to smart card , a user has little incentive to keep his or her smart card secure (e.g., not loan or give it to friends, family, and\/or strangers). However, if there is something that the user perceives as valuable stored on smart card , he or she has a strong incentive to keep the card secure.","Such additional value can be added to smart card  in any of a wide variety of manners. For example, smart card  can have electronic money stored on the card which can be used by the cardholder to purchase goods and\/or services (e.g., pay-per-view movie, goods from other retailers, services from other vendors, etc.). In this example, a threshold amount of electronic money must be on smart card  in order for smart card  to be used for decryption (or alternatively for encryption as well). If at least that threshold amount of electronic money is not on smart card , then module  (or smart card ) will not perform the decryption. The user thus has an incentive to keep track of his or her smart card\u2014if he loses the card then the electronic money on the card is also lost, or if he gives it to someone else that person(s) can spend the electronic money on the card.","Other user-specific information  related to the rendering of media content may also be stored on smart card . By way of example, a user's preferred channels, preferred viewing times, preferred type of content, etc. can all be stored on smart card . Such preferences can be input manually by the user or alternatively learned automatically (e.g., by system ) and stored on smart card . These preferences are thus carried with the user, allowing them to be immediately available when the user is using a different system (e.g., in another room of his or her house, a hotel room, etc.). These preferences can be kept secure by the user on smart card  because as soon as smart card  is removed from the system, no device or component will be able to access the information on smart card . The fact that the data is only stored on the card, rather than hard disk, can be verified by an independent consumer privacy watchdog body. Further privacy can be obtained by allowing a user to purchase smart card  anonymously (e.g., using cash), so that there is nothing tying the identity of the user to the smart card .","Returning to , once the media content is encrypted by module , it can be made available to other modules - without fear of being used inappropriately. Some modules - are able to carry out their functions based on the encrypted content, while others decrypt the content before carrying out their functions. Any module - which needs to decrypt the media content communicates with smart card  to perform the necessary decryption based at least in part on household identifier  maintained on smart card . The exact manner in which the content is decrypted is dependent on the encryption scheme used to encrypt the content. The communication with smart card  by any other module - is analogous to that discussed above with respect to module  (including establishment of a secure communication channel and authentication of smart card ). Once the module is finished its processing of the content, the processed content is re-encrypted (in a manner analogous to the encryption discussed above with reference to module ) before being passed to another module.","The encrypted content is output by descrambling and encrypting module  in packets.  illustrates an exemplary packet of encrypted content in accordance with certain embodiments of the invention. Packet  is illustrated including header information  and corresponding encrypted content . Encrypted content  includes the media content data (e.g., the audio data or the video data) that has been encrypted by module , and header information  includes information describing the media content. The header information  can vary in different implementations. Examples of such information include a packet identifier (e.g., that explicitly or implicitly identifies the order of receipt or rendering of the packet  relative to other packets ), content type (e.g., whether encrypted content  is audio, video, text, etc.), source of the content, restrictions as to its use, etc.","In the illustrated example, only the content is encrypted by module  the header information  remains unencrypted. By not encrypting the header information , some components - in system  of  can operate on the information without decrypting the actual content. For example, module  or module  can save the packet  to storage device  without decrypting the encrypted content . Alternatively, the entire packet , including header information , may be encrypted.","Returning to , descrambling and encrypting module  outputs the encrypted media, in the form of packets, to demultiplexing module . Demultiplexing module  analyzes the header information and forwards packets of video content to video analyzer module . Other packets are forwarded directly to rendering delay module .","The example video analyzer module  analyzes video content in an attempt to identify scene changes. In order to analyze the video content, the media content is decrypted by module . The video content is then analyzed, re-encrypted, and forwarded to rendering delay module . The same process applies to any other module that needs to process the actual video or audio content.","Rendering delay module  stores the encrypted content to storage device  for delayed viewing. Similarly, time shifting module  stores the encrypted content to storage device  for subsequent retrieval. The functionality of modules  and  is similar. However, delay module  is primarily intended to temporarily delay rendering of the content (e.g., a movie is paused while the viewer gets a snack), whereas time shifting module  is primarily intended to store the content for viewing at a later time (e.g., the following weekend).","Storage device  can be any of a wide variety of fixed or removable storage devices, such as a hard disk, a magnetic tape, an optical disk, etc. Modules  and  are illustrated as storing encrypted content on the same storage device . Alternatively, different storage devices may be used for each of the modules  and  (or multiple storage devices may be shared by modules  and ).","Neither module  nor module  decrypts the encrypted content. Thus, the content, as stored on storage device , is in encrypted form. This prevents the content from being copied from storage device  and rendered at another location, as discussed in more detail below. The recording is only useful if a smart card with the correct household identifier is available for the decrypting.","The encrypted content is also forwarded to home network module . Home network module  can transmit the encrypted content to another computing device (or alternatively a storage device) via network interface . Analogous to modules  and , network module  does not decrypt the encrypted content. Thus, the destination of the content over network interface  cannot render the content without smart card  to decrypt the content.","The encrypted content is also provided to MPEG decoder module . MPEG decoder module  decodes (e.g., decompresses) the encoded content (which is encoded in an MPEG format in the illustrated example). Module  decrypts the encrypted content prior to decoding the media content, and outputs the decoded content to content renderer module . Module  can, after decoding the media content, optionally encrypt the decoded content. Whether module  encrypts the decoded content is dependent on whether a secure communication channel exists between modules  and . If there is a secure communication channel (e.g., the modules  and  are on the same expansion card within system , or are within the same display device), then encryption is not necessary. Content renderer module  renders the media content via rendering device . Although illustrated as a single decoder module  and a single renderer module , multiple such modules may be included (e.g., one for each type of media content, such as one for audio content and one for video content). Additionally, multiple rendering devices may be included (e.g., one for visual content and another for audio content).","Alternatively, if a secure communication channel between modules  and  is not included, then the decoded content is encrypted by decoder module . The encrypted decoded content is then forwarded to renderer module , and is decrypted by module  (if there is a secure communication channel between module  and rendering device ), or is decrypted by rendering device  (if there is not a secure communication channel between module  and rendering device ).","System  illustrates an exemplary computing device that can receive, store, transmit over a network, and render media content. Alternative systems need not include all of this functionality. For example, a server system may be able to receive media content, store the content, and transmit the content to another computing device via a network interface, but have no rendering ability. By way of another example, a system may be able to receive and render media content, but have no ability to store the content for later viewing or transmit the content to another computing device over a network.","Furthermore, media content may not be processed by every module illustrated in system . For example, media content may be transferred from demultiplexing module  directly to decoding module , bypassing modules , , , and .","Specific examples of modules for processing media content are illustrated in FIG. . These modules - are exemplary only\u2014any of a wide variety of additional modules may also be included in system . Examples of additional modules include: a signal range selector corresponding to reception hardware (e.g., for antenna selection); a frequency selector to filter particular frequencies; an encoder (e.g., an MPEG encoder), to translate analog signals into digital bit streams; a packager (or tuner capturer) to separate the digital stream into packets and perform Forward Error Correction (FEC); a stream selector (or demultiplexer) to select particular packets from the stream; a stream selection filter to perform additional filtering of packets; an Ethernet packager to package packets into Ethernet frames; etc.","As illustrated in , the media content is communicated to different modules in  in an encrypted manner. Any module which processes the content in a manner that requires the content to be decrypted, decrypts the content, processes the content, and re-encrypts the processed content. Thus, the media content is only in decrypted form when it is actually being processed by a particular module. In one implementation these modules are required to be licensed, making their integrity and trustworthiness are inherent.","Additionally, in one implementation memory obfuscation techniques are used to provide additional security for the content when it has been decrypted and is being processed by one of the modules. Typically, when the content is decrypted it is stored in system memory (e.g., RAM), to allow for processing of the content by the module. However, the decrypted content can be vulnerable to a malicious user when it is stored in system memory. Memory obfuscation techniques can then be used to protect the content, even when in decrypted form. Any of a variety of conventional memory obfuscation techniques can be used to obfuscate the code of one or more of modules -.","System  thus allows media content to be tagged to a particular household. The media is encrypted based on smart card , thereby requiring smart card  to be present in order to decrypt and render the stored content. This decryption and rendering can be performed by any system  to which smart card  is in communication (e.g., plugged into), such as the system  that recorded the content or a system  at a friend's house if smart card  is taken to the friend's house. Alternatively it can be a physically different smart card, but only if that smart card has the same household identifier stored (securely) inside.",{"@attributes":{"id":"p-0086","num":"0085"},"figref":"FIG. 6","b":["310","312","310","314","316","318","320","312","314","312"]},"Media content is received into household  at server  and transmitted (in encrypted form) to the rendering system(s)  desired by the user. The content can be transmitted in its entirety prior to beginning rendering, or alternatively streamed to the rendering system(s)  so that rendering can begin before all of the content is transferred (such as in accordance with the ASF (Advanced Streaming Format) standard or other formats or standards). Additional information regarding ASF is available from Microsoft Corporation of Redmond, Wash. Each rendering system  includes a smart card reader that allows communication between the rendering system and a smart card so that encrypted media content received from server  can be decrypted and rendered. Additionally, server  includes a smart car reader that allows server  to encrypt received media content.","Alternatively, media content may be received at one or more of the rendering systems  and rendered and\/or stored at that rendering system, transferred to another rendering system (for rendering or storage), or transferred to server  for storage. Any such transfers to other rendering systems or server  are transfers of the media content in encrypted form.","In one implementation, each of the rendering systems  is a system  of FIG. . Alternatively, some of the rendering systems  may not include all of the modules, or be coupled to all of the devices, as is system . By way of example, a rendering system  may be able to receive media content via the network and decrypt the media content, but not be able to descramble or store the content (e.g., modules , , , , and  of  would not be included, and the system would not be directly coupled to set top box  or storage device ).","In one implementation, server  is a system  of FIG. . Alternatively, server  may not be able to render media content (e.g., modules , , and  of  would not be included, and the server would not be directly coupled to a rendering device ).","Multiple similar smart cards  can be issued to a household (e.g., a user or group of users, such as a family), each including the same household identifier and\/or key pair. Other information could differ among cards, but the information used to encrypt and decrypt the media content (e.g., the household identifier and\/or key pair) needs to be the same for all such cards so that any one can decrypt content encrypted by another one of the cards. Such multiple keys allows multiple systems (e.g., multiple rendering systems ) within a household to render content concurrently (or not concurrently, but also not requiring the smart card to be carried from one system  to another).","By encrypting the media content using a smart card , and correspondingly requiring a smart card  for decryption, limitations are placed on the ability to render (playback) the content. This effectively creates a boundary to the user's network, the boundary being defined by wherever the smart card  goes (e.g., within house ). This effective boundary prevents a malicious user from copying useable media content to a server on the Internet. Although such a user could copy the encrypted media content to a server on the Internet, no one else would be able to decrypt it without that user's smart card. A user would, however, be able to copy the encrypted media content to a server on the Internet and then subsequently retrieve the content from that server and render it providing the user had a smart card with the household identifier used to encrypt the media content.",{"@attributes":{"id":"p-0093","num":"0092"},"figref":["FIG. 7","FIG. 7","FIG. 3","FIG. 7","FIGS. 3 and 6"],"b":"220"},"Initially, a signal carrying scrambled media content is received (act ). Descrambling and encrypting module  checks whether the smart card  is authorized to encrypt the media content (act ). Any restrictions that are placed on the usage of smart card  to encrypt media content (e.g., the smart card being able to authenticate itself, greater than a threshold amount of electronic money being stored on the card, etc.) must be satisfied in act . If at least one of the restrictions is not satisfied, then the descrambling and decrypting process fails (act ). However, if all of the restrictions are satisfied, then descrambling and encrypting module  removes the scrambling of the content (act ). Alternatively, media content may be received in act  which is not scrambled, in which case act  can be skipped.","The descrambled content is then encrypted by descrambling and encrypting module  based on smart card  (act ). This encrypting is based, as discussed above, on a household identifier corresponding to smart card . Once the content is encrypted, different actions can be taken. Which action is to be taken can be determined automatically (e.g., according to behavior learned from previous user requests, according to default programming, according to commands embedded in the received media content, etc.) or manually (e.g., according to a specific user request for this content). In the illustrated example, these different actions include storing the content, transferring the content, and rendering the content.","If the content is to be stored, then rendering delay module  (or time shifting module ) saves the encrypted content to storage device  (act ). However, if the content is to be transferred, then home network module  transfers the content over a network to another computing device (e.g., another rendering system  or server  of ) via network interface  (act ).","On the other hand, if the content is to be rendered, then the encrypted content is made available to decoder module  (act ). Decoder module  checks whether the smart card is authorized to decrypt the media content (act ). This authorization process is analogous to that discussed above with respect to act , except that it is for decryption rather than encryption. If the smart card is not authorized to decrypt the media content, then the decryption and rendering process fails (act ). However, if the smart card is authorized to decrypt the media content, then decoder module  decrypts and decodes the content (act ), then transmits the decoded content to renderer module  for rendering on rendering device  (act ). Alternatively, as discussed above with reference to , additional encryption of the decoded content may be performed by decoder module  and subsequent decryption performed by renderer module  or rendering device .","The process of  operates based on received media content. This media content can be operated on in different portions. The media content may be received in a format that separates the content into particular portions (e.g., packets or units) and these portions may be operated on individually. For example, descrambling and encrypting module  may descramble and encrypt each portion individually, each encrypted portion resulting in a packet (e.g., packet  of ) to be forwarded to another module -.","Alternatively, the separation of content into packets may be performed by a module of system , such as descrambling and encrypting module . According to this alternative, module  determines how to separate the incoming content into multiple packets (e.g., multiple packets  of FIG. ). This determination can be made, for example, based on the format of the received signal and\/or content.",{"@attributes":{"id":"p-0100","num":"0099"},"figref":["FIG. 8","FIG. 8","FIG. 3","FIG. 8","FIGS. 3 and 7"],"b":"220"},"Initially, encrypted content is received by decoder module  (act ). This encrypted content can be received from any of a variety of different sources, such as from storage device  via rendering delay module  or time shifting module , from another computing device via network interface  and home network module , directly from descrambling and encrypting module , from another processing module in system  (e.g., video analyzer module ), etc.","In some instances, content can even be encrypted to a particular household (thereby requiring the smart card  to decrypt and render the content) prior to its transmission to the household. By way of example, in a content on-demand environment where media content is available to individual user's on demand (e.g., for a fee), the household identifier for the user can be made available to the on-demand provider (e.g., the household identifier may be transmitted to the provider along with the request for content, pre-payment of the fee, during an initial registration process, etc.), thereby allowing the provider to encrypt the content to the user. The content can then be transmitted to the user via any public, non-secure network(s) without concern on the part of the provider because only the user that paid for the content, with the appropriate smart card , will be able to decrypt and render the content.","Decoder module  checks whether the smart card is authorized to decrypt the media content (act ). This checking is analogous to the checking discussed above with reference to act  of , except that it is for decryption rather than encryption. If the smart card is not authorized to decrypt the media content, then the decrypting and rendering process fails (act ). However, if the smart card is authorized to decrypt the media content, then decoder module  decrypts and decodes the content (act ).","Once the content is decrypted and decoded, different actions can be taken based on whether the content needs to be re-encrypted before being transferred to rendering device . If the data channel from decoder module  to rendering device  is secure, then additional encryption is not necessary and the decoded content is transmitted to renderer module  for rendering on rendering device  (act ).","However, if the data channel from decoder module  to rendering device  is not secure, then decoder module  encrypts the decoded content (act ). Decoder module  then transmits the encrypted decoded content to renderer module  (act ). Although not shown in , decoder module  may optionally perform an additional check, prior to encrypting the decoded content (or prior to transmitting the encrypted decoded content), as to whether the smart card is authorized to encrypt the media content (analogous to act  of FIG. ). If such a check is made and the smart card is not authorized to encrypt the media content, then the rendering process fails. Renderer module  checks whether the smart card is authorized to decrypt the media content (act ). This checking is analogous to the checking discussed above with reference to act  of , except that it is for decryption rather than encryption. If the smart card is not authorized to decrypt the media content, then the decrypting and rendering process fails (act ). However, if the smart card is authorized to decrypt the media content, then the encrypted decoded content is decrypted and rendered on rendering device  (act ). The decryption of the encrypted decoded content can be performed by renderer module  (e.g., if there is a secure data path between module  and device ) or alternatively by rendering device  (e.g., if there is not a secure data path between module  and device ).","By requiring a smart card to render media content, various parental control schemes can be implemented using the smart card. In one such scheme, parents are able to restrict their children's ability to watch (and\/or listen to) media content by restricting their children's usage of the smart card(s). By way of example, a parent can allow the child to use the card to decrypt content only during times of the day that the parent is willing to allow the child to view\/listen to the content. When the parent takes the smart card away from the child (or removes the smart card from the system), the child is no longer able to view\/listen to the content.","In another such scheme, a household can have multiple different smart cards and parents can use different smart cards for encrypting different categories of content. Thus, content that parents do not want their children to view\/listen to is encrypted based on one card (e.g., a \u201cparents\u201d card, or an \u201cR-rated\u201d card), while content that children can view\/listen to is encrypted based on another card (e.g., a \u201cfamily\u201d card, or a \u201cG-rated\u201d card). The parents can then insert the family\/G-rated card when the children are awake, which cannot decrypt content that was encrypted based on the parents\/R-rated card. Similarly, after the children are in bed, the parents\/R-rated card can be inserted into the system, allowing the non-family oriented content to be decrypted and rendered.","In yet another such scheme, a rating (e.g., \u201cparents\u201d, \u201cR\u201d, \u201cfamily\u201d, \u201cPG\u201d, \u201cG\u201d, etc.) is associated with and securely stored on the smart card (e.g., in data section  or elsewhere in memory  of FIG. ). Media content can also include a corresponding rating for the content (e.g., in header  of FIG. ). If the rating associated with the smart card does not match the rating of the media content, then the media content is not encrypted and\/or decrypted by the system. This check can occur, for example, in the authorization checking steps , , , and  of .","The ratings may also have an ordering (e.g., common movie ratings such as \u201cG\u201d, \u201cPG\u201d, \u201cPG-13\u201d, \u201cR\u201d, and \u201cX\u201d). In this situation, the media content can be encrypted and\/or decrypted by the system only if the rating associated with the smart card is equal to or greater than the rating of the media content (e.g., using the movie ratings in the previous example, media content having a \u201cPG-13\u201d rating could be encrypted and\/or decrypted using a smart card having an associated rating of \u201cPG-13\u201d, \u201cR\u201d, or \u201cX\u201d).","Note that these parental controls can be effective regardless of whether the original media content received and encrypted was scrambled. By encrypting all media content that is available in the household, these parental control schemes can be used to restrict children's viewing of all content without regard for whether the content was originally scrambled.","The smart cards can further be used to maintain privacy of individual viewing habits within a household. Different users in the household can have their own smart cards for encrypting and decrypting media content. Thus, even if a user records media content on a system available to others in the household (e.g., server  of FIG. ), no other member of the household will be able to identify what the content is because their individual smart cards cannot be used to decrypt the content. This can be useful, for example, if a user has risqu\u00e9\u00b4 viewing habits that he or she desires to keep secret from other members of the household.","Thus, associating content with households using smart cards has been described. Media content received at a household is advantageously encrypted based on a household identifier corresponding to a smart card. The media content can then be rendered anywhere (inside the household, or even at another house) as long as the smart card is at the same location.","Although the description above uses language that is specific to structural features and\/or methodological acts, it is to be understood that the invention defined in the appended claims is not limited to the specific features or acts described. Rather, the specific features and acts are disclosed as exemplary forms of implementing the invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention is illustrated by way of example and not limitation in the figures of the accompanying drawings. The same numbers are used throughout the figures to reference like components and\/or features.",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
