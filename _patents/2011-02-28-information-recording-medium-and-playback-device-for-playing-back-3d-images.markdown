---
title: Information recording medium and playback device for playing back 3D images
abstract: To aim to increase the use efficiency of a screen on which a subtitle is displayed together with a stereoscopic image. A video shift mode is set for each subtitle. When a stereoscopic image is played back, in accordance with the video shift mode of the subtitle, a video plane is shifted upward or downward to perform cropping processing of collecting black frames provided in the upper end and the lower end of the screen in either one of the upper end and the lower end so as to save a display region of the subtitle.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08121460&OS=08121460&RS=08121460
owner: Panasonic Corporation
number: 08121460
owner_city: Osaka
owner_country: JP
publication_date: 20110228
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This is a continuation of International Application PCT\/JP2010\/003998, with an international filing date of Jun. 16, 2010.","The present invention relates to a technology of playing back 3D and 2D images.","The 2D images, also called monoscopic images, are represented by pixels on an X-Y plane that is applied to the display screen of the display device. In contrast, the 3D images have a depth in the Z-axis direction in addition to the pixels on the X-Y plane applied to the screen of the display device.","The 3D images are presented to the viewers (users) by simultaneously playing back the left-view and right-view images to be viewed respectively by the left and right eyes so that a stereoscopic effect can be produced. The users would see, among the pixels constituting the 3D image, pixels having positive Z-axis coordinates in front of the display screen, and pixels having negative Z-axis coordinates behind the display screen.","It is preferable that an optical disc storing a 3D image has compatibility with a playback device that can play back only 2D images (hereinafter, such a playback device is referred to as \u201c2D playback device\u201d). This is because, otherwise, two types of discs for 3D and 2D images need to be produced so that the 2D playback device can play back the same content as that stored in a disc for 3D image. Such an arrangement will take a higher cost. It is accordingly necessary to provide an optical disc storing a 3D image that is played back as a 2D image by the 2D play back device, and as a 2D or 3D image by a play back device supporting both the 3D and 2D images (hereinafter, such a playback device is referred to as \u201c2D\/3D playback device\u201d).","Patent Literature 1 identified below is one example of prior art documents describing technologies for ensuring the compatibility in playback between 2D and 3D images, with respect to optical discs storing 3D images.","[Patent Literature 1] Japanese Patent No. 3935507","By the way, in the case of a movie work or the like, subtitle data is stored in an optical disc subtitle. Generally, when such a movie work is played back, subtitles are overlaid with videos for display. Here, if long scripts or narrations are included in the movie work, most of a screen is occupied with display regions for subtitle characters. If playback of a video with a high level of jump-out is performed in the state where most of the screen is occupied with the display regions for subtitle characters, subtitles overlap stereoscopic display of the video. This results in playback of a stereoscopic image that is extremely difficult to view. There is a method of moving the arrangement position of the subtitle characters an end of the screen such that the subtitles does not overlap stereoscopic display of the video. However, a stereoscopic effect of a video greatly differs depending on a playback position in a plurality of playback sections in the time axis of a video stream. Also, subtitle characters often differ in character amount depending on the type of language. Accordingly, if any one of the ends of the screen is uniformly fixed as a subtitle display region, the use efficiency of the screen is deteriorated. As a result, even if a user spends his money to purchase an expensive widescreen 3D TV, there might occur a case where the user cannot enjoy the stereoscopic effect to the full.","The present invention provides a recording medium capable of avoiding degradation of a stereoscopic effect due to decrease of the use efficiency of a screen.","The present invention provides a recording medium having recorded thereon a video stream constituting a stereoscopic image, playlist information, and a plurality of subtitle streams, wherein the playlist information includes a stream selection table and a plurality of pieces of additional information, the stream selection table shows a stream number, a stream entry, and a stream attribute, with respect to each of the subtitle streams to be permitted to be played back in a monoscopic playback mode, the pieces of additional information each correspond to a stream number, and the pieces of additional information each include a region-saving flag indicating, as a display region of a subtitle in a stereoscopic playback mode of a playback device, an upper end or a lower end in a video plane, the subtitle is obtained by decoding a subtitle stream corresponding to the piece of additional information, when the recording medium is played back by a playback device, if the region-saving flag indicates the upper end, the playback device shifts the video stream in the video plane in a downward direction, and renders the shifted video stream, and if the region-saving flag indicates the lower end, the playback device shifts the video stream in the video plane in an upward direction, and renders the shifted video stream.","The additional information including a region-saving flag defining a display region of a subtitle is included in a stream selection table for each playback section in correspondence with a stream number. When the playback section changes, or when a request for changing the stream is received, a stream selection procedure is executed. A stream number in accordance with the language settings of a playback device is set in a stream number register. As a result, a region-saving flag indicated by a piece of additional information corresponding to the set stream number is provided with the playback device. With this structure, it is possible to realize control in which a display region of a subtitle is saved in the upper end of the screen in a playback section and a display region of a subtitle is saved in the lower end of the screen in another playback section.","The cinema scope size (1:2.35) is generally used for the aspect ratio of video of movies. In the case where a video is stored in an optical disc such as a BD-ROM, a main feature video is disposed in the center of an HD video having the aspect ratio of 16:9 without changing the aspect ratio, and a black frame is inserted into each of the upper side and the lower side of the HD video. Accordingly, with the above structure, it is possible to display subtitles in a large subtitle display region generated by collecting black frames located above and below the main feature video to one of the upper end and the lower end of the video plane. This can improve the use efficiency of the screen, thereby improving the stereoscopic effect.","(Additional Technical Problem)","According to 3D videos in which the stereoscopic effect is realized using the parallax difference between main-view image and a sub-view image, the parallax difference differs depending on the screen size of display device. This causes difference in the depth of images depending on the screen size. As a result, if a 3D video created for viewing in a display device with a large screen is viewed in a display device with a small screen, the 3D video is not powerful and less width is displayed in such a display device than a creator of the 3D video has expected. On the other hand, a 3D video created for viewing in a display device with a small screen is viewed in a display device with a large screen, an excessive sense is given to the 3D video and this causes a viewer to suffer from eye strain.","The present invention aims to provide a recording medium that is capable of preventing occurrence of negative influence exerted by viewing of a 3D video in a display device with a screen whose size is different from that assumed in the creation of the 3D video.","A recording medium that can solve the above problem is a recording medium having recorded thereon a main-view video stream, a sub-view video stream, and meta data, wherein the main-view video stream includes main-view picture data constituting a main-view of a stereoscopic video, the sub-view video stream includes sub-view picture data constituting a sub-view of the stereoscopic video, the meta data includes offset correction values each corresponding to screen size information of each of a plurality of display devices, and the offset correction value defines an offset for shifting, in a leftward direction or a rightward direction of a horizontal coordinate, at least one of a main-view video plane in which the main-view picture data is to be rendered and a sub-view video plane in which the sub-view picture data is to be rendered.","By giving, to picture data, an offset defined in screen size information for each display screen size so as to shift the video plane, it is possible to give an appropriate parallax difference to a stereoscopic image depending on each screen size. As a result, with the above structure, it is possible to prevent occurrence of negative influence exerted by viewing of a 3D video in a display device with a screen whose size is different from that assumed in the creation of the 3D video.","The recording media provided with the solution to problem described above may be implemented as package media containing contents for sale on a store. Also, playback devices supporting the recording media may be implemented as player devices for playing back the package media, and integrated circuits supporting the recording media may be implemented as system LSIs to be embedded in the player devices.",{"@attributes":{"id":"p-0130","num":"0129"},"figref":["FIGS. 1A through 1C","FIG. 1A"],"b":["100","200","300","400","500"]},"The recording medium  provides the home theater system with, for example, a movie work. The movie work may provide a stereoscopic image. Here, the stereoscopic image is composed of at least two view-point images. The view-point image is an image that is deflected to some extent, and the at least two view-point images include a main-view image and a sub-view image. As shown in , the recording medium  may be, for example, a disc or a memory card among many types of recording media. In the following, a \u201crecording medium\u201d is presumed to be a disc unless otherwise noted.","The playback device  is connected with the display device  and plays back the recording medium . The playback device described in the present application is a 2D\/3D playback device (player) which, provided with the 2D output mode and the 3D output mode, can switch between these output modes to play back a main-view video stream representing a main-view image and a sub-view video stream representing a sub-view image.","The display device  is a television and provides the user with an interactive operation environment by displaying a menu and the like as well as images of movie works. In the present embodiment, the user needs to wear the 3D glasses  for the display device  to realize the stereoscopic viewing. Here, the 3D glasses  are not necessary when the display device  displays images by the lenticular method.","The 3D glasses  are equipped with liquid-crystal shutters that enable the user to view a parallax image by the sequential segregation method or the polarization glasses method. Here, the parallax image is an image which is composed of a pair of (i) an image that enters only into the right eye and (ii) an image that enters only into the left eye, such that pictures respectively associated with the right and left eyes respectively enter the eyes of the user, thereby realizing the stereoscopic viewing.  shows the state of the 3D glasses  when the left-view image is displayed. At the instant when the left-view image is displayed on the screen, the liquid-crystal shutter for the left eye is in the light transmission state, and the liquid-crystal shutter for the right eye is in the light block state.  shows the state of the 3D glasses  when the right-view image is displayed. At the instant when the right-view image is displayed on the screen, the liquid-crystal shutter for the right eye is in the light transmission state, and the liquid-crystal shutter for the left eye is in the light block state.","The remote control  is a machine for receiving operations for playing back AV from the user. The remote control  is also a machine for receiving operations onto the layered GUI from the user. To receive the operations, the remote control  is equipped with a menu key, arrow keys, an enter key, a return key, and numeral keys, where the menu key is used to call a menu constituting the GUI, the arrow keys are used to move a focus among GUI components constituting the menu, the enter key is used to perform ENTER (determination) operation onto a GUI component constituting the menu, the return key or numeric keys are used to return to a higher layer in the layered menu.","In the home theater system shown in , an output mode of the playback device for causing the display device  to display images in the 3D output mode is called a \u201c3D output mode\u201d, and an output mode of the playback device for causing the display device  to display images in the 2D output mode is called a \u201c2D output mode\u201d.","This completes the description of the usage act of the recording medium and the playback device.","Embodiment 1 is characterized in that a register in the playback device stores information that indicates whether or not the playback device has a capability to realize a stereoscopic viewing using a right-eye graphics stream and a left-eye graphics stream.","In the following description, the main-view and the sub-view are used to realize the parallax image method. The parallax image method (also called 3D-LR mode) is a method for realizing the stereoscopic viewing by preparing separately an image for the right eye and an image for the left eye, and causing the image for the right eye to enter only into the right eye and the image for the left eye enter only into the left eye.  shows the user's head on the left side of the drawing and the images of a dinosaur skeleton seen respectively by the left eye and the right eye of the user on the right side of the drawing. When the light transmission and block are repeated alternately for the left and right eyes, the left and right scenes are overlaid in the brain of the user by the effect of residual images of eyes, and the overlaid image is recognized as a stereoscopic image appearing in front of the user.","The MPEG4-MVC method is used as the method for encoding the video streams for realizing such a stereoscopic viewing. In the description hereinafter it is presumed that the main-view video stream is \u201cbase-view video stream\u201d in the MPEG4-MVC method, and the sub-view video stream is \u201cdependent-view video stream\u201d in the MPEG4-MVC method.","The MPEG4-MVC base-view video stream is a sub-bit stream with view_id being set to \u201c0\u201d, and is a sequence of view components with view_id being set to \u201c0\u201d. The MPEG4-MVC base-view video stream conforms to the restrictions imposed on the MPEG4-AVC video stream.","The MPEG4-MVC dependent-view video stream is a sub-bit stream with view_id being set to \u201c1\u201d, and is a sequence of view components with view_id being set to \u201c1\u201d.","A view component is one of a plurality of pieces of picture data that are played back simultaneously for the stereoscopic viewing in one frame period. A compress-encoding that makes use of the correlation between view points is realized by using, as picture data, view components of the base-view and dependent-view video streams to realize a compress-encoding that makes use of the correlation between pictures. View components of the base-view and dependent-view video streams assigned to one frame period constitute one access unit. This makes it possible for the random access to be performed in a unit of the access unit.","Each of the base-view video stream and the dependent-view video stream has a GOP structure in which each view component is a \u201cpicture\u201d, and is composed of closed GOPs and open GOPs. The closed GOP is composed of an IDR picture, and B-pictures and P-pictures that follow the IDR picture. The open GOP is composed of a non-IDR I-picture, and B-pictures and P-pictures that follow the non-IDR I-picture.","The non-IDR I-pictures, B-pictures, and P-pictures are compress-encoded based on the frame correlation with other pictures. The B-picture is a picture composed of slice data in the bidirectionally predictive (B) format, and the P-picture is a picture composed of slice data in the predictive (P) format. The B-picture is classified into reference B (Br) picture and non-reference B (B) picture.","In the closed GOP, the IDR picture is disposed at the top. In the display order, the IDR picture is not the top, but pictures (B-pictures and P-pictures) other than the IDR picture cannot have dependency relationship with pictures existing in a GOP that precedes the closed GOP. As understood from this, the closed GOP has a role to complete the dependency relationship.",{"@attributes":{"id":"p-0147","num":"0146"},"figref":"FIG. 3"},"The second row of  shows the internal structure of the base-view video stream. This stream includes view components with picture types I, P, Br, Br, P, Br, Br, and P. These view components are decoded according to the Decode Time Stamps (DTS). The first row shows the left-eye image. The left-eye image is played back by playing back the decoded view components I, P, Br, Br, P, Br, Br, and P according to the PTS, in the order of I, Br, Br, P, Br, Br, and P.","The fourth row of  shows the internal structure of the dependent-view video stream. This stream includes view components with picture types P, P, B, B, P, B, B, and P. These view components are decoded according to the DTS. The third row shows the right-eye image. The right-eye image is played back by playing back the decoded view components P, P, B, B, P, B, B, and P according to the PTS, in the order of P, B, B, P, B, B, and P.","The fifth row of  shows how the state of the 3D glasses  is changed. As shown in the fifth row, when the left-eye image is viewed, the shutter for the right eye is closed, and when the right-eye image is viewed, the shutter for the left eye is closed.","Here, a mode, in which video frames of the base-view video stream (B) and video frames of the dependent-view video stream (D) are alternately output at a display cycle of 1\/48 seconds like \u201cB\u201d-\u201cD\u201d-\u201cB\u201d-\u201cD\u201d, is called a \u201cB-D presentation mode\u201d.","The B-D presentation mode includes a 3D-depth mode in which the stereoscopic viewing is realized by using the 2D images and depth information, as well as a 3D-LR mode in which the stereoscopic viewing is realized by using L (Left) images and R (Right) images.","Also, a mode, in which a same type of video frame is repeatedly output twice or more while the 3D mode is maintained as the output mode, is called a \u201cB-B presentation mode\u201d. In the B-B presentation mode, video frames of an independently playable base-view video stream are repeatedly output like \u201cB\u201d-\u201cB\u201d-\u201cB\u201d-\u201cB\u201d.","The B-D presentation mode and the B-B presentation mode described above are basic presentation modes in the playback device. Other than these, output modes such as a 1 plane+offset mode, an upper end 2D subtitle playback mode, and a lower end 2D subtitle playback mode are available in the playback device.","The 1 plane+offset mode (also referred to as \u201c3D-offset mode\u201d) is an output mode in which the stereoscopic viewing is realized by incorporating a shift unit at a location subsequent to the plane memory and functioning the shift unit. In each of the left-view period and the right-view period, the plane offset unit shifts the coordinates of the pixels in the plane memory in units of lines leftward or rightward to displace the image formation point of the right-eye and left-eye view lines frontward or backward so that the viewer can feel a change in the sense of depth. More specifically, when the pixels coordinates are shifted leftward in the left-view period, and rightward in the right-view period, the image formation point is displaced frontward; and when the pixels coordinates are shifted rightward in the left-view period, and leftward in the right-view period, the image formation point is displaced backward.","In such a plane shift, the plane memory for the stereoscopic viewing only needs to have one plane. It is thus the best method for generating the stereoscopic images with ease. However, the plane shift merely produces stereoscopic images in which monoscopic images come frontward or go backward. Therefore, it is suited for generating a stereoscopic effect for the menu or subtitle, but leaves something to be desired in realizing a stereoscopic effect for the characters or physical objects. This is because it cannot reproduce dimples or unevenness of the faces of characters.","To support the 1 plane+offset mode, the playback device is structured as follows. For the playback of graphics, the playback device includes a plane memory, a CLUT unit, and an overlay unit. The plane shift unit is incorporated between the CLUT unit and the overlay unit. The plane shift unit realizes the above-described change of pixel coordinates by using the offset in the offset sequence incorporated in the access unit structure of the dependent-view video stream. With this arrangement, the level of jump-out of pixels in the 1 plane+offset mode changes in synchronization with the MVC video stream. The 1 plane+offset mode includes \u201c1 plane+zero offset mode\u201d. The 1 plane+zero offset mode is a display mode which, when the pop-up menu is ON, gives the stereoscopic effect only to the pop-up menu by making the offset value zero.","The target of the shift control by the offset sequence is a plurality of plane memories which constitute a predetermined layer model. The plane memory is a memory for storing one screen of pixel data, which has been obtained by decoding the elementary streams, in units of lines so that the pixel data can be output in accordance with the horizontal and vertical sync signals. Each of the plurality of plane memories stores one screen of pixel data that is obtained as a result of decoding by the video decoder, PG decoder, or IG decoder.","The predetermined layer model is composed of a layer of the left-eye video plane and the right-eye video plane, a layer of the PG plane, and a layer of the IG\/BD-J plane, and is structured so that these layers (and the contents of the plane memories in these layers) can be overlaid in the order of the base-view video plane, PG plane, and IG\/BD-J plane from the bottom.","The layer overlay is achieved by executing a superimposing process onto all combinations of the two layers in the layer model. In the superimposing process, pixel values of pixel data stored in the plane memories of the two layers are superimposed. The following describes the plane memories in each layer.","The left-eye video plane is a plane memory for storing pixel data constituting the left-eye picture data among one screen of pixel data that is obtained by decoding the view components. The right-eye video plane is a plane memory for storing pixel data constituting the right-eye picture data among one screen of pixel data that is obtained by decoding the view components.","The presentation graphics (PG) plane is a plane memory for storing graphics that are obtained when a graphics decoder, which operates by the pipeline method, performs the decoding process. The IG\/BD-J plane is a plane memory that functions as an IG plane in some operation mode and functions as a BD-J plane in other operation mode. The interactive graphics (IG) plane is a plane memory for storing graphics that are obtained when a graphics decoder, which operates based on the interactive process, performs the decoding process. The BD-J plane is a plane memory for storing the drawing image graphics that are obtained when an application of an object-oriented programming language performs the drawing process. The IG plane and the BD-J plane are exclusive to each other, and when one of them is used, the other cannot be used. Therefore the IG plane and the BD-J plane share one plane memory.","In the above-mentioned layer model, with regard to the video plane, there are a base-view plane and a dependent-view plane. On the other hand, with regard to the IG\/BD-J plane and the PG plane, there is neither a base-view plane nor a dependent-view plane. For this reason, the IG\/BD-J plane and the PG plane are the target of the shift control.","The upper end 2D subtitle playback mode is an output mode in which a display region of a 2D subtitle is saved in the upper end of a video frame by incorporating a shift unit at a location subsequent to the video plane memory and causing the shift unit to function. The lower end 2D subtitle playback mode is an output mode in which a display region of a 2D subtitle is saved in the lower end of a video frame by causing the shift unit to function. In the upper end 2D subtitle playback mode, the plane offset unit shifts downward pixel coordinates of picture data stored in the video plane memory during each of the left-view period and the right-view period. In the lower end 2D subtitle playback mode, the plane offset unit shifts upward the pixel coordinates of the picture data stored in the video plane memory during each of the left-view period and the right-view period.","In order to support the upper end 2D subtitle playback mode and the lower end 2D subtitle playback mode, the playback device needs to be structured as follows. The playback device includes a video plane memory and an overlay unit for playback of video frames and graphics, and further includes a shift unit incorporated between the video plane memory and the overlay unit. The shift unit realizes the change of pixel coordinates as described above, using an offset incorporated into a stream registration sequence of a graphics stream.",{"@attributes":{"id":"p-0166","num":"0165"},"figref":["FIG. 4A","FIGS. 4B and 4C"]},"This completes the explanation of the 3D output mode. The following explains the internal structure of the recording medium pertaining to the present embodiment.",{"@attributes":{"id":"p-0168","num":"0167"},"figref":["FIGS. 5A through 5C","FIG. 5A"]},"<Index Table>","The index table is management information of the entire recording medium. The index table is read first by a playback device after the recording medium is loaded into the playback device, thereby the recording medium is uniquely identified by the playback device.","<Program File>","The program file of the operation mode object stores control programs for operating the playback device. The control program may be written as a set of commands or written in an object-oriented compiler language. The former program supplies a plurality of navigation commands as a batch job to the playback device in the command-based operation mode to operate the playback device based on the navigation commands. The command-based operation mode is called an \u201cHDMV mode\u201d.","The latter program supplies bytecode applications, which are instances of class structure, to the playback device in the operation mode which is based on the object-oriented compiler language, in order to operate the playback device based on the instances. Java\u2122 applications, which are one of the bytecode applications, can be used as the instances of class structure. The operation mode based on the object-oriented compiler language is called a \u201cBD-J mode\u201d.","<Stream File>","A stream file stores a transport stream that is obtained by multiplexing a video stream, one or more audio streams, and a graphics stream. The stream file has two types: 2D-only; and 2D\/3D shared. The 2D-only stream file is in a normal transport stream format. The 2D\/3D shared stream file is in a stereoscopic interleaved stream file format.","The stereoscopic interleaved stream file format is a file format in which Extents of a main transport stream (main TS) including a base-view stream and Extents of a sub transport stream (sub TS) including a dependent-view stream are arranged in an interleaved manner.","The main TS stored in the stream file contains packet management information (PCR, PMT, PAT) defined in the European digital broadcast standard, as information for managing and controlling a plurality of types of PES streams.","The PCR (Program Clock Reference) stores STC time information corresponding to an ATS that indicates the time when the PCR packet is transferred to a decoder, in order to achieve synchronization between an ATC (Arrival Time Clock) that is a time axis of ATSs, and an STC (System Time Clock) that is a time axis of PTSs and DTSs.","The PMT (Program Map Table) stores PIDs in the streams of video, audio, graphics and the like contained in the transport stream file, and attribute information of the streams corresponding to the PIDs. The PMT also has various descriptors relating to the TS. The descriptors have information such as copy control information showing whether copying of the AV clip is permitted or not.","The PAT (Program Association Table) shows a PID of a PMT used in the TS, and is registered by the PID arrangement of the PAT itself.","These PCR, PMT, and PAT, in the European digital broadcast standard, have a role of defining partial transport streams constituting one broadcast program (one program). This enables the playback device to cause the decoder to decode TSs as if it deals with the partial TSs constituting one broadcast program, conforming to the European digital broadcast standard. This structure is aimed to support compatibility between the recording medium playback devices and the terminal devices conforming to the European digital broadcast standard.","Pair of extents in the main TS and the sub-TS are each set to have a data size such that underflow of double buffer is not occurred during playback. This enables the playback device to load these pairs of extents without interruption.","This completes the description of the stream file.","<Stream Information File>","The stream information file is a file for ensuring a random access to any source packet in a transport stream stored in a stream file, and ensuring a seamless playback with other transport streams. Via the stream information files, the stream files are managed as \u201cAV clips\u201d. The stream information file includes information of the AV clip such as the stream encoding format, frame rate, bit rate, and resolution, and includes a basic entry map that shows correspondence between source packet numbers at the starts of GOPs and the presentation time stamps in the frame periods. Thus, by preloading the stream information file prior to an access to the stream file, the property of the transport stream in the stream file to be accessed is recognized, thereby the execution of the random access is ensured. The stream information file has two types: 2D stream information file; and 3D stream information file. The 3D stream information file includes clip information for the base view (clip base information), clip information for the dependent view (clip dependent information), and an entry map extended for the stereoscopic viewing.","The clip base information includes base-view extent start point information, and the clip dependent information includes dependent-view extent start point information. The base-view extent start point information includes a plurality of source packet numbers. Each source packet number indicates a packet number of a packet including a boundary between Extents in the main TS. The dependent-view extent start point information also includes a plurality of source packet numbers. Each source packet number indicates a packet number of a packet including a boundary between Extents in the sub-TS. By using these extent start point information, the stereoscopic interleaved stream file is divided into an ATC sequence  constituting the main TS and an ATC sequence  constituting the sub-TS. The ATC sequence is a sequence of source packets, wherein Arrival_Time_Clocks referred to by the Arrival_Time_Stamps included in the ATC sequence includes \u201cno arrival time-base discontinuity\u201d. Since the ATC sequence is a sequence of source packets in which the ATC time stamps are continuous, each source packet constituting the ATC sequence is subjected to continuous source packet depacketizing processes and continuous packet filtering processes while the clock counter is counting the arrival time clocks of the playback device.","While the ATC sequence is a sequence of source packets, a sequence of TS packets whose time stamps are continuous in the STC time axis is called an \u201cSTC sequence\u201d. The STC sequence is a sequence of TS packets which do not include \u201csystem time-base discontinuity\u201d, which is based on the STC (System Time Clock) that is a system standard time for TSs. The presence of the system time-base discontinuity is indicated by a \u201cdiscontinuity_indicator\u201d being ON, where the discontinuity_indicator is contained in a PCR packet carrying a PCR (Program Clock Reference) that is referred to by the decoder to obtain an STC. The STC sequence is a sequence of TS packets whose time stamps are continuous in the STC time axis. Therefore, each TS packet constituting the STC sequence is subjected to continuous decoding processes performed by the decoder provided in the playback device, while the clock counter is counting the system time clocks of the playback device. The extension entry map indicates, in correspondence with the presentation time stamps representing the frame periods at the starts of GOPs, source packet numbers of access unit delimiters which indicate starting positions of view components at the starts of GOPs in the dependent-view video stream.","On the other hand, the basic entry map in the 3D stream information file indicates, while maintaining the compatibility with the 2D stream information file, in correspondence with the presentation time stamps representing the frame periods at the starts of GOPs, source packet numbers of access unit delimiters which indicate starting positions of view components at the starts of GOPs in the base-view video stream.","<Playlist Information File>","The playlist information file is a file storing information that is used to cause the playback device to play back a playlist. The \u201cplaylist\u201d indicates a playback path defined by logically specifying a playback order of playback sections, where the playback sections are defined on a time axis of transport streams (TS). The playlist has a role of defining a sequence of scenes to be displayed in order, by indicating which parts of which transport streams among a plurality of transport streams should be played back. The playlist  information defines \u201cpatterns\u201d of the playlists. The playback path defined by the playlist information is what is called a \u201cmulti-path\u201d. The multi-path is composed of a \u201cmain path\u201d and one or more \u201csub-paths\u201d. The main path is defined for the main transport streams. The sub-paths are defined for sub streams. A plurality of sub-paths can be defined while one main path is defined. By defining a playback path of the base-view video stream in the main path and defining a playback path of the dependent-view video stream in the sub-path, it is possible to suitably define a set of video streams for performing a stereoscopic playback.","AV playback by the multi-path can be started when the application of an object-oriented programming language instructs to generate a frame work player instance that plays back the playlist information. The frame work player instance is actual data that is generated on the heap memory of the virtual machine based on the media frame work player class. Also, arrangement may be made so that playback by the multi-path can be started when a command-based program issues a playback command with an argument specifying the playlist information.","The playlist information includes one or more pieces of playitem information. The playitem information is playback section information that defines one or more pairs of an \u201cin_time\u201d time point and an \u201cout_time\u201d time point on the video stream playback time axis.","The playlist information has a hierarchical structure composed of playitem information, clip information, and a transport stream. It is possible to set a one-to-many relationship between (i) a pair of transport stream and clip information and (ii) playitem information so that one transport stream can be referenced by a plurality of pieces of playitem information. This makes it possible to adopt, as a bank film, a transport stream created for a title so that the bank film can be referenced by a plurality of pieces of playitem information in a plurality of playlist information files, making it possible to create a plurality of variations of a movie effectively. Note that the \u201cbank film\u201d is a term used in the movie industry and means an image that is used in a plurality of scenes.","In general, the users do not recognize the unit called playlist, and recognize a plurality of variations (for example, a theatrical version and a TV broadcast version) branched from the stream files as the playlists.","The playlist information falls into two types: 2D playlist information; and 3D playlist information. A difference between them is that the 3D playlist information includes a base-view indicator and a stereoscopic stream selection table.","The \u201cstereoscopic stream selection table\u201d is a table that shows, in correspondence with stream numbers, stream attributes and stream entries of elementary streams that are to be played back only in the 3D output mode.","The \u201cbase-view indicator\u201d is information indicating either the left eye or the right eye for which the base-view video stream is to be indicated, wherein the base-view video stream is the base of the compress-encoding using the correlation between view points. By changing the base-view indicator of the playlist information, it is possible to change the assignment of the left eye and right eye at the level of the playlist.","Since the assignment of the left eye and right eye can be changed at the level of the playlist that does not depend on the structure of the stream, when, for example, there is a playlist in which the position and angle of an object in the image is set as \u201cbase view=left eye\u201d and \u201cdependent view=right eye\u201d, it is possible to generate a playlist in which the position and angle of an object in the image is set as \u201cbase view=right eye\u201d and \u201cdependent view=left eye\u201d, as another version.","By reversing the assignment of the left eye and right eye to the base-view and dependent-view video streams at the level of the playlist, it is possible to reverse the stereoscopic effect. For example, when there has already been generated a playlist intending a stereoscopic effect that the object appears in front of the screen, it is possible to generate another playlist intending a stereoscopic effect that the object appears behind the screen. This produces an advantageous effect that variations of 3D playlists with different stereoscopic effects can be generated easily.",{"@attributes":{"id":"p-0195","num":"0194"},"figref":["FIG. 5B","FIG. 5C","FIG. 5B","FIG. 5C"]},"Next, the internal structure of TS will be described.","The elementary streams (ES) to be multiplexed in the TSs include the video stream, audio stream, presentation graphics stream, and interactive graphics stream.","(Video Stream)","The base-view video stream constitutes a primary video stream in a picture-in-picture application. The picture-in-picture application is composed of the primary video stream and a secondary video stream. The primary video stream is a video stream composed of picture data of the picture-in-picture application that represents a parent picture in the screen; and the secondary video stream is a video stream composed of picture data of the picture-in-picture application that represents a child picture that is fit in the parent picture.","The picture data constituting the primary video stream and the picture data constituting the secondary video stream are stored in different plane memories after being decoded. The plane memory that stores the picture data constituting the secondary video stream has, in the first half thereof, a structural element (Scaling & Positioning) that performs changing scaling of the picture data constituting the secondary video stream, and positioning display coordinates of the picture data constituting the secondary video stream.","(Audio Stream)","The audio stream is classified into two types of a primary audio stream and a secondary audio stream.","The primary audio stream is an audio stream that is to be a main audio when the mixing playback is performed; and the secondary audio stream is an audio stream that is to be a sub-audio when the mixing playback is performed. The secondary audio stream includes information for downsampling for the mixing, and information for the gain control.","(Presentation Graphics (PG) Stream)","The PG stream is a graphics stream that can be synchronized closely with the video, with the adoption of the pipeline in the decoder, and is suited for representing subtitles. The PG stream falls into two types: a 2D PG stream; and a stereoscopic PG stream. The stereoscopic PG stream further falls into two types: a left-eye PG stream; and a right-eye PG stream.","It is possible to define up to 32 2D PG streams, up to 32 left-eye PG streams, and up to 32 right-eye PG streams. These PG streams are attached with different packet identifiers. Thus, it is possible to cause a desired PG stream among these PG streams to be subjected to the playback, by specifying a packet identifier of the one to be played back to the demultiplexing unit.","Close synchronization with video is achieved due to the decoding with the pipeline adopted therein. Thus the use of the PG stream is not limited to the playback of characters such as the subtitle characters. For example, it is possible to display a mascot character of the movie that is moving in synchronization with the video. In this way, any graphics playback that requires close synchronization with the video can be adopted as a target of the playback by the PG stream.","The PG stream is a stream that is not multiplexed into the transport stream but represents a subtitle. The text subtitle stream (also referred to as a \u201ctextST stream\u201d) is a stream of this kind, as well. The textST stream is a stream that represents the contents of subtitle by the character codes.","The PG stream and the text subtitle stream are registered as the same stream type in the same stream registration sequence, without distinction between them in type. And then during execution of a procedure for selecting a stream, a PG stream or a text subtitle stream to be played back is determined according to the order of streams registered in the stream registration sequence. In this way, the PG streams and text subtitle streams are subjected to the stream selection procedure without distinction between them in type. Therefore, they are treated as belonging to a same stream type called \u201cPG_text subtitle stream\u201d.","The PG_text subtitle stream for 2D is played back in the 1 plane+offset mode, the upper end 2D subtitle playback mode, and the lower end 2D subtitle playback mode.","(Interactive Graphics (IG) Stream)","The IG stream is a graphics stream which, having information for interactive operation, can display menus with the progress of playback of the video stream and display pop-up menus in accordance with user operations.","As is the case with the PG stream, the IG stream is classified into two types of a 2D IG stream and a stereoscopic IG stream. The IG stream control information (called \u201cinteractive control segment\u201d) includes information (user_interface_model) that defines the user interface model. The person in charge of authoring can specify either \u201calways on\u201d or \u201cpop-up menu on\u201d by setting the user interface model information, where with the \u201calways on\u201d, menus are displayed with the progress of playback of the video stream, and with the \u201cpop-up menu on\u201d, the pop-up menus are displayed in accordance with user operations.","The interactive operation information in the IG stream has the following meaning. When the Java\u2122 virtual machine instructs the playback control engine, which is proactive in the playback control, to start playing back a playlist in accordance with a request from an application, the Java\u2122 virtual machine, after instructing the playback control engine to start the playback, returns a response to the application to notify that the playback of the playlist has started. That is to say, while the playback of the playlist by the playback control engine continues, the Java\u2122 virtual machine does not enter the state waiting for end of execution. This is because the Java\u2122 virtual machine is what is called an \u201cevent-driven-type\u201d performer, and can perform operation while the playback control engine is playing back the playlist.","On the other hand, when, in the HDMV mode, the command interpreter instructs the playback control engine to play back a playlist, it enters the wait state until the execution of playback of the playlist ends. Accordingly, the command execution unit cannot execute an interactive process while the playback of the playlist by the playback control engine continues. The graphics decoder performs an interactive operation in place of the command interpreter. Thus, to cause the graphics decoder to perform the interactive operation, the IG stream is embedded with control information defining interactive operations for which buttons are used.","(Display Modes Allowed for Each Stream Type)","Different 3D display modes are allowed for each stream type. In the primary video stream 3D display mode, two output modes, namely the B-D presentation mode and the B-B presentation mode are allowed. The B-B presentation mode is allowed for the primary video stream only when the pop-up menu is on. The type of primary video stream when the playback is performed in the B-D presentation mode is called a \u201cstereoscopic B-D playback type\u201d. The type of primary video stream when the playback is performed in the B-B presentation mode is called a \u201cstereoscopic B-B playback type\u201d.","In the PG stream 3D display mode, five output modes, namely the B-D presentation mode, 1 plane+offset mode, \u201c1 plane+Zero Offset\u201d mode, upper end 2D subtitle playback mode, and lower end 2D subtitle playback mode are allowed. The \u201c1 plane+zero offset\u201d mode is allowed for the PG stream only when the pop-up menu is on. The type of PG stream when the playback is performed in the B-D presentation mode is called a \u201cstereoscopic playback type\u201d. The type of PG stream and PG_text subtitle stream when the playback is performed in the 1 plane+offset mode is called a \u201c1 plane+offset type\u201d. The type of PG stream and PG_text subtitle stream when the playback is performed in the \u201c1 plane+zero offset\u201d mode is called a \u201c1 plane+zero offset type\u201d. A type of a PG stream or a text subtitle stream that is played back in the upper end 2D subtitle playback mode is referred to as an \u201cupper end 2D subtitle playback type\u201d. A type of a PG stream or a text subtitle stream that is played back in the lower end 2D subtitle playback mode is referred to as a \u201clower end 2D subtitle playback type\u201d.","In the text subtitle stream 3D display mode, four output modes, namely the 1 plane+offset mode, the \u201c1 plane+zero offset\u201d, upper end 2D subtitle playback mode, and lower end 2D subtitle playback mode are allowed. The \u201c1 plane+zero offset\u201d mode is allowed for the text subtitle stream only when the pop-up menu is on.","In the IG stream 3D display mode, three output modes, namely the B-D presentation mode, 1 plane+offset mode, and \u201c1 plane+zero offset\u201d mode are allowed. The \u201c1 plane+zero offset\u201d mode is allowed for the IG stream only when the pop-up menu is on. It is supposed in the following description, except where otherwise mentioned, that the picture-in-picture cannot be used during playback in the 3D output mode. This is because each of the picture-in-picture and the 3D output mode requires two video planes for storing non-compressed picture data. It is also supposed in the following description, except where otherwise mentioned, that the sound mixing cannot be used in the 3D output mode.","Next, the internal structures of the main TS and sub-TS will be described.  show the internal structures of the main TS and sub-TS.",{"@attributes":{"id":"p-0217","num":"0216"},"figref":"FIG. 6A"},"A source packet having packet ID \u201c0x0100\u201d constitutes a Program_Map_Table (PMT). A source packet having packet ID \u201c0x0101\u201d constitutes a PCR.","A source packet sequence having packet ID \u201c0x1011\u201d constitutes the primary video stream.","Source packet sequences having packet IDs \u201c0x1200\u201d through \u201c0x121F\u201d constitute 32 2D PG streams.","Source packet sequences having packet IDs \u201c0x1400\u201d through \u201c0x141F\u201d constitute 32 2D IG streams.","Source packet sequences having packet IDs \u201c0x1100\u201d through \u201c0x111F\u201d constitute primary audio streams.","By specifying a packet identifiers of one of these source packets to the demultiplexing unit, it is possible to cause a desired elementary stream among a plurality of elementary streams multiplexed in the main transport streams to be demultiplexed and subjected to the decoder.",{"@attributes":{"id":"p-0224","num":"0223"},"figref":"FIG. 6B"},"A source packet sequence having packet ID \u201c0x1012\u201d constitutes the dependent-view video stream.","Source packet sequences having packet IDs \u201c0x1220\u201d through \u201c0x123F\u201d constitute 32 left-eye PG streams.","Source packet sequences having packet IDs \u201c0x1240\u201d through \u201c0x125F\u201d constitute 32 right-eye PG streams.","Source packet sequences having packet IDs \u201c0x1420\u201d through \u201c0x143F\u201d constitute 32 left-eye IG streams.","Source packet sequences having packet IDs \u201c0x1440\u201d through \u201c0x145F\u201d constitute 32 right-eye IG streams.","This completes the description of the stream file. Next is a detailed explanation of the playlist information.","To define the above-described multi-path, the internal structures shown in  are provided.  shows the internal structure of the playlist information. As shown in , the playlist information includes main-path information, sub-path information, playlist mark information, and extension data. These constitutional elements will be described in the following.","1) The main-path information is composed of one or more pieces of main playback section information.  shows the internal structures of the main-path information and the sub-path information. As shown in , the main-path information is composed of one or more pieces of main playback section information, and the sub-path information is composed of one or more pieces of sub playback section information.","The main playback section information, called playitem information, is information that defines one or more logical playback sections by defining one or more pairs of an \u201cin_time\u201d time point and an \u201cout_time\u201d time point on the TS playback time axis. The playback device is provided with a playitem number register storing the playitem number of the current playitem. The playitem being played back currently is one of the plurality of playitems whose playitem number is currently stored in the playitem number register.",{"@attributes":{"id":"p-0234","num":"0233"},"figref":["FIG. 7C","FIG. 7C"]},"The stream reference information includes: \u201cstream Information file name information (clip_Information_file_name)\u201d that indicates the file name of the stream information file that manages, as \u201cAV clips\u201d, the transport streams constituting the playitem; \u201cclip encoding method identifier (clip_codec_identifier)\u201d that indicates the encoding method of the transport stream; and \u201cSTC identifier reference (STC_ID_reference)\u201d that indicates STC sequences in which in-time and out-time are set, among the STC sequences of the transport stream.","This completes description of the playitem information.","2) The sub playback section information, called sub-path information, is composed of a plurality of pieces of sub-playitem information.  shows the internal structure of the sub-playitem information. As shown in , the sub-playitem information is information that defines playback sections by defining pairs of an \u201cin_time\u201d and an \u201cout_time\u201d on the STC sequence time axis, and includes stream reference information, in-time out-time information, sync playitem reference, and sync start time information.","The stream reference information, as in the playitem information, includes: \u201cstream Information file name information\u201d, \u201cclip encoding method identifier\u201d, and \u201cSTC identifier reference\u201d.","The \u201cin-time out-time information (SubPlay_Item_In_Time, SubPlayItem_Out_Time)\u201d indicates the start point and end point of the sub-playitem on the STC sequence time axis.","The \u201csync start time information (Sync_Start_PTS_of_Playitem)\u201d indicates a time point on the STC sequence time axis of the playitem specified by the sync playitem identifier, that corresponds to the start point of the sub-playitem specified by the sub-playitem In_Time. The sub-playitem In_Time exists on playback time axis of the playitem specified by this sync playitem identifier.","The \u201csync start time information (Sync_Start_PTS_of_Playitem)\u201d indicates a time point on the STC sequence time axis of the playitem specified by the sync playitem identifier, that corresponds to the start point of the sub-playitem specified by the sub-playitem In_Time.","3) The playlist mark information is information that defines the mark point unique to the playback section. The playlist mark information includes an indicator indicating a playback section, a time stamp indicating the position of a mark point on the time axis of the digital stream, and attribute information indicating the attribute of the mark point.","The attribute information indicates whether the mark point defined by the playlist mark information is a link point or an entry mark.","The link point is a mark point that can be linked by the link command, but cannot be selected when the chapter skip operation is instructed by the user.","The entry mark is a mark point that can be linked by the link command, and can be selected even if the chapter skip operation is instructed by the user.","The link command embedded in the button information of the IG stream specifies a position for a random-access playback, in the form of an indirect reference via the playlist mark information.","<Basic Stream Selection Table (StreamNumber_table)>","The basic stream selection table shows a list of elementary streams that are to be played back in a monoscopic output mode, and the table, when a playitem containing the basic stream selection table itself becomes the current playitem among a plurality of playitems constituting the playlist, specifies, for each of the plurality of stream types, an ES which is permitted to be played back, among ESs multiplexed in AV clips referenced by the main path and the sub-path of the multi-path. Here, the stream types include: the primary video stream in the picture-in-picture; the secondary video stream in the picture-in-picture; the primary audio stream in the sound mixing; the secondary audio stream in the sound mixing; the PG_text subtitle stream; and the IG stream. It is possible to register an ES which is permitted to be played back, for each of these stream types. More specifically, the basic stream selection table is composed of sequences of stream registrations Here, the stream registration is information that, when a playitem containing the basic stream selection table itself becomes the current playitem, indicates what kind of stream is the ES permitted to be played back. Each stream registration is associated with the stream number of the stream. Each stream registration has a data structure in which a pair of a stream entry and a stream attribute is associated with a logical stream number.","The stream number in the stream registration is represented by an integer such as \u201c1\u201d, \u201c2\u201d, or \u201c3\u201d. The largest stream number for a stream type is identical with the number of streams for the stream type.","The playback device is provided with a stream number register for each stream type, and the current stream, namely the ES being played back currently, is indicated by the stream number stored in the stream number register.","A packet identifier of the ES to be played back is written in the stream entry. By making use of this structure in which a packet identifier of the ES to be played back can be written in the stream entry, the stream numbers included in the stream registrations are stored in the stream number registers of the playback device, and the playback device causes the PID filter thereof to perform a packet filtering based on the packet identifiers stored in the stream entries of the stream registrations. With this structure, TS packets of the ESs that are permitted to be played back according to the basic stream selection table are output to the decoder, so that the ESs are played back.","In the basic stream selection table, the stream registrations are arranged in an order of stream numbers. When there are a plurality of streams that satisfy the conditions: \u201cplayable by playback device\u201d; and \u201cthe language attribute of the stream matches the language setting in the device\u201d, a stream corresponding to the highest stream number in the stream registration sequences is selected.","With this structure, when there is found a stream that cannot be played back by the playback device, among the stream registrations in the basic stream selection table, the stream is excluded from the playback. Also, when there are a plurality of streams that satisfy the conditions: \u201cplayable by playback device\u201d; and \u201cthe language attribute of the stream matches the language setting in the device\u201d, the person in charge of authoring can convey the playback device how to select one with priority from among the plurality of streams.","It is judged whether there is a stream that satisfies the conditions: \u201cplayable by playback device\u201d; and \u201cthe language attribute of the stream matches the language setting in the device\u201d. Also, a stream is selected from among a plurality of streams that satisfy the conditions. The procedure for the judgment and selection is called \u201cstream selection procedure\u201d. The stream selection procedure is executed when the current playitem is switched, or when a request to switch the stream is input by the user.","A sequential procedure for performing the above-described judgment and selection and setting a stream number in the stream number register of the playback device when a state change occurs in the playback device, such as when the current playitem is switched, is called \u201cprocedure to be executed at state change\u201d. Since the stream number registers are provided respectively in correspondence with the stream types, the above-described procedure is executed for each stream type.","A sequential procedure for performing the above-described judgment and selection and setting a stream number in the stream number register of the playback device when a request to switch the stream is input by the user is called \u201cprocedure at state change request\u201d.","A procedure for setting the stream number registers to the initial values of the stream registration sequences when a BD-ROM is loaded, is called \u201cinitialization\u201d.","Priorities are assigned evenly to the streams specified in the sub-playitem information and the streams specified in the playitem information, as indicated by the stream registration sequences in the basic stream selection table. As a result, even a stream not multiplexed with a video stream is targeted for selection as a stream to be played back in sync with the video stream, if the stream is specified by the sub-playitem information.","Furthermore, when playback device can play back a stream specified by the sub-playitem information, and when the priority of the stream specified by the sub-playitem information is higher than the priority of the graphics stream multiplexed with the video stream, the stream specified by the sub-playitem information is played back in place of the stream multiplexed with the video stream.","The following explains the use of the stream numbers recited in the basic stream selection table. The stream numbers recited in the basic stream selection table can be used as operands of the set stream command.","The set stream command is a command that instructs the playback device to change the current stream by setting the stream number specified by the operand into the stream number register as the current stream number. The set stream command is used by a command-based program when it causes the playback device to change the stream.","The set stream command can be used as an argument of the stream change UO or an argument of the set stream API, as well. The stream change UO is a user operation event that instructs the playback device to change the current stream by setting the stream number specified by the argument into the stream number register as the current stream number.","The set stream API is an API that instructs the playback device to change the current stream by setting the stream number specified by the argument into the stream number register as the current stream number. The set stream API is used by a program based on an object-oriented programming language when it causes the playback device to change the stream.",{"@attributes":{"id":"p-0263","num":"0262"},"figref":["FIGS. 8A and 8B","FIG. 8A","FIG. 8B","FIG. 8B","FIG. 8B","FIG. 8B"]},"Next, the extension data will be described in detail.","When the playlist information refers to the MVC video stream, an extension stream selection table needs to be stored in a data block of extension data in the playlist information file.","When the playlist information refers to the MVC video stream on the disc, or the MVC video stream in the stereoscopic IG stream playback menu, extension information of the sub-path information (sub-path block extension) needs to be stored in a data block of extension data in the playlist information file.","When a 2D playback device finds unknown extension data in the playlist file, the 2D playback device should disregard the extension data.","<Extension Stream Selection Table (StreamNumber_table_StereoScopic(SS))>","The extension stream selection table shows a list of elementary streams that are to be played back in a stereoscopic output mode, and is used together with the basic stream selection table only in the stereoscopic output mode. The extension stream selection table defines the elementary streams that can be selected when a playitem is played back or when a sub-path related to the playitem is played back.","The extension stream selection table indicates the elementary streams that are permitted to be played back only in the stereoscopic output mode, and includes stream registration sequences. Each piece of stream registration information in the stream registration sequences includes a stream number, and a stream entry and a stream attribute corresponding to the stream number. The extension stream selection table means an extension that is unique to the stereoscopic output mode. Therefore, a playlist for which each piece of playitem information is associated with the extension stream selection table (STN_table_SS) is called \u201c3D playlist\u201d.","Each stream entry in the extension stream selection table indicates a packet identifier that is to be used in the demultiplexing by the playback device, when the playback device is in the stereoscopic output mode, and the corresponding stream number is set in the stream number register of the playback device. A difference from the basic stream selection table is that the stream registration sequences in the extension stream selection table are not targeted by the stream selection procedure. That is to say, the stream registration information in the stream registration sequences of the basic stream selection table is interpreted as the priorities of the elementary streams, and a stream number in any piece of stream registration information is written into the stream number register. In contrast, the stream registration sequences of the extension stream selection table are not targeted by the stream selection procedure, and the stream registration information of the extension stream selection table is used only for the purpose of extracting a stream entry and a stream attribute that correspond to a certain stream number when the certain stream number is stored in the stream number register.","Suppose that, when the output mode switches from the 2D output mode to the 3D output mode, the target stream selection table also switches from the basic stream selection table to the extension stream selection table. Then, the identity of the stream numbers may not be maintained, and the identity of the language attribute may be lost, as well.","Accordingly, the use of the extension stream selection table is restricted to the above-described one to maintain the identity of the stream attribute such as the language attribute.","The following explains the use of the stream numbers recited in the extension stream selection table. The stream numbers recited in the extension stream selection table can be used as operands of the set stream command and the set stereoscopic stream command.","The set stereoscopic stream command is a command that instructs the playback device to change the current stream by setting the stream number for stereoscopic viewing specified by the operand into the stream number register as the current stream number. The set stereoscopic stream command is used by a command-based program when it causes the playback device to change the stereoscopic stream.","The set stereoscopic stream command can be used as an argument of the stream change UO or an argument of the set stream API, as well.","The extension stream selection table is composed of stream registration sequences of the dependent-view streams, stream registration sequences of the PG streams, and stream registration sequences of the IG streams.","The stream registration sequences in the extension stream selection table are combined with the stream registration sequences of the same stream types in the basic stream selection table. More specifically, the dependent-view video stream registration sequences in the extension stream selection table are combined with the primary video stream registration sequences in the basic stream selection table; the PG stream registration sequences in the extension stream selection table are combined with the PG stream registration sequences in the basic stream selection table; and the IG stream registration sequences in the extension stream selection table are combined with the IG stream registration sequences in the basic stream selection table.","After this combination, the above-described procedure is executed onto the stream registration sequences in the basic stream selection table among the two tables after the combination.",{"@attributes":{"id":"p-0279","num":"0278"},"figref":"FIG. 9"},"When there are N pieces of playitems identified as playitems #-#N, stream registration sequences respectively corresponding to the playitems #-#N are provided in the extension stream selection table. The stream registration sequences corresponding to each playitem are dependent-view stream registration sequence, PG stream registration sequence, and IG stream registration sequence.","The \u201cFixed_offset_during_Popup\u201d is a fixed offset during pop-up, and controls the playback type of the video or PG_text subtitle stream when the pop-up menu is set to \u201con\u201d in the IG stream. The \u201cFixed_offset_during_Popup\u201d field is set to \u201con\u201d when the \u201cuser_interface_model\u201d field in the IG stream is on, namely, when the user interface of the pop-up menu is set to \u201con\u201d. Also, the \u201cFixed_offset_during_Popup\u201d field is set to \u201coff\u201d when the \u201cuser_interface_model\u201d field in the IG stream is off, namely, when the \u201cAlwaysON\u201d user interface is set.","When the fixed offset during pop-up is set to \u201c0\u201d, namely, when the pop-up menu is set to \u201coff\u201d in the user interface of the IG stream, the video stream is in the B-D presentation mode, the stereoscopic PG stream becomes the stereoscopic playback type, and during playback in the 1 plane+offset mode, the PG text subtitle stream is in the 1 plane+offset mode.","When the fixed offset during pop-up is set to \u201c1\u201d, namely, when the pop-up menu is set to \u201con\u201d in the IG stream, the video stream is in the B-B presentation mode. The stereoscopic PG stream is in the 1 plane+offset mode, and the PG stream for \u201c1 plane+offset\u201d is played back as the \u201c1 plane+zero offset\u201d playback type.","In the 1 plane+offset mode, the PG_text subtitle stream becomes \u201c1 plane+zero offset\u201d.",{"@attributes":{"id":"p-0285","num":"0284"},"figref":"FIGS. 10A through 10C"},{"@attributes":{"id":"p-0286","num":"0285"},"figref":"FIG. 10A"},"The stream entry includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which the playback path of the dependent-view video stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the dependent-view video stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the dependent-view video stream in this stream file.","The \u201cstream attribute\u201d includes the language attribute of the dependent-view video stream.","The \u201cthe number of offset sequences (number_of_offset_sequence)\u201d indicates the number of offsets provided in the dependent-view video stream.","The \u201coffset sequence number information\u201d (\u201cnumber_of_offset_sequence\u201d in the drawing) indicates the number of offset sequences in the dependent-view stream.","The value of the \u201coffset sequence number information in the extension stream selection table is identical with the number of offset sequences that is included in the dependent-view stream.","The dependent-view video stream registration sequences shown in FIG. A indicate that a plurality of pieces of stream registration information are provided in correspondence with a plurality of dependent-view video streams. However,  merely illustrates the data structure thereof. In the actuality, since there is only one base-view video stream normally, the number of pieces of stream registration information for the dependent-view video stream is one.",{"@attributes":{"id":"p-0293","num":"0292"},"figref":"FIG. 10B"},"The lead lines in the drawing indicates the close-up of the common internal structure of the PG stream registration sequences.","The \u201cPG_text subtitle offset sequence ID reference information (PGtextST_offset_sequence_id_ref)\u201d is PG_text subtitle stream offset sequence reference information, and indicates an offset sequence with respect to the PG_text subtitle stream in the 1 plane+offset mode.","The offset metadata is supplied by the access unit of the dependent-view video stream. The playback device should apply the offset, which is supplied by this field, to the presentation graphics (PG) plane of the 1 plane+offset mode type.","When the field is an undefined value (FF), the playback device does not apply this offset to the PG stream plane memory.","The \u201cstereoscopic PG presence\/absence flag (is_SS_PG)\u201d indicates the validity and presence of the following in the PG stream: the left-eye IG stream entry; the right-eye IG stream entry; and the stream attributes. When the structure is absent in the stereoscopic PG stream, this field should be set to \u201c0\u201d; and when the structure is present in the stereoscopic PG stream, this field should be set to \u201c1\u201d.","The \u201cleft-eye stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which the playback path of the left-eye PG stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the left-eye PG stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the left-eye PG stream in this stream file.","The \u201cright-eye stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which the playback path of the right-eye PG stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the right-eye PG stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the right-eye PG stream in this stream file. When the stream file referenced by the \u201cstream_entry_for_dependent_view\u201d in the stream registration information in the extension stream selection table is different from the stream file referenced by the stream entry in the basic stream selection table, a stream file storing the right-eye PG stream needs to be read again.","The \u201ccommon stream attribute\u201d includes language attributes of the left-eye PG stream and the right-eye PG stream.","The \u201cstereoscopic PG_text subtitle offset sequence ID reference information (SS_PG_textST_offset_sequence_id_ref)\u201d is reference information for referencing an offset sequence for the PG_text subtitle stream, and indicates the offset sequence for the PG_text subtitle stream. The playback device should apply the offset, which is supplied by this field, to the PG plane.","When the field is an undefined value (FF), the playback device does not apply this offset to the PG stream plane memory.","The \u201cVideo shift mode (video_shift_mode)\u201d is a region-saving flag that defines processing of saving a display region of a subtitle. The region-saving flag indicates whether the display region of the subtitle is to be saved in the upper end or the lower end in the video plane. When the display region of the subtitle is neither saved in the upper end nor the lower end in the video plane, the video shift mode is set to \u201cKeep\u201d. When the video_shift_mode is set to \u201cKeep\u201d, picture data stored in the video plane memory is neither shifted upward nor downward, and the picture data are overlaid with a subtitle stored in the PG stream plane memory, as shown in .","When the subtitle display region of the PG_text subtitle stream is located in the lower end of the video plane, the video shift mode is set to \u201cUp\u201d. When the subtitle display region of the PG_text subtitle stream is located in the upper end of the video plane, the video shift mode is set to \u201cDown\u201d.","When subtitles obtained by decoding a PG stream whose video_shift_mode is set to \u201cUp\u201d are located in the lower end of the screen. Accordingly, as shown in , picture data stored in the video plane memory is shifted upward, and the picture data is overlaid with a subtitle stored in the PG stream plane memory. This can prevent the subtitle from being displayed as if the subtitle dents in stereoscopic images. When subtitles obtained by decoding a PG stream whose video_shift_mode is set to \u201cDown\u201d are located in the upper end of the screen. Accordingly, as shown in , picture data stored in the video plane memory is shifted downward, and the picture data are overlaid with subtitles stored in the PG stream plane memory. This can prevent the subtitles from being displayed as if the subtitles dent in stereoscopic images.",{"@attributes":{"id":"p-0307","num":"0306"},"figref":"FIG. 10C"},"The \u201cIG offset sequence ID reference information (IG_offset_sequence_id_ref)\u201d is an interactive graphics offset sequence reference, and is a reference to the sequence ID of the IG stream in the 1 plane+offset mode. This value indicates an offset sequence ID defined for the offset sequence. As described above, the offset metadata is supplied by the dependent-view video stream. The playback device should apply the offset, which is supplied by this field, to the IG stream of the 1 plane+offset mode type.","When the field is an undefined value (FF), the playback device does not apply this offset to the interactive graphics (IG) stream plane.","The \u201cB-B mode offset direction information (IG_Plane_offset_direction_during_BB_video)\u201d is the user interface of the pop-up menu in the B-B presentation mode, and indicates the offset direction in the IG plane in the 1 plane+offset mode while the IG stream is played back.","When this field is set to \u201c0\u201d, it is the front setting. That is to say, the plane memory exists between the television and the viewer, and the plane is shifted rightward during the left-view period, and the plane is shifted leftward during the right-view period.","When this field is set to a value \u201c1\u201d, it is the behind setting. That is to say, the plane memory exists behind the television or the screen, and the left plane is shifted rightward, and the right plane is shifted leftward.","The \u201cB-B mode offset value information (IG_Plane_offset_value_during_BB_video)\u201d indicates, in units of pixels, the offset value of the IG plane in the 1 plane+offset mode while the IG stream is played back by the user interface of the pop-up menu in the B-B presentation mode.","The \u201cstereoscopic IG presence\/absence flag (is_SS_IG)\u201d indicates the validity and presence of the following in the IG stream: the left-eye IG stream entry; the right-eye IG stream entry; and the stream attributes. When the structure is absent in the stereoscopic PG stream, this field should be set to \u201c0\u201d. When the structure is present in the stereoscopic PG stream, this field should be set to \u201c1\u201d.","The \u201cleft-eye stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which the playback path of the left-eye IG stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the left-eye IG stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the left-eye IG stream in this stream file.","The \u201cright-eye stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which the playback path of the right-eye IG stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the right-eye IG stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the right-eye IG stream in this stream file. When the stream file referenced by the \u201cstream_entry_for_dependent_view\u201d in the stream registration information in the extension stream selection table is different from the stream file referenced by the stream entry in the basic stream selection table, a stream file storing the right-eye IG stream needs to be read.","The \u201ccommon stream attribute\u201d includes language attributes of the left-eye IG stream and the right-eye IG stream.","The \u201cstereoscopic IG offset sequence ID reference information\u201d is a reference to the offset sequence ID for the stereoscopic-type IG stream, and indicates the offset sequence for the offset metadata of the dependent-view video stream. The playback device should apply the offset, which is supplied by this field, to the stereoscopic-type IG plane.","When the field is an undefined value (FF), the playback device does not apply this offset to the IG plane.","The PG_text subtitle stream offset sequence reference information and the IG stream offset sequence reference information are written in the stream registration information in correspondence with stream numbers. Therefore, when the stream selection procedure is executed due to a change of the device state or occurrence of a request for stream change and a stream number corresponding to the language setting on the device side is set in the stream number register, an offset sequence indicated by a reference corresponding to the new stream number is supplied from the video decoder to the shift unit. With this structure, an optimum offset sequence corresponding to the language setting in the playback device is supplied to the shift unit, thus it is possible to set the depth of the graphics in 1 plane+offset mode to an optimum value corresponding to the language setting in the playback device.","The following describes restrictions for the extension stream selection table.","The stream entry in the stereoscopic dependent-view block should not change in the playlist.","When the type of the stream entry in the stereoscopic dependent-view block is the ES type (stream type=2) that is used by the sub-path, the sub-path ID reference and the subclip entry ID reference (ref_to_subclip_entry_id) do not change in the playlist.","Only two types of elementary streams are permitted to be the types of the stream entry, stream entry for the base view, and stream entry for the dependent view. The two types are: ES (stream type=1) in the AV clip used by the playitem; and ES (stream type=2) in the AV clip used by the sub-path.","In the stereoscopic dependent-view block, the stream encoding method in the stream attribute is set to \u201c0x20\u201d.",{"@attributes":{"id":"p-0326","num":"0325"},"figref":"FIG. 14"},"The middle part of  shows the demultiplexing unit. The upper part of  shows the combination of the basic stream selection table and the extension stream selection table. The left side of  shows the main TS and the sub-TSs, and the right side of  shows the demultiplexed base-view video stream, dependent-view video stream, left-eye PG stream, right-eye PG stream, left-eye IG stream, right-eye IG stream, and primary audio stream.",{"@attributes":{"id":"p-0328","num":"0327"},"figref":"FIG. 15"},"The vertical column on the left side of  shows the following stream numbers: primary video stream #; primary audio streams # and #; PG_text subtitle streams #, # and #; and IG streams # and #.","The element streams arranged on the left side of , enclosed by a dotted line, are element streams that are targeted for demultiplexing only in the 2D output mode, and that are permitted by the stream selection table (STN_table) to be played back.","The element streams arranged on the right side of , enclosed by a dotted line, are element streams that are targeted for demultiplexing only in the 3D output mode, and that are permitted by the extension stream selection table (STN_table_SS) to be played back.","The element streams enclosed by the combined dotted lines of the left side and the right side are element streams that are targeted for demultiplexing in the 3D output modes.","With regard to the video stream #, the MPEG4-MVC base-view video stream is enclosed by the combined dotted lines of the left side and the right side. This indicates that the MPEG4-MVC base-view video stream is targeted to be played back in both the 2D and the 3D output modes. On the other hand, the MPEG4-MVC dependent-view video stream is enclosed by only the dotted line of the right side. This indicates that the MPEG4-MVC dependent-view video stream is to be played back only in the 3D output mode.","With regard to the primary audio streams # and #, they are both enclosed by the combined dotted lines of the left side and the right side. This indicates that the audio streams # and # are targeted to be played back in both the 2D and the 3D output modes.","With regard to the PG_text subtitle streams, the PG_text subtitle streams # and # are 2D PG streams, and are enclosed by the combined dotted lines of the left side and the right side, indicating that they are targeted to be played back in both the 2D and the 3D output modes. On the other hand, the left-eye PG stream and the right-eye PG stream are enclosed by only the dotted line of the right side. This indicates that the left-eye PG stream and the right-eye PG stream are to be played back only in the 3D output mode.","With regard to the IG streams, the IG streams # and # are 2D IG streams, and are enclosed by the combined dotted lines of the left side and the right side. This indicates that IG streams # and # are targeted to be played back only in the 2D output mode. On the other hand, the left-eye IG stream and the right-eye IG stream are enclosed by only the dotted line of the right side. This indicates that the left-eye IG stream and the right-eye IG stream are to be played back in the 2D output mode and the 3D output mode.","As understood from the above description, in the 3D output mode, the dependent-view video stream is added to the target for playback regarding the stream type \u201cvideo stream\u201d.","It is also understood that, in the 3D output mode, the left-eye PG stream and the right-eye PG stream are added to the target for playback regarding the stream type \u201cPG stream\u201d, and the left-eye IG stream and the right-eye IG stream are added to the target for playback regarding the stream type \u201cIG stream\u201d. The reason for adding the left-eye PG stream and the right-eye PG stream to the target for playback is that the left-eye PG stream and the right-eye PG stream are used to realize the stereoscopic playback in the 3D output mode. The reason for adding the left-eye IG stream and the right-eye IG stream to the target for playback is that the left-eye IG stream and the right-eye IG stream are used to realize the stereoscopic playback in the 3D output mode.","This completes the description of the recording medium. In the following, the playback device will be described in detail.",{"@attributes":{"id":"p-0340","num":"0339"},"figref":["FIG. 16","FIG. 16","FIG. 16"],"b":["201","202","203","204","205","206","207","208","209","210"]},"The reading unit  reads out, from the recording medium, the index table, program file, playlist information file, stream information file, and stream file. When reading the stereoscopic interleaved stream file, the reading unit  performs a process in which it divides the stereoscopic interleaved stream file into (i) an ATC sequence  corresponding to the main TS and (ii) an ATC sequence  corresponding to the sub-TS, by using (a) the extent start point information of the clip base information in the 3D clip information file and (b) the extent start point information in the clip dependent information, and stores the ATC sequences  and  into different read buffers. This division is realized by repeating two processes: the first process of extracting, from the stereoscopic interleaved stream file, as many source packets as the number of packets corresponding to the source packet number indicated by the extent start point information in the clip dependent information, and adding the extracted source packets into the ATC sequence ; and the second process of extracting, from the stereoscopic interleaved stream file, as many source packets as the number of packets corresponding to the source packet number indicated by the extent start point information in the clip base information, and adding the extracted source packets into the ATC sequence .","The memory  stores a combined stream registration sequence that is obtained by combining the extension stream selection table and the basic stream selection table included in the playlist information.","The player number register  includes a plurality of registers that are required for the playback device to operate.","The decoder  is composed of a video decoder , a PG decoder , an IG decoder , and an audio decoder which correspond to respective stream types.","The demultiplexing unit  is provided with: a source depacketizer for converting the source packets into TS packets; and a PID filter for performing the packet filtering. The demultiplexing unit  converts source packets having packet identifiers written in stream entries of the basic stream selection table in the 3D playlist information into TS packets, and outputs the TS packets to the decoder. Also, the demultiplexing unit  converts source packets having packet identifiers written in stream entries of the stereoscopic stream selection table in the 3D playlist information into TS packets, and outputs the TS packets to the decoder. Which packet identifiers, among a plurality of packet identifiers written in a plurality of stream entries of the basic and stereoscopic stream selection tables, are to be used is determined in accordance with the setting in the stream number register among the player status registers. The stream number register is a register for storing the current stream number.","The plane memory set  is composed of a plurality of plane memories.","These plane memories constitute a layer model, and the data stored in each plane memory are used to overlay the layers with each other. The plane memory set includes a left-eye plane memory and a right-eye plane memory. Respective non-compressed picture data obtained by decoding the base-view and dependent-view components of each access unit are written into the left-eye and right-eye plane memories. The plane memory set includes a left-eye plane memory and a right-eye plane memory. Respective non-compressed picture data obtained by decoding the base-view and dependent-view components of each access unit are written into the left-eye and right-eye plane memories. The writing is performed each time the playback start time indicated by the presentation time stamp of each access unit is reached.","To which of the left-eye plane memory and the right-eye plane memory the picture data after decoding is to be written is determined in accordance with the base-view indicator in the playlist information. When the base-view indicator specifies the base-view video stream as \u201cfor the left eye\u201d, the picture data of the base-view video stream is written to the left-eye plane memory, and the picture data of the dependent-view video stream is written to the right-eye plane memory.","When the base-view indicator specifies the base-view video stream as \u201cfor the right eye\u201d, the picture data of the base-view video stream is written to the right-eye plane memory, and the picture data of the dependent-view video stream is written to the left-eye plane memory. These view components are output to the display device in sequence. More specifically, in one frame period, the picture data stored in the left-eye plane memory and the picture data stored in the right-eye plane memory are output simultaneously.","The shift unit  shifts the pixel coordinates.","The layer overlay unit  overlays the layers in the plurality of plane memories.","The transmission\/reception unit  transits to a data transfer phase via a mutual authentication phase and a negotiation phase, when playback device is connected with another device in the home theater system via an interface. The transmission\/reception unit  performs data transfer in the transfer phase.","In the negotiation phase, the capabilities of the partner device (including the decode capability, playback capability, and display frequency) are grasped, and the capabilities are set in the player setting register, so that the transfer method for the succeeding data transfers is determined. The negotiation phase includes a mutual authentication phase in which each of the devices confirms the authenticity of the other device. After the negotiation phase, one line of the pixel data in the non-compression\/plaintext format in the picture data after the layer overlaying is transferred to the display device at a high transfer rate in accordance with the horizontal sync period of the display device. On the other hand, in the horizontal and vertical blanking intervals, audio data in the non-compression\/plaintext format is transferred to other devices (including an amplifier and a speaker as well as the display device) connected with the playback device. With this structure, the devices such as the display device, amplifier and speaker can receive the picture data and audio data both in the non-compression\/plaintext format, and a reproduced output is achieved. Further, when the partner device has the decode capability, a pass-through transfer of the video and audio streams is possible. In the pass-through transfer, it is possible to transfer the video stream and audio stream in the compressed\/encrypted format, as they are.","The playback control unit  executes a random access from an arbitrary time point on the time axis of the video stream. More specifically, when it is instructed to play back from an arbitrary time point on the time axis of the video stream, the playback control unit  searches for a source packet number of an access unit corresponding to the arbitrary time point, by using a base entry map in the 3D stream information file and an extension entry map. The access unit includes a pair of a view component of the base-view video stream and a view component of the dependent-view video stream, and this searching identifies a source packet number of a source packet storing an access unit delimiter for the access unit. Reading from the source packet number and decoding enable a random access to be performed. When a 3D playlist is to be played back, random accesses to the main TS and the sub-TS are executed by using the in-time and the out-time defined in the main-path information and the in-time and the out-time defined in the sub-path information of the 3D playlist information, to start the playback of the playlist.","The video decoder  is a representative decoder among the decoders constituting the decoder set . The video decoder  preloads view components that constitute the dependent-view video stream, and decodes view components of a picture type for which the Instantaneous Decoder Refresh (IDR) at the start of the closed GOP in the base-view video stream is intended (IDR type). In this decoding, all the coded data buffers and decode data buffers are cleared. After decoding the view components of the IDR type in this way, (i) view components following the base-view video stream compress-encoded based on the correlation with these view components and (ii) view components of the dependent-view video stream, are decoded. Non-compressed picture data is obtained by this decoding of the view components. The obtained non-compressed picture data is stored in the decode data buffer to be used as the reference picture.","By using the reference picture, the motion compensation is performed onto (i) view components following the base-view video stream and (ii) view components of the dependent-view video stream. Non-compressed picture data with regard to (i) view components following the base-view video stream and non-compressed picture data with regard to (ii) view components of the dependent-view video stream are obtained by the motion compensation. The obtained non-compressed picture data are stored in the decode data buffer to be used as reference pictures. The above-described decoding is performed each time the decode start time indicated in the decode time stamp of each access unit is reached.","The following describes the PG decoder , text subtitle decoder , and IG decoder , and the internal structures of the streams that are to be decoded by these decoders.","For the PG stream: the decoder structure is \u201c1 decoder+1 plane\u201d when the \u201c1 plane+offset\u201d method is adopted; and the decoder structure is \u201c2 decoders+2 planes\u201d when the 3D-LR method is adopted.","Similarly, for the IG stream: the decoder structure is \u201c1 decoder+1 plane\u201d when the \u201c1 plane+offset\u201d method is adopted; and the decoder structure is \u201c2 decoders+2 planes\u201d when the 3D-LR method is adopted.","For the text subtitle stream for which the 3D-LR method cannot be adopted: the decoder structure is \u201c1 decoder+1 plane\u201d when the \u201c1 plane+offset\u201d method is adopted.","First, the internal structure of the PG stream, and the internal structure of the PG decoder for decoding the PG stream will be described.","Each of the left-eye PG stream and the right-eye PG stream includes a plurality of display sets. The display set is a set of functional segments that constitute one screen display. The functional segments are processing units that are supplied to the decoder while they are stored in the payloads of the PES packets which each have the size of approximately 2 KB, and are subjected to the playback control with use of the DTSs and PTSs.","The display set falls into the following types.","A. Epoch-start Display Set","The epoch-start display set is a set of functional segments that start the memory management by resetting the composition buffer, code data buffer, and graphics plane in the graphics decoder. The epoch-start display set includes all functional segments required for composition of the screen.","B. Normal-case Display Set","The normal-case display set is a display set that performs the composition of the screen while continuing the memory management of the composition buffer, code data buffer, and graphics plane in the graphics decoder. The normal-case display set includes functional segments that are differentials from the preceding display set.","C. Acquisition-point Display Set","The acquisition-point display set is a display set that includes all functional segments required for composition of the screen, but does not reset the memory management of the composition buffer, code data buffer, and graphics plane in the graphics decoder. The acquisition-point display set may include functional segments that are different from those in the previous display set.","D. Epoch-continue Display Set","The epoch-continue display set is a display set that continues the memory management of the composition buffer, code data buffer, and graphics plane in the playback device as it is when the connection between a playitem permitting the playback of the PG stream and a playitem immediately before the playitem is the \u201cseamless connection\u201d (CC=5) that evolves a clean break. In this case, the graphics objects obtained in the object buffer and the graphics plane are kept to be present in the object buffer and the graphics plane, without being discarded.","Certain time points on the playback time axis of the STC sequence are assigned to the start point and end point of these display sets, and the same times are assigned to the left-eye view and to the right-eye view. Also, for the left-eye PG stream and the right-eye PG stream, the types of the display sets that are present on the same time point on the time axis are the same. That is to say, when the display set on the left-eye side is the epoch-start display set, the display set on the right-eye side that is at the same time point on the time axis of the STC sequence is the epoch-start display set.","Further, when the display set on the left-eye side is the acquisition-point display set, the display set on the right-eye side that is at the same time point on the time axis of the STC sequence is the acquisition-point display set.","Each display set includes a plurality of functional segments. The plurality of functional segments include the following.","(1) Object Definition Segment","The object definition segment is a functional segment for defining the graphics object. The graphics definition segment defines the graphics object by using a code value and a run length of the code value.","(2) Pallet Definition Segment","The pallet definition segment includes pallet data that indicates correspondence among each code value, brightness, and red color difference\/blue color difference. The same correspondence among the code value, brightness, and color difference is set in both the pallet definition segment of the left-eye graphics stream and the pallet definition segment of the right-eye graphics stream.","(3) Window Definition Segment","The window definition segment is a functional segment for defining a rectangular frame called \u201cwindow\u201d in the plane memory that is used to extend the non-compressed graphics object onto the screen. The drawing of the graphics object is restricted to the inside of the plane memory, and the drawing of the graphics object is not performed outside the window.","Since a part of the plane memory is specified as the window for displaying the graphics, the playback device does not need to perform the drawing of the graphics for the entire plane. That is to say, the playback device only needs to perform the graphics drawing onto the window that has a limited size. The drawing of the part of the plane for display other than the window can be omitted. This reduces the load of the software on the playback device side.","(4) Screen Composition Segment","The screen composition segment is a functional segment for defining the screen composition using the graphics object, and includes a plurality of control items for the composition controller in the graphics decoder. The screen composition segment is a functional segment that defines in detail the display set of the graphics stream, and defines the screen composition using the graphics object. The screen composition falls into the types such as Cut-In\/-Out, Fade-In\/-Out, Color Change, Scroll, and Wipe-In\/-Out. With use of the screen composition defined by the screen composition segment, it is possible to realize display effects such as deleting a subtitle gradually, while displaying the next subtitle.","(5) End Segment","The end segment is a functional segment that is located at the end of a plurality of functional segments belonging to one display set. The playback device recognizes a series of segments from the screen composition segment to the end segment as the functional segments that constitute one display set.","In the PG stream, the start time point of the display set is identified by the DTS of the PES packet storing the screen composition segment, and the end time point of the display set is identified by the PTS of the PES packet storing the screen composition segment.","The left-eye graphics stream and the right-eye graphics stream are packetized elementary streams (PES). The screen composition segment is stored in the PES packet. The PTS of the PES packet storing the screen composition segment indicates the time when the display by the display set to which the screen composition segment belongs should be executed.","The value of the PTS of the PES packet storing the screen composition segment is the same for both the left-eye video stream and the right-eye video stream.","(Decoder Models of PG Decoder)","The PG decoder includes: a \u201ccoded data buffer\u201d for storing functional segments read from the PG stream; a \u201cstream graphics processor\u201d for obtaining a graphics object by decoding the screen composition segment; an \u201cobject buffer\u201d for storing the graphics object obtained by the decoding; a \u201ccomposition buffer\u201d for storing the screen composition segment; and a \u201ccomposition controller\u201d for decoding the screen composition segment stored in the composition buffer, and performing a screen composition on the graphics plane by using the graphics object stored in the object buffer, based on the control items included in the screen composition segment.","A \u201ctransport buffer\u201d for adjusting the input speed of the TS packets constituting the functional segments is provided at a location before the graphics plane.","Also, at locations subsequent to the graphics decoder, a \u201cgraphics plane\u201d, a \u201cCLUT unit\u201d for converting the pixel codes constituting the graphics object stored in the graphics plane into values of brightness\/color difference based on the pallet definition segment, and a \u201cshift unit\u201d for the plane shift are provided.","The pipeline in the PG stream makes it possible to simultaneously executes the following processes: the process in which the graphics decoder decodes an object definition segment belonging to a certain display set and writes the graphics object into the graphics buffer; and the process in which a graphics object obtained by decoding an object definition segment belonging to a preceding display set is written from the object buffer to the plane memory.",{"@attributes":{"id":"p-0394","num":"0393"},"figref":["FIGS. 17A and 17B","FIG. 17A","FIG. 17B"]},"In , the PG decoder itself is represented by a frame drawn by the solid line, and a portion that follows the graphics decoder is represented by a frame drawn by the chain line.",{"@attributes":{"id":"p-0396","num":"0395"},"figref":"FIG. 17A"},{"@attributes":{"id":"p-0397","num":"0396"},"figref":"FIG. 17B"},"The offset sequence is contained in the right-eye video stream. Thus, in the plane offset format, the PG decoder has \u201c1 decoder\u201d structure, and the output from the PG decoder is supplied to the left-eye view and the right-eye view by switching therebetween.","The PG decoder performs the following to switch between 2D and 3D.","1. The mutual switching between the 1 plane+offset mode and the 2D mode is performed seamlessly. This is realized by invalidating the \u201cOffset\u201d.","2. When switching between the 3D-LR mode and the 2D mode is performed, the display of the subtitle temporarily disappears because the switching between the modes requires switching between PIDs. This is the same as the switching between streams.","This completes the explanation of the PG decoder. In the following, the text subtitle decoder will be described in detail.","(Decoder Models of Text Subtitle Decoder)","The text subtitle decoder is composed of a plurality of pieces of subtitle description data.","The text subtitle decoder includes: a \u201csubtitle processor\u201d for separating the text code and the control information from the subtitle description data; a \u201cmanagement information buffer\u201d for storing the text code separated from the subtitle description data; a \u201ctext render\u201d for extending the text code in the management information buffer to the bit map by using the font data; an \u201cobject buffer\u201d for storing the bit map obtained by the extension; and a \u201cdrawing control unit\u201d for controlling the text subtitle playback along the time axis by using the control information separated from the subtitle description data.","The text subtitle decoder is preceded by: a \u201cfont preload buffer\u201d for preloading the font data; a \u201cTS buffer\u201d for adjusting the input speed of the TS packets constituting the text subtitle stream; and a \u201csubtitle preload buffer\u201d for preloading the text subtitle stream before the playback of the playitem.","The graphics decoder is followed by a \u201cgraphics plane\u201d; a \u201cCLUT unit\u201d for converting the pixel codes constituting the graphics object stored in the graphics plane into values of brightness and color difference based on the pallet definition segment; and a \u201cshift unit\u201d for the plane shift.",{"@attributes":{"id":"p-0408","num":"0407"},"figref":["FIGS. 18A and 18B","FIG. 18A","FIG. 18B","FIGS. 18A and 18B"]},{"@attributes":{"id":"p-0409","num":"0408"},"figref":"FIG. 18A"},{"@attributes":{"id":"p-0410","num":"0409"},"figref":"FIG. 18B"},"The text subtitle stream differs from the PG stream as follows. That is to say, the font data and the character code are sent, not the graphics data is sent as the bit map, so that the rendering engine generates the subtitle. Thus the stereoscopic viewing of the subtitle is realized in the 1 plane+offset mode.","This completes the description of the text subtitle stream and the text subtitle decoder. Next, the internal structure of the IG stream and the structure of the IG decoder will be described.","(IG stream)","Each of the left-eye IG stream and the right-eye IG stream includes a plurality of display sets. Each display set includes a plurality of functional segments. As is the case with the PG stream, the display set falls into the following types. epoch-start display set, normal-case display set, acquisition-point display set, and epoch-continue display set.","The plurality of functional segments belonging to these display sets include the following types.","(1) Object Definition Segment","The object definition segment of the IG stream is the same as that of the PG stream. However, the graphics object of the IG stream defines the in-effect and out-effect of pages, the normal, selected, and active states of the button members. The object definition segments are grouped into those that define the same state of the button members, and those that constitute the same effect image. The group of object definition segments defining the same state is called a \u201cgraphics data set\u201d.","(2) Pallet Definition Segment","The pallet definition segment of the IG stream is the same as that of the PG stream.","(3) Interactive Control Segment","The interactive control segment includes a plurality of pieces of page information. The page information is information that defines a screen composition of the multi-page menu. Each piece of page information includes an effect sequence, a plurality of pieces of button information, and a reference value of a pallet identifier.","The button information is information that realizes an interactive screen composition on each page constituting the multi-page menu by displaying the graphics object as one state of a button member.","The effect sequence constitutes the in-effect or the out-effect with use of the graphics object, and includes effect information, where the in-effect is played back before a page corresponding to the page information is displayed, and the out-effect is played back after the page is displayed.","The effect information is information that defines each screen composition for playing back the in-effect or the out-effect. The effect information includes: a screen composition object that defines a screen composition to be executed in the window (partial region) defined by the window definition segment on the graphics plane; and effect period information that indicates a time interval between the current screen and the next screen in the same region.","The screen composition object in the effect sequence defines a control that is similar to the control defined by the screen composition segment of the PG stream. Among the plurality of object definition segments, an object definition segment that defines the graphics object used for the in-effect is disposed at a location that precedes an object definition segment that defines the graphics object used for the button member.","Each piece of button information in the page information is information that an interactive screen composition on each page constituting the multi-page menu by displaying the graphics object as one state of a button member. The button information includes a set button page command that, when a corresponding button member becomes active, causes the playback device to perform the process of setting a page other than the first page as the current page.","To make it possible for the offset in the plane shift to be changed for each page during playback of the IG stream, a navigation command for changing the offset is incorporated into the button information, and the \u201cauto-activate\u201d of the navigation command is defined in the corresponding piece of button information, in advance. This makes it possible to change automatically the value or direction of the offset defined in the stream registration information of the IG stream.","(4) End Segment","The end segment is a functional segment that is located at the end of a plurality of functional segments belonging to one display set. A series of segments from the interactive control segment to the end segment are recognized as the functional segments that constitute one display set.","The following are the control items of the interactive control segment that are the same for both the left-eye graphics stream and the right-eye graphics stream: button adjacency information; selection time-out time stamp; user time-out duration; and composition time-out information.","1. Button Adjacency Information","The button adjacency information is information that specifies a button to be changed to the selected state when a key operation specifying any of upward, downward, leftward, and rightward is performed while a certain button adjacent to the specified button is in the selected state.","2. Selection Time-out Time Stamp","The selection time-out time stamp indicates a time-out time that is required to automatically activate a button member in the current page and cause the playback device to execute the button member.","3. User Time-out Duration","The user time-out duration indicates a time-out time that is required to return the current page to the first page so that only the first page is displayed.","4. Composition Time-out Information","The composition time-out information indicates a time period that is required to end an interactive screen display by the interactive control segment. With respect to the IG stream, the start time point of a display set is identified by the DTS of the PES packet storing the interactive control segment, and the end time point of the display set is identified by the composition time-out time of the interactive control segment. The same DTS and the same composition time-out time are set for both the left eye and the right eye.","(Decoder Models of IG Decoder)","The IG decoder includes: a \u201ccoded data buffer\u201d for storing functional segments read from the IG stream; a \u201cstream graphics processor\u201d for obtaining a graphics object by decoding the screen composition segment; an \u201cobject buffer\u201d for storing the graphics object obtained by the decoding; a \u201ccomposition buffer\u201d for storing the screen composition segment; and a \u201ccomposition controller\u201d for decoding the screen composition segment stored in the composition buffer, and performing a screen composition on the graphics plane by using the graphics object stored in the object buffer, based on the control items included in the screen composition segment.","A \u201ctransport buffer\u201d for adjusting the input speed of the TS packets constituting the functional segments is provided at a location before the graphics plane.","Also, at locations after the graphics decoder, a \u201cgraphics plane\u201d, a \u201cCLUT unit\u201d for converting the pixel codes constituting the graphics object stored in the graphics plane into values of brightness\/color difference based on the pallet definition segment, and a \u201cshift unit\u201d for the plane shift are provided.",{"@attributes":{"id":"p-0443","num":"0442"},"figref":["FIGS. 19A and 19B","FIGS. 19A and 19B","FIG. 19A","FIG. 19B"]},"These decoders include a circuit for reflecting values of system parameters onto the offsets so that the program can control the depth information of the menu graphics.",{"@attributes":{"id":"p-0445","num":"0444"},"figref":"FIG. 19B"},"The composition controller in the graphics decoder realizes the initial display of the interactive screen by displaying the current button, among a plurality of button members in the interactive screen, by using the graphics data of the graphics data set corresponding to the selected state, and displaying the remaining buttons by using the graphics data set corresponding to the normal state.","When a user operation specifying any of upward, downward, leftward, and rightward is performed, it writes, into the button number register, a number of a button member that is present in the direction specified by the user operation among a plurality of button members in the normal state and adjacent to the current button, the writing causing the button member having become newly the current button to change from the normal state to the selected state.","In the interactive screen, when a user operation for changing the button member from the selected state to the active state is performed, the interactive screen is updated by extracting the graphics data constituting the active state from the graphics data set and displaying the extracted graphics data.","The update of the interactive screen should be executed in common to the left-eye view and the right-eye view. Thus it is preferable that the left-eye graphics decoder and the right-eye graphics decoder have in common a composition controller for the two-decoder model.","In the above-described case, the inter-changing is realized by using the same navigation command for both the left-eye view and the right-eye view of the stereoscopic IG stream, and setting the same button structure for both the 3D graphics object and the 2D graphics object.","When switching between the 2D IG stream and the stereoscopic IG stream, it is possible to change only the displayed graphics object when the attribute and number and the like of the navigation command and button information are the same for both. Switching from the 3D-LR mode to the display of only the L image can be made without reloading, but there is a possibility that the display position may be shifted. It is preferable that the playback device performs the switching based on a flag set to indicate which is adopted by the title producer.","The following are notes on switching between modes.\n\n","This completes the description of the IG stream and the IG decoder. Next, the plane memory will be described in detail.","The following describes the plane memory structure in the 1 plane+offset mode.","The layer overlaying in the plane memory is achieved by executing a superimposing process onto all combinations of the layers in the layer model. In the superimposing process, pixel values of pixel data stored in the plane memories of the two layers are superimposed. The layer overlaying by the layer overlay unit  is achieved by executing a superimposing process onto all combinations of two layers among the layers in the layer model. In the superimposing process, pixel values of pixel data stored in the plane memories of the two layers are superimposed in the layer model of the plane memory.","The superimposing between layers is performed as follows. A transmittance \u03b1 as a weight is multiplied by a pixel value in unit of a line in the plane memory of a certain layer, and a weight of (1\u2212transmittance \u03b1) is multiplied by a pixel value in unit of a line in the plane memory of a layer below the certain layer. The pixel values with these brightness weights are added together. The resultant pixel value is set as a pixel value in unit of a line in the layer. The layer overlaying is realized by repeating this superimposing between layers for each pair of corresponding pixels in a unit of a line in adjacent layers in the layer model.","A multiplication unit for multiplying each pixel value by the transmittance to realize the layer overlaying and an addition unit for adding up the pixelsare provided at locations subsequent to the plane memory, as well as the above-described CLUT unit, shift unit and the like.",{"@attributes":{"id":"p-0458","num":"0459"},"figref":["FIG. 20","FIG. 20","FIG. 20"]},"With the plane memory structure for the 3D-LR method which is provided with two pairs of a layer model and a portion following the plane memory, two pairs of the video plane, PG plane, and IG plane are provided for the left-eye view and the right-eye view, and the outputs from each plane memory are overlaid, as the layer overlaying, separately for the left-eye view and the right-eye view.",{"@attributes":{"id":"p-0460","num":"0461"},"figref":"FIG. 21"},"In , the layer model composed of the left-eye and right-eye video planes, PG plane, and IG plane is encircled by the solid line, and a portion that follows the plane memory is encircled by the chain line. As shown in , there is only one above-described layer model. Also, there are two portions following the plane memory.","In the 1 plane+offset mode: the video plane is provided, one for each of the left-eye view and right-eye view; and each of the PG plane and the IG plane is provided, one for both the left view and the right view. A PG plane and an IG plane each are not separately prepared for each of the left-eye view and the right-eye view. There is only one plane memory for both the left-eye view and the right-eye view. With this structure, the above-described layer overlaying is performed onto the left-eye and right-eye outputs.",{"@attributes":{"id":"p-0463","num":"0464"},"figref":"FIG. 22"},"In the upper end 2D subtitle playback mode method and the lower end 2D subtitle playback mode, a video plane is prepared for each of the left-eye view and the right-eye view. A PG plane and an IG plane each are not separately prepared for each of the left-eye view and the right-eye view. There is only one plane memory for both the left-eye view and the right-eye view. In accordance with the setting of the register (PSR), which is described later, indicating the video shift mode of the playback device, pixel shift of the video plane is performed upward or downward by 131 pixels for each of the left-eye view and the right-eye view. Then, layer overlaying is performed on the left-eye output and the right-eye output.","The playback device needs to support all of the 3D-LR mode, the 1 plane+offset mode, the upper end 2D subtitle playback mode, and the lower end 2D subtitle playback mode. Thus the hardware structure of the playback device is basically \u201c2 decoders+2 planes\u201d. When the mode switches to either of the 1 plane+offset mode, the 2D output mode, the upper end 2D subtitle playback mode, and the lower end 2D subtitle playback mode, the playback device becomes to have the \u201c1 decoder+1 plane\u201d structure, invalidating one of the two pairs of \u201c1 decoder+1 plane\u201d.","It is at the discretion of the manufacturer of the playback device which of 1-decoder structure and 2-decoder structure is adopted as the decoder model and which of 1-plane structure and 2-planes structure is adopted as the plane model. Of course, the playback device may be designed to have the 2-decoder and 2-plane structure, then it may be set to be able to play back the stereoscopic PG and IG as the top-of-the-line product, and may be set not to be able to play back the stereoscopic PG and IG as the lower-cost product. This expands the lineup. Such a configuration having the capability to play back the stereoscopic PG or a configuration having the capability to play back the stereoscopic IG exists in the register set.","The following explains the register set.","The register set is composed of a plurality of player status registers and a plurality of player setting registers. Each of the player status registers and player setting registers is a 32-bit register and is assigned with a register number so that a register to be accessed is identified by the register number.","The bit positions of the bits (32 bits) that constitute each register are represented as \u201cb\u201d through \u201cb\u201d. Among these, bit \u201cb\u201d represents the highest-order bit, and bit \u201cb\u201d represents the lowest-order bit. Among the 32 bits, a bit sequence from bit \u201cbx\u201d to bit \u201cby\u201d is represented by [bx:by].","The value of an arbitrary bit range [bx:by] in a 32-bit sequence stored in the player setting register\/player status register of a certain register number is treated as an environment variable (also called \u201csystem parameter\u201d or \u201cplayer variable\u201d) that is a variable of an operation system in which the program runs. The program that controls the playback can obtain a system parameter via the system property or the application programming interface (API). Also, unless otherwise specified, the program can rewrite the values of the player setting register and the player status register. For the program based on an object-oriented programming language to do this, the program needs to have the authority to obtain or rewrite system parameters.","The player status register is a hardware resource for storing values that are to be used as operands when the MPU of the playback device performs an arithmetic operation or a bit operation. The player status register is also reset to initial values when an optical disc is loaded, and the validity of the stored values is checked. The values that can be stored in the player status register are the current title number, current playlist number, current playitem number, current stream number, current chapter number, and so on. The values stored in the player status register are temporary values because the player status register is reset to initial values each time an optical disc is loaded. The values stored in the player status register become invalid when the optical disc is ejected, or when the playback device is powered off.","The player setting register differs from the player status register in that it is provided with power handling measures. With the power handling measures, the values stored in the player setting register are saved into a non-volatile memory when the playback device is powered off, and the values are restored when the playback device is powered on. The values that can be set in the player setting register include: various configurations of the playback device that are determined by the manufacturer of the playback device when the playback device is shipped; various configurations that are set by the user in accordance with the set-up procedure; and capabilities of a partner device that are detected through negotiation with the partner device when the device is connected with the partner device.",{"@attributes":{"id":"p-0473","num":"0474"},"figref":"FIG. 23","b":"203"},"The left side of  shows the internal structures of the register set , and the right side shows the internal structures of the playback control unit.","The following describes the player status registers and the player setting registers assigned with respective register numbers.","PSR is a stream number register for the IG stream, and stores a current IG stream number.","PSR is a stream number register for the PG stream, and stores a current PG stream number.","PSR is used for the setting of \u201cPlayer Capability for 3D\u201d. This indicates whether or not the playback device has a capability to perform the stereoscopic playback.","On the other hand, the playback control unit includes a stream selection procedure for determining a unique current PG stream number and a unique current IG stream number in the current playlist, by referring to the PSR in the register set  and the stream selection table of the current playlist information in the memory. The stream selection procedure includes \u201cInitialization\u201d and \u201cProcedure when playback condition changed\u201d.",{"@attributes":{"id":"p-0480","num":"0481"},"figref":"FIG. 25","b":["32","32","32"]},{"@attributes":{"id":"p-0481","num":"0482"},"figref":"FIG. 24","b":["24","24","24"]},"The bit \u201cb\u201d in PSR represents the video display capability of stereoscopic 1280\u00d7720 50 p. More specifically, when bit \u201cb\u201d is set to \u201c0\u201d, it indicates that the playback device does not have the processing capability to display the 1280\u00d7720\/50 Hz progressive video; and when bit \u201cb\u201d is set to \u201c1\u201d, it indicates that the playback device has the processing capability to display the 1280\u00d7720\/50 Hz progressive video.","The bit \u201cb\u201d in PSR represents the stereoscopic PG capability. More specifically, when bit \u201cb\u201d is set to \u201c0\u201d, it indicates that the playback device does not have the capability to play back the stereoscopic PG; and when bit \u201cb\u201d is set to \u201c1\u201d, it indicates that the playback device has the capability to play back the stereoscopic PG.","The bit \u201cb\u201d in PSR represents the stereoscopic IG capability. More specifically, when bit \u201cb\u201d is set to \u201c0\u201d, it indicates that the playback device does not have the capability to play back the stereoscopic IG; and when bit \u201cb\u201d is set to \u201c1\u201d, it indicates that the playback device has the capability to play back the stereoscopic IG.","The bit \u201cb\u201d in PSR represents the BD-J capability in the 3D output mode. More specifically, when bit \u201cb\u201d is set to \u201c1\u201d, it indicates that the playback device can process the BD-J mode in the 3D output mode; and when bit \u201cb\u201d is set to \u201c0\u201d, it indicates that the playback device cannot process the BD-J mode in the 3D output mode. The use of the bit \u201cb\u201d in PSR is not related to the subject of the present embodiment, and thus will be described in some subsequent embodiment.","As described above, PSR can be set to indicate whether or not the stereoscopic playback is available for each of the IG and PG This makes it possible to provide: a configuration in which each of the IG and PG decoders is composed of two decoders and the playback device supports the stereoscopic playback for both IG and PG, or a configuration in which each of the IG and PG decoders is composed of two decoders and the playback device supports the stereoscopic playback for only PG and the 1 plane+offset mode for IG, or a converse configuration in which each of the IG and PG decoders is composed of two decoders and the playback device supports the stereoscopic playback for only IG and the 1 plane+offset mode for PG.","Furthermore, to sell the playback device as a lower-cost product, it is possible to provide a configuration in which although each of the IG and PG decoders is composed of two decoders, the playback device supports merely the 1 plane+offset mode for each of IG and PG In this way, while having a common configuration in which each of the IG and PG decoders is composed of two decoders, the present embodiment makes it possible to determine whether to support the stereoscopic playback for each of IG and PG separately, depending on the grade of the product. This expands lineup of products of the playback device that the manufacturer can provide.","Also, when each of or both of the IG and PG decoders is composed of one decoder, it clearly indicates the availability of the stereoscopic playback. Accordingly, even if the playlist can be played back in a stereoscopic mode, it is possible to prevent the playback type from being set to the stereoscopic PG or stereoscopic IG erroneously.","The playback control having been described up to now can be realized by causing a computer to execute a program which is generated by writing the processing procedure represented by the flow charts of  in an object-oriented compiler language.",{"@attributes":{"id":"p-0490","num":"0491"},"figref":"FIG. 26","b":["1","2","6","2","3","4","5","6","2"]},"At this timing, step S is performed to judge whether or not there has been a stream selection request. When it is judged that there has been a stream selection request, the \u201cprocedure when playback condition is changed\u201d is executed, with the requested stream number being regarded as \u201cx\u201d (step S). When it is judged that the current playitem number is the last number (YES in step S), the process ends.","<Determination of Current PG Stream and Playback Type Thereof>","A current PG_text subtitle stream whose stream number is to be stored in PSR is selected based on the output mode (PSR), stereoscopic PG capability in PSR, and \u201cis_SS_PG\u201d.",{"@attributes":{"id":"p-0494","num":"0495"},"figref":"FIG. 27","b":["11","22","23","28"]},"In step S, the current PG_text subtitle stream number is obtained from PSR. In step S, it is judged whether the current PG_text subtitle stream number is of PG (YES) or of text subtitle stream number (NO). In step S, it is checked whether or not the PG stream corresponding to the current PG_text subtitle stream number satisfies conditions (A) and (B).","Here, the conditions (A) and (B) are defined as follows.","Condition (A): The playback device has a capability to decode a PG stream that is identified by the current PG_text subtitle stream number.","Condition (B): The playback device has a capability to play back the specified language.","On the other hand, in step S, it is checked whether or not the text subtitle stream corresponding to the current PG_text subtitle stream number satisfies conditions (A) and (B).","Condition (A): The playback device has a capability to extend the character code of the text subtitle stream, which is identified by the current PG_text subtitle stream number, into a bit map. This playback capability is indicated in PSR in the PSR set .","Condition (B): the playback device has a capability to support characteristics of the language of the text subtitle stream identified by the current PG_text subtitle stream number.","It should be noted here that, for a playback device to \u201cbe able to decode\u201d a text subtitle stream which represents the subtitle of a language, the playback device should have the capability to extend the text subtitle stream of the language into the bit map, and the capability to support characteristic of the language.","Here, this will be considered by taking examples of English, Japanese, and Arabic. As for subtitle displays in English, the language characteristics of English are judged to be supported only when the functions of \u201chorizontal writing\u201d, \u201ckerning\u201d, \u201cdouble letter\/logotype\u201d are all supported.","As for subtitle displays in Japanese, the language characteristics of Japanese are judged to be supported only when the functions of \u201chorizontal writing\u201d \u201cvertical writing\u201d \u201cprohibit line breaks after certain characters\u201d, \u201ccharacters in smaller size\u201d are all supported.","As for subtitle displays in Arabic, the language characteristics of Arabic are judged to be supported only when the functions of \u201crendering from the right to the left\u201d and \u201cdouble letter\/logotype\u201d are all supported.","When the playback device has the capability to extend the text subtitle stream of a language into the bit map and has the capability to support characteristics of the language, it can be said that the above-described conditions (A) and (B) are satisfied. When the playback device has the capability to extend the text subtitle stream of a language into the bit map, but not the capability to support characteristic of the language, it can be said that the condition (B) is not satisfied, but only the condition (A) is satisfied.","The capability to support characteristics of language is set for each language in bits constituting PSR through PSR in the register set. More specifically, PSR through PSR have flags that correspond to respective 3-byte language codes defined in ISO 639-2\/T. Each of the flags is set to indicate whether or not the playback device has a capability to display a text subtitle of a language code that corresponds to the flag.","Among the 3-byte language codes defined in ISO 639-2\/T, a 3-byte language code called \u201cita\u201d indicates Italian, and a 3-byte language code called \u201cjpn\u201d indicates Japanese. Also, a 3-byte language code called \u201cjay\u201d indicates Japanese. Approximately 430 languages are covered by the 3-byte language codes defined in ISO 639-2\/T. The flags in PSR through PSR are referred to when, to determine the current PG_text subtitle stream, it is judged whether or not the text subtitle stream written in the stream number table can be decoded. With this structure, it is possible to perform appropriately the judgment on whether a text subtitle stream can be decoded, even if the text subtitle stream is of a minor language.","After the above-described judgments, the control proceeds to step S in which it is judged whether or not the playback device satisfies a condition (Z).","Here, the condition (Z) is that the user is intending to play back a subtitle of an unsupported language, wherein the \u201cunsupported language\u201d is a language whose characteristics are not supported. The intention is indicated in PSR in the register set.","The control then proceeds to step S in which it is judged whether or not the number of PG_text subtitle streams in the stream selection table of the current playitem is \u201c0\u201d. When the stream selection table indicates that no PG_text subtitle stream has been permitted to be played back, the PG_text subtitle stream number stored in PSR is maintained (step S).","When the stream selection table indicates at least one PG_text subtitle stream that is permitted to be played back, the control proceeds to step S to check for the validity of the current PG_text subtitle stream. In step S, it is judged whether or not the current PG_text subtitle stream number is equal to or greater than the total number of stream entries in the stream selection table and conditions (A) and (B) are satisfied.","When the result of judgment in step S is negative, the control proceeds to step S in which it is judged whether or not the current PG_text subtitle stream number is equal to or greater than the total number of stream entries in the stream selection table and conditions (A) and (Z) are satisfied. When the result of judgment in step S is affirmative, the value in PSR is maintained since it is determined that, although a PG_text subtitle stream number of a text subtitle of an unsupported language is set in PSR, the user is intending to play back a subtitle of the unsupported language (step S). When the result of judgment in step S is negative, an optimum stream for the current playitem is selected (step S).","The steps S through S following this are unique to the 3D output mode. Specifically, in the 3D output mode, determination processing of upper or lower end playback type is firstly performed (step S). In the determination processing of upper or lower end playback type, when the playback type is neither set as the upper end 2D subtitle playback type nor the lower end 2D subtitle playback type (step S: No), is_SS_PG of a PG stream identified by a PG stream number of a PSR is acquired from stream registration information included in the stream selection table (step ). Then, judgment is performed on whether a flag of the acquired is_SS_PG indicates \u201c1\u201d and whether stereoscopic PG capability of b in PSR indicates \u201c1\u201d (step ). If a result of the judgment in step S is Yes, the playback type is set as the stereoscopic PG in which a left-eye PG stream and a right-eye PG stream (step S).","When the playback type is set as the stereoscopic PG, the stereoscopic playback is performed by using packet identifier references that are included in the left-eye and right-eye stream entries of a piece of stream registration information corresponding to the current stream number stored in PSR, among a plurality of pieces of stream registration information in the extension stream selection table. More specifically, the demultiplexing unit is caused to demultiplex TS packets whose packet identifiers are indicated by the packet identifier references that are included in the left-eye and right-eye stream entries of a piece of stream registration information corresponding to the current stream number stored in PSR.","When the judgment result in step S is NO, the playback type is set as \u201c1 plane+offsetPG\u201d (step S). When the playback type is set as \u201c1 plane+offsetPG\u201d, the PG playback in the 1 plane+offset mode is executed by using an offset sequence indicated by the PG_text subtitle stream offset sequence ID reference information in a piece of stream registration information corresponding to the current stream number stored in PSR, among a plurality of pieces of stream registration information in the extension stream selection table.","Here the offset sequence is explained. A plurality of offset sequences to be used in the 1 plane+offset mode exist in the video access unit of the dependent-view video stream.","The video access unit of the dependent-view video stream is structured as a sequence of a video access unit delimiter, a sequence parameter set, a picture parameter set, an MVC scalable nesting SEI message, a first view component, a sequence end code, and a stream end code. The MVC scalable nesting SEI message includes a user data container. The user data container is unregistered user data, and falls into three types: closed caption information; GOP structure map; and offset metadata. One of these types is indicated by the \u201ctype indicator\u201d in the user data container.","The offset metadata is a sequence list for the PG plane, IG plane, and BD-J plane, and is used for the offset setting while the presentation graphics, text subtitle, and IG\/BD-J plane are played back in the 1 plane+offset mode. More specifically, the offset metadata indicates the offset control on the PG plane, IG plane, and BD-J plane when the graphics to be overlaid with the picture data is played back in the 1 plane+offset mode.","The offset metadata should be stored in the MVC scalable nesting SEI message in the starting video component of each GOP in the encoding order of the dependent-view access unit. The offset metadata contains the above-described plurality of offset sequences. The offset sequence is a parameter sequence that indicates control parameters for each frame period in a group of pictures, where the control parameters are used when the graphics are overlaid with each piece of picture data belonging to the group of pictures. The offset sequence is composed of as many control parameters as the number indicated by the \u201cnumber_of_displayed_frames_in_GOP\u201d. The control parameter is composed of plane offset direction information and a plane offset value.","The plane offset direction information (\u201cPlane_offset_direction\u201d) indicates the direction of offset in the plane. When the plane offset direction information is set to a value \u201c0\u201d, it indicates the front setting in which the plane memory exists between the TV and the viewer, and in the left-view period, the plane is shifted rightward, and in the right-view period, the plane is shifted leftward. When the plane offset direction information is set to a value \u201c1\u201d, it indicates the behind setting in which the plane memory exists behind the TV or the screen, and in the left-view period, the plane is shifted leftward, and in the right-view period, the plane is shifted rightward. When the plane offset direction information indicates the front setting, the Z-axis coordinate of the control parameter in the three-dimensional coordinate system is a positive coordinate. When the plane offset direction information indicates the behind setting, the Z-axis coordinate of the control parameter in the three-dimensional coordinate system is a negative coordinate.","The plane offset value (\u201cplane_offset_value\u201d) indicates the amount of deviation in the horizontal direction, of the pixels constituting the graphics, and indicates the offset value of the plane in units of pixels.","When the playback type of PG is set as \u201c1 plane+offsetPG\u201d, an offset sequence is extracted from the video decoder and the extracted offset sequence is supplied to the shift unit, wherein the offset sequence to be extracted is indicated by the PG_text subtitle stream offset sequence ID reference information in a piece of stream registration information corresponding to the current stream number, among a plurality of pieces of stream registration information stored in the SEI message of the dependent-view video stream.","This completes the explanation of the \u201cprocedure when playback condition is changed\u201d for the PG_text subtitle stream.",{"@attributes":{"id":"p-0525","num":"0526"},"figref":"FIG. 28"},"In the determination processing of upper and lower edges playback type, video_shift_mode of a PG stream identified by a PG stream number in the PSR is acquired from stream registration information included in the extension stream selection table (step S). It is judged on whether the acquired video_shift_mode indicates \u201cDown\u201d and the video shift mode of the playback device in the PSR  indicates \u201cDown\u201d (step S).","When a result of judgment in step S is YES, the playback type is set as the upper end 2D subtitle playback type (step S). In this case, PG is played back in the upper end 2D subtitle playback mode. Specifically, the demultiplexing unit performs demultiplexing on a TS packet having a packet identifier indicated by a packet identifier reference included in a stream entry corresponding to a stream number of a current stream stored in the PSR. Also, the shift unit shifts picture data, which is stored in each of the right-eye video plane and the left-eye video plane, downward by 131 pixels.","When a result of the judgment in step S is No, it is judged on whether the video_shift_mode acquired in step S indicates \u201cUp\u201d and the video shift mode of the playback device in the PSR indicates \u201cUp\u201d (step S). When a result of judgment in step S is YES, the playback type is set as the lower end 2D subtitle playback type (step S). In this case, PG is played back in the lower end 2D subtitle playback mode. In the lower end 2D subtitle playback mode, the shift unit shifts picture data, which is stored in each of the right-eye video plane and the left-eye video plane, upward by 131 pixels.","This completes the description of the determination processing of upper or lower end playback type.",{"@attributes":{"id":"p-0530","num":"0531"},"figref":"FIG. 29"},"In step S, it is checked for all PG_text subtitle streams whether the following conditions (a), (b), and (c) are satisfied.","The conditions (a), (b), and (c) are defined as follows when the check-target PG stream is a PG stream i.","Condition (a): the playback device has the capability to decode the PG stream i.","Condition (b): PG_language_code of the PG stream i matches the language setting in the playback device. Here, the language setting in the playback device is indicated by PSR in the register set.","The conditions (a), (b), and (c) are defined as follows when the check-target text subtitle stream is a text subtitle stream i.","Condition (a): the playback device has the capability to extend the character code of the text subtitle stream i into a bit map.","Condition (b): the playback device has the capability to support the language attribute of the text subtitle stream i.","Condition (c): the \u201ctextST_language_code\u201d of the text subtitle stream i matches the language setting in the playback device.","After the checking, it is judged in step S whether or not the playback device satisfies the condition (Z) described in the previous flow chart (playback of unsupported language). When the playback device does not satisfy the condition (Z), the control goes to step S in which it is judged whether or not there is a PG_text subtitle stream that satisfies the conditions (a), (b), and (c). When there are PG_text subtitle streams that satisfy the conditions (a), (b), and (c), a PG_text subtitle stream whose corresponding stream entry is placed first in the stream selection table is selected from among the PG_text subtitle streams that satisfy the conditions (a) through (c), and the PG_text subtitle stream number of the selected PG_text subtitle stream is set in PSR (step S).","When there is no PG_text subtitle stream that satisfies the conditions (a), (b), and (c), the control goes to step S in which it is judged whether or not there is a PG_text subtitle stream that satisfies less conditions. Here the less conditions in this context mean the conditions (a) and (b). Namely, in step S, it is judged whether or not there is a PG_text subtitle stream that satisfies the conditions (a) and (b). When there are PG_text subtitle streams that satisfy the conditions (a) and (b), a PG_text subtitle stream whose corresponding stream entry is placed first in the Stream selection table is selected among the PG_text subtitle streams that satisfy conditions (a) and (b), and the PG_text subtitle stream number of the selected PG_text subtitle stream is set in PSR (step S).","When there is no PG_text subtitle stream that satisfies the conditions (a) and (b), a value 0xFFF as a PG_text subtitle stream number is set in PSR (step S). When it is judged in step S that the playback device satisfies the condition (Z), the control goes to step S in which it is judged whether or not there is a PG_text subtitle stream that satisfies another less conditions. Here the \u201canother less conditions\u201d in this context mean the conditions (a) and (c). Namely, in step S, it is judged whether or not there is a PG_text subtitle stream that satisfies the conditions (a) and (c).","When there are PG_text subtitle streams that satisfy the conditions (a) and (c), a PG_text subtitle stream whose corresponding stream entry is placed first in the stream selection table is selected among the PG_text subtitle streams that satisfy conditions (a) and (c), and the PG_text subtitle stream number of the selected PG_text subtitle stream is set in PSR (step S).","When there is no PG_text subtitle stream that satisfies the conditions (a) and (c), the control goes to step S in which it is judged whether or not there is a PG_text subtitle stream that satisfies the condition (a). When there are PG_text subtitle streams that satisfy the condition (a), a PG_text subtitle stream whose corresponding stream entry is placed first in the stream selection table is selected among the PG_text subtitle streams that satisfy the condition (a), and the PG_text subtitle stream number of the selected PG_text subtitle stream is set in PSR (step S). When there is no PG_text subtitle stream that satisfies the condition (a), a value 0xFFF is set in PSR (step S).","This completes the explanation of the procedure for selecting an optimum PG_text subtitle stream.",{"@attributes":{"id":"p-0545","num":"0546"},"figref":"FIG. 30"},"In step S, it is judged whether the number \u201cx\u201d specified by an operand of the set stream stereoscopic command indicates a stream number of the PG stream (YES) or the text subtitle stream (NO). In step S, it is checked whether or not the PG stream corresponding to the number \u201cx\u201d (PGx) satisfies the following conditions (A) and (B).","Condition (A): The playback device has a capability to decode a PG stream that is identified by the number x.","Condition (B): The language attribute of the identified PG stream matches the language attribute of the playback device.","In step S, it is checked whether or not the text subtitle stream corresponding to the number \u201cx\u201d (textSTx) satisfies the following conditions (A) and (B).","Condition (A): The playback device has a capability to extend the character code of the text subtitle stream x into a bit map.","Condition (B): the playback device has the capability to support the language attribute of the text subtitle stream x.","In step S, it is checked whether or not the playback device satisfies the condition (Z), and then in step S, it is judged whether or not the number is equal to or lower than the total number of stream entries in the stream selection table and conditions (A) and (B) are satisfied. When the result of judgment in step S is affirmative, a PG_text subtitle stream with a PG_text subtitle stream number corresponding to the number x is selected, and the number x is set in PSR (step S).","When the result of judgment in step S is negative, the control proceeds to step S in which it is judged whether or not the number is equal to or lower than the total number of stream entries in the stream selection table and conditions (A) and (Z) are satisfied. When the result of judgment in step S is affirmative, a PG_text subtitle stream with a PG_text subtitle stream number corresponding to the number x is selected, and the number x is set in PSR (step S).","When the result of judgment in step S is negative, the control proceeds to step S in which it is judged whether or not the number x is 0xFFF. When it is judged that the number x is not 0xFFF, the value in PSR is maintained since it is determined that the stream selection table indicates that no PG_text subtitle stream has been permitted to be played back (step S).","When it is judged that the number x is 0xFFF, a PG_text subtitle stream that is optimum for the current playitem is selected (step S). This selection of an optimum PG_text subtitle stream is performed in a similar manner to the procedure shown in .","The process of subsequent steps S to S is unique to the 3D output mode. Specifically, determination processing of upper or lower end playback type is performed (step S). In the determination processing of upper or lower end playback type, if the playback type is set as neither the upper end 2D subtitle playback type nor the lower end 2D subtitle playback type (step S: No), is_SS_PG of a PG stream X identified by a PG stream number X is acquired from stream registration information included in the extension stream selection table (step S). Then, it is judged on whether a flag of the acquired is_SS_PG indicates \u201c1\u201d and whether stereoscopic PG capability of PSR indicates \u201c1\u201d (step ). If a result of the judgment in step  is Yes, the playback type is determined as a stereoscopic PG playback type (step ). When the result of the judgment in step S is NO, the playback type is set as \u201c1 plane+offset\u201d (step S).",{"@attributes":{"id":"p-0557","num":"0558"},"figref":["FIG. 31","FIG. 30"],"b":["58","41","57","41","57"]},"<Determination of Current IG Stream and Playback Type Thereof>","A current IG stream whose stream number is to be stored in PSR is selected based on the output mode in PSR, stereoscopic PG capability in PSR, and \u201cis_SS_IG\u201d.",{"@attributes":{"id":"p-0560","num":"0561"},"figref":"FIGS. 32A and 32B"},{"@attributes":{"id":"p-0561","num":"0562"},"figref":"FIG. 32A","b":["61","65","64","67"]},"In step S, it is judged whether or not the number of entries in the stream selection table is \u201c0\u201d. When the number is \u201c0\u201d, the value in PSR is maintained (step S).","When it is judged in step S that the number of entries in the stream selection table is not \u201c0\u201d, the control proceeds to step S in which it is judged whether or not the number of entries in the stream selection table is equal to or greater than the value in PSR. When the result of judgment in step S is affirmative, the value in PSR is maintained (step S). When it is judged that the value in PSR is greater than the number of entries in the stream selection table, value \u201c1\u201d is set in PSR (step S). Steps S through S that follow step S are unique to the 3D output mode. More specifically, steps S through S in the 3D output mode are performed as follows. An \u201cis_SS_IG\u201d of an IG stream identified by the IG stream number stored in PSR is obtained from the stream registration information in the extension stream selection table (step S). It is judged whether or not the obtained \u201cis_SS_IG\u201d flag is \u201c1\u201d and the stereoscopic IG capability indicated by \u201cb\u201d in PSR is \u201c1\u201d (step S). When the result of judgment in step S is YES, the playback type is set as the stereoscopic IG (step S). When the playback type is set as the stereoscopic IG, the stereoscopic playback is performed by using packet identifier references that are included in the left-eye and right-eye stream entries of a piece of stream registration information corresponding to the current stream number stored in PSR, among a plurality of pieces of stream registration information in the extension stream selection table. More specifically, the demultiplexing unit is caused to demultiplex TS packets whose packet identifiers are indicated by the packet identifier references that are included in the left-eye and right-eye stream entries of a piece of stream registration information corresponding to the current stream number stored in PSR.","When the judgment result in step S is NO, the playback type is set as \u201c1 plane+offset\u201d (step S).","When the playback type is set as \u201c1 plane+offsetIG\u201d, the IG playback in the 1 plane+offset mode is executed by using an offset sequence indicated by the stereoscopic IG offset sequence ID reference information in a piece of stream registration information corresponding to the current stream number stored in PSR, among a plurality of pieces of stream registration information in the extension stream selection table. More specifically, an offset sequence is extracted from the video decoder and the extracted offset sequence is supplied to the shift unit, wherein the offset sequence to be extracted is indicated by the stereoscopic IG offset sequence ID reference information in a piece of stream registration information corresponding to the current stream number, among a plurality of pieces of stream registration information stored in the SEI message of the dependent-view video stream.",{"@attributes":{"id":"p-0566","num":"0567"},"figref":"FIG. 32B","b":"0"},"When a stream change is requested by the set stream stereoscopic command (set stream SS command), by the set stream command, or by a user operation requesting a stream number change, the stream number specified by an operand of the command, or the stream number specified by a user operation, is set as the number x and the procedure is executed as follows.","In step S, it is judged whether or not the number of entries in the stream selection table is equal to or greater than the number x. When the result of judgment in step S is affirmative, the value is set in PSR (step S). When it is judged that the value x is greater than the number of entries in the stream selection table, value \u201c1\u201d is set in PSR (step S). In the 3D output mode, the procedure is executed as follows. An \u201cis_SS_IG\u201d of an IG stream identified by the IG stream number stored in PSR is obtained from the stream registration information in the extension stream selection table (step S). It is judged whether or not the obtained \u201cis_SS_IG\u201d flag is \u201c1\u201d and the stereoscopic IG capability indicated by PSR is \u201c1\u201d (step S). When the result of judgment in step S is YES, the playback type is set as the stereoscopic IG (step S). When the judgment result in step S is NO, the playback type is set as \u201c1 plane+offset\u201d (step S).",{"@attributes":{"id":"p-0569","num":"0570"},"figref":"FIGS. 33A through 33C"},{"@attributes":{"id":"p-0570","num":"0571"},"figref":"FIG. 33A"},"The three pieces of stream registration information provided in the extension stream selection table have stream numbers \u201c1\u201d, \u201c2\u201d, and \u201c3\u201d, respectively, and the stream attributes in the three pieces of stream registration information have \u201cEnglish\u201d, \u201cJapanese\u201d, and \u201cChinese\u201d as the language attributes, respectively. The stream registration information provided in the basic stream selection table differs in the packet identifier stored in the stream entry, from the stream registration information provided in the extension stream selection table. Also, the stream registration information provided in the extension stream selection table contains (i) a packet identifier for a base-view PG stream for the B-D presentation mode, and (ii) a packet identifier for a dependent-view PG stream.",{"@attributes":{"id":"p-0572","num":"0573"},"figref":"FIG. 33B"},"The arrows identified by signs \u201ca\u201d, \u201ca\u201d, and \u201ca\u201d schematically indicate (i) the judgment on whether language settings match each other, (ii) the setting of a stream number in the stream number register, and (iii) the output of a packet identifier to the demultiplexing unit, respectively.","In the operation procedure of this example, it is judged whether the language setting of the playback device matches the stream attribute contained in the stream registration information whose stream number is \u201c3\u201d, and it is judged that they match. As a result of this, the stream number \u201c3\u201d of this stream registration information is written into the stream number register. Also, the packet identifier written in the stream entry of the basic stream selection table is output to the demultiplexing unit. Following this, a TS packet identified by the packet identifier written in the stream entry of the stream registration information whose stream number is \u201c3\u201d in the basic stream selection table is output to the decoder.",{"@attributes":{"id":"p-0575","num":"0576"},"figref":"FIG. 33C"},"The arrows identified by signs \u201ca\u201d, \u201ca\u201d, and \u201ca\u201d schematically indicate (i) the judgment on whether language settings match each other, (ii) the setting of a stream number in the stream number register, and (iii) the output of a packet identifier to the demultiplexing unit, respectively.","In the operation procedure of this example, it is judged whether the language setting of the playback device matches the stream attribute contained in the stream registration information whose stream number is \u201c3\u201d, and it is judged that they match. As a result of this, the stream number \u201c3\u201d of this stream registration information is written into the stream number register. Also, the packet identifier written in the stream entry of the basic stream selection table is output to the demultiplexing unit. Following this, a pair of TS packets identified by a pair of packet identifiers written in the stream entry of the stream registration information whose stream number is \u201c1\u201d in the extension stream selection table are output to the decoder.",{"@attributes":{"id":"p-0578","num":"0579"},"figref":"FIGS. 34A through 34C"},{"@attributes":{"id":"p-0579","num":"0580"},"figref":"FIG. 34A"},"The three pieces of stream registration information provided in the extension stream selection table have stream numbers \u201c1\u201d, \u201c2\u201d, and \u201c3\u201d, respectively, and all of the stream attributes in the three pieces of stream registration information have \u201cChinese\u201d as the language attributes. The stream registration information provided in the basic stream selection table differs in the packet identifier stored in the stream entry, from the stream registration information provided in the extension stream selection table. Also, the stream registration information provided in the extension stream selection table contains (i) a packet identifier for a left-eye PG stream for the B-D presentation mode, and (ii) a packet identifier for a right-eye PG stream for the B-D presentation mode.",{"@attributes":{"id":"p-0581","num":"0582"},"figref":"FIG. 34B"},"The arrows identified by signs \u201ca\u201d, \u201ca\u201d, and \u201ca\u201d schematically indicate (i) the judgment on whether language settings match each other, (ii) the setting of a stream number, and (iii) the output of a packet identifier to the demultiplexing unit, respectively.","In the stream selection procedure of this example, it is judged whether the language setting of the playback device matches the stream attribute contained in the stream registration information whose stream number is \u201c1\u201d, and it is judged that they match. As a result of this, the stream number \u201c1\u201d of this stream registration information is written into the stream number register. Also, the packet identifier written in the stream entry of the basic stream selection table is output to the demultiplexing unit. Following this, a TS packet identified by the packet identifier written in the stream entry of the stream registration information whose stream number is \u201c1\u201d in the basic stream selection table is output to the decoder.",{"@attributes":{"id":"p-0584","num":"0585"},"figref":"FIG. 34C"},"The arrows identified by signs \u201ca\u201d, \u201ca\u201d, and \u201ca\u201d schematically indicate (i) the judgment on whether language settings match each other, (ii) the setting of a stream number in the stream number register, and (iii) the output of a packet identifier to the demultiplexing unit, respectively.","In the operation procedure of this example, it is judged whether the language setting of the playback device matches the stream attribute contained in the stream registration information whose stream number is \u201c1\u201d, and it is judged that they match. As a result of this, the stream number \u201c1\u201d of this stream registration information is written into the stream number register. Also, the packet identifier written in the stream entry of the basic stream selection table is output to the demultiplexing unit. Following this, a pair of TS packets identified by a pair of packet identifiers written in the stream entry of the stream registration information whose stream number is \u201c1\u201d in the extension stream selection table are output to the decoder.","According to the present embodiment as described above, the extension stream selection table includes a video shift mode that defines saving of subtitle display region in correspondence with a stream number. Accordingly, when the playback section changes, or when a request for changing the stream is received, a stream selection procedure is executed. When a new stream number is set in a stream number register, a video shift mode corresponding to the set new stream number is provided with the playback device. With this structure, it is possible to realize control in which a display region of a subtitle is saved in the upper end of the screen in a playback section and a display region of a subtitle is saved in the lower end of the screen in another playback section.","The cinema scope size (1:2.35) is generally used for the aspect ratio of video of movies. In the case where a video is stored in an optical disc such as a BD-ROM, a main feature video is disposed in the center of an HD video having the aspect ratio of 16:9 without changing the aspect ratio, and a black frame is inserted into each of the upper side and the lower side of the HD video. Accordingly, with the above structure, it is possible to display subtitles in a large subtitle display region generated by collecting black frames located above and below the main feature video to one of the upper end and the lower end of the video plane. This can improve the use efficiency of the screen, thereby improving the stereoscopic effect.","As a modification example of the present embodiment, the following describes a method of shifting upward or downward not only picture data stored in the video plane memory but also subtitles stored in the PG plane memory so as to overlay the picture data with the subtitles.",{"@attributes":{"id":"p-0590","num":"0591"},"figref":["FIGS. 35A through 35C","FIG. 35B"]},"In the present modification example, the stream registration information of the PG stream additionally includes a \u201cPG shift value video shift upward (PG_v_shift_value_for_Up)\u201d and a \u201cPG shift value video shift downward (PG_v_shift_value_for_Down)\u201d.","The \u201cPG shift value in video shift upward (PG_v_shift_value_for_Up)\u201d represents an amount of downward shift of subtitle data stored in the PG plane memory in the case where the video shift mode is set as \u201cUp\u201d and a display region of subtitles of a PG_text subtitle stream is saved in the lower ends of the video plane.","The \u201cPG shift value in video shift downward (PG_v_shift_value_for_Down)\u201d represents an amount of upward shift of subtitle data stored in the PG plane memory in the case where the video shift mode is set as \u201cDown\u201d and a display region of subtitles of a PG_text subtitle stream is saved in the upper ends of the video plane.","These values are set in PSR shown in . The shift amount shown by the PSR includes a plane shift amount in video shift upward and a plane shift amount in video shift downward for each plane. For example, the PSR includes \u201cPG_shift_value_for_UP\u201d and \u201cPG_shift_value_for_Down\u201d for a PG plane. These values are set by acquiring PG_v_shift_value_for_Up and PG_v_shift_value_for_Down of a current PG stream selected by stream switching from stream registration information in the extension stream selection table.",{"@attributes":{"id":"p-0595","num":"0596"},"figref":"FIG. 36","b":["32","33"]},"Specifically, when the video_shift_mode in the PSR is set as \u201cUp\u201d, a picture output from the video plane memory is shifted upward by 131 pixels, and a subtitle output from the PG plane is shifted downward by the number of pixels set in the PG_shift_value_for_Up in the PSR, and layer overlaying is performed on the picture and subtitle, as shown in . On the other hand, when the video_shift_mode in the PSR is set as \u201cDown\u201d, a picture output from the video plane memory is shifted downward by 131 pixels, and a subtitle output from the PG plane is shifted upward by the number of pixels set in the PG_shift_value_for_Down in the PSR, and layer overlaying is performed on the picture and subtitle, as shown in .","Here, in the present modification example, as shown in , in the case where the video_shift_mode indicates \u201cUp\u201d or \u201cDown\u201d, plane shift results in a cropped region. Accordingly, there only needs to make a restriction such that no subtitle data is in the cropped region. In other words, as shown in the left side of , since a region other than a region surrounded by a dashed line has a possibility to be cropped, a display position of the PG is restricted such that no subtitle data is displayed on the region other than the region surrounded by the dashed line. The coordinate of the region is represented by (0,PG_v_shfit_value_for_Down), (0,height+PG_v_sfhit_value_for_Up), (width,PG_v_shfit_value_for_Down), and (width,height+PG_v_sfhit_value_for_Up). For example, if PG_v_sfhit_value_for_Up indicates \u2212a and PG_v_sfhit_value_for_Down indicates+b, the region is represented by (0,b), (0,height\u2212a), (width,b), and (width,height\u2212a). As the constraint conditions for PG, the display position is restricted so as not to go beyond the above region, the display position to which the size of an object to be displayed is added is restricted so as not to go beyond the above region, the display position of the window is restricted so as not to go beyond the above region, and the display position of the window to which the window size is added is restricted so as not to go beyond the above region, for example. Such constraint conditions can prevent display of a partially lacking.","The following describes Embodiment 2 of the present invention.","In the present embodiment, a method is described for realizing 3D video having an appropriate depth depending on the screen size of a TV connected to the 2D\/3D playback device.","In the case of 3D video with use of the parallax images, the screen size affects the sense of depth of 3D video, as shown in the left side of . This is due to the difference value between the left-eye video and the right eye video that varies depending on the screen size of the TV. Suppose that, for example, in the case where a left video and a right video are created so as to realize the most appropriate width for a 50-inch TV as shown in the left side of . In such a case, it is possible to realize the most appropriate viewing for a 50-inch TV. However, the difference value between the left-eye video and the right eye video is small for a TV smaller than the 50-inch TV, and as a result a video that is not powerful and does not have much width is displayed in such a TV. On the other hand, the difference is too large for a TV larger than the 50-inch TV, and this causes the user to have an eyestrain. In view of this, it is preferable to apply an offset value for correcting the screen size to each of the left-eye plane and the right eye plane for output to the TV, as shown in the right side of . For example, in the case where the left-eye video and the right eye video are optimized for the 50-inch TV as shown in , an offset value is set for a 32-inch TV so as to increase the sense of depth for output to the TV. An offset value is set for a 100-inch TV so as to decrease the sense of depth for output to the TV. Setting of an offset value indicates, like the 1 plane+offset method, the last plane output from the player is shifted based on an offset value, and is cropped. An offset value to be applied to this last plane of the player is referred to as an \u201coutput offset correction value\u201d. The following describes a specific method.","Firstly, the data structure is described. The basic parts of the data structure are the same as those for storing 3D videos described in the above embodiments, and accordingly additional parts or different parts from the above embodiments are mainly described here.","In a file such as an index file, a playlist file, and an AV stream information file, a table as shown in  is stored. In this table, a plurality of pieces of screen size information are registered, each of which includes a TV inch and an output offset correction value that are grouped into pairs. In , the inch number is defined for each 10 inches. Alternatively, the inch number may be defined for each arbitrary inch in accordance with a predetermined standard. Further alternatively, the user may define the inch number. It may be employed to prepare some tables as shown in , and only reference IDs of these tables are registered in the file such as the index file, the playlist file, and the AV stream information file. It may be employed to prepare a function for determining an offset value depending on the inch number as shown in the right side of .","The table may include, in addition to the pairs of TV inch and output offset correction values, a value of the optimal TV size (assumed_TV_size_when authoring) indicating an inch a created content targets. The use of the values of the optimal TV size makes it possible to perform various types of correction processing. For example, in the case where display is performed by a TV having an optimal inch size or greater, it is possible to perform processing such as displaying images having the optimal inch size on the center of the screen of the TV and displaying a black frame around a video, as shown in .","Next, the playback device relating to the preset embodiment is described. The playback device includes, as shown in , a PSR that is a system parameter for storing an output offset correction value and an output offset correction value application unit. The playback control unit acquires the screen size (inch number) of a TV to be connected with the playback device via an HDMI cable or the like, identifies an output offset correction value corresponding to the screen size based on the table shown in , and stores the identified output offset correction value in the PSR. The output offset correction value application unit refers to the value stored in the PSR, and set an offset value for a plane the left-eye video and the right-eye video that are overlaid by the plane addition unit, using a value of the PSR.","Instead of storing an output offset correction value in the PSR, the structure may be employed in which the screen size is stored in the PSR and the output offset correction value application unit identifies an output offset correction value with reference to the table shown in .","Note that the output offset correction value may be adjusted depending on a user who is watching the video. For example, since an infant has a narrow distance between left and right eyes, the smaller difference between a left-eye video and a right eye video is preferable. In view of this, an \u201coutput offset correction value \u03b1\u201d for correcting the output offset correction value is prepared. The output offset correction value application unit performs offset correction processing with use of a value resulting from multiplying the offset correction value by the \u201coutput offset correction value \u03b1\u201d. Specifically, the processing is realized with use of the structure shown in .  shows a PSR in which the output offset correction value \u03b1 is stored. The playback control unit or the program execution unit sets the value on the PSR via the menu screen, the OSD screen of the player, or the like. For example, in order to decrease the depth for a child user, it is possible to decrease the depth by setting a value greater than 1. The output offset correction value application unit refers to the PSR and the PSR, and applies offset on the plane with use of a value resulting from multiplying the output offset correction value by the output offset correction value \u03b1. As a result, it is possible to adjust the sense of depth in accordance with a user's preference.","It may be possible to employ the structure in which the \u201coutput offset correction value \u03b1\u201d is set on the menu screen of the BD program by selecting one of three modes \u201cweak\u201d, \u201cnormal\u201d, and \u201cstrong\u201d for the depth of 3D.","The \u201coutput offset correction value \u03b1\u201d may be stored for each of the SEI message of a video stream, the descriptor of the PMT packet, the playitem, or the like, and may be changed depending on the scene. With such a structure, it is possible to set an \u201coutput offset correction value \u03b1\u201d having a greater value for a scene having a large depth, for example.","In the present embodiment, the output offset amount correction value is changed depending on the screen size of TV. Alternatively, the output offset amount correction value or the output offset correction value \u03b1 may be changed depending on the distance from the TV to the user. In this case, the following structure may be employed. Glasses for 3D viewing measures the distance from the screen of the TV to the glasses, the TV acquires the distance, and then the TV notifies the playback device of the distance via an HDMI cable.","In the present embodiment, the output offset amount correction value is changed depending on the screen size of TV. Alternatively, the projector may measure the screen size in the following methods because the projector cannot recognize the size of the screen. According to one of the methods, the projector outputs a laser to the screen such as infrared light, the distance is measured with use of the flashback of the infrared light from the screen, and the screen size is calculated with use of the optical parameter of the lens. According to another one of the methods, the length of a \u201cline segment\u201d is displayed on the projector, and the user measures the length of the line segment on the screen inputs the length via the OSD of the projector. The projector can calculate the length of the screen depending on the length of the line segment on the screen.","According to the present embodiment as described above, it is possible to achieve an optimal stereoscopic effect suitable for each screen size by performing offset processing for changing the difference value between the left-eye video and the right-eye video depending on the screen size for video display.","Embodiment 3 relates to an improvement of the internal structure of the stereoscopic interleaved stream file.","Here, as a premise of the present embodiment, files in the UDF file system will be explained briefly. The UDF file is composed of a plurality of Extents managed by the file entry. The \u201cfile entry\u201d includes a \u201cdescriptor tag\u201d, an \u201cICB tag\u201d, and an \u201callocation descriptor\u201d.","The \u201cdescriptor tag\u201d is a tag identifying, as a \u201cfile entry\u201d, the file entry which includes the descriptor tag itself. The descriptor tag is classified into a file entry descriptor tag, a space bit map descriptor tag, and so on. In the case of a file entry descriptor tag, \u201c261\u201d, which indicates \u201cfile entry\u201d is written therein.","The \u201cICB tag\u201d indicates attribute information concerning the file entry itself.","The \u201callocation descriptor\u201d includes a Logical Block Number (LBN) indicating a recording position of an Extent constituting a low-order file under a directory. The allocation descriptor also includes data that indicates the length of the Extent. The high-order two bits of the data that indicates the length of the Extent are set as follows: \u201c00\u201d to indicate an allocated and recorded Extent; \u201c01\u201d to indicate an allocated and not-recorded Extent; and: \u201c11\u201d to indicate an Extent that follows the allocation descriptor. When a low-order file under a directory is divided into a plurality of Extents, the file entry should include a plurality of allocation descriptors in correspondence with the Extents.","It is possible to detect an address of an Extent constituting a stream file by referring to the allocation descriptor in the file entry described above.","The following describes the files in various types that are used in the present embodiment.","<Stereoscopic Interleaved Stream File (FileSS)>","The stereoscopic interleaved stream file (FileSS) is a stream file (2TS-interleaved file) in which two TSs are interleaved, and is identified by a five-digit integer value and an extension (ssif) indicating an interleave-format file for stereoscopic playback. The stereoscopic interleaved stream file is composed of Extent SS[n]. The Extent SS[n] (also referred to as \u201cEXTSS[n]\u201d) is identified by the index number \u201cn\u201d. The index number \u201cn\u201d increments in order starting from the top of the stereoscopic interleaved stream file.","Each Extent SS[n] is structured as a pair of a dependent-view data block and a base-view data block.","The dependent-view data block and base-view data block constituting the Extent SS[n] are a target of cross reference by the file 2D, file base, and file dependent. Note that the cross reference means that a piece of data recorded on a recording medium is registered as an Extent of a plurality of files in the file entries thereof. In the present embodiment, the starting addresses and continuation lengths of the dependent-view data block and base-view data block are registered in the file entries of the file 2D, file base, and file dependent.","<File Base (FileBase)>","The file base (FileBase) is a virtual stream file that is presumed to \u201cstore\u201d a main TS specified by the extent start point information in the clip information corresponding to the file 2D. The file base (FileBase) is composed of at least one Extent [] (also referred to as \u201cEXT[]\u201d). The Extent [] is the iExtent in the file base, where \u201ci\u201d is an index number of the Extent and is incremented starting from \u201c0\u201d at the top of the file base. The file base is a virtual stream file used to treat the stereoscopic interleaved stream file, which is a 2TS-file, as a 1TS-file. The file base is generated in a virtual manner by building its file entry in the memory of the playback device.","In the actual reading, the file base is identified by performing a file open using a file name of the stereoscopic interleaved stream file. More specifically, when the file open using a file name of the stereoscopic interleaved stream file is called, the middleware of the playback device generates, in the memory, a file entry identifying an Extent in the file base, and opens the file base in a virtual manner. The stereoscopic interleaved stream file can be interpreted as \u201cincluding only one TS\u201d, and thus it is possible to read a 2TS stereoscopic interleaved stream file from the recording medium as a 1TS file base.","When only a base-view data block is to be read in the B-B presentation mode, only the Extents constituting the file base become the target of the reading. Even if the mode is switched from the B-B presentation mode to the B-D presentation mode, both the dependent-view data block and the base-view data block can be read by extending the reading range from the Extents constituting the file base to the Extents constituting the stereoscopic interleaved stream file. Thus, with this arrangement, the efficiency of the file reading is not decreased.","<File Dependent (FileDependent)>","The file dependent (FileDependent) is a stream file that is presumed to \u201cstore\u201d a sub-TS, and is composed of Extent [] (also referred to as \u201cEXT[]\u201d). The Extent [] is the iExtent in the file dependent, where \u201ci\u201d is an index number of the Extent and is incremented starting from \u201c0\u201d at the top of the file dependent. The file dependent is a virtual stream file used to treat the stereoscopic interleaved stream file, which is a 2TS-file, as a 1TS-file storing the sub-TS. The file dependent is generated in a virtual manner by building its file entry in the memory of the playback device.","The dependent-view video stream is attached with and accessed with use of a file name that is represented by a number generated by adding \u201c1\u201d to the five-digit integer representing the file name of the stereoscopic interleaved stream file. The recording medium stores a dummy file, and the \u201cnumber generated by adding 1\u201d, namely, the identification number of the dependent-view video stream, is attached to the dummy file. Note that the dummy file is a file that stores no Extent, namely, substantial information, but is attached with only a file name. The dependent-view video stream is treated as being stored in the dummy file.","<File 2D (File2D)>","The file 2D (File2D) is a 1TS stream file storing a main TS that is played back in the 2D output mode, and is composed of the Extent 2D. The file 2D is identified by a five-digit integer value and an extension (ssif) indicating an interleave-format file for stereoscopic playback.",{"@attributes":{"id":"p-0632","num":"0633"},"figref":"FIG. 45"},"In , the first row shows a file 2D\/file base 00001.m2ts and a file dependent 00002.m2ts. The second row shows Extents that store dependent-view data blocks and base-view data blocks. The third row shows a stereoscopic interleaved stream file 00001.ssif.","The dotted arrows h, h, h, and h show the files to which Extents EXT[] and EXT[] belong, the belongingness being indicated by the allocation identifiers. According to the belongingness guided by the arrows h and h, Extents EXT[] and EXT[1] are registered as Extents of the file base 00001.m2ts.","According to the belongingness guided by the arrows h and h, Extents EXT[] and EXT[1] are registered as Extents of the file dependent 00002.m2ts.","According to the belongingness guided by the arrows h, h, h, and h, Extents EXT[], EXT[], EXT[1], and EXT[1] are registered as Extents of 00001.ssif. As understood from this, Extents EXT[] and EXT[1] have the duality of belonging to 00001.ssif and 00001.m2ts. The extension \u201cssif\u201d is made of capital letters of StereoScopic Interleave File, indicating that the file is in the interleave format for stereoscopic playback.","Here, a pair of an Extent constituting the file base and an Extent constituting the file dependent that are both identified by the same Extent identifier is called an \u201cinterleave Extent unit\u201d. In the example shown in , a pair of EXT[] and EXT[] that are both identified by an Extent identifier \u201ci\u201d is an interleave Extent unit [i]. Also, a pair of EXT[1] and EXT[1] that are both identified by an Extent identifier \u201ci+1\u201d is an interleave Extent unit [i+1]. In a random access to a stereoscopic interleaved stream file, it is necessary to ensure that an interleave Extent unit identified by the Extent identifier is read from the recording medium completely at once.",{"@attributes":{"id":"p-0638","num":"0639"},"figref":"FIGS. 46A through 46C"},"The third row in  shows the internal structure of the interleaved stream file. The stereoscopic interleaved stream file is composed of Extents EXT[] and EXT[] storing base-view data blocks and EXT[] and EXT[] storing dependent-view data blocks, wherein they are arranged alternately in the interleave format.","The first row in  shows the internal structure of the file 2D\/file base. The file 2D\/file base is composed of only Extents EXT[] and EXT[] storing base-view data blocks, among the Extents constituting the interleaved stream file shown in the third row. The file 2D\/file base and the interleaved stream file have the same name, but different extensions.","The second row in  shows the internal structure of the file dependent. The file dependent is composed of only Extents EXT[], EXT[], and EXT[] storing dependent-view data blocks, among the Extents constituting the interleaved stream file shown in the third row. The file name of the file dependent is a value higher by \u201c1\u201d than the file name of the interleaved stream file, and they have different extensions.","Not all playback devices necessarily support the 3D playback system. Therefore, it is preferable that even an optical disc including a 3D image supports a 2D playback. It should be noted here that the playback devices supporting only the 2D playback do not identify the data structure extended for the 3D. The 2D playback devices need to access only the 2D playlists and 2D streams by using a conventional identification method provided to the 2D playback devices. In view of this, the base-view video streams are stored in a file format that can be recognized by the 2D playback devices.","According to the first method, the main TS is assigned with the same file name as that in the 2D playback system so that the above-described referencing of playlist information can be realized, that is to say, so that the main TS can be used in the 2D playback as well, and stream files in the interleave format have a different extension.  shows that files \u201c00001.m2ts\u201d and \u201c00001.ssif\u201d are coupled with each other by the same file name \u201c00001\u201d, although the former is in the 2D format and the latter is in the 3D format.","In a conventional 2D playback device, the playlist refers to only the AV clips the main TS, and therefore the 2D playback device plays back only the file 2D. On the other hand, in a 3D playback device, although the playlist refers to only the file 2D storing the main TS, when it finds a file that has the same identification number and a different extension, it judges that the file is a stream file in the interleave format for the 3D image, and outputs the main TS and sub-TS.","The second method is to use different folders. The main TSs are stored in folders with conventional folder names (for example, \u201cSTREAM\u201d), but sub-TSs are stored in folders with folder names unique to 3D (for example, \u201cSSIF\u201d), with the same file name \u201c00001\u201d. In the 2D playback device, the playlist refers to only files in the \u201cSTREAM\u201d folder, but in the 3D playback device, the playlist refers to files having the same file name in the \u201cSTREAM\u201d and \u201cSSIF\u201d folders simultaneously, making it possible to associate the main TS and the sub-TS.","The third method uses the identification numbers. That is to say, this method associates the files based on a predetermined rule regarding the identification numbers. For example, when the identification number of the file 2D\/file base is \u201c00001\u201d, the file dependent is assigned with identification number \u201c00002\u201d that is made by adding \u201c1\u201d to the identification number of the file 2D, as shown in . However, the file system of the recording medium treats the file dependent, which is assigned with a file name according to the rule, as a non-substantial dummy file. This is because the file dependent is, in the actuality, the stereoscopic interleaved stream file. The file names having been associated with each other in this way are written into (i) the stream registration information in the basic stream selection table and (ii) the sub-clip entry ID reference (ref_to_subclip_entry_id) in the stream registration information in the extension stream selection table. On the other hand, the playback device recognizes a file name, which is a value higher by \u201c1\u201d than the file name written in the sub-clip entry ID reference, as the file name of the dummy file, and performs the process of opening the file dependent in a virtual manner. This ensures that the stream selection procedure reads, from the recording medium, the file dependent that is associated with other files in the above-described manner.","The clip information files are identified by the same rule as above.","This completes the description of the file 2D, file base, and file dependent.","The following explains the data blocks in detail.","<Base-view Data Block>","The base-view data block (B[i]) is the idata in the main TS. Note that the main TS is a TS specified as the main element of the main path by the clip information file name information of the current playitem information. The \u201ci\u201d in B[i] is an index number that is incremented starting from \u201c0\u201d corresponding to the data block at the top of the file base.","The base-view data blocks fall into those shared by the file base and the file 2D, and those not shared by the file base and the file 2D.","The base-view data blocks shared by the file base and the file 2D and the base-view data blocks unique to the file 2D become the Extents of the file 2D, and they are set to have a length that does not cause a buffer underflow in the playback device. The starting sector address of the base-view data blocks is written in the allocation descriptor in the file entry of the file 2D.","The base-view data blocks unique to the file base, which are not shared by the file 2D, do not become the Extents of the file 2D, and thus they are not set to have a length that does not cause an underflow in a single buffer in the playback device. The base-view data blocks are set to have a smaller size, namely, a length that does not cause an underflow in a double buffer in the playback device.","The starting sector addresses of the base-view data block unique to the file base are not written in the allocation descriptor in the file entry. Instead of this, the starting source pocket in the base-view data block is pointed to by the extent start point information in the clip information of the clip information file corresponding to the main TS. Therefore, the starting sector address of a base-view data block unique to the file base needs to be obtained by using (i) the allocation descriptor in the file entry of the stereoscopic interleaved stream file and (ii) the extent start point information in the clip information.","<Dependent-view Data Block>","The dependent-view data block (D[i]) is the idata in the sub-TS. Note that the sub-TS is a TS specified as the main element of the sub-path by the stream entry in the stream registration sequence in the extension stream selection table corresponding to the current playitem information. The \u201ci\u201d in D[i] is an index number that is incremented starting from \u201c0\u201d corresponding to the data block at the top of the file dependent.","The dependent-view data blocks become the Extents of the file dependent, and are set to have a length that does not cause an underflow in a double buffer in the playback device.","Also, in the continuous regions in the recording medium, a dependent-view data block is disposed before a base-view data block that is played back in the same playback time together the dependent-view data block. For this reason, when the stereoscopic interleaved stream file is read, the dependent-view data block is read before the corresponding base-view data block, without fail.","The starting sector addresses of the dependent-view data blocks are not written in the allocation descriptor in the file entry of the file 2D since the dependent-view data blocks are not shared by the file 2D. Instead of this, the starting source pocket in the dependent-view data block is pointed to by the extent start point information in the clip information. Therefore, the starting sector address of a dependent-view data block needs to be obtained by using (i) the allocation descriptor in the file entry of the file 2D and (ii) the extent start point information in the clip information.","<Classification of Extent>","As described above, the Extents of the file 2D fall into those shared by the file base, and those not shared by the file base.","Suppose here that the Extents of the file 2D are B[], B[], B[], B[]2D, and B[]2D, and that the Extents of the file base are B[], B[], B[], B[]ss, and B[]ss. Of these, B[], B[], and B[] are base-view data blocks shared by the file base. B[]2D and B[]2D are base-view data blocks unique to the file 2D, not shared by the file base.","Also, B[]ss and B[]ss are base-view data blocks unique to the file base, not shared by the file 2D.","The data of B[]2D is bit-for-bit same as data of B[]ss. The data of B[]2D is bit-for-bit same as data of B[]ss.","The data blocks B[], B[]2D, and B[]2D in the file 2D constitute Extents (big Extents) having a large continuation length immediately before a position at which a long jump is caused. In this way, big Extents can be formed immediately before a long jump in the file 2D. Accordingly, even when a stereoscopic interleaved stream file is played back in the 2D output mode, there is no need to worry an occurrence of an underflow in the read buffer.","The file 2D and the file base have sameness, although being partially different in Extents. Therefore, the file 2D and the file base are generically called \u201cfile 2D\/file base\u201d.",{"@attributes":{"id":"p-0668","num":"0669"},"figref":["FIG. 47","FIG. 47"]},"The data blocks shown in the second row are D[], B[], D[], B[], D[], B[]ss, D[], B[]ss, B[]2D, and B[]2D. The arrows ex, ex, ex, and ex show the belongingness in which, among these data blocks, data blocks B[], B[], B[]2D, and B[]2D constitute the Extents of the file 2D.","The arrows ex and ex show the belongingness in which D[], B[], D[], B[], D[], B[]ss, D[], and B[]ss constitute the Extents of the stereoscopic interleaved stream file.","The fourth row shows that, among these data blocks constituting the stereoscopic interleaved stream file, B[], B[], B[]ss, and B[]ss constitute the Extents of the file base. The fifth row shows that, among the data blocks constituting the stereoscopic interleaved stream file, D[], D[], D[], and D[] constitute the Extents of the file dependent.",{"@attributes":{"id":"p-0672","num":"0673"},"figref":"FIG. 48"},"The arrows rf, rf, and rf show a playback path generated by combining the extension \u201cm2ts\u201d and a file name \u201c00001\u201d described in \u201cclip_information_file_name\u201d in the playitem information of the 2D playlist information. In this case, the playback path on the base-view side is constituted from data blocks B[], B[], and B[]2D.","The arrows rf, rf, rf, and rf show a playback path specified by the playitem information of the 3D playlist information. In this example, the playback path on the base-view side is constituted from data blocks B[], B[], B[]ss, and B[]ss.","The arrows rf, rf, rf, and rf show a playback path specified by the sub-playitem information of the 3D playlist information. In this example, the playback path on the dependent-view side is constituted from data blocks D[], D[], D[], and D[]. These data blocks constituting the playback paths specified by the playitem information and the sub-playitem information can be read by opening files that are generated by combining the extension \u201cssif\u201d and file names written in \u201cclip_information_file_name\u201d in the playitem information.","As shown in , the clip information file name information in the 3D playlist and the clip information file name information in the 2D playlist have file names in common. Accordingly, the playlist information can be written to include description that is common to the 3D playlist and the 2D playlist (see as signs df and df indicate) so as to define the 3D playlist and the 2D playlist. Accordingly, once playlist information for realizing the 3D playlist is written: the playlist information functions as the 3D playlist when the output mode of the playback device is the stereoscopic output mode; and the playlist information functions as the 2D playlist when the output mode of the playback device is the 2D output mode. The 2D playlist and the 3D playlist shown in  have in common a piece of playlist information, which is interpreted as the 2D playlist or the 3D playlist depending on the output mode of the playback device that interprets the piece of playlist information. This reduces the amount of time and effort made by a person in charge of authoring.","When main TSs and sub-TSs are stored in the stereoscopic interleaved stream file, a file name of the file 2D is written in \u201cclip_information_file_name\u201d in the playitem information of the 2D playlist, and a file name of the file base is written in \u201cclip_information_file_name\u201d in the playitem information of the 3D playlist. Since the file base is a virtual file and its file name is the same as that of the stereoscopic interleaved stream file, the file name of the stereoscopic interleaved stream file can be written in \u201cclip_information_file_name\u201d in the playitem information. A file name of the file dependent is written in \u201cref_to_subclip_entry_id\u201d in the stream registration information in the extension stream selection table. The file name of the file dependent is created by adding \u201c1\u201d to the identification number of the stereoscopic interleaved stream file.","As described above, base-view and dependent-view data blocks are stored in one stereoscopic interleaved stream file, and the stereoscopic interleaved stream file can be opened as a file of any of the file 2D, file base, and file dependent. With this structure, the decoder can treat the stereoscopic interleaved stream file in the same manner as a regular stream file. Thus the storage method of the base-view and dependent-view video streams can be positively used for the storage of the stereoscopic interleaved stream file.","Next, the internal structure of the clip information file will be described in detail.",{"@attributes":{"id":"p-0680","num":"0681"},"figref":"FIGS. 49A through 49D"},{"@attributes":{"id":"p-0681","num":"0682"},"figref":["FIG. 49A","FIG. 49B"]},"The \u201cclip information\u201d is information indicating, for each ATC sequence, what type of AV clip each source packet sequence stored in the stream file is.","The \u201csequence information\u201d indicates, for each ATC sequence, information (ATC sequence information) that indicates what type of ATC sequence one or more source packet sequences stored in the stream file are. The ATC sequence information includes: information indicating, by the source packet number, where the source packet being the start point of the ATC exists; offsets between the STC sequence identifiers and the ATC sequence identifiers; and STC sequence information corresponding to each of a plurality of STC sequences. Each piece of STC sequence information includes: a packet number of a source packet storing the PCR of the STC sequence in concern; information indicating where in the STC sequence the source packet being the start point of the STC sequence exists; and the playback start time and the playback end time of the STC sequence.","The \u201cprogram information\u201d indicates the program structures of the main TS and sub-TSs managed as \u201cAV clips\u201d by the clip information file. The program information indicates what types of ESs are multiplexed in the AV clip. More specifically, the program information indicates what types of packet identifiers the ESs multiplexed in the AV clip have, and indicates the encoding method. Thus the program information indicates the encoding method, such as MPEG2-video or MPEG4-AVC, that is used to compress-encode the video stream.","The \u201ccharacteristic point information\u201d is information indicating, for each ES, where the characteristic points of a plurality of ESs multiplexed in the AV clip exist. The information indicating the characteristic point for each ES is called a \u201cbasic entry map\u201d.","What becomes the characteristic point is different for each type of stream. In the case of the base-view and dependent-view video streams, the characteristic point is the access unit delimiter that indicates the I-picture-type view component that is located at the start of the open GOP and closed GOP. In the case of the audio stream, the characteristic point is the access unit delimiter indicating the start positions of the audio frames that exist at regular intervals, for example, every one second. In the case of the PG and IG streams, the characteristic point is the access unit delimiter indicating the start positions of the display sets (display set of epoch start, display set of acquisition point) that are provided with all the functional segments necessary for the display, among the display sets of the graphics streams.","The ATC sequence and the STC sequence differ in how they represent the characteristic point. The ATC sequence represents the characteristic point by the source packet number. The STC sequence represents the characteristic point by using the PTS that indicates the time point on the STC time axis.","In view of the above-described differences, the basic entry map for each ES is composed of a plurality of entry points. More specifically, in each entry point constituting the entry map, a source packet number that indicates the location of the characteristic point in the ATC sequence is associated with a PTS that indicates the location of the characteristic point in the STC sequence. Further, each entry point includes a flag (\u201cis_angle_change\u201d flag) that indicates whether an angle change to the characteristic point is available. Since an angle change is available at the source packet located at the start of the interleave unit constituting the multi-angle section, the \u201cis_angle_change\u201d flag in the entry point indicating the starting source packet of the interleave unit is always set ON. Also, the entry point indicating the starting source packet of the interleave unit is associated with In_Time in the playitem information by the entry point.","The entry map for each ES indicates the source packet numbers of the characteristic points for respective stream types in correspondence with the PTSs. Accordingly, by referencing this entry map, it is possible to obtain, from an arbitrary time point in the ATC sequence, source packet numbers that indicate locations of the characteristic points for the ESs that are closest to the arbitrary time point.","This completes the explanation of the clip information file for 2D. Next is a detailed explanation of the clip information file for 3D.  shows the internal structure of clip information file for 3D. The clip information file for 3D includes: \u201cclip dependent information (dependent-view management information)\u201d which is clip information for the file dependent; and \u201cclip base information (base-view management information)\u201d which is clip information for the file base, as well as the \u201cclip information for file 2D\u201d that is regular clip information (management information). The reason is as follows. As described, the stereoscopic interleaved stream file is stored in a directory that is different from the directory in which the regular stream files are stored, to prevent them from mixing each other. Accordingly, the clip information files cannot be associated with the stereoscopic interleaved stream file. Thus the clip dependent information and the clip base information are stored in the clip information file for 2D.","The clip dependent information and the clip base information differ from the clip information file for 2D in that the clip dependent information and the clip base information include metadata that has the extent start point sequence.","As shown in , the clip dependent information includes the extent start point sequence, and the clip base information also includes the extent start point sequence. The characteristic point information includes an entry map, and the extension data includes an extension entry map.","In the 3D output mode, the clip information file is divided into a clip base information file and a clip dependent information file.",{"@attributes":{"id":"p-0694","num":"0695"},"figref":"FIG. 49C"},{"@attributes":{"id":"p-0695","num":"0696"},"figref":"FIG. 49D"},"A clip information file for the 2D output mode is stored under the directory for the clip information file (CLPI directory). The clip base information file is generated from the clip information file in the 3D output mode, and is treated to be stored in the clip information file for the 2D output mode.","A dummy clip information file is stored under the directory for the clip information file (CLPI directory). The dummy clip information file is assigned with a file name that is represented by a number corresponding to the file dependent, namely, a number generated by adding \u201c1\u201d to the identification number of the file 2D\/file base. The clip dependent information file is generated in the 3D output mode from the clip information file corresponding to the file 2D, and is treated to be stored in the dummy clip information file. Suppose here that the clip information file in the 2D output mode is 00001.clpi, then the clip base information file in the 3D output mode is treated to be stored in 00001.clpi, and the clip dependent information file in the 3D output mode is treated to be stored in 00002.clpi.","<Extent Start Point>","The following explains the extent start point.","As described above, the stereoscopic interleaved stream file is composed of two clip AV streams (BDAV MPEG2 transport stream). The pair of extent start point information enables the stereoscopic interleaved stream file to be divided into two AV streams. The extent start point information is supplied as follows.","(1) An extent start point information table is supplied, to the playback device, in a piece of clip information that is referenced by a playitem of a playlist which includes a sub-path of \u201csub-path type=8\u201d. It should be noted here that the sub-path of \u201csub-path type=8\u201d is an out-of-MUX dependent-view video stream playback path of an on-disc type.","(2) Another extent start point information table is supplied, to the playback device, in a piece of clip information that is referenced by a sub-playitem of a playlist which includes a sub-path of \u201csub-path type=8\u201d.","When a flag in the playitem information (flug_is_multiangle_flag), which indicates whether a multi-angle section exists, is set ON, the extent start point information tables in a pair are supplied to the playback device, one in a piece of clip information that is referenced by an angle ID value, and the other in a piece of clip information that is referenced by a sub-clip entry ID value.","The extent start point information in the clip information file has the following data structure. The ID value and ID value in the extension data in ext_data_entry( ) should be set to 0x0002 and 0x0004, respectively.","The clip information file including the extent start point information tables needs to satisfy the following two conditions.","(a) The clip information file needs to be referenced by a playitem of a playlist which includes a sub-path of \u201csub-path type=8\u201d.","(b) The clip information file needs to be referenced by a sub-playitem in a sub-path of \u201csub-path type=8\u201d. Note that the sub-path of \u201csub-path type=8\u201d is an out-of-MUX dependent-view video stream playback path of an on-disc type.",{"@attributes":{"id":"p-0708","num":"0709"},"figref":["FIG. 50","FIG. 50","FIG. 50","FIG. 50"]},"The arrows bk and bk indicate that the file base and the file dependent are obtained respectively by dividing the stream file shown on the right side of the drawing.","The clip information file shown on the left side of  includes characteristic point information, extension data, clip base information, and clip dependent information. The arrows bk and bk indicate that the extent start point information tables in the clip base information and the clip dependent information enable the stereoscopic interleaved stream file to be divided.","The following explains the extent start point.","In the extent start point information of the clip information file, an ID value and an ID value in the extension data in ext_data_entry( ) should be set to 0x0002 and 0x0004, respectively.","The clip information file including the extent start point information needs to satisfy the following two conditions.","(i) The clip information file needs to be referenced by a playitem of a playlist which includes a sub-path having a sub-path type indicating 8.","(ii) The clip information file needs to be referenced by a sub-playitem in a sub-path having a sub-path type indicating 8. Note that the sub-path having a sub-path type indicating 8 is an out-of-MUX dependent-view video stream playback path of an on-disc type.","The stereoscopic interleaved stream file is composed of two clip AV streams (BDAV MPEG2 transport streams). The pair of extent start point information enables the stereoscopic interleaved stream file to be divided into two AV streams. The extent start point information is supplied as follows.","(1) An extent start point information table is stored in clip information that is referenced by a playitem of a playlist which includes a sub-path having a sub-path type indicating 8, so as to be supplied to the playback device.","(2) Another extent start point information table is stored in clip information that is referenced by a sub-playitem of a playlist which includes a sub-path having a sub-path type indicating 8, so as to be supplied to the playback device.","If the \u201cis_multiangle\u201d flag in the playitem is set to 1, the pair of the extent start point information tables is clip information referred by an angle ID value and clip information referred by a subclip entry ID value, respectively, so as to be supplied to the playback device.",{"@attributes":{"id":"p-0720","num":"0721"},"figref":["FIGS. 51A and 51B","FIG. 51A"]},{"@attributes":{"id":"p-0721","num":"0722"},"figref":["FIG. 51B","FIG. 51B"]},"The \u201cnumber_of_extent_start_point\u201d indicates the number of Extents that belong to the related AV stream file. The extent start point information tables in the clip base information and the clip dependent information in the same pair have the same value in the \u201cnumber_of_extent_start_point\u201d.","The number of \u201cSPN_extent_start\u201ds (SPN_extent_start[0] through SPN_extent_start [number_of_extent_start_point]) is \u201cnumber_of_extent_start_point+1\u201d. Each SPN_extent_start is specified by the Extent identifier [extent_id], and is a 32-bit value that indicates a source packet number of the source packet that corresponds to the extent_idExtent in the AV stream file.","The following explains the extension data of the clip information file. The extension data includes an extension entry map. The extension entry map, as is the case with the basic entry map, is composed of a plurality of entry points. More specifically, in each entry point constituting the extension entry map, a source packet number that indicates the location of the characteristic point in the ATC sequence is associated with a PTS that indicates the location of the characteristic point in the STC sequence. Each entry point further includes: a flag (\u201cis_angle_change\u201d flag) that indicates whether an angle change to the characteristic point is available; and information (I_size) that indicates the size of the intra picture located at the start of GOP. The extension entry map differs from the basic entry map in that the following restrictions are imposed thereon.","When the extension entry map includes entries for the MPEG4-MVC view components, the extension entry map should also include entries for view components in correspondence with the PTSs in the extension entry map.","When there are two clip information files whose respective application types are \u201c1\u201d and \u201c8\u201d and which correspond to a stereoscopic interleaved stream file, the following conditions should be satisfied. That is to say, when an Extent identified by an Extent ID value of clip information with \u201capplication type=1\u201d (clip information of an application type for the primary video stream) includes a source packet that is to be referenced by PTS_EP_Start of the base-view video stream, an Extent identified by the same Extent ID value of clip information with \u201capplication type=8\u201d should include a source packet that is to be referenced by the same PTS_EP_Start_value of the dependent-view video stream.",{"@attributes":{"id":"p-0727","num":"0728"},"figref":["FIG. 52","FIG. 52"]},"When Extent[1] specified by the extent start point with \u201cExtent ID=1\u201d has a source packet [n] with \u201cSPN=n\u201d that is referenced by an entry with \u201cPTS_EP_Start=t\u201d of the base-view video stream, Extent[1] specified by the extent start point with \u201cExtent ID=1\u201d, which is the same Extent ID of the clip information with \u201capplication type=8\u201d, includes a source packet [n] with \u201cSPN=n\u201d that is referenced by an entry with \u201cPTS_EP_Start=t\u201d, which is an entry having the same value in the dependent-view video stream.","As apparent from this, when a source packet located at the start of GOP(i) of the base-view video stream and a source packet located at the start of GOP(i) of the dependent-view video stream belong to the same interleave Extent unit, entries pointing to the source packet located at the start of GOP(i) of the base-view video stream and the source packet located at the start of GOP(i) of the dependent-view video stream are added into each of the basic entry map and the extension entry map. Accordingly, by using both the basic entry map and the extension entry map, it is possible to ensure the continuous reading of the GOP(i) of the base-view video stream and the GOP(i) of the dependent-view video stream.",{"@attributes":{"id":"p-0730","num":"0731"},"figref":"FIG. 53"},"It is presumed here that a source packet [x] with \u201cSPN=x\u201d that is referenced by an entry with \u201cPTS_EP_Start=x\u201d of the base-view video stream exists at the start of a file base Extent that is referenced by an Extent ID=x, and that a source packet [y] with \u201cSPN=y\u201d that is referenced by an entry with \u201cPTS_EP_Start=x\u201d exists at the start of a file dependent Extent that is referenced by an Extent ID=j, wherein \u201ci\u201d and \u201cj\u201d are different from each other.","It cannot be said that Extent [i] specified by the extent start point of the clip dependent with \u201cExtent ID=i\u201d includes a source packet with \u201cSPN=x\u201d that is referenced by an entry with \u201cPTS_EP_Start=x\u201d, which is an entry of the base-view video stream having the same value. Therefore an entry with \u201cPTS_EP_Start=x\u201d cannot be added into the extension entry map.","When a source packet located at the start of GOP(i) of the base-view video stream and a source packet located at the start of GOP(i) of the dependent-view video stream belong to different interleave Extent units, an entry pointing to the source packet located at the start of GOP(i) is not added into any of the basic entry map and the extension entry map. In this case, GOP(i) of the base-view video stream and GOP(i) of the dependent-view video stream are excluded from the access destination of the random access. This prevents the access performance from being degraded.",{"@attributes":{"id":"p-0734","num":"0735"},"figref":"FIG. 54"},"In step S, it is judged whether or not the current output mode is the 3D output mode. When the current output mode is the 2D output mode, a loop constituted from steps S through S is performed.","In step S, the stream file, which is identified by: \u201cxxxxx\u201d described in Clip_information_file_name of the current playitem; and extension \u201cm2ts\u201d, is opened. In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the current playitem are converted into \u201cStart_SPN[i]\u201d and \u201cEnd_SPN[i]\u201d by using the entry map corresponding to the packet ID of the video stream.","In step S, the Extents belonging to the reading range [i] are identified to read the TS packet with PID [i] from the Start_SPN[i] to the End_SPN[i]. In step S, the drive of the recording medium is instructed to continuously read the Extents belonging to the reading range [i].","When the current output mode is the stereoscopic output mode, a loop constituted from steps S through S is performed.","In step S, the stream file, which is identified by: \u201cxxxxx\u201d described in the Clip_information_file_name of the current playitem; and extension \u201cssif\u201d, is opened. In step S, the base-view video stream is assigned to either the left-view or right-view video plane in accordance with the base-view indicator of the current playitem information, and the dependent-view video stream is assigned to the other, namely the left-view or right-view video plane that has not been assigned to the base-view video stream.","In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the current playitem are converted to \u201cStart_SPN[i]\u201d and \u201cEnd_SPN[i]\u201d by using the basic entry map corresponding to the base-view video stream.","In step S, the sub-playitem corresponding to the dependent-view stream is identified. In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the identified sub-playitem are converted into \u201cStart_SPN[j]\u201d and \u201cEnd_SPN[j]\u201d by using the extension entry map corresponding to the dependent-view video stream.","The Extents belonging to the reading range [i] are identified to read the TS packet having the packet ID [i] constituting the base-view video stream from \u201cStart_SPN[i]\u201d to \u201cEnd_SPN[i]\u201d (step S). The Extents belonging to the reading range [j] are identified to read the TS packet having the packet ID [j] from \u201cStart_SPN[j]\u201d to \u201cEnd_SPN[j]\u201d (step S). Following this, in step S, the Extents belonging to the reading ranges [i] and [j] are sorted in the ascending order. In step S, the drive is instructed to continuously read the Extents belonging to the reading ranges [i] and [j] using the sorted addresses. After this, when the source packet sequence is read, in step S, the base-view and dependent-view ATC sequences are restored and supplied to the PID filters for the base view and dependent view.","As described above, according to the present embodiment, when GOPs of the main TS and sub-TS are to be recorded onto the above-described recording medium, entries of the extension entry map point to only dependent-view picture data pieces that correspond to base-view picture data pieces pointed to by entries of the basic entry map as those that are to be played back at the same playback times as the dependent-view picture data pieces.","The picture data pieces pointed to by entries of the basic entry map and the picture data pieces pointed to by entries of the extension entry map make pairs in Extents. Accordingly, when an Extent is accessed via the basic entry map and the extension entry map, it is possible to play back each set of GOPs of the base view and dependent view corresponding to each other as one unit. This makes it possible to solve the problem of playback start delay.","Note that it may be possible to define that each extent include at least one entry point, as shown in . With this definition, it is possible to prevent increase in length of an interval between entry points, thereby suppressing a delay amount for jump playback or the like as shown in .","The present embodiment relates to an improvement for restoring the ATC sequence from the data blocks that constitute the stereoscopic interleaved stream file.  shows how the ATC sequence is restored from the data blocks constituting the stereoscopic interleaved stream file.","The fourth row of  shows a plurality of data blocks that constitute the stereoscopic interleaved stream file. The third row shows the source packet sequence multiplexed in the main TS and the sub-TS.","The second row shows a set of STC sequence  constituting the dependent view, an entry map, and ATC sequence  constituting the dependent view. The first row shows a set of STC sequence  constituting the dependent view, an entry map, and ATC sequence  constituting the dependent view. The arrows extending from the third row to the first and the second rows schematically show that the ATC sequences  and  are restored from the data blocks of the two TSs (main TS and sub-TS) interleaved in the stereoscopic interleaved stream file. These ATC sequences are associated with the STC sequences by the entry map in the clip information.","This completes the description of the recording medium in the present embodiment. In the following, the playback device will be described in detail.","The playback device in the present embodiment has a structure in which the reading unit receives inputs of source packets from two recording mediums. For this purpose, the reading unit includes two drives and two read buffers. The two drives are used to access the two recording mediums, respectively. The two read buffers are used to temporarily store the source packets input from the two drives and output them to the decoder. An ATC sequence restoring unit is provided between the two drives and the two read buffers. The ATC sequence restoring unit separates the ATC sequence constituting the base-view stream and the ATC sequence constituting the dependent-view stream, from the source packets in the interleaved stream file read from one recording medium, and writes the two ATC sequences into the two read buffers, respectively. With this structure, the playback device can process the ATC sequence constituting the base-view video stream and the ATC sequence constituting the dependent-view video stream as if they have been read from different recording mediums, respectively.",{"@attributes":{"id":"p-0751","num":"0752"},"figref":["FIGS. 56A and 56B","FIG. 56A"],"b":["0","1","1","1","2"]},{"@attributes":{"id":"p-0752","num":"0753"},"figref":["FIG. 56B","FIG. 56B"]},{"@attributes":{"id":"p-0753","num":"0754"},"figref":["FIGS. 57A through 57D","FIG. 57A"]},{"@attributes":{"id":"p-0754","num":"0755"},"figref":["FIG. 57B","FIG. 57C"],"b":["0","1","2","1","0","1","2","2"]},{"@attributes":{"id":"p-0755","num":"0756"},"figref":"FIG. 57D"},"As shown in , when the ATC sequence  is composed of the dependent-view data blocks D[], D[], D[], . . . D[n], the source packet numbers , b, b, b, b, . . . bn, which are relative to the dependent-view data blocks D[], D[], D[], . . . D[n] constituting the ATC sequence , are written in the SPN_extent_start in the extent start point information table of the file dependent.","When the ATC sequence  is composed of the base-view data blocks B[], B[], B[], . . . B[n], the number of source packets , a, a, a, a, . . . an, which are relative to the base-view data blocks B[], B[], B[], . . . B[n] constituting the ATC sequence , are written in the SPN_extent_start in the extent start point information table of the file base.",{"@attributes":{"id":"p-0758","num":"0759"},"figref":"FIG. 57C"},"Similarly, when the starting source packet number of the base-view data block B[x] is ax and the starting source packet number of the base-view data block B[x+1] is ax+1, the number of source packets constituting the base-view data block B[x] is \u201c(ax+1)\u2212ax\u201d.","When the starting source packet number of the last base-view data block B[n] in the stereoscopic interleaved stream file is \u201can\u201d and the number of source packets constituting the ATC sequence  is \u201cnumber_of_source_packet\u201d, the number of source packets constituting the base-view data block B[n] is \u201cnumber_of_source_packet-an\u201d.","When the starting source packet number of the last dependent-view data block D[n] in the stereoscopic interleaved stream file is \u201cbn\u201d and the number of source packets constituting the ATC sequence  is \u201cnumber_of_source_packet\u201d, the number of source packets constituting the dependent-view data block D[n] is \u201cnumber_of_source_packet-bn\u201d.",{"@attributes":{"id":"p-0762","num":"0763"},"figref":"FIG. 57D"},"In the stereoscopic interleaved stream file, the starting SPN of D[] is \u201c0\u201d and the starting SPN of B[] is \u201cb\u201d.","The starting SPN of D[] is \u201cb+a\u201d, representing the sum of b (the number of source packets in the preceding dependent-view data block D[]) and a (the number of source packets in the preceding base-view data block B[]).","The starting SPN of B[] is \u201cb+a\u201d (=b+a+b\u2212b), representing the sum of b (the number of source packets in the preceding dependent-view data block D[]) and a (the number of source packets in the preceding base-view data block B[]) and \u201cb\u2212b\u201d (the number of source packets in the preceding dependent-view data block D[]).","The starting SPN of D[] is \u201cb+a\u201d (=b+a+b\u2212b+a\u2212a), representing the sum of b (the number of source packets in the preceding dependent-view data block D[]) and a (the number of source packets in the preceding base-view data block B[]) and \u201cb\u2212b\u201d (the number of source packets in the preceding dependent-view data block D[]) and \u201ca\u2212a\u201d (the number of source packets in the preceding base-view data block B[]).","The starting SPN of B[] is \u201cb+a\u201d (=b+a+b\u2212b+a\u2212a+b\u2212b), representing the sum of b (the number of source packets in the preceding dependent-view data block D[]) and a (the number of source packets in the preceding base-view data block B[]) and \u201cb\u2212b\u201d (the number of source packets in the preceding dependent-view data block D[]) and \u201ca\u2212a\u201d (the number of source packets in the preceding base-view data block B[]) and \u201cb\u2212b\u201d (the number of source packets in the preceding dependent-view data block D[]).",{"@attributes":{"id":"p-0768","num":"0769"},"figref":"FIGS. 58A through 58C","b":["1","2"]},"Suppose that an attempt is made to obtain a source packet number in a stereoscopic interleaved stream file in D[x] with a source packet number \u201cbx\u201d, in the ATC sequence  shown in . n this case, the starting source packet number of D[x] is \u201cbx+ax\u201d, representing the sum of source packet numbers which are relative to data blocks D[], B[], D[], B[], D[], B[], . . . D[x\u22121], B[x\u22121], as shown in .","Suppose that an attempt is made to obtain a source packet number in a stereoscopic interleaved stream file in B[x] with a source packet number \u201cax\u201d, in the ATC sequence  shown in . In this case, the starting source packet number of B[x] is \u201cbx+1+ax\u201d, representing the sum of source packet numbers which are relative to data blocks D[], B[], D[], B[], D[], B[], . . . D[x\u22121], B[x\u22121], D[x], as shown in .",{"@attributes":{"id":"p-0771","num":"0772"},"figref":"FIG. 58C"},"The starting LBN and continuous length of EXT[] and EXT[] are obtained as follows, wherein EXT[] is an Extent of a file base corresponding to B[x], and EXT[] is an Extent of a file dependent corresponding to D[x].","The LBN can be obtained from the starting source packet number of D[x] by converting the source packet into the LBN by performing a calculation ((bx+ax)*192\/2048). Similarly, the LBN can be obtained from the starting source packet number of B[x] by converting the source packet into the LBN by performing a calculation ((bx+1+ax)*192\/2048). Here, the number \u201c192\u201d indicates the number of bytes representing the source packet size, and the number \u201c2048\u201d indicates the number of bytes representing the sector size (logical block size). The LBN of an Extent in the stereoscopic interleaved stream file that is closest to these LBNs can be obtained by using these converted LBNs as \u201cfile_offset\u201d that is an argument of a function \u201cSSIF_LBN(file_offset)\u201d. The function SSIF_LBN is a function that returns an LBN corresponding to the file_offset after tracing the allocation descriptors of the SSIF starting with the file_offset.","Accordingly, the starting LBN of EXT[] is represented as \u201cSSIF_LBN ((bx+ax)*192\/2048)\u201d. Also, the starting LBN of EXT[] is represented as \u201cSSIF_LBN ((bx+1+ax)*192\/2048)\u201d.","On the other hand, the continuous length of EXT[] is represented as \u201cSSIF_LBN ((bx+1+ax)*192\/2048)\u2212SSIF_LBN ((bx+ax)*192\/2048)\u201d. Also, the continuous length of EXT[] is represented as \u201cSSIF_LBN ((bx+1+ax+1)*192\/2048)\u2212SSIF_LBN((bx+1+ax)*192\/2048)\u201d. When file entries indicating these starting LBNs and continuous lengths are generated on a memory, it is possible to obtain file bases and file dependents virtually.","The demultiplexing performed by the two ATC sequences is based on the basic stream selection table and the extension stream selection table described in Embodiment 1. The ATC sequence restoring unit is realized by creating a program that causes the hardware resource to perform the process shown in .  shows the procedure for restoring the ATC sequence.","In step S, the ATC sequence for base-view is set as the ATC sequence , and the ATC sequence for dependent-view is set as the ATC sequence . In step S, the variable \u201cx\u201d is initialized to \u201c1\u201d. The variable \u201cx\u201d specifies a base-view data block and a dependent-view data block. After this, the control enters a loop in which steps S through S are repeatedly performed as follows.","It is judged whether or not a source packet number bx specified by the variable \u201cx\u201d is equal to a source packet number bn specified by the last numeral \u201cn\u201d of the base-view data block (step S). When the result of the judgment is in the negative (No in step S), the source packets from the source packet (bx+ax), which is specified by the source packet number \u201cbx+ax\u201d, to the source packet immediately before the source packet (b+ax) specified by the source packet number \u201cb+ax\u201d are added into the ATC sequence  (step S). Then, the source packets from the source packet (bx+1+ax) to the source packet immediately before the source packet (bx+1+ax+1) are added into the ATC sequence  (step S). And then the variable \u201cx\u201d in incremented (step S). These steps are repeated until it is judged Yes in step S.","When it is judged Yes in step S, as many source packets as the number specified by \u201cnumber_of_sourcepacket-bn\u201d starting from the source packet number \u201cbn\u201d are added into the ATC sequence  (step S). And as many source packets as the number specified by \u201cnumber_of_source_packet-bn\u201d starting from the source packet number \u201can\u201d are added into the ATC sequence  (step S).","After the ATC sequences  and  are restored through the above-described steps, the file base is virtually opened by generating, in the memory, the file entry that indicates the start LBN of the base-view data block and the continuation length (step S). Similarly, the file dependent is virtually opened by generating, in the memory, the file entry that indicates the start LBN of the dependent-view data block and the continuation length (step S).","<Technical Meaning of Opening File Base>","When a random access from an arbitrary time point is to be performed, a sector search within a stream file needs to be performed. The sector search is a process for identifying a source packet number of a source packet corresponding to the arbitrary time point, and reading a file from a sector that contains a source packet of the source packet number.","Since the size of one Extent constituting the stereoscopic interleaved stream file is large, the sector search requires a wide range of searching. In that case, when a random access from an arbitrary time point is performed, it may take a long time to identify the reading-target sector.","This is because, in the interleaved stream file, data blocks constituting the base-view video stream and the dependent-view video stream are disposed in the interleaved manner to constitute one long Extent, and the allocation descriptor of the file entry of the interleaved stream file merely indicates the start address of the long Extent.","In contrast, the file base is composed of a plurality of short Extents, and the start address of each Extent is written in the allocation descriptor. As a result, the sector search requires a narrow range of searching. Thus, when a random access from an arbitrary time point is performed, the reading-target sector can be identified in a short time.","That is to say, since the data blocks constituting the base-view video stream are managed as Extents of the file base, and the start address of the data block is written in the allocation descriptor in the file entry corresponding to the file base, it is possible to quickly reach the sector including the source packet at the target random access position, by starting the sector search from the start address of the Extent that contains the target random access position.","With the above-described structure in which the data blocks constituting the base-view video stream are managed as Extents of the file base, and the start address of each Extent and the continuation length are written in the allocation descriptor in the file entry corresponding to the file base, it is possible to perform a random access from an arbitrary time point in the base-view video stream at a high speed.","More specifically, the sector search is performed as follows. First, the entry map corresponding to the base-view video stream is used to detect a source packet number that is the random access position corresponding to the arbitrary time point.","Next, the extent start point information in the clip information corresponding to the base-view video stream is used to detect an Extent that contains the source packet number that is the random access position.","Further, the allocation descriptor in the file entry corresponding to the file base is referenced to identify the start sector address of the Extent that contains the source packet number that is the random access position. Then a file read is performed by setting a file pointer to the start sector address, and a packet analysis is executed onto the read source packet to identify the source packet with the source packet number that is the random access position. Then the identified source packet is read. With this procedure, the random access to the main TS is executed efficiently. This also applies to the sub-TS.","As described above, according to the present embodiment, Extents of the base-view video stream and the dependent-view video stream in the interleaved stream file are supplied to the demultiplexing unit and the decoder after they are rearranged based on the extent start point information. Thus the decoder and program can treat, as the files virtually existing on the recording medium, the file base storing the base-view video stream and the file dependent storing the dependent-view video stream.","In this structure, the base-view video stream and the dependent-view video stream for the stereoscopic viewing are recorded on the recording medium, while the base-view video stream and the dependent-view video stream can be accessed separately. With this structure, the processing efficiency of the playback device is improved.","In the present embodiment, the following describes a problem of HDMI output, a super-resolution method, and a method of increasing frame rate in order to play back 3D contents stored in a BD-ROM.","(HDMI Output)","Firstly, identification of 3D display\/glasses method is described with reference to . In the case where a plurality of TVs are connected with a 3D displayable player, it is desirable to notify the player, via an I\/F such as HDMI, of whether glasses are necessary for 3D viewing with use of each TV, and if necessary, which type of glasses are necessary. For example, if it is recognizable in a BD player that active shutter glasses are necessary for 3D viewing with use of a TV connected with the BD player, it is possible to program such that before 3D playback is started, a viewer is informed of a message that indicates active shutter glasses are necessary for 3D viewing with use of the connected TV. Accordingly, it is desirable that apparatuses connected with the BD player via E-EDID, InfoFrame, or the like share information for identifying whether glasses are necessary for 3D viewing with use of each TV, and if necessary, which type of glasses are necessary (anaglyph, circular deflection, or active shutter, for example), such that the BD player is informed of the information. If a communication function between each TV and the glasses is prepared, it is possible to appropriately change 3D videos for each user by providing the player with position information of the glasses (specifically, the vertical line extending from the center of the TV screen and the horizontal\/vertical angle of the glasses). In the case where a TV- is a 2D dedicated TV and a TV- is a 3D dedicated TV, it is desirable, as output for the TV-, to extract and output only a right eye video or a left-eye video to be output to the TV-, or display a message indicating that 3D viewing is impossible in the TV- such as a message \u201c3D is being played back in TV-\u201d or a message \u201c3D viewing is impossible in TV-\u201d. As shown in , in the case where a playback video is switched to a 2D video to a 3D video, it is desirable to doubly output only one of a right-eye video and a left-eye video at a 3D video frame rate with no change. This is because change of the frame rate causes delay due to the necessity of authentication of HDMI, for example. However, in the case where a 3D video is displayed, in consideration of that glasses darken the user's eyesight, a video to be displayed in a TV has a high brightness level, and appropriate processing for performing 2D video display might not be performed on the video. In view of this, in the case where only one of a right-eye video and a left-eye video is doubly output like a section \u201c2D dubbing playback\u201d shown in , when a video is output via HDMI, a flag indicating that playback. Accordingly, it is possible to judge, in the TV, a video to be transferred is a 2D video. This enables control such as image processing appropriate for 2D video playback. Next, the correlation between subtitles and menu streams used for BD is described with reference to . Suppose that a player needs to simultaneously perform 2D output and 3D output. Since presentation Graphics (a stream for subtitle, and is abbreviated as \u201cPG\u201d) and Interactive Graphics stream (a stream for menu, and is abbreviated as \u201cIG\u201d) that are used in BD-ROMs are displayed as different patterns, PG and IG each have a different PID and accordingly need to be decoded separately. However, in order to prevent occurrence of the difference between the user's operation while viewing 2D display on a TV and the viewer's operation while viewing 3D viewing on the TV, it is desirable that all pieces of information of 2D stream (C) correspond to all pieces of information of 3D left-eye\/right-eye streams (L,R), except all patterns of 2D stream (C) and display positions thereof and all patterns of 3D left-eye\/right-eye streams (L,R) and display positions thereof. For example, with respect to PG, it is desirable that streams are recorded such that the same subtitle is displayed at the same display time among C, L, and R (that is, only patterns of subtitle and display information are different among C, L, and R). Also, with respect to IG, it is desirable that streams are recorded such that the page structure of a menu, the shift among buttons, button commands in execution, and the like are the same among corresponding C, L, and R (that is, only patterns of subtitle and display information are different among C, L, and R), thereby to realize the same menu operation among C, L, and R. This is necessary to realize that a 2D viewer and a 3D viewer can the same subtitle and menu in the TV- and the TV-, respectively, and menu can be controlled by both the TV- and the TV-. n order to perform simultaneous output, the player separately overlays L, R, and C to generate 2D video and 3D video, as shown in . Although only an IG decoder is shown in , the same applies to a PG decoder. Also, instead of using an L video for 3D for 2D video output, R video may be used.","(Super-Resolution)","Next, processing for realizing more smooth 2D\/3D video display is described, with reference to . In a TV that performs 2D display based on the input in which a left-eye (Ln) video and a right eye (Rn) video alternately succeed, such as L, R, L, R, . . . , either left-eye videos or right-eye videos are displayed, such as L, L, L, . . . or R, R, R, . . . Accordingly, in the case where a right-eye video and a left-eye video are simultaneously filmed according to a conventional art, only the image quality of the video L is increased using a video (L) temporally previous to the video L and a video (L) temporally subsequent to the video L. However, there is a case that a L video is more highly associated with R, R, and R videos for the eye on the other side than L and L videos. Accordingly, even in the case where 2D display is performed, it is possible to further increase the image quality by referring to a video that is not displayed. The method of increasing the image quality is no object here. It is greatly important to use either a right-eye video or a left-eye video that is not displayed (both of the right-eye video and the left-eye video after all) in processing of increasing the image quality while performing 2D display, in order to increase the image quality with a high precision. In this case, although 2D display is performed for the viewer, the player and the TV need to be connected with each other such that 3D display is performed. It is necessary to perform connection authentication as 3D with respect to I\/F such as HDMI to perform switch control to cause the player to output both of L\/R videos. In the case of a TV performing 3D display based on left-eye videos (Ln) and right-eye videos (Rn) such as L, R, L, R, . . . that are sequentially input, it is considered to be effective to use both of L\/R videos is effective in order to increase the image quality of each of the videos. Also, it is possible to estimate, with a high accuracy, a frame to be used for performing increasing the image quality by recording the optical parameter of the L\/R camera (angle between cameras, the focal distance, or the like) in a stream.","(Increase in Frame Rate)","Next, the following describes processing for realizing more smooth 2D\/3D video display, with reference to  again. Especially, when 3D display is realized, right-eye videos and left-eye videos are often alternately displayed in accordance with the time division display method. This tends to cause the user to suffer from eye strain due to the low frame rate for display. Furthermore, in the case where there is a great change amount of video materials among frames due to the recent increase in the screen size of TV, the user tends to feel tired due to the low frame rate. Accordingly, in the case where 3D playback is performed, playback is normally performed at a frame rate such as a frame rate twice or three times the normal frame rate of a video material. However, even if display is performed at a two or three times faster than normal, a video being displayed is the same as the video being displayed at the normal speed. This still remains a problem caused by a change amount of videos among frames in viewing by a large screen. For example, in the case where display is performed at twice faster than normal, left-eye videos and right-eye videos are displayed two sets for each time such as L, R, L, R, L, R, L, R, . . . At the second display of L,R, it is possible to reduce the user's tired feeling by displaying videos (an intermediate video of L and L and an intermediate video of R and R) whose time resolutions have been increased using a high image quality circuit. In other words, it is possible to reduce the user's eye strain in 3D viewing by a large screen by generating an intermediate vide at a sampling frequency higher than a sampling frequency (frame rate) of a video material and performing 3D display.","Note that in the case of a TV that performs stereoscopic display by displaying parallax images for the left eye and right eye in which a viewer needs to wear glasses, when parallax images for the left eye and right eye become larger than a distance between the right eye and the left eye of the viewer, a picture as 3D is not composed. This causes a problem that the user suffers from eye strain and 3D sickness. Accordingly, as a TV display processing, it is desirable to shift the right videos and the left videos as a whole to the right or the left for display, such that parallax images for the left eye and right eye are not misaligned beyond a distance between a right eye and a left eye corresponding to the smallest glasses among commercially available ones. The player may shift the right videos and the left videos as a whole to the right or the left to perform output processing, such that an appropriate parallax difference is displayed by causing the viewer to input or select his age or desired 3D strength on an interactive menu screen of the BD.","The present embodiment describes the production of the recording mediums described in the embodiments so far, namely, the production act of the recording medium.","The recording method of the present embodiment can be realized as a real-time recording in which AV files (stream files) and non-AV files (files other than the stream files) are generated in real time, and are written directly into the AV data recording region and the non-AV data recording region provided in the recording medium. However, not limited to this, the recording method of the present embodiment can be realized as a pre-format recording in which bit streams to be recorded into the volume region are generated in advance, a master disc is generated based on the bit streams, and the master disc is pressed, thereby making possible a mass production of the optical disc. The recording method of the present embodiment is applicable to either the real-time recording or the pre-format recording.","When the recording method is to be realized by the real-time recording technology, the recording device for performing the recording method creates an AV clip in real time, and stores the AV clip into the BD-RE, BD-R, hard disk, or semiconductor memory card.","In this case, the AV clip may be a transport stream that is obtained as the recording device encodes an analog input signal in real time, or a transport stream that is obtained as the recording device partializes a digital input transport stream. The recording device for performing the real-time recording includes: a video encoder for obtaining a video stream by encoding a video signal; an audio encoder for obtaining an audio stream by encoding an audio signal; a multiplexor for obtaining a digital stream in the MPEG2-TS format by multiplexing the video stream, audio stream and the like; and a source packetizer for converting TS packets constituting the digital stream in the MPEG2-TS format into source packets. The recording device stores an MPEG2 digital stream having been converted into the source packet format, into an AV clip file, and writes the AV clip file into the BD-RE, BD-R, or the like. When the digital stream is written, the control unit of the recording device performs a process of generating the clip information and the playlist information in the memory. More specifically, when the user requests a recording process, the control unit creates an AV clip file and an AV clip information file in the BD-RE or the BD-R.","After this, when the starting position of GOP in the video stream is detected from the transport stream which is input from outside the device, or when the GOP of the video stream is created by the encoder, the control unit of the recording device obtains (i) the PTS of the intra picture that is positioned at the start of the GOP and (ii) the packet number of the source packet that stores the starting portion of the GOP, and additionally writes the pair of the PTS and the packet number into the entry map of the clip information file, as a pair of EP_PTS entry and EP_SPN entry. After this, each time a GOP is generated, a pair of EP_PTS entry and EP_SPN entry is written additionally into the entry map of the clip information file. In so doing, when the starting portion of a GOP is an IDR picture, an \u201cis_angle_change\u201d flag having been set to \u201cON\u201d is added to a pair of EP_PTS entry and EP_SPN entry. Also, when the starting portion of a GOP is not an IDR picture, an \u201cis_angle_change\u201d flag having been set to \u201cOFF\u201d is added to a pair of EP_PTS entry and EP_SPN entry.","Further, the attribute information of a stream in the clip information file is set in accordance with the attribute of the stream to be recorded. After the clip and the clip information are generated and written into the BD-RE or the BD-R, the playlist information defining the playback path via the basic entry map in the clip information is generated and written into the BD-RE or the BD-R. When this process is executed with the real-time recording technology, a hierarchical structure composed of the AV clip, clip information, and playlist information is obtained in the BD-RE or the BD-R.","This completes the description of the recording device for performing the recording method by the real-time recording. Next is a description of the recording device for performing the recording method by the pre-format recording.","The recording method by the pre-format recording is realized as a manufacturing method of an optical disc including an authoring procedure.",{"@attributes":{"id":"p-0809","num":"0810"},"figref":["FIGS. 64A and 64B","FIG. 64A"]},"In the authoring step S, a bit stream representing the whole volume region of the optical disc is generated.","In the signing step S, a request for signature is made to the AACS LA to manufacture the optical disc. More specifically, a portion is extracted from the bit stream is sent to the AACS LA. Note that the AACS LA is an organization for managing the license of the copyrighted work protection technologies for the next-generation digital household electric appliances. The authoring sites and mastering sites are licensed by the AACS LA, where the authoring sites perform authoring of optical discs by using authoring devices, and the mastering sites execute mastering by using mastering devices. The AACS LA also manages the medium keys and invalidation information. The AACS LA signs and returns the portion of the bit stream.","In the medium key obtaining step S, a medium key is obtained from the AACS LA. The medium key provided from the AACS LA is not fixed. The medium key is updated to a new one when the number of manufactured optical discs reaches a certain number. The update of the medium key makes it possible to exclude certain makers or devices, and to invalidate an encryption key by using the invalidation information even if the encryption key is cracked.","In the medium key encrypting step S, a key used for encrypting a bit stream is encrypted by using the medium key obtained in the medium key obtaining step.","In the physical format step S, the physical formatting of the bit stream is performed.","In the identifier embedding step S, an identifier, which is unique and cannot be detected by ordinary devices, is embedded, as electronic watermark, into the bit stream to be recorded on the optical disc. This prevents mass production of pirated copies by unauthorized mastering.","In the mastering step S, a master disc of the optical disc is generated. First, a photoresist layer is formed on the glass substrate, a laser beam is radiated onto the photoresist layer in correspondence with desired grooves or pits, and then the photoresist layer is subjected to the exposure process and the developing process. The grooves or pits represent values of the bits constituting the bit stream that has been subjected to the eight-to-sixteen modulation. After this, the master disc of the optical disc is generated based on the photoresist whose surface has been made uneven by the laser cutting in correspondence with the grooves or pits.","In the replication step S, copies of the optical disc are produced by a mass production by using the master disc of the optical disc.",{"@attributes":{"id":"p-0818","num":"0819"},"figref":["FIG. 64B","FIG. 64A","FIG. 64B"],"b":["205","207","209"]},"Next, the authoring step is explained.",{"@attributes":{"id":"p-0820","num":"0821"},"figref":"FIG. 65"},"In step S, the reel sets of the main TS and sub-TS are defined. A \u201creel\u201d is a file which stores the material data of an elementary stream. In the authoring system, the reels exist on a drive on a local network. The reels are data representing, for example, L and R images shot by a 3D camera, audio recorded at the shooting, audio recorded after the shooting, subtitles for each language, and menus. A \u201creel set\u201d is a group of links to the material files, representing a set of elementary streams to be multiplexed into one transport stream. In this example, a reel set is defined for each of the main TS and the sub-TS.","In step S, the prototypes of playitem and sub-playitem are defined, and the prototypes of the main path and sub-path are defined by defining a playback order of playitem and sub-playitem. The prototype of the playitem can be defined by receiving, via a GUI, a specification of a reel that is permitted to be played back by a targeted playitem in the monoscopic output mode, and a specification of In_Time and Out_Time. The prototype of the sub-playitem can be defined by receiving, via a GUI, a specification of a reel that is permitted to be played back by a playitem corresponding to a targeted sub-playitem in the stereoscopic output mode, and a specification of In_Time and Out_Time.","For the specification of a reel to be permitted to be played back, a GUI is provided to make it possible to check a check box corresponding to, among the links to the material files in the reel set, a link to a material file permitted to be played back. With this GUI, numeral input columns are displayed in correspondence with the reels. With use of the numeral input columns, the priority of each reel is received, and based on this, the priorities of the reels are determined. With the setting of the reels permitted to be played back and the setting of the priorities, the stream selection table and the extension stream selection table are generated.","The specification of In_Time and Out_Time is performed when the recording device executes the process in which the time axis of the base-view video stream or the dependent-view video stream is displayed as a graphic on the GUI, a slide bar is moved on the graphic of the time axis, and specification of a positional setting of the slide bar is received from the user.","The definition of the playback order of the playitem and the sub-playitem is realized by the following process: a picture at In_Time of the playitem is displayed as a thumbnail on the GUI, and the recording device receives from the user an operation made onto the thumbnail to set the playback order.","In step S, a plurality of elementary streams are obtained by encoding the material files specified by the reel sets. The plurality of elementary streams include the base-view video stream and the dependent-view video stream, and the audio stream, PG stream, and IG stream that are to be multiplexed with the base-view video stream and the dependent-view video stream.","In step S, one main TS is obtained by multiplexing thereinto the base-view video stream and an elementary stream which, among the elementary streams obtained by the encoding, belongs to same reel set as the base-view video stream.","In step S, one sub-TS is obtained by multiplexing thereinto the dependent-view video stream and an elementary stream which, among the elementary streams obtained by the encoding, belongs to the same reel set as the dependent-view video stream.","In step S, the prototype of the clip information file is created based on the parameters having been set during the encoding and multiplexing.","In step S, the playlist information is defined by generating the playitem information and the sub-playitem information based on the prototype of the playitem, and then generating the main path information and the sub-path information by defining the playback order based on the playitem information and the sub-playitem information.","In the generation of the playitem information, the stream selection table is generated in the playitem information so that, among the elementary streams multiplexed in the main TS, elementary streams that are defined, in the basic structure of the playitem, to be played back in the monoscopic output mode are set to \u201cplayable\u201d. Also, to define the playback section in the base-view video stream, the In_TIme and Out_TIme having been defined by the above-described editing are written in the playitem information.","In the generation of the sub-playitem information, the extension stream selection table is generated in the extension data of the playlist information so that, among the elementary streams multiplexed in the sub-main TS, elementary streams that are defined, in the basic structure of the playitem, to be played back in the stereoscopic output mode are set to \u201cplayable\u201d. The playitem information and the sub-playitem information are defined based on information in the clip information file, and thus are set based on the prototype of the prototype of the clip information file.","In step S, the main TS, sub-TS, prototype of the clip information file, and prototype of the playlist information are converted into a directory file group in a predetermined application format.","Through the above-described processes, the main TS, sub-TS, clip information, playitem information, and sub-playitem information are generated. Then the main TS and the sub-TS are converted into respective independent stream files, the clip information is converted into the clip information file, and the playitem information and the sub-playitem information are converted into the playlist information file. In this way, a set of files to be recorded onto the recording medium are obtained.","After this, when the video stream encoding step is executed, the plane offset value and the offset direction information obtained the above-described conversion are written into the metadata of each GOP. In this way, the offset sequence can be generated in the encoding process.",{"@attributes":{"id":"p-0836","num":"0837"},"figref":"FIG. 66"},"In step S, the recording device generates the file entry in the memory of the recording device by creating \u201cxxxxx.ssif\u201d. In step S, it is judged whether the continuous free sector regions have been ensured. When the continuous free sector regions have been ensured, the control proceeds to step S in which the recording device writes the source packet sequence constituting the dependent-view data block into the continuous free sector regions as much as EXT[]. After this, steps S through S are executed. When it is judged in step S that the continuous free sector regions have not been ensured, the control proceeds to step S in which the exceptional process is performed, and then the process ends.","The steps S through S constitute a loop in which the process of steps S-S and S is repeated until it is judged \u201cNO\u201d in step S.","In step S, the recording device writes the source packet sequence constituting the base-view data block into the continuous free sector regions as much as EXT[]. In step S, it adds, into the file entry, the allocation identifier that indicates the start address of the source packet sequence and continuation length, and registers it as an Extent. In connection with this, it writes, into the metadata in the clip base information and the clip dependent information, the Extent start point information that indicates the start source packet number thereof.","The step S defines the condition for ending the loop. In step S, it is judged whether or not there is a non-written source packet in the base-view and dependent-view data blocks. When it is judged that there is a non-written source packet, the control proceeds to step S to continue the loop. When it is judged that there is no non-written source packet, the control proceeds to step S.","In step S, it is judged whether or not there are continuous sector regions. When it is judged that there are continuous sector regions, the control proceeds to step S. When it is judged that there are no continuous sector regions, the control returns to step S.","In step S, \u201cxxxxx.ssif\u201d is closed and the file entry is written onto the recording medium. In step S, \u201cxxxxx.m2ts\u201d is created and the file entry of \u201cxxxxx.m2ts\u201d is generated in the memory. In step S, the allocation descriptor that indicates the continuation length and the start address of Extent of the base-view data block unique to the file 2D is added into the file entry of \u201cxxxxx.m2ts\u201d. In step S, \u201cxxxxx.m2ts\u201d is closed and the file entry is written.","In step S, it is judged whether or not there is a long jump occurrence point in the range of \u201cEXTss+EXT2D\u201d. In the present example, it is presumed that the long jump occurrence point is a boundary between layers. When it is judged that there is a long jump occurrence point in the range of \u201cEXTss+EXT2D\u201d, the control proceeds to step S in which a copy of the base-view data block is created, and base-view data blocks B[i]ss and B[i]2D are written into the region immediately before the long jump occurrence point, and then the control proceeds to step S. These become Extents of the file 2D and Extents of the file base.","The following explains specific values of EXT2D, EXT[], EXT[], and EXTss[n].","The lowermost value of EXT2D is determined so that, when a playback in the 2D output mode is performed, a buffer under flow does not occur in the read buffer of the playback device during a jump period from each base-view data block to the next base-view data block.","The lowermost value of EXT2D is represented by the following expression for Condition 1, when it takes Tjump2D(n) of time when a jump from the nbase-view data block to the (n+1)base-view data block is made, each base-view data block is read into the read buffer at a speed of Rud2D, and the base-view data block is transferred from the read buffer to the video decoder at an average speed of Rbext2D.\n\n[Lowermost value of 2]\u2267(22)\/(22)\u00d7jump2()\u2003\u2003<Condition 1>\n","It is presumed here that an Extent corresponding to a base-view data block B[n]ss is represented as EXT[]. In this case, the lowermost value of EXT[] is determined so that, when a playback in the B-D presentation mode is performed, a buffer under flow does not occur in the double buffer during a jump period from each base-view data block to the next dependent-view data block, and during a jump period from the dependent-view data block to the next base-view data block.","In the present example, the double buffer is composed of a read buffer  and a read buffer . The read buffer  is the same as the read buffer provided in the 2D playback device.","It is presumed here that, when a playback in the B-D presentation mode is performed, it takes Tfjump3D(n) of time when a jump from the nbase-view data block to the pdependent-view data block is made, and it takes TBjump3D(n) of time when a jump from the pdependent-view data block to the (n+1)base-view data block is made.","It is further presumed that, each base-view data block is read into the read buffer  at a speed of Rud3D, each dependent-view data block is read into the read buffer  at the speed of Rud3D, and the base-view data block is transferred from the read buffer  to the video decoder at an average speed of Rbext3D. Then the lowermost value of EXT[] is represented by the following expression for Condition 2. The continuation length of the big Extents is set to a value that is equal to or higher than the lowermost value.\n\n[Lowermost value of 1[]]\u2267(33)\/(33)\u00d7(jump3()+2[]\/(3jump3()))\u2003\u2003<Condition 2>\n","The lowermost value of EXT is determined so that, when a playback in the B-D presentation mode is performed, a buffer under flow does not occur in the double buffer of the playback device during a jump period from each dependent-view Extent to the next base-view data Extent, and during a jump period from the base-view Extent to the next dependent-view Extent.","The lowermost value of EXT[] is represented by the following expression for Condition 3, when it takes Tfjump3D(n+1) of time when a jump from the (n+1)base-view data block to the (p+1)dependent-view data block is made, and the dependent-view data block is transferred from the read buffer  to the decoder at an average speed of Rdext3D.\n\n[Lowermost value of 2[]]\u2267(33)\/(33)\u00d7(jump3()+2[1]\/(3jump3(1)))\u2003\u2003<Condition 3>\n","<Specific Values of EXTSS>","When a jump from a reading of an Extent to the next Extent is to be made, the buffer should be occupied by a sufficient amount of data immediately before the jump. Accordingly, when a stereoscopic interleaved stream file is to be read, the read buffer needs to store one Extent, and occurrence of a buffer under flow should be avoided.","However, the \u201cEXTSS\u201d needs to be determined based not only on \u201cTjump\u201d, a time period taken when a jump from an Extent to another Extent, but on \u201cTdiff\u201d. It should be noted here that the \u201cTdiff\u201d represents a delay time that occurs in connection with a preloading of dependent-view data blocks in EXTss and a preloading of dependent-view data blocks in EXTssnext. The following further explains the meaning of Tdiff. When a stereoscopic interleaved stream file is read while the starting dependent-view data block is being preloaded.","In EXTss, the playback is delayed as much as the time period required for preloading the dependent-view data block. Here, the time period required for preloading the starting dependent-view data block in EXTss is referred to as \u201cdelay period\u201d because the playback is delayed as much as the period.","On the other hand, in EXTssnext, immediately after a jump from EXTss to EXTssnext is made, the starting dependent-view data block is preloaded. Thus the playback by the video decoder is allowed to be delayed for the period of the preloading. Therefore the time period in which the starting dependent-view data block is preloaded in the playback of EXTssnext is referred to as \u201cgrace period\u201d because the start of playback by the video decoder is allowed to be delayed for the period.","In view of this, a value of Tdiff is obtained by subtracting the delay period from the grace period of the dependent-view data block. More specifically, the value Tdiff is calculated using the following expression.\n\n[((11next)\u221211)\u00d71000\u00d7872]\n","In the above expression, Tdiff means a difference between the time period for reading SstEXT[]EXTss and the time period for reading SstEXT[]EXTSSnext; SstEXT[]EXTss represents the size of EXT[] which is located at the start of EXTss; SstEXT[]EXTssnext represents the size of EXT[] which is located at the start of EXTssnext. EXTssnext is an Extent in the stereoscopic interleaved stream file, is located immediately after EXTss, and is played back seamlessly with EXTss.","With use of Tdiff and Tjump, which is a time period required for jump to EXTssnext, Sextss, which is the minimum Extent size based on the average bit rate in each Extent, is calculated as a value satisfying the following Condition 4.\n\nByte]\u2267[(jump+72)\/(1000\u00d78)]\u00d7(192)\/(72\u00d7188\u2212192)]\u2003\u2003<Condition 4>\n","In the above Condition 4, Rud represents a data rate in transfer from the BD-ROM drive in the stereoscopic output mode.","Rextss represents an average bit rate in EXTss and is obtained using the following expressions.\n\n188\u00d78\/(27000000)]\n\nstartnext\u2212start\n\nlaststart(27000000\u00d7188\u00d78\/min(1,2))\n","In the above expressions, ATCDextss represents the ATC period of EXTss.","ATCstart_EXTss represents the minimum ATC value specified by the ATC field of the source packet sequence in EXTss.","ATCstart_EXTssnext represents the minimum ATC value specified by the ATC field of the source packet sequence in EXTssnext.","ATClast_EXTss represents the maximum ATC value specified by the ATC field of the source packet sequence in EXTss.","Nsp represents the number of source packets which are included in the main TS and sub-TS and have ATC values corresponding to ATCs in the range of ATCDexss.","Rts represents a value of the TS recording rate in the main TS, and its maximum value is 48 Mbps.","Rts represents a value of the TS recording rate in the sub-TS, and its maximum value is 48 Mbps.","When two playitems are to be played back continuously, EXTss includes the first byte of data in the ATC sequence that is used by the previous playitem (Playitem ).\n\n","EXTss includes byte of data in the ATC sequence that is used by the current playitem (Playitem ).\n\n","<Detailed Recording of Base-view Data Blocks and Dependent-view Data Blocks>","When GOPs of the main TS and sub-TS are to be recorded onto a recording medium, entries of the extension entry map point to only dependent-view picture data pieces that correspond to base-view picture data pieces pointed to by entries of the basic entry map as those that are to be played back at the same playback times as the dependent-view picture data pieces.","To realize such pointing, the recording process is performed as follows.","In the recording process, an attempt is made so that a boundary between a dependent-view data block and a base-view data block matches a boundary between a dependent-view GOP and a base-view GOP. More specifically, in this attempt, the access unit delimiter of the starting video access unit of GOP(i) in the sub-TS is divided as a boundary between dependent-view data blocks, and the access unit delimiter of the starting video access unit of GOP(i) in the main TS is divided as a boundary between base-view data blocks. In this division, the restriction on the Extent length described earlier should be satisfied.","In this division, when either a base-view data block or a dependent-view data block does not satisfy the restriction that the Extent should have a length that does not cause an underflow in a double buffer in the playback device, a padding packet is inserted either into immediately before the access unit delimiter of the starting video access unit of GOP(i) in the sub-TS, or into immediately before the access unit delimiter of the starting video access unit of GOP(i) in the main TS, and then the above-described attempt is made again so that the boundaries match.","When the boundaries match successfully by the above-described method, an entry pointing to a source packet number of a source packet storing the access unit delimiter of the starting access unit of the dependent-view GOP is added into the extension entry map. Also, an entry pointing to a source packet number of a source packet storing the access unit delimiter of the starting access unit of the base-view GOP is added into the base entry map, as well.","When the boundaries do not match even if the padding packet is inserted, and the source packet storing the access unit delimiter of the starting access unit of the dependent-view GOP is in the middle of the dependent-view data block, an entry pointing to the source packet is not added into the extension entry map. Similarly, when the source packet storing the access unit delimiter of the starting access unit of the base-view GOP is in the middle of the base-view data block, an entry pointing to the source packet is not added into the extension entry map.","When such entries are excluded from the extension entry map in this way, it is ensured that pairs of a base view and a dependent view are pointed to by the entries of the basic entry map and the extension entry map.","The process of recording base-view data blocks and dependent-view data blocks and then generating the entry maps is realized by a process in which the starts of GOPs are detected from the recorded stereoscopic interleaved stream file, and entries pointing to the detected starts of GOPs are added into the entry maps. The following describes the procedure for generating the basic and extension entry maps by detecting the starts of GOPs and adding the entries, with reference to .",{"@attributes":{"id":"p-0881","num":"0886"},"figref":"FIG. 67"},"In step S, forms of the basic entry map and the extension entry map are generated in the memory, and the control proceeds to a loop composed of steps S through S. In this loop, the variable x identifies a GOP. The loop is executed as follows. The variable x is initialized to 1 (step S). The start of GOP(x) is identified (step S). An SPN(x) corresponding to the starting PTS(x) of the GOP is identified (step S). After this, judgments are performed in steps S and S. In step S, it is judged whether or not SPN(x) is the start of EXT[]. When it is judged that SPN(x) is not the start of EXT[], steps S- are skipped. When it is judged that SPN(x) is the start of EXT[], the control proceeds to step S in which EXT[], whose start SPN(y) corresponds to PTS(x), is identified.","In step S, it is judged whether or not variable \u201ci\u201d that identifies EXT[] matches variable \u201cj\u201d that identifies EXT[]. When it is judged that variable \u201ci\u201d does not match variable \u201cj\u201d, the steps after this are skipped. When it is judged that variable \u201ci\u201d matches variable \u201cj\u201d, EP_entry(x) pointing to a pair of PTS(x) and SPN(x) is added into the basic entry map (step S), and EP_entry(x) pointing to a pair of PTS(x) and SPN(y) is added into the extension entry map (step S).","In step S, it is judged whether or not variable x specifies the last GOP. When it is judged that variable x does not specify the last GOP, variable x is incremented, and the control moves to step S.","<Creation of Index Table>","The index table described in Embodiment 3 can be created in the following manner. When the base-view video stream, dependent-view video stream, clip information file, and playlist information file are generated in accordance with the flow chart shown in , the display frequencies of playlists to be recorded on the recording medium are identified. Of these display frequencies, the resolution\/display frequency of the playlist to be used in the first play title, or the resolution\/display frequency of the playlist of the title specified by the title number in the range from 0 to 999 is set in the video format information and the frame rate information in the BDMV application information in the index table. With this structure, the resolution\/display frequency to be applied to the display of the playlist is set in the index table.",{"@attributes":{"id":"p-0887","num":"0892"},"figref":"FIG. 68","b":["701","702"]},"In step S, a BD-J object is generated. In step S, a movie object is described with use of a command that instructs playback of a playlist. In step S, an index table is generated by describing correspondence between title numbers and BD-J object or movie object. In step S, a playlist to be the first play title is selected. In step S, BDMV application information, which indicates the video format and video rate of the playlist in the first play title, is generated. In step S, an index table that includes the title index and the BDMV application information is generated. In step S, BD-J object, the BD-J application, movie object, and index table are written onto the recording medium.","The following explains the recording medium that is generated by the above-described recording.",{"@attributes":{"id":"p-0890","num":"0895"},"figref":"FIG. 69"},"The first row of  shows one example of a multi-layered optical disc. The second row shows tracks in the horizontally extended format though they are in reality formed spirally in the recording layers. These spiral tracks in the recording layers are treated as one continuous volume region. The volume region is composed of a lead-in region, recording layers of recording layers  through , and a lead-out region, where the lead-in region is located at the inner circumference, the lead-out region is located at the outer circumference, and the recording layers of recording layers  through  are located between the lead-in region and the lead-out region. The recording layers of recording layers  through  constitute one consecutive logical address space.","The volume region is sectioned into units in which the optical disc can be accessed, and serial numbers are assigned to the access units. The serial numbers are called logical addresses. Data is read from the optical disc by specifying a logical address. Here, in the case of a read-only disc such as the BD-ROM, basically, sectors with consecutive logical addresses are also consecutive in the physical disposition on the optical disc. That is to say, data stored in the sectors with consecutive logical addresses can be read without performing a seek operation. However, at the boundaries between recording layers, consecutive data reading is not possible even if the logical addresses are consecutive. It is thus presumed that the logical addresses of the boundaries between recording layers are registered in the recording device in advance.","In the volume region, file system management information is recorded immediately after the lead-in region. Following this, a partition region managed by the file system management information exists. The file system is a system that expresses data on the disc in units called directories or files. In the case of the BD-ROM, the file system is a UDF (Universal Disc Format). Even in the case of an everyday PC (personal computer), when data is recorded with a file system called FAT or NTFS, the data recorded on the hard disk under directories and files can be used on the computer, thus improving usability. The file system makes it possible to read logical data in the same manner as in an ordinary PC, using a directory and file structure.","The fourth row shows how the regions in the file system region managed by the file system are assigned. As shown in the fourth row, a non-AV data recording region exists on the innermost circumference side in the file system region; and an AV data recording region exists immediately following the non-AV data recording region. The fifth row shows the contents recorded in the non-AV data recording region and the AV data recording region. As shown in the fifth row, Extents constituting the AV files are recorded in the AV data recording region; and Extents constituting non-AV files, which are files other than the AV files, are recorded in the non-AV data recording region.",{"@attributes":{"id":"p-0895","num":"0900"},"figref":"FIG. 70"},"The BDMV directory is a directory in which data such as AV content and management information used in the BD-ROM are recorded. Five sub-directories called \u201cPLAYLIST directory,\u201d \u201cCLIPINF directory\u201d, \u201cSTREAM directory\u201d, \u201cBDJO directory\u201d, \u201cJAR directory\u201d, and \u201cMETA directory\u201d exist below the BDMV directory. Also, two types of files (i.e. index.bdmv and MovieObject.bdmv) are arranged under the BDMV directory.","A file \u201cindex.bdmv\u201d (the file name \u201cindex.bdmv\u201d is fixed) stores an index table.","A file \u201cMovieObject.bdmv\u201d (the file name \u201cMovieObject. bdmv\u201d is fixed) stores one or more movie objects. The movie object is a program file that defines a control procedure to be performed by the playback device in the operation mode (HDMV mode) in which the control subject is a command interpreter. The movie object includes one or more commands and a mask flag, where the mask flag defines whether or not to mask a menu call or a title call when the call is performed by the user onto the GUI.","A program file (XXXXX.bdjo---\u201cXXXXX\u201d is variable, and the extension \u201cbdjo\u201d is fixed) to which an extension \u201cbdjo\u201d is given exists in the BDJO directory. The program file stores a BD-J object that defines a control procedure to be performed by the playback device in the BD-J mode.","A substance of such a Java\u2122 application is a Java\u2122 archive file (YYYYY.jar) stored in the JAR directory under the BDMV directory.","An application may be, for example, a Java\u2122 application that is composed of one or more xlet programs having been loaded into a heap memory (also called work memory) of a virtual machine. The application is constituted from the xlet programs having been loaded into the work memory, and data.","In the \u201cPLAYLIST directory\u201d, a playlist information file (\u201cxxxxx.mpls\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cmpls\u201d is fixed) to which an extension \u201cmpls\u201d is given exists.","In the \u201cCLIPINF directory\u201d, a clip information file (\u201cxxxxx.clpi\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cclpi\u201d is fixed) to which an extension \u201cclpi\u201d is given exists.","The Extents constituting the files existing in the directories explained up to now are recorded in the non-AV data region.","The \u201cSTREAM directory\u201d is a directory storing a transport stream file. In the \u201cSTREAM directory\u201d, a transport stream file (\u201cxxxxx.m2ts\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cm2ts\u201d is fixed) to which an extension \u201cm2ts\u201d is given exists.","The above-described files are formed on a plurality of sectors that are physically continuous in the partition region. The partition region is a region accessed by the file system and includes an \u201cregion in which file set descriptor is recorded\u201d, \u201cregion in which end descriptor is recorded\u201d, \u201cROOT directory region\u201d, \u201cBDMV directory region\u201d, \u201cJAR directory region\u201d, \u201cBDJO directory region\u201d, \u201cPLAYLIST directory region\u201d, \u201cCLIPINF directory region\u201d, and \u201cSTREAM directory region\u201d. The following explains these regions.","The \u201cfile set descriptor\u201d includes a logical block number (LBN) that indicates a sector in which the file entry of the ROOT directory is recorded, among directory regions. The \u201cend descriptor\u201d indicates an end of the file set descriptor.","Next is a detailed description of the directory regions. The above-described directory regions have an internal structure in common. That is to say, each of the \u201cdirectory regions\u201d is composed of a \u201cfile entry\u201d, \u201cdirectory file\u201d, and \u201cfile recording region of lower file\u201d.","The \u201cfile entry\u201d includes a \u201cdescriptor tag\u201d, an \u201cICB tag\u201d, and an \u201callocation descriptor\u201d.","The \u201cdescriptor tag\u201d is a tag identifying, as a \u201cfile entry\u201d, the file entry which includes the descriptor tag itself.","The \u201cICB tag\u201d indicates attribute information concerning the file entry itself.","The \u201callocation descriptor\u201d includes a logical block number (LBN) that indicates a recording position of the directory file. Up to now, the file entry has been described. Next is a detailed description of the directory file.","The \u201cdirectory file\u201d includes a \u201cfile identification descriptor of lower directory\u201d and \u201cfile identification descriptor of lower file\u201d.","The \u201cfile identification descriptor of lower directory\u201d is information that is referenced to access a lower directory that belongs to the directory file itself, and is composed of identification information of the lower directory, the length of the directory name of the lower directory, a file entry address that indicates the logical block number of the block in which the file entry of the lower directory is recorded, and the directory name of the lower directory.","The \u201cfile identification descriptor of lower file\u201d is information that is referenced to access a file that belongs to the directory file itself, and is composed of identification information of the lower file, the length of the lower file name, a file entry address that indicates the logical block number of the block in which the file entry of the lower file is recorded, and the file name of the lower file.","The file identification descriptors of the directory files of the directories indicate the logical blocks in which the file entries of the lower directory and the lower file are recorded. By tracing the file identification descriptors, it is therefore possible to reach from the file entry of the ROOT directory to the file entry of the BDMV directory, and reach from the file entry of the BDMV directory to the file entry of the PLAYLIST directory. Similarly, it is possible to reach the file entries of the JAR directory, BDJO directory, CLIPINF directory, and STREAM directory.","The \u201cfile recording region of lower file\u201d is a region in which the substance of the lower file that belongs to a directory. A \u201cfile entry\u201d of the lower entry and one or more \u201cExtents\u201d are recorded in the \u201cfile recording region of lower file\u201d.","The stream file that constitutes the main feature of the present application is a file recording region that exists in the directory region of the directory to which the file belongs. It is possible to access the transport stream file by tracing the file identification descriptors of the directory files, and the allocation descriptors of the file entries.","The present embodiment describes the internal structure of a 2D\/3D playback device that has integrated functions of the playback devices having been described in the embodiments so far.",{"@attributes":{"id":"p-0920","num":"0925"},"figref":"FIG. 71","b":["1","2","2","3","4","5","5","6","7","203","11","12","13","14","15","16","17","18","19"],"i":["a","b","a","b"]},"The BD-ROM drive , like a 2D playback device, reads out data from a BD-ROM disc based on a request from the playback control unit . AV clips read from the BD-ROM disc are transferred to the read buffer or ","When a 3D image is to be played back, the playback control unit  issues a read request that instructs to read the base-view data block and the dependent-view data block alternately in units of Extents. The BD-ROM drive  reads out Extents constituting the base-view data block into the read buffer , and reads out Extents constituting the dependent-view data block into the read buffer . When a 3D image is to be played back, the BD-ROM drive  should have a higher reading speed than the BD-ROM drive for a 2D playback device, since it is necessary to read both the base-view data block and the dependent-view data block simultaneously.","The read buffer is a buffer that may be realized by, for example, a dual-port memory, and stores the data of the base-view data blocks read by the BD-ROM drive .","The read buffer is a buffer that may be realized by, for example, a dual-port memory, and stores the data of the dependent-view data blocks read by the BD-ROM drive .","The switch  is used to switch the source of data to be input into the read buffers, between the BD-ROM drive  and the local storage .","The system target decoder  decodes the streams by performing the demultiplexing process onto the source packets read into the read buffer and the read buffer ","The plane memory set is composed of a plurality of plane memories. The plane memories include those for storing a left-view video plane, a right-view video plane, a secondary video plane, an interactive graphics plane (IG plane), and a presentation graphics plane (PG plane).","The plane overlay unit performs the plane overlaying explained the embodiments so far. When the image is to be output to the television or the like, the output is conformed to the 3D system. When it is necessary to play back the left-view image and the right-view image alternately by using the shutter glasses, the image is output as it is. When the image is to be output to, for example, the lenticular television, a temporary buffer is prepared, the left-view image is first transferred into the temporary buffer, and the left-view image and the right-view image are output simultaneously after the right-view image is transferred.","The HDMI transmission\/reception unit  executes the negotiation phase described in Embodiment 1 in conformance with, for example, the HDMI standard, where HDMI stands for High Definition Multimedia Interface. In the negotiation phase, the HDMI transmission\/reception unit  can receive, from the television, (i) information indicating whether or not it supports a stereoscopic display, (ii) information regarding resolution for a monoscopic display, and (iii) information regarding resolution for a stereoscopic display.","The playback control unit  includes a playback engine and a playback control engine . When it is instructed from the program executing unit  or the like to play back a 3D playlist, the playback control unit  identifies a base-view data block of a playitem that is the playback target among the 3D playlist, and identifies a dependent-view data block of a sub-playitem in the 3D sub-path that should be played back in synchronization with the playitem. After this, the playback control unit  interprets the entry map of the corresponding clip information file, and requests the BD-ROM drive  to alternately read the Extent of the base-view data block and the Extent of the dependent-view data block, starting with the playback start point, based on the Extent start type that indicates which of an Extent constituting the base-view video stream and an Extent constituting the dependent-view video stream is disposed first. When the playback is started, the first Extent is read into the read buffer or the read buffer completely, and then the transfer from the read buffer and the read buffer to the system target decoder  is started.","The playback engine executes AV playback functions. The AV playback functions in the playback device are a group of traditional functions succeeded from CD and DVD players. The AV playback functions include: Play, Stop, Pause On, Pause Off, Still Off, Forward Play (with specification of the playback speed by an immediate value), Backward Play (with specification of the playback speed by an immediate value), Audio Change, Picture Data Change for Secondary Video, and Angle Change.","The playback control engine performs playlist playback functions in response to function calls from the command interpreter which is the main operating body in the HDMV mode, and from the Java platform which is the main operating body in the BD-J mode. The playlist playback functions mean that, among the above-described AV playback functions, the Play and Stop functions are performed in accordance with the current playlist information and the current clip information, where the current playlist information constitutes the current playlist.","The memory is a memory for storing the current playlist information and the current clip information. The current playlist information is a piece of playlist information that is currently a target of processing, among a plurality of pieces of playlist information that can be accessed from the BD-ROM, built-in medium drive, or removable medium drive. The current clip information is a piece of clip information that is currently a target of processing, among a plurality of pieces of clip information that can be accessed from the BD-ROM, built-in medium drive, or removable medium drive.","The register set  is a player status\/setting register set that is a set of registers including a general-purpose register for storing arbitrary information that is to be used by contents, as well as the playback status register and the playback setting register having been described in the embodiments so far.","The program executing unit  is a processor for executing a program stored in a BD program file. Operating according to the stored program, the program executing unit  performs the following controls: (1) instructing the playback control unit  to play back a playlist; and (2) transferring, to the system target decoder, PNG\/JPEG that represents a menu or graphics for a game so that it is displayed on the screen. These controls can be performed freely in accordance with construction of the program, and how the controls are performed is determined by the process of programming the BD-J application in the authoring process.","The program memory  stores a current dynamic scenario which is provided to the command interpreter that is an operator in the HDMV mode, and to the Java\u2122 platform that is an operator in the BD-J mode. The current dynamic scenario is a current execution target that is one of Index.bdmv, BD-J object, and movie object recorded in the BD-ROM. The program memory  includes a heap memory.","The heap memory is a stack region for storing byte codes of the system application, byte codes of the BD-J application, system parameters used by the system application, and application parameters used by the BD-J application.","The HDMV module  is provided with a command interpreter, and controls the HDMV mode by decoding and executing the navigation command which constitutes the movie object.","The BD-J platform  is a Java\u2122 platform that is an operator in the BD-J mode, and is fully implemented with Java\u2122 2 Micro_Edition (J2ME) Personal Basis Profile (PBP 1.0), and Globally Executable MHP specification (GEM1.0.2) for package media targets. The BD-J platform  is composed of a class loader, a byte code interpreter, and an application manager.","The class loader is one of system applications, and loads a BD-J application by reading byte codes from the class file existing in the JAR archive file, and storing the byte codes into the heap memory.","The byte code interpreter is what is called a Java\u2122 virtual machine. The byte code interpreter converts (i) the byte codes constituting the BD-J application stored in the heap memory and (ii) the byte codes constituting the system application, into native codes, and causes the MPU to execute the native codes.","The application manager is one of system applications, and performs application signaling for the BD-J application based on the application management table in the BD-J object, such as starting or ending a BD-J application. This completes the internal structure of the BD-J platform.","The middleware  is an operating system for the embedded software, and is composed of a kernel and a device driver. The kernel provides the BD-J application with a function unique to the playback device, in response to a call for the Application Programming Interface (API) from the BD-J application. The middleware  also realizes controlling the hardware, such as starting the interruption handler by sending an interruption signal.","The mode management module  holds Index.bdmv that was read from the BD-ROM, built-in medium drive, or removable medium drive, and performs a mode management and a branch control. The management by the mode management is a module assignment to cause either the BD-J platform or the HDMV module to execute the dynamic scenario.","The user event processing unit  receives a user operation via a remote control, and causes the program executing unit  or the playback control unit  to perform a process as instructed by the received user operation. For example, when the user presses a button on the remote control, the user event processing unit  instructs the program executing unit  to execute a command included in the button. For example, when the user presses a fast forward\/rewind button on the remote control, the user event processing unit  instructs the playback control unit  to execute the fast forward\/rewind process onto the AV clip of the currently played-back playlist.","The local storage  includes the built-in medium drive for accessing a hard disc, and the removable medium drive for accessing a semiconductor memory card, and stores downloaded additional contents, data to be used by applications, and other data. A region for storing the additional contents is divided into as many small regions as BD-ROMs. Also, a region for storing data used by applications is divided into as many small regions as the applications.","The nonvolatile memory  is a recording medium that is, for example, a readable\/writable memory, and is a medium such as a flash memory or FeRAM that can preserve the recorded data even if a power is not supplied thereto. The nonvolatile memory  is used to store a backup of the register set .","The present embodiment is an embodiment for implementing an invention that is the same as the invention (hereinafter referred to as \u201cpresent invention\u201d) recited in the description and the drawings attached to a request for a patent application which is a basis of the priority declaration of the present application.","Firstly, of the implementation acts of the recording medium of the present invention, an embodiment of a usage act is described.  shows the embodiment of a usage act of a recording medium relating to the present invention. A BD-ROM  in  is a recording medium pertaining to the present invention. The BD-ROM  is used to supply movies to a home theater system composed of a playback device , a television , and a remote control .","This completes the description of the usage act of the recording medium relating to the present invention.","The following describes the data structure of a BD-ROM (i.e., a recording medium of the present invention) for recording 2D images.",{"@attributes":{"id":"p-0952","num":"0957"},"figref":"FIG. 72B"},"The fourth row in  shows the BD-ROM , and the third row shows a track on the BD-ROM. Although the track is usually formed to extend spirally from an inner circumference to an outer circumference, the track is drawn in a laterally expanded manner in the present figure. As with other optical discs such as DVDs and CDs, the BD-ROM  has a recording region that spirals from the inner circumference to the outer circumference of the BD-ROM . The BD-ROM  also has a volume region in which logical data can be recorded, between the lead-in on the inner circumference side and the lead-out on the outer circumference side. The volume region is sectioned into units in which the optical disc can be accessed, and serial numbers are assigned to the access units. The serial numbers are called logical addresses. Data is read out from the optical disc by specifying logical addresses. It is defined here that the logical addresses also indicate physically consecutive regions on the optical disc. That is to say, data with consecutive logical addresses can be read without a seek operation. There is a special area called BCA (Burst Cutting Area) provided at a place more inner than the lead-in. Since it can be read only by a drive, not by an application, the BCA is often used by the copyright protection technology.","At the head of the volume region, volume information of a file system is recorded, followed by application data such as video data. The file system is a system that expresses data on the disc in units of directories and files. In the BD-ROM , the file system is recorded in a format called UDF (Universal Disc Format). Even in the case of an everyday PC (Personal Computer), when data is recorded with a file system called FAT or NTFS, the data recorded on the hard disk under directories and files can be used on the computer, thus improving usability. The file system makes it possible to read logical data in the same manner as in an ordinary PC, using a directory and file structure.","The directory and file structure on the BD-ROM  is as follows. A BDMV directory is provided directly below a root directory (ROOT). Data such as AV contents and management information on the BD-ROM  is recorded in the BDMV directory. Provided below the BDMV directory are an index file (index.bdmv) defining an index table constituting a title, a PLAYLIST directory, a CLIPINF directory, a STREAM directory, a BDJO directory, and a JAR directory. Provided below the STREAM directory, CLIPINF directory and PLAYLIST directory are: an AV clip (XXX.M2TS) storing AV contents such as video and audio that are multiplexed together; a clip information file (XXX.CLPI) storing AV clip management information; a playlist file (YYY.MPLS) defining logical playback paths of AV clips; and a BD program file (AAA.PROG) storing a program that defines a dynamic scenario.","The following describes the data structure of the files that are stored under the BDMV directory.","The index file (Index.bdmv) is described first. The index file has the index table shown in . The index table is a table that is provided in the highest layer and defines the title structure of the top menu, FirstPlay, and all titles stored on the BD-ROM. The index table specifies program files to be executed first from each title, the top menu, and the FirstPlay. Each time a title or a menu is called, a BD-ROM player refers to the index table, to execute a predetermined BD program file. Here, FirstPlay is set by a content provider, and indicates a BD program file to be executed automatically when the disc is loaded into a BD-ROM player. The top menu specifies a movie object or a BD-J object which is to be called when a command \u201cReturn to the menu\u201d is executed according to a user operation via a remote controller.","The BD program file (AAA.PRG) stores a plurality of programs to be specified and executed from each title. Different prefixes (e.g., AAA) are used to identify corresponding files. Although interpreter-approach programs with unique specifications are used to generate programs for Blu-ray Disc, the programs to be used may be written in a general-purpose programming language such as Java\u2122 or Java\u2122 Script. The programming language is not essential to the present invention. The programs specify playlists to be played back.","A description is now given on the AV clip (XXX.M2TS) and the clip information file (XXX.CLPI).","The AV clip is a digital stream having an MPEG-2 transport stream format.",{"@attributes":{"id":"p-0961","num":"0966"},"figref":["FIG. 73A","FIG. 73A"]},"Described below is the structure of the video stream. When a video compression\/encoding technique such as MPEG-2, MPEG-4 AVC and SMPTE VC-1 is used, data is compressed in size by taking advantage of spatial and temporal redundancy of the video. One method that takes advantage of temporal redundancy of the video is inter-picture predictive encoding. According to the inter-picture predictive encoding, when encoding a certain picture, another picture to be displayed before or after the certain picture along the display time axis is designated as a reference picture. After detecting a motion amount by which data of the certain picture differs from data of the reference picture, the data of the certain picture is compressed in size by removing the spatial redundancy, which is obtained by subtracting the certain picture (target of encoding) from the motion-compensated reference picture.","An I-picture is a picture that is encoded by inter-picture predictive encoding\u2014i.e., by only using information present in itself without referring to a reference picture. It should be noted that a \u201cpicture\u201d is a unit of encoding and denotes both of a frame and a field. A P-picture is a picture that is encoded by inter-picture predictive encoding\u2014more specifically, by referring to another picture that has already been processed. A B-picture is a picture that is encoded by inter-picture predictive encoding\u2014more specifically, by simultaneously referring to other two pictures that have already been processed. A B-picture that is referred to by another picture is called a \u201cBr-picture\u201d. A frame (in the case of the frame structure) and a field (in the case of the field structure) are called video access units.","Each stream in the AV clip is identified by a PID. For example, an alignment 0x1011 is allocated to a video stream used as the video of the movie, alignments 0x1100 to 0x111F are allocated to the audio streams, alignments 0x1200 to 0x121F are allocated to the presentation graphics, alignments 0x1400 to 0x141F are allocated to the interactive graphics streams, alignments 0x1B00 to 0x1B1F are allocated to the video streams used as secondary video of the movie, and alignments 0x1A00 to 0x1A1F are allocated to the audio stream used as secondary audio mixed with the primary audio.",{"@attributes":{"id":"p-0965","num":"0970"},"figref":"FIG. 73B","b":["501","504","502","505","502","505","503","506","507","510","508","511","508","511","509","512","513","503","506","509","512"]},{"@attributes":{"id":"p-0966","num":"0971"},"figref":"FIG. 74A","b":["1","2","3","4"]},{"@attributes":{"id":"p-0967","num":"0972"},"figref":["FIG. 74B","FIG. 74B"],"b":"1503"},"In addition to TS packets of audio, video, subtitles and the like, the AV clip also includes TS packets of a PAT (Program Association Table), a PMT (Program Map Table) and a PCR (Program Clock Reference). The PAT shows a PID of a PMT used in the AV clip. The PID of the PAT itself is registered as \u201c0\u201d. The PMT stores the PIDs in the streams of video, audio, subtitles and the like, and attribute information corresponding to the PIDs. The PMT also has various descriptors relating to the AV clip. The descriptors have information such as copy control information showing whether copying of the AV clip is permitted or not permitted. The PCR stores STC time information corresponding to an ATS showing when the PCR packet is transferred to a decoder, in order to achieve synchronization between an ATC (Arrival Time Clock) that is a time axis of ATSs, and an STC (System Time Clock) that is a time axis of PTSs and DTSs.",{"@attributes":{"id":"p-0969","num":"0974"},"figref":"FIG. 75A"},"As shown in , each piece of clip information file is management information for an AV clip. The clip information files are in one to one correspondence with the AV clips, and are each composed of clip information, stream attribute information, and entry map.","As shown in , clip information is composed of a system rate, a playback start time, and a playback end time. The system rate represents a maximum transfer rate at which the AV clip is transferred to the PID filter of the system target decoder, which will be described later. The interval between the ATSs in the AV clip is equal to or lower than the system rate. The playback start time is the PTS of the first video frame in the AV clip. The playback end time is obtained by adding a per-frame playback interval to the PTS of the last video frame in the AV clip.","As shown in , a piece of attribute information is registered for each PID of each stream in the AV clip. Each piece of attribute information has different information depending on whether the corresponding stream is a video stream, an audio stream, a presentation graphics stream, or an interactive graphics stream. Each piece of video stream attribute information carries information including what kind of compression codec the video stream was compressed with, and the resolution, aspect ratio and frame rate of the pieces of picture data that compose the video stream. Each piece of audio stream attribute information carries information including what kind of compression codec the audio stream was compressed with, how many channels are included in the audio stream, how many languages the audio stream supports, and the sampling frequency. The information in the video stream attribute information and the audio stream attribute information is used for purposes such as initialization of a decoder before the player performs playback.","As shown in , the entry map is table information that shows entry map header information , PTSs, and SPNs. Each PTS shows a display time of each I-picture in the video stream in the AV clip. Each SPN is the SPN of the AV clip that is started with an I-picture. Here, a pair of a PTS and an SPN shown in a same row in the table is called an \u201centry point\u201d. Each entry point has an entry point ID (hereinafter also referred to as an \u201cEP_ID\u201d). Starting with the top entry point, which has an entry point ID 0, the entry points have successively incremented entry point IDs. Using the entry map, the player can specify the location of a file of an AV clip corresponding to an arbitrary point on the playback axis of the video stream. For instance, when performing special playback such as fast forward or rewind, the player can perform processing efficiently without analyzing the AV clip, by specifying, selecting and playing back an I-picture registered in the entry map. An entry map is created for each video stream multiplexed in the AV clip. The entry maps are managed according to PIDs. The entry map header information  is stored at the head of each entry map. The entry map header information  carries information such as the PID of the corresponding video stream and the number of entry points.","A description is now given of the playlist file (YYY.MPLS).","A playlist indicates the playback path of an AV clip. As shown in , a playlist is composed of one or more playitems . Each playitem shows a playback segment with respect to an AV clip. The playitems  are each identified by a respective playitem ID, and are written in the order in which they are to be played in the playlist. Furthermore, the playlist includes an entry mark  showing a playback start point. The entry mark  can be assigned in the playback segments defined in the playitem. As shown in , entry marks  are assigned to positions that are potential playback start positions in playitems, and used for cued playback. In the case of a Movie title, for instance, the entry marks  may be assigned to the head of each chapter, thus making chapter playback possible. It should be noted that the playback path of a series of playitems is defined as a main path  in the present example.","The content of the playitems is now described with reference to . A playitem includes clip information  of the clip to be played back, a playback start time , a playback end time , a connection condition , and a stream selection table . Since the playback start time and the playback end time are time information, the player refers to the entry map of the clip information file, acquires an SPN corresponding to the designated playback start time and playback end time, and designates a read start position, to perform playback processing.","The connection condition  shows a previous playitem and a connection type. When the connection condition  of a playitem is \u201c1\u201d, it is not guaranteed that the AV clip indicated by this playitem is seamlessly connected with another AV clip indicated by a previous playitem that precedes this playitem. When the connection condition  of a playitem is \u201c5\u201d or \u201c6\u201d, it is guaranteed that the AV clip indicated by this playitem is seamlessly connected with another AV clip indicated by a previous playitem that precedes this playitem. When the connection condition  is \u201c5\u201d, an STC of one playitem and an STC of another playitem does not need to be continuous with each other. That is to say, the video display start time of a start of an AV clip indicated by a post-connection playitem may not be continuous from the video display start time of an end of an AV clip indicated by a pre-connection playitem. However, in the case where the AV clip indicated by the pre-connection playitem and the AV clip indicated by the post-connection playitem are input to the PID filter of the system target decoder  and sequentially played back, these AV clips should not crash the decoding ability of the system target decoder . Also, there are several conditions that must be met. For example, the last frame of the audio in the AV clip indicated by the pre-connection playitem must overlap the first frame of the audio in the AV clip indicated by the post-connection playitem on the playback time axis. Also, in the case where the connection condition  is \u201c6\u201d, when the AV clips indicated by the pre-connection and post-connection playitems are combined together, they must be playable as a single AV clip. In other words, an STC and ATC of the AV clip indicated by the pre-connection playitem are continuous, and an STC and ATC of the AV clip indicated by the post-connection playitem are continuous.","The stream selection table  is composed of a plurality of stream entries . Each stream entry  is composed of a stream selection number , stream path information  and stream identification information . The stream selection numbers  are numbers that increment in order from the first stream entry  included in the stream selection table. The stream selection numbers  are used for stream identification in the player. The stream path information  is information showing which AV clip the stream shown by the stream identification information  is multiplexed on. For example, if the stream path information  shows \u201cmain path\u201d, this indicates the AV stream of the playitem. If the stream path information  shows \u201csub-path ID=1\u201d, this indicates an AV clip of a sub-playitem corresponding to a playback segment of the playitem. Specifics of the sub-path will be described in the next section. The stream identification information  is information such as PIDs, and shows streams multiplexed on the AV clip being referred to. Furthermore, stream attribute information is also recorded in the stream entries . Each stream attribute information is a piece of information showing a property of a stream, and for instance includes a language attribute in the case of audio, presentation graphics, or interactive graphics.","As shown in , a playlist may have one or more sub-paths. The sub-paths are assigned IDs in the order they are registered in the playlist. These IDs are used as sub-path IDs for identifying the sub-paths. Sub-paths are a series of playback paths played back in synchronization with a main path. As with a playitem, a sub-playitem has the clip information  of the clip to be played back, the playback start time , and the playback end time . The playback start time  and the playback end time  of the sub-playitem are expressed using the same time axis as the main path. For example, if a certain stream entry  registered in the stream selection table  of the playitem # shows sub-path ID=0 and presentation graphics , the presentation graphics  multiplexed on the AV clip of the sub-playitem # played back in synchronization with the playback segment of the playitem #, among the sub-paths of sub-path ID=0, will be played back in the playitem # playback segment. Furthermore, a sub-playitem includes a field called an SP connection condition, which has the same meaning as a connection condition of a playitem. An AV clip on a border between sub-playitems whose SP connection conditions are \u201c5\u201d or \u201c6\u201d needs to meet the conditions that the stated playitems whose connection conditions are \u201c5\u201d or \u201c6\u201d need to meet.","This concludes the description of the data structure of the BD-ROM (i.e., a recording medium relating to the present invention) for recording thereon 2D images.","A description is now given of a playback device (2D playback device) relating to the present invention, the playback device playing back a BD-ROM having 2D images recorded thereon.",{"@attributes":{"id":"p-0982","num":"0987"},"figref":"FIG. 78A","b":["1500","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510"]},"The BD-ROM drive  reads data from a BD-ROM disc based on a request from the playback control unit . An AV clip read from the BD-ROM disc is transferred to the read buffer . An index file, a playlist file, and a clip information file read from the BD-ROM disc are transferred to the management information memory . A movie object file read from the BD-ROM disc is transferred to the program memory .","The read buffer  is a buffer constituted from a memory or the like that stores data read using a BD-ROM drive. The management information memory  is a buffer constituted from a memory or the like that stores management information on the index file, playlist file and clip information file. The program memory  is a buffer constituted from a memory or the like that stores the movie object file.","The system target decoder  performs (i) demultiplexing processing on source packets read into the read buffer  and (ii) processing to decode streams. Information necessary to decode streams included in an AV clip, such as codec types and stream attributes, is transferred from the playback control unit . The system target decoder  writes the decoded primary video stream, secondary video stream, interactive graphics stream, and presentation graphics stream in their plane memories, namely a primary video plane, a secondary video plane, an interactive graphics plane (IG plane), and a presentation graphics plane (PG plane), respectively. The system target decoder  also mixes the decoded primary audio stream with the decoded secondary audio stream, and outputs the mixed streams to a speaker or the like. The system target decoder  also performs processing to decode graphics data such as JPEG and PNG (transferred from the program execution unit ) for display of a menu or the like, and to write the decoded graphics data to an image plane. Details of the system target decoder  are given later.","The user event processing unit  requests processing by the program execution unit  or the playback control unit  in response to a user operation made through the remote control. For instance, when a button on the remote control is pressed, the user event processing unit  makes a request to the program execution unit  to execute a command included in the button. As another example, when a fast forward or rewind button in the remote control is pressed, the user event processing unit  instructs the playback control unit  to execute fast forward or rewind processing of the AV clip of the playlist currently being played back.","The playback control unit  has the function of controlling playback of the AV clip by controlling the BD-ROM drive  and the system target decoder . The playback control unit  also controls playback processing of an AV clip by interpreting playlist information based on a playback instruction from the program execution unit  or notification by the user event processing unit . Furthermore, the playback control unit  also performs setting and referencing of the player variable , and performs playback operations.","The player variable  includes system parameters ( ) indicating the status of the player, and general parameters (GPRM) for general use.",{"@attributes":{"id":"p-0989","num":"0994"},"figref":"FIG. 78B"},"PSR: Language Code","PSR: Primary audio stream number","PSR: Subtitle stream number","PSR: Angle number","PSR: Title number","PSR: Chapter number","PSR: Program number","PSR: Cell number","PSR: Selected key information","PSR: Navigation timer","PSR: Playback time information","PSR: Mixing mode for Karaoke","PSR: Country information for parental management","PSR: Parental level","PSR: Player configuration value (video)","PSR: Player configuration value (audio)","PSR: Language code for audio stream","PSR: Language code extension for audio stream","PSR: Language code for subtitle stream","PSR: Language code extension for subtitle stream","PSR: Player region code","PSR: User's preferential selection of 2D\/3D output mode","PSR: Current 2D\/3D output mode","PSR: 3D video output capability of display","PSR: 3D image playback capability","PSR: Reserved","PSR: Reserved","PSR: Reserved","PSR: Reserved","PSR: Reserved","PSR: Reserved","PSR: Reserved","The PSR is updated every time picture data belonging to an AV clip is displayed. In other words, if the playback device causes a new piece of picture data to be displayed, the PSR is updated to show the display time (PTS) of the new picture. The current playback point can be known by referring to the PSR.","The language code for the audio stream of the PSR and the language code for the subtitle stream of the PSR are items that can be set in the OSD of the player or the like, and show default language codes of the player. For example, the BD program file may have the following function. Namely, if the language code for audio stream PSR is English, when a playlist is played back, a stream entry having the same language code is searched for in the stream selection table of the playitem, and the corresponding audio stream is selected and played back.","Furthermore, the playback control unit  checks the status of the system parameter while playback is performed. The PSR, PSR, PSR and PSR show the audio stream number, subtitle stream number, secondary video stream number and secondary audio stream number, respectively. These values correspond to the stream selection number . As one example, the audio stream number PSR may be changed by the program execution unit . The playback control unit  compares the stream section number  from among the stream selection table  of the playitem currently being played back, refers to the matching stream entry , and switches playback of the audio stream. In this way, switches can be made between which audio, subtitle or secondary video stream is played back or not.","The program execution unit  is a processor for executing a program stored in the BD program file. The program execution unit  performs operations in accordance with the stored program, and performs control as follows. (1) The program execution unit  instructs the playback control unit  to perform playlist playback. (2) The program execution unit  transfers PNG\/JPEG for graphics for a menu or a game to the system target decoder, for display on a screen. These operations can be performed flexibly in accordance with the makeup of the programs. What kind of control is performed is determined according to programming procedure of the BD program file in the authoring procedure.","The plane adder instantaneously superimposes data pieces written in the primary video plane, the secondary video plane, the interactive graphics plane, the presentation graphics plane and the image plane, and displays the resultant superimposed data on the screen of a television or the like.","A description of the system target decoder  is now given with reference to .","The source depacketizer interprets a source packet transferred to the system target decoder , extracts the TS packet, and sends the TS packet to the PID filter. In sending the TS packet, the source depacketizer adjusts the time of input into the decoder in accordance with the ATS of the source packet. More specifically, in accordance with the rate of storing an AV clip, the source depacketizer transfers the TS packet to the PID filer at the instant that the value of the ATC generated by the ATC counter and the value of the ATS of the source packet become identical.","The PID filters transfer TS packets output from the source depacketizers. More specifically, the PID filters transfer TS packets having a PID that matches a PID required for playback to the primary video decoder, the secondary video decoder, the IG decoder, the PG decoder, the audio decoder or the secondary audio decoder, depending on the PID of the TS packet. For instance, in the case of the BD-ROM, a TS packet having a PID 0x1011 is transferred to the primary video decoder, TS packets having PIDs 0x1B00 to 0x1B1F are transferred to the secondary video decoder, TS packets having PIDs 0x1100 to 0x111F are transferred to the primary audio decoder, TS packets having PIDs 0x1A00 to 0x1A1F are transferred to the secondary audio decoder, TS packets having PIDs 0x1200 to 0x121F are transferred to the PG decoder, and TS packets having PIDs 0x1400 to 0x141F are transferred to the IG decoder.","The primary video decoder is composed of a TB (Transport Stream Buffer) , an MB (Multiplexing Buffer) , an EB (Elementary Stream Buffer) , a compressed video decoder , and a DPB (Decoded Picture Buffer) .","The TB  is a buffer that, when a TS packet including a video stream is output from the PID filter , temporarily stores the TS packet as it is.","The MB  is a buffer that, when a video stream is output from the TB  to the EB , temporarily stores PES packets. When data is transferred from the TB  to the MB , the TS header of each TS packet is removed.","The EB  is a buffer that stores a picture in an encoded state (I-picture, B-picture and P-picture). When data is transferred from the MB  to the EB , the PES header is removed.","The compressed video decoder  creates a frame\/field image by decoding each video access unit in a video elementary stream at respective predetermined decode times (DTS). Possible compression encoding formats of the video stream multiplexed on the AV clip include MPEG2, MPEG4AVC, and VC1, and therefore the decoding scheme used by the compressed video decoder  can be changed in accordance with stream attributes. The compressed video decoder  transfers each of the decoded frame\/field images to the DPB , and writes each of the decoded frame\/field images in the primary video plane at respective display times (PTS).","The DPB  is a buffer that temporarily stores the decoded frame\/field images. The compressed video decoder  makes use of the DPB  to, when decoding the video access units (e.g., a P-picture and a B-picture encoded by the inter-picture predictive encoding), refer to pictures that have already been decoded.","The secondary video decoder has the same structure as the primary video decoder. The secondary video decoder performs decoding of an input secondary video stream, and writes resultant pictures to the secondary video plane in accordance with respective display times (PTS).","The IG decoder extracts and decodes an interactive graphics stream from the TS packets input from source packetizers, and writes the resultant decompressed graphics data to the IG plane in accordance with respective display times (PTS).","The PG decoder extracts and decodes a presentation graphics stream from the TS packets input from the source packetizers, and writes the resultant decompressed graphics data to the PG plane in accordance with respective display times (PTS).","The primary audio decoder has a buffer. While accumulating data in the buffer, the primary audio decoder extracts information such as a TS header and a PES header, and performs audio stream decode processing to obtain decompressed LPCM-state audio data. The primary audio decoder outputs the obtained audio data to the audio mixer in accordance with the respective playback time (PTS). Possible compression encoding formats of the audio stream multiplexed on the AV clip include AC3 and DTS, and therefore the decoding scheme used to decode the compressed audio is changed in accordance with stream attributes.","The secondary audio decoder has the same structure as the primary audio decoder. The secondary audio decoder performs decoding of an input secondary audio stream, and outputs resultant decompressed LPCM-state audio data to the audio mixer in accordance with respective display times. Possible compression encoding formats of the audio stream multiplexed on the AV clip include Dolby Digital Plus and DTS-HD LBR, and therefore the decoding scheme used to decode the compressed audio is changed in accordance with stream attributes.","The audio mixer mixes (superimposes) the decompressed audio data output from the primary audio decoder and the decompressed audio data output from the secondary audio decoder with each other, and outputs the resultant audio to a speaker or the like.","The image processor decodes graphics data (PNG and JPEG) transferred from the program execution unit, and outputs the resultant decoded graphics data to the image plane in accordance with a display time designated by the program execution unit.","This concludes the description of the structure of the 2D playback device relating to the present invention.","(Principle of 3D Playback)","With reference to , the following describes the principle of enabling stereoscopic viewing on a home-use screen. There are two major methods to enable the stereoscopic viewing: a method that utilizes holography; and a method that utilizes parallax images.","The first method utilizing the holography is characterized in that it can create 3D images of an object in such a manner that a human viewer recognizes the three-dimensionality of the created 3D images in the same way as he\/she recognizes the three-dimensionality of the actual object. However, although a technical theory has already been established in the field of holography, when it comes to playback of a video, it is extremely difficult to create holograms of a video with the current holography technique, because doing so requires use of (i) a computer that can perform an enormous amount of operations to create holograms of the video in real time, and (ii) a display device whose resolution is high enough to be able to draw thousands of linear materials in a distance of 1 mm. For this reason, there are almost no practical examples of holography that are commercially used.","The second method utilizing the parallax images is characterized in that, after right-eye images and left-eye images are separately prepared, it enables stereoscopic viewing by making the right-eye images and the left-eye images only visible to the right eye and the left eye, respectively.  shows a user looking at a relatively small cube that is on a straight line connecting the center of the user's face and the center of the cube, as viewed from above. The top right view exemplarily shows the cube as seen by the left eye of the user. The bottom right view exemplarily shows the cube as seen by the right eye of the user.","The merit of the second method is that it can realize the stereoscopic viewing merely by preparing right-eye images and left-eye images separately. As there are several technical ways to make the right-eye and left-eye images only visible to the right eye and left-eye, respectively, the second method has already been practically implemented as different techniques.","One technique is called a \u201csequential segregation\u201d method, with which the user views the left-eye and right-eye images, which are displayed alternately in the time axis direction on a screen, while wearing stereoscopic glasses (with liquid-crystal shutters). At this time, to the user's eyes, a left-eye image and a corresponding right-eye image look superimposed over each other due to the afterimage effect. Accordingly, the user's eyes recognize that the pair of the left-eye image and the corresponding right-eye image is a 3D image. To be more specific, while a left-eye image is being displayed on the screen, the stereoscopic glasses make the left-eye liquid-crystal shutter transparent and the right-eye liquid-crystal shutter dark. Conversely, while a right-eye image is being displayed on the screen, the stereoscopic glasses make the right-eye liquid-crystal shutter transparent and the left-eye liquid-crystal shutter dark. As stated earlier, this technique (alternate-frame sequencing) displays right-eye and left-eye images alternately in the time axis direction. Thus, unlike an ordinary 2D movie that is displayed at 24 frames-per-second, this technique needs to display a total of 48 left-eye and right-eye images per second. Therefore, the alternate-frame sequencing is suitable for use in a display device that can rewrite the screen at a relatively high speed. The alternate-frame sequencing can also be used in any display device that can rewrite the screen for a predetermined number of times per second.","As opposed to the aforementioned sequential segregation method that outputs the left-eye and right-eye pictures alternately in the time axis direction, there is another technique that simultaneously displays, on a single screen, a left-eye picture and a right-eye picture horizontally next to each other. Here, with the aid of a lenticular lens that is semicircular in shape and attached to the surface of the screen, pixels constituting the left-eye picture and pixels constituting the right-eye picture are only presented to the left eye and the right eye, respectively. In the above manner, this technique can create the illusion of 3D images by presenting parallax pictures to the left eye and the right eye. Note, the lenticular lens may be replaced with another device (e.g., liquid crystal elements) that has the same function as the lenticular lens. Also, a vertical polarizing filter and a horizontal polarizing filter may be provided for left-eye pixels and right-eye pixels, respectively. Here, stereoscopic viewing can be realized by the viewer viewing the screen through polarizing glasses composed of a vertical polarizing filter (for the left eye) and a horizontal polarizing filter (for the right eye).","This stereoscopic viewing technique utilizing the parallax images has been commonly used for attractions of amusement parks and the like, and has already been established. Hence, this technique may be the closest form of technology that could be practically implemented for home use. It should be mentioned that many other methods\/techniques have been suggested to realize such stereoscopic viewing utilizing the parallax images, such as a two-color separation method. Although the alternate-frame sequencing and the polarization glass technique are explained in the present embodiment as examples of methods\/techniques to realize the stereoscopic viewing, the stereoscopic viewing may be realized using other methods\/techniques other than the aforementioned two techniques, as long as it is realized using parallax images.","In the present embodiment, a description is given of a method for recording, on an information recording medium, parallax images used for stereoscopic viewing. Hereafter, an image for the left eye is referred to as a \u201cleft-eye image\u201d, an image for the right eye is referred to as a \u201cright-eye image\u201d, and a pair of the left-eye image and the corresponding right-eye image is referred to as a \u201c3D image\u201d. (Switching between 2D and 3D displays)","Described below is the data structure of the BD-ROM, which is a recording medium pertaining to the present invention, for storing 3D images.","Basic parts of the data structure are the same as those of the data structure for recording 2D video images. Therefore, the following description focuses on extended or different parts of such data structure. The following description will be given under the assumption that 3D images are recorded on a BD-ROM. Hereafter, a playback device that can only play back 2D images is referred to as a \u201c2D playback device\u201d, and a playback device that can play back both of 2D images and 3D images is referred to as a \u201c2D\/3D playback device\u201d.","The following describes an index file (Index.bdmv) stored in a BD-ROM for playing back stereoscopic images.  shows an example of an index file (Index.bdmv) stored in a BD-ROM for playing back stereoscopic images. In the example shown in , as a playlist, there are prepared a 2D PlayList  showing a playback path of 2D images and a 3D PlayList  showing a playback path of 3D images. A title is selected by a user, and the executed BD program file checks if the playback device is compliant with the 3D image playback according to a program stored therein. If the playback device is compliant with the 3D image playback, the executed BD program file checks if the user has selected the playback of the 3D images, and switches a PlayList to be played back accordingly.","Also, a \u201c3D existence flag\u201d and a \u201c2D\/3D preference flag\u201d are prepared for the index file. The 3D existence flag is a flag that identifies whether or not a PlayList for playing back the 3D images exists in the title. Since the 2D\/3D playback device does not have to prepare for the playback of the 3D images in a case where the flag shows \u201cFALSE\u201d, the 2D\/3D playback device can skip processing such as HDMI authentication, thereby performing processing at high speed. The 2D\/3D preference flag is an identifier showing whether a content provider specifies the playback of the 2D images or 3D images when the TV and the playback device are capable of playing back both the 2D images and the 3D images. When the flag shows \u201c3D\u201d, the playback device can promptly performs the HDMI authentication since switching to a 2D mode is not necessary. In general, a large delay occurs during the HDMI authentication between the playback device and the TV when the video stream attribute such as the frame rate is different. Therefore, when another switching is performed from the playback of the 2D images to the playback of the 3D images after switching to the 2D images, a large delay occurs. Therefore, it is possible to prevent a delay time of the HDMI authentication if the switching to the playback of the 2D images can be skipped with use of the 2D\/3D preference flag.","Note that the \u201c3D existence flag\u201d and the \u201c2D\/3D preference flag\u201d may be set for each title instead of the index file as a whole.",{"@attributes":{"id":"p-1058","num":"1063"},"figref":"FIG. 99"},"In S, a value in PSR is checked. When the value is \u201c0\u201d, since the playback device is a 2D playback device, the 2D PlayList is played back. When the value is \u201c1\u201d, the process advances to S.","In S, a menu screen is displayed to ask whether the user wishes for playback of 2D images or 3D images. In accordance with a result of the user's selection made with a remote control or the like, when the user wishes for the 2D image playback, the 2D PlayList is played back, and when the user wishes for the 3D image playback, the process advances to S.","In S, it is checked whether the display corresponds to the 3D image playback. For example, after the playback device is connected to the display using HDMI, the playback device makes an inquiry to the display as to whether the display corresponds to the 3D image playback. When the display does not correspond to the 3D image playback, the display device plays back the 2D PlayList. Alternatively, the playback device may display, on a menu screen or the like, a notification that informs the user that the television is not ready for the playback. When the display corresponds to the 3D image playback, the display device plays back the 3D PlayList.","Also, in the above is described that the parental level can be set in the PSR in the 2D playback device. With this setting, control can be performed such that only the user who is the appropriate age or over can play back the BD-ROM disc. In addition to this parental level, a 3D parental level in PSR is prepared for the 2D\/3D playback device. In the 3D parental level is stored information on the age of the user who uses the 2D\/3D playback device, as with the PSR. The BD program file of the title of the BD-Rom disc judges whether or not the playback is permitted, with use of this PSR in addition to the PSR. Since the PSR is the parental level regarding the playback of the 3D images, the parental level is controlled with use of the PSR in the 2D playback device. With these two kinds of parental levels, control can be performed, in view of physical effects on a small child in the process of growing, based on a demand that \u201csmall children cannot watch 3D image but 2D images\u201d, for example. For example, a playlist to be played back may be selected with reference to the PSR after it is checked that the display supports the playback of the 3D image (S: YES) in the flow chart shown in .","Note that although the age information is stored in the PSR as with the PSR, in the PSR may be set whether the playback of the 3D images is prohibited or not.","Also, in the system parameter (in this example, the PSR) is set the information showing \u201cwhich of the 2D images and the 3D images the user prefers to be played back\u201d. In the PSR is set, by the user via the OSD of the 2D\/3D playback device, which of the playback of the 2D images and the playback of the 3D images the user give a priority to. When the display supports the playback of the 3D images, and information on the PSR shows that the user gives the priority to the playback of the 3D images, it is not necessary to switch to the playback of the 2D images. Therefore, the HDMI authentication can be promptly performed, and the playback processing of the 3D images can be also promptly performed. Also, the BD program determines whether to playback 2D or 3D with reference to this PSR, thereby enabling playback processing in accordance with a user's preference.","Note that a BD program may refer to the PSR to determine a default selection button of a menu to be displayed by a BD program. For example, suppose that a menu prompts the user to branch to \u201c2D video playback\u201d or \u201c3D video playback\u201d. In this case, if the value of the PSR indicates \u201c2D\u201d, the user puts his cursor on a button of \u201c2D video playback\u201d. If the value of the PSR indicates \u201c3D\u201d, the user puts his cursor on a button of \u201c3D video playback\u201d.","The selection on \u201cwhich of 2D playback and 3D playback user prefers\u201d differs for each user who performs playback. In the case where the 2D\/3D playback device includes a unit for identifying a person who is watching the 2D\/3D playback device, the value of the PSR may be set depending on a user who is currently watching the 2D\/3D playback device. For example, suppose that three family members (father, mother, and child) use a 2D\/3D playback device. The 2D\/3D playback device manages an account for each user. In this case, by updating the value of the PSR depending on a user who is currently logging in, it is possible to perform control in accordance with a preference of a person who is actually using the 2D\/3D playback device.","The selection on \u201cwhich of 2D playback and 3D playback user prefers\u201d may be performed by setting levels, instead of selecting between 2D and 3D. For example, four levels of \u201calways 2D\u201d, \u201crather 2D\u201d, \u201crather 3D\u201d, and \u201calways 3D\u201d may be set. With such a structure, it is possible to perform playback processing in a 2D\/3D playback device much more in accordance with a user's preference. For example, suppose that a PSR is used, which is a system parameter showing the status of a playback device. In this case, if the value of the PSR indicates the level \u201calways 2D\u201d, the value of the PSR is always set to the 2D mode. If the value of the PSR indicates the level \u201calways 3D\u201d, the value of the PSR is always set to the 3D mode (L\/R mode or DEPTH mode).","Next, the following describes the structure of a presentation graphics with reference to . A subtitle entry displayed as shown in  is composed of a plurality of subtitle data entries. Each of the subtitle data entries is composed of composition information, window information, palette information, and object information. The composition information is information for defining the screen structure of subtitle data. The composition information stores therein cropping information of an object, a display position of the cropped object, a window ID for identifying a window to be referred to, a palette ID for identifying a palette to be referred to, and an object ID for identifying the palette to be referred to. The window information stores therein a window region for defining a region in which the decoder will perform decoding together with a window ID. The object information stores therein a graphics image together with the object ID. The graphics image is image data composed of 256 index colors, and is compressed by a compression method such as the run-length compression method. The palette information stores therein table information (CLUT) on a color to be used for the object together with the palette ID. The table is storable therein 256 colors, and each color is referable using a corresponding color ID. The color ID has either value of 0-255. The color ID having the value 255 fixedly corresponds to a clear and colorless color.",{"@attributes":{"id":"p-1069","num":"1074"},"figref":"FIG. 82","b":["1","2","3","4","5"]},"The following describes improvement in subtitle display.","When the \u201c1 plane+offset\u201d method is applied to a PG plane, in order to create subtitle data, it is necessary to adjust offset metadata depending on the depth of a video image. This makes creation of subtitle data difficult.","In view of this problem, the following describes a method in which regions of black frames on the screen that are not used for a main feature video of a movie work, the regions of the black frames are collected on the upper side or the lower side on the screen, and subtitle data is displayed on the regions of the black frames.","Since the black frames inserted in the video stream are unnecessary regions, subtitle data may be displayed on the black frames. However, as shown in the right side on the upper level of , the black frame provided on each of the upper side and the lower side has only 131 pixels. The black frame having this size is slightly small to insert subtitle data. In view of this, as shown in , the main feature video is shifted upward or downward, and a black color is given to a region obtained after shifting the main feature video, and the black frames provided on the upper side and the lower side are collected in the upper side or the lower side. As a result, it is possible to prepare a black frame enough large to insert subtitle data.","The following describes the data structure for realizing this concept.","The basic parts of the data structure are the same as those for storing 3D videos described in the above embodiments, and accordingly additional parts or different parts from the above embodiments are mainly described here. Also, the following description of PG is applicable to IG or a sub video in the same way as PG by replacing the PG with the IG or the sub video.",{"@attributes":{"id":"p-1076","num":"1081"},"figref":"FIG. 83","b":"1311"},"Next, the 2D\/3D playback device relating to the preset embodiment is described.  shows the structure of plane overlaying performed by the 2D\/3D playback device. Although the description is given here using a PG plane as a representative example, the description is applicable to any plane such as a sub video plane, an IG plane, and an image plane.","In addition to the compositional elements described in the above embodiments, the 2D\/3D playback device shown in  includes, a video plane cropping unit  that performs cropping processing of 2D\/left-eye video plane and right eye video plane, a PSR for writing a shift mode of a video, a PG plane cropping unit  that performs cropping processing of a PG plane, and a PSR in which a shift amount of a plane such as a PG plane.","The PSR shown in  is a system parameter of the 2D\/3D playback device, and indicates a shift mode of a video (video_shift_mode). The video_shift_mode of the PSR includes three modes of \u201cKeep, \u201cUp, and \u201cDown. A value 0 of the PSR indicates \u201cUp\u201d, and a value of 2 of the PSR indicates \u201cDown\u201d. The video plane cropping unit  performs cropping processing of a video plane in accordance with a video shift mode written in the PSR. The value of the PSR is set via an API of a BD program or a command.","In the case where the value of PSR indicates \u201cKeep\u201d, the video plane cropping unit  does not change the 2D\/left-eye video plane and the right eye video plane, and proceeds to processing of superimposing with other plane, as shown in FIG. B(). In the case where the value of the PSR indicates \u201cUp\u201d, the video plane cropping unit  shifts upwards the 2D\/left-eye video plane and the right eye video plane, respectively, crops a black frame from the upper region, and inserts the cropped black frame into the lower region, as shown in FIG. B(). Then, the video plane cropping unit  proceeds to processing of superimposing with the plane. As a result, the black frame can be concentrated downward of the plane. Also, in the case where the value of the PSR indicates \u201cDown\u201d, the video plane cropping unit  shifts downward the 2D\/left-eye video plane and the right eye video plane, respectively, and crops a black frame from the lower region, and inserts the cropped black frame into the upper region, as shown in FIG. B(). Then, the video plane cropping unit  proceeds to processing of superimposing with the plane. As a result, the black frame can be concentrated upward of the plane.",{"@attributes":{"id":"p-1081","num":"1086"},"figref":"FIG. 37","b":["33","33","33","33","33"]},"The PG plane cropping unit  shown in  performs plane shift depending on a shift amount of the PG plane shown by the PSR. The shift processing and overlay processing of overlaying with a video plane performed by the PG plane cropping unit  are shown in  and . As shown in , the video_shift_mode of the PSR indicates \u201cKeep\u201d, the PG plane cropping unit  performs overlay processing of overlaying with the video plane without performing the shift processing. As shown in , if the video_shift_mode of the PSR indicates \u201cUp\u201d, the PG plane cropping unit  performs shift processing of the PG plane using the value of the PG_shift_value_for_Up stored in the PSR to crop a part protruding from the plane and superimpose the cropped protruding part with the video plane. By performing such processing, it is possible to display a subtitle on a lower side compared with a case of 2D playback, and display the subtitle in an appropriate position within a region of a black frame in the lower side. As shown in , the video_shift_mode of the PSR indicates \u201cDown\u201d, the PG plane cropping unit  performs shift processing of the PG plane using the value of the PG_shift_value_for_Down stored in the PSR to crop a part protruding from the plane and superimpose the cropped protruding part with the video plane. By performing such processing, it is possible to display a subtitle on an upper side compared with a case of 2D playback, and display the subtitle in an appropriate position within a region of a black frame in the upper side.","Note that in the structure shown in , offset processing in the horizontal axis direction (1 plane+offset method) for preventing jumping is omitted. Alternatively, it may be employed to add the mechanism of cropping processing based on an offset value in the lateral axis direction. With such a structure, even in the case where a subtitle is displayed on a region of a black frame, it is possible to make the subtitle to look like jumping.","Note that in the case where a subtitle is displayed on a region of a black frame as shown in , an offset value in the lateral axis direction may be a fixed value. In such a case, it may be possible to define a shift amount in the X-axis direction to additional information shown in , store a value of the shift amount in a PSR in the similar way as in the PSR, and perform offset processing in the lateral axis direction using the value. This enables easy data creation.","In the structure of the plane overlaying described with reference to , the shift amount in the Y-axis direction is stored in the PSR. Alternatively, instead of setting a system parameter, it may be possible to employ the structure in which the PG plane cropping unit  directly refers to the playlist.","In the case where the video_shift_mode indicates \u201cUp\u201d or \u201cDown\u201d, the shift amount of the video plane may be fixed to the size of each of the black frames provided in the upper and lower sides of the plane (131 pixels in the example shown in ). Alternatively, an author or a user may set the shift amount without limitation. Further alternatively, it may be employed to prepare a new system parameter, store the shift amount in the new system parameter, and set the shift amount via a BD program or a player OSD.","In the structure of the plane overlaying described with reference to , the description is given on processing of shifting the whole plane using a value stored in the PSR. Alternatively, the value may be used as a value to be added to a display position of the PG in the composition information. For example, in the case where the display position of the PG in the composition information is (x,y) and the video_shift_mode indicates \u201cKeep\u201d, the PG decoder displays a corresponding subtitle data entry in a position indicated by (x,y+PG_shift_value_for_UP). With such a structure, processing is reduced compared with plane shift. In such a use case, PG_shift_value_for_UP may be stored in the composition information.","As shown in , in the case where the video_shift_mode indicates \u201cUp\u201d or \u201cDown\u201d, plane shift results in a cropped region. Accordingly, there only needs to make a restriction such that no subtitle data is in the cropped region. In other words, as shown in the right side of , since a region other than a region surrounded by a dashed line has a possibility to be cropped, a display position of the PG is restricted such that no subtitle data is displayed on the region other than the region surrounded by the dashed line. The coordinate of the region is represented by (0,PG_v_shfit_value_for_Down), (0,height+PG_v_sfhit_value_for_Up), (width,PG_v_shfit_value_for_Down), and (width,height+PG_v_sfhit_value_for_Up). For example, if PG_v_sfhit_value_for_Up indicates \u2212a and PG_v_sfhit_value_for_Down indicates+b, the region is represented by (0,b), (0,height\u2212a), (width,b), and (width,height\u2212a). As the constraint conditions for PG, the display position is restricted so as not to go beyond the above region, the display position to which the size of an object to be displayed is added is restricted so as not to go beyond the above region, the display position of the window is restricted so as not to go beyond the above region, and the display position of the window to which the window size is added is restricted so as not to go beyond the above region, for example. Such constraint conditions can prevent display of a partially lacking.","Note that \u201cvideo_shift_mode\u201d may be added to the stream additional information  of the stream selection information, as shown in . In this case, the structure of plane overlay processing performed in the 2D\/3D playback device is as shown in . The structure shown in  includes a PSR in addition. The PSR stores therein a flag of On\/Off indicating whether to perform video shift. In other words, the PSR having the value 1 indicates to perform video shift. The PSR having the value 0 indicates not to perform video shift. The PSR that is a flag of On\/Off indicating whether to perform video shift is controlled by a program execution unit or the like in accordance with a menu, for example. The PSR may be set in accordance with a user operation such as OSD of a player. A video shift mode is stored in the PSR. A value of the video shift mode is set based on additional information of a subtitle stream selected by PG stream selection. If the PSR indicates On, the video plane cropping unit  performs cropping processing of video plane based on video shift_mode_set in the PSR. If the PSR indicates Off, the video plane cropping unit  does not perform the cropping processing. With such a structure, it is possible to set an appropriate video_shift_mode for each subtitle.","As shown in , video_shift_mode is stored in the stream additional information  of the stream selection information such that PG streams whose shift modes video_shift_mode has the same attribute are registered in a row in the stream selection table. A remote control of the 2D\/3D playback device generally includes a subtitle switching button. A user operation is defined such that each time the user presses the subtitle switching button, PG streams sequentially switch in the order of subtitle streams registered in the stream selection table. In the case where the user switches a subtitle using the subtitle switching button of the remote control, the video plane frequently moves upward and downward. As a result, the video becomes difficult to watch, and the user has an uncomfortable feeling. Accordingly, PG streams whose shift modes video_shift_mode has the same attribute are registered in a row in the stream selection table, as shown in . For example, in the example shown in , subtitle entries - each have a video_shift_mode=Keep, subtitle entries - each have a video_shift mode=Up, and subtitle entries - each have a video_shift_mode=Down. By collectively arranging subtitles having the same video shift mode in this way, it is possible to prevent frequent shift of the video plane.","In the case where the video_shift_mode instantly switches among \u201cKeep\u201d, \u201cUp\u201d, and \u201cDown\u201d, the user feels unnatural. Accordingly, the video_shift_mode preferably switches among \u201cKeep\u201d, \u201cUp\u201d, and \u201cDown\u201d with a smooth effect. In this case, shift processing of the PG plane is preferably performed after completion of shift of the video plane.","In the present embodiment, the method has been described in which black frames are dynamically collected in the upper region or the lower region on the screen. Alternatively, the following structure may be employed, as shown in the upper level of . Specifically, a main feature video is arranged not in the middle of the screen but a slightly upper side of the screen so as to create a video stream, more black frames are arranged in the lower side so as to use the lower side for displaying subtitles. With such a structure, the black frames do not need to be dynamically changed for displaying subtitles. As a result, the videos do not move upward and downward, and the user does not feel uncomfortable.","As described with reference to , in the palette information of the PG stream, a clear and colorless color is fixedly assigned to the color whose ID is . The 2D\/3D playback device may control the value of this color to create a black frame. Specifically, the value of the color whose ID is  is stored in a system parameter PSR. The 2D\/3D playback device changes the color whose ID is  of the PG plane in accordance with the PSR. With such a structure, by setting a background color of a subtitle to the color whose ID is , the subtitle is displayed using a transparent color and the background can be seen through the subtitle in the normal state, as shown in the left side on the lower level of . By changing the color whose ID is  to an untransparent color, it is possible to change the background color of the subtitle, as shown in the right side on the lower level of . The value of PSR can be set on the menu screen of the BD program or the like.","The present embodiment describes an example structure of a playback device () for playing back the data of the structure described in an earlier embodiment, which is realized by using an integrated circuit .","A medium interface unit  receives (reads) data from the medium, and transfers the data to the integrated circuit . Note that the medium interface unit  receives the data of the structure described in the earlier embodiment. The medium interface unit  is, for example: a disc drive when the medium is the optical disc or hard disk; a card interface when the medium is the semiconductor memory such as the SD card or the USB memory; a CAN tuner or Si tuner when the medium is broadcast waves of broadcast including the CATV; or a network interface when the medium is the Ethernet\u2122, wireless LAN, or wireless public line.","A memory  is a memory for temporarily storing the data received (read) from the medium, and the data that is being processed by the integrated circuit . For example, the SDRAM (Synchronous Dynamic Random Access Memory), DDRx SDRAM (Double-Date-Ratex Synchronous Dynamic Random Access Memory; x=1, 2, 3 . . . ) or the like is used as the memory . Note that the number of the memories  is not fixed, but may be one or two or more, depending on the necessity.","The integrated circuit  is a system LSI for performing the video\/audio processing onto the data transferred from the interface unit , and includes a main control unit , a stream processing unit , a signal processing unit , an AV output unit , and a memory control unit .","The main control unit  includes a processor core having the timer function and the interrupt function. The processor core controls the integrated circuit  as a whole according to the program stored in the program memory or the like. Note that the basic software such as the OS (operating software) is stored in the program memory or the like in advance.","The stream processing unit , under the control of the main control unit , receives the data transferred from the medium via the interface unit  and stores it into the memory  via the data bus in the integrated circuit . The stream processing unit , under the control of the main control unit , also separates the received data into the video-base data and the audio-base data. As described earlier, on the medium, AV clips for 2D\/L including left-view video stream and AV clips for R including right-view video stream are arranged in an interleaved manner, in the state where each clip is divided into some Extents. Accordingly, the main control unit  performs the control so that, when the integrated circuit  receives the left-eye data including left-view video stream, the received data is stored in the first region in the memory ; and when the integrated circuit  receives the right-eye data including right-view video stream, the received data is stored in the second region in the memory . Note that the left-eye data belongs to the left-eye Extent, and the right-eye data belongs to the right-eye Extent. Also note that the first and second regions in the memory  may be regions generated by dividing a memory logically, or may be physically different memories. Further note that although the present embodiment presumes that the left-eye data including the left-view video stream is the main-view data, and the right-eye data including the right-view video stream is the sub-view data, the right-eye data may be the main-view data and the left-eye data may be the sub-view data. Also, the graphics stream is multiplexed in either or both of the main-view data and the sub-view data.","The signal processing unit , under the control of the main control unit , decodes, by an appropriate method, the video-base data and the audio-base data separated by the stream processing unit . The video-base data has been recorded after being encoded by a method such as MPEG-2, MPEG-4 AVC, MPEG-4 MVC, or SMPTE VC-1. Also, the audio-base data has been recorded after being compress-encoded by a method such as Dolby AC-3, Dolby Digital Plus, MLP, DTS, DTS-HD, or Linear PCM. Thus, the signal processing unit  decodes the video-base data and the audio-base data by the methods corresponding thereto. Models of the signal processing unit  are various decoders of Embodiment 1 shown in .","The memory control unit  mediates the access to the memory  from each functional block in the integrated circuit .","The AV output unit , under the control of the main control unit , performs the superimposing of the video-base data having been decoded by the signal processing unit , or format conversion of the video-base data and the like, and outputs the data subjected to such processes to the outside of the integrated circuit .",{"@attributes":{"id":"p-1103","num":"1108"},"figref":"FIG. 101","b":["5","5","51","52","53"]},"The device\/stream interface unit  is an interface for transferring data between the interface unit  and the integrated circuit . The device\/stream interface unit  may be: SATA (Serial Advanced Technology Attachment), ATAPI (Advanced Technology Attachment Packet Interface), or PATA (Parallel Advanced Technology Attachment) when the medium is the optical disc or the hard disk; a card interface when the medium is the semiconductor memory such as the SD card or the USB memory; a tuner interface when the medium is broadcast waves of broadcast including the CATV; or a network interface when the medium is the Ethernet, wireless LAN, or wireless public line. The device\/stream interface unit  may have a part of the function of the interface unit , or the interface unit  may be embedded in the integrated circuit , depending on the type of the medium.","The demultiplexing unit  separates the playback data, transferred from the medium, including video and audio, into the video-base data and the audio-base data. Each Extent, having been described earlier, is composed of source packets of video, audio, PG (subtitle), IG (menu) and the like (dependent source packets may not include audio). The demultiplexing unit  separates the playback data into video-base TS packets and audio-base TS packets based on the PID (identifier) included in each source packet. The demultiplexing unit  transfers the data after the separation to the signal processing unit . The data on which the processing has been performed is directly transferred to the signal processing unit , or is stored in the memory  and then transferred to the signal processing unit . A model of the demultiplexing unit  is, for example, the source depacketizer and the PID filter of Embodiment 8 as shown in . Also, a graphics stream, as a single stream, which has not been multiplexed with main view data or sub view data is transmitted to the signal processing unit  without being processed by the demultiplexing unit .","The switching unit  switches the output destination (storage destination) so that, when the device\/stream interface unit  receives the left-eye data, the received data is stored in the first region in the memory ; and when the switching unit  receives the right-eye data, the received data is stored in the second region in the memory . Here, the switching unit  is, for example, DMAC (Direct Memory Access Controller).  is a conceptual diagram showing the switching unit  and the peripheral when the switching unit  is DMAC. The DMAC, under the control of the main control unit , transmits the data received by the device stream interface and the data storage destination address to the memory control unit . More specifically, the DMAC switches the output destination (storage destination) depending on the received data, by transmitting Address  (the first storage region) to the memory control unit  when the device stream interface receives the left-eye data, and transmitting Address  (the second storage region) to the memory control unit  when the device stream interface receives the right-eye data. The memory control unit  stores data into the memory  in accordance with the storage destination address sent from the DMAC. Note that a dedicated circuit for controlling the switching unit  may be provided, instead of the main control unit .","In the above description, the device\/stream interface unit , demultiplexing unit , and switching unit  are explained as a typical structure of the stream processing unit . However, the stream processing unit  may further include an encryption engine unit for decrypting received encrypted data, key data or the like, a secure management unit for controlling the execution of a device authentication protocol between the medium and the playback device and for holding a secret key, and a controller for the direct memory access. In the above, it has been explained that, when the data received from the medium is stored into the memory , the switching unit  switches the storage destination depending on whether the received data is left-eye data or right-eye data. However, not limited to this, the data received from the medium may be temporarily stored into the memory , and then, when the data is to be transferred to the demultiplexing unit , the data may be separated into the left-eye data and the right-eye data.",{"@attributes":{"id":"p-1108","num":"1113"},"figref":"FIG. 103","b":["8","8","81","82","83"]},"The image superimposing unit  superimposes the decoded video-base data. More specifically, the image superimposing unit  superimposes the PG (subtitle) and the IG (menu) onto the left-view video data or the right-view video data in units of pictures. A model of the image superimposing unit  is, for example, Embodiment 1 and . More specifically, decoded video data and subtitle data are stored in a region of the memory  for storing data to be rendered in each plane. Here, the plane is a region included in the memory  or a virtual space. The image superimposing unit  superimposes a left-view plane with a subtitle plane corresponding thereto, and superimposes a right-view plane with a subtitle plane corresponding thereto. Then, based on a region-saving flag corresponding to subtitle data (stream) to be superimposed, the left-view plane and the right-view plane are each superimposed with the subtitle data such that the subtitle data is superimposed in a display region for the subtitle data indicated by the region-saving flag (for example, Embodiment 1 and ). In other words, if the region-saving flag indicates the display region for the subtitle data as the upper end, the left-view plane and the right-view plane are each shifted downward in the vertical coordinate, and superimposed with subtitle data. If the region-saving flag indicates the display region for the subtitle data as the lower end, the left-view plane and the right-view plane are each shifted upward in the vertical coordinate, and superimposed with subtitle data.","The video output format converting unit  performs the following processes and the like as necessary: the resize process for enlarging or reducing the decoded video-base data; the IP conversion process for converting the scanning method from the progressive method to the interlace method and vice versa; the noise reduction process for removing the noise; and the frame rate conversion process for converting the frame rate.","The audio\/video output interface unit  encodes, in accordance with the data transmission format, the video-base data, which has been subjected to the image superimposing and the format conversion, and the decoded audio-base data. Note that, as will be described later, the audio\/video output interface unit  may be provided outside the integrated circuit .",{"@attributes":{"id":"p-1112","num":"1117"},"figref":["FIG. 104","FIG. 103"],"b":["8","3","83","83","83","83"],"i":["a","b","c. "]},"The analog video output interface unit converts and encodes the video-base data, which has been subjected to the image superimposing process and the output format conversion process, into the analog video signal format, and outputs the conversion result. The analog video output interface unit is, for example: a composite video encoder that supports any of the NTSC method, PAL method, and SECAM method; an encoder for the S image signal (Y\/C separation); an encoder for the component image signal; or a DAC (D\/A converter).","The digital video\/audio output interface unit overlays the decoded audio-base data with the video-base data having been subjected to the image superimposing and the output format conversion, encrypts the overlaid data, encodes in accordance with the data transmission standard, and outputs the encoded data. The digital video\/audio output interface unit is, for example, HDMI (High-Definition Multimedia Interface).","The analog audio output interface unit , being an audio DAC or the like, performs the D\/A conversion onto the decoded audio-base data, and outputs analog audio data.","The transmission format of the video-base data and audio-base data may be switched depending on the data receiving device (data input terminal) supported by the display device\/speaker , or may be switched in accordance with the selection by the user. Furthermore, it is possible to transmit a plurality of pieces of data corresponding to the same content in parallel by a plurality of transmission formats, not limited to the transmission by a single transmission format.","In the above description, the image superimposing unit , video output format converting unit , and audio\/video output interface unit  are explained as a typical structure of the AV output unit . However, the AV output unit  may further include, for example, a graphics engine unit for performing the graphics processing such as the filter process, image overlaying, curvature drawing, and 3D display.","This completes the description of the structure of the playback device in the present embodiment. Note that all of the functional blocks included in the integrated circuit  may not be embedded, and that, conversely, the memory  shown in  may be embedded in the integrated circuit . Also, in the present embodiment, the main control unit  and the signal processing unit  have been described as different functional blocks. However, not limited to this, the main control unit  may perform a part of the process performed by the signal processing unit .","Also, as shown in , the process performed by the playback device in the present embodiment may be performed by the display device. In that case, the data received by the medium interface unit  is subjected to the signal processing performed by the integrated circuit , and the video data after this processing is output via the display drive unit  onto the display panel  and the audio data after this processing is output onto the speaker . Here, the AV output unit  has, for example, a structure shown in , and the data is transferred via the video output interface unit  and the audio output interface unit  that are provided inside or outside the integrated circuit . Note that the device may be provided with a plurality of video output interface units  and a plurality of audio output interface units , or may be provided with an interface unit that is common to the video and the audio.","The route of the control buses and the data buses in the integrated circuit  is designed in an arbitrary manner depending on the processing procedure of each processing block or the contents of the processing. However, the data buses may be arranged so that the processing blocks are connected directly as shown in , or maybe arranged so that the processing blocks are connected via the memory  (the memory control unit ) as shown in .","The integrated circuit  may be a multi-chip module that is generated by enclosing a plurality of chips into one package, and its outer appearance is one LSI.","It is also possible to realize the system LSI by using the FPGA (Field Programmable Gate Array) that can be re-programmed after the manufacturing of the LSI, or the reconfigurable processor in which the connection and setting of the circuit cells inside the LSI can be reconfigured.","Next, the operation of the playback device having the above-described structure will be explained.",{"@attributes":{"id":"p-1124","num":"1129"},"figref":"FIG. 109"},"S: data is received (read) from the medium (the medium interface unit  and the stream processing unit ).","S: the data received (read) in S is separated into various data (the video-base data and the audio-base data) (the stream processing unit ).","S: the various data generated by the separation in S are decoded by the appropriate format (the signal processing unit ).","S: among the various data decoded in S, the video-base data is subjected to the superimposing process (the AV output unit ).","S: the video-base data and the audio-base data having been subjected to the processes in S through S are output (the AV output unit ).",{"@attributes":{"id":"p-1130","num":"1135"},"figref":"FIG. 110","b":"6"},"S: the device\/stream interface unit  of the stream processing unit  receives (reads out) data (playlist, clip information, etc.) which is other than the data stored in the medium to be played back and is necessary for playback of the data, via the interface unit , and stores the received data into the memory  (the interface unit , the device\/stream interface unit , the memory control unit , and the memory ).","S: the main control unit  recognizes the compression method of the video and audio data stored in the medium by referring to the stream attribute included in the received clip information, and initializes the signal processing unit  so that the corresponding decode processing can be performed (the main control unit ).","S: the device\/stream interface unit  of the stream processing unit  receives (reads out) the data of video\/audio that is to be played back, from the medium via the interface unit , and stores the received data into the memory  via the stream processing unit  and the memory control unit . Note that the data is received (read) in units of Extents, and the main control unit  controls the switching unit  so that, when the left-eye data is received (read), the received data is stored in the first region; and when the right-eye data is received (read), the received data is stored in the second region, and the switching unit  switches the data output destination (storage destination) (the interface unit , the device\/stream interface unit , the main control unit , the switching unit , the memory control unit , and the memory ).","S: the data stored in the memory  is transferred to the demultiplexing unit  of the stream processing unit , and the demultiplexing unit  identifies the video-base data (main video, sub-video), PG (subtitle), IG (menu), and audio-base data (audio, sub-audio) based on the PIDs included in the source packets constituting the stream data, and transfers the data to each corresponding decoder in the signal processing unit  in units of TS packets (the demultiplexing unit ).","S: each decoder in the signal processing unit  performs the decode process onto the transferred TS packets by the appropriate method (the signal processing unit ).","S: among the video-base data decoded by the signal processing unit , the data corresponding to the left-view video stream and the right-view video stream is resized based on the display device  (the video output format converting unit ).","S: the PG (subtitle) and IG (menu) are superimposed onto the video stream resized in S (the image superimposing unit ).","S: the IP conversion, which is a conversion of the scanning method, is performed onto the video data after the superimposing in  (the video output format converting unit ).","S: the encoding, D\/A conversion and the like are performed onto video-base data and the audio-base data having been subjected to the above-described processes, based on the data output format of the display device\/speaker or the data transmission format for transmission to the display device\/speaker . For example, processing is performed on the video-base data and the audio-base data so as to be outputted in analog or digital format. The composite video signal, the S image signal, the component image signal and the like are supported for the analog output of the video-base data. Also, HDMI is supported for the digital output of the video-base data and the audio-base data. (the audio\/video output interface unit ).","S: the video-base data and the audio-base data having been subjected to the process in S is output and transmitted to the display device\/speaker (the audio\/video output interface unit , the display device\/speaker ).","This completes the description of the operation procedure of the playback device in the present embodiment. Note that the result of process may be temporarily stored into the memory  each time a process is completed. Note that when the playback process is performed by the display device shown in , the operation procedure is basically the same, and functional blocks corresponding to the functional blocks of the playback device shown in  perform the processes similarly. Also, in the above operation procedure, the video output format converting unit  performs the resize process and the IP conversion process. However, not limited to this, the processes may be omitted as necessary, or other processes (noise reduction process, frame rate conversion process, etc.) may be performed. Furthermore, the processing procedures may be changed if possible.","(Supplementary Notes)","Up to now, the present invention has been described through the best embodiments that the Applicant recognize as of now. However, further improvements or changes can be added regarding the following technical topics. Whether to select any of the embodiments or the improvements and changes to implement the invention is optional and may be determined by the subjectivity of the implementer.","(Offset Metadata)","Offset metadata described in the embodiments may be realized by not only the data formats described above but also other data formats. The following lists other data formats of offset metadata.",{"@attributes":{"id":"p-1146","num":"1151"},"figref":"FIG. 89"},"In the first data format, offset metadata is stored in a clip information file. In this case, as shown in , it may be possible to include table information in which PTS and offset amounts of a plurality of pieces of offset_id are included. A specific syntax is shown in .",{"@attributes":{"id":"p-1148","num":"1153"},"figref":["FIG. 90","FIG. 90A","FIG. 90B","FIG. 89"]},{"@attributes":{"id":"p-1149","num":"1154"},"figref":["FIG. 91","FIG. 91A","FIG. 91B"],"b":["11201","11202","11203"]},{"@attributes":{"id":"p-1150","num":"1155"},"figref":["FIG. 92","FIG. 92A","FIG. 92B"]},{"@attributes":{"id":"p-1151","num":"1156"},"figref":"FIG. 93"},"The fifth data format is a yet another data format for storing offset metadata in a playlist information file. As shown in , a reference ID (ref_playitem_id_of_same_offset_metadata) for a playitem using the same offset metadata is additionally included. When \u201cref_playitem_id_of_same_offset_metadata\u201d does not indicate 0xFFFF representing invalid, the 2D\/3D playback device applies the offset metadata that is the same as a playitem indicated by the \u201cref_playitem_id_of_same_offset_metadata\u201d. With this structure, it is only necessary to define one piece of offset metadata with respect to a plurality of playitems having the same offset metadata. This can reduce the data amount.",{"@attributes":{"id":"p-1153","num":"1158"},"figref":"FIG. 94"},"The sixth data format is a yet another format for storing offset metadata in a playlist information file.","In this data format, a header in which loop is performed in units of playitems and a region in which offset metadata is stored are separately provided, as shown in . A playitem is associated with a piece of offset metadata by offset_block_id. With this structure, in the case where a plurality of playitems using the same piece of offset metadata are included, it is only necessary to define one piece of offset metadata. This can reduce a data amount. Also, the header may store therein an address value (start_address) of a file in which a corresponding piece of offset metadata is stored. This structure facilitates access in units of playitems.","In the syntax shown in  to , an entry of offset metadata is composed of 7-bit \u201coffset_direction,offset_value\u201d. Alternatively, offset metadata may be prepared by using the difference from a certain sequence of offset metadata. This structure can decrease the size of \u201coffset_direction,offset_value\u201d.","As another data format, it may be possible to employ a structure in which offset metadata is embedded on an audio stream using audio watermark technique. Alternatively, it may be possible to employ a structure in which offset metadata is embedded on a video stream using video watermark technique.","(PG Stream)","In order to reduce the number of subtitles to suppress increase in the band of streams, it is effective to share one PG stream as one of a PG stream for use in the \u201c1 plane+offset\u201d method PG stream and either a left-eye or right-eye PG stream for use in the 2 plane L\/R method.","However, if such a structure is employed, there is a case where shift occurs between a position in which a depth between the left-eye graphics and the right eye graphics is large (position in which the graphicses protrude toward the user) and a position in which the depth is small, as shown in . In such a case, each of the graphicses moves between right and left. In an example shown in , if subtitle data is shift from a scene having a small depth to a scene having a large depth, the left-eye graphics is shifted in the right direction, and the right eye graphics is shifted in the left direction. If the left-eye graphics is used for the 2D display and the 1 plane+offset method, the left-eye graphics is shifted in the left direction in the same way. This causes the user to feel uncomfortable.","In view of this problem, in order to display the 2D display subtitle and the 1 plane+offset method subtitle without causing the user to feel uncomfortable, the display position of the composition information is fixed, as shown in . Also, an offset (I_offset) for displaying as a 2 plane L\/R method left-eye PG is separately prepared in the composition information. In the case where display is performed in accordance with the 2 plane L\/R method, the 2D\/3D playback device adds the offset value to the display position of the composition information for display. With such a structure, even in the case where the same stream is used for the 2D display subtitle, the 1 plane+offset method subtitle, and the 2 plane L\/R method left-eye subtitle, it is possible to perform display in any display mode without causing the user to feel uncomfortable.","(Speed Increase in Jump Playback)",{"@attributes":{"id":"p-1163","num":"1168"},"figref":"FIG. 97A","b":["2","2","2","2","2","2"]},"In view of this, in order to reduce a time period from loading to the entry point to starting playback, the structure as shown in  is employed. In , a File2D indicates data regions L[], L[], L[] for 2D, and L[] on the disc. A FileSS indicates data regions L[], L[], L[] for 3D, and L[] on the disc. The L[] for 2D and the L[] for 3D are structured so as to have the same data. With such a structure, the same data can be read although different playback paths are used.  shows the structure in which data of a right eye AV clip corresponding to the data region L[] for 3D is interleaved in small units (range indicated by an arrow ). With such a structure, in the case where the 2D\/3D playback device starts playback from the entry point, it is possible to structure a head extent of the FileDependent smaller compared with the structure shown in . This can reduce a time period from starting at the entry point to the start of decoding.","(Additional Information)","Additional information may be incorporated into an extension information field of playlist information, as an extension stream selection table that includes information elements shown below.","An \u201cupper end region flag\u201d is a flag indicating whether there is an upper end region during playback of a PG_text subtitle stream.","An \u201cupper end region stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which a playback path of a PG_text subtitle stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the PG_text subtitle stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the PG_text subtitle stream in this stream file.","\u201cUpper end region depth reference information\u201d is reference information for referring an offset sequence for a PG_text subtitle stream in the case where subtitles are displayed in the upper end region, and indicates an offset sequence for a PG_text subtitle stream in the case where subtitles are displayed in the upper end region. The playback device should apply the offset, which is supplied by this field, to the PG plane.","A \u201clower end region flag\u201d is a flag indicating whether there is a lower end region during playback of a PG_text subtitle stream.","A \u201clower end region stream entry\u201d includes: a sub-path identifier reference (ref_to_Subpath_id) specifying a sub-path to which a playback path of a PG_text subtitle stream belongs; a stream file reference (ref_to_subClip_entry_id) specifying a stream file in which the PG_text subtitle stream is stored; and a packet identifier (ref_to_stream_PID_subclip) of the PG_text subtitle stream in this stream file.","\u201cLower end region depth reference information\u201d is reference information for referring an offset sequence for a PG_text subtitle stream in the case where subtitles are displayed in the lower end region, and indicates an offset sequence for a PG_text subtitle stream in the case where subtitles are displayed in the lower end region. The playback device should apply the offset, which is supplied by this field, to the PG plane.","(Playback of Optical Disc)","The BD-ROM drive is equipped with an optical head that includes a semiconductor laser, collimated lens, beam splitter, objective lens, collecting lens, and light detector. The light beams emitted from the semiconductor laser pass through the collimated lens, beam splitter, and objective lens, and are collected on the information surface of the optical disc.","The collected light beams are reflected\/diffracted on the optical disc, pass through the objective lens, beam splitter, and collimated lens, and are collected in the light detector. A playback signal is generated depending on the amount of light collected in the light detector.","(Variations of Recording Medium)","The recording medium described in each Embodiment indicates a general package medium as a whole, including the optical disc and the semiconductor memory card. In each Embodiment, it is presumed, as one example, that the recording medium is an optical disc in which necessary data is recorded in advance (for example, an existing read-only optical disc such as the BD-ROM or DVD-ROM). However, the present invention is not limited to this. For example, the present invention may be implemented as follows: (i) obtain a 3D content that includes the data necessary for implementing the present invention and is distributed by a broadcast or via a network; (ii) record the 3D content into a writable optical disc (for example, an existing writable optical disc such as the BD-RE, DVD-RAM) by using a terminal device having the function of writing into an optical disc (the function may be embedded in a playback device, or the device may not necessarily be a playback device); and (iii) apply the optical disc recorded with the 3D content to the playback device of the present invention.","The following describes embodiments of the recording device for recording the data structure of each Embodiment into a semiconductor memory, and the playback device for playing back thereof.","First, the mechanism for protecting the copyright of the data recorded on the BD-ROM will be explained, as a presupposed technology.","Some of the data recorded on the BD-ROM may have been encrypted as necessitated in view of the confidentiality of the data.","For example, the BD-ROM may contain, as encrypted data, the data corresponding to a video stream, an audio stream, or a stream including these.","The following describes decryption of the encrypted data among the data recorded on the BD-ROM.","The semiconductor memory card playback device stores in advance data (for example, a device key) that corresponds to a key that is necessary for decrypting the encrypted data recorded on the BD-ROM.","On the other hand, the BD-ROM is recorded in advance with (i) data (for example, a medium key block (MKB) corresponding to the above-mentioned device key) that corresponds to a key that is necessary for decrypting the encrypted data, and (ii) encrypted data (for example, an encrypted title key corresponding to the above-mentioned device key and MKB) that is generated by encrypting the key itself that is necessary for decrypting the encrypted data. Note here that the device key, MKB, and encrypted title key are treated as a set, and are further associated with an identifier (for example, a volume ID) written in an area (called BCA) of the BD-ROM that cannot be copied in general. It is structured such that encrypted data cannot be decrypted if these elements are combined incorrectly. Only if the combination is correct, a key (for example, a title key that is obtained by decrypting the encrypted title key by using the above-mentioned device key, MKB, and volume ID) that is necessary for decrypting the encrypted data can be derived. The encrypted data can be decrypted by using the derived key.","When a playback device attempts to play back a BD-ROM loaded in the device, it cannot play back the encrypted data unless the device itself has a device key that makes a pair (or corresponds to) the encrypted title key and MKB recorded on the BD-ROM. This is because the key (title key) that is necessary for decrypting the encrypted data has been encrypted, and is recorded on the BD-ROM as the encrypted title key, and the key that is necessary for decrypting the encrypted data cannot be derived if the combination of the MKB and the device key is not correct.","Conversely, when the combination of the encrypted title key, MKB, device key, and volume ID is correct, the video stream and audio stream are decoded by the video decoder and the audio decoder with use of the above-mentioned key (for example, a title key that is obtained by decrypting the encrypted title key by using the device key, MKB, and volume ID) that is necessary for decrypting the encrypted data. The playback device is structured in this way.","This completes the description of the mechanism for protecting the copyright of the data recorded on the BD-ROM. It should be noted here that this mechanism is not limited to the BD-ROM, but may be applicable to, for example, a readable\/writable semiconductor memory (such as a portable semiconductor memory such as the SD card) for the implementation.","Next, the playback procedure in the semiconductor memory card playback device will be described. In the case in which the playback device plays back an optical disc, it is structured to read data via an optical disc drive, for example. On the other hand, in the case in which the playback device plays back a semiconductor memory card, it is structured to read data via an interface for reading the data from the semiconductor memory card.","More specifically, the playback device may be structured such that, when a semiconductor memory card is inserted into a slot provided in the playback device, the playback device and the semiconductor memory card are electrically connected with each other via the semiconductor memory card interface, and the playback device reads out data from the semiconductor memory card via the semiconductor memory card interface.","The playback device explained in each Embodiment may be realized as a terminal device that receives data (distribution data) that corresponds to the data explained in each Embodiment from a distribution server for an electronic distribution service, and records the received data into a semiconductor memory card.","Such a terminal device may be realized by structuring the playback device explained in each Embodiment so as to perform such operations, or may be realized as a dedicated terminal device that is different from the playback device explained in each Embodiment and stores the distribution data into a semiconductor memory card. Here, a case where the playback device is used will be explained. Also, in this explanation, an SD card is used as the recording-destination semiconductor memory.","When the playback device is to record distribution data into an SD memory card inserted in a slot provided therein, the playback device first send requests a distribution server that stores distribution data, to transmit the distribution data. In so doing, the playback device reads out identification information for uniquely identifying the inserted SD memory card (for example, identification information uniquely assigned to each SD memory card, more specifically, the serial number or the like of the SD memory card), from the SD memory card, and transmits the read identification information to the distribution server together with the distribution request.","The identification information for uniquely identifying the SD memory card corresponds to, for example, the volume ID having been described earlier.","On the other hand, the distribution server stores necessary data (for example, video stream, audio stream and the like) in an encrypted state such that the necessary data can be decrypted by using a predetermined key (for example, a title key).","The distribution server, for example, holds a private key so that it can dynamically generate different pieces of public key information respectively in correspondence with identification numbers uniquely assigned to each semiconductor memory card.","Also, the distribution server is structured to be able to encrypt the key (title key) itself that is necessary for decrypting the encrypted data (that is to say, the distribution server is structured to be able to generate an encrypted title key).","The generated public key information includes, for example, information corresponding to the above-described MKB, volume ID, and encrypted title key. With this structure, when, for example, a combination of the identification number of the semiconductor memory card, the public key contained in the public key information which will be explained later, and the device key that is recorded in the playback device in advance, is correct, a key (for example, a title key that is obtained by decrypting the encrypted title key by using the device key, the MKB, and the identification number of the semiconductor memory) necessary for decrypting the encrypted data is obtained, and the encrypted data is decrypted by using the obtained necessary key (title key).","Following this, the playback device records the received piece of public key information and distribution data into a recording region of the semiconductor memory card being inserted in the slot thereof.","Next, a description is given of an example of the method for decrypting and playing back the encrypted data among the data contained in the public key information and distribution data recorded in the recording region of the semiconductor memory card.","The received public key information stores, for example, a public key (for example, the above-described MKB and encrypted title key), signature information, identification number of the semiconductor memory card, and device list being information regarding devices to be invalidated.","The signature information includes, for example, a hash value of the public key information.","The device list is, for example, information for identifying the devices that might be played back in an unauthorized manner. The information, for example, is used to uniquely identify the devices, parts of the devices, and functions (programs) that might be played back in an unauthorized manner, and is composed of, for example, the device key and the identification number of the playback device that are recorded in the playback device in advance, and the identification number of the decoder provided in the playback device.","The following describes playing back the encrypted data among the distribution data recorded in the recording region of the semiconductor memory card.","First, it is checked whether or not the decryption key itself can be used, before the encrypted data is decrypted by using the decryption key.","More specifically, the following checks are conducted. (1) A check on whether the identification information of the semiconductor memory card contained in the public key information matches the identification number of the semiconductor memory card stored in advance in the semiconductor memory card. (2) A check on whether the hash value of the public key information calculated in the playback device matches the hash value included in the signature information. (3) A check, based on the information included in the device list, on whether the playback device to perform the playback is authentic (for example, the device key shown in the device list included in the public key information matches the device key stored in advance in the playback device). These checks may be performed in any order.","After the above described checks (1) through (3), the playback device performs a control not to decrypt the encrypted data when any of the following conditions is satisfied: (i) the identification information of the semiconductor memory card contained in the public key information does not match the identification number of the semiconductor memory card stored in advance in the semiconductor memory card; (ii) the hash value of the public key information calculated in the playback device does not match the hash value included in the signature information; and (iii) the playback device to perform the playback is not authentic.","On the other hand, when all of the conditions: (i) the identification information of the semiconductor memory card contained in the public key information matches the identification number of the semiconductor memory card stored in advance in the semiconductor memory card; (ii) the hash value of the public key information calculated in the playback device matches the hash value included in the signature information; and (iii) the playback device to perform the playback is authentic, are satisfied, it is judged that the combination of the identification number of the semiconductor memory, the public key contained in the public key information, and the device key that is recorded in the playback device in advance, is correct, and the encrypted data is decrypted by using the key necessary for the decryption (the title key that is obtained by decrypting the encrypted title key by using the device key, the MKB, and the identification number of the semiconductor memory).","When the encrypted data is, for example, a video stream and an audio stream, the video decoder decrypts (decodes) the video stream by using the above-described key necessary for the decryption (the title key that is obtained by decrypting the encrypted title key), and the audio decoder decrypts (decodes) the audio stream by using the above-described key necessary for the decryption.","With such a structure, when devices, parts of the devices, and functions (programs) that might be used in an unauthorized manner are known at the time of the electronic distribution, a device list showing such devices and the like may be distributed. This enables the playback device having received the list to inhibit the decryption with use of the public key information (public key itself) when the playback device includes anything shown in the list. Therefore, even if the combination of the identification number of the semiconductor memory, the public key itself contained in the public key information, and the device key that is recorded in the playback device in advance, is correct, a control is performed not to decrypt the encrypted data. This makes it possible to prevent the distribution data from being used by an unauthentic device.","It is preferable that the identifier of the semiconductor memory card that is recorded in advance in the semiconductor memory card is stored in a highly secure recording region. This is because, when the identification number (for example, the serial number of the SD memory card) that is recorded in advance in the semiconductor memory card is tampered with, unauthorized copying becomes easy. More specifically, unique, although different identification numbers are respectively assigned to semiconductor memory cards, if the identification numbers are tampered with to be the same, the above-described judgment in (1) does not make sense, and as many semiconductor memory cards as tampering may be copied in an unauthorized manner.","For this reason, it is preferable that information such as the identification number of the semiconductor memory card is stored in a highly secure recording region.","To realize this, the semiconductor memory card, for example, may have a structure in which a recording region for recording highly confidential data such as the identifier of the semiconductor memory card (hereinafter, the recording region is referred to as a \u201csecond recording region\u201d) is provided separately from a recording region for recording regular data (hereinafter, the recording region is referred to as a \u201cfirst recording region\u201d), a control circuit for controlling accesses to the second recording region is provided, and the second recording region is accessible only through the control circuit.","For example, data may encrypted so that encrypted data is recorded in the second recording region, and the control circuit may be embedded with a circuit for decrypting the encrypted data. In this structure, when an access is made to the second recording region, the control circuit decrypts the encrypted data and returns decrypted data. As another example, the control circuit may hold information indicating the location where the data is stored in the second recording region, and when an access is made to the second recording region, the control circuit identifies the corresponding storage location of the data, and returns data that is read from the identified storage location.","An application, which is running on the playback device and is to record data onto the semiconductor memory card with use of the electronic distribution, issues, to the control circuit via a memory card interface, an access request requesting to access the data (for example, the identification number of the semiconductor memory card) recorded in the second recording region. Upon receiving the request, the control circuit reads out the data from the second recording region and returns the data to the application running on the playback device. It sends the identification number of the semiconductor memory card and requests the distribution server to distribute the data such as the public key information, and corresponding distribution data. The public key information and corresponding distribution data that are sent from the distribution server are recorded into the first recording region.","Also, it is preferable that the application, which is running on the playback device and is to record data onto the semiconductor memory card with use of the electronic distribution, checks in advance whether or not the application is tampered with before it issues, to the control circuit via a memory card interface, an access request requesting to access the data (for example, the identification number of the semiconductor memory card) recorded in the second recording region. For checking this, an existing digital certificate conforming to the X.509 standard, for example, may be used.","Also, the distribution data recorded in the first recording region of the semiconductor memory card  may not necessarily be accessed via the control circuit provided in the semiconductor memory card.","The information recording medium of the present invention stores a 3D image, but can be played back in both 2D-image playback devices and 3D-image playback devices. This makes it possible to distribute movie contents such as movie titles storing 3D images, without causing the consumers to be conscious about the compatibility. This activates the movie market and commercial device market. Accordingly, the recording medium and the playback device of the present invention have high usability in the movie industry and commercial device industry.",{"@attributes":{"id":"p-1218","num":"1223"},"b":"100"},{"@attributes":{"id":"p-1219","num":"1224"},"b":"200"},{"@attributes":{"id":"p-1220","num":"1225"},"b":"300"},{"@attributes":{"id":"p-1221","num":"1226"},"b":"400"}],"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND ART","CITATION LIST","Patent Literature","SUMMARY OF INVENTION","Technical Problem","Solution to Problem","Advantageous Effects of Invention","DESCRIPTION OF EMBODIMENTS","Embodiment 1","Modification Example","Embodiment 2","Embodiment 3","Embodiment 4","Embodiment 5","Embodiment 6","Embodiment 7","Embodiment 8","Embodiment 9","Embodiments of Semiconductor Memory Card Recording Device and Playback Device","Embodiments of Receiving Device","INDUSTRIAL APPLICABILITY","REFERENCE SIGNS LIST"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":[{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIGS. 1A through 1C"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIGS. 5A through 5C"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIGS. 6A and 6B"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIGS. 7A through 7D"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIGS. 8A and 8B"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIGS. 10A through 10C"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 12A","FIG. 12B"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIGS. 17A and 17B"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIGS. 18A and 18B"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIGS. 19A and 19B"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 23","b":"203"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 24","b":"24"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIGS. 25A and 25B","b":"32"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 26"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 30"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 31"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIGS. 32A and 32B"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIGS. 33A through 33C"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIGS. 34A through 34C"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIGS. 35A through 35C"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 36"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 37"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 38"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 39"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 40"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 41"},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 42"},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 43"},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 44"},{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 45"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIGS. 46A through 46C"},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 47"},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIG. 48"},{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIGS. 49A through 49D"},{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 50"},{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIGS. 51A and 51B"},{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 52"},{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 53"},{"@attributes":{"id":"p-0072","num":"0071"},"figref":"FIG. 54"},{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 55"},{"@attributes":{"id":"p-0074","num":"0073"},"figref":"FIGS. 56A and 56B"},{"@attributes":{"id":"p-0075","num":"0074"},"figref":"FIGS. 57A through 57D"},{"@attributes":{"id":"p-0076","num":"0075"},"figref":"FIGS. 58A through 58C","b":["1","2"]},{"@attributes":{"id":"p-0077","num":"0076"},"figref":"FIG. 59"},{"@attributes":{"id":"p-0078","num":"0077"},"figref":"FIG. 60"},{"@attributes":{"id":"p-0079","num":"0078"},"figref":"FIG. 61"},{"@attributes":{"id":"p-0080","num":"0079"},"figref":"FIG. 62"},{"@attributes":{"id":"p-0081","num":"0080"},"figref":"FIG. 63"},{"@attributes":{"id":"p-0082","num":"0081"},"figref":"FIGS. 64A and 64B"},{"@attributes":{"id":"p-0083","num":"0082"},"figref":"FIG. 65"},{"@attributes":{"id":"p-0084","num":"0083"},"figref":"FIG. 66"},{"@attributes":{"id":"p-0085","num":"0084"},"figref":"FIG. 67"},{"@attributes":{"id":"p-0086","num":"0085"},"figref":"FIG. 68"},{"@attributes":{"id":"p-0087","num":"0086"},"figref":"FIG. 69"},{"@attributes":{"id":"p-0088","num":"0087"},"figref":"FIG. 70"},{"@attributes":{"id":"p-0089","num":"0088"},"figref":"FIG. 71"},{"@attributes":{"id":"p-0090","num":"0089"},"figref":"FIGS. 72A through 72C"},{"@attributes":{"id":"p-0091","num":"0090"},"figref":"FIGS. 73A and 73B"},{"@attributes":{"id":"p-0092","num":"0091"},"figref":"FIGS. 74A and 74B"},{"@attributes":{"id":"p-0093","num":"0092"},"figref":"FIGS. 75A and 75B"},{"@attributes":{"id":"p-0094","num":"0093"},"figref":"FIGS. 76A and 76B"},{"@attributes":{"id":"p-0095","num":"0094"},"figref":"FIGS. 77A through 77C"},{"@attributes":{"id":"p-0096","num":"0095"},"figref":"FIGS. 78A and 78B"},{"@attributes":{"id":"p-0097","num":"0096"},"figref":"FIG. 79"},{"@attributes":{"id":"p-0098","num":"0097"},"figref":"FIG. 80"},{"@attributes":{"id":"p-0099","num":"0098"},"figref":"FIG. 81"},{"@attributes":{"id":"p-0100","num":"0099"},"figref":"FIG. 82"},{"@attributes":{"id":"p-0101","num":"0100"},"figref":"FIG. 83"},{"@attributes":{"id":"p-0102","num":"0101"},"figref":"FIG. 84"},{"@attributes":{"id":"p-0103","num":"0102"},"figref":"FIG. 85"},{"@attributes":{"id":"p-0104","num":"0103"},"figref":"FIG. 86"},{"@attributes":{"id":"p-0105","num":"0104"},"figref":"FIG. 87"},{"@attributes":{"id":"p-0106","num":"0105"},"figref":"FIGS. 88A and 88B"},{"@attributes":{"id":"p-0107","num":"0106"},"figref":"FIGS. 89A and 89B"},{"@attributes":{"id":"p-0108","num":"0107"},"figref":"FIGS. 90A and 90B"},{"@attributes":{"id":"p-0109","num":"0108"},"figref":"FIGS. 91A and 91B"},{"@attributes":{"id":"p-0110","num":"0109"},"figref":"FIGS. 92A and 92B"},{"@attributes":{"id":"p-0111","num":"0110"},"figref":"FIG. 93"},{"@attributes":{"id":"p-0112","num":"0111"},"figref":"FIG. 94"},{"@attributes":{"id":"p-0113","num":"0112"},"figref":"FIG. 95"},{"@attributes":{"id":"p-0114","num":"0113"},"figref":"FIG. 96"},{"@attributes":{"id":"p-0115","num":"0114"},"figref":"FIG. 97"},{"@attributes":{"id":"p-0116","num":"0115"},"figref":"FIG. 98"},{"@attributes":{"id":"p-0117","num":"0116"},"figref":"FIG. 99"},{"@attributes":{"id":"p-0118","num":"0117"},"figref":"FIG. 100"},{"@attributes":{"id":"p-0119","num":"0118"},"figref":"FIG. 101"},{"@attributes":{"id":"p-0120","num":"0119"},"figref":"FIG. 102"},{"@attributes":{"id":"p-0121","num":"0120"},"figref":"FIG. 103"},{"@attributes":{"id":"p-0122","num":"0121"},"figref":"FIG. 104"},{"@attributes":{"id":"p-0123","num":"0122"},"figref":"FIG. 105"},{"@attributes":{"id":"p-0124","num":"0123"},"figref":"FIG. 106"},{"@attributes":{"id":"p-0125","num":"0124"},"figref":"FIG. 107"},{"@attributes":{"id":"p-0126","num":"0125"},"figref":"FIG. 108"},{"@attributes":{"id":"p-0127","num":"0126"},"figref":"FIG. 109"},{"@attributes":{"id":"p-0128","num":"0127"},"figref":"FIG. 110"}]},"DETDESC":[{},{}]}
