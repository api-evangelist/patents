---
title: Altering access to a fibre channel fabric
abstract: A mechanism is provided for altering access to a network. A virtual I/O server controller in a virtual I/O server operating system receives an indication that an identified communications adapter requires attention. The virtual I/O server controller issues a set of calls to a set of N_port identification virtualization server adapters coupled to the identified communications adapter. Each of the set of calls indicates to each of the set of N_port identification virtualization server adapters a request to move a set of clients from their assigned port on the identified communications adapter to an available port on a failover communications adapter. The set of N_port identification virtualization server adapters moves the set of clients from the identified communications adapter to the failover communications adapter.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08274881&OS=08274881&RS=08274881
owner: International Business Machines Corporation
number: 08274881
owner_city: Armonk
owner_country: US
publication_date: 20090512
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The present application relates generally to an improved data processing apparatus and method and more specifically to an apparatus and method for altering access to a Fibre Channel fabric.","N_Port ID virtualization (NPIV) allows single Fibre Channel host bus adapters (HBAs) to register multiple worldwide port names (WWPN) with a fabric name server. A worldwide port name is a unique name in a Fibre Channel network. Each registered worldwide port name is assigned a unique identifier, such as a node port (N_Port) ID, when the worldwide port name connects to a fabric. With N_Port ID virtualization, a single Fibre Channel HBA may appear as multiple worldwide port names in the Fibre Channel fabric. Each NPIV server adapter that provides NPIV, connects to the Fibre Channel network through one or more Fibre Channel host bus adapters (FC HBAs). FC HBAs provide a connection of a host system to other network and storage devices through a Fibre Channel fabric.","In one illustrative embodiment, a method, in a data processing system, is provided for altering access to a network. The illustrative embodiment receives an indication that an identified communications adapter requires attention. The illustrative embodiment issues a set of calls to a set of N_port identification virtualization server adapters coupled to the identified communications adapter. In the illustrative embodiment, each of the set of calls indicates to each of the set of N_port identification virtualization server adapters a request to move a set of clients from their assigned port on the identified communications adapter to an available port on a failover communications adapter. The illustrative embodiment moves the set of clients from the identified communications adapter to the failover communications adapter.","In other illustrative embodiments, a computer program product comprising a computer useable or readable medium having a computer readable program is provided. The computer readable program, when executed on a computing device, causes the computing device to perform various ones, and combinations of, the operations outlined above with regard to the method illustrative embodiment.","In yet another illustrative embodiment, a system\/apparatus is provided. The system\/apparatus may comprise one or more processors and a memory coupled to the one or more processors. The memory may comprise instructions which, when executed by the one or more processors, cause the one or more processors to perform various ones, and combinations of, the operations outlined above with regard to the method illustrative embodiment.","These and other features and advantages of the present invention will be described in, or will become apparent to those of ordinary skill in the art in view of, the following detailed description of the example embodiments of the present invention.","Many problems arise when maintaining or replacing Fibre Channel host bus adapter (FC HBA) hardware, when moving workload from one FC HBA to another FC HBA, or when moving workload from one port on an FC HBA to another port on the same FC HBA. Known solutions to perform these operations typically require redundant hardware and\/or manual intervention from an administrator. Further, to maintain or replace a FC HBA, the administrator requires access to each of the targets for the FC HBAs involved. That is, administrator involvement is required to map worldwide port names (WWPNs) for ports on the FC MBA to target ports that are accessible to the client.","The illustrative embodiments provide a mechanism for using N_port identification virtualization (NPIV) to solve the same problems with minimal hardware and\/or administrator involvement. NPIV allows multiple clients to use a physical Fibre Channel port where each client is assigned a unique worldwide port name (WWPN). The illustrative embodiments use a Virtual I\/O Server (VIOS) as the controller; however, other types of intermediaries or Virtual Machine Managers (VMMs) may also be used, such as VMware\u00ae and Xen\u2122. The VIOS communicates with a plurality of physical Fibre Channel host bus adapters (FC HBAs) through a virtualization layer, which presents virtual FC HBAs using a plurality of worldwide port names. Each client's operating system utilizes a virtual NPIV adapter to connect to one or more ports on the virtual FC HBAs via a NPIV server adapter in the VIOS. The VIOS may forward appropriate fabric events received from the physical FC HBA ports to each client through their virtual NPIV adapter and\/or may queue Fibre Channel transactions for each client. The illustrative embodiments use the VIOS to map a client NPIV adapter from an assigned FC MBA port to another FC HBA port in the event of a FC HBA failure, maintenance of an FC HBA, workload balancing between two or more FC HBAs, or the like.","As will be appreciated by one skilled in the art, the present invention may be embodied as a system, method, or computer program product. Accordingly, the present invention may take the form of an entirely hardware embodiment, an entirely software embodiment (including firmware, resident software, micro-code, etc.) or an embodiment combining software and hardware aspects that may all generally be referred to herein as a \u201ccircuit,\u201d \u201cmodule\u201d or \u201csystem.\u201d Furthermore, the present invention may take the form of a computer program product embodied in any tangible medium of expression having computer usable program code embodied in the medium.","Any combination of one or more computer usable or computer readable medium(s) may be utilized. The computer-usable or computer-readable medium may be, for example, but not limited to, an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system, apparatus, device, or propagation medium. More specific examples (a non-exhaustive list) of the computer-readable medium would include the following: an electrical connection having one or more wires, a portable computer diskette, a hard disk, a random access memory (RAM), a read-only memory (ROM), an erasable programmable read-only memory (EPROM or Flash memory), an optical fiber, a portable compact disc read-only memory (CDROM), an optical storage device, a transmission media such as those supporting the Internet or an intranet, or a magnetic storage device. Note that the computer-usable or computer-readable medium could even be paper or another suitable medium upon which the program is printed, as the program can be electronically captured, via, for instance, optical scanning of the paper or other medium, then compiled, interpreted, or otherwise processed in a suitable manner, if necessary, and then stored in a computer memory. In the context of this document, a computer-usable or computer-readable medium may be any medium that can contain, store, communicate, propagate, or transport the program for use by or in connection with the instruction execution system, apparatus, or device. The computer-usable medium may include a propagated data signal with the computer-usable program code embodied therewith, either in baseband or as part of a carrier wave. The computer usable program code may be transmitted using any appropriate medium, including but not limited to wireless, wireline, optical fiber cable, radio frequency (RF), etc.","Computer program code for carrying out operations of the present invention may be written in any combination of one or more programming languages, including an object oriented programming language such as Java\u2122, Smalltalk\u2122, C++ or the like and conventional procedural programming languages, such as the \u201cC\u201d programming language or similar programming languages. The program code may execute entirely on the user's computer, partly on the user's computer, as a stand-alone software package, partly on the user's computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario, the remote computer may be connected to the user's computer through any type of network, including a local area network (LAN) or a wide area network (WAN), or the connection may be made to an external computer (for example, through the Internet using an Internet Service Provider). In addition, the program code may be embodied on a computer readable storage medium on the server or the remote computer and downloaded over a network to a computer readable storage medium of the remote computer or the users' computer for storage and\/or execution. Moreover, any of the computing systems or data processing systems may store the program code in a computer readable storage medium after having downloaded the program code over a network from a remote computing system or data processing system.","The illustrative embodiments are described below with reference to flowchart illustrations and\/or block diagrams of methods, apparatus (systems) and computer program products according to the illustrative embodiments of the invention. It will be understood that each block of the flowchart illustrations and\/or block diagrams, and combinations of blocks in the flowchart illustrations and\/or block diagrams, can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer, special purpose computer, or other programmable data processing apparatus to produce a machine, such that the instructions, which execute via the processor of the computer or other programmable data processing apparatus, create means for implementing the functions\/acts specified in the flowchart and\/or block diagram block or blocks.","These computer program instructions may also be stored in a computer-readable medium that can direct a computer or other programmable data processing apparatus to function in a particular manner, such that the instructions stored in the computer-readable medium produce an article of manufacture including instruction means which implement the function\/act specified in the flowchart and\/or block diagram block or blocks.","The computer program instructions may also be loaded onto a computer or other programmable data processing apparatus to cause a series of operational steps to be performed on the computer or other programmable apparatus to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide processes for implementing the functions\/acts specified in the flowchart and\/or block diagram block or blocks.","The flowchart and block diagrams in the figures illustrate the architecture, functionality, and operation of possible implementations of systems, methods and computer program products according to various embodiments of the present invention. In this regard, each block in the flowchart or block diagrams may represent a module, segment, or portion of code, which comprises one or more executable instructions for implementing the specified logical function(s). It should also be noted that, in some alternative implementations, the functions noted in the block may occur out of the order noted in the figures. For example, two blocks shown in succession may, in fact, be executed substantially concurrently, or the blocks may sometimes be executed in the reverse order, depending upon the functionality involved. It will also be noted that each block of the block diagrams and\/or flowchart illustration, and combinations of blocks in the block diagrams and\/or flowchart illustration, can be implemented by special purpose hardware-based systems that perform the specified functions or acts, or combinations of special purpose hardware and computer instructions.","Thus, the illustrative embodiments may be utilized in many different types of data processing environments including a distributed data processing environment, a single data processing device, or the like. In order to provide a context for the description of the specific elements and functionality of the illustrative embodiments,  are provided hereafter as example environments in which aspects of the illustrative embodiments may be implemented. While the description following  will focus primarily on a single data processing device implementation for altering the access to a Fibre Channel fabric, this is only an example and is not intended to state or imply any limitation with regard to the features of the present invention. To the contrary, the illustrative embodiments are intended to include distributed data processing environments and embodiments in which access to a Fibre Channel fabric may be altered.","With reference now to the figures and in particular with reference to , example diagrams of data processing environments are provided in which illustrative embodiments of the present invention may be implemented. It should be appreciated that  are only examples and are not intended to assert or imply any limitation with regard to the environments in which aspects or embodiments of the present invention may be implemented. Many modifications to the depicted environments may be made without departing from the spirit and scope of the present invention.","With reference now to the figures,  depicts a pictorial representation of an example distributed data processing system in which aspects of the illustrative embodiments may be implemented. Distributed data processing system  may include a network of computers in which aspects of the illustrative embodiments may be implemented. The distributed data processing system  contains at least one network , which is the medium used to provide communication links between various devices and computers connected together within distributed data processing system . The network  may include connections, such as wire, wireless communication links, or fiber optic cables.","In the depicted example, server  and server  are connected to network  along with storage unit . In addition, clients , , and  are also connected to network . These clients , , and  may be, for example, personal computers, network computers, or the like. In the depicted example, server  provides data, such as boot files, operating system images, and applications to the clients , , and . Clients , , and  are clients to server  in the depicted example. Distributed data processing system  may include additional servers, clients, and other devices not shown.","In the depicted example, distributed data processing system  is the Internet with network  representing a worldwide collection of networks and gateways that use the Transmission Control Protocol\/Internet Protocol (TCP\/IP) suite of protocols to communicate with one another. At the heart of the Internet is a backbone of high-speed data communication lines between major nodes or host computers, consisting of thousands of commercial, governmental, educational and other computer systems that route data and messages. Of course, the distributed data processing system  may also be implemented to include a number of different types of networks, such as for example, an intranet, a local area network (LAN), a wide area network (WAN), or the like. As stated above,  is intended as an example, not as an architectural limitation for different embodiments of the present invention, and therefore, the particular elements shown in  should not be considered limiting with regard to the environments in which the illustrative embodiments of the present invention may be implemented.","With reference now to , a block diagram of an example data processing system is shown in which aspects of the illustrative embodiments may be implemented. Data processing system  is an example of a computer, such as client  in , in which computer usable code or instructions implementing the processes for illustrative embodiments of the present invention may be located.","In the depicted example, data processing system  employs a hub architecture including north bridge and memory controller hub (NB\/MCH)  and south bridge and input\/output (I\/O) controller hub (SB\/ICH) . Processing unit , main memory , and graphics processor  are connected to NB\/MCH . Graphics processor  may be connected to NB\/MCH  through an accelerated graphics port (AGP).","In the depicted example, local area network (LAN) adapter  connects to SB\/ICH . Audio adapter , keyboard and mouse adapter , modem , read only memory (ROM) , hard disk drive (HDD) , CD-ROM drive , universal serial bus (USB) ports and other communication ports , and PCI\/PCIe devices  connect to SB\/ICH  through bus  and bus . PCI\/PCIe devices may include, for example, Ethernet adapters, add-in cards, and PC cards for notebook computers. PCI uses a card bus controller, while PCIe does not. ROM  may be, for example, a flash basic input\/output system (BIOS).","HOD  and CD-ROM drive  connect to SB\/ICH  through bus . HDD  and CD-ROM drive  may use, for example, an integrated drive electronics (IDE) or serial advanced technology attachment (SATA) interface. Super I\/O (SIO) device  may be connected to SB\/ICH .","An operating system runs on processing unit . The operating system coordinates and provides control of various components within the data processing system  in . As a client, the operating system may be a commercially available operating system such as Microsoft\u00ae Windows\u00ae XP (Microsoft and Windows are trademarks of Microsoft Corporation in the United States, other countries, or both). An object-oriented programming system, such as the Java\u2122 programming system, may run in conjunction with the operating system and provides calls to the operating system from Java\u2122 programs or applications executing on data processing system  (Java is a trademark of Sun Microsystems, Inc. in the United States, other countries, or both).","As a server, data processing system  may be, for example, an IBM\u00ae eServer\u2122 System p\u00ae computer system, running the Advanced Interactive Executive (AIX\u00ae) operating system or the LINUX\u00ae operating system (eServer, System p, and AIX are trademarks of International Business Machines Corporation in the United States, other countries, or both while LINUX is a trademark of Linus Torvalds in the United States, other countries, or both). Data processing system  may be a symmetric multiprocessor (SMP) system including a plurality of processors in processing unit . Alternatively, a single processor system may be employed.","Instructions for the operating system, the object-oriented programming system, and applications or programs are located on storage devices, such as HDD , and may be loaded into main memory  for execution by processing unit . The processes for illustrative embodiments of the present invention may be performed by processing unit  using computer usable program code, which may be located in a memory such as, for example, main memory , ROM , or in one or more peripheral devices  and , for example.","A bus system, such as bus  or bus  as shown in , may be comprised of one or more buses. Of course, the bus system may be implemented using any type of communication fabric or architecture that provides for a transfer of data between different components or devices attached to the fabric or architecture. A communication unit, such as modem  or network adapter  of , may include one or more devices used to transmit and receive data. A memory may be, for example, main memory , ROM , or a cache such as found in NB\/MCH  in .","Those of ordinary skill in the art will appreciate that the hardware in  may vary depending on the implementation. Other internal hardware or peripheral devices, such as flash memory, equivalent non-volatile memory, or optical disk drives and the like, may be used in addition to or in place of the hardware depicted in . Also, the processes of the illustrative embodiments may be applied to a multiprocessor data processing system, other than the SMP system mentioned previously, without departing from the spirit and scope of the present invention.","Moreover, the data processing system  may take the form of any of a number of different data processing systems including client computing devices, server computing devices, a tablet computer, laptop computer, telephone or other communication device, a personal digital assistant (PDA), or the like. In some illustrative examples, data processing system  may be a portable computing device which is configured with flash memory to provide non-volatile memory for storing operating system files and\/or user-generated data, for example. Essentially, data processing system  may be any known or later developed data processing system without architectural limitation.","Again, the illustrative embodiments provide a mechanism for using N_port identification virtualization (NPIV) to solve the same problems with minimal hardware and or SAN administration. The illustrative embodiments use a Virtual I\/O Server (VIOS) that couples to a plurality of physical Fibre Channel host bus adapters (FC HBAs) and presents virtual EC HBAs with their own world wide port name by using a virtualization layer. By forwarding appropriate fabric events received virtual FC HBA ports to each client through their virtual NPIV adapter and\/or queuing Fibre Channel transactions for each client or initiator, the VIOS provides for multiple initiators to share one FC HBA so that two FC HBAs may provide redundancy to more then one initiator, thus saving hardware. The illustrative embodiments break dependency between the PC HBA world wide port name and the initiators access to SCSI targets since the world wide port names are attributes of a VIOS controlled NPIV adapter rather then the physical FC HBA. The VIOS provides for sending each effected client a notification of LINK down when the FC HBA to which the client is connected has lost or is losing connectivity to the Fibre Channel fabric or when an expected maintenance event occurs, which require remapping the virtual port of the NPIV adapter to a new physical port on another FC HBA. The VIOS sends a LINK up when new mapping to another FC HBA is established.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 3","b":["300","310","330","350","310","312","314","316","330","332","334","336","350","352","354","356","350","356","300","310","330","350"]},"LPARs  and  and VIOS partition  may communicate with one another through virtualization layer . Virtualization layer  is software that performs communications and resource management to allow multiple instances of operating systems  and  and VIOS operating system  to run on data processing system  at the same time. Virtualization layer  performs tasks such as processor time slice sharing, memory allocation, or the like. Virtualization layer  may be, for example, a hypervisor.","Applications  and  may include network applications that communicate with devices on Fibre Channel network . When communicating with Fibre Channel network , applications  and  make calls to APIs  and , and operating systems  and  that communicate through N_port identification virtualization (NPIV) adapters  and , respectively, to N_port identification virtualization (NPIV) server adapters  and , respectively, in VIOS partition  using a respectively assigned worldwide port name (WWPN). In the illustrative embodiments each of NPIV server adapters  and  form two relationships. NPIV server adapters  and  each form a respective first relationship to NPIV adapter  and NPIV adapter . In addition, NPIV server adapters  and  each form a second relationship with a port on Fibre Channel host bus adapters (FC HBAs)  or  in virtualization layer . Each port on FC HBAs  and  may serve many NPIV server adapters simultaneously. Current limitations of a single port on an FC HBA is limited to 64 NPIV server adapters. However, this is a limitation of the currently known FC HBAs and the illustrative embodiments are not limited such currently known limitations.","NPIV server adapters  and  provide virtual WWPNs that map directly to WWPNs of Fibre Channel host bus adapters (FC HBAs)  or  virtualized in virtualization layer . That is, virtualization layer  presents virtual FC HBAs  and  that map to physical FC HBAs using a plurality of worldwide port names. While data processing system  illustrates FC HBAs  and , the illustrative embodiments are not limited to such. Rather, any number of FC HBAs or other communication adapters may be utilized with the mechanisms of the illustrative embodiments without departing from the spirit and scope of the present invention. NPIV server adapter  then communicates or passes the call from application  and  through FC HBAs  or  virtualized in virtualization layer  and network layer  to network . Network layer  is software that performs tasks for network communication. Network layer  may perform tasks such as end-to-end packet delivery, quality of service maintenance, error control, and the like.","Network  may be a network that includes a storage area network (SAN)  that, in the depicted example, is a Fibre Channel compliant SAN. Fibre Channel is a scalable technology data transfer interface technology that maps several common transport protocols, including Internet Protocol (IP) and Small Computer System Interface (SCSI), allowing it to merge high-speed I\/O and networking functionality in a single connectivity technology. Fibre Channel is a set of open standards defined by American National Standards Institute (ANSI) and International Organization for Standardization (ISO). Detailed information regarding the various Fibre Channel standards is available from ANSI Accredited Standards Committee (ASC) X3T11, which is primarily responsible for the Fibre Channel project. These standards are collectively referred to in this specification as the Fibre Channel standard or the Fibre Channel specification. Fibre Channel operates over both copper and fiber optic cabling at distances of up to 10 Kilometers and supports multiple inter-operable topologies including point-to-point, arbitrated-loop, and switching (and combinations thereof).","It should be appreciated that while the illustrative embodiments will be described in terms of using Fibre Channel and a Fibre Channel fabric, the illustrative embodiments are not limited to such. Rather, any interface technology, communication suite, or communication protocol may be utilized with the mechanisms of the illustrative embodiments without departing from the spirit and scope of the present invention. Fibre Channel is only used as an example and is not intended to state or imply any limitation with regard to the types of communication connections or protocols that may be used with the mechanisms of the illustrative embodiments.","The depicted embodiment of SAN  includes a set of nodes  that are interconnected through Fibre Channel fabric network . Nodes  of network  may include any of a variety of devices or systems including, data processing system , data processing systems  (computers), tape subsystems , RAID devices , disk subsystems , Fibre Channel arbitrated loops (FCAL) , or other suitable data storage and data processing devices. One or more of nodes  of network  may be connected to an external network denoted by reference numeral . External network  may be a local area network (LAN), a wide area network (WAN), or the like. For example, the external network  may be an Internet Protocol (IP) supported network, such as the Internet.",{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 4A","FIG. 3"],"b":["300","400","402","404","406","408","410","400","412","414","416","408","410","406","416","418","420","402","412","418","420","418","420"]},"VIOS  uses VIOS controller  to communicate with FC HBAs  and . When FC HBA  or  begins to experience errors indicating a pending failure, FC HBA  or  send the errors as fabric events to VIOS  through VIOS controller . VIOS controller  may use one or more predetermined error thresholds to determine if the received errors indicate that FC HBA  and\/or  are beginning to fail. VIOS  may then use VIOS controller  to communicate appropriate fabric events received from FC HBAs  and\/or  to the appropriate one(s) of clients  or . VIOS controller  may also queue the fabric events if communication with clients  and  is not possible, due to an outage, the client being offline, or the like. VIOS controller  provides a mapping of each NPIV adapter  or  to an assigned port on FC HBA  or . In addition, VIOS controller  stores information provided by FC HBAs  and  and\/or virtualization layer  that identifies the connectivity provided by each port of FC HBAs  and  to a set of targets. As targets are added to a particular port on a FC HBA, then the FC HBA and\/or the virtualization layer in which the FC HBA resides provides updates to VIOS controller . Thus, VIOS controller  also provides for mapping NPIV adapters  or  from one FC HBA port to another FC HBA port in the event of required attention, such as a pending failure in FC HBA  or , maintenance of FC HBA  or , workload balancing between FC HBAs  and , or the like.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 4B","b":["418","422","406","406","402","418","420","406","402","406","418","424","402","418","406","406","420","426","402","420","420","406","406","402","402","420","418"]},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 4C","b":["418","422","418","418","422","406","406","402","420","418","406","402","406","420","426","402","420","406","406","418","424","402","418","418","406","406","402","402","418"]},{"@attributes":{"id":"p-0055","num":"0054"},"figref":["FIG. 4D","FIG. 4D"],"b":["422","418","420","418","420","418","420","418","420","422","420","412","432","434","436","50","418","402","430","422","412","432","434","436","420","420","418","420","422","420","418"]},"Once VIOS controller  identifies the set of clients, in this example, clients  and  to move from FC HBA  to FC HBA , then VIOS controller  calls NPIV server adapter  and NPIV server adapter . The call to NPIV server adapter  indicates that NPIV server adapter  is to move client  from its assigned port on FC HBA  to an available port on FC HBA . NPIV server adapter  then sends an event signal to client  indicating that connectivity has temporarily been lost. NPIV server adapter  then sends a command to FC HBA  to break the connection for client . Upon receiving the command, FC HBA  breaks the requested connection and returns an acknowledgement to NPIV server adapter . In this example, NPIV server adapter  then sends a connection command to FC HBA  in order to establish connectivity for client  to FC HBA . Upon receiving the command, FC HBA  establishes the requested connection and returns an acknowledgement to NPIV server adapter . NPIV server adapter  then sends an event signal to client  that connectivity has been reestablished. With connectivity reestablished, client  is then able to perform communication with the FC fabric through FC HBA .","The call to NPIV server adapter  indicates that NPIV server adapter  is to move client  from its assigned port on FC HBA  to an available port on FC HBA . NPIV server adapter  sends an event signal to client  indicating that connectivity has temporarily been lost. NPIV server adapter  then sends a command to FC HBA  to break the connection for client . Upon receiving the command, FC HBA  breaks the requested connection and returns an acknowledgement to NPIV server adapter . In this example, NPIV server adapter  then sends a connection command to FC HBA  in order to establish connectivity for client  to FC HBA . Upon receiving the command, FC HBA  establishes the requested connection and returns an acknowledgement to NPIV server adapter . NPIV server adapter  then sends an event signal to client  that connectivity has been reestablished. With connectivity reestablished, client  is then able to perform communication with the FC fabric through FC HBA .","Thus, the illustrative embodiments provide a mechanism for using N_port identification virtualization (NPIV) to solve the same problems with minimal hardware and\/or administrator involvement. NPIV allows multiple clients to use a Fibre Channel port where each client is assigned a unique worldwide port name (WWPN). The illustrative embodiments use the VIOS to map a client NPIV adapter from an assigned FC HBA port to another FC HBA port in the event of a FC HBA failure, maintenance of an FC HBA, workload balancing between two or more FC HBAs, or the like.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 5","b":["502","504","506","508","510","512","514","516"]},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 6","b":["602","604","606","608","610","612","614","616"]},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 7","b":["702","704","704","702","704","706","708","710"]},"Once the VIOS controller identifies the set of clients, then the VIOS controller calls a set of NPIV server adapters associated with the set of clients (step ). The call(s) to the set of NPIV server adapters indicate that the set of NPIV server adapters are to move the set of clients from their assigned port on the set of overworked FC HBAs to an available port on the set of underworked FC HBAs. For each client in the set of clients, the associated NPIV server adapter in the set of NPIV server adapters sends an event signal to the client indicating that connectivity has temporarily been lost (step ). The associated NPIV server adapter then sends a command to the associated overworked FC HBA in the set of overworked FC HBAs to break the connection for that client (step ). Upon receiving the command, the associated overworked FC HBA breaks the requested connection and returns an acknowledgement to the NPIV server adapter (step ). The NPIV server adapter then sends a connection command to an underworked FC HBA in the set of underworked FC HBAs in order to establish connectivity for the client to the underworked FC HBA (step ). Upon receiving the command, the underworked FC HBA establishes the requested connection and returns an acknowledgement to the NPIV server adapter (step ). The NPIV server adapter then sends an event signal to the client that connectivity has been reestablished (step ), with the operating ending thereafter. With connectivity reestablished, the client is then able to perform communication with the FC fabric through the underworked FC HBA.","Thus, the illustrative embodiments provide a mechanism for using N_port identification virtualization (NPIV) to solve the same problems with minimal hardware and\/or SAN administration. The illustrative embodiments use a Virtual I\/O Server (VIOS) that couples to a plurality of Fibre Channel host bus adapters (FC HBAs) and presents virtual FC HBAs with their own world wide port name by using a virtualization layer. By forwarding appropriate fabric events received virtual FC HBA ports to each client through their virtual NPIV adapter and\/or queuing Fibre Channel transactions for each client or initiator, the VIOS provides for multiple initiators to share one FC HBA so that two FC HBAs may provide redundancy to more then one initiator, thus saving hardware. Therefore, the illustrative embodiments break dependency between the FC HBA world wide port name and the initiators access to SCSI targets since the world wide port names are attributes of a VIOS controlled NPIV adapter rather then the physical FC HBA. The VIOS provides for sending each effected client a notification of LINK down when the FC HBA to which the client is connected, has lost, or is losing connectivity to the Fibre Channel fabric or when an expected maintenance event occurs, which requires remapping the virtual port of the NPIV adapter to a new port on another FC HBA. The VIOS sends a LINK up when new mapping to another FC HBA is established.","As noted above, it should be appreciated that the illustrative embodiments may take the form of an entirely hardware embodiment, an entirely software embodiment or an embodiment containing both hardware and software elements. In one example embodiment, the mechanisms of the illustrative embodiments are implemented in software or program code, which includes but is not limited to firmware, resident software, microcode, etc.","A data processing system suitable for storing and\/or executing program code will include at least one processor coupled directly or indirectly to memory elements through a system bus. The memory elements can include local memory employed during actual execution of the program code, bulk storage, and cache memories which provide temporary storage of at least some program code in order to reduce the number of times code must be retrieved from bulk storage during execution.","Input\/output or I\/O devices (including but not limited to keyboards, displays, pointing devices, etc.) can be coupled to the system either directly or through intervening I\/O controllers. Network adapters may also be coupled to the system to enable the data processing system to become coupled to other data processing systems or remote printers or storage devices through intervening private or public networks. Modems, cable modems and Ethernet cards are just a few of the currently available types of network adapters.","The description of the present invention has been presented for purposes of illustration and description, and is not intended to be exhaustive or limited to the invention in the form disclosed. Many modifications and variations will be apparent to those of ordinary skill in the art. The embodiment was chosen and described in order to best explain the principles of the invention, the practical application, and to enable others of ordinary skill in the art to understand the invention for various embodiments with various modifications as are suited to the particular use contemplated."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS","p":["The invention, as well as a preferred mode of use and further objectives and advantages thereof, will best be understood by reference to the following detailed description of illustrative embodiments when read in conjunction with the accompanying drawings, wherein:",{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":["FIG. 4A","FIG. 3"],"b":"300"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4B"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4C"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4D"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
