---
title: High energy photon detection using pulse width modulation
abstract: Methods and systems for processing an analog signal that is generated by a high energy photon detector in response to a high energy photon interaction. A digital edge is generated representing the time of the interaction along a first path, and the energy of the interaction is encoded as a delay from the digital edge along a second path. The generated digital edge and the delay encode the time and energy of the analog signal using pulse width modulation.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08258480&OS=08258480&RS=08258480
owner: The Board of Trustees of the Leland Stanford Junior University
number: 08258480
owner_city: Stanford
owner_country: US
publication_date: 20090303
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["PRIORITY CLAIM AND REFERENCE TO RELATED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application claims the benefit of U.S. Provisional Application Ser. No. 61\/067,905, filed Mar. 3, 2008, under 35 U.S.C. \u00a7119. U.S. Provisional Application Ser. No. 61\/067,905 is incorporated in its entirety by reference herein.","This invention was made with Government support under contracts EB003283 and CA119056 awarded by the National Institutes of Health. The Government has certain rights in this invention.","A field of the invention is imaging. Example applications of the invention include, but are not limited to, nuclear imaging, nuclear medicine, defense applications, and oil well drilling.","High energy photons need to be detected in a variety of applications including but not limited to nuclear science, high energy physics, astronomy, and medical imaging. In many high energy photon (e.g., x-ray, gamma ray or annihilation photon) detectors, information from individual interactions are recorded, including parameters such as the time of the event, the energy of the event, and the location of the event. These parameters are determined through certain processing algorithms applied to the analog signals that the detector generates.","As nonlimiting examples,  shows arrival time difference spectra for a pair of coincident interactions of two high energy (511 keV) photons generated from a positron-electron annihilation event. As will be appreciated by those in the art, the two photons interact in opposing high energy photon detectors aligned with the direction of photon emission. The arrival time of each coincident photon can be determined and then subtracted to form a histogram of the time differences.  shows an example energy spectrum of high energy photon interactions in a scintillation detector in response to irradiating it with 511 keV photons and 1.2 MeV photons from a Na-22 source. The pulse-height of the signal (x-axis) is proportional to the energy of the photon interaction of the detector.  shows spatial distributions of high energy photon interactions in a position sensitive high energy photon scintillation crystal array detector. A high energy photon detector can record position (discrete or continuous) of high energy photon interactions.","However, the transmission of such analog signals for processing can present problems. For example, because several detectors often are used in a given application, many individual signal lines (e.g., wires) are required to carry encoded analog signals. The number of signal lines increases even further for delivering various types of information. Additionally, the quality of the signal may deteriorate, particularly if the detector is located in certain environments (as a nonlimiting example, magnetic environments, such as within a magnetic resonance imaging (MRI) detector), or is multiplexed to reduce number of readout channels.","Embodiments of the invention provide, among other things, methods and systems for processing an analog signal that is generated by a high energy photon detector in response to a high energy photon interaction. In an example method, a digital edge is generated representing the time of the interaction along a first path, and the energy of the interaction is encoded as a delay from the digital edge along a second path. The generated digital edge and the delay encode the time and energy of the analog signal using pulse width modulation.","As described above, in standard high energy photon detectors, for an event such as a scintillation event, information from individual interactions is recorded, such as the time of the event, the energy of the event, and the location of the event. These parameters are determined through certain analog signal processing algorithms applied to the analog signals that the detector generates. For example, the energy and location information may be processed using an analog-to-digital (ADC) converter that samples an analog value that is proportional to the integral of the charge created by the scintillation event.","However, more recent, very high resolution high energy photon detection systems require new data acquisition architectures to accommodate the large increase in the number of readout channels. For example,  shows light multiplexing being used to reduce the number of readout channels in a conventional PET block detector readout system . In , a block detector  and photomultiplier tubes (PMT)  produces a signal sent over an analog bus to a low channel count (4-channel) ASIC . Four ADCs  read each analog channel, the result of which is output to a readout system such as but not limited to a field programmable gate array (FGPA)  with suitable logic. This system  scales poorly in the number of ADCs required as the channel count increases.",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5","b":["22","24","26","28","24","30"]},"For an improved architecture to implement very high channel count PET data acquisition systems, pulse width modulation (PWM) has significant advantages over previous generations of readout architectures. Thus, embodiments of the present invention modulate the width, rather than the amplitude, of a digital pulse to be proportional to the integral of the charge created. The analog value of the outgoing digital pulses may be recovered by using a time-to-digital converter (TDC) in back-end electronics, preferably without the need for an ADC. Further, it is possible to provide a purely digital high density back end. In an example embodiment, the same TDC used to record the time of the event can be used to recover the amplitude.","Generally, embodiments of the invention provide methods, apparatuses, and systems for encoding photon interaction information, such as the arrival time, energy, and location of each high energy photon interaction in a detector using the different arrival times of various edges of a digital signal, rather than in the amplitude of an analog signal, as provided in conventional approaches. This pulse width modulation is analogous to the different methods of phase modulation and amplitude modulation of an analog carrier in continuous radio frequency modulation. Digital encoding of the signal, especially onto a single wire or fiber, allows more flexibility and drastically simpler data acquisition electronics over analog encoding of the signal.","Further, an example circuit according to embodiments of the present invention allows a PWM readout scheme different from time over threshold PWM circuits used in high energy physics. PWM techniques simplify the routing to the back end electronics without degrading the performance of the system. An example readout architecture based on PWM processes digital rather than analog pulses, which can be very easily multiplexed, allowing one to achieve very high channel density required for ultra-high resolution, 3-D positioning high-energy photon detector systems.","Apparatuses and systems according to certain embodiments of the invention include, but are not limited to, a front-end for an imaging system that couples to a high-energy photon detector, a front-end including a high-energy photon detector, and an imaging system having such front-ends. A nonlimiting example apparatus for performing methods according to the present invention is a front-end for a positron emission tomography (PET) system as shown in the following figures, though those of ordinary skill in the art will appreciate that other systems having emitted photons may be used. PET is a medical imaging modality that uses positron emitting radionuclides attached to specific molecules that are introduced into the body of an animal and tracked by a PET system to provide sensitive assays of a wide range of biological processes relating to cancer or other diseases associated with alterations in the functional metabolism of cells in the body. Tracking is possible because the radionuclides emit high-energy photons that are detected with high spatial, spectral and temporal resolution by PET system detectors. For example, two high energy (e.g., 511 keV) photons are generated from a positron-electron annihilation event. The two photons interact in opposing high energy photon detectors (coincident interaction) aligned with the direction of photon emission. Embodiments of the present invention convert this exponentially decaying signal (e.g., via an exponentially decaying light signal or a signal from a direct bandgap semiconductor) into a digital edge and a width.","In applications such as but not limited to PET, the time information is extremely important. In an example embodiment and method of the present invention, time is encoded using a low jitter timing discriminator. The charge from the high energy interaction in the detector triggers a comparator. A logic signal is generated that is slightly delayed from the interaction. The energy of the signal is created by a circuit that converts the amplitude of the received charge into a time delay from the logic signal generated from the discriminator. This creates a pulse width, the width being the time difference between the first logic signal and the second, which is proportional to the amplitude.","Turning now to the drawings,  shows a high channel count digital architecture  according to an embodiment of the present invention. Each of a plurality of detector channels  outputs via a digital bus  to a low channel count front-end ASIC pulse width modulator , which in turn outputs to a high density digital bus . In this example embodiment, no ADCs are needed to digitize amplitude modulation. This example system enables the move to a purely digital high density back end  embodied in suitable FPGA logic.","Example methods and systems of the present invention encode the time, energy, and location of each high energy photon interaction in a detector using the different arrival times of various edges of a digital signal, rather than in the amplitude of an analog signal. An example PWM scheme marries the fast constant fraction discriminator (CFD) timing needed for PET and the time counter principles behind the Wilkinson ADC conversion technique for encoding amplitude. Because it is relatively simple to implement a very high degree of multiplexing using digital pulses, the example PWM readout architecture  can potentially readout more channels than a high density analog readout architecture without using ADCs. With the advent of very high channel count field programmable gate arrays (FPGAs) synthesized into very high performance TDCs, the digital back-end readout of PWM architectures, even with thousands of readout channels, can be easily realized in certain example embodiments using off the shelf components and simple high density digital buses, though other components and buses are also contemplated.","PWM circuits utilizing time-over-threshold (TOT) have been used to digitize amplitude information of nuclear decay and drift chambers. In TOT techniques, by setting a threshold voltage above zero, an amplitude dependent pulse width can be generated from a Gaussian, or other CR-RC type shaped pulse. However, TOT techniques suffer from problems that discourage its use in certain high energy photon detection systems.","For example, the noise of TOT depends on the shaping circuits used and strongly depends on the inherent non-linearity of the width versus amplitude dependence. Since the decay of a Gaussian-shaped pulse falls off exponentially with the time, it does not provide the good delay linearity needed for a robust PWM scheme. The data acquisition architectures of TOT are used in very high channel count physics experiments using silicon vertex trackers and calorimeters. New high resolution PET systems, as one example, have similar high channel count needs as these high energy physics experiments.","As shown in , an example high energy photon detection system, such as but not limited to a PET system, includes a front end  having a high energy photon detector  that is positioned to detect photons from a source of emitted photons and produce an analog signal. The high energy photon detector  can include one of a plurality of high energy photon detectors, such as, but not limited to, one or more scintillation crystals coupled to one or more magnetically insensitive semiconductor photodetectors, one or more magnetically insensitive direct interaction semiconductors, or traditional photodetectors including photomultiplier tubes, etc. Those of ordinary skill in the art will appreciate that various sources of emitted photons and high energy photon detectors are possible, and the present invention is not to be limited to a particular configuration for either the source of emitted photons or the high energy photon detector .","In example operations, the high energy photon detector  produces an analog signal as a charge in response to a high energy photon interaction. This analog signal (e.g., charge) has a temporal dependence, and represents the energy of the incoming high energy photon. The signal varies in time based on the random process of radioactive decay and varies in energy based on the physical transport of photons through matter.","The high energy photon detector  may be suitably coupled (e.g., electrically connected), directly or indirectly, to a pulse width modulation front-end circuit, including an analog preamplifier circuit, for example a shaping amplifier such as a charge sensitive preamplifier . A nonlimiting example of a charge sensitive preamplifier is based on an electrical circuit that produces a voltage that is proportional to charge. Example electrical couplings include discrete networks of components that pass the charge from the detector  to the preamplifier . The charge sensitive preamplifier  converts the charge to a voltage signal output. For example, the preamplifier integrates the charge.","Generally, the output is converted to a digital signal having a first edge (e.g., a rising edge) representing a time of the original analog signal, and second edge (e.g., a falling edge) representing amplitude. Each edge transition encodes a unique analog value. Preferably, the time encoding and the energy encoding take place along two separate paths, which are referred to herein as a first path and a second path, though this designation is not intended to require a particular ordering.","For example, to encode the time of the event, the output of the preamplifier circuit  (e.g., the integrated signal) is sent to a time encoding circuit, such as a timing discriminator  (e.g., constant fraction or leading edge), along a first path, generating a digital edge that represents the time of the start of the event. This first edge of the signal should be as accurate as possible. The timing discriminator  may, as a nonlimiting example, generate a digital edge at the time where the signal can be first reliably detected above noise. For instance, the time encoding circuit may, when a voltage or current of the analog signal crosses a threshold, generate a signal with the time of the event to provide a fixed edge.","An example timing discriminator is a constant fraction discriminator that generates a timing signal that is independent of the amplitude of the signal, though other time encoding circuits, such as but not limited to a good comparator, may also be used. It is preferred that the preamplifier circuit  and the timing discriminator  be combined into a single circuit (e.g., a single chip) suitably coupled to the high energy photon detector .","To encode the energy of the event, the output signal of the preamplifier circuit (e.g., the falling signal edge) is also connected to a delay encoding circuit along a second path that converts the width of the preamplifier circuit output signal to a delay from the first edge (produced by the timing discriminator). This splitting of the output signal into separate paths or channels for timing and energy encoding is significantly different from TOT methods, which conventionally have suffered from degraded timing and\/or energy performance.","In example embodiments, a falling signal edge is produced with constant slope decay from a peak signal. Because the peak signal is proportional to the integral of the charge, and therefore the energy of the event, the amplitude will decay with a constant slope. By detecting when this amplitude decays to zero with a suitable detector such as a comparator, the delay from the start of the event is proportional to the amplitude.","An example of a delay encoding circuit is a pulse width modulator. The pulse width modulator includes a peak detector circuit  that detects the peak after integrating and preferably shaping (e.g., Gaussian shaping or optimally filtering) the input charge. After detecting the peak, a detection circuit can enable a delay circuit  that is proportional to amplitude. An example of a delay circuit is a current source that discharges a capacitor. If the current is proportional to the amplitude, then the time to discharge the capacitor to no charge will be linearly related to the amplitude. In an example method, the peak detector  records the peak of the integration, and the charge is converted to an amplitude over a certain time. The circuit detects when the peak has been reached, and begins discharging a timing element.","In an example embodiment, a comparator detects when the amplitude of the delay circuit signal decays to zero or some other number. For example, the amplitude may be placed onto a capacitor. When the timing accurate trigger fires, the preamplifier circuit immediately puts a rising edge on the output. Because the preamplifier integrates the input charge, the time from the start of the pulse to the peak is always a constant amount of time regardless of the amplitude of the pulse. The peak should be sampled after a fixed delay duration from the start of the pulse. That fixed delay time is application specific, and related to the time required for a given detector to reach the optimal signal-to-noise ratio. The peak can be reliably sampled by using a peak detection circuit.","After the peak is sampled, the amplitude then immediately starts a discharge from the capacitor in a controlled fashion (e.g., linear, though other methods may be used). When the capacitor decays to zero (or other threshold low), the comparator indicates low. The low time minus the high time determines the width of the pulse. The delay from the start of the event is proportional to the amplitude, because the amplitude of the preamplifier circuit output decays with a constant slope. This signal represents the energy of the event. Thus, in this example pulse width modulation circuit , one energy and one time value can be encoded into a single digital signal.","In particular example embodiments of the present invention, the timing discriminator  is embodied in a constant fraction discriminator (CFD), which encodes the arrival time and reduces time walk. Additionally, the peak detector  captures the maximum signal from a Gaussian shaped signal and generates a ramp function that linearly decays to zero. By splitting the signal into two paths, the signal-to-noise-ratio (SNR) of coincidence timing can be optimized at the same time as the SNR of the energy signal. Certain TOT-based ASICs, on the other hand, use little or no shaping to attain the best timing performance, and this severely degrades the SNR of the energy channel. Other TOT-based ASICs use Gaussian shaping with good SNR for energy performance, but this slow shaping significantly degrades timing performance.","Another advantage of certain example embodiments of the present invention is that in certain types of high energy photon data acquisition, such as standard PET data acquisition, timing is performed by a constant fraction discriminator (CFD) to reduce the amplitude dependent time walk. In embodiments of the present invention, the scintillation pulse is driven into a CFD that sets a latch  started at the rising edge. The scintillation signal may have some small amount of fast shaping to optimize the timing resolution. In terms of time pickoff, an example design is identical to and will have the same performance as standard PET electronics.","The pulse width modulation circuit  can be seen as an ADC operating on the energy portion of the scintillation pulse. In a more particular embodiment, the scintillation signal is first shaped by a Gaussian shaper (e.g., part of peak detector ) set with a time constant to maximize SNR. Because the Gaussian shaper is a linear transform of the scintillation signal, the time between the start of the pulse and the peak of the Gaussian shaper will be constant. This is exploited in current PET detector readout electronics designs by firing a sample and hold to sample at this peak.","To capture the peak of the Gaussian shaper, an example embodiment implements a very fast peak detector with a linear ramp discharge. For example, as shown in , an example embodiment of the present invention provides a high speed analog peak detector  with RC delay circuit . High speed Shockley diodes D and D are matched. An offset voltage of the Shockley diodes is needed due to the forward drop in the feedback of the op-amp. Capacitor C holds the peak voltage. When the input drops below the peak, the capacitor discharges with a time constant of R*C. The terminal of R is tied to VEE to improve linearity. The resistors and capacitors can be changed to provide better dynamic range and less quantization noise with a corresponding tradeoff in pile-up at high event rates.","For discrete implementations, a peak detector is simpler than the associated electronics to fire a sample-and-hold precisely at the peak of the signal. The example peak detector has a capacitor to store the value. With a simple resistor, an approximately linear discharge current can be generated that decays based on an RC product. The peak detector will begin to decay as soon as the output of the Gaussian shaper falls below the value of the storage capacitor. On the other hand, a sample-and-hold circuit would not have this limitation and could begin decaying immediately after sampling the value. Therefore, for an ASIC implementation, a sample-and-hold circuit would be preferred over a peak detector because the ramp could decay faster than the falling edge of the Gaussian shaper, which would improve count rate performance.","The output of the PWM with a linear ramp discharge is fed into a high speed comparator with an adjustable threshold. The output of the comparator fires the reset of the latch . The final digital signal has the rising edge encoding the arrival time of the scintillation pulse and the falling edge encoding the width of the pulse.","An example PWM circuit is considered herein to better appreciate its impact on energy resolution for a scintillation detector. Other figures of merit, including spatial resolution, can be easily derived from this framework. First, the variance of the PWM in time is derived:",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msubsup":{"mi":["\u03c3","PWM"],"mn":"2"},"mo":"=","mrow":{"msubsup":[{"mi":["\u03c3","CFD"],"mn":"2"},{"mi":["\u03c3","COMP"],"mn":"2"}],"mo":["+","+","+"],"mrow":{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msubsup":{"mi":["\u03c3","TDC"],"mn":"2"}},"mfrac":{"mrow":[{"msubsup":[{"mi":"\u03c3","msub":{"mi":["V","CAP"]},"mn":"2"},{"mi":"\u03c3","msub":{"mi":["V","i"]},"mn":"2"},{"mi":"\u03c3","msub":{"mi":["V","t"]},"mn":"2"}],"mo":["+","+"]},{"mrow":[{"mo":"\u2202","mi":"V"},{"mo":"\u2202","mi":"t"}],"mo":"\/"}]}}}},{"mrow":{"mo":["(",")"],"mn":"1"}}]}}}},"br":{},"sub":["V",{"sub2":"i"},"V",{"sub2":"t"},"V",{"sub2":"CAP"},"CFD","COMP","PWM","TDC","i"],"sup":["2","2","2","2 ","2 ","2 ","2 "]},"The slope of the discharge is related to the value of the resistor R and capacitor C, as shown in , and the negative supply voltage. In , an input scintillation signal, indicated by a dark solid line, enters a peak detector with a linear ramp discharge, indicated by a light line. The upper dotted line represents the maximum of the signal and is proportional to maximum value of a Gaussian shaped signal. The lower dotted line represents the threshold for firing the trigger.","The discharge is made more linear by connecting the terminal of the resistor to VEE. The slope is",{"@attributes":{"id":"p-0059","num":"0058"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"mo":"\u2202","mi":"V"},{"mo":"\u2202","mi":"t"}],"mo":"\/"},{"mfrac":{"mrow":{"msub":{"mi":["V","i"]},"mo":"-","mi":"VEE"},"mi":"RC"},"mo":"\u2248","mrow":{"mfrac":{"mi":["VEE","RC"]},"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":"because","msub":{"mi":["V","i"]},"mrow":{"mo":["<<","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"VEE"}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"2"}}]}}}}},"The variance of the PWM can be converted into energy resolution by optimizing the voltage headroom of the circuits (max(V)\u2248VEE\/2, and max(V)\u2248scaled so that it accommodates the 511 keV photopeak pulse height).",{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mfrac":{"msub":{"mi":["\u03c3","PWM"]},"mrow":{"mrow":[{"mrow":[{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["V","i"]}}},{"mo":"\u2202","mi":"V"}],"mo":"\/"},{"mo":"\u2202","mi":"t"}],"mo":"\/"}},"mo":"=","mroot":{"mrow":{"mfrac":[{"mrow":{"msubsup":[{"mi":["\u03c3","CFD"],"mn":"2"},{"mi":["\u03c3","COMP"],"mn":"2"}],"mo":["+","+"],"mrow":{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msubsup":{"mi":["\u03c3","TDC"],"mn":"2"}}},"mi":"RC"},{"mrow":[{"msubsup":[{"mi":"\u03c3","msub":{"mi":["V","CAP"]},"mn":"2"},{"mi":"\u03c3","msub":{"mi":["V","l"]},"mn":"2"},{"mi":["\u03c3","t"],"mn":"2"}],"mo":["+","+"]},{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["V","i"]}}}]}],"mo":"+"},"mn":"2"}}},{"mrow":{"mo":["(",")"],"mn":"3"}}]}}}}},"There is a clear tradeoff in choosing the RC constant. The longer the RC constant, the better the energy resolution (that is, better SNR), but this will come with a penalty in dead-time. The dead-time of this example PWM is different from ADC based converters. However, the dead-time of the example PWM is the same as that for a Wilkinson ADC, because the time to convert the amplitude is linearly related to the amplitude. For Wilkinson ADC or PWM circuits, the non-Poisson nature of the dead-time has been derived. The voltage noise terms of equation (3) should be made small relative to the input amplitude V. The noise Vis simply the kT\/c noise of the storage capacitor. Usually, the noise of the front end detector is much larger than the noise of these simple elements.","A key performance parameter to be optimized for certain embodiments of the present invention is the dynamic range versus the dead-time of the front-end detector. Thus, an example performance includes an 8-bit dynamic range for a pulse-width modulation (PWM) scheme, which is adequate for high resolution PET systems based on semiconductor detectors such as avalanche photodiodes (APD) or cadmium zinc telluride (CZT).","To test an example embodiment of the present invention, a discrete PWM test board was fabricated and evaluated for energy resolution performance versus a standard peak-sampled ADC. The example PWM circuit includes a peak detector with a linear ramp discharge and a high speed LT1171 comparator. The R was set at 10 k and the C at 100 pF, giving a slope of",{"@attributes":{"id":"p-0065","num":"0064"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mn":"50","mo":"\u2062","mrow":{"mfrac":{"mi":"V","mrow":{"mi":["\u03bc","s"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mo":"."}}}},"br":{}},"After pulser linearity tests, a 10 \u03bcCi Na source irradiated a 3 mm\u00d73 mm\u00d720 mm LYSO crystal connected to a single 3 mm\u00d73 mm solid state photomultiplier (SSPM) pixel of the SENSL 4\u00d74 SPMArray 3035G16. The example test board contained a fast trans-impedance amplifier (500 Ohms) to amplify and invert the input signal for the input to an Ortec CFD-935. A CFD is very useful for the fast timing for an example PWM scheme. The output of the CFD was the start for the Ortec 567 TAC\/SCA. For the energy channel, the signal was shaped by a Cremat-200 100ns Gaussian shaping amplifier. The shaped signal was input to both the discrete PWM circuit and to an Ortec 427A delay amplifier. The latter channel enables comparison to the standard analog modulated processing chain. After level shifting to negative NIM voltage standard, the PWM signal was sent to the stop of the Ortec 567 TAC\/SCA. The output of the delay amplifier and the TAC went to an NI-1110 peak-sampling ADC. The Ortec 567 TAC\/SCA is used to convert the pulse width back into an amplitude for digitization to mimic the function of the TDC and generate the PWM equivalent of a pulse height spectrum. The Na energy spectrum was acquired fir both the standard analog-modulation, peak-sensing ADC chain and the PWM processing chain.",{"@attributes":{"id":"p-0067","num":"0066"},"figref":["FIG. 10","FIG. 10"]},{"@attributes":{"id":"p-0068","num":"0067"},"figref":["FIG. 11","FIG. 11"],"sup":"22"},"A wide dynamic range (for PET) scintillation signal (0-1.27 MeV) was digitized from the PWM circuit versus the standard analog-modulated digitization. Results are shown in .  shows PWM energy Na energy spectra results, which correlate very well with the analog-modulated scheme.  shows the energy resolution of the two conversion schemes, which is identical at 19.4+\/0.4% FWHM at 511 keV. The correlation between the ADC and PWM is 1.0 with a 1.2% standard deviation. This example PWM circuit is not fully able to linearize the low amplitude pulses from the 100 ns Gaussian shaper. An RC constant with a larger time constant relative to the shaper constant can be used to remove this small amplitude non-linearity, but this will increase dead-time. This small low-amplitude non-linearity should not be a significant detriment, however.","Example PWM circuits provide a dynamic range, linearity, and SNR with a circuit that can in certain embodiments be relatively simple yet can meet performance parameters needed for high energy imaging, such as but not limited to PET data acquisition designs. Example PWM circuits and methods preserve the low jitter of CFD based triggering while deriving a pulse width from an optimally shaped signal, achieving a high SNR energy signal.","Results suggest that this nonlimiting example test circuit can perform well in high energy photon imaging applications, including but not limited to PET scintillation applications. Example circuits can be used to capture signals from, as nonlimiting examples, a light sharing block detector or a 3-D positioning sensitive detector because of the improved linearity and optimal SNR as compared to conventional, TOT designs for PET.","In another example, both a constant rise time and fall time can be incorporated in the delay circuit to give a larger delay as a function of amplitude. An example of a high energy photon detection by a scintillation detection and analog front-end circuit with a constant rise and fall slope is shown in . In some high energy photon detectors, there may be more than one characteristic time between the start of the signal and the peak of the signal. This happens in a type of phoswich scintillation detector that comprises two or more different scintillators.","As shown in , a peak sense  may be incorporated into a front-end circuit  to determine when the peak occurs. The peak sense  holds a peak value until being reset, providing a start delay. The signal from the peak sense  can also be compared to a constant delay circuit to determine which of the scintillator crystal types were hit, and this can be incorporated into the pulse signal.","A high energy photon detector  may also provide spatial signals representing the spatial location of the high energy photon interaction within the detector. For example, as shown in the front end circuit  in , the high energy photon detector  may output a signal, such as a spatially dependent charge ratio, which records the position (discrete or continuous) of the high energy photon interaction. The resulting output of the front end circuit  encodes time, energy, and location of a high energy photon interaction within the detector via a toggle . In example embodiments, such spatial signals of the detector can also be encoded using pulse width modulation, and these signals can create edges that are delayed from the edge that encodes the energy of the event. For example, there may be further encoding by using peak detection circuits  and constant fall-time generators  to digitally encode each of the time of the event, the energy of the event, and spatial signals (minimum of one per dimension encoded). Examples of spatial information for four spatial channels (e.g. channels a, b, c, and d, representing the x and y coordinates), are shown in an example pulse train in . The peak sense  detector shown in  can also be useful for assisting processing of the spatial signals.","It is contemplated that other information can be added onto the end of the pulse, but such information can come with a large penalty to the maximum count rate. Additional digital encoding or signaling can occur asynchronously on the same wire to encode detector information or other information. Another example is the decay constant of a scintillator. The latter can allow for phoswich stacked detectors in which interactions occurring in the different scintillation crystals can be identified based on different light decay constants intrinsic to each scintillator. The peak sense circuit  shown in  may be useful for this feature as well. The output from a peak sense circuit  can be compared to that from a constant delay circuit and, depending on whether it is before or after the constant delay, can determine which layer of the phoswich scintillator was hit.","As a nonlimiting example, in a front end circuit  shown in , a detector ID delay circuit  may output a detector ID in the form of binary code that uniquely identifies a detector. This detector ID may be encoded, for example, by binary encoding, or run-length encoding.","The front-end circuit may include, for example, a circuit that combines the time, energy, spatial information, and one or more other signals (such as, but not limited to, a detector ID) into an output signal such as a pulse train. One or more output lines, but preferably one output line, from the front-end circuit may be a suitable output line for carrying the output signal. This output line may carry, for example electrical and\/or optical signals, and thus may be an electrical and\/or optical wire or wires.","Optical coupling may be performed by a circuit that modulates the intensity of light in a laser diode. The light of the laser diode can be coupled into an optical fiber. The light of the laser can be detected using a photodetector. The light intensity can be converted into an electrical signal. The electrical signal can then be converted into a digital signal. In this way, optical transmission is equivalent to electrical transmission. Nonlimiting example embodiments for optical coupling are provided in U.S. patent application Ser. No. 12\/246,326, filed Oct. 6, 2008, to the present inventors.","It is preferred that the output signals for multiple detectors be multiplexed into as few output lines as possible. This is especially preferred if a signal detector has multiple signals. For example, a position sensitive avalanche photodiode (PSAPD) may have 5 signals, requiring 5 shaping amplifiers and 5 peak detectors. Because all 5 events happen at the same time, it is desirable to read out all 5 events using the same output line. In a preferred embodiment, a timing accurate comparator determines an arrival time of a first event. The 5 signals can be encoded (e.g., by a suitable logic circuit) such that the high-to-low transition of the first event leads to the second one, and onto the third, fourth, and fifth event. This cascaded modulation is especially useful for reducing the number of output lines needed (in this case, one wire transmits 5 encoded signals).","Referring again to , the output line or lines are suitably connected to a readout system  for receiving the output signal from the front end system and decoding the signal for further processing. Example readout systems include, but are not limited to, a time-to-digital converter, which converts the pulse width to an amplitude. Other suitable systems include a time-to-digital converter based on high speed counters. As a nonlimiting example, time-to-digital converters are already included in some known imaging devices, such as some known PET systems (for recording time information of a pulse). These may be used as a readout system, as would be appreciated by those of ordinary skill in the art. The decoded signal can then be processed according to methods known to those of ordinary skill in the art. Accordingly, example methods and systems of the present invention preferably are suitable for use with existing systems, such as imaging systems, as a front-end.","A significant advantage of example embodiments of the present invention is a reduction in the number of electronic connections needed between the detector and the readout system. This advantage is provided because multi-parameter signals can be encoded into fewer wires or a single wire, rather than having several wires encoding the signal. High energy photon detection systems, including but not limited to advanced positron emission tomography (PET) systems or other high energy photon\/radionuclide detection systems, can have hundreds to many thousands of detectors. Each of these detectors must resolve the time, energy, and spatial information of a high energy photon interaction. In many imaging detectors, one signal encodes the digital trigger, which is used for timing information. Four signals encode the spatial and energy signals, and each of these four signals needs to be digitized by an analog-to-digital converter. Therefore, five signals must be connected from the detector to the analog readout in the conventional system for a particular detector, rather than only one signal in the example pulse-width modulated design. Digitally encoding the signal onto a single wire allows more flexibility and drastically simpler data acquisition electronics versus analog encoding of the signal. However, it will be appreciated that more than one signal wire may be used if desired.","The entire pulse duration should be minimized to allow for the highest number of detected pulses per unit time per signal wire. There are tradeoffs in the amount of time it takes to integrate the charge and filter the incoming signal before detecting the peak of the signal. Filtering, such as Gaussian shaping, can provide the largest signal-to-noise ratio for a given decay time constant for a scintillator while minimizing broadband noise. If an inadequate filtering time constant is chosen to minimize the pulse width, then a non-optimal signal-to-noise ratio will be achieved. A fixed, detector dependent, constant delay from the start of the signal to the peak of filtering circuit signal using the optimal time constant can be sampled in the peak detector. Further, embodiments of the present invention provide the minimum pulse width for linear encoding of the output of a high energy photon detector. Thus, for a particular desired signal-to-noise ratio (SNR), which is a function of the pulse width, embodiments of the present invention allow the signal to be encoded in the most efficient manner possible.","Yet another advantage is that digital multiplexing has no degradation in performance, whereas analog multiplexing reduces performance for each detector added into a multiplexing circuit. As shown in , analog electronic multiplexing is a current method to attempt to reduce the number of readout channels. Detectors can be connected using spatial encoding so that many detectors can be read out using a common readout path. Analog electronic multiplexing, however, degrades the amplitude and timing information of the signal. Therefore, there is a limit to how many channels can be multiplexed together. As shown in , digital signals, by contrast, can be almost infinitely multiplexed with very little degradation in performance. This allows for far fewer channels that digitize the signals without performance degradation.","Additionally, digital signals in example embodiments of the present invention can be transmitted by methods other than analog transmission. Examples of digital transmission include electronic transmission over a multiplex channel, or over an optical fiber. A digital output, for example, may be coupled to a laser driver for generation of optical signals. The digital signal is much more robust in the present of noise, attenuation, and interference. As a nonlimiting example, it is easier to transmit digital signals using optical encoding over fiber using the same high performance telecommunications technology that is used to route digital packets. Analog signal transmission over wires is greatly constrained by noise and power requirements, whereas digital signal transmission over optical fibers has many advantages in applications that require relaying signals over great distance, in highly electromagnetically interfering environments, or both.","According to example embodiments of the present invention, by integrating a simple portion of electronics adjacent to a PET detector, the signals can be relayed over digital communication channels. This allows for a large reduction in the number of readout channels, and for robust delivery of the information signals to back end data processing electronics. PET detectors as part of a system according to embodiments of the present invention can be placed in environments where it has been difficult to operate, such as in an MR system.","As another advantage, time-to-digital converters can be used to replace the analog-to-digital converters in embodiments of the present invention. Particularly, by encoding the signal by pulse width, the amplitude can be recovered using time-to-digital converters rather than analog to digital converters. Time-to-digital converters are already used in some conventional systems to recover the timing information of the pulse, and according to embodiments of the present invention they can be reused to give the amplitude and spatial information. This allows the elimination of analog-to-digital converters in a system if desired.","Each of the hundreds to thousands of detectors in a conventional high energy photon\/radionuclide detection system has sensitive analog circuits that must be connected over cables from the detector to devices or systems for data acquisition. Integrated circuits implementing pulse width modulation can be created directly in a detector simply and easily. By integrating a simple portion of electronics adjacent to the detectors, the signals can be relayed over digital communication channels. This allows for a large reduction in the number of readout channels, and for robust delivery of the information signals to the back end data processing electronics. Example embodiments of the present invention can greatly reduce the cost of the data electronics, while at the same time allowing the placement of these detectors in harsh environments that hinder effective operation, such as but not limited to a magnetic resonance imaging (MRI) system. However, it is to be understood that high energy photon detection systems alone may be provided and used according to embodiments of the invention without an MR system or other system.","Nonlimiting example applications for the present invention include high energy physics, such as scintillation or solid-state detectors, nuclear medicine applications, such as positron emission tomography (PET), gamma ray imaging, or single photon computed tomography (SPECT), defense applications for nuclear weapons proliferation or homeland defense, including gamma ray spectroscopy and imaging detection, and oil well drilling, such as by using scintillation detectors in harsh drilling environments.","Though particular nonlimiting example PWM circuits are described, it will be appreciated by those of ordinary skill in the art that several modifications are possible. For example, alternative linear ramp circuits could easily be implemented in ASICs or more discrete components to achieve much better linearity (though such circuits may increase complexity). Also, the peak detector with resistive discharge can easily replaced by, for example, a sample-and-hold with current source discharge architecture in an ASIC design. This would remove the non-linearity for small signals that the peak-detection method may suffer from with small RC constants used to improve dead-time performance. Further, the timing CFD of the front end may be replaced with a fast leading edge discriminator. The amplitude information may be used to remove the time walk. However, it is preferred that the same comparator that is used for timing not be used for the energy signal, otherwise a poor tradeoff between timing and energy SNR may result.","While various embodiments of the present invention have been shown and described, it should be understood that other modifications, substitutions, and alternatives are apparent to one of ordinary skill in the art. Such modifications, substitutions, and alternatives can be made without departing from the spirit and scope of the invention, which should be determined from the appended claims.","Various features of the invention are set forth in the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 17"}]},"DETDESC":[{},{}]}
