---
title: Data hiding via phase manipulation of audio signals
abstract: Data are embedded in an audio signal for watermarking, steganography, or other purposes. The audio signal is divided into time frames. In each time frame, the relative phases of one or more frequency bands are shifted to represent the data to be embedded. In one embodiment, two frequency bands are selected according to a pseudo-random sequence, and their relative phase is shifted. In another embodiment, the phases of one or more overtones relative to the fundamental tone are quantized.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07289961&OS=07289961&RS=07289961
owner: University of Rochester
number: 07289961
owner_city: Rochester
owner_country: US
publication_date: 20040618
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["REFERENCE TO RELATED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","DESCRIPTION OF RELATED ART","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["The present application claims the benefit of U.S. Provisional Patent Application No. 60\/479,438, filed Jun. 19, 2003, whose disclosure is hereby incorporated by reference in its entirety into the present disclosure.","The work leading to the present invention was supported by the Air Force Research Laboratory\/IFEC under grant number F30602-02-1-0129. The government has certain rights in the invention.","The present invention is directed to a system and method for insertion of hidden data into audio signals and retrieval of such data from audio signals and is more particularly directed to such a system and method using a phase encoding scheme.","Digital watermarking currently is receiving a great amount of attention due to commercial interests that seek to control the distribution of digital media as well as other types of digital data. A watermark is data that is embedded in a media or document file that serves to identify the integrity, the origin or the intended recipient of the host data file. One attribute of watermarks is that they may be visible or invisible. A watermark also may be robust, fragile or semi-fragile. The data capacity of a watermark is a further attribute. Trade-offs among these three properties are possible and each type of watermark has its specific use. For example, robust watermarks are useful for establishing ownership of data, whereas fragile watermarks are useful for verifying the authenticity of data.","Steganography literally means \u201ccovered writing\u201d and is closely related to watermarking, sharing many of the attributes and techniques of watermarking. Steganography works by embedding messages within other, seemingly harmless messages, so that seemingly harmless messages will not arouse the suspicion of those wishing to intercept the embedded messages.","As a basic example, a message can be embedded in a bitmap image in the following manner. In each byte of the bitmap image, the least significant bit is discarded and replaced by a bit of the message to be hidden. While the colors of the bitmap image will be altered, the alteration of colors will typically be subtle enough that most observers will not notice. An intended recipient can reconstruct the hidden message by extracting the least significant bit of each byte in the transmitted image. If the bitmap image has eight-bit color depth (256 colors), and the message to be hidden is a text message with eight-bit text encoding, then each letter of the text message can be encoded in and extracted from eight pixels of the bitmap image. While more sophisticated examples exist, the above example will serve to illustrate the basic concept.","The field of steganography is receiving a good deal of attention due to interest in covert communication via the Internet, as well as via other channels, and data hiding in information systems security applications. The single most important requirement of a steganographic method is that it be invisible to all but the intended recipient of the message.",{"@attributes":{"id":"p-0009","num":"0008"},"figref":["FIG. 1","FIG. 1"]},"Steganography in digital audio signals is especially challenging due to the acuity and complexity of the human auditory system (HAS). Besides having a wide dynamic range and a fairly small differential range, the HAS is unable to perceive absolute monaural phase, except in certain contrived situations.",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},"Two companies, Verance and Digimarc, have introduced schemes for watermarking of audio signals. Those two schemes will be described.","Verance was formed in 1999 from the merger of ARIS Technologies Inc. and Solana Technology Development Corporation. Verance provides software packages to companies interested in controlling the use of their copyrighted digital audio content, but the major application seems to be in broadcast monitoring and verification. For that application, hidden tags are inserted into digital files for TV and radio commercials, programs and music, and a service is provided which monitors all airplay in all major US media markets so that reports can be provided to the advertisers and copyright owners.","In 1999, Verance was selected to provide a worldwide industry standard for copy protected DVD audio and in the Secure Digital Music Initiative (SDMI) and was adopted by the 4C Entity, a consortium of technology companies committed to \u201cprotecting entertainment content when recorded to physical media.\u201d Verance's audio watermarking technology was intended to embed inaudible yet identifiable digital codes into an audio waveform. The audio watermarks are expected to carry detailed information associated with the audio and audio-visual content for such purposes as monitoring and tracking its distribution and use as well as controlling access to and usage of the content. Embedded watermarks travel with the audio and audiovisual content wherever it goes and are highly resistant to even the most sophisticated attempts to remove them.","The problem with Verance's technology for copyright protection, however, is that it can be hacked. It has been demonstrated that the watermark data can be detected and removed by hackers who were able to discover the key by applying general signal process analysis. This weakness was uncovered in a \u201chackers challenge\u201d test, set up by the SDMI. The technology has not been accepted by the industry since its announcement in 1999.","Digimarc was founded in 1995 with a focus on deterring counterfeiting and piracy of media content through \u201cdigital watermarking,\u201d primarily for images and video. It had revenue in 2002 of $80M. Its earliest success came from working with a consortium of leading central banks on the development of a system to deter PC counterfeiting of banknotes. The company provides products and services that enable production of millions of personal identification products such as driver's licenses in more than 33 US states and 20 countries.","Digimarc does not have a significant business in audio watermarking, but about six years ago, Digimarc competed in an open, competitive bid process by the DVD-CCA (DVD Copy Control Association), to protect movies from piracy. The DVD-CCA includes the leading companies from the motion picture, computer and consumer electronics industries. The DVD-CCA decided on Aug. 1, 2002, that the offered technologies from Digimarc and its competitors were inadequate. An interim solution was announced by the DVD-CCA on Sep. 15, 2003. It appears that that the interim DVD-CCA solution is no longer supported.","Other technologies will now be described.","An alternative data protection technique from NEC, as described in U.S. Pat. No. 6,539,475 (Method for protecting digital data through unauthorized copying), has a trigger signal embedded in the data. If the embedded trigger mark is present, the data is considered to be a scrambled copy. The device then descrambles the input data if it detects a trigger signal. In the case of an unauthorized copy that contains a trigger signal with unscrambled data, the descrambler would render the data useless.","The principal weakness of this technology lies in the requirement to remove the protection before the data can be used. If an authorized person is able to insert the recording device after the descrambling, an unprotected and descrambled copy of the data can be made.","In another patent, U.S. Pat. No. 6,684,199, assigned to the Recording Industry Association of America, the system authenticates data by introducing an authentication key in the form of a predetermined error. The purpose is to prevent piracy through unauthorized access and unauthorized copying of the data stored on the media disc. It is one of the few techniques that can survive analog conversion, but it is open to signal processing analysis by hackers.","Examination of various music and speech spectrograms indicates an apparent randomness of phase, which is not surprising since the analysis frequencies of the spectral analysis are not phase coherent with the frequencies present in the signal. So far, however, that apparent randomness of phase has not been exploited for data-hiding purposes.","It is therefore an object of the present invention to overcome the above-noted deficiencies of the prior art.","It is another object of the invention to realize a technique which resists blind signal-processing attacks.","It is still another object of the invention to realize a technique which can survive digital-to-analog conversion.","It is yet another object of the invention to realize a technique which can survive lossy audio compression, such as MPEG I layer III (MP3) compression, and which can even be applied directly to compressed audio files such as MP3 files.","To achieve the above and other objects, the present invention is directed to a technique in which the phase of chosen components of the host audio signal is manipulated. In a preferred embodiment, the phase manipulation, and thus the hidden message, may be detected by a receiver with the proper \u201ckey.\u201d Without the key, the hidden data is undetectable, both aurally and via blind digital signal processing attacks. The method described is both aurally transparent and robust and can be applied to both analog and digital audio signals, the latter including uncompressed as well as compressed audio file formats such as MP3. The present invention allows up to 20 kbits of data to be embedded in compressed or uncompressed audio files.","Naturally occurring audio signals such as music or voice contain a fundamental frequency and a spectrum of overtones with well-defined relative phases. When the phases of the overtones are modulated to create a composite waveform different from the original, the difference will not be easily detected. Thus, the manipulation of the phases of the harmonics in an overtone spectrum of voice or music may be exploited as a channel for the transmission of hidden data.","The fact that the phases are random presents an opportunity to replace the random phase in the original sound file with any pseudo-random sequence in which one may embed hidden data. In such an approach, the embedded data is encoded in the larger features of the cover file, which enhances the robustness of the method. To extract the embedded data, one uses the \u201ckey\u201d to distinguish the phase modulation encoding from the inherent phase randomness of the audio signal.","The present invention has the advantage over existing Verance algorithms of being undetectable and robust to blind signal processing attacks and of being uniquely robust to digital to analog conversion processing.","The present invention can be used to watermark movies by applying the watermark to the audio channel in such a way as to resist detection or tampering.","The present invention would allow copies of the data to be distributed as unscrambled information, but would contain the capability to identify the source of any copy. For example, a digital rights management system implementing the present invention would inform users as they download music that unauthorized copies are traceable to them and they are responsible for preventing further illegal distribution of the downloaded file.","Two preferred embodiments and variations thereon will be set forth in detail with reference to the drawings.","A first method of phase encoding is indicated in . In the illustrated method, during each time frame one selects a pair (or more) of frequency components of the spectrum and re-assigns their relative phases. The choice of spectral components and the selected phase shift can be chosen according to a pseudo-random sequence known only to the sender and receiver. To decode, one must compute the phase of the spectrum and correlate it with the known pseudo-random carrier sequence.","More specifically, a phase encoding scheme is indicated in which information is inserted as the relative phase of a pair of partials \u03c6, \u03c6in the sound spectrum. In each time frame a new pair of partials may be chosen according to a pseudo-random sequence known only to the sender and receiver. The relative phase between the two chosen spectral components is then modified according to a pseudo-random sequence onto which the hidden message is encoded.","A second preferred embodiment, called the Relative Phase Quantization Encoding Scheme or the Quantization Index Modulation (QIM) scheme, will now be disclosed with reference to . In that phase encoding method the following steps are employed. One first computes the spectrum of a frame of audio data, then selects an apparent fundamental tone and its series of overtones as shown in the left plot of ; it is convenient to select the strongest frequency component in the spectrum. Then, two of the overtones in the selected series are \u201crelative phase quantized\u201d according to one of two quantization scales, as shown on the right. The choice of quantization levels indicates a \u201c1\u201d or \u201c0\u201d datum. The relative phase-quantized spectrum is then inversely transformed to convert back to the time domain. The second preferred embodiment uses a variable set of phase quantization steps as explained below.","Step 1:","Segment the time representation of the audio signal S[i], (0\u2266i\u2266I\u22121) into series of frames of L points S[i] where (0\u2266i\u2266L\u22121). At this stage, a threshold check may be applied and the frame skipped if insufficient audio power was present in the frame.","Step 2:","Compute the spectrum of each frame of audio data and calculate the phase of each frequency component within the frame, \u03a6(\u03c9) (0\u2266i\u2266L\u22121). An idealization of a typical spectrum with a fundamental and accompanying overtone series is shown.","Step 3:","Quantize the relative phases of two of the overtones in the selected frame according to one of two quantization scales, as shown on the right of FIG. .\n\n\u0394\u03a6=\u03c0\/2\n\nIf \u20181\u2019 is to be embedded,\n\n\u03a6(\u03c9)=\u0394\u03a6\u00d7round(\u03a6(\u03c9)\/\u0394\u03a6)\n\nIf \u20180\u2019 is to be embedded,\n\n\u03a6(\u03c9)=\u0394\u03a6\u00d7round(\u03a6(\u03c9)\/\u0394\u03a6\u22120.5)+\u0394\u03a6\/2\n","The number of quantization levels \u2018n\u2019 is variable. The greater the number of levels, the less audible the effect of phase quantization. However, when a greater number of quantization levels is employed, the probability of data recovery error increases.","Step 4:","Inverse transform the phase-quantized spectrum to convert back to the time representation of the signal by applying an L-point IFFT (inverse fast Fourier transform).","Recovery of the embedded data requires the receiver to compute the spectrum of the signal and to know which two spectral components were phase quantized. In the tests described later, the relative phase between the fundamental and the second harmonic was employed as the communication channel.",{"@attributes":{"id":"p-0061","num":"0060"},"figref":["FIG. 5","FIG. 6"]},"The method described above was also applied to a 23-second-long classical guitar solo. Gaussian noise was introduced prior to decoding. The relative phase between the 2 strongest harmonics of the music file was quantized and embedded with 1 kbit of binary data then followed with the decoding process in the presence of Gaussian noise. The above was done for 3 different quantization scales (2equally spaced quantization levels), with n=1, 2 and 3 respectively. The decoding error rate at 3 different quantization levels with increasing signal to noise ratio (SNR) is shown in .","Applying the method described here to 512 points frames of 44,100 samples\/sec audio one may encode 86 bits per second per chosen spectral line. This is slightly over 5 kbits\/minute. We have also employed the method on up to 4 harmonics of the overtone spectrum with satisfactory results, raising the data capacity to approximately 20 kbits\/minute.","The robustness of data against lossy compression will now be described. MP3 is a common form of lossy audio compression that employs human auditory system features, specifically frequency and temporal masking, to compress audio by a factor of approximately 1:10.","The robustness of the steganographic technique described above was evaluated by hiding data in an uncompressed (.wav) audio file followed by conversion to MP3 format and then back to .wav format. The spectrograms of the final wav files were indistinguishable from the originals, and the audio quality was typical of MP3 compressed audio. In the example presented here, we embedded 1 kbit of data in the phase of the 2harmonic of the strongest spectral feature in each frame. The file was then converted to MP3 using the Lame MP3 encoder, converted back to .wav format and then examined for the presence of the hidden data. In , the decoding error rate is illustrated as a function of the MP3 encoder output bitrate\u2014ranging from 32 kbit\/sec to 224 kbit\/sec. We explored data survivability as a function of the number of quantization steps, 2, for n=1, 2, 3. The frame length employed was 576 points and the sampling frequency was 44,100 Hz.","It was found that the data recovery error rate could be reduced to near zero by employing an amplitude threshold in the selection of the segments of audio data that were encoded. A weak form of error correction could be employed to guard against such infrequent errors. One also may implement the techniques described above directly in compressed audio files, which would eliminate recovery errors.","To test the robustness of the stego message under D-A-D conversion, the audio file with the embedded binary stego message was recorded to cassette tape employing a common tape deck and then re-digitized using the same deck for play-back. The tape deck introduced amplitude modulation, nonlinear time shifts (wow and flutter) and broad-band noise.","The encoding method performs best when the decoder and the encoder are synchronized. As shown in , de-synchronization leads to an increased bit-recovery error rate. Therefore, a synchronization method is needed to compensate for the time shifts introduced by the D-A-D conversion process. One such method that we found to be effective is as follows. First, at the encoder we chose frames distributed periodically throughout the file to encode a stego message that is known to the decoder. At the decoder these frames serve as \u201csynchronization frames\u201d. For example, if we encode every fourth frame in the audio file with the binary stego message \u2018\u2019, during decoding we may check every fourth frame to assess the instantaneous time-shift and then resynchronize the remaining data frames before decoding.","Another factor is the ratio of power between the selected harmonics. In some frames, the power ratio is too low to allow robust encoding and those frames will be skipped. We found that for a power ratio of 1:5, the robustness of the method was maintained.",{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 10"},"An artifact of the phase manipulation method described above is a small discontinuity at the frame boundaries caused by reassignment of the phase of one of the spectral components. Depending upon the magnitude of the discontinuity, there may be a broad spectral component, appearing as white noise, in the background of the host file spectrum. In order to reduce the magnitude of the discontinuity, three techniques have been employed. In the first, rather than reassigning the phase of a single spectral component we do so for a band of frequencies in the neighborhood of the spectral component of interest. We typically use a band of frequencies of width equal to a few percent of the signal bandwidth.","A second method is to employ an error diffusion technique using a sigma delta modulator. Background information on sigma-delta modulation is found in our U.S. Pat. No. 6,707,409, issued Mar. 16, 2004.",{"@attributes":{"id":"p-0073","num":"0072"},"figref":["FIG. 11","FIG. 11","FIG. 11","FIG. 11"],"b":["1100","1102","1104","1","1104","2","1104","1106","1110","1104","1","1104","2","1104","1112"]},"Although both of these methods proved to be acceptable, a third method proved to be the simplest and most effective. The third method for reducing the phase discontinuities at the frame boundaries is simply to force the phase shifts to go to zero at the frame boundaries. In our implementation we employed a raised cosine function (1+cos)with n=10. At the frame boundaries the phase of the chosen harmonic is not shifted and in the central region of the frame the phase is shifted by an amount equal to the difference of the original phase of the chosen harmonic and the nearest phase quantization step. The audible artifacts are eliminated in this method.",{"@attributes":{"id":"p-0075","num":"0074"},"figref":"FIG. 12","b":["1200","1202","1214","1202","1214"]},"In the encoder , the audio signal and the data to be embedded are received in an input . A processor  embeds the data in the audio signal and outputs the encoded file through an output . From the output , the encoded file can be transmitted in any suitable fashion, e.g., by being placed on a persistent storage medium  (DVD, CD, tape, or the like) or by being transmitted over a live transmission system .","In the decoder , the encoded file is received at an input . A processor  extracts the embedded data from the signal and outputs the data through an output . If required, the audio signal can also be output through the output . For example, if the embedded data are used for watermarking purposes, the data and the audio signal can be supplied to a player which will not play the audio signal unless the required watermarking data are present.","The preferred embodiments will now be summarized with reference to the flow chart of . In step , the audio signal is divided into time frames and frequency components. In step , at least two frequency components are selected. In step , the phases are altered in accordance with the data.","While two preferred embodiments and variations thereon have been set forth above in detail, those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example, numerical values are illustrative rather than limiting, as are recitations of specific file formats. Moreover, in addition to steganography and watermarking, any suitable use for hidden data falls within the present invention. Furthermore, the present invention can be implemented on any suitable hardware through any suitable software, firmware, or the like. Also, audio signals or files are not limited to portions of data recognized as discrete files by an operating system, but instead may be continuously recorded signals or portions thereof. Therefore, the present invention should be construed as limited only by the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Preferred embodiments of the present invention and variations thereon will be set forth in detail with reference to the drawings, in which:",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 13"}]},"DETDESC":[{},{}]}
