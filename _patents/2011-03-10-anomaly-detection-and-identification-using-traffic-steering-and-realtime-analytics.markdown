---
title: Anomaly detection and identification using traffic steering and real-time analytics
abstract: A system, associated with a service provider network, is configured to monitor traffic, that is traveling to or from the service provider network, to obtain traffic metrics that correspond to a collection of network layers, where the network layers; process the traffic metrics with respect to each of the network layers to identify an anomaly, associated with the traffic, that corresponds to at least one of the network layers; send a request for packets associated with the traffic based on the identification of the anomaly; receive copies of the packets associated with the traffic; analyze the copies of the packets to obtain information associated with the anomaly; and send a notification that indicates that the anomaly has been identified, where the notification includes the traffic metrics associated with the traffic or the information associated with the anomaly.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09026644&OS=09026644&RS=09026644
owner: Verizon Patent and Licensing Inc.
number: 09026644
owner_city: Basking Ridge
owner_country: US
publication_date: 20110310
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS"],"p":["Service provider networks transport network traffic associated with a variety of services, applications, and content. The network traffic may include voice, text, video and\/or data. Service provider networks are sized and\/or scaled in order to transport an increasing quantity of traffic that is sent by and\/or received from more and more users and\/or content providers. Additionally, the increase in the quantity of traffic corresponds to an expanding demand for various types of services, applications, and\/or content.","Unfortunately, service provider networks are not always able to detect traffic conditions and\/or anomalies associated with the increased quantity of traffic being transported over the networks. Additionally, techniques for identifying conditions and\/or anomalies on a real-time basis often utilize large quantities of processing capacity, degrade network performance, and\/or reduce network throughput. Traffic conditions and\/or anomalies that are not detected and\/or remedied may cause congestion, service disruption, and\/or damage to occur within the service provider networks.","The following detailed description refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements.","Systems and\/or methods, described herein, may enable traffic (e.g., packets), associated with a service provider network, to be monitored in order to identify an anomaly, associated with the traffic, using traffic steering and\/or real-time analytics techniques. The traffic steering and real-time analytics techniques may be used by a network device (e.g., an analytics and reporting (AR) server) to monitor the traffic, at one or more network layers (e.g., layers one through seven of the International Organization of Standardization's Open Systems Interconnect (OSI) model) of the service provider network. The AR server may, based on the monitoring, obtain information associated with the traffic (hereinafter referred to as \u201ctraffic metrics\u201d) at the one or more network layers. The AR server may identify an anomaly, associated with the traffic, based on the traffic metrics. The AR server may obtain packets associated with the anomaly and\/or a flow to which the anomaly corresponds. The AR server may perform an analysis on the packets to identify information associated with the anomaly. The AR server may send a notification indicating that the anomaly has been detected. The notification may include the traffic metrics, information associated with the anomaly and\/or context information associated with a user device that is affected by the anomaly.","The real-time monitoring may include inspecting packets in a stateful manner that does not hinder and\/or reduce network throughput. The AR server may perform the stateful inspection by analyzing a portion of packets (e.g., headers, trailers, etc.), that does not include packet payloads, to obtain the traffic metrics. The AR server may perform statistical packet inspection (SPI) by analyzing whether particular traffic metrics conform to thresholds that are based on statistical norms associated with service provider network . The AR server may use the traffic metrics to identify changes, trends, and\/or triggers that indicate that an anomaly exists. Analyzing the portion of the packets that does not include the packet payload (e.g., usually associated with deep packet inspection (DPI) techniques) may permit the AR server to detect the anomaly in a manner that does cause network and\/or device throughput to decrease.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 1","FIG. 1","FIG. 1","FIG. 1"],"b":["100","100","110","1","110","110","110","120","130","140","1","140","140","140","150","160"]},"Also, in some implementations, one or more of the devices of environment  may perform one or more functions described as being performed by another one or more of the other devices of environment . Devices and\/or systems of environment  may interconnect via wired connections, wireless connections, or a combination of wired and wireless connections.","User device  may include any computation or communication device, such as a wireless mobile communication device that is capable of communicating with base station . For example, user device  may include a radiotelephone, a personal communications system (PCS) terminal (e.g., that may combine a cellular radiotelephone with data processing and data communications capabilities), a personal digital assistant (PDA) (e.g., that can include a radiotelephone, a pager, Internet\/intranet access, etc.), a laptop computer, a camera, a personal gaming system, or another type of mobile computation or communication device.","Base station  may include one or more devices that receive, process, and\/or transmit traffic, such as voice, video, text, and\/or other data, destined for and\/or received from user device . One or more base stations  may be associated with a radio access network (RAN) that receives traffic from and\/or sends traffic to service provider network . Base station  may send traffic to and\/or receive traffic from user device  via an air interface and may include one or more cells via which signals are received from and\/or transmitted to user device .","CDS  may include one or more devices that gather, process, search, store, and\/or provide information in a manner similar to that described herein. CDS  may perform operations associated with content distribution within environment . For example, CDS  may perform caching operations by obtaining content from content provider  and\/or temporarily storing the content in a memory associated with CDS . CDS  may process content in order to ensure that the content is sent to user device . CDS  may, for example, convert content into a format and\/or protocol based on a type of user device . CDS  may send the content, to user device  in a manner that maximizes network throughput without inducing congestion, jitter, and\/or other conditions.","CDS  may monitor packets associated with traffic flows being transported to and\/or from service provider network . CDS  may, based on the monitoring, determine whether a traffic anomaly, associated with a traffic flow, is detected. CDS  may, for example, obtain traffic metrics from packets associated with the traffic and may use the traffic metrics to identify the anomaly. CDS  may obtain the traffic metrics at one or more of the seven OSI network layers, such as at the physical layer (e.g., layer 1), the data link layer (e.g., layer 2), the network layer (e.g., layer 3), the transport layer (e.g., layer 4), the session layer (e.g., layer 5), the presentation layer (e.g., layer 6), and\/or the application layer (e.g., layer 7).","CDS  may process the traffic metrics to determine at which network layers anomalies are detected. CDS  may process the traffic metrics to identify which network device (e.g., within service provider network ) and\/or user device  is affected by the anomaly. CDS  may obtain context information associated with the affected user device  and\/or network device (e.g., locations, device identifiers, Internet protocol (IP) addresses, etc.). CDS  may replicate packets associated with the flow to which the anomaly corresponds and may analyze the replicated packets to obtain information associated with the anomaly. CDS  may generate an anomaly report that includes the traffic metrics, the context information, and\/or the information associated with the anomaly.","Content providers  may include any type or form of content providers. For example, content providers  may include free television broadcast providers (e.g., local broadcast providers, such as NBC, CBS, ABC, and\/or Fox), for-pay television broadcast providers (e.g., TNT, ESPN, HBO, Cinemax, CNN, etc.), and\/or Internet-based content providers (e.g., YouTube, Vimeo, Netflix, Hulu, Veoh, etc.) that stream content from web sites and\/or permit content to be downloaded (e.g., via progressive download, etc.). Content providers  may produce media streams (e.g., television broadcasts). A media stream may refer to stream of content that includes video content (e.g., a video stream), audio content (e.g., an audio stream), and\/or textual content (e.g., a textual stream).","Service provider network  may include one or more wired and\/or wireless networks via which user devices  communicate and\/or receive content. For example, service provider network  may include a cellular network, the Public Land Mobile Network (PLMN), a second generation (2G) network, a third generation (3G) network, a fourth generation (4G) network (e.g., a long term evolution (LTE) network), a fifth generation (5G) network, and\/or another network. Additionally, or alternatively, service provider network  may include a wide area network (WAN), a metropolitan area network (MAN), an ad hoc network, an intranet, a fiber optic-based network (e.g., a fiber optic service network), and\/or a combination of these or other types of networks.","Network  may include one or more wired and\/or wireless networks. For example, network  may include a cellular network, the PLMN, a 2G network, a 3G network, a 4G network (e.g., an LTE network), a 5G network, and\/or another network. Additionally, or alternatively, network  may include a WAN, a MAN, a telephone network (e.g., the Public Switched Telephone Network (PSTN)), an ad hoc network, an intranet, the Internet, a fiber optic-based network, and\/or a combination of these or other types of networks.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 2","FIG. 2","FIG. 2"],"b":["130","130","205","210","220","230","230","130","130","130","130"]},"EPC device  may include a network device that, receives, processes, switches, routes, and\/or transmits packets associated with traffic being transported to and\/or from service provider network . For example, EPC device  may take the form of a routing device, a switching device (e.g., an Ethernet switch, etc.), a multiplexing device, or a device that performs a combination of routing, switching, and\/or multiplexing functions. In one example implementation, EPC device  may be a digital device. In another example implementation, EPC device  may be an optical device. In yet another example implementation, EPC device  may be a combination of a digital device and an optical device.","EPC device  may generally function to connect service provider network  to CO steering device  and\/or network . For example, EPC device  may transfer traffic, received from user device  (e.g., via service provider network ), to network  via CO steering device . In another example, EPC device  may receive, from network  and via CO steering device , traffic that is destined for user device , and EPC device  may send the traffic to user device  via service provider network . EPC device  may transfer DNS queries, received from user device  via service provider network , to DNS server  to obtain an IP address associated with content provider  from which content is to be retrieved. EPC device  may forward, to CO steering device , the obtained IP address in order to enable the content to be retrieved from content provider .","DNS server  may be a server device that manages, stores, and\/or obtains one or more IP addresses for all or a portion of content providers  from which content can be obtained. DNS server  may receive, from user device  and via EPC , a request for an IP address associated with particular content (e.g., based on a domain name, etc.). DNS server  may, in one example, retrieve an IP address, associated with a particular content provider , that corresponds to the domain name. DNS server  may send the IP address to user device  in order to enable user device  to communicate with the particular content provider .","AR server  may include one or more server devices, or other types of computation or communication devices, that gather, process, search, store, and\/or provide information in a manner similar to that described herein. In one example implementation, AR server  may monitor traffic being sent to and\/or received from server provider network .","For example, AR server  may monitor packets associated with traffic flows that are being transported to and\/or received from service provider network . AR server  may obtain traffic metrics, associated with the traffic flows, as a result of the monitoring.","AR server  may monitor the traffic flows, in real-time, at one or more of the OSI network layers. AR server  may, when monitoring the traffic flows, analyze packets associated with the traffic flows in a stateful manner (e.g., by analyzing the contents of packet headers, trailers, etc.). When analyzing the packets with respect to layer one, for example, AR server  may identify a quantity of bandwidth being used by user device . In another example, AR server may identify errors in layer three headers (e.g., IP version 4 (v4) headers, IP version 6 (v6) headers, etc.) and\/or layer four headers (e.g., transmission control protocol (TCP) headers, user datagram protocol (UDP) headers, etc.). In yet another example, with respect to layer five processing, AR server  may identify information associated with calls placed by user device  and\/or sent to user device , such as call termination rates, average call duration, etc. When processing the packets with respect to layer six, AR server  may determine whether a particular type of multipurpose Internet mail extension (MIME) (e.g., a particular MIME type) has been detected, etc. When processing the packets with respect to layer seven, AR server  may identify a quantity of web page not found errors (e.g., \u201c404\u201d errors), etc.","AR server  may determine that an anomaly, associated with a traffic flow, exists based on traffic metrics obtained as a result of monitoring the traffic flows. AR server  may, for example, determine that all or a portion of the traffic metrics do not conform to a threshold associated with one or more of the OSI thresholds. In an example implementation, AR server  may perform statistical packet inspection (SPI) by analyzing whether particular traffic metrics conform to thresholds that are based on statistical norms associated with service provider network .","AR server  may obtain context information, associated with user device , based on the determination that the anomaly has been detected. For example, AR server  may determine, from the traffic metrics, that user device  is affected by the anomaly. AR server  may obtain context information associated with user device  from service provider network . The context information may include an identifier associated with user device  (e.g., a mobile directory number (MDN), an IP address, etc.), information associated with an operating system being used by user device , a type of user device , etc. Additionally, or alternatively, AR server  may communicate with service provider network  to obtain location information associated with user device  (e.g., using a particular application programming interface (API) that enables the location information to be obtained). In another example, AR server  may retrieve, from service provider network , information associated with a usage history (e.g., previous web pages visited, calls made, etc.) that corresponds to user device .","AR server  may send a request for packets associated with the traffic flow to which the anomaly corresponds. For example, AR server  may generate an AR packet that identifies information associated with the flow (e.g., a source and\/or destination IP address, a uniform resource locator (URL), a source and\/or destination port, a MDN associated with user device , a type of user device , a quantity of packets to be copied, etc.). AR server  may send, to CO steering device , the AR packet requesting all or a portion of the packets associated with the flow. CO steering device  may receive the request and may replicate packets associated with the flow based on the information obtained from the AR packet. CO steering device  may send the replicated packets to AR server  in response to the request.","AR server  may receive the replicated packets and may analyze the packets to obtain information associated with the anomaly that may be stored within the replicated packets. The information associated with the anomaly may include, for example, an indication that malicious software (e.g., a virus, a worm, etc.) is included within the replicated packets. In another example, the information associated with the anomaly may include an indication that an incorrect protocol and\/or standard is associated with the flow.","When analyzing the packets, AR server  may perform statistical analysis (e.g., based on SPI techniques) to determine whether particular traffic metrics conform to thresholds associated with statistical norms of network performance. In another example implementation, AR server  may perform a DPI operation that includes analyzing payloads associated with the replicated packets to obtain information associated with the anomaly.","AR server  may generate a notification associated with the anomaly that includes the replicated packets, information associated with the anomaly, the traffic metrics, the context information, and\/or other information associated with the anomaly. AR server  may send the notification to a server device, that enables an operator, associated with service provider network , to remedy the anomaly.","CO steering device  may include one or more server devices, or other types of computation or communication devices, that gather, process, search, store, and\/or provide information in a manner similar to that described herein. In one example implementation, CO steering device  may perform content optimization operations on content being served to user devices . For example, CO steering device  may process content, destined for user device , to maximize throughput and\/or avoid congestion while being transported over service provider network .","In another example, CO steering device  may perform packet replication operations. For example, CO steering device  may receive, from AR server , a request for a copy of packets associated with a flow with which an anomaly has been detected. In one example, the request may include an AR packet which identifies information associated with the flow. CO steering device  may collect packets, associated with the flow identified by the request. CO steering device  may, for example, identify packets to be collected based on information obtained from the AR packet (e.g., a destination and\/or source IP address, a URL, a destination and\/or source port, a MDN, a MIME type, a device type, etc.). CO steering device  may perform a replication operation on the packets to generate a copy of the packets. CO steering device  may send the collected packets to the destination IP address and may send (e.g., \u201csteer\u201d) the replicated packets to AR server  in response to the request.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 3","FIG. 3","FIG. 3"],"b":["300","110","205","210","220","230","110","205","210","220","230","300","300","310","320","330","340","350","360","300","300","300","310","300","300"]},"Bus  may include a path that permits communication among the components of device . Processor  may include a processor, microprocessor, or processing logic that may interpret and execute instructions. Memory  may include any type of dynamic storage device that may store information and instructions, for execution by processor , and\/or any type of non-volatile storage device that may store information for use by processor .","Input component  may include a mechanism that permits a user to input information to device , such as a keyboard, a keypad, a button, a switch, etc. Output component  may include a mechanism that outputs information to the user, such as a display, a speaker, one or more light emitting diodes (LEDs), etc. Communication interface  may include any transceiver-like mechanism that enables device  to communicate with other devices and\/or systems via wireless communications (e.g., radio frequency, infrared, and\/or visual optics, etc.), wired communications (e.g., conductive wire, twisted pair cable, coaxial cable, transmission line, fiber optic cable, and\/or waveguide, etc.), or a combination of wireless and wired communications. For example, communication interface  may include mechanisms for communicating with another device or system via a network, such as service provider network  and\/or network . In one alternative implementation, communication interface  may be a logical component that includes input and output ports, input and output systems, and\/or other input and output components that facilitate the transmission of data to other devices.","As will be described in detail below, device  may perform certain operations relating anomaly detection and identification. Device  may perform these operations in response to processor  executing software instructions contained in a computer-readable medium, such as memory . A computer-readable medium may be defined as a non-transitory memory device. A memory device may include space within a single physical memory device or spread across multiple physical memory devices. The software instructions may be read into memory  from another computer-readable medium or from another device. The software instructions contained in memory  may cause processor  to perform processes described herein. Alternatively, hardwired circuitry may be used in place of or in combination with software instructions to implement processes described herein. Thus, implementations described herein are not limited to any specific combination of hardware circuitry and software.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 4","FIG. 4"],"b":["400","400","220","150","400","400","405","410","430","440","450","460","400","405","460","400","400"]},"Layer 1 field  may store traffic metrics associated with layer one of the OSI model. Layer 1 field  may include a user device (UD) bandwidth entry , a uniform resource locator (URL) bandwidth entry , and a concurrent flow entry . Layer 1 field  includes entries - for explanatory purposes. In practice, layer 1 field  may include additional entries, fewer entries, different entries, and\/or differently arranged entries than are described with respect to layer 1 field .","UD bandwidth entry  may store information associated with a quantity of bandwidth associated with flows originating from user device  and\/or being served to user device  over a period of time during which AR server  is monitoring the traffic. URL bandwidth entry  may store information associated with a quantity of bandwidth of a URL, that corresponds to a particular content provider . The quantity of bandwidth may, for example, be based on flows from one or more user devices  that are communicating with the particular content provider during the period of time. Concurrent flow entry  may store information associated with a quantity of concurrent flows to and\/or from service provider network  during the period of time.","AR server  may, for example, detect an anomaly associated with layer one traffic metrics, when the quantity of bandwidth, stored in UD bandwidth entry  is greater than a threshold associated with a maximum quantity of bandwidth used by user device . In another example, AR server  may determine that an anomaly exists when the quantity of bandwidth, stored in URL bandwidth entry , is greater than a threshold associated with a maximum quantity of bandwidth used for a URL. In yet another example, AR server  may determine that an anomaly exists when the quantity of concurrent flows, as indicated by concurrent flow entry , is greater than a threshold associated with a maximum quantity of concurrent flows.","Layer 3 field  may store traffic metrics associated with layer three of the OSI model. Layer 3 field  may include a domain name service (DNS) queries entry , a destination uniform resource locator (URL) entry , a server address entry , a content provider IP address entry , a ports entry , a user device (UD) destined to common URL entry , and a foreign traffic entry . Layer 3 field  includes entries - for explanatory purposes. In practice, layer 3 field  may include additional entries, fewer entries, different entries, and\/or differently arranged entries than are described with respect to layer 3 field .","DNS queries entry  may store information associated with a DNS queries rate based on a quantity of DNS queries over the period of time during which AR server  is monitoring the traffic associated with service provider network . Destination URL entry  may store a destination URL associated with a flow. Server address entry  may store a server URL and\/or IP address that has not previously been detected by AR server . For example, AR server  may compare a server URL and\/or IP address, obtained from the traffic, to a list of URLs and\/or IP addresses stored in a memory associated with AR server . AR server  may store the server URL and\/or IP address in server URL entry  based on a determination that the server URL and\/or IP address does not match a stored URL and\/or IP address. Content provider IP address entry  may store an IP address associated with content provider  with which a flow is associated. For example, AR server  may store an IP address obtained from a hypertext transfer protocol (HTTP) message (e.g., a HTTP get message) to retrieve content from content provider .","Ports entry  may store information associated with a quantity of ports being used by user device  over a period of time during which AR server  is monitoring traffic. UD destined for common URL entry  may store information associated with a quantity of user devices , associated with service provider network , that are communicating with the same URL and\/or port. Foreign traffic entry  may store information associated with a quantity of traffic flows to and\/or from a network associated with a foreign country.","AR server  may, for example, detect an anomaly associated with layer three traffic metrics, when a DNS query rate (e.g., stored in DNS queries entry ) is greater than a threshold associated with a maximum DNS query rate permitted by service provider network . In another example, AR server  may determine that an anomaly exists when a server URL and\/or IP address, which has not before been detected, is stored in server address entry . In yet another example, AR server  may determine that an anomaly exists when a quantity of ports being used by user device , as indicated by ports used entry , is greater than a threshold associated with a maximum quantity of ports permitted to be used by user device . In still another example, AR server may determine that an anomaly exists when a quantity of user devices  that are communicating with the same URL, as indicated by UD destined for common URL entry , is greater than a threshold. The threshold may be associated with a maximum quantity of user devices  permitted to communicate with a URL at a point in time. In further example, AR server  may determine that an anomaly exists when a quantity of flows that are being sent to and\/or received from a network associated with a foreign country, as indicated by foreign traffic entry , is greater than a threshold associated with a maximum quantity of flows associated with a foreign country.","Layer 4 field  may store traffic metrics associated with layer four of the OSI model. Layer 4 field  may include a flows to destination port entry , a repeat connections entry , and a port sweeping entry . Layer 4 field  includes entries - for explanatory purposes. In practice, layer 4 field  may include additional entries, fewer entries, different entries, and\/or differently arranged entries than are described with respect to layer 4 field .","Flows to destination port entry  may store information associated with a quantity of concurrent flows, from service provider network , that are destined for a particular TCP port and\/or UDP port. Repeat connections entry  may store information associated with quantity of times user device  attempts to reconnect to the same TCP and\/or UDP port. Port sweeping entry  may store information that indicates that user device  is sweeping UDP and\/or TCP ports. For example, AR server  may determine that user device  is repeatedly attempting to connect to a quantity of ports within period of time during which AR server  is monitoring the traffic.","AR server  may, for example, detect an anomaly associated with layer four traffic metrics, when a quantity of concurrent flows that are destined for a particular TCP and\/or UDP port, as indicated by flows to destination port entry , are greater than a threshold. The threshold may correspond to a maximum quantity of concurrent flows, destined for a TCP and\/or UDP port, that are permitted by service provider network . In another example, AR server  may determine that an anomaly exists when a quantity of times user device  attempts to reconnect to a particular TCP and\/or UDP port (e.g., as indicated by repeat connections entry ) is greater than a threshold associated with a maximum quantity of repeat connections permitted by service provider network . In yet another example, AR server  may determine that an anomaly exists when an indication that user device  is port sweeping, is stored in port sweeping entry .","Layer 5 field  may store traffic metrics associated with layer five of the OSI model. Layer 5 field  may include a session initiation protocol (SIP) calls to external server entry , a call termination rate entry , and a call duration entry . Layer 5 field  includes entries - for explanatory purposes. In practice, layer 5 field  may include additional entries, fewer entries, different entries, and\/or differently arranged entries than are described with respect to layer 5 field .","SIP calls to external server entry  may store information associated with a quantity of calls to SIP servers that are not associated with service provider network . Call termination rate entry  may store information associated with a call termination rate associated with service provider network . For example, AR server  may identify the call termination rate based on a quantity of call terminations over a period of time during which AR server  is monitoring traffic. Call duration entry  may store information associated with a time period of calls (e.g., an average call duration, etc.) originating from service provider network  and\/or being sent to user devices  via service provider network .","AR server  may, for example, detect an anomaly associated with layer five traffic metrics, when a quantity of calls to an external SIP server, as indicated by entry , is greater than a threshold that corresponds to a maximum quantity of calls to the external SIP server that is permitted by service provider network . In another example, AR server  may determine that an anomaly exists when a call termination rate, as indicated by call termination rate entry , is greater than a threshold that corresponds to a maximum call termination rate permitted by service provider network . In yet another example, AR server  may determine that an anomaly exists when a difference between an average call duration, as indicated by average call duration entry , and an average call duration, associated with service provider network , is greater than a threshold.","Layer 6 field  may store traffic metrics associated with layer six of the OSI model. Layer 6 field  may include a MIME type entry . Layer 6 field  includes entry  for explanatory purposes. In practice, layer 6 field  may include additional entries, different entries, and\/or differently arranged entries than are described with respect to layer 6 field . MIME type entry  may store information associated with a MIME type that has not before been detected by AR server . AR server  may, for example, detect an anomaly associated with layer six traffic metrics, when a MIME type, not before detected by AR server , is stored in MIME type entry .","Layer 7 field  may store traffic metrics associated with layer seven of the OSI model. Layer 7 field  may include a DNS resolutions to URL entry  and an errors entry . Layer 7 field  includes entries  and  for explanatory purposes. In practice, layer 7 field  may include additional entries, fewer entries, different entries, and\/or differently arranged entries than are described with respect to layer 7 field .","DNS resolutions to URL entry  may store information associated with a quantity of DNS query results that are associated with a particular URL. Errors entry  may store information associated with a quantity of \u201c404\u201d errors (e.g., web page not found) received when user devices , associated with service provider network , attempt to retrieve content from content providers .","AR server  may, for example, detect an anomaly associated with layer seven traffic metrics, when a quantity of DNS query results, associated with a particular URL (as indicated by entry ), are greater than a threshold. The threshold may be associated with a maximum quantity of DNS query results, associated with a particular URL, that is permitted by service provider network . In another example, AR server  may detect an anomaly when the quantity of 404 errors, received by user devices  (as indicated by entry ), is greater than a threshold associated with a maximum quantity of 404 errors permitted by service provider network .",{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 5","b":["500","500","500","505","510","515","520","525","530","535","540","540","500","505","540","500","500"]},"Anomaly ID field  may store a unique identifier associated with an anomaly that has been detected by AR server . The unique identifier may be used, by AR server  and\/or a network management server to track and\/or manage the anomaly. Start time field  may store a time at which the anomaly was detected by AR server  when monitoring the traffic to and\/or from service provider network . Stop time field  may store another time when the anomaly is no longer detected by AR server .","Anomaly classification field  may store information associated with a class of the anomaly. For example, AR server  may store information associated with a class of the anomaly that corresponds to one or more OSI layers in which the anomaly was detected. In another example, AR server  may store information associated with a class of the anomaly based on a type of anomaly (e.g., a protocol error, a potential electronic attack, malicious software, an unknown user device , an unknown content provider , etc.). In yet another example, AR server  may store information associated with a class of anomaly that corresponds to a severity of the anomaly and\/or an urgency by which to remedy the anomaly.","UD context info field  may store context information associated with user device  that has been affected by the anomaly. The context information may include, for example, information associated with user device  (e.g., a MDN, an IP address, a port identifier, etc.), information associated with a type of user device , information associated with an operating system hosted by user device , a location associated with user device  (e.g., latitude, longitude, a geographical area in which user device  is located, a zip code, an address, etc.), and\/or information associated with a user of user device  (e.g., a username, password, personal identification number (PIN), etc.). The context information may also, or alternatively, include information associated with prior usage history associated with user device , such as a quantity of previous web pages accessed, calls placed and\/or received, and\/or URLs used by user device . Traffic metrics field  may include all or a portion of the traffic metrics obtained, by AR server , as a result of the monitoring (e.g., as shown in metrics data structure  of ).","Packet analysis info field  may store information obtained by AR server  as a result of a packet analysis operation performed on packets associated with a flow that corresponds to the anomaly. In one example, the packets on which the packet analysis was performed may be replicated from packets, associated with the flow that corresponds to the anomaly. Packet analysis field  may store information generated as a result of statistical analysis (e.g., based on SPI techniques) of the packets relative to packets associated with other anomalies within service provider network . For example, the packet analysis information, stored within packet analysis info field , may include a quantity of flows (e.g., that is statistically greater than a threshold) associated with the anomaly and\/or other anomalies detected within service provider network . In another example, the packet analysis information may include information associated with other flows and\/or other anomaly IDs, detected by AR server  within service provider network , that correlate to the classification of the anomaly (e.g., as identified by anomaly classification field ).","The packet analysis information may include information associated with a quantity of bandwidth associated with the anomaly and\/or the other anomalies that is statistically greater than a threshold. The packet analysis information may include information associated with network layer three header values (e.g., such as an IPv4 header, an IPv6 header, etc.) and\/or network layer four header values (e.g., a TCP header, a UDP header, etc.). AR server  may identify and\/or highlight errors detected within the information associated with the layer three header and\/or layer four header. The packet analysis information may include sequence identifiers associated with the packets and AR server  may identify missing packets and\/or mis-ordered packets based on missing sequence identifiers and\/or mis-ordered sequence identifiers, respectively.","Geo field  may store geographical information and\/or network topographical information associated with the anomaly and\/or other anomalies. The geographical information may include information associated with a geographical area within which user devices  and\/or network devices (e.g., within service provider network ) that are affected by the anomaly are located. The network topographical information may include information associated with a topology of service provider network . The topology of service provider network  may identify devices and\/or network paths within service provider network  and\/or may highlight particular devices that may be affected by the anomaly.",{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 6","b":["600","220","600","220"]},"As shown in , process  may include monitoring traffic being transported to and\/or from a service provider network (block ). For example, AR server  may monitor traffic being transported to and\/or from service provider network . AR server  may, for example, monitor the traffic with respect to one or more network layers of the OSI model (e.g., layers one through seven). AR server  may, in another example, monitor each packet, associated with the traffic, in a stateful manner (e.g., based on packet content that is not stored in packet payloads) and\/or another technique that does not include DPI of packet payloads.","As also shown in , process  may include obtaining traffic metrics based on the traffic monitoring (block ). For example, AR server  may obtain traffic metrics, associated with the traffic that is being transported to and\/or from service provider network , as a result of monitoring the traffic. AR server  may obtain traffic metrics with respect to network layer one in a manner similar to that described above (e.g., layer 1 field  of ). The layer one traffic metrics may be include information associated with a quantity of bandwidth used by user device  and\/or another quantity of bandwidth that corresponds to communications associated with an IP address and\/or URL. Additionally, or alternatively, the layer one traffic metrics may include a quantity of concurrent flows associated with the traffic.","AR server  may obtain traffic metrics with respect to network layer three in a manner similar to that described above (e.g., layer 3 field  of ). The layer three traffic metrics may include information associated with a quantity of DNS queries being processed by service provider network  and\/or DNS server . The layer three traffic metrics may include a destination URL associated with the traffic and\/or an IP address used in requests to obtain content (e.g., an HTTP get message) from content provider . The layer three traffic metrics may include a server URL and\/or a server IP address that has not yet been detected by AR server . The layer three traffic metrics may include information associated with a quantity of ports being used by user device  at a point in time and\/or over a period of time. The layer three traffic metrics may include information associated with a quantity of user devices  that are communicating with a particular URL and\/or a network associated with a foreign country (e.g., a country other than a country in which service provider network  is located).","AR server  may obtain traffic metrics with respect to network layer four in a manner similar to that described above (e.g., layer 1 field  of ). The layer four traffic metrics may include information associated with a quantity of concurrent flows that are destined to a particular port (e.g., a TCP port, a UDP port, etc.) and\/or information associated a quantity of repeat connections, by user device , to a particular port. The layer four traffic metrics may include an indication that user device  is sweeping ports (e.g., repeatedly attempting to communicate via multiple TCP ports, UDP ports, and\/or other ports).","AR server  may obtain traffic metrics with respect to network layer five in a manner similar to that described above (e.g., layer 5 field  of ). The layer five traffic metrics may include information associated with a quantity of SIP calls to an external server (e.g., a server that is not associated with service provider network ). The layer five traffic metrics may include information associated with a call termination rate and\/or a call duration (e.g., an average call duration, etc.).","AR server  may obtain traffic metrics with respect to network layer six in a manner similar to that described above (e.g., layer 6 field  of ). The layer six traffic metrics may include information associated with a MIME type that has not yet been detected by AR server .","AR server  may obtain traffic metrics with respect to network layer seven in a manner similar to that described above (e.g., layer 7 field  of ). The layer seven traffic metrics may include information associated with a quantity of DNS queries to a particular URL and\/or a quantity of 404 errors associated with the traffic.","As further shown in , process  may include processing the traffic metrics at one or more network layers (block ). For example, AR server  may process the traffic metrics at each of the one or more network layers for which traffic metrics were obtained to determine whether an anomaly exists with respect to the traffic. In one example implementation, AR server  may perform statistical analysis (e.g., based on SPI techniques) on the traffic metrics to determine whether any of the traffic metrics do not conform to threshold corresponding to statistical norms associated with service provider network . AR server  may, for example, compare one or more traffic metrics, associated with layer one traffic metrics, with a respective different threshold that corresponds to each of the one or more layer one traffic metrics. In one example, AR server  may compare a quantity of bandwidth, associated with traffic originating from user device , with a threshold associated with a maximum quantity of bandwidth for user device . AR server  may, in another example, compare another layer one traffic metric (e.g., quantity of concurrent flows, quantity of bandwidth associated with a particular URL, etc.) with another threshold to determine whether a layer one anomaly is detected with respect to the other layer one traffic metric.","AR server  may, for example, compare one or more traffic metrics, associated with layer three traffic metrics, with a respective different threshold that corresponds to each of the one or more layer three traffic metrics. In one example, AR server  may compare a quantity of DNS queries being processed over a period of time with a threshold associated with a maximum quantity of DNS queries permitted to be processed over the period of time. AR server  may compare another layer three traffic metric (e.g., a quantity of ports being used by user device  over a time period, a quantity of user devices  communicating with a particular URL and\/or port, a quantity of user devices  that are communicating with a network associated with a foreign country, etc.) with another threshold to determine whether a layer three anomaly is detected with respect to the other layer three traffic metric. In another example, AR server  may determine whether an layer three anomaly is detected based on whether a destination URL, a server IP address, and\/or a server URL, which have not been detected at a previous point in time, have been detected by AR server .","AR server  may, for example, compare one or more traffic metrics, associated with layer four traffic metrics, with a respective different threshold that corresponds to each of the one or more layer four traffic metrics. In one example, AR server  may compare a quantity of concurrent flows destined for a particular port (e.g., a TCP port, UDP port, etc.) with a threshold associated with a maximum quantity of concurrent flows destined for a port permitted by service provider network . AR server  may compare other layer four traffic metrics (e.g., a quantity of repeat connection attempts to a particular port, etc.) with another threshold to determine whether a layer four anomaly is detected with respect to the other layer four traffic metric. In another example, AR server  may determine whether a layer four anomaly is detected based on whether port sweeping by user device  is detected.","AR server  may, for example, compare one or more traffic metrics, associated with layer five traffic metrics, with a respective different threshold that corresponds to each of the one or more layer five traffic metrics. In one example, AR server  may compare a quantity of SIP calls to an external server (e.g., a server not associated with service provider network ) with a threshold associated with a maximum quantity of SIP calls permitted to be made to an external server. AR server  may compare other layer five traffic metrics (e.g., a call termination rate, an average call duration, etc.) with another threshold to determine whether a layer five anomaly is detected with respect to the other layer five traffic metrics.","AR server  may determine whether an anomaly, associated with network layer six, is detected. AR server  may, for example, determine whether a MIME type, which has not been detected at a prior point in time, has been detected by AR server .","AR server  may, for example, compare one or more traffic metrics, associated with layer seven traffic metrics, with a respective different threshold that corresponds to each of the one or more layer seven traffic metrics. In one example, AR server  may compare a quantity of DNS queries to a particular URL over a period of time with a threshold associated with a maximum quantity of DNS queries, to a particular URL, that are permitted over the period of time. AR server  may compare another layer seven traffic metric (e.g., a quantity of  errors within a time period, etc.) with another threshold to determine whether a layer seven anomaly is detected with respect to the other layer seven traffic metric.","As further shown in , if an anomaly, associated with the traffic, is not detected (block \u2014NO), then process  may include monitoring traffic being transported to and\/or from the service provider network (block ). For example, AR server  may determine that a layer one anomaly does not exist when all of the layer one traffic metrics conform to layer one thresholds. AR server  may determine, for example, that a layer one anomaly does not exist, based on a determination that the quantity of bandwidth, associated with the traffic originating from user device , is not greater than the threshold associated with a maximum quantity of bandwidth permitted for user device .","AR server  may determine that a layer three anomaly does not exist when all of the layer three traffic metrics conform to layer three thresholds. For example, AR server  may determine that a layer three anomaly does not exist based on a determination that the quantity of DNS queries being processed over the period of time is not greater than the threshold associated with a maximum quantity of bandwidth permitted for user device .","AR server  may determine that a layer four anomaly does not exist when all of the layer four traffic metrics conform to layer four thresholds. For example, AR server  may determine that a layer four anomaly does not exist based on a determination that the quantity of concurrent flows that are destined for the particular port is not greater than the threshold associated with the maximum quantity of concurrent flows permitted to be destined for a port.","AR server  may determine that a layer five anomaly does not exist when all of the layer five traffic metrics conform to layer five thresholds. For example, AR server  may determine that a layer five anomaly does not exist based on a determination that the quantity of SIP calls to the external server is not greater than the threshold associated with the maximum quantity of SIP calls permitted to be made to an external server.","AR server  may determine that a layer six anomaly does not exist when all of the layer six traffic metrics conform to layer six thresholds. For example, AR server  may determine that a layer six anomaly does not exist based on a determination that a MIME type associated with the traffic has been detected at a prior point in time.","AR server  may determine that a layer seven anomaly does not exist when all of the layer seven traffic metrics conform to layer seven thresholds. For example, AR server  may determine that a layer seven anomaly does not exist based on a determination that the quantity of DNS queries to the particular URL is not greater than the threshold associated with the maximum quantity of URL queries permitted to be made to a URL.","AR server  may continue to monitor traffic being transported to and\/or from service provider network  based on the determination that an anomaly has not been detected.","As yet further shown in , if an anomaly, associated with the traffic, is detected (block \u2014YES), then process  may include obtaining context information associated with an affected user device  (block ). For example, AR server  may determine that a layer one anomaly exists when one or more of the layer one traffic metrics do not conform to respective layer one thresholds. AR server  may determine, for example, that a layer one anomaly exists, based on a determination that the quantity of bandwidth, associated with the traffic originating from user device , is statistically greater (e.g., based on an average bandwidth, a peak bandwidth, etc.) than the threshold associated with a maximum quantity of bandwidth permitted for user device .","AR server  may determine that a layer three anomaly exists when one or more of the layer three traffic metrics do not conform to respective layer three thresholds. For example, AR server  may determine that a layer three anomaly exists based on a determination that the quantity of DNS queries being processed over the period of time is greater than the threshold associated with a maximum quantity of bandwidth permitted for user device .","AR server  may determine that a layer four anomaly exists when one or more of the layer four traffic metrics do not conform to respective layer four thresholds. For example, AR server  may determine that a layer four anomaly exists based on a determination that the quantity of concurrent flows that are destined for the particular port is greater than the threshold associated with the maximum quantity of concurrent flows permitted to be destined for a port.","AR server  may determine that a layer five anomaly exists when one or more of the layer five traffic metrics do not conform to respective layer five thresholds. For example, AR server  may determine that a layer five anomaly exists based on a determination that the quantity of SIP calls to the external server is greater than the threshold associated with the maximum quantity of SIP calls permitted to be made to an external server.","AR server  may determine that a layer six anomaly exists when one or more of the layer six traffic metrics do not conform to respective layer six thresholds. For example, AR server  may determine that a layer six anomaly exists based on a determination that a MIME type associated with the traffic has not been detected at a prior point in time.","AR server  may determine that a layer seven anomaly exists when one or more of the layer seven traffic metrics do not conform to respective layer seven thresholds. For example, AR server  may determine that a layer seven anomaly exists based on a determination that the quantity of DNS queries to the particular URL is greater than the threshold associated with the maximum quantity of URL queries permitted to be made to a URL.","AR server  may obtain context information associated with user device  affected by the anomaly, based on a determination that an anomaly, associated with the traffic, has been detected. For example, AR server  may determine, from the traffic metrics, that user device  is affected by the anomaly based on a MDN associated with the flow to which the anomaly corresponds. AR server  may obtain context information associated with user device  from service provider network  and\/or CO steering device . For example, AR server  may send a request to CO steering server  for information associated with user device . CO steering server  may use the MDN and\/or an IP address, obtained from the request, to identify an internal IP address and\/or port, via which user device  communicates with service provider network , based on network address translation (NAT) bindings.","In another example, AR server  may send a query, to service provider network  (e.g., an home subscriber server, an authentication, authorization, and accounting server, etc.), to obtain context information associated with user device . The context information, obtained from service provider network , may include information associated with an operating system being used by user device , a type of user device , location information associated with user device , information associated with a user of user device , etc.","AR server  may retrieve context information associated with user device , from a memory associated with AR server . The context information, retrieved from the memory, may include information associated with a usage history for user device , such as information associated with a quantity of prior web pages accessed, previous URLs used, calls received and\/or placed, etc.","As still further shown in , process  may include sending a request to obtain packets associated with the anomaly (block ) and receiving the packets associated with the anomaly (block ). For example, AR server  may generate a request to retrieve packets associated with the flows to which the anomaly corresponds. AR server  may, for example, generate the request that includes information associated with the flow, such as a destination and\/or source IP address associated with the flow, a destination and\/or source port associated with the flow, a URL and\/or MIME type associated with the flow, information associated with user device  (e.g., a MDN, a type of user device, etc.) to which the flow corresponds, and\/or a quantity of packets to be obtained. In an example implementation, AR server  may store the information associated with the flow in an AR packet to be sent to CO steering device  as all or a part of a request for the packets associated with the flow.","CO steering device  may receive the request and may replicate packets associated with the flow based on the information associated with the flow obtained from the request. CO steering device  may forward the packets to an intended destination based on the destination IP address. CO steering device  may send the replicated packets to AR server  in response to the request.","As also shown in , process  may include performing a packet analysis operation on the packets (block ). For example, AR server  may perform a packet analysis operation on the replicated packets received from CO steering device  and\/or packets associated with other flows for which an anomaly has been detected. AR server  may analyze the packets to classify the anomaly. In one example, AR server  may use SPI techniques to analyze the replicated packets, In another example, AR server  may use DPI techniques and\/or SPI techniques to analyze the replicated packets.","AR server  may identify protocol errors within network layer three packet headers (e.g., IPv4 headers, IPv6 headers, etc.) and\/or layer four packet headers (e.g., TCP headers, UDP headers, etc.) and may assign a class to the anomaly. In another example, AR server  may identify malicious software and\/or data (e.g., a virus, a worm, etc.) associated with the packets and may assign another class to the anomaly. In yet another example, AR server  may identify a potential electronic attack originating from user device  and\/or from a particular IP address, URL, port etc. (e.g., based on a quantity of bandwidth associated with the flow, evidence of port sweeping, etc.) and may assign yet another classification to the anomaly. In a further example, AR server  may identify signaling errors and\/or packet errors (e.g., based on unexpected messages contained within the packets, missing packets, mis-ordered packets, etc.) and may assign a further classification to the anomaly.","AR server  may compare information associated with another flow, with which an anomaly is associated, with information associated with the flow obtained from the replicated packets and\/or metrics information. For example, AR server  may identify whether there is another anomaly occurring within service provider network . AR server  may compare the classification of the other anomaly with the classification of the anomaly. AR server  may determine a quantity of anomalies and\/or flows associated with other anomalies within service provider network  over a period of time. AR server  may determine a location of user devices  and\/or network devices, within a geographic area and\/or network topology, that are affected by the anomaly and\/or the other anomaly. AR server  may compare the timing information (e.g., a time when the anomaly was detected, a time when the anomaly ended (if any), etc.) associated with the anomaly with timing information associated with the other anomaly within services provider network .","As further shown in , process  may include sending a notification associated with the anomaly based on the traffic metrics, the context information, and information obtained as a result of the packet analysis (block ). For example, AR server  may generate a notification associated with the anomaly. The notification may include the traffic metrics for one or more of the network layers, that were obtained by AR server  as a result of monitoring the traffic being transported to and\/or received from service provider network . The notification may include context information, associated with user device , that was affected by the anomaly. The notification may include information obtained as a result of the packet analysis (e.g., the replicated packets and packets associated with the other anomaly). The notification may include geographical information and\/or network topographical information associated with user devices  and\/or network devices that are affected by the anomaly and\/or the other anomaly. The notification may include a time when the anomaly was detected and another time when the anomaly was no longer detected (e.g., if the anomaly is no longer ongoing). The notification may include the classification assigned to the anomaly and\/or a unique identifier associated with the anomaly. AR server  may send the notification to a network management server that enables the network management server and\/or an operator associated with the network management server to remedy the anomaly and\/or make changes to service provider network  to mitigate the anomaly and\/or the other anomaly.","Systems and\/or methods, described herein, may enable traffic, associated with a service provider network, to be monitored in order to identify an anomaly, associated with the traffic. The systems and\/or methods may monitor the traffic, at one or more network layers (e.g., layers one through seven of the OSI model) of the service provider network. The systems and\/or methods may obtain traffic metrics, associated with the one or more network layers, as a result of the traffic monitoring. The systems and\/or methods may identify an anomaly, associated with the traffic, based on the traffic metrics. The systems and\/or methods may obtain context information associated with a user device that is affected by the anomaly. The systems and\/or methods may obtain a copy of the packets associated with the flow to which the anomaly corresponds. The AR server may perform analysis on packets and\/or other packets associated with another anomaly. The AR server may send a notification indicating that the anomaly has been detected. The notification may include the traffic metrics, the context information associated with the affected user device, information obtained as a result of the packet analysis and\/or the copy of the packets.","The foregoing description provides illustration and description, but is not intended to be exhaustive or to limit the implementations to the precise form disclosed. Modifications and variations are possible in light of the above teachings or may be acquired from practice of the embodiments.","While a series of blocks has been described with regard to , the order of the blocks may be modified in other implementations. Further, non-dependent blocks may be performed in parallel.","It will be apparent that systems and\/or methods, as described above, may be implemented in many different forms of software, firmware, and hardware in the implementations illustrated in the figures. The actual software code or specialized control hardware used to implement these systems and methods is not limiting of the embodiments. Thus, the operation and behavior of the systems and methods were described without reference to the specific software code\u2014it being understood that software and control hardware can be designed to implement the systems and methods based on the description herein.","Further, certain portions, described above, may be implemented as a component that performs one or more functions. A component, as used herein, may include hardware, such as a processor, an application-specific integrated circuit (ASIC), or a field-programmable gate array (FPGA), or a combination of hardware and software (e.g., a processor executing software).","It should be emphasized that the terms \u201ccomprises\u201d\/\u201ccomprising\u201d when used in this specification are taken to specify the presence of stated features, integers, steps or components but does not preclude the presence or addition of one or more other features, integers, steps, components or groups thereof.","Even though particular combinations of features are recited in the claims and\/or disclosed in the specification, these combinations are not intended to limit the disclosure of the embodiments. In fact, many of these features may be combined in ways not specifically recited in the claims and\/or disclosed in the specification. Although each dependent claim listed below may directly depend on only one other claim, the disclosure of the embodiments includes each dependent claim in combination with every other claim in the claim set.","No element, act, or instruction used in the present application should be construed as critical or essential to the embodiments unless explicitly described as such. Also, as used herein, the article \u201ca\u201d is intended to include one or more items. Where only one item is intended, the term \u201cone\u201d or similar language is used. Further, the phrase \u201cbased on\u201d is intended to mean \u201cbased, at least in part, on\u201d unless explicitly stated otherwise.","The term \u201cpacket\u201d as used herein, may refer to a datagram, a data item, or a cell; a fragment of a packet, a fragment of a datagram, a fragment of a data item, a fragment of a cell; or another type, arrangement, or packaging of data."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0004","num":"0003"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0005","num":"0004"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0006","num":"0005"},"figref":["FIG. 3","FIGS. 1 and 2"]},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
