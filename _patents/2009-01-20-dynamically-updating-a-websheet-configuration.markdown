---
title: Dynamically updating a websheet configuration
abstract: A system and computer program product for updating a configuration of a websheet. A client receives a web page including the websheet from a server. The websheet includes data values stored in a relational database table. The table includes a first set of data values displayed in cells of the websheet in response to the client receiving the web page. The table also includes a second set of data values associated with the websheet configuration. Second set data values are not displayed in the websheet in response to the client receiving the web page. A form displaying the second set is received by the client. Second set data values are updated on the form to provide an updated websheet configuration. With its updated configuration, the websheet is displayed at the client and allows data entry to modify or add first set data values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07882108&OS=07882108&RS=07882108
owner: International Business Machines Corporation
number: 07882108
owner_city: Armonk
owner_country: US
publication_date: 20090120
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a continuation application claiming priority to Ser. No. 11\/235,774, filed Sep. 27, 2005.","The present invention relates to a method and system for dynamically updating a websheet, and more particularly to a technique for dynamically updating a configuration of the websheet by a remote end user.","Conventional websheet applications provide end users with limited spreadsheet capabilities, but lack easy-to-use tools for dynamically modifying the layout, calculation formulas and database storage aspects of the websheet. Thus, there is a need for an improved technique for dynamic modification of websheets by end users.","In first embodiments, the present invention provides a method of updating a configuration of a websheet in a network computing environment, the method comprising:","receiving, at a client computing unit via a browser running on the client computing unit, a web page having the websheet from a server computing unit, the websheet comprising a plurality of cells, each cell being associated with multiple data values of a plurality of data values, wherein the plurality of data values is stored in a table of a relational database and comprises:\n\n","receiving, at the client computing unit via the browser, a data value input form from the server computing unit, the data value input form displaying the second set via a first query of the database;","updating one or more data values of the second set, the updating comprising:\n\n","displaying the websheet at the client computing unit via the browser, wherein the websheet has the updated configuration and displays the first set, wherein an entry on the websheet having the updated configuration is capable of modifying a data value of the first set or adding a new data value to the first set.","In second embodiments, the present invention provides a system for updating a configuration of a websheet in a network computing environment, the system comprising:","means for receiving, at a client computing unit via a browser running on the client computing unit, a web page having the websheet from a server computing unit, the websheet comprising a plurality of cells, each cell being associated with multiple data values of a plurality of data values, wherein the plurality of data values is stored in a table of a relational database and comprises:\n\n","means for receiving, at the client computing unit via the browser, a data value input form from the server computing unit, the data value input form displaying the second set via a first query of the database;","means for updating one or more data values of the second set, the means for updating comprising:\n\n","means for displaying the websheet at the client computing unit via the browser, wherein the websheet has the updated configuration and displays the first set, wherein an entry on the websheet having the updated configuration is capable of modifying a data value of the first set or adding a new data value to the first set.","In third embodiments, the present invention provides a computer program product comprising a computer-usable medium including computer-usable program code for updating a configuration of a websheet, the computer program product including:","computer-usable code for receiving, at a client computing unit via a browser running on the client computing unit, a web page having the websheet from a server computing unit, the websheet comprising a plurality of cells, each cell being associated with multiple data values of a plurality of data values, wherein the plurality of data values is stored in a table of a relational database and comprises:\n\n","computer-usable code for receiving, at the client computing unit via the browser, a data value input form from the server computing unit, the data value input form displaying the second set via a first query of the database;","computer-usable code for updating one or more data values of the second set, the updating comprising:\n\n","computer-usable code for displaying the websheet at the client computing unit via the browser, wherein the websheet has the updated configuration and displays the first set, wherein an entry on the websheet having the updated configuration is capable of modifying a data value of the first set or adding a new data value to the first set.","In fourth embodiments, the present invention provides a method for deploying computing infrastructure, comprising integrating computer-readable code into a computing system, wherein the code in combination with the computing system is capable of performing a process of updating a configuration of a websheet in a network computing environment, the process comprising:","receiving, at a client computing unit via a browser running on the client computing unit, a web page having the websheet from a server computing unit, the websheet comprising a plurality of cells, each cell being associated with multiple data values of a plurality of data values, wherein the plurality of data values is stored in a table of a relational database and comprises:\n\n","receiving, at the client computing unit via the browser, a data value input form from the server computing unit, the data value input form displaying the second set via a first query of the database;","updating one or more data values of the second set, the updating comprising:\n\n","displaying the websheet at the client computing unit via the browser, wherein the websheet has the updated configuration and displays the first set, wherein an entry on the websheet having the updated configuration is capable of modifying a data value of the first set or adding a new data value to the first set.","Advantageously, the present invention provides an end user with a single, easy-to-use tool allowing dynamic modification of layout, calculation formulas and data values in cells of a websheet. Websheet layout modification is completed on a form presented using an intuitive spreadsheet model on a web browser. An existing body of calculation and display techniques is re-used by specifying novel behind-the-scenes data values, thereby avoiding the need for customized coding of spreadsheet applications or other programming skills. Instead of customizing a websheet layout with calculations, the end user selects data values on a form.","The present invention provides a technique for remotely and dynamically updating the configuration of a websheet by utilizing code that interprets data values of a relational database table. The data values are associated with the layout of a websheet, and with the appearance, calculations, and displayed contents of cells of a websheet. As used herein, a websheet is defined as a spreadsheet-like collection of cells organized in rows and columns, which automatically displays real-time data from a remote database via a network (e.g., the Internet), rather than data from a user's local file. The updating of the websheet configuration provided by the present invention includes updating the number of rows and\/or columns of the websheet, the headers of the rows and\/or columns, the type of data that is permitted in a cell, the formulas used to calculate values displayed in cells, an attribute identifying whether a data value is modifiable, and any other attribute related to the appearance or visual layout of a single cell of the websheet or of the websheet as a whole.",{"@attributes":{"id":"p-0037","num":"0056"},"figref":["FIG. 1","FIG. 1"],"b":["100","100","102","104","106","102","102","102","106","104","102","102","104","106"]},"Client computing unit  includes a web browser (e.g., Microsoft\u00ae Internet Explorer\u00ae)  by which a user of client computing unit  may access a websheet or a data value input form. For example, the user may utilize browser  to select a link to display the websheet or the data value input form at client . Client  also includes one or more functions (e.g., JavaScript\u00ae functions) supporting calculations in websheets and data value input forms. Although not shown, client computing system  typically includes components (e.g., central processing unit, memory, etc.) similar to components of server computing unit , which are described below.","Server computing unit  generally comprises a central processing unit (CPU) , a memory , an input\/output (I\/O) interface , a bus , I\/O devices  and a database . CPU  performs computation and control functions of server . CPU  may comprise a single processing unit, or be distributed across one or more processing units in one or more locations (e.g., on a client and server). Memory  may comprise any known type of data storage and\/or transmission media, including magnetic media, optical media, random access memory (RAM), read-only memory (ROM), a data cache, a data object, etc. Database  is stored on any type of storage unit, such as a magnetic disk drive or an optical disk drive. Database  is a relational database storing data values that determine the configuration of a websheet. Moreover, similar to CPU , memory  and\/or database  may reside at a single physical location, comprising one or more types of data storage, or be distributed across a plurality of physical systems in various forms. Further, memory  and\/or database  can include data distributed across, for example, a LAN, WAN or storage area network (SAN) (not shown).","I\/O interface  comprises any system for exchanging information to or from an external source. I\/O devices  comprise any known type of external device, including a display monitor, keyboard, mouse, printer, speakers, handheld device, printer, facsimile, etc. Bus  provides a communication link between each of the components in server , and may comprise any type of transmission link, including electrical, optical, wireless, etc.","I\/O interface  also allows server  to store and retrieve information (e.g., program instructions or data) from an auxiliary storage device, such as a non-volatile storage device (e.g., a CD-ROM drive which receives a CD-ROM disk) (not shown). Server  can store and retrieve information from other auxiliary storage devices (not shown), which can include a direct access storage device (DASD) (e.g., hard disk or floppy diskette), a magneto-optical disk drive, a tape drive, or a wireless communication device.","Server  comprises any type of computing unit capable of communicating with one or more other computing units (e.g., client ). Server  is, for example, a WebSphere\u00ae server available from International Business Machines Corporation of Armonk, N.Y.","Similarly, client  comprises any type of computing unit capable of communicating with server  and connecting with database  via network . Examples of client computing unit  include a personal computer, laptop computer, handheld device, mobile phone, etc.","Memory  includes computer program code comprising a websheet configuration update system that includes a servlet  that runs, for example, on the Java\u00ae 2 Platform (e.g., Java\u00ae 2 Platform, Enterprise Edition or J2EE\u00ae) and a template engine such as a Velocity engine . Velocity is an open source Java\u00ae-based template engine that converts templates to HyperText Markup Language (HTML), text, extensible markup language (XML), SQL, PostScript\u00ae, etc., and is available from the Apache Software Foundation of Forest Hill, Md. Java\u00ae servlet  extracts data values from tables in database  and assembles data structures (not shown). Velocity engine  provides macros that use the assembled data structures to render a display of a websheet or a data value input form at client computing unit  (see ) via web browser  (see ). Further, memory  may include other systems not shown in , such as an operating system (e.g., Linux) that runs on CPU  and provides control of various components within and\/or connected to server .",{"@attributes":{"id":"p-0045","num":"0064"},"figref":["FIG. 2A","FIG. 1","FIG. 1","FIG. 1","FIG. 1","FIG. 1","FIG. 1","FIG. 1","FIG. 1","FIGS. 2B-2D"],"b":["200","202","108","204","124","106","122","202","124","206","124","204","122"]},{"@attributes":{"id":"p-0046","num":"0065"},"figref":["FIG. 2B","FIG. 2A","FIG. 1","FIG. 1","FIG. 2A","FIG. 1"],"b":["230","230","230","122","122","122"]},"A cell data value is a number, a string, or an expression to be used to calculate a value to be displayed. Cell data values are displayed on the websheet at client computing unit  (see ) in response to the client computing unit receiving a web page that includes the websheet.","Configuration-related data values are data tags that determine the websheet's display appearance or layout (e.g., number of rows or number of columns in the websheet), the data type that is permitted to be displayed within a cell (e.g., integer, string, etc.), the display type associated with data displayed within a cell (e.g., choices from a drop-down list), an expression to be calculated to determine a cell data value, an indicator indicating whether a cell data value is modifiable, the highlighting of a cell, and any other appearance-related aspect of a cell. At least one of the configuration-related data values is associated with each cell of the websheet. Configuration-related data values are not displayed on the websheet at client computing unit  (see ) in response to the client computing unit receiving a web page that includes the websheet whose configuration is to be updated by the process of .","The column names of table  indicate the following data values related to a cell of a websheet:\n\n",{"@attributes":{"id":"p-0050","num":"0078"},"figref":["FIG. 2C","FIG. 2B","FIG. 2B"],"b":["260","260","260"],"ul":{"@attributes":{"id":"ul0019","list-style":"none"},"li":{"@attributes":{"id":"ul0019-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0020","list-style":"none"},"li":["SHEETID: an integer identifier of a sheet that includes the cell. SHEETID is a key of relational database  (see ) that indicates a particular sheet of one or more sheets within a page.","SHEETLABEL: a string used to identify the sheet. For example, a formula used for a calculation of a data value of the websheet can utilize SHEETLABEL to indicate which sheet includes a value that is included in the formula.","PAGEID: an integer identifier of a page that includes the sheet.","NUMROWS: the total number of rows of the sheet identified by SHEETID.","NUMCOLUMNS: the total number of columns of the sheet identified by SHEETID."]}}}},{"@attributes":{"id":"p-0051","num":"0084"},"figref":["FIG. 2D","FIG. 2C"],"b":["270","270","270"],"ul":{"@attributes":{"id":"ul0021","list-style":"none"},"li":{"@attributes":{"id":"ul0021-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0022","list-style":"none"},"li":["PAGEID: an integer identifier of a page. PAGEID is used a key in relational database  (see ).","PAGELABEL: a string used to identify the page."]}}}},"In one embodiment, a single, general-purpose relational database table is used to store all the data values defined by .","Returning to , following the creation of column-name, column-value hashtables in step , Java\u00ae servlet  (see ) invokes, in step , a servlet provided by Velocity engine . The Velocity servlet utilizes Velocity macros to convert templates to HTML, based in part on values retrieved from the hashtables of step . In step , the Velocity servlet transmits the page templates of HTML and JavaScript\u00ae code to the user's web browser  (see ). In step , web browser  (see ) converts the HTML code to the visual presentation of the websheet, and retains the JavaScript\u00ae code to use for dynamic updating of calculated data values as the user accesses and interacts with the websheet via web browser  (see ). Step  also displays the websheet to the user at client computing unit  (see ). An example of a websheet displayed to the user in step  is shown in screen  of .","In step , the user enters one or more data values in the websheet. Each data value entered is input into one cell of the websheet. When the user is done entering data in the websheet, the user indicates the completion of data entry by, for example, clicking a Save All Changes button (see ) with a pointing device. In step , data values displayed in the websheet are transmitted to Java\u00ae servlet  (see ), cell by cell, using a Common Gateway Interface (CGI) parameter mechanism. CGI specifies a standard for passing data between a client and a web server. Data values associated with certain columns of the relational database table (e.g., columns in  with \u201cVALUE\u201d extensions, such as INT_VALUE, STR_VALUE, etc.) are the only values affected by step . In step , Java\u00ae servlet  (see ) interprets incoming cell data values to produce update queries for database  (see ). The update queries are, for instance, SQL queries that utilize a JDBC\u00ae interface. In step , Java\u00ae servlet  (see ) executes the update queries produced in step , sends an acknowledgement of completion (or an error message) to the user's web browser  (see ), and refreshes the cell data values in the websheet as displayed to the user at client computing unit .","As a user utilizes the process of  to access a websheet for data entry, the present invention provides the user with the capability to dynamically update the configuration of the websheet being accessed.  is a flow chart of a process for updating a configuration of the websheet (e.g., screen  of ) displayed by the process of , in accordance with embodiments of the present invention. The websheet configuration update process begins at step . In step , the user selects a link (not shown on ) on the websheet to perform an administrative action, such as updating the configuration of the websheet. The user selection is performed at client computing unit  (see ) after the client receives a web page, which includes the websheet, from server computing unit  (see ). The user selection is transmitted from the client to Java\u00ae servlet  (see ).","In step , Java\u00ae servlet  (see ) queries database  (see ) for retrieval of configuration-related data values associated with a layout of a group of cells of the websheet and\/or configuration-related data values associated with a particular cell of the websheet. For example, an SQL query retrieves a data value (e.g., NUMROWS of ) providing the total number of rows of a sheet. As another example, an SQL query retrieves a data value (e.g., DISPLAYTYPE of ) associated with the display type of a cell of the websheet. The configuration-related data values of  retrieved by the query of step  are the values that are capable of being updated in the process of . It will be apparent to those skilled in the art that the tables of  may be extended to include other configuration-data values not shown, such as data values defining the widths of each of the columns of the websheet, or the highlighting utilized in a cell of the websheet.","In step , macros provided by Velocity engine  (see ) construct HTML code to display the configuration-related data values to the user at client computing unit  (see ). The configuration-related data values are displayed in a data value input form, which has entry fields for the configuration-related data values. In one embodiment, some aspects of the configuration of the websheet (e.g., column widths) are determined by code provided by Velocity engine  (see ), rather than by data values of the relational database tables defined by .","The data value input form is received at client computing unit  (see ) for display to a user via web browser  (see ). The data value input form can also include entry fields for cell data values.  depicts a screen  including a data value input form displaying updateable configuration-related data values (e.g., Display Type and Data Type) and cell data values (e.g., Full Row of Values) of the websheet of , in accordance with embodiments of the present invention. In one embodiment, the data value input form includes data entry fields that update the number of rows and the number of columns of the websheet.","Returning to , inquiry step  determines if the user selects another cell to display different data on the data value input form. If the user selects another cell, the process repeats starting at step . If the user does not select another cell, the process continues with step . In step , the user modifies the configuration-related data values on the data value input form of step . For example, screen  of  illustrates a data value input form that includes data in an entry field for updating the configuration (e.g., the number of rows) of the websheet of . The configuration of the 6-row websheet of  is updated by entering 7 in the entry field labeled \u201cRow\u201d in the data entry form of . Cell data values are added to the newly added row 7 in entry fields (e.g., under \u201cFull Row of Values\u201d). For instance, screen  illustrates the added cell data values of \u201cTest\u201d at row 7, column 1 and 7777 at row 7, column 2. The updated configuration-related data values are transmitted to Java\u00ae servlet  (see ) in step  via a CGI parameter mechanism.","In an alternate embodiment, configuration-related data values associated with a sheet (e.g., number of rows and number of columns) rather than with only a single cell are presented to the user on a form separate from the form shown in  in response to a user's selection on websheet  (see ) and\/or data entry form  (see ).","In step , Java\u00ae servlet  (see ) interprets incoming configuration-related data values to produce an update query for the selected cell. In step , Java\u00ae servlet  (see ) executes the update query produced in step , and sends an acknowledgment of completion of the execution (or an error message) to the user's web browser  (see ). In response to completing the execution of the update query produced in step , the data values modified in step  are updated in database  (see ).","In step , the user exits the data value input form and selects a link to the websheet that corresponds to the exited data value input form. Step  displays the websheet at client computing unit  (see ) via web browser  (see ), with the displayed websheet's configuration updated as determined by the updated configuration-related data values of step . The websheet of step  displays cell data values included in the cells of the websheet. A data entry in a cell of the websheet follows the process of  and is capable of adding a new cell data value or updating an existing cell data value. For example, screen  of  depicts the websheet of  after its configuration is changed by the input in  of the configuration-related data value that adds a seventh row to the websheet. The process of updating a websheet configuration ends at step .","In one embodiment, access to the process of  is limited to a privileged user who has been authorized to update the configuration of the websheet.","In another embodiment, the process of  includes dynamically updating an expression (i.e., a formula) to be calculated for display in a cell of the websheet. The expression to be calculated is included in the data value input form (e.g., adjacent to \u201cFormula\u201d). After updating the formula in step , an associated data value in relational database  (see ) is updated (e.g., a value of the SCRIPT_VALUE column of ). One or more functions provided by a scripting programming language (e.g., JavaScript\u00ae functions) are executed to interpret the updated formula, perform the calculation indicated by the formula, and provide a result. In response to the calculation, the result is assigned to the associated cell data value.","Code Examples","The following HTML and Velocity code implements logic for rendering a websheet in, for instance, step  of  or step  of . The code and its internal comments use \u201cspreadsheet\u201d as a synonym for a websheet, as described herein. The code below utilizes a \u201cforeach\u201d primitive to count the number of rows and columns, rather than having the row and column totals stored in database  (see ). A preferred embodiment uses a different approach, however, and stores the number of rows and the number of columns in database  (see ), which allows the user of client computing unit  (see ) to update the number of rows and\/or the number of columns on the data value input form shown in .",{"@attributes":{"id":"p-0066","num":"0101"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"<!-- start of spreadsheet definition -->"},{"entry":"<table class=\u201css_table\u201d summary=\u201cCIO Dashboard\u201d cellspacing=\u201c2\u201d>"},{"entry":"<tbody>"},{"entry":"##"},{"entry":"#foreach($row in $spreadsheet)"},{"entry":"#set($rowCount = $velocityCount)"},{"entry":"#set($rowID = $row.key)"},{"entry":"<!-- spreadsheet row ${rowCount} -->"},{"entry":"<tr class=\u201css_row\u201d>"},{"entry":"##"},{"entry":"#foreach ($cell in $row.value)"},{"entry":"#set ($colCount = $velocityCount)"},{"entry":"#set ($colCount0 = $velocityCount \u2212 1)"},{"entry":"#set ($key = $cell.key)"},{"entry":"#set ($val = $cell.value)"},{"entry":"##"},{"entry":"## note: $val ($cell.value) is a hashtable keyed on column names"},{"entry":"from query: cell_data, modifiable, displaytype"},{"entry":"##"},{"entry":"## Data type: i(nteger), s(tring), d(ate), f(loat), c(urrency)\u2019, j(ava script"},{"entry":"formula);"},{"entry":"## Display type: P=Percent, U=cUrrency, H=Header, G=general,"},{"entry":"C=content only, Y=yes\/no radio, T=true\/false, S=sat\/unsat,"},{"entry":"Z=Fall 2003, X=X or blank, R=Red\/Green\/Yellow"},{"entry":"##"},{"entry":"#if ($val.displaytype == \u2018H\u2019)"},{"entry":"## display type is Header"},{"entry":"#if ($rowCount == 1)"},{"entry":"<th id=\u201chdr-col-${colCount}\u201d class=\u201ccol_header\u201d"},{"entry":"style=\u201cwidth:$columnWidth.get($colCount0)px\u201d>$val.cell_data<\/th>"},{"entry":"#else"},{"entry":"<td id=\u201chdr-row-${rowID}\u201d class=\u201crow_header\u201d >$val.cell_data<\/td>"},{"entry":"#end"},{"entry":"##"},{"entry":"## if display type is General or cUrrency or Percent"},{"entry":"#elseif ($val.displaytype == \u2018G\u2019 || $val.displaytype == \u2018U\u2019 ||"},{"entry":"$val.displaytype == \u2018P\u2019)"},{"entry":"<td headers=\u201chdr-col-${colCount}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d>"},{"entry":"#if ($val.modifiable == \u2018Y\u2019 && $val.lockmode == \u20180\u2019)"},{"entry":"<label for=\u201c${val.label}\u201d\/>"},{"entry":"<input name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d onKeyPress=\u201creturn autoTab(this,"},{"entry":"event);\u201d onChange=\u201cif(!${sheetName}Validator.check(this)) return"},{"entry":"false;${sheetName}.evalCell(this);\u201d class=\u201css_input\u201d type=\u201ctext\u201d"},{"entry":"maxLength=\u201c$maxLength.get($colCount0)\u201d value=\u201c\u201d \/>"},{"entry":"#elseif ($val.modifiable == \u2018Y\u2019 && $val.lockmode == \u20181\u2019)"},{"entry":"<input name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d readonly=\u201ctrue\u201d onKeyPress=\u201creturn"},{"entry":"autoTab(this, event);\u201d class=\u201css_input_lok\u201d type=\u201ctext\u201d value=\u201c\u201d \/>"},{"entry":"#else"},{"entry":"<input name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d readonly=\u201ctrue\u201d onKeyPress=\u201creturn"},{"entry":"autoTab(this, event);\u201d class=\u201css_input_ro\u201d type=\u201ctext\u201d value=\u201c\u201d \/>"},{"entry":"#end"},{"entry":"<\/td>"},{"entry":"##"},{"entry":"## if display type is X or Blank"},{"entry":"#elseif ($val.displaytype == \u2018X\u2019)"},{"entry":"#if ($val.modifiable == \u2018Y\u2019)"},{"entry":"<td headers=\u201chdr-col-${colCount}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d>"},{"entry":"<label for=\u201c${val.label}\u201d\/>"},{"entry":"<input name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201ctext-align:"},{"entry":"center;width:"},{"entry":"$columnWidth.get($colCount0)px\u201d onKeyPress=\u201creturn autoTab(this,"},{"entry":"event);\u201d onChange=\u201c${sheetName}.evalCell(this);return"},{"entry":"${sheetName}Validator.check(this);\u201d class=\u201css_input\u201d type=\u201ctext\u201d"},{"entry":"maxLength=\u201c$maxLength.get($colCount0)\u201d value=\u201c\u201d \/>"},{"entry":"<\/td>"},{"entry":"#else"},{"entry":"<td headers=\u201chdr-col-$velocityCount\u201d>"},{"entry":"<input name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201ctext-align:"},{"entry":"center;width:"},{"entry":"$columnWidth.get($colCount0)px\u201d readonly=\u201ctrue\u201d onKeyPress=\u201creturn"},{"entry":"autoTab(this, event);\u201d class=\u201css_input_ro\u201d type=\u201ctext\u201d value=\u201c\u201d \/>"},{"entry":"<\/td>"},{"entry":"#end"},{"entry":"##"},{"entry":"## if display type is Content ( text )"},{"entry":"#elseif ($val.displaytype == \u2018C\u2019)"},{"entry":"##<td style=\u201ctext-align: center; width:"},{"entry":"$columnWidth.get($colCount0)px\u201d>$val.cell_data<\/td>"},{"entry":"<td style=\u201ctext-align: center; width:"},{"entry":"$columnWidth.get($colCount0)px\u201d>$val.cell_data<\/td>"},{"entry":"##"},{"entry":"## if display type is sat\/unsat"},{"entry":"#elseif ($val.displaytype == \u2018S\u2019)"},{"entry":"<td>"},{"entry":"<select name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d>"},{"entry":"<option value=\u201c\u201d #if(${val.cell_data}==\u201c\u201d)selected=\u201ctrue\u201d#end>[Select"},{"entry":"rating]<\/option>"},{"entry":"<option value=\u201cSat\u201d"},{"entry":"#if(${val.cell_data}==\u201cSat\u201d)selected=\u201ctrue\u201d#end>Sat<\/option>"},{"entry":"<option value=\u201cMar\u201d"},{"entry":"#if(${val.cell_data}==\u201cMar\u201d)selected=\u201ctrue\u201d#end>Mar<\/option>"},{"entry":"<option value=\u201cUnsat\u201d"},{"entry":"#if(${val.cell_data}==\u201cUnsat\u201d)selected=\u201ctrue\u201d#end>Unsat<\/Option>"},{"entry":"<option value=\u201cVarious\u201d"},{"entry":"#if(${val.cell_data}==\u201cVarious\u201d)selected=\u201ctrue\u201d#end>Various<\/option>"},{"entry":"<option value=\u201cTBD\u201d"},{"entry":"#if(${val.cell_data}==\u201cTBD\u201d)selected=\u201ctrue\u201d#end>TBD<\/option>"},{"entry":"<\/select>"},{"entry":"<\/td>"},{"entry":"##"},{"entry":"##"},{"entry":"## if displaytype is Red\/Green\/Yellow ( status )"},{"entry":"#elseif ($val.displaytype == \u2018R\u2019)"},{"entry":"<td>"},{"entry":"<select name=\u201c${val.label}\u201d id=\u201c${val.label}\u201d style=\u201cwidth:"},{"entry":"$columnWidth.get($colCount0)px\u201d>"},{"entry":"<option value=\u201c\u201d"},{"entry":"#if(${val.cell_data}==\u201c\u201d)selected=\u201ctrue\u201d#end>---<\/option>"},{"entry":"<option value=\u201cRed\u201d"},{"entry":"#if(${val.cell_data}==\u201cRed\u201d)selected=\u201ctrue\u201d#end>Red<\/option>"},{"entry":"<option value=\u201cGreen\u201d"},{"entry":"#if(${val.cell_data}==\u201cGreen\u201d)selected=\u201ctrue\u201d#end>Grn<\/option>"},{"entry":"<option value=\u201cYellow\u201d"},{"entry":"#if(${val.cell_data}==\u201cYellow\u201d)selected=\u201ctrue\u201d#end>Yel<\/option>"},{"entry":"<option value=\u201cInactive\u201d"},{"entry":"#if(${val.cell_data}==\u201cInactive\u201d)selected=\u201ctrue\u201d#end>N\/A<\/option>"},{"entry":"<\/select>"},{"entry":"<\/td>"},{"entry":"#else"},{"entry":"<td style=\u201cwidth: $columnWidth.get($colCount0)px\u201d>$val.cell_data<\/td>"},{"entry":"#end"},{"entry":"#end"},{"entry":"## end foreach cell in row"},{"entry":"<\/tr>"},{"entry":"#end"},{"entry":"## end foreach row in sheet"},{"entry":"<\/tbody>"},{"entry":"<\/table>"},{"entry":"##"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"The following JavaScript\u00ae code implements a portion of the logic for performing calculations in a websheet. The calculations can facilitate the dynamic updating of data values in, for example, step  of .",{"@attributes":{"id":"p-0068","num":"0103"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"this.evalCell = function(html_ss_cell)"},{"entry":"{"},{"entry":"\/\/ check if a formula was entered into the table cell"},{"entry":"if (html_ss_cell.value.length > 0 &&"},{"entry":"html_ss_cell.value.charAt(0) == \u2018=\u2019)"},{"entry":"{"},{"entry":"this.setCellForumla(html_ss_cell.id, html_ss_cell.value.substring(1));"},{"entry":"\/\/ clear out the cell value and html table field"},{"entry":"this.setCellValue(html_ss_cell.id, \u2018\u2019);"},{"entry":"}"},{"entry":"else"},{"entry":"{"},{"entry":"this.setCellValue(html_ss_cell.id, html_ss_cell.value);"},{"entry":"}"},{"entry":"this.recalc( );"},{"entry":"if (this.linkedSheet != null) this.linkedSheet.recalc( );"},{"entry":"}"},{"entry":"this.recalc = function( )"},{"entry":"{"},{"entry":"\/\/ resolve formula cell references"},{"entry":"\/\/ and substitute with the referenced cell.value"},{"entry":"var cell = null;"},{"entry":"for (ref in this.cellMap)"},{"entry":"{"},{"entry":"cell = this.cellMap[ref];"},{"entry":"if (cell.formula != null)"},{"entry":"{"},{"entry":"try"},{"entry":"{"},{"entry":"this.resolveCellRefs(cell.id);"},{"entry":"}"},{"entry":"catch (exception)"},{"entry":"{"},{"entry":"alert(\u201cError in formula: \u201d + id + \u201c\\n\u201d + cell.formula);"},{"entry":"}"},{"entry":"}"},{"entry":"}"},{"entry":"\/\/ Evaluate cell values as formulas"},{"entry":"\/\/ cell.value contains the formulas with"},{"entry":"\/\/ cell labels (references) substituted with the referenced cell.value"},{"entry":"var evalResult = \u201c\u201d;"},{"entry":"for (ref in this.cellMap)"},{"entry":"{"},{"entry":"cell = this.cellMap[ref];"},{"entry":"\/\/ eval only formulas that are marked as valid"},{"entry":"if (cell.formula != null)"},{"entry":"{"},{"entry":"if (cell.status == true)"},{"entry":"{"},{"entry":"try"},{"entry":"{"},{"entry":"evalResult = eval(cell.value);"},{"entry":"}"},{"entry":"catch (ex)"},{"entry":"{"},{"entry":"evalResult=\u201c\u201d;"},{"entry":"}"},{"entry":"this.setCellValue(cell.id, evalResult);"},{"entry":"}"},{"entry":"else"},{"entry":"{"},{"entry":"this.setCellValue(cell.id, \u201c\u201d);"},{"entry":"}"},{"entry":"}"},{"entry":"}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"The invention can take the form of an entirely hardware embodiment, an entirely software embodiment or an embodiment containing both hardware and software elements. In a preferred embodiment, the invention is implemented in software, which includes but is not limited to firmware, resident software, microcode, etc.","Furthermore, the invention can tale the form of a computer program product accessible from a computer-usable or computer-readable medium providing program code , , ,  (see ) for use by or in connection with a computer ,  (see ) or any instruction execution system to provide and facilitate the capabilities of the present invention. For the purposes of this description, a computer-usable or computer-readable medium can be any apparatus that can contain, store, communicate, propagate, or transport the program for use by or in connection with the instruction execution system, apparatus, or device.","The medium can be an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system (or apparatus or device) or a propagation medium. Examples of a computer-readable medium include a semiconductor or solid state memory, magnetic tape, a removable computer diskette, RAM  (see ), ROM, a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk-read-only memory (CD-ROM), compact disk-read\/write (CD-R\/W) and DVD.","A data processing system  (see ) suitable for storing and\/or executing program code , , ,  (see ) will include at least one processor  (see ) coupled directly or indirectly to memory elements  (see ) through a system bus  (see ). The memory elements can include local memory employed during actual execution of the program code, bulk storage, and cache memories which provide temporary storage of at least some program code in order to reduce the number of times code must be retrieved from bulk storage during execution.","Furthermore, the present invention discloses a method for deploying or integrating computing infrastructure, comprising integrating computer-readable code into computer system  (see ), wherein the code in combination with computer system  (see ) is capable of performing a process of updating a configuration of a websheet. The disclosed method for deploying or integrating computing infrastructure with the capabilities described herein can be offered as a service on a subscription service.","The flow diagrams depicted herein are provided by way of example. There may be variations to these diagrams or the steps (or operations) described herein without departing from the spirit of the invention. For instance, in certain cases, the steps may be performed in differing order, or steps may be added, deleted or modified. All of these variations are considered a part of the present invention as recited in the appended claims.","While embodiments of the present invention have been described herein for purposes of illustration, many modifications and changes will become apparent to those skilled in the art. Accordingly, the appended claims are intended to encompass all such modifications and changes as fall within the true spirit and scope of this invention."],"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0026","num":"0045"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0027","num":"0046"},"figref":["FIG. 2A","FIG. 1"]},{"@attributes":{"id":"p-0028","num":"0047"},"figref":["FIG. 2B","FIG. 2A"]},{"@attributes":{"id":"p-0029","num":"0048"},"figref":["FIG. 2C","FIG. 2B"]},{"@attributes":{"id":"p-0030","num":"0049"},"figref":["FIG. 2D","FIG. 2C"]},{"@attributes":{"id":"p-0031","num":"0050"},"figref":["FIG. 2E","FIG. 2A"]},{"@attributes":{"id":"p-0032","num":"0051"},"figref":["FIG. 3A","FIG. 2A"]},{"@attributes":{"id":"p-0033","num":"0052"},"figref":["FIG. 3B","FIG. 2E"]},{"@attributes":{"id":"p-0034","num":"0053"},"figref":["FIG. 3C","FIG. 2E"]},{"@attributes":{"id":"p-0035","num":"0054"},"figref":["FIG. 3D","FIG. 2E","FIG. 3C"]}]},"DETDESC":[{},{}]}
