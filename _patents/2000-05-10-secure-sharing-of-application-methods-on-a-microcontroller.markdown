---
title: Secure sharing of application methods on a microcontroller
abstract: A method and microcontroller for secure object sharing between applications executing on the microcontroller. A server application registers a delegate object with the operating system of the microcontroller. The delegate object permits access to the public interfaces of the server while enforcing security policies.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07127605&OS=07127605&RS=07127605
owner: Axalto, Inc.
number: 07127605
owner_city: Austin
owner_country: US
publication_date: 20000510
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims the benefit of U.S. provisional application No. 60\/133,300 filed on May 10, 1999.","This invention relates in general to the field of programming, and more particularly to a secure method of sharing application methods between two or more application programs executing on a secure microcontroller (e.g., smart card) programmed in a high level programming language.","Software applications written for smart cards using a high level programming language are typically prevented by the smart card security system from accessing the data and methods associated with other applications. However, it is desirable to permit certain applications to access particular methods of other applications. For example, a distributor of an electronic purse might have an agreement with a certain airline to grant frequent flier points based on the amount purchased. In that example, the purse application might want to check to see whether a frequent flier loyalty application is loaded onto the smart card, and if so, to access a method of the loyalty application in order to grant points.","There exist in the prior art solutions for sharing application methods with other applications. For example, the Java Card 2.1 specification uses shareable interface objects (because of its wide adoption, the Java Card 2.1 approach to method sharing is referred hereinafter as the \u201cConventional Approach\u201d). However, the prior art methods, for example, the Conventional Approach, suffer from several drawbacks.","First, when an application grants another application access to its methods, it grants access to all of the shareable methods of a class. Suppose a server applet (application which extends the applet class) has two interfaces on the same class, intended for different kinds of clients. If a client has been granted one interface, in the prior art the server has no way to prevent the other interface from being used as well, giving the client access to unintended methods.","This kind of security compromise is illustrated in Appendix A. Code 1 is an example of a server code, and Code 2 is a code example of a client obtaining and misusing a reference to that server. Once a client has been granted access to any interface, it is possible for that client to access all of the shareable interface methods of an object by explicitly re-casting an interface the client is supposed to be granted access to into an interface that the client is not supposed to have access to. So if a server applet has two interfaces, intended for different kinds of clients, a client who legitimately obtains one interface, could cast it into the other interface, and gain access to unintended methods.","Code segments Code 1 and Code 2 of Appendix A illustrate the above described security risk inherent to the Conventional Approach.","For example, consider an applet ABCLoyaltyApplet that has two different services that it intends to offer exclusively to two different clients, e.g., grantFrequentFlyerPoints for client Airline, and grantLoyaltyPoints for client Purse. Both of these services are accessible to respective clients via different published interfaces, but both are defined in the Applet class ABCLoyaltyApplet, as illustrated in Code 1 in Appendix A.","If the Purse client was aware of the Airline client interface, the Purse client could take the interface it had been granted by the server applet to grant loyalty points, and recast it as the Airline client interface. The Purse client could then use the grantFrequentFlyerPoints interface (intended for client Airline) to maliciously add unwarranted frequent flier points, as shown in Code 2 in Appendix A. Thus the security of the server has been compromised.","A second drawback is based on the method of client authentication. The decision by a server applet to grant access to an object must be based solely on the application identifier (AID) of the requesting applet; no other information is available to the server applet. The intended use is clearly to allow certain interfaces to be granted only to particular client applets, as denoted by their unique AIDs. However, it is possible to maliciously set the AID of a rogue applet to be the same as the AID of a client applet known to have access to a particular interface. The rogue applet is then loaded instead of the applet that legitimately owns the AID. Once loaded, the rogue applet can request the desired interface. The server applet, having only the AID for reference, will naturally grant this request, since the AID matches the required AID for the interface. The rogue applet can then freely use the interface for malicious purposes, again compromising the security of the server application.","A third drawback also results from the method of providing method sharing by client AID authentication. Granting access based on AID necessarily assumes that the server applet that wishes to share the object has knowledge of all AIDs of all client applets that could potentially be loaded which will share particular interfaces. Requiring the server application to have knowledge of all potential client AIDs precludes adding additional client applets after the server has been loaded. Such future applets are excluded from access to the object, since the server can only grant access based on the AID list that the server had when it was loaded. That deficiency necessitates rewriting and reissuing the server applet such that the new AIDs are included, which may pose an insurmountable hurdle when the server applet is already widely distributed.","These drawbacks form a formidable obstacle to the use of object sharing in smart cards. For object sharing to truly be practical, these obstacles must be overcome.","The method, microcontroller, and system of the present invention provide for secure object sharing between microcontroller applications while overcoming the aforementioned deficiencies.","The invention features a secure microcontroller (e.g., a contact or contactless smart card in any form factor) that is constructed to execute applications written in a high level programming language (e.g., a Java programming language) using an interpreter, the applications being able to share methods in a secure manner using delegates to enforce the security policy that each application wishes to impose with regard to each method shared.","Among the advantages of the invention are one or more of the following. Applications may be written to share methods with other applications using the degree of security required in each instance; applications have the freedom to implement whatever security policy is deemed necessary for each method, ranging from full unrestricted access to certain methods by any application, to the opposite extreme of strong cryptographic mutual validation to access other methods. Applications using this invention are able to share methods with future applications that may have not yet even been considered. Applications grant access to their methods on an individual basis to other applications; each method could be permitted to be accessed by applications based on different criteria, providing maximum granularity of access control. Applications need not be susceptible to fraudulent access based on application identifier impersonation. Such applications need not grant access to all public methods of a class.","Other advantages and features will become apparent from the following description and from the claims.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["50","50","100","102","106","100","102","108","100","102","108","100","110","102","106"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIGS. 2","FIG. 2","FIG. 2","FIG. 2","FIG. 2","FIG. 2"],"i":["a ","e ","a","b","c","d","e"],"b":["2","100","102","102","200","108","100","202","108","108","204","102","102","208","108","206","108","210","208","100","100","212","106","102","206","206","216","100","106"]},"Note that the Conventional Approach of object sharing suffers from several aforementioned drawbacks, including the possibility of the server security being compromised by various means, and the difficulty of including within the server applet a list of every client AID that is permitted to gain access to the server, especially when such clients may be written after the server is deployed.","The present invention suffers from none of these drawbacks of the Conventional Approach. According to an embodiment of the invention a delegate approach is used to protect the underlying methods of the server and the client applications. Instead of granting a client application access to an interface of the server application, the client is given access to a delegate object. The delegate object controls access to the shared methods of the server application by enforcing a security policy, using security mechanisms. Thus the aforementioned technique of employing delegate objects enables introducing security mechanisms for object sharing. The security policy may include, but is not limited to, doing nothing, verifying common knowledge of a shared secret, hashing, and authenticating the client, e.g., through an AID, public-private key pairs (e.g., the RSA algorithm). The security policy may be through a preloaded means or via user interaction, e.g., by entering a PIN or other shared secret.","Obtaining a reference using the delegate approach is illustrated in through . In , the server applet  registers the delegate object (DO) associated with the server AID  with the JCRE  upon installation. In , the client applet  requests the DO associated with a given server AID  from the JCRE , and obtains the DO reference  if it exists. Note that the DO reference will always be obtained if a server matching the requested AID has been installed; the server applet is not consulted upon this request, thus alleviating the need for the server to contain a list of acceptable client AIDs, which is a considerable drawback in the Conventional Approach. In , the client applet  uses the DO reference  to bypass the firewall  and access the portion of the server applet  that comprises the DO . The server applet  is still prohibited from accessing  the client applet  due to the firewall .","However, this restriction can easily be avoided by having the client applet register a client delegate object which is obtained by the server applet. In fact, since the server applet does not have to contain a list of client AIDs, there is not a fundamental difference between a client applet and a server applet; any applet may freely obtain a delegate object registered by any other applet. The client may be thought of as whichever applet happens to be initiating a request for service at a particular time. Thus, two applets may have the relationship of being both a client and server to each other in various circumstances. Such an arrangement makes mutual authentication practical, which can lead to applets working together at a level of trust that is impractical with the Conventional Approach.",{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 4","FIG. 4","FIG. 3"],"b":["100","405","308"]},"The server delegate  requests a reference  to the client delegate  from the JCRE , and receives the reference . The server delegate  issues a challenge  to the client delegate  to prove knowledge of the secret. The challenge is forwarded  to the client applet . The client applet  responds to the challenge in a way that demonstrates knowledge of the secret , and passes this response to the client delegate . The client delegate  passes the response  back to the server delegate . The server delegate  validates the response. If the response is correct, then the original request for service  is forwarded  to the server applet . The server applet  provides the requested service, and issues a response  which is passed to the server delegate . This response is passed back  to the client applet , thus completing the request for service.","Note that depending upon the security policy, as part of the response , the server may provide a session key to an authenticated client. Until the session key expires (usually when power is removed), the client may initiate subsequent requests that are processed using messages , , , and , bypassing the challenge\/response portion of this sequence.","Note also that the authentication could have been easily performed in both directions if desired, in that the client could authenticate the server before trusting the server to process the request for service, using exactly this same process.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 5","b":["110","102","308","510","540","520","550","530","560","570"]},"Appendix B contains code for the preferred embodiment for delegates. Code 3 shows a server applet  registering its delegate . Code 4 illustrates the server delegate . Code 5 illustrates a simple challenge\/response interface. Code 6 shows a client applet  invoking a server method. Code 7 illustrates a client delegate  for challenge\/response.","While specific embodiments of the present invention have been described, various modifications and substitutions will become apparent to one skilled in the art by this disclosure. One example of such modification is to use proxies instead of delegates. Such modifications and substitutions are within the scope of the present invention, and are intended to be covered by the appended claims.",{"@attributes":{"id":"p-0036","num":"0035"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"APPENDIX A"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Compromising security of a SIO"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"package AppABC;"},{"entry":"import javacard.framework.*;"},{"entry":"public interface ABCLoyaltyAirlineInterface extends Shareable {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"public void grantFrequentFlyerPoints (int amount);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"public interface ABCLoyaltyPurseInterface extends Shareable {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"public void grantLoyaltyPoints (int amount);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"public class ABCLoyaltyApplet extends"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"javacard.framework.Applet implements"]},{"entry":[{},"ABCLoyaltyAirlineInterface, ABCLoyaltyPurseInterface {"]},{"entry":[{},"protected int loyaltyPoints;"]},{"entry":[{},"protected int frequentFlyerPoints;"]},{"entry":[{},"\/* A service only for client \u2018Airline\u2019 *\/"]},{"entry":[{},"public void grantFrequentFlyerPoints (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"frequentFlyerPoints += amount;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/* A service only for client \u2018Purse\u2019 *\/"]},{"entry":[{},"public void grantLoyaltyPoints (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"loyaltyPoints += amount;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public ABCLoyaltyApplet( ) throws Exception {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"loyaltyPoints = 0;"]},{"entry":[{},"frequentFlyerPoints = 0;"]},{"entry":[{},"\/* Add code to initialize potential client AIDs . . . *\/"]},{"entry":[{},"register ( );"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public void process( ) {"]},{"entry":[{},"\u2002\/* Various code specific to services for this applet,"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"such as point redemption code . . . *\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public Shareable getShareableInterfaceObject ("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"AID clientAID, byte parameter) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (clientAID.equals (purseAppletAID))"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return (ABCLoyaltyPurseInterface) this;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"else if (clientAID.equals (airlineAppletAID))"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return (ABCLoyaltyAirlineInterface) this;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return null;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"Code 1. Server defines and grants access to SIO"},{"entry":"package AppPurse;"},{"entry":"import javacard.framework.*;"},{"entry":"import AppABC.*;"},{"entry":"public class PurseApplet extends javacard.framework.Applet {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"private int value;"]},{"entry":[{},"private ABCLoyaltyPurseInterface abcSIO;"]},{"entry":[{},"public PurseApplet( ) throws Exception {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"value = 0;"]},{"entry":[{},"abcSIO = (ABCLoyaltyPurseInterface)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"JCSystem.getAppletSharableInterfaceObject ("]},{"entry":[{},"abcLoyaltyAppletAID, (byte) 0);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"register ( );"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public void use (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"value \u2212= amount;"]},{"entry":[{},"if (abcSIO != null)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"abcSIO.grantLoyaltyPoints (amount);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/* Attempt to \u2018hack\u2019 by using an SIO to access the Airline"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"* applet's exclusive service grantFreguentFlyerPoints *\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"ABCLoyaltyAirlineInterface hackSIO ="]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(ABCLoyaltyAirlineInterface)"]},{"entry":[{},"JCSystem.getAppletSharableInterfaceObject ("]},{"entry":[{},"ABCLoyaltyAppletAID, (byte) 0);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (hackSIO != null)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"hackSIO.grantFrequentFlyerPoints (amount);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"\/* Other methods follow for adding points to the purse . . . *\/"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"Code 2. Client compromises SIO"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0037","num":"0036"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"APPENDIX B"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Secure Delegate Implementation Of Object Sharing"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"package AppABC;"},{"entry":"import OSResources.*;"},{"entry":"public class ABCLoyaltyApplet extends OSResources.Applet {"},{"entry":"private String aid = AppABC.ABCLoyaltyApplet;"},{"entry":"private int loyalty;"},{"entry":"public ABCLoyaltyApplet( ) {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"loyalty = 0;"]},{"entry":[{},"register (new ABCLoyaltyDelegate (this), aid);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"void grantPoints (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"loyalty += amount;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"boolean usePoints (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (loyalty >= amount) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"loyalty \u2212= amount;"]},{"entry":[{},"return true;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"} else {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return false;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"int readPoints ( ) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return loyalty;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"Code 3. Server applet registering its delegate"},{"entry":"package AppABC;"},{"entry":"import OSResources.*;"},{"entry":"public class ABCLoyaltyDelegate extends Delegate {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"final static byte CHALLENGE_LENGTH = (byte) 64;"]},{"entry":[{},"final static byte FAILURES_ALLOWED = (byte) 2;"]},{"entry":[{},"private byte[ ] secret1 = {\/* initializing code . . . *\/};"]},{"entry":[{},"private byte[ ] secret2 = {\/* initializing code . . . *\/};"]},{"entry":[{},"private ABCLoyaltyApplet myApplet;"]},{"entry":[{},"private ChallengePhrase cp;"]},{"entry":[{},"private ChallengePhrase checkcp;"]},{"entry":[{},"private byte grantTriesRemaining = FAILURES_ALLOWED;"]},{"entry":[{},"private byte useTriesRemaining = FAILURES_ALLOWED;"]},{"entry":[{},"protected ABCLoyaltyDelegate (ABCLoyaltyApplet a) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"myApplet = a;"]},{"entry":[{},"cp = new ChallengePhrase (CHALLENGE_LENGTH);"]},{"entry":[{},"checkcp = new ChallengePhrase (CHALLENGE_LENGTH);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public boolean grantPoints (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/\/ do some checking"]},{"entry":[{},"if (myApplet != null) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"ABCLoyaltyInterface pD = (ABCLoyaltyInterface)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"OSystem.getDelegate ("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"OSystem.getPreviousContextAID ( ));"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (pD != null) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/* Create new random challenge phrase *\/"]},{"entry":[{},"checkcp.setPhrase(cp.randomize ( ));"]},{"entry":[{},"\/* Get client response to phrase *\/"]},{"entry":[{},"byte[ ] response = pD.loyaltyChallenge (cp);"]},{"entry":[{},"byte[ ] r = checkcp.encrypt (secret1);"]},{"entry":[{},"if (isEqual (response, r)) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\/* See if client gave the correct response *\/"]},{"entry":[{},"grantTriesRemaining = FAILURES_ALLOWED;"]},{"entry":[{},"myApplet.grantPoints (amount);"]},{"entry":[{},"return true;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"} else {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if (--grantTriesRemaining == 0) myApplet = null;"]},{"entry":[{},"return false;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"return false;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public boolean usePoints (int amount) {"]},{"entry":[{},"\/* Access to this method uses secret2, for different"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"clients, but is otherwise similiar to grantPoints . . . *\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public int readPoints ( ) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if (myApplet != null) return myApplet.readPoints( );"]},{"entry":[{},"else return 0;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"Code 4. Server delegate"},{"entry":"package AppABC;"},{"entry":"import OSResources.*;"},{"entry":"public interface ABCLoyaltyInterface {"},{"entry":"public byte[ ] loyaltyChallenge (ChallengePhrase cp);"},{"entry":"}"},{"entry":"Code 5. Server defines interface that each client must"},{"entry":"provide to handle challenge\/response"},{"entry":"package AppPurse;"},{"entry":"import OSResources.*;"},{"entry":"import AppABC.*;"},{"entry":"public class PurseApplet extends OSResources.Applet {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"public String aid =\u201cAppPurse.PurseApplet\u201d;"]},{"entry":[{},"private byte[ ] secret1 = {\/* initializing code . . . *\/ };"]},{"entry":[{},"private int value;"]},{"entry":[{},"public PurseApplet ( ) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"value = 0;"]},{"entry":[{},"register (new PurseDelegate(this), aid);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public byte[ ] loyaltyChallenge (ChallengePhrase cp) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return cp.encrypt (secret1);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public void use (int amount) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"value \u2212= amount;"]},{"entry":[{},"ABCLoyaltyDelegate d ="]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(ABCLoyaltyDelegate)"]},{"entry":[{},"OSystem.getDelegate (\u201cAppABC.ABCLoyaltyApplet\u201d);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (d != null) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"d.grantPoints (amount);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\/* Other methods follow for adding points to the purse . . . *\/"},{"entry":"}"},{"entry":"Code 6. Client applet invoking server method"},{"entry":"package AppPurse;"},{"entry":"import OSResources.*;"},{"entry":"import AppABC.*;"},{"entry":"public class PurseDelegate extends Delegate implements"},{"entry":"ABCLoyaltyInterface {"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"private PurseApplet myApplet;"]},{"entry":[{},"protected PurseDelegate (PurseApplet a) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"myApplet = a;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"public byte[ ] loyaltyChallenge (ChallengePhrase cp) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"if (myApplet != null)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return (myApplet.loyaltyChallenge (cp));"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"return null;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"}"},{"entry":"Code 7. Client challenge\/response delegate"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}}],"BRFSUM":[{},{}],"heading":["Background of the Invention","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
