---
title: Interception and modification of network authentication packets with the purpose of allowing alternative authentication modes
abstract: Methods and systems in a data/computer network for authenticating identifying data transmitted from a client to a server through use of a gateway interface system which are communicately coupled to each other are disclosed. An authentication packet transmitted from a client to a server of the data network is intercepted by the interface, wherein the authentication packet is encrypted with a one-time password for transmission from the client to the server. The one-time password associated with the authentication packet can be verified utilizing a one-time password token system. The authentication packet can then be modified for acceptance by the server, wherein the response packet generated by the server is thereafter intercepted, verified and modified for transmission back to the client in a similar but reverse process.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07421576&OS=07421576&RS=07421576
owner: The United States of America as represented by the United States Department of Energy
number: 07421576
owner_city: Washington
owner_country: US
publication_date: 20030116
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["STATEMENT OF GOVERNMENT INTEREST","TECHNICAL FIELD","BACKGROUND OF THE INVENTION","BRIEF SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["The invention described herein may be manufactured and used by or for the United States Government for Governmental purposes without the payment of any royalties.","The present invention is generally related to computer network security methods and systems. The present invention is also related to Kerberos authentication methods and systems. The present invention is additionally related to methods for authenticating computer network users.","A continuing need exists for privacy and authentication in computer networks. The ability to properly authenticate a computer network user, for example, is one of the foremost areas of concern involved in computer network security. Various authentication schemes have been created to address computer network security needs. One scheme that has recently gained a great deal of use is the Kerberos security system, including related Kerberos protocols and software. Kerberos is a network authentication protocol that was designed to provide strong authentication for client\/server applications by using secret-key cryptography. The Kerberos security system is generally utilized today as a developing standard for authenticating computer network users, because it can operate in a multi-vendor network and does not require the transmission of passwords over the computer network.","Kerberos functions as a means for authenticating users. A Kerberos software package implemented in the context of a data network (e.g., a computer network) can determine if a user is in fact a valid network user. It does not provide other security services such as audit trails. Kerberos authentication is based on \u201cpasswords\u201d and does not involve physical location or smart cards. In order to implement Kerberos in a computer network, each computer in a network must run Kerberos software. Kerberos works by granting a \u201cticket,\u201d which can then be honored by all network computers running the Kerberos protocol. Such tickets can be encrypted, so that passwords do not pass over the network in \u201cclear text\u201d and additionally, so that the users are not required to enter their password when accessing a different computer.","Kerberos protocols find particularly useful applications in association with the Internet, a computer network well known in the computer networking arts. Because the Internet, including many internal organization \u201cIntranet\u201d networks, generally operate via insecure network environments, many of the protocols utilized in the Internet (including \u201cIntranets\u201d) do not provide any security. Tools to \u201csniff\u201d passwords off of a computer network are commonly utilized by malicious hackers. Applications, which send an unencrypted password over a computer network (e.g., Internet and\/or Intranet), are very vulnerable to undesirable network intrusions.","Many computer network designers, including designers of so-called \u201cweb sites\u201d often utilize \u201cfirewalls\u201d to solve their network security problems. A firewall, well-known in networking and computer arts is generally a security module that protects an organization's network (e.g., an Intranet) against external threats, such as hackers, coming from another network, such as the Internet. Firewalls prevent computers or other computing devices within a particular network from communicating directly with computers or other devices external to the network and vice versa. Instead, all communications are generally routed through a proxy server outside of the organizational network, and the proxy server determines if it may be safe to let a particular message or data pass through to the network.","Unfortunately, firewalls assume that malicious hackers, for example, operate external to the computer network, which is essentially a flawed assumption. Insiders carry out many particularly egregious and damaging incidents of computer crime. Firewalls also have a significant disadvantage in that they restrict how a user is able to function within the network environment. Kerberos was thus created as a solution to these network security problems. The Kerberos protocol uses strong cryptography so that a client can prove its identity to a server (and vice versa) across an insecure network connection. After a client and server have utilized Kerberos to prove their identity, all communications thereafter can be encrypted to assure privacy and data integrity.","The present invention was created as a solution for integrating a one-time password system (e.g., CRYPTO Cards) into an institution-Wide Windows\u00ae desktop. With the advent of modern operating systems such as, for example, Windows 2000\u00ae, many operating systems have moved from proprietary-based authentication schemes to the more standard Kerberos system. Because many institutions have utilized Kerberos in UNIX environments for a number of years, many one-time passwords have been integrated into UNIX-based Kerberos protocols. A number of schemes have been considered for integrating one-time passwords with Microsoft's version of Kerberos, for example including the use of a UNIX Kerberos server, cross-realm trusts between UNIX and Microsoft\u00ae servers, modifying a Microsoft\u00ae system or server, and the replacement of end-user authentication interfaces. The present inventor has determined that all of these solutions are either technically unfeasible or too difficult to implement.","Based on the foregoing, the present inventor has concluded that a need exists for an improved method and system for authenticating users without the aforementioned drawbacks. The present inventor believes that an improved authentication scheme can be designed and implemented which involves the interception of network-level Kerberos authentication packages. Such an improved authentication scheme, including methods and systems thereof, are thus disclosed herein.","The following summary of the invention is provided to facilitate an understanding of some of the innovative features unique to the present invention, and is not intended to be a full description. A full appreciation of the various aspects of the invention can be gained by taking the entire specification, claims, drawings, and abstract as a whole.","It is therefore one aspect of the present invention to provide an improved computer network access method and system.","It is another aspect of the present invention to provide a method and system for intercepting and modifying computer network-level Kerberos authentication packets.","It is yet another aspect of the present invention for verifying the integrity of intercepted network-level Kerberos authentication packets with a secondary authentication scheme.","The above and other aspects can be achieved as will now be further summarized. Methods and systems can be implemented in a computer network for authenticating identifying data transmitted from a client to a server. An authentication packet transmitted from a client to a server over a data network can be intercepted and encrypted with a one-time password for transmission from a client to a server, which in turn generates a response packet for transmission back to the client. The one one-time password associated with the authentication packet can be verified utilizing an arbitrary one-time password token system. The authentication packet can then be modified for acceptance by the server. The response packet generated by the server can thereafter be intercepted, verified and modified for transmission back to the client in a similar, but reverse process.","The particular values and configurations discussed in these non-limiting examples can be varied and are cited merely to illustrate an embodiment of the present invention and are not intended to limit the scope of the invention.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 1","FIG. 2"],"b":["100","202","201"]},"The process can be initiated as depicted at block . Thereafter, as illustrated at block , one or more inbound preauthentication packets can be intercepted from the client.","Next, a one-time password (OTP) utilized to encrypt the inbound preauthentication packet from a group of valid one-time passwords presented from the one-time authentication server can be determined, as illustrated at block . A decision can then be made, as illustrated at decision block , determining if a valid one-time password was found.","If the valid one-time password is found, as indicated at decision block , the packet can be decrypted with the one-time password as indicated at block . The preauthentication packet can then be re-encrypted with a known valid password. Note that such a known valid password is the password that is expected by the domain server as a valid password for a given user. Following encryption with a known valid password, the packet is then passed on to the domain server. This valid password is usually only known between the system doing the modification and the domain server, and is therefore referred to as a shared secret. Following processing of the operation illustrated at block , the preauthentication packet can be re-encrypted with the shared secret, as indicated at block .","If, however, a valid one-time password was not found, as illustrated at decision block , then as illustrated at block , a determination can be made whether or not the originating preauthentication packet is encrypted with a known valid shared secret. Note that this shared secret may be the same shared secret indicated at block , given a different process path. If it is determined, as indicated at block  that the preauthentication packet has been encrypted with a valid shared secret, then the operation illustrated at block  can be performed, wherein the preauthentication packet is encrypted with a known invalid password. This process allows, if desired, the assurance that the originating client cannot use the shared secret between the system doing the modification and the domain server. If it is determined, however, as illustrated at block , that the preauthentication packet has not been encrypted with the shared secret, then the operation depicted at block  is performed.","Thus, described thereafter at block , the preauthentication packet in its modified or unmodified state is passed on to the domain server. As indicated next at block , the response from the domain server can be intercepted in route back to the client. Thereafter, a determination can be made whether or not the response packet is encrypted with the valid shared secret. As indicated at decision block , such a determination is processed. If the response packet is encrypted with the shared secret, then the response with the shared secret is decrypted, as indicated at block .","Following processing of the operation illustrated at block , the response packet is re-encrypted with the original one-time password, as depicted at block . The response packet can then be forwarded to the client system, as indicated at block . If the response packed is not encrypted with the shared secret, then the response packet is simply sent to the client system, as illustrated at block . The process then terminates, as depicted at block .","The corresponding response packet from the domain server can also be intercepted in route back to the client. It can contain the requested TGT encrypted with the previously utilized shared secret. The system can decrypt the packet with the shared secret and can then encrypt it with the original one-time password initially utilized by the client system in the preauthentication packet before sending it on to the client system. All other Kerberos-related and unrelated server traffic is left unmodified.","It can be appreciated by those skilled in the art that the methodology described with respect to  can be implemented as a program product (i.e., computer program product) composed of one or more modules. The term \u201cmodule\u201d as utilized herein thus generally refers to a software module. In the computer programming arts, a module can be implemented as a collection of routines and data structures that performs particular tasks or implements a particular abstract data type. Modules generally are composed of two parts. First, a software module may list the constants, data types, variable, routines, and so forth that can be accessed by other modules or routines. Second, a software module may be configured as an implementation, which can be private (i.e., accessible only to the module), and which contains the source code that actually implements the routines or subroutines upon which the module is based.","Therefore, when referring to a \u201cmodule\u201d herein, the present inventor is generally referring to such software modules or implementations thereof. The methodology illustrated in  for example, can be implemented as a series of modules. Such modules can be utilized separately or together to form a program product that can be implemented through signal-bearing media, including transmission media and recordable media. The present invention is capable of being distributed as a program product in a variety of forms, which apply equally regardless of the particular type of signal-bearing media utilized to carry out the distribution.","Examples of signal-bearing media include: recordable-type media, such as floppy disks, hard disk drives, CD ROMs, CD-Rs, etc., and transmission media, such as digital and\/or analog communication links. Examples of transmission media also include devices such as modems, which permit digitized information to be transmitted over standard telephone lines and\/or the more advanced digital communications lines. The present invention can thus be implemented as a program product composed of a plurality of modules, which can be interactively displayed for a user on a display screen of a data-processing system (e.g., a computer). Such interactivity may be provided by a graphical user interface (GUI), which is well known in the art, including Internet browser applications thereof.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 2","FIG. 3","FIG. 2","FIGS. 2","FIGS. 2"],"b":["3","4","3","4"]},"As indicated in , client  and server  can communicate utilizing the functionality provided by HTTP. Active within client  is a first process, browser , which establishes connections with server , and presents information to the user. Any number of commercially or publicly available browsers can be utilized in various implementations in accordance with the preferred embodiment of the present invention. For example, a browser such as Netscape\u00ae can provide the functionality specified under HTTP.","User requests  for data are transmitted by a client application program to a server . Server  can be, for example, a remote computer system accessible over the Internet or other communication networks. Note that the term \u201cInternet\u201d as utilized herein is well known in the art and refers generally to the worldwide collection of gateways and networks that utilize the TCP\/IP suite of protocols to communicate with one another. The term \u201cintranet,\u201d on the other hand, refers to a network designed for information processing within a particular company or organization that employs applications associated with the Internet, such as Web pages, Web browsers, and so forth, but which are accessible only to those within the company or organization.","Server  generally performs scanning and searching of raw (e.g., unprocessed) information sources (e.g., newswire feeds or news groups) and, based upon these user requests, presents the filtered electronic information as server responses  to the client process. The client process may be active in a first computer system, and the server process may be active in a second computer system, communicating with one another over a communications medium, thus providing distributed functionality and allowing multiple clients to take advantage of the information-gathering capabilities of the server.","Server  executes the corresponding server software, which presents information to the client in the form of HTTP responses . The HTTP responses  correspond with the Web pages represented using HTML, or other data generated by server . Server  provides HTML . With certain browsers, a Common Gateway Interface (CGI)  is also provided, which allows the client program to direct server  to commence execution of a specified program contained within server . This may include a search engine that scans received information in the server for presentation to the user controlling the client.","By utilizing this interface, and HTTP responses , server  may notify the client of the results of that execution upon completion. Common Gateway Interface (CGI)  is one form of a gateway, a device utilized to connect dissimilar networks (i.e., networks utilizing different communications protocols) so that electronic information can be passed from one network to the other. Gateways transfer electronic information, converting such information to a form compatible with the protocols used by the second network for transport and delivery.","In order to control the parameters of the execution of this server-resident process, the client may direct the filling out of certain \u201cforms\u201d from the browser. This is provided by the \u201cfill-in-forms\u201d functionality (i.e., forms ), which can be provided by some browsers, such as the Netscape-brand browser described herein. This functionality allows the user via a client application program to specify terms in which the server causes an application program to function (e.g., terms or keywords contained in the types of stories\/articles, which are of interest to the user). This functionality is an integral part of the search engine.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 4","b":["400","201","201","208","202","204","206","202","208","208","208","200","208","208"]},{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 5","FIG. 5"],"b":["500","502","504","504","504","506","507","502","504","502","504","511","504","506","513","506","504","513","509","504","502","5015"]},"Based on the foregoing, it can be appreciated that the present invention represents an advancement over the prior art. Currently, the only available technology provided by one-time password vendors for integration with Windows authentication requires the modification and\/or replacement of the user authentication interface on each desktop or server system. Such a solution can be highly intrusive in large-scale deployment. The technology disclosed herein does not require modification of any system.","The most significant application of the present invention is the integration of one-time password systems with Kerberos-based authentication systems in a non-intrusive manner. Immediate applications include the integration of any one-time password system (e.g., CRYPTO Card, SecurID, etc.) with Kerberos. Those skilled in the art can appreciate, however, that the present invention can be applied to other networks and systems. For example, the present invention can be integrated with a Distributed Computing Environment (DCE) authentication system, which is also based upon Kerberos, and which is heavily utilized by supercomputing facilities, such as, for example Los Alamos National Laboratory in Los Alamos, N. Mex. Essentially, all vendors of one-time password systems will significantly benefit through applications of the present invention.","The embodiments and examples set forth herein are presented to best explain the present invention and its practical application and to thereby enable those skilled in the art to make and utilize the invention. Those skilled in the art, however, will recognize that the foregoing description and examples have been presented for the purpose of illustration only. Other variations and modifications of the present invention will be apparent to those of skill in the art. The description as set forth is not intended to be exhaustive or to limit the scope of the invention. Many modifications and variations are possible in light of the above teaching without departing from the spirit and scope of the following claims. It is contemplated that the use of the present invention can involve components having different characteristics. It is intended that the scope of the present invention be defined by the claims appended hereto, giving full cognizance to equivalents in all respects.","The embodiments of the invention in which an exclusive property or right is claimed are defined as follows."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying figures, in which like reference numerals refer to identical or functionally-similar elements throughout the separate views and which are incorporated in and form part of the specification, further illustrate the present invention and, together with the detailed description of the invention, serve to explain the principles of the present invention.",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 3","FIG. 2"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
