---
title: High resolution phase frequency detectors
abstract: An inexpensive and reliable, high resolution digital phase detector for timing circuits for wireless, optical or wire-line transmission systems. In particular this invention allows using size limited clock counters for measurements of unlimited time ranges by combining unlimited number of intermediate samples without accumulating samples granularity errors. In addition to the measurements of the final time ranges, the intermediate samples are available for purposes of digital signal processing.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06864672&OS=06864672&RS=06864672
owner: 
number: 06864672
owner_city: 
owner_country: 
publication_date: 20010524
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a 371 of PCT\/CA01\/00723 filed May 24, 2001 and claims benefit of provisional application 60\/206,579 filed May 24, 2000.","1. Field of the Invention","This invention is directed to providing high resolution low cost digital phase detectors which can be used in digital phase locked loops (DPLLs) and shall also make possible other replacements of analog circuits by their digital implementations.","The high resolution phase detectors (HRPD) can be used for a wide range of data rates, and for wireless, optical, or wireline transmission and communication systems.","2. Background Art","Most of currently used digital phase detectors have resolution limited by a clock cycle time. While some most advanced digital phase detectors allow higher resolutions which are comparable with propagation delays of clock propagating gates, they have other limitations such as: complex algorithms which are conditioned by propagation delays of detector timing circuits, and dependency of their phase resolution on technological process and power supply variations.","The closest background solution is presented by Bogdan (U.S. Pat. No. 6,148,052). However this background solution requires additional oscillator circuit implemented with free running ring oscillator having unknown oscillation frequencies dependent on IC process deviations and power supply variations causing propagation delays deviations ranging from \u221250% to +50%.","Outputs of such additional unpredictable oscillator circuit are used to capture a phase of a first signal frame and a phase of a second signal frame, which need to be subtracted from each other to calculate a phase skew between the first signal frame and the second signal frame. Therefore in addition to the oscillator circuit, said background solution requires:\n\n","There is a need for digital phase detectors which have simpler algorithms and greater independence versus the propagation delays of the detector timing circuits and the clock propagating gates.","Such much simpler digital phase detectors are provided by the present invention which eliminates the additional free running oscillator and the above mentioned additional circuits and calibration related subroutines. These improvements are achieved by changing principle of operation, as the present invention:","Propagates the first signal clock through serially connected gates and uses outputs of these gates for sensing phase of the second signal or propagates the second signal through serially connected gates and uses outputs of these gates for sensing phase of the first signal clock, instead of using outputs of the additional free running oscillator for capturing phases of the first signal and the second signal.","Since the first signal and the second signal are much more stable than the free running oscillator; the above calibration circuits are replaced by much simpler self-calibration means or by stabilizing propagation delays of the serially connected gates with phase locked loops or with delay locked loops.","It is an object of present invention to provide digital high resolution phase detectors which are simple and reliable and can be used in variety of communication systems.","Variety of the high resolution phase detectors are described in this document using the same terms which are explained below.","First signal clock fis a higher frequency signal which is used to measure time periods corresponding to single or multiple cycles of a lower frequency signal which is called second signal frame fr.","High resolution phase detectors comprise:\n\n","The high resolution extension can be implemented by using a propagation circuit and a phase capture register, as it is explained below.","The first signal clock or the measured second signal frame is propagated through multiple serially connected gates.","The first signal clock or the second signal frame is captured in the phase capture register by the outputs of the serially connected gates, or the outputs of the serially connected gates are captured in the phase capture register by the first signal clock or by the second signal frame. The content of the phase capture register is used to calculate a phase skew of the second signal frame versus the first signal clock.","The high resolution phase processing method comprises:\n\n","The above methods allow designing multiple different implementations of HRPD.","Some of these HRPD implementations are defined in the GENERAL DESCRIPTION OF THE INVENTION and are shown with more details in the DESCRIPTION OF THE PREFERRED EMBODIMENTS.","1. HRPD Config.1 based on delay line captured by frame edge","The HRPD Config.1 uses:\n\n","The calibration method comprises:\n\n","The calibration method can further comprise a reduction of an error caused by an occurrence of different gate delays at the end versus the front of the delay line:\n\n","2. HRPD Config.2 based on ring oscillator captured by frame edge.","The HRPD Config.2 uses:\n\n","Since the number of ring oscillator gates and the first signal clock period are known, calibration of gates propagation delay is not needed for the HRPD Config.2.","3. HRPD Config.3 based on clock signal captured by frame delay line edges.","The HRPD Config.3 uses:\n\n","The calibration method comprises:\n\n","The calibration method can further comprise a reduction of an error caused by an occurrence of different gate delays at the end versus the front of the delay line:\n\n","4. HRPD Config.4 based on frame delay line captured by clock signal.","The HRPD Config.4 uses:\n\n","The calibration method comprises:\n\n","The calibration method can further comprise a reduction of an error caused by an occurrence of different gate delays at the end versus the front of the delay line:\n\n","5. HRPD Config.5 based on frame captured by clock delay line.","The HRPD Config.5 uses:\n\n","The calibration method comprises:\n\n","The calibration method can further comprise a reduction of an error caused by an occurrence of different gate delays at the end versus the front of the delay line:\n\n","6. HRPD Config.6 based on frame captured by ring oscillator.","The HRPD Config.6 uses:\n\n","Since the number of ring oscillator gates and the first signal clock period are known, calibration of gates propagation delay is not needed for the HRPD Config.6.","1. HRPD Config.1 based on delay line captured by frame edge","The HRPD Config.1 is shown in FIG. .","Approximate phase measurements are explained below.","The HRPD Config.1 uses two symmetrical phase counters buffers A\/B (PCBA\/PCBB), which perform reverse functions during alternative A\/B cycles of the frame signal fr. During the A cycle, the PCBA counts the number of incoming fclocks, but during the following B cycle the PCBA remains frozen until its content is read by a phase processing unit (PPU), and subsequently the PCBA is reset before the beginning of the next A cycle. Reversibly, the PCBB performs counting during the B cycle and is read and reset during the following A cycle.","Such symmetrical PCBA\/PCBB configuration allows much more time for counters propagation by inhibiting counting long before the actual reading takes place.","Therefore, much higher frequencies of counted clocks are allowed for the same IC technology.","Generally speaking the above concept of a digital phase detector, represents one of several possible HRPD solutions, which are based on counting the first signal clock during every frame of the second signal, wherein the second signal frame contains a number of the second signal clocks.","The symmetrical twin pair PCBA\/PCBB configuration:\n\n","When frrise signals the end of the current phase measurement, counting of fclock is inhibited and the counter content remains frozen, until the next rise of the frsignal when the counted clock is enabled again. The whole frcycle is a very long freeze period, which is more than sufficient to accommodate; any kind of counter propagation, the counter transfer to the phase processing unit, and the counter reset. During the freeze period a mate counter is kept enabled and provides measurement of frphase.","More detailed operations of the PCBA\/PCBB configuration for both alternatives STOPA=1 and STOPB=1, are further explained below.","When STOPA signal is active, HRPD circuits perform listed below functions.","The PCBB counts all rising edges of fclocks.","When PCBB(9) goes high, the PCBB generates SEL9 signal. The SEL9 activates RD_REQ which initiates the PPU to read PCBA via CNTR(15:0).","The PPU calculates an approximate phase error of previous frversus f, by subtracting from the newly read PCB, the number N of fclocks which nominally should correspond to the frame fr.","When CTRB(14) goes high, the PCBB generates SEL14 signal. The SEL14 activates RST_PCBA which initiates PCBA reset circuits after its content has been read by PPU.","When frrise occurs, PRESTOP_FF is set to 1 and inverts STOPA\/STOPB signals.","When STOPB signal is active all the above functionality is fulfilled with reversed roles of STOPB and PCBA versus STOPA and PCBB.","High resolution extension of phase measurements is explained below.","The high resolution extension enhances phase detection resolution to a single inverter delay i.e. by \u02dc10 times compared with conventional methods based on clock counting. The high resolution measurement is implemented in the HRPD Config.1, by using the phase capture register (PCR) to measure a positioning of the last rising edge of the second signal frame frversus the fclock waveform","The phase capture register captures a state of outputs of multiple serially connected gates which the first signal clock fis continuously propagated through, at the leading edge of the second signal frame fr.","PCR decoders are used in the high resolution extension, and they are defined below.","The last rise decoder (LRD) provides binary encoded position of frising edge, which has been captured at the most right location of the PCR.","The cycle length decoder (CLD) provides binary encoded lengths of the fwave, which has been captured between these 2 falling or 2 rising edges of the fwave which occurred at the most right locations of the PCR.","Captured PCR content is decoded by the last rise decoder and the cycle lengths decoder. Contents of the LRD and the CLD are later transferred to the phase processing unit (PPU).","The above operations are controlled by a Detector Timing Circuit, which is shown in the FIG. .","Timing analysis of the detector timing circuit is shown in FIG.  and is explained below.","The High Clock Region Flip-Flop (HCR_FF) is set to 1, when frise encounters PCR(0) set to 1. The PCR(0) was set to 1, if an frrise encountered f=high. Therefore the HCR_FF=1 signals, that frrising edge occurred during the f=high halfcycle.","The PCR(1) is set to 1, when an frrise encounters f=low. Therefore the PCR(1)=1 signals, that frrising edge occurred during the f=low halfcycle.","PRESTOP_FF is set to 1, when ffall encounters HCR_FF or PCR(1) set to 1.","STOP_FF is reversed, by any rising edge of the PRESTOP_FF. Any STOP_FF switching causes a reversal of the PCBA\/PCBB functions.","The whole PCR is reset by the signal PhaDet_RST. The PhaDet_RST shall be generated during fr=low halfcycle and after contents of the PCR decoders are read by the phase processing unit.","It shall be noticed that a first frise which occurs after frrise, will encounter unchanged status of the STOP_FF. Therefore presently active counter will be increased by 1 by the first frise, but it will be freezed when following ffall will reverse the STOP_FF before an arrival of the second frise.","However since STOP_FF reversal was similarly delayed during previous frmeasurement, presently active counter missed counting one frise at the beginning of the present measurement.","Therefore the counter content needs to be decreased by 1, in order to represent a correct number of complete fcycles which occurred between consecutive rising edges of the frframe.","Phase processing method combines the approximate phase measurement and the high resolution extension into an actual phase measurement of a frame signal.","The phase processing method uses additional terms which are explained below.","Calculated by PPU, measured phase (MEA_PHA) represents the actual phase error between frversus the equivalent fframe; and consists of the listed below components.","LRD\/CLD is a normalized value of a phase error between frrise versus last frise, as it has been read by the PPU from the LRD and CLD decoders.","Remaining phase error (REM_PHA) is calculated based on the present measurement results, but PPU stores and uses it to correct the next measurement result. The REM_PHA represents a remainder of a presently captured fraction of the fperiod, which needs to be added to the next phase error measurement.","Subtracted N which is a nominal number of first signal clocks per a second signal frame; transforms the counted number of fcycles per frperiod, into an approximate phase error between the frversus the f.","While the LRD\/CLD represents a normalized PCR captured extension of the CNTR(15:0) captured phase, and is added to the present MEA_PHA: the remaining phase error between the frand the next frise amounts to (CLD-LRD)\/CLD and it is stored as the REM_PHA, in order to modify next measurement's MEA_PHA.","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+LRD\/CLD\u2212N, REM_PHA=(CLD\u2212LRD)\/CLD. \n","2. HRPD Config.2 based on ring oscillator captured by frame edge","For the approximate phase measurements the HRPD Config.2 uses the same circuits as the HRPD Config.1.","High resolution extension for the Config.2 has differences versus the Config.1, which are shown in the FIG.  and are listed below:\n\n","The phase capture register captures the state of outputs of multiple serially connected gates which form the ring oscillator which the first signal clock fis continuously propagated through, at the leading edge of the second signal frame fr.","Since the ring oscillator gates must use lowered power supply, in order to allow their delays controllability in the PLL configuration: phase detection resolution will be slightly lower for the Config.2 versus the Config.1, but it still shall be significantly better when compared with conventional methods limited to clock counting.","The detector timing circuit and the timing analysis are the same for the Config.2 as for the Config.1 (see FIG.  and FIG. ).","The only difference between a phase processing method of the Config.2 versus the Config.1 is: that since ring gates number (RGN) is always known, the Config.2 does not need to use the cycle lengths decoder and the CLD can be replaced by a ring gates number (RGN) in the equations calculating the MEA_PHA and the REM_PHA.","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+LRD\/RGN\u2212N, REM_PHA=(RGN\u2212LRD)\/RGN. \n","3. HRPD Config.3 based on clock signal captured by frame delay line edges.","For the approximate phase measurements the HRPD Config.3 uses the same circuits as the HRPD Config.1.","High resolution extension for the Config.3 has differences versus the Config.1, which are shown in the FIG.  and are listed below:\n\n","Since non inverting gates must be used in the delay line, resolution is reduced compared with the Config.1, but still is significantly better than with conventional methods.","For the detector timing circuits, the HRPD Config.3 uses similar solutions as the HRPD Config.1: with the exception of using the signal PCR(\u22121) (see FIG. ), instead of the signal PCR(1) (see ) to enable activation of the PRESTOP_FF by the first falling edge of the f.","The timing analysis is very similar for the Config.3 (see ) as for the Config.1 (see FIG. ). The differencies are caused by the fact that for the Config.3 parts of waveforms which occur after the rising edges of the frame signal are captured, and therefore the captured waveforms are shown on the right sides of the arrows indicating appearances of the frame rising edges.","Phase processing method for the Config.3 is explained below.","Since for the Config.3, the PCR and its decoders represent a part of a waveform which occurs after a frame rising edge:\n\n","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+(CLD\u2212FRD)\/CLD\u2212N, REM_PHA=FRD\/CLD. \n","4. HRPD Config.4 based on frame delay line captured by clock signal.","For the approximate phase measurements the HRPD Config.4 uses the same circuits as the HRPD Config.1.","High resolution extension for the Config.4 has differences versus the Config.1, which are shown in the FIG.  and are explained below.","Instead of propagating the fclock through a delay line, the second signal frame is propagated through the delay line, and the outputs of the delay line gates are captured after any rising edge of the second signal frame:\n\n","A bit FPCR(\u22121) is used in the FPCR for capturing present value of the second signal frame frby the falling edge of the first signal clock f.","The last frame decoder (LFD) provides a binary encoded position of the frrising edge versus the first following frising, which has been captured on the right side of the FPCR.","The cycle length decoder (CLD) provides a binary encoded lengths of the fwave which is calculated as a difference between a number of gate delays captured in the EPCR versus a number of gate delays captured in the FPCR.","Detector Timing Circuit for the Config.4 has differences versus the Config.1, which are shown in the FIG.  and are explained below.","FPCR(\u22121) is used to activate the HCR_FF which enables activation of the PRESTOP_FF, if an frrise occurred during f=high condition.","FPCR(0) is used directly to enable activation of the PRESTOP_FF, if an frrise occurred during f=low condition.","An inverted PRESTOP_FF is used as active low STOPFN signal: in order to preserve the frame delay line captured in the FPCR by the first fclock after a rising edge of fr. Normally all the rising edges of the fclock keep capturing the frame delay line in the FPCR, until the capturing is inhibited by STOPFN=low. Since STOPFN=low is generated between the first and the second frise after the rising edge of fr, the final content of the FPCR is the delay line captured by the first frise.","Similarly an active low STOPEN signal is generated between the second and the third frise after the rising edge of fr. Since STOPEN=low inhibits further capturing of the frame delay line in the EPCR, the final content of the EPCR is the delay line captured by the second frise.","Timing analysis for the Config.4 is shown in the FIG. .","The timing diagrams show both capture events: the delay line capturing by the first frise, and the delay line capturing by the second frise.","The FPCR(\u22121) is activated before the FPCR(0): if frrise occurs during f=high condition and is captured by ffall. Similarly the FPCR(0) is activated before the FPCR(\u22121): if frrise occurs during f=low condition and is captured by frise.","The STOPFN is shown to be activated as STOPFN=low by the ffall after the first frise. Similarly the STOPEN is shown to be activated as STOPEN=low by the ffall after the second frise.","Phase processing method for the Config.4 is defined below.","LFD\/CLD is a normalized value of a phase error between an frrise versus the first frise, as it has been read by PPU from the LFD and CLD decoders.","The content of the LFD divided by the CLD, represents a REM_PHA value which shall be added to the next measurement.","A fraction of the fcycle which shall be added to the present measurement amounts to:\n\n1\u2212LFD\/CLD=(CLD\u2212LFD)\/CLD. \n","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+(CLD\u2212LFD)\/CLD\u2212N, REM_PHA=LFD\/CLD. \n","5. HRPD Config.5 based on frame captured by clock delay line.","For the approximate phase measurements the HRPD Config.5; uses the same circuits as the HRPD Config.1.","High resolution extension for the Config.5 has differences versus the Config.1, which are shown in FIG.  and are explained below.","The Config.5 implements said capture synchronization method:\n\n","For some integrated circuit technologies, PCR flip-flops propagation delays may be sufficient to provide said required pulse duration. Therefore for such technologies the DPCR is not needed, since an output of the next PCR bit can be connected directly to an inverter which prevents delay line output from passing through the gate connected to the clock input of the current PCR bit.","The outputs of the delay line gates which the fclock is propagated through, keep capturing 0s in the PCR for as long as the second signal frame remains low.","When a rising edge of the frappears (see also FIG. ):\n\n","Therefore:\n\n","A bit PCR(\u22121) is used in the PCR for capturing present value of the second signal frame fr, by the falling edge of the first signal clock f.","First frame decoder (FFD) provides binary encoded position of the frrising edge versus the last proceeding frising which has been captured on the left side of the PCR as the frdetection bit of the second line rising edge.","Cycle length decoder (CLD) provides binary encoded lengths of the fwave, which is calculated as a number of gate delays between: the frdetection bit of the first line rising edge, and the frdetection bit of the second line rising edge.","Since non inverting gates must be used in the delay line, the resolution is reduced compared with the Config.1, but still is significantly better than with conventional methods.","Detector Timing Circuit for the Config.5 has differences versus the Config.1, which are shown in the FIG.  and are explained below.","PCR(\u22121) is used to activate the HCR_FF which enables PRESTOP_FF activation, if an frrise occurred during f=high condition.","PCR(0) directly enables PRESTOP_FF activation, , if an frrise occurred during f=low condition.","Phase processing method for the Config.5 is explained below.","FFD\/CLD is a normalized value of a phase error between an frrise versus the last frise, as it has been read by the PPU from the FFD and the CLD decoders.","The content of the FFD divided by the CLD shall be added to the present phase measurement.","A fraction of the fcycle which shall be added to the next measurement amounts to:\n\n1\u2212FFD\/CLD=(CLD\u2212FFD)\/CLD. \n","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+FFD\/CLD\u2212N, REM_PHA=(CLD\u2212FFD)\/CLD. \n","6. HRPD Config.6 based on frame captured by ring oscillator.","For the approximate phase measurements, the HRPD Config.6 uses the same circuits as the HRPD Config.5.","High resolution extension for the Config.6 has differences versus the Config.5, which are shown in the FIG.  and FIG.  and are explained below.","Instead of the open ended delay line, the outputs of the ring oscillator which is phase locked to a stable clock, are used to capture a rise of the frsignal in the PCR.","Since the number of ring oscillator gates and the fclock period are known, a calibration of the gates propagation delays is not needed for the HRPD Config.6, and the CLD is not needed as well.","Since the calibration is not needed, and the oscillator gates delays cover all the fclock period; the PCR can be much shorter, as it needs to cover only one fclock period.","The Config.6 uses PLLxL Freq. Multiplier to provide the ring oscillator which is phase locked to a stable reference clock. Therefore ring oscillator gates are the serially connected gates which the fis propagated through, and are used to capture a rise of the second signal frame. The ring oscillator gates must use lower power supply in order to allow their delays controllability in the PLL configuration.","Therefore, resolution is slightly reduced compared with the Config.5, but still is significantly better than with conventional methods.","The detector timing circuit is the same for the Config.6 as for the Config.5.","The timing analysis is very similar for the Config.6 as for the Config.5. The only difference is that the PCR content is much shorter, since only one fclock period needs to be captured.","The only difference between the phase processing method of the Config.6 versus the Config.5 is: that since ring gates number (RGN) is always known, the Config.6 does not need to use the cycle lengths decoder and the CLD can be replaced by the RGN in the equations calculating the MEA_PHA and the REM_PHA.","Therefore:\n\nMEA_PHA=REM_PHA+CNTR\u22121+FFD\/RGN\u2212N REM_PHA=(RGN\u2212FFD)\/RGN \n"],"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","BRIEF SUMMARY OF THE INVENTION","GENERAL DESCRIPTION OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["HRPD implementation and preferred embodiments of the invention will now be described with reference to attached drawings in which:",{"@attributes":{"id":"P-00036","num":"00036"},"figref":"FIG. 1"},{"@attributes":{"id":"P-00037","num":"00037"},"figref":"FIG. 2"},{"@attributes":{"id":"P-00038","num":"00038"},"figref":"FIG. 3"},{"@attributes":{"id":"P-00039","num":"00039"},"figref":"FIG. 4"},{"@attributes":{"id":"P-00040","num":"00040"},"figref":"FIG. 5"},{"@attributes":{"id":"P-00041","num":"00041"},"figref":"FIG. 6"},{"@attributes":{"id":"P-00042","num":"00042"},"figref":"FIG. 7"},{"@attributes":{"id":"P-00043","num":"00043"},"figref":"FIG. 8"},{"@attributes":{"id":"P-00044","num":"00044"},"figref":"FIG. 9"},{"@attributes":{"id":"P-00045","num":"00045"},"figref":"FIG. 10"},{"@attributes":{"id":"P-00046","num":"00046"},"figref":"FIG. 11"},{"@attributes":{"id":"P-00047","num":"00047"},"figref":"FIG. 12"},{"@attributes":{"id":"P-00048","num":"00048"},"figref":"FIG. 13"},{"@attributes":{"id":"P-00049","num":"00049"},"figref":"FIG. 14"}]},"DETDESC":[{},{}]}
