---
title: Method for mounting network attached storage NAS device, and digital media player DMP
abstract: A method for mounting a network attached storage (NAS) device, and a digital media player are provided, which includes broadcasting a discovery message for searching a network attached storage NAS device; parsing a configuration response message, which is sent by the NAS device according to the discovery message, and obtaining configuration information of the NAS device; and mounting the NAS device according to the configuration information. According to the present invention, the automatic mounting of the NAS device is realized by discovering and obtaining the configuration information of the NAS device in the network, and personally-recorded-video-contents or downloaded media contents, where the personally-recorded-video-contents or the downloaded media contents are stored in the NAS device, can be played according to the selection of a user in the case that local data storage is not supported, so as to enable a digital home user to obtain a better user experience.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09118497&OS=09118497&RS=09118497
owner: HUAWEI TECHNOLOGIES CO., LTD.
number: 09118497
owner_city: Shenzhen
owner_country: CN
publication_date: 20120529
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE EMBODIMENTS"],"p":["This application is a continuation of International Application No. PCT\/CN2011\/074681, filed on May 26, 2011, which is hereby incorporated by reference in their entireties.","The present invention relates to a method for mounting a network attached storage (NAS) device, and a digital media player (DMP), and belongs to the field of network communications technologies.","Multimedia-related entertainment services are the most important needs of the digital home, for example, services such as download of Internet videos and music are widely used in a common home. The DLNA (Digital Living Network Alliance, digital living network alliance) proposes setting a DMS (Digital Media Server, digital media server) device in a home according to an interconnection standard for sharing various media data in the home, and provides media sharing service capability to a DMP (Digital Media Player, digital media player) device through a home network, and the DMP device may upload corresponding media contents to the DMS, or download corresponding media contents from the DMS, or play corresponding media contents in the DMS. In a scenario defined by the DLNA, the used protocol is UPnP (Universal Plug and Play, universal plug and play), and the UPnP protocol solves mutual discovery of devices, content directory browse, connection management, and audio and video transmission management.","The IPTV (Internet Protocol Television, internet protocol television) is also common in a digital home application solution, and recording and download of contents in an IPTV network is also a main way for obtaining entertainment multimedia contents in the digital home. Its an application scenario is a PVR (Personal Video Recorder, personal video recorder) type STB (Set-top Box, set-top box) records or downloads the IPTV contents locally, which may be played again locally if needed. When the PVR type STB is combined with the DMS, devices such as a STB, a computer, and a hand-held terminal that are in other rooms can share the video contents in the PVR type STB. That is to say, in the prior art, local recording is performed, and local playing that is not based on the capability of the IPTV system needs to realized, so only a STB having a hard disk can support the local recording or download. Moreover, due to the main function of the STB is to play multimedia contents, the function requirement of content sharing can be meet when the STB is in working. However, the STB is not a professional storage device, and cannot meet the requirement of content sharing of other devices in the home network anytime and anywhere.","Embodiments of the present invention provide a method for mounting a network attached storage (NAS) device, and a digital media player, so as to realize automatic mounting of the NAS device, realize a personal video recording or download service in the case that local data storage is not supported, and improve experience of a digital home user.","An embodiment of the present invention provides a method for mounting a network attached storage NAS device, where the method includes:\n\n","An embodiment of the present invention provides a digital media player DMP, where the DMP includes:\n\n","An embodiment of the present invention provides a method for mounting a network attached storage NAS device, where the method includes:\n\n","An embodiment of the present invention provides a digital media player DMP, where the DMP includes:\n\n","It can be seen from the foregoing technical solutions according to the embodiments of the present invention that the automatic mounting of the NAS device is realized by discovering and parsing the configuration information of the NAS device in the network, and personally-recorded video contents or downloaded media contents, where the personally-recorded video contents or the downloaded media contents are stored in the NAS device, can be played according to the selection of a user in the case that local data storage is not supported, so as to enable a digital home user to obtain a better user experience.","The technical solutions according to the embodiments of the present invention are clearly and completely described in the following with reference to the accompanying drawings in the embodiments of the present invention. Obviously, the embodiments to be described are only part of rather than all of the embodiments of the present invention. All other embodiments obtained by persons of ordinary skill in the art based on the embodiments of the present invention without creative efforts shall fall within the protection scope of the present invention.","An embodiment of the present invention provides a method for mounting a network attached storage NAS device, where the method includes broadcasting, by a digital media player DMP, in a network a discovery message for searching a network attached storage NAS device; parsing, by the DMP, a configuration response message sent by the NAS device according to the discovery message, and obtaining configuration information of the NAS device; and mounting, by the DMP, the NAS device according to the configuration information. By using the method, an existing DMP that does not support file storage automatically mounts the NAS device through a network file system, so as to realize personal video recording or download application in an IPTV. In this embodiment, the corresponding NAS device may be a storage device that exists in the network and is used by other devices, and generally provides a standard network file service (for example, samba, NFS and so on). The corresponding DMP device may be a device that is connected to a home gateway and provides media content sharing to a home network, and in this embodiment, a STB that does not support a PVR is used as the DMP device for description. The embodiment is specifically described below with reference to an accompanying drawing in the specification. As shown in , the method may include:","Step : A DMP broadcasts, in a network, a discovery message for searching a network attached storage NAS device.","Specifically, as shown in , when an STB, that does not support a PVR and is used as a DMP, is powered on for connecting to a network, a NAS device in the network is actively searched at first by performing step S. The searching method may be broadcasting a discovery message in the network, a format of the discovery message is as shown in the following table:",{"@attributes":{"id":"p-0025","num":"0036"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"center"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Header","Identification Code A","IP","SN","Checksum"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}}}},"Identification Code A in the message is an identification of the message, which indicates that the message is a discovery message, and is sent by the STB; IP indicates an IP address of the STB that sends the message; SN indicates a serial number of the STB that sends the message; and Checksum indicates a HASH value of all information excluding a header field and before this field, and is used to prevent forging of the message.","Step : The DMP parses a configuration response message sent by the NAS device according to the discovery message, and obtains configuration information of the NAS device.","Specifically, after receiving the discovery message by an online NAS device, as shown in , the online NAS device returns a configuration response message to the STB that sends the discovery message, by performing step S, the configuration response message may be a message sent to a 54330 port of the STB through UDP unicast, and a format of the configuration response message is as shown in the following table:",{"@attributes":{"id":"p-0029","num":"0040"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["UDP Header","Identification Code C","SN","Checksum"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Para Code1","Para Len","Para","Para Code2","Para Len","Para Value"]},{"entry":[{},{},"Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}}},"Identification Code C in the message is an identification of the message, which indicates that the message is a response message, and is sent by the NAS; SN indicates a serial number of the NAS device that sends the message; Checksum indicates a HASH value of all information excluding a header field before this field, and is used to prevent forging of the message; Para Code1 represents a following parameter name, for example, a URL for mounting, and a URL for configuring NAS; Para Len indicates a length of the parameter; and Para Value indicates a value of the parameter, which is transferred by means of ASCII codes.","After receiving the configuration response message sent by the NAS device, as shown in , the STB parses the configuration response message by performing step S, and obtains configuration information of the NAS device, the configuration information carries the serial number of the NAS device, a URL address for mounting, and a URL address for configuring.","Step : The DMP mounts the NAS device according to the configuration information.","Specifically, after obtaining the configuration information, as shown in , the STB mounts the NAS device by performing step S. Taking an example that a mounting manner is a NFS: The NAS device returns a URL address for mounting which is similar to \u201cNFS:\/\/<host>:<port><url-path>\u201d, where if a default value of port is 2049, the value of port may not be carried; when mounting the NAS device, the STB needs to attach the serial number of the NAS at the back of the URL, and the corresponding serial number must be completely consistent with that filled in during broadcasting. Therefore, a complete URL address after mounting is NFS:\/\/<host>:<port><url-path>\/<SN>.","After the mounting is completed, the STB continues to configure the NAS device through a URL address, because the NAS device returns the URL address for configuring that is similar to \u201chttp:\/\/<host>:<port><url-path>\u201d, where if a default value of port is 80, the value of the port may not be carried, and the parameter is used to open personally-recorded-video-contents or downloaded contents, where the personally-recorded video contents or the downloaded contents are shared on the NAS device, through browser jump when a user inputs a command \u201cconfigure NAS device\u201d in a configuration page.","An embodiment of the present invention further provides another method for mounting a NAS device, as shown in , where the method includes:","Step : A DMP monitors whether a broadcast message sent by a network attached storage NAS device exists in a network, and sends a response message to the NAS device if the broadcast message sent by the NAS device in the network is received.","Specifically, in this embodiment, the corresponding NAS device may be a storage device which exists in the network and is used by other devices, and generally provides a standard network file service (for example, samba, NFS and so on). The corresponding DMP device may be a device that is connected to a home gateway and provides media content sharing to a home network, and in this embodiment, a STB that does not support a PVR is used as the DMP device for description.","As shown in , if the STB, which is used as a DMP and does not support the PVR, does not find an online NAS device after being powered on and connected to a network, the STB keeps monitoring a network state. When a NAS device is online in the network, a message is broadcasted in the network by performing step Q, where a format of the broadcast message is as shown in the following table:",{"@attributes":{"id":"p-0039","num":"0050"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"center"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Header","Identification Code B","IP","SN","Checksum"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}}}},"Identification Code B in the message is an identification of the message, which indicates that the message is a broadcast message, and is sent by the NAS device; IP indicates an IP address of the NAS device that sends the message; SN indicates a serial number of the NAS device that sends the message; and Checksum indicates a HASH value of all information excluding a header field before the header field, and is used to prevent forging of the message.","After receiving the broadcast message, as shown in , the STB sends a discovery response message to the NAS device that sends the broadcast message through step Q, where a format of the discovery response message is the same as that of a broadcasted discovery message for actively searching the NAS device in the network.","Step : The DMP parses a configuration response message sent by the NAS device according to the discovery message, and obtains configuration information of the NAS device.","Specifically, after receiving the response message sent by the STB, as shown in , the NAS device returns a configuration response message to the STB that sends the discovery message by performing step Q, where the configuration response message may be a message sent to a 54330 port of the STB through UDP unicast, and a format of the configuration response message is as shown in the following table:",{"@attributes":{"id":"p-0044","num":"0055"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"56pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["UDP Header","Identification Code C","SN","Checksum"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Para Code1","Para Len","Para","Para Code2","Para Len","Para Value"]},{"entry":[{},{},"Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}}},"Identification Code C in the message is an identification of the message, which indicates that the message is a response message, and is sent by the NAS; SN indicates the serial number of the NAS device that sends the message; Checksum indicates the HASH value of all the information excluding a header before this field, and is used to prevent forging of the message; Para Code1 represents a following parameter name, for example, a URL for mounting, a URL for configuring by the NAS; Para Len indicates a length of the parameter; and Para Value indicates a value of the parameter, which is transferred by means of ASCII codes.","After receiving the configuration response message sent by the NAS device, as shown in , the STB parses the configuration response message by performing step Q, and obtains configuration information of the NAS device, where the configuration information carries the serial number of the NAS device, a URL for mounting, a URL for configuring by the NAS.","Step : The DMP mounts the NAS device according to the configuration information.","Specifically, after obtaining the configuration information, as shown in , the STB mounts the NAS device by performing step Q. Taking an example that a mounting manner is NFS: The NAS device returns a URL address for mounting that is similar to \u201cNFS:\/\/<host>:<port><url-path>\u201d, where if a default value of port is 2049, the value of the port may not be carried; when mounting the NAS device, the STB needs to attach the serial number of the NAS at the back of the URL, and the corresponding serial number must be completely consistent with that filled in during broadcasting. Therefore, a complete URL address after mounting is NFS:\/\/<host>:<port><url-path>\/<SN>.","After the mounting is completed, the STB continues to configure the NAS device through a URL address, because the NAS device returns the URL address for configuring that is similar to \u201chttp:\/\/<host>:<port><url-path>\u201d, where if a default value of port is 80, the value of the port may not be carried, and the parameter is used to open personally-recorded-video-contents or downloaded contents, where the personally-recorded video contents or the downloaded contents are shared on the NAS device, through browser jump when a user inputs a command \u201cconfigure NAS device\u201d in a configuration page.","After the STB that does not support the PVR completes the mounting of the NAS device, reading of data such as images, audios, and videos that are stored in the NAS device can be realized.  is a schematic flow chart about controlling a STB  to browse and play contents on a NAS device  by a remote controller, so as to realize the sharing of personally-recorded-video-contents in the IPTV by the NAS device . First, when the STB  plays a recorded program in the NAS device , the STB , as defined by the DLNA, provides a UI (interface) for a user to browse contents. After receiving a remote controller event from the user, the UI invokes an API (Application Programming Interface, application programming interface) provided by the STB , triggers the STB  to retrieve a content directory in the NAS device  for browsing or playing. In , in a corresponding scenario, the NAS device  is a DMS device, which provides UPnP sharing of recorded contents to the STB ; after the STB  and the NAS device  are mutually discovered through UPnP, a file list is displayed on the UI of the STB  by \u201ccontent directory browse\u201d; and when playing is started, connection is established between the STB  and the NAS device  by \u201cconnection management\u201d, and playing is controlled by \u201caudio and video transmission management\u201d, so that out of band (not limited by the DLNA) transmission of the personally-recorded-video-contents is performed through a transmission manner of \u201cconnection management\u201d negotiation.","In a specific application scenario, for example, a personal-video-recorded-content sharing system based on a NAS device shown in , a corresponding module for mounting the NAS device is set in a STB . By setting a storage address to be the corresponding NAS device address, even if the STB  does not have a local storage function, a personal video recording or download service can also be provided to a user. A corresponding module for playing the media content is set in a STB  or a PC, which has the functions of discovering a device in a system and playing content. During playing the media content, a subject for triggering the obtaining of IPTV contents is still the STB ; however, the STB  does not need a local hard disk any longer, but mounts the NAS device through NFS or samba, and writes the corresponding media content in the NAS device. When an interconnection solution of devices in the system is a solution defined by the DLNA, other devices such as the STB  or the PC may access personally-recorded-video-contents or downloaded contents, where the personally-recorded-video-contents or the downloaded contents are stored in the NAS device.","By using the technical solution according to this embodiment, the automatic mounting of the NAS device is realized by discovering and parsing the configuration information of the NAS device in the network, and the personally-recorded-video-contents or the downloaded media contents, where the personally-recorded video contents or the downloaded contents are stored in the NAS device, can be played according to the selection of a user in the case that local data storage is not supported, so as to enable a digital home user to obtain a better user experience.","An embodiment of the present invention further provides a digital media player, as shown in , where the digital media player may specifically include a device searching unit , a first message parsing unit , and a first device mounting unit . The device searching unit  is configured to broadcast, in a network, a discovery message for searing a NAS device; the first message parsing unit  is configured to parse a configuration response message sent by the NAS device according to the discovery message, and obtain configuration information of the NAS device; and the first device mounting unit  is configured to mount the NAS device according to the configuration information.","Optionally, in the device searching unit , the discovery message carries an IP address of the DMP, a serial number of the DMP, and an identification of the discovery message.","Optionally, in the first message parsing unit , the configuration information carries a serial number used to identify and mount the NAS device, a URL address for mounting, and a URL address for configuring.","By using the technical solution according to this embodiment, the automatic mounting of the NAS device is realized by discovering and parsing the configuration information of the NAS device in the network, and personally-recorded-video-contents or downloaded media contents, where the personally-recorded-video-contents or the downloaded media contents are stored in the NAS device, can be played according to the selection of a user in the case that local data storage is not supported, so as to enable a digital home user to obtain a better user experience.","An embodiment of the present invention further provides a digital media player. As shown in , the digital media player includes a device monitoring unit , a second message parsing unit , and a second device mounting unit . The device monitoring unit  is configured to monitor whether a broadcast message sent by a network attached storage NAS device exists in a network, and send a response message to the NAS device if the broadcast message sent by the NAS device in the network is received; the second message parsing unit  is configured to parse a configuration response message sent by the NAS device according to the discovery message, and obtain configuration information of the NAS device; and the second device mounting unit  is configured to mount the NAS device according to the configuration information.","Optionally, in the device monitoring unit , the discovery message carries an IP address of the DMP, a serial number of the DMP, and an identification of the discovery message.","Optionally, in the second message parsing unit , the configuration information carries a serial number used to identify and mount the NAS device, a URL address for mounting, and a URL address for mounting.","By using the technical solution according to this embodiment, the automatic mounting of the NAS device is realized by discovering and parsing the configuration information of the NAS device in the network, and personally-recorded-video-contents or downloaded media contents, where the personally-recorded video contents or the downloaded media contents are stored in the NAS device, can be played according to the selection of a user in the case that local data storage is not supported, so as to enable a digital home user to obtain a better user experience.","Implementation manners of processing functions of units included in the digital media player have been described in the foregoing method embodiments, and are not repeatedly described here.","It should be noted that in the foregoing module embodiments, the included units are divided only according to logical functions, but the present invention is not limited to the division, as long as corresponding functions can be realized; in addition, specific names of the function units are provided merely for the purpose of distinguishing the units from one another, but not intended to limit the scope of the present invention.","The foregoing descriptions are merely exemplary specific embodiments of the present invention, but not intended to limit the scope of the present invention. All variations or replacements that can be easily thought of by those skilled in the art within the technical scope of the present invention should fall within the protection scope of the present invention. Therefore, the protection scope of the present invention is defined by the protection scope of the claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["To illustrate the technical solutions according to the embodiments of the present invention more clearly, accompanying drawings required for describing the embodiments are introduced briefly in the following. Apparently, the accompanying drawings in the following description are only some embodiments of the present invention, and persons of ordinary skill in the art may further obtain other drawings according to these accompanying drawings without creative efforts.",{"@attributes":{"id":"p-0013","num":"0024"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0025"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0026"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0016","num":"0027"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0017","num":"0028"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0018","num":"0029"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0019","num":"0030"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0020","num":"0031"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
