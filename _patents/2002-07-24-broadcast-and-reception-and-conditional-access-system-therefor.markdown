---
title: Broadcast and reception, and conditional access system therefor
abstract: A digital satellite television system has a plurality of set-top-boxes associated with a plurality of end users' television receivers, a modem and a decoder housed in each STB, a Subscriber Authorization System (SAS) incorporating or having associated therewith a plurality of communication servers, means included in the SAS for generating Electronic Managements Messages (EMM), a back channel interconnecting each of the STBs individually with the SAS, means included in the SAS and each STB so that the necessary information required to inject a relevant EMM into the system is supplied directly to the relevant communication server included in or associated with the SAS to authorize the release of the said EMM and/or means to connect the modem to the back channel and means whereby an EMM is transmissible to the decoder directly from a relevant communication server included in or associated with the SAS. Further important features are also disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07644429&OS=07644429&RS=07644429
owner: Nagra Thomson Licensing
number: 07644429
owner_city: Boulogne-Billancourt
owner_country: FR
publication_date: 20020724
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a continuation of application Ser. No. 10\/007,662, filed Dec. 10, 2001 now abandoned, which is a continuation of application Ser. No. 09\/780,625, filed Feb. 12, 2001 now abandoned, which is a continuation of application Ser. No. 09\/571,011, filed May 15, 2000 now abandoned, which is a continuation of application Ser. No. 09\/400,314, filed Sep. 21, 1999 now abandoned, which is a continuation of PCT\/EP97\/02108, filed Apr. 25, 1997.","The present invention relates to a broadcast and reception system, in particular to a mass-market digital interactive satellite television system, and to a conditional access system therefor.","In particular, but not exclusively, the invention relates to a mass-market broadcast system having some or all of the following preferred features:\u2014\n\n","More particularly the present invention relates to so-called pay television (or radio) where a user\/viewer selects a programme\/film\/game to be viewed for which payment is to be made, this being referred to as a pay-per-view (PPV) or in the case of data to be downloaded a so-called pay-per-file (PPF).","With such known PPV or PPF systems a significant amount of time is required to be spent by the user\/viewer in order to carry out the actions necessary to actually access the product being selected.","For example, in one known system the sequence of steps which have to be carried out are as follows:\u2014\n\n","In another known system the human operator is replaced by an automatic voice server so that when the user telephones the SMS he\/she hears a voice activated recording to which the user conveys the same information as I) above.","This second arrangement reduces the delay inherent in the first described arrangement which can be more easily overloaded when large numbers of users are wishing to order a product at the same time.","However, even with this second arrangement the user is involved in inputting significant information in the form of lengthy serial numbers which operation provides plenty of scope for error as well as being time consuming.","The third known arrangement involves the user making use of existing screen based systems such as MINITEL in France and PRESTEL in the United Kingdom, which systems replace the voice activated server referred to above in connection with the second arrangement. The MINITEL and PRESTEL systems themselves incorporate a modem at the consumer end.","In all these known arrangements the user is involved in the expenditure of significant time and effort in inputting all the information necessary to enable the system to in effect authorize the transmission of the chosen product to the user's television set.","In the case of a satellite television system there is a further delay involved in the user actually receiving the product selected.","In PPV and PPF systems the key element in controlling the user's access to products are so-called Entitlement Management Messages (EMM) which have to be injected into the system in order to give the user product access. More particularly the EMMs are the mechanism by which the encrypted data representative of a product is decrypted for a particular individual user.","In known satellite television systems the EMMs are transmitted to the user's televisions via the satellite link at regular intervals in the MPEG-2 data stream. Thus in the case of a particular user's EMM there can be a significant delay of perhaps several minutes before the user's next EMM transmission arrives at that user's television set.","This transmission delay is in addition to the delay referred to earlier which is inherent in the user having to manually input certain data into the system. The cumulative effect of these two delays is that it may take perhaps typically five minutes for a user to be able to gain access to the selected product.","The present invention is concerned with overcoming this problem.","In a first aspect, the present invention provides a conditional access system comprising:\n\n","Preferably, the message is an entitlement message for transmission (for example by broadcast) to the receiving means, said generating means being adapted to generate entitlement messages in response to data received from said receiving means.","The generating means may be arranged to transmit a message as a packet of digital data to said receiving means either via said communications server or via a satellite transponder.","The receiving means may be connectable to said communications server via a modem and telephone link.","In a related aspect, the present invention provides a conditional access system for affording conditional access to subscribers, comprising:\n\n","The system may further comprise a receiver\/decoder for the subscriber, the receiver\/decoder being connectable to said communications server, and hence to said subscriber authorization system, via a modem and telephone link.","In a second aspect, the present invention provides a broadcast and reception system including a conditional access system as described above.","In a third aspect, the present invention provides a broadcast and reception system comprising:\n\n","The dedicated connection would typically be a hard-wired connection and\/or a modemmed connection, with the possibility of the connection been made via a cellular telephone system. In other words, the dedicated connection is capable of forming a channel of communication (from point to point). This is in contrast to broadcasting of information through the air or ambient medium. The connecting means would typically be a modem at the receiving means.","Hence, in a closely related aspect, the present invention provides a broadcast and reception system comprising:\n\n","The above features can afford the advantage of providing the user the necessary viewing authorization (via the EMM) more quickly than has hitherto been possible, partly because, since the SAS typically uses a smaller amount of computer code than the SMS, the SAS can operate more efficiently (and in real time), partly because the SAS can itself, directly, generate the requisite EMM, and partly because the EMM can be passed to the user or subscriber via a dedicated (typically modemmed) link.","Preferably, the generating means is connected to said modem via a communications server which is preferably included in or associated with said generating means.","The receiving means may be further adapted to receive said entitlement messages via a satellite transponder.","The receiving means may be a receiver\/decoder comprising means for receiving a compressed MPEG-type signal, means for decoding the received signal to provide a television signal and means for supplying the television signal to a television.","Preferably, the receiving means is adapted to communicate with said generating means via said modem and connecting means. The receiving means may comprise means for reading a smartcard insertable thereinto by an end user, the smartcard having stored therein data to initiate automatically the transmission of a message from said receiving means to said generating means upon insertion of the smartcard by the end user.","In addition, the system may further comprise a voice link to enable the end user of the broadcast and reception system to communicate with the generating means.","It will be understood from the above that the present invention provides two arrangements by which the time it takes for an end user to access a desired product is reduced. Preferably both arrangements are employed to achieve the maximum time saving but either arrangement can be used individually.","According to a further aspect of the present invention, there is provided a broadcast and reception system, comprising, at the broadcast end:\n\n","By providing that the broadcast system can request the receiver to call it back, the possibility is afforded of the broadcast system obtaining information from the receiver about the state of the receiver.","Preferably, the means for calling back the broadcast system includes a modem connectable to a telephone system. By using a modemmed back channel, a simple way of putting the invention into effect can be provided.","Preferably also, the means for calling back the broadcast system is arranged to transfer to the broadcast system information concerning the receiver. This information might include the number of remaining tokens, the number of pre-booked sessions, and so on.","Preferably, the broadcast system includes means for storing the information, so that it can be processed at a later time, as desired.","Preferably, the broadcast means is arranged to broadcast a callback request which includes a command that the callback be made at a given time, and the means for calling back the broadcast system is arranged to respond to said command. By arranging for the callback to be later than the actual request, greater flexibility can be imparted to the system.","The broadcasting means may be arranged to broadcast as the callback request one or more Entitlement Messages for broadcast.","Preferably, the broadcast system includes means for generating a check message (such as a random number) and passing this to the receiver, the receiver includes means for encrypting the check message and passing this to the broadcast system, and the broadcast system further includes means for decrypting the check message received from the receiver and comparing this with the original check message. In this way it can be checked whether the receiver is genuine.","Any of the above features may be combined together in any appropriate combination. They may also be provided, as appropriate, in method aspects.","An overview of a digital television broadcast and reception system  according to the present invention is shown in . The invention includes a mostly conventional digital television system  which uses the known MPEG-2 compression system to transmit compressed digital signals. In more detail, MPEG-2 compressor  in a broadcast centre receives a digital signal stream (typically a stream of video signals). The compressor  is connected to a multiplexer and scrambler  by linkage . The multiplexer  receives a plurality of further input signals, assembles one or more transport streams and transmits compressed digital signals to a transmitter  of the broadcast centre via linkage , which can of course take a wide variety of forms including telecom links. The transmitter  transmits electromagnetic signals via uplink  towards a satellite transponder , where they are electronically processed and broadcast via notional downlink  to earth receiver , conventionally in the form of a dish owned or rented by the end user. The signals received by receiver  are transmitted to an integrated receiver\/decoder  owned or rented by the end user and connected to the end user's television set . The receiver\/decoder  decodes the compressed MPEG-2 signal into a television signal for the television set .","A conditional access system  is connected to the multiplexer  and the receiver\/decoder , and is located partly in the broadcast centre and partly in the decoder. It enables the end user to access digital television broadcasts from one or more broadcast suppliers. A smartcard, capable of decrypting messages relating to commercial offers (that is, one or several television programmes sold by the broadcast supplier), can be inserted into the receiver\/decoder . Using the decoder  and smartcard, the end user may purchase events in either a subscription mode or a pay-per-view mode.","An interactive system , also connected to the multiplexer  and the receiver\/decoder  and again located partly in the broadcast centre and partly in the decoder, enables the end user to interact with various applications via a modemmed back channel .","The conditional access system  is now described in more detail.","With reference to , in overview the conditional access system  includes a Subscriber Authorization System (SAS) . The SAS  is connected to one or more Subscriber Management Systems (SMS) , one SMS for each broadcast supplier, by a respective TCP-IP linkage  (although other types of linkage could alternatively be used). Alternatively, one SMS could be shared between two broadcast suppliers, or one supplier could use two SMSs, and so on.","First encrypting units in the form of ciphering units  utilising \u201cmother\u201d smartcards  are connected to the SAS by linkage . Second encrypting units again in the form of ciphering units  utilising mother smartcards  are connected to the multiplexer  by linkage . The receiver\/decoder  receives a \u201cdaughter\u201d smartcard . It is connected directly to the SAS  by Communications Servers  via the modemmed back channel . The SAS sends amongst other things subscription rights to the daughter smartcard on request.","The smartcards contain the secrets of one or more commercial operators. The \u201cmother\u201d smartcard encrypts different kinds of messages and the \u201cdaughter\u201d smartcards decrypt the messages, if they have the rights to do so.","The first and second ciphering units  and  comprise a rack, an electronic VME card with software stored on an EEPROM, up to 20 electronic cards and one smartcard  and  respectively, for each electronic card, one (card ) for encrypting the ECMs and one (card ) for encrypting the EMMs.","The operation of the conditional access system  of the digital television system will now be described in more detail with reference to the various components of the television system  and the conditional access system .","Multiplexer and Scrambler","With reference to , in the broadcast centre, the digital video signal is first compressed (or bit rate reduced), using the MPEG-2 compressor . This compressed signal is then transmitted to the multiplexer and scrambler  via the linkage  in order to be multiplexed with other data, such as other compressed data.","The scrambler generates a control word used in the scrambling process and included in the MPEG-2 stream in the multiplexer . The control word is generated internally and enables the end user's integrated receiver\/decoder  to descramble the programme.","Access criteria, indicating how the programme is commercialised, are also added to the MPEG-2 stream. The programme may be commercialised in either one of a number of \u201csubscription\u201d modes and\/or one of a number of \u201cPay Per View\u201d (PPV) modes or events. In the subscription mode, the end user subscribes to one or more commercial offers, or \u201cbouquets\u201d, thus getting the rights to watch every channel inside those bouquets. In the preferred embodiment, up to 960 commercial offers may be selected from a bouquet of channels. In the Pay Per View mode, the end user is provided with the capability to purchase events as he wishes. This can be achieved by either pre-booking the event in advance (\u201cpre-book mode\u201d), or by purchasing the event as soon as it is broadcast (\u201cimpulse mode\u201d). In the preferred embodiment, all users are subscribers, whether or not they watch in subscription or PPV mode, but of course PPV viewers need not necessarily be subscribers.","Both the control word and the access criteria are used to build an Entitlement Control Message (ECM); this is a message sent in relation with one scrambled program; the message contains a control word (which allows for the descrambling of the program) and the access criteria of the broadcast program. The access criteria and control word are transmitted to the second encrypting unit  via the linkage . In this unit, an ECM is generated, encrypted and transmitted on to the multiplexer and scrambler .","Each service broadcast by a broadcast supplier in a data stream comprises a number of distinct components; for example a television programme includes a video component, an audio component, a sub-title component and so on. Each of these components of a service is individually scrambled and encrypted for subsequent broadcast to the transponder . In respect of each scrambled component of the service, a separate ECM is required.","Programme Transmission","The multiplexer  receives electrical signals comprising encrypted EMMs from the SAS , encrypted ECMs from the second encrypting unit  and compressed programmes from the compressor . The multiplexer  scrambles the programmes and transmits the scrambled programmes, the encrypted EMMs and the encrypted ECMs as electric signals to a transmitter  of the broadcast centre via linkage . The transmitter  transmits electromagnetic signals towards the satellite transponder  via uplink .","Programme Reception","The satellite transponder  receives and processes the electromagnetic signals transmitted by the transmitter  and transmits the signals on to the earth receiver , conventionally in the form of a dish owned or rented by the end user, via downlink . The signals received by receiver  are transmitted to the integrated receiver\/decoder  owned or rented by the end user and connected to the end user's television set . The receiver\/decoder  demultiplexes the signals to obtain scrambled programmes with encrypted EMMs and encrypted ECMs.","If the programme is not scrambled, that is, no ECM has been transmitted with the MPEG-2 stream, the receiver\/decoder  decompresses the data and transforms the signal into a video signal for transmission to television set .","If the programme is scrambled, the receiver\/decoder  extracts the corresponding ECM from the MPEG-2 stream and passes the ECM to the \u201cdaughter\u201d smartcard  of the end user. This slots into a housing in the receiver\/decoder . The daughter smartcard  controls whether the end user has the right to decrypt the ECM and to access the programme. If not, a negative status is passed to the receiver\/decoder  to indicate that the programme cannot be descrambled. If the end user does have the rights, the ECM is decrypted and the control word extracted. The decoder  can then descramble the programme using this control word. The MPEG-2 stream is decompressed and translated into a video signal for onward transmission to television set .","Subscriber Management System (SMS)","A Subscriber Management System (SMS)  includes a database  which manages, amongst others, all of the end user files, commercial offers (such as tariffs and promotions), subscriptions, PPV details, and data regarding end user consumption and authorization. The SMS may be physically remote from the SAS.","Each SMS  transmits messages to the SAS  via respective linkage  which imply modifications to or creations of Entitlement Management Messages (EMMs) to be transmitted to end users.","The SMS  also transmits messages to the SAS  which imply no modifications or creations of EMMs but imply only a change in an end user's state (relating to the authorization granted to the end user when ordering products or to the amount that the end user will be charged).","As described later, the SAS  sends messages (typically requesting information such as call-back information or billing information) to the SMS , so that it will be apparent that communication between the two is two-way.","Entitlement Management Messages (EMMs)","The EMM is a message dedicated to an individual end user (subscriber), or a group of end users, only (in contrast with an ECM, which is dedicated to one scrambled programme only or a set of scrambled programmes if part of the same commercial offer). Each group may contain a given number of end users. This organisation as a group aims at optimising the bandwidth; that is, access to one group can permit the reaching of a great number of end users.","Various specific types of EMM are used in putting the present invention into practice. Individual EMMs are dedicated to individual subscribers, and are typically used in the provision of Pay Per View services; these contain the group identifier and the position of the subscriber in that group. So-called \u201cGroup\u201d subscription EMMs are dedicated to groups of, say, 256 individual users, and are typically used in the administration of some subscription services. This EMM has a group identifier and a subscribers' group bitmap. Audience EMMs are dedicated to entire audiences, and might for example be used by a particular operator to provide certain free services. An \u201caudience\u201d is the totality of subscribers having smartcards which bear the same Operator Identifier (OPI). Finally, a \u201cunique\u201d EMM is addressed to the unique identifier of the smartcard.","The structure of a typical EMM is now described with reference to . Basically, the EMM, which is implemented as a series of digital data bits, comprises a header , the EMM proper , and a signature . The header  in turn comprises a type identifier  to identify whether the type is individual, group, audience or some other type, a length identifier  which gives the length of the EMM, an optional address  for the EMM, an operator identifier  and a key identifier . The EMM proper  of course varies greatly according to its type. Finally, the signature , which is typically of 8 bytes long, provides a number of checks against corruption of the remaining data in the EMM.","Subscriber Authorization System (SAS)","The messages generated by the SMS  are passed via linkage  to the Subscriber Authorization System (SAS) , which in turn generates messages acknowledging receipt of the messages generated the SMS  and passes these acknowledgements to the SMS .","As shown in , at the hardware level the SAS comprises in known fashion a mainframe computer  (in the preferred embodiment a DEC machine) connected to one or more keyboards  for data and command input, one or more Visual Display Units (VDUs)  for display of output information and data storage means . Some redundancy in hardware may be provided.","At the software level the SAS runs, in the preferred embodiment on a standard open VMS operating system, a suite of software whose architecture is now described in overview with reference to ; it will be understood that the software could alternatively be implemented in hardware.","In overview the SAS comprises a Subscription Chain area  to give rights for subscription mode and to renew the rights automatically each month, a Pay Per View Chain area  to give rights for PPV events, and an EMM Injector  for passing EMMs created by the Subscription and PPV chain areas to the multiplexer and scrambler , and hence to feed the MPEG stream with EMMs. If other rights are to be granted, such as Pay Per File (PPF) rights in the case of downloading computer software to a user's Personal Computer, other similar areas are also provided.","One function of the SAS  is to manage the access rights to television programmes, available as commercial offers in subscription mode or sold as PPV events according to different modes of commercialisation (pre-book mode, impulse mode). The SAS , according to those rights and to information received from the SMS , generates EMMs for the subscriber.","The Subscription Chain area  comprises a Command Interface (CI) , a Subscriber Technical Management (STM) server , a Message Generator (MG) , and the Ciphering Unit .","The PPV Chain area  comprises an Authorisation Server (AS) , a relational database  for storing relevant details of the end users, a local blacklist database , Database Servers  for the database, an Order Centralized Server (OCS) , a Server for Programme Broadcaster (SPB) , a Message Generator (MG)  whose function is basically the same as that for the Subscription Chain area and is hence not described further in any detail, and the Ciphering Unit .","The EMM Injector  comprises a plurality of Message Emitters (MEs) , ,  and  and Software Multiplexers (SMUXs)  and . In the preferred embodiment, there are two MEs,  and  for the Message Generator , with the other two MEs  and  for the Message Generator . MEs  and  are connected to the SMUX  whilst MEs  and  are connected to the SMUX .","Each of the three main components of the SAS (the Subscription Chain area, the PPV Chain area and the EMM Injector) are now considered in more detail.","Subscription Chain Area","Considering first the Subscription Chain area , the Command Interface  is primarily for despatching messages from the SMS  to the STM server , as well as to the OCS , and from the OCS to the SMS. The Command Interface takes as input from the SMS either direct commands or batch files containing commands. It performs syntactic analysis on the messages coming from the STM server, and is able to emit accurate messages when an error occurs in a message (parameter out of range, missing parameter, and so on). It traces incoming commands in textual form in a trace file  and also in binary form in a replay file  in order to be able to replay a series of commands. Traces can be disabled and the size of files limited.","Detailed discussion of the STM server  is now provided with particular reference to . The STM server is effectively the main engine of the Subscription Chain area, and has the purpose of managing free rights, the creation of new subscribers and the renewal of existing subscribers. As shown in the figure, commands are passed on to the Message Generator , albeit in a different format from that in which the commands are passed to the STM server. For each command, the STM server is arranged to send an acknowledgement message to the CI only when the relevant command has been successfully processed and sent to the MG.","The STM server includes a subscriber database , in which all the relevant parameters of the subscribers are stored (smartcard number, commercial offers, state, group and position in the group, and so on). The database performs semantic checks of the commands sent by the CI  against the content of the database, and updates the database when the commands are valid.","The STM server further manages a First In First Out (FIFO) buffer  between the STM server and the MG, as well as a backup disk FIFO . The purpose of the FIFOs is to average the flow of commands from the CI if the MG is not able to respond for a while for any reason. They can also ensure that in the case of a crash of the STM server or MG no command will be lost, since the STM server is arranged to empty (that is, send to the MG) its FIFOs when restarted. The FIFOs are implemented as files.","The STM server includes at its core an automatic renewal server  which automatically generates renewals, and, if required by the operators, free rights. In this context, the generation of renewals may be thought of as including the generation of rights for the first time, although it will be understood that the generation of new rights is initiated at the SMS. As will become apparent, the two can be treated by roughly the same commands and EMMs.","Having the STM separate from the SAS, and the automatic renewal server within the SAS rather than (in known systems) in the SMS , is a particularly important feature, since it can significantly reduce the number of commands which need to be passed from the SMS to the SAS (bearing in mind that the SMS and SAS may be in different locations and operated by different operators). In fact, the two main commands required from the SMS are merely commands that a new subscription should be started and that an existing subscription should be stopped (for example in the case of non-payment). By minimising command exchange between the SMS and SAS, the possibility of failure of command transfer in the linkage  between the two is reduced; also, the design of the SMS does not need to take into account the features of the conditional access system  generally.","Automatic renewal proceeds in the fashion indicated in the flow diagram of . In order to reduce bandwidth, and given that a very high percentage of all renewals are standard, renewal proceeds in groups of subscribers; in the preferred embodiments there are 256 individual subscribers per group. The flow diagram begins with the start step , and proceeds to step  where a monthly activation of the renewal function is made (although of course it will be appreciated that other frequencies are also possible). With a monthly frequency, rights are given to the end user for the current month and all of the following month, at which point they expire if not renewed.","In step  the subscriber database  is accessed in respect of each group and each individual within that group to determine whether rights for the particular individual are to be renewed.","In step , a group subscription bitmap is set up according to the contents of the subscriber database, as shown in . The bitmap comprises a group identifier (in this case Group \u2014\u201cG\u201d)  and 256 individual subscriber zones . The individual bits in the bitmap are set to 1 or zero according to whether or not the particular subscriber is to have his rights renewed. A typical set of binary data is shown in the figure.","In step  the appropriate commands, including the group subscription bitmap, are passed to the Message Generator . In step  the Message Generator sets an obsolescence date to indicate to the smartcard the date beyond which the particular subscription EMM is not valid; typically this date is set as the end of the next month.","In step  the Message Generator generates from the commands appropriate group subscription EMMs and asks the Ciphering Unit  to cipher the EMMs, the ciphered EMMs being then passed to the EMM Injector , which, in step , injects the EMMs into the MPEG-2 data stream.","Step  indicates that the above described procedure is repeated for each and every group. The process is finally brought to an end at stop step .","The flow diagram described above with reference to  relates in fact specifically to the renewal of subscriptions. The STM also manages in a similar way free audience rights and new subscribers.","In the case of free audience rights, available for specific television programmes or groups of such programmes, these are made available by the STM issuing a command to the Message Generator to generate appropriate audience EMMs (for a whole audience) with an obsolescence date a given number of days (or weeks) hence. The MG computes the precise obsolescence date based on the STM command.","In the case of new subscribers, these are dealt with in two stages. Firstly, on purchase the smartcard in the receiver\/decoder  (if desired by the operator) affords the subscriber free rights for a given period (typically a few days). This is achieved by generating a bitmap for the subscriber which includes the relevant obsolescence date.","The subscriber then passes his completed paperwork to the operator managing the subscriber (at the SMS). Once the paperwork has been processed, the SMS supplies to the SAS a start command for that particular subscriber. On receipt by the SAS of the start command, the STM commands the MG to assign a unique address to the new subscriber (with a particular group number and position within the group) and to generate a special, so-called \u201ccommercial offer\u201d subscription EMM (as opposed to the more usual \u201cgroup\u201d subscription EMM used for renewals) to provide the particular subscriber with rights until the end of the next month. From this point renewal of the subscriber can occur automatically as described above. By this two stage process it is possible to grant new subscribers rights until the SMS issues a stop command.","It is to be noted that the commercial offer subscription EMM is used for new subscribers and for reactivation of existing subscribers. The group subscription EMM is used for renewal and suspension purposes.","With reference to , a typical subscription EMM proper (that is, ignoring the header and signature) generated by the above procedure comprises the following main portions, namely typically a 256 bit subscription (or subscribers' group) bitmap , 128 bits of management ciphering keys  for the ciphering of the EMM, 64 bits of each exploitation ciphering key  to enable the smartcard  to decipher a control word to provide access to broadcast programmes, and 16 bits of obsolescence date  to indicate the date beyond which the smartcard will ignore the EMM. In fact in the preferred embodiment three exploitation keys are provided, one set for the present month, one set for the next month, and one for resume purposes in the event of system failure.","In more detail, the group subscription EMM proper has all of the above components, except the management ciphering keys . The commercial offer subscription EMM proper (which is for an individual subscriber) includes instead of the full subscribers' group bitmap  the group ID followed by the position in the group, and then management ciphering keys  and three exploitation keys , followed by the relevant obsolescence date .","The Message Generator  serves to transform commands issued by the STM server  into EMMs for passing to the Message Emitter . With reference to , firstly, the MG produces the EMMs proper and passes them to the Ciphering Unit  for ciphering with respect to the management and exploitation keys. The CU completes the signature  on the EMM (see ) and passes the EMM back to the MG, where the header  is added. The EMMs which are passed to the Message Emitter are thus complete EMMs. The Message Generator also determines the broadcast start and stop time and the rate of emission of the EMMs, and passes these as appropriate directions along with the EMMs to the Message Emitter. The MG only generates a given EMM once; it is the ME which performs its cyclic transmission.","Again with reference to , the Message Generator includes its own EMM database  which, for the lifetime of the relevant EMM, stores it. It is erased once its emission duration has expired. The database is used to ensure consistency between the MG and ME, so that for example when an end user is suspended the ME will not continue to send renewals. In this regard the MG computes the relevant operations and sends them to the ME.","On generation of an EMM, the MG assigns a unique identifier to the EMM. When the MG passes the EMM to the ME, it also passes the EMM ID. This enables identification of a particular EMM at both the MG and the ME.","Also concerning the Subscription Chain area, the Message Generator includes two FIFOs  and , one for each of the relevant Message Emitters  and  in the EMM Injector , for storing the ciphered EMMs. Since the Subscription Chain area and EMM Injector may be a significant distance apart, the use of FIFOs can allow full continuity in EMM transmission even if the links  and  between the two fail. Similar FIFO's are provided in the Pay Per View Chain area.","One particular feature of the Message Generator in particular and the conditional access system in general concerns the way that it reduces the length of the EMM proper  by mixing parameter length and identifier to save space. This is now described with reference to  which illustrates an exemplary EMM (in fact a PPV EMM, which is the simplest EMM). The reduction in length occurs in the Pid (Packet or \u201cParameter\u201d identifier) . This comprises two portions, the actual ID , and the length parameter for the packet  (necessary in order that the start of the next packet can be identified). The whole Pid is expressed in just one byte of information, 4 bits being reserved for the ID, and four for the length. Because 4 bits is not sufficient to define the length in true binary fashion, a different correspondence between the bits and the actual length is used, this correspondence being represented in a look-up table, stored in storage area  in the Message Generator (see ). The correspondence is typically as follows:\u2014",{"@attributes":{"id":"p-0123","num":"0141"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"126pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"0000 = 0"]},{"entry":[{},"0001 = 1"]},{"entry":[{},"0010 = 2"]},{"entry":[{},"0011 = 3"]},{"entry":[{},"0100 = 4"]},{"entry":[{},"0101 = 5"]},{"entry":[{},"0110 = 6"]},{"entry":[{},"0111 = 7"]},{"entry":[{},"1000 = 8"]},{"entry":[{},"1001 = 9"]},{"entry":[{},"1010 = 10"]},{"entry":[{},"1011 = 11"]},{"entry":[{},"1100 = 12"]},{"entry":[{},"1101 = 16"]},{"entry":[{},"1110 = 24"]},{"entry":[{},"1111 = 32"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"It will be seen that the length parameter is not directly proportional to the actual length of the packet; the relationship is in part more quadratic rather than linear. This allows for a greater range of packet length.","Pay Per View Chain Area","Concerning the Pay Per View Chain area , with reference to  in more detail the Authorisation Server  has as its client the Order Centralized Server , which requests information about each subscriber which connects to the Communications Servers  to purchase a PPV product.","If the subscriber is known from the AS , a set of transactions takes place. If the subscriber is authorized for the order, the AS creates a bill and sends it to the OCS. Otherwise, it signals to the OCS that the order is not authorized.","It is only at the end of this set of transactions that the AS updates the end users database  via the database servers (DBAS) , if at least one transaction was authorized; this optimizes the number of database accesses.","The criteria according to which the AS authorizes purchase are stored in the database, accessed through DBAS processes. In one embodiment, the database is the same as the database accessed by the STM.","Depending on consumer profile, the authorization may be denied (PPV_Forbidden,Casino_Forbidden . . . ). These kind of criteria are updated by STM , on behalf of the SMS .","Other parameters are checked, such as limits allowed for purchase (either by credit card, automatic payment, or number of authorized token purchases per day).","In case of payment with a credit card, the number of the card is checked against a local blacklist stored in the local blacklist database .","When all the verifications are successful, the AS:\u2014","1. Generates a bill and sends it to the OCS, which completes this bill and stores it in a file, this file being later sent to the SMS for processing (customer actual billing); and","2. Updates the database, mainly to set new purchase limits.","This check-and-generate-bill-if-OK mechanism applies for each command a subscriber may request during a single connection (it is possible to order e.g. 5 movies in a single session).","It is to be noted that the AS has a reduced amount of information concerning the subscriber, by comparison with that held by the SMS. For example, the AS does not hold the name or address of the subscriber. On the other hand, the AS does hold the smartcard number of the subscriber, the subscriber's consumer category (so that different offers can be made to different subscribers), and various flags which state whether, for example, the subscriber may purchase on credit, or he is suspended or his smartcard has been stolen. Use of a reduced amount of information can help to reduce the amount of time taken to authorize a particular subscriber request.","The main purpose of the DBASs  is to increase database performance seen from the AS, by paralleling the accesses (so actually it does not make much sense to define a configuration with only one DBAS). An AS parameter determines how many DBAScs should connect. A given DBAS may be connected to only one AS.","The OCS  mainly deals with PPV commands. It operates in several modes.","Firstly, it operates to process commands issued by the SMS, such as product refreshment (for instance, if the bill is already stored by the SMS, no bill is generated by the OCS), update of the wallet in the smartcard , and session cancellation\/update.","The various steps in the procedure are:\u2014","1. Identifying the relevant subscriber (using the AS );","2. If valid, generate adequate commands to the Message Generator, in order to send an appropriate EMM. Commands may be:",{"@attributes":{"id":"p-0139","num":"0000"},"ul":{"@attributes":{"id":"ul0015","list-style":"none"},"li":{"@attributes":{"id":"ul0015-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0016","list-style":"none"},"li":["Product commands,","Update of the wallet,","Session erasure."]}}}},"Note that these operations do not imply creation of billing information, since billing is already known from the SMS. These operations are assimilated to \u201cfree products\u201d purchase.","Secondly, the OCS deals with commands received from the subscribers through the Communications Servers . These may be received either via a modem connected to the receiver\/decoder , or by voice activation via the telephone , or by key activation via a MINITEL, PRESTEL or like system where available.","Thirdly, the OCS deals with callback requests issued by the SMS. These last two modes of operation are now discussed in more detail.","In the second type of mode described above it was stated that the OCS deals with commands received directly from the end user (subscriber) through the Communications Servers . These include product orders (such as for a particular PPV event), a subscription modification requested by the subscriber, and a reset of a parental code (a parental code being a code by which parents may restrict the right of access to certain programmes or classes of programmes).","The way in which these commands are dealt with is now described in more detail with reference to .","Product orders by a subscriber involve the following steps:\n\n","The EMM(s) is sent either on the modem line  if the consumer placed the product order using the receiver\/decoder  (more details of this are described later), or else it is broadcast. The one exception to this is where there is some failure of the modem connection (in the case where the consumer places the order using the receiver\/decoder); in this event the EMM is broadcast over the air.","A subscription modification requested by a subscriber involves:\n\n","If modification was requested using the receiver\/decoder, the OCS generates a confirmation to the SMS. Otherwise, for example in the case of phone or Minitel, the subscriber is prompted for confirmation and this answer sent to the SMS via the OCS and the CI.","Reset of a parental code involves:","1. Identifying the caller (using AS); and","2. Sending a command to the MG to generate an appropriate EMM bearing an appropriate reset password.","In the case of reset of parental code, the command to reset the code is for security reasons not permitted to originate from the receiver\/decoder. Only the SMS, telephone and MINITEL or like can originate such a command. Hence in this particular case the EMM(s) are broadcast only on air, never on the telephone line.","It will be understood from the above examples of different modes of operation of the OCS that the user can have direct access to the SAS, and in particular the OCS and AS, in that the Communications Servers are directly connected to the SAS, and in particular the OCS. This important feature is concerned with reducing the time for the user to communicate his command to the SAS.","This feature is illustrated further with reference to , from which it can be seen that the end user's Set-Top-Box, and in particular its receiver\/decoder , has the capability of communicating directly with the Communications Servers  associated with the SAS . Instead of the connection from the end user to the Communications Servers  of the SAS  being through the SMS  the connection is directly to the SAS .","In fact, as directly mentioned two direct connections are provided.","The first direct connection is by a voice link via a telephone  and appropriate telephone line (and\/or by MINITEL or like connection where available) where the end users still have to input a series of voice commands or code numbers but time is saved compared with the communication being via the SMS .","The second direct connection is from the receiver\/decoder  and the input of data is achieved automatically by the end user inserting his own daughter smartcard  thus relieving the end user of the job of having to input the relevant data which in turn reduces the time taken and the likelihood of errors in making that input.","A further important feature which arises out of the above discussion is concerned with reducing the time taken for the resulting EMM to be transmitted to the end user in order to initiate viewing by the end user of the selected product.","In broad terms, and with reference to , the feature is again achieved by providing the end user's receiver\/decoder  with the capability of communicating directly with the Communications Servers  associated with the SAS .","As described earlier the integrated receiver\/decoder  is connected directly to the Communications Servers  by the modemmed back channel  so that commands from the decoder  are processed by the SAS , messages generated (including EMMs) and then sent back directly to the decoder  through the back channel . A protocol is used in the communication between the CS  and the receiver\/decoder  (as described later), so that the CS receive acknowledgement of receipt of the relevant EMM, thereby adding certainty to the procedure.","Thus, for example, in the case of a pre-book mode the SAS  receives messages from the end user via the smartcard and decoder  via its modem and via the telephone line , requesting access to a specific event\/product, and returns a suitable EMM via the telephone line  and modem to the decoder , the modem and decoder being preferably located together in a Set-Top-Box (SIT). This is thus achieved without having to transmit the EMM in the MPEG-2 data stream  via the multiplexer and scrambler , the uplink , satellite  and datalink  to enable the end user to view the event\/product. This can save considerably on time and bandwidth. Virtual certainty is provided that as soon as the subscriber has paid for his purchase the EMM will arrive at the receiver\/decoder .","In the third type of mode of operation of the OCS  described above, the OCS deals with callback requests issued by the SAS. This is illustrated with reference to . Typical callback requests have the purpose of ensuring that the receiver\/decoder  calls back the SAS via the modemmed back channel  with the information that the SAS requires of the receiver\/decoder.","As instructed by the Command Interface , the subscription chain Message Generator  generates and sends to the receiver\/decoder  a callback EMM. This EMM is ciphered by the Ciphering Unit  for security reasons. The EMM may contain the time\/date at which the receiver\/decoder should wake up and perform a callback on its own, without being explicitly solicited; the EMM may also typically contain the phone numbers which the terminal must dial, the number of further attempts after unsuccessful calls and the delay between two calls.","When receiving the EMM, or at the specified time-date; the receiver\/decoder connects to the Communications Servers . The OCS  first identifies the caller, using the AS , and verifies certain details, such as smartcard operator and subscriber details. The OCS then asks the smartcard  to send various ciphered information (such as the relevant session numbers, when the session was watched, how many times the subscriber is allowed to view the session again; the way in which the session was viewed, the number of remaining tokens, the number of prebooked sessions, etc). This information is deciphered by the PPV chain Message Generator , again using the Ciphering Unit . The OCS adds this information to a callback information storage file  for later processing and passing to the SMS . The information is ciphered for security reasons. The whole procedure is repeated until there is nothing more to be read from the smartcard.","One particular preferred feature of the callback facility is that before reading the smartcard (so just after the identification of the caller using the AS  as described above) a check is made by the SAS  that the receiver\/decoder is indeed a genuine one rather than a pirated version or computer simulation. Such a check is carried out in the following manner. The SAS generates a random number, which is received by the receiver\/decoder, ciphered, and then returned to the SAS. The SAS deciphers this number. If the deciphering is successful and the original random number is retrieved, it is concluded that the receiver\/decoder is genuine, and the procedure continues. Otherwise, the procedure is discontinued.","Other functions which may occur during the callback are erasure of obsolete sessions on the smartcard, or filling of the wallet (this latter also being described later under the section entitled \u201cSmartcard\u201d).","Also as regards the Pay Per View Chain area , description is now made of the Communications Servers . At the hardware level, these comprise in the preferred embodiment a DEC Four parallel processor machine. At the software architecture level, with reference to , in many respects the Communications Servers are conventional. One particular divergence from conventional designs arises from the fact that the Servers must serve both receiver\/decoders  and voice communication with conventional telephones , as well possibly as MINITEL or like systems.","It will be noted in passing that two Order Centralized Servers  are shown in  (as \u201cOCS\u201d and \u201cOCS\u201d). Naturally any desired number may be provided.","The Communication Servers include two main servers (\u201cCS\u201d and \u201cCS\u201d) as well as a number of frontal servers (\u201cFrontal \u201d and \u201cFrontal \u201d); whilst two frontal servers are shown in the figure, typically 10 or 12 may be provided per main server. Indeed, although two main servers CS and CS and two frontal servers, Frontal  and Frontal , have been shown, any number could be used. Some redundancy is usually desirable.","CS and CS are coupled to OCS and OCS via high level TCP\/IP links , whilst CS and CS are coupled to Frontal  and Frontal  via further TCP\/IP links .","As illustrated, CS and CS comprise servers for \u201cSENDR\u201d (transmission), \u201cRECVR\u201d (reception), \u201cVIX\u201d (MINITEL, PRESTEL or the like), \u201cVOX\u201d (voice communication), and \u201cTRM\u201d (communication with the receiver\/decoder). These are coupled to the \u201cBUS\u201d for communication of signals to the Frontal servers.","CS and CS communicate directly with the receiver\/decoders  via their modemmed back channels  using the X25 public network common protocol. The relatively low-level protocol between the Communications Servers  and the receiver\/decoders  is in one preferred embodiment based upon the V42 standard international CCITT protocol, which provides reliability by having error detection and data re-transmission facilities, and uses a checksum routine to check the integrity of the re-transmission. An escape mechanism is also provided in order to prevent the transmission of disallowed characters.","On the other hand, voice telephone communication is carried out via the Frontal Communications Servers, each capable of picking up, say, 30 simultaneous voice connections from the connection  to the local telephone network via the high speed \u201cT2\u201d (E1) standard telephony ISDN lines.","Three particular functions of the software portion of the Communications Servers (which could of course alternatively be implemented fully in hardware) are firstly to convert the relatively low level protocol information received from the receiver\/decoder into the relatively high level protocol information output to the OCS, secondly to attenuate or control the number of simultaneous connections being made, and thirdly to provide several simultaneous channels without any mixing. In this last regard, the Communications Servers play the role of a form of multiplexer, with the interactions in a particular channel being defined by a given Session ID (identifier), which is in fact used throughout the communication chain.","Finally as regards the Pay Per View Chain area , and with reference again to , the Server for Programme Broadcast (SPB)  is coupled to one or more Programme Broadcasters  (which would typically be located remotely from the SAS) to receive programme information. The SPB filters out for further use information corresponding to PPV events (sessions).","A particularly important feature is that the filtered programme event information is passed by the SPB to the MG which in turn sends a directive (control command) to the ME to change the rate of cyclic emission of the EMMs in given circumstances; this is done by the ME finding all EMMs with the relevant session identifier and changing the cycle rate allocated to such EMMs. This feature might be thought of as a dynamic allocation of bandwidth for specific EMMs. Cyclic EMM emission is discussed in more detail in the section below concerned with the EMM Injector.","The circumstances in which the cycle rate is changed are now described with reference to , which demonstrates how cycle rate  is raised a short while (say 10 minutes) before a particular PPV programme event until the end of the event from a slow cycle rate of say once every 30 minutes to a fast cycle rate of say once every 30 seconds to 1 minute in order to meet the anticipated extra user demand for PPV events at those times. In this way bandwidth can be allocated dynamically according to the anticipated user demand. This can assist in reducing the overall bandwidth requirement.","The cycle rate of other EMMs may also be varied. For example the cycle rate of subscription EMMs may be varied by the Multiplexer and Scrambler  sending the appropriate bitrate directive.","EMM Injector","Concerning the EMM Injector , details of the Message Emitters  to , forming part of the EMM Injector and acting as output means for the Message Generator, are now described with reference to . Their function is take the EMMs and to pass them cyclically (in the manner of a carousel) via respective links  and  to the Software Multiplexers  and  and thence to the hardware multiplexers and scramblers . In return the software multiplexers and scramblers  generate a global bitrate directive to control the overall cycling rate of the EMMs; to do so, the MEs take into account various parameters such as the cycle time, the size of EMM, and so on. In the figure, EMM_X and EMM_Y are group EMMs for operators X and Y, whilst EMM_Z are other EMMs for either operator X or operator Y.","Further description proceeds for an exemplary one of the Message Emitters; it will be appreciated that the remaining MEs operate in similar fashion. The ME operates under control of directives from the MG, most notably transmission start and stop time and emission rate, as well as session number if the EMM is a PPV EMM. In relation to the emission rate, in the preferred embodiment the relevant directive may take one of five values from Very fast to Very slow. The numeric values are not specified in the directive, but rather the ME maps the directive to an actual numeric value which is supplied by the relevant part of the SAS. In the preferred embodiment, the 5 emission rates are as follows:\u2014",{"@attributes":{"id":"p-0179","num":"0210"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1.","Very fast","every 30 seconds"]},{"entry":[{},"2.","Fast","every minute"]},{"entry":[{},"3.","Medium","every 15 minutes"]},{"entry":[{},"4.","Slow","every 30 minutes"]},{"entry":[{},"5.","Very slow","every 30 minutes"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"The ME has first and second databases  and . The first database is for those EMMs which have not yet achieved their broadcast date; these are stored in a series of chronological files in the database. The second database is for EMMs for immediate broadcast. In the event of a system crash, the ME is arranged to have the ability to re-read the relevant stored file and perform correct broadcast. All the files stored in the databases are updated upon request from the MG, when the MG wishes to maintain consistency between incoming directives and EMMs already sent to the NE. The EMMs actually being broadcast are also stored in Random Access Memory .","A combination of the FIFOs  and  in the Message Generator and the databases  and  in the Message Emitter means that the two can operate in standalone mode if the link  between them is temporarily broken; the ME can still broadcast EMMs.","The Software Multiplexers (SMUX)  and  provide an interface between the MEs and the hardware multiplexers . In the preferred embodiment, they each receive EMMs from two of the MEs, although in general there is no restriction on the number of MEs that can be connected with one SMUX. The SMUXs concentrate the EMMs and then pass them according to the type of EMM to the appropriate hardware multiplexer. This is necessary because the hardware multiplexers take the different types of EMMs and place them at different places in the MPEG-2 stream. The SMUX's also forward global bitrate directives from the hardware multiplexers to the MEs.","One particularly important feature of the ME is that it emits EMMs in random order. The reason for this is as follows. The Message Emitter has no ability to sense or control what it emits to the multiplexer. Hence it is possible that it may transmit two EMMs which are to be received and decoded by the receiver\/decoder  back to back. In such circumstances, further, it is possible that if the EMMs are insufficiently separated the receiver\/decoder and smartcard will be unable to sense and decode properly the second of the EMMs. Cyclically emitting the EMMs in random order can solve this problem.","The manner in which randomization is achieved is now described with reference to ; in the preferred embodiment the necessary software logic is implemented in the ADA computer language. A particularly important part of the randomization is the correct storage of the EMMs in the databases  and  (which are used for backup purposes) and in the RAM . For a particular cycle rate and operator, the EMMs are stored in a two-dimensional array, by rank  (going say from A to Z) and number in the rank  (going from 0 to N). A third dimension is added by cycle rate , so that there are as many two-dimensional arrays as there are cycle rates. In the preferred embodiment there are 256 ranks and typically 200 or 300 EMMs in each rank; there are 5 cycle rates. A final dimension to the array is added by the presence of different operators; there are as many three-dimensional arrays as there are operators. Storage of the data in this fashion can permit rapid retrieval in the event that the MG wants to delete a particular EMM.","Storage of the EMMs takes place according to the \u201chash\u201d algorithm (otherwise known as the \u201cone-way hash function\u201d. This operates on a modulo approach, so that successive ranks are filled before a higher number in the rank is used, and the number of EMMs in each rank remains roughly constant. The example is considered of there being 256 ranks. When the MG sends the ME an EMM with identifier (ID) , the rank \u201c1\u201d is assigned to this EMM, and it takes the first number  in the rank .","The EMM with ID  is assigned the rank (\u201c2\u201d, and so on, up to the rank . The EMM with ID  is assigned the rank \u201c1\u201d again (based on the modulo function), and takes the second number in the first rank, and so on.","Retrieval of a specific EMM, for example when deletion of a specific EMM is requested by the MG, is effected by means of the inverse of the above. The hash algorithm is applied to the EMM ID to obtain the rank, after which the number in the rank is found.","The actual randomization occurs when the EMMs are, on a cyclical basis, retrieved from RAM  using the randomization means  which is implemented in the hardware and\/or software of the Message Emitter. The retrieval is random, and again based on the hash algorithm. Firstly, a random number (in the above example initially in the range 1 to 256) is chosen, to yield the particular rank of interest. Secondly, a further random number is chosen to yield the particular number in the rank. The further random number is selected according to the total number of EMMs in a given rank. Once a given EMM has been selected and broadcast, it is moved to a second identical storage area in the RAM , again using the hash function. Hence the first area diminishes in size as the EMMs are broadcast, to the extent that, once a complete rank has been used, this is deleted. Once the first storage area is completely empty, it is replaced by the second storage area before a new round of EMM broadcast, and vice versa.","In the above fashion, after two or three cycles of the EMMs, statistically the chances of any two EMMs destined for the same end user being transmitted back to back is negligible.","At regular intervals whilst the EMMs are being stored the computer  computes the number of bytes in storage and from this computes the bitrate of emission given the global bitrate directive from the multiplexer and software multiplexer.","Reference was made above to the backup databases  and . These are in fact in the preferred embodiment sequential file stores, which hold a backup version of what is in the RAM . In the event of failure of the Message Emitter and subsequent restart, or more generally when the ME is being restarted for whatever reason, a link is made between the RAM and the databases, over which the stored EMMs are uploaded to RAM. In this way, the risk of losing EMMs in the event of failure can be removed.","Similar storage of PPV EMMs occurs to that described above in relation to subscription EMMs, with the rank typically corresponding to a given operator and the number in the rank corresponding to the session number.","Smartcard","A daughter, or \u201csubscriber\u201d, smartcard  is schematically shown in  and comprises an 8 bit microprocessor , such as a Motorola 6805 microprocessor, having an input\/output bus coupled to a standard array of contacts  which in use are connected to a corresponding array of contacts in the card reader of the receiver\/decoder , the card reader being of conventional design. The microprocessor  is also provided with bus connections to preferably masked ROM , RAM  and EEPROM . The smartcard complies with the ISO 7816-1, 7816-2 and 7816-3 standard protocols which determine certain physical parameters of the smartcard, the positions of the contacts on the chip and certain communications between the external system (and particularly the receiver\/decoder ) and the smartcard respectively and which will therefore not be further described here. One function of the microprocessor  is to manage the memory in the smartcard, as now described.","The EEPROM  contains certain dynamically-created operator zones , ,  and dynamically-created data zones which will now be described with reference to .","Referring to , EEPROM  comprises a permanent \u201ccard ID\u201d (or manufacturer) zone  of 8 bytes which contains a permanent subscriber smartcard identifier set by the manufacturer of the smartcard .","When the smartcard is reset, the microprocessor  issues a signal to receiver\/decoder , the signal comprising an identifier of the conditional access system used by the smartcard and data generated from data stored in the smartcard, including the card ID. This signal is stored by the receiver\/decoder , which subsequently utilises the stored signal to check whether the smartcard is compatible with the conditional access system used by the receiver\/decoder .","The EEPROM  also contains a permanent \u201crandom number generator\u201d zone  which contains a program for generating pseudo-random numbers. Such random numbers are used for diversifying transaction output signals generated by the smartcard  and sent back to the broadcaster.","Below the random number generator zone  a permanent \u201cmanagement\u201d zone  of 144 bytes is provided. The permanent management zone  is a specific operator zone utilised by a program in the ROM  in the dynamic creation (and removal) of zones , ,  . . . as described below. The permanent management zone  contains data relating to the rights of the smartcard to create or remove zones.","The program for dynamically creating and removing zones is responsive to specific zone creation (or removal) EMMs which are transmitted by the SAS  and received by the receiver\/decoder  and passed to the subscriber smartcard . In order to create the EMMs the operator requires specific keys dedicated to the management zone. This prevents one operator from deleting zones relating to another operator.","Below the management zone  is a series of \u201coperator ID\u201d zones , ,  for operators ,  . . . N respectively. Normally at least one operator ID zone will be preloaded into the EEPROM of the subscriber smartcard  so that the end user can decrypt programmes broadcast by that operator. However further operator ID zones can subsequently be dynamically created using the management zone  in response to a transaction output signal generated via his smartcard  by the end user (subscriber), as will subsequently be described.","Each operator zone , ,  contains the identifier of the group to which the smartcard  belongs, and the position of the smartcard within the group. This data enables the smartcard (along with the other smartcards in its group) to be responsive to a broadcast \u201cgroup\u201d subscription EMM having that group's address (but not the smartcard's position in the group) as well as to an \u201cindividual\u201d (or commercial offers subscription) EMM addressed only to that smartcard within the group. There can be 256 member smartcards of each such group and this feature therefore reduces significantly the bandwidth required for broadcasting EMMs.","In order to reduce further the bandwidth required for broadcasting \u201cgroup\u201d subscription EMMs, the group data in each operator zone , ,  and all similar zones in the EEPROM of smartcard  and the other daughter smartcards is continually updated to enable a particular smartcard to change its position in each group to fill any holes created by e.g. deletion of a member of the group. The holes are filled by the SAS  as in the STM server  there is a list of such holes.","In this manner fragmentation is reduced and each group's membership is maintained at or near the maximum of 256 members.","Each operator zone , ,  is associated with one or more \u201coperator data objects\u201d stored in the EEPROM . As shown in , a series of dynamically created \u201coperator data\u201d objects - are located below the operator ID zones. Each of these objects is labelled with:\n\n","Deletion of a data object creates a \u201chole\u201d  in the smartcard, that is, the number of bytes that the deleted objects had previously occupied are not immediately occupied. The thus \u201cfreed\u201d number of bytes, or \u201chole\u201d are labelled with:\n\n","The next data object created fills the hole, as identified by the identifier . In this manner the limited memory capacity (4 kilobytes) of the EEPROM  is efficiently utilised.","Turning now to the set of data objects associated with each operator, examples of the data objects are now described.","Data object  contains an EMM key used for decrypting encrypted EMM's received by the receiver\/decoder . This EMM key is permanently stored in the data object . This data object  may be created prior to distribution of the smartcard , and\/or may be created dynamically when creating a new operator zone (as described above).","Data object  contains ECM keys which are sent by the associated operator (in this case operator ) to enable the end user to decrypt the particular \u201cbouquet\u201d of programs to which he has subscribed. New ECM keys are sent typically every month, along with a group subscription (renewal) EMM which renews the end user's overall right to view the broadcast from (in this case) operator . The use of separate EMM and ECM keys enables viewing rights to be purchased in different ways (in this embodiment by subscription and individually (Pay Per View)) and also increases security. The Pay Per View (PPV) mode will be described subsequently.","Since new ECM keys are sent periodically, it is essential to prevent a user from using old ECM keys, for example by switching off the receiver\/decoder or re-setting a clock to prevent expiry of an old ECM key so that a timer in the receiver\/decoder  could be overridden. Accordingly operator zone  comprises an area (typically having a size of 2 bytes) containing an obsolescence date of the ECM keys. The smartcard  is arranged to compare this date with the current date which is contained in received ECMs and to prevent decryption if the current date is later than the obsolescence date. The obsolescence date is transmitted via EMMs, as described above.","Data object  contains a 64 bit subscription bitmap which is an exact representation of the broadcast operator's programs to which the subscriber has subscribed. Every bit represents a program and is set to \u201c1\u201d if it is subscribed to and \u201c0\u201d if it is not.","Data object  contains a quantity of tokens which can be used by the consumer in PPV mode to buy viewing rights to an imminent broadcast e.g. in response to a free preview or other advertisement. Data object  also contains a limit value, which may be set to e.g. a negative value to allow credit to the consumer. Tokens can be purchased e.g. by credit and via the modemmed back channel , or by using a voice server in combination with a credit card, for example. A particular event can be charged as one token or a number of tokens.","Data object  contains a description of a PPV event, as shown with reference to table  of .","The PPV event description  contains a \u201csession ID\u201d  identifying the viewing session (corresponding to the program and the time and date of broadcasting) a \u201csession mode\u201d  indicating how the viewing right is being purchased (e.g. in pre-book mode), a \u201csession index\u201d  and a \u201csession view\u201d .","In respect of receiving a programme in PPV mode, the receiver decoder  determines whether the programme is one sold in PPV mode. If so, the decoder  checks, using the items stored in the PPV event description  whether the session ID for the programme is stored therein. If the session ID is stored therein, the control word is extracted from the ECM.","If the session ID is not stored therein, by means of a specific application the receiver\/decoder  displays a message to the end user indicating that he has the right to view the session at a cost of, say, 25 tokens, as read from the ECM or to connect to the communications servers  to purchase the event. Using the tokens, if the end user answers \u201cyes\u201d (by means of remote controller  (see )) the decoder  sends the ECM to the smartcard, the smartcard decreases the wallet of the smartcard  by 25 tokens, writes the session ID , the session mode , the session index  and the session view  in the PPV event description  and extracts and deciphers the control word from the ECM.","In the \u201cpre-book\u201d mode, an EMM will be passed to the smartcard  so that the smartcard will write the session ID , the session mode , the session index  and the session view  in the PPV event description  using the EMM.","The session index  can be set to differentiate one broadcast from the other. This feature permits authorization to be given for a subset of broadcasts, for example, 3 times out of 5 broadcasts. As soon as an ECM with a session index different from the current session index  stored in the PPV event description  is passed to the smartcard, the number of the session view  is decreased by one. When the session view reaches zero, the smartcard will refuse to decipher an ECM with a different session index to the current session index.","The initial value of the session view depends only on the way in which the broadcast supplier wishes to define the event to which it relates; the session view for a respective event may take any value.","The microprocessor  in the smartcard implements a counting and a comparison program to detect when the limit to the number of viewings of a particular program has been reached.","All of the session ID , the session mode , the session index  and the session view  in the PPV event description  may be extracted from the smartcard using the \u201ccall-back\u201d procedure as described previously.","Each receiver\/decoder  contains an identifier which may either identify uniquely that receiver\/decoder or identify its manufacturer or may classify it in some other way in order to enable it to work only with a particular individual smartcard, a particular class of smartcards made by the same or a corresponding manufacturer or any other class of smartcards which are intended for use with that class of receiver\/decoders exclusively.","In this manner the receiver\/decoders  which have been supplied by one broadcast supplier to the consumer are protected against the use of non-authorised daughter smartcards .","Additionally or alternatively to this first \u201chandshake\u201d between the smartcard and the receiver, the EEPROM of the smartcard  could contain a field or bitmap describing the categories of receiver\/decoders  with which it can function. These could be specified either during the manufacture of the smartcard  or by a specific EMM.","The bitmap stored in the smartcard  typically comprises a list of up to 80 receiver\/decoders, each identified with a corresponding receiver\/decoder ID with which the smartcard may be used. Associated with each receiver\/decoder is a level \u201c1\u201d or \u201c0\u201d indicating whether the smartcard may be used with the receiver\/decoder or not, respectively. A program in the memory  of the receiver\/decoder searches for the identifier of the receiver\/decoder in the bitmap stored in the smartcard. If the identifier is found, and the value associated with the identifier is \u201c1\u201d, then the smartcard is \u201cenabled\u201d; if not, then the smartcard will not function with that receiver\/decoder.","In addition, if, typically because of an agreement between operators, it is desired to authorize the use of other smartcards in a particular receiver\/decoder, specific EMMs will be sent to those smartcards to change their bitmap via the transponder .","Each broadcast supplier may differentiate his subscribers according to certain predetermined criteria. For example, a number of subscribers may be classed as \u201cVIPs\u201d. Accordingly, each broadcast supplier may divide his subscribers into a plurality of subsets, each subset comprising any number of subscribers,","The subset to which a particular subscriber belongs is set in the SMS . In turn, the SAS  transmits an EMM to the subscriber which writes information (typically of length 1 byte) concerning the subset to which the subscriber belongs into the relevant operator data zone, say , of the EEPROM of the smartcard. In turn, as events are broadcast by the broadcast supplier, an ECM, typically of 256 bits, is transmitted with the event and indicating which of the subsets of subscribers may view the event. If, according to the information stored in the operator zone, the subscriber does not have the right to view the event, as determined by the ECM, programme viewing is denied.","This facility may be used, for example, to switch off all of a given operator's smartcards in a particular geographical region during the transmission of a particular program, in particular a program relating to a sports fixture taking place in that geographical region. In this manner football clubs and other sport bodies can sell broadcasting rights outside their locality whilst preventing local supporters from viewing the fixture on television. In this manner the local supporters are encouraged to buy tickets and attend the fixture.","Each of the features associated with zones  to  is considered to be a separate invention independent of the dynamic creation of zones.","It will be understood that the present invention has been described above purely by way of example, and modifications of detail can be made within the scope of the invention.","Each feature disclosed in the description, and (where appropriate) the claims and drawings may be provided independently of in any appropriate combination.","In the aforementioned preferred embodiments, certain features of the present invention have been implemented using computer software. However, it will of course be clear to the skilled man that any of these features may be implemented using hardware. Furthermore, it will be readily understood that the functions performed by the hardware, the computer software, and such like are performed on or using electrical and like signals.","Cross reference is made to our co-pending applications, all bearing the same filing date, and entitled Signal Generation and Broadcasting, Smartcard for use with a Receiver of Encrypted Broadcast Signals, and Receiver, Broadcast and Reception System and Conditional Access System therefor, Downloading a Computer File from a Transmitter via a Receiver\/Decoder to a Computer, Transmission and Reception of Television Programmes and Other Data, Downloading Data, Computer Memory Organisation, Television or Radio Control System Development, Extracting Data Sections from a Transmitted Data Stream, Access Control System, Data Processing System, and Broadcast and Reception System, and Receiver\/Decoder and Remote Controller therefor. The disclosures of these documents are incorporated herein by reference. The list of applications includes the present application."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"p":["Preferred features of the present invention will now be described, purely by way of example, with reference to the accompanying drawings, in which:\u2014",{"@attributes":{"id":"p-0045","num":"0063"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0046","num":"0064"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0047","num":"0065"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0048","num":"0066"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0049","num":"0067"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0050","num":"0068"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0051","num":"0069"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0052","num":"0070"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0053","num":"0071"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0054","num":"0072"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0055","num":"0073"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0056","num":"0074"},"figref":["FIG. 12","FIG. 2"]},{"@attributes":{"id":"p-0057","num":"0075"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0058","num":"0076"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0059","num":"0077"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0060","num":"0078"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0061","num":"0079"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0062","num":"0080"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0063","num":"0081"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0064","num":"0082"},"figref":"FIG. 20"}]},"DETDESC":[{},{}]}
