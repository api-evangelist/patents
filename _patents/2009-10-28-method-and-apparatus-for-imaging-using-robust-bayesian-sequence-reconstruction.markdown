---
title: Method and apparatus for imaging using robust bayesian sequence reconstruction
abstract: Methods and systems for determining a sequence of energy interactions in a detector. A plurality of discrete energy interactions is received in a plurality of detector voxels. A plurality of possible sequences of interaction is formed based on the received plurality of discrete energy interactions. For each of the plurality of possible sequences of interaction, an a posteriori probability is computed, where the a posteriori probability is based on a likelihood that the possible sequence of interaction is consistent with the received plurality of discrete energy interactions. Additionally or alternatively, the a posteriori probability may be based on an a priori probability. One of the formed plurality of possible sequences of interaction is selected based on the computed a posteriori probability.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08274054&OS=08274054&RS=08274054
owner: The Board of Trustees of the Leland Standford Junior University
number: 08274054
owner_city: Stanford
owner_country: US
publication_date: 20091028
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["PRIORITY CLAIM AND REFERENCE TO RELATED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application claims the benefit of U.S. Provisional Application Ser. No. 61\/109,010, filed Oct. 28, 2008, under 35 U.S.C. \u00a7119, which is incorporated by reference herein.","This invention was made with government support under grants R01 CA119056, R33 EB003283 and R01 CA120474 awarded by National Institutes of Health (NIH). The government has certain rights in the invention.","Fields of the invention include methods, apparatus, and systems for imaging. Example applications of the invention include imaging using gamma ray detectors.","Gamma ray detectors, based on scintillator, semiconductor, or gaseous materials, can be used to absorb, detect, and localize gamma rays. They are useful in a wide variety of applications ranging from medical imaging to astronomy and homeland security.","One nonlimiting example imaging application is positron emission tomography (PET). In PET and other applications, an event produces a gamma ray photon pair. Using detectors, a line of response (LOR) is determined for the photon pair, and multiple LORs are used to image a subject. Single events may also be used in certain imaging methods by determining an incoming direction. Detectors having good energy and spatial resolution provide a potential for high-resolution image detection systems.","However, in a significant number of events, one annihilation photon deposits all its energy across multiple detector elements. Such events, which are referred to herein as photon multiple interactions events (PMIEs), affect the reliability of current imaging methods. A nonlimiting example PMIE occurs when the photon undergoes inter-crystal scatter (ICS). For example, during a PMIE, depending on the gamma ray energy and the detector material (effective atomic number, density, and thickness), one gamma ray photon might produce a sequence of multiple discrete interactions in the detector, depositing its energy across multiple detector elements, due to Compton scatter and other physical effects. Due to the very short interaction time, it can be difficult to determine the actual interaction sequence.","For a high-resolution detector, a large percentage of the recorded single events and recorded coincidences include PMIEs. However, because it is desirable for an image reconstruction to include all recorded events for high sensitivity, ICS events should be positioned as accurately as possible. Because the earliest interaction defines the correct LOR or incoming direction for an event (subsequent interactions are not aligned with the true LOR or direction because Compton scatter deviates the annihilation photon from its linear trajectory, and an incorrect LOR causes loss of contrast, quantitative accuracy, and spatial resolution), it is useful to know the order of the interactions.","Methods and systems for determining a sequence of energy interactions in a detector are provided according to example embodiments of the present invention. In an example method, a plurality of discrete energy interactions is received in a plurality of detector voxels. A plurality of possible sequences of interaction is formed based on the received plurality of discrete energy interactions. For each of the plurality of possible sequences of interaction, an a posteriori probability is computed, where the a posteriori probability is based on a likelihood that the possible sequence of interaction is consistent with the received plurality of discrete energy interactions. Additionally or alternatively, the a posteriori probability may be based on an a priori probability. One of the formed plurality of possible sequences of interaction is selected based on the computed a posteriori probability.","When multiple interactions are recorded, it is useful to know the order of the interactions. For example, the first interaction carries the most accurate position information for the incoming gamma ray. In addition, accurately sequencing the multiple interactions can be used to estimate the incoming direction of a gamma ray.","The ability to correctly position PMIEs greatly affects the global performance of imaging systems, such as but not limited to PET systems based on CZT detectors. Discarding such events is not a desirable solution because such events are part of a large fraction (e.g., 93.8%) of all the recorded coincidences. Conventional positioning schemes degrade both contrast and resolution, reduce the image's quantitative accuracy, and affect the detectability of hot lesions. Simple approaches help improve the image quality but are outperformed by more advanced positioning schemes that use more of the information available in an optimal way.","Bayesian methods according to embodiments of the present invention can combine prior information and measurements to identify the most probable sequence. Example robust Bayesian methods, based on maximum a posteriori (MAP), are disclosed for reconstructing the order of sequences of interactions that occur in detectors, thereby allowing one to identify the crystal of entry. An example sequence reconstruction problem is formulated using a robust (e.g., stochastic) statistical framework that takes into account the uncertainties in measuring the position and energy of every interaction. A particular example reconstructed sequence both maximizes the agreement with the data measurements and a priori probabilities based on the physics of gamma ray transport.","An embodiment of the invention is a method, apparatus, and\/or system that determines (e.g., estimates) the correct sequence of a plurality of energy (e.g., gamma ray) interactions by using a robust statistical method, such as Bayesian estimation. Methods for determining a line of response (LOR) for incoming photons, for determining a direction of a single incoming photon, for selecting a first and\/or subsequent interactions, for determining whether to consider or reject a particular event, and\/or for imaging a subject by estimating the correct sequence of incoming photons are also provided under example embodiments of the present invention. Reconstructing a complete sequence of interactions for each photon can provide a reliable way to select an earliest interaction because it ensures that all the interactions are consistent with one another.","In an example method, for a plurality of energy (e.g., gamma ray) interactions, a plurality of possible sequences of interaction is formed based on received photon interactions in a plurality of detector voxels. For example, the received photon interactions may include received signals corresponding to a plurality of particular detector voxel locations and a plurality of energy measurements. As a result, as one nonlimiting example, if three detectors are hit during a PMIE, the received signals can be used to determine the particular detectors that are hit (x, y, z), and the energy measured (E, E, E). Unknown are the order of interactions \u03c3, the energy deposited E, and the location \u03c9 of the interactions within the detector voxel (energy measurements have additive Gaussian noise, and detector pixel identification is noise-free).","The plurality of possible sequences preferably includes all possible permutations of the order of the interactions. Thus, in an example method, all of the possible sequences are formed. For each possible sequence, an a posteriori probability is computed.","Preferably, this probability is based in part on a maximum likelihood evaluation, e.g., an evaluation of the likelihood that a particular sequence of interactions is consistent with the observations (and in more particular examples, consistency of the energy measurements with the position measurements). For example, sequences including each of the possible permutations may be tested and compared to the observed energy information. As a nonlimiting example, for each sequence to be tested, one or more hypothetical energy calculations can be performed, and the result can be compared to the observed energy to evaluate a likelihood. In certain embodiments, for example, the hypothetical energy depositions can be computed using Compton kinematics.","Further, the a posteriori probability may be calculated based in part on prior knowledge, which is especially helpful when the measurements are noisy and\/or unreliable. As a nonlimiting example, a prior distribution can be obtained by computing a total cross-section for each of the possible trajectories, based on the physics of gamma ray transport, to model the non-uniform probabilities for a sequence to be generated. Thus, before the energy measurements are made (though not necessarily), the relative a priori distribution can be inferred based on prior knowledge. Example types of prior knowledge and consideration criteria that may be used are provided in example embodiments of the present invention. However, methods of the present invention are not to be limited to using the particular types of prior knowledge described in examples herein. Individual or multiple criteria may be used.","In a particular example, if \u03c9, the uniform distribution inside the detector pixel is known, and \u03c3 are discrete values (card.=N!) an example\n\n","The first two can be solved, in a nonlimiting example, using Monte-Carlo or other sampling on \u03c9 (e.g., using a GPU).","An example a posteriori probability objective combines the likelihood of the sequence, which measures the consistency of the energy measurements with the position measurements, and an a priori probability, which models the non-uniform probabilities for a sequence to be generated, and penalizes sequences that are unlikely based on photon attenuation and Compton scatter. Nonlimiting example methods for combining the a posteriori probability and the a priori probability include multiplying and adding the probabilities. As a nonlimiting example, the likelihood result may be multiplied by the a priori result to provide an objective value. In an example embodiment, a parameter may be used to control the respective influence (weight) of the likelihood and the prior model (e.g., the parameter may be used as a coefficient or exponent). The sequence having the maximum objective value is selected, and the location of the estimated earliest interaction is used to position the PMIE. In this way, example methods of the present invention consider both the detector measurements and the physics of gamma ray transport in determining the interaction sequence.","To improve the robustness of the Bayesian method, a distribution of multiple gamma ray tracks within the detector voxels can be generated in example embodiments of the present invention using stochastic methods. As a nonlimiting example, a random distribution of multiple gamma ray paths within a particular detector voxel can be generated by using Monte-Carlo sampling. The average objective over these multiple interaction paths can then be maximized. For example, for each permutation of the order of the interaction, possible realizations of the positions can be determined by, for each detector voxel in a group of multiple interactions, selecting at least one of a plurality of distributed positions within the detector voxel. This example method accounts for the finite spatial resolution of the detectors, as opposed to merely assuming that the center of a particular detector voxel is the correct interaction location. The random distributions can be used for a likelihood calculation, an a priori probability, or both. This method may require more computational resources than needed if only the center of the detector voxel is considered, but it provides significantly more robust results, as the determined path between multiple detector voxels can vary greatly depending on the particular path taken within each detector voxel. The number of realizations generated can be selected based on available computation time and\/or resources, as nonlimiting examples. Distributed computing (e.g., parallel computing) may be used in some example embodiments to generate and\/or evaluate particular realizations.","In an example robust method, the determined objectives for each realization are combined, for instance, averaged, to determine a maximum likelihood objective for that permutation. As a nonlimiting example, if a random distribution of gamma ray paths within a particular detector voxel is generated by using Monte-Carlo sampling, a likelihood may be computed using Monte-Carlo integration. Other methods for averaging the determined objectives, or other methods for combining the objectives, are contemplated as well (e.g., weighted average, multiplicative average, taking a worst case scenario, etc.) The average objective is thus maximized over these multiple distributed interaction paths based on the computed a posteriori probability. Accordingly, this example maximum likelihood criterion seeks the sequence of interactions that has the greatest statistical consistency with the observations by the detector, and accounts for any noisy and unreliable measurements.","Example methods according to the present invention provide a robust statistical framework for accurately estimating the sequence of gamma ray interactions with a high success rate. Factors such as the finite spatial resolution of the gamma ray detector, the noise distribution of the energy measurements, and\/or the non-uniform a priori distribution of the sequences based on the physics of photon transport can be accounted for in example methods.","It is also contemplated that a sequence determination may be made based on only the maximum likelihood criterion (to assess consistency with observations), maximum a posteriori criteria based on prior knowledge, and\/or generated distribution paths within individual detector voxels, or any combination of these three. While considering all three general criteria is preferred, the present invention is not to necessarily be limited to such consideration.","An example imaging system according to embodiments of the present invention includes a source of emitted photons (though other imaging systems may be separate from the source of emitted photons), and one or more detectors positioned to receive emitted photons and generate signals. The source of emitted photons may vary as will be appreciated by one of ordinary skill in the art, and the present invention is not to be limited to a particular source. A nonlimiting example source of emitted photons is a body into which a radioactive tracer has been introduced.","The one or more detectors should be able to detect individual interaction coordinates (e.g., individual detector voxels) and energies. A nonlimiting example for the one or more detectors is a cadmium-zinc-telluride (CZT) detector module, though others (e.g., lutetium oxyorthosilicate (LSO) coupled to thin position-sensitive avalanche photodiodes) are also applicable. An example detector module provides signals for 3-D positioning as well as energy. The pitch with which electrode strips are deposited determines the intrinsic spatial resolution. This example detector module also provides a pixilated design, which is employed by example embodiments of the present invention. However, the present invention is not to be limited to the imaging devices and systems specifically described herein, including those using a CZT detector module. Suitable power supplies, signal lines, etc. are coupled to the one or more detectors, as will be understood by those of ordinary skill in the art.","The one or more detectors are coupled by suitable electrical and\/or optical couplers to a receiver and signal processor (which can include one or multiple receivers and one or multiple signal processors), which processes the signals produced by the one or more detectors. The receiver, such as but not limited to pulse processing electronics, may be any suitable receiver, and may be combined with or separate from the signal processor. A nonlimiting example signal processor is provided by a computing device, such as but not limited to a computer. A signal processor configured to perform methods of the present invention, e.g., a suitably configured computer, computer hardware, or computing device, is also contemplated to be part of the present invention. Further, embodiments of the present invention may also be provided by hardware devices, media of any appropriate type or design, a propagated signal, etc., that can be used to configure a signal processor to perform one or more example methods of the present invention (as a nonlimiting example, media containing executable instructions that when executed cause a computer to perform example methods of the present invention). The signal processor can be powered by any suitable power supply. A result may be displayed on a suitable display, stored in memory, storage (such as but not limited to disk storage), or any media, may be printed, and\/or may be used for further processing. Accordingly, it is to be understood that when referring to methods herein, such description is also intended to refer to imaging devices, imaging systems, signal processors, computers, media, etc.","A robust (e.g., stochastic) Bayesian method according to example embodiments of the present invention can reconstruct more correct sequences than conventional methods. As a result, images reconstructed from datasets processed using example methods and systems of the present invention have higher SNR and show sharper features. An example method accounts for the pixilated nature of gamma ray detectors to provide improved performance.","Embodiments of the present invention may be used for several applications. As a nonlimiting example, in medical imaging, knowledge of the first interaction reduces the number of mispositioned photons, resulting in sharper images and higher SNR. For example, in medical imaging, it may be necessary to know the precise point-of-entrance of the gamma ray to accurately position the event. By forming the correct sequence, it is possible to determine the first interaction, which provides the most accurate position information. This feature is crucial to high-resolution gamma ray imaging systems in which multiple interactions are more likely to happen. Further, in medical imaging, knowledge of the first and second (or subsequent) interactions can be used to estimate the photon incoming direction and reject bad events (such as scatter and randoms) or incorporate events that are usually thrown away (e.g., singles). In gamma ray astronomy and homeland security applications, sequence reconstruction is critical to performing Compton imaging.","In addition, for a Compton camera, used in astronomy or homeland security, it is important to be able to accurately identify and sequence the first, the second, and, if available, sometimes the third interaction. This knowledge is useful to form the Compton cone and estimate both the point-of-entrance and the angle-of-entrance. This information can be used, as nonlimiting examples, to reconstruct sky images or image the presence of nuclear material in cargo trucks.","Preferred embodiments will now be discussed with respect to the drawings. The drawings include schematic figures that are not to scale, which will be fully understood by skilled artisans with reference to the accompanying description. Features may be exaggerated for purposes of illustration. From the preferred embodiments, artisans will recognize additional features and broader aspects of the invention.","Exploiting the full potential of high-resolution imaging methods can benefit from positioning events that deposit their energy, through Compton scatter, in multiple locations. Such high resolution imaging systems, such as but not limited to high-resolution positron emission tomography (PET) systems, use detector modules including small detection elements. As one nonlimiting example, semiconductor detectors made of Cadmium Zinc Telluride (CZT) directly sense the ionization signal created by the annihilation photon absorption. In these detectors, a strong electric field is established across the crystal by applying a relatively large potential difference on the two electrodes (anode and cathode) on either face of a monolithic crystal slab. When an incoming annihilation photon interacts with the atoms in the semiconductor crystal, electron-hole pairs are created and drift toward opposite faces, where they are detected by the device. The motion of the charge induces signals on the respective electrodes that are used to extract spatial, energy, and temporal information.","CZT detectors have good energy and spatial resolution. In addition, they can measure the 3-dimensional (3D) location (e.g., coordinates) of the energy deposition for building high-resolution individual interactions. As a result, they can provide high-resolution positron emission tomography (PET) systems with depth-of-interaction (DOI) measurement capability.","To exploit the full potential of CZT detector modules, however, the image reconstruction should be able to use the events in which annihilation photons deposit all their energy (e.g., 511 keV) across multiple detector elements or multiple locations, such as those that undergo inter-crystal scatter (ICS). For these events (referred to herein as PMIEs), the crystal of entrance is ambiguous. PMIEs are a major source of event positioning error in high-resolution PET systems, for example if the events are erroneously assumed to the wrong LOR, which in turn degrades spatial resolution, quantitative accuracy, and image contrast.","An example CZT detector module , as shown in , uses a set of parallel, thin rectangular strips  for the anode and an orthogonal set  for the cathode. For example, the cathodes  and the anodes  can be deposited on a front and a back face of a CZT slab , respectively. The x-y coordinate of the interaction (in the orientation shown in ) is determined by the intersection of the strips ,  on either side of the crystal slab  that record a signal above threshold. The pitch with which the electrodes are deposited determines the intrinsic spatial resolution. The z coordinates along the direction orthogonal to the electrode plane are determined using the ratio of the cathode to anode signal pulse heights. In an example imaging system, in this direction, the intrinsic resolution is below 1 mm full-width half-maximum (FWHM). In this example cross-strip electrode design, the signals can be multiplexed, thereby reducing the number of electronic channels required.","In a nonlimiting example small animal PET system , 40\u00d740\u00d75 mmslabs  of CZT are arranged edge-on with respect to the incoming photons. The 8\u00d78\u00d78 cmfield-of-view (FOV) extends to the edge of the detectors, due to the detector's ability to read out the 3D coordinates of individual photon interactions. The intrinsic resolution in the x-y plane, determined by the electrode pitch, is 5 mm for the example cathode and 1 mm for the example anode. The axial and tangential intrinsic resolution for the system is therefore 1 mm. To mitigate the impact of parallax blurring, the depth coordinate is quantized to intervals of 5 mm. The detector voxel elements in this example system are 1\u00d75\u00d71 mmin the coordinate system of .","CZT is a low Z material, and as a result its photo-fraction is low compared to other crystals. To preserve high photon detection efficiency, the geometry of the particular example system  is designed such that 511 keV photons see a minimum of 4 cm thick material. Still, in the CZT material for this example system , a large fraction (75.1%) of all events undergoes at least one Compton scatter. Because the detection voxels are small, the scattered photons usually escape into adjacent crystals. On average, a 511 keV photon deposits its energy in 2.2 detector voxels. Accordingly, in 93.8% of all the recorded coincident pairs in an example run, at least one annihilation photon underwent ICS. It is highly desirable to use all the events, including those for which the position is ambiguous, to preserve the system's high photon sensitivity (e.g., 17% at 800 \u03bcCi at the center, a 16-fold increase compared to using only events that deposit all their energy in a single detector voxel). However, the ability to correctly position these events strongly determines the quality of the images obtained from the example PET system .","A standard position sensitive PET detector uses light multiplexing in the scintillation crystal array and\/or charge multiplexing in a position sensitive photodetector or associated readout circuit resulting in a few (typically four) readout channels. Such detectors estimate the photon interaction coordinates for each event by determining the weighted mean of the readout signals. Thus, individual interaction coordinates and their energies deposited cannot be determined in the standard PET detector. Fortunately, PMIEs are less frequent for standard large crystal elements, which are more likely to completely absorb the energy from multiple interactions.","In the example system  shown in , since the cross-strip electrode design is capable of recording the 3D coordinates and energy deposition for every interaction, it is possible to distinguish the photons that deposit their energy in a single detector voxel from those which deposit their energy in multiple detector voxels. The knowledge of every interaction position and energy can be used to infer the correct crystal of entrance and mitigate the effect of ICS positioning errors. The earliest interaction carries the most accurate position information because it best defines the correct line of response (LOR) along which the two annihilation photons traveled. In general, the time of each interaction is not known with sufficient accuracy to infer which interaction happened first, thus the order of the sequence of interaction must be reconstructed from the position and energy of individual interactions. Secondary interactions are useful for measuring the total energy of the event, or estimating the direction of the incoming photon.","Other PET systems, such as but not limited to systems where the crystal is individually coupled to the light detector, allow readout of multiple interactions from PMIEs. Examples include, but are not limited to, systems disclosed in Bergeron et al, Performance evaluation of the LabPET APD-based digital PET scanner, IEEE Nuclear Science Symp. Conf. Record, vol. 6, 2007, pp 4185-91; Spanoudaki, Development and performance studies of a small animal positron emission tomography with individual crystal readout and depth or interaction information, Dissertation Technische Universitt Munchen, 2008; Braem et al, Feasibility of a novel design of high resolution parallax-free Compton enhanced PET scanner dedicated to brain research, Phys. Med. Biol. 49, 2004, pp. 2547-62; Zhang et al., Performance characterization of a novel thin position-sensitive avalanche photodiode for 1 mm resolution positron emission tomography, IEEE Trans. Nucl. Sci. 54, 2007, pp. 415-21; and Levin et al., New imaging technologies to enhance the molecular sensitivity of positron emission tomography, Proc. IEEE 96, 2008, pp. 439-67, the contents of which are incorporated herein by reference.","These systems are example systems that can distinguish the photons that deposit their energy in a single detector voxel from those which deposit their energy in multiple detector voxels. This presents an opportunity to position PMIEs. Positioning methods can usually be classified in three categories: interaction selection, unconstrained positioning, and full sequence reconstruction.","In interaction selection, an estimate of the earliest interaction (EI) is selected from the finite set of all detected interactions, and used to position the PMIE. This class of methods exploits some form of correlation between the order of the interactions and properties of their energy and position. Example techniques include choosing the interaction with largest\/second largest signal, the smallest depth of interaction, or the minimum distance to the other coincident photon. For sequences of more than two interactions, the order of subsequent interactions is not recovered.","In unconstrained positioning, the positioning problem is relaxed by allowing the positioning of PMIEs to be assigned to any location within the detection volume. For example, the energy-weighted mean scheme (EWM), used in conventional PET systems, combines the interaction locations linearly using the energy as weight.","Full sequence reconstruction is performed by assigning possible sequences (for example, every possible sequence) an objective value. For example, an objective can be chosen to favor sequences that are consistent with both the detector's measurements and\/or the physics of \u03b3-ray transport.","A number of objectives have been considered to penalize sequences that violate the kinematics of Compton scatter. These techniques are based on testing the consistency of redundant information. For example, the cosine of the scatter angle can be computed using the Compton formula, provided that the order of the sequence of interactions and the annihilation photon energy are known. This quantity can also be obtained directly from the interaction locations. The sum of the square of the differences of the scatter angle cosines can be used as an objective to assess that the sequence kinematics are valid. This scheme can be refined by weighting the summands by the measurement error. Another method forms the weighted sum of the absolute difference between the scatter angle computed from trigonometry and from Compton kinematics.","The objective can also be based on physical considerations, such as the probability that the annihilation photon follows a trajectory. The Klein-Nishina differential cross-section is one component of the trajectory probability. Other components can contribute to the trajectory probability, such as photoelectric cross section and exponential attenuation.","Another technique, backtracking, reconstructs the sequence backwards. Instead of performing a full search over the combinatorial space of all the sequences, this technique recovers the complete sequence of interactions sequentially by first identifying the photoelectric interaction, whose energy is assumed to be independent of the track properties, and then by retracing the interaction track backwards.","To reduce mispositioning errors, a robust Bayesian estimation method is provided according to embodiments of the present invention based on a maximum-a-posteriori (MAP) objective. An example method reconstructs the order of the sequence of interactions created by photons (e.g., 511 keV photons) in detectors such as the CZT detectors. The position of the event then can be assigned to the location of the estimated earliest interaction. The sequence reconstruction problem preferably is formulated using a robust statistical (e.g., stochastic) framework that takes into account the uncertainties in measuring the position and energy of each interaction. The reconstructed sequence both maximizes the agreement with the data measurements, and the a priori probability of the trajectory, based on the physics of gamma ray transport.","Example embodiments include a sequence reconstruction method that optimizes agreement with the measurements while also accounting for the trajectory total cross-section. Bayesian estimation provides an example framework to combine these two goals. Agreement with the measurements can be dealt with in an example embodiment using a maximum-likelihood (ML) approach, and the total trajectory cross-section can be described by a prior probability distribution. The combination (e.g., product) of the likelihood with the prior distribution yields the maximum a posteriori (MAP) objective. Using an example statistical framework has the advantage that measurement noise properties can be rigorously characterized in the objective. In addition, the example ML estimate is asymptotically efficient and unbiased.","A concern with some sequence reconstruction methods is that the exact location of each interaction within the detector voxel is uncertain. It is often assumed that the interactions occur at the center of the detector voxels, and this induces errors in the calculation of the objective. To mitigate this problem, a stochastic Bayesian estimation approach is used in example embodiments to provide a more robust method. In a particular example method, for all possible sequence orderings, the objective is averaged over many possible interaction paths, where the interaction location is sampled from 3D uniform distributions over the corresponding detector voxels. In a nonlimiting example embodiment, the possible interaction paths are produced by Monte-Carlo.","The MAP objective combines the likelihood objective and a prior probability distribution. A particular example method based on MAP will now be described with respect to the PMIE event shown in .","Stochastic Maximum-Likelihood","The maximum likelihood (ML) criterion is used to determine (e.g., seek) the sequence of interactions that has the greatest consistency (e.g., statistical consistency) with the observations. For an event comprising N interactions, N! hypotheses are tested in an example method. Each hypothesis describes a possible sequence of N interactions. The particular example ML procedure evaluates the likelihood of all the hypotheses and selects the one with the greatest likelihood.","Due to the pixilated nature of the detector (in this example, CZT detectors), the interaction position is quantized to the nearest detector voxel. The exact position rof each interaction can be expressed as the sum of the center dof the detector voxel (e.g., the nearest intersection of the electrodes) and the position quantization error q\n\n\u2003\u2003(1)\n","For example, in , the solid line represents the annihilation photon trajectory.  shows an example coincident event recorded by an example PET system based on CZT cross-strip electrodes modules, including a pure photoelectric event (p, left) and a PMIE (right) with three interactions E, E, E. The incoming energy eis 511 keV. In this specific example, there are six possible sequences, only one of which is correct (sequence , , ). Incorrect sequences can result in mispositioning of the ICS event and misidentification of the LOR (dotted line).",{"@attributes":{"id":"p-0069","num":"0074"},"figref":["FIG. 2B","FIG. 2B"],"sub":["i ","i","i","i","i","i "]},"The permutations of {1, . . . , N} form a finite set , of cardinality N!. Here, \u03c3=(\u03c3, . . . , \u03c3) refers to an element of . For example, (3, 1, 2) is an element of . The set of all the possible sequences of N interactions can be mathematically represented by .","The recorded energy deposition locations are numbered j=1, . . . , N. These indices are arbitrary and do not represent the true order of the interactions. The measurement Eof the energy deposited at the jlocation rin the detector () in an example method is subject to zero-mean Gaussian noise n, with variance \u03a3.\n\n=\u03b5(0,\u03a3), j=\u03c3\u2003\u2003(2)\n\nwhere \u03b5denotes the true energy deposition for the iinteraction. The true energy depositions are indexed by i, the true interaction number, which is related to j by an unknown permutation \u03c3.\n","Note that in formulating an ML objective, it is possible to compute analytically the energy deposited during a Compton scatter interaction. For example, given any permutation \u03c3 in the order of the interactions, \u00ea(\u03c3) is the hypothetical value of the photon energy between the ith and the (i+1)th interaction, computed from Compton kinematics. The hypothetical energy deposited by the ith interaction is denoted {circumflex over (\u03b5)}(\u03c3). Conservation of energy implies\n\n(\u03c3)=(\u03c3)+{circumflex over (\u03b5)}(\u03c3)\u2003\u2003(3)\n","The first hypothetical energy deposition can be computed using",{"@attributes":{"id":"p-0074","num":"0079"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"msub":{"mover":{"mi":"\u03b5","mo":"^"},"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},{"msub":{"mi":"e","mn":"0"},"mo":"-","mfrac":{"msub":{"mi":"e","mn":"0"},"mrow":{"mn":"1","mo":"+","mrow":{"mfrac":{"msub":{"mi":"e","mn":"0"},"mrow":{"msub":{"mi":["m","e"]},"mo":"\u2062","msup":{"mi":"c","mn":"2"}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mi":"cos","mo":"\u2062","msub":{"mover":{"mi":"\u03b8","mo":"^"},"mn":"1"}}}}}}}}],"mo":"="},{"mrow":{"mi":"cos","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"\u03b8","mo":"^"},"mn":"1"}},"mo":"=","mfrac":{"mrow":[{"mo":["\u2329","\u232a"],"mrow":{"mrow":[{"msub":{"mi":"r","msub":{"mi":"\u03c3","mn":"1"}},"mo":"-","mi":"p"},{"msub":[{"mi":"r","msub":{"mi":"\u03c3","mn":"2"}},{"mi":"r","msub":{"mi":"\u03c3","mn":"1"}}],"mo":"-"}],"mo":"\u2758"}},{"mrow":[{"mo":["\uf605","\uf606"],"mrow":{"msub":{"mi":"r","msub":{"mi":"\u03c3","mn":"1"}},"mo":"-","mi":"p"}},{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mi":"r","msub":{"mi":"\u03c3","mn":"2"}},{"mi":"r","msub":{"mi":"\u03c3","mn":"1"}}],"mo":"-"}}],"mo":"\u00b7"}]}}],"mo":[",","\u2062"],"mstyle":{"mtext":{}}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]}}}},"br":{},"sub":["e ","0 ","0 "]},"In a similar fashion, for i\u2266N\u22121, {circumflex over (\u03b5)}(\u03c3) can be evaluated recursively for any permutation \u03c3:",{"@attributes":{"id":"p-0076","num":"0081"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"msub":{"mover":{"mi":"\u03b5","mo":"^"},"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},{"msub":{"mover":{"mi":"e","mo":"^"},"mrow":{"mi":"i","mo":"-","mn":"1"}},"mo":"-","mfrac":{"msub":{"mover":{"mi":"e","mo":"^"},"mrow":{"mi":"i","mo":"-","mn":"1"}},"mrow":{"mn":"1","mo":"+","mrow":{"mfrac":{"msub":{"mover":{"mi":"e","mo":"^"},"mrow":{"mi":"i","mo":"-","mn":"1"}},"mrow":{"msub":{"mi":["m","e"]},"mo":"\u2062","msup":{"mi":"c","mn":"2"}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mi":"cos","mo":"\u2062","msub":{"mover":{"mi":"\u03b8","mo":"^"},"mi":"i"}}}}}}}}],"mo":"="},{"mrow":{"mi":"cos","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"\u03b8","mo":"^"},"mi":"i"}},"mo":"=","mfrac":{"mrow":[{"mo":["\u2329","\u232a"],"mrow":{"mrow":[{"msub":[{"mi":"r","msub":{"mi":["\u03c3","i"]}},{"mi":"r","msub":{"mi":"\u03c3","mrow":{"mi":"i","mo":"-","mn":"1"}}}],"mo":"-"},{"msub":[{"mi":"r","msub":{"mi":"\u03c3","mrow":{"mi":"i","mo":"+","mn":"1"}}},{"mi":"r","msub":{"mi":["\u03c3","i"]}}],"mo":"-"}],"mo":"\u2758"}},{"mrow":[{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mi":"r","msub":{"mi":["\u03c3","i"]}},{"mi":"r","msub":{"mi":"\u03c3","mrow":{"mi":"i","mo":"-","mn":"1"}}}],"mo":"-"}},{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mi":"r","msub":{"mi":"\u03c3","mrow":{"mi":"i","mo":"+","mn":"1"}}},{"mi":"r","msub":{"mi":["\u03c3","i"]}}],"mo":"-"}}],"mo":"\u00b7"}]}}],"mo":[",","\u2062"],"mstyle":{"mtext":{}}}},{"mrow":{"mo":["(",")"],"mn":"5"}}]}}}}},"For i=N, the energy of the annihilation photon is fully deposited through photoelectric interaction. Therefore, the last energy deposition is\n\n\u00ea(\u03c3)=\u00ea(\u03c3)\u2003\u2003(6)\n","The correct sequence \u03c3satisfies {circumflex over (\u03b5)}(\u03c3)=\u03b5for all i. However, only a noisy measurement Eof \u03b5is known, and therefore the sequence which maximizes the likelihood that {circumflex over (\u03b5)}(\u03c3)=Eis chosen. Assuming the positions qare known, the likelihood Lcan be expressed as",{"@attributes":{"id":"p-0079","num":"0084"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["L","q"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":"E","msub":{"mi":"\u03c3","mn":"1"}},"mo":"=","mrow":{"msub":{"mover":{"mi":"\u03b5","mo":"^"},"mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}}},{"msub":{"mi":"E","msub":{"mi":["\u03c3","N"]}},"mo":"=","mrow":{"mrow":{"msub":{"mover":{"mi":"\u03b5","mo":"^"},"mi":"N"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},"mo":"\u2758","mi":"\u03c3"}}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"7"}}]},{"mtd":[{"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"3.3em","height":"3.3ex"}}},"mo":"\u2062","mrow":{"mo":"=","mrow":{"munderover":{"mo":"\u220f","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"N"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mfrac":{"mn":"1","mrow":{"msqrt":{"mrow":{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c0"}},"mo":"\u2062","msub":{"mi":["\u03a3","i"]}}},"mo":"\u2062","mrow":{"mi":"exp","mo":["(",")"],"mrow":{"mrow":{"mrow":{"mo":"-","msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":"E","msub":{"mi":["\u03c3","i"]}},"mo":"-","mrow":{"msub":{"mover":{"mi":"\u03b5","mo":"^"},"mi":"i"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}}}},"mn":"2"}},"mo":"\/","mn":"2"},"mo":"\u2062","msubsup":{"mover":{"mi":"\u03a3","mo":"^"},"mi":"i","mn":"2"}}}}}}}},{"mrow":{"mo":["(",")"],"mn":"8"}}]}]}}},"br":{},"sub":["i ","i","i","i","i","i","i","i","i"],"sup":["2","2 ","2 ","2","2","2","2 "]},"In example operation, the optimization parameters qare unknown. In order to compute the objective, they can be substituted by their expected value E(q). For a uniform distribution, E(q)=0, therefore the interaction locations are assumed to be at the detector voxel center d. However, the uncertainty on qcan result in important variations in the scatter angle \u03b8, which in turn cause significant errors in the objective, as shown in . In , energy depositions were recorded in two locations. One or more interactions have occurred in each of the detector voxels, delineated by dashed rectangles. The sub-voxel positions qand qof each interaction are unknown. If qand qare assumed to be zero, one obtains the trajectory represented by a dotted line. If a robust method is used instead, qand qare generated randomly and the objective is computed by averaging many trajectories, represented by solid lines. The scatter angle can vary substantially depending on the position of the interaction within each detector voxel.","An example robust method includes maximizing the likelihood expected value over q\n\nmax (\u03c3)=(\u03c3)\u2003\u2003(9)\n","This objective accounts for limited resolution of the detector and provides a robust estimator for the optimal sequence. The computation of L (\u03c3) in an example method is performed by Monte-Carlo integration absent an analytical expression. Multiple realizations of the positions q, assumed to be uniformly distributed within the detector voxel, are generated. The objective is evaluated for each realization, and the average objective is then computed.","In an example performance of a method, a GeForce 9800 GX2 (NVIDIA) graphics processing unit (GPU) and the CUDA library (Nickolls et al., Scalable parallel programming with CUDA, ACM Queue 6, 2008, pp. 40-53) were used to accelerate the calculation of the expected value by Monte Carlo integration. Processing each PMIE involved computing the likelihood objective over 16,384 realizations. A Mersenne-twister random number generator was executed on a GPU to randomly sub-sample the detector voxels using a uniform distribution. The computation was decomposed into 32 blocks of 128 threads, resulting in a total of 4096 threads, each processing four realizations. The number of realizations was chosen to maximize performance, and can be reduced for faster processing. The 16,384 objective values were subsequently averaged on the CPU.","Maximum A Posteriori","The quality of the estimation can be enhanced by incorporating prior knowledge into the objective. This particularly helps when the measurements are noisy and unreliable. For estimating the order of the interactions in a PMIE, a prior probability distribution is obtained in example embodiments by computing the total cross-section for all N! trajectories. This cross-section is based on the physics of \u03b3-ray transport. For example, before the energy measurements are made, the relative a priori distribution of the sequence of interactions can be inferred based on the Klein-Nishina differential cross-section and the photoelectric cross-section.","An example prior probability distribution P(\u03c3) comprises three components: the probability P(\u03c3) that the annihilation photon travels the distance linking two successive interactions without being attenuated; the probability P(\u03c3) that the photon Compton scatters N\u22121 times, with angle \u03b8, each interaction being localized within a small control volume \u03b4Vcentered on r; and the probability P(\u03c3) that the photon is absorbed by the photoelectric effect within a small control volume \u03b4Vcentered on r.","The first component P(\u03c3) can be expressed as",{"@attributes":{"id":"p-0087","num":"0092"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["P","prop"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},{"munderover":{"mo":"\u220f","mrow":[{"mi":"i","mo":"=","mn":"1"},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mo":"-","mrow":{"msub":{"mi":["\u03bc","tot"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mover":{"mi":"e","mo":"^"},"mi":"i"}}}},{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mi":"r","msub":{"mi":"\u03c3","mrow":{"mi":"i","mo":"+","mn":"1"}}},{"mi":"r","msub":{"mi":["\u03c3","i"]}}],"mo":"-"}}],"mo":"\u00d7"}}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"10"}}]}}}},"br":{},"sub":["tot ","i"]},"The second component P(\u03c3) can be obtained from the Compton scatter cross-section:",{"@attributes":{"id":"p-0089","num":"0094"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["P","comp"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c3"}},{"munderover":{"mo":"\u220f","mrow":[{"mi":"i","mo":"=","mn":"1"},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mfrac":{"mrow":[{"msub":{"mi":["\u03bc","c"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mover":{"mi":"e","mo":"^"},"mi":"i"}}},{"msub":{"mi":["\u03bc","kn"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mover":{"mi":"e","mo":"^"},"mi":"i"}}}]},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mrow":[{"mi":"\u03d5","mo":"=","mn":"0"},{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c0"}]},"mo":"\u2062","mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03b8","i"]}}]}}}}],"mo":"="},"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mo":["(",")"],"mn":"11"}}]},{"mtd":[{"mrow":{"mrow":[{"msubsup":{"mo":"\u222b","mrow":[{"mi":"\u03d5","mo":"=","mn":"0"},{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c0"}]},"mo":"\u2062","mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03b8","i"]}}]}},{"msubsup":{"mo":"\u222b","mrow":[{"mi":"\u03d5","mo":"=","mn":"0"},{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c0"}]},"mo":"\u2062","mrow":{"mfrac":[{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03a9","i"]}}]},{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03a9","i"]}},{"mo":"\u2146","msub":{"mi":["\u03b8","i"]}}]}],"mo":"\u2062"}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"12"}}]},{"mtd":[{"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"6.1em","height":"6.1ex"}}},"mo":"\u2062","mrow":{"mo":"=","mrow":{"msubsup":{"mo":"\u222b","mrow":[{"mi":"\u03d5","mo":"=","mn":"0"},{"mn":"2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c0"}]},"mo":"\u2062","mrow":{"mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03a9","i"]}}]},"mo":["\u2062","\u2062","\u2062","\u2062"],"mi":"sin","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["\u03b8","i"]},"mrow":{"mo":"\u2146","mi":"\u03d5"}}}}}},{"mrow":{"mo":["(",")"],"mn":"13"}}]},{"mtd":[{"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"6.1em","height":"6.1ex"}}},"mo":"\u2062","mrow":{"mo":"=","mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","sin"],"msub":{"mi":["\u03b8","i"]},"mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03a9","i"]}}]}}}}},{"mrow":{"mo":["(",")"],"mn":"14"}}]}]}}},"br":{}},{"@attributes":{"id":"p-0090","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},{"mo":"\u2146","msub":{"mi":["\u03a9","i"]}}]},"mo":"\u221d","mrow":{"mrow":{"mo":["(",")"],"mrow":{"mfrac":{"msub":[{"mi":"e","mrow":{"mi":"i","mo":"+","mn":"1"}},{"mi":["e","i"]}]},"mo":["-","+"],"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mfrac":{"msub":[{"mi":"e","mrow":{"mi":"i","mo":"+","mn":"1"}},{"mi":["e","i"]}]}},"mn":"2"},{"mi":"sin","mn":"2"}],"mo":["\u2062","\u2062"],"msub":{"mi":["\u03b8","i"]}},"msup":{"mrow":{"mo":["(",")"],"mfrac":{"msub":[{"mover":{"mi":"e","mo":"^"},"mrow":{"mi":"i","mo":"+","mn":"1"}},{"mover":{"mi":"e","mo":"^"},"mi":"i"}]}},"mn":"3"}}},"mo":"."}}},{"mrow":{"mo":["(",")"],"mn":"15"}}]}}}},"br":{},"sub":["kn","i"]},{"@attributes":{"id":"p-0091","num":"0096"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["\u03bc","kn"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mover":{"mi":"e","mo":"^"},"mi":"i"}}},{"msubsup":{"mo":"\u222b","mrow":[{"mi":"\u03d5","mo":"=","mn":"0"},{"mn":"2","mo":"\u2062","mi":"\u03c0"}]},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mrow":{"mi":"\u03b8","mo":"=","mn":"0"},"mi":"\u03c0"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mrow":{"mo":"\u2146","msub":{"mi":["\u03c3","kn"]}},"mo":"."}}}],"mo":"="},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}},{"mrow":{"mo":["(",")"],"mn":"16"}}]}}}},"br":{},"sub":["kn","i","c","i"],"figref":["FIG. 4","FIG. 4"]},"Please amend the paragraph beginning at line 10, page 24 as follows:","The resulting example prior distribution is the product of the three components\n\n(\u03c3)=(\u03c3)\u00d7(\u03c3)\u00d7(\u03c3).\u2003\u2003(18)\n","Please amend the paragraph beginning at line 13 on page 24 as follows:","The example MAP objective is then formed by multiplying the example likelihood objective with the example a priori probability distribution\n\n(\u03c3)=(\u03c3)(\u03c3),\u2003\u2003(19)\n\nwhere \u03b2 is a parameter weighing the prior probability and the likelihood. The ML estimate is obtained when \u03b2 is zero. Note also that the objectives may be combined in other ways, for example by addition, with \u03b2 and (1\u2212\u03b2) as coefficients.\n","A simplified schematic of the complete example positioning algorithm is provided in .","Simulation of an Example CZT PET System","A fast Monte-Carlo package, GRAY (Olcott et al., GRAY: high energy photon ray tracer for PET applications, IEEE Nuclear Science Symp. Conf. Record, 2006, pp. 2011-5) was used to simulate an example PET system based on CZT cross-strip electrodes modules. The photoelectric effect and Compton scattering are the only physical processes included in GRAY. GRAY uses published databases (e.g., Berger et al., XCOM: photon cross sections database, NIST Standard Reference Database, 8 (XGAM), 1998) for computing the interaction cross-sections. The Compton scatter angular distribution is generated according to the Klein-Nishina formula. Individual interactions (hits) in the CZT detector module can be stored in list-mode. The list-mode dataset contains the accurate time, energy, and position of individual interactions.","After the simulation, the position of each event was processed to account for the limited spatial resolution of the system. Within one module, the spatial coordinates were binned to a grid of 1\u00d75\u00d71 mmdetector voxels. When two interactions occurred in the same detector voxel (which was rare), they were merged and their energies summed. The energy of individual interactions was blurred by additive Gaussian noise with variance \u03a3=1\/2.35\u00d7((6 keV)+(2.2%\u00d7\u03b5)), FWHM. The interactions were indexed arbitrarily, and the correct order of the sequence was stored for evaluation purposes. A lower-energy detection threshold of 10 keV was applied. The time stamp was blurred using 8 ns Gaussian noise. A 8 ns time window, consistent with NEC measurements for rat and mouse phantoms, was applied for coincidence gating. No dead time model was used in the simulation of the detectors.","The performance of four positioning schemes for PMIEs was investigated:","(i) Earliest Interaction (EI): The interaction with the smallest non-blurred time stamp was selected. This ideal scheme gives an upper bound on the performance of the positioning algorithm, although time resolution limitations restrict its use in practice.","(ii) Maximum A Posteriori (MAP): The full sequence was reconstructed using the example robust maximum-likelihood and robust maximum a posteriori methods described above. The event was positioned at the location of the estimated first interaction.","(iii) Energy Weighted Mean (EWM): The event was positioned at the energy-weighted mean position of the interactions. This scheme is standard for conventional PET block detectors.","(iv) Minimum Pair Distance (MPD): Both coincident events are first roughly positioned (for example, using EWM). The interaction closest to the rough location of the other coincident photon event is selected. This scheme is based on the preference of 511 keV photons to scatter forward. Unlike in MAP, the energy measurements are not used.","Discarding PMIEs was not considered, as one-interaction events are only a small fraction (e.g., 6.2%) of all coincidence photon events.","To identify the EI with MAP, the full sequence of interactions is reconstructed. For N\u22675, the size of the combinatorial search space (N!) is greater than 60. Therefore, for N\u22675, the MPD scheme was used instead of MAP for identifying the EI. Unlike MAP, the search space size in MPD grows linearly. In addition, for N large, the energy depositions are small, which means that in most interactions the photon scatters forward. Hence, MPD performs well for N\u22675.","The simplest measure of the quality of the positioning is the recovery rate, defined as the fraction of all the processed single-photon events for which the first interaction is correctly identified. This figure of merit is not applicable for unconstrained positioning methods such as EWM. The recovery rate was evaluated in a variety of situations: for varying between zero and one, for stochastic and non-stochastic optimization, for PMIEs with number of interactions varying between one and six, and for varying energy resolution (0%, 3%, and 12% FWHM at 511 keV) and spatial resolution (1\u00d71\u00d71 and 1\u00d75\u00d71 mmdetector voxels). To consider the influence of positioning methods on the final image quality, three components were investigated: the detector point-spread function (PSF), the contrast versus noise trade-off, and the reconstructed resolution.","A collimated single-photon, 1D point spread function (PSF) was measured for three incident angles (0, 30, and 60 degrees) and for all four positioning methods (EI, MAP, MPD, and EWM). A infinitely thin needle beam of 511 keV photons was simulated in GRAY and aimed at the center of a detector voxel in the middle of the panel, as shown in . The events were positioned and their transverse coordinate (i.e., along e) histogrammed. The axial coordinate (i.e., along e) was also histogrammed for the normal (i.e., 0 degrees) beam. To assess the extent of backscatter, and investigate depth-dependent effects, 2D PSFs were also generated by histogramming the events' estimated positions along both eand e.",{"@attributes":{"id":"p-0108","num":"0113"},"figref":["FIGS. 6A-C","FIG. 6A","FIG. 6B","FIG. 6C"],"sup":"3 "},"The contrast phantom, as shown in , was simulated to assess the quantitative contrast recovery. The phantom had a total of 800 \u03bcCi, and five seconds of acquisition were simulated, yielding 14.6 million coincident events. List-mode 3D-OSEM, with 10 million events per subset, was used for the reconstruction (Pratx et al., Fast, accurate and shift-varying line projections for iterative reconstruction using the GPU, IEEE Trans. Med. Imaging, 28, 2009, pp. 435-45). The contrast was measured in the reconstructed image as a function of iteration number. Mean reconstructed activity was measured in the hot spheres by using spherical 3D regions-of-interest (ROIs), as shown by example in . Background activity was evaluated by averaging the reconstructed intensity in two cylindrical ROIs placed off of the central axial plane. Noise was approximated by the spatial standard deviation in the background ROIs, normalized by the mean background intensity. The peak value of the contrast-to-noise ratio (CNR) was computed over all the iterations.","A high-resolution sphere phantom, as shown in , was simulated to consider the effects of the positioning on image resolution. The phantom included four quadrants of spheres in air, all in the central axial plane, placed all the way up to the edge of the 8\u00d78\u00d78 cmsystem FOV. The spheres were 1, 1.25, 1.5, and 1.75 mm in diameter. Their centers were placed twice their diameter apart. The phantom had a total of 800 \u03bcCi and five seconds of acquisition were simulated, yielding 27.2 million coincident events. The reconstructed sphere size (FWHM) was measured by fitting a Gaussian mixture with offset to 1D profiles through the reconstructed image. The 1 mm spheres were too small relative to the voxel size for their reconstructed FWHM to be reliably assessed.","Recovery Rate: The recovery rate is the fraction (e.g., %) of the processed single-photon events for which the first interaction is correctly identified. All recovery rates were evaluated based on at least 10 million events, and are subject to statistical measurement error below 0.02%. Some positioning methods, such as EWM, do not identify the first interaction, but rather estimate the position directly. The recovery rate is undefined for these methods.","For the example MAP positioning scheme, the recovery rate was computed for \u03b2 varying between zero and one, as shown in . The highest recovery rate (85.2%) was obtained for \u03b2=0.85, for the contrast phantom. This value is slightly higher than that obtained for \u03b2=0 (83.5%), which shows that use of prior information increases the quality of the estimation.","For MAP, the worst performance is reached for \u03b2=1, when only the prior probability is optimized. Yet, in this case, the recovery rate (74.3%) was still larger than for MPD (69.9%). Although both methods rely on the physics of y-ray transport and ignore the energy measurements, MAP with \u03b2=1 is a more accurate a priori probability computed from the trajectory total cross-section.",{"@attributes":{"id":"p-0114","num":"0119"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"49pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":["Positioning","Beam","Beam","Beam","Contrast"]},{"entry":["Methods","0\u00b0","30\u00b0","60\u00b0","Phantom"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["MAP (first interaction)","84.3","86.2","83.6","85.2"]},{"entry":["MPD (first interaction)","76.6","71.9","70.2","69.4"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}}}},{"@attributes":{"id":"p-0115","num":"0120"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"8"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"8","colwidth":"28pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"8","align":"center","rowsep":"1"}}},{"entry":["Positioning","PE","1 CS +","2 CS +","3 CS +","4 CS +","5 CS +",{}]},{"entry":["Methods","Only","PE","PE","PE","PE","PE","Global"]},{"entry":{"@attributes":{"namest":"1","nameend":"8","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"8"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"8","colwidth":"28pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["MAP","100","76.7","85.6","84.8","\u2014","\u2014","85.2*"]},{"entry":["(1interaction)",{},{},{},{},{},{},{}]},{"entry":["MPD","100","52.1","64.1","75.8","82.4","86.4","69.4"]},{"entry":["(1interaction)",{},{},{},{},{},{},{}]},{"entry":["MAP","100","76.7","78.3","67.0","\u2014","\u2014","77.6"]},{"entry":"(Full sequence)"},{"entry":{"@attributes":{"namest":"1","nameend":"8","align":"center","rowsep":"1"}}},{"entry":"*For N \u2267 5, the first interaction is estimated using MPD because the large size of the combinatorial search space (\u226760) makes the identification of the correct sequence impractical."},{"entry":{"@attributes":{"namest":"1","nameend":"8","align":"left","id":"FOO-00002"},"sup":"\u2020"}}]}}]}}},{"@attributes":{"id":"p-0116","num":"0121"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"77pt","align":"center"}}],"thead":{"row":{"entry":"TABLE 3"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Positioning","1 \u00d7 1 \u00d7 1 mm","1 \u00d7 5 \u00d7 1 mm"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"7"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"21pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Methods","0.5%","2.5%","12%","0.5%","2.5%","12%"]},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"7"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"char","char":"."}},{"@attributes":{"colname":"4","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"char","char":"."}},{"@attributes":{"colname":"7","colwidth":"21pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["MAP","90.0","89.6","88.1","85.5","85.2","61.5"]},{"entry":["(1interaction)",{},{},{},{},{},{}]},{"entry":["MPD",{},"69.4*",{},{},"69.4*",{}]},{"entry":"(1interaction)"},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}},{"entry":"*The MPD scheme does not use energy information."},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"left","id":"FOO-00004"},"sup":"\u2020"}}]}}]}}},{"@attributes":{"id":"p-0117","num":"0122"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 4"},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}},{"entry":["Interaction","PE","1 CS +","2 CS +","3 CS +",{}]},{"entry":["Position","Only","PE","PE","PE","Global"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Sub-voxel sampling","100","76.7","85.0","84.8","85.2"]},{"entry":["Voxel center","100","68.2","75.9","72.5","78.8"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}}}},"The recovery rate varies with the photon angle of incidence, as shown in Table 1. The example MAP struggles most with large photon incident angles (such as 60 degrees), where the photon is more likely to interact with multiple panels. The MPD scheme performs best for photons impinging normally on the detector. For the contrast phantom setup, the number of mispositioned events with MAP is a factor of two lower compared to MPD: 30.6% versus 14.8%.","The recovery rate also depends on the number of times the annihilation photon interacts with the detector, as shown in Table 2 (CS indicates Compton scatter, PE indicates photoelectric). MAP's ability to find the earliest interaction is not substantially degraded by an increasing number of interactions. Although the size of the search space increases linearly, so does the number of measurements.","MAP has the ability to recover the full sequence of interactions, which is useful in certain applications. The recovery rate for the full sequence is provided in the third row of Table 2.","The specifications of the detector technology, including the energy resolution and intrinsic spatial resolution, affect the performance of the example MAP scheme. Table 3 shows the recovery rate (%) for MAP and MPD as a function of energy resolution and detector voxel size. Three levels of energy blur were considered: 0.5%, 2.5%, and 12% FWHM at 511 keV. Two levels of depth resolution were also investigated: 1 and 5 mm. For MAP, \u03b2=0.85 was used for all measurements. It should be noted that was only optimized for a system with 2.5% energy resolution and 5 mm depth resolution.","For the example MAP method, higher detector spatial and energy resolution help position correctly a larger fraction of PMIEs. Also, MAP's recovery rate is less sensitive to the energy resolution than to the detector voxel size.","An example robust objective uses stochastic optimization via sub-voxel sampling to account for the geometrical properties of the detector voxels. Table 4 shows that the stochastic approach results in a higher recovery rate compared to a deterministic one (where, for example, the interactions are assumed to occur at the center of the detector voxel).","Point-Spread Function:  shows the detector coincident PSFs for all four example positioning methods. For a normal beam (0 degrees), the PSF was plotted along the axial () and tangential () dimensions. The tangential component of the PSF was also plotted for 30 degrees () and 60 degrees () beams. Due to the 5 mm depth resolution of the example detector, the PSF is wider and asymmetric for photons incoming at an oblique angle. The PSF is not normalized, and therefore a higher peak value indicated that more counts are correctly positioned at the PSF center. The worst case error is smaller for EWM (\u224830 mm) than for MAP or MPD (40 mm), because the earliest interaction pulls the center of mass towards itself. Nevertheless, the average error is lower for both MAP and MPD than for EWM.",{"@attributes":{"id":"p-0125","num":"0130"},"figref":"FIG. 9"},"Reconstructed Contrast: The system PSF affects the final image quality. Therefore, the contrast versus noise trade-off was investigated for five hot spheres in a warm background of activity ().  shows the images reconstructed using 100 sub-iterations of list-mode OSEM for all four positioning methods: EI, MAP, MPD, and EWM. The four pictures are shown on the same intensity scale to facilitate the comparison. Only two spheres can be resolved for EWM. For the other positioning schemes, all but the smallest sphere are resolved.",{"@attributes":{"id":"p-0127","num":"0132"},"figref":["FIG. 11","FIG. 11A","FIG. 11B","FIG. 11C","FIG. 11D","FIG. 11E"]},"Unlike the contrast recovery, the noise is not affected by mispositioning. Independently of the positioning method, the contrast is degraded by small angle tissue scatter and by random coincidences (randoms rate is around 10.6%). For this reason, it never reaches its true value (10:1), even for the ideal EI positioning scheme, which provides the highest contrast recovery (8.6 to 1). For the largest sphere, the contrast is 10% higher for MAP (7.5 to 1) than for the MPD scheme (6.8 to 1). The contrast difference is even greater for the smaller spheres: for the 2 mm sphere, the contrast is 24% higher for MAP than for MPD. It should be noted also that the contrast of the smallest spheres (1 and 1.5 mm) did not converge within a hundred iterations; however the noise prevents iterating further.","The EWM method demonstrated the worst performance for this task. The contrast is degraded to the extent that the small spheres (\u22662 mm) cannot be resolved. The contrast of the largest sphere is 46% lower, compared to MAP.","The CNR () provides a rough estimate of the detectability of hot lesions in a background. Lesion with CNR greater than 4 (shown as a dotted line) are usually detectable, even though observer experience and object shape can also affect the detectability. The dotted line represents the threshold for Rose criterion. According to this criterion, the 1 mm sphere can only be detected when the ideal EI positioning scheme is used. The 1.5 mm and 2 mm spheres are not detectable when EWM is used. The CNR is systematically higher for MAP than for MPD.","Reconstructed Sphere Resolution: The hot spheres phantom () was used to evaluate how the spatial resolution is affected by positioning when iterative 3D-OSEM reconstruction is used.  show the reconstructed images at 50 iterations for the four positioning methods (EI (), MAP (), MPD (), and EWM ()). The spheres are best resolved for the ideal EI scheme. MAP and MPD appear to perform similarly, but EWM shows substantial degradation of the spatial resolution.","Further investigation was performed by measuring the reconstructed FWHM of the spheres. This was done by fitting a Gaussian mixture with offset to multiple horizontal D profiles through the center of the spheres. The results of these measurements are reported in , for the 1.75 mm (), 1.5 mm (), and 1.25 mm () sphere sizes. Since the ML estimate is non-linear, the reconstructed FWHM should be analyzed with care and should not be interpreted in terms of modulation transfer function. However, it defines the ability of the algorithm to distinguish small lesions that are close to each other. It should also be noted that the reconstructed sphere FWHM is not expected to be equal to the real sphere size.","Due to parallax blurring and despite 5 mm depth resolution, the reconstructed sphere size is degraded for spheres away from the center of the FOV. The ideal EI scheme provides the best reconstructed FWHM, followed by MAP and MPD. Due to fewer mispositioned events, the reconstructed 1.75 mm spheres were on average 5.6% smaller for MAP than for MPD. As observed in , EWM adds a substantial amount of blur to the reconstructed images. The profile through the 1.75 mm spheres () shows that, besides the FWHM, the contrast of the spheres is affected by positioning.","Example robust Bayesian methods have been provided for reconstructing sequences of interactions in detectors, allowing identification of the first interaction in the sequence. When MAP is used in an example embodiment, two times fewer events are mispositioned compared to MPD, a simpler algorithm. As a result, the PSF has lower tails and higher peak value, because more events are positioned to the correct LOR. MAP is also less susceptible to mispositioning events in which the photon undergoes back-scatter. This directly affects the reconstructed image quality. The contrast is higher for MAP positioning that for MPD. Mispositioning causes contrast loss because events that were emitted from the hot lesion are positioned in the background. The CNR is greater for MAP than for MPD and EWM, which implies that small lesions have a better chance of being detected in a clinical setting. In addition, MAP provides better quantitative accuracy. Images reconstructed using MAP positioning show higher spatial resolution, which allows the detection of hot objects.","The full sequence of interactions can also be reconstructed by optimizing the prior distribution alone (i.e., \u03b2=1 in MAP). Like MPD, this example approach has the advantage that energy measurements are not needed. Furthermore, MAP with \u03b2=1 can outperform MPD (e.g., by 4.4%, as shown in ).","The size of the search space used for recovering the first interaction grows linearly with N, as does the number of energy measurements. Therefore, the performance of the example MAP method is maintained even as N increases. When recovering the full sequence, the size of the search space increases exponentially with N; hence, the recovery rate for complete sequences drops sharply for N=4.","Uncertainty in the locations of the interactions (within the detector voxel boundaries) translates into uncertainty in the scatter angle, which, in turn, yields uncertainty on the energy deposited. Position uncertainty in 1\u00d75\u00d71 mmdetector voxels causes an equivalent energy blur far greater than 12% FWHM at 511 keV. When the interactions are constrained to fixed detectors voxels, the range of energies that can be deposited is often much larger than the energy resolution of the system. Therefore, good spatial resolution is more important than good energy resolution for estimating correctly the order of the interactions.","PMIEs have been previously corrected using a simple positioning method (such as EWM), and then by incorporating an accurate model of the PSF to reconstruct the images. However, by effectively deconvolving the PMIE blur, this approach amplifies the noise. It is therefore preferable to use a positioning method, such as the example MAP method, prior to reconstruction, to estimate the location of the first interaction. Incorporating the resulting PSF into the reconstruction will generate less noise amplification because such a PSF is narrower. This requires, however, that crystals can be individually read out.","The described validation of the example MAP scheme was carried out based on simulations that included the standard Compton model based on the Klein-Nishina formula, the accurate linear attenuation coefficients from published databases, and the standard photoelectric model. Other physical effects can occur, such as characteristic X-ray production, Raleigh scattering, Bremsstrahlung and Doppler broadening, etc. Furthermore, the electron is neither free nor at rest, and therefore the Klein-Nishina formula is not accurate for Compton scattering of low (<100 keV) energy photons. The example method was therefore applied to a dataset using GATE, a more detailed Monte-Carlo package that incorporates all these effects (except Doppler broadening). For a point source in the center, the recovery rate dropped from 85.0% to 82.4% for MAP, and from 70.1% to 67.9% for MPD. This drop is mostly caused by the production of a characteristic X-ray that can propagate beyond boundaries of the detector voxel, in which case the number of interactions recorded increases. Doppler broadening was not modeled in any of the simulations. For 511 keV photons, Doppler broadening blur is at most 6 keV FWHM. Energy blurring remains dominated by the finite resolution of the detectors. In addition, high recovery rate (e.g., 84.5%) can still be achieved even with larger energy blur.","A particular example method assumes that the photon incoming energy eand the location of other coincident photon p are available. While true for PET, these assumptions should not be made for other modalities that may be assisted under other embodiments of the present invention, such as but not limited to single photon emission computed tomography (SPECT) or Compton cameras. Example methods, however, can be generalized for these modalities. The incoming energy ecan be estimated by summing the energies of all the interactions. When p is unavailable, the likelihood should not include the first interaction because the scatter angle cos {circumflex over (\u03b8)}cannot be computed.","The example MAP objective can be readily extended to be used as criteria for rejecting tissue scattered events and random coincidences. An example formulation assumes that the incoming photon energy eis 511 keV, and that the incident angle is given by the location p of the other photon pair. When the photon scatters in tissue or is paired up incorrectly (random coincidence), the assumption does not hold. As a result, no sequence might be attributed a high probability, and the event can be discarded.","MAP positioning according to example embodiments of the present invention can also be applied to crystals other than CZT. In a nonlimiting example, high-resolution detectors with depth-of-interaction capabilities can be built from lutetium oxyorthosilicate (LSO) coupled to thin position-sensitive avalanche photodiodes (PSAPD). These detectors do not offer as good an energy resolution as CZT, but the example MAP positioning scheme has high recovery rates even with 12% energy resolution FWHM. It should also be noted that, due to a higher photo-fraction, PMIEs occurs less often in LSO than in CZT.","While various embodiments of the present invention have been shown and described, it should be understood that other modifications, substitutions, and alternatives are apparent to one of ordinary skill in the art. Such modifications, substitutions, and alternatives can be made without departing from the spirit and scope of the invention, which should be determined from the appended claims.","Various features of the invention are set forth in the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIGS. 6A-C","FIG. 6A","FIG. 6B","FIG. 6C"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 8","FIG. 8A","FIG. 8B","FIG. 8C","FIG. 8D"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 10","FIG. 10A","FIG. 10B","FIG. 10C","FIG. 10D"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIGS. 11A-F","FIG. 11A","FIG. 11B","FIG. 11C","FIG. 11D","FIG. 11E","FIG. 11F"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIGS. 13A-13D","FIG. 13A","FIG. 13B","FIG. 13C","FIG. 13D"]}]},"DETDESC":[{},{}]}
