---
title: Fast common mode feedback control for differential driver
abstract: A system and method for a fast stabilizing output buffer. A differential driver circuit is provided with an amplifier stage for receiving a differential input signal and generating a differential output based upon the input signal. The differential output has a corresponding common-mode (CM) voltage level typically based upon a value half of the power supply. A common-mode feedback buffer (CMFB) stage detects a change in the CM voltage level and recovers the CM voltage level to its desired value within a very fast settling time based upon a very high bus frequency. The CMFB stage utilizes a topology comprising only a single device. In one embodiment, this single device is a nmos transistor utilized as a transimpedance stage. Stability is provided by a circuit biasing stage and a shunting capacitor within the CMFB stage.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07906994&OS=07906994&RS=07906994
owner: Standard Microsystems Corporation
number: 07906994
owner_city: Hauppauge
owner_country: US
publication_date: 20090224
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","This invention relates to electronic circuits, and more particularly, to an efficient method for a fast stabilizing output buffer.","2. Description of the Relevant Art","Very high-speed networks and computer buses continue to increase demand for bandwidth. By utilizing differential signaling, high-speed serial bus architectures are improving in order to satisfy this demand. Differential signaling electrically transmits information by means of two complementary signals sent on two separate wires. This technique can be used for both analog signaling, such as audio signal transmission, and digital signaling, such as within a Peripheral Component Interconnect (PCI) Express serial link interface and Universal Serial Bus (USB) interface.","One advantage of differential signaling includes a tolerance of ground potential differences between a transmitter and a receiver, since a receiver interface reads the difference between the two transmitted data signals and is not affected by the wires' voltages with respect to ground. Also, differential signaling is used with low voltages of mobile electronic devices since it provides twice the noise immunity of a single-ended system. Differential signaling helps to reduce the number of wire routes, or signal traces, and helps to reduce power consumption.","Differential signals are driven between a transmitter and a receiver by a differential amplifier, or differential driver, comprising a differential pair. If the input devices on a complementary metal oxide semiconductor (CMOS) differential pair are all nmos transistors, and the loads are either inductors or resistors, then a common-mode feedback buffer (CMFB), or loop or amplifier, is unnecessary. A CMFB is not required in this case, since the output resistance of this type of differential pair is weighted down by the low resistance of the inductor or resistors.","However, if a high-impedance transconductor, such as a nmos or a pmos transistor, is loaded with a high-impedance current source, such as a pmos or a nmos transistor, respectively, then a CMFB becomes necessary. Small differences between the bias current of the transconductor and the bias current of the load can induce large swings in voltage when multiplied by the high resistance of the output node.","In order to obtain a stable and predictable output signal, first, the CMFB needs to center the common mode output signal to a fixed but arbitrary chosen reference voltage. For maximal output voltage swing, a value that is half of the supply voltage is preferred. Second, the bandwidth of the CMFB has to be greater than the bandwidth of the differential amplifier. This requirement ensures the differential amplifier has a predictable and stable output response even with high frequency input signals. Third, the common mode input voltage range of the CMFB needs to be greater than the differential output range of the differential amplifier. And, fourth, the differential input range of the CMFB has to be greater than the differential output range of the differential amplifier.","Prior communication bus protocols utilizing Low Voltage Differential Signaling (LVDS) require an enabled CMFB to settle within hundreds of microseconds. Newer bus architectures utilizing similar techniques as LVDS require higher frequencies on the bus. Therefore, the CMFB is required to settle at a faster rate, such as a few nanoseconds, in order to maintain the corresponding differential data rate. This new settle time requirement for the CMFB is not met by current designs. The typical much slower settling times help eliminate signal stability problems. In order to maintain current circuit topologies, substantial power may need to be used to reach the new speeds. However, the bandwidth will be limited and stability issues arise with the unknown loads that can be coupled to the output.","In view of the above, efficient methods and systems for a fast stabilizing output buffer are desired.","Systems and methods for a fast stabilizing output buffer. In one embodiment, a differential driver circuit is provided with an amplifer stage for receiving a differential input signal and generating a differential output based upon the input signal. The differential output has a corresponding common-mode (CM) voltage level based upon a predetermined reference CM voltage level. A common-mode feedback buffer (CMFB) stage detects a change in the CM voltage level from the predetermined reference CM voltage level and recovers the CM voltage level to the reference CM voltage level within a very fast settling time based upon a predetermined high bus frequency. The CMFB stage utilizes a topology comprising only a single device. In one embodiment, this single device is an nmos transistor utilized as a transimpedance stage. Other embodiments may utilize a single pmos transistor or a single bipolar junction transistor. Stability is provided by a circuit biasing stage and a shunting capacitor within the CMFB stage.","Also contemplated is a method to very quickly provide serial data on a communication bus. Differential output data is conveyed on the bus with an associated common-mode (CM) voltage level typically half of the value of the power supply. The method comprises detecting a change in the CM voltage level and recovering the CM voltage level to its desired value within a recovery time corresponding to a predetermined high bus frequency. This frequency may be a couple hundred megahertz (MHz).","These and other embodiments will be appreciated upon reference to the following description and accompanying figures.","While the invention is susceptible to various modifications and alternative forms, specific embodiments are shown by way of example in the drawings and are herein described in detail. It should be understood, however, that drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed, but on the contrary, the invention is to cover all modifications, equivalents and alternatives falling within the spirit and scope of the present invention as defined by the appended claims.","In the following description, numerous specific details are set forth to provide a thorough understanding of the present invention. However, one having ordinary skill in the art should recognize that the invention may be practiced without these specific details. In some instances, well-known circuits, structures, and techniques have not been shown in detail to avoid obscuring the present invention.","Referring to  one embodiment of a communication bus  utilizing differential signals is shown. This embodiment does not include all examples of functional blocks, control logic, circuitry, and interfaces required both within and outside transmitter  and receiver . The embodiment shown is for a simple illustrative purpose.","An alternative to a common ground signal method is a differential voltage signal method, wherein each bit is represented by the difference of voltage levels between a ground-isolated pair of wires, such as the first pair signal+  and signal\u2212  and the second pair output+  and output\u2212 . Communication bus  does not utilize a voltage between one wire and a common ground. A parallel to serial port signal converter may feed the input signal . Circuitry referred to as a Serializer\/Deserializer (SerDes) may be used to supply input data on inputs signal . SerDes is a pair of functional blocks commonly used in high speed communications. These blocks convert data between serial data and parallel interfaces in each direction. The differential signal method may limit both the capacitive and inductive effects imposed upon each signal and the tendency for the signals to be corrupted due to outside electrical interference, thereby significantly improving the practical distance of a serial network.","Transmitter  may comprise a differential amplifier in order to drive a differential voltage signal between signal+  and signal\u2212 . Similarly, receiver  may comprise a differential amplifier in order to drive a differential voltage signal between output+  and output\u2212 . The signal routes , , , and  may not be electrically common with a ground reference.","Having eliminated any relation between a voltage signal and ground on these lines, the only significant capacitance imposed on the signal voltage may be the cross-coupled capacitance existing between the two signal wires, such as capacitors -. As used herein, elements referred to by a reference numeral followed by a letter may be collectively referred to by the numeral alone. For example, capacitors -may be collectively referred to as capacitors . Capacitance between a signal wire and a ground reference now may be of much less effect, because the capacitive path between the two signal wires via a ground reference is two capacitances in series. For example, a path from signal+  to ground reference includes capacitor . Then a continued path from ground reference to signal\u2212  includes capacitor . This path includes the series combination of capacitors  and  and series capacitive values are always less than any of the individual capacitances.","Furthermore, any noise voltage induced between the signal wires  and  and ground reference by an external source may be ignored. The reason for this is that noise voltage likely may be induced on both signal wires  and  in equal measure, and receiver  may only respond to the differential voltage between signals  and , rather than the voltage between either signal+  or signal\u2212  and ground reference. Communication bus  may be more widely used in networks than a common ground reference method in industrial applications where longer wiring distances and greater potential for electrical interference from AC power wiring exists.","Design parameters used to provide a high frequency protocol on signals  and  may need to standardized in order to be useful for a wide range of applications. The Open Systems Interconnection Reference Model, or OSI Model, is an abstract description for layered communications and computer network protocol design. It was developed as part of the Open Systems Interconnection (OSI) initiative. In its most basic form, it divides network architecture into seven layers which, from top to bottom, are the Application, Presentation, Session, Transport, Network, Data-Link, and Physical Layers.","A layer is a collection of conceptually similar functions that provide services to the layer above it and receives service from the layer below it. For example, a layer that provides error-free communications across a network provides the path needed by applications above it, while it calls the next lower layer to send and receive packets that make up the contents of the path.","The Physical Layer defines the electrical and physical specifications for devices. In particular, it defines the relationship between a device and a physical medium. This may include the layout of pins, voltages, cable specifications, Hubs, repeaters, network adapters, or other.","The Data Link Layer provides the functional and procedural means to transfer data between network entities and to detect and possibly correct errors that may occur in the Physical Layer. The Network Layer provides the functional and procedural means of transferring variable length data sequences from a source to a destination via one or more networks, while maintaining the quality of service requested by the Transport Layer.","Newer network architectures for communication bus  may be developing to satisfy demands for higher frequencies and higher throughput of data. For example, one implementation, Media Local Bus (MLB) offered by Standard Microsystems Corp., is developed for the Physical Layer and the Link Layer. MLB is an on-printed-circuit-board (on-PCB) or inter-chip communication bus, specifically designed to standardize a common hardware interface and software application programming interface (API) library. This standardization may allow one or more applications to access network data, or to communicate with other applications, with minimum effort. MLB is also designed to provide a simple migration path from existing network architectures to next-generation architectures. MLB supports all network data transport methods including synchronous stream data, asynchronous packet data, control message data, and isochronous data transport.","Network bandwidth refers to the practical frequency limit of a network medium. In serial communication, bandwidth may be a product of data volume, such as binary bits per transmitted word and data speed, or words per second. The standard measure of network bandwidth is bits per second, or bps.","Because serial data requires the transmission of all data bits through the same wiring channel, such as in one embodiment signal+ , from transmitter  to receiver , it necessitates a potentially high frequency signal on the network wiring. Both data, such as 32 bits or 64 bits depending on the word size, and other bits necessary for parity checking and signal synchronization may be updated at a rate of thousands of times per second. Serial data network frequencies start to enter the radio range, and simple wires begin to act as antennas, pairs of wires as transmission lines, due to inductive and capacitive reactances. These parasitic characteristics may distort and slow down signal transmissions.","The higher speed requirements of newer network architectures as described earlier offer design challenges such as meeting these higher frequencies without appreciably sacrificing stability. Particularly, the design of the differential driver with a common-mode feedback buffer (CMFB) may require the greatest attention. For example, in addition to the higher speed parasitic characteristics, the signal lines  and , in one embodiment, may be coupled to multiple drivers, or transmitters . A particular transmitter  may be waiting to drive signals onto lines  and , and, therefore, circuitry within at least a CMFB stage is turned off in order to provide a tri-state output. Upon receiving permission to drive a differential output on lines  and , the circuitry within at least the CMFB stage of this particular transmitter  may need a very quick response from the time of being enabled to a time of reaching a settled state, such as providing a common-mode voltage level for signal lines  and . In one embodiment, this fast response, due to newer network architectures, may be reduced from previous values of hundreds of microseconds to only a few nanoseconds.","Turning now to , one embodiment of a generalized diagram of a differential driver  with common mode feedback is shown. Referring again to , driver  may be utilized within the output circuitry of transmitter  or receiver . The simplified diagram of driver  may be implemented by many known circuit topologies and techniques as known to those skilled in the art. In one embodiment, a reference common-mode voltage signal, Vcmref , is supplied to feedback amplifier . Also, the voltage level at a common-mode node, such as Vcm , may be supplied to feedback amplifier . The common-mode node is between two series resistors  and  that may have the same value such as 1 kohm in one embodiment. A current source  supplies current to corresponding circuitry and may be implemented by a current mirror or other topology. Input signal  may be used to determine which nodes are supplied with current from source  via switches  and , which may be implemented by known transistor topologies.","In prior designs the common mode feedback loop, or CMFB, formed by amplifier , resistor , and resistor  was designed to be much slower than the differential data rate on output lines  and , which helps to eliminate many stability issues. Typical settling times measured from the time driver  is enabled to the time node  settles to a predetermined common-mode voltage level, are in the hundreds of microseconds.","However, newer communication bus architectures, such as the MLB briefly described above, require much faster speeds from the CMFB such as a settling time within 5 nanoseconds. For example, driver  controls the common mode voltage on the lines  and , or the bus, via the CMFB and when enabled the CMFB needs to settle within 5 ns. The previous circuits for the feedback amplifier  typically requires 5 or more transistors, which is an appreciable footprint in the driver design. Also, unless substantial power is used in current implementations of the feedback amplifier , its bandwidth will be limited and stability issues arise with the unknown loads that can be attached to the output.","Referring now to , one embodiment of a differential driver  with common-mode feedback for high-speed differential data rates is shown. Referring again to , driver  may be utilized within the output circuitry of transmitter  or receiver . An input, or amplifier, stage , which also acts as a driver stage, comprises pmos transistor  and nmos transistor . Transistors  and  both receive an input signal, which may be a differential input signal, and generate a differential output on lines  and . In one embodiment, transistors  and  may be one half of a H-bridge, wherein the other half is not shown for ease of illustrative purposes and an H-bridge is well known to those skilled in the art. A common-mode feedback buffer (CMFB) stage  comprises nmos transistor  configured as a transimpedance stage, resistor  and capacitor  on the gate terminal of transistor , and resistors  and .","The remainder of the circuitry of driver  may be used for biasing and stability purposes. Current sources  and  may be implemented by any topology known by those skilled in the art. These current sources and pmos transistor  and the current mirror implemented by pmos transistors  and  provide predetermined current values to the circuitry below. The current values supplied by the output drains of pmos transistors  and  may be an integer multiple on one another based on the sizing, such as the transistor width, of these transistors. In one embodiment, pmos transistor may be 4 times the width of pmos transistor , and, thus, pmos transistor  supplies 4 times more current than transistor .","In order to obtain a fast response required by a very high-speed network bus architecture, such as the MLB specification, a single device transimpedance stage may be used to control the common-mode voltage. In one embodiment, a single device transimpedance stage utilizes a single nmos transistor, such as transistor . In another embodiment, a pmos transistor or a bipolar junction transistor may be utilized. In other embodiments, other single transistor configurations may be utilized to provide a fast reponse required by a high-speed network bus architecture. The combination of nmos transistor  and resistors  and  provide the CMFB circuitry for driver . When enabled, the gate terminal of nmos transistor  senses the common-mode voltage, Vcm , at the center of resistors  and  through a series resistor .","The voltage potential at the gate terminal of transistor  is maintained at the gate-to-source turn-on voltage, Vgs, of transistor . However, this Vgs value may not be the desired common-mode voltage for driver . Therefore, a replica circuit may be used to attempt to provide the desired common-mode voltage level, Vcmref , at the center of resistors  and . Note that there may be a slight variation from this value, and, therefore, this node voltage is represented as Vcm . In one embodiment, the replica circuit comprises the combination of nmos transistor , current sinks , , and ; and current sources , , and . This replica circuit may be used to generate sufficient current through series resistor  in order to create a voltage drop that provides the voltage level Vcm  at the node between resistors  and .","This replica circuit produces a direct current and does not require a fast response. Therefore, the replica circuit may be implemented by a well know classical voltage feedback topology. Transistors  and  may need to match one another such as having very similar geometric width and channel length, turn-on threshold voltage level, and other. Note that the ground reference return for the matched transistors  and  are separated from the ground reference for the current sinks , , and . Transistors  and  utilizes ground reference Vsspwr  and the current sinks utilize ground reference Vss .","The current through transistor  may reach a very high amount, such as a few milliamperes, which may produce a significant voltage drop to the ground pin Vsspwr . The current mirror, comprising pmos transistors  and , in combination with pmos transistor  may subsequently increase the amount of current drawn and the drain terminal of transistor  may experience both a voltage and current increase. Therefore, the significant voltage drop to the ground pin Vsspwr  produced by transistor  may be sensed by transistor . Accordingly, the voltage drop across resistor  may increase, single-ended differential amplifier  may output a voltage larger than the Vgs value of the nmos transistors in driver , and current sink  may turn on stronger and draw more current. Then the voltage drop across resistor  may increase and thereby the voltage level at Vcm  may decrease and return to a value similar to the desired common-mode voltage level Vcmref  referenced to the node Vss . This compensation may take longer than the enable time for the CMFB, which may be a few nanoseconds, but the error is appreciably small, such as in the range of 20 mV.","Ideally, amplifiers have a near-constant gain for a given frequency range and the gain rolls off at higher frequencies. Transient and frequency response of feedback amplifiers are related to a pole location characteristic of the amplifier in question. Non-ideal amplifiers typically have more than one pole. The negative feedback provided by the replica circuit of driver  may require frequency compensation in order to avoid the unintentional creation of positive feedback, which will cause driver  to oscillate, and to control overshoot and ringing.","A pole is the point in a frequency response curve where the amplitude decreases by 3 db due to an integrating resistance and capacitive reactance. Ultimately, each pole will result in a phase lag of 90\u00b0, or the output signal will lag behind the input signal by 90\u00b0 at this point. Capacitances within the gain stages of an amplifier cause the output signal to lag behind the input signal by 90\u00b0 for each pole they create. Pole splitting is a type of frequency compensation in which a capacitor is introduced with the intention of moving the pole lowest in frequency, typically an input pole, to lower frequencies and the pole next in frequency, typically an output pole, to a higher frequency. This pole movement increases the stability of the amplifier and improves its step response at the cost of decreased speed.","Driver  of  may have two poles. One pole is partially provided by the gate-to-source parasitic capacitance of transistor  and a second pole is provided by capacitor  coupled to the output, or drain terminal of transistor . The placement of capacitor  across resistor  cancels the pole formed by the parasitic gate-to-source capacitance of transistor  and the series resistance formed by the on-state resistance of transistor  and resistors , , and . Capacitor  can't be connected to the center of resistors  and  since this node may be disconnected when the output is disabled and it is not desirable to have extra capacitance left on an output node.","Driver  may provide a high-speed settling CMFB for a differential amplifier by including a diode connected nmos transistor , wherein the drain terminal is connected to the gate terminal via the on-state resistance of transistor , resistor , and resistor . Stability for driver  may be provided by the described replica circuit and capacitor .","Although the embodiments above have been described in considerable detail, numerous variations and modifications will become apparent to those skilled in the art once the above disclosure is fully appreciated. It is intended that the following claims be interpreted to embrace all such variations and modifications."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
