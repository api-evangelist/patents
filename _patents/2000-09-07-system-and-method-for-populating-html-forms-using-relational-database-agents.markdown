---
title: System and method for populating HTML forms using relational database agents
abstract: A hybird Notes/DB2 environment provides a requisition catalog on the Web. Client browsers are connected to a GWA infrastructure including a first network dispatcher and a virtual cluster of Domino.Go servers. The network dispatcher sprays out browser requests among configured .nsf servers in virtual server cluster. Communications from this virtual server cluster are, in turn, dispatched by a second network dispatcher servers in a Domino cluster. External objects, primarily for a GUI, are served in a .dfs and include graphic files, Java files, HTML images and net.data macros. The catalog is built from supplier provided flat files. A front end is provided for business logic and validation, as also is a relation database backend. HTML forms are populated using relational database agents. A role table is used for controlling access both to Notes code and DB2 data. Large amounts of data is quickly transferred using an intermediate agent and window.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06950983&OS=06950983&RS=06950983
owner: International Business Machines Corporation
number: 06950983
owner_city: Armonk
owner_country: US
publication_date: 20000907
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS REFERENCES TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","BEST MODE FOR CARRYING OUT THE INVENTION","1. Clustered Servers","2. Front End","3. Back End","4. Catalog Administration","5. Role Table GUI","6. Relational DB Agents","7. Data Transfer","8. Customizable Side Bar","9. Populating HTML Pages from a Relational Database","10. Open Catalog File","ADVANTAGES OVER THE PRIOR ART","ALTERNATIVE EMBODIMENTS"],"p":[{"@attributes":{"id":"p-0002","num":"0000"},"ul":{"@attributes":{"id":"ul0001","list-style":"none"},"li":[{"@attributes":{"id":"ul0001-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0002","list-style":"none"},"li":"The following U.S. patent applications filed concurrently herewith are assigned to the same assignee hereof and contain subject matter related, in certain respects, to the subject matter of the present application, the teachings of which applications are incorporated herein by this reference:"}},"Ser. No. 09\/657,215, entitled \u201cSystem and Method for Clustering Servers for Performance and Load Balancing\u201d;","Ser. No. 09\/657,216, entitled \u201cSystem and Method for Front End Business Logic and Validation\u201d;","Ser. No. 09\/657,217, entitled \u201cSystem and Method for Data Transfer With Respect to External Applications\u201d;","Ser. No. 09\/656,037, entitled \u201cSystem and Method for Providing a Relational Database Backend\u201d;","Ser. No. 09\/656,803, entitled \u201cSystem and Method for Providing a Role Table GUI via Company Group\u201d;","Ser. No. 09\/657,196, entitled \u201cSystem and Method for Catalog Administration Using Supplier Provided Flat Files\u201d; and","Ser. No. 09\/657,195, entitled \u201cSystem and Method for Providing an Application Navigator Client Menu Side Bar\u201d."]}},"1. Technical Field of the Invention","This invention pertains to a system and method for managing a requisition catalog on the web.","2. Background Art","A requisition catalog for a large enterprise in a web environment must enable very fast access to a very large database from a large number of clients. A large number of clients is required for optimal performance of a catalog system. There is a need to architect such a system so as to be scalable, that is, capable of providing that fast access to an ever increasing number of clients and a growing database or collection of databases.","In a requisition catalog system for a large enterprise in a web environment, there is a requirement for a system and method for insuring that all general ledger accounts associated with commodities are correct, and within this requirement for providing a description from the associated accounting system for use by customer or requester to select the correct general ledger (GL) account when doing financial validation on a requisition.","A requisition catalog for a large enterprise is stored in a very large database. However, a Lotus Notes database has a hard limit of 2 to 4 gigabytes of data. That is, Notes puts its entire database into one big Notes standard format(.nsf) file. Information in such a .nsf file is accessed by a system geometrically. As a result, such a system slows down significantly as it accesses larger files. This slow down ramps up rather badly. Consequently, the hard limit is artificially put in because of this ramp up in access time. The typical solution to this problem is to split a very large database into many smaller databases. Lotus Notes has a Lotus connector\/Lotus script extensions connector (LCLSX). This allows connection to other databases but these script extensions are not set up to actually be the database. There is a need in the art for a system and method for utilizing Lotus script extensions in combination with a relational database to provide high capacity storage without performance degradation.","In building a requisition catalog for a large enterprise with many suppliers, an automated process is needed to receive a flat file from a supplier for review by a buyer before being externalized for use by requesters. While the buyer must be able to review the contents, he must be restricted from making changes to certain sensitive fields, such as changing a unit price or a unit of measure, both of which could constitute fraud. Consequently, allowing the buyer to edit the flat file can't provide the level of security required. There is a need in the art to provide a buyer a means of auditing catalog content before externalizing it to production for access by requesters.","A requisition catalog for use in a web environment requires a very large database, such as an IBM DB2 database, and the functionality provided by, for example, a Lotus Notes server. However, a Lotus Notes access control list (ACL) can not be used to control access to an IBM DB2 database, and the privileges on a DB2 table can be granted only by the table instance owner. Additionally, since Notes agents which access DB2 are running from a Notes server, the Notes server ID often has full access to all tables, and there is no way to limit that. That is, in a hybrid (Notes\/DB2) environment, the user ID which accesses DB2 tables is the ID of the Notes server. Therefore, access by a user to the DB2 tables can't be restricted with current technology. There is a need in the art for a system and method which allows certain users access to certain data in certain selected tables. That is, there is needed a system and method for providing very flexible access to DB2 tables without requiring database administrator (DBA) involvement to issue grants against the tables, and bypassing the problem caused by Notes agents all coming from the same user (the Notes server ID).","In a hybrid requisition catalog system for use in a web environment, much of the application data is stored in, for example, IBM DB2 tables. However, a web interface written in Java script and in HTML does not have functionality for connecting to DB2 and reading data from DB2 tables. No function is provided in Java script and in HTML to connect to or access such a database. It is not presently possible to make the connection by connecting to the database and executing SQL queries. Consequently, there is a need in the art for a system and method utilizing an existing infrastructure including Lotus Notes, Domino Go, and DB2 to combine HTML and Java script web presentation with DB2 data.","In a requisition catalog system for use in a web environment by a large enterprise, there must be provided a way to deal with web sites that exist outside of a firewall, or internal applications within the firewall but outside of the requisition catalog (Req\/Cat Web or RCW) application. That is, a system and method is required for transferring a large quantity of data back from such a web site or application to the RCW application in a timely manner. One possible way is to send data on the universal resource locator (URL). However, such a URL is limited to 1 K bytes, which is not enough to do the task quickly for the quantities of information required. Information can be put into a frame, and that information can be read, but only if the information is written and read by the same server.","In a preferred system, the RCW application exists in a frame set in a browser. As part of security for such a browser, Netscape and Internet Explorer (IE) establish ownership of the frames: each frame is a window under control of the browser. A user can open up a session in any frame desired. However, if all of the frames are not owned by same session, then these frames not commonly owned cannot see the contents of each other. In Netscape version 4.51 frame ownership was changed to protect against frame spoofing. Frame spoofing is a way other servers can use to trick the owner of a frame into thinking it had created a frame actually created by someone else, enabling access to data not owned. Netscape 4.51 plugs that hole.","Consequently, in the new environment (with spoofing inhibited) a problem is presented: if a RCW application needs to access an outside supplier site for information to get back through one its own the frames, as soon as data is written by that outside supplier site into one of the frames owned by RCW, ownership of the frame is transferred from RCW to the supplier; RCW no longer owns the frame and cannot access the information. A system and method is needed to enable transfer of data from a supplier site to a RCW application which does not entail frame spoofing.","In a web application, such as a requisition catalog system for a large enterprise, a fast browser interface and navigator is needed, including a very fast graphical user interface (GUI).","There is known in the art several Internet applications which provide a strip down, for example, the left hand side of a window that has menu of items from which a user may select. Such windows also may display a header, including header type items which will expand upon selection into a drop down list. Such windows also may include a footer including leafs which will, upon selection, change what is seen on right side of screen. Such applications provide a very nice user interface for documents, with a table of contents (TOC) on the left, and on the right the selected contents.","However, these expandible and collapsible menus are characteristically slow. This slowness is a result of every click sending a request to a remote server, which server responds by sending information back to expand the list at the browser. Every click on the web is slow, involving communications of the request and response over a relatively slow web communication link. There is, therefore, a need in the art to dramatically increase the speed of operation of a graphical user interface at a browser.","It is an object of the invention to provide a scalable database system in a web environment with optimal access performance characteristics for an expanding number of clients and a growing database.","It is an object of the invention to provide a system and method for enabling a requester to select the correct general ledger account when doing financial validation on a requisition.","It is an object of the invention to provide a system and method for utilizing Lotus script extensions in combination with a relational database to provide high capacity storage without performance degradation.","It is an object of the invention to provide a system and method for enabling a buyer a means for editing catalog content before externalizing it to production for access by requesters.","It is an object of the invention to provide a system and method for providing very flexible access to DB2 tables without requiring database administrator (DBA) involvement to issue grants against the tables, and bypassing the problem caused by Notes agents all coming from the same user (the Notes server ID).","It is an object of the invention to provide a system and method utilizing an existing infrastructure including Lotus Notes, Domino Go, and DB2 to combine HTML and Java script web presentation with DB2 data.","It is an object of the invention to provide a system and method for enabling transfer of data from a supplier site to a RCW application which does not entail frame spoofing.","It is an object of the invention to provide a system and method for dramatically increasing the speed of operation of a navigation frame of a GUI.","A system and method for generating a web presentation in a hybrid environment. A page display hypertext markup language is written to a browser display, and an agent is executed to read data from a database table and dynamically populate the data to the page display.","Other features and advantages of this invention will become apparent from the following detailed description of the presently preferred embodiment of the invention, taken in conjunction with the accompanying drawings.","In accordance with the preferred embodiment of the invention, a requisition catalog system (RCW, or Rec\/Cat Web) is provided within a global web architecture (GWA) infrastructure. Such an architecture provides for the large number of clients required to assure good performance. In an exemplary embodiment, the requisition catalog application is deployed within the IBM web domain, which requires the use of GWA for clustering of W3 and www.ibm.com web sites. This architected solution assures a scalable Req\/Cat Web application.","Referring to , client browsers  are connected to a GWA infrastructure including network dispatcher  and domino.go, a virtual cluster of Domino servers. Network dispatcher , sprays out or dispatches requests among configured servers S, S, S in virtual server cluster . Communications from cluster  are, in turn, dispatched (also referred to as sprayed out, distributed, proxy passed, or redirected) by network dispatcher  among servers S, S, and S in Domino cluster . While three servers are illustrated as configured in each of clusters  and , each cluster configuration may be scaled to any number of servers. External objects , which can be stored on a distributed file system (.dfs), include graphic files, Java files, HTML images, net.data macros, and other .nsf files external to Domino, and in particular include configuration file proxy statements . In this instance, external objects  are stored on a .dfs and exist only once, so it is not necessary to replicate all of the external objects to each of the servers S\u2013S. External objects , served in a .dfs are graphic files, Java files, anything that would live outside of the server files (also referred to .nsf files) S\u2013S, including HTML images and net.data macros. These are part of the code implementing the Req\/Cat Web application of the preferred embodiment of the invention, but are not part of Domino code, and are primarily for the GUI. By storing them outside of cluster servers , performance is improved.","In order to avoid potential bottlenecks on the clustered Domino servers  and in order to store a larger amount of data than is quickly searchable in Domino, a relational database , such as the IBM DB2 database, is used to store configuration data. Data is written by the clustered servers  by the end user, or by batched programs stored on application server  that are receiving data from back-end systems .","Referring to , in accordance with the invention, a proxy pass is used with both domino.go cluster  and Domino cluster . In accordance with a proxy pass, when a URL  is passed to network dispatcher , the NP processes that out and sprays it to any one of the configured servers. Spray means to distribute or map a URL  to any one of these configured servers S\u2013S, S\u2013S, which is the effect of mapping, as is represented by line , URL  to any of S, S, S in cluster . Examples of URLs include <w3.ibm.com\/*>, <www.ibm.com\/*>, and <w3.ibm.com\/transform\/reqcat\/?opendatabase rccreate>.","In accordance with the invention, a unique architecture for a requisition catalog system includes a hybrid application using external objects  in a distributed file system off of the domino.go cluster  that works with network dispatcher  and the proxy pass capability  to redirect traffic to the Domino cluster .","These servers S\u2013S are mirror images: each has same .nsf files. Periodically, these servers replicate back and forth so that information is contained in all of them. Data is kept consistent.","In operation, when a client comes in through browser , his request can be directed to any domino.go server S\u2013S that determines the mapping of the URL request and what type of function is needed (displaying of images or code execution on S\u2013S, or connecting to an .nsf server S\u2013S to display user data).",".nsf servers S\u2013S then feed requests to the application server , which in this embodiment is a backend Req\/Cat Web (RCW) server to which all data gets replicated and where the bridges and agents run. Data gets replicated out to other back-end servers (DB2, MVS, SAP)  as needed. A bridge is an application that transfers data from one server to another server. An agent is an application that runs scheduled or by request to do some processing of data.","In an exemplary embodiment, Domino.go, or virtual server cluster,  is part of the GWA infrastructure. Any w3.ibm.com or www.ibm.com must go through a domino.go cluster . In accordance with the present invention a proxy out to the Domino cluster  is also provided. The purpose of this is to improve scalability and performance. Proxy statements  are used to ensure that the proper pieces of the application are invoked as appropriate, depending upon what the end user is doing. These statements are a mapping through a configuration file of URL  to any clustered server .","Referring to , a specific exemplary embodiment of the invention includes client browser  connected to network dispatcher (URL redirect) , which is connected to GWA shared GO cluster (W3-1.IBM.COM) . Cluster  is connected to external objects including OBI  and DFS , to dedicated DB2 server , and to network dispatcher (proxy) . Dispatcher  is connected to dedicated Domino \u201cend user\u201d cluster . Cluster  is connected to Blue Pages database  (an internal personnel database), dedicated DB2 server , dedicated Domino \u201capplication\u201d server , and other Notes databases , including Skills Matching (an application for contracting technical services), AMNF (an application for identifying nonmanager requisition approvers), and public address book (PAB, for user login and authentication). Application server  is connected to FormWave  (an application that does approval form routing), PRISM\/Copics  (which are requisition feeder systems on MVS and AS\/400), SAP  (an ERP, or enterprise resource planning system, including an accounting application having an accounts payable function), dedicated content staging server  where an administration Notes client  runs, and dedicated DB2 server . The content staging server is used to update both .nsf and DB2 configuration data, and is also connected to server .","The architecture of  presents a complex, scalable global procurement application (referred to as Req\/Cat Web) implemented within Global Web Architecture (GWA). Req\/Cat Web allows customers to generate on-line, general procurement requisitions. Customers interfacing client browser  can search through vendor catalogs to select items and fill in order information. Submitted requisitions are routed through an approval process using FormWave . Requisitions that have been approved are sent to a back-end system (SAP) , where a purchase order is cut and billing occurs. Customers can monitor their requisition status, as the back end sends status updates to the application .","Technologies utilized in building Req\/Cat Web include the following: Domino.Go  provides a proxy passing function and caching facility. Lotus Notes\/Domino is used for its security and workflow capabilities. DB2 provides rich relational database functions and data management. Net.Data is used for its catalog searching functionality. Javascript is used for GUI presentation and data verification. Req\/Cat Web application code sits on DFS , on the Domino cluster servers , and on Domino application server .","Architectural elements include load balancing, file storage, end-user front end (which reside in the Domino cluster servers ), back-end processing, external dependencies, and use of frames.","For load balancing, Req\/Cat Web uses the GWA proxy pass architecture, documented in the presentation currently available on the Notes\/Web application CoC Web site at http:\/\/w3.coc.ibm.com\/coc\/cocweb.nsf\/Homepages\/gwatrain.html.","Network dispatchers ,  are used between the client  and the Domino.Go cluster  and also between the Domino.Go cluster  and Domino cluster  to automatically balance the load of http requests among servers S\u2013S and S\u2013S. Configuration file (httpd.conf)  contains the proxy statements that are used for redirections. When a client  enters the url (w3.ibm.com\/transform\/reqcat) and Network dispatcher  redirects the client to the appropriate server , the redirection is transparent to the client.","Workload is split between Domino.Go  and Domino  to improve performance.","File storage is provided by dynamic file system (.dfs, or DFS) , which contains javascript files (.js), html, images, and net.data macros. Domino servers  contain navigation, configuration, create requisition, open requisition, requisition invoice paid, requisition archive, cost center, confirmations, and help databases. DB2 server  contains tables including: confirmations, user profiles, zip codes, accounting data, commodity configuration data, buyer information, routing, and catalogs.","An end-user front end for Req\/Cat Web uses Domino authentication to permit login to the application. The client uses his Lotus Notes ID and pre-set http password to \u201cauthenticate\u201d. When a client logs in at browser , the Domino servers  (S\u2013S) are configured to check the name and password in public address book , which is a designated server within GNA. In a further exemplary embodiment, secure login function may be provided through the implementation of digital certificates. Data is retrieved from DB2  using LC:LSX calls via Notes agents, or Net.Data. Net.Data is used for a catalog searching and drill-down function. Java APIs are used for information retrieval from BluePages .","As much processing as possible is performed asynchronously on the back-end, application server . Bridge jobs are scheduled on two levels: system level (CRON) and notes level (Agents). Agents run periodically, say hourly, to process requisitions and send them to SAP . Other agents are scheduled off-peak, where ever possible.","External dependencies include FormWave for form approval routing, BluePages for personal data for user profile creation and approver changes, interfaces to Open Buying on the Internet (OBI) server and skill matching applications, and SAP for receiving requisitions for purchase order (PO) creation and processing. Information returned by SAP to Req\/Cat Web includes requisition status, PO\/RFS status, PO history, negative confirmations, currency codes, and configuration information.","By using frames, a large majority of preprocessing can be performed dynamically, on the client, reducing the number of trips back and forth to the server. This is a tremendous boost to performance. The web screen described hereafter is not he result of a Notes form, but rather of a dynamically generated HTML\/javascript code produced by a displayReqHeader( ) function. This function dynamically writes html and javascript code into the content frame of the application. The javascript function is coded in a displayreq.js file stored on the filesystem and loaded into a jsCode frame by a source (<script src=\u201c.\/js\/displayreq.js\u201d>) command in a jscode.html file at the time when the initial frameset is loading. A displayReqHeader( ) function is called from several places in the application to redisplay the requisition information in the content frame. This screen is called any time a WebReq Lotus Notes form is opened by an OpenForm command for a new requisition, or by an OpenDocument command when an existing document is opened. OpenForm occurs when the displayReqHeader( ) javascript function is called as the last part of an OnLoad event coded in the HTML-Attributes property of the WebReq form. Any time an existing document is opened that was saved with Form-WebReq, the OnLoad event causes the displayReqHeader( ) javascript to be run to OpenDocument. Any time a content frame has been loaded with some other page during the processing of a requisition, and the user performs an action to return to the requisition in process, the displyReqHeader( ) javascript function is called directly. This form reads the information stored in reData frame and dynamically fills the content frame with this screen.","Referring to , as will be more fully described hereafter, a screen display includes header frame , navigation frame , footer frame , temporary data frame , request data frame , and content frame . The tempData frame  is used as a temporary holder for information, and to direct calls dynamically, while keeping the current data in the screen, and making the return data available to the application.","Table 1 shows, for the exemplary embodiment of , the software loaded on each of the servers used for the Req\/Cat Web application.",{"@attributes":{"id":"p-0072","num":"0078"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 1"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"SERVERS AND SOFTWARE"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","Server Description","Software"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["2","Domino.Go Servers S1\u2013S3","AIX 4.3.2"]},{"entry":["3",{},"Domino Go 4.6.2.6 with"]},{"entry":["4",{},"Denial of Service Fix"]},{"entry":["5",{},"Net.Data 2.0.8"]},{"entry":["6",{},"DB2 CAE 5.2"]},{"entry":["7",{},"DFS Client"]},{"entry":["8",{},"Java Runtime 1.1.6"]},{"entry":["9","Domino End-User Servers S4\u2013S6","AIX 4.3.2"]},{"entry":["10",{},"Domino 4.6.4"]},{"entry":["11",{},"DB2 CAE 5.2"]},{"entry":["12",{},"Java Runtime 1.1.6"]},{"entry":["13","Domino Application Server 114","AIX 4.3.2"]},{"entry":["14",{},"Domino Go 4.6.2.6 with"]},{"entry":["15",{},"Denial of Service Fix"]},{"entry":["16",{},"DB2 CAE 5.2"]},{"entry":["17",{},"Java Runtime 1.1.6"]},{"entry":["18",{},"Mercator 1.4.2 with Svc"]},{"entry":["19",{},"Pack 3 Hith Test API"]},{"entry":["20",{},"Lotus VIM"]},{"entry":["21",{},"C++ 3.6.4"]},{"entry":["22","UDB Server 129","AIX 4.3.2"]},{"entry":["23",{},"UDB 5.2"]},{"entry":["24",{},"Java Runtime 1.1.6"]},{"entry":["25","Content Staging Server 127","AIX 4.3.2"]},{"entry":["26",{},"Domino 4.6.4"]},{"entry":["27",{},"DB2 CAE 5.2"]},{"entry":["28",{},"Java Runtime 1.1.6"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"The Req\/Cat Web front end provides several validation routines, including ZIP code validation, catalog search criteria, and chart of account validation. In the architecture of , various programs, including ZIP code validation, catalog search and chart of account validation routines reside in application server , and the data tables, including the chart of accounts, reside in the relational database .","ZIP code validation is provided to assure that the tax department is provided the information needed implement the correct tax rules on purchase orders in SAP .","Chart of accounts validation includes the mapping of commodity codes to account codes. This is done to insure that all general ledger accounts associated with commodities are correct, and within this to insure that a description from SAP  is available for use by a customer to select correct general ledger (GL) account when doing financial validation on a requisition.","Referring to , for ZIP code validation, when a purchaser access RCW, a user profile  is accessed. Profile  includes many defaults, one of which is delivery information (defaulted to all line items of requisition). One of the fields in profile  is ZIP code. When the purchaser enters his ZIP code, RCW searches ZIP code database , a database for ZIP codes which is fed periodically, say nightly, from the enterprise tax system . This same validation routine continues by creating a requisition  with item options, including deliver to information with a zip code field. The requester can change the deliver to information, , but any time it is changed, the ZIP code is checked against ZIP code database . Whereas previously, customer input of ZIP code was accepted without checking. By this invention, ZIP code validation is performed at the front end by a java or SQL program call to db2 database . Responsive to entry of ZIP code on a requisition or to the changing of delivery information which includes ZIP code on a requisition line item, the ZIP code is validated against a database of valid ZIP codes. In an alternative embodiment, the ZIP code database is refreshed from a trusted source, and the entered or changed ZIP code is checked for valid match with respect to state and city.","A create requisition request goes to catalog search, which used to search by part number or description. Previously, this was a very limited search to just the catalogs. A search argument of % pen % was not a very crisp search for the customer. In order to improve the catalog search, in accordance with the present invention, searches may be conducted against a longer description and files up to 255 characters. Screen down searches are provided for sub-commodity. Wild card searches used to require %, but now assumes a wild card search in all cases. Searches are also provided against subcommodity. As a result, catalog searches now reference short description, long description, and catalog sub-commodity. A database catalog includes part number, short description, long description, oem part number, commodity code. Newly added is subcommodity.","Referring to , the method of the preferred embodiment of the invention is described for managing a chart of accounts . When creating a commodity list, which includes expense, capital, and resale accounts , commodities descriptions  are pushed to the correct commodity group. The resulting chart of accounts  is available from SAP . Previously an administrator had input a chart of accounts. Now, a company administrator, for example, may select from commodity accounts  the expense field, which results in drop-down display of a valid chart of accounts  from SAP chart of accounts  with account numbers  and commodity descriptions . The company administrator may then select from that valid chart of accounts  the correct commodity to push to company\/commodity document .","Referring to , the process for a requester to create requisition is set forth. By way of example, a requester creates a requisition by doing in step  a search for \u201csupplies\u201d, which will bring to him in step  a display presenting commodity W, and thence in step  to a catalog (for example, a Staples catalog) which includes commodities (pens, erasers, calendars), from which the requester can create several line items. Upon selecting \u201cproceed to accounting\u201d, the requester is presented a financial summary  including commodity code w pens for line item , w erasers for line item , and w for line item  calendars. The user may then request display of financial worksheet . In this window , the requester will see a title  expense, which can be changed, for example, by toggling to other categories, such as balance sheet. Selecting G\/L account  may drop down a list showing several account codes  and related descriptions , depending upon what the company administrator has pushed to the commodity document  from which financial worksheet  is derived. Previously, a requester was provided in worksheet  one account code choice without description. By this invention, the requester is provided correct general ledger account codes and descriptions, resulting in less miscodes, more correct ledger entries, and correct SAP account codes. This improved general ledger account selection process avoids back end processing to correct erroneous entries.","Thus, in accordance with a preferred embodiment of the invention, a method is provided for creating a valid chart of accounts from which an administrator  can facilitate and enable a requisitioner to select a valid general ledger account. First, there is push from an enterprise (erp) system a chart of accounts  with descriptions to a req\/cat system database. The administrator selects from req\/cat system database valid accounts with descriptions for a given commodity and purchase time period, and then pushes the selected account\/description tuple to the company commodity groups, thus completing the setup of the commodity documents  to be used in the requisition creation process. A company commodity document  created by administrator  may include for each commodity code under each company, commodity code , which is a very broad catagory, short description , long description  (from procurement organization ), key words , approvers , financial information  (including purchase type , and general ledger account ), route-to buyer  (by plant association), preferred supplier  (which associates the commodity code to a catalog ), and special handling code  (with drop list including, for example, skills matching, obi, administrative services)\u2014all used to drive the customer to the correct commodity.","To create a requisition, a user searches against commodities and catalogs in commodity description documents , which may be Notes documents or DB2 records, and creates one or more line items. These searches may be done by catalog and non-catalog, and driven based on descriptions entered by requester. A hierarchy of families may be provided as an alternative search approach. The requisitioner initiates a proceed to accounting process, which displays line items which may be selected by requisitioner; and then displays a financial worksheet created by a Java agent with fields which need to be selected or populated by the requisitioner from the company commodity document, based on purchase type, and which presents valid general ledger accounts numbers and descriptions to the requisitioner.","Referring to , in a large enterprise, the requisition catalog requires a very large database. In accordance with the preferred embodiment of the invention, such a large data repository is provided by the using the IBM DB2 relational database . Other possible databases include Oracle, Sybase, and MSSQL.","Lotus Notes databases are built upon an object model and classes: databases, views, and documents are classes used to access Notes data. But, these classes are set to be final and not extendible, and a Req\/Cat Web database must be extendible.","Consequently, referring to , in accordance with an embodiment of the present invention, DB2 access routines  are provided for accessing DB2 data . The Req\/Cat Web application executes Lotus code, with access controlled on the code, and data obtained from and written to relational database .","Normally, Notes saves all data as documents. There is a save method provided for that purpose. In accordance with a preferred embodiment of the invention, the Notes save method is intercepted and stopped, and execution passed to Req\/Cat Web code for saving data to DB2. In the same way, execution of a Notes open method is intercepted and stopped, and then Req\/Cat Web code executed to pull information in from DB2.","Lotus Notes provides for web applications, and supports methods called webqueryopenagent, and webquerysaveagent. Notes also provides a saveoptions parameter. Setting saveoptions to zero tells Notes not to save a document.","In accordance with the preferred embodiment of the invention, saveoptions is set to zero, and webquerysaveagent used to save data in DB2. The webquerysaveagent is written in Lotus Script, and calls Lotus Script extensions and also can also call its own APIs , , including the database api's . At this point, Req\/Cat Web haves full control, and can save one or many tables, can explode the data model and write many tables.","On the other side, instead of editing an existing document as is done with Notes, Req\/Cat Web executes createnewdocument. As the document opens, Lotus Notes gives the query webqueryopenagent, and this is also written in Lotus Script, which has access to data base api's , where data from many database  tables may be read to construct a Lotus document from DB2.","This configuration involves some naming standards and a hierarchy of interfaces. By way of example, database access routines are, by convention, data application programming interfaces (DAPI) . These are routines for accessing data  outside of the Req\/Cat Web application. Referring to , a hierarchy of application program interfaces (APIs) includes core API's  containing everything necessary to connect to database . Next in hierarchy, to access specific data, are database API's (DAPI) , which interface to a single piece of data (such as company or employee information.) Below these rest the business logic code .","In a programming environment, the top of pyramid represents the work of a core DB2 programmer. Below him are those people who use core DB2 API's and write, for example, DAPI's  to access individual DB2 tables within database , for example API's for countries. These core APIs , therefore, include a GET method, and update, insert, and delete routines. Third level  represents the application programmer who only needs to use these methods (ie, company dapi: IBM US) in their business logic  applications, including ability to update, for example.","Referring to , this same pyramid is used to implement graphical APIs  on the user interface , business APIs  on the business logic  interface, and database APIs  on the database  interface. This illustrates that duties of programers can be separated, so that everyone need not know the complexities of the entire system. That is, some developers work on data manipulation, others on the user interface, and still others on business logic. The application developer need not know the names of the actual database, tables, or fields, or even how to access them. This also enables a DB2 administrator to alter a table, and only affect the one DAPI developer that wrote the specific table DAPI . All code is one routine, so changes to the database need only affect one piece of logic.","Referring to , an example of this API implementation is illustrated. CoreDB2  is the core API  to connect to DB2 . It contains two classes, configuration class DB2Config  and base class DB2Base .","Calling DB2Config  determines database name , user identifier , and password \u2014information that the database requires to establish a valid connection, and is passed to DAPI  for making that connection. (Without this method, user IDs and passwords would have to be hard coded in the application.)","DB2Base  is extended by the DAPI  programmer for each DAPI  instance that is needed. It contains methods ,  for connecting to and disconnecting from the database, a method  for defining the number of rows to return at a time, a method  for getting the next group of records, methods for reads , inserts , updates , and deletes , commit  and rollback  options, and a flag  to determine if all data has been retrieved.","DAPIUserProfile  is a class for retrieving or updating information about an employee. It extends DB2Base  so the application  developer would not have to write the logic to access DB2 , but could concentrate on the information about the employee. The DAPI  developer would need to know about the employee table (table and field names, for example) and would implement methods for selecting and displaying data. In an exemplary embodiment, DAPIUserProfile class methods include the following:\n\n","An application  like the human resources (HR) application would then need to read HR data and insert it into the employee table if the employee did not exist, or update it if something changed, or delete it if the employee no longer exists. This application developer would then only have to know the methods and properties of the userprofile class  in order to write the application. An example of such an application is set forth in Table 2, with reference to the steps of . This table sets forth the HR load routine, a batch program to read HR data from a flat file and insert it into the DB2 user profile table.",{"@attributes":{"id":"p-0097","num":"0114"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EXAMPLE APPLICATION"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1",{},"\u2018in the following step, instantiate a DB2 config"]},{"entry":["2",{},"object, and call it db2; the database name 230, etc.,"]},{"entry":["3",{},"is determined by instantiating the db2 config object,"]},{"entry":["4",{},"as defined by the core programmers\u2019"]},{"entry":["5","272:","Dim db2 As New DB2Config(session)"]},{"entry":["6",{},"\u2018the database information is known, and can be passed"]},{"entry":["7",{},"to the employee profile.\u2019"]},{"entry":["8","274:","Print \u2033The target DB2 database alias is \u2033&"]},{"entry":["9",{},"db2.getDB2DatabaseName (\u2009) )"]},{"entry":["10",{},"\u2018All that must be done is to pass the DB2 class to the"]},{"entry":["11",{},"userProfile.\u2019"]},{"entry":["12","276:","Dim eps As New userProfile(db2)"]},{"entry":["13",{},"\u2018Delete everything from the employee table to start the"]},{"entry":["14",{},"bridge.\u2019"]},{"entry":["15","278:","I headerDivision = \u201c\u2009\u201d Then"]},{"entry":["16",{},"\u2003Call eps.clearTable(\u2009)"]},{"entry":["17",{},"Else"]},{"entry":["18",{},"\u2003Call eps.deleteEmployeesWhere(\u201cCOGRPCD= \u201c\u2009\u201d"]},{"entry":["19",{},"\u2003&headerDivision &\u201d\u2009\u2033)"]},{"entry":["20",{},"End If"]},{"entry":["21","280:","For count = 2 To records\u22121"]},{"entry":["22",{},"\u2018Read the next record and make sure that it can be"]},{"entry":["23",{},"loaded without problems\u2019"]},{"entry":["24",{},"If ReadInputFile(inputFileNum, count, userid, al, cl"]},{"entry":["25",{},"eps, cci) Then"]},{"entry":["26",{},"\u2003Call eps.insertEmployee (DB2ColumnNames,"]},{"entry":["27",{},"BuildDB2ColumnValues (\u2009) )"]},{"entry":["28",{},"\u2003db2kAdditions = db2Additions+1"]},{"entry":["29",{},"End If"]},{"entry":["30",{},"Next . . ."]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"In Table 3, a pseudo code example of use of the webquerysaveagent process is illustrated.",{"@attributes":{"id":"p-0099","num":"0116"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 3"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"WEQUERYSAVEAGENT EXAMPLE"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1","Dimension db2 As New DB2Config(session)"]},{"entry":[{},"2","Print \u2033The target DB2 database alias is \u2033&"]},{"entry":[{},"3","db2 getDB2DatabaseName (\u2009) )"]},{"entry":[{},"4","Dimension eps As New userProfile(db2)"]},{"entry":[{},"5","execute process 260 to selectemployee by employee id"]},{"entry":[{},"6","if employee does not exist, then"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"7",{},"execute process 264 to insert employee"]},{"entry":[{},"8",{},"else if employee changed, then"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"9",{},"execute process 265 to update employee"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"7pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"10",{},"else (employee not changed) information to user"]},{"entry":[{},"11",{},"\u201cemployee not changed\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"12",{},"no save"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"7pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"13",{},"endif"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}]}}},"In the example of Table 3, an application programmer  is using a dapi written by programmers .","In this manner, the relational database  is used as the data source, instead of a Notes database, in a way that hides the complexities of DB2 database programming. That is, in a fashion to similar Notes programming\u2014the idea is to allow a Notes programmer to use a familiar looking class  to load and save data.","In accordance with the preferred embodiment of the invention, a requisition catalog administration function provides control, audit, and publishing procedures for flat files received from suppliers.","Referring to , a system architecture for implementing catalog administration includes a requester browser , a buyer browser , with net.data connections  and  to a dedicated DB2 server and DB2 database  having a staging table  and a production table  through network dispatcher  and Go cluster . Go cluster  is also connected through network dispatcher  and Domino cluster  to Domino application server . A buyer  accesses staging table  via net.data connection , and a requestor  accesses the production  table via net.data connection . This connection ,  is implemented as a single path, and the requester and buyer provided different levels of authority to access different tables ,  in DB2  over that same path. Buyer  can change selected fields in the staging table  and can update production table  from staging table . Requester  can only view (not change) the production table . The buyer at browser  is controlled by a GUI which contains access control list (ACL) control on fields, and edit authority for catalog access.","Referring to , this architecture further includes a catalog flat file , an application program  within application server , catalog administration function , Req\/Cat Web function , and WEB communications  and  connecting a catalog administration function with ACL control  and requester  to database .","In operation, catalog flat file  is received by application server  through firewall  via EDI and loaded into DB2 database  by application program . Catalog administration function  specific users  audit control over certain fields in staging table , and publishes the catalog data to the live, or production, system . Function  presents to buyer  a staging table  with a GUI front end, with selected fields enable and other fields not enabled to be personalized.","Catalog file  is a flat file containing catalog items in a column delimited format specified to supplier  by the enterprise.","Application server  manages database  containing staging table  and production table . A catalog file  comes to application server , which includes a program  for moving data from that flat file to staging table .","A buyer at terminal  accesses the staging table  on the web . He views catalog items and enters transactions with action button which transfers information from staging table  to production table . Production table  is referenced by req cat web , and staging table  is referenced by the catalog administration function  operated by the buyer . Typically, a buyer is member of procurement organization with responsibility for negotiating deals with suppliers. A requester  accesses production table  over web  to create and submit a requisition to SAP .","In accordance with the preferred embodiment of the invention, control over what buyer  can change is provided by a GUI in a process which loads a catalog  from a supplier into a production system .","Catalog files  come in from suppliers in an enterprise defined standard format, and the access to fields in that format is hard coded into the catalog administration function . Application server program  has error checking functions to assure validity of a catalog  from a supplier . Buyer  accesses staging table  through a catalog administration function  which has hard coded into it the access controls on the various fields in the catalog format. Production table , which is accessed by the requester , is updated periodically (upon buyer actuation) from the staging table .","Implementation of the invention involves several code procedures: there is a program  which loads a file  that is received via EDI into a table  in DB2. There are routines  which allow a buyer  to browse certain catalogs in the staging table  and change certain fields while being inhibited from changing others. And there are the routines  which take the approved catalog and migrate the data from the staging DB2 table  to the production DB2 table .","Referring to , a preferred embodiment of these processes are presented. In supplier system , supplier source data  is extracted and reformatted in step  to create catalog flat file  in the format specified by the enterprise. In step  that flat file is transmitted to the enterprise , as is represented by line , where it is accepted in step  into the enterprise EDI mailbox . In step , the data in the flat file in mailbox  is reformatted and put into generation data group (GDG) , a location for saving more than one file, so as to retain the last N iterations, and a archive entry made to processing log . In step , a delivery component executes to send data from GDG  to application server , as is represented by line , in the form of catalog flat file . In step , a delivery component receives the flat file and, as is represented by line , starts job scripts including MASSLOAD for reading the flat file and loading staging table , and as represented by line  alerts the buyer . As is represented by lines ,  and , respectively, MASSLOAD  accesses database server  procedures catalogs , products , and Req\/Cat Web , and makes an archival entry to processing log .","CatalogS  is the staging table  for the catalog profile, which provides for each catalog the supplier name, the start and end dates of catalog validity, the currency, and so forth.","ProductS  is the staging table  that holds the catalog parts, a listing by part number of price, description, and so forth.","Req\/Cat Web validate procedure  is a Java stored procedure for performing the initial validation of data received in flat file .","Front end  is a GUI used by the buyer, for example to update the catalog .","In operation, validation procedure  validates the format and identifies catalog changes to products , logging those changes in file . It then checks a flag in catalog , and if the flag is on invokes procedure  provided catalogs  does not indicate any critical errors. Validate and load procedure  then moves the contents of products staging table  into the appropriate production table , writing any errors to processing log . (In the event that procedure  does not call procedure , then buyer  intervention is required via GUI .) After procedure  completes execution, it may either stop, or if catalog  has a flag set on and catalogs staging table  indicates no critical errors, then procedure  will invoke validation and migration procedure . After validate procedure  completes, it has written to prodmessages file , and the buyer may use GUI  to read messages from file  and make any desired changes to staging table . They buyer may also choose to reject the catalog and, via step , contact the supplier to restart the process. This occurs if there is an error in the unit prices, which is an example of information in the catalog which a buyer is not authorized to change on his own.","After the buyer has used GUI  to make the values in staging table  acceptable, he sets the flag in staging table  which allows migration procedure  to run to move data from staging table  into production table , a relational database, such as Net Commerce (NC) or IBM DB2.","A preferred embodiment of the invention provides through use of a role table in DB2 database  (, or  in ) very flexible access to DB2 tables without requiring involvement by a database administrator (DBA) to issue grants against the tables, thus bypassing the problem caused by Notes agents all coming from the same user (the Notes server ID).","Everything in Lotus Notes, even code, is in documents which require access control list (ACL) controls on access. Consequently, the preferred embodiment of the invention uses Notes ACLs to access code. However, when accessing data, a role table  (see ) is used to build roles and permissions, and an object model is provided to generically access data from database , thus extending Notes to access a non-Notes data source . In order to configure DB2 to work in a Notes application environment, a single sign off is provided after getting through Notes code ACLs. This does not involve use of any of DB2's role tables and grants, but rather a single web ID  known to the Notes code to access the DB2 data.","Referring to , role table  includes for each of a plurality of user WEB ID's , the associated role  and level  of granularity at which the user is associated with the role. Example: for a role  of country administrator, the level  is the country id, and user with web ID  of 02 can update contract profiles for that country.","Any person at a browser  attempting to access a row in a DB2 table  must pass the role table  check. Further, for accessing a supplier table in DB2 , anyone can view the list of suppliers in the application that applies to the requesters country, but only the country administrator can update them.","User  identifies a user profile , which specifies the user name , web identifier , charge information , including country, company, work location) and delivery information  (including street, office, and building).","Thus, in accordance with the preferred embodiment of the invention, the web ID  for the browser user is used to control access to the Notes databases and to the DB2 databases. The Notes databases have code and documents which the user must access (including contract profiles, cost center profiles) and also tables in the DB2 database. A user must access both Notes databases and DB2 databases, and access to all of these databases is controlled based on the user web ID  through the use of role table .","In order to make and use the preferred embodiment of the invention, an implementer and user would do the following:\n\n","The invention allows a person's access to DB2 tables to be limited by the contents of a second db2 table rather than the grants issued by the DBA. In the Notes environment of the preferred embodiment of the invention, the ID which is actually granted the authority to the table is the Notes Server machine since the server accessing the db2 tables is the Notes server. Since the user web id is once removed, this provides a mechanism for applying a level of authority to the user to then apply to the db2 table. That mechanism is the role table.","Table 4 lists and describes the Req\/Cat Web tables of the preferred embodiment of the invention.",{"@attributes":{"id":"p-0128","num":"0149"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"329pt","align":"center"}},"thead":{"row":{"entry":"TABLE 4"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"REC\/CAT WEB ADMINISTRATION TABLES"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"126pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ADMINISTRATION",{},{}]},{"entry":["FUNCTION","TABLE","DESCRIPTION"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Access Authority","REQCAT.TROLEAUTHORITY","Maps a user to a role"]},{"entry":[{},{},"and the qualifier for"]},{"entry":[{},{},"that role (i.e., what level)"]},{"entry":[{},"REQCAT.TROLECODE","Defines the list of"]},{"entry":[{},{},"valid roles - Global"]},{"entry":[{},{},"Admin, Country Admin, etc"]},{"entry":["Account numbers","REQCAT.TACCOUNTPROFILE","Holds account codes to"]},{"entry":[{},"REQCAT.TLACCOUNTPROFILE","be validated against"]},{"entry":[{},"REQCAT.TACCTPROFDETAIL","Provides details about"]},{"entry":[{},"REQCAT.TLACCTPROFDETAIL","the account codes"]},{"entry":[{},"REQCAT.TACCT VALIDATION1","Holds account codes to"]},{"entry":[{},{},"be validated against,"]},{"entry":[{},{},"as well as what type of"]},{"entry":[{},{},"validation is occurring"]},{"entry":[{},{},"(i.e., against BMS,"]},{"entry":[{},{},"Remind, Project numbers,"]},{"entry":[{},{},"Customer numbers, etc)"]},{"entry":[{},"REQCAT.TACCTVALIDTYPE","Defines the list of"]},{"entry":[{},{},"validation types"]},{"entry":[{},"REQCAT.TCOMPCOA","Defines the GL account"]},{"entry":[{},"REQCAT.TLCOMPCOA","numbers that are"]},{"entry":[{},{},"available for each"]},{"entry":[{},{},"company code, and"]},{"entry":[{},{},"provides a translated description"]},{"entry":["Approver routing","REQCAT.TAPPROVERASSIGN","Links an approver to a"]},{"entry":[{},{},"type and a code (i.e. I\/T 0001)"]},{"entry":[{},"REQCAT.TAPPROVERPROFILE","Defines the approver's name,"]},{"entry":[{},{},"Web ID, etc."]},{"entry":[{},"REQCAT.TAPPRVTYPEPROF","Defines the types of"]},{"entry":[{},{},"approvers available to"]},{"entry":[{},{},"the application"]},{"entry":[{},{},"(capital, financial,"]},{"entry":[{},{},"I\/T, chemical, safety, tax)"]},{"entry":[{},"REQCAT.TCATLGAPPROVAL","Allows a catalog administrator"]},{"entry":[{},{},"to flag a catalog item as"]},{"entry":[{},{},"requiring chemical or safety"]},{"entry":[{},{},"approval in specific locations."]},{"entry":[{},{},"For example, toner is not considered a"]},{"entry":[{},{},"chemical item except in Vermont,"]},{"entry":[{},{},"because of special environmental"]},{"entry":[{},{},"laws in that state."]},{"entry":["Buyer routing","REQCAT.TBUYERPROFILE","Defines the owner of a buyer"]},{"entry":[{},{},"code and contact information"]},{"entry":[{},"REQCAT.TBUYERROUTING","Links a buyer to a commodity"]},{"entry":[{},"REQCAT.TBUYER SUPPLIER","Links a buyer to a supplier"]},{"entry":["Catalog profiles","RC.CATALOG","Defines the characteristics of a"]},{"entry":[{},{},"catalog - supplier, expiration date,"]},{"entry":[{},{},"currency, etc."]},{"entry":[{},"RC.CATPLREL","Defines the plants which are allowed"]},{"entry":[{},{},"to access this catalog"]},{"entry":["Commodity families","NC.CATEGORY","Defines the global list"]},{"entry":[{},{},"of commodity groupings"]},{"entry":["Commodity codes","RC.COMMOCODE","Defines the global list of"]},{"entry":[{},{},"commodities and identifies which"]},{"entry":[{},{},"family each belongs to"]},{"entry":["Company commodities","RC.COMMCOMP","Not all commodities may be valid"]},{"entry":[{},{},"for all companies. This table"]},{"entry":[{},{},"identifies which commodity codes the"]},{"entry":[{},{},"company wants to use."]},{"entry":[{},"REQCAT.TCOMMCOMPBUYER","Some commodities require that the"]},{"entry":[{},{},"user select a buyer from a"]},{"entry":[{},{},"predefined list."]},{"entry":[{},{},"This is the predefined list."]},{"entry":[{},"REQCAT.TCOMMCOMPCOA","This associates GL account codes"]},{"entry":[{},{},"with the commodity code."]},{"entry":[{},"REQCAT.TCOMMWLOCRCV","This defines for which work"]},{"entry":[{},{},"locations this commodity is"]},{"entry":[{},{},"\u2018receivable\u2019. This flag is forwarded"]},{"entry":[{},{},"to SAP for further use in"]},{"entry":[{},{},"receiving locations"]},{"entry":[{},"RC.SUBCOMMODITY","Some commodities are too broad and"]},{"entry":[{},{},"the need exists for sub-dividing"]},{"entry":[{},{},"the goods under this commodity so"]},{"entry":[{},{},"that different suppliers and"]},{"entry":[{},{},"different purchase processes can"]},{"entry":[{},{},"be used."]},{"entry":[{},"RC.SUPPSUBCOMM","This links a supplier to a specific"]},{"entry":[{},{},"subcommodity."]},{"entry":["Companies","RC.COMPANY","Associates SAP company codes with"]},{"entry":[{},{},"associated country. For example,"]},{"entry":[{},{},"IBM US contains three company codes"]},{"entry":[{},{},"for IBM, Lotus, and Tivoli."]},{"entry":["Countries","RC.COUNTRY","Holds the list of ISO country codes,"]},{"entry":[{},{},"i.e., US, FR, DE, etc"]},{"entry":["Company groups","REQCAT.TCOMPGRPTYPPROF","Defines the list of valid grouping"]},{"entry":[{},{},"types, such as ACCOUNT, UPROF"]},{"entry":[{},"REQCAT.TCOMPGRPPROFILE","Defines the list of group names and"]},{"entry":[{},{},"links them to their types, such as"]},{"entry":[{},{},"IBMUS - ACCOUNT and IBMUS - UPROF"]},{"entry":[{},"REQCAT.TCOMPANYGROUPING","Lists the company codes that belong to the"]},{"entry":[{},{},"specified grouping"]},{"entry":["Plants","RC.PLANT","Associates plant codes with company"]},{"entry":[{},{},"and country. A company can have many"]},{"entry":[{},{},"plants, a plant may belong to only one"]},{"entry":[{},{},"company."]},{"entry":["Suppliers","RC.SUPPLIER","Defines the characteristics of a"]},{"entry":[{},{},"supplier - name, code, contact"]},{"entry":[{},{},"information, location"]},{"entry":[{},"RC.SUPPCOMP","Defines which company"]},{"entry":[{},{},"codes may reference"]},{"entry":[{},{},"this supplier for"]},{"entry":[{},{},"purchasing"]},{"entry":["Work locations","REQCAT.TWORKLOCATION","Associates work locations with plant,"]},{"entry":[{},"REQCAT.TLWORKLOCATION","company, and country."]},{"entry":[{},{},"A plant can have one or more work"]},{"entry":[{},{},"locations, a work location may"]},{"entry":[{},{},"belong to only one plant."]},{"entry":[{},"REQCAT.TWORKLOCDELTOADDR","For those work locations which have a"]},{"entry":[{},{},"predefined CDC"]},{"entry":[{},{},"(Chemical Delivery Center) address"]},{"entry":["User profiles","REQCAT.TEMPLOYEEPROFILE","Holds employee information"]},{"entry":["Catalog parts","see FIG. 18, DB2 NCF","Hold part information,"]},{"entry":[{},"tables 368","category\/subcategory information, etc."]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"In accordance with a preferred embodiment of the invention, in a Notes\/DB2 hybrid environment, a Notes agent reads data from a DB2 table, and then dynamically populates that data to an HTML page. In this manner, an the existing infrastructure (including Notes, Domino Go, and DB2) is used to combine HTML and Java script web presentation with DB2 data.","Referring to , Notes agents  are used as intermediaries. Each such agent  reads DB2 tables , collects data using SQL select statements, and builds web page  dynamically, writing out the Java script and HTML to present the page on a Web browser, such as Web browser . The results of the DB2 searches also helps to determine which HTML needs to be written, something which standard HTML cannot handle. Thus, conditional logic may be used.","A plurality of agents  are provided. The premise is the same in all: figure out who is asking, and then tailor what is shown by what they are authorized to see. The example of Table 5 is the supplier profile agent.","This process makes use of the Notes connection function lsx:lc. This Lotus Script connection is a built in API for connectivity to relational databases. The lsx:lc connector is a Lotus provided API which allows connection to DB2.","For example, to display a list of supplier profiles, two DB2 tables  must be read: one provides a list of suppliers and the other is role table  (). When role table  is read, the code tests the users ability to edit (country admin for country of supplier), and may display the web page differently depending thereon. A dynamic feature of the invention is that straight text may be displayed, or with text with hyperlinks to open a supplier profile, as an example.","To make and use this preferred embodiment of the invention, the following is done:\n\n","Inputs to the method of this embodiment of the invention include the DB2 table to be read or updated, and the output includes HTML conditionally generated based on results of the DB2 table reads.","The HTML page being populated may, for example, provide a list of suppliers. Such pages may also be used in the requisition or configuration area of the application, displaying commodity codes, suppliers, and so forth.",{"@attributes":{"id":"p-0137","num":"0162"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 5"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EXAMPLE AGENT 440"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","This agent is invoked from the administration tab for \u2018supplier\u2019."]},{"entry":["2","It is presenting the user with a view of suppliers that have been"]},{"entry":["3","configured on the system. Based on the access authority of the"]},{"entry":["4","user, this list will be presented either as just text, for the"]},{"entry":["5","general user, or as hotlinks for an administrator to then open an"]},{"entry":["6","individual supplier profile and update it."]},{"entry":["7","Sub Initialize"]},{"entry":["8","\/\/setting up variables"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["9",{},"Dim src As New LCConnection (\u201cdb2\u201d)"]},{"entry":["10",{},"Dim fldLst As New LCFieldList (100)"]},{"entry":["11",{},"Dim suppname As LCField"]},{"entry":["12",{},"Dim suppcode As LCField"]},{"entry":["13",{},"Dim InfoView As AllInfoView"]},{"entry":["14",{},"Dim session As New NotesSession"]},{"entry":["15",{},"Dim doc As NotesDocument"]},{"entry":["16",{},"Dim sqlQueryString As String"]},{"entry":["17",{},"Dim flag As Variant"]},{"entry":["18",{},"Dim admin As Integer"]},{"entry":["19",{},"Admin=True"]},{"entry":["20",{},"Dim lclsxSession As LCSession"]},{"entry":["21",{},"Dim supplierdb As notesdatabase"]},{"entry":["22",{},"Dim configview As notesview"]},{"entry":["23",{},"Dim configdoc As notesdocument"]},{"entry":["24",{},"Dim lookuptype As String"]},{"entry":"25"},{"entry":["26",{},"On Error Goto errHandler"]},{"entry":"27"},{"entry":["28",{},"Set supplierdb=session.currentdatabase"]},{"entry":["29",{},"Set configview = supplierdb.getview(\u201cAPPVIEW\u201d)"]},{"entry":["30",{},"Set configdoc = configview.getfirstdocument"]},{"entry":["31",{},"lookuptype = configdoc.HRFormat(0)"]},{"entry":"32"},{"entry":["33",{},"Set doc=session.DocumentContext"]},{"entry":["34",{},"Set InfoView=New AllInfoView"]},{"entry":"35"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["36","\/\/connect to DB2"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["37",{},"InfoView.ConnectToDB2"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["38","\/\/Query the role table for users roles and authority levels"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["39",{},"If Not InfoView.CheckAdminPrivilegesOK (doc.CurrentUserName (0)) Then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["40",{},"Admin = False"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["41",{},"End If"]},{"entry":["42",{},"InfoView.DisconnectDB2"]},{"entry":"43"},{"entry":["44",{},"If (Admin = False) And (lookuptype = \u201cDON\u201d)Then"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["45",{},"Print\u201c<script>alert(\u2018You are not authorized to view Supplier"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["46","documents Please contact your procurement administrator if you have"]},{"entry":["47","questions\u2019);\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["48",{},"Print \u201chistory.go(\u22123)<\/script>\u201d"]},{"entry":["49",{},"Exit Sub"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["50",{},"End If"]},{"entry":"51"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["52","\/\/Begin printing out HTML from the agent"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"7pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"245pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["53",{},"Print \u201c<link rel=stylesheet type=\u201d\u2009\u201ctext\/css\u201d\u2009\u201chref=\u201d\u2009\u201c\/transform"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["54","\u2009\/reqcat\/css\/defaultstyles.css\u201d\u2009\u201c>\u201d"]},{"entry":"55"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["56",{},"Dim db2c As New db2config(session)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["57","\/\/Connect to DB2"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["58",{},"src.database = db2c.getDB2DatabaseName(\u2009) \u2032 \u201creqcat41\u201d"]},{"entry":["59",{},"src.Connect"]},{"entry":"60"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["61","\/\/build the SQL Query"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["62",{},"sqlQuerystring = \u201cselect SUNAME, SUID from RC.SUPPLIER\u201d"]},{"entry":["63",{},"sqlQueryString = sqlQueryString & \u201c order by SUNAME\u201d"]},{"entry":"64"},{"entry":["65",{},"If (src.execute(sqlQueryString, fldLst) = 0) Then"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["66",{},"Print \u201cYou do not have any supplier profiles to view.\u201d"]},{"entry":["67",{},"End"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["68",{},"End If"]},{"entry":"69"},{"entry":["70",{},"Set suppname = fldLst.Lookup (\u201cSUNAME\u201d)"]},{"entry":["71",{},"Set suppcode = fldLst.Lookup (\u201cSUID\u201d)"]},{"entry":"72"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["73","\/\/Print more HTML"]},{"entry":["74","Print \u201c<TABLE width=\u2018100%\u2019 cellpadding=\u20180\u2019 cellspacing=\u20180\u2019 >\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["75",{},"Print \u201c<BR><TR><TD class=\u201d\u2009\u201cbanner\u201d\u2009\u201c bgcolor=\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["76","\u201c3366cc\u201d\u2009\u201calign=\u201d\u2009\u201ccenter\u201d\u2009\u201c> Suppliers<\/TD><\/TR>\u201d"]},{"entry":"77"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["78",{},"Print \u201c<\/TABLE>\u201d"]},{"entry":"79"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["80","\/\/If the user is an admin, then provide a button for adding new"]},{"entry":["81","suppliers"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["82",{},"If Admin Then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["83",{},"Print \u201c<form>\u201d"]},{"entry":["84",{},"Print \u201c<input type=\u2018button\u2019 name=\u2018mybutton\u2019 value=\u2018Add"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["85","Supplier Profile\u2019 onClick=\u201d\u2009\u201cjavascript: document.location.href="]},{"entry":["86","\u2018.\/SUPPLIER?OpenForm\u2019;\u201d\u2009\u201c>\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["87",{},"Print \u201c<\/form>\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["88",{},"Else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["89",{},"Print \u201c<BR>\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["90",{},"End If"]},{"entry":"91"},{"entry":["92",{},"Print \u201c(table cellpadding=2 cellspacing=0 border=0>\u201d"]},{"entry":["93",{},"Print \u201c<tr><td class=\u201d\u2009\u201cbannersublevel\u201d\u2009\u201c ><B> Supplier<\/B><\/td>\u201d"]},{"entry":["94",{},"Print \u201c<\/tr>\u201d"]},{"entry":"95"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["96","\/\/Toggling background color on alternate rows"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["97",{},"flag = True"]},{"entry":"98"},{"entry":["99",{},"While (src.Fetch (fldLst) > 0)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["100",{},"If (flag) Then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["101",{},"Print \u201c<tr bgcolor=#CCCCCC>\u201d"]},{"entry":["102",{},"flag = False"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["103",{},"Else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["104",{},"Print \u201c<tr bgcolor=#FFFFFF>\u201d"]},{"entry":["105",{},"flag = True"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["106",{},"End If"]},{"entry":"107"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["108","\/\/If user is an admin, then print the supplier name as a hotlink"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["109",{},"If Admin Then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["110",{},"Print\u201c<td class=\u201d\u2009\u201cfield\u201d\u2009\u201c> <a href=.\/SUPPLIER?OpenForm&\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["111","& suppcode.text(0) & \u201c>\u201d&suppname.text(0)&\u201c<\/a> <\/td>\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["112",{},"Else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["113","\/\/otherwise just print it as text"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["114",{},"Print\u201c<td class=\u201d\u2009\u201cfield\u201d\u2009\u201c>\u201d &suppname.text(0) &\u201c<\/td>\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["115",{},"End If"]},{"entry":["116",{},"Print\u201c<td class=\u201d\u2009\u201cfield\u201d\u2009\u201c>\u201d &suppcode.text(0) &\u201c<\/td>\u201d"]},{"entry":["117",{},"Print \u201c<\/tr>\u201d"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["118",{},"Wend"]},{"entry":["119",{},"Print \u201c<\/table>\u201d"]},{"entry":["120",{},"End"]},{"entry":"121"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["122","errHandler:"]},{"entry":"123"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["124",{},"Print \u201c<br>\u201d & session.currentagent.name & \u201c - Line # \u201d &Str(Erl)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["125","& \u201c \/\/ Error \u201d & Str(Err) & \u201c: \u201d & Error$"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["126",{},"If (lclsxSession.Status <\u2009>LCSUCCESS) Then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["127",{},"Dim text As String"]},{"entry":["128",{},"Dim extcode As Long"]},{"entry":["129",{},"Dim exttext As String"]},{"entry":"130"},{"entry":["131",{},"Call lclsxSession.GetStatus (text, extcode, exttext)"]},{"entry":["132",{},"If (lclsxSession.Status = LCFAILEXTERNAL)Then"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["133",{},"Print \u201c<br>DB2 message: \u201d & exttext & \u201c code #\u201d &"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["134","Cstr(extcode)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["135",{},"Else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["136",{},"Print \u201c<br>Connector message: \u201d & text"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["137",{},"End If"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["138",{},"Else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["139",{},"Print Error$"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["140",{},"End If"]},{"entry":"141"},{"entry":"142"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["143","End Sub"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"In accordance with the preferred embodiment of the invention, a system and method is provided for transferring to a Req\/Cat Web (RCW) application in a timely manner large quantities of data from web sites that exist outside of a firewall, or internal applications within the firewall but outside of the Req\/Cat Web application.","For the purpose of the description of this embodiment, RCW exists in a frame set in a browser. A frame set divides a screen into logical and user-friendly sections called frames. As part of security for browser , Netscape and Internet Explorer (IE) establish ownership of the frames: each frame is a window under control of browser . Browser  can open up a session in any frame desired. However, if all of the frames open on a browser are not owned by same session, then these frames cannot see the contents of each other.","Consequently, the problem is presented: if RCW needs to access an outside supplier site  for information to get back through one its own the frames, as soon as data is written by that other site into one of the frame at browser , RCW no longer owns the frame and cannot access the information. So this aspect of the invention is concerned with data passing.","In accordance with the preferred embodiment of the invention, the supplier  opens a new window through normal Java script commands and writes its data into it, along with the name of the agent to run in RCW application server . That new window then calls one of the RCW processes, which is able to see the data because it is not in a frame and is therefore available for RCW to access. That process causes an agent to runs (in RCW) that can see that data and write it to a frame on the RCW side, resulting in RCW owning both the data and the frame. This allows RCW to reach NOTES information, and write that information to other frames. RCW owns the data and the frame. Ownership is established in the RCW application.","Consequently, by carefully tracking and controlling the sequence of opening windows, RCW can establish the origin from which data is coming, where the data is going, and which process owns it.","Those are the high points. Review: two sites are talking to each other using an intermediate window, doing a handoff of data and of ownership of both data and frame such that when it is time to supply information to the RCW application, RCW owns the data, frame and process.","Referring to , a system and method are provided for data transfer from a externally owned site to an application owned frame set which operates as follows. The RCW application opens a supplier site URL in a temporary frame . Upon user selection of go to supplier , as is represented by step , frame  opens the supplier window  as a separate browser session. Two windows are now open: the original application  with its window underlying, and a supplier window  over it with the supplier URL. The reason for doing this is that the supplier requires that the browser be full frame, not in a small frame set. The primary RCW application in window  is quiesced to a wait state. As is represented by steps , the user can now select from window  items to buy, search, or whatever the supplier deems is appropriate for a user to order his data. The user then issues the command to submit the order. In step , the supplier site then gathers content from order data entered at window , in step  formats the page, and in step  issues a call to Req\/Cat Web to open third window  with first agent . The supplier uses an enterprise specified agent name for first agent  when opening third window . Third window  is a window, but not a frame, and thus the Req\/Cat Web can get access to it even though it is opened by the supplier. First agent  includes an html form command  which defines the processing to be done on the contents  of the form now displayed in third window , and the supplier site writes into this third window  unique order identifying information. Once written, the browser activates the form. Once activated, it is a program in its own right, the html  that was written and any java script in it will execute. One of first things it does is look at the action in the form command and determine that this is the program that will run to deal with the contents of this form. That action program, or first agent , is a RCW action program on the RCW server that can see contents of third window  because it is not in a frame, and thus ownership is not critical. In step , first RCW agent  executes a program or process that writes the contents  of window  back into its frame set (temporary frame) , and then calls second agent  which references Java script code  and, as is represented by step , access Notes data on the Notes server, add content to the requisition, and issue the commands that send the order to be stored in the requisition. This is key, Req\/Cat Web has used its own process  to write into its own window , and knows who owns the data. First agent  process opened window  and writes the data to temporary frame  and then kicks off another process, second agent , that can read that data, can read and write to all of the frames  in the application, can access information from Lotus notes, and write all the information into the requisition.","Window  is provided by a supplier site from outside the application, and possibly also outside a firewall. Window  is an external application that allows execution of code  for performing search, select, submit (call enterprise server, which may be inside firewall), and order data, including gather content , formatting the page , and calling RCW  with the first agent  as an action form.","Window  is a window opened by the supplier to include a Req\/Cat Web agent, first agent . First agent  posts document contents to temporary data frame . As a variation, for skills matching, calls are made to the agents ,  with a parameter after placing the data to retrieve in a Notes database. The second agent  retrieves the data, can look up and add supporting data from yet another Notes database.","The key consideration here is, \u201cwho owns the frame\u201d. The server that owns the agent that last wrote a frame owns it, and can see its content, but cannot see any other frame's contents if they were written by another server's programs or agents.","Window  and first agent  act as an intermediary. Content  is owned by the supplier server , but the first agent  is owned by the Req\/Cat Web server . That first agent  then kicks off the rest of the process, passing the data and ownership to the RCW server  and the second agent . The second agent  can now can access Notes data on the Notes server , and issue the commands that send the order to be stored in the requisition.","In accordance with the preferred embodiment of the invention, a customizable side bar is provided. Dynamic HTML is used by the navigator responsive to user input to change data presented at the screen without having to communicate with a remote server.","Referring to , navigation frame or menu bar appears, typically, on the left of a display window, to display a plurality of menu boxes, including headers \u2013 and items \u2013. As a cursor is moved over the headers, each individual header is highlighted or some symbol , , , , respectively, rotated by, say, 45 degrees, so as to point either down or to the right, to indicate to the user the header which will, upon being clicked, toggled to either a collapsed or expanded state from its current expanded or collapsed state, respectively. As illustrated, headers  and  are in a collapsed state, and headers  and  are in an expanded state. When expanded, header  is expanded to show items \u2013, and header  to show items \u2013. The user may move the cursor to one of items \u2013, and select the item to update the data displayed in content frame .","Heretofore, when the user selects (clicks on) a menu header , there is generally a pause as the request is made to the server to obtain a new page including an expanded menu bar  including a display of the included items. In accordance with a preferred embodiment of the invention, when server loads the window to a client, all of the information required to load the menu bar  is provided, including information for the expanded menu items (but not the content frame associated with them). If a menu header  is clicked when in the collapsed state, the menu items \u2013 are shown or made visible and the following menu headers and items are moved relative to the expanded menu bar. If a menu item  is clicked, then communication with the server is required to load the content frame .","Upon initial load, all headers \u2013 are collapsed and all menu items are hidden. Menu headers \u2013 are displayed below each other with no gaps between them. Clicking on a last menu header merely shows all the menu items and moves nothing below it. Clicking on the first menu header would show all of its items and move every header and item a constant amount without changing its visibility state. (The display area  may be off of the window, but is available via the scroll bar .) In accordance with this embodiment of the invention, the result of selecting a header \u2013 is an instantaneous response from the client browser either expanding or collapsing the selected header and respectively displaying or removing from display the included items.","This is done using dynamic html (dhtml), which allows creation of divisions within a document. These divisions are equivalent to tab items, menu items \u2013, or headers \u2013. In Netscape, these divisions are called layers. In Explorer, the layers are called divisions. These divisions can be hidden or shown, and moved relative distances on the screen. The current state of the art is to use these divisions for moving or flashing graphics, but not for business applications such as menu bars. In accordance with the present invention dhtml at the client creates subtle changes, business like, in the menu bar  without requiring server communications. The use of dhtml is described at developer.netscape.com.","Java script code, executable at a client for inserting, showing, moving and updating a menu bar , is illustrated in Table 6.",{"@attributes":{"id":"p-0155","num":"0180"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 6"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"MENU BAR CODE"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","----JavaScript (appNav.js) --------"]},{"entry":["2","\/\/ appNav Class Constructor"]},{"entry":["3","----------------------------------------------------"]},{"entry":["4","\/\/ This class implements a JavaScript Object intended to represent"]},{"entry":["5","the Navigator function appNav(menuVar) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["6",{},"\/\/methods"]},{"entry":["7",{},"this.init = appNavInit;"]},{"entry":["8",{},"this.sizeit = appNavSizeit;"]},{"entry":["9",{},"this.toggletext = appNavToggleText;"]},{"entry":["10",{},"this.isItem = appNavIsItem;"]},{"entry":["11",{},"this.reverse = appNavReverse;"]},{"entry":["12",{},"\/\/ properties"]},{"entry":["13",{},"this.ns = document.layers;"]},{"entry":["14",{},"this.ie = document.all;"]},{"entry":["15",{},"this.loaded = 0;"]},{"entry":["16",{},"this.whichone = 0;"]},{"entry":["17",{},"this.whichgroup = 0;"]},{"entry":["18",{},"if ( this.ns ) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["19",{},"this.show = \u2018show\u2019;"]},{"entry":["20",{},"this.hide = \u2018hide\u2019;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["21",{},"} else {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["22",{},"this.show = \u2018visible\u2019;"]},{"entry":["23",{},"this.hide = \u2018hidden\u2019;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["24",{},"}"]},{"entry":["25",{},"this.menus = menuVar;"]},{"entry":["26",{},"this.max = menuVar.length;"]},{"entry":["27",{},"this.images = new Array(this.max);"]},{"entry":["28",{},"this.menuMove = new Array(this.max);"]},{"entry":["29",{},"for (i=0;i < this.max; i++) this.menuMove[i] = 20 *"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["30","(menuVar[i] \u22121);"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["31",{},"this.tabShow = [false, false, false, false, false, false, false,"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["32","false];"]},{"entry":["33","}"]},{"entry":["34","function appNavInit(\u2009) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["35",{},"var k=0;"]},{"entry":["36",{},"if (this.loaded == 0) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["37",{},"for (i=0; i < this.menuMove.length; i++) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["38",{},"this.images[i] = new Array(this.menus[i]);"]},{"entry":["39",{},"for (j=0; j < this.menus[i]; j++) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["40",{},"this.images[i]\u2009[j] = new Image (\u2009);"]},{"entry":["41",{},"pos = (\u201c0\u201d+i).slice(i>9,2) + (\u201c0\u201d+j).slice(j>9);"]},{"entry":["42",{},"this.images[i] [j].src = \u201c. .\/images\/men\u201d +"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["43","pos+\u201c.gif\u201d"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["44",{},"if (this.ie) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["45",{},"document.images[k].src=this.images[i] [j]."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["46","src;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["47",{},"k++;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["48",{},"} else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["49",{},"document.layers [\u201cD\u201d+pos].document."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["50","images[0].src=this.images[i] [j].src;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["51",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["52",{},"}"]},{"entry":["53",{},"this.loaded=1;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["54",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["55","};"]},{"entry":["56","function appNavSizeit(\u2009) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["57",{},"if (this.loaded==1) {this.loaded = 0; this.init(\u2009); }"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["58","};"]},{"entry":["59","function appNavToggleText(z) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["60",{},"if (this.loaded==1) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["61",{},"this.tabShow[z] = !this.tabShow[z]"]},{"entry":["62",{},"for (j=1; j<this.menus[z]; j++) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["63",{},"pos = (\u201c0\u201d+z).slice(z>9) + (\u201c0\u201d+j).slice(j>9);"]},{"entry":["64",{},"if (this.ie)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["65",{},"text = document.all(\u201cD\u201d+pos).style"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["66",{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["67",{},"text = document.layers[\u201cD\u201d+pos]"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["68",{},"if (this.tabShow[z])"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["69",{},"text.visibility = this.show;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["70",{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["71",{},"text.visibility = this.hide;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["72",{},"}"]},{"entry":["73",{},"for (i=z+1; i<this.max; i++) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["74",{},"for (j=0; j<this.menus[i]; j++) {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["75",{},"pos = (\u201c0\u201d+i).slice(i>9) + (\u201c0\u201d+j).slice(j>9);"]},{"entry":["76",{},"if (this.ie) {"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["77",{},"text = document.all(\u201cD\u201d+pos).style"]},{"entry":["78",{},"if (this.tabShow[z])"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["79",{},"text.pixelTop += this.menuMove[z]"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["80",{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["81",{},"text.pixelTop \u2212= this.menuMove[z]"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["82",{},"} else {"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["83",{},"text = document.layers(\u201cD\u201d+pos]"]},{"entry":["84",{},"if (this.tabShow[z])"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["85",{},"text.top += this.menuMove[z]"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["86",{},"else"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"119pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["87",{},"text.top \u2212= this.menuMove[z]"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["88",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["89",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["90",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["91",{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["92","};"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"In accordance with the preferred embodiment of the invention, LotusScript is used to generate HTML via \u2018print\u2019 statements and lclsx is used within a LotusScript agent to build SQL queries. There are variables in LotusScript which affect the result set from the query. In addition, not only is the data to be presented dynamic, but how to present it is also dynamic. That is, a general user and an administrator can query DB2 and receive back the same list of suppliers. However, the HTML generated for the general user will be only static text. The HTML generated for the administrator will be the same content, the same list of suppliers, but the supplier name will be rendered as a hyperlink to invoke another URL which will then open up the supplier profile for editing.","Table 7 presents a pseudo code description of the procedure for loading a catalog file.",{"@attributes":{"id":"p-0158","num":"0183"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 7"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"LOAD CATALOG FILE"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","Open catalog file"]},{"entry":["2","Insert new Catalog Header into RC.catalogs with a version"]},{"entry":["3","number of 0"]},{"entry":["4","while more catalog file records loop"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["5",{},"if PRODUCT record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["6",{},"insert a products record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["7",{},"if RECORDCOUNT record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["8",{},"save expected record count"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["9",{},"if STARTDATE record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["10",{},"update catalogs with the date"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["11",{},"if STOPDATE record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["12",{},"update catalogs with the date"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["13",{},"if VENDORSERIAL record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["14",{},"update catalogs with the serial"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["15",{},"if CATALOGID record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["16",{},"if we have SupplierID then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["17",{},"Make sure the supplier, catalog pair are same as in"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["18",{},"Database"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["19",{},"update new Catalog Header with catalog ID"]},{"entry":["20",{},"update existing version 0 catalog to be max(version)+1"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["21",{},"(this pushes what used to be \u201ccurrent\u201d, ie version 0,"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["22",{},"to the top of the history stack)"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["23",{},"if SUPPLIERID record"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["24",{},"if we have CatalogID then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["25",{},"Make sure the supplier, catalog pair are same as in"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["26",{},"Database"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"right"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["27","end while"]},{"entry":["28","Error if actual record count doesn't match expected record"]},{"entry":["29","count"]},{"entry":["30","Call Validate stored procedure to validate catalog"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"It is an advantage of the invention that there is provided a scalable database system in a web environment with optimal access performance characteristics for an expanding number of clients and a growing database.","It is an advantage of the invention that there is provided a system and method for enabling a requester to select the correct general ledger account when doing financial validation on a requisition.","It is an advantage of the invention that there is provided a system and method for utilizing Lotus script extensions in combination with a relational database to provide high capacity storage without performance degradation.","It is an advantage of the invention that there is provided a system and method for enabling a buyer a means for editing catalog content before externalizing it to production for access by requesters.","It is an advantage of the invention that there is provided a system and method for providing very flexible access to DB2 tables without requiring database administrator (DBA) involvement to issue grants against the tables, and bypassing the problem caused by Notes agents all coming from the same user (the Notes server ID).","It is an advantage of the invention that there is provided a system and method utilizing an existing infrastructure including Lotus Notes, Domino Go, and DB2 to combine HTML and Java script web presentation with DB2 data.","It is an advantage of the invention that there is provided a system and method for enabling transfer of data from a supplier site to a RCW application which does not entail frame spoofing.","It is an advantage of the invention that there is provided a system and method for dramatically increasing the speed of operation of a navigation frame of a GUI.","It will be appreciated that, although specific embodiments of the invention have been described herein for purposes of illustration, various modifications may be made without departing from the spirit and scope of the invention. In particular, it is within the scope of the invention to provide a computer program product or program element, or a program storage or memory device such as a solid or fluid transmission medium, magnetic or optical wire, tape or disc, or the like, for storing signals readable by a machine, for controlling the operation of a computer according to the method of the invention and\/or to structure its components in accordance with the system of the invention.","Further, each step of the method may be executed on any general computer, such as an IBM System , AS\/400, PC or the like and pursuant to one or more, or a part of one or more, program elements, modules or objects generated from any programming language, such as C++, Java, Pl\/1, Fortran or the like. And still further, each said step, or a file or object or the like implementing each said step, may be executed by special purpose hardware or a circuit module designed for that purpose.","Accordingly, the scope of protection of this invention is limited only by the following claims and their equivalents."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0028","num":"0034"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0029","num":"0035"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0030","num":"0036"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0031","num":"0037"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0032","num":"0038"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0033","num":"0039"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0034","num":"0040"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0035","num":"0041"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0036","num":"0042"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0037","num":"0043"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0038","num":"0044"},"figref":["FIG. 11","FIG. 10"]},{"@attributes":{"id":"p-0039","num":"0045"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0040","num":"0046"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0041","num":"0047"},"figref":["FIG. 14","FIG. 13"]},{"@attributes":{"id":"p-0042","num":"0048"},"figref":["FIG. 15","FIG. 1"]},{"@attributes":{"id":"p-0043","num":"0049"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0044","num":"0050"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0045","num":"0051"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0046","num":"0052"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0047","num":"0053"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0048","num":"0054"},"figref":"FIG. 21"}]},"DETDESC":[{},{}]}
