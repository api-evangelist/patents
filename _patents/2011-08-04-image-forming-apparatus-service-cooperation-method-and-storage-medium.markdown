---
title: Image forming apparatus, service cooperation method, and storage medium
abstract: An image forming apparatus includes a plurality of individual processing units respectively corresponding to a plurality of services that cooperate with the image forming apparatus via a network and configured to communicate with the services and perform individual processing corresponding to the services, a specifying unit configured to specify an individual processing unit corresponding to the service selected out of the plurality of services in response to a user operation from the plurality of individual processing units, and a generation unit serving as a module commonly used among the plurality of individual processing units and configured to generate screen information corresponding to the individual processing unit specified by the specifying unit based on the information managed by the individual processing unit.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08625139&OS=08625139&RS=08625139
owner: Canon Kabushiki Kaisha
number: 08625139
owner_city: Tokyo
owner_country: JP
publication_date: 20110804
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENTS"],"p":["1. Field of the Invention","The present invention relates to an image forming apparatus, a service cooperation method, and a storage medium.","2. Description of the Related Art","In recent years, in an image processing apparatus, on a real time operating system (a real time OS), an execution environment directed toward another built-in system (an execution environment such as Java\u00ae) has been constructed. Owing to the execution environment directed toward the built-in system, an application for controlling the image processing apparatus can be installed from the exterior and loaded. The execution environment directed toward the built-in system enables a developer to develop the application for the image processing apparatus in a common development language and a common development environment. Further, the image processing apparatus has been made highly-functional and multifunctional and a wide variety of image processing apparatuses have also been developed for a scanning function and a printing function. In recent years, an image processing apparatus, which is loaded with not only basic functions such as computerization and printing of a paper document such as a scanning function and a printing function but also a network interface (network I\/F), has been developed. An image processing apparatus, which is loaded with the network I\/F, cooperates with an external system and an external service connected via a network, to provide various solutions. Japanese Patent Application Laid-Open No. 2010-56770 discusses an image processing apparatus that cooperates with a document management system and can upload only scan data that matches a document management policy.","On the other hand, a use format of a computer based on the Internet, for example, a cloud computing environment has been paid attention to in recent years with respect to a network environment surrounding the image processing apparatus. In the cloud computing environment, a user uses computer processing as a service via a network. Particularly, various services are provided from a service providing apparatus, and the user can select the service according to his\/her own use format such as utility form.","Therefore, even in the image processing apparatus, it is important to provide a solution for improving efficiency of user's work in cooperation with various services.","In the cloud computing environment, a provider of the providing apparatus that provides the services and a provider of the image processing apparatus are not necessarily associating in a cooperative framework. Accordingly, in the service providing apparatus, an interface for inquiring whether the image processing apparatus can use the services is not necessarily prepared. More specifically, in the conventional image processing apparatus, a user interface (UI), scan processing, and print processing are required to be mounted according to the services. If the number of services that cooperate with the image processing apparatus is increased, therefore, mounted codes become huger.","One aspect of the present invention is directed to appropriately dealing with an increase in the number of services that cooperate with an image forming apparatus.","According to another aspect of the present invention, an image forming apparatus includes a plurality of individual processing units respectively corresponding to a plurality of services that cooperate with the image forming apparatus via a network and configured to communicate with the services and perform individual processing corresponding to the services, a specifying unit configured to specify an individual processing unit corresponding to the service selected out of the plurality of services in response to a user operation, from the plurality of individual processing units, and a generation unit serving as a module commonly used among the plurality of individual processing units and configured to generate screen information corresponding to the individual processing unit specified by the specifying unit based on the information managed by the individual processing unit.","Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.","Various exemplary embodiments, features, and aspects of the invention will be described in detail below with reference to the drawings.","The exemplary embodiments do not limit the present invention. All components described in the exemplary embodiments are not necessarily essential as means for solving the issue of the present invention.","A first exemplary embodiment will be described below.  illustrates an example of a basic software configuration of an image processing apparatus . An operating system (OS)  is an example of a first execution environment, and controls the whole image processing apparatus . The OS  includes a library group for instructing modules (or a central processing unit (CPU)) in a real time OS for respectively controlling various functions of the image processing apparatus  in real time so that the library group controls various functions including an option device and an expansion card connected to the image processing apparatus . The OS  further includes a module group for providing an interface command to applications that operate in an order higher than the OS .","A controller control unit  operates on the OS , and includes modules for controlling a scanner , a printer , and so on, described below. An application programming interface (API)  is responsive to a sequence of instructions input from the applications, to access the controller control unit . The API  sends a control command to devices connected to a network via a network interface (I\/F) , described below. An application  operates on the OS , and requests various types of processing from the controller control unit  via the API .","A virtual machine  is a second execution environment most suitable for executing specific applications, and is implemented by a virtual machine such as Java (registered trademark), for example. A virtual machine API  accesses the controller control unit  that operates on the OS  by the applications on the virtual machine , and has a function of a conversion module for calling the API  in the present exemplary embodiment.","A framework  is a module having a function of integrally controlling the applications on the virtual machine . An application management application  manages other applications on the virtual machine , cooperates with the framework , and downloads, uploads, deletes, and invalidates applications  and . The applications  and  operate on the virtual machine , and request various types of processing from the controller control unit  via the virtual machine API .","A resource management unit  manages resources used by the virtual machine , and operates on the OS . The resource management unit  sets a limit so that resources such as a memory more than previously determined cannot be used when the virtual machine , the virtual machine API , the framework , or all the applications on the OS  use the resources. For example, the resource management unit  performs control so that the application that displays a user interface (UI) cannot display the UIs if more than the predetermined maximum number of the UIs are displayed.","While the application is assumed to be the one (e.g., the application ) that operates in the second execution environment, it may be an application (e.g., the application ) that operates in the first execution environment.","A service cooperation method in which an image processing apparatus cooperates with various services (e.g., services for retaining data scanned by the image processing apparatus), to improve the efficiency of user's work in a cloud computing environment will be described.","Conventionally, when an image processing apparatus sends data representing a scanned document to an external service, data having any data format (hereinafter referred to as a file format or a data format, as needed) that can be generated by the image processing apparatus has been sent to the external service. Generally, under a network environment such as a local area network (LAN), an external server, which provides a service and is a sending destination can nearly always receive all data having a data format sent from the image processing apparatus. Since the external server is a general-purpose server that can receive binary data regardless of its data format, for example, a file transfer protocol (FTP) server, a server message block (SMB) server, and a web data valid (DAV) server, the image processing apparatus may nearly always send data having any data format.","If there exists a data format that cannot be received by the external server as the sending destination, the data format that cannot be received by the image processing apparatus is inquired for so that the type of data that can be sent from the image processing apparatus is controlled (see, e.g., Japanese Patent Application Laid-Open No. 2010-56770).","On the other hand, under the cloud computing environment in which various services are provided, a data format that can be received (stored) differs for each service. A data format that is stored differs for each service. When the image processing apparatus downloads and prints data, therefore, the data may not be printable depending on the type of data.","When data is sent from the image processing apparatus to the service in the cloud computing environment, or data is downloaded from the service and printed, the image processing apparatus is required to inquire an appropriate data format of the external server. More specifically, the image processing apparatus is required to inquire of the external server what a receivable data format is or whether data having a printable data format is retained, and to perform processing according to an inquiry result.","However, in the cloud computing environment, a provider of the external server and a provider of the image processing apparatus are not necessarily in a cooperative framework. Accordingly, an interface for the image processing apparatus to inquire of the external server is not necessarily prepared.","For such reasons, in order to enjoy the services in the cloud computing environment, a user interface, scan processing, and print processing are required to be mounted, respectively, according to the services in the image processing apparatus. Therefore, as the number of services that cooperate with the image processing apparatus increases, mounted codes become huger.","The above-mentioned will be described below more specifically with reference to .  illustrates an example of a functional configuration of an application  in an image processing apparatus  that sends and receives data to and from the general-purpose server under the network environment such as the LAN. The server can receive data having any data format. Therefore, the application  is mounted in consideration of only data that can be processed by the image processing apparatus .","More specifically, a scan setting UI  in a UI  displays a UI for performing setting for data that can be generated by the image processing apparatus . A print setting UI  in the UI  displays a UI for performing setting for acquisition of data that can be printed by the image processing apparatus . A scan processing control unit  performs processing only considering whether a setting content is consistent with a processing capability of the image processing apparatus  according to a setting content (setting value) in the scan setting UI . A print processing control unit  performs processing only considering whether a setting content is consistent with the processing capability of the image processing apparatus  according to a setting content (setting value) in the print setting UI . A service communication unit  sends and receives a file (a document) according to an FTP, an SMB, a web DAV, or the like.","An example of an image processing apparatus (an image processing apparatus ) that sends and receives data to and from various services under the cloud computing environment will be described below.  illustrates an example of a functional configuration of an application  in the image processing apparatus . The application  needs to be mounted also in consideration of data that can be processed by a service (external server). A user interface, scan processing, and print processing are mounted for each service. The application  assumes that it sends and receives data to and from two services, i.e., a service A and a service B. In a UI , a scan setting UI  for a service A (service A scan setting UI) is data that can be generated by the image processing apparatus , and displays a UI for making setting for data that can be received in the service A. Similarly, a print setting UI  for a service A (service A print setting UI) is data that can be stored in the service A, and displays a UI for making setting for acquisition of data that can be printed by the image processing apparatus .","A scan processing control unit  for a service A (service A scan processing control unit) performs processing considering whether a setting content is consistent with not only a processing capability of the image processing apparatus  but also a data storage capability in the service A according to a setting content in the service A scan setting UI . A print processing control unit  for a service A (service A print processing control unit) performs processing considering whether a setting content is consistent with not only the processing capability of the image processing apparatus  but also a data storage capability in the service A according to a setting content in the service A scan setting UI . A service communication unit for a service A (service A service communication unit)  sends and receives a file according to a communication protocol and a communication interface that are provided by the service A.","Similarly, a scan setting UI  for a service B (service B scan setting UI), a print setting UI  for a service B (service B print setting UI), a scan processing control unit  for a service B (service B scan processing control unit), a print processing control unit  for a service B (service B print processing control unit), and a service communication unit  for a service B (service B service communication unit) are required to be mounted in consideration of data that can be processed by the service B.","Therefore, as the number of services for sending and receiving data to and from the image processing apparatus  increases, a mounting code becomes huger.","An image processing apparatus, which differs from the image processing apparatus  and is capable of performing display of a UI, scan processing, and print processing according to the services, will be described below.",{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 4","b":["100","410","400","420","410","421","100","420","420"]},"While the external server  includes one external server, and the one external server provides the file management service in the present embodiment, the external server  may include a plurality of servers as its other format, and the plurality of servers may start a plurality of virtual machines to perform distributed processing. In this case, a technique referred to as a \u201cscale out\u201d (a cloud computing technique) for increasing the number of virtual machines according to a predetermined condition is used.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 5","b":["100","510","100","511","512","102","513","511"]},"A hard disk drive (HDD)  stores image data, various programs, and various tables. An operation unit I\/F  connects an operation unit  and the control unit . The operation unit  includes a liquid crystal display unit having a touch panel function, a keyboard, and so on. An application in the image processing apparatus  calls the virtual machine API  (or the API ) according to processing, and requests the controller control unit  to execute processing for displaying various screens on the liquid crystal display unit in the operation unit .","A printer I\/F  connects the printer  and the control unit . Data (e.g., image data) to be printed by the printer  is transferred from the control unit  via the printer I\/F , and is printed on a recording medium in the printer . The application in the image processing apparatus  calls the virtual machine API  (or the API ) according to processing, and requests the controller control unit  to execute print processing.","A scanner I\/F  connects the scanner  and the control unit . The scanner  reads a document to generate image data, and inputs the image data to the control unit  via the scanner I\/F . The application in the image processing apparatus  calls the virtual machine API  (or the API ) according to processing. The application in the image processing apparatus  requests the controller control unit  to execute scan processing, and sends image data (scan data, described below) to the external server .","The network I\/F  connects the control unit  (the image processing apparatus ) to the LAN . The network I\/F  sends various types of information to the external server  connected via the LAN , and receives the various types of information from the external server  connected via the LAN .",{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 6","b":["420","610","420","611","612","613","611","614","615","610","420","421","615","421"]},"In the present exemplary embodiment, the CPU  performs processing according to a procedure for the control program stored in the ROM , to implement functions in the external server  and various types of processing, described below.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 7","FIG. 7","FIG. 1"],"b":["700","511","100"]},"In the present exemplary embodiment, it is assumed that the application  operates on the virtual machine , similarly to the applications  and . The application  may operate on the OS , similarly to the application .","A startup processing unit  for a service A (service A startup processing unit) performs initialization processing for performing processing for a service A by an instruction from the virtual machine . The service A startup processing unit  sends to a service communication router  a specifying request to specify a service communication unit for a service A (service A service communication unit ) as the initialization processing. The service A startup processing unit  requests the service A service communication unit  specified by the service communication router  to acquire screen generation information (e.g., initial screen display data) from the service A. The service A startup processing unit  includes the initial screen display data in a request to display an initial screen when it ends the initialization processing, and sends the initial screen display request to a UI control unit . A startup processing unit  for a service B (service B startup processing unit) performs initialization processing for performing processing for a service B, similarly to the service A startup processing unit . While the image processing apparatus  acquires screen generation information from the service to display a screen, and generates a screen (i.e., screen information provided to generate the screen) based on the acquired screen generation information in the present embodiment, the present invention is not limited to this. The image processing apparatus  may generate a screen based on the screen generation information in the image processing apparatus  without acquiring the screen generation information from the service, and may display another screen generated based on the screen generation information in the image processing apparatus  as an initial screen.","The UI control unit  includes a scan setting UI  and a print setting UI . The UI control unit  performs processing for displaying a UI on the operation unit . More specifically, the UI control unit  receives the initial screen display request from the service A startup processing unit  or the service B startup processing unit , and displays an initial screen illustrated in , for example. The UI control unit  sends to the service communication router  an acquisition request to acquire scan setting information relating to scanning, and sends to the scan setting UI  the scan setting information received from the service communication router . Similarly, the UI control unit  sends to the service communication router  an acquisition request to acquire print setting information relating to printing, and sends to the print setting UI  the print setting information received from the service communication router . The scan setting UI  generates screen information relating to a scan setting screen illustrated in , for example, according to the scan setting information received from the UI control unit , to display the scan setting screen on the operation unit . The scan setting unit UI  sends to a scan processing control unit  an input value input by the user in timing at which a scan start button for the scan setting screen is pressed.","The print setting UI  generates screen information relating to an initial screen  illustrated in , for example, according to the print setting information received from the UI control unit , displays the initial screen  on the operation unit , and controls an operation in the initial screen . The print setting UI  performs control so that the user cannot give an instruction to print a file that cannot be printed in a list of file names\/folder names (file name\/folder name list) .","More specifically, when the file that cannot be printed is selected in the list  according to a user's operation, a print button  is brought into a disable state so that it cannot be pressed. On the other hand, when the print button  is pressed, the print setting UI  sends to a print processing control unit  a file name of the file (which may be a file identifier) selected in the list  and a request to print the file.","The scan processing control unit  receives a value input on a scan setting screen and sent from the scan setting UI , to execute scan processing, and acquires image data from a scan processing result. The scan processing control unit  converts image data into scan data having a file format that can be processed by the service A according to the input value, and sends to the service communication router  the scan data and a request to send the scan data to the service A.","The print processing control unit  receives the file name and the printing request, which are sent from the print setting UI , to send the file name and a request to acquire the file to the service communication router . The print processing control unit  receives a response to the file acquisition request from the service communication router  and a file acquisition result, to execute print processing.","The service communication router  specifies, when it receives a service communication unit specifying request from the service A startup processing unit  or the service B startup processing unit , a service communication unit suitable for communication with each of the services. The service communication router  is responsive to an acquisition request from the UI control unit , to acquire scan setting information or print setting information via the specified service communication unit and send the acquired setting information to the UI control unit .","The service communication router  sends, when it receives the scan data and the scan data sending request from the scan processing control unit , the scan data and the scan data sending request to the specified service communication unit. The service communication router  sends, when it receives the file name and the printing request from the print processing control unit , the file name and the printing request to the specified service communication unit.","The service A service communication unit  mainly performs processing for communication with the service A. The service A service communication unit  acquires scan setting information or print setting information from a scan\/print setting database (scan\/print setting DB)  in response to the acquisition request from the service communication router , and sends the acquired setting information to the service communication router . The service A service communication unit  sends, based on the scan data and the scan data sending request, which have been received from the service communication router , the received scan data to the service A. The service A service communication unit  calls the printing file acquisition unit  based on the file name and the printing request, which have been received from the service communication router . In other words, the service communication unit is an example of an individual processing unit, and communicates with each of the services while performing individual processing for the service.","It is assumed that the service A service communication unit  controls communication processing in an application layer that differs for each service. For example, it is assumed that the service A service communication unit  performs communication with a service by a web service such as Single Object Access Protocol (SOAP) or REpresentational State Transfer (REST) implemented by using a HyperText Transfer Protocol (HTTP) which is a communication protocol.","A printing file acquisition unit  acquires a printing file from the service A based on the file name in response to a call from the service A service communication unit . At this time, the printing file acquisition unit  determines whether the image processing apparatus  can perform printing depending on the file name. If it is determined that even a file having an unprintable file format can be converted into a file having a printable file format in the service A, the service A service communication unit  requests the service A to convert the file into a printable file. In this case, the printing file acquisition unit  acquires the file after the conversion from the service A.","The scan\/print setting DB  manages information such as a file format of scan data that can be sent to the service A, an item in which setting relating to scan processing can be made, and a file, which can be printed by the image processing apparatus , acquired from the service A (data to be printed).","A service communication unit  for a service B (service B service communication unit) basically performs processing similarly to the service A service communication unit . A communication partner with which the service B service communication unit  communicates is the service B. A printing file acquisition unit  and a scan\/print setting DB  are also basically similar to the printing file acquisition unit  and the scan\/print setting DB . However, a service to be processed by the printing file acquisition unit  and the scan\/print setting DB  is the service B.",{"@attributes":{"id":"p-0074","num":"0073"},"figref":["FIG. 8","FIG. 8"],"b":["519","511","100"]},"The initial screen  is an example of an initial screen obtained when the service A is accessed, and is displayed by the UI control unit  after the service A startup processing unit  in the application  ends initialization processing. The file name\/folder name list  represents names of files and names of folders, which are stored (managed) in the service A.  illustrates a state where the UI control unit  displays the initial screen display data acquired by the service A startup processing unit  on the operation unit .","If the user desires to send scanned image data to the service A, the user operates the liquid crystal display unit having a touch panel function (performs a user operation), to designate any folder in the file name\/folder name list , and presses a sending button . When the user operation for pressing the sending button  is performed, a scan setting screen  illustrated in , for example, is displayed on the operation unit .","When the user desires to print files stored in the service A, the user designates any of the files in the file name\/folder name list , and presses the print button . When the user presses the print button , the application  acquires the designated file from the service A and prints the acquired file.","When the user presses a cancel button , the image processing apparatus  displays a menu screen of the image processing apparatus  on the operation unit . On the menu screen, the user can designate, out of basic functions of the image processing apparatus  such as copying and scanning and functions such as access to the service A and access to the service B, the function that the user desires to use.",{"@attributes":{"id":"p-0079","num":"0078"},"figref":["FIG. 9","FIG. 9","FIG. 9"],"b":["900","900","519","511","100","900"]},"The scan setting screen  receives a designation of a file format of a file into which image data generated by scanning a document is converted. When the user operation for pressing the sending button  on the initial screen  is performed, the application  displays the screen  on the operation unit .","A file format selection setting  switches display of a detailed setting  in response to pressing of a file format button (e.g., a Portable Document Format (PDF) button ) for selecting a file format displayed at the left thereof.  illustrates a state where the PDF file format button  is pressed.","The detailed setting  includes setting items that can be set for scan processing for each file format selected by pressing the file format button. In the present exemplary embodiment, the setting items in the detailed setting  in a state where the PDF file format button  is selected are illustrated. A high-compression specifying button  is a bottom for designating whether a PDF file having a high-compression format is generated when the PDF file is generated.  illustrates a state where the high-compression specifying button  is pressed, to make a setting, \u201cGenerate a PDF file having a high-compression format\u201d.","A reader extensions specifying button  is a button for designating whether a PDF file having a reader extension format is generated when the PDF file is generated. An optical character recognition (OCR) specifying button  is a button for executing OCR processing for image data obtained by scanning a document and designating whether an execution result is embedded in the PDF file.","A PDF file encryption specifying button  is a button for specifying, when the PDF file is generated, whether to prevent opening of the PDF file unless a password is entered when opened. A password entry area  is an entry area for entering the password when the PDF file is opened. The password entry area  allows entry of the password only when the PDF file encryption specifying button  is pressed.","When a user operation for selecting a file format on the scan setting screen  is performed, and a user operation for pressing a scan start button  is performed, the application  executes scan processing. When a user operation for pressing a cancel button  is performed, the application  makes a screen transition from the scan setting screen  to the initial screen .",{"@attributes":{"id":"p-0086","num":"0085"},"figref":"FIG. 10","b":["711","711","512","513","514","100"]},"Scan\/print setting information  is an example of information stored in the scan\/print setting DB , and includes a category , a setting item , and a settable value . The category  represents the type of setting relating to processing (e.g., setting relating to scanning and setting relating to printing). The setting item  includes items such as a file format (e.g., a file format in which data can be sent and a file format in which data can be printed), service conversion, and preview display. While in the present exemplary embodiment, the setting items include a file format in which data can be sent and a file format in which data can be printed, the present exemplary embodiment can also handle other setting items. The information relates to data that can be processed by a service to be used. The settable value  represents a value used in the setting item .",{"@attributes":{"id":"p-0088","num":"0087"},"figref":["FIG. 11","FIG. 11"],"b":["700","511","100","514","100","105","100"]},"While the service A startup processing unit  is executed as an example, the service B startup processing unit  different from the service A startup processing unit  may be executed depending on the input value on the menu screen.","In step S, the CPU  causes the service A startup processing unit  to first send a specifying request to specify a service communication unit to the service communication router . The service communication router , which has received the service communication unit specifying request, specifies the service communication unit corresponding to the service A startup processing unit , which has sent the service communication unit specifying request. The service communication router  specifies the service A service communication unit  provided as the service communication unit corresponding to the service A startup communication unit .","In step S, the CPU  causes the service communication router  to check whether the service A service communication unit  exists. If the service communication router  determines that the service A service communication unit  does not exist as a result of the check (NO in step S), the processing proceeds to step S. On the other hand, if the service communication router  determines that the service A service communication unit  exists (YES in step S), the processing proceeds to step S. The service communication router  can check the presence or absence of the service communication unit  using an appropriate method. For example, the service communication router  refers to a file, in which a service communication unit is described, provided in the image processing apparatus , to check the presence or absence of the service communication unit.","In step S, the CPU  causes the service communication router  to return a message that the service A service communication unit  does not exist as a response to a specifying request (a specifying request response) to the service A startup processing unit . The service A startup processing unit , which has received the specifying request response, sends a display request to display an error message that a designated service cannot be accessed, to the UI control unit , and ends the processing.","In step S, the CPU  causes the service communication router  to load the service A service communication unit  and to bring the service A service communication unit  into a call ready state. The service communication router  returns a message that preparation of communication with the service A is completed as a response to a specifying request (a specifying request response), to the service A startup processing unit .","In step S, the CPU  causes the application  to perform initial screen display processing, to display the initial screen , for example, on the operation unit . Details of the initial screen display processing will be described with reference to .","In step S, the CPU  causes the print setting UI  to receive a user operation (user instruction) on the initial screen , for example, displayed on the operation unit . When the user desires to send scanned image data, the user designates a folder of a storage destination from the file name\/folder name list  and presses the sending button . When the user desires to print files stored in the service A, the user designates the file to be printed from the file name\/folder name list  and presses the print button .","In step S, the UI control unit  determines whether the user operation received in step S is a scan instruction or a print instruction. The UI control unit  determines, if the pressed button is the sending button  on the initial screen , for example, that the user operation is the scan instruction. The UI control unit  determines, if the pressed button is the print button  on the initial screen , for example, that the user operation is the print instruction. If it is determined that the user operation is the scan instruction, the processing proceeds to step S. If it is determined that the user operation is the print instruction, the processing proceeds to step S.","In step S, the CPU  causes the application  to perform scan processing. Details of the scan processing will be described with reference to . In step S, the CPU  causes the application  to perform print processing. Details of the print processing will be described with reference to .",{"@attributes":{"id":"p-0098","num":"0097"},"figref":["FIG. 12","FIG. 12"],"b":["511","100","514"]},"In step S, the CPU  causes the service A startup processing unit  to send a request to acquire print setting information to the service communication router . The service communication router  sends the received acquisition request to the service A service communication unit . The service A service communication unit  acquires the print setting information from the scan\/print setting DB  according to the received acquisition request. The service A service communication unit  returns the print setting information to the service communication router  as a response to the acquisition request. The service communication router  returns the print setting information to the service A startup processing unit  as a response to the acquisition request.","In step S, the service A startup processing unit  sends a request to acquire initial screen display data to the service communication router . The service communication router  sends the received acquisition request to the service A service communication unit . The service A service communication unit  communicates with the service A according to the received acquisition request, to acquire the initial screen display data. The service A service communication unit  returns the initial screen display data as a response to the acquisition request to the service communication router . The service communication router  returns the initial screen display data as a response to the acquisition request to the service A startup processing unit . The initial screen display data includes information relating to a file and information relating to a folder, which are managed in the service A.","In step S, the CPU  causes the service A startup processing unit , which has received the initial screen display data and the print setting information, to send a request to display an initial screen, together with the initial screen display data and the print setting information, to the UI control unit . The UI control unit  requests the print setting UI  to generate and display a UI when it receives the display request. The print setting UI  refers to the initial screen display data included in the display request, to generate the UI and display the initial screen , for example, on the operation unit , and ends the processing.","The print setting UI  performs control so that the print button  cannot be depressed when a user designates a file having a file format other than a printable file format on the file name\/folder name list . More specifically, the print setting UI  specifies the printable file format from the print setting information included in the initial screen display request. More specifically, the print setting UI  generates information representing a screen on which the printable data out of the data that is managed in the service can be selected as a printing object. The print setting UI  performs control to bring the print button  into a disable state when the file having a file format other than the printable file format is selected on the file name\/folder name list .",{"@attributes":{"id":"p-0103","num":"0102"},"figref":["FIG. 13","FIG. 13"],"b":["511","100","514"]},"In step S, the CPU  causes the UI control unit  to send a request to acquire scan setting information to the service communication router . The service communication router  sends the received acquisition request to the service A service communication unit . The service A service communication unit  acquires scan setting information from the scan\/print setting DB  according to the received acquisition request. The service A service communication unit  returns the scan setting information as a response to the acquisition request to the service communication router . The service communication router  returns the scan setting information as a response to the acquisition request to the UI control unit .","In step S, the CPU  causes the UI control unit  to request the scan setting UI  to generate and display a UI. The scan setting UI  displays the scan setting screen , for example, on the operation unit . In the case, the scan setting UI  refers to the scan setting information, to switch a setting item or the like. If settable values corresponding to a setting item \u201cfile format\u201d include \u201cPDF\u201d and \u201cTag Image File Format (TIFF)\u201d, for example, the scan setting UI  performs control so that buttons displayed as the file format button at the left of the file format selection setting  include only \u201cPDF\u201d and \u201cTIFF\u201d. More specifically, the scan setting UI  generates, from information representing a data format that can be processed by a service, information representing a screen on which the data format that can be processed by the service can be selected. If settable values corresponding to a setting item \u201cPDF\u201d include \u201chigh-compression\u201d, \u201cOCR\u201d, and so on, as illustrated in the scan\/print setting DB , control is performed to display the high-compression specifying button  and the OCR specifying button  in the detailed setting .","In step S, the CPU  causes the scan setting UI  to include an input value (set value) set on the scan setting screen  in a request to execute scan processing, and to send the input value to the scan processing control unit  when a user operation for pressing the scan start button  is performed. The scan processing control unit  executes scan processing based on the received execution request.","In step S, the CPU  causes the scan processing control unit  to convert image data obtained from a scan processing execution result into a designated file format, for example, according to the input value set via the scan setting screen . In step S, the CPU  causes the scan processing control unit  to then send a scan data sending request including scan data having the file format obtained by the conversion, to the service communication router , and ends the processing. The service communication router  sends the received sending request to the service A service communication unit . The service A service communication unit  sends the scan data to the service A according to the received sending request.",{"@attributes":{"id":"p-0108","num":"0107"},"figref":["FIG. 14","FIG. 14"],"b":["511","100","514"]},"In step S, the CPU  causes the UI control unit  to send a file name of a file selected by a user operation and a printing request to print the file, to the print setting UI . The print setting UI , which has received the file name and the printing request, sends the file name and a request to acquire the file having the file name to the service communication router . The service communication router  sends the file name and the acquisition request to the service A service communication unit .","In step S, the CPU  causes the service A service communication unit  to call the printing file acquisition unit , and causes the printing file acquisition unit  to determine whether the file format of the file selected by the user operation needs to be converted (can be converted in the service A). In other words, the printing file acquisition unit  refers to the scan\/print setting information  which is an example of identification information, to identify data representing a file having a file format required to be converted in the service A. For example, the printing file acquisition unit  refers to the scan setting\/print setting DB , to determine that the conversion in the service A is required when it is determined that a settable value \u201cxx document\u201d corresponding to a setting item \u201cservice conversion\u201d and a file name match each other. If the printing file acquisition unit  determines that the conversion is required, the processing proceeds to step S. On the other hand, if the printing file acquisition unit  determines that the conversion is not required, the processing proceeds to step S.","In step S, the CPU  causes the printing file acquisition unit  to send a file conversion request to the service A to convert the file format of the file, which matches the settable value \u201cxx document\u201d, selected by the user operation, into a printable file format (a PDF format in this example). The service A converts, when it receives the conversion request, the file that matches the settable value \u201cxx document\u201d selected by the user operation, into the file having the PDF format.","In step S, the CPU  causes the printing file acquisition unit  to send a file acquisition request to the service A to acquire a file itself having a file name or a file conversion result in step S. By the service A that has received the acquisition request, file data having the designated file name is acquired and returned as a response to the printing file acquisition unit . Therefore, the printing file acquisition unit  acquires file data included in a response to the acquisition request, from the service A.","The printing file acquisition unit  sends the acquired file data to the service A service communication unit , and the service A service communication unit  returns the file data as a response to a printing request to the service communication router . The service communication router  that has received the file data returns the file data to the print setting UI  as the response to the printing request. The print setting UI  that has received the file data sends the received file data to the print processing control unit .","In step S, the CPU  causes the print processing control unit  that has received the file data to perform print processing for the received file data, and ends the processing.","As described above, according to the present exemplary embodiment, in the image processing apparatus that cooperates with external services connected via a network, the increase in the number of external services, which send and receive data to and from the image processing apparatus, can be dealt with by adding mounting codes for only processing units dependent on the external services. More specifically, the image processing apparatus can realize a new external service by adding mounting codes for the service A startup processing unit  and the service A service communication unit  respectively corresponding to external services to be added. The processing units dependent on the external services commonly use a processing unit (a module) on which a commonly usable function is mounted. According to this configuration, the mounting code can be prevented from becoming huger due to the increase in the number of external services, for example.","According to the present exemplary embodiment, the functions of the image processing apparatus can be limited according to an external service (cloud service) provided by the external server serving as a communication partner. According to the present exemplary embodiment, the image processing apparatus can realize the new cloud service without correcting the mounting codes corresponding to the basic functions of the image processing apparatus.","In the first exemplary embodiment, a user designates a file desired to be printed from the file name\/folder name list  to perform printing. When printing is performed, however, the user may confirm a content of a file that will be printed, to check whether the file is to be printed. The user can avoid a situation in which an erroneous file is printed by checking whether the file is to be printed.","On the other hand, when a file to be printed is acquired from a service connected via a network and printed, a content of the file to be printed may not be confirmed unless the file is acquired. In a configuration in which the file to be printed is acquired, if the file size of the file to be printed is large, a time is required to acquire the file, which is not convenient for the user.","In the second exemplary embodiment, a configuration is adopted in which a preview thumbnail (a thumbnail image) for confirming a content of a file is acquired and displayed in processing dependent on a service.",{"@attributes":{"id":"p-0120","num":"0119"},"figref":["FIG. 15","FIG. 15","FIG. 15","FIG. 11","FIG. 15","FIG. 14"],"b":["511","100","514","1109","1401","1405"]},"In step S, the CPU  causes a UI control unit  to display a configuration screen for confirming whether a print preview is to be displayed. More specifically, the UI control unit  displays on an operation unit  a screen on which a message \u201cIs a preview displayed?\u201d and a confirmation button (a \u201cYES\u201d button and \u201cNO\u201d button) are displayed. In other words, the UI control unit  generates, when data is selected on a screen on which printable data can be selected (e.g., an initial screen ), screen information representing a screen on which an instruction to preview the selected data (data to be printed) can be given.","In step S, the UI control unit  determines that a preview display instruction is given when the user presses the \u201cYES\u201d button on the confirmation screen, and determines that a print instruction is given when the \u201cNO\u201d button is pressed. If the UI control unit  determines that the preview display instruction is given, the processing proceeds to step S. On the other hand, if the print instruction is given, the processing proceeds to step S.","In step S, the CPU  causes the UI control unit  to send a file name and a request to acquire a thumbnail image to a service communication router . The service communication router  sends the file name and the acquisition request to a service A service communication unit . The service A service communication unit  refers to the file name, to determine whether a thumbnail image can be acquired in a service A. For example, the service A service communication unit  refers to a scan setting\/print setting DB . The service A service communication unit  determines that the service A can acquire the thumbnail image when it is determined that a settable value \u201cxx document\u201d corresponding to a setting item \u201cpreview display\u201d and the file name match each other.","At this time, if it is determined that the thumbnail image can be acquired (YES in step S), the processing proceeds to step S. On the other hand, if it is determined that the thumbnail image cannot be acquired (NO in step S), the processing proceeds to step S.","In step S, the CPU  causes the service A service communication unit  to return a message that the thumbnail image cannot be acquired as a response to the acquisition request to the service communication router . The service communication router  returns the message that the thumbnail image cannot be acquired as the response to the acquisition request, to the UI control unit . The UI control unit , which has received the response to the acquisition request, displays the message that the thumbnail image cannot be acquired on the operation unit , to make a screen transition to an initial screen in response to a user operation.","In step S, the CPU  causes the service A service communication unit  to send to the service A a file conversion request indicating that a file having a file name is converted into a file having a preview display format such as a Joint Photographic Expert Group (JPEG) (a thumbnail image). The service A converts, when it receives the conversion request, a file having a file name designated by the user operation into the file having the preview display format.","In step S, the CPU  causes the service A service communication unit  to then send to the service A a request to acquire a file indicating that a file conversion result in step S is acquired. The service A that has received the acquisition request acquires file data after the conversion, and returns the acquired file data as a response to the service A service communication unit . Therefore, the service A service communication unit  acquires the file data included in the response to the acquisition request, from the service A.","In step S, the CPU  causes the service A service communication unit  to return the file data acquired as the response to the request to acquire the thumbnail image to the service communication router . The service communication router , which has received the file data, returns the file data acquired as the response to the acquisition request to a print setting UI . The print setting UI  displays the received file data on the operation unit .","When the preview has been displayed by the user operation, the UI control unit  displays the initial screen. The above-mentioned configuration enables the user to confirm the file data from the preview, and then to perform a user operation for giving a printing instruction to print desired file data.","As described above, according to the present exemplary embodiment, the processing can be switched depending on an output destination (a recording medium or a liquid crystal display unit) in the processing dependent on the external services. Thus, each of the external services can be dealt with by changing a mounting code according to the external service in the processing dependent on the external service while an increase in the number of mounting codes in the whole image processing apparatus  can also be suppressed.","The present invention has also been implemented by executing processes, described below. More specifically, software (a program) for implementing functions in the above-mentioned exemplary embodiments is supplied to a system or an apparatus via a network or various types of recording media, and a computer (e.g., a CPU or a micro processing unit (MPF)) in the system or the apparatus reads out the program and executes the program.","The configuration according to the above-mentioned exemplary embodiment can deal with an increase in the number of cooperating services more appropriately.","Other Embodiments","Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment (s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment (s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).","While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications, equivalent structures, and functions.","This application claims priority from Japanese Patent Application No. 2010-189473 filed Aug. 26, 2010, which is hereby incorporated by reference herein in its entirety."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate exemplary embodiments, features, and aspects of the invention and, together with the description, serve to explain the principles of the invention.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 15"}]},"DETDESC":[{},{}]}
