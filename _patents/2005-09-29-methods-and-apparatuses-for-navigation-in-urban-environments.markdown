---
title: Methods and apparatuses for navigation in urban environments
abstract: Embodiments disclose methods, systems, and apparatuses for providing maps and directions, including walking and mass transit directions in urban environments where users do not drive cars. Additionally, driving directions can be included. Various criteria, including preferences for amount of walking, for or against particular streets, certain mass transit vehicle types, number of transfers between mass transit vehicles, and other preferences, are considered in the routing calculations, as well as non-individual information such as current conditions and other information. User feedback on various qualitative aspects of the directions is received and stored, and used in subsequent routing decisions. Embodiments disclosed include web services whereby third parties, such as members of the travel industry, can access such services which provide textual and graphical information. Further, clients can access and edit mass transit information through the web services.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07957871&OS=07957871&RS=07957871
owner: Hopstop.com, Inc.
number: 07957871
owner_city: New York
owner_country: US
publication_date: 20050929
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","Field of the Invention","SUMMARY","DETAILED DESCRIPTION"],"p":["The invention relates to automated assistance in finding maps and routes in urban areas, often without an automobile, involving walking, mass transit, and other transportation modes.","The invention provides methods and apparatuses for assisting users in journey planning within urban areas, especially without the use of an automobile. A fully integrated system of walking, mass transit, and driving directions is provided, taking into account time of day and day of week; user preferences for amount of walking, number of mass transit transfers, and other factors; current congestion data; and user feedback on qualitative and quantitative measures of transportation, such as best subway lines, average walk times on particular streets, or most scenic streets.","HTTP (for HyperText Transfer Protocol) is the primary method used to convey information on the World Wide Web.","A Uniform Resource Locator, URL or Web address, is a standardized address for some resource (such as a document or image) on the Internet or elsewhere. First created by Tim Berners-Lee for use on the World Wide Web, the currently used forms are detailed by Internet standard RFC 1738.","An HTTP cookie (usually called simply a cookie) is a packet of information sent by a server to a World Wide Web browser and then sent back by the browser each time it accesses that server. Cookies are used by a server to maintain state between otherwise stateless HTTP transactions, and are often used for authentication, personalization, shopping baskets, and other information about the user accessing the server.","XML is a standard general purpose markup language, recommended by the World-Wide Web Consortium (W3C). Its primary purpose is to facilitate the sharing of data across different systems, particularly systems connected via the Internet. Languages based on XML (for example, RDF, RSS, MathML, XHTML, SVG, and cXML) are defined in a formal way, allowing programs to modify and validate documents in these languages without prior knowledge of their form.","An XML document is a particular computer document in the XML format.","The term \u201cXML schema\u201d, when used here, is broadly understood to mean a description of a type of XML document, typically expressed in terms of constraints on the structure and content of documents of that type, above and beyond the basic constraints imposed by XML itself. It can include a DTD (Document Type Definition), an XML Schema, a RELAX NG schema, or other definition of an XML document type.","The term \u201cserver\u201d, when used here, is broadly understood to mean any computing entity or family of such entities capable of responding to user requests over a network. The computing entities may be computer servers or server farms, general purpose digital computers, personal digital assistants, special-purpose devices such as printers or scanners with digital processors built in, or specialized hardware devices such as XML chips or XML computers; either containing storage units or making use of storage units elsewhere on the network. The family of computing entities may be geographically distributed or may be \u201cvirtual\u201d entities within a larger entity.","The term \u201cdatabase\u201d, when used here, is broadly understood to mean a collection of one or more data elements stored in one or more computers. The database may be structured in a variety of ways, such as in flat files, in a relational model, hierarchical model, network model, dimensional model, object-oriented model, or in any sort of information retrieval structure known in the art. The database may be distributed across one or more servers. Various sorts of indexing schemes may be applied to the database in order to optimize access times for the data. The database may support read-write access or it may be read-only.","The term \u201cuser interface control\u201d, when used here, is broadly understood to mean any suitable hardware or software permitting a human being to provide input to a computer.","Hardware devices include joysticks, styluses, mice or other pointing devices, keyboards, touch screens, keypads, microphones and other computer peripherals already existing or yet to be invented. Software includes typed commands, hyperlinks, graphical user interface controls such as menus, buttons, choice lists, check boxes, radio buttons, and the like, already existing or yet to be invented. Software user interface controls can be provided via a command-line interface, graphical user interface, Web-based interface, gestural interface, tactile interface, voice interface, SMS (Short Text Message), or other.","The term \u201cweb service\u201d, when used here, is broadly understood to mean a software system designed to support interoperable machine-to-machine interaction between software processes, which may be separated by a network. A web service has an interface described in a machine-processable format, which may be XML or any format built on XML, such as WSDL (Web Service Description Language). Web services may be accessed over any common network protocol, such as HTTP, FTP, SMTP, XMPP, or other protocols. The format of a web service message may be defined by SOAP, XML-RPC, JAX_RPC, REST, remote procedure call, distributed object method frameworks such as CORBA or DCOM, or other computer format such as Common Gateway Interface, comma-separated value, tab-separated value, Basic Encoding Rules, or other format. A web service may be published in a UDDI (Universal Description, Discovery, and Integration) format, which provides information assisting potential users of the web service to find and use the service.","The term \u201cvalidating\u201d when used here in the context of a web service, is broadly understood to mean performing a step on license information submitted by a client which authenticates the client, verifies that the client is entitled to access the web service and that the terms of the contractual arrangement have not been violated and that the license has not expired, verifies that the license information has not been duplicated contrary to terms of the license, and rejects the request if any of the above tests fail. Validation may be carried out by any method known in the art, such as one-way hash functions, shared secrets, public key encryption, or other methods, including no encryption (clear text).","The term \u201cmass transit vehicle\u201d, when used here, is broadly understood to mean a conveyance which transports persons who do not own the conveyance, whether for free or for payment. It can include a conveyance of any publicly or privately operated organization, including buses, subways, trains, bicycles, motorcycles, trolleys, light rail, trams, ferries, monorails, taxicabs, pedicabs whether operated by foot power or motor power, Segways, airplanes, horse-drawn carriages, helicopters, car services, automobiles, or other forms of transportation existing or yet to be invented.","The term \u201cmass transit route\u201d, when used here, is broadly understood to mean an identification of a particular mass transit service or route. It may be a train number for a train or subway service, a flight number for an airline, a bus number for a bus service, or a ferry number for a ferry service. It is to be distinguished from a vehicle number, i.e. the identification of a particular mass transit vehicle.","The term \u201cmass transit stop\u201d, when used here, is broadly understood to mean a particular place where a mass transit vehicle traveling a mass transit route may stop to take on and let off passengers, whether regularly scheduled or on passenger demand. It can include a bus stop, subway or tram stop, ferry entrance or exit, cab stand, train station, airport, heliport, or any similar location.","The term \u201cmass transit direction\u201d, when used here, is broadly understood to mean an instruction to board a mass transit vehicle traveling a particular mass transit route at a particular mass transit stop, and to depart the vehicle at another mass transit stop.","The term \u201cmass transit transfer direction\u201d, when used here, is broadly understood to mean an instruction to exit a mass transit vehicle traveling a particular mass transit route at a particular mass transit stop, and board a second mass transit vehicle traveling a second mass transit route at a particular mass transit stop,","The term \u201cmass transit criteria\u201d when used here, is broadly understood to mean any factor which may be meaningful to a user regarding mass transit directions. It can include any of the factors enumerated in \u201cmass transit conditions\u201d, as well as personal preferences, e.g. desire to minimize cash outlay, a distaste for large crowds, slow trains or crowded buses, a favorite bus driver, or a route which one's friends or coworkers habitally take. It can also include a vehicle preference for buses only, subways only, or buses plus subways, or a maximum number of transfers in a route. It can also include any preference for or against particular mass transit routes, e.g. in favor of those routes going through attractive areas or against those tending to be crime-ridden or slow, or any transit route where the user has any good or bad experiences in the past.","The term \u201cvehicle time wastage\u201d, when used here, is broadly understood to mean time spent by a mass transit vehicle when the vehicle is not moving. It can include time waiting in traffic, at a bus stop, subway stop, ferry stop, or any other form of delay, whether predictable or unpredictable. In cases of unpredictable delay, an expected average value may be used.","The term \u201cwalking direction\u201d, when used here, is broadly understood to mean an instruction to walk along one or more streets in specified directions, starting at a first point and finishing at a second point, and turning at specified points.","The term \u201ccurrent information\u201d when used here, is broadly understood to mean information that is frequently updated. The frequency of update may vary according to unique characteristics of the information, and may be monthly, weekly, daily, hourly, or even more frequently.","The term \u201cmass transit conditions\u201d, when used here, is broadly understood to mean current information on conditions affecting mass transit usage in a particular area. It can include information on strikes and other work stoppages; breakdowns of mass transit vehicles; crimes; problems with mass transit infrastructure such as subway stations, electrical systems, control systems, ferry facilities such as docks, water routes, or bus stations; overloaded mass transit routes such as might be encountered before or after a sporting event or other public event; or any factor affecting the desirability or efficacy of using a particular mass transit route.","The term \u201cwalking conditions\u201d, when used here, is broadly understood to mean current information on conditions affecting walking in a particular area. It can include information on construction sites, demonstrations, parades, street closures, riots, sporting events, conventions, concerts, outdoor theater events, public events such as a visit by a government official or other public figure, movie or television shooting, recent crimes, suicides, traffic accidents, terrorist incidents, police or military operations, natural disasters, or any factor affecting the desirability or efficacy of walking in a particular area.","The term \u201cwalking criteria\u201d, when used here, is broadly understood to mean any factor which may be meaningful to a user regarding walking directions. It can include any of the factors enumerated in \u201cwalking conditions\u201d, as well as such personal preferences related to these, e.g. a distaste for large crowds. It can also include any preference for or against particular streets or areas, such as favorite stores or restaurants, areas where the user has friends or relatives, or is employed, has clients or customers, or has any good or bad experiences in the past.","The term \u201cgeographic database\u201d, when used here, is broadly understood to mean a database storing geographic, topographic, cartographic, spatial, mass transit information, walking information, or street and road information, or any combination thereof. It may have been derived from survey data, including census data; from governmental or private institutions; satellite data; aerial photography; manual entry from printed mass transit schedules; map scanning; or other source of input.","The term \u201cpublisher\u201d, when used here, is broadly understood to mean an entity, public or private, owning rights to a geographic database or route-finding service and offering it for free, or for sale or distribution via a network.","The term \u201ccontractual arrangement\u201d, when used here, is broadly understood to mean an action performed between at least two parties, one of whom is an entity acting on behalf of a publisher, and another of whom is an entity acting on behalf of a user wishing to gain access to such information. The contractual arrangement could include payment via cash, check, credit card, PayPal or other such payment services, presentation of a coupon or other promotional offer, agreement to perform reciprocal services, or any means whereby the client meets the access requirements of the publisher, including simply agreeing to terms of a license.","Automated navigation systems are known in the art. Bellesfield et al (U.S. Pat. No. 6,282,489), for instance, discloses methods and apparatus for displaying a travel route and generating a list of places of interest located near the travel route. Rafiah et al (U.S. Pat. No. 6,834,229) discloses a journey planner providing an integrated travel plan involving multiple transportation modes including driving and public transportation. Many other systems providing road directions, e.g. Mapquest on the Internet, are available.","Such systems are commonly limited to providing road directions, which may be useful for either driving or walking. Rafiah, mentioned above, accesses the online databases of various transport providers, e.g. trains, buses, ferries, airlines, subways, and others, creating a menu of options for longer trips, such as city to city, but ignores many of the problems of urban travel, as will be shown below.\n\n","Finally, there are many GPS-enabled devices which can assist in finding a route over terrain with or without roads. However, the micro-environment of an urban area presents additional and hitherto unaddressed problems.","In an urban environment, users are presented with a different set of issues than have been addressed by such navigation systems.\n\n","In New York, for example, people frequently do not own cars, or at least do not drive them for daily use, since it is costly, slow, and inconvenient, and parking is scarce and expensive. Public transportation, particularly buses, subways, and ferries, on the other hand, is readily available and routes are well-integrated, so that a substantial number of Manhattan residents do not even own a car.","Yet there is a vast amount of knowledge about the various bus and subway lines which residents and visitors must master in order to use the system efficiently. For example, the NYC Transit system has 468 subway stations. The 25 subway routes are interconnected, and many lines feature express trains, across-the-platform transfers to local trains and \u201cskip-stop\u201d express service. Moreover, certain trains operate on different frequencies and stop on different subway stations based on the time of day and day of the week. Often newcomers, tourists, and other visitors simply walk or use taxis because they don't know where the buses and subways run, or how often, where to board them, how to pay for them (whether exact change is required, stored-value fare cards, etc.) or where to exit. The uncertainty is simply too great for someone unfamiliar with the system.","Moreover, walking is a vitally important transportation option in Manhattan and other urban areas. Not only is it sometimes the most efficient method for short distances, it is often preferable because of the exercise benefits, access to shopping and other urban services, enjoyment of pleasant weather, etc. Yet walking can also be problematic, especially for newcomers but even for natives. In cities comprised of a large network of streets, city residents and tourists are often confused by the complex maze of connecting street walkways. Some of these streets are also only available to vehicles or are un-passable on foot. In addition, consumers require clear walking directions to the appropriate location to enter a subway station or bus stop. There is a need for point-to-point routing information including walking direction, in addition to other transportation options.","An end-to-end journey an automobile in Manhattan, Boston, Washington, or other city with well-developed rapid transit thus requires assembling information from a diverse set of sources, not as yet well-integrated or Web-enabled. There is thus a need in the art for systems and methods for assisting navigation in an urban environment, especially without a car.","The invention provides a range of services related to navigation in urban areas. Routes from a start point to an end point and optionally passing through one or more intermediate points can be created, taking into account user criteria. Current information, such as mass transit conditions and walking conditions, as defined earlier in this document, can be factored into the routing decisions. Users can access the services from standard computers, hand-held digital devices such as PDAs, including via SMS (short message service) messages, voice recognition interface, or via a Web Service or ordinary HTTP access.","In one embodiment, a user enters a start and destination address into a web page, preferences for amount of walking, transportation mode (subways, buses, walking, or combinations thereof), tolerance for transfers among mass transit vehicles; maximum number of buses taken (users may not want to take 3 successive buses, even if it is the \u201coptimal\u201d route by some calculations), max number of subway trains, date and time of departure, etc. In other embodiments, users can provide feedback indicating preferences for or against certain streets for walking (because of shopping desirability, or crime undesirability), or against certain mass transit routes (e.g. because of past mechanical problem, chronic lateness, crowded cars, etc.). Feedback can be used either for individual routing decisions, or, in one embodiment, as current information on mass transit conditions, walking conditions, or driving conditions which influences routing decisions for one or more other users as well. In still other embodiments, routing can be conditioned based on time of day or day of week (certain streets may be deserted at night and thus dangerous), or on the weather (walking is less preferable when it's raining), or based on special events (a visit by the President may upset all transit schedules in the immediate neighborhood).","In embodiments of the invention, users provide feedback which is used to continuously enhance the quality of the invention. Feedback is used both to create and maintain a database about the user's own preferences, which is useful for creating routes for that user; and also to update the database used for all users. For example, a user may report a preference for walking on a particular street because she has friends there, and may also report that a subway stop has broken turnstiles and is dirty and unpleasant. The former information is used only in the context of creating a route for that user, while the latter is applicable to all users.","In addition to adjusting the database based on reported times, conditions, and preferences, the invention, in another embodiment, acts as a \u201csocial network\u201d or \u201cvirtual community\u201d.","User comments, in some cases, contain more detail than can be captured in a rating system or in average speed data. Therefore, comments are also made available in an unmediated, searchable format","Additionally, a Web Service is provided for transit operators and other third parties in order that mass transit information can be viewed, entered, and edited, saving the operators the burden of hosting and maintaining a web presence. The route information can be accessed from an Internet-enabled computer, via text messaging services such as SMS (short message service) on a mobile computing device such as PDA or cell-phone, or by voice over a normal cell phone. A Web Service is provided for programmatic use, as well as a standard HTTP server for human-mediated use.",{"@attributes":{"id":"p-0065","num":"0072"},"figref":"FIG. 1"},"The Links table  is a table of transportation links: walking, rapid transit, etc. For each link, such information as the id, (x,y) coordinates of the start and stop points, the distance, the name of the link, start and stop ids, vehicle-id, and other information is stored. Its source for walking links can be a publicly available geographical database, such as TIGER\/Line data from the U.S. Census Bureau, or a commercial digital map provider such as Navteq (www.navteq.com) or Tele Atlas (www.teleatlas.com) or others. Its source for rapid transit links is the Routes table .","The Routes table  is a table of rapid transit routes. There is no single, universal source of online rapid transit information in some cities, and an aspect of the invention is a method of creating and providing such a source. The Routes table  contains an id, name, description, vehicle type, schedule information on when the route is traversed, information on when the data was entered and by whom it was approved, etc.","The Stops table  is a table of rapid transit stops, containing for each stop its id, address, (x,y) coordinates, name, description, information on when the data was entered and by whom it was approved, etc.","The Route_items table  is a relational table providing a correspondence between  and , symbolized by the \u201cRel_\u201d  symbol. There is one row for each stop of each route, the row containing the id of the route and the id of the stop.","The Transfers table  is a table of transfer information.","The Vehicle_types table  is a table of vehicle types.",{"@attributes":{"id":"p-0072","num":"0079"},"figref":"FIG. 2","b":["210","220","230","240"]},{"@attributes":{"id":"p-0073","num":"0080"},"figref":["FIG. 3","FIG. 2"],"b":["310","320","380","330","340","320","350","360","370"]},"The Routes table  is created \u201cby hand\u201d in one embodiment of the invention, meaning that the data is inputted by administrative personnel of the publisher operating the invention, or by personnel of the various rapid transit agencies, as described later under","Mass Transit Database Service.",{"@attributes":{"id":"p-0075","num":"0082"},"figref":["FIG. 4","FIG. 2"],"b":["120","410","420"]},"At , for each pair (i, i+1) of the \u2018stops\u2019 array, a node in the route layer of the directed graph with the same (x,y) coordinates is looked up, and if not found, created. The algorithm continues on . At  a test is made as to whether the algorithm has already processed a route node whose (x.y) coordinates are the same as those of the \u2018from\u2019 node. If so, at  the \u2018from\u2019 node is assigned the node number of that node; if not, at  a new node number is assigned it. A similar test is made for the \u2018to\u2019 node at , where if a route node has been processed whose (x.y) coordinates are the same as those of the \u2018to node; if so  assigns that node number to the \u2018to\u2019 node; if not, at  a new node number is assigned. At  a new record is inserted into the Links table.",{"@attributes":{"id":"p-0077","num":"0084"},"figref":["FIG. 5","FIG. 5"],"b":["1","510","2","520","3","530","4","560","4","3","530","5","570","580","3","530","5","570","6","540","6","540","5","570","550"],"sup":"th "},{"@attributes":{"id":"p-0078","num":"0085"},"figref":"FIG. 6","b":["1","1","610","510","2","2","620","520","3","3","630","530"]},{"@attributes":{"id":"p-0079","num":"0086"},"figref":"FIG. 7","b":["710","720","730","730"]},{"@attributes":{"id":"p-0080","num":"0087"},"b":["740","760","750","790"],"figref":"FIG. 8"},"At , the start and destination addresses are validated. At , the (x,y) coordinates of the start and destination addresses are looked up, using any suitable software for resolving a building or intersection address; in one embodiment a publicly available sofware package \u201cGeocoder\u201d (described at http:\/\/www.cpan.org\/modules\/by-module\/Geo\/Geo-Coder-US-1.00.readme), and spell checker software for checking the spelling of geographic names and offering corrections, such as that offered by Aspell (http:\/\/aspell.net).  is continued at .",{"@attributes":{"id":"p-0082","num":"0089"},"figref":"FIG. 8","b":["800","810"]},"Although classical route-finding algorithms, such as Dijkstra's, find the least cost route, based on some cost factor, the algorithm has been extended in novel ways for the invention.  illustrates, where the hypothetical task is to find the least cost route from A at  to B at .","According to Dijkstra's algorithm, nodes are found closest to the start node (node A at ), one by one. First, consider nodes C at  and D at . The closest to A is node C, because the distance of edge (link) A-C at  is 10 seconds, and A-D at  is 20 seconds. Thus the first closest node is found\u2014node A at . This is called a \u201cresolved\u201d node. Then, consider nodes that are connected with one edge to the resolved nodes. Compare distances from node A at  to such nodes. Thus, compare distances from A at  to D at  (the distance along edge  is 20 seconds), and from A at  to F at  (the distance is 50 seconds (10+40)). Thus, the second closest node is node D at . Repeat finding the next closest node, until node B at  is reached (the destination node). Going back, from B to A, using the closest nodes, we find the shortest path from A to B.","Each edge of the graph is a record in the Links table. When the next closest node is searched for and an edge (a link) is considered, the link is \u201cfiltered\u201d in the following manner:","If the link is a part of a route, and the vehicle of the route is excluded by the user based on any mass transit criteria (e.g. the user has excluded all buses, or B25 bus only), the link is skipped, as if it doesn't exist in the graph at all.","If the path to the last closest node contains the maximum number of buses taken, according to another mass transit criteria, and the link belongs to a bus route, the link is skipped. The same applies to the mass transit criteria of maximum number of subway trains.","If the walking distance of the path to the last closest node is equal or greater than a walking criteria of maximum distance walked, and the link is a walking link, the link is skipped.","If the link is not available currently because of known mass transit conditions, where \u201ccurrently\u201d is approximately the departure time selected by the user plus the distance to the last closest node, in seconds), the link is skipped.","It will be apparent to one of ordinary skill in the art that the \u201cfiltering\u201d of links can be extended to include any of the criteria mentioned earlier, such as mass transit or walking conditions, user preferences, etc., or other criteria. Additionally, the cost factors shown in  could be adjusted on a continuous basis, so that expected mass transit or walking delays are real-time or nearly so.",{"@attributes":{"id":"p-0091","num":"0098"},"figref":["FIG. 12","FIG. 14"],"b":["1200","1210","1220","1400"],"sup":"th "},{"@attributes":{"id":"p-0092","num":"0099"},"figref":"FIG. 13","b":["1300","1310","1320"]},"While thus far embodiments of the invention have been described as for non-driving transportation in urban environments, in other embodiments it can include driving as one or more legs of a trip. For example, a route can include driving to a train station or Park And Ride, parking, taking one or more trains or other mass transit vehicles, and then walking to the final destination. Or, in other embodiments, inter-city trips can be handled, and the route can include driving to an airport, dropping off a rental car, flying to another city, and taking public transportation from the airport, as in cities such as New York, Boston, San Francisco, and Chicago where subway trains serve the airports.",{"@attributes":{"id":"p-0094","num":"0101"},"figref":["FIGS. 15-18","FIG. 2","FIG. 15","FIG. 16"],"b":["1500","1610","1620","1680","1630","1640","1620","1650","1660","1670"]},"The algorithm continues at  on , where the ImpossibleTurns table is created, a table giving a list of driving link pairs which are not driveable, either at certain times, on certain days, or at all.  is expanded on . At , all records are deleted. At  a test is made as to whether all \u2018D\u2019 (for \u2018driving\u2019) records of the Links table have been processed. If so, the algorithm terminates. If not, a pair of \u2018D\u2019 records is read . At  a test is made as to whether the pair are \u201cconnected\u201d, i.e. if the second node of the second link is the same as the first node of the first link. If not, the algorithm returns to . If so, a test is made at  as to whether driving through from link to link is possible. (Note that, since the TIGER\/Line data from the U.S. Census Bureau does not contain full information on driving conditions such as legal turns, other databases from commercial sources, such as Navteq http:\/\/www.navteq.com, are used in some embodiments of the invention.) If so, the algorithm returns to . If not, at  a record is added to the ImpossibleTurns table.","The algorithm continues at  on , which is expanded on . On , the ovals represent nodes and the directed lines represent links.  is a link representing a one-way street, while  and  represent a two-way street. The absence of a link in the opposite direction from  indicates that travel is not possible in that direction. , , , and  also represent one-way links, but additionally an entry in the database for  notes that the right turn is prohibited. The algorithm continues at  on , which represents the normal processing of the route daemon for driving directions. When considering any link for inclusion in driving directions, the daemon checks the previous link in the Links table, and if the pair consisting of the previous link and the link being considered exists as a row in the ImpossibleTurns table, the link is removed from consideration for incorporation into the route.",{"@attributes":{"id":"p-0097","num":"0104"},"figref":["FIGS. 14 and 19","FIG. 14"],"b":"1220"},"On , a portion of the database schema, , is shown.  describes the Feedback table, data for which is derived from the user interface control . The \u2018route_id\u2019 and \u2018stop_id\u2019 fields pertain to a mass transit line or mass transit stop, respectively, while the \u2018tlid\u2019 field pertains to a portion of a walking route. \u2018ip\u2019 represents user identification information, in this embodiment the IP address from which the feedback was received. It will be apparent to one skilled in the art that other forms of user identification information could also be used, e.g. a unique id of the user as determined by table lookup, telephone number, index into a table of email addresses, personal name, social security number, etc. The \u2018c_time\u2019 field represents the current time of the receipt of the user feedback.",{"@attributes":{"id":"p-0099","num":"0106"},"figref":"FIG. 19","b":["1900","1910"]},"The Feedback table is searched for lines, stops, or streets having more than 5 Feedback records from different users within the last 6 months. Other parameters for the frequency and recency of the feedback could also be used. In addition, other methods of testing recency could be used, e.g. weighted averages. An average rating is calculated.","If a mass transit route is found with the desired frequency and recency of feedback, all links of the route are \u201cpenalized\u201d by having the stored distance of the link multiplied by a factor, in one embodiment, 10 divided by the average rating. A sufficiently large increase will thus tend to bias the routing algorithm away from the mass transit route.","If a mass transit stop is found with the desired frequency and recency of feedback, all links that lead to this stop are \u201cpenalized\u201d, by having the stored distance of the link multiplied by a factor, in one embodiment, 10 divided by the average rating. A sufficiently large increase will thus tend to bias the routing algorithm away from the mass transit route.","If a portion of a street is found with the desired frequency and recency of feedback, the stored distance of the street portion multiplied by a factor, in one embodiment, 10 divided by the average rating. A sufficiently large increase will thus tend to bias the routing algorithm away from the street portion.","Transaction Model","The foregoing have described an embodiment of the invention which can be delivered over the web to the general public, possibly for free. In another embodiment, the invention can be offered on a subscription or fee basis to transit operators, hotels, travel agents, tourist bureaus whether public or private, corporate trip planners, or any members of the travel industry. The invention can be offered as a Web Service, as defined earlier, with a license key provided in each transaction.","A client wishing to gain access to the invention via the Web Service must enter into a contractual arrangement, possibly through an agent, with the publisher of the Web Service. The publisher might offer a variety of plans, such as a limit on the number of transactions per month, year, or other period, perhaps with \u201crollover\u201d for unused transactions as in cell phone plans. There could be a per-transaction fee if the client exceeds the limit in any given period. There might also be a fixed fee for unlimited access, or reciprocal arrangements wherein the client performs other services for the operator, such as advertising or contribution to the upkeep of the server installation.","In one embodiment, the web service is described in WSDL, or Web Services Definition Language. In one embodiment, the following nine procedure calls are offered to clients via the Web Service:","1) GetRoute","To get subway and\/or bus, and walking directions and maps for a route from address1 to address2. Returns either route info, or preview thumbnails for address1 and address2 if several matches found for the addresses.","2) GetRouteByThumbnailIds","To get a route using thumbnail ids returned by GetRoute.","3) GetRouteInfo","To get info of a route by its id.","4) GetRouteCopy","To get a copy of a route specified by its id. Used to derive a new copy of a route and its maps to prevent changing the original route, and its maps.","5) GetMap","To get a map for an address. Returns either map info, or preview thumbnails if several matches found for the address.","6) GetMapByThumbnailId","To get a map using a thumbnail id returned by GetMap.","7) GetMapInfo","To get info of a map by its id. Accepts parameters to move, zoom, re-center the map if needed.","8) GetMapCopy","To get a copy of a map specified by its id. Used to derive a new copy of a map to prevent changing the original map.","9) GetCityInfo","To get info of a city, including ids\/names of its counties, and the default county.","Although the full WSDL is not included here, a representative sample of the XML","Schema for the GetRoute protocol is shown below:",{"@attributes":{"id":"p-0118","num":"0125"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<s:element name=\u201cGetRoute\u201d>"]},{"entry":[{},"\u2002<s:complexType>"]},{"entry":[{},"\u2003<s:sequence>"]},{"entry":[{},"\u2002\u2003\u2002<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201clicenseKey\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201ccity\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201ccounty1\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201czip1\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201caddress1\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201ccounty2\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201czip2\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201caddress2\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cday\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003 name=\u201ctime\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cmode\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201ctransferPriority\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201clanguage\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201crouteId\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201csimplifiedDirs\u201d type=\u201cs:string\u201d \/>"]},{"entry":[{},"\u2003\u2002<\/s:sequence>"]},{"entry":[{},"\u2003\u2009<\/s:complexType>"]},{"entry":[{},"\u2002\u2002<\/s:element>"]},{"entry":[{},"\u2002\u2002<s:element name=\u201cGetRouteResponse\u201d>"]},{"entry":[{},"\u2003\u2002<s:complexType>"]},{"entry":[{},"\u2003\u2002\u2009<s:sequence>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c1\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cResponseStatus\u201d type=\u201cs0:ResponseStatus\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cRouteInfo\u201d type=\u201cs0:RouteData\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cMaps\u201d type=\u201cs0:ArrayOfMapData\u201d \/>"]},{"entry":[{},"\u2002\u2002\u2003<s:element minOccurs=\u201c0\u201d maxOccurs=\u201c1\u201d"]},{"entry":[{},"\u2003\u2003name=\u201cThumbnails\u201d type=\u201cs0:ArrayOfThumbnailData\u201d \/>"]},{"entry":[{},"\u2003\u2002\u2009<\/s:sequence>"]},{"entry":[{},"\u2003\u2002<\/s:complexType>"]},{"entry":[{},"\u2003<\/s:element>"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Validation of the license key, including protecting against forgeries or copying or using a license key past its expiration, can be done by any of a variety of schemes known in the art, such as one-way hash functions, public key encryption, shared-secret, etc., or no encryption (clear text)","Mass Transit Database Service","In another embodiment of the invention, a mass transit database such as that depicted in  and in the specification may be offered on a subscription or fee basis to transit operators, hotels, travel agents, tourist bureaus whether public or private, corporate trip planners, or any members of the travel industry.",{"@attributes":{"id":"p-0121","num":"0128"},"figref":"FIG. 10","b":["1000","1010"]},{"@attributes":{"id":"p-0122","num":"0129"},"figref":"FIG. 11","b":"1100"},"Foregoing described embodiments of the invention are provided as illustrations and descriptions. They are not intended to limit the invention to precise form described. In particular, it is contemplated that functional implementation of invention described herein may be implemented equivalently in hardware, software, firmware, and\/or other available functional components or building blocks, and that networks may be wired, wireless, or a combination of wired and wireless. Other variations and embodiments are possible in light of above teachings, and it is thus intended that the scope of invention not be limited by this Detailed Description, but rather by Claims following."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0004","num":"0003"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0005","num":"0004"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 4","i":"a "},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 19"}]},"DETDESC":[{},{}]}
