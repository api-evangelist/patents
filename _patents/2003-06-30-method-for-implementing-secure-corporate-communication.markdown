---
title: Method for implementing secure corporate communication
abstract: A mobile or other device connects to a server via a publicly accessible network such as the Internet. After installation upon the device, a virtual private network (VPN) client connects to the server and downloads a VPN profile. In one embodiment the device creates public/private key pairs and requests enrollment of a digital certificate. In another embodiment a digital certificate and public/private key pairs are provided. The device also receives a digital certificate from the server and verifies the server certificate by requesting the user to supply a portion of a fingerprint for the certificate. The invention further includes an automatic content updating (ACU) client that downloads a user profile for the VPN, requests certificate enrollment, and updates the VPN client and other applications when new content is available. A security service manager (SSM) server includes, or is in communication with, a Web server, multiple databases, an enrollment gateway and an internal certification authority (CA). A VPN policy manager application creates and manages VPN profiles and/or policies and communicates with the SSM server. The SSM server, which may reside on an enterprise intranet, may further communicate with one or more external CAs.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07448080&OS=07448080&RS=07448080
owner: Nokia, Inc.
number: 07448080
owner_city: Irving
owner_country: US
publication_date: 20030630
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS-REFERENCES TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["This application is related to the U.S. Patent Application Ser. No. 10\/608,818 titled \u201cMethod of Implementing Secure Access,\u201d filed simultaneously herewith and having the contents of which are incorporated by reference herein.","This invention pertains to the field of secure access to a communication network, and more particularly to the field of securely accessing a remote server or other device via a publicly accessible communication network.","Employees, customers and innumerable other persons routinely need access to a computer in their daily lives. Often, the accessed computer resides in a corporate communication network such as an Intranet, local area network (LAN) or other type of network which is accessed remotely, often via the Internet or other publicly accessible network. In many cases, the information residing on the computer is sensitive or confidential, so that the connection to the computer should be secure.","Virtual private networks (VPNs) have been implemented to assist computer users when remotely accessing a computer over a publicly accessible network. A VPN may in many ways be viewed as a secure corporate communications network that allows employees, customers and other persons having access rights to securely communicate with a corporate (or other entity's) computer. A VPN can allow secure communication to the corporate computer from sites all over the world at any time of day. When accessing a VPN or other corporate secure communications network, a user conventionally provides a username and password to access the network.","Existing VPNs and methods for implementing same are usually readily implemented by small organizations. However, with expanding usage of the Internet, cellular telephones and other mobile devices with computing capabilities, and computers in general, existing methods and systems for VPN deployment and maintenance become problematic. The problems become especially acute when users are spread across many time zones, perhaps even across the globe, and require 24 hour coverage, 7 days per week. For example, administrators have conventionally created public key infrastructure PKI data separately for each user and included that data in the VPN policy delivered to the user. This can be a very tedious and time-consuming process when the number of VPN users becomes large.","There is a need for scalable systems, devices and methods for deploying and maintaining secure communications, especially where large numbers of users are widely dispersed. In particular, there is a need for such systems, methods and devices to facilitate easier deployment of VPN client security policies, profiles and certificates to large numbers of authorized remote access users. This is especially important when the remote users access a corporate (or other entity) computer via mobile handheld devices. Because there may be numerous mobile devices in use and small devices are easily lost, ease of deployment is critical. Moreover, mobile handheld devices often have limited capabilities by comparison to a PC or laptop computer.","The present invention addresses these needs by providing secure network access to a great variety of customers. In one embodiment of the invention, a process for creating a secure communication link to a remote device via a publicly accessible network is initiated. In response to initiation of that process, a determination is made as to whether at least one local application program used to create the secure communication link is configured. If that local application program is not configured, a second process is initiated to access a database via the publicly accessible network. In response to accessing that database, configuration information is received. The local application is then configured based upon the received configuration information, and creation of the secure communication link continues based on the configuration.","Other and further aspects of the present invention will become apparent during the course of the following description and by reference to the attached drawings.","In the following description of various illustrative embodiments, reference is made to the accompanying drawings that form a part thereof, and in which is shown by way of illustration various embodiments in which the invention may be practiced. It is to be understood that other embodiments may be utilized and structural and functional modifications may be made without departing from the scope of the present invention.","Referring now to the drawings, wherein like reference numerals refer to like parts,  illustrates a block diagram of several virtual private networks (VPN) distributed across a backbone packet data network . In at least one embodiment, packet data network  is the Internet. As illustrated, VPN-A is connected by tunnels (indicated by long dashes) which represent secure communications between devices A, A and A. Similarly, VPN-B is connected by secure tunnels (indicated by short dashes) between devices B, B and B. VPN networks A and B are located in a company or organization having multiple locations. The VPN architecture illustrated in  permits an employee or member of the company or organization (or other authorized person) to access the company or organization's local area network (LAN) after connection to the company or organization's VPN by secure tunnels over the Internet or other backbone packet data network. In at least one embodiment, the connection is secured by a tunneling technology such as Secure Sockets Layer (SSL). However, the invention is not limited to any particular technology for securing the connection. A mobile device  may communicate through a mobile network  to the Internet  and then to and from the different devices B-B. Devices B-B could be part of the same intranet, or could be dispersed across multiple intranets or other Local Area Networks (LANs) or Wide Area Networks (WANs).",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 2","b":["10","12","14","18","24","10","11","19","18","36"]},"Mobile VPN client software (VPN client) is first installed in mobile device  for communication with security service manager (SSM) server . The VPN client is shown in  as one of the installed applications  in mobile device , and is explained more fully below. The user can download the VPN client using an ordinary web browser, via an infrared, BLUETOOTH, or WLAN connection, via broadcasting or multicasting (e.g., DVB-T or its modifications), via email, or via CD-ROM or other removable media. The VPN client is delivered as, e.g., a SYMBIAN OS operating system SIS file for easy installation in mobile device .","SSM server , through a Web server  (shown in ), has an interface for filtering requests received from remote sources such as mobile device . Only authenticated users are allowed to access SSM server . User authentication is based on username\/password combinations that a remote device user enters into a HTML form provided by the external User Interface (UI) of Web server . A successful authentication causes SSM server  to create a session for the authenticated user. The session is then identified between subsequent page requests by encoding a session ID into the URLs for the pages stored in Web server . Specifically, each link to subsequent web pages contains a session ID parameter that SSM server  uses to validate the page requests. Servlets and JSP pages on Web server  create the URLs in the web pages. The user can log out from SSM server  using a link in a web page provided by Web server . Because users do not always remember to log out, however, the user sessions have a short timeout value. In one embodiment, all pages of Web server  are only accessible through SSL connections. Usernames, passwords and session IDs are thus transferred only over encrypted connections.","Exemplary VPN Client Installation in User Interface of Mobile Phone","All requests from mobile device , including requests from a user's browser, are sent via hypertext transfer protocol (HTTP) to SSM server . In at least one embodiment, HTTP connections  from mobile devices  in the Internet  pass through VPN gateway  and\/or firewall\/proxy server , and SSM server  is not connected directly to the Internet .","Mobile device , which includes a display screen, a keypad and\/or other input and output devices, provides various interfaces to a user during installation of a VPN client. After download, the display indicates that a SIS file containing the VPN client is present (). Upon opening that file, the user is prompted to install the software by selecting \u201cYes\u201d (), which starts the installation process. Selecting \u201cNo\u201d cancels the installation. Upon selecting Yes, the user is provided with several selections in an options menu: \u201cinstall,\u201d \u201cview certificate,\u201d or \u201cdetails about the product being installed\u201d (). After selecting \u201cinstall,\u201d the user is asked to close all active applications running on the device (). This is for safety reasons, so that other applications do not interfere with the installation. After closing any other applications, the actual installation starts. When installation is complete, the installation process asks the user to switch the device off and on again (). This ensures that all low level components are properly installed when the device is turned back on. After installation, a Mobile VPN client icon appears on an application menu (). Users can move the client icon anywhere in the application menu or to any folder.","The installation process employs an Automatic Content Update (ACU) service. The ACU service includes a protocol between mobile device  and SSM server  that allows device  to keep its local content storage synchronized with the content of SSM server . In one embodiment, ACU service client software (ACU client) is part of the mobile VPN client, and is installed prior to installing other components of the VPN client. The ACU client setup phase comprises two protocol transactions. The first transaction is used to download an ACU client configuration package to the mobile client and the second transaction is used to enroll an ACU client certificate. The client certificate is used in subsequent ACU communications to sign ACU requests and to authenticate responses to requests.","SSM server  includes a database  (), which in turn comprises additional databases. A configuration database allows clients to fetch client configuration packages from SSM server . A certificate enrollment database allows clients to enroll certificates with SSM server . A content metadata database allows clients to fetch metadata about the content stored in a content database. The content database allows clients to fetch actual content from SSM server . All databases contain some type of data that a client can fetch. While the configuration database contains only client configuration packages, however, the content database can contain any kind of data. The content in the databases is also assigned one or more properties; these properties are included in search filters of ACU requests in order to find the desired data. For example, the certificate enrollment database supports properties such as certificate requests prepared using PKCS#10 (or other certificate request syntax) and entity name; the content database supports properties such as content ID and type.","Different levels of security authorization from incoming ACU request messages are required for access to the different databases. In at least one embodiment, there are three levels of security: Req (lowest), Req (intermediate) and Req (highest). The configuration database accepts all security levels (Req, Req and Req), while the content database requires the highest security level (Req). Table 1 below summarizes security level requirements, content properties and contents types of SSM server  databases in one embodiment. For example, the certificate enrollment database stores and returns X.509v3 certificates (e.g., \u201capplication\/pkix-cert\u201d). As is known in the art, X.509 refers to the International Telecommunications Union recommended standard for digital certificates. Search filters in a request targeting the certificate enrollment database can include three properties, an entity name, a request type and a PKCS#10 certificate request. The certificate enrollment database requires requests to have security level Req or Req.",{"@attributes":{"id":"p-0029","num":"0028"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":[{},"Supported",{},{}]},{"entry":[{},"request","Supported content","Stored and"]},{"entry":[{},"security","properties (in search","returned"]},{"entry":["Database","levels","filters)","content types"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Configuration","Req1","ACUServerAddr (the","client"]},{"entry":["database","Req2","address of the ACU","configuration"]},{"entry":[{},"Req3","server)","(e.g.,"]},{"entry":[{},{},{},"\u201capplication\/x-"]},{"entry":[{},{},{},"acu-client-"]},{"entry":[{},{},{},"config\u201d)"]},{"entry":["Certificate","Req2","EntityName (an additional","Base64-"]},{"entry":["enrollment","Req3","piece of information that","encoding of"]},{"entry":["database",{},"can be used to find the","a DER-"]},{"entry":[{},{},"right enrollment service at","encoded"]},{"entry":[{},{},"a server)","certificate (e.g.,"]},{"entry":[{},{},"RequestType","\u201capplication\/"]},{"entry":[{},{},"\u201cnew\u201d if a new request","pkix-cert\u201d)"]},{"entry":[{},{},"\u201cpoll\u201d if a repeated"]},{"entry":[{},{},"request, i.e. a certificate"]},{"entry":[{},{},"poll after a pending status"]},{"entry":[{},{},"\u201crenewal\u201d if a certificate"]},{"entry":[{},{},"renewal request"]},{"entry":[{},{},"\u201crenewalpoll\u201d if a"]},{"entry":[{},{},"repeated renewal request"]},{"entry":[{},{},"PKCS#10 (Base64-"]},{"entry":[{},{},"encoding of a DER-"]},{"entry":[{},{},"encoded PKCS#10"]},{"entry":[{},{},"certificate request)"]},{"entry":["Content","Req3","TargetContentID","metadata (e.g.,"]},{"entry":["metadata",{},"(the ID of a content item","\u201capplication\/x-"]},{"entry":["database",{},"in the content database)","acu-metadata\u201d)"]},{"entry":[{},{},"TargetContentType"]},{"entry":[{},{},"(the type of a content item"]},{"entry":[{},{},"in the content database)"]},{"entry":[{},{},"TargetContentTimestamp"]},{"entry":[{},{},"(the timestamp of a"]},{"entry":[{},{},"content item in the content"]},{"entry":[{},{},"database)"]},{"entry":["Content","Req3","ContentID","The type of"]},{"entry":["database",{},"(the ID of a content item)","the requested"]},{"entry":[{},{},"ContentType","content"]},{"entry":[{},{},"(the type of a content"]},{"entry":[{},{},"item)"]},{"entry":[{},{},"ContentTimestamp"]},{"entry":[{},{},"(the ID timestamp of a"]},{"entry":[{},{},"content item)"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"On receipt of a first response package from SSM server , mobile device  establishes a trust relationship with SSM server . In particular, mobile device  validates and stores a returned SSM server certificate. The stored SSM server certificate is then used to automatically validate subsequent ACU responses from the same server.","Mobile device  and server  complete the ACU and VPN client setup phase before starting other operations (e.g., updating content from other applications on device , using a VPN for secure communication by another application, etc.). Target databases used during client setup can vary. However, example target databases and message security levels used in ACU client setup phase are described in Table 2 and in .",{"@attributes":{"id":"p-0032","num":"0031"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Message","Target Database","Security Level"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1",".\/acu_config_db","Req1"]},{"entry":["2","N\/A","Resp1"]},{"entry":["3",".\/acu_cert_db","Req2"]},{"entry":["4","N\/A","Resp2"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}}},"Message  is used by the ACU client to fetch an ACU client configuration package from an ACU server (e.g., SSM server ). That server uses message  to return an ACU client configuration package to the ACU client. The ACU client uses message  to enroll an ACU client certificate with the ACU server. That server uses message  to return an ACU client certificate to the ACU client. During a subsequent operational phase, the ACU client sends a message to fetch content metadata or actual content from an ACU server, or to enroll a certificate with an ACU server (not shown in  or Table 2). This can include fetching a VPN policy from SSM server . In response, the server returns content metadata, actual content or a certificate to the ACU client. This can include returning a VPN policy to the ACU client.","If a SSM server or client certificate expires or otherwise becomes invalid, mobile device  initiates a new client setup phase and performs the appropriate initialization steps. If mobile device  receives a successful authentication status, but also receives an indication that the mobile client certificate is about to expire, mobile device  can enroll a new client certificate using the about-to-expire certificate for authenticating the request. Once the new certificate is received, it replaces the old one.","Messages from mobile device  to SSM server  have a portion which defines the session ID (e.g., a number) and message ID (e.g., also a number), SSM server  and client address(es). The client address portion may, optionally, also contain authentication information. A body portion of the message identifies the version of the ACU protocol (e.g. \u201cSyncML\/1.0\u201d) used in this message and expected to be used in the response package. The body portion further includes a query containing properties of the content that the client wants to retrieve from the server. For example, a query may contain the absolute URI of SSM server  (e.g.,\u201chttp:\/\/<acu-server-name>\/acu\u201d). In one embodiment, the query value is same as the destination uniform resource identifier (URI) used at the HTTP level. The message from mobile device  further includes an absolute URI or an international mobile station equipment identity (IMEI) uniform resource number (URN) that uniquely identifies mobile device  (e.g., \u201chttp:\/\/<client-name>:<port>\u201d or \u201cIMEI:493005100592800\u201d). The inclusion of client authentication and identity information depends on the security level of the request message. The message from mobile device  also indicates whether the message is the last message of a package. In at least one embodiment, an ACU package is always contained in a single message, and a \u201cfinal element\u201d description would thus be present in all ACU messages from device .","In one embodiment, the body of an ACU response message from SSM server  includes an identifier of the version (e.g. \u201c1.0\u201d) of XML (extensible markup language) used in, e.g., the ACU protocol; a status information element used to inform the application sending a particular element about the result of that element's processing by SSM server  or other recipient (e.g., an error code indicating why communication was not successful); a version of the ACU protocol (e.g. \u201cSyncML\/1.0\u201d); the properties of the content that the client wants to retrieve from the server in the corresponding request; and information on Status\/Results element pairs for additional Search elements (if any) in the corresponding request package. Results elements are present only if the corresponding queries return some content. The ID of the content item, which in at least one embodiment is the same as the ID element value in the corresponding ACU metadata, can be used as the value of the ContentID content property in ACU search filters for the content database.","Various application programs operating upon mobile device  may employ the ACU client installed on the mobile device. When an application specifies a content ID in a content updating request, the ACU Agent  () calls an Internet Protocol Security (IPSec) manager  to obtain the identity of the server with which the updating process is to be performed, and prompts the user of the device to provide the VPN client password. When ACU agent  has the server identity (SSM server  in the present example), ACU agent  continues the updating process by querying the application for a list of content types desired. ACU Agent  further asks the application for metadata (e.g., IDs, types and timestamps) about the desired content. After communication with the identified server (here, SSM server ) has been properly initialized, ACU Agent  generates an ACU request message to SSM server . That message fetches metadata regarding the content that SSM server  has associated with the client application that is requesting an update and\/or the user of that application. The ACU request includes a search filter that lists all content types that the client application wishes updated. ACU agent  then compares metadata returned by SSM server  to metadata in the application requesting an update. If differences occur, ACU agent  sets a server content update configuration parameter (e.g., \u201cForceUpdates\u201d) in ACU data storage  (). ACU agent  then fetches all new and changed content (if any) from SSM server .  is an exemplary view of a flow diagram describing how ACU messages are handled according to one embodiment of the invention.","VPN Policy Installation UI of Mobile Phone","One or more VPN policies are one type of content retrieved by mobile device  from SSM server . A VPN policy contains all the information required by a mobile device with a VPN client (e.g., \u201cmVPNClient\u201d), such as mobile device , to establish secure connections to SSM server  so as to, in at least one embodiment, access email , databases  and other facilities in the enterprise Intranet (). In one embodiment, the policy contains end-user identity data such as certificates and private keys. A VPN policy without certificates, private keys and other user-specific data is called a \u201cprofile.\u201d Multiple end-users can obtain the same profile, and then create individualized policies. In one embodiment, VPN policies and profiles are managed and administrated in SSM server , which in turn includes and\/or is in communication with policy manager application , database  and certificate authority .","A single VPN policy may require multiple user certificates. For example, a policy created by policy manager application  and transferred to database  of SSM server  could contain several VPN gateway definitions, with each definition using certificate authentication but relying on a different certificate authority. Consequently, a single policy may require multiple certificate enrollment processes before becoming ready for activation. Although a policy may have multiple associated user certificates, there is, in at least one embodiment, a single public\/private key pair of a given size for a policy. In other words, all certificates associated with a single policy and using the same key size refer to the same public\/private key pair.","In one embodiment, and as shown in , files constituting a VPN policy are contained in IPSec policy storage  and include a policy information file  (containing general information about the policy), a policy file  (containing IPSec and Internet Key Exchange, or IKE, rules), one or more certificate files  and one or more private key files . In at least one embodiment, IPSec policy storage  stores public\/private key pairs , certificates , and certificate requests and associations  (described below) for any application, not only the VPN client. IPSec policy storage  is modifiable to support new content properties that may be required by ACU agent .","Applications  operating on mobile device  access the ACU client through ACU agent . In one embodiment, the VPN client accesses ACU Agent  through IPSec manager .","At various stages during the content updating and certificate enrollment process, ACU agent  communicates with the client application (e.g., the VPN client) that initiated the updating, enrollment or other process.","ACU data storage  contains information about the client applications using the ACU client, such as VPN client information . ACU data storage  also contains information  on servers with which ACU agent  communicates on behalf of client applications, such as SSM server . The actual content and content metadata fetched from servers is stored by the respective client applications that requested update or other ACU service. In the case of the VPN client, content and content metadata is stored in IPSec Policy Storage . As also shown in , mobile device  includes an interface to mobile network  such as transceiver , a CPU , as well as telephone and calendar applications. Although not shown, mobile device  would also have one or more user input devices (e.g., a keyboard), output devices (e.g., a display) and other known components.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 4","b":["66","78","80","82","20","82","20","84","82","10","20"]},"In one embodiment, ACU agent  and each application using the ACU client communicates during the content updating and certificate enrollment processes with IPSec manager . IPSec manager  is, in one embodiment, a part of operating system software on mobile device  (such as the SYMBIAN OS operating system). IPSec manager  manages IPSec policy storage , including the certificates and private keys stored therein. IPSec manager  also performs encryption and decryption operations with the private keys stored in the policy storage . In one embodiment, the private keys are installed and stored in encrypted form, and IPSec Manager  manages the policy import and VPN client passwords needed to decrypt and encrypt the private keys. The VPN client software, through IPSec manager  and\/or other operating system components, implements dialogs to request VPN client and policy installation passwords from the user.","IPSec manager  further supports the generation and storing of public\/private key pairs, the storing of certificates and the generation and storing of certificate requests for the VPN client software and for other applications. IPSec manager  assumes functionality required to support policy updating and certificate enrollment processes. When the user starts a policy updating process with a command to IPSec manager , IPSec manager  (through a user interface) asks for the VPN client password.","In one embodiment, the VPN client supports two principal types of VPN authentication: certificate authentication and legacy authentication. Certificate authentication is based on user public key infrastructure (PKI) data (e.g., a public\/private key pair and corresponding certificate), while legacy authentication is based on usernames and passwords\/passcodes.","The certificate enrollment process is available in two forms: automated and manual. The user initiates a automated certificate enrollment process by activating a policy that requires certificate enrollment. A policy requires certificate enrollment when it is a PKI policy and lacks all user PKI information, or when the user PKI information is incomplete or expired. The user initiates a manual certificate enrollment process by selecting a policy that requires certificate enrollment in the VPN client UI and then choosing a specific command from the client menu.","In one embodiment, profiles are created using a VPN policy manager application  and describe the VPN structure (e.g., network topology) to gateways and to clients. In one embodiment, VPN gateway  performs final checks of access rights, and a client version of a policy contains only information required to set up secure connections to correct gateways.","In some embodiments, policy manager application  includes user private keys and certificates with a policy. If a VPN profile defines the use of certificates and private keys, but does not contain them, a VPN client will create a public-private key pair and a corresponding certificate request and then send the request to a certification authority (CA)  for enrollment. If the enrollment is successful, the CA  sends back a certificate and the VPN client is ready for secure connections.","To facilitate the certificate enrollment process, one embodiment of SSM server  acts as a certificate enrollment gateway. In this case, VPN clients send enrollment requests to SSM server  instead of CA , and only SSM server  communicates with CA . SSM server  then performs the necessary authentication and authorization to make certificate enrollment fully automated. SSM server  authenticates users with a user database  or a remote authentication dial-in user service (RADIUS) server . The latter enables the usage of password tokens such as SECURID (available from RSA Security Inc. of Bedford, Mass.).","In some embodiments, SSM server  functions as an internal VPN certification authority. In such case there may be no need to use a third party CA to sign VPN certificates, which can result in significant cost savings in PKI-based VPN deployments.","VPN policies and profiles may change after they are initially deployed. Clients can update a policy from SSM server  in various ways. In one embodiment, the VPN client, using the ACU client, automatically checks for updated policies upon connection to SSM server . Upon finding updated policies, the VPN client (using the ACU client) automatically imports any changes. The ACU protocol is based on SyncML in one embodiment and cooperates with SYMBIAN OS-based VPN client software. Automatic updating minimizes the need for email notifications and browser-based downloads.","During the policy updating process, and regardless of whether policy activation succeeds or not, IPSec manager  sets a parameter that specifies whether policy updating has started. The setting is stored in an initialization file of IPSec manager  (not shown in ). Next, IPSec manager  initiates the policy updating process for the activated policy by calling a corresponding ACU agent method and passing various parameters to it. Those parameters include the policy ID (as content ID) and the ID of an IPSec ACU plug-in (e.g., UID of the IPSec ACU Plug-in DLL). ACU agent  then loads the specified plug-in and uses the plug-in (not shown in ) as an interface between ACU agent . and IPSec manager  to obtain the ID of the server (SSM server  in the example) with which the updating process is to be performed; the plug-in then implements the call from ACU agent  by calling IPSec manager . If the plug-in does not return a server ID to ACU agent , the updating process terminates. The process is also terminated if the client application record in the ACU data storage  does not have an associated server account record with the specified server ID. If the plug-in returns a valid server ID to ACU agent , the policy updating process continues.","Provisioning in Mobile Client UI","A user can initiate provisioning of mobile device  via a UI (e.g., moving a selection box on top of an icon and pressing a selection key, as shown in ). In one embodiment, no data is displayed if there are no policies installed on the device (). In that embodiment, an options menu in a UI of mobile device  lists various functions a user can perform, and a back command returns a user to a main application menu.","To obtain a first policy, a user connects to SSM server . From the Options menu, the user selects \u201cUpdate from server\u201d () to start policy reception. Mobile device  connects to SSM server  and connection is protected by a VPN client password. If it is the first time the device is being used, a user may be required to create a VPN client password. During password entry, each character is shown for a moment before it changes to an asterisk (). Pressing \u201cOK\u201d after entering characters accepts the password and continues the process. Selecting \u201cCancel\u201d returns a user to the client main screen. In next provisioning step the user enter the URL or IP address of SSM server  (). In one embodiment, the server address is delivered to the user by a corporate security or network manager. After entering \u201cOK,\u201d the address is accepted and the process continues. As before, \u201cCancel\u201d returns the user to the VPN client main screen. Next, the user selects an Internet Access Point (IAP) to connect to the Internet (or to a specific dial-up network) (). In one embodiment, the operating system displays a dialog when it detects that an application requests Internet access. \u201cSelect\u201d accepts an Internet access point, and \u201cCancel\u201d returns the user to the VPN client main screen. Next, mobile device  connects to SSM server . In one embodiment, a \u201cG\u201d in a box in the top left corner of a display informs the user that GPRS access is active in a mobile network (). If \u201cCancel\u201d is selected the process terminates.","If a certificate for SSM server  and configuration information for the VPN client are not present (or are invalid), the client initialization process fetches a client configuration package from SSM server  (). Without an existing SSM server certificate in the ACU data storage , ACU agent  cannot automatically trust the response and the server that sent it. To establish trust, ACU agent  asks the user to enter a server identity code. In one embodiment, software on mobile device  prompts the user to enter numbers from a 16 byte identification code or \u201cfingerprint\u201d of an incoming certificate, and displays the remaining numbers for the user to verify against the full fingerprint. For example, a fingerprint code may be of a form, e.g. \u201c12qwe34rtyqwe1234\u201d. When verifying the server, the user is shown an incomplete code or string, e.g. \u201c12qwexxrtyqwexx34\u201d, where \u201cx\u201d depicts a missing character. To verify the server, the user must then enter \u201c34\u201d in the first two x's and \u201c12\u201d in the last two x's. The mobile device  calculates a fingerprint of the certificate received during the connection and converts it to a readable string; the device then removes (e.g., changes to \u201cx\u201d, \u201c_\u201d, etc.) one or more randomly selected characters from the string and displays the modified string to the user. The random character selection can be tailored to the capability of a mobile device. For example, in a mobile phone with a small keypad, only digit characters are randomly removed. The device capabilities may be determined by, e.g., the IMEI code for the device.","The number of missing characters in the string may also vary. The positions of the randomly removed characters within the fingerprint are different for different access attempts. ACU agent  compares the user-entered digits or characters to the characters removed from the 16 bytes of thee received SSM server certificate's fingerprint. If the code matches the fingerprint, i.e. the user-input characters match the characters removed from the server fingerprint, ACU agent  assumes that SSM server  can be trusted and stores the server certificate to the certificate file  in IPSec policy storage  by calling IPSec manager . The connection to SSM server  is then allowed to continue.","Another example of the foregoing procedure is shown in . SSM server  creates a hash of the server's certificate and sends that hash to mobile device  as a fingerprint. In the example of , the fingerprint is the 16 byte hexadecimal value 11:AF:93:B4:C8:B8:BA:CE:81:64:00:DB:9F:D5:91:59. Prior to policy provisioning, a network administrator provides the user of mobile device  with the fingerprint in a secure manner, e.g. by mailing a card having the fingerprint. imprinted thereon. Mobile device  calculates the fingerprint (e.g., the hash of the certificate) and displays the fingerprint with four randomly-selected characters replaced with blanks (\u201c_\u201d). The user then enters the four missing characters. The user is thereby prevented from accepting the certificate without actually verifying it.","Using the foregoing procedure, a user verifies the certificate of a server to ensure that the user is connecting to a legitimate server, and not a hostile server (such as a server pretending to be the desired server). This verification is done by comparing the previously published fingerprint of the certificate against the fingerprint calculated from the certificate received from the server.","As indicated, the fingerprint code for SSM server  is provided off-line (prior to provisioning) to the user in various embodiments. The server's administrator publishes the certificate's fingerprint in some way which cannot be changed by attackers (e.g., a company newsletter, personal delivery, regular mail, etc.). The user's client software calculates the fingerprint and then it displays the fingerprint to the user with random characters replaced with blanks (or other characters) and asks the user to enter the missing characters. To be able to do this the user must verify the shown incomplete fingerprint against the published fingerprint. If he can enter the valid characters, then he also has verified that the fingerprint is a correct one (otherwise he would not have known the missing characters).","In at least one embodiment, the VPN client substantially simultaneously (and without user interaction) requests a certificate from SSM server  whenever connecting mobile device  to a corporate network (such as the intranet of ). In other words, the VPN client software adds the above-described certificate validation process to every server access attempt.","An embodiment of the invention allows users to confirm connection to a secured device when obtaining high-speed Internet service from home, hotels, airports, cafes, etc. For example, a user may be traveling and wish to connect mobile device  to a high-speed Internet access point at a location being visited. A fingerprint of a certificate for such an access point is delivered through trusted media to everyone wishing to use the access point. In a hotel, the fingerprint could be provided by a front desk clerk. The fingerprint could also be mailed to a user. The fingerprint could be publicly displayed in trusted environment that cannot be easily altered, such as an encased or difficult to reach bulletin board. Similar to the procedure outlined above, mobile device  could then, as part of connection to the high-speed access point, require the user to supply characters of the fingerprint.","In some embodiments, and as previously indicated, the fingerprint of a certificate is calculated from the certificate itself, such as through a hash function.","After the user of device  verifies the certificate of SSM server , SSM server  requires the user to verify that the user is who he or she claims to be, and that an account has been established for him or her. The user is prompted to enter a user name and password for access to SSM server  (). In some embodiments, tokens or one time passwords could be used. After SSM server  and device  are authenticated to one another, device  stores the SSM server  certificate and receives information about available content (). ACU agent  stores a reference to a received certificate in the server account record  () of the ACU data storage  () along with other client configuration information received from SSM server . The user gets a list of available content () that (in the example) includes a new VPN policy (\u201cgeneric*\u201d) from VPN policy manager application , as well as an ACU certificate (\u201cACUcert\u201d). The ACU certificate is a device certificate for the user that is used to authenticate device  to SSM server . Device  downloads the content (). When content download is complete, device  shows the available VPN policies (; no certificates are shown). The user can now use the new policy(ies) by connecting to a VPN gateway.","At this point, device  has received a policy that requires certificate enrollment. In other words, the policy does not yet have an attached certificate which can be used for authentication. If a client certificate is not in place or is invalid, the client initialization process continues with client certificate enrollment.","The VPN client of device  first checks whether the VPN policy is a certificate authentication policy, and whether a certificate is attached to the policy. If the policy does not contain a valid certificate, the user is asked if he or she wishes to enroll a certificate (). Upon selecting \u201cyes,\u201d the user is presented with a UI indicating generation of a certificate request (). This starts with the generation of a public\/private key pair for the client application, unless a key pair of the required length has already been created. In one embodiment, all server accounts that ACU agent  creates for a client application use the same set of key pairs. The set includes a single key pair of each different key length required by the servers. Key pairs are generated by calls to IPSec manager . The length of generated keys is determined by a parameter included in client configuration information fetched from SSM server  and stored in the corresponding ServerAccount record  in ACU data Storage .","Next, ACU agent  may request legacy authentication information (username and password) from the user (not shown). The legacy authentication information is used to authenticate the certificate enrollment request sent to SSM server . In addition, the specified username may be combined with user identity information contained in a client configuration package, or a message transaction used to download an ACU client configuration package (e.g., the ACU client certificate used in subsequent ACU communications) to the ACU client, to form the user identity to be used in the Client certificate.","Once the username has been asked, the key pair is ready and the returned key pair identifier stored to the appropriate ServerAccount record  in ACU Data Storage , ACU agent  obtains a privacy enhanced mail (PEM) encoded PKCS#10 certificate request for the generated key pair and supplied user identity by calling IPSec manager . In the case of a client certificate, the challenge password attribute in the certificate request is left empty. IPSec manager  then checks whether the asked certificate request already exists (erg., is cached) in IPSec policy storage . If the request does not exist, IPSec manager  creates it by using a PKCS#10 module (not shown in ).","After creating the certificate request, IPSec manager  stores (caches) the request to IPSec policy storage . The request cache is used to avoid the re-generation of certificate requests whose enrollment completes one or more times with a pending status. ACU agent  then constructs an ACU request message containing the PKCS#10 request. Device  then sends the message to SSM server  for certificate enrollment. The user is prompted to select an Internet access point (). ACU agent  then stores the returned enrollment status (success, failure, pending) to the appropriate ServerAccount record  in ACU data storage .  shows a UI indicating receipt by device  of a certificate. If the certificate enrollment is successful, ACU agent  stores the returned client certificate to IPSec policy storage  by calling IPSec manager . ACU agent  also stores a reference to the saved certificate to the appropriate ServerAccount record  in ACU data storage . If SSM server  returns a certificate enrollment return code indicating success or failure (i.e., not a pending request), ACU agent  deletes the corresponding certificate request from IPSec manager .","The automated certificate enrollment process is initiated when a user activates a policy via the IPSec UI. The policy activation request flows from the IPSec UI to the IPSec application programming interface (API) and further to IPSec manager . If IPSec manager  determines that the policy being activated requires certificate enrollment, it returns a corresponding return code to the IPSec API without activating the policy. On receipt of a return code indicating need for certificate enrollment, the IPSec API stops the policy activation process and returns the return code to the IPSec UI. On receipt of a return code indicating need for certificate enrollment, the IPSec UI first launches a confirmation dialog allowing the user to accept or reject the forthcoming enrollment process. If the user accepts the enrollment, the IPSec UI continues by opening a progress dialog that will be shown as long as the enrollment process continues. The progress dialog also allows the user to stop the ongoing enrollment process. In one embodiment, the VPN client password is asked at initiation of the policy activation process (before the above confirmation and progress dialogs) and is not asked again during the certificate enrollment process.","The user can move to other applications while the certificate enrollment process continues. The progress dialog is only visible in the IPSec UI, but dialogs requiring user interaction during the updating process appear on top of other applications the user is accessing.","After the user reaccepts enrollment in the IPsec UI, the enrollment process continues by call to ACU agent  to perform automated certificate enrollment for the specified policy. The call includes as parameters the ID of a plug-in to be used in the enrollment process (e.g. an IPSec ACU Plug-in, or interface to IPSec manager  for ACU agent ) and the ID of the policy for which certificate enrollment is to be performed. From the point of view of ACU agent , the policy ID is a client-specific parameter, e.g., a user of device  may belong to many groups (discussed below), but the user has one policy ID. Next, ACU agent  calls the IPSec ACU Plug-in to return a list of enrollment servers for the policy. The IPSec ACU Plug-in implements the call by calling IPSec manager . A server address in the returned list indicates the server (e.g., SSM server ) where the one or more certificate requests are to be sent. However, a single VPN policy can refer to multiple certificates and each certificate can be enrolled with a different server.","Next in the enrollment process, ACU agent  takes the returned server addresses, one at a time, and checks whether communication with the respective server is properly initialized. If not, ACU agent  asks the user to select the IAP to be used for communicating with the server (e.g., ). Then, ACU agent  performs a client initialization process for the server. Once communication with the server is properly initialized, ACU agent  calls the plug-in to return the certificate requests for the specified policy-server combination. The ACU identity associated with the server (e.g., SSM server  ) is also included in the call.","When IPSec manager  receives a request to create and return certificate requests for a certain policy, it handles the request. Each certificate request in the list returned to ACU agent  by IPSec manager  includes a PEM-encoded PKCS#10 certificate request and a request identifier. Request identifiers are defined by client applications and passed back to the applications (through the corresponding ACU interfaces) in enrollment responses. In the case of the VPN client, the request identifier is a combination of subject identity and key pair information that the VPN client can use to find the policy and host with which a certain enrollment response is associated. ACU agent  then creates an ACU request message comprising all certificate requests aimed at a certain server and sends the request message.","When a response is received from a server, ACU agent  parses the response and passes the returned certificate enrollment responses, one at a time, to the IPSec ACU Plug-in. The plug-in passes the responses further to IPSec manager .","An enrollment response comprises a policy ID, a certificate request ID and a status code, and may include a certificate. The certificate is present only if the status code indicates a successful enrollment. A certificate is missing if the status code indicates a failure or that the enrollment request is pending.","When the IPSec Manager  receives an enrollment response, it stores the certificate (if returned) to IPSec Policy Storage  and saves the enrollment status to the corresponding enrollment information field in the VPN policy file . The corresponding enrollment information field is found according to the returned certificate request identifier.","If the enrollment status code indicates success or failure but not a pending request, IPSec Manager  deletes the cached certificate request from IPSec Policy Storage .","When ACU agent  has processed all certificate requests returned by the IPSec ACU Plug-in for a certain policy and passed the returned certificates back to the plug-in, it returns a success\/error code to the IPSec API that initiated the certificate enrollment process. The IPSec API then returns the code to the IPSec UI.","If the IPSec UI receives an error return code as a response to a certificate enrollment call, it shows a dialog advising the user that the enrollment failed and that the policy cannot be activated. If the IPSec UI receives a success return code, it shows a dialog advising the user that the enrollment succeeded and that the policy can now be activated. In this dialog, the user can let the policy be activated or cancel the activation. If the activation continues, the VPN client password is not requested again, as it was obtained before the enrollment process was started.","Activating a Policy","After a policy is downloaded, the user must activate it. In at least one embodiment, a user activates a policy by selecting the policy () and then choosing \u201cActivate\u201d in an Options menu (). Policy activation is protected by the VPN client password (). For a certificate policy, this password also unlocks the private key functions. The user selects the Internet Access Point (IAP) he prefers to use to connect to the corporate network (). Once user has selected the IAP, the device initiates a connection to a VPN gateway by showing user that GPRS connection is active for \u201cpredefined generic\u201d policy; a colored dot  indicates that the initialization is under way (). Upon successfully establishing a connection, the VPN tunnel is ready for use by any application, and the user interface advises that the \u201cpredefined generic\u201d policy is active by changing the color of dot  to, e.g., green. The user can then securely access his or her data in the Intranet by selecting an appropriate application. The user can deactivate the VPN tunnel connection by returning to policy application and select \u201cDeactivate\u201d from the Options menu.","In several embodiments, a SSM server includes various components and a Management station. These components can be combined into a single platform or divided among multiple platforms. Referring to , SSM server  is shown inside the dashed box with an enrollment gateway (EGW) , a Web server , a database  and an internal CA  to indicate that these components, in at least some embodiments, reside on a single device. In other embodiments, some or all of these components reside on separate devices. In still other embodiments, other components (including, e.g., e-mail gateway , RADIUS server  or VPN policy manager application ) could reside on the same device with SSM server .","Database  is an embedded relational database that stores information about the users, user groups, client policies, other files and their properties. The ACU client refers to SSM content objects in database  with logical identifiers such as, e.g., Acu_config_db<name>, and performs certificate enrollment using logical identifiers such as, e.g., Acu_cert_db<name>, which identifiers are recognized and interpreted by SSM server . End-users of SSM server  authenticate themselves before receiving access to the information or functionality of SSM server . Authentication is based on the use of authenticators (authentication providers). User identity in database  is of a type of a USERFQDN, (user+fully qualified domain name, e.g., userid@domain.). Further information from the users may include last name, first name, logon name, password, e-mail address, mobile, phone number or IMEI, authentication server, user groups, self-provisioning rules, and matching rules.","SSM server  determines where a user is identified. There are at least three different types of authenticators. The first is a SSM authenticator, wherein the user id\/password combinations are checked against database . Only one instance of this authenticator type can exist at a time. The second type of authenticator is a RADIUS authenticator, wherein the user id\/password combinations are checked against RADIUS server . The passwords can be either normal passwords or one-time passwords generated with token cards (such as SecurID). Several instances of this authenticator type can exist at the same time.","The third type of authenticator is certificate authenticator, wherein the user must present a valid certificate and a signature. The certificate validity requires that it is signed by a trusted CA, and that it not be expired or revoked. If the signature was signed with the certificate, the user is considered authenticated. The email address in the subject alternative name extension field of the rfc822Name is used to map the user to a SSM user id. In the certificate request field an identity of the certificate subject is inserted in the subject alternative name extension field of the ACU client certificate as an rfc822Name (i.e., an e-mail address in the form \u201clocal-part@domain\u201d). The e-mail address is constructed from a user name\/ID asked from the user and the fully qualified domain name specified in the FQDN element, which value is used as the domain part in an e-mail address stored in the subject alternative name extension field of the ACU client certificate. The common name of the subject DN is the same as the local-part of the rfc822Name. If a subject DN suffix is present in a user certificate used to access a VPN gateway, it overrides a corresponding enrollment service configuration value. A flag indicates whether a user certificate used for accessing a VPN gateway should include the user identity as an rfc822Name in the certificates' subject alternative name extension field. Possible values are 0=no and 1=yes. If this value is present, it also overrides the corresponding enrollment service configuration value. The fully qualified domain name (FQDN) to be used is the rfc822Name value if the user identity is included as an rfc822Name in the certificates' subject alternative name extension field. If this value is present, it also overrides the corresponding enrollment service configuration value. The expected length of the private key whose corresponding public key is included in the user certificate used with this VPN gateway may also be provided. If this value is present, it also overrides the corresponding enrollment service configuration value.","Each authenticator has a name and a varying number of attributes that depend on the type of the authenticator. In at least one embodiment, all authenticator implementations support a common Java interface, the authenticator interface.","The association of authentication requests with authenticators is based on the credentials supplied (user id\/password or a certificate\/signature), a mapping of authenticators to users, and a set of self-provisioning rules. If the user making the authentication request has a record in the SSM database, the authenticator specified in that record is used to authenticate the user. If the record does not specify an authenticator, the authentication fails.","If the user making the authentication request does not have a record in the SSM database, the authentication is performed according to a set of self-provisioning rules. In one embodiment, a self-provisioning rule maps together three pieces of information: a domain ID, an authenticator and a user group. A domain ID is extracted from the user name included in the authentication request and compared to the domain IDs defined for the self-provisioning rules. If a matching rule is found, the authenticator specified in the found rule is used to authenticate the user. If a matching rule is not found, the authentication fails.","SSM components accessing other components without an end-user identity (e.g. a PKI server requesting a CRL (certificate revocation list) from SSM server ) must also be authenticated. This is based on a shared secret that was given by the system administrator when he or she installed the components.","When an end-user is successfully authenticated with a self-provisioning rule (e.g., when there is no user record in database ), a new user record is automatically created in database . The new user record is automatically associated with a user group that is specified as the default group In the self-provisioning rule that was used to authenticate the user. In addition, the new user record is associated with the authenticator that was used to authenticate the user.","A default user group can have any number of content entries associated with it; content can thus be automatically associated with users. Users can then retrieve content from SSM server  even if the administrator has not created or imported any user information to SSM server .","Once connected to SSM server , a user (either a client user or administrator) can use SSM server  according to permissions defined in the database . The permission information is also stored in database  for users that are authenticated against an external authentication server. In at least one embodiment, usage permissions are defined in the SSM as roles. A role is a definition of the objects that users are allowed to access, and the actions they can perform, when in that role. In one embodiment, SSM server  supports four different types of user groups: system managers, user managers, content managers and client users. Each of these group types has an associated role that is inherited by all actual groups of that type as well as by all users that belong to those groups. A user that belongs to several user groups with different roles inherits the least restricted role. In one embodiment, the default user group types and their roles are defined in SSM server  configuration or ACU configuration and cannot be changed via the SSM server  manager graphical user interface (GUI) or command line interface (CLI). By changing SSM server  configuration, however, roles associated with default group types can be changed.","Components accessing SSM server  functions over the network without a user identity have a special component role that is used to define what those components may do. In addition, there is a special internal role that is used internally by SSM server , which role can access all objects and perform all operations. Although VPN client software installation packages and VPN policies\/profiles are types of content handled by the SSM, the SSM is not restricted to these content types.","The content that SSM server  delivers is not necessarily created within SSM server  itself. Rather, content can be created in external systems and imported to SSM server  as files. Inside SSM server , the files are turned into content entries with a certain multipurpose Internet mail extension (MIME) type. The import operation can be started from a CLI of SSM server . In some embodiments, the files to be imported must be accessible locally through normal file system operations.","SSM server  integrates with the policy manager application (PMA)  by allowing the policies and profiles created and maintained by PMA  to be exported to SSM server . This operation is initiated from within PMA . PMA  communicates with SSM server  via, e.g., a JAVA interface designed for this purpose.","SSM administrators can import user and user group information to SSM server  from external systems. In addition to plain user and user group information, user-to-group and group-to-group mapping information can also be imported to SSM server . For example, administrators can create users and user groups, search users and, user groups, modify user and user group attributes, move and delete users and user groups, associate users with user groups and content entries, and associate user groups with other user groups (e.g., to form a group hierarchy).",{"@attributes":{"id":"p-0098","num":"0097"},"figref":"FIG. 6","b":["112","114","116","118","110","112","114","116","118","10","110","112","114","116","118"]},"Group  in  is associated with a single policy and a single user. However, because of the inheritance mechanism (sales is inherited from London office which is inherited from Company HQ), the group of users  has different associated policies than do groups  and . Paul Boss has a one associated policy, the Company HQ policy, through the Company HQ group . Mary Scary is in the London office and has two associated policies, Company HQ  and London . Tim Tooth works in the London sales office and has three associated policies: Company HQ , London  and Sales .","When a content entry is associated with a user group , the entry is indirectly associated also with all users and groups that belong to that group or any of its child groups. This indirect association is enforced at run-time by application logic that traverses the group hierarchy from bottom to top. When a content entry is deleted, all of its associations with users and user groups are also deleted.","EGW  (, ) certificates for ACU authentication are issued from SSM internal Certification Authority (CA) . EGW  can also issue certificates for VPN authentication from internal CA . Alternatively (or additionally), EGW  can communicate with External CAs, acting as a Registration Authority (RA) towards external CAs and as a control point for client certificate enrollment requests, and can forward enrollment requests to an appropriate CA using SCEP (simple certificate enrollment protocol) or CRS (certificate request syntax). In some embodiments, EGW  provides enrollment protocol conversion.","In various embodiments, Web server  acts as an external interface to SSM server . A mobile device  sends a certificate enrollment request to Web server , which forwards it to the EGW . Mobile device  also connects to Web server  for automatic content updates from SSM database . A VPN policy manager application  exports client policies (or profiles) to Web server , which stores them in SSM database . As indicated above, the SSM system may comprise a number of server and client components.","SSM server  uses the Remote Authentication Dial In User Service (RADIUS, RFC2138) protocol to communicate with external authentication servers. This protocol is transported over user datagram protocol (UDP).","In some embodiments, SSM Server  is the central component in the SSM system, and the only component that accesses the internal database or the external authentication servers.","EGW  provides SSM Public Key Infrastructure services: certificate EGW (enrollment gateway)  and certificates for ACU authentication issued from SSM internal certificate authority . Certificates for VPN authentication may come from SSM internal CA  and\/or external CAs. In some embodiments, only SSM server  classes can access EGW  directly, and other components (e.g., management applications, web servlets) access EGW  only through the management interfaces of SSM server .","EGW  uses SSM server  to store its persistent data (e.g., certificates, CRLs, etc.) as well as to authenticate and authorize certificate enrollment requests. EGW Server  communicates with SSM server .","SSM server  has a GUI and\/or CLI to provide management and administrator interface to SSM server management functions.","SSM server  publishes two interfaces that are used to import policies, profiles, and other content to be distributed. A generic HTTP-based content update API can be used by any external software component. The HTTP servlet imports the content into database . Web server  implements the SSM end-user functionality. Web server  also runs servlets which handle XML processing of the ACU requests, forward HTTP requests to EGW Server  (through SSM server ), and provide the HTTP based import interface.","Web server  is a HTTP(S) listener for SSM server . In at least one embodiment, this is the only component in the system which listens for requests coming from the external network.","SSM server  components use several network interfaces and protocols to communicate with each other or with external systems. EGW server  and SSM server  can communicate using any appropriate protocol. In one embodiment, a request\/response protocol over two TCP\/IP connections (one for each direction) is used. The tag-length-value based protocol is encrypted and both parties are authenticated by the fact that they know the secret key which is derived from the shared secret asked during the installation.","SSM server  uses, e.g., Simple Mail Transfer Protocol (SMTP) over TCP\/IP to send e-mail notifications to end-users. An e-mail gateway is used to route e-mail messages.","As indicated, and in at least one embodiment, all requests from a VPN client of a mobile device , as well from an end-user's browser, come over HTTP to Web server . These requests include a user's web browser sending HTTPS requests to Web server , in response to which Web server  provides HTML pages and\/or downloaded files. These connections are encrypted with SSL; SSM server  is authenticated based on its certificate and the mobile device is authenticated with a username\/password. Web server  also receives certificate enrollment requests from the VPN client of mobile device  over HTTP. The requests are encrypted and signed, and a plain HTTP connection may be used. Web server  also receives Automatic Content Update (ACU) requests from the VPN client of mobile device . These requests are encrypted and signed; SSM server  is authenticated based on its certificate and mobile device  is authenticated with a username\/password or a certificate issued for this purpose.","HTTP connections from the clients in the public Internet  (e.g., device ) pass through a firewall  and\/or a proxy\/gateway . An application on device  can import and update policies from SSM server  using a HTTP connection encrypted with SSL (HTTPS). SSM server  is authenticated based on the certificate and device  is authenticated with a username\/password, and the user belongs to the Content Manager group, e.g., when policy manager application  pushes policies towards SSM server . Once connected to SSM server , a user (user  or administrator) can use SSM server  according to the permissions defined in the SSM. In one embodiment, the permission information is stored in database , even for users that are authenticated against an external authentication server.","VPN gateway  uses HTTP to request Certificate Revocation Lists (CRLs) from the EGW  (through Web server  and SSM server ). CRLs are signed entities that can be transported over a plain HTTP connection without encryption.","EGW  may connect to external Certification Authorities to forward certificate requests over HTTP.","SSM server  is not limited to use as a VPN policy deployment tool. SSM server  supports scalable deployment of PKI and secure distribution of any content to authenticated and authorized end-users. Scalable PKI data generation can be delegated to VPN clients. In such case, a user receives a generic policy (i.e., a profile) without PKI data, and the user's VPN client generates the PKI data before the policy is used. In particular, the client generates a public\/private key pair and corresponding certificate enrollment request and sends the request to a Certification Authority (CA). The CA then creates and returns the certificate.","The many features and advantages of the present invention are apparent from the detailed specification, and thus, it is intended by the appended claims to cover all such features and advantages of the invention which fall within the spirit and scope of the invention. Numerous modifications and variations will occur to those skilled in the art, and the invention is not limited to the exact construction and operation illustrated and described herein. All suitable modifications and equivalents which may be resorted to are within the scope of the claims. The foregoing description is intended to be exemplary rather than limiting. As but one example, the invention has been described by reference to a SSM server ; devices, systems and methods according to the invention could include (and\/or include communication with) multiple SSM servers . The invention further includes (and\/or includes communication with) servers and devices that that lack all of the features described with regard to SSM server , and\/or that contain additional features. As another example, a returned certificate can be validated based on a hash calculated over an entire ACU message (except for the signature element of the ACU message) resulting in a first response from a remote device, with the hash being signed with a private key held by the remote device, and with the corresponding certificate being included in the first response and used by the recipient to verify the signature and identify and authenticate the sender. These and other modifications are within the scope of the invention as defined in the attached claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing summary of the invention, as well as the following detailed description of preferred embodiments, is better understood when read in conjunction with the accompanying drawings, which are included by way of example, and not by way of limitation with regard to the claimed invention.",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIGS. 8-35"}]},"DETDESC":[{},{}]}
