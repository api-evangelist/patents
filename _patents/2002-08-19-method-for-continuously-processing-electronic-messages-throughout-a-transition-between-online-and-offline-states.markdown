---
title: Method for continuously processing electronic messages throughout a transition between online and offline states
abstract: An electronic mail (e-mail) application program includes a configurable, e-mail messaging feature for automatically responding to a portable computer's transition between online and offline states. The e-mail application program determines the state of a connection between a portable computer and an electronic mail server and processes electronic messages in accordance with the appropriate state. The portable computer's transition between an online state and an offline state triggers a user-configurable response, designed to permit the continuation of electronic mail message processing in a manner that accommodates the state change. The e-mail application program responds to such a transition by automatically switching between online and offline modes of operation. The e-mail application program can also respond to such a transition by establishing a secondary connection to a mail server when a primary connection is rendered inoperative. A user may configure various aspects of the invention to respond to a transition in a way that accommodates the user's hardware and/or software requirements.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06954782&OS=06954782&RS=06954782
owner: Microsoft Corporation
number: 06954782
owner_city: Redmond
owner_country: US
publication_date: 20020819
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a continuation of application Ser. No. 08\/992,730, filed Dec. 17, 1997, now U.S. Pat. No. 6,457,879, which application(s) are incorporated herein by reference.","The present invention relates to a method for sending and receiving electronic messages, and more particularly relates to an improved method for enabling a computer to continually process electronic messages when the computer makes a transition between online and offline states.","Electronic mail (e-mail) has become an extremely popular communications medium. Computer users have replaced many forms of paper correspondence with e-mail correspondence to capitalize on the speed and economy of electronic communication. The typical office or campus environment utilizes a Local Area Network (LAN) to connect computer users to a central e-mail system. Generally, a LAN connection provides a direct line of communication between an individual user's computer (remote computer) and the e-mail system (mail server). LAN connections are usually hard-wired into a building or across a campus so that all of the remote computers in the network can enjoy the benefits of a direct connection to the server. However, as portable computers have become more popular and powerful, users are demanding access to mail servers from locations where direct, hard-wired connections are not feasible.","Typically, a connection between the remote computer and the mail server can be either a direct connection, provided by a Local Area Network (LAN), or a dial-up connection, provided through a modem connection to a network node. At work a portable computer user might have a docking station that provides a LAN connection. When away from the office with the portable computer undocked, the user might utilize a modem to connect to the mail server. A computer network that supports modem connections is commonly referred to as a dial-up network, because it typically utilizes a telephone connection between the modem and the server.","Because a LAN connection is a direct, hard-wired connection, it can provide high-speed communications capabilities between the mail server and the remote computer. A remote computer user can connect to the mail server (go \u201conline\u201d), access his or her mail, send outgoing e-mail messages, check for and receive incoming e-mail messages, and remain online for extended periods. As mail is sent to the remote computer user, via the mail server, the mail server processes and delivers the mail to the remote computer user's e-mail server. The remote computer periodically polls the server to check the user's e-mail mailbox for new incoming e-mail messages.","A dial-up connection provides access to e-mail for remote computer users that are located in areas where LAN access to the mail server is unavailable (e.g., at home, at a hotel, etc.). Typically, a dial-up connection is utilized where the remote computer user wishes to use a modem to connect to the mail server via a telephone connection. Because the connection is not direct, communication between the mail server and the remote computer is slower than with a LAN connection. The remote computer user, connected via a dial-up connection, can perform all of the operations that could be performed via a LAN connection, but each operation usually takes more time.","The remote computer user will typically perform e-mail operations by utilizing an e-mail client application program module (e-mail client) that runs on the remote computer. The e-mail client may communicate with the mail server to send and receive e-mail messages in a format that is readable to both the remote computer and the mail server. The mail server also may have an e-mail application program module operating to communicate with the remote computer's e-mail client.","One option that many e-mail clients offer permits the remote computer user to operate in an offline mode. Offline mode is generally a means by which the user can compose e-mail messages and read previously received e-mail messages, regardless of whether the user's computer is actually connected to a mail server. Communication between the remote computer and the mail server is not attempted by an e-mail client in offline mode.","In this context, \u201conline state\u201d is used to indicate the existence of an operable line of communication between a mail server and a remote computer, regardless of whether the communication line is being utilized by an e-mail client. \u201cOnline mode\u201d is used to indicate that an e-mail client running on a remote computer is operating in a manner that requires an operable line of communication between a mail server and the remote computer. That is, for the e-mail client to successfully operate in online mode, the remote computer on which the e-mail client is running must be in an online state.","Similarly, \u201coffline state\u201d indicates the absence of an operable line of communication between a mail server and a remote computer. \u201cOffline mode\u201d indicates that an e-mail client running on a remote computer is operating in a manner that does not require an online state. An offline mode of operation does not typically require that the remote computer be in an offline state. Unlike online mode, offline mode can be successfully implemented by an e-mail client without regard to the online\/offline state of the remote computer.","The ability to process e-mail messages in offline mode is desirable to e-mail users. When a user wants to prepare e-mail messages for subsequent transmission, the user may do so without having to connect to the mail server. Where the user doesn't have access to an electronic connection to the server or the user's server has crashed, this capability permits the user to perform his or her composition work and then send the composed messages, as a batch, at a later time. This mode of operation permits the user to work more efficiently, by not limiting composition to only those times that the user is connected to a mail server.","Offering users the capability of operating in either online or offline mode has, unfortunately, spawned another problem. Most e-mail clients are not well equipped to accommodate a transition between online and offline modes of operation. Consequently, a computer's transition between online and offline states can disrupt effective e-mail message processing.","The typical use of a portable computer presents a representative illustration of a transition between online and offline states. A user might have a portable computer that is equipped to operate in conjunction with a docking station. Docking stations are well known to those skilled in the computer arts and typically provide a base station for a portable computer. A docking station often includes such devices as a power supply, expansion slots, a monitor, a keyboard connector, connectors for CD-ROM, floppy or hard drives, and a LAN connection. The LAN connection can provide a communication line between the portable computer and a mail server.","The portable computer might be docked in a docking station one minute and undocked the next minute. When a portable computer that is processing e-mail messages in online mode is undocked from its docking station, the connection between the computer and the mail server will be severed. Most e-mail clients do not provide a means for responding to this transition between online and offline states. The user will be unable to continue processing e-mail because the e-mail client will be attempting to operate as if the laptop were still connected to the mail server. In such a case, the user will usually experience an unending series of warning messages indicating the loss of a connection to the mail server. The user is forced to terminate the e-mail client and either to restart after reconnecting to the mail server or to restart in offline mode.","This problem is not limited to the example of a portable computer with a docking station, but can occur with any computer that loses an operating communications line with a mail server. No effective solution to this problem has been proffered in the prior art. Indeed, most e-mail clients either assume that the remote computer user is always in online mode, or allow the remote computer user to select online or offline modes of operation, but are unable to accommodate a transition between online and offline states of operation.","Therefore, there is a need in the art for an improved method of effecting a transition between online and offline modes of email processing operation where there is a transition between online and offline states. This method should provide the remote computer user an interface for configuring the responsive actions to be taken in the event of a state change. In addition to an improved configuration interface, the system should provide the capability to automatically respond to the detection that the remote computer has made a transition between online and offline states and to continue to process e-mail in accordance with a user's configuration settings.","The present invention satisfies the above-described needs by providing an improved method for continuously processing electronic messages during and after a transition between online and offline states. The present invention responds to such a transition by automatically switching between online and offline modes of operation. The present invention can be configured to connect to a mail server via a LAN connection when operating in an online mode and via a modem when operating in an offline mode. A user may also configure various aspects of the invention to respond to a transition in a way that accommodates the user's hardware and\/or software requirements.","In one aspect, the present invention provides a method for effecting a switch between online and offline modes of electronic message processing. The method includes processing messages in an online mode, while the computer is in an online state. A determination is made that the computer has switched from online state to offline state. In response to the determination, the method switches operation from online mode to offline mode.","More particularly described, the determination of the transition between online mode and offline mode is a signal that the computer has become undocked or disconnected from a mail server. Various aspects of online mode and offline mode are definable by user input, stored in a configuration file.","In another aspect, the present invention provides a method for effecting a switch between online and offline modes of electronic message processing. The method includes determining the state in which the computer is operating. In response to the computer being in a first state, a first mode of operation is enabled. Where the computer is in a second state, a second mode of operation is enabled. The present invention can automatically switch between operating in an online mode, where communication is effected via a LAN connection, and operating in an offline mode, where subsequent communication is effected via a modem connection. The method is also able to receive an indication of a change in states and automatically switch modes of operation to accommodate the change.","In yet another aspect, the present invention provides a method for processing electronic messages in a system including a server, a portable computer, and a docking station. The method includes receiving a signal indicating that the portable computer has been docked in the docking station. Where the portable computer is docked, the method includes determining whether an operable connection exists between the portable computer and a mail server, via the docking station. If the connection is operable, the method includes processing electronic messages in accordance with an online mode of operation. If the connection is not operable, the method includes processing electronic messages in accordance with an offline mode of operation.","The various aspects of the present invention may be more clearly understood and appreciated from a review of the following detailed description of the disclosed embodiments and by reference to the appended drawings.","The present invention is directed to a method for continuously processing electronic mail (e-mail) messages throughout a computer's transition between online and offline states of operation. In an exemplary embodiment, an e-mail application program determines the state of a connection between a portable computer and an electronic mail server and processes electronic messages in accordance with the appropriate state. The portable computer's transition between an online state and an offline state triggers a user-configurable response, designed to permit the continuation of electronic mail message processing in a manner that accommodates the state change. The e-mail application program responds to such a transition by automatically switching between online and offline modes of operation. In one embodiment, a user may configure various aspects of the invention to respond to a transition in a way that accommodates the user's hardware and\/or software requirements. For example, the user can configure the invention to communicate with a mail server via a LAN connection when operating in an online mode and to communicate with the server via a modem connection when operating in an offline mode.","Referring now to the drawings, in which like numerals represent like elements throughout the several figures, aspects of the present invention and an exemplary operating environment will be described.","FIG.  and the following discussion are intended to provide a brief, general description of a suitable computing environment in which the invention may be implemented. While the invention will be described in the general context of an application program that runs on an operating system in conjunction with a personal computer, those skilled in the art will recognize that the invention also may be implemented in combination with other program modules. Generally, program modules include routines, programs, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Moreover, those skilled in the art will appreciate that the invention may be practiced with other computer system configurations, including hand-held devices, multiprocessor systems, microprocessor-based or programmable consumer electronics, minicomputers, mainframe computers, and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote memory storage devices.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 1","FIG. 1"],"b":["5","10","11","10","12","13","14","15","12","16","17","10","14","53","15","17","10"]},"Within the portable computer , a high speed bus  is connected to a high speed bus controller  and the processor data\/address bus . In one embodiment, the high speed bus  is implemented as a standard Peripheral Component Interconnect (PCI) bus although other standardized bus architectures may be used, such as the Extended Industry Standard Architecture (EISA) bus. The high speed bus controller  examines all signals from the processor  to route the signals to the appropriate bus. Signals between the processor  and the system memory  are merely passed through the high speed bus controller . However, signals from the processor  intended for devices other than system memory  are routed onto the high speed bus , another level in the hierarchical design of the computer system .","Various devices are connected to the high speed bus . A hard disk drive  is connected to the high speed bus  via a hard disk drive interface . A CD-ROM drive , which is used to read a CD-ROM disk , is connected to the high speed bus  via a CD-ROM interface . The video display  or other kind of display device is connected to the high speed bus  via a video adapter .","A first low speed bus  is connected to the high speed bus  by a first low speed bus controller . The first low speed bus  is generally of lesser or equal speed when compared to that of the high speed bus . In the one embodiment, the first low speed bus  is implemented as an Industry Standard Architecture (ISA) bus although other standardized bus architectures may be used.","A number of program modules may be stored in the drives and RAM , including an operating system , one or more application programs , other program modules including an e-mail client , and program data . A user enters commands and information into the portable computer  by using a keyboard  and\/or pointing device, such as a mouse , which are connected to the first low speed bus  via a serial port interface . Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, and other devices suitable for positioning a cursor on the video display .","As shown in , the portable computer  also includes a modem . Typically, the modem  is connected to a telephone line . The modem  is preferably internal to the portable computer  and is connected directly to the first low speed bus . Although illustrated in  as internal to the portable computer , those of ordinary skill in the art will quickly recognize that the modem  may also be external to the portable computer . The modem  is typically used to communicate by telephone over wide area networks , such as the global Internet. Such a network can provide a connection between the portable computer  and a mail server . The mail server  typically includes many or all of the elements described relative to the portable computer , by means of a memory storage device within the mail server (not shown). More particularly, the mail server  can include application program modules (not shown) and e-mail clients (not shown) that enable the mail server  to communicate electronic messages with one or more portable computers  via logical connections, such as the modem connection described.","As shown in , a first bridge  is connected to the high speed bus . The first bridge  connects to a second bridge , which is part of the docking station , when the user \u201cdocks\u201d the portable computer  into the docking station . In this manner, devices in the docking station  become part of the portable computer  and capable of being controlled by the processor . Docking stations  are well known to those skilled in the computer arts and typically provide a base station for a portable computer . A docking station  often includes such devices as a power supply, expansion slots, a monitor, a keyboard connector, connectors for CD-ROM, floppy or hard drives, and a LAN or dial-up connection.","Within the docking station , a second low speed bus  is connected to the high speed bus  by a second low speed bus controller . Similar to the first low speed bus , the second low speed bus  is generally of less or equal speed when compared to that of the high speed bus . In one embodiment the second low speed bus  is preferably implemented as an ISA bus although other standardized bus architectures may be used. A network interface  is connected to the second low speed bus  in the docking station . The network interface  is used for connecting to other computers via a local area network , such as the mail server . Those skilled in the art will appreciate that other buses (not shown) may be present in the docking station  and that the network interface  may be capable of communicating with the processor  over a higher speed bus (such as a PCI bus) rather than the second low speed bus . However, the illustrated buses (the high speed bus  and the second low speed bus ) are used exemplary embodiments to support the present invention.","Those skilled in the art will understand that software modules and data are provided to the portable computer  via one of the memory storage devices or computer-readable media, which may include the hard disk drive , floppy disk (not shown), CD-ROM , RAM , ROM , and digital tapes (not shown). In an exemplary embodiment, these software modules include an operating system , application programs , and an e-mail client . It will be appreciate that the e-mail client  may be implemented as a stand-alone software module or as a component of a DTIM, such as the \u201cMICROSOFT OUTLOOK '98\u201d program. In an exemplary embodiment, the hard disk drive  may be used to store these software modules once they are installed from a CD-ROM . Software modules may also include files or data structures created during run-time operations of the computer system , such as the program data .","Although the above description is directed to a portable computer with a docking station , those skilled in the art will appreciate that the present invention is not limited to this implementation. Indeed, the present invention may be implemented to operate in cooperation with any computer that is capable of being connected to and disconnected from a server via a communications link. A computer can be placed in an offline state by various means including: undocking the computer (an \u201cundock event\u201d), physically disconnecting a LAN or dial-up connection, failure of the server, and a user's command to cease communication. Similarly, a computer can be placed in an online state by various means including: docking the computer (a \u201cdock event\u201d), a once-failed server becoming available to the computer, and a user's command to initiate communication. Because the present invention relates to a computer that is \u201cremote\u201d from a server, the terms \u201ccomputer,\u201d \u201cremote computer,\u201d \u201cpersonal computer,\u201d and \u201cportable computer\u201d are used interchangeably.","The operating system  provides the basic interface between the computer's resources, the user, and the program modules, such as the \u201cMICROSOFT OUTLOOK '98\u201d program. The operating system  provides a variety of functions or services that allow an application program  to easily deal with various types of input\/output (I\/O) by issuing relatively simple function calls. Generally described, an application program  communicates with the operating system  by calling predefined functions provided by the operating system . The operating system  responds by providing the requested information in a message or by executing the required task.","In the context of the present invention, the primary interaction between the e-mail client  and the operating system  involves e-mail messaging related tasks.  depicts a block diagram of an exemplary structure of an e-mail messaging system that enables the e-mail client  () to interact with the operating system . An exemplary operating system  incorporates an application programming interface (API)  that permits electronic messaging applications, such as the \u201cMICROSOFT OUTLOOK '98\u201d program, to interact with message service providers . Examples of APIs are the Messaging Application Programming Interface (MAPI) and the Outlook Messaging Interface (OMI), both of which are well known to those skilled in the computer arts.","The API  permits an e-mail client  () to request and execute lower-level services that are performed by the portable computer's  () operating system . Interfacing the e-mail client  () and the operating system  (FIG. ), by way of the API , permits electronic messages to be communicated between the e-mail client  () and the communications resources that are controlled by the operating system . The operating system  may, in turn, transmit e-mail messages by way of the computer's modem  () or network interface  () to a mail server  () via a wide area network  () or a LAN  (FIG. ).","Generally, the e-mail client  will require the use of the operating system to perform three functions: sending outgoing e-mail messages; receiving incoming e-mail messages; and resolving names. Therefore, an exemplary operating system will incorporate a level of messaging service providers  between the API  and the operating system  itself. Messaging service providers are drivers that ultimately connect the e-mail client  to the operating system . Most messaging systems include three types of service providers: message store providers , address book providers , and message transport providers .","The messaging service providers  cooperate with the API  to create and send e-mail messages in the following way. An e-mail message may be composed and addressed to one or more recipients. When the e-mail client  sends the e-mail message, the message store provider  checks that each recipient has a unique and valid address and that the message has all of the information necessary for transmission to the named recipients. The transport provider  executes message transmission and reception between the API  and the operating system . The e-mail message is then placed in a message buffer (not shown) for subsequent transmission.","If there is a question about a recipient, such as can occur when there are multiple recipients with the same name, the address book provider  resolves the ambiguity. Resolving names is usually effected by comparing the names against a list (i.e., address book) that coordinates names to e-mail addresses. This may be done in one of two ways: against address books on the portable computer  () or against address books on the mail server  (FIG. ). The mail server  () generally has a greater capacity for such address books and is, therefore, generally the preferred source of comparison. However, when the mail server is not accessible to the portable computer  (FIG. ), resolving the names of recipients will usually be performed only against the lists on the portable computer  (FIG. ).","Consequently, the API\/service providers arrangement provides a structure by which an e-mail client , such as that included in the \u201cMICROSOFT OUTLOOK '98\u201d program, can request and execute lower-level services, such as sending messages, receiving messages, and resolving names. The operating system  ultimately performs these services at the command of the service providers . The operating system utilizes the serial port interface  () or the network interface  () to send, receive and resolve names where those services require accessing a mail server  (FIG. ). Therefore, the status (i.e., availability or unavailability) of an operating communications line at either the serial port interface  () or the network interface  () is critical to the ability of the e-mail client  to perform various e-mail messaging functions.","The exemplary operating system  has the ability to generate a message to alert all application programs  (FIG. ), including any e-mail client , that the status of the portable computer's  () LAN or dial-up communication line has changed. The operating system determines the status of the serial port interface  () and of the network interface  (FIG. ), via the system bus  (FIG. ). Specifically, the operating system is able to indicate that an operating connection to a mail server  (FIG. ), for example, has been rendered inoperative or that an initially inoperative connection to a mail server  () has been rendered operative.","The exemplary operating system notifies applications of a dock or undock event via a Configuration Change Message (CCM). In an exemplary embodiment, the operating system sends a Device Change CCM via the system bus  (FIG. ), to all currently operating applications. The Device Change CCM includes an Event Parameter, which can be set to indicate whether a device is being added or removed.","In the case of a dock event, the Event Parameter of the Device Change CCM is set to indicate the addition of a device. The Device Change CCM can also indicate that the device is a network device, meaning that the device can provide the capabilities to communicate via a network connection, such as a LAN connection. Thus, the exemplary operating system ultimately notifies the e-mail client  () and other applications that a network connection is operative.","In the case of an undock event, the Event Parameter of the Device Change CCM is set to indicate the removal of a device. As with the dock event, the Device Change CCM indicates that the device is a network device, meaning that the device can provide the capabilities to communicate via a network connection. Thus, the exemplary operating system notifies the e-mail client  () and other applications that a network connection is no longer operative.","In this context, \u201conline state\u201d is used to indicate the existence of an operable line of communication between a mail server,  () and a portable computer  (FIG. ), regardless of whether an e-mail client  is actually using the line to communicate with the server. \u201cOnline mode\u201d is used to indicate that an e-mail client  running on the portable computer  () is operating in a manner that requires an operable line of communication between the mail server  () and the portable computer  (FIG. ). That is, for an e-mail client  to successfully operate in online mode, the portable computer  () on which the e-mail client  is running must be in an online state.","Similarly, \u201coffline state\u201d indicates the absence of an operable line of communication between the mail server  () and the portable computer  (FIG. ). \u201cOffline mode\u201d indicates that an e-mail client  running on the portable computer  () is operating in a manner that does not require an online state. An offline mode of operation does not require that the portable computer  () is in an offline state. Unlike online mode, offline mode can be successfully implemented by an e-mail client  without regard to the online\/offline state of the portable computer  (FIG. ).","As discussed above, online mode generally requires an operable connection between the portable computer  () the mail server  () (i.e., an online state). Because this operable connection exists, the e-mail client  may perform a variety of e-mail messaging functions. Outgoing messages may be sent to a recipient immediately upon submission, without being queued. The mail server  may be polled periodically for new, incoming e-mail messages. Names of recipients may be resolved against address books on the mail server, as necessary. Where the user has chosen to queue outgoing messages, the e-mail client  may prompt the user to send the messages before exiting from the e-mail client . Additionally, the e-mail client  may gather information from incoming messages that the user chooses to retain on the mail server  (FIG. ). This list of e-mail messaging functions is not exhaustive, but merely illustrative of functions that are generally associated with an e-mail client  operating in online mode. When operating in online mode, the user will normally be communicating with the mail server  via a LAN connection.","Offline mode does not require an operable connection between the portable computer  () and the mail server. Accordingly, the e-mail messaging functions available to the user of an e-mail client  operating in offline mode are somewhat limited. Messages are not sent immediately, but are queued until the next time that the e-mail client  is operating in online mode, and the portable computer  () is in an online state. The mail server  () is not polled for new, incoming messages; otherwise, each polling attempt would generate a warning message that the server could not be found. Names are not resolved against address books on the mail server  (FIG. ), but only those address books on the portable computer  (FIG. ). This list of functions is not exhaustive, but merely illustrative of functions that are generally associated with an e-mail client  operating in offline mode. When operating in offline mode, the user will normally be communicating with the mail server  via a modem connection (when communication is required).","When the portable computer  () is connected to a mail server  () via a dial-up connection, the user can configure the e-mail client  to operate so as to avoid e-mail messaging functions that hinder efficiency because of the low-speed modem connection. For instance, the user may operate the e-mail client  in offline mode until the user issues a command that requires an operable connection between the portable computer  () and the mail server  (FIG. ), such as a send command. The user also may configure the e-mail client  to return to offline mode as soon as the function requiring the mail server  () connection is completed. Additionally, the user can prohibit the reception of an e-mail message that is larger than a particular size and would require a longer connection time to download from the mail server  (FIG. ). Where the dial-up connection is active, the user may operate in online mode. However, by implementing the configuration capabilities of the present invention, the user can optimize e-mail messaging operations by selecting which operations to perform and which to suppress.","While the above description has been directed to the processing of e-mail messages, it is to be appreciated that the invention can be used for any form of electronic messages. Indeed, the \u201cMICROSOFT OUTLOOK '98\u201d program module, which is an exemplary embodiment of the present invention, is capable of processing electronic messages that contain data other than data composed as a mail message. Examples of these electronic messages include scheduling updates, reminders, and alerts that are transmitted as electronic data.","An exemplary embodiment of the present invention is represented by a desktop information management (DTIM) program module called \u201cMICROSOFT OUTLOOK '98\u201d developed by Microsoft Corporation of Redmond, Wash. designed to work with Microsoft Corporation's \u201cWINDOWS 95\u201d and \u201cWINDOWS NT 4.0\u201d operating systems. Briefly described, the \u201cMICROSOFT OUTLOOK '98\u201d program module is a DTIM program module that allows users to manage their own calendar, tasks or \u201cto-do\u201d lists, notes, contacts, and electronic mail messages via different program modules internal to the DTIM program module.","Each program module maintains information or data about things such as appointments, task lists, mail messages, etc., in specific data items in memory. This data can be transmitted as electronic messages to other program modules or other computer users. The DTIM program module has control modules that are used to process these electronic messages between the internal program modules and other users via an electronic messaging system, such as a mail server. The aspect of processing electronic messages, including electronic mail messages, is the focus of the present invention.","The \u201cMICROSOFT OUTLOOK '98\u201d program permits the user to configure various attributes of the present invention to accommodate the user's hardware configuration and\/or operation preferences. For example, the user can select whether to send e-mail messages immediately or to queue e-mail messages for later transmission. Similarly, the user may select whether the user will primarily connect to a mail server by LAN or dial-up connection. Because the user's configuration preferences are established in advance, the transition between online mode and offline mode can be made to conform to the user's selections.  depict exemplary user interface windows that permit the user to select a configuration that conforms e-mail operations to the user's preferences. After a discussion of the user interface windows, an exemplary embodiment will be discussed, in connection with and in which the effects of the user's configuration choices are made apparent in the context of subsequent e-mail operations.","In order for the e-mail client  () to operate in online mode, the user must establish an online state (i.e., an operable connection between the portable computer  () and a mail server  (FIG. )). The \u201cMICROSOFT OUTLOOK '98\u201d program establishes an online state in accordance with a user configuration file that is generated by use of a user configuration window.",{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 3","b":["300","300","300","301","300"]},"Referring still to , the CCW  includes a connection dialog box  that permits the user to select a primary connection to the server and, where appropriate, to select a secondary connection to the server. The CCW  also includes a modem dialog box  that permits the user to configure an e-mail client  () to accommodate the hardware specifications of various modem types, where a modem is used as a primary or secondary connection to a mail server. After the user has input the configuration selections in the CCW , the user may save those selections in a configuration file that can be accessed by an e-mail client  () to conform its operations thereto. The user can save the configuration selections by selecting the \u201cOK\u201d button . Alternatively, the user can cancel selections made in the CCW  by selecting the \u201cCancel\u201d button .","The connection dialog box , in the CCW , includes several buttons (, , ), which permit the user to select one of three connection types that will serve as the user's primary connection to a mail server. Selection of the LAN button  indicates that the user intends to access a mail server primarily by LAN connection (e.g., the network interface  (FIG. )). Selection of the dial-up button  indicates that the user intends to access a mail server primarily by dial-up connection to a wide area network  (FIG. ). Finally, selection of the manual button  indicates that the user intends to establish a connection to the mail server  () by some other means (e.g., a modem connection established by a separate application program) and wishes for the e-mail client  () to merely utilize the existing connection. Functionally, this connection is equivalent to a LAN connection.","If the user selects the LAN button , the \u201cMICROSOFT OUTLOOK '98\u201d program will define the LAN connection as the primary e-mail connection and will look to the computer's network interface  () for a LAN communication link to a mail server, when a command requiring mail server  () access is issued. As described in connection with FIG.  and , such commands include commands to send e-mail messages, receive e-mail messages, and resolve names against address books on a mail server  (FIG. ). When the LAN connection is available, the e-mail client  () will utilize the connection to send and receive e-mail messages, and resolve names. However, when the LAN connection is not available, the CCW  allows the user to select a dial-up connection (modem connection) as a secondary connection. The user defines the secondary connection by selecting the LAN connection button  as well as the secondary dial-up network checkbox . The procedure that the e-mail client  () will follow in response to these commands will be described in more detail below, in connection with and ","If the user selects the connect manually button , the \u201cMICROSOFT OUTLOOK '98\u201d program will not perform any connection steps, but will rely on a preexisting connection. Instead of controlling a modem, the \u201cMICROSOFT OUTLOOK '98\u201d program will perform handshaking functions as if it were communicating via a LAN connection. If a LAN connection is not available and if a modem connection has not been established before starting the program, the handshaking will fail.","If the user selects the dial-up button  (labeled \u201cConnect using my phone line), the e-mail client  () will define the dial-up connection as the primary e-mail connection and will look to the computer's serial port interface  () for a dial-up connection to a mail server  (FIG. ), when a command requiring access to the mail server  () is issued. As described in connection with FIG.  and , such commands include commands to send e-mail messages, receive e-mail messages, and resolve names against address books on a mail server  (FIG. ). The procedure that the e-mail client  () will follow in response to these commands will be described in more detail below, in connection with and ","The CCW  also includes a modem dialog box . This box is disabled unless the user selects a dial-up connection (modem connection) as either a primary or secondary connection. The modem dialog box  simply allows the user to configure the \u201cMICROSOFT OUTLOOK '98\u201d program to accommodate the requirements of the modem  () that will be utilized to establish the dial-up connection. The user can add modem configuration files to the list by selecting the add button  and configure modem configuration files on the list by selecting the properties button . By pressing the expose list button , the user can review the entire list of modem configurations available for establishing a dial-up connection.",{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 4","b":["400","400","400","401","400"]},"Referring still to , the MDW  includes a list of four options that permit the user to select various attributes affecting the operation of the program while performing e-mail operations via a dial-up connection. After the user has input the configuration selections in the MDW , the user may save those selections in a configuration file that can be accessed by an e-mail client  () to conform its operations thereto. The user can save the configuration selections by selecting the \u201cOK\u201d button . Alternatively, the user can cancel selections made in the MDW  by selecting the \u201cCancel\u201d button . The four options are elected by selecting check-boxes (, , , and ) corresponding to the option desired.","The first check-box, the warn before switching box , will cause the \u201cMICROSOFT OUTLOOK '98\u201d program to generate a warning when selected. The warning will be generated before the program switches between dial-up connections. For example, referring back to , the user can define the parameters of a dial-up connection by selecting the properties button  () in the CCW . One parameter is the circumstances in which a particular dial-up connection is used. A user may use a first dial-up connection for a primary e-mail account and a second dial-up connection for secondary e-mail account. If the user decides to check the secondary e-mail account, but the user is connected to a mail server via the first dial-up connection, the program will attempt to disconnect the first connection and establish the second connection. Selecting the warn before switching box  will generate a warning and prompt the user to for permission before proceeding to switch between dial-up connections.","The second check-box, the hang-up when finished box , will disconnect the dial-up connection when certain e-mail operations have been completed via the dial-up connection. As will be discussed below in connection with and , the user will generally want to minimize the time spent connected to a mail server  () via a dial-up connection. Accordingly, the \u201cMICROSOFT OUTLOOK '98\u201d program can be configured to disconnect immediately after completing e-mail operations that require a dial-up connection. Thus, the user does not have to monitor the progress of these operations in order to manually disconnect when the operations are completed. If the user does not select this check-box, the program will maintain the dial-up connection until the user affirmatively terminates the dial-up connection.","The third check-box, the auto-dial enable box , will establish a dial-up connection when the dial-up connection is selected as the primary or secondary mail server connection in the CCW  () and a \u201ccheck messages\u201d command is issued. The check messages command is issued by the \u201cMICROSOFT OUTLOOK '98\u201d program periodically, when the user has configured the program to check for new incoming messages on a periodic basis (e.g., every thirty minutes). When the user is connected to the mail server  () via a LAN connection, this does not present a problem, because mail checking is done in the background (i.e., the user does not see the operation occur) over the existing connection. However, where the mail server is to be connected via a dial-up connection, the user may want to suspend the automatic mail checking operation so that the program doesn't automatically dial out on the user's telephone line. Leaving the check-box unselected will suspend mail checking when the dial-up connection is not operative.","The final check-box, the limit message size box , merely assists in minimizing the time that the user is connected to the mail server  () via a dial-up connection. When the user receives a message that is larger than a selectable size, the \u201cMICROSOFT OUTLOOK '98\u201d program will not download the message. This is especially advantageous for dial-up connection users, because a large message can prolong the time the user must be connected to the mail server  () via the dial-up connection. Where the dial-up connection is made over a telephone line that is otherwise busy or that is expensive to maintain, large messages can consume valuable time.",{"@attributes":{"id":"p-0076","num":"0075"},"figref":["FIGS. 5","FIG. 1"],"i":["a ","b "],"b":["5","49","49","1","49","1"]},"LAN-Only Operation","When the user has selected the LAN connection button  in the CCW  (FIG. ), but has not selected the secondary dial-up network checkbox , the \u201cMICROSOFT OUTLOOK '98\u201d program will operate in LAN-only mode. This mode will never seek to establish a connection to the mail server  (FIG. ), via a dial-up connection. Therefore, if the LAN connection is unavailable or the mail server  () cannot be connected to via the LAN connection for some other reason, the program will simply be unable to enter the online mode of operation.","Accordingly, the \u201cMICROSOFT OUTLOOK '98\u201d program will check the LAN connection upon starting-up (i.e., boot). If the LAN connection to the mail server  () is operational, then the program will send and receive mail via the LAN connection and then enter online mode. Periodically, the program will poll the mail server  () in the background for any new incoming messages. If any new messages are available, or if the user demands to send or receive a message, the LAN connection is checked and the message transfer is completed, if the connection is operational. If the connection is not operational, then an error message is recorded in an error log file and the program simply remains in online mode.","The program will enter offline mode if the user undocks the portable computer  () or if the user toggles a \u201cWork Offline\u201d command from FALSE to TRUE, which indicates the user's desire to disconnect from the mail server  (FIG. ). Once in offline mode, the program will suppress background polling of the mail server  () and will return to online mode only if the user makes an affirmative attempt to immediately send or receive messages, the user toggles the Work Offline command to FALSE, or a dock event occurs. The details of the LAN-only mode of operation will become more apparent in the context of the following discussion of and ","Dial-Up-Only Operation","When the user has selected the dial-up button  in the CCW  (FIG. ), the \u201cMICROSOFT OUTLOOK '98\u201d program will operate in dial-up-only mode. This mode will never seek to establish a connection to the mail server  (FIG. ), via a LAN connection. Therefore, if the dial-up connection is unavailable or the mail server  () cannot be connected to via the dial-up connection for some other reason, the program will simply be unable to enter the online mode of operation.","Accordingly, the \u201cMICROSOFT OUTLOOK '98\u201d program will check the dial-up connection upon starting-up (i.e., boot). If the dial-up connection to the mail server  () is operational, then the program will send and receive mail via the LAN connection and then enter online mode. Periodically, the program will poll the mail server  () in the background for any new incoming messages. If any new messages are available, or if the user demands to send or receive a message, the dial-up connection is checked and the message transfer is completed if the connection is operational. If the connection is not operational, then an error message is recorded in an error log file and the program simply switches to offline mode. Alternatively, if the dial-up connection is not operational, the program can make an attempt at establishing the dial-up connection. If the attempt is successful, the program will enter online mode.","The program will enter offline mode if the user undocks the portable computer  () or if the user toggles the Work Offline command to TRUE, which indicates the user's desire to disconnect from the mail server  (FIG. ). Once in offline mode, the program will suppress background polling of the mail server  () unless the user has selected the auto-dial enable box  (FIG. ). The program will return to online mode only if the user makes an affirmative attempt to immediately send or receive messages, the user toggles the Work Offline command to FALSE, or a dock event occurs. The details of the dial-up-only mode of operation will become more apparent in the context of the following discussion of and ","LAN with Dial-Up Backup Operation","Referring now to and , the behavior of the \u201cMICROSOFT OUTLOOK '98\u201d program will be described where the user has selected a LAN connection as the primary connection for e-mail operations and has selected a dial-up connection as a secondary connection. and depict a single, bifurcated flowchart which depicts an exemplary method of the present invention. The LAN with dial-up backup configuration is enabled by selecting the LAN connection button  and the secondary dial-up network checkbox  in the CCW . This configuration provides the program the ability to maintain stable e-mail operations even if the user loses the primary LAN connection.","The method starts at step , which represents the startup of the \u201cMICROSOFT OUTLOOK '98\u201d program. The method then branches to decision block , at which a determination is made as to whether the LAN connection to the server is operational. If the LAN connection is operational, the method branches to block  in which the mail is transferred between the portable computer  () and the mail server  (FIG. ). In this step, any outgoing mail is sent to the mail server  () and any incoming mail that has been stored on the mail server  () is sent to the portable computer  (FIG. ). The method then branches to step  in which the program enters online mode. While in online mode, the method is responsive to a periodic background poll and to actions taken by the user.","Step  represents the method's responsiveness to any of the actions represented by blocks , , , and . Step  is an undock event, meaning that the portable computer  () is undocked from its docking station  (FIG. ). In response to the undock event, the method branches to offline mode at step  (via connectors  and ). If the user toggles the Work Offline command to TRUE, the method branches to step , and on to offline mode at step  (via connectors  and ). Where the user has configured the program to periodically check for messages, the method branches to step  and performs a background poll of the mail server  () by branching to decision block , which checks the LAN connection's operability. If the LAN connection is operable, then the method branches to step  and transfers mail as described above. If, on the other hand, the LAN connection is not operable, the method branches to step  and records an error message in a log file. The method branches from both steps  and  back to online mode at step . Step  represents the user action of issuing a command to immediately send or receive messages.","When the user issues a command to immediately send or receive messages at step , the method branches to decision block  (via connectors  and ) which checks the LAN connection's operability. If the LAN connection is operative, the method branches to step  and e-mail messages are transferred as described above. The method then branches back to online mode at step  (via connectors  and ).","If the LAN connection is not operative, the method branches to decision block  where a determination is made as to whether the dial-up connection has been selected as a secondary connection. Incidentally, step  is also reached (via connectors  and ) if the decision block at step  determines that the LAN connection is initially (i.e., at start up) inoperative. If the dial-up connection has not been selected as a secondary connection, the method branches to offline mode at step  (via connectors  and ). If, on the other hand, the secondary dial-up connection has been enabled, the method branches to step  and calls the mail server  (FIG. ), via the dial-up connection. Once the dial-up connection has been established, the method branches to step  and any available e-mail messages are transferred. The method then branches to decision block , which determines whether the user has configured the program to terminate the dial-up connection after the available mail has been transferred. If not, the program branches to online mode at step  (via connectors  and ). If the user has configured the program to terminate the dial-up connection, then the method branches to step  and hangs-up the dial-up connection. The method then branches to offline mode at step .","As discussed above, offline mode at step  can also be reached from when the user affirmatively elects to operate in offline mode (step ), when an undock event occurs (step ), or when the LAN connection is inoperative and a dial-up connection has not been designated as a secondary connection (step ). As with online mode, in offline mode the method is responsive to any one of four events. This responsiveness is represented by step , which provides branches to steps , , , and .","If the user toggles the Work Offline command to FALSE (step ) or a dock event occurs (step ) the method branches to online mode at step  (via connectors  and  or  and , respectively). If the user issues a command to immediately send or receive messages (step ), then the method branches to decision block  and determines whether a dial-up connection is active. If the dial-up connection is inactive, the method branches to establish a dial-up connection to the mail server  () at step  (via connectors  and ). If, on the other hand, a dial-up connection is active, the method branches to step  to transfer the available mail and then branches to step  to remain in online mode (via connectors  and ).","The final action to which the method is responsive while in offline mode is the background poll (step ). Where the program is set up to keep checking for new messages using a background poll, the method will branch to step . The method will then branch to decision block  to determine whether the user has configured the program to automatically establish a dial-up connection in order to check for new messages. When the program is not so configured, the method will do nothing , merely branching back to offline mode at step  (via connectors  and ).","The flowchart depicted in and illustrates the behavior of the \u201cMICROSOFT OUTLOOK '98\u201d program, where the program is configured to utilize a dial-up connection in the event of a failure to connect via a LAN connection. However, many of the behaviors apply to the dial-up-only and LAN-only modes of operation discussed above. Notably, all three modes incorporate the online mode and offline modes of operation.","From the foregoing description, it will be appreciated that the present invention provides an improved method for continuously processing electronic mail (e-mail) messages during and after a transition between online and offline states. In an exemplary embodiment, the e-mail messaging features of the \u201cMICROSOFT OUTLOOK '98\u201d program provide a user-configurable means for responding to both unexpected and voluntary losses of mail server access. Additionally, the \u201cMICROSOFT OUTLOOK '98\u201d program can respond to newly established connections to a mail server.","During the initial configuration, the user can choose the primary mode of communication between the portable computer and the mail server. Examples of connections are LAN and dial-up connections. The user also can establish a secondary connection which will be utilized in cases where the primary connection is unavailable. The user can also configure the \u201cMICROSOFT OUTLOOK '98\u201d program to perform or suppress certain e-mail messaging functions in order to optimize the performance of the \u201cMICROSOFT OUTLOOK '98\u201d program to accommodate the characteristics of the primary and\/or secondary connections selected.","The present invention smoothes the transition from online to offline state by making the transition more transparent to the user and allowing the user to continue e-mail message processing, despite the transition. Where the user issues a command that is inconsistent with the present mode of e-mail messaging operation, the invention can switch modes of operation to accommodate the command. Additionally, the user may configure the invention to prompt the user before proceeding to switch modes of operation.","The present invention has been described in various exemplary embodiments, and particularly as an integrated e-mail messaging feature of the \u201cMICROSOFT OUTLOOK '98\u201d program. However, those skilled in the computer arts will appreciate that the invention is not limited to the described embodiments, but can be implemented in various embodiments including stand-alone e-mail clients. Alternative embodiments will become apparent to those skilled in the art to which the present invention pertains without departing from its spirit and scope. Accordingly, the scope of the present invention is defined by the appended claims rather than the foregoing description."],"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","AN EXEMPLARY OPERATION ENVIRONMENT","BASIC ELECTRONIC MAIL OPERATION","AN EMBODIMENT FOR AUTOMATICALLY RESPONDING TO STATE TRANSITIONS","A CONFIGURABLE EMBODIMENT","REVIEW OF THE DETAILED DESCRIPTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIGS. 5","i":["a ","b "],"b":"5"}]},"DETDESC":[{},{}]}
