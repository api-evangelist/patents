---
title: Recording medium, playback device, system LSI, playback method, glasses, and display device for 3D images
abstract: A recording medium in which a left-view video stream and a right-view video stream are recorded in an interleaved transport stream file. The interleaved transport stream file is identified by a combination of (i) an equivalent identification number being equivalent with the file reference information and (ii) a file extension indicating that video streams are stored in the interleaved manner, the equivalent identification number. Among Extents that constitute the interleaved transport stream file, Extents constituting the left-view or right-view video stream are identified as a normal-format transport stream file by a combination of (i) the equivalent identification number being equivalent with the file reference information and (ii) a file extension indicating that video streams are stored in a normal manner.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08089507&OS=08089507&RS=08089507
owner: Panasonic Corporation
number: 08089507
owner_city: Osaka
owner_country: JP
publication_date: 20090925
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims benefit of U.S. provisional application 61\/101,316, filed Sep. 30, 2008.","(1) Field of the Invention","The present invention relates to a technology of recording 3D and 2D images.","(2) Description of the Related Art","The 2D images, also called planar images, are represented by pixels on an X-Y plane that is applied to the display screen of the display device.","In contrast, the 3D images have a depth in the Z-axis direction in addition to the pixels on the X-Y plane applied to the screen of the display device. The 3D images are presented to the viewers (users) by simultaneously playing back the left-view and right-view images to be viewed respectively by the left and right eyes so that a stereoscopic effect can be produced. The users would see, among the pixels constituting the 3D image, pixels having positive Z-axis coordinates in front of the display screen, and pixels having negative Z-axis coordinates behind the display screen.","It is preferable that an optical disc storing a 3D image has compatibility with a playback device that can play back only 2D images (hereinafter, such a playback device is referred to as \u201c2D playback device\u201d). This is because, otherwise, two types of discs for 3D and 2D images need to be produced so that the 2D playback device can play back the same content as that stored in a disc for 3D image. Such an arrangement will take a higher cost. It is accordingly necessary to provide an optical disc storing a 3D image that is played back as a 2D image by the 2D play back device, and as a 2D or 3D image by a play back device supporting both the 3D and 2D images (hereinafter, such a playback device is referred to as \u201c2D\/3D playback device\u201d).","Patent Document 1 identified below is one example of prior art documents describing technologies for ensuring the compatibility in playback between 2D and 3D images, with respect to optical discs storing 3D images.","[Prior Art Documents]","[Patent Literature 1]","Japanese Patent No. 3935507","In the stereoscopic playback, it is necessary to record the video streams for the left-eye and right-eye views of the user. The left-view and right-view video streams need to be converted into a certain recording format, and it is important to determine the recording format. According to a typical recording format, the left-view and right-view video streams are multiplexed at the level of the TS packet, and the result is recorded as one transport stream. However, with this method, the bit rates that can be assigned to the left-view and right-view video streams are low. This may deteriorate the image quality.","One concept for preventing the bit rates from becoming low is to store the left-view and right-view video streams into different transport stream files, and supply the left-view video stream from the optical disc, and the right-view video stream from the hard disk. In this case, since the TS packets can be supplied from the optical disc and the hard disk, it is possible to ensure a certain level of bit rate for each of the left-view and right-view video streams. This concept may be applied to a use format in which the left-view video stream is supplied from the optical disc, the right-view video stream is supplied from the network, and these video streams are combined to be played back by the user. However, with this concept, the left-view and right-view video streams cannot be stored into one optical disc. Accordingly, the concept is not suitable for a business format in which an optical disc storing the left-view and right-view video streams is sold as one product or rented over the counter. The movie industry will hesitate to take in the concept.","As one example of the method for recording the left-view and right-view video streams while ensuring the bit rates, proposed is a method in which the left-view and right-view video streams are converted into one transport stream in the interleave format, and the transport stream is recorded into an optical disc, as is realized in what is called multi-angle playback.","In the storage format in which the left-view and right-view video streams are converted into the interleave format and then stored into one transport stream file, the values of the Arrival Time Stamps (ATS) are not continuous in the Extents constituting the left-view video stream and in the Extents constituting the right-view video stream. As a result, the ATS value repeatedly change irregularly during the playback, increasing and decreasing, increasing and decreasing. This is difficult from the monotonous increase of the ATS value observed in the case of a normal video stream. Therefore, when such a transport stream file in the interleave format is subjected a playback by a 2D playback device, the normal operation of the 2D playback device cannot be ensured.","It is therefore an object of the present invention to provide a recording medium which can be played back by both the 3D playback device and the 2D playback device.","The above-described object is fulfilled by a recording medium in which playlist information and stream files are recorded, wherein the playlist information includes one or more pieces of playback section information, the one or more pieces of playback section information include file reference information that specifies the stream files storing video streams, the stream files are an interleaved transport stream file and a normal-format transport stream file, in the interleaved transport stream file, a plurality of segments belonging to a left-view video stream and a plurality of segments belonging to a right-view video stream are arranged in an interleaved manner, the interleaved transport stream file being identified by a combination of an equivalent identification number and a file extension indicating that video streams are stored in the interleaved manner, the equivalent identification number being equivalent with the file reference information, and the normal-format transport stream file stores a base-view video stream, and is identified by a combination of the equivalent identification number and a file extension indicating that video streams are stored in a normal manner, the base-view video stream being either the left-view video stream or the right-view video stream that can be played back in a planar-view playback.","In the present invention, the transport stream file in the interleave format is identified by a combination of (i) an identification number that is equivalent with the file reference information and (ii) an extension indicating that it is a transport stream file in the interleave format. With this structure, when the output mode of the playback device is in the stereoscopic playback mode, it is possible to read out Extents constituting a transport stream file in the interleave format by identifying it from the file reference information included in the playlist information and an extension indicating that it is a transport stream file in the interleave format, and to playback the read-out Extents. With this structure, 2D playback devices cannot read out Extents constituting a transport stream file in the interleave format. This prevents the 2D playback devices from suffering from an erroneous operation or an unstable operation due to the change of the ATS value unique to the transport stream file in the interleave format, namely the repetitive, irregular change of the ATS value of increase and decrease.","Also, it is possible to preliminarily describe a predetermined piece of file reference information in the playlist information so as to read out and play back, in the 3D playback, a stream file in the interleave format having (i) a file name that is the same as the predetermined piece of file reference information and (ii) an extension indicating that it is a transport stream file in the interleave format, and in the 2D playback, a transport stream file having (i) a file name that is the same as the predetermined piece of file reference information and (ii) an extension indicating that it is normal-format transport stream file. This eliminates the need for creating respectively the 3D playlist information and the 2D playlist information, thus reducing the trouble of authoring.","It is also possible to access the Extents constituting the base-view video stream among Extents constituting transport stream files in the interleave format, by using (i) the file reference information included in the playlist information and (ii) an extension indicating that it is a normal-format transport stream file. It is thus possible to realize both the stereoscopic playback in the 3D playback device and the planar-view playback in the 2D playback device even if transport stream files for the planar view are not recorded separately from the transport stream files in the interleave format. This makes it possible to provide users with one BD-ROM in which a 3D movie work has been recorded. Since there is no need to record transport stream files for the planar view separately from the transport stream files in the interleave format, there is no need to sell a package containing both a recording medium with a 3D image and a recording medium with a 2D image, or sell them separately as different articles for sale. This does not increase the cost of distribution, nor increase the cost for inventory management in the retail and wholesale stores, and the movie industry can deal with 3D movie works in the same manner as existing 2D movie works.","The following describes an embodiment of a recording medium and a playback device provided with means for solving the above-described problems, with reference to the attached drawings. First, a brief description is give of the principle of the stereoscopic view.","In general, due to the difference in position between the right eye and the left eye, there is a little difference between an image seen by the right eye and an image seen by the left eye. It is this difference that enables the human beings to recognize the image they see in three dimensions. The stereoscopic display is realized by using the parallax of human beings, so that a planar image looks as is it is three-dimensional.","More specifically, there is a difference between the image seen by the right eye and the image seen by the left eye, the difference corresponding to parallax of human beings. The stereoscopic display is realized by displaying the two types of images alternately at regular short time intervals.","The \u201cshort time interval\u201d may be a time period that is short enough to provide human beings, by the alternate displays, an illusion that they are seeing a three-dimensional object. The methods for realizing the stereoscopic viewing include one using a holography technology and one using a parallax image.","The former method, the holography technology, is characterized in that it can reproduce an object three-dimensionally in the same manner as a human being recognizes the object normally, and that, in regards with video generation, although it has established a technological theory, it requires (i) a computer that can perform an enormous amount of calculations to generate the video for holography in real time, and (ii) a display device having a resolution in which several thousands of lines can be drawn in a length of 1 mm. It is extremely difficult for the current technology to realize such a product, and thus products for commercial use have hardly been developed.","On the other hand, the latter method using a parallax image has a merit that a stereoscopic viewing can be realized only by preparing images for viewing with the right eye and the left eye. Some technologies including the sequential segregation method have been developed for practical use from the viewpoint of how to cause each of the right eye and the left eye to view only the images associated therewith.","The sequential segregation method is a method in which images for the left eye and right eye are alternately displayed in a time axis direction such that left and right scenes are overlaid in the brain by the effect of residual images of eyes, and the overlaid image is recognized as a stereoscopic image.",{"@attributes":{"id":"p-0080","num":"0079"},"figref":["FIG. 1A","FIG. 1A"],"b":["100","200","300","400","500"]},"The BD-ROM  provides the home theater system with, for example, a movie work.","The playback device  is connected with the television  and plays back the BD-ROM .","The television  provides the user with an interactive operation environment by displaying a menu and the like as well as the movie work. The user needs to wear the 3D glasses  for the television  of the present embodiment to realize the stereoscopic viewing. Here, the 3D glasses  are not necessary when the television  displays images by the lenticular method. The television  for the lenticular method aligns pictures for the left and right eyes vertically in a screen at the same time. And a lenticular lens is provided on the surface of the display screen such that pixels constituting the picture for the left eye form an image only in the left eye and pixels constituting the picture for the right eye form an image only in the right eye. This enables the left and right eyes to see respectively pictures that have a parallax, thereby realizing a stereoscopic viewing.","The 3D glasses  are equipped with liquid-crystal shutters that enable the user to view a parallax image by the sequential segregation method or the polarization glasses method. Here, the parallax image is an image which is composed of a pair of (i) an image that enters only into the right eye and (ii) an image that enters only into the left eye, such that pictures respectively associated with the right and left eyes respectively enter the eyes of the user, thereby realizing the stereoscopic viewing.  shows the state of the 3D glasses  when the left-view image is displayed. At the instant when the left-view image is displayed on the screen, the liquid-crystal shutter for the left eye is in the light transmission state, and the liquid-crystal shutter for the right eye is in the light block state.  shows the state of the 3D glasses  when the right-view image is displayed. At the instant when the right-view image is displayed on the screen, the liquid-crystal shutter for the right eye is in the light transmission state, and the liquid-crystal shutter for the left eye is in the light block state.","The remote control  is a machine for receiving from the user operations onto the layered GUI. To receive the operations, the remote control  is equipped with a menu key, arrow keys, an enter key, a return key, and numeral keys, where the menu key is used to call a menu constituting the GUI, the arrow keys are used to move a focus among GUI components constituting the menu, the enter key is used to perform ENTER (determination) operation onto a GUI component constituting the menu, the return key is used to return to a higher layer in the layered menu.","This completes the description of the usage act of the recording medium and the playback device.","The present embodiment adopts a method in which parallax images to be used for the stereoscopic viewing are stored in an information recording medium.","The parallax image method is a method for realizing the stereoscopic viewing by preparing separately an image for the right eye and an image for the left eye, and causing the image for the right eye to enter only into the right eye and the image for the left eye enter only into the left eye.  shows the user's head on the left-hand side of the drawing and the images of a dinosaur skeleton seen respectively by the left eye and the right eye of the user on the right-hand side of the drawing. When the light transmission and block are repeated alternately for the right and left eyes, the left and right scenes are overlaid in the brain of the user by the effect of residual images of eyes, and the overlaid image is recognized as a stereoscopic image appearing in front of the user.","Among the parallax images, the image entering the left eye is called a left-eye image (L image), and the image entering the right eye is called a right-eye image (R image). A video composed of only L images is called a left-view video, and a video composed of only R images is called a right-view video. Also, the video streams which are obtained by digitizing and compress-encoding the left-view video and right-view video are called left-view video stream and right-view video stream, respectively.",{"@attributes":{"id":"p-0090","num":"0089"},"figref":"FIG. 3"},"In the second row of , the internal structures of the left-view video stream is shown. This stream includes picture data I, P, Br, Br, P, Br, Br, and P. These picture data are decoded according to the Decode Time Stamps (DTS). The first row shows the left-eye image. The left-eye image is played back by playing back the decoded picture data , P, Br, Br, P, Br, Br, and P according to the PTS, in the order of I, Br, Br, P, Br, Br, and P. In , a picture that has no reference picture and performs the intra-picture prediction encoding using only an encoding target picture is called I-picture. Note that the \u201cpicture\u201d is a unit of encoding that includes both the frame and the field. Also, a picture that performs the inter-picture prediction encoding by referring to one processed picture is called P-picture; a picture that performs the inter-picture prediction encoding by simultaneously referring to two processed pictures is called B-picture; and a B-picture that is referred to by another picture is called Br-picture. Note that the frame is regarded as the video access unit when the frame structure is adopted, and the field is regarded as the video access unit when the field structure is adopted.","In the fourth row of , the internal structures of the right-view video stream is shown. This stream includes picture data P, P, B, B, P, B, B, and P. These picture data are decoded according to the DTS. The third row shows the right-eye image. The right-eye image is played back by playing back the decoded picture data P, P, B, B, P, B, B, and P according to the PTS, in the order of P, B, B, P, B, B, and P.","The fifth row shows how the state of the 3D glasses  is changed. As shown in the fifth row, when the left-eye image is viewed, the shutter for the right eye is closed, and when the right-eye image is viewed, the shutter for the left eye is closed.","These left-view and right-view video streams are compressed by the inter-picture prediction encoding using the correlated property between view points, as well as by the inter-picture prediction encoding using the correlated property in a time axis. The pictures constituting the right-view video stream are compressed by referring to the pictures constituting the left-view video stream having the same display times.","For example, the starting P-picture of the right-view video stream refers to the I-picture of the left-view video stream; the B-picture of the right-view video stream refers to the Br-picture of the left-view video stream; and the second P-picture of the right-view video stream refers to the P-picture of the left-view video stream.","One of the video compression methods using such a correlated property between view points is a corrected standard of MPEG-4 AVC\/H.264 which is called Multi-view Video Coding (MVC). The Joint Video Team (JVT), which is a joint project of the ISO\/IEC MPEG and the ITU-T VCEG, completed the formulation of the corrected standard of MPEG-4 AVC\/H.264 in July 2008. The MVC is a standard for encoding, in bulk, images for a plurality of view points. Due to the use, in the prediction encoding, of the similarity of images between view points as well as the similarity of images in a time axis, the MVC has improved the compression efficiency compared with methods for encoding independent images for a plurality of view points.","A video stream, among the left-view video stream and the right-view video stream having been compress-encoded by the MVC, that can be decoded independently is called \u201cbase-view video stream\u201d. Also, a video stream, among the left-view video stream and the right-view video stream, that has been compress-encoded based on the inter-frame correlated property with each picture data constituting the base-view video stream, and that can be decoded only after the base-view video stream is decoded, is called \u201cdependent-view stream\u201d.","From now on, production of the recording medium, namely, production act of recording medium will be described.",{"@attributes":{"id":"p-0099","num":"0098"},"figref":"FIG. 4"},"The first row of  shows a BD-ROM being a multi-layered optical disc. The second row shows tracks in the horizontally extended format though they are in reality formed spirally in the recording layers. These spiral tracks in the recording layers are treated as one continuous volume area. The volume area is composed of a lead-in area, recording layers of recording layers  through , and a lead-out area, where the lead-in area is located at the inner circumference, the lead-out area is located at the outer circumference, and the recording layers of recording layers  through  are located between the lead-in area and the lead-out area. The recording layers of recording layers  through  constitute one consecutive logical address space.","The volume area is sectioned into units in which the optical disc can be accessed, and serial numbers are assigned to the access units. The serial numbers are called logical addresses. A data reading from the optical disc is performed by specifying a logical address. Here, sectors with consecutive logical addresses are also consecutive in the physical disposition on the optical disc. That is to say, data stored in the sectors with consecutive logical addresses can be read out without performing a seek operation. On the other hand, it is presumed that the logical addresses are not consecutive in the areas, such as boundaries between recording layers, where consecutive data reading is not possible.","In the volume area, file system management information is recorded immediately after the lead-in area. Following this, a partition area managed by the file system management information exists. The file system is a system that expresses data on the disc in units called directories and files. In the case of the BD-ROM , the file system is a UDF (Universal Disc Format). Even in the case of an everyday PC (personal computer), when data is recorded with a file system called FAT or NTFS, the data recorded on the hard disk under directories and files can be used on the computer, thus improving usability. The file system makes it possible to read logical data in the same manner as in an ordinary PC, using a directory and file structure.","Among the files that are accessible on the file system, a file in which an AV stream, which is obtained by multiplexing a video stream and an audio stream, is stored is called \u201cAV file\u201d. On the other hand, a file in which general data other than the AV stream is stored is called \u201cnon-AV file\u201d.","AV files in which AV streams in a transport stream format are stored are called \u201ctransport stream files\u201d, where the AV streams in the transport stream format are obtained by converting the Packetized Elementary Streams (PESs) such as video streams and audio streams into TS packets, and multiplexing the TS packets.","On the other hand, AV files in which AV streams in a system stream format are stored are called \u201csystem stream files\u201d, where the AV streams in the system stream format are obtained by converting the PES streams such as video streams and audio streams into pack sequences, and multiplexing the pack sequences.","The AV files recorded on the BD-ROM, BD-RE, or BD-R are the former, namely, transport stream files. Also, the AV files recorded on the DVD-Video, DVD-RW, DVD-R, or DVD-RAM are the latter, namely, system stream files, and are also called video objects.","The fourth row shows how the areas in the file system area managed by the file system are assigned. As shown in the fourth row, a non-AV data recording area exists on the innermost circumference side in the file system area; and an AV data recording area exists immediately following the non-AV data recording area. The fifth row shows the contents recorded in the non-AV data recording area and the AV data recording area. As shown in the fifth row, Extents constituting the AV files are recorded in the AV data recording area; and Extents constituting non-AV files, which are files other than the AV files, are recorded in the non-AV data recording area.",{"@attributes":{"id":"p-0108","num":"0107"},"figref":"FIG. 5"},"The BDMV directory is a directory in which data such as AV content and management information used in the BD-ROM are recorded. Five sub-directories called \u201cPLAYLIST directory,\u201d \u201cCLIPINF directory,\u201d \u201cSTREAM directory,\u201d \u201cBDJO directory,\u201d \u201cJAR directory,\u201d and \u201cMETA directory\u201d exist below the BDMV directory. Also, two types of files (i.e. index.bdmv and MovieObject.bdmv) are arranged under the BDMV directory.","A file \u201cindex.bdmv\u201d (the file name \u201cindex.bdmv\u201d is fixed) stores an index table that shows correspondence between title numbers of a plurality of titles available on the BD-ROM and program files (namely, BD-J objects or movie objects) defining each title. The index table is management information of the entire BD-ROM. The \u201cindex.bdmv\u201d file is the first file that is read by a playback device after the BD-ROM is loaded into the playback device, so that the playback device is enabled to uniquely identify the disc. The index table is a table belonging to the highest layer for defining the title structure including all titles stored in the BD-ROM, top menu, and FirstPlay. The index table specifies a program file that is to be executed first among the general titles, top menu title, and FirstPlay title. The BD-ROM playback device refers to the index table and executes a predetermined program file each time a title or a menu is called. Here, the FirstPlay title is set by the content provider, and in which a program file, which is to be executed automatically when the disc is loaded, is set. The top menu title specifies a movie object or a BD-J object that is to be called when a command, such as a \u201creturn-to-menu\u201d command, is executed by a user operation on the remote control. The \u201cindex.bdmv\u201d file contains initial_output_mode information as information regarding the stereoscopic view. The initial_output_mode information defines how the initial state of the output mode of the playback device should be when the \u201cindex.bdmv\u201d file is loaded. The producer side can define a desired output mode in the initial_output_mode information.","A file \u201cMovieObject.bdmv\u201d (the file name \u201cMovieObject.bdmv\u201d is fixed) stores one or more movie objects. The movie object is a program file that defines a control procedure to be performed by the playback device in the operation mode (HDMV mode) in which the control subject is a command interpreter. The movie object includes one or more commands and a mask flag, where the mask flag defines whether or not to mask a menu call or a title call when the call is performed by the user onto the GUI.","A program file (XXXXX.bdjo---\u201cXXXXX\u201d is variable, and the extension \u201cbdjo\u201d is fixed) to which an extension \u201cbdjo\u201d is given exists in the BDJO directory. The program file stores a BD-J object that defines a control procedure to be performed by the playback device in the operation mode (BD-J mode) in which the control subject is a Java\u2122 virtual machine that is a byte code interpreter. The BD-J object includes an \u201capplication management table\u201d. The \u201capplication management table\u201d in the BD-J object is a table that is used to cause the playback device to perform an application signaling, with the title being regarded as the life cycle. The application management table includes an \u201capplication identifier\u201d and a \u201ccontrol code\u201d, where the \u201capplication identifier\u201d indicates an application to be executed when a title corresponding to the BD-J object becomes a current title. BD-J applications whose life cycles are defined by the application management table are especially called \u201cBD-J applications\u201d. The control code, when it is set to AutoRun, indicates that the application should be loaded onto the heap memory and be activated automatically; and when it is set to Present, indicates that the application should be loaded onto the heap memory and be activated after a call from another application is received. On the other hand, some BD-J applications do not end their operations even if the title is ended. Such BD-J applications are called \u201ctitle unboundary applications\u201d.","A substance of such a Java\u2122 application is a Java\u2122 archive file (YYYYY.jar) stored in the JAR directory under the BDMV directory.","An application may be, for example, a Java\u2122 application that is composed of one or more xlet programs having been loaded into a heap memory (also called work memory) of a virtual machine. The application is constituted from the xlet programs having been loaded into the work memory, and data.","In the \u201cPLAYLIST directory\u201d, a playlist information file (\u201cxxxxx.mpls\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cmpls\u201d is fixed) to which an extension \u201cmpls\u201d is given exists.","The \u201cplaylist\u201d indicates a playback path defined by logically specifying a playback order of playback sections, where the playback sections are defined on a time axis of AV streams. The playlist has a role of defining a sequence of scenes to be displayed in order, by indicating which parts of which AV streams among a plurality of AV streams should be played back. The playlist information file stores playlist information which defines \u201cpatterns\u201d of the playlists. The BD-J application starts a playback of a playlist by instructing a Java\u2122 virtual machine to generate a JMF (Java Media Frame work) player instance for playing back the playlist information. The JMF player instance is data that is actually generated in the heap memory of the virtual machine based on a JMF player class.","In the \u201cCLIPINF directory\u201d, a clip information file (\u201cxxxxx.clpi\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cclpi\u201d is fixed) to which an extension \u201cclpi\u201d is given exists.","The Extents constituting the files existing in the directories explained up to now are recorded in the non-AV data area.","The \u201cSTREAM directory\u201d is a directory storing a transport stream file. In the \u201cSTREAM directory\u201d, a transport stream file (\u201cxxxxx.m2ts\u201d---\u201cXXXXX\u201d is variable, and the extension \u201cm2ts\u201d is fixed) to which an extension \u201cm2ts\u201d is given exists.","The transport stream file in the STREAM directory stores an AV clip. The \u201cAV clip\u201d is composed of \u201cpieces\u201d of AV streams. That is to say, the AV clip is a set of packets storing sections of a plurality of types of PES streams such as a video stream, audio stream, and graphics stream. Each AV clip includes consecutive time stamps and provides a seamless AV playback for a predetermined period. The AV clip ensures a playback for a predetermined period on a time axis, where the length of the period is not fixed and may be, for example, one second, five seconds, or one minute.","Also, the AV clip contains packet management information (PCR, PMT, PAT) defined in the European digital broadcast standard, as information for managing and controlling a plurality of types of PES streams.","The PCR (Program Clock Reference) stores STC time information corresponding to an ATS that indicates the time when the PCR packet is transferred to a decoder, in order to achieve synchronization between an ATC (Arrival Time Clock) that is a time axis of ATSs, and an STC (System Time Clock) that is a time axis of PTSs and DTSs.","The PMT (Program Map Table) stores PIDs in the streams of video, audio, graphics and the like contained in the transport stream file, and attribute information of the streams corresponding to the PIDs. The PMT also has various descriptors relating to the AV clip. The descriptors have information such as copy control information showing whether copying of the AV clip is permitted or not permitted.","A PMT header is disposed at the top of the PMT. Information written in the PMT header includes the length of data included in the PMT to which the PMT header is attached. The PMT header is followed by a plurality of descriptors relating to the AV clip, Information such as the aforementioned copy control information is recited as the descriptors. The descriptors are followed by a plurality of pieces of stream information relating to the streams included in the transport stream file. Each piece of stream information is composed of stream descriptors which each describe a type of a stream, a PID of the stream, and attribute information (such as frame rate or aspect ratio) of the stream, where the stream type is used for identifying the compression codec of the stream or the like. There are as many stream descriptors as the streams existing in the AV clip.","The PAT (Program Association Table) shows a PID of a PMT used in the AV clip, and is registered by the PID arrangement of the PAT itself.","These PCR, PMT, and PAT, in the European digital broadcast standard, have a role of defining partial transport streams constituting one broadcast program (one program). This enables the playback device to cause the decoder to decode AV clips as if it deals with the partial transport streams constituting one broadcast program, conforming to the European digital broadcast standard. This structure is aimed to support compatibility between the BD-ROM playback devices and the terminal devices conforming to the European digital broadcast standard.","The AV clips include a \u201cleft-view AV clip\u201d that is a set of packets storing sections of a plurality of types of PES streams for a left-view playback, such as a left-view video stream, a left-view graphics stream, and an audio stream that is to be played back together with these streams, where each left-view AV clip includes consecutive time stamps and ensures a seamless AV playback for a predetermined period. Furthermore, a left-view AV clip may be called a \u201c2D\/left-view AV clip\u201d when it includes a base-view video stream and makes possible a planar-view playback. Note that in the following description, unless otherwise noted, it is assumed that a left-view video stream is a base-view video stream, and a left-view AV clip including a left-view video stream is a 2D\/left-view AV clip.","The AV clips also include a \u201cright-view AV clip\u201d that is a set of packets storing sections of a plurality of types of PES streams for a right-view playback, such as a right-view video stream, a right-view graphics stream, and an audio stream that is to be played back together with these streams, where each right-view AV clip includes consecutive time stamps and ensures a seamless AV playback for a predetermined period.","The clip information file stored in the CLIPINF directory is information which indicates details of each AV clip such as what packets a left-view AV clip or a right-view AV clip is composed of, and is information that is read out into a memory before a corresponding AV clip is played back and is provided for reference in the playback device while the playback of the AV clip continues.","Up to now, the internal structure of the recording medium has been described. The following describes how to generate the recording medium shown in , namely a form of a recording method.","The recording method of the present embodiment includes not only the above-described real-time recording in which AV files and non-AV files are generated in real time, and are written into the AV data recording area and the non-AV data recording area, but also a pre-format recording in which bit streams to be recorded into the volume area are generated in advance, a master disc is generated based on the bit streams, and the master disc is pressed, thereby making possible a mass production of the optical disc. The recording method of the present embodiment is applicable to either the real-time recording or the pre-format recording.",{"@attributes":{"id":"p-0132","num":"0131"},"figref":"FIG. 6"},"In step S, the title structure of the BD-ROM is determined. In this process, title structure information is generated. The title structure information defines, using a tree structure, the relationships among playback units (such as the title, movie object, BD-J object, and playlist) in the BD-ROM. More specifically, the title structure information is generated by defining nodes that respectively corresponds to: \u201cdisc name\u201d of the BD-ROM to be created; \u201ctitle\u201d that can be played back from index.bdmv; \u201cmovie object and BD-J object\u201d constituting the title; and \u201cplaylist\u201d that is played back from the movie object and BD-J object, and connecting these nodes with edges.","In step S, a video, audio, still picture, and subtitle to be used for the title are imported.","In step S, BD-ROM scenario data is generated by performing an editing process onto the title structure information in accordance with a user operation received via the GUI. Note that the BD-ROM scenario data is information for causing the playback device to play back an AV stream in units of titles. In the BD-ROM, a scenario is information defined as the index table, movie object, or playlist. The BD-ROM scenario data includes information of the materials constituting the streams, playback section, information indicating a playback route, a menu screen arrangement, and information of transition from the menu.","Step S is an encoding process in which PES streams are obtained by performing encoding based on the BD-ROM scenario data.","Step S is a multiplexing process in which AV clips are obtained by multiplexing the PES streams.","In step S, a database of the data to be recorded into the BD-ROM is generated. Here, the database is a generic name of the index table, movie object, playlist, BD-object and the like defined in the BD-ROM as described above.","In step S, an AV file and a non-AV file are generated in a file system format conforming to the BD-ROM, by using inputs of the Java\u2122 program, the AV clip obtained in the multiplexing process, and the BD-ROM database.","Step S is a process of writing the non-AV file, and step S is a process of writing the AV file.","The multiplexing process of step S multiplexes source packet sequences constituting the video, audio, and graphics, and includes a first conversion process and a second conversion process. In the first conversion process, the video, audio, and graphics streams are converted into PES streams, and the PES streams are converted into transport streams. In the second conversion process, TS packets constituting the transport streams are converted into source packets.","In the process of writing the AV file, in step S, the source packet sequences are written into consecutive areas in the recording medium, as extents of AV files.","The streams to be written in these processes are as follows.\n\n","The video stream is composed of a primary video and a secondary video of a movie. Here, the primary video is a normal video which is displayed as a parent image by picture-in-picture; and the secondary video is a video which is displayed on a small screen by picture-in-picture. The primary video is classified into a left-view video and a right-view video, and the secondary video is also classified into a left-view video and a right-view video.","The video stream may be encoded for recording, by MPEG-2, MPEG-4AVC, SM PTE VC-1 or the like, as well as by MVC as described above.\n\n","The audio stream represents the main audio part of the movie. The audio stream is compress-encoded for recording, by Dolby AC-3, Dolby Digital Plus, MLP, DTS, DTS-HD, linear PCM or the like. The audio stream is classified into a primary audio stream and a secondary audio stream. The primary audio stream is an audio stream that is to be a main audio when the mixing playback is performed; and the secondary audio stream is an audio stream that is to be a sub-audio when the mixing playback is performed.\n\n","The Presentation Graphics (PG) stream is a graphics stream representing graphics, such as movie subtitles and characters, that should be accurately synthesized with the picture. There are PG streams for a plurality of languages such as English, Japanese and French.","The PG stream is composed of functional segments such as: PCS (Presentation Control Segment); PDS (Pallet Define Segment); WDS (Window Define Segment); and ODS (Object Define Segment). The ODS is a functional segment that defines a graphics object as a subtitle.","The WDS is a functional segment that defines the amount of bits of a graphics object on the screen. The PDS is a functional segment that defines a color in drawing a graphics object. The PCS is a functional segment that defines a page control in displaying a subtitle. Such page control includes Cut-In\/Out, Fade-In\/Out, Color Change, Scroll, and Wipe-In\/Out. It is possible with the page control by the PCS to achieve a display effect, for example, fading out the current subtitle while displaying the next subtitle.","In the playback of a graphics stream, the graphics decoder realizes the above-described accurate synchronization by running the hardware full out. More specifically, the graphics decoder runs the hardware full out by executing, by pipeline, two processes: a process of obtaining a graphics object by decoding the ODS belonging to a certain display unit and writing the obtained graphics object into the object buffer; and a process of obtaining a graphics object by decoding the ODS belonging to a preceding display unit and writing the obtained graphics object into the plane memory.","The PG stream is a stream that is not multiplexed into the transport stream but represents a subtitle. The text subtitle stream (also referred to as textST stream) is a stream of this kind, as well. The textST stream is a stream that represents the contents of subtitle by the character codes. A combination the PG stream and the textST stream is called \u201cPGTextST stream\u201d in the BD-ROM standard.\n\n","The Interactive Graphics (IG) stream is a graphics stream for achieving an interactive control via a remote control. The interactive control defined by the IG stream is an interactive control that is compatible with an interactive control on a DVD playback device. The IG stream is composed of functional segments such as: ICS (Interactive Composition Segment); PDS (Palette Definition Segment); ODS (Object Definition Segment); and END (END of Display Set Segment). The ODS is a functional segment that defines a graphics object. A button on the interactive screen is drawn by a plurality of such graphics objects. The PDS (Palette Definition Segment) is a functional segment that defines a color in drawing a graphics object. The ICS is a functional segment that achieves a state change in which the button state changes in accordance with a user operation. The ICS includes a button command that is executed when a confirmation operation is performed on a button. The Interactive Graphics stream represents an interactive screen that is created by arranging GUI commands on the screen.",{"@attributes":{"id":"p-0153","num":"0156"},"figref":["FIG. 7A","FIG. 7A"],"b":["1","2","3","4"]},"<TS Packet Sequence>",{"@attributes":{"id":"p-0155","num":"0158"},"figref":"FIG. 7B"},"As shown in the first row of , each TS packet is a fixed-length packet consisting of a 4-byte \u201cTS header\u201d carrying information such as a PID identifying the stream, and a 184-byte \u201cTS payload\u201d storing data. The PES packets are divided and stored in the TS payloads.","As shown in the second row, each TS packet is attached with a 4-byte TP_Extra_Header to be converted into a 192-byte source packet. Such 192-byte source packets are written in an AV clip. The TP_Extra_Header stores information such as an ATS (Arrival_Time_Stamp). The ATS shows a transfer start time at which the TS packet is to be transferred to a PID filter. The source packets are arranged in the AV clip as shown in the third row. The numbers incrementing from the head of the AV clip are called SPNs (source packet numbers).","<Multiplexing of AV Clips>",{"@attributes":{"id":"p-0159","num":"0162"},"figref":"FIG. 8"},"A group of source packets whose ATSs are continuous in the Arrival Time Clock (ATC) time axis is called an ATC sequence. Also, a group of source packets whose Decode Time Stamps (DTSs) and Presentation Time Stamps (PTSs) are continuous in the System Time Clock (STC) time axis is called an STC sequences.",{"@attributes":{"id":"p-0161","num":"0164"},"figref":"FIG. 9"},"The second row shows source packet sequences which belong to each Extent.","The Extents shown in the first row are obtained by arranging a group of source packets constituting the right-view AV clip and a group of source packets constituting the left-view AV clip, by the interleave arrangement. The interleave arrangement in the case of  is to record alternately each set of source packets constituting the right-view AV clip and each set of source packets constituting the left-view AV clip, by regarding each set as one Extent, and thereby with a regularity that they are arranged in the order of \u201cright-view\u201d, \u201cleft-view\u201d, \u201cright-view\u201d, \u201cleft-view\u201d, . . . .","Here, the variables \u201ci\u201d and \u201ci+1\u201d in the parentheses indicate serial numbers of Extents to be played back. According to this notation, it is understood that the two Extents having the variable \u201ci\u201d, namely EXT_L[i] and EXT_R[i] are played back simultaneously, and the two Extents having the variable \u201ci+1\u201d, namely EXT_L[i+1] and EXT_R[i+1] are played back simultaneously.","The size of Extent EXT_L[i] is called SEXT_L[i]; and the size of Extent EXT_R[i] is called SEXT_R[i].","A description is given of how these sizes SEXT_R[i] and SEXT_R[i] are determined. The Extents in this example are read out into the two buffers (the right-view read buffer and the left-view read buffer) alternately, to be provided to the video decoder. Accordingly, it is necessary to determine the sizes SEXT_R[i] and SEXT_R[i] by taking into consideration the times required to fill up the right-view read buffer and the left-view read buffer. That is to say, it is necessary to determine the capacity of the right-view read buffer to satisfy the following relationship:\n\nCapacity of right-view read buffer=max1\u00d7\u201ctime required to fill up left-view read buffer with jumps\u201d,\n\nwhere \u201cRmax\u201d represents the rate of transfer to the right-view read buffer. Here, the \u201cjump\u201d has the same meaning as the disc seek. This is because the continuous areas available for recording in the BD-ROM have a limit, and a left-view video stream and a right-view video stream may not necessarily be recorded to be adjacent to each other, but may be recorded in separate areas.\n","Next, the \u201ctime required to fill up left-view read buffer with jumps\u201d is considered. TS packets are accumulated in the left-view read buffer at a transfer rate of Rud\u2212Rmax. The \u201cRud\u2212Rmax\u201d means a difference between Rmax and Rud, where Rmax represents the rate of output from the left-view read buffer, and Rud represents the rate of input to the left-view read buffer. Therefore, the time required to fill up the left-view read buffer is represented as \u201cRB\/(Rud\u2212Rmax)\u201d.","Here, when the data is read into the left-view read buffer, it is necessary to take into consideration the jump time (Tjump) required to jump from the right-view AV clip to the left-view AV clip, and the jump time (Tjump) required to jump from the left-view AV clip to the right-view AV clip. Therefore, the time required to fill up the left-view read buffer is represented as:\n\n(2\u00d7Tjump+RB2\/(Rud\u2212Rmax2).\n","When the rate of transfer to the right-view read buffer is represented as Rmax, all source packets in the right-view read buffer should be output at the transfer rate Rmax, in the above-described accumulation time of the left-view read buffer.","Therefore, the capacity \u201cRB\u201d of the right-view read buffer is represented as:\n\n1\u2267max1\u00d7[2\u00d7jump+2\/[Rud\u2212max2].\n","The capacity \u201cRB\u201d of the left-view read buffer can be obtained in a similar manner and is represented as:\n\n2\u2267max2\u00d7[2\u00d7jump+1\/[Rud\u2212max1].\n","The specific value of the capacity of each of the right-view read buffer and the left-view read buffer is 1.5 MB or less. In the present embodiment, Extent sizes SEXT_R and SEXT_L are each set to be equal to or substantially equal to the capacity of each of the right-view read buffer and the left-view read buffer. Up to now, how the right-view and left-view AV clips are recorded has been described. Next, the internal structure of the right-view and left-view AV clips will be described. First, the internal structure of Extents EXT_R[i] and EXT_L[i] will be described with reference to .","Extent EXT_L[i] is composed of the following source packets.","A source packet having packet ID \u201c0x01000\u201d constitutes a program_map. A source packet having packet ID \u201c0x01001\u201d constitutes a PCR.","A source packet having packet ID \u201c0x1011\u201d constitutes a left-view video stream.","Source packets having packet IDs \u201c0x1220\u201d through \u201c0x123F\u201d constitute a left-view PG stream.","Source packets having packet IDs \u201c0x1420\u201d through \u201c0x143F\u201d constitute a left-view IG stream.","Source packets having packet IDs \u201c0x1100\u201d through \u201c0x111F\u201d constitute an audio stream.","Extent EXT_R[i] is composed of the following source packets.","A source packet having packet ID \u201c0x1012\u201d constitutes a right-view video stream. Source packets having packet IDs \u201c0x1240\u201d through \u201c0x125F\u201d constitute a right-view PG stream. Source packets having packet IDs \u201c0x1440\u201d through \u201c0x145F\u201d constitute a right-view IG stream.","(Location of Extents in Volume Area)","Extents are formed on a plurality of sectors that are physically continuous in the partition area. The partition area is an area accessed by the file system and includes an \u201carea in which file set descriptor is recorded\u201d, \u201carea in which end descriptor is recorded\u201d, \u201cROOT directory area\u201d, \u201cBDMV directory area\u201d, \u201cJAR directory area\u201d, \u201cBDJO directory area\u201d, \u201cPLAYLIST directory area\u201d, \u201cCLIPINF directory area\u201d, and \u201cSTREAM directory area\u201d. The following explains these areas.","The \u201cfile set descriptor\u201d includes a logical block number (LBN) that indicates a sector in which the file entry of the ROOT directory is recorded, among directory areas. The \u201cend descriptor\u201d indicates an end of the file set descriptor.","Next is a detailed description of the directory areas. The above-described directory areas have an internal structure in common. That is to say, each of the \u201cdirectory areas\u201d is composed of a \u201cfile entry\u201d, \u201cdirectory file\u201d, and \u201cfile recording area of lower file\u201d.","The \u201cfile entry\u201d includes a \u201cdescriptor tag\u201d, \u201cICB tag\u201d, and \u201callocation descriptor\u201d.","The \u201cdescriptor tag\u201d is a tag that indicates the entity having the descriptor tag is a file entry.","The \u201cICB tag\u201d indicates attribute information concerning the file entry itself.","The \u201callocation descriptor\u201d includes a logical block number (LBN) that indicates a recording position of the directory file. Up to now, the file entry has been described. Next is a detailed description of the directory file.","The \u201cdirectory file\u201d includes a \u201cfile identification descriptor of lower directory\u201d and \u201cfile identification descriptor of lower file\u201d.","The \u201cfile identification descriptor of lower directory\u201d is information that is referenced to access a lower directory that belongs to the directory file itself, and is composed of identification information of the lower directorY, the length of the directory name of the lower directory, a file entry address that indicates the logical block number of the block in which the file entry of the lower directory is recorded, and the directory name of the lower directory.","The \u201cfile identification descriptor of lower file\u201d is information that is referenced to access a file that belongs to the directory file itself, and is composed of identification information of the lower file, the length of the lower file name, a file entry address that indicates the logical block number of the block in which the file entry of the lower file is recorded, and the file name of the lower file.","The file identification descriptors of the directory files of the directories indicate the logical blocks in which the file entries of the lower directory and the lower file are recorded. By tracing the file identification descriptors, it is therefore possible to reach from the file entry of the ROOT directory to the file entry of the BDMV directory, and reach from the file entry of the BDMV directory to the file entry of the PLAYLIST directory. Similarly, it is possible to reach the file entries of the JAR directory, BDJO directory, CLIPINF directory, and STREAM directory.","The \u201cfile recording area of lower file\u201d is an area in which the substance of the lower file that belongs to a directory. A \u201cfile entry\u201d of the lower entry and one or more \u201cExtents\u201d are recorded in the \u201cfile recording area of lower file\u201d.","The \u201cfile entry\u201d includes a \u201cdescriptor tag\u201d, \u201cICB tag\u201d, and \u201callocation descriptor\u201d.","The \u201cdescriptor tag\u201d is a tag that indicates the entity having the descriptor tag is a file entry. The tag is classified into a file entry descriptor, a space bit map descriptor, and the like. In the case of the file entry, \u201c261\u201d indicating the file entry is described in the descriptor tag.","The \u201cICB tag\u201d indicates attribute information concerning the file entry itself.","The \u201callocation descriptor\u201d includes a logical block number (LBN) that indicates a recording position of an Extent that constitutes a lower file belonging to a directory. The allocation descriptor includes data indicating an Extent length, and a logical block number that indicates a recording position of an Extent. Here, when the higher two bits of the data indicating the Extent length are set to \u201c0\u201d, it is indicated that the Extent is an assigned and recorded Extent; and when the higher two bits are set to \u201c1\u201d, it is indicated that the Extent is an assigned and not-recorded Extent. When they are set to \u201c0\u201d, it is indicated that the Extent is an Extent that continues from the allocation descriptor. When a lower file belonging to a directory is sectioned into a plurality of Extents, the file entry has a plurality of allocation descriptors for each Extent.","By referring to the allocation descriptors of the above-described file entries, it is possible to recognize addresses of Extents that constitute the playlist information file, clip information file, transport stream file, BD-J object file, and JAR archive file.","The transport stream file that constitutes the main feature of the present application is a file recording area that exists in the directory area of the directory to which the file belongs. It is possible to access the transport stream file by tracing the file identification descriptors of the directory files, and the allocation descriptors of the file entries.","The above-described AV stream, Index.bdmv, JAR file, and BD-J object are recorded on the BD-ROM in accordance with the file structure and the directory structure. Therefore, the playback device can read out these into the memory by performing a system call for the file open.","Here, the file open is a process in which directories are searched for a file with use of a file name that is given by the system call, and if the file is detected, FCB (File Control Block) is ensured, and the number of file handle is returned. The FCB is generated by copying the contents of the directory entry of the target file, onto the memory. In this file open, the transport stream file with extension \u201cm2ts\u201d is identified by a file path using the STREAM directory, and the transport stream file with extension \u201cssif\u201d is identified by a file path using the STREAM directory and the SSIF directory. This is because the transport stream files with extension \u201cssif\u201d are stored in the STREAM directory and the SSIF directory.","The following describes how the Extents shown in  are dealt with in the above-described file structure.",{"@attributes":{"id":"p-0203","num":"0206"},"figref":"FIG. 10"},"The first row shows transport stream files \u201c00001.m2ts\u201d and \u201c00002.m2ts\u201d that are in an ordinary transport stream format. The second row shows right-view and left-view Extents. The third row shows transport stream file \u201c00001.ssif\u201d in the interleave format.","The dotted arrows h, h, h, and h indicate to which files Extents EXT_R[i] and EXT_L[i] belong, by the allocation identifiers. It is understood from the belonging relationships indicated by the arrows h and h that Extents EXT_L[i] and EXT_L[i+1] are registered as Extents of \u201c00001.m2ts\u201d.","It is understood from the belonging relationships indicated by the arrows h and h that Extents EXT_R[i] and EXT_R[i+1] are registered as Extents of \u201c00002.m2ts\u201d.","It is understood from the belonging relationships indicated by the arrows h, h, h, and h that Extents EXT_R[i], EXT_L[i], EXT_R[i+1], and EXT_L[i+1] are registered as Extents of \u201c00001.ssif\u201d. It is understood from this description that Extents EXT_L[i] and EXT_L[i+1] have duality in that they belong to both \u201c00001.ssif\u201d and \u201c00001.m2ts\u201d. The extension \u201cssif\u201d stands for StereoScopic Interleave File, and indicates that the file is in the interleave format for the stereoscopic playback.",{"@attributes":{"id":"p-0208","num":"0211"},"figref":"FIG. 11"},"The upper part of  shows the Extents that constitute respective transport stream files.","Of these, Extents EXT_L[i] and EXT_L[i+1] are played back as a 2D image.","Not all playback devices necessarily support the 3D playback system. Therefore, it is preferable that even a BD-ROM including a 3D image supports a 2D playback. It should be noted here that the playback devices supporting only the 2D playback do not identify the data structure extended for the 3D. The 2D playback devices need to access only the 2D playlists and 2D AV clips by using a conventional identification method provided to the 2D playback devices. In view of this, the left-view video streams are stored in a file format that can be recognized by the 2D playback devices.","There are a plurality of methods for coupling a left-view AV clip with a right-view AV clip. According to the first method, the left-view file is assigned with the same file name as that in the 2D playback system so that the left-view file can be used in the 2D playback as well, and transport stream files in the interleave format have a different extension. The lower-left part of  shows that files \u201c000001.m2ts\u201d and \u201c000001.ssif\u201d are coupled with each other by the same file name \u201c000001\u201d, although the former is in the 2D format and the latter is in the 3D format.","In a conventional 2D playback device, the playlist refers to only the left-view AV clips, and therefore the 2D playback device plays back only the AV clips for 2D. On the other hand, In a 3D playback device, although the playlist refers to only the left-view AV clips, when it finds a file that has the same identification number and a different extension, it judges that the file is a transport stream files in the interleave format for the 3D image, and outputs left view and right view.","The second method is to use different folders. The left-view files are stored in folders with conventional folder names (for example, \u201cSTREAM\u201d), but right-view files are stored in folders with folder names unique to 3D (for example, \u201cSSIF\u201d), with the same file name \u201c00001\u201d. In the 2D playback device, the playlist refers to only files in the \u201cSTREAM\u201d folder, but in the 3D playback device, the playlist refers to files having the same file name in the \u201cSTREAM\u201d and \u201cSSIF\u201d folders simultaneously, making it possible to associate the left view and the right view.","The third method uses the identification numbers. That is to say, this method associates the files based on a predetermined rule regarding the identification numbers. For example, when the identification number of the left view is \u201c00001\u201d, the identification number of the right view is \u201c00002\u201d that is made by adding \u201c1\u201d to the identification number of the left view. This is only one example, and not limited to this, for example, the identification number of the right view may be made by adding \u201c10000\u201d to the identification number of the left view.","In this example, the images to be played back by conventional 2D playback devices are left-view images. However, the images may be right-view images. Also, the playlist may include information that indicates which of the left-view image and the right-view image is defined as the image to be played back by conventional 2D playback devices.","When a coupling method is to be realized, the playback device side requires a mechanism for detecting the coupled files, and a mechanism for detecting the file based on a predetermined rule, and playing back files that are not referenced by the playlist. The 3D supporting playback devices require the above-described mechanisms when they use any of such coupling methods. However, with this structure, there is no need for using different types of playlists to play back both the 2D and 3D images, and it is possible to make the playlist operate safely in the conventional 2D playback devices that are already prevalent.","Up to now, transport stream files storing AV clips have been described. Next is a detailed description of how to record the above-described transport stream files into the recording medium, namely, the procedure for writing the AV files into the AV data area (AV file writing process).",{"@attributes":{"id":"p-0219","num":"0222"},"figref":"FIG. 12"},"In step S, \u201cxxxxx.ssif\u201d is created, and a file entry is generated in the memory of the recording device. In step S, it is judged whether or not free continuous sector areas have been allocated. When it is judged that free continuous sector areas have been allocated, steps S through S are performed. When it is judged that free continuous sector areas have not been allocated, the control goes to step S in which exceptions of writing failures are handled, and the recording method is ended.","Steps S through S form a loop in which the process of steps S through S and S is repeated until it is judged \u201cNo\u201d in step S.","In step S, the same amount of a source packet sequence constituting the left-view AV clip as SEXT_L[i] is written into the free continuous sector areas. In step S, the starting address at which the source packet sequence has been written, and the allocation identifier indicating the length of continuity, are additionally written into the file entry, and is registered as an Extent.","In step S, the same amount of a source packet sequence constituting the right-view AV clip as SEXT_R[i] is written into the free continuous sector areas. In step S, the starting address at which the source packet sequence has been written, and the allocation identifier indicating the length of continuity, are additionally written into the file entry, and is registered as an Extent.","Step S defines the condition for ending the loop. In step S, it is judged whether or not a not-written source packet exists in the left-view video stream or the right-view video stream. When a not-written source packet exists, the control moves to step S to continue the process in the loop. When a not-written source packet does not exist, the control moves to step S.","In step S, it is judged whether or not continuous sector areas exist. When continuous sector areas exist, the control moves to step S. When continuous sector areas do not exist, the control returns to step S.","In step S, \u201cxxxxx.ssif\u201d is closed, and the file entry is written into the recording medium. In step S, \u201cxxxxx.m2ts\u201d is created, and a file entry of \u201cxxxxx.m2ts\u201d is generated in the memory. In step S, the starting address of an Extent of either the left-view AV clip or the right-view AV clip that includes the base-view video stream, and the allocation identifier indicating the length of continuity, are additionally written into the file entry of \u201cxxxxx.m2ts\u201d. In step S, \u201cxxxxx.m2ts\u201d is closed, and the file entry is written.","This completes the explanation of the AV file writing process. Next is a description of the clip information file.","<Clip Information File>",{"@attributes":{"id":"p-0229","num":"0232"},"figref":["FIG. 13","FIG. 13"],"b":["1","1"]},"As indicated by the lead line ch, the clip information is composed of \u201csystem rate\u201d, \u201cplayback start time\u201d, and \u201cplayback end time\u201d. The system rate indicates a maximum transfer rate at which TS packets constituting an AV clip are transferred to the PID filter of the system target decoder which will be described later. The interval between ATSs included in an AV clip is set to be equal to or smaller than the system rate. The playback start time is a PTS of the starting video frame of the AV clip. The playback end time is set to a value that is obtained by adding one frame of playback interval to the PTS of the ending video frame of the AV clip.",{"@attributes":{"id":"p-0231","num":"0234"},"figref":"FIG. 14"},"The lead line ah indicates the close-up of the internal structure of the stream attribute information.","As indicated by the lead line ah, the stream attribute information includes: stream attribute information of the left-view video stream constituted from the TS packet having packet ID \u201c0x1011\u201d; stream attribute information of the right-view video stream constituted from the TS packet having packet ID \u201c0x1012\u201d; stream attribute information of the audio stream constituted from the TS packets having packet IDs \u201c0x1100\u201d and \u201c0x1101\u201d; and stream attribute information of the PG stream constituted from the TS packets having packet IDs \u201c0x1220\u201d and \u201c0x1221\u201d. As understood from this, the stream attribute information indicates what attributes the PES streams have, where the PES streams are constituted from a plurality of types of source packets. As indicated by the lead line ah, attribute information of each stream included in the AV clip is registered for each PID.",{"@attributes":{"id":"p-0234","num":"0237"},"figref":"FIGS. 15A and 15B"},{"@attributes":{"id":"p-0235","num":"0238"},"figref":"FIG. 15A","b":["1","1"]},"The \u201centry map table header information\u201d stores information such as the PIDs of video stream indicated by the entry maps, and values of entry points.","The \u201cExtent start type\u201d indicates which of an Extent constituting the left-view video stream and an Extent constituting the right-view video stream is disposed first.","The \u201centry map for PID=0x1011\u201d, \u201centry map for PID=0x1012\u201d, \u201centry map for PID=0x1220\u201d, and \u201centry map for PID=0x1221\u201d are entry maps for each PES stream constituted from a plurality of types of source packets. Each entry map includes \u201centry points\u201d, each of which is composed of a pair of PTS and SPN values. Also, and identification number of the entry point is called an \u201centry point ID\u201d (hereinafter referred to as EP_ID), where the EP_ID of the first entry point is \u201c0\u201d, and after this, the EP_ID for each entry point in the serial order is incremented by \u201c1\u201d. By using the entry maps, the playback device can identify a source packet position corresponding to an arbitrary position on the time axis of the video stream. For example, when a special playback such as a fast forward or rewinding is to be performed, I-pictures registered in the entry maps can be identified, selected, and played back. This makes it possible to process efficiently without analyzing the AV clip. Also, the entry maps are created for each video stream which is multiplexed in the AV clip, and are managed by the PIDs.","The lead line eh indicates the close-up of the internal structure of the entry map for PID=0x1011. The entry map for PID=0x1011 includes entry points corresponding to EP_ID=0, EP_ID=1, EP_ID=2, and EP_ID=3. The entry point corresponding to EP_ID=0 indicates a correspondence among the is_angle_change flag having been set to \u201cON\u201d, SPN=3, and PTS=80000. The entry point corresponding to EP_ID=1 indicates a correspondence among the is_angle_change flag having been set to \u201cOFF\u201d, SPN=1500, and PTS=270000.","The entry point corresponding to EP_ID=2 indicates a correspondence among the is_angle_change flag having been set to \u201cOFF\u201d, SPN=3200, and PTS=360000. The entry point corresponding to EP_ID=3 indicates a correspondence among the is_angle_change flag having been set to \u201cOFF\u201d, SPN=4800, and PTS=450000. Here, the is_angle_change flag indicates whether or not it is possible to decode independent of the entry point itself. When the video stream has been encoded by the MVC or MPEG-4AVC and an IDR picture exists in the entry point, this flag is set to \u201cON\u201d. When a Non-IDR picture exists in the entry point, this flag is set to \u201cOFF\u201d.",{"@attributes":{"id":"p-0241","num":"0244"},"figref":["FIG. 15B","FIG. 15A"]},"The entry point corresponding to EP_ID=2 indicates SPN=3200, and this source packet number is associated with PTS=360000. The entry point corresponding to EP_ID=3 indicates SPN=4800, and this source packet number is associated with PTS=450000.",{"@attributes":{"id":"p-0243","num":"0246"},"figref":["FIG. 16","FIG. 16"],"b":["1","1","1","1","21","21","21","21"]},"By using the entry maps, the playback device can identify a file position of AV clip corresponding to an arbitrary position on the time axis of the video stream. For example, when a special playback such as a fast forward or rewinding is to be performed, I-pictures registered in the entry maps can be identified, selected, and played back. This makes it possible to process efficiently without analyzing the AV clip.","This completes the explanation of the entry map table. Next is a detailed description of the 3D metadata.","The 3D metadata is a group of metadata defining various information that are required for the stereoscopic playback. The 3D metadata includes a plurality of offset entries. Each offset entry is associated with a plurality of PIDs and a plurality of display times. When a PES stream is to be played back, it is possible to define, for each PID and for each display time, how much offsets should be used to realize the stereoscopic view at a plurality of display times of the PES stream.","This completes the explanation of the clip information file. Next is a detailed description of the playlist information.","It is difficult to switch seamlessly between the 2D playback and the 3D playback due to the difference between them in the structure of the decoder and display plane. It is thus difficult to switch seamlessly between the 2D playitem and the 3D playitem.",{"@attributes":{"id":"p-0249","num":"0252"},"figref":"FIG. 17"},"The \u201cmain path\u201d includes one or more playitems. In the example shown in , the main path is composed of playitems #, #, and #.","The \u201csub-paths\u201d indicate playback paths that are played back together with the main path. The sub-paths are assigned with IDs (sub-path IDs) in the order of registration in the playlist. The sub-path ID is used to identify a sub-path. The sub-path is classified into the sync type and the non-sync type, where the sub-path of the sync type is played back in synchronization with the main path, and the sub-path of the non-sync type is played back not in synchronization with the main path. Either of the types is described in the \u201csub-path type\u201d. The sub-path includes one or more sub-playitems, and each sub-playitem includes one or more pieces of sub-playitem information.","The \u201cplayitem\u201d includes a stream selection table. The stream selection table is information indicating stream numbers of elementary streams that are permitted to be played back by the playitems and sub-playitems. Details of the playlist information, playitem information, sub-playitem information, and stream selection table will be described in later embodiments.","AV clips #, #, and # are played back as 2D images, and are played back as left-view images in the 3D playback.","AV clips #, #, and # are played back as right-view images in the 3D playback.","The main path of the 2D playlist refers to AV clips #, #, and # storing the left-view AV clips, as indicated by signs rf, rf, and rf.","The 3D playlist includes a main path that refers to left-view AV clips as indicated by signs rf, rf, and rf. The 3D playlist also includes a sub-path that refers to right-view AV clips. The sub-path refers to AV clips #, #, and # storing the right-view AV clips, as indicated by signs rf, rf, and rf. The sub-path is set to synchronize with the main path on the time axis. With this structure, the 2D playlist and the 3D playlist can share the left-view AV clips, and the 3D playlist can associate the left-view AV clips with the right-view AV clips to synchronize with each other on the time axis.","In this example shown in , the playitems #, #, and # in the 2D playlist and the playitems #, #, and # in the 3D playlist both refer to the AV clips #, #, and #. As a result, when the playlist information that defines the 2D playlist and the 3D playlist is to be described, it is possible to use a description that is common to the 2D playlist and the 3D playlist (see signs df and df). Accordingly, by preliminarily describing the playlist information for realizing the 3D playlist, the playlist functions as the 3D playlist when the playback device is in the stereoscopic output mode, and functions as the 2D playlist when the playback device is in the 2D output mode. The 2D playlist and the 3D playlist shown in  are therefore interpreted as the 2D playlist and the 3D playlist respectively depending on the output mode of the playback device that interprets the playlist. This structure reduces the trouble of authoring that should be performed by a person in charge.",{"@attributes":{"id":"p-0258","num":"0261"},"figref":["FIG. 18","FIG. 17","FIG. 17","FIG. 18"],"b":["7","8","9"]},"In the example shown in , AV clips #, #, and # and AV clips #, #, and # both store right views, but are different in the angle at which the right eye view the subject.","The sub-path that corresponds to sub-path ID=0 refers to AV clips #, #, and #, as indicated by signs rf, rf, and rf, and the sub-path that corresponds to sub-path ID=1 refers to AV clips #, #, and #, as indicated by signs rf, rf, and rf. With this structure, it is possible to select a sub-path that is to be played back in synchronization with the main path storing the left view, based on the size of the screen of the display device and the preference indicated by the user. This makes it possible to display a stereoscopic image by using a parallax image that is comfortable to the user.","In regards with the playlist information for realizing the 3D playlist having the above-described structure, the playlist functions as the 3D playlist when the playback device is in the stereoscopic output mode, and functions as the 2D playlist when the playback device is in the 2D output mode. The 2D playlist and the 3D playlist shown in  are therefore interpreted as the 2D playlist and the 3D playlist respectively depending on the output mode of the playback device that interprets the playlist, providing optimum outputs. This structure reduces the trouble of authoring that should be performed by a person in charge.",{"@attributes":{"id":"p-0262","num":"0265"},"figref":["FIG. 19","FIG. 19"],"b":"1"},"First, a description is given of the MainPath information. The lead line mp indicates the close-up of the internal structure of the MainPath information. As indicated by the lead line mp, the MainPath information is composed of a plurality of pieces of PlayItem information: PlayItem information #, . . . #N. The PlayItem information defines one or more logical playback sections that constitute the MainPath. The lead line hs in the drawing indicates the close-up of the structure of the PlayItem information. As indicated by the lead line hs, the PlayItem information is composed of: \u201cClip_Information_file_name\u201d that indicates the file name of the playback section information of the AVClip to which the IN point and the OUT point of the playback section belong; \u201cClip_codec_identifier\u201d that indicates the AVClip encoding method; \u201cis_multi_angle\u201d that indicates whether or not the PlayItem is multi angle; \u201cconnection_condition\u201d that indicates whether or not to seamlessly connect the current PlayItem and the preceding PlayItem; \u201cref_to_STC_id[0]\u201d that indicates uniquely the STC_Sequence targeted by the PlayItem; \u201cIn_time\u201d that is time information indicating the start point of the playback section; \u201cOut_time\u201d that is time information indicating the end point of the playback section; \u201cUO_mask_table\u201d that indicates which user operation should be masked by the PlayItem; \u201cSTN_table\u201d; \u201cleft-view\/right-view identification information\u201d; and \u201cmulti_clip_entry\u201d.","The following describes the \u201cSTN_table\u201d, \u201cleft-view\/right-view identification information\u201d, and \u201cmulti_clip_entry\u201d.","The \u201cSTN_table (Stream Number_table)\u201d is a table in which logical stream numbers are assigned to pairs of (i) a stream entry including a packet ID and (ii) a stream attribute. The order of the pairs of a stream entry and a stream attribute in the STN_table indicates a priority order of the corresponding streams. This STN_table is provided for the 2D playback, and an STN_table for the 3D playback is provided independent of this table.","The \u201cleft-view\/right-view identification information\u201d is base-view video stream specification information that specifies which of the left-view video stream and the right-view video stream is the base-view video stream. When it is \u201c0\u201d, the left-view\/right-view identification information indicates that the base-view video stream is the left-view video stream; and when it is \u201c1\u201d, the left-view\/right-view identification information indicates that the base-view video stream is the right-view video stream.","The \u201cconnection_condition\u201d indicates a forward PlayItem and a connection type. When the connection_condition of a PlayItem is \u201c1\u201d, it indicates that the AV clip specified by the Playitem is not ensured to be connected seamlessly with the AV clip specified by the Playitem that precedes the Playitem. When the connection_condition of a Playitem is \u201c5\u201d or \u201c6\u201d, it indicates that the AV clip specified by the Playitem is ensured to be connected seamlessly with the AV clip specified by the Playitem that precedes the Playitem.","When the connection_condition is \u201c5\u201d, the STCs between Playitems may be discontinuous. That is to say, the video display start time of the start of the starting AV clip of the post-connection Playitem may be discontinuous from the video display end time of the end of the ending AV clip of the pre-connection Playitem. It should be noted here that the AV clips need to be generated so that the decoding by the system target decoder does not fail when a playback is performed after the AV clip of the post-connection Playitem is input into the PID filter of the system target decoder immediately after the AV clip of the pre-connection Playitem is input into the PID filter of the system target decoder, where the system target decoder will be described later. Also, there are some limiting conditions. For example, the audio end frame of the AV clip of the pre-connection Playitem should overlap, on the playback time axis, with the audio start frame of the post-connection Playitem.","When the connection_condition is \u201c6\u201d, an AV clip of the pre-connection Playitem connected with an AV clip of the post-connection Playitem should be able to be played back as one AV clip. That is to say, the STCs should be continuous and the ATCs should be continuous through the AV clips of the pre-connection Playitem and post-connection Playitem.","The \u201cmulti_clip_entry\u201d is information that identifies AV clips representing images of different angles when a multi-angle section is formed by the Playitem.","This completes the description of the main path information. Next, a detailed description is given of the sub-path information table.",{"@attributes":{"id":"p-0272","num":"0275"},"figref":"FIG. 20","b":["1","1","1","2","3","2","2","1","3","3"],"sub":"\u2014 In"},"The \u201cClip_information_file_name\u201d is information that, with the file name of Clip information written therein, uniquely specifies a SubClip that corresponds to the SubPlayItem.","The \u201cClip_codec_identifier\u201d indicates an encoding method of the AVClip.","The \u201cref_to_STC_id [0]\u201d uniquely indicates a STC_Sequence that is the target of the SubPlayItem.","The \u201cSubPlayItem_In_time\u201d is information that indicates the start point of SubPlayItem in the playback time axis of the SubClip.","The \u201cSubPlayItem_Out_time\u201d is information that indicates the end point of SubPlayItem in the playback time axis of the SubClip.","The \u201csync_PlayItem_id\u201d is information that uniquely specifies, among PlayItems constituting the MainPath, a PlayItem with which the SubPlayItem is to be synchronized. The \u201cSubPlayItem_In_time\u201d is present on the playback time axis of the PlayItem specified by the \u201csync_PlayItem_id\u201d.","The \u201csyn.c_start_PTS_of_PlayItem\u201d indicates, with the time accuracy of 45 KHz, the position of the start point of the SubPlayItem specified by the SubPlayItem_In_time, on the playback time axis of the PlayItem specified by the \u201csync_PlayItem_id\u201d.",{"@attributes":{"id":"p-0280","num":"0283"},"figref":["FIG. 21","FIG. 21","FIG. 16","FIG. 21","FIG. 16","FIG. 21","FIG. 21","FIG. 16"]},"This completes the explanation of the sub-path information. Next is a detailed description of the entry mark information.","The entry mark information can be attached at a position within a playback section defined by the playitem. Namely, the entry mark information is attached at a position that can be a playback start point in the playitem, and is used for a random-access playback. For example, during a playback of a movie title, the chapter playback is realized when an entry mark is attached to a chapter start position.","This completes the description of the entry mark information. Next is a detailed explanation of the extension data.","The extension data is an extension unique to the 3D playlist and is not compatible with the 2D playlist. The extension data stores STN_table_SS#1-#N. Each STN_table_SS corresponds to a different piece of playitem information, and is a table in which logical stream numbers are assigned to pairs of a stream entry a stream attribute for 3D playback. The order of the pairs of a stream entry and a stream attribute in the STN_table_SS indicates a priority order of the corresponding streams. The stream selection table is constituted from the STN_table in the playitem information and the STN_table_SS in the extension data.","The following describes the stream selection table which is included in the above-described internal structure of the playitem information.",{"@attributes":{"id":"p-0286","num":"0289"},"figref":"FIG. 22A"},"As the stream entries of the STN_table, the audio\/PG\/IG for 2D that are playable in the 2D output mode can be registered. For this reason, the STN_table includes a 2D video stream entry group, a 2D audio stream entry group, a 2D PG stream entry group, and a 2D IG stream entry group, and the packet identifiers of the video, audio, PG, and IG streams can be described in these stream entry groups.","As the stream entries of the STN_table_SS, the audio\/PG\/IG for 3D that are playable in the stereoscopic playback mode can be registered. For this reason, the STN_table_SS includes a 3D video stream entry group, a 3D audio stream entry group, a 3D PG stream entry group, a 3D IG stream entry group, and stream combination information, and the packet identifiers of the video, audio, PG, and IG streams can be described in these stream entry groups.",{"@attributes":{"id":"p-0289","num":"0292"},"figref":["FIG. 22B","FIG. 22B"]},"The \u201cstream selection number\u201d is a number attached to each stream entry in the stream selection table, and is incremented by one in the order starting with \u201cstream entry \u201d. The \u201cstream selection number\u201d is used for identification of the streams by the playback device.","The \u201cstream path information\u201d is information that indicates an AV clip in which the stream indicated by the stream identification information is multiplexed. For example, when the \u201cstream path information\u201d is \u201cmain path\u201d, it indicates an AV clip of the playitem; and when the \u201cstream path information\u201d is \u201csub-path ID=1\u201d, it indicates an AV clip of a sub-playitem that corresponds to the playback section of the playitem, in the sub-path indicated by the sub-path ID.","The \u201cstream identification information\u201d is information such as the PID, and indicates a stream multiplexed in the referenced AV clip. Each stream entry also includes attribute information of each stream. Here, the attribute information is information that indicates characteristics of each stream. For example, in the case of audio, presentation graphics, or interactive graphics, the attribute information includes a language attribute or the like.","In the STN_table_SS, the stream entries for the left-view and right-view video streams have the same values with respect to, for example, the frame rate, resolution, and video format. For this reason, the stream entry may include a flag that indicates either the left-view video stream or the right-view video stream.","This completes the description of the stream selection table. Next, a detailed description is given of the left-view\/right-view identification information.","It has been presumed in the description that the left view is the main, and the left view is displayed in the 2D display. However, it may be set that the right view is the main. The present embodiment is provided with information that indicates which of the left view and the right view is the main and is displayed in the 2D display. In other words, the information indicates which of the left view and the right view is the base-view video stream. The information indicating this is the left-view\/right-view identification information.","It appears to be typical that in the studio, the left-view video is generated as a 2D video. However, some creators might desire to create the right-view video as a 2D video. Since there is such a possibility, the left-view\/right-view identification information, which indicates which of the left-view and the right-view is the base-view, is provided to be set for each piece of playitem information.",{"@attributes":{"id":"p-0297","num":"0300"},"figref":["FIG. 23","FIG. 17"]},"Each stream and the left-view\/right-view identification information can be output the display device, and the display device can use the left-view\/right-view identification information to distinguish between the left-view and right-view streams. When a pair of glasses of the shutter method is used, it is necessary to recognize which of the left-view image and the right-view image is the main image that is to be referenced by the playitem, in order to synchronize displays between the glasses and the display device. Therefore, switch signals are sent to the glasses so that the light passes through the left glass of the shutter-method glasses when the left view is displayed, and the light passes through the right glass of the shutter-method glasses when the right view is displayed.","The distinction between the left view and the right view is also necessary even in the naked-eye stereoscopic view method in which the display device has a screen embedded with a prism, such as a lenticular. Therefore, this information is also used this method to distinguish between the left view and the right view.","Up to now, the left-view\/right-view identification information has been described. The left-view\/right-view identification information is provided on the assumption that either the left-view image or the right-view image among the parallax images can be played back as a planar image. However, such a view may not be suitable for being used a planar image, depending on the parallax image.","The following describes the left-view image and the right-view image that are not suitable for being used a planar image.",{"@attributes":{"id":"p-0302","num":"0305"},"figref":["FIG. 24","FIG. 24","FIG. 24","FIG. 24"]},"In , the \u201c00005.mpls\u201d specifies the left-view and right-view video streams with a large jumping-out-of-screen effect, as the main path information and the sub-path information, respectively.","Also, the \u201c00003.mpls\u201d specifies the center-image video stream, using the main path. The movie object in the upper-left portion of  is described so that either 00005.mpls or 00003.mpls is selected for playback depending on the 3D playback capability (3D-Capability) of the playback device (the \u201cif\u201d statement in the drawing).","This completes the description of implementation acts of the recording medium and recording method. The following describes the playback device in detail.",{"@attributes":{"id":"p-0306","num":"0309"},"figref":"FIG. 25","b":["1","2","2","3","4","5","5","6","7","9","10","11","12","13","14","15","16","17","18","19"],"i":["a","b","a","b"]},"The BD-ROM drive , like a 2D playback device, reads out data from a BD-ROM disc based on a request from the playback control unit . AV clips read out from the BD-ROM disc are transferred to the read buffer or ","When a 3D image is to be played back, the playback control unit  issues a read request that instructs to read out the 2D\/left-view AV clip and the right-view AV clip alternately in units of Extents. The BD-ROM drive  reads out Extents constituting the 2D\/left-view AV clip into the read buffer , and reads out Extents constituting the right-view AV clip into the read buffer . When a 3D image is to be played back, the BD-ROM drive  should have a higher reading speed than the BD-ROM drive for a 2D playback device, since it is necessary to read out both the 2D\/left-view AV clip and the right-view AV clip simultaneously.","The read buffer is a buffer that may be realized by, for example, a dual-port memory, and stores the data of the 2D\/left-view AV clips read out by the BD-ROM drive .","The read buffer is a buffer that may be realized by, for example, a dual-port memory, and stores the data of the right-view AV clips read out by the BD-ROM drive .","The switch  is used to switch the source of data to be input into the read buffers, between the BD-ROM drive  and the local storage .","The system target decoder  decodes the streams by performing the demultiplexing process onto the source packets read out into the read buffer and the read buffer ","The plane memory set is composed of a plurality of plane memories. The plane memories include those for storing a left-view video plane, a right-view video plane, a secondary video plane, an interactive graphics plane (IG plane), and a presentation graphics plane (PG plane).","The plane synthesizing unit superposes the left-view video plane, right-view video plane, secondary video plane, IG plane, PG plane, and GFX plane in an instant, and displays the superposed image onto a screen such as a TV screen. In displaying this, the plane synthesizing unit crops a set of the secondary video plane, IG plane, and PG plane for the left view and the right view alternately, and synthesizes the cropped set of the secondary video plane, IG plane, and PG plane with the left-view video plane or the right-view video plane. The image resulted from the synthesizing is transferred to the GFX superposing process.","The plane synthesizing unit crops graphics for the left view and the right view from the IG plane alternately, by using the offset information specified from the API, and outputs, to the television, an image in which the left-view video plane or the right-view video plane, the secondary video plane, IG plane, and PG plane are superposed.","When the image is to be output to the television or the like, the output is conformed to the 3D system. When it is necessary to play back the left-view image and the right-view image alternately by using the shutter glasses, the image is output as it is. When the image is to be output to, for example, the lenticular television, a temporary buffer is prepared, the left-view image is first transferred into the temporary buffer, and the left-view image and the right-view image are output simultaneously after the right-view image is transferred.","The HDMI transmission\/reception unit  includes an interface conforming to, for example, the HDMI standard, where HDMI stands for High Definition Multimedia Interface. The HDMI transmission\/reception unit  performs data transmission\/reception in conformance with the HDMI standard between the playback device and a device (in this example, a television ) with which the playback device is connected by the HDMI connection. The picture data stored in the video and the non-compressed audio data decoded by the management information memory  are transferred to the television  via the HDMI transmission\/reception unit . The television  holds, for example, (i) information indicating whether or not it supports a stereoscopic display, (ii) information regarding resolution for a planar display, and (iii) information regarding resolution for a stereoscopic display. Upon receiving a request from the playback device via the HDMI transmission\/reception unit , the television  returns the requested necessary information (for example, (i) information indicating whether or not it supports a stereoscopic display, (ii) information regarding resolution for a planar display, and (iii) information regarding resolution for a stereoscopic display) to the playback device. In this way, the playback device can obtain the information indicating whether or not the television  supports a stereoscopic display, from the television  via the HDMI transmission\/reception unit .","The playback control unit  includes a playback engine and a playback control engine . When it is instructed from the program executing unit  or the like to playback a 3D playlist, the playback control unit  identifies a 2D\/left-view AV clip of a playitem that is the playback target among the 3D playlist, and identifies a right-view AV clip of a sub-playitem in the 3D sub-path that should be played back in synchronization with the playitem. After this, the playback control unit  interprets the entry map of the corresponding clip information file, and requests the BD-ROM drive  to alternately read out the Extent of the 2D\/left-view AV clip and the Extent of the right-view AV clip, starting with the playback start point, based on the Extent start type that indicates which of an Extent constituting the left-view video stream and an Extent constituting the right-view video stream is disposed first. When the playback is started, the first Extent is read out into the read buffer or the read buffer completely, and then the transfer from the read buffer and the read buffer to the system target decoder  is started. When playing back the 3D playlist, the playback control unit  notifies the plane synthesizing unit of the 3D metadata that is included in the clip information file that corresponds to the 2D\/left-view AV clip.","The playback engine executes AV playback functions. The AV playback functions in the playback device are a group of traditional functions succeeded from CD and DVD players. The AV playback functions include: Play, Stop, Pause On, Pause Off, Still Off, Forward Play (with specification of the playback speed by an immediate value), Backward Play (with specification of the playback speed by an immediate value), Audio Change, Picture Data Change for Secondary Video, and Angle Change.","The playback control engine performs playlist playback functions. The playlist playback functions mean that, among the above-described AV playback functions, the Play and Stop functions are performed in accordance with the current playlist information and the current clip information, where the current playlist information constitutes the current playlist.","The management information memory  is a memory for storing the current playlist information and the current clip information. The current playlist information is a piece of playlist information that is currently a target of processing, among a plurality of pieces of playlist information that can be accessed from the BD-ROM, built-in medium drive, or removable medium drive. The current clip information is a piece of clip information that is currently a target of processing, among a plurality of pieces of clip information that can be accessed from the BD-ROM, built-in medium drive, or removable medium drive.","The register set  is a player status\/setting register set that is a set of registers including: a player status register for storing a playlist playback status; a player setting register for storing configuration information indicating the configuration of the playback device; and a general-purpose register for storing arbitrary information that is to be used by contents. Here, the playlist playback status indicates playback statuses such as which of various pieces of AV data information described in the playlist is used, and at what position (time) the currently played-back portion of the playlist is.","When the playlist playback status changes, the playback control engine stores the changed playlist playback status into the register set . Also, in accordance with an instruction received from an application which is run by the command interpreter that is an operator in the HDMV mode, or run by the Java\u2122 platform that is an operator in the BD-J mode, a value specified by the application may be stored, or a stored value may be transferred to the application.","The program executing unit  is a processor for executing a program stored in a BD program file. Operating according to the stored program, the program executing unit  performs the following controls: (1) instructing the playback control unit  to play back a playlist; and (2) transferring, to the system target decoder, PNG\/JPEG that represents a menu or graphics for a game so that it is displayed on the screen. These controls can be performed freely in accordance with construction of the program, and how the controls are performed is determined by the process of programming the BD-J application in the authoring process.","The program memory  stores a current dynamic scenario which is provided to the command interpreter that is an operator in the HDMV mode, and to the Java\u2122 platform that is an operator in the BD-J mode. The current dynamic scenario is a current execution target that is one of Index.bdmv, BD-J object, and movie object recorded in the BD-ROM. The program memory  includes a heap memory.","The heap memory is a stack region for storing byte codes of the system application, byte codes of the BD-J application, system parameters used by the system application, and application parameters used by the BD-J application.","The HDMV module  is a DVD virtual player that is an operator in the HDMV mode, and is a performer in the HDMV mode. The HDMV module  has a command interpreter, and performs the control in the HDMV mode by interpreting and executing the navigation command constituting the movie object. The navigation command is described in a syntax that resembles a syntax used in the DVD-Video. Accordingly, it is possible to realize a DVD-Video-like playback control by executing the navigation command.","The BD-J platform  is a Java\u2122 platform that is an operator in the BD-J mode, and is fully implemented with Java2 Micro_Edition (J2ME) Personal Basis Profile (PBP 1.0), and Globally Executable MHP specification (GEM1.0.2) for package media targets. The BD-J platform  is composed of a class loader, a byte code interpreter, and an application manager.","The class loader is one of system applications, and loads a BD-J application by reading out byte codes from the class file existing in the JAR archive file, and storing the byte codes into the heap memory.","The byte code interpreter is what is called a Java\u2122 virtual machine. The byte code interpreter converts (i) the byte codes constituting the BD-J application stored in the heap memory and (ii) the byte codes constituting the system application, into native codes, and causes the MPU to execute the native codes.","The application manager is one of system applications, and performs application signaling for the BD-J application based on the application management table in the BD-J object, such as starting or ending a BD-J application. This completes the internal structure of the BD-J platform.","The middleware  is an operating system for the embedded software, and is composed of a kernel and a device driver. The kernel provides the BD-J application with a function unique to the playback device, in response to a call for the Application Programming Interface (API) from the BD-J application. The middleware  also realizes controlling the hardware, such as starting the interruption handler by sending an interruption signal.","The mode management module  holds Index.bdmv that was read out from the BD-ROM, built-in medium drive, or removable medium drive, and performs a mode management and a branch control. The management by the mode management is a module assignment to cause either the BD-J platform or the HDMV module to execute the dynamic scenario.","The user event processing unit  receive a user operation via a remote control, and causes the program executing unit  or the playback control unit  to perform a process as instructed by the received user operation. For example, when the user presses a button on the remote control, the user event processing unit  instructs the program executing unit  to execute a command included in the button. For example, when the user presses a fast forward\/rewind button on the remote control, the user event processing unit  instructs the playback control unit  to execute the fast forward\/rewind process onto the AV clip of the currently played-back playlist.","The local storage  includes the built-in medium drive for accessing a hard disc, and the removable medium drive for accessing a semiconductor memory card, and stores downloaded additional contents, data to be used by applications, and other data. An area for storing the additional contents is divided into as many small areas as BD-ROMs. Also, an area for storing data used by applications is divided into as many small areas as the applications.","The nonvolatile memory  is a recording medium that is, for example, a readable\/writable memory, and is a medium such as a flash memory or FeRAM that can preserve the recorded data even if a power is not supplied thereto. The nonvolatile memory  is used to store a backup of the register set .","Next, the internal structure of the system target decoder  and the plane memory set will be described.  shows the internal structure of the system target decoder  and the plane memory set . As shown in , the system target decoder  and the plane memory set include an ATC counter , a source depacketizer , a PID filter , an STC counter , an ATC counter , a source depacketizer , a PID filter , a primary video decoder , a left-view video plane , a right-view video plane , a secondary video decoder , a secondary video plane , a PG decoder , a PG plane , an IG decoder , an IG plane , a primary audio decoder , a secondary audio decoder , a mixer , a rendering engine , and a GFX plane .","The ATC counter  generates an Arrival Time Clock (ATC) for adjusting the operation timing within the playback device.","The source depacketizer , after a source packet is stored in the read buffer , transfers a TS packet of the source packet to the PID filter. More specifically, the source depacketizer  transfers the TS packet to the PID filer according to the recording rate of the AV clip, at the instant when the value of the ATC generated by the ATC counter and the value of the ATS of the source packet become identical. In transferring the TS packet, the source depacketizer  adjusts the time of input into the decoder in accordance with the ATS of the source packet.","The PID filter  transfers, among the TS packets output from the source depacketizer , TS packets having a PID that matches a PID required for playback, to the primary video decoder , the secondary video decoder , the IG decoder , the PG decoder , the primary audio decoder , or the secondary audio decoder .","The STC counter  generates an System Time Clock (STC) for adjusting the operation timing of the decoders.","The ATC counter  generates an Arrival Time Clock (ATC) for adjusting the operation timing within the playback device.","The source depacketizer , after a source packet is stored in the read buffer , transfers a TS packet of the source packet to the PID filter. More specifically, the source depacketizer  transfers the TS packet to the PID filer according to the system rate of the AV clip, at the instant when the value of the ATC generated by the ATC counter and the value of the ATS of the source packet become identical. In transferring the TS packet, the source depacketizer  adjusts the time of input into the decoder in accordance with the ATS of the source packet.","The PID filter  transfers, among the TS packets output from the source depacketizer , TS packets having a PID that matches a PID written in the stream selection table of the current playitem, to the primary video decoder, in accordance with the PID.","The primary video decoder  decodes the left-view video stream, and writes the decoding result, namely, a non-compressed video frame, into the left-view video plane .","The left-view video plane  is a plane memory that can store picture data with a resolution of, for example, 1920\u00d72160 (1280\u00d71440).","The right-view video plane  is a plane memory that can store picture data with a resolution of, for example, 1920\u00d72160 (1280\u00d71440).","The secondary video decoder , having the same structure as the primary video plane, performs decoding of an input secondary video stream, and writes resultant pictures to the secondary video plane in accordance with respective display times (PTS).","The secondary video plane  stores picture data for the secondary video that is output from the system target decoder  as a result of decoding the secondary video stream.","The PG decoder  extracts and decodes a presentation graphics stream from the TS packets input from the source depacketizer, and writes the resultant non-compressed graphics data to the PG plane in accordance with respective display times (PTS).","The PG plane  stores non-compressed graphics object that is obtained by decoding the presentation graphics stream.","The IG decoder  extracts and decodes an interactive graphics stream from the TS packets input from the source depacketizer, and writes the resultant non-compressed graphics object to the IG plane in accordance with respective display times (PTS).","The IG plane  stores non-compressed graphics object that is obtained by decoding the interactive graphics stream.","The primary audio decoder  decodes the primary audio stream.","The secondary audio decoder  decodes the secondary audio stream.","The mixer  mixes the decoding result of the primary audio decoder  with the decoding result of the secondary audio decoder .","The rendering engine  decodes graphics data such as JPEG or PNG that is used by the BD-J application when rendering a menu.","The GFX plane  is a plane memory into which graphics data such as JPEG or PNG is written after it is decoded.","Next, the internal structure of the primary video decoder  will be explained. The primary video decoder  is composed of a TB , an MB , an EB , a TB , an MB , an EB , a video decoder , a buffer switch , a DPB , and a picture switch .","The Transport Buffer (TB)  is a buffer for temporarily storing TS packets containing the left-view video stream, as they are after being output from the PID filter .","The Multiplexed Buffer (MB)  is a buffer for temporarily storing PES packets when the video stream is output from the TB to the EB. When the data is transferred from the TB to the MB, the TS headers are removed from the TS packets.","The Elementary Buffer (EB)  is a buffer for storing video access units in the encoded state. When the data is transferred from the MB to the EB, the PES headers are removed.","The Transport Buffer (TB)  is a buffer for temporarily storing TS packets containing the right-view video stream, as they are after being output from the PID filter.","The Multiplexed Buffer (MB)  is a buffer for temporarily storing PES packets when the video stream is output from the TB to the EB. When the data is transferred from the TB to the MB, the TS headers are removed from the TS packets.","The Elementary Buffer (EB)  is a buffer for storing video access units in the encoded state. When the data is transferred from the MB to the EB, the PES headers are removed.","The video decoder  generates a frame\/field image by decoding each access unit constituting the video elementary stream at predetermined decoding times (DTSs). Since there are a plurality of compress-encoding methods, such as MPEG2, MPEG4 AVC, and VC1, that can be used to compress-encode the video stream that is to be multiplexed into the AV clip, the decoding method of the video decoder  is selected in accordance with the stream attribute. When it decodes the picture data constituting the base-view video stream, the video decoder  performs a motion compensation using the picture data, which exist in the future and past directions, as reference pictures. When it decodes each picture data constituting the dependent-view video stream, the video decoder  performs a motion compensation using the picture data, which constitute the base-view video stream, as reference pictures. After the picture data are decoded in this way, the video decoder  transfers the decoded frame\/field image to the DPB , and transfers the corresponding frame\/field image to the picture switch at the timing of the display time (PTS).","The buffer switch  determines from which of the EB  and the EB  the next access unit should be extracted, by using the decode switch information that was obtained when the video decoder  decoded the video access units, and transfers a picture from either the EB  or the EB  to the video decoder  at the timing of the decoding time (DTS) assigned to the video access unit. Since the DTSs of the left-view video stream and the right-view video stream are set to arrive alternately in units of pictures on the time axis, it is preferable that the video access units are transferred to the video decoder  in units of pictures when decoding is performed ahead of schedule disregarding the DTSs.","The Decoded Picture Buffer (DPB)  is a buffer for temporarily storing the decoded frame\/field image. The DPB  is used by the video decoder  to refer to the decoded pictures when the video decoder  decodes a video access unit such as the P-picture or the B-picture having been encoded by the inter-picture prediction encoding.","The picture switch , when the decoded frame\/field image transferred from the video decoder  is to be written into a video plane, switches the writing destination between the left-view video plane and the right-view video plane. When the left-view stream is targeted, non-compressed picture data is written into the left-view video plane in a moment, and when the right-view stream is targeted, non-compressed picture data is written into the right-view video plane in a moment.",{"@attributes":{"id":"p-0370","num":"0373"},"figref":["FIG. 27","FIG. 27"],"b":["5","5","61","61","61","61","62","32","33","63","64","65","66"],"i":["b","b ","a","b","c ","d "]},"The plane memories include a left-view video plane, a right-view video plane, a secondary video plane, a PG plane, an IG plane, and a GFX plane which are arranged in the stated order. Into the left-view video plane and the right-view video plane, the image data is written alternately at the timing of PTS by the system target decoder . The plane synthesizing unit selects either the left-view video plane or the right-view video plane into which the image data is written at the timing of PTS, and transfers the data from the selected video plane to the superposing process so that it is superposed with the secondary video plane, PG plane, and IG plane.","In this method, different contents are stored into the left-view video plane and the right-view video plane to realize the stereoscopic view. However, not limited to this, even if the same content is stored into the left-view video plane and the right-view video plane, it is possible to realize a pseudo stereoscopic view by assigning different coordinates to the pixels in the left-view video plane and the right-view video plane. Among the above-described plane memories, the PG plane realizes a stereoscopic view by changing the coordinates of pixels in the plane memory. In the following, how the stereoscopic view is realized with the PG plane is described.",{"@attributes":{"id":"p-0373","num":"0376"},"figref":"FIG. 28"},"A description is given of how to synthesize the PG planes, with reference to an example of PG planes shown in . The plane synthesizing unit obtains an offset value that corresponds to the current display time, from one of the offset entries existing in the 3D metadata, the one that corresponds to the PID of the currently played-back presentation graphics. When the image plane to be superposed is the left-view video plane, the plane synthesizing unit shifts the coordinates of the image data stored in the PG plane towards the positive direction of the X axis by the offset value. The plane synthesizing unit then crops the PG plane to prevent it from overlapping with the left-view video plane, and provides it to be synthesized with the other planes (see the upper portion of ).","When the image plane to be superposed is the right-view video plane, the plane synthesizing unit shifts the coordinates of the image data stored in the PG plane towards the negative direction of the X axis by the offset value. The plane synthesizing unit then crops the PG plane to prevent it from overlapping with the left-view video plane, and provides it to be synthesized with the other planes (see the lower portion of ). The IG plane and the secondary video plane are processed in the same manner.",{"@attributes":{"id":"p-0376","num":"0379"},"figref":"FIG. 29"},"This completes the description of the plane synthesizing. Next, a description is given of the internal structure of the register set  and the detail of the playback control engine ",{"@attributes":{"id":"p-0378","num":"0381"},"figref":"FIG. 30","b":["10","7"],"i":"b. "},"The left-hand side of  shows the internal structures of the register set , and the right-hand side shows the internal structures of the playback control engine ","The values stored in the PSRs shown in  are referenced and updated by the movie object and the BD-J object as necessary. As understood from this, the values stored in the PSRs are parameters referenced by the movie object and the BD-J object, and thus are also called system parameters.","First, representative ones among a plurality of PSRs will be described.","PSR is a stream number register for the audio stream, and stores a current audio stream number.","PSR is a stream number register for the PG stream, and stores a current PG stream number.","PSR is set to a value in the range from \u201c1\u201d through \u201c100\u201d to indicate a current title number.","PSR is set to a value in the range from \u201c1\u201d through \u201c999\u201d to indicate a current chapter number; and is set to a value \u201c0xFFFF\u201d to indicate that the chapter number is invalid in the playback device.","PSR is set to a value in the range from \u201c0\u201d through \u201c999\u201d to indicate a current playlist number.","PSR is set to a value in the range from \u201c0\u201d through \u201c255\u201d to indicate a current playitem number.","PSR is set to a value in the range from \u201c0\u201d through \u201c0xFFFFFFFF\u201d to indicate a current playback time point (current PTM) with the time accuracy of 45 KHz.","PSR is a stream number register for the IG stream, and stores a current IG stream number.","PSR indicates whether or not the user intends to perform the stereoscopic playback.","PSR indicates an output mode value.","PSR is used for the setting of \u201cDisplay Capability for Video\u201d. This indicates whether or not a display device connected to the playback device has a capability to perform the stereoscopic playback.","PSR is used for the setting of \u201cPlayer Capability for 3D\u201d. This indicates whether or not the playback device has a capability to perform the stereoscopic playback.","On the other hand, the playback control engine includes a procedure executing unit  for determining the output mode of the current playlist by referring to the PSR, PSR, PSR, PSR, and PSR, and the stream selection table of the current playlist information in the management information memory .","The \u201cPlayer Capability for 3D\u201d stored in PSR means the capability of playback device regarding the 3D playback as a whole. Thus it may be simply denoted as \u201c3D-Capability\u201d.","PSR defines the output mode, and the selection model of the state transition is defined as shown in .",{"@attributes":{"id":"p-0397","num":"0400"},"figref":"FIG. 31"},"The general state is maintained unless a state transition occurs. The state transition is caused by a start of playlist playback, a navigation command, an output mode change requested by a BD-J application, or a jump to a BD-J title. When a state transition occurs, a procedure for obtaining a preferable output mode is executed.","The arrows jm, jm, jm, . . . shown in  represent events that trigger state transitions. The state transitions in  include the following.","The \u201cLoad a disc\u201d means the state in which the BD-ROM has been loaded.","The \u201cStart presentation\u201d means to \u201cstart playlist playback\u201d in the HDMV mode. In the BD-J mode, it means to branch to a BD-J title. This is because, in the BD-J mode, branching to a BD-J title does not necessarily mean that a playlist starts to be played back.","The \u201cJump to BD-J title\u201d means to branch to a BD-J title.","More specifically, it indicates that a title (BD-J title), which is associated with a BD-J application in the index table, becomes a current title.","The \u201cStart Playlist Playback\u201d means that a playlist number identifying a playlist is set to a PSR, and the playlist information is read out onto the memory as the current playlist information.","The \u201cChange Output Mode\u201d means that the output mode is changed when the BD-J application calls the API.","The \u201cTerminate Presentation\u201d, in the HDMV mode, means that a playback of a playlist is completed; and in the BD-J mode, means that a BD-J title jumps to a title (HDMV title) that is associated with a movie object in the index table.","When a disc is loaded, the state of the output mode transits to a temporary state \u201cInitialization\u201d. After this, the state of the output mode transits to the invalid state.","The output mode selection state is maintained to be \u201cinvalid\u201d until the playback start (Start Presentation) is made active. The \u201cStart Presentation\u201d, in the HDMV mode, means that a playlist has been started to be played back; and in the BD-J mode, means that a BD-J title has been started to be played back, and some operation of a BD-J application has been started. It does not necessarily mean that a playlist has been started to be played back.","When Start Presentation is made active, the state of the output mode transits to a temporary state \u201cProcedure when playback condition is changed\u201d The output mode transits to \u201cValid\u201d depending on the result of \u201cProcedure when playback condition is changed\u201d. The output mode transits to \u201cInvalid\u201d when the output mode is effective and Start Presentation is completed.","The navigation command in the movie object should be executed before a playlist starts to be played back because the content provider sets a preferable output mode with the command.","When the navigation command in the movie object is executed, the state transits to \u201cinvalid\u201d in this model.",{"@attributes":{"id":"p-0412","num":"0415"},"figref":"FIG. 32"},"In step S, it is judged whether or not a disc unbound BD-J application is running. In step S, it is judged whether or not the stereoscopic display capability information in PSR indicates \u201cthere is capability\u201d and the initial_output_mode information in Index.bdmv indicates the \u201cstereoscopic output mode\u201d.","When it is judged as Yes in step S, the current output is maintained in step S. When it is judged as No in step S and Yes in step S, the output mode in PSR is set to the stereoscopic output mode in step S. When it is judged as No in step S and No in step S, the output mode in PSR is set to the 2D output mode in step S.",{"@attributes":{"id":"p-0415","num":"0418"},"figref":"FIG. 33","b":["11","22","13","23"]},"When it is judged as Yes in step S, the current output mode is not changed in step S. When it is judged as No in step S and Yes in step S, the current output mode is not changed (step S). When it is judged as No in step S and No in step S, the current output mode is set to the 2D output mode (step S).","What should be taken into account when a playlist starts to be played back is that PES streams that can be played back in respective playitems are defined in the stream selection tables of the respective playitems. For this reason, when the current playitem starts to be played back, first, it is necessary to select an optimum one for playback from among PES streams that are permitted to be played back in the stream selection table of the current playitem. The procedure for this selection is called \u201cstream selection procedure\u201d.",{"@attributes":{"id":"p-0418","num":"0421"},"figref":"FIG. 34","b":["21","21","22","21","23","24","33","24","33","26","27"]},"When it is judged as Yes in either step S or step S, the control goes to step S in which the stream number stored in the stream number register is maintained.","When it is judged as No in both steps S and S, it is determined which ones among a plurality of conditions are respectively satisfied by the PES streams registered in the current STN_table (step S). It is then judged whether or not there are a plurality of PES streams satisfying a same combination of conditions (step S).","When there is only one PES stream satisfying the conditions, the PES stream satisfying the conditions is selected as the current stream (step S).","When there are a plurality of PES streams satisfying a same combination of conditions, a PES stream having the highest priority in the STN_table is selected from among the PES streams plurality of PES streams satisfying the conditions (step S). After this, the selected stream number, corresponding to the stream entry of the PES stream, is written into the PSR as the stream number register (step S).","After the output mode and PES stream that should be played back in the current playitem are determined through the above-described procedures, it is necessary to start playing back the current playitem. The procedure for playing back the current playitem corresponds to the output mode that has been determined through the Procedure when playback condition is changed. The following is the description of the procedure for playing back the playitem which corresponds to the output mode, with reference to .",{"@attributes":{"id":"p-0424","num":"0427"},"figref":"FIG. 35"},"In step S, it is judged whether or not the current output mode is the 3D output mode. When the current output mode is the 2D output mode, the current playitem number is initialized to \u201c1\u201d in step S, and then a loop constituted from steps S through S is performed.","In this loop, the process of steps S through S is performed onto the current playitem, and then the current playitem number is incremented (step S). The loop is repeated until the last current playitem number is detected (Yes in step S). The steps S through S are performed as follows.","In step S, the TS file, which is identified by: \u201cxxxxx\u201d described in Clip_information_file_name of the current playitem; and extension \u201cm2ts\u201d, is opened. In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the current playitem are converted into \u201cStart_SPN[i]\u201d and \u201cEnd_SPN[i]\u201d by using the entry map corresponding to the packet ID of the video stream.","In step S, the Extents belonging to the reading range [i] are identified to read out the TS packet with PID [i] from the Start_SPN[i] to the End_SPN[i]. In step S, the BD drive is instructed to continuously read out the Extents belonging to the reading range [i].","When the current output mode is the stereoscopic output mode (Yes in step S), the current playitem number is initialized to \u201c1\u201d in step S, and then a loop constituted from steps S through S is performed.","In this loop, the process of steps S through S is performed onto the current playitem, and then the current playitem number is incremented (step S). The loop is repeated until the last current playitem number is detected (Yes in step S). The steps S through S are performed as follows.","In step S, the transport stream file, which is identified by: \u201cxxxxx\u201d described in the Clip_information_file_name of the current playitem; and extension \u201cssif\u201d, is opened. In step S, either the left-view or right-view video stream that is specified by the left-view\/right-view identification information of the current playitem information is set to the base-view video stream. The left-view or right-view video stream that is not set to the base-view video stream is set to the dependent-view stream.","In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the current playitem are converted to \u201cStart_SPN[i]\u201d and \u201cEnd_SPN[i]\u201d by using the entry map corresponding to the packet ID of the base-view video stream.","In step S, the sub-playitem corresponding to the dependent-view stream is identified. In step S, the \u201cIn_time\u201d and \u201cOut_time\u201d of the identified sub-playitem are converted into \u201cStart_SPN[j]\u201d and \u201cEnd_SPN[j]\u201d by using the entry map [j] corresponding to the packet ID [j] of the dependent-view stream.","The Extents belonging to the reading range [i] are identified to read out the TS packet having the packet ID [i] from \u201cStart_SPN[i]\u201d to \u201cEnd_SPN[i]\u201d (step S). The Extents belonging to the reading range [j] are identified to read out the TS packet having the packet ID [j] from \u201cStart_SPN[j]\u201d to \u201cEnd_SPN[j]\u201d (step S). Following this, in step S, the Extents belonging to the reading ranges [i] and [j] are sorted in the ascending order. In step S, the BD drive is instructed to continuously read out the Extents belonging to the reading ranges [i] and [j] using the sorted addresses.","In the HDMV mode, when playback of a playlist stops, nothing is displayed on the screen, while in the BD-Jmode, even if playback of a playlist stops, something may be displayed on the screen because the BD-J application can perform the screen rendering. In such a case, a mismatch will occur if the BD-J application performs the screen rendering for the planar view while the playback control engine side realizes the stereoscopic view.","After a playlist starts to be played back, it is necessary to convert the menu or graphics to 3D or 2D, depending on whether the playlist provides 3D images or 2D images. In view of this, in the present embodiment, the middleware outputs an event to the BD-J application to urge the screen rendering for the stereoscopic viewing.","Here, a description is given of a mechanism for notifying a program, which is recorded on a disc and is running on the playback device, with the timing at which a switch occurs between a 2D image and a 3D image.","According to the state transition shown in , when a playlist starts to be played back during a playback of a BD-J title, the \u201cProcedure when playback condition is changed\u201d is executed. When this happens, the start of the playlist must be notified to the BD-J application by some means.  shows how to notify the BD-J application of the start of the playlist.",{"@attributes":{"id":"p-0439","num":"0442"},"figref":"FIG. 36"},"The first row of  shows the GUI rendered by the BD-J application. The third row shows the state of the playback control engine. The second row shows the HscreenConfiguration event that is output from the middleware to the BD-J application.","According to the third row of , the state of the playback control engine changes as: \u201cPause\u201d\u2212>\u201cPlayback of 3D playlist\u201d\u2212>\u201cPause\u201d. Also, the HscreenConfiguration event indicating the 3D start is output at the timing when the state of the playback control engine changes from \u201cPause\u201d to \u201cPlayback of 3D playlist\u201d, and the HscreenConfiguration event indicating the 3D end is output at the timing when the state of the playback control engine changes from \u201cPlayback of 3D playlist\u201d to \u201cPause\u201d.","As shown in the first row of , the GUI that is rendered by the BD-J application while the playback control engine pauses is the 2D GUI. On the other hand, the GUI that is rendered by the BD-J application while the 3D playlist is played back is the 3D GUI. This is because the BD-J application changes the GUI targeted for the rendering, in response to the output of the event.","Next is a description of a case in which the playback control engine changes the target of playback from a 2D playlist to a 3D playlist in the middle of the playback, a case different from the above-described one in which a playback is started after a pause.  shows what event is output to the BD-J application when the state of the playback control engine changes from \u201cPlayback of 2D playlist\u201d to \u201cPlayback of 3D playlist\u201d.","The first row of  shows the GUI rendered by the BD-J application. The third row shows the state of the playback control engine. The second row shows the HscreenConfiguration event that is output from the middleware to the BD-J application.","According to the third row of , the state of the playback control engine changes as: \u201cPlayback of 2D playlist\u201d->\u201cPlayback of 3D playlist\u201d->\u201cPlayback of 2D playlist\u201d. Also, the HscreenConfiguration event indicating the 3D start is output at the timing when the state of the playback control engine changes from \u201cPlayback of 2D playlist\u201d to \u201cPlayback of 3D playlist\u201d, and the HscreenConfiguration event indicating the 3D end is output at the timing when the state of the playback control engine changes from \u201cPlayback of 3D playlist\u201d to \u201cPlayback of 2D playlist\u201d.","As shown in the first row of , the GUI that is rendered by the BD-J application while the playback control engine plays back the 2D playlist is the 2D GUI. On the other hand, the GUI that is rendered by the BD-J application while the 3D playlist is played back is the 3D GUI. This is because the BD-J application changes the GUI targeted for the rendering, in response to the output of the event.","Next is a description of a case in which the user instructs the playback device to change the subtitle or audio while the playback control engine plays back a 3D playlist. In this case, the stream targeted for the playback is changed. The following describes the case of changing the stream, with reference to .",{"@attributes":{"id":"p-0448","num":"0451"},"figref":"FIG. 38"},"The first row of  shows the GUI rendered by the BD-J application. The third row shows the state of the playback control engine. The second row shows the HscreenConfiguration event that is output from the middleware to the BD-J application.","According to the third row of , the state of the playback control engine is the playback of 3D playlist, but during which a switch occurs between streams. Also, the HscreenConfiguration event is output at the timing when a switch occurs from a first stream to a second stream, and at the timing when a switch occurs from the second stream to the first stream.","As shown in the first row of , the GUI that is rendered by the BD-J application while the playback control engine plays back the 3D playlist is the 3D GUI.","When a playback of a 3D image is started or ended at the timing when the playitem or the playlist changes, or at the timing when the user changes the stream, an event is output. This makes it possible to detect the timing at which a switch occurs between a 2D image and a 3D image and to change the menu graphics to an appropriate one.","As described above, according to the present embodiment, when the output mode of the playback device is the stereoscopic playback mode, Extents constituting a transport stream file in the interleave format, which is identified by a combination of (i) the Clip_Information_file_name included in the playlist information and (ii) an extension indicating that it is a transport stream file in the interleave format, are read out and played back. This allows Extents constituting a transport stream file in the interleave format to be read out and played back only when the output mode is set to the stereoscopic playback mode. With this structure, 2D playback devices cannot read out Extents constituting a transport stream file in the interleave format. This prevents the 2D playback devices from suffering from an erroneous operation or an unstable operation due to the change of the ATS value unique to the transport stream file in the interleave format, namely the repetitive, irregular change of the ATS value of increase and decrease.","Also, it is possible to preliminarily describe a predetermined piece of file reference information in the playlist information so as to readout and play back, in the 3D playback, a stream file in the interleave format having (i) a file name that is the same as the predetermined piece of file reference information and (ii) an extension indicating that it is a transport stream file in the interleave format, and in the 2D playback, a transport stream file having (i) a file name that is the same as the predetermined piece of file reference information and (ii) an extension indicating that it is normal-format transport stream file. This eliminates the need for creating respectively the 3D playlist information and the 2D playlist information, thus reducing the trouble of authoring. The reduction in the trouble of authoring will contribute to the production of enhanced movie works for the stereoscopic viewing.","Embodiment 2 describes the functions and the internal structures of a display device  and 3D glasses  with reference to .","Part (a) of  shows the internal structure of the display device . As shown in , the display device  includes a tuner , an HDMI transmission\/reception unit , a message storage unit , a display control unit , a display panel , and a wireless transmission unit .","The tuner  receives a multi-channel transport stream transmitted by the digital terrestrial broadcasting or the satellite digital broadcasting, and demodulates the received multi-channel transport stream. In so doing, the tuner  can select a plurality of channels simultaneously and output non-compressed pictures.","The HDMI transmission\/reception unit  receives non-compressed, synthesized picture data transmitted from the playback device via the HDMI.","The message storage unit  stores a warning message which is to be displayed in place of a picture.","The display control unit  performs a control to display the non-compressed pictures obtained as a result of demodulation by the tuner , and performs a control to display the non-compressed, synthesized pictures transmitted from the playback device via the HDMI. In displays, the display control unit  can change the display periods with the time accuracy of 1\/120 seconds or 1\/140 seconds. With use of the time accuracy, it is possible to divide, for example, the display period of 1\/24 seconds into smaller display periods such as 1\/48 seconds, 1\/72 seconds, and 1\/92 seconds.","The display panel  is a device that emits light in units of pixels by driving the liquid crystal display elements, plasma light-emitting elements, or organic EL elements, and displays non-compressed picture data under control of the display control unit .","The wireless transmission unit  controls the 3D glasses  by the infrared communication method or the wireless LAN method. More specifically, the wireless transmission unit  transmits a sync signal that urges the state transition of the 3D glasses , at the beginning of each display period in each of the 3D mode and the multi-channel mode. The repetitive transmissions of the sync signal cause the 3D glasses  to transit to the light transmission state in the left-view period, to the light block state in the right-view period, and to the light transmission state in the left-view period, for example. The state of the 3D glasses  changes as shown in .","In the present embodiment, as a process for the 3D mode, the display control unit  divides the display period of 1\/24 seconds into three smaller display periods (display periods 1\/3, 2\/3, and 3\/3) each having a time length of 1\/72 seconds, and displays different contents in the three smaller display periods 1\/3, 2\/3, and 3\/3, respectively. For example, the left view is displayed in the first display period 1\/3, the right view is displayed in the second display period 2\/3, and a warning message is displayed in the third display period 3\/3. At the beginning of each of the display periods, a sync signal is transmitted to the glasses so that the state of the left view and right view transits.","As a process for the multi-channel mode, the display device  demodulates a plurality of channels by the time division. And the display control unit  divides the display period of 1\/24 seconds into two smaller display periods (display periods 1\/2 and 2\/2) each having a time length of 1\/48 seconds, and displays different contents in the two smaller display periods 1\/2 and 2\/2, respectively. For example, the channel 1 is displayed in the first display period 1\/2 and the channel 2 is displayed in the second display period 2\/2. When a display period of a certain channel arrives, the glasses of the user who desires to view the certain channel are caused to transit to the light transmission state, and the glasses of the user who desires to view another channel are caused to transit to the light block state.","Part (b) of  shows the internal structure of the 3D glasses .","The 3D glasses  include a wireless reception unit  for receiving sync signals, which trigger the state transition, from the display device , a state control unit  causing the state of the liquid crystal shutters to transit between the light transmission state and the light block state, and liquid crystal shutters  and .","The glasses also have operation modes: 3D mode; and multi-channel mode.","In the 3D mode, the glasses can transit to the light-block-block state, as well as to the light transmission state and the light block state. The light-block-block state is a state in which both the left view and the right view are closed.","In the multi-channel mode, the glasses transit between the light-transmission-transmission state in which both the left view and the right view are opened, and the light-block-block state in which both the left view and the right view are closed.","To realize the stereoscopic display, the present embodiment not only switches between the left view and the right view of the glasses, but also displays a warning message to urge wearing of the 3D glasses , preventing the user who has already wearing the 3D glasses from seeing the message. Now, a description is given of how to control the 3D glasses  to prevent the user who has already wearing the 3D glasses from seeing the message, with reference to .",{"@attributes":{"id":"p-0471","num":"0474"},"figref":["FIG. 40","FIG. 40"]},"In the last display period 3\/3 among the three display periods of 1\/72 seconds obtained by dividing the display period of 1\/24 seconds, the user who is wearing the glasses cannot see the warning message displayed on the screen. The message \u201cWear 3D glasses\u201d displayed on the screen can only be seen by users who are not wearing the glasses, but cannot be seen by users who are wearing the glasses. In this way, a message suitable for the situation is displayed.","In the multi-channel display, the display device uniquely control the shutters equipped with the two pairs of glasses, not merely switching between the left and right shutters. The unique control will be described with reference to .",{"@attributes":{"id":"p-0474","num":"0477"},"figref":["FIG. 41","FIG. 41"]},"Within each display period of 1\/24 seconds, in the first display period 1\/2, the glasses worn by the user 1 are in the light-transmission-transmission state, and the user 1 can view Channel 1 (ch1).","In the first display period 1\/2, the glasses worn by the user 2 are in the light-block-block state, and the user 2 cannot view Channel 1 (ch1).","In the second display period 2\/2, the glasses worn by the user 1 are in the light-block-block state, and the user 2 cannot view Channel 2 (ch2). In the second display period 2\/2, the glasses worn by the user 2 are in the light-transmission-transmission state, and the user 2 can view Channel 2 (ch2). With this usage, two persons can watch different channels simultaneously on one screen.","Also, each person wearing a pair of 3D glasses can use an earphone embedded in the glasses to independently enjoy the video and audio. This expands the application: for example, preventing a fight over favorite channel in the living room; and playing a versus game on one screen. Also, increasing the steps will make it possible to display three or more channels on one screen.","As described above, with the present embodiment, a plurality of users viewing the display device can view different, desired channels respectively, by wearing the 3D glasses . Since the users can watch their favorite programs respectively even if there are not as many display devices as the users, it is possible to use efficiently the living room of the users' home.","Embodiment 3 relates to negotiation between the playback device and the display device. Because the home theater systems built in the users' homes are unique to each other, it is necessary for the playback device to negotiate with the display device when they are connected, to determine what playlist should be prepared for the playback.","Embodiment 3 describes an improvement of simultaneously outputting digital data for 3D and analog data for a conventional display device.","With respect to BD-ROMs storing 3D images, consideration should be taken so that they are normally played back in 2D playback devices which are already widespread and there are enormous number of them. One of the methods for realizing it is to control it by the program on the BD-ROM, as described in Embodiment 1. However, a bug in the program may lead to an incorrect selection, causing an inappropriate image to be played back. This may damage the user's health or place such an excessive burden on the playback device to destroy it. Therefore, some mechanism is required to prevent a playback of an inappropriate image.","The following describes the connection with a 2D TV.","In the first place, conventional analog devices do not support 3D images, and thus cannot output 3D images. In view of this, while the playback device is playing back a 3D image, a message such as \u201c3D image is currently provided. Please watch this on a 3D-supporting display\u201d is displayed through an analog output to let the user know that he\/she is connecting with a wrong terminal or a display device that does not support 3D images. It is further preferable that after this, the playback is automatically switched to a 2D playlist when the display device connected to the playback device is a 2D display device.","Next, a description is given of the case where a 2D display device and a 3D display device are connected to the playback device, and image signals are output to these display devices simultaneously. When a 2D display device and a 3D display device are connected to the playback device, and image signals are output to them simultaneously, either the left-view or right-view of the 3D image is output to the 2D display device.","What is called 2D output priority image information is information that defines which of the left-view and right-view video streams is to be output for the analog display when image signals of the playlist are output simultaneously. The 2D output priority image information is provided preliminarily in the playlist, and images signals are output to the 2D display device and the 3D display device simultaneously in conformance with the 2D output priority image information in the current playlist. With this structure, it is possible to output image signals simultaneously to the two display devices even if 2D and 3D images cannot be decoded simultaneously or even if 2D and 3D playlists are not used independently.","Similarly, when an OSD (system built-in menu) display is performed, a 3D-supporting OSD display is performed on the 3D display device, and a 2D image dedicated to the 2D display device or only the left view or the right view is output to the output such as the analog output that supports only the 2D.","When it is difficult to perform outputs for the 3D and the 2D, it is preferable that a sub-display unit is provided on the remote control, and the images are displayed on the sub-display unit.","These will be described in more detail with reference to .  shows a connection format between the playback device and the display device. The upper part of  shows a display device with an analog connection. The lower-left part shows a display device  that supports the 3D and is digitally connected, and the lower-right part shows a 2D display device  that is digitally connected.","When the playback device is connected with the 3D display device and the 2D display device, the playback device tries to negotiate with these display devices. When the playback device finds out that it cannot negotiate with a display device since it is connected analog with the display device, it plays back either the left-view or right-view video stream that is indicated in the 2D output priority image information. With this arrangement, when the playback device is connected analog with a display device, it is possible to play back a playlist that a person in charge of authoring intends to play back.","On the other hand, when the playback device is connected with two display devices digitally and the negotiation is successful, the playback device checks whether each of the display devices is a 3D display device or a 2D display device.","When it is found by the negotiation that the display device connected with the playback device is a 2D display device, the playback device causes the 2D display device to display the message and image as indicated by the arrow mg shown in .","The arrow mg indicates the transition of the contents displayed on the screen of the 2D display device. In the case of the digital connection, a message \u201c3D image is currently provided. Please watch this on a 3D-supporting display\u201d is displayed, and then a 2D image is displayed.","Also, in the negotiation, it is necessary to switch among a plurality of right-views. One of the reasons for this is the difference in size among the display devices. Each person is considered to have a similar distance between the left and right eyes even when the individual variability is taken into account. In contrast, display devices vary in size, for example, from a 20-inch size to 150-inch size. For example, when a user views an image, that was created assuming a 50-inch size display device and a distance of 6.5 cm between the eyes, on a 150-inch size display device, the distance between the eyes suitable for recognizing the image as a 3D image becomes triple and should be 19.5 cm. In view of this, various combinations of a left view video stream and a right view video stream may be stored in correspondence with various sizes of the display devices, so that the difference of 6.5 cm between the left view and the right view can be obtained in each of the various sizes of the display devices. With this structure, it is possible to select an optimum combination of a left view video stream and a right view video stream for any size of the display device.","There are various sizes of display devices such as 150-inch and 50-inch. Even if they have the same number of pixels in the horizontal direction, the distance on the screen is different among them. This will be described with reference to .",{"@attributes":{"id":"p-0496","num":"0499"},"figref":"FIG. 43"},"On the left-hand side of , combinations of a right-view picture and a left-view picture are shown, where the combinations have different offsets in the horizontal direction.","In the middle column of , distances on the screen of a 50-inch display are shown. On the right-hand side of , distances on the screen of a 150-inch display are shown. As shown in the drawing, when the difference between the right and left pictures in the horizontal direction is 50 pixels, the distances on the screen of the 50-inch display is 2.0 cm, and the distances on the screen of the 150-inch display is 6.0 cm.","When the difference between the right and left pictures in the horizontal direction is 100 pixels, the distances on the screen of the 50-inch display is 4.0 cm, and the distances on the screen of the 150-inch display is 12.0 cm.","When the difference between the right and left pictures in the horizontal direction is 150 pixels, the distances on the screen of the 50-inch display is 6.0 cm, and the distances on the screen of the 150-inch display is 18.0 cm.","Since 6.0 cm is the optimum distances on the screen of both the 50-inch and 150-inch displays, the 3D Stream Depth Change UO or the 3D Stream Depth Change command is used to change the distance displayed on the screen.","The program can automatically select an optimum combination of the left and right views by using the method for obtaining the screen sizes of display devices, described above with reference to . With this structure, the user does not need to be concerned about the screen size since an optimum stream is automatically selected.","When a plurality of streams with different depths are recorded in correspondence with different screen sizes, streams with different pixel differences of the local storage may be recorded in the recording medium, and the user itself may select a depth by using a UO or a command for switching among the streams","As described up to now, according to the present embodiment, when the playback device is connected with a display device, it is ensured that a more appropriate playback output is performed in terms of the relationship with the display device.","Embodiment 4 relates to an improvement of selecting PG and IG streams appropriately for a corresponding video stream for the stereoscopic viewing.","The image to be played back in the 2D playback device is a 2D image, and the corresponding subtitle and menu image are 2D. Similarly, the image to be played back in the 3D playback device is a 3D image, and it is preferable that the corresponding subtitle and menu image are also 3D. This is because when a 2D PG or a 2D IG is displayed together with a corresponding 3D image, the special composition would be different from what was originally intended. When this happens, the user becomes unable to recognize the space normally, and may injure his\/her health in the worst case.","Also, even when using a 3D playback device, the user has an option to select a 2D image. In that case, the corresponding subtitle or menu image should be automatically changed from 3d to 2D.","A combination of a 2D image and a subtitle or the like and a combination of a 3D image and a subtitle or the like may be selected by a program. However, by preliminarily storing information that indicates such combinations, it is also possible for the playback device to exclude inappropriate combinations. The mechanism for realizing this will be described in the following.","As described in Embodiment 1, the playlist for 3D includes the STN_table for 2D and the STN_table_SS for 3D, which are divided from the stream selection table. Further, the image, audio, PG, and IG streams that are used only in the 2D playbacks and those used only in the 3D playbacks are registered in different entry groups. When a 2D image is selected, the audio, PG, and IG having been prepared for 3D cannot be selected. Similarly, when a 3D image is selected, the audio, PG, and IG having been prepared for 2D cannot be selected.","It is also possible to divide the management table further so as to manage independently the left view and the right view, from the stream registration of the title\/menu image that are associated with the left view and the right view.","A PG stream created for 2D differs from a PG stream created for 3D in the presence of depth, position, and angle. Therefore, the person in charge of authoring must prevent that, while a 3D video stream is played back, a PG stream for 2D is selected and played back together with the 3D video stream.","To prevent this, stream combination information is included in the STN_table_SS.  show an example of how the stream combination information is written to indicate combinations of a video stream and a PG stream.","As shown in , the stream combination information in the stream selection table permits the video stream number \u201c1\u201d to be combined with the PG stream numbers \u201c1\u201d and \u201c2\u201d.","Also, the stream combination information in the stream selection table permits the video stream number \u201c2\u201d to be combined with the PG stream numbers \u201c1\u201d and \u201c2\u201d. Further, the stream combination information permits the video stream number \u201c3\u201d to be combined with the PG stream numbers \u201c3\u201d and \u201c4\u201d, and permits the video stream number \u201c4\u201d to be combined with the PG stream numbers \u201c3\u201d and \u201c4\u201d.",{"@attributes":{"id":"p-0515","num":"0518"},"figref":["FIG. 44B","FIG. 44A"]},"The left-hand side of  shows video streams with video stream numbers \u201c1\u201d to \u201c4\u201d. Of these, video streams with video stream numbers \u201c1\u201d and \u201c2\u201d are for 2D, and video streams with video stream numbers \u201c3\u201d and \u201c4\u201d are for 3D.","The right-hand side of  shows PG streams with PG stream numbers \u201c1\u201d to \u201c4\u201d. Of these, PG streams with PG stream numbers \u201c1\u201d and \u201c2\u201d are for 2D, and PG streams with video stream numbers \u201c3\u201d and \u201c4\u201d are for 3D.","The solid lines kw to kw connecting the video streams with the PG streams schematically indicate the permitted combinations of a video stream and a PG stream that are defined in the stream combination information. As indicated schematically by the solid lines, 2D images cannot be combined with 3D subtitles, nor are combined 3D images with 2D subtitles. Also, certain permitted combinations may be omitted intentionally.","With the above-described structure in which the stream combination information preliminarily indicates combinations of a video stream and a PG stream, and when a video stream is selected, a PG stream for the video stream is selected in accordance with the stream combination information, it is possible to ensure that a PG stream optimum for a video stream is selected.",{"@attributes":{"id":"p-0520","num":"0523"},"figref":["FIG. 45","FIG. 45"]},"In step S, a video stream number is obtained. In step S, a PG stream number is obtained. In step S, it is judged whether or not the combination of the video stream and the PG stream is registered in the stream combination information. When the combination is registered, the combination is played back in step S. When the combination is not registered, another PG stream combined with the video stream in the registered combination according to the stream combination information is selected and played back.","As described in the beginning of Embodiment 1, there are various principles for realizing the stereoscopic view, and accordingly stereoscopic products that are and will be on the market are considered to be made based on various 3D systems. Also, since each display device supports a predetermined 3D system, it is preferable that the playback device has system parameters indicating a plurality of 3D systems. The present embodiment deals with, for example, the following 3D playback systems: the two-screen stereo playback system in which videos for two screens are sent independently; the side-by-side system; the horizontally double system; and the 2D+depth information system. When there are other 3D systems that can be supported by display devices, the bit assignment to the PSRs is determined to be able to indicate whether or not the other 3D systems can be used.",{"@attributes":{"id":"p-0523","num":"0526"},"figref":"FIG. 46"},"The PSR shown in  is composed of four bits (b, b, b, and b). Each of the bits, from the most significant bit b to the least significant bit b, is associated with a corresponding 3D playback system. When the playback device supports the 3D playback system, the corresponding bit is set to \u201c1\u201d, and when the playback device does not support, the bit is set to \u201c0\u201d. When all the bits of PSR are \u201c0\u201d, the playback device is a 2D playback device; and when one or more of the bits are \u201c1\u201d, the playback device is a 2D\/3D playback device that supports the corresponding 3D playback systems.","The bits constituting the PSR, from the most significant bit b to the least significant bit b, respectively indicate where or not the playback device supports, as the 3D display system, the two-screen stereo playback system, the side-by-side system, the horizontally double system, and the 2D+depth information system.","The two-screen stereo playback system is the 3D display system that has been described so far in the embodiments.","The side-by-side system is a system in which the resolution of 1920\u00d71080 is divided into 960\u00d71080 and 960\u00d71080, and the left view and the right view are displayed with these resolutions, respectively.","The horizontally double system is a system in which the resolution of 1920\u00d71080 is converted divided into 3840\u00d71080, and each of the left view and the right view is displayed with the resolution of 1920\u00d71080.","The 2D+depth information system is a system for realizing the stereoscopic view by a 2D image and a gray-scale image. The gray-scale image is composed of binarized pixels. The brightness of the binarized pixels indicates the depth of each pixel in the 2D image. The depths of the pixels constituting the 2D image are created based on the brightness of the binarized pixels, and then a stereoscopic image is built.","When a BD-J application on the BD-ROM is to access the values of the player setting register, it can also access these as a system property of the playback device.","When the display device is connected with the playback device by a transmission system such as HDMI in which the performance\/supporting system of display device can be transmitted to the playback device, the values of the PSR are automatically set in correspondence with the performance of the playback device and the system supported by the display device. In this case, the values of the PSR vary depending on the display device connected to the playback device even if the playback device is the same.","When the display device cannot transmit the performance of the own device, it is preferable that the user set it manually.","When the playback device can obtain the supporting system of the display device, the playback device may obtain further information on the 3D playback such as the size of the display device, resolution, and a distance between the screen of the display device and the viewer, and store the obtained information in the PSR. The information can be used when the program selects an optimum playback system.","There may be a case where how the 3D is supported cannot be represented by one bit. In that case, a plurality of bits should be used. For example, when it is recognized that up to the image size of 1920\u00d71080 can be supported, but that a playback is not available for a higher resolution due to insufficient performance of the decoder or the like, two bits may be adopted so that, for example, \u201c00b\u201d represents a non-support; \u201c01b\u201d represents a support of up to 1920\u00d71080; and \u201c10b\u201d represents a support of higher than 1920\u00d71080. This makes it possible to indicate the supporting state in more detail by using the system parameter.","It is possible, by defining a bit assignment to the PSRs covering a plurality of 3D systems, to use any display device to realize a stereoscopic playback, regardless of the 3D system that is supported by the display device connected with the playback device.  shows how the 3D playback system supported by the display device is reflected on the setting register of the playback device. With use of a system parameter representing \u201c3D-Capability\u201d that indicates the 3D playback capability that has been described earlier, it is possible to inhibit the 2D playback device from selecting a 3D video stream. When the user is to select a 3D video stream at the beginning of a program or a playitem, it can be judged whether or not the to-be-selected stream can be played back by the playback device, by referring to the player setting register to confirm the 3D system supported by the playback device, and obtaining the information of the to-be-selected stream from the stream selection table.","Since 2D playback devices cannot play back 3D images, this process prevents the selection itself, and can prevent an inappropriate image from being displayed on the screen.","When this arrangement is combined with the mechanism of automatically obtaining the 3D system supported by the display device that is described in the previous embodiment, the selection is limited to either a stream of the 3D system supported by the display device connected with the playback device, or a 2D stream. This also prevents an inappropriate image from being displayed on the screen.","The following describes the process of the program when the above-described process is realized.","The BD program file, which is executed after a title is selected by the user, checks whether the playback device supports the 3D image playback, and if so, whether the user has selected the 3D image playback, and according to the check results, switches to a playlist to be played back.","When a plurality of 3D playback systems should be supported, playlists corresponding to the to-be-supported 3D playback systems are prepared. And then, when the playback device supports a playlist stored in the BD-ROM, a 3D playlist corresponding to the supported playlist is selected, and when the playback device does not support a playlist stored in the BD-ROM, a 2D playlist is selected.","Next is a description of the structure of the FirstPlay title.","A playlist constituting the FirstPlay title, namely, a playlist that is played back when the disc is inserted into the device, should be a 2D image in any playback device without fail, for the sake of safety.","A program stored in the BD-ROM is created on the authoring side, and when the playback device supports a plurality of 3D formats, which among the 3D playback systems has a priority to be selected depends on the intention of the authoring side.","Here, the selection of a 3D playlist will be described.","For example, when \u201c3D system 1\u201d is the two-screen stereo playback system and \u201c3D system 2\u201d is the side-by-side system, and the playback device supports only the side-by-side system, the program selects a 3D playlist \u201c00005.mpls\u201d conforming to the side-by-side system that can be played back by the playback device, and plays back the selected 3D playlist.","The following describes the relationships between Index.bdmv and the program.","As shown in , the 3D playback system is reflected on the setting register of the playback device, and the program stored in the BD-ROM is run. This enables the person in charge of authoring to set a 3D system that is optimum for the playback device and the display device, to the setting register of the playback device. To realize such a selection of a 3D playback system, the index table and the BD program file are set as follows.",{"@attributes":{"id":"p-0548","num":"0551"},"figref":"FIG. 48"},"The left-hand side of  shows the index table and the mode management module  that decodes the index table. As described above, the index table includes entries that respectively correspond to the FirstPlay title, top menu, title , title , and title .","The right-hand side of  shows four playlist files that are selectively played back in accordance with the setting of the output mode in the playback device.","The four playlist files are: \u201c00001.mpls\u201d, \u201c00003.mpls\u201d describing the 2D image playback paths; \u201c00004.mpls\u201d describing the playback path by the 3D system 1; and \u201c00005. mpls\u201d describing the playback path by the 3D system 2.","The middle part of  shows two movie objects: \u201cmovie object #\u201d and \u201cmovie object #\u201d.","The movie object # instructs to play back \u201c00001.mpls\u201d. The \u201c00001.mpls\u201d defines a 2D playlist. This is because the playlist to be played back by the FitstPlay title needs to be played back in any output mode.","The movie object # instructs to play back \u201c00004.mpls\u201d when the \u201c3D-Capability\u201d indicated in the PSR is the 3D system 1, and instructs to play back \u201c00005.mpls\u201d when the \u201c3D-Capability\u201d indicated in the PSR is the 3D system 2, and instructs to play back \u201c00003.mpls\u201d when the \u201c3D-Capability\u201d does not match any 3D system. The arrows pp, pp, and pp shown in  schematically show the playlist playback instructions issued by the movie objects.","The arrows my and my shown in  indicate that these movie objects are subjected to the decoding by the HDMV module . The figure shows that, when the HDMV module  executes these movie objects, the above-mentioned three playlist files are selectively subjected to the playback, depending on the \u201cCapability\u201d of the playback device.","When PG streams that can be combined with the video stream are preliminarily defined in the stream combination information, the stream selection procedure conforms to the flowchart shown in .",{"@attributes":{"id":"p-0557","num":"0560"},"figref":"FIG. 49","b":["81","82","83","83","84","83","85"]},"Embodiment 6 describes a recording device for performing the recording method described in Embodiment 1.","When the recording method is to be realized by the real-time recording technology, the recording device for performing the recording method creates an AV clip in real time, and stores the AV clip into the BD-RE, BD-R, hard disk, or semiconductor memory card.","In this case, the AV clip may be a transport stream that is obtained as the recording device encodes an analog input signal in real time, or a transport stream that is obtained as the recording device partializes a digital input transport stream.","The recording device for performing the real-time recording includes: a video encoder for obtaining a video stream by encoding a video signal; an audio encoder for obtaining an audio stream by encoding an audio signal; a multiplexor for obtaining a digital stream in the MPEG2-TS format by multiplexing the video stream, audio stream and the like; and a source packetizer for converting TS packets constituting the digital stream in the MPEG2-TS format into source packets. The recording device stores an MPEG2 digital stream having been converted into the source packet format, into an AV clip file, and writes the AV clip file into the BD-RE, BD-R, or the like. When the digital stream is written, the control unit of the recording device performs a process of generating the clip information and the playlist information in the memory. More specifically, when the user requests a recording process, the control unit creates an AV clip file and an AV clip information file in the BD-RE or the BD-R.","After this, when the starting position of GOP in the video stream is detected from the transport stream which is input from outside the device, or when the GOP of the video stream is created by the encoder, the control unit of the recording device obtains (i) the PTS of the intra picture that is positioned at the start of the GOP and (ii) the packet number of the source packet that stores the starting portion of the GOP, and additionally writes the pair of the PTS and the packet number into the entry map of the clip information file, as a pair of EP_PTS entry and EP_SPN entry. After this, each time a GOP is generated, a pair of EP_PTS entry and EP_SPN entry is written additionally into the entry map of the clip information file. In so doing, when the starting portion of a GOP is an IDR picture, an \u201cis_angle_change\u201d flag having been set to \u201cON\u201d is added to a pair of EP_PTS entry and EP_SPN entry. Also, when the starting portion of a GOP is not an IDR picture, an \u201cis_angle_change\u201d flag having been set to \u201cOFF\u201d is added to a pair of EP_PTS entry and EP_SPN entry.","Further, the attribute information of a stream in the clip information file is set in accordance with the attribute of the stream to be recorded. After the clip and the clip information are generated and written into the BD-RE or the BD-R, the playlist information defining the playback path via the entry map in the clip information is generated and written into the BD-RE or the BD-R. When this process is executed with the real-time recording technology, a hierarchical structure composed of the AV clip, clip information, and playlist information is obtained in the BD-RE or the BD-R.","This completes the description of the recording device for performing the recording method by the real-time recording. Next is a description of the recording device for performing the recording method by the pre-format recording.","The recording device described here is used by the authoring staff in a production studio for distributing movie contents. The use form of the recording device of the present invention is as follows: a digital stream representing a movie title is generated by compress-encoding in compliance with the MPEG standard, a scenario describing how the movie title should be played is generated, and a volume bit stream for BD-ROM including these data is generated.",{"@attributes":{"id":"p-0566","num":"0569"},"figref":["FIG. 50","FIG. 50"],"b":["501","502","503","504","505","506"]},"The video encoder  generates left-view and right-view video streams by encoding left-view and right-view non-compressed bit map images in accordance with a compression method such as the MPEG4-AVC or the MPEG2. In so doing, the right-view video stream is generated by encoding frames that correspond to the left-view video stream, by the inter-picture prediction encoding method. In the process of the inter-picture prediction encoding, the depth information for 3D image is extracted from the motion vectors of the left-view and right-view images, and the depth information is stored into a frame depth information storage unit . The video encoder  performs an image compression using the relative characteristics between pictures by extracting the motion vectors in units of macro blocks of 8\u00d78 or 16\u00d716.","In the process of extracting the motion vectors in units of macro blocks, a moving image whose foreground is a human being and background is a house is determined as a target of extracting the motion vector. In this case, an inter-picture prediction is performed between a left-eye image and a right-eye image. With this process, no motion vector is detected from the portion of the image corresponding to the \u201chouse\u201d, but a motion vector is detected from the portion of the image corresponding to the \u201chuman being\u201d.","The detected motion vector is extracted, and the depth information is generated in units of frames when the 3D image is displayed. The depth information is, for example, an image having the same resolution as the frame having the depth of eight bits.","The material producing unit  generates streams such as an audio stream, interactive graphics stream, and a presentation graphics stream, and writes the generated streams into an audio stream storage unit , an interactive graphics stream storage unit , and a presentation graphics stream storage unit ","When generating an audio stream, the material producing unit  generates the audio stream by encoding a non-compressed LinearPCM audio by a compression method such as AC. Other than this, the material producing unit  generates a presentation graphics stream in a format conforming to the BD-ROM standard, based on the subtitle information file that includes a subtitle image, a display timing, and subtitle effects such as fade-in and fade-out. Also, the material producing unit  generates an interactive graphics stream in a format for the menu screen conforming to the BD-ROM standard, based on the menu file that describes bit-map images, transition of the buttons arranged on the menu, and the display effects.","The scenario generating unit  generates a scenario in the BD-ROM format, in accordance with the information of each stream generated by the material producing unit  and the operation input by the authoring staff via the GUI. Here, the scenario means a file such as an index file, movie object file, or playlist file. Also, the scenario generating unit  generates a parameter file which describes which stream each AV clip for realizing the multiplexing process is constituted from. The file generated here such as an index file, movie object file, or playlist file has the data structure described in Embodiments 1 and 2.","The BD program producing unit  generates a source code for a BD program file and generates a BD program in accordance with a request from a user that is received via a user interface such as the GUI. In so doing, the program of the BD program file can use the depth information output from the video encoder  to set the depth of the GFX plane.","The multiplexing processing unit  generates an AV clip in the MPEG2-TS format by multiplexing a plurality of streams described in the BD-ROM scenario data, such as the left-view video stream, right-view video stream, video, audio, subtitle, and button. When generating this, the multiplexing processing unit  also generates the clip information file that makes a pair with the AV clip.","The multiplexing processing unit  generates the clip information file by associating, as a pair, (i) the entry map , generated by the multiplexing processing unit  itself and (ii) attribute information that indicates an audio attribute, image attribute and the like for each stream included in the AV clip. The clip information file has the structure that has been described in each embodiment so far.","The format processing unit  generates a disc image in the UDF format by arranging, in a format conforming to the BD-ROM standard, the BD-ROM scenario data generated by the scenario generating unit , the BD program file produced by the BD program producing unit , the AV clip and clip information file generated by the multiplexing processing unit , and directories and files in a format conforming to the BD-ROM standard, where the UDF format is a file system conforming to the BD-ROM standard.","In so doing, the format processing unit  generates the 3D metadata for the PG stream, ID stream, and secondary video stream by using the depth information output from the video encoder . Also, the format processing unit  sets by automation the arrangement of an image on the screen so as not to overlap with an object in the 3D image, and adjusts the offset value so that depths do not overlap each other. The file layout of the disc image generated in this way is set to have the data structure of the file layout described in Embodiments 1 and 2. The generated disc image is converted into the data for BD-ROM press, and the press process is performed onto the data. The BD-ROM is produced in this way.","(Embodiment as Recording Device for Realizing Managed Copy)","The recording device may have a function to write a digital stream by the managed copy.","The managed copy is a technology that, when a digital stream, playlist information, clip information, or application program is to be copied from a read-only recording medium such as the BD-ROM to another optical disc (BD-R, BD-RE, DVD-R, DVD-RW, DVD-RAM or the like), hard disk, removable medium (SD memory card, memory stick, Compact Flash\u2122, smart medium, multi-media card or the like), has a communication with a server to perform an authentication, and permits the copy only if the authentication results in success. This technology makes it possible to perform controls, such as limiting the number of backups, and permitting the backup only with billing.","When a copy from the BD-ROM to the BD-R or BD-RE is to be performed, and the copy source and the copy destination have the same recording capacity, the managed copy only requires a sequential copy of the bit stream in the BD-ROM from the innermost circumference to the outermost circumference.","When the managed copy is the one that assumes a copy between different types of mediums, a transcode is necessary. Here, the \u201ctranscode\u201d means a process for adapting the digital stream recorded in the BD-ROM to the application format of the copy-destination medium by converting the format of the digital stream from the MPEG2 transport stream format to the MPEG2 program stream format or the like, or re-encoding after decreasing the bit rates assigned to the video stream and the audio stream. In the transcode, it is necessary to obtain the AV clip, clip information, and playlist information by performing the above-described real-time recording process.","(Supplementary Notes)","Up to now, the present invention has been described through the best embodiments that the Applicant recognize as of now. However, further improvements or changes can be added regarding the following technical topics. Whether to select any of the embodiments or the improvements and changes to implement the invention is optional and may be determined by the subjectivity of the implementer.","(Stereoscopic Viewing Methods)","According to the parallax image method used in Embodiment 1, the left-eye and right-eye images are displayed alternately in the time axis direction. As a result, for example, when 24 images are displayed per second in a normal two dimensional movie, 48 images, for the combination of the left-eye and right-eye images, should be displayed per second in a three dimensional movie. Accordingly, this method is suitable for display devices that rewrite each screen at relatively high speeds. The stereoscopic viewing using the parallax images is used in the play equipment of the amusement parks, and has been established technologically. Therefore, it may be said that this method is closest to the practical use in the homes. There have been proposed various other technologies such as the two-color separation method, as the methods for realizing stereoscopic viewing using the parallax images. In the embodiments, the sequential segregation method and the polarization glasses method have been used as examples. However, the present invention is not limited to these methods as far as the parallax images are used.","Also, not limited to the lenticular lens, the display device  may use other devices, such as the liquid crystal element, that have the same function as the lenticular lens. It is further possible to realize the stereoscopic viewing by providing a vertical polarization filter for the left-eyepixels, and providing a horizontal polarization filter for the right-eye pixels, and causing the viewer to view the screen through a pair of polarization glasses that is provided with a vertical polarization filter for the left eye and a horizontal polarization filter for the right eye.","(Data Structure of Index.bdmv for Storing 3D Images)","There is another method in which different types of index files, not playlists, are prepared respectively for the 2D playback devices and the 3D playback devices, and 2D playback devices refer to \u201cIndex.bdmv\u201d when they start a playback, and 3D playback devices refer to \u201cIndex.3dmv\u201d when they start a playback.","(Data Structure for Dealing with Plurality of Streams)","When there are a plurality of streams to be dealt with, the sub-path information may be used as described above, or multi_clip_entries for multi-angle may be used. When the \u201cmulti_clip_entries\u201d is used, it is preferable to inhibit the use of the U for changing the angle after a stream is selected in correspondence with the size of the display device screen, so that the selected stream is changed to another stream that corresponds to another size of the display device screen.","(Target of Application of Left View and Right View)","The left view and right view may be prepared not only to be applied to the video stream representing the main story, but also to be applied to the thumbnail images. As is the case with the video stream, the 2D playback device displays conventional 2D thumbnail images, but the 3D playback device outputs a left-eye thumbnail image and a right-eye thumbnail image prepared for the 3D, in compliance with a 3D display system.","Similarly, the left view and right view may be applied to menu images, thumbnail images of each scene for chapter search, and reduced images of each scene.","(Structure of Recording Layer)","It is preferable that each recording layer of the BD-ROM is provided with a stereoscopic\/planar view shared area, a stereoscopic view dedicated area, and a planar view dedicated area.","The stereoscopic\/planar view shared area is an area that is accessed when a stereoscopic image is played back and when a planar image is played, back. The stereoscopic\/planar view shared area is a continuous area in which (i) a plurality of Extents belonging to the base-view video stream file and (ii) a plurality of Extents belonging to the dependent-view stream video stream file, are alternately arranged and recorded.","The stereoscopic view dedicated area and the planar view dedicated area follow the stereoscopic\/planar view shared area and exist immediately before the boundary of the recording layer.","The stereoscopic view dedicated area is accessed immediately before a long jump that occurs during a playback in the stereoscopic-view output mode. The stereoscopic view dedicated area is an area in which (i) Extents following the Extents belonging to the base-view video stream file recorded in the stereoscopic\/planar view shared area and (ii) Extents following the Extents belonging to the dependent-view stream video stream file recorded in the stereoscopic\/planar view shared area, are alternately arranged and recorded.","The planar view dedicated area is accessed immediately before a long jump that occurs during a playback in the 2D output mode. The planar view dedicated area is an area in which copies of Extents belonging to the base-view video stream file recorded in the stereoscopic view dedicated area are recorded.","(Producing Program of Each Embodiment)","The application program described in each embodiment of the present invention can be produced as follows. First, the software developer writes, using a programming language, a source program that achieves each flowchart and functional component. In this writing, the software developer uses the class structure, variables, array variables, calls to external functions, and so on, which conform to the sentence structure of the programming language he\/she uses.","The written source program is sent to the compiler as files. The compiler translates the source program and generates an object program.","The translation performed by the compiler includes processes such as the syntax analysis, optimization, resource allocation, and code generation. In the syntax analysis, the characters and phrases, sentence structure, and meaning of the source program are analyzed and the source program is converted into an intermediate program. In the optimization, the intermediate program is subjected to such processes as the basic block setting, control flow analysis, and data flow analysis. In the resource allocation, to adapt to the instruction sets of the target processor, the variables in the intermediate program are allocated to the register or memory of the target processor. In the code generation, each intermediate instruction in the intermediate program is converted into a program code, and an object program is obtained.","The generated object program is composed of one or more program codes that cause the computer to execute each step in the flowchart or each procedure of the functional components. There are various types of program codes such as the native code of the processor, and Java\u2122 byte code. There are also various forms of realizing the steps of the program codes. For example, when each step can be realized by using an external function, the call statements for calling the external functions are used as the program codes. Program codes that realize one step may belong to different object programs. In the RISC processor in which the types of instructions are limited, each step of flowcharts may be realized by combining arithmetic operation instructions, logical operation instructions, branch instructions and the like.","After the object program is generated, the programmer activates a linker. The linker allocates the memory spaces to the object programs and the related library programs, and links them together to generate a load module. The generated load module is based on the presumption that it is read by the computer and causes the computer to execute the procedures indicated in the flowcharts and the procedures of the functional components. The program described here may be recorded on a computer-readable recording medium, and may be provided to the user in this form.","(How to Describe Data Structure)","Among the above-described data structures, a repetitive structure that has a plurality of pieces of predetermined type of information can be defined by setting (i) an initial value for the control variable and (ii) a repeat condition, into the \u201cfor\u201d statement. The \u201cDo While\u201d statement may be used as well.","Also, an arbitrary data structure in which predetermined information is defined when a predetermined condition is satisfied, can be defined by describing (i) the condition to be satisfied and (ii) a variable to be set when the condition is satisfied, into the \u201cif\u201d statement. The \u201cswitch\u201d statement or the \u201ccase\u201d statement may be used as well.","As described above, the data structure of each Embodiment can be described in compliance with the grammar of a high-level programming language. Therefore, the data structure of each Embodiment is subjected to the translation performed by the compiler which includes processes such as the syntax analysis, optimization, resource allocation, and code generation. In an object-oriented language, the data structure described in a high-level programming language is treated as a portion other than the method of the class structure, namely, as an array-type member variable in the class structure, and constitutes a part of the program. That is to say, the data structure of each Embodiment is converted into computer code, then recorded into a computer-readable recording medium, and becomes a member variable of the program. Since it can be treated in this way, the data structure described up to now is substantially a program.","(Playback of Optical Disc)","The BD-ROM drive is equipped with an optical head that includes a semiconductor laser, collimated lens, beam splitter, objective lens, collecting lens, and light detector. The light beams emitted from the semiconductor laser pass through the collimated lens, beam splitter, and objective lens, and are collected on the information surface of the optical disc.","The collected light beams are reflected\/diffracted on the optical disc, pass through the objective lens, beam splitter, and collimated lens, and are collected in the light detector. A playback signal is generated depending on the amount of light collected in the light detector.","(Variations of Recording Medium)","The recording medium described in each Embodiment indicates a general package medium as a whole, including the optical disc and the semiconductor memory card. In each Embodiment, it is presumed, as one example, that the recording medium is an optical disc in which necessary data is preliminarily recorded (for example, an existing read-only optical disc such as the BD-ROM or DVD-ROM). However, the present invention is not limited to this. For example, the present invention may be implemented as follows: (i) obtain a 3D content that includes the data necessary for implementing the present invention and is distributed by a broadcast or via a network; (ii) record the 3D content into a writable optical disc (for example, an existing writable optical disc such as the BD-RE, DVD-RAM) by using a terminal device having the function of writing into an optical disc (the function may be embedded in a playback device, or the device may not necessarily be a playback device); and (iii) apply the optical disc recorded with the 3D content to the playback device of the present invention.","(Embodiments of Semiconductor Memory Card Recording Device and Playback Device)","The following describes embodiments of the recording device for recording the data structure of each Embodiment into a semiconductor memory, and the playback device for playing back thereof.","First, the mechanism for protecting the copyright of the data recorded on the BD-ROM will be explained, as a presupposed technology.","Some of the data recorded on the BD-ROM may have been encrypted as necessitated in view of the confidentiality of the data.","For example, the BD-ROM may contain, as encrypted data, the data corresponding to a video stream, an audio stream, or a stream including these.","The following describes decryption of the encrypted data among the data recorded on the BD-ROM.","The semiconductor memory card playback device preliminarily stores data (for example, a device key) that corresponds to a key that is necessary for decrypting the encrypted data recorded on the BD-ROM.","On the other hand, the BD-ROM is preliminarily recorded with (i) data (for example, a medium key block (MKB) corresponding to the above-mentioned device key) that corresponds to a key that is necessary for decrypting the encrypted data, and (ii) encrypted data (for example, an encrypted title key corresponding to the above-mentioned device key and MKB) that is generated by encrypting the key itself that is necessary for decrypting the encrypted data. Note here that the device key, MKB, and encrypted title key are treated as a set, and are further associated with an identifier (for example, a volume ID) written in an area (called BCA) of the BD-ROM that cannot be copied in general. It is structured such that encrypted data cannot be decrypted if these elements are combined incorrectly. Only if the combination is correct, a key (for example, a title key that is obtained by decrypting the encrypted title key by using the above-mentioned device key, MKB, and volume ID) that is necessary for decrypting the encrypted data can be derived. The encrypted data can be decrypted by using the derived key.","When a playback device attempts to play back a BD-ROM loaded in the device, it cannot play back the encrypted data unless the device itself has a device key that makes a pair (or corresponds to) the encrypted title key and MKB recorded on the BD-ROM. This is because the key (title key) that is necessary for decrypting the encrypted data has been encrypted, and is recorded on the BD-ROM as the encrypted title key, and the key that is necessary for decrypting the encrypted data cannot be derived if the combination of the MKB and the device key is not correct.","Conversely, when the combination of the encrypted title key, MKB, device key, and volume ID is correct, the video stream and audio stream are decoded by the decoder with use of the above-mentioned key (for example, a title key that is obtained by decrypting the encrypted title key by using the device key, MKB, and volume ID) that is necessary for decrypting the encrypted data. The playback device is structured in this way.","This completes the description of the mechanism for protecting the copyright of the data recorded on the BD-ROM. It should be noted here that this mechanism is not limited to the BD-ROM, but may be applicable to, for example, a readable\/writable semiconductor memory (such as a portable semiconductor memory such as the SD card) for the implementation.","Next, the playback procedure in the semiconductor memory card playback device will be described. In the case in which the playback device plays back an optical disc, it is structured to read out data via an optical disc drive, for example. On the other hand, in the case in which the playback device plays back a semiconductor memory card, it is structured to read out data via an interface for reading out the data from the semiconductor memory card.","More specifically, the playback device may be structured such that, when a semiconductor memory card is inserted into a slot (not illustrated) provided in the playback device, the playback device and the semiconductor memory card are electrically connected with each other via the semiconductor memory card interface, and the playback device reads out data from the semiconductor memory card via the semiconductor memory card interface.","(Embodiments of Receiving Device)","The playback device explained in each Embodiment may be realized as a terminal device that receives data (distribution data) that corresponds to the data explained in each Embodiment from a distribution server for an electronic distribution service, and records the received data into a semiconductor memory card.","Such a terminal device may be realized by structuring the playback device explained in each Embodiment so as to perform such operations, or may be realized as a dedicated terminal device that is different from the playback device explained in each Embodiment and stores the distribution data into a semiconductor memory card. Here, a case where the playback device is used will be explained. Also, in this explanation, an SD card is used as the recording-destination semiconductor memory.","When the playback device is to record distribution data into an SD memory card inserted in a slot provided therein, the playback device first send requests a distribution server (not illustrated) that stores distribution data, to transmit the distribution data. In so doing, the playback device reads out identification information for uniquely identifying the inserted SD memory card (for example, identification information uniquely assigned to each SD memory card, more specifically, the serial number or the like of the SD memory card), from the SD memory card, and transmits the read-out identification information to the distribution server together with the distribution request.","The identification information for uniquely identifying the SD memory card corresponds to, for example, the volume ID having been described earlier.","On the other hand, the distribution server stores necessary data (for example, video stream, audio stream and the like) in an encrypted state such that the necessary data can be decrypted by using a predetermined key (for example, a title key).","The distribution server, for example, holds a private key so that it can dynamically generate different pieces of public key information respectively in correspondence with identification numbers uniquely assigned to each semiconductor memory card.","Also, the distribution server is structured to be able to encrypt the key (title key) itself that is necessary for decrypting the encrypted data (that is to say, the distribution server is structured to be able to generate an encrypted title key).","The generated public key information includes, for example, information corresponding to the above-described MKB, volume ID, and encrypted title key. With this structure, when, for example, a combination of the identification number of the semiconductor memory card, the public key contained in the public key information which will be explained later, and the device key that is preliminarily recorded in the playback device, is correct, a key (for example, a title key that is obtained by decrypting the encrypted title key by using the device key, the MKB, and the identification number of the semiconductor memory) necessary for decrypting the encrypted data is obtained, and the encrypted data is decrypted by using the obtained necessary key (title key).","Following this, the playback device records the received piece of public key information and distribution data into a recording area of the semiconductor memory card being inserted in the slot thereof.","Next, a description is given of an example of the method for decrypting and playing back the encrypted data among the data contained in the public key information and distribution data recorded in the recording area of the semiconductor memory card.","The received public key information stores, for example, a public key (for example, the above-described MKB and encrypted title key), signature information, identification number of the semiconductor memory card, and device list being information regarding devices to be invalidated.","The signature information includes, for example, a hash value of the public key information.","The device list is, for example, information for identifying the devices that might be played back in an unauthorized manner. The information, for example, is used to uniquely identify the devices, parts of the devices, and functions (programs)) that might be played back in an unauthorized manner, and is composed of, for example, the device key and the identification number of the playback device that are preliminarily recorded in the playback device, and the identification number of the decoder provided in the playback device.","The following describes playing back the encrypted data among the distribution data recorded in the recording area of the semiconductor memory card.","First, it is checked whether or not the decryption key itself can be used, before the encrypted data is decrypted by using the decryption key.","More specifically, the following checks are conducted.\n\n","These checks may be performed in any order.","After the above described checks (1) through (3), the playback device performs a control not to decrypt the encrypted data when any of the following conditions is satisfied: (i) the identification information of the semiconductor memory card contained in the public key information does not match the identification number of the semiconductor memory card preliminarily stored in the semiconductor memory card; (ii) the hash value of the public key information calculated in the playback device does not match the hash value included in the signature information; and (iii) the playback device to perform the playback is not authentic.","On the other hand, when all of the conditions: (i) the identification information of the semiconductor memory card contained in the public key information matches the identification number of the semiconductor memory card preliminarily stored in the semiconductor memory card; (ii) the hash value of the public key information calculated in the playback device matches the hash value included in the signature information; and (iii) the playback device to perform the playback is authentic, are satisfied, it is judged that the combination of the identification number of the semiconductor memory, the public key contained in the public key information, and the device key that is preliminarily recorded in the playback device, is correct, and the encrypted data is decrypted by using the key necessary for the decryption (the title key that is obtained by decrypting the encrypted title key by using the device key, the MKB, and the identification number of the semiconductor memory).","When the encrypted data is, for example, a video stream and an audio stream, the video decoder decrypts (decodes) the video stream by using the above-described key necessary for the decryption (the title key that is obtained by decrypting the encrypted title key), and the audio decoder decrypts (decodes) the audio stream by using the above-described key necessary for the decryption.","With such a structure, when devices, parts of the devices, and functions (programs) that might be used in an unauthorized manner are known at the time of the electronic distribution, a device list showing such devices and the like may be distributed. This enables the playback device having received the list to inhibit the decryption with use of the public key information (public key itself) when the playback device includes anything shown in the list. Therefore, even if the combination of the identification number of the semiconductor memory, the public key itself contained in the public key information, and the device key that is preliminarily recorded in the playback device, is correct, a control is performed not to decrypt the encrypted data. This makes it possible to prevent the distribution data from being used by an unauthentic device.","It is preferable that the identifier of the semiconductor memory card that is preliminarily recorded in the semiconductor memory card is stored in a highly secure recording area. This is because, when the identification number (for example, the serial number of the SD memory card) that is preliminarily recorded in the semiconductor memory card is tampered with, unauthorized copying becomes easy. More specifically, unique, although different identification numbers are respectively assigned to semiconductor memory cards, if the identification numbers are tampered with to be the same, the above-described judgment in (1) does not make sense, and as many semiconductor memory cards as tamperings may be copied in an unauthorized manner.","For this reason, it is preferable that information such as the identification number of the semiconductor memory card is stored in a highly secure recording area.","To realize this, the semiconductor memory card, for example, may have a structure in which a recording area for recording highly confidential data such as the identifier of the semiconductor memory card (hereinafter, the recording area is referred to as a second recording area) is provided separately from a recording area for recording regular data (hereinafter, the recording area is referred to as a first recording area), a control circuit for controlling accesses to the second recording area is provided, and the second recording area is accessible only through the control circuit.","For example, data may encrypted so that encrypted data is recorded in the second recording area, and the control circuit may be embedded with a circuit for decrypting the encrypted data. In this structure, when an access is made to the second recording area, the control circuit decrypts the encrypted data and returns decrypted data. As another example, the control circuit may hold information indicating the location where the data is stored in the second recording area, and when an access is made to the second recording area, the control circuit identifies the corresponding storage location of the data, and returns data that is read out from the identified storage location.","An application, which is running on the playback device and is to record data onto the semiconductor memory card with use of the electronic distribution, issues, to the control circuit via a memory card interface, an access request requesting to access the data (for example, the identification number of the semiconductor memory card) recorded in the second recording area. Upon receiving the request, the control circuit reads out the data from the second recording area and returns the data to the application running on the playback device. It sends the identification number of the semiconductor memory card and requests the distribution server to distribute the data such as the public key information and corresponding distribution data. The public key information and corresponding distribution data that are sent from the distribution server are recorded into the first recording area.","Also, it is preferable that the application, which is running on the playback device and is to record data onto the semiconductor memory card with use of the electronic distribution, preliminarily checks whether or not the application is tampered with before it issues, to the control circuit via a memory card interface, an access request requesting to access the data (for example, the identification number of the semiconductor memory card) recorded in the second recording area. For checking this, an existing digital certificate conforming to the X.509 standard, for example, may be used.","Also, the distribution data recorded in the first recording area of the semiconductor memory card may not necessarily be accessed via the control circuit provided in the semiconductor memory card.","(System LSI)","It is desirable that part of the components of the playback device that is mainly composed of logic devices, such as the system target decoder, playback control unit , and program executing unit, is realized as a system LSI.","The system LSI is obtained by implementing a bear chip on a high-density substrate and packaging them. The system LSI is also obtained by implementing a plurality of bear chips on a high-density substrate and packaging them, so that the plurality of bear chips have an outer appearance of one LSI (such a system LSI is called a multi-chip module).","The system LSI has a QFP (Quad Flat Package) type and a PGA (Pin Grid Array) type. In the QFP-type system LSI, pins are attached to the four sides of the package. In the PGA-type system LSI, a lot of pins are attached to the entire bottom.","These pins function as an interface with other circuits. The system LSI, which is connected with other circuits through such pins as an interface, plays a role as the core of the playback device .","Such a system LSI can be embedded into various types of devices that can play back images, such as a television, game machine, personal computer, one-segment mobile phone, as well as into the playback device . The system LSI thus greatly broadens the use of the present invention.","It is desirable that the system LSI conforms to the Uniphier architecture.","A system LSI conforming to the Uniphier architecture includes the following circuit blocks.","Data Parallel Processor (DPP)","The DPP is an SIMD-type processor where a plurality of elemental processors perform a same operation. The DPP achieves a parallel decoding of a plurality of pixels constituting a picture by causing operating units, respectively embedded in the elemental processors, to operate simultaneously by one instruction.","Instruction Parallel Processor (IPP)","The IPP includes: a local memory controller that is composed of instruction RAM, instruction cache, data RAM, and data cache; processing unit that is composed of instruction fetch unit, decoder, execution unit, and register file; and virtual multi processing unit that causes the processing unit to execute a parallel execution of a plurality of applications.","MPU Block","The MPU block is composed of: peripheral circuits such as ARM core, external bus interface (Bus Control Unit: BCU), DMA controller, timer, vector interrupt controller; and peripheral interfaces such as DART, GPIO (General Purpose Input Output), and sync serial interface.","Stream I\/O Block","The stream I\/O block performs data input\/output with the drive device, hard disk drive device, and SD memory card drive device which are connected onto the external busses via the USB interface and the ATA packet interface.","AV I\/O Block","The AV I\/O block, which is composed of audio input\/output, video input\/output, and OSD controller, performs data input\/output with the television and the AV amplifier.","Memory Control Block","The memory control block performs reading and writing from\/to the SD-RAM connected therewith via the external buses. The memory control block is composed of internal bus connection unit for controlling internal connection between blocks, access control unit for transferring data with the SD-RAM connected to outside of the system LSI, and access schedule unit for adjusting requests from the blocks to access the SD-RAM.","The following describes a detailed production procedure. First, a circuit diagram of a part to be the system LSI is drawn, based on the drawings that show structures of the embodiments. And then the constituent elements of the target structure are realized using circuit elements, ICs, or LSIs.","As the constituent elements are realized, buses connecting between the circuit elements, ICs, or LSIs, peripheral circuits, interfaces with external entities and the like are defined. Further, the connection lines, power lines, ground lines, clock signals and the like are defined. For these definitions, the operation timings of the constituent elements are adjusted by taking into consideration the LSI specifications, and bandwidths necessary for the constituent elements are secured. With other necessary adjustments, the circuit diagram is completed.","After the circuit diagram is completed, the implementation design is performed. The implementation design is a work for creating a board layout by determining how to arrange the parts (circuit elements, ICs, LSIs) of the circuit and the connection lines onto the board.","After the implementation design is performed and the board layout is created, the results of the implementation design are converted into CAM data, and the CAM data is output to equipment such as an NC (Numerical Control) machine tool. The NC machine tool performs the SoC implementation or the SiP implementation. The SoC (System on Chip) implementation is a technology for printing a plurality of circuits onto a chip. The SiP (System in Package) implementation is a technology for packaging a plurality of circuits by resin or the like. Through these processes, a system LSI of the present invention can be produced based on the internal structure of the playback device  described in each embodiment above.","It should be noted here that the integrated circuit generated as described above may be called IC, LSI, ultra LSI, super LSI or the like, depending on the level of the integration.","It is also possible to achieve the system LSI by using the FPGA (Field Programmable Gate Array). In this case, a lot of logic elements are to be arranged lattice-like, and vertical and horizontal wires are connected based on the input\/output combinations described in LUT (Look-Up Table), so that the hardware structure described in each embodiment can be realized. The LUT is stored in the SRAM. Since the contents of the SRAM are erased when the power is off, when the FPGA is used, it is necessary to define the Config information so as to write, onto the SRAM, the LUT for realizing the hardware structure described in each embodiment.","This embodiment is realized by middleware and hardware part corresponding to the system LSI, hardware part other than the part corresponding to the system LSI, interface part for the middleware, interface part for the middleware and system LSI, interface with the hardware part other than the part corresponding to the system LSI, and the user interface part, and when these are embedded in a playback device, these operate in cooperation with each other to provide unique functions.","By appropriately defining the interface part for the middleware, and the interface part for the middleware and system LSI, it is possible to develop, independently in parallel, the user interface part, middleware part, and system LSI part of the playback device. This makes it possible to develop the product more efficiently. Note that the interface can be segmented in various ways.","The information recording medium of the present invention stores a 3D image, but can be played back in both 2D-image playback devices and 3D-image playback devices. This makes it possible to distribute movie contents such as movie titles storing 3D images, without causing the consumers to be conscious about the compatibility. This activates the movie market and commercial device market. Accordingly, the recording medium and the playback device of the present invention have high usability in the movie industry and commercial device industry.",{"@attributes":{"id":"p-0687","num":"0000"},"ul":{"@attributes":{"id":"ul0010","list-style":"none"},"li":{"@attributes":{"id":"ul0010-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0011","list-style":"none"},"li":[{"@attributes":{"id":"ul0011-0001","num":"0693"},"b":"100"},{"@attributes":{"id":"ul0011-0002","num":"0694"},"b":"200"},{"@attributes":{"id":"ul0011-0003","num":"0695"},"b":"300"},{"@attributes":{"id":"ul0011-0004","num":"0696"},"b":"400"},{"@attributes":{"id":"ul0011-0005","num":"0697"},"b":"500"},{"@attributes":{"id":"ul0011-0006","num":"0698"},"b":"1"},{"@attributes":{"id":"ul0011-0007","num":"0699"},"b":["2","2"],"i":["a","b "]},{"@attributes":{"id":"ul0011-0008","num":"0700"},"b":"4"},{"@attributes":{"id":"ul0011-0009","num":"0701"},"b":"5","i":"a "},{"@attributes":{"id":"ul0011-0010","num":"0702"},"b":"5","i":"b "},{"@attributes":{"id":"ul0011-0011","num":"0703"},"b":"6"},{"@attributes":{"id":"ul0011-0012","num":"0704"},"b":"7"},{"@attributes":{"id":"ul0011-0013","num":"0705"},"b":"9"},{"@attributes":{"id":"ul0011-0014","num":"0706"},"b":"10"},{"@attributes":{"id":"ul0011-0015","num":"0707"},"b":"11"},{"@attributes":{"id":"ul0011-0016","num":"0708"},"b":"12"},{"@attributes":{"id":"ul0011-0017","num":"0709"},"b":"13"},{"@attributes":{"id":"ul0011-0018","num":"0710"},"b":"14"},{"@attributes":{"id":"ul0011-0019","num":"0711"},"b":"16"},{"@attributes":{"id":"ul0011-0020","num":"0712"},"b":"17"},{"@attributes":{"id":"ul0011-0021","num":"0713"},"b":"18"},{"@attributes":{"id":"ul0011-0022","num":"0714"},"b":"19"},{"@attributes":{"id":"ul0011-0023","num":"0715"},"b":"23"},{"@attributes":{"id":"ul0011-0024","num":"0716"},"b":"27"},{"@attributes":{"id":"ul0011-0025","num":"0717"},"b":"31"},{"@attributes":{"id":"ul0011-0026","num":"0718"},"b":"32"},{"@attributes":{"id":"ul0011-0027","num":"0719"},"b":"33"},{"@attributes":{"id":"ul0011-0028","num":"0720"},"b":"34"},{"@attributes":{"id":"ul0011-0029","num":"0721"},"b":"35"},{"@attributes":{"id":"ul0011-0030","num":"0722"},"b":"36"},{"@attributes":{"id":"ul0011-0031","num":"0723"},"b":"37"},{"@attributes":{"id":"ul0011-0032","num":"0724"},"b":"38"},{"@attributes":{"id":"ul0011-0033","num":"0725"},"b":"39"},{"@attributes":{"id":"ul0011-0034","num":"0726"},"b":"40"},{"@attributes":{"id":"ul0011-0035","num":"0727"},"b":"41"},{"@attributes":{"id":"ul0011-0036","num":"0728"},"b":"42"}]}}}},"Although the present invention has been fully described by way of examples with reference to the accompanying drawings, it is to be noted that various changes and modifications will be apparent to those skilled in the art. Therefore, unless such changes and modifications depart from the scope of the present invention, they should be construed as being included therein."],"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","The Problems the Invention is Going to Solve","Means to Solve the Problems","EFFECTS OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS","Embodiment 1","Embodiment 2","Embodiment 3","Embodiment 4","Embodiment 5","Embodiment 6","INDUSTRIAL APPLICABILITY","DESCRIPTION OF CHARACTERS"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and the other objects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings which illustrate a specific embodiment of the invention.","In the drawings:",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIGS. 1A through 1C"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIGS. 7A and 7B"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIGS. 15A and 15B"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 18","FIG. 17"]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIGS. 22A to 22C"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":["FIG. 23","FIG. 17"]},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 25"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 26","b":["4","5"],"i":"a; "},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 27","b":"5","i":"b; "},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 30","b":["10","7"],"i":"b; "},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 31"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 32"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 33"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 34"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 35"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 36"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 37"},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 38"},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 39","b":["300","400"]},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 40"},{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 41"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 42"},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 43"},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIGS. 44A and 44B"},{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 45"},{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 46"},{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIG. 47"},{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 48"},{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 49"},{"@attributes":{"id":"p-0072","num":"0071"},"figref":"FIG. 50"}]},"DETDESC":[{},{}]}
