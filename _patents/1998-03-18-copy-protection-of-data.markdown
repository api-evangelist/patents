---
title: Copy protection of data
abstract: A copyright protection scheme downloads data from a server, typically over the World Wide Web to a client for presentation to a user. The downloaded data is cryptographically protected, by encryption and hashing. When displayed by the client, storing and copying functions are selectively disabled in respect of the data, in order to prevent unauthorized copying.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07079649&OS=07079649&RS=07079649
owner: British Telecommunications public limited company
number: 07079649
owner_city: London
owner_country: GB
publication_date: 19980318
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","This invention relates to protecting data against copying and has particular application to protecting data transmitted through a network, such as hypermedia transmitted over a web-based network.","2. Related Art","It is known that data in the form of hypermedia such as hypertext, is often written in the hypertext language HTML and arranged in webpages that are provided by a server connected through a network to a client. The client may comprise a personal computer or other processing device capable of presenting the data retrieved from the server to a user. The network may comprise a local area network (LAN), a wide area network (WAN) or may comprise the Internet. For example, the World Wide Web comprises many servers connected over the Internet in a web, which have addresses in the form of universal resource locators (URL).","The hypertext information is arranged in webpages which include hotspots to allow the user to establish a link to another webpage, which may be located on the same or a different server, the routing to the document being achieved by use of a URL in the webpage at the hotspot.","Web clients typically access the hypermedia information using a browser. An overview of the World Wide Web and HTML is given in Chapter 1 of \u201cHTML 3.2 and CGI Unleashed\u201d J. December and M. Ginsberg 1996 (ISBN 1-57521-177-7).","As well known in the art, HTML webpages can display text, graphics and files of other descriptions such as video images, animated graphics and audio samples. Hypermedia have the significant advantage that the client can rapidly transfer viewing from one document to another by using a mouse to click on hotspots in the document, permitting the user to transfer from one web site to another, which may be at different physical locations.","The individual works which are displayed on the HTML pages may be copyright works. Because of the ease with which the copyright work may be viewed, transmitted and copied on the web, it is difficult for a copyright owner to enforce its copyright. For example, when a graphics file has been downloaded to a client, it may be readily copied onto the hard disc of a client's computer and replicated many times digitally, with no significant degradation from copy to copy.","With a view to overcoming this problem, the invention provides a method of copy protecting data sent from a server to a client for presentation to a user, comprising: cryptographically protecting the data; sending the cryptographically protected data to the client; and selectively controlling copying functions of the client in respect of the data whilst the data is being held by the client in a form suitable for presentation to the user.","The data may be cryptographically protected by encryption and\/or by an integrity checking procedure such as hashing.","More specifically, the method according to the invention may include downloading a program object to the client, running the program object on the client such that a request is uploaded to the server for a file containing the cryptographically protected data, downloading the file to the client, and rendering the cryptographically protected data in an unprotected form suitable for presentation to the user, the program object being operative such that no, or restricted, copy or save functions are offered to the user in respect of the downloaded data in its unprotected form.","The invention has particular but not exclusive application to downloading data over a network such as the World Wide Web, but is also applicable to LANs, WANs and to distribution of data using long term storage media such as 3.5\u2033 floppy discs or CD-ROM based technology.","The method of the invention may be used with a conventional browser.","A message concerning a webpage may be downloaded from the server to the client, the message including information concerning the program object, such that a request is then uploaded to the server in response to the message, in order to retrieve the program object. The webpage may be written in HTML code. The program object may comprise a Java applet although the invention envisages the use of other program objects such as Active X or OLE.","As a result of processing a Java applet, the usual copy and save functions will not be presented to the user, thereby providing security in respect of the unprotected data presented to the user.","The data presented may comprise text, graphics, pictures, audio or any other suitable form.","The program object may include data concerning a cryptographic key, which can then be used to render the downloaded cryptographically protected data into an unprotected form suitable for presentation to the user.","An authentication procedure may be employed to ensure that the cryptographically protected data is only downloaded to an authenticated client. The authentication process may be performed by reference to a payment scheme, to enable a royalty to be collected in respect of the downloaded, cryptographically protected data.","It will be understood that no copy protection scheme can ever be completely successful, because when data is presented to users, they will have the opportunity to copy it. However in accordance with the invention the effort required to break the protection scheme provided by the inventive method may be significantly greater than the payment of a monetary sum to permit use of the protected data, thereby reducing the risk to the owner of the data releasing it through the World Wide Web or other open access networks.","The downloaded data may be steganographically marked, for example with a digital watermark. When the identity of the client is known, the watermark may include the client identity, in order to provide additional security in the event that fraudulent copies are made by the user.","The invention also includes a server configured to perform the inventive method.","The invention furthermore includes a method of downloading encrypted data from a server to a client, including: registering the client with the server by determining a machine identifier of the client by analysing its hardware and\/or its software configuration, transmitting the machine identifier to the server, combining the transmitted machine identifier with a cryptographic key to form a unique determinator for the client, and transmitting the unique determinator to the client, to be stored therein for use subsequently in identifying the client to the server, to permit encrypted data to be downloaded thereto from the server; subsequently identifying the client to the server on the basis of the unique determinator; and then downloading data encrypted by means of the cryptographic key to the identified client, for decryption by the client using the key from the unique determinator.","The downloaded data can be decrypted at the client using the key from the unique determinator.","The client may be identified to the server by again determining the machine identifier for the client, comparing it with the machine identifier included in said unique determinator, and signalling to the server on the basis of the outcome of the comparison.","The client may be authenicated by the server prior to downloading the encrypted data. This may be carried out by generating a challenge, generating a response as a predetermined cryptographic function of the cryptographic key for the client as held by the server, and as a function of the key included in the unique determinator stored in the client, and authenticating the client on the basis of the outcome of the comparison.","An example of the invention will now be described in relation to the World Wide Web (WWW). As is well known, a page of information on a web server is identified on the web by means of an individual URL so that it can be accessed by a browser running on a client computer. Referring to , a web server  is connected through the World Wide Web , to a client computer in the form of a PC . HTML webpages can be downloaded to the client computer  from the web server , to be displayed to the user of the client computer . The HTML document may include links to other HTML pages on the same or a different web server, in a manner well known per se. The HTML webpages may also include embedded objects such as graphics, images and the like.","The client  runs a browser which receives the HTML documents from the web server  and displays them on the display of the computer. In this example, the browser is Java aware i.e. can interpret Java bytecodes received from the server. More particularly, as known in the art, when the HTML document includes a so-called Java applet tag, the server downloads a corresponding applet, consisting of Java bytecodes, which are interpreted and run by the browser. Typically, the downloaded Java applet allows interactivity between the user of the computer  and the displayed image. For further information, reference is directed to \u201cHTML 3.2 and CGI Unleashed\u201d, supra, Chapter 18.","An example of the screen display of an HTML webpage is shown in . The display is provided within a window  presented by the browser. Examples of a suitable browser are the Microsoft Internet Explorer 3.1 and the Netscape Navigator. The browser includes a number of conventional controls which are operated by clicking on a mouse, in the usual way. For example, the browser includes a print button  which allows a screen print to be produced of the entire page shown within the browser window . Also, the browser includes a control, shown schematically at , with a drop-down menu option \u201cview source\u201d, which allows a display to be provided of the actual HTML code which is being run.","A page  is shown within the window  of the browser. The page is defined by a sequence of lines of HTML code which specify the text and layout provided on the page. Also, the code specifies areas which receive graphical, image data or other data that is downloaded in separate files which have a predetermined tag. In this example a graphics file with a tag \u201cgif\u201d is displayed. The HTML code causes the gif file to be displayed within the pre-defined area of the page. Thus, in the page , the gif file is displayed in region  defined by the downloaded HTML code. An example of the code for the gif file is shown in Code Extract No. 1, below.",{"@attributes":{"id":"p-0043","num":"0042"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Code Extract No. 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CE1.1","<HTML>"]},{"entry":"CE1.2"},{"entry":["CE1.3","<HEAD><TITLE>Company X's Homepage<\/TITLE><\/HEAD>"]},{"entry":"CE1.4"},{"entry":["CE1.5","<BODY>"]},{"entry":["CE1.6","Welcome to Company X's Homepage"]},{"entry":"CE1.7"},{"entry":["CE1.8","<IMG ALIGN=middle SRC=\u201ca_graphic.gif\u201d><P>"]},{"entry":"CE1.9"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CE1.10","<A HREF=\u201canother.html\u201d>link to another web page<\/A>"]},{"entry":["CE1.11","<\/BODY>"]},{"entry":"CE1.12"},{"entry":["CE1.13","<\/HTML>"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"If the user clicks the computer's mouse in the area of the displayed image , using the right mouse button, a drop-down menu  is displayed which gives the user options including \u201csave\u201d, to save the digital data corresponding to the gif file to the computer's hard disc or to some other storage location, and also the option to print, using a printer connected to the computer  (not shown). Thus, the user of computer  can make a copy of the digital data which comprises the graphics displayed in region  and the data can then be forwarded to other locations in an unrestricted manner. Because the data is recorded in digital form, it can be replicated many times without degradation of image quality.","Also, the entire page , including the graphics display , can be printed using the browser print button . However, the printed image quality can only at best be of that displayed on the screen of the computer. The printed image will be in the analogue domain so any processes that return the image to the digital domain will only further reduce the quality.","The displayed HTML page  also includes a hotspot . When the computer's mouse is clicked on the hotspot, a link is established to another webpage, which is then displayed within the window . The HTML code associated with the hotspot  includes a URL in order to establish the link to another webpage, in a manner well known per se.","As is well known in the art, HTML code can also include a Java applet. This consists of a programming object which is downloaded from the server , that can be run locally, within the browser . An applet is specified in HTML by a code tag\u2014applet as will be described hereinafter. When the HTML interpreter in the browser encounters such a tag in a webpage, it refers back to the web server, which then downloads Java bytecodes to the browser. Typically, applets are used to display animated graphic symbols in a webpage, although many other applications can be provided, as well known to those skilled in the art. The location and size of the applet display is determined by instructions in lines of the HTML code.","If the user clicks the right mouse button on the data displayed by running the applet, no drop-down menu is provided corresponding to the menu  shown in . The user can use the view-source button  to display the lines of code which make up the HTML page being displayed, but this does not reveal the data that is displayed when the applet is run by the browser. The Java interpreter can display gif files when running an applet, within the applet, although normally, gif files are downloaded directly into the webpage because it is not normally necessary to process them in terms of Java bytecodes.","The present invention provides a method by which data can be downloaded to the webpage in a secure manner, and cannot be saved or copied whilst being displayed without significant fraudulent effort.","An example of a downloading process in accordance with the invention will now be described in more detail with reference to ,  and . In this example, a webpage containing copyright protected image data is downloaded from the server  to client computer  through the World Wide Web . The resulting display in the browser  is shown in  and the processing steps are shown in more detail in .","At step S the client  uploads a request to the server  for details of a webpage. The request comprises a conventional hypertext file transfer protocol (HTTP) page request. The server then, at step S, gets the page, or constructs it \u201con the fly\u201d and downloads the HTML code corresponding to the page, to the client  through the World Wide Web (WWW) . In the usual way, the HTML code includes references for images, graphics, sound bytes and the like and in response to such codes, the server will upload HTTP requests for corresponding files to be displayed in the webpage. For example, referring to the webpage  shown in , it includes a graphical image  constituted by a gif file. In order to obtain the data for the display , an HTTP request is uploaded at step S to the server, and corresponding binary graphical data is downloaded at step S. This data is then displayed in region  of the page  shown in . However, this data is not copyright protected because the user can save and copy it using the right mouse button as previously explained with reference to .","However, in accordance with the invention, region  of the displayed page  is copyright protected. The HTML code associated with the page  of FIG.  is shown in Code Extract No. 2, below, and references an applet A1 at line CE2.8.",{"@attributes":{"id":"p-0053","num":"0052"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Code Extract No. 2"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CE2.1","<HTML>"]},{"entry":"CE2.2"},{"entry":["CE2.3","<HEAD><TITLE>Company X's Homepage<\/TITLE><\/HEAD>"]},{"entry":"CE2.4"},{"entry":["CE2.5","<BODY>"]},{"entry":["CE2.6","Welcome to Company X's Homepage with added copyright protection"]},{"entry":"CE2.7"},{"entry":["CE2.8","<APPLET CODE=BTCBrowserApplet.class WIDTH=200 HEIGHT=150>"]},{"entry":["CE2.9","<PARAM NAME = file VALUE=\u201ca_graphic.gif\u201d>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["CE2.10","<\/APPLET>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CE2.11","<IMG SRC=\u201canother_graphic.gif\u201d><P>"]},{"entry":"CE2.12"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CE2.13","<A HREF=\u201canother.html\u201d>link to another web page<\/A>"]},{"entry":["CE2.14","<\/BODY>"]},{"entry":"CE2.15"},{"entry":["CE2.16","<\/HTML>"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"The Java bytecodes for running the applet are downloaded to the client from the server  to the client  at step S in . The applet A1 is then run on the client, using the Java interpreter within the browser, in order to prepare the browser to receive data to be displayed in region  of the webpage, downloaded from the server.","The data to be displayed in region  is cryptographically protected so that it cannot be readily deciphered, by monitoring the downloaded signals. In this example, the cryptographic protection includes encryption of the downloaded data together with hashing, as will be explained in more detail hereinafter.","The applet A1 allows the downloaded file to be decrypted and checked for integrity i.e. hash verified. More specifically, the applet A1 includes the following: a hashing algorithm HA, a master hashing key K, an encryption algorithm EA, an encryption key Kand a BTC file request. As used herein, the term BTC refers to a file of copyright protected data, for display at the browser.","The applet A1 is run at step S on the client computer  and at step S, the applet causes a BTC file request to be uploaded to the server .","At step S, the server performs an authentication step in order to determine whether it is safe to download the requested BTC file to the client. The authentication may be carried out in a number of different ways. For example, the server may only download the file if the client has made a payment, so as to allow the owner of the copyright of the BTC file to collect a royalty for the act of viewing the file. A micropayment scheme for this purpose is described in our co-pending patent application No. GB 9624127.8 entitled Transaction System. Alternatively, the client  may be known to the server in respect of some other service being provided, for example an Internet home shopping scheme, and the client's credentials may be authenticated by means of procedures already in use for the service.","Assuming that the client  passes the authentication step S, the server then, at step S, prepares the BTC file for downloading to the client .","The step S is shown in more detail in . At step S. the relevant data is fetched. This may comprise graphics data, audio, video, text or an other appropriate data format.","At step S., the data is watermarked. This may involve changing some of the bits in the data stream so as to record a pattern which is imperceptible in the image displayed by the browser , when the data is downloaded to the client. Watermarking is a well known example of a technique termed steganography. For a general review of this technique and digital watermarks, reference is directed to \u201cDisappearing Cryptography\u201d, P. Wayner, Academic Press 1996 (ISBN 0-12-738671-8). Watermarking gives additional security in the event the protected data is copied, because knowledge of the source of copying can be determined from the watermark. Thus, if the authentication step (step S) provides the server with a particular identity for the client, the identity may be watermarked at step S. into the data.","At step S., the watermarked data is hashed at the server, using a copy of the hashing algorithm HA that was downloaded in applet A1 and a file-specific session hashing key K. The hashing process consists of using the algorithm HA and the key Ktogether with the data bits of the encrypted data, to form additional bits HV, in the manner of parity bits, that are added to the data string. The hashing ensures that sections of data are not removed and replaced by others, in order to ensure that for example a command \u201cpay U$1\u201d is not changed to \u201cpay US$100\u201d. A suitable form of hashing algorithm is SHA which is described in more detail in National Institute of Standards and Technology, Federal Information Processing Standards Publication 180-1 (NIST FIPS PUB 180-1) SECURE HASH STANDARD.","As step S. the data is encrypted at the server , using a copy of the algorithm EA and the key Kwhich were downloaded previously to the client, in the Java bytecodes of applet A1. An example of an encryption algorithm is the DES algorithm and reference is directed to the National Institute of Standards and Technology, Federal Information Processing Standards Publication 46-2 (NIST FIPS PUB 46-2) DATA ENCRYPTION STANDARD (DES). The encryption algorithm AE is actually a pair of algorithms, one of which is used to encrypt and the other to decrypt. It will be understood that the key Kis changed periodically as is known to be good practice in the art.","Then the resulting file, at step S. is wrapped in a proprietary BTC file format which itself includes additional cryptographic protection techniques.","The proprietary BTC file format is shown in . The BTC file format comprises header information H, and an embedded file EF. The processing performed at step S. is shown in more detail in .","The BTC file in step S. is generated as follows. In step S.. partial information for the header H is generated. This comprises a version number for the file format, and any specific copyright protection control information CI for the file.","In step S.. the integrity of all of this information is protected by generating a hash value HVusing a hashing key HK.","In step S.. the hashing key used on the header HK, and the generated hash value HVare both appended to the header H, so as to complete it.","In step S.. the watermarked, and encrypted file generated in step S. is appended to the header H to form part of the embedded file EF in .","In step S.. information which describes the hashing that was performed in step S. is appended to the file EF. This information comprises the specific session hashing key Kused on the embedded file hereinafter referred to as HKand the hash value HV generated in step S. hereinafter referred to as HV. This completes the BTC file.","At step S () the BTC file is downloaded to the client .","Then, at step S, the BTC file is processed using the applet A1 previously downloaded to the client . The processing performed at step S is shown in more detail in . At steps S. and S. the integrity of the content of the header H is verified. In step S., using the hashing algorithm HA, and the hashing key used on the header HK(recovered from the header H of the BTC file) the hash value HVof the header is generated. At step S. the value is checked against the hash value HVrecovered from the BTC file header H.","If the result of the check is unsatisfactory, an error banner is displayed at step S. in the region  () in the window of the browser . However, if the integrity check is satisfactory, the applet A1 checks in step S. that it knows how to process files of the type specified in the version number recovered from the header  of . If the result of the check is unsatisfactory, an error banner is displayed at step S. in the region  () in the window of the browser . However if the check is satisfactory, the applet A1 can make use of the specific copyright protection control information CI for the file (present in the header H of ) when processing user requests for data manipulation.","In step S. the embedded file EF is decrypted using the encryption algorithm EA and the key Kpreviously downloaded in the applet A1.","In steps S. and S. the integrity of the content of the decrypted file is verified as follows. In step S., using the hashing algorithm HA, and the hashing key used on the embedded file (recovered from the embedded file EF in the BTC file) the hash value HV is generated. In step S. the value is checked against the hash value HVrecovered from the BTC embedded file EF.","If the result of the check is unsatisfactory, an error banner is displayed at step S. in the region  () in the window of the browser . However, if the integrity check is satisfactory, the applet A1 can display the content of the decrypted file in the region  ) in the window of the browser  in step S..","Thus, if the BTC file contains image data, the image is displayed, together with its imperceptible watermark, in the region  of webpage  shown in . The user cannot save or copy the image data. Because the Java enabled browser is running an applet for the image data in region , the functions of the right mouse button are disabled for region . Therefore, if the user clicks the mouse with the right button, no menu option is automatically provided for saving, copying or printing the displayed data in region . The right mouse button function is disabled according to usual Java operation for applets as previously described. The user could operate the print button  of the browser  but this would only print a low quality image and would not permit the digital data that comprises the image  to be recovered for the purpose of providing a high quality copy.","Furthermore, if the downloaded BTC file is cached in the browser, it will be cached in its cryptographically protected form so that making copies of the cached file does not permit access to the downloaded data in the BTC file, unless substantial code breaking activities are fraudulently undertaken by the user.","It will be understood that no copyright protection scheme can ever be completely successful because when a copyright work is presented to a user, they will have an opportunity to copy it. The purpose of the present scheme however, is to make payment of a small monetary sum in respect of the copyright protected work, more attractive than the effort of breaking the protection regime provided by the invention. An analogy can be drawn with copying pages of a book with a photocopier. In theory, it would be possible to borrow a book and then photocopy all of its pages. However, in practice, this is very inconvenient and it is probably easier to purchase another copy of the book. Similarly, in the described example of the invention, it is simpler to pay for viewing of the copyright work than spending time breaking the copyright protection scheme.","Many modifications and variations fall within the scope of the invention. For example, the running of the applet A1 may be modified according to the downloaded copyright control information CI in order to provide a restricted set of functions when operating the right mouse button on the display area . For example, operation of the right mouse button on the display area  may optionally provide a drop down menu which offers the user a copyright notice giving details of the copyright owner of the displayed image.","Also, the menu may offer an option to save the document in an unprotected format upon payment of an additional larger fee than that paid to view the image initially.","Considering the applet A1 downloaded at step S in , it may not be necessary to include the encryption and hashing algorithms EA and HA for every downloading operation. It is preferable, but not essential that the algorithms are kept secret, so that they could be pre-loaded onto the client computer, and held in a data file on its hard disc.","If the server  knows the identity of the client , at the time of requesting the applet A1, individual encryption and hashing keys can be downloaded in the Java bytecodes A1, at step S. The embedded EF file in  can then be encrypted and hashed using the individual keys, specific to the client , when the file is prepared at step S for downloading. The use of individual keys, specific to the client , improves security.","An example of how an individual key can be provided, will now be described with reference to .  illustrates an initial registration procedure by which details of the client  are made known to the web server . At step R, the client  contacts the web server  with a request to become registered for the copyright protection scheme. The web server , at step R provides the client with a program referred to herein as a dogtag. The dogtag is typically provided on a compact optical disc (CD), possibly in combination with other software, e.g. for shopping over the Internet or a micropayment scheme. By sending the CD through the postal service to a specified address, there is reasonable certainty that the client machine which runs the dogtag corresponds to the user who requested it. The CD may also include the encryption and hashing algorithms EA and HA which can be pre-loaded onto the client's hard disc.","At step R, the dogtag program is run in order to provide a machine identification code (MID) which provides a substantially unique identification of the client. The dogtag program scans the client computer both in terms of its hardware and software. Examples of characteristics of the client which can be used to form the MID are as follows:\n\n","For added security, the dogtag can only be run once for registration purposes.","At step R, the MID is uploaded through the WWW  to the web server . At step R an individual cryptographic key Kis embedded together with the MID in the bytecodes of the Java applet which is then downloaded at step R to the client  and is stored on the hard disc thereof at step R. The individual key Kactually comprises a set of keys, individually provided for each client  for use in hashing and encrypting as previously described.","Referring now to , this shows how the authentication step, step S in , can be performed, subsequent to the registration procedure of .","At step Q, the dogtag program is used to produce a current MID. This is compared, at step Q, with the MID stored on the hard disc of the client at step R, during the registration procedure. If the MIDs are the same, the current value of MID is sent at step Q to the web server .","At step Q, the web server  generates a challenge consisting of a random number, RAND, which is transmitted to the client . Then, at step Q, the client computes RESPONSE as a cryptographic function of the MID, the challenge RAND and the stored individual cryptographic key K.","At step Q, the RESPONSE is sent to the web server  through WWW . Meanwhile at step Q, the web server also generates a response, namely RESPONSE\u2032 in the same was as performed by the client . At step Q the RESPONSE is compared with RESPONSE\u2032 and if they correspond, the client has been successfully authenticated. In this situation, the BTC file can be downloaded, as shown at steps S and S in , using individual keys, specific to the client, for encryption and hashing. The keys used may be session keys, generated from key batches and a batch number.","Other forms of authentication can be used. For example, a smart card can be used in the manner of a SIM card used with GSM mobile telephones, in combination with a SIM card reader connected to the client . This has the advantage that the identity of the user is monitored rather than the identity of the client computer, so that the user can move from machine to machine and still use the service.","Referring again to , the web server  is illustrated as having different functional blocks ,  and . Block  performs the cryptographic processes associated with steps S. and S. of , block  performs the watermarking processes described with reference to step S. and block  performs the other processes. In some situations, it may be convenient to provide separate cryptographic servers and watermark servers so that the provision of keys and watermarking can be performed as a separate service to a number of different web servers.","Whilst the described example of the invention uses the Java programming language, it will be understood that other hypermedia languages may be used, for example Active X and OLE.","The registration and authentication procedure described with reference to  may also be used for other authentication processes in which a client is required to register with a web server. Thus, this procedure could be used for processes which involve other data transfer regimes between the client and server in which a registration and authentication is needed."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["In order that the invention may be more fully understood an example will now be described with reference to the accompanying drawings, in which:",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2","b":"3"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 3","b":["1","3","2"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 6","FIG. 5"],"b":"10"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 8","FIG. 6"],"b":["10","5"]},{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 9","FIG. 5"],"b":"12"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 11","FIG. 10","FIG. 5"],"b":"9"}]},"DETDESC":[{},{}]}
