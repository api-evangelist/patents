---
title: Method and arrangement for sending and receiving confidential electronic messages in a legally binding manner
abstract: In a method and arrangement for the secure transmission of at least one electronic message from a first terminal of a first user to at least one second terminal of a second user, the electronic message is generated by the first terminal. The electronic message is received by the second terminal. The electronic message is transmitted by an infrastructure for legally binding transmission of electronic messages from the first terminal to the second terminal. A first security module connected to the first terminal encrypts and/or signs the electronic message before the electronic message is transmitted by the infrastructure from the first terminal to the second terminal. A second security module, connected to the second terminal, decrypts the transmitted electronic message and/or verifies the signed electronic message.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08843746&OS=08843746&RS=08843746
owner: Francotyp-Postalia GmbH
number: 08843746
owner_city: Birkenwerder
owner_country: DE
publication_date: 20111011
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["1. Field of the Invention","The invention relates to a method and an arrangement for the secure transmission of at least one electronic message from a first terminal of a first user (sender) to at least one second terminal of a second user (recipient).","2. Description of the Prior Art","For the legally binding transmission of electronic messages between two terminals, the E-POST system of the Deutsche Post AG and the DE-Mail System are known, which respectively are to enable the legally binding and confidential exchange of electronic documents between citizens, offices and companies via the Internet. The main objective of these systems is to be able to make deliveries via the Internet in a legally binding manner. Moreover, in the case of the DE-Mail System the data transmission between the Internet service provider of the sender and the Internet service provider of the recipient takes place in an encrypted manner. However, with these existing systems, unauthorized access to the data of the electronic message is possible at least at the provider itself or the providers themselves when the administrator rights are used accordingly.","Likewise, during the transmission of the electronic messages from the terminal of the sender to the provider and from the provider to the terminal of the recipient unauthorized access to the data of the electronic message can take place. Here, both the manipulation of the message and unauthorized access to the information of the message are considered as unauthorized access.","It is an object of the invention to ensure a secure transmission of an electronic message from a first terminal of a first user to at least one second terminal of a second user while using an infrastructure for the legally binding transmission of electronic messages without having to trust the operator of this infrastructure that he does neither spy out nor modify the sent message content.","In the inventive method and arrangement the security modules that are provided at the sender side and at the recipient side implement a cryptographic processing of the data of the electronic message so that an end-to-end encryption of the message between the first terminal and the second terminal is easily possible. As a result, unauthorized access to the information of the electronic message by the instances involved in the provision of the infrastructure for the legally binding transmission of electronic messages, such as an Internet service provider, and thus a manipulation of the electronic message are reliably prevented, even if the Internet service provider were to misuse its administrator rights for such purposes. Here, the first user is preferably the sender, and the second user is the recipient.","It is advantageous when the first security module is connected to the first terminal via a first data transmission connection and\/or the second security module and the second terminal are connected via a second data transmission connection. Here, the first data transmission connection and\/or the second data transmission connection can in particular be a transmission channel in a network, preferably a transmission channel in a wireless network. Alternatively, the first data transmission connection can be provided by a bus system of the first terminal and\/or by a standardized application interface. Further, the second data transmission connection can be provided by a bus system of the second terminal and\/or by a standardized application interface. The application interfaces can in particular be provided by software and are also referred to as API (application programming interface). As a bus system, in particular an internal bus system of the first terminal, such as a PCI bus, a PCI Express bus, an ISA bus, a universal serial bus or a suitable other data bus can be used.","By way of the indicated connection options between the security module and the terminal, different designs of the security module can be provided, in particular it can be provided as a separate terminal, as a unit of the terminal or as a software module executed by the terminal.","In an embodiment of the invention, the electronic message is transmitted by means of the infrastructure for the legally binding transmission of electronic messages from the first terminal to a provider and the message is transmitted from the provider to the second terminal. Alternatively or additionally, the electronic message transmitted from the first terminal to the provider can be encrypted by the provider. This provider is a first provider. The encrypted electronic message can then be transmitted from the first provider to a second provider. Subsequently, the message is decrypted by the second provider and transmitted to the second terminal. As a result thereof, an encryption of the electronic message as required according to the infrastructure for the legally binding transmission of electronic messages takes place during its transmission between two providers.","Preferably, the infrastructure for legally binding electronic messages comprises at least one, preferably all of the following functions and services:\n\n","By means of this infrastructure, it is guaranteed that the regulations to be complied with for legally binding electronic messages can easily be complied with.","Further, it is advantageous to provide at least one data processing unit for providing services for the secure transmission of electronic messages, by which unit the sending of encrypted and\/or signed electronic messages is enabled. Enabling of the sending of the encrypted and\/or signed electronic messages can in particular take place dependent on the payment of a fee. Alternatively or additionally, this data processing unit can provide a user administration service for the registration of the users whose user identity is stored in the first and\/or the second security module. In this way, a user administration that is independent of the infrastructure can be provided for the secure transmission of the electronic messages according to the invention.","It is particularly advantageous when an identification service for the identification of a user registered in the security module is provided by the first security module and\/or by the second security module, wherein the user is identified by means of a user login such as user name and password, a user login with the aid of biometric data of the user which are sensed by means of a biometric sensor, a security module connected via the Internet and\/or via a wireless data transmission connection, and\/or a chip card. This allows for an easy identification of the user by the security module. After identification of the user and authentication of the user, in particular user information stored in the security module can be used for identifying the user at components of the infrastructure for the legally binding transmission of electronic messages. In this way, an easy and secure identification and authentication of the user is possible both at the security module and the infrastructure for the transmission of electronic messages.","When identifying the first user and\/or the second user via the security module of their respective terminal, a mobile transaction number that is transmitted from the infrastructure for the legally binding transmission of electronic messages to the E-Postage provider and from there to the security module can be identified, the first terminal sending a request for sending the mobile transaction number to the infrastructure and a transaction number being generated by a data processing unit of the infrastructure and being transmitted to the E-Postage provider and from there to the security module of the terminal of the user. This provides an easy and efficient possibility of enabling access only for the user who is in possession of the security module to which the transaction number is finally transmitted.","The transmission of the mobile transaction number from the Internet service provider to the E-Postage provider takes place either via a wired link or via a radio network (e.g. GSM, GPRS, UMTS), wherein the E-Postage provider respectively provides one own user account for the first and the second user (A), (B). The transmission of a mobile transaction number from the E-Postage provider to the security module takes place via the encrypted communication channel (). Here, the information can be transmitted either via a wired link (e.g. Internet) or via a radio network (e.g. GSM, GPRS, UMTS).","Further, it is advantageous when the electronic message is transmitted via a secure data connection to the provider, the secure data connection being established between the respective terminal and the provider. The cryptographically secured identity of the provider is then preferably verified by the first terminal. Preferably, this verification takes place with the aid of a cryptographic certificate that is available to the first terminal. This certificate is preferably stored in a storage area of the first security module. The use of a cryptographic certificate prevents an easy manipulation of the certificate. When high security standards are met, such a certificate only has to be renewed every one to five years, preferably every three years. By using the certificate, it can be verified by the security module whether the secure data connection is actually established to the desired provider or whether the destination address of the provider has been manipulated and another unwanted user has taken the place of the provider, to whom a secure data connection would then be established without verification of the identity of the provider. This prevents that the secure data transmission connection is rerouted to an unwanted user. As a result thereof, the security of the data transmission can be increased and manipulations of the electronic message and unauthorized access to the electronic message are prevented.","Further, it is advantageous when information about the secure identity of the respective security module is requested by the respective terminal and is transmitted from the respective security module to the respective terminal. The respective terminal is then identified at the provider with the aid of this information. In this way, the first terminal can, for example, request information from the first security module about its secure identity, the first security module transmitting this information to the first terminal. Likewise, the second terminal can request information about the secure identity of the second security module from the second security module, which information is then transmitted from the second security module to the second terminal. This allows for an easy identification of the terminal at the provider with the aid of the secure identity of the security module. In particular, for several users several secure identities can be stored in the security module, which identities can then be read out from the security module and transmitted to the respective terminal connected to the security module in the case of a user login of a user for whom information about its secure identity is stored in the security module. With the aid of this information allocated to the user, the terminal can then identify the terminal and\/or the user at the provider. In this way, an easy and secure identification of the user and\/or the terminal at the provider is possible.","A first user registered in the first security module is preferably a legal person. A second user registered in the first security module is a natural person who after login at the first terminal and\/or at the first security module can send a message in the name of the first user in a legally binding manner. In addition, the second user can receive messages for the first user, the security module then decrypting encrypted electronic messages and\/or verifying signed electronic messages.","In a further advantageous embodiment of the invention, an account information is stored at least in the first security module. This account information comprises the accessibility of an account storage element which is in particular allocated to a user and\/or the security module. From a value stored in the account storage element then a preset amount is deducted when an electronic message is encrypted by the first security module, which message is then sent by means of the first terminal and transmitted to the second terminal by means of the infrastructure. After the deduction of the amount from the stored value, the first security module and\/or a central data processing unit can then additionally or alternatively send release information to the provider, which information is necessary so that the provider forwards the message to the recipient. The release information sent to the provider can in particular comprise payment information, dependent on which the provider forwards the electronic message. In this way, an easy payment of the fees charged by the provider for the handling of the electronic message to be sent and of fees charged for the inventive encryption and\/or signing is achieved. In particular, no further operating steps of the user are necessary for this.","For the encryption and\/or the signing of the electronic message, the first terminal preferably transmits at least the message content, at least one piece of information on the recipient and optionally one of the following information to the first security module:\n\n","In this way, the security module is easily provided with information on the encryption, the signing and\/or the billing of the electronic message.","Further, it is advantageous when a private key of the recipient for encrypting the electronic message and\/or a signature key for signing the electronic message is stored in a storage area of the first security module and\/or in a storage area of a central data processing unit. The key of the recipient for encrypting the electronic message and\/or the signature key can be read out from the central data processing unit. This key or, respectively, these keys are used by the security module to encrypt or, respectively, sign the message. This allows for an easy key administration in the security module itself and\/or in the central data processing unit.","Further, it is advantageous when the first security module and\/or the second security module are a component integrated into the terminal. This component is preferably connected to further components of the first or, respectively second terminal via a data bus. Alternatively, the security module can be provided by software executed by the terminal. This offers two advantageous possibilities of providing the security module.","In an embodiment of the invention, information can be transmitted via the respective terminal between the respective security module and a provider who provides at least a part of the infrastructure for the legally binding transmission of legally binding electronic messages. Preferably, no direct data transmission is possible between the security module and the provider. As a result thereof, an additional protection of the security module is achieved as no direct external accesses to the security module are possible. Preferably, between the security module and the respective terminal only a data exchange according to a preset protocol is possible which only provides specific instructions and data exchange steps required for the secure transmission of legally binding electronic messages so that a manipulation of the security module is effectively prevented.","Every service provider who provides the transmission of data at least over a section between the first terminal and the second terminal is regarded as a provider in the sense of the invention. Such providers are in particular Internet service providers, email providers and\/or telecommunications providers. These providers in particular provide services and\/or infrastructure for the legally binding transmission of messages.","In , a block diagram of an arrangement  for the secure legally binding transmission of email messages between a first end user system  of a user A and a second end user system  of a user B is illustrated. In the arrangement , a national and\/or international infrastructure for legally binding emails is schematically illustrated as a block , the services required for this infrastructure  being provided by different data processing units, in particular by Internet service providers ,  and\/or further data processing systems that can be contacted via the Internet . In addition to the infrastructure  and the Internet service providers , , the end user systems ,  are connected via data transmission links ,  to a so-called electronic postage provider (EPP) . By the electronic postage provider  services are provided which enable and support the secure transmission of legally binding electronic messages, such as email messages. The electronic postage provider  is connected via a data transmission link  indicated by the arrow to further data processing units (not illustrated) of the infrastructure .","The communication between the end user system  and the electronic postage provider  can in particular take place via the same data line or the same Internet connection of the respective end user system  as the connection to the Internet service provider , . The end user system  comprises a personal computer  which serves as a terminal for generating email messages, for sending these email messages after generation and for receiving email messages. In connection with the Internet service provider  and the further infrastructure , it is possible to transmit with the aid of the personal computer  legally binding email messages to at least one further end user system  and to receive legally binding email messages sent from the further end user system . The end user system  comprises a security module  connected to the personal computer  via at least one interface , which security module is arranged in a postage meter in the present embodiment. Between the security module  and the infrastructure , data can be exchanged via the data transmission links  and , and in particular data with access information and\/or authentication information can be transmitted from a service of the infrastructure  to the security module  via a secure channel. As an alternative to the transmission link  in the form of a wired link, also a radio network connection, such as WLAN, GSM, UMTS, can be used. In this case, the security module  itself would be equipped with an antenna and a radio network controller.","Between the personal computer  and the Internet service provider , a data connection can be established via a data transmission link , by means of which data connection the personal computer  can access the email services of the Internet service provider  and the Internet . Legally binding email messages to be sent from the personal computer  and legally binding email messages to be received by the personal computer  are transmitted between the personal computer  and the Internet service provider  preferably via the data transmission link  with the aid of a secure data connection.","The second end user system  comprises a personal computer  as a second terminal of the arrangement  as well as a security module  connected to the personal computer  via a data interface , which security module  is arranged in a postage meter, just like the security module . Between the security module  and the infrastructure , data can be exchanged via the data transmission links  and  and in particular data with access information and\/or authentication information can be transmitted from a service of the infrastructure  to the security module . As an alternative to the wired transmission link , also a radio network connection, such as WLAN, UMTS, GSM, can be used. In this case, the security module  itself would be equipped with an antenna and a radio network controller.","For the registration of a user A at the personal computer  for the sending and\/or receiving services for sending and\/or receiving legally binding email messages, an authentication request is transmitted from the personal computer  via the data connection  to the Internet service provider  which forwards this request to an authentication service of the infrastructure . The infrastructure  generates a transaction number and transmits this transaction number via the data transmission links  and  to the security module . After receipt of this transaction number, the security module  forwards this transaction number via the interface  to the personal computer  and in this way registers the user. Alternatively or additionally, the user can log in at the security module  in that a biometric characteristic of the user is sensed by means of a biometric sensor. Alternatively or additionally, an authentication of the user can take place by means of a signature read out from a chip card, which signature is read from the chip card by means of a reading unit after insertion of the chip card by the user A and is then used for authentication of the user. The chip card can be read with a reading unit of the personal computer  or by means of a reading unit of the security module .","Via the data connection , a communication interface between the end user system  and the Internet service provider  is provided, via which sending and receiving of secure legally binding email messages as well as receiving confirmations of delivery and confirmations of receipt, access to a central address directory, a mail box administration and\/or an archiving service for email messages and attached documents is possible. The establishment of a secure connection via the data transmission link  takes place, for example, by means of a unidirectional software key management on the basis of HTTPS\/SSL or TLS. Here, the personal computer  verifies in particular the cryptographically secured identity of the Internet service provider , for example, via user certificates that are firmly integrated into the software executed by the personal computer . The personal computer  reads out information about the secure identity of the security module  from the security module  and identifies itself as the terminal  of the user A at the Internet service provider  with the aid of this information. Further, the personal computer  transmits the data to be encrypted of the legally binding email message to be sent via the interface  to the security module  which then encrypts and\/or signs the data dependent on demand. Dependent on the demand and the payment conditions stored for the respective user A, B, an account in credit administered in the security module  by means of an account storage element is debited. The security module  in particular provides the following services:\n\n","Further, a data transmission link  is provided between the personal computer  and the electronic postage provider . The data transmission link  can, for example, be provided by a secure data transmission connection via the Internet . Via the data transmission link , a registration of the security module at the electronic postage provider takes place. This registration is repeated for each new user A, B to be registered at the security module . Further, a verification of the identity of the security module  takes place via the data transmission link  prior to an electronic transaction, i.e. prior to every encryption and\/or signing of an email to be sent and prior to the decryption and\/or verification of the signature of a received email.","Further, the account in credit of the security module  can be loaded via the data transmission link  when the electronic postage provider  receives payment for the user A or for the security module via a bank interface  from a bank . The electronic postage provider  preferably has at least two data processing units, a first data processing unit  for the administration of users and their public keys for the encryption of messages as well as, if applicable, of signature keys, and at least one second data processing unit  for fee administration as well as for the administration of accounts in credit of the users A, B or, respectively accounts in credit of the security modules , . Further, via the data transmission channel  further administrative transactions, such as the disabling and enabling of the security module , the loading of tariff tables with fees for possible transactions etc. can automatically be implemented.","The establishment of the secure data transmission connection via the data transmission channel  takes place, for example, via a bidirectional hardware key management on the basis of the Diffie-Hellmann method. Here, the security module  can verify the identity of the electronic postage provider . As already mentioned, this can take place via root certificates that are stored in the security module  and are preferably only readable. The electronic postage provider  can verify the identity of the security module  in particular with the aid of a key of the security module  stored in a data base of the electronic postage provider . For this, several keys can be stored in a key directory which is accessed with the aid of a lightweight directory access protocol (LDAP) (LDAP key directory).","In case the security module of the recipient is designed in the form of software, the sender will preferably use a fresh secret message key to encrypt the message to be sent and to implicitly authenticate it as a result thereof. The used secret message key is directly sent by the sender, for example as an SMS message, to the recipient who enters the key into its software security module.","The Internet service provider  has at least two data processing units, in particular a security server  and an accounting server  for accounting fees charged during handling of legally binding email messages. These are fees which the respective end user A, B has to pay when sending a legally binding email message as well as fees which the service providers ,  charge among each other when sending legally binding email messages.","The accounting server  further has a bank interface  via which data can be exchanged between the accounting server  and the bank  or a further bank. As in the case of the first Internet service provider , the second Internet service provider  has a security server  and an accounting server . The accounting server  is connected to the bank  via a bank interface  via which data in particular with payment information can be exchanged. Via the bank interfaces , , the Internet service providers ,  receive information on incoming payments for the user accounts of the users A and\/or B and via the bank interface  the electronic postage provider  receives information on incoming payments for the user accounts of the users A and\/or B. The accounting servers ,  of the Internet service providers ,  are connected to the accounting server  via a respective data transmission link ,  so that information on incoming payments and\/or payments for the user accounts of the users A, B can likewise be transmitted between the accounting server  of the electronic postage provider  and the accounting servers ,  of the Internet service providers , .","Further, the Internet service providers ,  are connected via a respective data transmission link ,  to further services of the infrastructure  for legally binding email messages. With the aid of these services, in particular a secure data exchange between the Internet service providers ,  is possible so that secure identification information of end users A, B can be queried. Further, by the services of the infrastructure, a registration service for end users can be provided.","The servers ,  of the first Internet service provider , the servers ,  of the second Internet service provider  and the data processing units ,  of the electronic postage provider  are each connected to one another via suitable data transmission connections, like via an internal network. Via the data transmission connections , , the electronic postage provider  receives accounting information for the respective end user A, B from the Internet service providers , . For settlement of these invoice amounts, the electronic postage provider  instructs the bank  via the bank interface  to credit the invoice amount of the invoice information to the account of the Internet service provider , . The bank  transmits a corresponding payment information via the data transmission channels ,  to the respective Internet service provider , . Via the bank interface , the electronic postage provider  receives a message about a payment of the end users A, B to their accounts in credit. The respective credit amounts are then available to the customers in the form of electronic postage for download onto their security module ,  via the data transmission link , . The communication between the components , ,  of the second end user system  among each other and with the second Internet service provider as well as with the electronic postage provider  takes place in the same manner as described for the components , , , the first Internet service provider  and the electronic postage provider .","In the following, the operational sequences for message transmission and message processing between the components of the arrangement  are described. The personal computer  serves as an intermediary between the security module  and the Internet service provider  so that no direct connection, in particular no online connection can be established between the security module  and the security server  of the Internet service provider . Between the electronic postage provider  and each Internet service provider ,  a manually secured transmission of an electronic postage provider verification key takes place. By means of this key, the respective Internet service provider ,  then verifies the certificate chains of all security modules , .","The registration of a new user C by an Internet service provider  can take place as explained in the following. In a first step, the personal computer requests an ID of the security module  from the security module . Then, the security module  sends its ID with several certificates, the first certificate comprising the identity of the security module , a time stamp, user data such as company, address, contact and, if used, a mobile transaction number that has been signed by the security module. A further certificate can be a public key certificate of the security module  that has previously been certified by the electronic postage provider .","The personal computer  forwards the ID of the security module  together with the certificates to the Internet service provider . Given this way of proceeding, the personal computer  acted as an intermediary (relay) between the security module  and the Internet service provider  so that no online connection is required between the security module  and the security server  of the Internet service provider . Preferably, a data transmission protocol is used for the transmission of data between the Internet service provider  and the personal computer  that is different from the one used for the transmission between the personal computer  and the security module .","Thereafter, the Internet service provider  verifies the ID of the security module  for validity, verifies whether the time stamp is current, and verifies the transmitted certificates with the aid of the public key of the electronic postage provider . If these verifications are successful, the Internet service provider  registers the user C and stores identification features of the user C in connection with the security module , in particular in connection with the ID of the security module . In this way, a user C is registered at the Internet service provider for legally binding emails and, subsequently, the user can log in at the Internet service provider via the data transmission channel  to send and receive legally binding emails, as this will be explained in the following for the user A.","For sending a secure legally binding email message according to the invention, a login of the user A takes place via the personal computer  at the Internet service provider  and at the electronic postage provider . For this, when using a mobile transaction number, a request for a mobile transaction number can be transmitted from the personal computer  via the data transmission channel  to the Internet service provider  which then forwards this request via the data transmission channel  to a corresponding service of the infrastructure . The mobile transaction number is then generated by this service and transmitted to the security module . In the case of a radio network connection to the security module, the transaction number is preferably transmitted to the security module  with the aid of the short message service. The data of the email message to be sent including possible attachments are transmitted from the personal computer  to the security module . Additionally, a recipient ID and\/or other information on the recipient are transmitted from the personal computer  to the security module . Further, information is transmitted as to whether the message content is to be signed with the aid of a publicly verifiable signature. Further, information can be transmitted from the personal computer  to the security module  as to whether a separate time stamp is requested for the message to be sent. Further, if available, a public key of the recipient of the message is transmitted for encrypting the message content of the email message from the personal computer  to the security module , as well as information on the accounting mode, i.e. whether the fees to be paid to the electronic postage provider  for encrypting and\/or signing the message and\/or the fees to be paid to the Internet service provider  for sending the legally binding email messages are to be paid via accounts in credit at the bank  or via accounts in credit at the electronic postage provider  and\/or at the Internet service provider .","When the public key of the message recipient is not transmitted from the personal computer  to the security module  or for verifying the transmitted public key of the message recipient, a public key of the recipient is read out from the storage area of the security module  and\/or requested by the security module  via the personal computer  at the electronic postage provider . Upon request of the public key at the electronic postage provider , this key is read out from the key server  and is transmitted in the personal computer  to the security module . The security module  verifies whether, for the selected accounting mode, sufficient credit balance is available for the user A to pay the fees that incur. If this is not the case, a respective error message is transmitted from the security module  to the personal computer . If an individual time stamp is requested for the message, this time stamp is attached to the message. If a publicly verifiable signature is necessary, the message content is signed with a secret key, and thereafter, the message including the signature is encrypted with the aid of the public key of the recipient. Alternatively, a symmetric encryption mode with integrity check can be used, and the symmetric session key used thereby can be encrypted with the public key of the recipient. The encrypted message can be preceded by the sender ID. The sender ID is preferably the ID of the security module . Alternatively or additionally, also the user ID of the user A can be added.","The fees to be paid for the encryption and\/or signature service of the security module  are deducted in the security module  from a credit balance stored in an account storage element. Thereafter, the encrypted and\/or signed message is transmitted from the security module  to the personal computer . After encrypting and\/or signing the message, the security module compiles a correctly formatted email message which contains the message protected between the end user systems , . For transmitting the message from the first terminal  to the Internet service provider , the user is logged in at the Internet service provider  with the aid of the received mobile transaction number or an alternative identification feature such as a user login by user name and password, an identification by biometric data and\/or by a certificate read out from a storage element such as a chip card or a certificate generated by an algorithm. After login, the email message can be transmitted via the data transmission channel  from the personal computer  to the Internet service provider  which then forwards this message to the end user system of the recipient . In the present embodiment, the email message is transmitted from the first Internet service provider  via the Internet  to the second Internet service provider  and from there, after a user login via the end user system , transmitted to the end user system .","For retrieving a received email by the end user system  at the Internet service provider , a mobile transaction number is requested from a service of the infrastructure  in charge thereof via the personal computer  and the Internet service provider , which transaction number is transmitted to the security module . With the aid of this mobile transaction number, the user is preferably logged in at the Internet provider  with the aid of user information such a user name already sent when requesting the mobile transaction number. As an alternative to the mobile transaction number, other identification features can be used.","After successful login at the Internet service provider , the personal computer  retrieves the email message stored at the Internet service provider  so that the data of the email message are transmitted from the Internet service provider  to the personal computer . The encrypted and\/or signed email message is transmitted from the personal computer  to the security module . From the sent email message, the security module  determines the recipient ID and determines the private key stored in the security module  for the recipient ID and decrypts the email message with the aid of the private key. Alternatively or additionally, a verification of the message content takes place with the aid of a signature verification key of the sender, which key is preferably attached to the message or is obtained from the public key directory of the electronic postage provider .","When the message transmitted from the personal computer  to the security module  contains a publicly verifiable signature, then the public key of the sender is used to verify this public signature. The decrypted message content is provided with additional information as to whether a possibly implemented signature verification or an integrity check had been successful. If the message comprises a time stamp, it is added to the decrypted message. The decrypted message and, if applicable, the additional information are transmitted from the security module  to the personal computer . The personal computer  processes the additional information transmitted from the security module  to the personal computer  together with the decrypted message and compiles a correctly formatted email message from the decrypted message content, which email message is then available in the personal computer . The content of the email message can then in particular be output via a display unit of the personal computer . Further, the additional information such as the successful signature verification and a time stamp can be displayed to the recipient B in addition to the message content.","As can be taken from the arrangement  according to , the end user systems  and  are connected to their respective Internet service provider ,  as well as to the central electronic postage provider  via similar data transmission channels and interfaces, the end user systems ,  as well as the other components of the arrangement  being designed such that secure legally binding email messages can be transmitted both from the end user system  to the end user system  as well as from the end user system  to the end user system . The sending of emails from the end user system  can take place in the same manner as described for the end user system . The receiving of the email messages by means of the end user system  takes place in the same manner as described for the end user system .","When biometric data are used for identifying a user, biometric data of the user A can be sensed by means of a biometric sensor of the end user system  and transmitted to the Internet service provider  which compares the transmitted data with stored biometric reference patterns.","Further, a user logged in at the security module , can use the user identity of a third user C for sending and receiving secure legally binding emails when the user has been authorized for it by an administrator. This is in particular advantageous when the third user C is a legal person such as a company. Thus, an identification of a user can take place on behalf of a third user. For this, a user identity of the third user C is stored in the security module  and can be used by every user A of the personal computer  registered in the security module  and authorized for sending messages for the third user C or, respectively, for receiving messages for the third user C.","Access to the security module  can then be protected by a PIN mechanism (PIN\u2014personal identification number). A system for the verification of the user identity can, for example, comprise a transaction number generator which generates a deterministic sequence of pseudorandom transaction numbers by means of a trapdoor one-way function by using a private key whose public counter-part is stored for verification of the transaction numbers during registration of the security module  at the Internet service provider .","In the security module, the PINs, the private key as well as the program for calculating the trapdoor one-way function are stored in a non-volatile memory of the security module . Apart from the last used transaction number, the trapdoor one-way function also takes into account specific order data, e.g. a hash value, of the message to be transmitted. On the basis of the previous transaction number and the current order data as well as the public key of the security module , the Internet service provider  verifies for each incoming transaction number whether the current transaction number is valid. Such a way of proceeding is in particular suitable when using the security module  in companies in which several employees of the company are authorized for access to the security module .","For increasing the security, a time limit for the validity of the identification features of one or of all users can be provided by the security module  and\/or the Internet service provider . Alternatively or additionally, the validity of the identification features of an end user can be limited to a preset number of verification procedures.",{"@attributes":{"id":"p-0061","num":"0076"},"figref":["FIG. 2","FIG. 1"],"b":["12","26","28","12","26","22","24","18","22","12","24","18","22"]},"The Internet service provider  is also connected to the telecommunications network  so that a mobile transaction number requested by the end user system  can be transmitted from the Internet service provider  via the electronic postage provider  to the security module .","Basically, the communication links as well as the establishment of the data transmission channels are always initiated by the end user system , preferably only by the terminal .","In , a block diagram with components of the end user system  is shown, The personal computer  of the end user system  has several components, which comprise a RAM element , a ROM element , a keyboard and a display , a processor , an NVRAM element , further peripheral devices  as well as a network controller . The components are connected to one another in the personal computer  via respective data lines and bus systems. Via the network controller , the personal computer  is connected to the internal network  of the end user system . The security module  comprises a RAM element , a ROM element , a tamper controller , an NVRAM element  or another non-volatile memory as well as a processor  and a network controller . Such a tamper controller  is an electronic monitoring circuit which detects whenever a small constant current flowing through a conductive meander completely surrounding the security module is interrupted. Such an interruption is considered as a manipulation attempt and results in the active deletion and destruction of the private cryptographic keys of the security module  to effectively and immediately prevent that these are spied out.","Via the network controller , the security module  is connected to the internal network . Preferably, the network  comprises a network switch . Via the internal network , a data exchange is possible between the personal computer  and the security module . Further, a firewall  is connected to the internal network . Via the firewall , a connection can be established from the personal computer  to the Internet . A data connection from the security module  to the Internet  and from the Internet  to the security module  is prevented by the firewall .","It is particularly advantageous to design the security module ,  as an independent external device that is connectable to the terminal  via a network connection. In the present embodiment, the terminal is designed as a personal computer . However, in other embodiments, the terminal can be any arbitrary other data processing device such as a laptop, a mobile phone, in particular a smartphone, a tablet PC or any other arbitrary device with which email messages can be received and\/or sent.","As already mentioned, the security module  can also be integrated in a postage meter which serves to frank mail. Further, the security module can also be implemented in the personal computer  as software.","In particular, a modified Blum Blum Shub generator can be used as a trapdoor one-way function. In this connection, a composite integer of sufficient length, at present of 2048 bit, can be used as a public key. The public key is formed by the equation n=p*q, wherein the factors p and q are prime numbers of approximately the same length (difference in length of about 10 bit), wherein both factors are congruent to 3 (mod 4). The security module  calculates the initial state according to the equation s=t(mod n), wherein t is an arbitrarily chosen number greater than 1 and smaller n. The private key is composed of the number pair p and q. The associated public key which is stored at the Internet service provider  and\/or at the electronic postage provider  comprises sand n. For every order i+1, by which, for example, the message m is to be transmitted as an email message, a transaction number generator generates a transaction number TANand updates its state sinto saccording to the following rule:","s\u2190Error! Objects cannot be created from editing field codes.(mod n), wherein sdesignates the internal state of the transaction number generator after the order and h designates a one-way hash function that provides values having a constant length of 2048 bit.","Then, the result sis output as TAN.","The Internet service provider as verification instance verifies the validity of the transmitted TANaccording to the following rule: The TANis assumed as sfor the reconstruction of the internal state of the sender side, wherein the validity is verified according to the following equation\n\n()=(mod ),\n\nwherein sdesignates the internal state of the generator after the order i.\n","In alternative embodiments of the invention, also only one Internet service provider can be provided, which carries out both the communication with the end user system  and the end user system . As an alternative to an Internet service provider, the function of the provider or, respectively, of the Internet service provider described in the embodiments and in connection with the invention can also be provided by an email service provider which does not allow access to the Internet for the end user system , . Rather, the final access to the Internet  is provided by a separate Internet service provider or another access, and the data transmission via the Internet  is used for communication with the email provider. The communication of the components of the end user system  with the Internet service provider  and with the electronic postage provider  as well as with the infrastructure for legally binding email messages has mainly been described for the end user system , the Internet service provider  and the electronic postage provider . The communication of the components of the end user system  among each other, between the end user system  and the Internet service provider  and between the end user system  and the electronic postage provider  takes place accordingly. When the communication of the end user systems ,  for sending the legally binding email takes place via one provider ,  only, then the encrypted transmission of the legally binding email between the servers ,  of the providers ,  via the Internet  can be dispensed with.","Although modifications and changes may be suggested by those skilled in the art, it is the intention of the inventor to embody within the patent warranted hereon all changes and modifications as reasonably and properly come within the scope of his contribution to the art."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0028","num":"0039"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0029","num":"0040"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0030","num":"0041"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
