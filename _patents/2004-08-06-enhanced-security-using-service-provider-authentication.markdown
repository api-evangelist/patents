---
title: Enhanced security using service provider authentication
abstract: A method () and an apparatus (e.g., a network node ()) for providing enhanced security using service provider authentication. In addition to authenticating an application signature () against a root certificate () stored on the network node (), a first carrier identification () associated with the application () is compared to a second carrier identification (). If the first and second carrier identifications match, then the application can be assigned to a trusted protection domain and granted permissions which provide privileged access to the network node. For example, the application can be granted permission to be installed and/or executed on the network node. Otherwise the application can be denied privileged access. Accordingly, a carrier's applications will be only installed onto network nodes that are intended recipients of the applications.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09313214&OS=09313214&RS=09313214
owner: GOOGLE TECHNOLOGY HOLDINGS LLC
number: 09313214
owner_city: Mountain View
owner_country: US
publication_date: 20040806
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","The present invention relates to communications networks, and more particularly to wireless communications networks.","2. Description of Related Art","Mobile Information Device Profile (MIDP), together with Connected Limited Device Configuration (CLDC), is a portable code runtime environment for resource-constrained devices, such as mobile telephones and personal digital assistants (PDAs). An example of a portable code environment is that known by the trade name Java, developed by Sun Microsystems, Inc. In this runtime environment, the CLDC defines a base set of application programming interfaces and a virtual machine used by the devices, and the MIDP specification defines a platform for dynamically and securely deploying networked applications to the devices. Notably, developers using MIDP can write applications once, and then deploy them to a wide variety of mobile communication devices. Such applications are referred to as MIDlets.","A MIDlet suite is a package of one or more MIDlets and consists of a Java Descriptor (JAD) file, a Java Archive (JAR) file and a manifest describing the contents of the JAR file. The JAD file contains attributes used by application management software to manage life-cycles of the MIDlets, as well as the application-specific attributes the MIDlet suite itself will use. The JAR file contains the Java class files for the MIDlet suite. Metainformation about these class files is included in the manifest.","MIDP increases access to data and services on a device, and thus a level of trust must be established between the application, the device, and the user. In version 2.0 of the MIDP, this level of trust is established using protection domains. A protection domain defines a collection of permissions that can be granted to a MiDlet suite, including access to privileged functionality on a device.","A MIDlet suite can be bound to a protection domain by properly signing the MIDlet suite in accordance with the X.509 Public Key Infrastructure (PKI) security standard. The signature process includes signing the JAR file with a signature created using a signer's private key. Together with the signature, signer certificates containing the signer's public key then are added as attributes to the JAD file. Finally, root certificates are distributed to devices on which the MiDlets will be executed to establish a basis of trust for MIDlets signed in accordance with the PKI security standard. A root certificate is an unsigned or self-signed X.509 public key certificate. A root certificate typically includes a signature from a certificate authority which confirms its authenticity.","When a MIDlet suite is downloaded to a device, the signature and signer certificates of the MIDlet suite are authenticated against the root certificates stored on the device. If the signature and signer certificates match a root certificate associated with a particular protection domain, the MIDlet suite will be bound to the protection domain and granted permissions defined therein. If the signature or signer certificates do not match a root certificate stored on the device, the MIDlet suite is assigned an untrusted status. Thus, the MIDlet suite will be denied access to privileged functionality on the device.","A carrier signed Java application will be trusted on all mobile communication devices having the appropriate root certificate. However, different carriers oftentimes use mobile communication devices having the same root certificates. In consequence, Java applications sometimes will be provided access to privileged functionality on devices for which the Java applications are not intended. Importantly, a particular carrier may not want its Java applications to be provided to devices which subscribe to another carrier. For example, carriers often provide games intended for their subscribers which can be downloaded over the Internet and transferred to a mobile communication device using a personal computer. A carrier probably would not want such games to be available to devices subscribing to another carrier. Similarly, if a mobile communication device subscribing to a first carrier is in roam mode and temporarily using a second carrier, that carrier may automatically download an application intended for the second carrier's subscribers, but which is of no use to the device. A user of the device probably would not want to tie up resources, which are already limited, with such an application.","An embodiment in accordance with the present invention relates to a method and an apparatus for providing enhanced application security using service provider authentication. More particularly, when an application is loaded to a network node, in addition to authenticating an application signature against a root certificate stored on the network node, a first carrier identification associated with the application is compared to a second carrier identification. If the first and second carrier identifications match, then the application can be assigned to a trusted protection domain and granted permissions which provide privileged access to the network node. For example, the application can be granted permission to be installed and\/or executed on the network node. Otherwise the application can be denied privileged access. Accordingly, a carrier's applications will be only installed onto network nodes that are intended recipients of the applications.","The communications network can be a wireless communications network. For example, the network node can be a mobile communication device. If the network node complies with the Mobile Information Device Profile (MIDP), the first carrier identification can be identified a MIDlet suite containing the application. For example, the MIDlet suite can be parsed and the carrier identification can be identified in the parsed MIDlet suite. The first carrier identification can be identified in a manifest of a Java Archive (JAR) file and\/or a Java Descriptor (JAD) file contained in the MIDlet suite. The second carrier identification can be received over the communications network or retrieved from a data store within the network node. In one arrangement, the data store can be a subscriber identity module (SIM) card.","An embodiment in accordance with the present invention relates to a method for providing enhanced application security using service provider authentication. More particularly, when an application is loaded to a network node, in addition to authenticating an application signature against a root certificate, a first carrier identification associated with the application is compared to a second carrier identification associated with the network node. The second carrier identification can be pre-stored on the network node, or provided to the network node when required. If the first and second carrier identifications match, then the application may be granted access to privileged functionality on the network node. For example, the application can be installed onto the network node. If the first and second identifications do not match, however, access to privileged functionality can be denied.","A flowchart is shown in  that is useful for understanding the method. As illustrated therein, the method  can include several steps beginning at step  with a network node receiving an application over a communications network. For example, an application can be received from a content provider over a landline and\/or a wireless communications link. In an arrangement in which the runtime environment of the network node is Mobile Information Device Profile (MIDP), the application can be a MIDlet contained in a MIDlet suite. The invention is not limited in this regard, however, and the application can be any type of application that can be propagated over a communications network and installed\/executed on a network node.","The application can be associated with security information that is used to establish a level of trust for the application. As defined herein, associating the application with security information can mean providing an identifier in the application which identifies a security file having the security information, providing an identifier in a file having the security information which identifies the application, or incorporating the security information into the application itself. For example, as those skilled in the art will appreciate, a signature and signer's certificates can be incorporated into the application in compliance with the X.509 Public Key Infrastructure (PKI) security standard. The invention is not so limited, however, and the skilled artisan will also appreciate that other security protocols can be implemented. At step , the security information associated with the application can be authenticated against a root certificate stored on the network node to determine whether the application is bound to a trusted protection domain.","Referring to decision box  and step , if the application is not bound to a trusted protection domain the application can be denied access to privileged functionality on the network node. For example, the application can be assigned to an untrusted protection domain and processed accordingly. For instance, a message can be provided on the network node to alert a user that the application is untrusted. The user then can be prompted to enter a particular user input if he wishes to proceed with installation and\/or execution of the application.","If the application is bound to a trusted protection domain, a first carrier identification that is associated with the application can be compared to a second carrier identification associated with the network node, as shown in step . The first carrier identification can identify the carrier whose customers are the intended recipients of the application, and can be provided in a file that is received with the application. For example, the first carrier identification can be provided in the root certificate associated with the application or embedded within the application. The second carrier identification can be stored on the network node, for example in a data store, or propagated from the carrier to the network node over the communications network.","Proceeding to decision box  and again to step , if the first and second carrier identifications do not match, the application can be denied access to privileged functionality on the network node. For example, installation and\/or execution of the application on the network node can be prevented, thus insuring that the application is not accessible to unauthorized users. If, however, the first and second carrier identifications match, the application can be provided access to privileged functionality on the network node, as shown in step . For instance, the application can be installed and\/or executed on the network node.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 2","b":["200","200","200"]},"At least one network node  can be communicatively linked to the communications network . The node  can be, for example, a mobile communication device, such as a mobile telephone or personal digital assistant (PDA), a computing device, or any other device which can receive an application  over the communications network .","The network node  can comprise a network interface , a processor , and a first data store . Optionally, the network also can include a second data store . The network interface  can be a landline or wireless network interface. For example, the network interface  can be a modem, a LAN or WAN interface, or a radio having interconnect and\/or dispatch capabilities. The processor  can be a central processing unit (CPU), a digital signal processor (DSP), an application specific integrated circuit (ASIC), or any other processor suitable for processing an application  received over the communications network .","Each of the data stores ,  can comprise an electronic storage medium, such as read only memory (ROM), flash memory or random access memory (RAM), a magnetic storage medium (e.g. a hard disk drive), an optical storage medium, a magneto-optical storage medium, or any other suitable data storage device. For example, the first and\/or second data store can be a subscriber identity module (SIM) card. A SIM card can identify a user account under which the network node  is operated, handle authentication of the network node, and provide data storage for user data such as telephone numbers and information about the communications network . A SIM card may also contain applications that run on the network node .","A root certificate  can be stored in the first data store . For example, the root certificate  can be embedded in an operating system stored on the data store . As noted, the root certificate can be associated with a protection domain and used by the processor  to authenticate security information  associated with the application  when the application  is received by the node .","A first carrier identification  can be attached to the application  as a text file, embedded within program code of the application , incorporated within the security information, or associated with the application  in some other suitable fashion. For example, in the case that the application  is contained in a MIDlet suite, the first carrier identification  can be included in the MIDlet suite's descriptor file, such as a Java Descriptor (JAD) file and\/or a manifest of the archive file. The archive file may be a Java Archive (JAR) file. Both the JAD file and manifest are text files containing attributes. The first carrier identification  can be added as an attribute to one or both of these files, and the network node's operating system can be configured to identify and process the carrier identification  attributes when the files are parsed.","Notably, if the X.509 PKI security standard is used, the attributes defined within the manifest of the JAR file are protected by the signature, whereas the JAD file is not. Thus, it may be desirable to use the manifest to securely pass the first carrier identification . Including the carrier identification  in both the manifest and JAD file, however, can provide an even greater level of security since the values then could be compared. Such a comparison may detect whether the JAD file or the manifest has been unscrupulously modified.","When the application  is received by the node , the processor  can compare the first carrier identification  to a second carrier identification . As shown, the second carrier identification  can be stored in the second data store . Alternatively, the second carrier identification  can be stored on another data store, such as the first data store .","In one arrangement, the second carrier identification  can be stored on the network node  when the network node  is entered into service, or at some other time prior to receiving the first carrier identification . In another arrangement, the second carrier identification  can be propagated to the network node  when needed by the processor  to perform a comparison. For example, upon receiving the application , the network node  can request a server to provide the second carrier identification  to the network node  via the communications network . The second carrier identification  can be encrypted in accordance with the implementation of the communications network . Such encryption techniques are known to the skilled artisan.","The present invention can be realized in hardware, software, or a combination of hardware and software. The present invention can be realized in a centralized fashion in one system, or in a distributed fashion where different elements are spread across several interconnected systems. Any kind of processing device or other apparatus adapted for carrying out the methods described herein is suited. A typical combination of hardware and software can be a processing device with an application that, when being loaded and executed, controls the processing device such that it carries out the methods described herein.","The present invention can also be embedded in an application program product, which comprises all the features enabling the implementation of the methods described herein, and which, when loaded in a processing device, is able to carry out these methods. Application program in the present context means any expression, in any language, code or notation, of a set of instructions intended to cause a system having an information processing capability to perform a particular function either directly or after either or both of the following: a) conversion to another language, code or notation; b) reproduction in a different material form.","This invention can be embodied in other forms without departing from the spirit or essential attributes thereof. Accordingly, reference should be made to the following claims, rather than to the foregoing specification, as indicating the scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"}]},"DETDESC":[{},{}]}
