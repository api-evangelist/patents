---
title: Method and system for supporting GPU audio output on graphics processing unit
abstract: The present invention sets forth a method for supporting enhanced audio on a graphics processing unit (GPU) in a computing device having a graphics subsystem. In one embodiment, the method includes the steps of determining whether an option of a GPU audio output is enabled and the graphics subsystem and a first external output device is connected, and routing a first audio stream to the GPU of the graphics subsystem for processing when the option of the GPU audio output is enabled and the graphics subsystem and the first external output device is in connection and causing the processed first audio stream to be transferred along a first transmission path to the first external output device, or otherwise causing a second audio stream to be transferred along a second transmission path to a second external output device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09165394&OS=09165394&RS=09165394
owner: NVIDIA Corporation
number: 09165394
owner_city: Santa Clara
owner_country: US
publication_date: 20091013
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","Embodiments of the present invention generally relate to graphics processing unit (GPU), and, more specifically, to a method and a system for supporting a GPU audio output on graphics processing unit.","2. Description of the Related Art","High definition (HD) video and audio enhances user experiences by incorporating HD graphics and audio signals in media such as Blue-Ray discs. Although some computing devices may support both HD graphics signals and HD audio signals, these computing devices typically rely on a dedicated audio subsystem to handle the HD audio signals. The HD audio signals may be presented through audio output devices such as amplifiers. To achieve even better sound quality than the HD audio signals, the computing devices may need to include additional audio processing hardware, which increases the overall cost for such computing devices.","Many graphics systems have more computational resources than required for the preparation and processing of HD graphics signals. As the foregoing illustrates, what is needed in the art is thus a method and a system for supporting an audio output that is processed by the GPU in a cost effective manner, so that the computational resources of a graphics system may be utilized and address at least the foregoing issues.","One embodiment of the present invention sets forth a method for supporting a GPU audio output on graphics processing unit (GPU) in a graphics subsystem. The method includes the steps of determining whether an option of a GPU audio output is enabled and the graphics subsystem and a first external output device is connected, and routing a first audio stream to the GPU of the graphics subsystem for processing when the option of the GPU audio output is enabled and the graphics subsystem and the first external output device is in connection, and causing the processed first audio stream to be transferred along a first transmission path to the first external output device, or otherwise causing a second audio stream to be transferred along a second transmission path to a second external output device.","At least one advantage of the disclosed method is to enable thread processors of the GPU to support a GPU audio output and output it to an external output device when certain conditions are met.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1","b":["100","100","100","102","104","106","110","102","104","110","106","106","102","110"]},"The graphics subsystem  comprises a graphics processing unit (GPU) , a frame buffer  coupled to the GPU . The GPU  comprises multiple output ports. In one implementation, at least one of the output ports is configured as a graphics output port , and at least one of the output ports is configured as an audio output port . The graphics subsystem  is configured to be in connection with a first external output device at least through the graphics output port . In one implementation, the first external output device is a display device  with an audio output. The graphics subsystem  may also be configured to be in connection with a second external output device, which in one implementation is an external audio output device . While the graphics subsystem  is shown to be connected to the one display device , it may be connected to multiple display devices. Similarly, although the graphics subsystem  is illustrated to be connected to the one external audio output device , the graphics subsystem  may be connected to multiple external audio output devices.","In one implementation, the system memory  contains an application program , an operating system (OS) , a graphics driver , an audio driver . The computer system  may further comprise an optical drive  storing a graphics source  and an audio source  and a high definition (HD) controller . The HD controller  is configured to at least convert the audio source , regardless of its format, to a HD-based audio signal, and a non-HD audio signal. In one implementation, the optical drive  is a digital versatile disc (DVD) player\/recorder.","The GPU  may be a graphics device designated for general purpose graphics-related computing for the graphics source . The audio driver  may cause the HD controller  to process the audio source  to generate a HD-based audio signal. The HD-based audio signal may be further routed to and outputted by the GPU . The audio driver  may also cause the GPU  to process the audio source  to a GPU audio signal. Throughout the disclosure, system audio generally refers to an audio signal that is not processed by the GPU , and GPU audio generally refers to another audio signal that is processed by the GPU . In one implementation, the GPU audio is \u201cEffective Spacious Sound\u201d audio signal.","To generate the GPU audio, the GPU  in one implementation may utilize thread processors to encode or decode the audio source  and to filter out associated noises.","To generate and output the GPU audio, an option of an output for the GPU audio may be enabled. The option may be offered by the application program . In one implementation, in addition to enabling the option, a connection between the external audio device  and the graphics subsystem  may be required before the GPU audio could be prepared. With both of the conditions satisfied, the GPU audio may be outputted to the external audio device .","On the other hand, when the option is not enabled or selected, the GPU  may not be caused to process the audio source  for the generation of the GPU audio. As a result, the system audio, rather than the GPU audio, may be outputted to the display device . In one implementation, the system audio refers to HDMI-based audio, which is a type of the HD-based audio signal. In another implementation, the system audio refers to the non-HD audio signal. The GPU audio may be transmitted through the audio output port  to the external audio output device , and the system audio such as Sony Philips Digital Interface (SPDIF)-based audio may be transmitted through the graphics output port  to the display device . In one implementation, the non-HD audio signal may be transmitted to yet another external output device through an output port  of the computer system  outside of the graphics subsystem .","When in operation, the CPU  may execute the application program , which in turn invoke various functions of the graphics subsystem  through the graphics driver  and the audio driver . One application program  may be, for example, a media player that is for playing back the graphics source  and the audio source .","In conjunction with ,  is a schematic diagram  for illustrating outputting analog audio signals in a 5.1 surround sound environment according to one embodiment of the present invention. A 5.1 surround sound environment provides an audio data stream intended for five full channels, each of which corresponds to its respective speaker. The 5.1 surround sound environment may further include one low frequency effect (LFE) channel. To illustrate, the five full channels in the 5.1 sound environments may contain external audio devices , , , , , and  located at left front, right front, center, surround left, and surround right in relation to a listening audience. In one implementation, the external audio device is a speaker. A GPU  may detect the existence of an external audio device (such as the external audio device ) to receive the GPU audio. In one implementation, the detection is performed through a general purpose input output (GPIO) pin  of the GPU . When a connection pin, which is connected to a pull-up resistor, of the external audio device  is in connection with the GPIO pin , the voltage level of the connection pin may be set to \u201chigh.\u201d In another implementation, the voltage level of the connection pin may be at \u201clow.\u201d With this voltage level, the GPU  could verify the connection of the external audio device. In another implementation, the GPU  may poll the voltage level of the GPIO pin  periodically to determine the connection of the external audio device, or receive an interrupt indicative of the connection. An option to enable the output of the GPU audio may be provided by the application program . When the option is enabled and the GPU  detects the connection of external audio devices , , , , , and\/or , an audio source (such as the audio source  in ), which may have been processed by a core circuitry (not shown) of the GPU , may be outputted to a digital-to-analog converter (DAC)  and a DAC  of the GPU . The DAC  and the DAC  may be configured to convert the processed audio source to a predetermined analog format. The DAC  and the DAC  may generally be used for the output of red (R), green (G), and blue (B) pixel signals of the graphics data. The GPU  may have the DAC  and the DAC  available for the processing and the transmission of the GPU audio while utilizing other I\/O ports for the output of the graphics data. This arrangement may work especially well in a parallel architecture such as the Compute Unified Device Architecture (CUDA). One or more of the DAC  and the DAC  may also support a plurality of channels for the transmission of the GPU audio. For example, each of the channels used for the transmission of the R\/G\/B pixel signals may correspond to one channel of the GPU audio. In one implementation, a pair of DACs may be able to provide five full channels and one LFE to create the 5.1 surround sound environment. Though six channels are provided in , it is worth noting that the pins of the DAC  and the DAC  may be grouped together as one set of channels one of a single external audio device. For example, when the external audio device such as an earphone comprising a set of left and right channels, the DAC  may be configured to provide the output of the GPU audio for the left channel of the earphone, and the DAC  may be configured to provide the output of the GPU audio for the right channel of the same earphone.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 3","FIG. 1"],"b":["306","309","306","311","310","311","328","310","310","314","316","314","316","328","320","320","152","306","302","304","311","311","306"]},"On the other hand, the second audio stream  may be routed to and processed by a high definition (HD) controller . An audio output  of the HD controller  may include an HD-based second audio stream and a non-HD second audio stream. The output  may be routed to a second output port (such as the graphics output port ) of the GPU  without going through the core circuitry . In one implementation, the second output port includes an internal flat panel (IFP) pin of the GPU . The second output stream  may follow a second transmission path to a display device (e.g., the display device  in ) through the second output port . In one implementation, the second transmission path may include the system interface , the HD controller  and the second output port (graphics output port ) of the GPU. Since the audio output  may not be processed by the core circuitry  of the GPU , the HD-based second audio stream and the non-HD second audio stream may be referred to as the aforementioned system audio. When the option of the output of the GPU audio is not enabled, no GPU audio is generated, and the system audio may be outputted along the second transmission path. In one implementation, the graphics output port  may process the audio output  (e.g., encoding) to generate another audio stream  that is in compliance with the specification associated with the display device coupled to the graphics output port .",{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 4","FIG. 1"],"b":["404","410","410","412","414","416","410","144","402","412","412","412","414","414","416","404","404","418","418","404","410","430"]},"The graphics stack  comprises a graphics driver , a graphics\/video decoder , and a graphics\/audio encoder . A graphics stream  may be processed through a separate graphics-dedicated driver stack, i.e. the graphics stack . The graphics driver  is responsible for rendering of the graphics stream . Before the graphics stream  can be processed by a GPU (e.g., GPU  in ), it is decoded by the graphics\/video decoder . After the processing of graphics stream  by the GPU is completed, the processed graphics stream  is then encoded by the graphics\/audio encoder  before being outputted to a graphics output port . Optionally, the graphics\/audio encoder  is also responsible for encoding the audio stream . The audio stream  is sent to the graphics stack  by the audio driver .","In conjunction with ,  is a flowchart illustrating a method  for an audio driver in a computing device to support a GPU audio output on graphics processing unit according to one embodiment of the present invention. In step , the audio driver is configured to determine whether an option of GPU audio output is enabled and a connection between an external audio device (e.g., external audio output device  in ) and the graphics subsystem is present. If so, the audio driver may route a first audio stream to a GPU for processing in step . The audio driver then may also cause the audio stream that is processed by the GPU to be transferred along a first transmission path in step . In one implementation, the first transmission path includes an audio output port of the GPU (e.g., the audio output port  in ). When the determination in the step  indicates that either the GPU audio output is not enabled or the connection between the external audio output device and the graphics subsystem is not present, in step  the audio driver may cause a second audio stream to be transferred along a second transmission path. In one implementation, the second transmission path includes a graphics output port of the GPU (e.g., the graphics output port  in ).","While the forgoing is directed to implementations of the present invention, other and further implementations of the invention may be devised without departing from the basic scope thereof. For example, aspects of the present invention are implemented in a combination of hardware and software. One implementation of the invention may be implemented as a program product for use with a computer system. The program(s) of the program product define functions of the implementations (including the methods described herein) and can be contained on a variety of computer-readable storage media. Illustrative computer-readable storage media include, but are not limited to: (i) non-writable storage media (e.g., read-only memory devices within a computer such as CD-ROM disks readable by a CD-ROM drive, flash memory, ROM chips or any type of solid-state non-volatile semiconductor memory) on which information is permanently stored; and (ii) writable storage media (e.g., floppy disks within a diskette drive or hard-disk drive or any type of solid-state random-access semiconductor memory) on which alterable information is stored. Such computer-readable storage media, when carrying computer-readable instructions that direct the functions of the present invention, are implementations of the present invention.","Therefore, the scope of the present invention is determined by the claims that follow."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["So that the manner in which the above recited features of the present invention can be understood in detail, a more particular description of the invention, briefly summarized above, may be had by reference to implementations, some of which are illustrated in the appended drawings. It is to be noted, however, that the drawings illustrate only typical implementations of this invention and are therefore not to be considered limiting of its scope, for the invention may admit to other equally effective implementations.",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
