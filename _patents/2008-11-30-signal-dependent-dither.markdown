---
title: Signal dependent dither
abstract: A new technique on the dithering of one-dimensional signals is presented. The novel technique determines whether dither is needed when reducing the bit depth and evaluates whether the total error of the un-dithered quantization is white noise. If this is the case, then no undesired harmonics are added in the quantization or re-quantization process. The novel technique presents a state of the art signal-dependent dither having a lower quantization noise.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07876247&OS=07876247&RS=07876247
owner: 
number: 07876247
owner_city: 
owner_country: 
publication_date: 20081130
---

{"@attributes":{"id":"description"},"GOVINT":[{},{}],"heading":["GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["The claimed invention was made with U.S. Government support under grant number EEC-9986821 awarded by the National Science Foundation (NSF). The government has certain rights in this invention.","The present invention is related to digital signals enhancement and more particularly, to the addition of dithering to digital signals.","Digital signals have become widespread and are favored in many applications because of their noise immunity. This is a result of their discreteness in both time and amplitude. Once the signal has been discretized, the signal can be stored or transmitted without additional noise being added. There are many applications however, where the discretization in both time and amplitude needs to be changed in the discrete domain. For example, if two digital systems operate at different sampling frequencies, a multirate system is used for the sampling rate conversion. The amplitude discretization can also be changed. Going from a 16 to an 8 bit representation, for example, would reduce the memory requirements for storing a signal. For instance, in gaming applications the precision of each sample is about 12 bits and the ring tones have a resolution of 8 bits. The process of lowering the amplitude resolution of a digital signal is called re-quantization.","If the signal amplitude change is large from sample to sample, then it is generally assumed that the re-quantization will be a uniformly (discrete) distributed i.i.d. (independent and identically distributed) sequence (white noise). In this case, the re-quantization error is independent of the signal being quantized. This assumption does not hold for all cases particularly when the signal has small amplitude. In this case rounding or truncating a signal can introduce various undesirable artifacts, namely, additional harmonics related to the signal being re-quantized. For this case, the re-quantization error is an autoregressive moving average (ARMA) process that cannot be modeled like a white noise sequence.","To avoid these unwanted harmonics, dither is generally added to the signal being quantized. Dither is an i.i.d. signal whose purpose is to ensure that the quantization error is uncorrelated with the signal being quantized. In addition, the dither signal is independent of the input. In additive dithering, the quantization error signal is dependent of the signal being quantized but some techniques can make the value of the first and second statistical moments independent of the error. The main disadvantage of adding dither is that since the dither is basically a noise signal, the signal to noise ratio (SNR) of the final re-quantized signal is lowered. Because of this, it is desirable to know if re-quantization will introduce the undesired harmonics. In some cases, the quantization noise will be an i.i.d signal even though no dither is added. In these cases, the signal can be re-quantized with no added harmonics, and without the signal to noise ratio penalty.","Another problem in the classic dithering model is that the amount of error is difficult to control when the probability density function (PDF) of the dither is uniform (RPDF) or gaussian (GPDF). It has been proved that dither with a triangular PDF (TPDF) can produce an error signal which has a constant variance, as this renders the first and second moments independent of the input. This dither has a larger variance in contrast to RPDF dither and the advantage of this dither is supported with psycho-acoustic tests which show that users prefer a constant noise instead of a non-constant noise. It has also been proved that, it is not possible to make a classic dither with a constant and lower variance in the quantization error than the one obtained with TPDF dither.","History of Quantization and Dithering","A lot of research has been done in the area of quantization and dithering. Different schemes of analog to digital conversion such as uniform and non-uniform quantization have been developed to sample continuous signals. For the purpose of this explanation, the quantization and re-quantization are assumed to be uniform where the difference between quantization levels is constant.","The study of quantization properties and its effects increased after the middle of the 20th century. An important mathematical foundation was published and recently summarized by Widrow (incorporated herein by reference). He establishes that quantization error can be modeled as a uniform i.i.d sequence under a given set of conditions. He found that the process of obtaining the probability density function (PDF) of the quantized signal is similar to Shannon's Sampling Theorem and named \u201cArea Sampling\u201d. It is explained how, having the relationship between the input and the output, and the PDF of the output of the quantizer, the original distribution could be recovered. Moreover, Widrow's research work defined the higher order statistics of quantization error and the study of the quantization output moments.","Dithering","The word dithering was originally used during in the Second World War. Aircraft bomb trajectory was more accurate when the airplane was flying, since the vibration reduces the error of moving parts. This vibration was termed dithering. Some initial applications of dithering were introduced by Roberts in his PhD thesis at MIT in (incorporated herein by reference). His work was related to the transmission of images in a digital television channel. To transmit a picture, the length of each sample was of at least 6 bits in the Pulse Code Modulation (PCM) standard. This is because the human eye is sensitive to the small changes in intensity. With the use of dithering, Roberts could reduce the resolution to 3 bits. In this work, he added small amounts of noise to the signal before quantization to cause the same effect in the perception of the eye with fewer bits. Some examples extracted from his thesis are shown in .","Later in 1964, Schuchman determined sufficient and necessary conditions of dither to have a minimum loss of statistical properties. For instance, one condition is that statistical dither must be independent of the signal to be quantized.","The state of the art dithering techniques used in industry about dithering were developed at least 20 years ago. Gray and Stokham summarized the most important research about dithered quantizers in (incorporated herein by reference). In this work, the theory of the subtractive and non-subtractive dithering and its statistical properties was explained. Also, Gray analyzed the spectra of quantization noise and summarized principal concepts about quantization, vector quantization, and dithering]. In addition, a strong mathematical foundation for the theory of non-subtractive dithering was developed in the AudioLab at University of Waterloo. These include the first and second order statistics of the system input and output and the introduction of digital dither.","In the middle of the 1980's, digital processing became more widespread and it was necessary to include dither in digital systems. In digital systems, the process of lowering the resolution of a signal is called re-quantization. Another study of digital quantization comes to the same conclusion as with continuous quantization. This work also introduces digital dither. Their work was extended when triangular PDF dither was used in digital audio. Currently, TPDF is the most popular technique of dithering in one-dimensional signals.","Dither is used in various applications. One of the most famous applications was developed in Bell Labs where Jayant and Rabiner used RPDF in speech processing (incorporated herein by reference). Another application uses GPDF in a high speed digital system for the suppression of the electromagnetic field. Furthermore, dithering is used in feedback systems to reduce the oscillation at high frequency.","Noise Shaping","One of the main objectives of this invention is to have white re-quantization error when quantizing signals. On the other hand, in some applications it is better to have a non-white noise. For example, human beings have greater perception of sound near to 4 kHz. It is possible to modulate (i.e, change the frequency) of the error signal to frequencies where we are less sensitive. In other words, this process changes the shape of the error spectrum to be minimally audible as it is shown in . This process is known as \u201cnoise shaping\u201d.  illustrates a general scheme for noise shaping, where Q is the quantizer (re-quantizer) and H(z) is a feedback filter. The difference between the input to the quantizer and the output is filtered and added to the input to modulate the total error.","Knowing the advantages and disadvantages of the prior art, what is needed is the development and software\/hardware implementation of an algorithm that measure the need for dithering and to develop a segment dependent dither where dither is added only to the segments where need dither, thus, providing adaptive dither with lower variance than the prior art.","An object of the invention is to demonstrate that hypothesis testing can be used effectively to determine if the total error of a re-quantized signal is white noise.","According to another aspect of the invention, the application to real audio signal re-quantizing is straight forward. The signal can be segmented, and each segment tested for the whiteness of the quantization noise. Dither can be added to the segments that do not pass the tests.","In accordance to a further aspect of the invention, an application for segment dependent dithering was developed where a signal is re-quantized from a first bit precision to a second lower bit precision adding dither to the segments where the total quantization error is not white noise.","Other embodiments, features and advantages of the present invention will be apparent from the following specification taken in conjunction with the following drawings","In order to establish the framework of the present invention, the specification will describe the statistics of re-quantization noise like mean and variance and the autocorrelation and power spectral density of the quantization noise assuming a set of condition. In addition, the total error PDF using the convolution theorem and area sampling will be derived, thus, showing that the total error is input dependent for non-subtractive dithering quantization. The total error statistical moments are defined and later used to obtain the principal properties of triangular PDF dither.","Re-Quantization","Quantization schemes determine the amplitude resolution of the digital signal. For simplicity, this description assumes a uniform quantization and discrete signals represented in 2s complement binary format. In this case, the amplitude resolution of the digital signal is determined by the number of bits used to represent each sample. The model for the lowered resolution signal is:\n\n()=\n","where Q(x[n]) is the quantization operation and xis the lower resolution quantized signal, x the original signal, n indicates the nsample and \u03b5 the quantization noise. The simplest methods of lowering the resolution are truncation, where the lower significant bits are discarded, and rounding to the nearest integer. Since the numbers are in 2s complement, the truncation operation is",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msup":{"mn":"2","mrow":{"mi":["N","M"],"mo":"-"}},"mo":"\u2062","mrow":{"mo":["\u230a","\u230b"],"mfrac":{"mrow":{"mi":"x","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"msup":{"mn":"2","mrow":{"mi":["N","M"],"mo":"-"}}}}}],"mo":"="},"mo":","}}},"br":{}},{"@attributes":{"id":"p-0057","num":"0056"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msup":{"mn":"2","mrow":{"mi":["N","M"],"mo":"-"}},"mo":"\u2062","mrow":{"mo":["\u230a","\u230b"],"mfrac":{"mrow":{"mrow":{"mi":"x","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"mo":"+","mn":"1"},"msup":{"mn":"2","mrow":{"mi":["N","M"],"mo":"-"}}}}}],"mo":"="},"mo":","}}}},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 4","sup":["N\u2212M ","N\u2212M "]},"Statistics of Quantization Noise","If the signal amplitude change is large from sample to sample, then the quantization error is a uniform white noise sequence. In this case, the samples of the quantization noise are uncorrelated between them, and are distributed uniformly from either 0 to 2\u0394 for truncation, or \u22122\u0394 to 2\u0394 for rounding. Under these conditions the quantization error PDF is defined as follows:",{"@attributes":{"id":"p-0060","num":"0059"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"P","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03c4","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u025b"}}},{"mo":"{","mrow":{"mtable":{"mtr":[{"mtd":[{"mrow":{"mfrac":{"mn":"1","mi":"\u0394"},"mo":","}},{"mrow":{"mrow":{"mo":"-","mfrac":{"mi":"\u0394","mn":"2"}},"mo":["<","<"],"mi":"\u025b","mfrac":{"mi":"\u0394","mn":"2"}}}]},{"mtd":[{"mn":"0"},{"mi":"otherwise"}]}]},"mo":","}}],"mo":"="}}}},"Given the quantization noise PDF, the statistical moments of a uniform distribution are:",{"@attributes":{"id":"p-0062","num":"0061"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"\u025b"}},"mo":"=","mn":"0"},"mo":","}}},{"mtd":{"mrow":{"mrow":{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"msup":{"mi":"\u025b","mn":"2"}}},"mo":"=","mfrac":{"msup":{"mi":"\u0394","mn":"2"},"mn":"12"}},"mo":","}}}]}}},"br":{}},{"@attributes":{"id":"p-0063","num":"0062"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"msup":{"mi":["\u025b","m"]}}},{"mo":"{","mrow":{"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mfrac":{"mn":"1","mrow":{"mi":["m","\u03bb"],"mo":"+"}},"mo":"\u2062","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mi":"\u0394","mn":"2"}},"mi":"m"}},"mo":","}},{"mrow":{"mi":["for","m","even"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]}}]},{"mtd":[{"mrow":{"mn":"0","mo":","}},{"mrow":{"mi":["for","m","odd"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]}}]}]},"mo":","}}],"mo":"="}}},"br":{}},"The autocorrelation of a signal is the strength of a linear relationship between a pair of points in the signal. The autocorrelation is defined as:\n\n(lag)=+lag ]],\n\nwhere lag is the difference in time (or in samples) between a pair of random variables. When lag is different from zero, assuming an i.i.d zero mean sequence, their linear relationship between the points is zero. On the other hand, when the lag is equal to zero, then the autocorrelation is equal to the variance of the signal. In summary, the autocorrelation of white noise can be expressed mathematically as:\n",{"@attributes":{"id":"p-0065","num":"0064"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"a","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"lag"}},{"mo":"{","mrow":{"mtable":{"mtr":[{"mtd":[{"mrow":{"msup":{"mi":"\u03c3","mn":"2"},"mo":","}},{"mrow":{"mi":["for","lag"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mn":"0"}}]},{"mtd":[{"mrow":{"mn":"0","mo":","}},{"mi":"otherwise"}]}]},"mo":"."}}],"mo":"="}}},"br":{}},"Power Spectral Density (PSD) measures the power of a signal in the frequency domain. PSD is defined as the Fourier transform of the autocorrelation. In the case of zero mean white noise it is:",{"@attributes":{"id":"p-0067","num":"0066"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mrow":[{"msubsup":{"mo":"\u222b","mrow":{"mo":"-","mi":"\u221e"},"mi":"\u221e"},"mo":"\u2062","mrow":{"mrow":[{"mi":"a","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c4"}},{"mo":"\u2146","mi":"\u03c4"}],"mo":["\u2062","\u2062","\u2062"],"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"j"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c9\u03c4"}},"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}},{"mrow":{"msubsup":{"mo":"\u222b","mrow":{"mo":"-","mi":"\u221e"},"mi":"\u221e"},"mo":"\u2062","mrow":{"msup":[{"mi":"\u03c3","mn":"2"},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"j\u03c9"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"\u03c4"}}],"mo":["\u2062","\u2062","\u2062","\u2062"],"mrow":[{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c4"}},{"mo":"\u2146","mi":"\u03c4"}],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}},"mo":"=","msup":{"mi":"\u03c3","mn":"2"}}],"mo":"="}],"mo":"="},"mo":","}}},"br":{}},"However, the white noise assumption does not hold for all cases. The quantization process can introduce additional harmonics related to the signal being requantized. These added harmonics occur when the quantization noise \u03b5[n] is highly correlated with signal x[n] and so has harmonic content related to this signal. An example of this is shown in , where a 1333 Hz sine wave has been requantized from 24 to 7 bits. Ideally, the power spectral density of a cosine signal is an impulse at the operation frequency. As can be viewed in , many impulses of small amplitude appear in the spectrum of the re-quantized signal.","Dither","To avoid these unwanted harmonics, dither is generally added to the signal before quantizing. The purpose of the dither signal is to ensure that the quantization error samples are uncorrelated with the signal being quantized. Ideally, the quantization error signal is independent of the signal being quantized, but it is generally accepted that having uncorrelated first and second moments is sufficient. Subtractive (SD) and non-subtractive dither (NSD) systems are commonly used. The difference between these schemes is that in the former, dither is subtracted after quantization. General schemes of dithered quantizers are shown in .","The total error (\u03b5) is defined as the difference between input and output signals. Thus, the SD total error as:\n\n\u03b5=()\u2212(),\n\nwhere x is the input signal and d is the dither signal. In contrast, the NSD total error is:\n\n\u03b5=()\u2212\n","This invention focuses on NSD, so the theoretical framework will be focused on this scheme.","Area Sampling and Dithered Quantization Error PDF","Area Sampling","Area sampling is a term used to deduce the PDF of the quantizer error. The quantizer error q[n] (different from total error) is defined as the difference between quantizer input and output. This PDF is a sampled version of the input PDF, with samples taken every \u0394. Specifically, the sampling process is the multiplication of the input PDF with a train of impulse functions, then scaled by in the neighborhood of the point in the input PDF. The quantizer error PDF can be represented as follows:",{"@attributes":{"id":"p-0073","num":"0072"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["p","q"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"q"}},{"munderover":{"mo":"\u2211","mrow":{"mi":["k","\u221e"],"mo":"-"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"q","mo":"-","mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"msubsup":{"mo":"\u222b","mrow":[{"mrow":[{"mo":"-","mfrac":{"mi":"\u0394","mn":"2"}},{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"+"},{"mfrac":{"mi":"\u0394","mn":"2"},"mo":"+","mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}]},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mo":"\u2146","mi":"y"}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}],"mo":"\u2062"}}],"mo":"="},"mo":","}}},"br":[{},{}],"figref":"FIG. 7"},"Knowing the quantizer error PDF, it is possible to deduce the total error PDF using the above-shown equation. Let p(w,x) be the conditional total error PDF in a NSD system. Defining w=x+d as the input to the quantizer, the conditional PDF of the quantizer input given x is p(w,x)=p(w\u2212x). Using area sampling and the NSD total error equation defined above, the conditional total error is:",{"@attributes":{"id":"p-0075","num":"0074"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":"p","mrow":{"mi":["\u025b","x"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u025b","x"],"mo":","}}},{"munderover":{"mo":"\u2211","mrow":{"mi":["k","\u221e"],"mo":"-"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u025b","x"],"mo":["+","-"],"mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"msubsup":{"mo":"\u222b","mrow":[{"mrow":[{"mo":"-","mfrac":{"mi":"\u0394","mn":"2"}},{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"+"},{"mfrac":{"mi":"\u0394","mn":"2"},"mo":"+","mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}]},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["p","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u03c9","x"],"mo":"-"}}},{"mrow":{"mo":"\u2146","mi":"\u03c9"},"mo":"."}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}],"mo":"\u2062"}}],"mo":"="}}}},"Therefore, multiplying by p(x) and integrating with respect to x, the marginal PDF of \u03b5 is:",{"@attributes":{"id":"p-0077","num":"0076"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["p","\u025b"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u025b"}},{"msubsup":{"mo":"\u222b","mrow":{"mo":"-","mi":"\u221e"},"mi":"\u221e"},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":"p","mrow":{"mi":["\u025b","x"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u025b","x"],"mo":","}}},{"msub":{"mi":["p","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":"\u2146","mi":"x"}],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}],"mo":"="},"mo":","}}}},"In the above equation, it is clear that the total error of a NSD is always signal dependent because it is impossible to separate the error E of the input x.","Total Error Moments","The random variable PDF moments are defined as E[x], where m represents the mmoment of such distribution. In many cases, this expression can be calculated using the characteristic function (CF). The CF, by definition, is the Fourier transform of a PDF. The moments are calculated evaluating the CF in the following expression:",{"@attributes":{"id":"p-0080","num":"0079"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"msup":{"mi":["x","m"]}}},{"mrow":[{"msubsup":{"mo":"\u222b","mrow":{"mo":"-","mi":"\u221e"},"mi":"\u221e"},"mo":"\u2062","mrow":{"msup":{"mi":["x","\u221e"]},"mo":["\u2062","\u2062","\u2062"],"mrow":[{"msub":{"mi":["f","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":"\u2146","mi":"x"}],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}},{"msup":{"mrow":{"mo":["(",")"],"mfrac":{"mi":"j","mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"}}},"mi":"m"},"mo":"\u2062","mrow":{"mrow":{"msubsup":{"mi":["C","x"],"mrow":{"mo":["(",")"],"mi":"m"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mn":"0"}},"mo":"."}}],"mo":"="}],"mo":"="}}},"br":{},"sub":["x ","x","x"],"sup":["(m) ","th "]},"In order to find the CF of the quantization error, the conditional total error equation previously defined is redefined as follows:",{"@attributes":{"id":"p-0082","num":"0081"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":"p","mrow":{"mi":["\u025b","x"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u025b","x"],"mo":","}}},{"munderover":{"mo":"\u2211","mrow":{"mi":["k","\u221e"],"mo":"-"},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["\u025b","x"],"mo":["+","-"],"mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"mo":["(",")"],"mrow":{"mi":"\u03c5","mo":"\u00d7","msub":{"mi":["p","d"]}}},{"mrow":{"mo":["(",")"],"mi":"\u025b"},"mo":"."}],"mo":["\u2062","\u2062"]}}],"mo":"="}}},"br":{}},{"@attributes":{"id":"p-0083","num":"0082"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":"{","mrow":{"mtable":{"mtr":[{"mtd":[{"mn":"1"},{"mrow":{"mrow":{"mo":"-","mi":"\u0394"},"mo":["<","<"],"mi":["x","\u0394"]}}]},{"mtd":[{"mn":"0"},{"mi":"otherwise"}]}]},"mo":"."}}],"mo":"="}}}},"In NSD total error equation, the total error is the addition (or subtraction) of two independent random variables. Consequently, the PDF of the total error is the convolution of quantized and dithered PDFs. Substituting the above-redefined equation into the marginal PDF of E and using the convolution property, the error PDF is:",{"@attributes":{"id":"p-0085","num":"0084"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["p","\u025b"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u025b"}},{"mrow":[{"mo":["[","]"],"mrow":{"mi":"\u03c5","mo":"\u00d7","msub":{"mi":["p","d"]}}},{"mrow":[{"mo":["(",")"],"mi":"\u025b"},{"mo":["[","]"],"mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mrow":{"mo":"-","mi":"\u221e"}},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["e","x"],"mo":["+","-"],"mrow":{"mi":["k","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},"mo":"\u00d7","msub":{"mi":["p","x"]}}}}],"mo":"\u2061"},{"mrow":{"mo":["(",")"],"mrow":{"mo":"-","mi":"\u025b"}},"mo":"."}],"mo":["\u2062","\u2062"]}],"mo":"="}}}},"Taking the Fourier transform of this equation and using the convolution theorem, the CF of \u03b5 is given by:",{"@attributes":{"id":"p-0087","num":"0086"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mrow":[{"mrow":{"mrow":[{"msub":{"mi":["C","\u025b"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}},{"mrow":[{"mi":"sinc","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}},{"msub":{"mi":["C","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}}],"mo":"\u2062"}],"mo":"="},"mo":"]"},{"mo":["[","]"],"mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mrow":{"mo":"-","mi":"\u221e"}},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u03b4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mo":"-","mi":"f"},"mo":"-","mfrac":{"mi":["k","\u0394"]}}}},{"msub":{"mi":["C","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":"-","mi":"f"}}}],"mo":"\u2062"}}}],"mo":"\u00d7"},"mo":","}}},{"mtd":{"mrow":{"mrow":[{"msub":{"mi":["C","\u025b"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mrow":{"mo":"-","mi":"\u221e"}},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"sinc","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"f","mo":"-","mfrac":{"mi":["k","\u0394"]}}}},{"msub":{"mi":["C","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"f","mo":"-","mfrac":{"mi":["k","\u0394"]}}}},{"mrow":{"msub":{"mi":["C","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":"-","mfrac":{"mi":["k","\u0394"]}}}},"mo":"."}],"mo":["\u2062","\u2062"]}}],"mo":"="}}}]}}}},"The mmoment of the error PDF is:",{"@attributes":{"id":"p-0089","num":"0088"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"E","mo":"\u2061","mrow":{"mo":["[","]"],"msup":{"mi":["\u025b","m"]}}},{"mrow":[{"mo":["(",")"],"mfrac":{"mi":"j","mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mrow":{"mo":"-","mi":"\u221e"}},"mi":"\u221e"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msup":{"mrow":[{"mo":["(",")"],"mrow":{"mrow":[{"mi":"sinc","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["k","\u0394"]}}},{"msub":{"mi":["C","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["k","\u0394"]}}}],"mo":"\u2062"}},{"mo":["(",")"],"mi":"m"}]},"mo":"\u2062","mrow":{"mrow":{"msub":{"mi":["C","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["k","\u0394"]}}},"mo":"."}}}],"mo":"\u2062"}],"mo":"="}}}},"Based on this formula, Lipshitz (incorporated herein by reference) demonstrates that if",{"@attributes":{"id":"p-0091","num":"0090"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msup":{"mrow":[{"mo":["(",")"],"mrow":{"mrow":[{"mi":"sinc","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["k","\u0394"]}}},{"msub":{"mi":["C","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":["k","\u0394"]}}}],"mo":"\u2062"}},{"mo":["(",")"],"mi":"m"}]},"mo":"=","mrow":{"mn":"0","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"mo":"\u2200","mrow":{"mi":"k","mo":"\u2260","mn":"0."}}}}}},"br":{},"sup":"th "},"This invention is concerned with the implementation of new methods of dithering. The present invention first determines statistical tests for determining the need for dithering. These hypothesis tests are used to measure if the total error is white noise. Then, it develops a new adaptive dithering technique that is input dependent and has constant variance. This adaptive dithering is obtained using optimization methods instead of the classical dithering methods that are statistical based.","Determining the Need for Dither when Re-Quantizing a 1-D Signal","Tests in the Time Domain","If the total error \u03b5 is white noise, then there will be no added harmonics. The most straightforward method of determining this would simply be testing the serial independence of the signal. It turns out that this is unnecessary, and only the total error needs to be tested. This is because a sufficient condition for not introducing unwanted harmonics during re-quantization is that the total error is an i.i.d. sequence. The reason for this is that an i.i.d. sequence has a white spectrum. As x[n] is the sum of x[n] and \u03b5[n], if \u03b5[n] is white, then x[n] is simply the original sequence x[n] with added white noise. The tests presented here evaluate the whiteness, or equivalently, the independence of \u03b5[n] and \u03b5[n+k] for all k\u22600.","Because \u03b5[n] is a finite signal, its statistics must be estimated from a finite number of samples. If N samples are used to calculate the estimates, its sample mean and variance can be defined as:",{"@attributes":{"id":"p-0095","num":"0094"},"maths":{"@attributes":{"id":"MATH-US-00018","num":"00018"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mover":{"mi":"\u03bc","mo":"^"},"mi":"\u025b"},"mo":"=","mrow":{"mfrac":{"mn":"1","mi":"N"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mn":"0"},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"n"}}}}}}},"br":{}},{"@attributes":{"id":"p-0096","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00019","num":"00019"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msubsup":{"mover":{"mi":"\u03c3","mo":"^"},"mi":"\u025b","mn":"2"},"mo":"=","mrow":{"mfrac":{"mn":"1","mi":"N"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mn":"0"},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"n"}},"mo":"-","msub":{"mover":{"mi":"\u03bc","mo":"^"},"mi":"\u025b"}}},"mn":"2"}}}}}},"br":{}},{"@attributes":{"id":"p-0097","num":"0096"},"maths":{"@attributes":{"id":"MATH-US-00020","num":"00020"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msubsup":{"mi":["p","\u025b","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"k"}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mfrac":{"mn":"1","mi":"N"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"p","mo":"=","mn":"0"},{"mi":["N","k"],"mo":["-","-"],"mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["n","k"],"mo":"+"}}},{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"n"}}],"mo":"\u2062"}}},"mo":","}},{"mrow":{"mn":"0","mo":["\u2062","\u2062","\u2062","\u2062"],"munder":[{"mo":"<","mi":"_"},{"mo":"<","mi":"_"}],"mi":"k","mrow":{"mi":"N","mo":"-","mn":"1"}}}]},{"mtd":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"p","mo":"^"},"mi":"\u025b"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":"-","mi":"k"}}},"mo":","}},{"mrow":{"mrow":{"mo":"-","mrow":{"mo":["(",")"],"mrow":{"mi":"N","mo":"-","mn":"1"}}},"mo":["\u2062","\u2062","\u2062","\u2062"],"munder":[{"mo":"<","mi":"_"},{"mo":"<","mi":"_"}],"mi":"k","mn":"0"}}]},{"mtd":[{"mn":"0"},{"mrow":{"mi":"else","mo":"."}}]}]}}],"mo":"="}}}},"If \u03b5(n) has zero mean, then the sample autocorrelation coefficient can be defined as",{"@attributes":{"id":"p-0099","num":"0098"},"maths":{"@attributes":{"id":"MATH-US-00021","num":"00021"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msubsup":{"mi":["p","\u025b","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"k"}},{"mfrac":{"msub":{"mover":{"mi":"p","mo":"^"},"mi":"\u025b"},"msubsup":{"mover":{"mi":"\u03c3","mo":"^"},"mi":"\u025b","mn":"2"}},"mo":"."}],"mo":"="}}}},"The autocorrelation coefficient at lag k gives a measure of the linear dependence between \u03b5[n] and \u03b5[n+k]. If \u03b5[n] and \u03b5[n+k] are independent, then the correlation, and the correlation coefficient will be zero. Thus, a necessary condition for the independence of a sequence is that its sample autocorrelation coefficient be zero for all k\u22600. The tests in the time domain presented here are based on using the sample autocorrelation coefficient to determine if the sequence is independent. Because of the finite number of samples used in the estimation, the sample autocorrelation and autocorrelation coefficient will never be exactly zero. A typical sample autocorrelation coefficient is shown in .","Box-Pierce Test","The Box Pierce Test (Q) statistic (incorporated herein by reference) is used to verify the null hypothesis of white noise. This test uses the first m lags of the autocorrelation coefficient to calculate the following statistic:",{"@attributes":{"id":"p-0102","num":"0101"},"maths":{"@attributes":{"id":"MATH-US-00022","num":"00022"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":["Q","bp"]},"mo":"=","mrow":{"mi":"N","mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"m"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msubsup":{"mi":["T","k"],"mn":"2"},"mo":"."}}}}}}},"Qasymptotically approaches a \u03c7distribution with m degrees of freedom for increasing N under the null hypothesis of a white noise signal. In order to make the Qstatistic closer to its asymptotic distribution, the number of lags must be smaller than the number of samples.","To improve the performance of the test, the error signal is scaled between \u22121 and 1 and the mean is subtracted. This test is useful to measure when the signal has autoregressive or moving average components. The Box-Pierce statistic has some problems with the approximation to its asymptotic distribution, and the following test modifies the statistic to achieve a better approximation.","Ljung-Box Test","This test is a modification introduced to the Box-Pierce test. This test has proven more effective when the signal being tested comes from a non-normal distribution. Using the autocorrelation estimator, the statistic is now defined by:",{"@attributes":{"id":"p-0106","num":"0105"},"maths":{"@attributes":{"id":"MATH-US-00023","num":"00023"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"msub":{"mi":["Q","bp"]},"mo":"=","mrow":{"mrow":[{"mi":"N","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"N","mo":"+","mn":"2"}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"m"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mfrac":{"msubsup":{"mi":["r","k"],"mn":"2"},"mrow":{"mi":["N","k"],"mo":"-"}}}],"mo":"\u2062"}},"mo":","}}},"br":[{},{}],"sup":"2 "},"The tests in the time domain are based on the sample autocorrelation. Similarly, tests in the frequency domain are based on the Fourier transform of the sample autocorrelation, the sample power spectral density. The autocorrelation of a white sequence is an impulse, so its Fourier transform is a constant; it is the variance of the signal:\n\n()=\u03c3\u03b4()PSD(\u03c9)=\u03c3.\n","Thus, the test in the frequency domain is used to determine if the PSD of the sequence \u03b5[n] is a constant. Two modifications to the above equation are made in practice. The sample autocorrelation is used because the signal is finite, and the DFT is used instead of the DTFT for ease of computation. The equation for the PSD estimate, the sample PSD, then becomes",{"@attributes":{"id":"p-0109","num":"0108"},"maths":{"@attributes":{"id":"MATH-US-00024","num":"00024"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["PSD","q"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"k","mo":"=","mrow":{"mrow":{"mo":"-","mi":"\u03b4"},"mo":"+","mn":"1"}},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":"r","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"k"}},"mo":"\u2062","msup":{"mi":"\u2147","mrow":{"mrow":[{"mo":"-","mi":"j"},{"mi":"kf","mo":"."}],"mo":["\u2062","\u2062"],"mfrac":{"mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"},"mi":"N"}}}}}],"mo":"="}}}},{"@attributes":{"id":"p-0110","num":"0109"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0111","num":"0110"},"maths":{"@attributes":{"id":"MATH-US-00025","num":"00025"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mrow":{"mo":"-","mi":"N"}},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mi":"N"}}}],"mo":"\u2062"}}],"mo":"="},"mo":","}}},{"mtd":{"mrow":{"mrow":{"mrow":[{"mi":"B","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mrow":{"mo":"-","mi":"N"}},{"mi":"N","mo":"-","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"},"mi":"N"}}}],"mo":"\u2062"}}],"mo":"="},"mo":[",","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mi":"and"}}},{"mtd":{"mrow":{"mrow":[{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}},{"mfrac":{"mn":"1","mi":"N"},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msup":{"mi":"A","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}},{"msup":{"mi":"B","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}}],"mo":"+"}}}],"mo":"="},{"mrow":{"mo":"-","mfrac":{"mi":"N","mn":"2"}},"mo":["<","<"],"mi":"l","mfrac":{"mi":"N","mn":"2"}}],"mo":[",",","]}}}]}}},"br":{}},{"@attributes":{"id":"p-0112","num":"0111"},"maths":[{"@attributes":{"id":"MATH-US-00026","num":"00026"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msup":{"mi":"\u2147","mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}},"mo":"=","mrow":{"mrow":[{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}}},{"mi":["j","and"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}}}}],"mo":"+"}}}},{"@attributes":{"id":"MATH-US-00026-2","num":"00026.2"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msup":{"mrow":{"mo":["\uf603","\uf604"],"msup":{"mi":"\u2147","mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}}},"mn":"2"},"mo":"=","mrow":{"msup":{"mrow":{"mo":["(",")"],"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}}}},"mn":"2"},"mo":"+","mrow":{"msup":{"mrow":{"mo":["(",")"],"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c0","knj"]},"mi":"N"}}}},"mn":"2"},"mo":"."}}}}}]},"In those previous studies, the following modification to F(k) is suggested.",{"@attributes":{"id":"p-0114","num":"0113"},"maths":{"@attributes":{"id":"MATH-US-00027","num":"00027"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"Y","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"k"}},{"mfrac":{"mrow":{"mn":"2","mo":"\u2062","mrow":{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"k"}}},"msubsup":{"mi":["\u03c3","x"],"mn":"2"}},"mo":"."}],"mo":"="}}}},"With a large N, Y(k) has a \u03c7distribution. If the variance of the sequence is unknown (i.e., the common case), it can be substituted by the sample variance. Knowing the distribution of the signal under the null hypothesis, a goodness of fit test is used to determine if the signal has a \u03c7distribution. Some typical goodness of fit tests are the Kolmogorov-Smimov and the Pearson \u03c7test. The former is used in this invention.","Adaptive Dither","One of the main contributions of this invention is a methodology to obtain an adaptive dither which depends on the signal being quantized. This signal dependent dither must have a total error with a constant variance as does TPDF dither. Also, this signal dependent dither must have less variance of the total error, and so less noise, than the typical TPDF dither. To obtain this dither, many statistical approaches were tried without good results. One of them linearizes the quantizer to deconvolve the PDF using an extended Gaussian Mixture Model approach. As none of the statistical methods gave satisfactory results, a numerical approach is proposed to find a dither signal using optimization methods.","The mathematical problem statement and two methods for obtaining a solution will be described.","Adaptive Dither Problem Statement","Let the quantized signal be defined as:",{"@attributes":{"id":"p-0119","num":"0118"},"maths":{"@attributes":{"id":"MATH-US-00028","num":"00028"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mrow":{"msub":{"mi":["Q","r"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mfrac":{"mrow":{"mi":"x","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"msup":{"mn":"2","mi":"m"}},"mo":"+","mrow":{"mi":"d","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}}}},"mo":"\u2062","msup":{"mn":"2","mi":"m"}}],"mo":"="},"mo":","}}},"br":{},"sub":"r","sup":"m "},{"@attributes":{"id":"p-0120","num":"0119"},"maths":{"@attributes":{"id":"MATH-US-00029","num":"00029"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mfrac":{"mrow":{"mi":"x","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"msup":{"mn":"2","mi":"m"}},"mo":"=","mrow":{"mrow":[{"msub":{"mi":["x","i"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msub":{"mi":["x","f"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}],"mo":"+"}}],"mo":"="},"mo":","}}},"br":[{},{}],"sub":["i","f","f","q","r","i","f","i","r","f"],"in-line-formulae":[{},{}],"i":["x","[n]=Q","x","[n]+x","[n]+d[n","x","[n]+Q","x","[n]+d[n"],"sup":["m","m"]},"In addition, the scaled quantization error signal is the difference between the input signal and the quantized signal divided by r as shown in the following equation:",{"@attributes":{"id":"p-0122","num":"0121"},"maths":{"@attributes":{"id":"MATH-US-00030","num":"00030"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mfrac":{"mrow":{"mrow":[{"mi":"x","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}],"mo":"-"},"msup":{"mn":"2","mi":"m"}},"mo":"=","mrow":{"mrow":[{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mfrac":{"mrow":{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"msup":{"mn":"2","mi":"m"}},"mo":"."}],"mo":"-"}}],"mo":"="}}}},"Replacing and using the above equations, the following expression is obtained:",{"@attributes":{"id":"p-0124","num":"0123"},"maths":{"@attributes":{"id":"MATH-US-00031","num":"00031"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"munder":[{"mrow":{"mrow":[{"msub":{"mi":["x","i"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msub":{"mi":["x","f"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}],"mo":"+"},"munder":{"mi":"\ufe38","mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}}},{"mrow":{"mrow":[{"msub":{"mi":["x","i"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"msub":{"mi":["Q","r"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":["x","f"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mi":"d","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}],"mo":"+"}}}],"mo":"-"},"munder":{"mi":"\ufe38","mrow":{"mrow":{"mrow":{"msub":{"mi":["x","q"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},"mo":"\u2062","mn":"2"},"mo":"-","mi":"m"}}}],"mo":"-"}],"mo":"="},{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mrow":[{"msub":{"mi":["x","f"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mrow":{"msub":{"mi":["Q","r"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":["x","f"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}},{"mi":"d","mo":"\u2061","mrow":{"mo":["[","]"],"mi":"n"}}],"mo":"+"}}},"mo":"."}],"mo":"-"}],"mo":"="}],"mo":[",","\u2062"],"mstyle":{"mtext":{}}}}}},"At this point, it is clear that the total error only depends of the fractional part of x[n]. Hence, the integer part can be ignored for purposes of this invention. As previously described, the autocorrelation of the error is used to measure whether it is white noise and the white noise autocorrelation is an impulse at lag zero. The desired error autocorrelation for lags 0 to N\u22121 is given by:",{"@attributes":{"id":"p-0126","num":"0125"},"maths":{"@attributes":{"id":"MATH-US-00032","num":"00032"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":["f","d"],"mo":["(","\u2062",")"],"mstyle":{"mspace":{"@attributes":{"width":"0.em","height":"0.ex"}}}},{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"msub":{"mi":"f","mn":"0"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}}},{"mtd":{"mrow":{"msub":{"mi":"f","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}}},{"mtd":{"mrow":{"msub":{"mi":"f","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}}},{"mtd":{"mrow":{"msub":{"mi":["f","k"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}}},{"mtd":{"mrow":{"msub":{"mi":"f","mrow":{"mi":"N","mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}}}]}},{"mo":"\u2003","mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}}],"mo":"\u2062"}},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]},{"mtd":[{"mn":"0"},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"2"}}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]},{"mtd":[{"mn":"0"},{"mo":"+"},{"mn":"0"},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"3"}}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]},{"mtd":[{"mi":"\u22ee"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"\u22f1"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"mn":"0"},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mn":"0"},{"mo":"+"},{"mrow":{"mrow":[{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}},{"mi":"\u03b5","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]}]}},{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"N","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mi":"\u03c3","mn":"2"}}}},{"mtd":{"mn":"0"}},{"mtd":{"mi":"\u22ee"}},{"mtd":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},{"mtd":{"mn":"0"}}]}}],"mo":"="}}],"mo":"="}],"mo":"="}}},"br":{},"sub":["f ","f ","r","r"],"figref":"FIG. 4"},"In this invention, an approximation is used for the linearization. The simplest estimator of Q(x) is to linearize",{"@attributes":{"id":"p-0128","num":"0127"},"maths":{"@attributes":{"id":"MATH-US-00033","num":"00033"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mrow":{"msub":{"mover":{"mi":"Q","mo":"^"},"mi":"r"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mo":"=","mi":"x"},{"mrow":{"mi":"so","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mfrac":{"mrow":[{"mo":"\u2146","mrow":{"msub":{"mover":{"mi":"Q","mo":"^"},"mi":"r"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}}},{"mo":"\u2146","mi":"x"}]}},"mo":"=","mn":"1."}],"mo":","}}},"br":[{},{}]},"Levenberg-Marquardt (LM) is an iterative optimization algorithm that can be used to find a solution which minimizes a system of non-linear functions. It is popular because it has a double behavior as a Gauss-Newton method and as Gradient Descent. In this invention the LM algorithm is used to iteratively obtain the dither vector d. In this algorithm, the update rule to obtain d is given by:\n\n+\u03b1\n","For small values of \u03b1 and using the first order Taylor expansion to approximate f(d) this becomes:\n\n()=(+\u03b1)\u2212()\u03b1,\n\nwhere J is the Jacobian matrix. Denoting the iteration error as e=f({circumflex over (d)})\u2212f(d+\u03b1), where d is the optimum solution, it is desired that the error decreases during each iteration. Hence, it is necessary that \u2225e\u2225=ee be minimum. Applying the above equation to the iteration error gives:\n\n\u2225()\u2212()\u2212()\u03b1\u2225.\n","Taking the first derivative with respect to \u03b1 and setting it equal to zero gives the equation below. This equation is called the normal equation:\n\n()()\u03b1=()(()\u2212()).\n","Subsequently, \u03b1 is obtained solving this linear system. Modifying this equation, Levenberg and later Marquardt propose a variation to the normal equations which are called the augmented normal equations:\n\n()(()\u2212()),\n\nwhere N=\u03bcl+J(d)J(d). The constant \u03bc is called the damping parameter and it is always positive. The algorithm assumes an initial \u03bc and \u03b1. If the error is reduced for a given value of \u03b1, then d is updated, \u03bc is decreased and a new iteration begins. On the other hand, if the new a increases the error, then \u03bc is increased and \u03b1 is recalculated. This procedure is repeated until the error is decreased. When the d is updated the entire process is repeated until the error or the relative change of \u03b1 are below of a threshold or a maximum number of iterations is reached.\n","The LM algorithm is said to have a double behavior. This is because when \u03bc is decreased (and it is small) it converges as a Gauss Newton method. In contrast, if \u03bc increases then it converges as a Gradient Descent method. In the case of dither, it is important that the value of d[n] will be limited in its values to assure that converges to an optimum solution. For this reason, it is necessary to add box constraints (i.e, upper and lower bounds) to the original LM algorithm. Another reason is that the approximations of Q(x) are made in the region between \u22124\u0394 and 4\u0394. A modification to this method to operate under a set of constraints will be explained later.","The solution dither vector d shows high correlation between different audio frames when the system f(d) is solved using LM. The circular autocorrelation estimator is proposed as a method to eliminate this correlation between frames. Let the circular autocorrelation estimator at lag L be defined as:",{"@attributes":{"id":"p-0135","num":"0134"},"maths":{"@attributes":{"id":"MATH-US-00034","num":"00034"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mrow":[{"msub":{"mi":["f","L"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mn":"0"},{"mi":"N","mo":"-","mn":"1"}]},"mo":"\u2062","mrow":{"mrow":[{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mrow":{"mo":["\u2329","\u232a"],"mrow":{"mi":["n","L"],"mo":"-"}},"mi":"N"}}},{"mi":"\u025b","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"n"}}],"mo":"\u2062"}}],"mo":"="},"mo":","}}},"br":{},"sub":"N "},{"@attributes":{"id":"p-0136","num":"0135"},"maths":{"@attributes":{"id":"MATH-US-00035","num":"00035"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":["f","d"],"mo":["(","\u2062",")"],"mstyle":{"mspace":{"@attributes":{"width":"0.em","height":"0.ex"}}}},{"mi":"k","mo":"\u2062","mrow":{"mo":"\u2003","mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}}],"mo":"\u2062"}},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"2"}}},{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"2"}}}],"mo":"\u2062"}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}}],"mo":"\u2062"}},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"2"}}},{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"2"}}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}}],"mo":"\u2062"}},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"3"}}},{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]},{"mtd":[{"mi":"\u22ee"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"\u22f1"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mfrac":{"mi":"N","mn":"2"}}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"0"}}],"mo":"\u2062"}},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mfrac":{"mi":"N","mn":"2"},"mo":"+","mn":"1"}}},{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mn":"1"}}],"mo":"\u2062"}},{"mo":"+"},{"mi":"\u2026"},{"mo":"+"},{"mrow":{"mrow":[{"msub":{"mi":["\u03b5","kn"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mfrac":{"mi":"N","mn":"2"}}},{"msub":{"mi":["\u03b5","u"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"N","mo":"-","mn":"1"}}}],"mo":"\u2062"}}]}]}},{"mi":"k","mo":"\u2061","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"N","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mi":"\u03c3","mn":"2"}}}},{"mtd":{"mn":"0"}},{"mtd":{"mi":"\u22ee"}},{"mtd":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},{"mtd":{"mn":"0"}}]}}}],"mo":"="}}}],"mo":"="}}},"br":[{},{}],"sub":["u ","kn "]},"The update sequence is given by:\n\n(+\u03b1),\n\nwhere Pis the projection operation. Similar to the unconstrained LM algorithm, if the error is reduced, then \u03bc is reduced and a new iteration begins. Otherwise, the updated value is defined as d=P(d\u2212tJ(d)), where tmust be well chosen to have an error in decreasing direction.\n\nSpectral Projected Gradient Optimization\n","Spectral projected gradient (SPG) is an algorithm which minimizes an objective function in a closed region, in this method denoted a box. The method is a modification to the Barzain-Borwein gradient descent algorithm. The algorithm was introduced and later modified by Birgin, Martinez and Raydan (incorporated herein by reference). The method has the following objective function:",{"@attributes":{"id":"p-0139","num":"0138"},"maths":{"@attributes":{"id":"MATH-US-00036","num":"00036"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}},{"mrow":[{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"i","mo":"=","mn":"0"},{"mi":"N","mo":"-","mn":"1"}]},"mo":"\u2062","msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["f","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}},"mn":"2"}}},{"mrow":[{"mfrac":{"mn":["1","2"]},"mo":"\u2062","msup":{"mrow":{"mo":["\uf605","\uf606"],"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}}},"mn":"2"}},{"mfrac":{"mn":["1","2"]},"mo":["\u2062","\u2062"],"msup":{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}},"mi":"T"},"mrow":{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"d"}},"mo":"."}}],"mo":"="}],"mo":"="}],"mo":"="}}}},"Similar to LM, the spectral projected gradient finds a vector d which minimizes the objective function. The update rule to obtain d is given by:\n\n,\n\nwhere \u03b6 is the step size and pis the search direction defined as:\n",{"@attributes":{"id":"p-0141","num":"0140"},"maths":{"@attributes":{"id":"MATH-US-00037","num":"00037"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":["p","k"]},"mo":"=","mrow":{"mrow":[{"msub":{"mi":["p","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":["d","k"]},"mo":"-","mrow":{"mfrac":{"mn":"1","msub":{"mi":["\u03ba","k"]}},"mo":["\u2062","\u2062","\u2062"],"mi":"\u25bd","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":["d","k"]}}}}}}},{"mi":"d","mo":"."}],"mo":"-"}}}}},"The parameter \u03bais obtained using the Barzain-Borwein gradient descent method where the parameter is estimated using the slack variables, S=x\u2212xand y=F(d)\u2212F(d). Therefore, the factor is given by:",{"@attributes":{"id":"p-0143","num":"0142"},"maths":{"@attributes":{"id":"MATH-US-00038","num":"00038"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msup":{"mi":"\u03ba","mrow":{"mi":"k","mo":"+","mn":"1"}},"mo":"=","mrow":{"mfrac":{"mrow":[{"msup":[{"mrow":{"mo":["(",")"],"msup":{"mi":["s","k"]}},"mi":"T"},{"mi":["y","k"]}],"mo":"\u2062"},{"msup":[{"mrow":{"mo":["(",")"],"msup":{"mi":["s","k"]}},"mi":"T"},{"mi":["s","k"]}],"mo":"\u2062"}]},"mo":"."}}}}},"Note that \u03ba can take any positive value. To avoid very large or very small values of \u03ba, the method inserts an upper and lower bound. Therefore, the parameter becomes:",{"@attributes":{"id":"p-0145","num":"0144"},"maths":{"@attributes":{"id":"MATH-US-00039","num":"00039"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msup":{"mi":"\u03ba","mrow":{"mi":"k","mo":"+","mn":"1"}},"mo":"=","mrow":{"mi":"min","mo":"\u2062","mrow":{"mrow":{"mo":["{","}"],"mrow":{"msub":{"mi":["\u03ba","max"]},"mo":",","mrow":{"mi":"max","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"msub":{"mi":["\u03ba","min"]},"mo":",","mfrac":{"mrow":[{"msup":[{"mrow":{"mo":["(",")"],"msup":{"mi":["s","k"]}},"mi":"T"},{"mi":["y","k"]}],"mo":"\u2062"},{"msup":[{"mrow":{"mo":["(",")"],"msup":{"mi":["s","k"]}},"mi":"T"},{"mi":["s","k"]}],"mo":"\u2062"}]}}}}}},"mo":"."}}}}}},"Finally, the vector is calculated using a non-monotone line search. In this line search, \u03b6is found if F(d)\u2266F+\u03b3\u03b6F(d)P, where \u03b3 [0, 1]. Otherwise, the value is iteratively obtained using the following update rule:",{"@attributes":{"id":"p-0147","num":"0146"},"maths":{"@attributes":{"id":"MATH-US-00040","num":"00040"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":["\u03b6","tmp"]},"mo":"=","mrow":{"mrow":[{"mo":"-","mfrac":{"mn":["1","2"]}},{"mfrac":{"mrow":[{"msup":[{"mi":"\u03b6","mn":"2"},{"mrow":{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":["d","k"]}}},"mi":"T"}],"mo":["\u2062","\u2062","\u2062","\u2062"],"mi":"\u25bd","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["p","k"]}},{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":"d","mrow":{"mi":"k","mo":"+","mn":"1"}}}},{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"msup":{"mi":["d","k"]}}}],"mo":"-"}]},"mo":"."}],"mo":"\u2062"}}}}},"If \u03b6is between the upper and the lower bound of \u03ba then \u03b6=\u03b6, otherwise, \u03b6=\u03b6\/2.","The following description explains several experiments defining the need for dither and adaptive dithering in one dimensional signals. Experiments with synthetic and real audio were performed to determine if the total error is white noise. In addition, examples of the effectiveness of the methods when the data comes from AR, MA and ARMA process are shown. Then, adaptive dither in synthetic and real audio is presented. The experiments were designed to test if adaptive dithering reaches the desired variance in the total error at different levels of quantization and at different values in the desired variance.","Experiments for Measuring the Need for Dither","The purpose of these experiments was to test the algorithms previously described which measure the need for dither. The experiments are statistical based hypothesis testing. This type of test has two types of error: saying the null hypothesis is false when it is true (type I error) and saying it is true when it is false (type II error). The tests are typically designed to have a user defined type I error. This methodology is used here and the type I error has been set at 10%. The null hypothesis in these experiments is that the signal is white noise. Thus, the error level has been selected so that 10% of the time the signal will be said to be not white when it really is.","Experiments Using an AR Process","The experiments explained are designed to test the relative performance of the different tests with synthetic data. The performance of the hypothesis tests when the data comes from an autoregressive process will be measured as shown in . The term zin  is a delay in time domain, so, the linear difference equation is given by o[n]=x[n]+ao[n\u22121], where o is the output of the AR process.","The level of the constant a controls the relative level of whiteness of the output signal. The input signal is a zero mean white noise uniformly distributed with 10000 samples. The two time domain tests and the frequency domain test previously explained are used to test the output signal as the constant a is varied from 0 to 1. As can be seen from , when the constant is set to zero the output is white noise, and as the constant increases the relative whiteness of the output signal decreases. The three tests reject the null hypothesis of white noise for relatively small values of a.","The probability value (p-value) in  can be interpreted as the probability of getting a value of the test statistic as extreme as or more extreme than that observed by chance alone under the null hypothesis. In this case, the three tests are fairly close, with the Ljung-Box test correctly identifying the signal as being non-white when the magnitude of a is only about 0.2.","Experiments Using an Ma Process","The purpose of this experiment was to evaluate at what level of whiteness the tests reject the null hypothesis when the data comes from a moving average process. This experiment uses synthetic data from a first order moving average process as shown in the . In this case, the linear difference equation is given by o[n]=x[n]+ax[n\u22121].","Similar to the AR process, the constant a controls the level of whiteness of the MA process. The input signal is zero mean white noise with 10000 samples. As shown in , when the constant a is close to zero the white noise tests does not reject the null hypothesis. On the other hand, when the constant is increased the white noise tests reject the null hypothesis. The Ljung box test is the best test because it rejects the null hypothesis for a smaller value of a than the other tests.","Experiments Using an ARMA Process","Analogous to the MA and AR process, the goal of this experiment is to evaluate the different tests when the data comes from a first order ARMA process. The input signal has the same characteristics of the last experiment. The process generation is shown in . Note that the ARMA process is the concatenation of an AR process and an MA process, so, its linear difference equation is given by o[n]=x[n]+ax[n\u22121]+bo[n\u22121].","In this case, the signal is controlled using an autoregressive constant a and the moving average constant b. The results of varying the constants a and b between 0 and 1 are shown in . When the constants are near zero, the output is white noise, and as the constants increase, the relative whiteness of the output signal decreases. When the constants a and b are the same, the signal is white noise. This is because the pole and the zero of the transfer function cancel when they are the same. The Ljung Box test is better than the other tests because it rejects the null hypothesis at smaller values of a and b than the Box-Pierce and Frequency Test.","Audio Experiments","Experiments Using Synthetic Audio","This set of experiments use a full scale 1333 Hz cosine wave with 24 bit precision. Each segment has a length of 10000 points and 1250 lags are used in the autocorrelation tests.","This first experiment was done to determine at what bit level the quantization noise ceases to be white. Here the signal is re-quantized to different bit levels varying from 22 down to 1 bit. As can be seen in , the tests have p-values above 0.1 until the signal is quantized around to 16 bits. At this point the p-values of the tests begin to decrease, each one showing that the total error is no longer white when the signal is re-quantized to values between 12 and 14 bits. Below to 12 bits the hypothesis test has p-values near to zero. The Box-Pierce test is the most monotonic, with the Frequency test having the most ripples near the hypothesis rejection level translating in less stability in its rejection.","Another experiment was performed using the same signal as before. The purpose was to observe the unwanted harmonics when the amplitude of the signal is changed. This experiment using synthetic audio uses a 1333 Hz cosine wave with 24 bit precision, and re-quantizes to either 16 or 12 bits. In this experiment, the amplitude of the cosine is decreased until unwanted harmonics appear in the re-quantized signal. It was found that the total error is classified as non-white before the harmonics are visible in the spectrum. When re-quantizing to 16 bits, the tests reject the null hypothesis when the cosine has been reduced to \u221220 dB or more. However, the harmonics are not visible in the PSD until the signal has been reduced by at least \u221220.9 dB of its maximum value. The results are similar when re-quantizing to 12 bits. The tests reject when the amplitude has been reduced by at least \u221210 dB, but visible harmonics appear when the amplitude has been reduced by at least to \u221213 dB.","Experiments Using Real Audio","The final experiments of this section used real audio with 24 bit precision and a 44.1 kHz sampling rate. Since an audio signal can change over time, the procedure is to segment the signal, and apply the tests on each segment. This is done to strengthen the stationary assumption. As in the previous test, each segment is 10000 samples in length, and the autocorrelation tests used a lag of 1250. The purpose of this experiment is to determine the number of frames that are rejected at different levels of quantization. This is done because it is assumed that an increase in the resolution produces a decrease in the number of rejected frames. For this experiment the audio signal has 711 frames.",{"@attributes":{"id":"p-0162","num":"0161"},"figref":"FIG. 17"},"A second experiment was performed in real audio to know at what bit depth in the re-quantized signal the tests do not reject the null hypothesis. In addition to looking at all the frames together, a study of only one frame was made. This frame was selected randomly and the same tests as above were performed for different re-quantization levels. The results are shown in . As can be seen in the Figure, the Box-Pierce test is again the most monotonic, with the frequency test having the most ripples. This suggests that the frequency test is less monotonic rejecting the null hypothesis than the autocorrelation tests.","Real Audio with Additive Dithering","If the tests previously proposed are used to measure white noise in the total error, then dither does not have to be added to the whole signal, only to the segments that do not pass the tests. As seen in the previous section, re-quantizing a segment to 4 bit resolution introduces unwanted harmonics and so does not have white total error. To see the effectiveness of adding dither, and if the test will show that the signal has been effectively dithered, the tests were run after adding dither. The results are shown in . The Figure shows that the dithered segment of real data has white total error. In addition, the total error is not rejected by the white noise hypothesis test, suggesting that dithering effectively uncorrelates the samples from the quantization total error.","An Application to Measure the Need for Dither","One of the objects of this invention is to implement the algorithms previously presented in Ansi C\/C++. This was done because the compiled C code is faster than Matlab\u2122 and other scripting languages. The program was written in Visual C++ and uses the GNU Scientific Library (GSL) for general mathematical functions. Other functions have been programmed in order to have the same functionality of Matlab\u2122. The program processes a standard 24 bit audio file in WAV format. The program segments the input wave file into frames of 10000 samples. After that, it truncates each sample to 16 bits using a shift right operation. It then calculates the p-value of the Ljung-Box, Box-Pierce and frequency test. When any of the tests rejects the null hypothesis, dither is added to this frame. To avoid the abrupt change of noise in the signal, the program increases and decrease the noise level gradually.","Specifications",{"@attributes":{"id":"p-0166","num":"0165"},"figref":"FIG. 20"},"In the file properties edit box, the program writes information about the sampling frequency, the number of samples and the number of channels (mono or stereo). Meanwhile, in the status edit box, the program indicates if the signal is being analyzed or the output file has been written.","Testing the Segment Dependent Dither C Program","The following experiment evaluates if dither is added in the frames where the test rejects the white noise hypothesis. This experiment was done using real audio data. In , (b) and (a) show the total error signal with segment depended dithering and undithered quantization respectively. (c) shows the difference between these signals. In (c), it can be seen that when the total error has long periods of zero, meaning that in these sectors dither was not added. (b) shows that dither is added in some segments of the audio signal in contrast to (a) where the total error is uniform.","The following experiment is a comparison of the sample variance of the total error when the signal of (a) is quantized with different types of dither.","Table 1 below shows the variances of the total error in non-subtractive dithering scheme. As can be shown, the quantized signal with triangular PDF dither in the frames that do not pass the tests has the lowest variance.",{"@attributes":{"id":"p-0171","num":"0170"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"Dither","Variance"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Uniform PDF","0.1666"]},{"entry":[{},"Gaussian PDF","0.1734"]},{"entry":[{},"Triangular PDF","0.2502"]},{"entry":[{},"Frame dependent","0.1182"]},{"entry":[{},"triangular PDF"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}}},"Now that the program has been shown to be working correctly, the total error is analyzed.  illustrates how the total error increases and decreases gradually avoiding abrupt changes of noise in the total error. It is important to note that in the frames which do not need dither the noise is apparently uniform i.i.d. sequence.","Adaptive Dither in Synthetic Audio","This set of experiments use a 10% of full scale 1333 Hz cosine wave with 24 bit precision. This experiment seeks to measure the difference between the total error variance obtained with Levenberg-Marquardt algorithm (LM) and Spectral Projected Gradient (SPG) and the desired variance. The total error variance of adaptive dither techniques previously described is compared with the variance of classical dither techniques. The input signal is dithered with adaptive dither, uniform PDF dither (RPDF), triangular PDF dither (TPDF), and Gaussian PDF dither (GPDF) and re-quantized to 16 bits. The desired variance of the total error for LM and SPG has been set to 0.150 as this is below the mean variance of the total error when dither has a RPDF (i.e, near 0.17) or a TPDF (i.e, near 0.250). The length of the frames has been set between 1000 and 10000 samples.",{"@attributes":{"id":"p-0174","num":"0173"},"figref":"FIG. 23"},"The previous experiment measures the variance of the total error when the re-quantized signal has 16 bits and it is necessary to measure if adaptive dither works at different bit depth in the re-quantized signal. The goal of the following experiment is to measure adaptive dither variance at different levels of quantization. The signal is quantized with adaptive dither and compared with classic techniques. The input signal has 1000 samples, the variance for adaptive dithering is set at 0.150 and the quantization levels q are 8, 13, 16 and 19.",{"@attributes":{"id":"p-0176","num":"0175"},"figref":["FIG. 24","FIG. 24"]},"The aim of the following experiment with synthetic audio is to evaluate if the desired variance of the total error is reached when this is set at different values. Specifically, this desired variance is varied between 0.11 and 0.3.",{"@attributes":{"id":"p-0178","num":"0177"},"figref":["FIG. 25","FIG. 24"]},"Experiments with Adaptive Dither and Real Audio","The purpose of the following experiments is to test the adaptive dithering using real audio under various conditions. In these experiments dither is applied to each frame before to be re-quantized. This algorithm was implemented in C++ using LEVMAR (incorporated herein by reference) for LM and Ool Optimization Package (incorporated herein by reference) for SPG. The experiments used real audio with 24 bit precision and a 44.1 kHz sampling rate. The optimization packages speed is related with the number of variables, so the program segments the data into frames. Furthermore, to analyze the signal, the program needs the number of bits, the filename, the length of the frame and the number of frames to analyze.","As the frames are relatively short, it was necessary to view the autocorrelation of the entire dataset to test if the total error signal was white noise. As seen in , in the case of ANSD with LM the total error signal has harmonics resulting in a bad quantization. The Ljung Box test was used and it rejected the null hypothesis of white noise.","This occurs because the first and the last error signals are contributing more to the optimization than the other samples in the desired error autocorrelation equation f(d). Similarly, the second most influential samples are \u03b5and \u03b5and so on. This indicates that the error samples from the middle has a smaller effect than the others, showing a higher relationship between the total error frames as shown in . The only way found to correct this side effect was using the circular autocorrelation estimator and redefining the system of non-linear equations as can be shown in the circular autocorrelation estimator equation f(d) and the new systems of equations for the LM algorithm f(d) respectively.","The following experiments with adaptive dithering and real audio are done to show that the methods reach the desired variance in the total error when the input is segmented in frames. These experiments use a set of 200000 samples segmented into frames with lengths of 1000, 2000, and 4000 samples for LM. For SPG the lengths of the frames were 1000, 2000, 4000, and 10000 samples. The desired variance in the total error is set at 0.150. The audio file has been written at 24 bits and the re-quantized signal at 16 bits.  shows the sample autocorrelation for ANSD with a frame length of 1000 samples. As seen in this Figure, the autocorrelation is white noise for LM and SPG. Table 2 shows that the total error in an adaptive dithering does not reject the null hypothesis of white noise for Ljung-Box Test, Box Pierce and Frequency tests.",{"@attributes":{"id":"p-0183","num":"0182"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"center"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Dither","Ljung Box","Box Pierce","Frequency"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Adaptive dither","0.9562","1.0000","0.3905"]},{"entry":["with LM",{},{},{}]},{"entry":["Adaptive dither","0.8287","1.000\u2002","0.3463"]},{"entry":"with SPG"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"Also, , ,  and  show the sample autocorrelation for frame lengths of 2000 and 4000 and 10000 samples. For these, the same behavior can be observed as in . In the same way, Tables 3, 4 and 5 show that the set of samples are not rejected by the hypothesis tests.",{"@attributes":{"id":"p-0185","num":"0184"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 3"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Dither","Ljung Box","Box Pierce","Frequency"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Adaptive dither","0.7825","1.0000","0.3905"]},{"entry":["with LM",{},{},{}]},{"entry":["Adaptive dither","0.7548","1.000\u2002","0.3689"]},{"entry":"with SPG"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},{"@attributes":{"id":"p-0186","num":"0185"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 4"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Dither","Ljung Box","Box Pierce","Frequency"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Adaptive dither","0.9692","1.0000","0.6224"]},{"entry":["with LM",{},{},{}]},{"entry":["Adaptive dither","0.9985","1.0000","0.1091"]},{"entry":"with SPG"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},{"@attributes":{"id":"p-0187","num":"0186"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"center"}}],"thead":{"row":[{"entry":"TABLE 5"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Dither ","Ljung Box","Box Pierce","Frequency"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Adaptive dither","1-000","0.1446","0.2233"]},{"entry":"with SPG"},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}}}},"This invention has demonstrated that hypothesis testing can be used effectively to determine if the total error of a re-quantized signal is white noise. The experiments indicate that for the 10% error level chosen, the tests are more sensitive than visual or audio inspection of the quantization error in determining if it is white noise or not. The application to real audio signal re-quantizing is straight forward. The signal can be segmented, and each segment tested for the whiteness of the quantization noise. Dither can be added to the segments that do not pass the tests. Of course, having one segment with no dither followed by another with dither may be undesirable, and also adding the typical full scale dither may not be needed. In addition to this, an application for segment dependent dithering was developed in C++ where a signal is re-quantized from 24 to 16 bits adding dither to the segments where the total quantization error is not white noise. The program has better execution time than Matlab\u2122 and contains libraries to analyze white noise conditions in time and frequency.","A representative digital computer system can be programmed to perform the method of this invention. The system comprises of a signal receiving unit for receiving and optionally storing\/buffering a digital signal; a segmenting unit for segmenting the received signal into a plurality of frames, each one comprising a selected amount of samples; a white noise detection unit receiving the plurality of frames and statistically processing each frame to determine the presence of white noise on the frames; a dithering unit receiving only the frames not having white noise for selectively adding dither to those frames; and an output unit providing a dithered signal. Alternatively, a programmable application-specific integrated circuit (ASIC) can be used to integrate at least part of the components in order to perform the method of this invention.","Other digital computer system configurations can also be employed to perform the method of this invention, and to the extent that a particular system configuration is capable of performing the method of this invention, it is equivalent to the above-explained representative digital computer system and within the scope and spirit of this invention. Once they are programmed to perform particular functions pursuant to instructions from program software that implements the method of this invention, such digital computer systems in effect become special-purpose computers particular to the method of this invention. The techniques necessary for this are well-known to those skilled in the art of computer systems.","Computer programs implementing the method of this invention will commonly be distributed to users on a distribution medium such as floppy disk or CD-ROM. From there, they will often be copied to a hard disk or a similar intermediate storage medium. When the programs are to be run, they will be loaded either from their distribution medium or their intermediate storage medium into the execution memory of the computer, configuring the computer to act in accordance with the method of this invention. All these operations are well-known to those skilled in the art of computer systems.","Adaptive dithering of one dimensional signal is a new technique which has been designed solving the non-linear system of equations of the autocorrelation of the total error. The derivatives of the system are approximated using a linear function. Iterative algorithms were then used to solve the resulting non-linear system. The methods were Levenberg Marquardt and Spectral Projected Gradient. For Spectral Projected Gradient, each segment of the signal can be analyzed and the dither is obtained independently without showing a linear relationship between them. Also, the experiments show that the resulting variance in the total error using SPG reaches the desired variance with an absolute error of around 0.01. For the Levenberg Marquardt algorithm, the linear autocorrelation estimator is not useful for more than one frame. The reason for this is that the adaptive dither and the total error signals between frames are not independent causing a non-white noise signal, and consequently rejecting the null hypothesis of white noise. In order to eliminate the correlation in LM, a circular autocorrelation estimator was used giving better results than linear autocorrelation. With this estimator, the null hypothesis of the white noise test is not rejected. Moreover, different experiments changing the length of the frames and the number of bits in the re-quantized signal show that LM and SPG are accurate reaching the desired variance in the total error with a small error margin. Furthermore, the programs for SPG and LM were tested in C++ offering better performance than Matlab\u2122. Finally, the experiments show that ANSD allows a total error signal with a constant variance from frame to frame and has a lower quantization noise variance than classic dithering techniques.","It is also envisioned that ANSD can be implemented in a parallel model which allows analyzing more data in less time. This implementation can have two schemes; the first consists of the implementation of the same program running on many platforms for different parts of the digital signal. And the second is to parallelize the optimization to improve the performance of the original program. In addition, adaptive dither and segment dependent dither can be tried for multidimensional problems.","The above description and drawings illustrate preferred embodiments which achieve the objects, features, and advantages of the present invention. Although certain advantages and preferred embodiments have been described above, those skilled in the art will recognize that substitutions, additions, deletions, modifications and\/or other changes may be made without departing from the spirit or scope of the invention. Accordingly, the invention is not limited by the foregoing description but is only limited by the scope of the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The above-described features of the invention will be more clearly understood from the following detailed description, which is provided with reference to the accompanying drawings in which:",{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 25"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 26"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 30"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 31"}]},"DETDESC":[{},{}]}
