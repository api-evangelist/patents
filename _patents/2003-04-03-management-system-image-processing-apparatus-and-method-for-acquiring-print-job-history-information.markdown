---
title: Management system, image processing apparatus and method for acquiring print job history information
abstract: The present invention makes it possible to uniquely manage the use of peripherals over a wide range or in two or more bases. The present invention controls whether all job information, managed by a management apparatus, is acquired from the management apparatus managing information on data processing, performed by a device, as job information, or additional job information among job information managed by the management apparatus is acquired.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07852502&OS=07852502&RS=07852502
owner: Canon Kabushiki Kaisha
number: 07852502
owner_city: Tokyo
owner_country: JP
publication_date: 20030403
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["1. Field of the Invention","The present invention relates to a management system of a usage amount at the time when a user uses a peripheral, which is connected to a network, such as a printer, a scanner, a copier, or a multi function peripheral (MFP) that integrate them, in a network environment constituted of a client computer, a server computer, etc.","2. Related Background Art","Up to now, known information processing apparatuses have managed usage amounts or information, relating to data processing executed by use, when each user uses a peripheral such as a printer, a scanner, a copier, or a multi function peripheral (MFP) integrating them, via a network.","In such an information processing apparatus, for example, as disclosed in Japanese Patent Application Laid-Open No. 10-161823 (U.S. Pat. No. 6,202,092), one server computer manages the use of a peripheral.","Nevertheless, in conventional technology as in the above, one server computer should manage plenty of peripherals when there are a lot of peripherals. In addition, in this case, peripherals that one server computer can manage are limited to ones that exist in the same building or room, or the like.","Hence, it was difficult to integrally manage a use status of peripherals in a wide range or across two or more bases by using a communication path such as the Internet. In addition, even if a plurality of server computers were installed in each base, the plurality of server computers managed only usage amounts and use statuses of peripherals under management, and information collected by each server computer was utilized individually and independently.","Hence, the present invention is to solve the tasks of conventional technology described above, and aims at making it possible to centrally manage the use of peripherals in a wide range or across a plurality of bases.","Moreover, the present invention aims at efficiently collecting information collected in a wide range or across a plurality of bases without increasing a load.","In addition, when a new user or apparatus, or the like is added in each base, a mismatch is caused between information, having already been grasped, and information collected from each base, and hence, it is not possible to correctly manage states of peripherals. On the other hand, it becomes impossible to perform accurate management in the case of unconditionally discarding the information where the mismatch is caused in order to avoid it, and a communication load and a processing load increase in the case of acquiring all the past information every time.","Hence, the present invention is to solve the tasks of conventional technology described above, and aims at making it possible to centrally manage the use of peripherals in a wide range or across a plurality of bases.","Moreover, the present invention aims at making it possible to perform information management corresponding to user's intention by also flexibly corresponding to the case that a new user or apparatus, or the like is added.","Hereafter, an example of embodiments of the present invention will be explained with referring to drawings.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 1","FIG. 1"],"b":["108","110"]},"Printers differently operate according to their functions. For example, the printer  is a most general one, and prints data received from a transmission unit in a client computer. In addition, the data processing that a device is required to perform is called a job, and in particular, the printing processing based on print data is called a printing job. The printer  sends a total number of delivery pages of the job at the time of job end to the transmission unit in the client computer . After printing, the printer  stores job information in memory in the printer.","The client computer  in  performs printing as follows. An application  operates a GDI (a subsystem processing graphic drawing)  of an OS by calling an application programming interface (API). A printer driver  converts a request from the GDI  into a form suitable to a printer performing printing to transmit the request to a spooler .","In the client computer , a job account client  hooks (monitors and recognizes) a GDI call of the application . The job account client  acquires a number of delivery sheets or a number of pages of a job that the application issued by counting the API performing page breaks or paper ejections. The job information acquired owing to this is called a hook log.","In addition, the job account client  can receive job information from a printer driver in the client computer by beforehand defining a protocol with and communicating with the printer driver. The job information acquired owing to this is called a driver log.","Furthermore, the job account client  acquires a number of delivery sheets or a number of pages of a job by monitoring a spooler periodically, and acquiring job information in the API when there is the job to be spooled. The job information acquired owing to this is called an API log.","Furthermore, the job account client  acquires a total number of delivery pages, which the printer returns, by defining a protocol with and communicating with the transmission unit. The job information acquired owing to this is called a transmission unit log.","Moreover, the job account server acquires job information from a printer by defining a protocol with and communicating with a printer in the case of the printer, storing the job information in the printer, such as a printer  that is a preferable example of the image forming apparatus. The job information acquired owing to this is called a device log. Though the device log is stored in RAM or an HDD in the printer, due to the limitation of memory capacity, it frequently happens that it is not possible to store all of the information such as a document name transmitted from the transmission unit. In addition, the image forming apparatus includes a facsimile, a copier, or a copying system combining a printer, which is a kind of copier and a scanner in addition to being a printer.","The job account client  provides the priority of which is to be selected from among the hook log, driver log, API log, transmission unit log, and device log, and transmits any one to the job account server.","A job account server  selects a job log according to a reading requester's request to perform aggregate processing such as aggregation by unit time, by device, and by job issuer.",{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 1"},"The client computer  composed of a standard PC or a work station transmits print data to either of the printers , , and  through the transmission unit  when printing is instructed from the application . The job account client  that is a software unit executed by a CPU in the client computer collects logs concerning various types of printing processing to transmit them to the job account server  through a job log transmission unit . At this time, the job log transmission unit that is a part of the job account client can also transmit the logs to a job log receiving unit by controlling a transmission part that the OS provides.","When a printing instruction is issued to the application  in the client computer , the application  calls the GDI for drawing. A hook unit  is built in by the job account client , and stores information such as which GDI call is called by any parameter, and a called frequency by hooking the GDI calls. The history established on the basis of this information is called a hook log .","An example of the hook log  is shown in . The hook unit  may change a document name on the basis of a specific criterion according to circumstances. The document name and this modification processing will be described later.","The printer driver  converts the GDI call into print data that the printer can interpret according to print settings to transmit the print data to the spooler , and extracts printed information from the contents of the conversion to transmit the printed information to the job account client  as a driver log .","The job account client  monitors whether a job stays in the spooler . If a job stays, the job account client  issues an API specified by the OS to acquire the printed information, and acquires the printed information as an API log .","The transmission unit  communicates with the printer designated among the printers , , and  from the application via a network to transmit print data if the printer is in a ready state. At this time, for instance, if a command in Printer Job Language of Hewlett-Packard Company that is described above is used, it is possible to acquire a number of pages that the job concerned delivered in the printer  after completing the delivery of all the pages of the printing job. A transmission unit (port monitor)  sends the job information such as the number of pages received from the printer  to the job account client . The printing log created on the basis of this information is called a transmission unit log .","In this manner, in the job account client (acquisition means) , four logs, that is, the hook log, driver log, API log, and transmission unit log are acquired, and created for one printing job. Nevertheless, four logs can not be necessarily taken at any time. For example, if the application  sends print data directly to the spooler , it is not possible to acquire the hook log  and driver log . If a protocol is not specified between the printer driver  and job account client , it is not possible to acquire the driver log . If there is no function of notifying the transmission unit of a number of delivery pages like the printer , it is not possible to acquire delivery page information in the transmission unit log . Nevertheless, by acquiring logs in a plurality of processing relating to the job, a probability of being able to acquire the log rises totally even if log acquisition is impossible in a part of processing.","The printer  interprets the job sent from the transmission unit , and executes printing. The printer  interprets the job sent from the transmission unit , and executes printing. After the end of the printing, the number of delivery pages and the number of delivery sheets are replied to the transmission unit . The printer  interprets the job sent from the transmission unit , and executes printing. After of the end of the printing, the job information is stored in an HDD (described later) .","A job log merging unit  merges the hook log, driver log, API log, and transmission unit log to send its result to the job log transmission unit . Merge processing will be described later. The job log transmission unit  transmits a job log to a job log receiving unit  of the job account server .",{"@attributes":{"id":"p-0055","num":"0054"},"figref":["FIG. 2","FIG. 1","FIG. 2","FIG. 1"],"b":["201","202","203","203","102","103","104","105","107","118","206","202","201","204","205","206","207","107","117","208"]},{"@attributes":{"id":"p-0056","num":"0055"},"figref":["FIG. 3","FIG. 1","FIG. 3"],"b":["305","301","302","303","304"]},"The RAM  is an area where the operating system, and programs for communication control, engine controller, etc. are loaded and executed. An engine unit  of this apparatus performs printing operation and image reading under the control of the controller. A communication unit  controls network communication, and can communicate with the client computer and server computer as explained in . A user operation I\/O unit  performs interactive setting work with a user. A system bus  becomes a data path between the above-described components.",{"@attributes":{"id":"p-0058","num":"0057"},"figref":["FIG. 4","FIG. 1"],"b":["121","41","42","203","43","203","44","203","45"]},{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 5","FIG. 1","FIG. 2"],"b":["51","52","53","54","50","50","62","121","62"]},{"@attributes":{"id":"p-0060","num":"0059"},"figref":["FIG. 6","FIG. 1","FIG. 1"],"b":["60","61","62","60","61","60","203","42","41","62","101","121","101","121"]},{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 7","b":"101"},{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 8"},"For example, when 2-UP printing processing is performed in duplex printing at the time of four logical pages, physical pages become 2. Then, the physical pages are printed on both sides of the form, and one sheet of form is ejected. A first logical page and a second logical page are printed on a top, and a third logical page and a fourth logical page are printed on a back.",{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 10","b":"108"},"In each of the hook log, driver log, API log, and transmission unit log, an area where flag information showing whether the job concerned ends the processing and information showing a log type are recorded is provided.","Here, the operation of the job log merging unit  in the client computer will be explained. The job log merging unit  receives each log, and records its contents in an HDD etc. Then, the job log merging unit  starts periodically in a predetermined period, and performs the merge processing of logs per job.","Though logs are merged-in this embodiment by making a job ID a key, it is also good to merge logs by making a document data name, which will be described later, or a new document data name a key.",{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIG. 11"},"Next, the operation of the job account server  will be explained. A job log receiving unit  that is a preferable example of acquisition means of the present invention acquires and stores a job sent from the job log transmission unit . In addition, the job log receiving unit  performs the polling of the printer-  periodically, and acquires job information if there is job information not acquired yet. This job information is made a device log. Though the device log is stored in the RAM  or HDD , it is not desirable to store all the information such as a document name, transmitted from the transmission unit , because of the limitation of memory capacity. Here, it is assumed that the upper limit of the document name is eight characters.  is a table showing an example of the device log.","A device job log merging unit  that is a preferable example of managing means of the present invention merges a merge log , sent from the job account client, and the device log . A job log recording unit  receives the job log from the job log merging unit  and stores it in the HD  etc. A job log aggregating unit  performs aggregate processing such as finding of a number of printed pages per unit period, or a number of printed pages per owner by a reader's command.","The job log merging unit  retrieves and determines whether there is an unprocessed device log where an item of the document name is the same as that of the merge log, and substitutes or adds the number of delivery pages and number of delivery sheets in the device log for\/to those in the merge log if it is determined to be present.",{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 13","b":["123","123","124"]},{"@attributes":{"id":"p-0074","num":"0073"},"figref":"FIG. 14","b":["101","101","1400","1410"]},"Reference numerals  to  denote printers. Nevertheless, it is assumed that the printer  is a multi function periphery (MFP) that has a function (printing history retaining function) of retaining printing history, and printers  and  do not have the printing history retaining function. The MFP  comprises a printer function, a copy function, a scanner function, and the printing history retaining function.","The computers A, B, , and , and the printers  and , and MFP  can respectively communicate with other apparatuses via a network.","In the client computer A, when the application A calls the GDI (Graphics Device Interface) A, the GDI A generates print data according to a command from the application A to transmit print data to the spooler A.","The job account client application A monitors (hooks) the application A calling the GDI A to store a hook log relating to the print data.","The spooler A communicates with a peripheral via the network, and if the peripheral is ready, the print data is transmitted. In addition, when the client computer B functions as a printer server, the print data that the GDI A generated is transmitted to the spooler B.","The job account client application A transmits the merge log, periodically stored, to the job account server application .","In the client computer B, the application B, GDI B, and spooler B operate similarly to the application A, GDI A, and spooler A, respectively.","A job account client application B monitors the spooler B periodically. If there is a printing job spooled in the spooler B, the job account client application B acquires information on the printing job by using an API (Application Program Interface). Specifically, the job account client application B acquires a number of delivery sheets and a number of pages of the printing job. Then, the job account client application B transmits the merge log, periodically stored, to the job account server application .","If the O\/S comprises a function of sending a status change of the spooler B to another application, it is acceptable that the job account client application B does not monitor the spooler B periodically. The OS only has to send to the job account client application B that the printing job is spooled in the spooler B.","In addition, reference numerals A and B are equal to reference numeral  in , reference numerals A and B are equal to reference numeral  in , reference numerals A and B are equal to reference numeral  in , and reference numerals A and B are equal to reference numeral  in .","In the server computer , the job account server application  includes a user information management unit , a device information management unit , a log management unit , and a use state I\/O unit . Among these, the user information management unit  stores and manages user information in memory storage , not shown, in server computer .","Furthermore, the device information management unit  investigates whether a peripheral connected to the network has a device log retaining function, and stores information on a device, having the device log retaining function, and other device information in the memory storage  in the server computer  and manages them.","The user information includes a computer log-in name (a name inputted so that a user may log in the computer) and a network log-in name (a name inputted so that the user may log in the network system) of the user using a peripheral, and is information for specifying (identifying) the user using the peripheral. In addition, the device information includes printing speed, color information, a network address, etc. of the peripheral.","The log management unit  receives the merge log  from the job account client applications A and B, and also stores the merge log in the memory storage . In addition, the log management unit  requests a device log to a peripheral (for example, the printer ) having a function of retaining the device log , and acquires the device log through the use state I\/O unit . This processing may be periodically performed. Furthermore, it is also acceptable that, when the memory capacity of a device log storage unit (not shown) of a peripheral decreases, it is reported to the use state I\/O unit, and at that time, this processing is performed.","Furthermore, it is also acceptable that, when the memory capacity of a device log storage unit (not shown) of a peripheral decreases, it is reported to the use state I\/O unit, and at that time, this processing is performed.","The use state I\/O unit  acquires a use state including a device log from a peripheral having a device log retaining function. In addition, the use state I\/O unit  can also output a use state report (a report showing how many jobs were executed per user) to a printer and\/or a monitor of a peripheral.","A supervisor can make the use state I\/O unit  output a use state to acquire a use state of the peripheral. The use state I\/O unit  outputs various use states on the basis of user information, device information, and historical print information (job information formed by summarizing a plurality of final logs in ) which are stored in the memory storage . The supervisor designates an output form (output format) for them to the use state I\/O unit. In addition, this use state output is displayed in, for example, a display unit (not shown) of the server computer . Furthermore, output data relating to the use state output may be transmitted to the client computer A or B, and may be displayed in a display unit (not shown) of the client computer.","The use state output outputs a usage amount (a number of sheets of forms and an amount of toner used for outputs) and the used time of a peripheral per user. In addition, a use state is separately outputted per operation mode (function) of a peripheral such as color printing or duplex printing. Furthermore, a use state is outputted per size or paper type used.","Moreover, a usage charge per peripheral or per user is outputted when a usage rate of the peripheral is set in the device information. In addition, the use state output outputs a paper type, an operation mode, a peripheral name, a printing amount, and a usage charge per user when usage rates per operation mode, per paper size, and per paper type are set.","Furthermore, a supervisor can also set use limitation per function, per user, per user department, and per used device through the user information management unit  and device information management unit . There are items such as a usage rate, a number of pages, and a number of sheets of paper as the limited information that can be set. When a user exceeds the use limitation, the use state I\/O unit  outputs so by monitoring the historical print information and collating the historical print information with the set limitation (limitation information). It is no problem whether this is a display output on a screen or a communication output such as e-mail.","In addition, when a certain user's use exceeds the limitation, the log management unit  makes the client computer A or the peripheral itself refuse the user's use by monitoring the historical print information and collating the historical print information with the limitation set per user. Alternatively, it is also acceptable to sound an alarm by the display on a screen or by other communication means such as e-mail to the user.","The integrated server computer  and base server computer  can communicate with each other via a network such as a LAN or the Internet. In addition, it is no problem whether a number of the base server computers  that communicate with one integrated server computer is single or plural.","In the integrated server computer , the job account integration server application  includes a user information reference unit , a device information reference unit , a log reference unit , a use state reference unit , and a base server information I\/O unit .","Among these, the user information reference unit  can refer to user information, stored in the memory storage , with the base server information I\/O unit .","In addition, it is needless to say that it is no problem whether the memory storage  is installed in the integrated server computer  and is managed or is installed in another computer, which can communicate with the integrated server computer , and is managed.","Furthermore, the device information reference unit  can refer to device information, stored in the memory storage , with the base server information I\/O unit .","The log reference unit  can refer to historical print information, stored in the memory storage , with the base server information I\/O unit .","The use state reference unit  can refer to information on a device use state that is stored in the memory storage .","The base server information I\/O unit  acquires the user information, device information, and historical print information from the base server computer . In addition, the base server information I\/O unit  can also output a use state report of the base server computer  (a report showing how many jobs were executed per user per base server computer ) to a printer and\/or a monitor of a peripheral.","A supervisor can make the base server information I\/O unit  output a use state to acquire a use state of the peripheral. The base server information I\/O unit  outputs various use states on the basis of base server information, user information, device information, and historical print information that are stored in the memory storage .","The supervisor designates an output form (output format) for them to the base server information I\/O unit . In addition, this use state output is displayed in, for example, a display unit (not shown) of the integrated server computer . Furthermore, output data relating to the use state output may be transmitted to the client computer A, and may be displayed in a display unit (not shown) of the client computer.","The use state output outputs a usage amount (a number of sheets of forms and an amount of toner used for outputs) and the used time of a peripheral per user registered in each base server computer . Moreover, a use state is separately outputted per operation mode (function) of a peripheral such as color printing or duplex printing. In addition, a use state is outputted per size or paper type used.","Furthermore, a usage charge per peripheral or per user is outputted when a usage rate of the peripheral is set in the device information. Moreover, the use state output outputs a paper type, an operation mode, a peripheral name, a printing amount, and a usage charge per user when usage rates per operation mode, per paper size, and per paper type are set.",{"@attributes":{"id":"p-0107","num":"0106"},"figref":"FIG. 15","b":["101","101","101","1400"]},"First of all, at step S, when a user instructs printing in the application  in the client computer , the application  edits a document, an image, etc. and outputs a print request according to the user's instruction.","Next, at step S, the job account client application  acquires a hook log, a driver log, an API log, and a transmission unit log, and generates a merge log from them to transmit the merge log to a base server computer.","Subsequently, at step S, print data is output to a printer  through the spooler  on the basis of an instruction from the job account server application.","On the other hand, in the base server computer , when the log management unit  acquires the merge log at step S, the process proceeds to step S, and the determination processing of printing permission is performed.","Next, the process proceeds to step S when the base server computer  permits the printing at step S, and the base server computer  instructs the printing permission. If the base server computer  does not permit the printing, the process proceeds to step S, and the base server computer  transmits an instruction of printing suspension to the printer or client computer.","Subsequently, the processing at the time when the integrated server computer  acquires various types of information from the base server computer  will be explained by using .",{"@attributes":{"id":"p-0114","num":"0113"},"figref":"FIG. 16","b":["1410","1400"]},"On this screen, it is assumed that the integrated server computer  acquires the historical print information of the base server computer  at a fixed time every day. In addition, if the processing of acquiring all the historical print information is performed at the same time when a lot of base server computers  exist, a load to the integrated server computer  becomes large. Hence, it is possible to perform settings different from each other for respective base server computers .","On this screen, there is an interval input column  for designating an interval of full acquisition of historical print information, a time input column  for designating the execution time of processing of acquiring full or differential historical print information, a month input column  and a day input column  for designating date and time when the next full data acquisition will be performed, an OK button  for finally establishing information inputted to those columns, and a cancel button  for exiting from this diagram without finally establishing this information.","When it becomes the time inputted in the time input column , the integrated server computer  acquires historical print information by giving a request to the base server computer . At this time, the integrated server computer  usually acquires only the historical print information that is newly added to be increased, and acquires all the historical print information, which the base server computer  has, in each interval inputted in the interval input column . The former is called differential data update processing, and the latter is called full data acquisition processing.","In addition, in the full data acquisition processing, all the historical print information of an object base is acquired after all the historical print information that was acquired has been already deleted. On the other hand, in the differential data update processing, only the historical print information added in the base server computer after having been acquired last time is acquired. Hence, if a department, a user, a device, or the like is added in the base server computer after the full data acquisition processing, the additional one is determined as an unknown one in the difference data update processing.","Hence, the full data acquisition processing is performed so as to manage the added department, user, device, or the like. In addition, it is possible to avoid a mismatch of historical print information by performing the differential data update processing without fail after the full data acquisition processing.","A reason why a next execution date when the full data acquisition processing will be performed is specifiable in the month input column  and day input column  is to make it possible to distribute a load to the integrated server computer  by shifting a day when historical print information is acquired if a lot of base server computers  exist. In particular, in the full data acquisition processing, since there is a possibility that a large amount of historical print information is transferred, it is remarkably effective to make it possible to designate an execution date in each base server computer.",{"@attributes":{"id":"p-0121","num":"0120"},"figref":"FIG. 17","b":["1410","1400"]},"First of all, at step S, the integrated server computer  determines whether a supervisor instructed an update request of the differential data of the base server computer  in the job account integration server application .","When instructed, it is determined whether the full data acquisition processing was performed before at step S. If not instructed, differential historical print information is acquired from the base server computer  at step S. In addition, the processing at step S is called differential data update processing.","The process returns to step S when the full data acquisition was performed before.","When the update request of differential data was not instructed at step S, it is determined at step S whether it is the time that the periodic update processing is designated.","The periodic update processing means the update processing of historical print information performed at the time set on the schedule setting screen in . The process returns to step S if it is not the designated time. When it becomes the designated time, the integrated server computer  confirms set contents, and confirms whether the full data acquisition processing is performed or the differential data update processing is performed.","When performing the differential data update processing, the integrated server computer  acquires the differential historical print information from the base server computer  at step S. When performing the full data acquisition processing, the integrated server computer  acquires the full historical print information from the base server computer  at step S.",{"@attributes":{"id":"p-0128","num":"0127"},"figref":["FIG. 18","FIG. 17","FIG. 13"],"b":["1703","1400","1801","1802"]},"Next, an item concerning a user (owner's name) in the extracted log is examined at step S, it is determined whether user information has already been acquired by the integrated server computer. The process moves to step S when already registered. When not registered yet, it is determined that a user that the integrated server computer does not know is added, the process proceeds to step S, and the data of the item concerning the user (owner's name) in the extracted log is replaced with \u201cunknown (unknown user)\u201d.","Subsequently, an item concerning a device (device name) in the extracted log is examined at step S, it is determined whether device information has already been acquired by the integrated server computer. The process moves to step S when already registered. When not registered yet, it is determined that a device that the integrated server computer does not know is added, the process proceeds to step S, and the data of the item concerning the device (device name) in the extracted log is replaced with \u201cunknown (unknown device)\u201d.","The log is registered in the memory storage  as historical print information at step S. Then, it is determined at step S whether the processing at steps S to S was performed for all logs, and the processing is ended when performed.","Though the items concerning a user and a device are confirmed in the above-described example, it is also possible to perform similar processing on items concerning paper type, card information, etc. besides them.","Usually, the information on a user and a device is registered in the base server computer to be reported from the base server computer to the integrated server computer, or is registered in the integrated server computer. Then, these types of information are collated with historical print information, and a number of printed sheets per user, a number of printed sheets per department where a user belongs, and a number of printed sheets per device are aggregated.","As for whether the information on a user or a device is registered, if the user or device that is not included in the historical print information acquired in the above-described data acquisition processing is included in the historical print information, acquired in the differential update data processing, when the differential data update processing is performed after the full data acquisition processing, it is possible to determine this as \u201cunknown\u201d.","In addition, \u201cunknown\u201d may be one type in the integrated server computer, or it is also good to classify the \u201cunknown\u201d into \u201cunknown in base A\u201d every base.",{"@attributes":{"id":"p-0136","num":"0135"},"figref":"FIG. 19"},"First of all, reference numeral  is for setting whether an unknown user is displayed as \u201cunknown\u201d. Reference numeral  is for setting whether an unknown device is displayed as \u201cunknown\u201d.","In addition, reference numeral  is for setting whether the historical print information of an unknown user is made valid. Reference numeral  is for setting whether the historical print information of an unknown device is made valid;","Besides these, it is also possible to set whether the historical print information of an unknown user and the like that is added in the above-described processing is included in the aggregation work that a supervisor performs.","Furthermore, it is also possible to grip a flow of job acquisition from every base by aggregating what is made unknown in each base.",{"@attributes":{"id":"p-0141","num":"0140"},"figref":"FIG. 20"},"First of all, one log that agrees with the aggregation condition is extracted at step S. Then, it is determined at step S whether the extracted log is a log whose user is unknown.","When the log is a log whose user is not unknown, the process proceeds to step S, and aggregate processing is performed so as to reflect the contents of the log concerned in aggregation result.","In the case of the log whose user is unknown, it is determined at step S on the basis of the contents of the setting in  whether \u201cmake unknown user's log valid\u201d is designated. If not designated, the process proceeds to step S so as not to reflect the log concerned in the aggregation result. If \u201cmake unknown user's log valid\u201d is designated, the process proceeds to step S so as to perform aggregation by including the log concerned.","Finally, it is confirmed at step S whether processing has been performed for all logs, and the above-described steps are repeated until processing is fully performed.","Respective computers execute processing shown in flow charts shown in respective charts (, , , , etc.) in this embodiment, and, respective units shown in  on the basis of programs. Then, also in the case that an information group including a program is supplied by a storage medium such as a CD-ROM, a flash memory, or an FD, or from an external storage medium via a network to the client computer, the present invention can be applied.","As mentioned above, it is needless to say that an object of the present invention is achieved even if a computer (or, a CPU or an MPU) of a system or an apparatus reads and executes a program code that is stored in a storage medium by supplying a storage medium recording a program code of software, which achieves a function of the above-described embodiment, to a system or an apparatus, or by downloading the program code from an external server (not shown).","In this case, the program code itself of the job account server or job account client program, or the like that is read from the storage medium achieves a new function of the present invention, and the storage medium that stores the program code constitutes the present invention. As a storage medium for supplying the program code, it is possible to use, for example, a floppy disk, a hard disk, an optical disk, a magneto-optical disk, a DVD, a CD-ROM, a magnetic tape, a nonvolatile memory card, ROM, EEPROM, and the like.","In addition, it is needless to say that it includes the case that not only a function of the above-described embodiment is achieved by a computer executing the read program code, but also a function of the above-described embodiment is achieved by an OS (operating system) or the like running on a computer and performing part or all of actual processing on the basis of an instruction of the program code. Moreover, it is needless to say that it includes the case that a CPU or the like that is provided in a feature expansion board or a feature expansion unit performs part or all of actual processing on the basis of an instruction of the program code after a program code, which is transmitted from an external predetermined server apparatus (not shown) via a network or is read from a storage medium, is written in memory provided in a feature expansion board inserted into the computer or a feature expansion unit connected to the computer, and a function of the above-described embodiment is achieved.","According to the present invention, it is possible to collect the acquired job information efficiently and without increasing a load in a wide range or plural bases by controlling whether all job information, managed by the management apparatus concerned, is acquired from the management apparatus managing information on the data processing, performed by a device, as job information, or, acquiring additional job information from among the job information managed by the management apparatus concerned. In addition, since it is possible to acquire all job information managed by the management apparatus by having acquired the differential job information even if unknown information is included, it is possible to correct a mismatch when aggregation is performed on the basis of the job information.","Furthermore, the above-described differential acquisition means can collect job information collected in a wide range or plural bases efficiently and without increasing a load by acquiring additional job information after job information was acquired last time.","Moreover, it is possible to set the time of each management apparatus acquiring job information and to prevent processing loads and communication loads from concentrating temporarily because of the concentration of job information acquisition, by making a display unit display a screen for setting at least one of the time of acquiring all or additional job information, an interval of acquiring all job information, and the time of acquiring all job information.","According to the present invention, it is possible to flexibly manage job information without discarding information where a mismatch occurs by acquiring job information, managed by a management apparatus, from the concerned management apparatus managing information on the data processing, performed by a device, as job information, determining whether a value of an item that the acquired job information shows is new, and modifying a value of the above-described item to a value showing uncertainty when it is determined that it is new.","In addition, it is possible to flexibly correspond to information where a mismatch occurs without acquiring all the past information every time and to clarify a user, a device, or the like, which is newly added, as an unknown one, by determining that a value of an item that the job information that is acquired shows is new when the value of the item that the job information that is acquired shows when additional job information is acquired from among job information managed by a management apparatus is not included in values of the item that the job information that is acquired shows when all job information managed by the management apparatus is acquired.","Furthermore, it is possible to flexibly correspond to information where a mismatch occurs and to perform aggregation corresponding to a user's intention, by making the user set whether job information where a value of an item shows uncertainty is used when aggregation based on the job information that is managed is performed.","It is possible to flexibly correspond to information where a mismatch occurs and to perform information management corresponding to user's intention, by making the user set whether information showing uncertainty is displayed when aggregation based on the job information that is managed is performed and aggregation result is displayed."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4","b":"121"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 13","b":"123"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 15","b":["101","101","101","1400"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 16","b":["1410","1400"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 17","b":["1410","1400"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 18","FIG. 17"],"b":"1703"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 20"}]},"DETDESC":[{},{}]}
