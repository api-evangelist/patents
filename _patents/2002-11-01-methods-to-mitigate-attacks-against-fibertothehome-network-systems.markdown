---
title: Methods to mitigate attacks against fiber-to-the-home network systems
abstract: The present invention provides methods to mitigate the problems associated with MAC address spoofing and denial of service attacks in an FTTH network system. The MAC address spoofing attack may occur when a computer hacker configures his computer to change the MAC address of a data signal to deceive the receiver of the signal's source address. The denial of service may occur when a computer hacker floods a file server with data packets. The present invention mitigates these attacks by modifying the software of certain components of the FTTH network system to enable the components to insert virtual MAC addresses, tags and codes into the data packets that identify a component of the communication related to the address of the source computer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08347075&OS=08347075&RS=08347075
owner: Verizon Laboratories Inc.
number: 08347075
owner_city: Waltham
owner_country: US
publication_date: 20021101
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["REFERENCE TO EARLIER FILED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["This application claims the benefit of U.S. Provisional Application No. 60\/332,904, filed Nov. 14, 2001, which is hereby incorporated by reference.","The present invention was not made with government support and the government has no rights in this invention.","1. Field of the Invention","The present invention relates generally to the field of fiber-to-the-home network systems and, more specifically, to methods to mitigate the media access control address spoofing attacks and denial of service attacks against fiber-to-the-home network systems.","2. Description of the Related Art","Fiber to the Home (FTTH) is a network system that provides high-speed information services from a remote supplier of data (e.g., a file server) to a subscriber's home using optical signals transmitted through fiber optic cable. The data may comprise voice, video or data. Information is transmitted in the form of an optical signal, thereby taking advantage of the benefits of using fiber optic technology. It is well known in the art that light transmitted in a glass fiber can carry more information faster, with smaller transmission losses, and over longer distances than electrical signals can carry in a copper or coaxial medium.","One example of a system that used FTTH technology is the Deep Fiber FTH-1000 system proposed by Marconi Communications. See Ethridge and Adcox, \u201cFiber to the Home Data Connectivity,\u201d Marconi Access Systems North America (October 2000). The system architecture of the FTH-1000 system is depicted in FIG. 1 of Marconi, which shows the interconnections between various sub-components of a Point of Presence (PoP) (i.e., the central office of a telephone company (Telco)), a plurality of passive optical splitters (POS) situated outside the Telco central office and a plurality of Residential Locations. Through each POS, a single fiber emanating from the PoP serves four subscribers' homes. Each home includes an optical-to-electrical converter (OEC), which converts optical signals from the POS to electrical signals, and provides those signals to appropriate physical terminations for voice, video and Ethernet data. In this manner, the OEC may support connections for Plain Old Telephone Service (POTS), Cable TV, direct broadcast satellite (DBS) and a local area network (LAN) of computers.","Conventionally, FTTH systems use an industry protocol called Point-to-Point Protocol over Ethernet (PPPoE) to provide the subscriber's data services. This protocol is described in RFC 2516, \u201cA Method For Transmitting PPP Over Ethernet (PPPoE),\u201d \u00a9 The Internet Society (1999). PPPoE allows subscribers that share a common facility to use a common Digital Subscriber Line (DSL), cable modem, or wireless connection to the Internet. PPPoE has the advantage that neither the Telco nor the Internet Service Provider (ISP) needs to provide any special support. Unlike dial-up connections, DSL and cable modem connections are \u201calways on.\u201d Since a number of different subscribers are sharing the same physical connection to the file server, the protocol is necessary to keep track of which subscriber the data is provided to, and which subscriber is billed for the use of such data.","PPPoE provides the ability to connect a network of subscriber host computers (Host) over a bridge to one of several file servers. As used herein, a bridge is a device that connects and passes packets between two network segments that generally use the same communications protocol. A bridge also allows a larger network to be segmented into smaller, more efficient networks. The bridge monitors the information traffic on both sides of a network so that it can pass data packets of information to the correct location, listens to the network, and automatically figures out the address of each computer on both sides of the bridge. A file server, as described in more detail below, is generally a very fast computer that stores the data and provides the data, upon request by a subscriber, to a Host.","The PPPoE has two distinct stages: a Discovery stage and a PPP Session stage. A Host must first perform discovery to identify the Ethernet Media Access Control (MAC) address of the file server and establish a PPPoE Session identification number to initiate the PPPoE Session stage. Because there may be more than one file server with which the Host can communicate, the Discovery stage allows the Host to discover all the available file servers and to select one. When the Discovery stage is successfully completed, both the Host and the selected file server have the information necessary to establish their point-to-point session.","The Discovery Stage, in more detail, requires that four steps be completed. Step one: the Host broadcasts a PPPoE Active Discovery Initiation (PADI) packet. Each PADI packet contains the Host's MAC address, and one or more tags indicating the service that the Host is requesting. Step two: one or more file servers send PPPoE Active Discovery Offer (PADO) packets. Step three: the Host reviews the PADO packets received from the file servers, chooses one and sends a unicast PPPoE Active Discovery Request (PADR) packet to the selected file server. Step four: the selected file server generates a unique Session Identification Number (Session ID) and sends a PPPoE Active Discovery Session confirmation (PADS) packet to the Host. After completing these four steps, both the Host and the file server know the Session ID and each other's MAC address, which together uniquely define the PPPoE session.","After the file server sends the PADS packet, it may proceed to the PPP Session stage. In addition, after the Host receives the PADS packet, it may proceed to the PPP Session stage. Once the PPPoE Session begins, PPP data is sent as in any other PPP protocol. The Session ID may not change during the PPPoE Session, and must remain the identification number assigned in the Discovery stage.","Despite its general suitability for some applications, a conventional FTTH system has several drawbacks, most notably its vulnerability to certain forms of attack. For example, in a MAC address spoofing attack, a computer hacker may configure his computer to send PADI packets with spoofed (false) MAC addresses to deceive a receiver of the PADI packet's source. In addition, a denial of service attack may occur when a computer hacker sends an abnormally large number of these PADI packets having the spoofed MAC addresses to a targeted file server such as for example, when the number of PADI packets received at the file server is above a threshold level set by the file server's software. The abnormally large number of PADI packets originating from a source computer and being transmitted to a device (e.g., a file server) in the communication system is known by those skilled in the art as \u201cflooding.\u201d Flooding is detected based on the settings in the software of the device that is receiving the data. For example, if a file server normally receives 500 PADI packet requests during a 1-hour period, the software may be configured to actuate an alarm when more than 500 PADI packet requests are received. In response to the flooding, the file server allocates all its available memory to process the PADI packets. After all the available memory in the file server has been allocated, no additional PADI packets can be processed. Consequently, existing subscribers are unable to receive ongoing data services and new subscribers are thereafter unable to log on. Due to the cessation of data transfer between the file server and Hosts when flooding occurs, an alarm is actuated at the central office of the Telco to inform the network administrator of the flooding condition and an investigation is initiated by Telco personnel to determine the source of the flooding. These investigations, however, are not only time consuming but they are also difficult because the PADI packets contain false identifying information such as the spoofed MAC addresses and tags that do not associate the PADI packets with the source computer.","There is a need, therefore, for an FTTH system that takes an entirely fresh approach, and provides an adequate measure of protection against such MAC spoofing attacks, denial of service attacks and the like.","An object of the present invention is to provide a method in a communication system to mitigate against a spoofing attack of a source computer's address. The method includes the steps of maintaining a plurality of virtual addresses in a component of the communication system associated with the source computer, and in an information packet sent by the source computer, replacing an address of the information packet with a selected one of the plurality of virtual addresses.","Another object of the present invention is to provide a method in a communication system to mitigate denial of service attacks by a source computer. The method includes the steps of inserting an identifier into information packets sent from a source computer, detecting a number above a threshold level of information packets containing the inserted identifier, removing the identifier from the information packets, and identifying a component of the communication system associated with the source computer based on the identifier obtained from the removing step.","A further object of the present invention is to provide a method in a communication system to mitigate denial of service attack by a source computer. The method includes the steps of inserting an identifier and code into information packets sent from a source computer, detecting a number above a threshold level of information packets containing the inserted identifier and code, removing the identifier and code from the information packets, and identifying a component of the communication system associated with the source computer based on the identifier or code obtained from the removing step.","The overall architecture of the network system of the present invention is shown in . In general, file servers (sometimes called Access Concentrators) , , located at a Central Office  exchange optical signals containing data with residential telephone service subscribers via a network of optical fiber links . This network includes common networking hardware, known in the art, that ensures efficient delivery of the optical signals to the subscriber's premises. Each file server , , may comprise generally a high speed computer, a memory and a network interface card , , (NIC), and provides the necessary data services to the subscribers' homes , ,  and . Computers residing in a subscriber's home, such as for example Host computer  located in home , also include NICs, typically situated in an expansion slot, such as a PCMCIA expansion slot. The network operating system, which handles all Telco communications including the immediate communications with a subscriber, resides on file servers , , ",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2","b":["7","7","8","9","7","7"]},"Each NIC  is assigned a MAC address  by its manufacturer. MAC addresses include a source address that is globally unique and are assigned in blocks to the NIC  manufacturers. This scheme ensures that no two NICs  will ever have the same source address. MAC addresses are 48 bits, expressed as 12 hexadecimal digits and normally hyphenated by octets (e.g., 12:34:56:78:9 A:BC). The first 6 digits of the MAC address identify the vendor of the NIC  while the last 6 digits identify the NIC's  serial number. For example, the first 6 digits 08:00:20 correspond to a NIC  manufactured by Sun Microsystems. While MAC addresses were designed to uniquely identify a particular NIC , it is well known in the art that these MAC addresses can be easily changed by simply actuating a command inside the computer to change the MAC address, thereby, in essence, lying about the source of a data packet.","Conventionally, a PADI packet will also include one or more tags along with the MAC address. As used herein, a tag is identifying information that is inserted into a data packet to provide additional information about the data, such as for example, its source or destination address. A tag may be inserted into a data packet by one or more components of the FTTH system such as for example, by a file server , by a Host , or by a hacker's computer  (). There are various types of tags that can be inserted into a data packet, such as the tags listed in Appendix A of RFC 2516, \u201cA Method For Transmitting PPP Over Ethernet (PPPoE).\u201d","For example:\n\n","Referring again to , a Remote Hut  is located between the Central Office  and a subscriber's home . The Remote Hut  may include a router  and switch , which control the routing and flow of data through the network. The router  directs where data travels, that is, the path traveled by the data through the network. The switch  controls when data travels, that is, the timing and rate of the flow of data. The router  selects the best path for the data to travel, based on the data's source and destination address. The router  can also direct traffic to prevent the head-on collisions of data, which occur when data from two separate computers converge simultaneously at the same node in a network. The Remote Hut  may also include a splitter wavelength division multiplexing frame device  (SWF), which combines voice and data signals having a certain wavelength with video signals having differing wavelengths. The Remote Hut  may further include a central connection point for cables from the file servers and Hosts, and may include a repeater, which amplifies the received signals.","A POS  is located outside the Remote Hut , most likely close to subscribers' homes , ,  such as for example, on a local telephone pole. In the system of , a single primary fiber entering the POS  exits as four separate secondary fibers, each of which provides data to a subscriber's home. The POS  is referred to as a \u201cpassive\u201d device because the optical data entering and exiting the device is neither increased nor decreased as it goes through the POS . It will be readily understood by those skilled in the art that the number of secondary lines exiting a POS may vary from one residential community to another.","Referring again to , optical signals enter the subscriber's home  and OEC  located therein. The OEC  converts the fiber optic signal to an electrical signal that is transmitted through electrical wiring ,  (e.g. twisted pair electrical wiring) in a subscriber's home , , ,  to the subscriber's home telephones , , cable television  and Host  for processing. It will be readily understood by those skilled in the art that the device coupling the source computer to the communication system may also comprise an optical-to-optical converter or an optical-to-wireless converter for radio frequency implementations.","A first embodiment of the present invention solves problems related to a MAC address spoofing attack.  is a simplified diagram of two homes ,  and their connections to various components of the FTTH system. For example, home , which is occupied by a subscriber of services, and home , which is occupied by a computer hacker, each includes a Host and an OEC that are connected outside the homes to a common POS , and from there to a NIC  of a file server  (not shown in ). A MAC address spoofing attack occurs when a computer hacker configures his computer  to send information packets that have spoofed MAC addresses. As used herein, a \u201cspoofed\u201d MAC address is a false MAC address that deceives a receiver of the information packet as to the information packet's correct source while an \u201cactual\u201d MAC address of an information packet identifies the correct source of the information packet. For example, a computer hacker may configure his computer  to send thousands of PADI packets from his computer, with each PADI packet containing a spoofed MAC address. By doing so, the receiver (e.g., a file server ) of these PADI packets will not be able to determine the PADI packet's correct source address.","In accordance with this embodiment of the present invention, all OECs maintain in their software a table of virtual MAC addresses that are unique, known only by OECs and file servers, specified by the OEC's software, and used by the OECs to replace all the MAC addresses (e.g., spoofed or actual addresses) sent from the Hosts. In particular, the virtual MAC addresses will replace the spoofed MAC addresses generated and sent from the computer hacker's terminal . With this scheme the OEC  will override each MAC address and replace it with a virtual MAC address, regardless of how the computer hacker configures his computer  to change the MAC address of each data signal. Thereafter, the data signal with the virtual MAC address will travel throughout the FTTH system, to the file server  and eventually back to OEC . At that point, the OEC  will effectively translate the virtual MAC address back to the spoofed MAC address generated by the computer hacker. This embodiment improves the management functionality of the FTTH system because the Telco can determine the OECs that the data signals traveled through. Since the OECs are located in a Host's home , , , the source address of the data signal can be readily determined. In addition, as described below, if a denial of service attack occurs, the Telco will be able to quickly locate the OEC and disconnect the computer hacker from the FTTH system.","A computer hacker can configure his computer  to flood a file server  with PADI packets containing spoofed MAC addresses at the Telco's central office , thereby denying continuing service to existing users and preventing new users from establishing a PPPoE session. A second embodiment of the present invention provides a method to mitigate a denial of service attacks to a Host when a computer hacker floods the file server  with PADI packets containing spoofed MAC addresses. In this description of the second embodiment of the present invention, we assume that the method described in the first embodiment to mitigate spoofing attacks of a MAC address of a source computer is not being used, thus the spoofed MAC addresses deceive the receiver (e.g., file server ) of the information packet as to the correct source of the information packet.","In accordance with the second embodiment of the present invention, the above-described problem is solved by modifying the software associated with the OECs to cause all the OECs in the FTTH system to insert tags in each PADI packet passing through an OEC, and by configuring the software associated with the file servers , , to cause them to actuate an alarm when flooding is detected. Flooding may be detected by having the software of the file servers , , set a threshold level for the number of information packets normally received by the file servers , , at a particular time during the day. If the threshold level is exceeded, the alarm is sounded, the PADI packets containing the same insert tag are identified, and the tags are removed. These tags will then be used in a follow-up investigation by Telco personnel to determine the correct source of the PADI packets. The preferred tag for this embodiment is an ID tag that provides the serial number of an OEC such as for example, the hacker's OEC . As shown in , the OECs are located inside homes , ,  and allow the Telco to quickly determine and disconnect the source of the flooding from the FTTH system. Serial numbers of other components of the FTTH system may be used, such as for example, the serial number of a router  (not shown in ). However, since the router  is located in the Remote Hut  and not inside the hacker's home  like the OEC , it is more difficult to associate the router  with a hacker's computer .","An example will now be provided to further understand the aspects of this second embodiment of the present invention. A computer hacker sitting at his computer  may configure his computer  to send out  PADI packets containing spoofed MAC addresses to file server . The file server , under normal circumstances, would only receive 500 PADI packets. For purposes of this example, it is assumed that the additional  PADI packets sent to the file server  will flood the file server  and may consequently, deny service to existing and new users. The computer hacker configured his computer  to send spoofed MAC addresses with each of the 750 PADI packets. Therefore, a receiver of the information packets containing the spoofed MAC addresses will not know the correct source of the information packet. In the second embodiment of the present invention, as the PADI packets pass through the OEC , the OEC  automatically inserts a tag in the PADI packet, which, for purposes of this example, will identify the serial number of OEC . Although each one of the 750 PADI packets has a different MAC address, each will contain the same tag identifying the serial number of OEC  inserted into it. After flooding is detected, an alarm will be actuated, the file server  will remove the tag from the PADI packet, and display the serial number of the OEC , which will be used by Telco in their follow-up investigation of the flooding incident. This embodiment has the added benefit that mitigating these denial of service attacks will improve the management functionality of the entire FTTH system by removing the computer hacker from the network.","A third embodiment of the present invention provides another method to mitigate the problem associated with the denial of service attack when a computer hacker floods a file server  with PADI packets containing spoofed MAC addresses. In the description of the third embodiment of the present invention, we assume, as we did in the second embodiment, that the method described in the first embodiment to mitigate spoofing attacks of a MAC address of a source computer is not being used herein, thus the spoofed MAC addresses deceive the receiver (e.g., file server ) of the information packet as to the correct source of the information packet.","The method of this embodiment is similar to the method of the second embodiment, in that it requires that the software for the OEC  and file server  be modified to have the OEC  insert in each PADI packet a certain tag, have the file server  remove the tag from the PADI packet when flooding occurs, and have the tag's information outputted to Telco personnel for further investigation. However, this third embodiment provides an additional level of security to the FTTH system by denial of service attacks by including with a tag described in the second embodiment a cryptographic message authentication code that is unique to OECs and file servers and may include, for example, a symmetrical key or pair of public keys. By so doing, even if a computer hacker can get access to the OEC and change a tag's information, he will not be able to change the cryptographic message. Therefore, if flooding occurs, the Telco personnel will be able to identify the OEC by the cryptographic message unique to the OEC and will be able to disconnect the computer hacker from the FTTH system.","It will be readily understood by those skilled in the art that the method of mitigating MAC address spoofing attacks as described in the first embodiment of the present invention can be used in combination with the methods of mitigating denial of service attacks as described in the second and third embodiments of the present invention to improve the management functionality of the entire FTTH system by identifying a source computer that is flooding file servers , , and , and subsequently removing the computer  from the network.","More generally, the invention has been particularly shown and described with respect to preferred embodiments thereof, it will be understood by those skilled in the art that changes in form and details may be made therein without departing from the scope and spirit of the invention."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
