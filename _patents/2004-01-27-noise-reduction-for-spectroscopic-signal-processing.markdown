---
title: Noise reduction for spectroscopic signal processing
abstract: A windowed noise reduction technique is presented that allows a noise-reduced spectrum of satisfactory accuracy to be recovered from original noisy spectroscopic data, while acquiring a significantly reduced number of transient acquisitions. The signal-averaged, decimated signal is written as a sum of a noisefree component and a noise component, and a vector space that contains a noisefree subspace and a noise subspace is created using these decimated signals. A correlation matrix is constructed in this vector space, and diagonalized to yield the singular values. The appearance of a clear gap between the noisefree singular values and the noise singular values, in a singular value graph, and the stability of the gap, supplies the criteria for determining that a sufficient number of iterations has been performed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07429860&OS=07429860&RS=07429860
owner: University of Southern California
number: 07429860
owner_city: Los Angeles
owner_country: US
publication_date: 20040127
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","GOVERNMENT'S INTEREST IN APPLICATION","BACKGROUND OF THE INVENTION","SUMMARY","DETAILED DESCRIPTION"],"p":["This application claims priority to U.S. provisional application, Ser. No. 60\/443,086, filed on Jan. 28, 2003, entitled \u201cProducing Windowed Noise Reduced Signals for Fourier and High Resolution Signal Processing for Spectroscopies such as NMR, ICR, etc.,\u201d and U.S. provisional application, Ser. No. 60\/445,671, filed on Feb. 7, 2003, entitled \u201cProducing Windowed Noise Reduced Signals for Fourier and High Resolution Signal Processing for Spectroscopies such as NMR, ICR, etc.\u201d The entire content of both applications is incorporated herein by reference.","This invention was made with government support under Grant No. PHY-0071742, awarded by the National Science Foundation of the United States Government. The government has certain rights in the invention.","1. Field of Invention","The present invention relates to signal processing in Nuclear Magnetic Resonance (NMR) and other spectroscopic techniques.","2. Background","In NMR spectroscopy, as well as in other spectroscopic methods, noise reduction can be a serious problem. In most experimental NMR studies, excessive noise can be present in the measured time domain signal, which decays exponentially and is thus called an FID (\u201cfree induction decay\u201d) signal. Because of the noise, the Fourier transformed spectrum may not allow the underlying spectrum to be reliably differentiated or extracted from the noise.","A number of methods are known in the art for reducing noise in NMR studies. Signal averaging over many transients or scans is widely known. In signal averaging, however, the signal grows relatively slowly over time. Also, other factors such as sample concentration, magnetic field strength, and NMR machine design frequently affect the intensity of the NMR signal, which is inherently rather weak. Because of these factors, the needed number of transients may often be very high. When the fast Fourier transform method is used to derive the spectrum from the measured data, the requisite number of transients may be too high for certain experiments to be practically feasible.","Many attempts have been made to address this problem by developing data processing methods that can extract signal information from noisy data using available knowledge regarding the model for the underlying signal. One known method is harmonic inversion, which is a parameter fitting model that extracts the desired spectral parameters by fitting the data to a sum of damped harmonics. The knowledge used here is that a linear combination of complex decaying exponentials can be assumed to be a good model for an NMR FID signal. The equations that relate the measured FID signal to such a model directly yield, when solved, spectral parameters such as the position, width, and intensity of each nuclear resonance, so that a spectrum can be reconstructed from these parameters.","The harmonic inversion method achieves a higher spectral resolution, for a given signal length, compared to the Fourier transform method. The solutions to the harmonic inversion equations, however, can be extremely sensitive to small noise perturbations. Various regularization techniques have been proposed. With no noise or with very little noise, the harmonic inversion method usually provides acceptable results when used with these regularization schemes. At typical noise levels, however, the harmonic inversion method together with the regularization schemes may yield inconsistent and unreliable results, producing spectra with false or missing spectral lines.","For these reasons, there is a need for a method and system that allows reliable spectra to be derived from spectroscopic data, without requiring an excessive number of transient acquisitions.","A method and system is presented that is based on harmonic inversion, and that allows for a reliable spectrum to be obtained using a greatly reduced number of transients or signal measurements. By providing criteria for recognizing when to stop transient collection, the machine time that is required in order to measure a spectrum to a requisite degree of accuracy, and to implement harmonic inversion reliably, can be significantly reduced.","In one embodiment, the NMR response signal from a sample is measured, and the measured signal is averaged over a number of measurements. The averaged signal is written as a sum of a noisefree component and a noise component, and is used to create a vector space that has a noisefree subspace and a noise subspace. A correlation matrix is created within the vector space. The correlation matrix is diagonalized, to yield the singular values and their corresponding eigenvectors. The singular values, which include noisefree singular values associated with the noisefree subspace, and noise singular values associated with the noise subspace, are plotted in a graph.","The appearance and subsequent stabilization of a clear gap between a noisefree singular value and a noise singular value are criteria that establish that a sufficient number of transients have been acquired. When the gap stabilizes, the measured signal is projected onto the noisefree subspace to produce a noise-reduced signal, which is then frequency converted by harmonic inversion or by other signal processing methods (such as Fourier transform), to generate a noise-reduced spectrum.","Instead of monitoring the signal-to-ratio of the spectrum as more measurements are made and averaged over, as done in other methods known in the art, in the present method and system, the criterion for stopping the acquisition of transients is the appearance of a stable gap in the singular value graph, and the appearance of a stable spectrum thereafter.","The method and system described above reduces the number of transients required to obtain satisfactory NMR spectra by a factor of about 10 to about 100, compared to a method in which signal averaging is performed using Fourier transforms only.","A method and system is presented that links the termination of transient acquisitions to the appearance of a gap in a singular value plot made from previously measured data, rather than to the signal-to-noise ratio of the resulting spectrum.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["100","100","100"]},"In overview, the NMR apparatus  includes a data acquisition system  that measures the response signals emitted by the sample in response to the RF excitation pulses that have been applied thereto, and a data processing system  that processes the measured signals to generate the desired characteristic spectra for the constituents of the sample. The signal averaging method, well known in the art, is used. The signals are averaged over a large number of measurements or scans (called \u201ctransients\u201d in NMR spectroscopy) in order to lower the noise content compared to a single signal measurement or transient. The apparatus  further includes a control system  that controls the activation of the data acquisition and processing systems  and . The control system  determines the number of measurements that should be made in order to generate a spectrum having desired noise characteristics, as described below.","The data acquisition system , which acquires the NMR response signals, includes components well known in the art. For example, the data acquisition system may include a measurement subsystem for measuring NMR response signals, and a signal averaging subsystem for averaging the measured signals over many measurements to lower the noise content in the signals. In signal averaging, the signal grows relative to noise by a factor \u221a{square root over (N)}, where Nrepresents the number of measured transients. The measurement subsystem typically includes an NMR transmitter for generating RF excitation pulses and delivering the pulses onto an NMR sample, and an NMR receiver for detecting the response signals emitted by the sample in response to such an excitation. NMR transmitters and receivers are well known in the art and commercially available. The signal averaging subsystem is also a standard component in NMR signal processing, and includes processing subsystems for receiving and storing an acquired transient after each measurement, and for averaging over all of the acquired and stored transients.","The signal averaging subsystem averages the corresponding sample points over all the transients. In this way, an averaged signal (sometimes called \u201censemble averaged signal\u201d in the art) is generated in which signal-to-noise correlations are very small, and which have a lower noise content than any single signal measurement or transient. The averaged signal may be represented as a discretized set of N sampled data points c(n=0, . . . , N\u22121).","In one embodiment, the data processing system  implements a signal processing scheme which is based on harmonic inversion, and which allows for spectra of satisfactory quality to be obtained while averaging over a greatly reduced number of transients. By \u201csatisfactory\u201d quality, it is meant that the error margin is within the standards accepted in the industry, and that there are no false or missing spectral lines. In overview, the data processing system  includes a noise reduction preprocessor  for transforming the averaged signal into a noise-reduced signal, and a spectral estimator  for converting the noise-reduced signal into a frequency domain to generate the desired spectrum. Preferably, the data processing system  also includes a windowing capability which breaks the Fourier transformed signal into \u201cwindows,\u201d i.e. into regions of smaller bandwidth.","A windowing program in the data processing system  applies a windowing filter to the averaged signal that is outputted by the data acquisition system . In one embodiment, the averaged signal is fast Fourier transformed, and the fast Fourier transformed frequency domain signal is broken into windows of 200 to 500 Fourier grid points. The window size that is most commonly used is about 300 Fourier grid points. While the method and system of the present invention can be implemented without the windowing step, windowing provides many advantages for the noise reduction portion of the signal processing described in this section. Without windowing, the singular value graphs (discussed below) become too cluttered with signal and noise singular value points to be easily analyzed. Also, because certain windows are much simpler to process than others, if the windowing step is omitted all features become unnecessarily tied to the features most affected by noise. Finally, without windowing the dimensions of a matrix that must be generated and diagonalized in order to solve the harmonic inversion equations may become too large, and as a consequence the needed diagonalization routine may become too time consuming.","When harmonic inversion is used, windowing creates a smaller signal of length Nwhich is much smaller than N, and which is valid only within the window. Resolution is not affected by this signal length reduction. The length Nof the smaller signal determines, in turn, the dimensions of the systems of equations to be solved in harmonic inversion, the dimensions being given by N\/2. Since these equations have a rank less than their dimension N\/2, they are ill-conditioned and unstable, and the results are very sensitive to small perturbations.","The edges of the windows are at the Fourier grid points. Ideally, their placement would surround the regions of the signal, and begin and end in regions of pure noise. In less than ideal situations a systematic windowing of the spectrum can be designed for all regions. If, because of spectral density reasons, peaks unavoidably appear at window edges where window induced distortions will occur, an additional window should be chosen so that the edge of the prior window falls interior to the new window.","The windowing filter is a \u201cdecimation\u201d window, which when applied to the averaged signal c(n=0, . . . , N\u22121) produces a decimated, band-limited signal of length Nfrom the measured averaged signal cof length N. The decimated signal will be referred to in this section as c(n=0, . . . , N\u22121). The signal length Nof the decimated signal is substantially less than the signal length N of the measured averaged signal. The decimated signal cis inputted into the noise reduction preprocessor described below. In a typical Fourier spectrum of a signal made of a given number of transients, all intensities outside the window of NFourier grid points are set to zero. The window spectrum is then shifted symmetrically about zero frequency and inverse Fourier transformed, to produce a decimated time signal. The original bandwidth, given by 2\u03c0\/\u03c4 where \u03c4 is the sampling period, is now reduced by a factor of N\/N. The effective sampling period of the decimated signal is given by N\/N\u2261\u03c4, which is substantially greater than the original sampling period \u03c4.","The noise reduction pre-processor  takes the decimated signal and creates a low noise signal therefrom. In one embodiment, the noise reduction pre-processor  includes: 1) a matrix generator that constructs a correlation matrix from the decimated signal, 2) a matrix diagonalizer that diagonalizes the correlation matrix to extract the singular values (i.e. the real, non-negative eigenvalues) and the corresponding eigenvectors, and 3) a signal projector that projects the decimated signal onto the noisefree subspace to generate noise-reduced signals.","In one embodiment, the matrix generator generates the correlation matrix within an M-dimensional vector space defined by the decimated signals c(n=0, . . . , N\u22121). Specifically, from the Ndecimated time signal samples c, a number N\u2212M+1 of linearly independent, M-dimensional measured signal vectors {right arrow over (c)}=(c,c, . . . ,c1) are created, to define an M-dimensional vector space. The measured signal vectors are then written as a sum of a noiseless signal vector {right arrow over (x)}and a random noise vector {right arrow over (\u03b5)}. In this way, the vector space defined by these M-dimensional measured signal vectors includes a noisefree signal subspace, and a random noise subspace.","It is known that the noisefree NMR, EPR etc. FID signal of chemical samples are made of K complex harmonics. A basic assumption of the harmonic inversion method is that the noiseless signal elements xare created from a sum of K damped harmonics, i.e. that the spectrum is the sum of K complex Lorentzians. K is the rank of the observed spectral peaks. In harmonic inversion, the noisefree signal vectors are written as a finite sum of damped harmonics. The noise vectors cannot be similarly fitted.","Specifically, the noiseless signal vectors are written vectorially, and sample by sample, as:",{"@attributes":{"id":"p-0036","num":"0035"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mover":{"mi":"x","mo":"->"},"mi":"n"},"mo":"=","mrow":{"mrow":[{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"K"},"mo":"\u2062","mrow":{"msub":[{"mi":["d","k"]},{"mover":{"mi":"s","mo":"->"},"mi":"k"},{"mi":["x","n"]}],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"msubsup":{"mi":["z","k","n"]},"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":"and"}},{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"K"},"mo":"\u2062","mrow":{"msub":{"mi":["d","k"]},"mo":"\u2062","msubsup":{"mi":["z","k","n"]}}}],"mo":"="}}},{"mrow":{"mo":["(",")"],"mn":"2"}}]}}}}},"where ({right arrow over (S)})=(1,z, . . . , z), z=exp(\u2212i\u03c9\u03c4).","In equation (2) above, drepresents the weight of the K-th harmonic, and \u03c9represents the complex frequency of the k-th harmonic.","In equation (2), Zis a damped exponential in the time domain. The real part of \u03c9is the frequency and the modulus of the imaginary part |Im (\u03c9)| is twice the width of the Lorentzian of height dI|Im (\u03c9)|. The rank or dimension of the signal space K is not an input, and is determined by the processing. Since the vectors {right arrow over (s)}are linearly independent, they form a basis set for a signal space in which the signal vectors {right arrow over (x)}must lie.","From the decimated signal c, the matrix generator constructs a M-by-M Hermitian covariant correlation matrix R(i=1, . . . , M; j=1, . . . M) in accordance with the following formula:",{"@attributes":{"id":"p-0041","num":"0040"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["R","ij"]},"mo":"=","mrow":{"mfrac":{"mn":"1","mrow":{"msub":{"mi":["N","d"]},"mo":["-","+"],"mi":"M","mn":"1"}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":[{"mi":"n","mo":"=","mn":"0"},{"msub":{"mi":["N","d"]},"mo":"-","mi":"M"}]},"mo":"\u2062","mrow":{"msub":{"mi":"c","mrow":{"mi":["n","i"],"mo":["+","-"],"mn":"1"}},"mo":"\u2062","msubsup":{"mi":"c","mrow":{"mi":["n","j"],"mo":["+","-"],"mn":"1"},"mo":"*"}}}}}},{"mrow":{"mo":["(",")"],"mn":"3"}}]}}}}},"Using a standard diagonalization routine, the matrix diagonalizer diagonalizes the correlation matrix R, thereby obtaining the singular values uand their corresponding eigenvectors {right arrow over (u)},i=1, . . . ,M. The singular values are the real, non-negative eigenvalues of the correlation matrix. The singular values are indexed so that u>u. After a sufficient number of transients, the signal projector projects the measured vectors onto the noisefree signal subspace, the projections representing the noise-reduced signal vectors.","The singular values can be divided between noisefree singular values, associated with the noisefree signal subspace, and the noise singular values associated with the noise signal subspace. In order to determine whether a sufficient number of transient acquisitions have been made, for purposes of obtaining a noise-reduced spectrum, a graph of In (u) against the index i is produced.","The user or operator of the apparatus  determines whether a separation or a \u201cgap\u201d between the first noise point (i.e. noise singular value) in the plot, and the smallest signal point (i.e. noisefree singular value) in the plot, can be identified. This provides a first criterion for recognizing that the iterations performed so far may be close to being sufficient for purposes of producing an acceptable spectrum. The user or operator then determines whether the gap stabilizes over a number of additional measurements, signal-averaging, and singular value generation, described above. This provides a second criterion for recognizing that a sufficient number of transients has been acquired. As a supplemental criterion, the operator may also determine whether the spectrum also stabilizes over a number of additional measurements.","In the method and system described in this section, the interactivity is with the singular value graph, not with the signal-to-ratio ratio that is monitored as the transients are being acquired, in contrast to known methods, such as the FFT (fast Fourier transform) method. When the FFT method is used, transients are taken and signal averaging is performed, until the desired signal-to-noise ratio is achieved. In practice, the operator watches the noise decrease, and watches the signal \u201crise out\u201d of the background. This is not done here. Instead, the criterion for stopping the acquisition of transients is the appearance of a stable gap in the singular value graph, and, supplementally, the appearance of a stable spectrum.","As an alternative to user interaction with the singular value graph, the control system  can be configured to determine whether the criteria described in paragraph 35 have been satisfied. For specific types of spectroscopy, spectrometers, active nuclei concentration, and physical parameters, calibrations can be made as to when the gap will appear. These calibrations do away with the need for user interactivity, in which case the control system  can be configured to determine: 1) whether a clearly discernable gap has appeared between the smallest signal point and the first noise point in the plot of singular values; and 2) whether the gap has stabilized with respect to further acquisition of transients by the data acquisition system . In this embodiment, once the control system  determines that such a gap has appeared and stabilized, the control system  sends command signals to stop the data acquisition system  from making further measurements.","The appearance of the gap and the stabilization of the gap establish that a sufficient number of transients have been performed for noise reduction to be implemented, for K to be estimated, for a local signal-to-noise ratio to be 1, and for transient collection to stop after roughly another 5% to 10% of the already collected transients have been obtained. The extra number of transients is needed to test the convergences, i.e. to check that the gap has stabilized and remains stable, and that the spectrum has also stabilized.","In one embodiment, the control system  may include a graphics system  that receives as input the singular values obtained by the noise reduction preprocessor , and generates a plot of the singular values as a function of their indices. While a logarithmic plot is described and discussed in this section, non-logarithmic plots can also be used. The control system  further includes a pattern recognition system , which is configured to identify, from the singular value plot generated by the graphics system , a gap between the smallest noisefree singular value and the first noise singular value. The control system  further includes a command signal generator  which is responsive to the pattern recognition system . The command signal generator  is configured to generate an output signal that requests the data acquisition system  to make more transient acquisitions (i.e., a \u201cnot OK\u201d signal as illustrated in ), if the pattern recognition system  fails to identify such a gap, or if the gap identified by the pattern recognition system  fails to converge. The command signal generator  is configured to generate an output signal that requests the data acquisition system  to stop making any further measurements (i.e., an \u201cOK\u201d signal as illustrated in ), if the pattern recognition system  establishes the appearance and stabilization of such a gap.","The control system  may include a computer-readable medium that has stored therein computer-readable instructions for a processor. These instructions, when read and implemented by the processor, cause the processor to perform the steps described in paragraph 37 above, namely: 1) identify a gap between a noisefree singular value (associated with the noisefree signal subspace) and an adjacent noise singular value (associated with the noise subspace); 2) request further measurements by the data acquisition system  if the gap cannot be identified; 3) if the gap can be identified, determine the stability of the gap; 4) request further measurements by the data acquisition system , if the gap does not stabilize; and 5) request that no further measurements be made by the data acquisition system , if the gap has stabilized. The computer-readable medium may be any medium known in the art, including but not limited to hard disks, floppy diskettes, CD-ROMs, flash memory, and optical storage devices. The computer readable instructions discussed above may be provided through software that is distributed through the Internet.","The gap represents the numerical separation between the eigenvalues associated with the noisefree signal subspace and the eigenvalues associated with the noise subspace. Perturbation theory indicates that groups of eigenvalues that are well spaced are much less sensitive to perturbations that eigenvalues that are close together. Therefore, the well-spaced eigenvalues can be identified with the noisefree signal, and the regions of high density eigenvalues can be identified with noise. Perturbation theory also indicates that the noise subspace has less influence on the noisefree signal subspace as the gap increases in size. When changes occur or when no \u201cgap\u201d can be clearly estimated, then the number of transients used needs to be increased and the whole process must start again.","When it is established by the user or by the control system  that a clear gap has appeared and stabilized, the signal projector in the noise reduction pre-processor  generates a noise-reduced signal, so that a spectrum can be formed by frequency inversion. The signal projector projects the decimated measured vectors onto the noisefree signal subspace, using the following projection formula:",{"@attributes":{"id":"p-0052","num":"0051"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msubsup":{"mover":{"mi":"c","mo":"->"},"mi":["n","or"]},"mo":"=","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"K"},"mo":"\u2062","mrow":{"mrow":{"mo":["(",")"],"mrow":{"msubsup":{"mover":{"mi":"u","mo":"->"},"mi":"k","mo":"*"},"mo":",","msub":{"mover":{"mi":"c","mo":"->"},"mi":"n"}}},"mo":"\u2062","msub":{"mover":{"mi":"u","mo":"->"},"mi":"k"}}}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]}}}},"br":{},"sub":"k "},"Given the decimated signal vectors {right arrow over (c)}an estimate of the N\u2212M+1 projected signal vectors can be made, as {right arrow over (X)}\u2245{right arrow over (c)}. Since a particular X\u2245c=celement appears in multiple vectors, an arithmetic average is taken, the result of which restores the Hankel structure of the signal matrix as defined by X=X. As this averaging tends to cancel some of the corrections made in the projection, starting with the new signal the whole procedure is iterated to convergence several times, to give the final noise-reduced or \u201ccleaned\u201d signal.","The noise-reduced signal, consisting of discretized sampled points c, is input into the spectral estimator , which converts the signal into frequency space by using known conversion methods such as harmonic inversion or Fourier transform, to derive a noise-reduced spectrum. Among the known methods, using harmonic inversion for the frequency conversion step gives the best results, while using the Fourier transform methods for the frequency conversion step provides improved results.",{"@attributes":{"id":"p-0055","num":"0054"},"figref":["FIG. 2","FIG. 2","FIG. 2"],"sub":"3"},"The experiment was performed with the knowledge that carbonyl was in the molecule, and that it was expected to give the lowest amplitude signal of all the carbons. The signal was expected to be in the 161 to 175 ppm region, so two windows were placed in each of 512 Fourier grid points. At 256 transients (N=256) a converged result was obtained, so that any further acquisition of transients was discontinued. The second column in the figure is shown to demonstrate convergence of the processing. The legend \u201cCS\u201d in the figure denotes \u201ccleaned signal,\u201d while \u201cNS\u201d denotes the original noisy signal. \u201cMF\u201d denotes the \u201cmatched filter\u201d variant of Fourier noise reduction processing. \u201cHI\u201d indicates that the harmonic inversion spectral estimator was used, while \u201cFFT\u201d indicates that the Fast Fourier Transform spectral estimator was used. The harmonic inversion spectrum, not being on a Fourier grid, was drawn on a thousand points grid in the window of the spectrum in the figures.",{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIG. 3","FIG. 2","FIG. 3","FIG. 3","FIG. 3"],"sub":"tr"},"As seen from the , and most clearly from the 2560 transients experiment, the noise singular values form a quasi-horizontal string, resembling a string of pearls, to the lower right of the smallest signal point, i.e. the smallest noisefree singular value. Windowing bends the true horizontal line without prejudicing the gap. The distance from the first noise point to the smallest signal point is the gap that is being identified. The gap between the noise singular values and the noisefree singular values is clearly seen in the 256 transient and the 2560 transient results in . The gap appears even if the noise eigenvalues are not constant. In most case, the gap can be begun to be estimated by recognizing that it always appear at the elbow of curves, as seen from . The qualitative change in the eigenvalue density and spacing (low on the left and high on the right) is an indicator of a gap.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 4","FIG. 2"],"sup":["13","13","th "],"sub":"3 "},"To start, 2176 scans (not shown) were tried first, with and both N=16384 and 32768 for the fourth carbon. The former gave K=7, the latter K=6. For the purposes of estimating K, it was surmised that the less noisy K=7 was correct. To be certain, the number of transients Nwas raised to 2432 and 2560. Both cases gave a clear K=7 at both half and full lengths and a converged spectrum, as seen in .",{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 5"},"In sum, the technique of the present invention allows for satisfactory spectra to be generated while using substantially fewer transients than are typically acquired for NMR spectral studies, by supplying the criteria for recognizing when transient acquisitions may stop while still deriving a satisfactory spectrum from already acquired transients. The method and system of the present invention permits a spectrum (having acceptably low noise characteristics) to be generated after performing measurements that are fewer by a factor of at least about 10 and up to about 100, compared to the number of measurements required in order to generate a spectrum having a comparable signal-to-noise ratio, using signal averaging followed by fast Fourier processing. In other words, a great deal of measurement time is saved. Because machine time is generally very expensive in spectroscopic techniques such as NMR, the saving in measurement time translates into substantial cost savings.","While the invention has been particularly shown and described with reference to specific preferred embodiments, it should be understood by those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope of the invention as defined by the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 2","sup":"13","sub":"13"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 3","FIG. 2"],"sup":"13","sub":"13 "},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 4","sup":["13","13","th "],"sub":"3"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 5","FIG. 4"]}]},"DETDESC":[{},{}]}
