---
title: Systems and methods for detecting authorized players
abstract: One embodiment includes method for determining whether a player application is authorized to play protected content. The method comprises reading a digital signature associated with the player application from a predetermined memory location using a protection interface associated with the player application, where the digital signature comprises one or more file designations. The embodiment further comprises mapping, by the protection interface, the one or more file designations to one or more files associated with the player application and transmitting mapping information from the protection interface to a verification application stored on a storage medium. The verification application is configured to determine whether the player application is authorized to play the protected content if the one or more file designations match the one or more files based on the mapping information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08856949&OS=08856949&RS=08856949
owner: Cyberlink Corporation
number: 08856949
owner_city: Shindian, Taipei
owner_country: TW
publication_date: 20090122
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATION","TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This application claims priority to, and the benefit of, U.S. Provisional Patent Application entitled, \u201cSYSTEMS AND METHODS FOR DETECTING AUTHORIZED PLAYERS,\u201d having Ser. No. 61\/141,403, filed on Dec. 30, 2008, which is incorporated by reference in its entirety.","The present disclosure generally relates to multimedia content and more particularly, relates to detecting authorized players of media content.","Over the years, digital video content has gained increasing popularity with consumers. With the increasing amount of audio and video content available to consumers through broadcast, cable, on-demand, fixed media, and other available sources of multimedia content, consumers have access to an increasing amount of content and programming. Furthermore, many devices (e.g., PCs, DVD recorders) and services that are readily available allow consumers to record, time-shift or view on-demand video and audio content.","Video playback systems are well known, and there are a variety of current standards that govern the format and other attributes associated with the various video playback systems. Today, the DVD (Digital Video Disc) standard is the predominant format utilized for optical disc storage because of its high storage capacity, thus enabling high quality video and audio to be stored. Consequently, media content such as movies, television shows, and music videos are made widely available in DVD format.","Blu-ray Disc offers advantages over DVDs and other previous optical standards in various ways including increased storage capacity and enhanced interactivity (disc content authoring, seamless menu navigation, network\/Internet connectivity, etc.). The Blu-ray Disc framework offers content providers almost unlimited functionality when creating interactive titles. The author has complete freedom in designing the user interface, which is controllable by using standard navigational buttons on a remote control. As such, Blu-ray Disc provides greater levels of user control and interactivity involving the underlying video content.","Unfortunately, piracy of audio\/visual works continues to proliferate as hackers facilitate the unauthorized distribution of multimedia content. Because of the capability in accessing and copying multimedia content stored on DVDs, for example, video and audio piracy continues to be an ongoing problem. Such piracy continues to be a problem even in light of the copy-restricted mechanisms that DVDs generally employ.","Briefly described, one embodiment, among others, includes a method for determining whether a player application is authorized to play protected content. The method comprises reading a digital signature associated with the player application from a predetermined memory location and determining whether the player application is authorized to play the protected content based on the digital signature. The digital signature contains one or more disk file designations and one or more image file designations.","Another embodiment is a system for determining whether a player application is authorized to play protected content. The system comprises a verification application configured to determine whether a player application on a viewing apparatus is authorized to access media content by examining a digital signature. In accordance with such embodiments, the verification application reads the digital certificate from a predetermined memory location in the viewing apparatus. The digital signature contains disk file designations and image file designations associated with the player application.","Another embodiment is a computer readable medium storing a computer program for execution on a processor. The computer program comprises computer executable instructions configured to read a digital signature associated with the player application from a non-volatile memory in a viewing apparatus and determine whether a player application on the viewing apparatus is authorized to play protected content based on the digital signature. The digital signature contains one or more disk file designations and one or more image file designations.","Other systems, methods, features, and advantages of the present disclosure will be or become apparent to one with skill in the art upon examination of the following drawings and detailed description. It is intended that all such additional systems, methods, features, and advantages be included within this description, be within the scope of the present disclosure, and be protected by the accompanying claims.","Having summarized various aspects of the present disclosure, reference will now be made in detail to the description of the disclosure as illustrated in the drawings. While the disclosure will be described in connection with these drawings, there is no intent to limit it to the embodiment or embodiments disclosed herein. On the contrary, the intent is to cover all alternatives, modifications and equivalents included within the spirit and scope of the disclosure as defined by the appended claims.","In response to unauthorized copying and distribution of multimedia content, publishers and authors of audio\/visual works have relied on various technologies that control access to digital content. BD+ is a component of the Blu-ray Disc Digital Rights Management system which was developed by Cryptography Research Inc. (CRI). BD+ is a small virtual machine (VM) embedded in authorized players that allows content providers to include executable programs (e.g., a BD+ program) on Blu-ray Discs. Such programs can examine the host environment to see if the player has been tampered with.","In general, every licensed playback device manufacturer provides the BD+ licensing authority with memory footprints that identify their devices. Such programs can also verify that the player's keys have not been changed. The programs can also limit playback of a Blu-Ray disc to the first device in which the disc is played. If a playback device manufacturer finds that its devices have been hacked, it can potentially release BD+ code that detects and circumvents the vulnerability. These programs can then be included in all new disc releases.","Each BD+ licensed BD-ROM player is issued BD+ signatures and a certificate that is signed by a BD+ licensing authority. The security check performed by the VM matches the player's BD+ security keys with the player's certificate. This check insures that keys have not been compromised or stolen from another playback environment and inserted into the environment being checked. Once the keys and certificates have been checked, the VM examines the player's playback environment. Each player manufacturer must provide the BD+ licensing authority with a memory footprint that can be used to identify their playback environment.","Various embodiments are described for detecting authorized player applications. In accordance with some embodiments, the digital signatures described above are constructed based on one or more files or tags. A designation list file of the locations of these files or tags, when loaded into memory, is generated. This list of memory locations is encrypted and signed. Upon installation of a BD software player, this list of memory locations is also installed. During playback, the list is loaded by a BD+API (application programming interface), for example, verified, and decrypted by a BD+ program (or verification application), which may be pre-stored on a storage medium such as a Blu-ray disc or other optical disc. The BD+ program then calls an API (e.g., DiscoveryRAM) or a protection interface coupled to the player application to verify if the tags are in their correct memory positions. That is, the memory locations in the list are compared to the actual memory locations of the tags to determine whether they match.","Various embodiments are thus described for generating digital signatures based on static disk files, image files associated with the target, or a combination of both. In this case, the target is the player application being evaluated. In this regard, the digital signatures actually identify the player application they are assigned to. A description of the various components of a system for determining whether a player application is authorized to play protected content is described below, followed by a discussion of the operation of these components. One embodiment is generally implemented on a storage medium, such as a Blu-ray disc or other optical disc. For purposes of illustration, the functionality of a verification application stored on a Blu-ray disc is described in connection with a player application and protection application executed on a viewing apparatus such as a computer.","With reference to , a system for determining whether a player application is authorized to play protected content is shown. For some embodiments, the system may include a verification application  stored on a storage medium  such as a Blu-ray disc (BD) or other optical disc. As described above in connection with the BD+ framework, the verification application  may be a virtual machine (VM) running within the BD-ROM playback engine, as those skilled in the art will appreciate. The verification application  may also be an executable file.","In accordance with some embodiments, the verification application  may be embedded into authorized copies of a Blu-ray Disc . These authorized copies are protected by AACS (Advanced Access Content System), which is a standard relating to content distribution and digital rights management. The viewing apparatus  is configured to obtain authorization for creating or downloading a authorized copy by contacting a designated server on the Internet. To protect against unauthorized distribution of media content, authorized copies are protected by DRM (digital rights management) such that uncontrolled copying is prevented.","The verification application  interfaces with a viewing apparatus , which may be, for example, a computer workstation, laptop or other computing device. The viewing apparatus  receives the storage medium (e.g., BD disc)  storing the verification application  via an optical disk drive or other means. The viewing apparatus  may include a display  and input devices such as a keyboard  and a mouse . Furthermore, the viewing apparatus  may be configured to provide a user interface, which a user utilizes to select movie titles to view or to access interactive features stored on the storage medium .","The viewing apparatus  includes a player application  and a protection interface . The player application  is utilized to play back media content stored on the storage medium . Before the player application  can access the media content stored on the storage medium , however, the verification application  performs a check to determine if the player application  is authorized to access the protected media content. Specifically, the verification application  interfaces with the protection interface  to determine whether the digital signature associated with the player application  is valid.","Reference is made to , which depicts a block diagram for an example illustration of a verification application interfacing with the viewing apparatus in  according to an embodiment of the present disclosure. The viewing apparatus  shown in  may include a memory  and a separate mass storage device  such as a hard disk drive for storing one or more disk files  associated with the player application .","As one skilled in the art will appreciate, the installation of an application or program may involve a large number of files. Many programs are supplied in a condensed form when distributed. In order to be used, the programs are first unpacked and relevant files and information are placed on the computer, taking into account variations between computers and any customized settings required by the user. During installation, the computer is configured to store relevant files and any necessary settings required for that program to operate correctly. Such files may include, for example, configuration files, shortcuts, and data files. The files may also include executable files and other binary files. Generally, such files are installed to a particular location on a hard disk drive or other mass storage device . Several hundred files  may be involved during an installation. For some embodiments, a portion of these files (e.g., twenty files) may be utilized to generate a digital signature .","For purposes of this disclosure, the term \u201cimage file\u201d  refers to a file loaded from a hard disk to memory for execution. Further the image file  can be regarded as an image of a disk file or loaded form of the disk file. The image file  represents a portion of the memory for execution. As one of ordinary skill will appreciate, within a computing environment, files stored on a hard disk undergo various changes when these files are loaded to memory for execution. As non-limiting examples, these image files may be moved to a new memory location (relocation) or de-compressed (if the files are originally in a compressed form). By way of illustration, the player application  may be stored in a compressed form with a file size of approximately 500 kB when stored in the mass storage device . When the player application  is loaded into memory  for execution, however, the size of the image file  may expand up to 2 MB.","It should be further noted that for some implementations, protection mechanisms may also be executed during this loading process. One protection mechanism is directed to checking for the presence of a debugger in the system while loading a file to memory. Another protection mechanism involves checking for the presence of malicious software designed to dump portions of code or to log data. For some embodiments, execution authority may also be checked to determine whether authorized components are being executed. Some embodiments may also involve checking the integrity of the binary code (after the file is loaded) or scrambling the binary code. As another protection mechanism, the file may be initially encrypted and decrypted when being loaded into memory for execution.","As such, for exemplary embodiments, both disk files (i.e., those files stored on the hard disk)  and image files  are utilized to create a digital signature  during creation of the player application . For purposes of this disclosure, disk files and may also be referred to as \u201cstatic files\u201d as these disk files generally reside in static memory. In accordance with exemplary embodiments, disk files and image files of the player application  are used to create a digital signature , which is later used to determine whether the player application  is an authorized player. In some implementations, the digital signature  contains both disk file designations and image file designations which are later examined to determine whether the player application  has been tampered with, copied without authorization, etc. For some embodiments, the digital signature  may be created using a predetermined algorithm such as a checksum algorithm or other algorithm.","Referring briefly to , a digital signature builder  is used to generate the digital signature  using, for example, a checksum algorithm or one of the algorithms described earlier. Generally, the signature builder  will be issued by a content provider or an entity seeking to control access to content stored in conjunction with the verification application . In this regard, the content provider also provides the verification application . Upon being created, the digital signature  is bundled with the player application  in a player application installation package , which may be distributed via an installation CD  or other means.","Upon installation of the player application  onto a viewing apparatus , the digital signature  containing the file designations is copied to a predetermined memory location on the viewing apparatus  for later verification. Note that if this digital signature  is somehow tampered with and embedded in another viewing apparatus  with another player application  installed, the file designations in the digital signature  will not align with files in that viewing apparatus . Accordingly, access to the protected content will be denied.","For some embodiments, the digital signature  may be embedded into certain installation files. In one implementation, the digital signature  may be appended to one or more files. In other implementations, the digital signature  may be stored as a separate file. The digital signature  is signed and recognized by the verification application  as the digital signature is created using the signature builder  discussed above. As emphasized earlier, in accordance with various embodiments, digital signatures may be generated based on disk files, image files, or a combination of both. By way of illustration, the contents of a digital signature  may comprise the following disk file designations and image file designations.",{"@attributes":{"id":"p-0036","num":"0035"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"98pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["(file #1) player.exe","disk file designation = 0x1357","image file designation = 0x2468"]},{"entry":["(file #2) decoder.dll","disk file designation = 0x4096","image file designation = 0x1024"]},{"entry":["(file #3) nav.dll","disk file designation = 0x1111","image file designation = 0x2222"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}},"br":{},"b":"206"},"The verification application  first loads an entry (e.g., player.exe; file designation=0x1357; image designation=0x2468). The protection interface  then maps the file designations in the entry to corresponding files in the viewing apparatus  and a determination is made on whether the corresponding files match the file designations, as illustrated in . For example, if the file designation 0x1357 and image designation 0x2468 map to a file other than \u201cplayer.exe,\u201d then a determination is made by the verification application  that the player application  is unauthorized as the digital signature  may have been hacked. It should be appreciated that while a single digital signature  is discussed, a plurality of digital signatures may also be implemented. It is understood that all such variations are within the scope of the present disclosure.","For embodiments involving use of predetermined constants, the file designations may comprise an offset (e.g., memory location) to a predetermined constant embedded in the disk file or the image file. The predetermined constant may be predefined or specified, for example, by an issuer of the BD+ program and embedded into the verification application . As a nonlimiting example involving a predetermined constant, suppose a predetermined constant with a value of 0x100 is defined. This constant is placed into a location within a disk or image file on the viewing apparatus . For this example, suppose that the predetermined constant is embedded within the file \u201cdecoder.dll\u201d at the location 0x3759. The location 0x3759 will be used to retrieve the constant value for comparison purposes. Since a constant value (e.g., 0x100) is being utilized, the designation list file may contain the following entry:\n\n","Referring back to the checksum and hash function implementations described earlier, it should be noted that the checksum and hash function implementations read entire files, whereas embodiments utilizing a predetermined constant read only a block of data. Furthermore, the checksum and hash function implementations perform an intermediate calculation for comparison purposes, whereas no additional calculation is needed when a predetermined constant is used. As such, checksum and hash function implementations compare calculated values, and implementations involving a predetermined constant simply read the value stored at a specified location (e.g., 0x3759) for comparison purposes. The examples provided above are merely illustrative and should not be construed as implying any limitations upon the scope of the present invention.","Referring back to , the verification application  sends a verification request  to the viewing apparatus  and specifically, to the protection interface , in order to determine whether the player application  is an authorized player. Upon receiving the verification request , the protection interface  reads the digital signature  stored in the viewing apparatus . In some cases, the digital signature  may be stored in a mass storage device  such as a hard disk drive.","As depicted in , based on the one or more disk file designations  and one or more image file designations  specified by the digital signature , the protection interface  provides a mapping to one or more corresponding disk files  and one or more corresponding image files . The mapping information may be sent back to the verification application  in a response . A determination is made on whether the file designations ,  match their corresponding files , . If the file designations ,  match their corresponding files , , then the digital signature  stored in the viewing apparatus  is valid and the player application  is authorized. The player application  can then access the protected content , as depicted in .","For implementations where only disk files , rather than image files  or a combination of both disk files  and image files , are utilized to generate the digital signature , the memory locations of the disk files  are recorded in a file such as a digital signature . The digital signature builder  encrypts this digital signature . The digital signature  is later loaded by the protection interface , and the verification application  verifies and decrypts the digital signature . The verification application  then sends a request to the protection interface  to map the file designations  to respective disk files based on the memory locations specified in the digital signature . If the memory locations point to disk files  that match the file designations  specified in the digital signature , a determination is made that the player application  is an authorized player.","Reference is now made to , which illustrates an embodiment of the viewing apparatus  shown in  for receiving the storage medium  storing the verification application . Generally speaking, the viewing apparatus  may comprise any one of a wide variety of wired and\/or wireless computing devices, such as a desktop computer, portable computer, dedicated server computer, multiprocessor computing device, cellular telephone, personal digital assistant (PDA), handheld or pen based computer, embedded appliance and so forth. Irrespective of its specific arrangement, viewing apparatus  can, for instance, comprise memory , a processing device , a number of input\/output interfaces , a network interface , a display , and mass storage , wherein each of these devices are connected across a data bus .","Processing device  can include any custom made or commercially available processor, a central processing unit (CPU) or an auxiliary processor among several processors associated with the viewing apparatus , a semiconductor based microprocessor (in the form of a microchip), one or more application specific integrated circuits (ASICs), a plurality of suitably configured digital logic gates, and other well known electrical configurations comprising discrete elements both individually and in various combinations to coordinate the overall operation of the computing system.","The memory  can include any one of a combination of volatile memory elements (e.g., random-access memory (RAM, such as DRAM, and SRAM, etc.)) and nonvolatile memory elements (e.g., ROM, hard drive, tape, CDROM, etc.). The memory  typically comprises a native operating system , one or more native applications, emulation systems, or emulated applications for any of a variety of operating systems and\/or emulated hardware platforms, emulated operating systems, etc. For example, the applications may include application specific software  stored on a computer readable medium for execution by the processing device  and may include the player application  depicted in . One of ordinary skill in the art will appreciate that the memory  can, and typically will, comprise other components which have been omitted for purposes of brevity.","Input\/output interfaces  provide any number of interfaces for the input and output of data. For example, where the viewing apparatus  comprises a personal computer, these components may interface with user input device , which may be a keyboard or a mouse, as shown in . Where the viewing apparatus  comprises a handheld device (e.g., PDA, mobile telephone), these components may interface with function keys or buttons, a touch sensitive screen, a stylist, etc. Display  can comprise a computer monitor or a plasma screen for a PC or a liquid crystal display (LCD) on a hand held device, for example.","In the context of this disclosure, a \u201ccomputer-readable medium\u201d stores the program for use by or in connection with the instruction execution system, apparatus, or device. The computer readable medium can be, for example, but not limited to, an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system, apparatus, or device. More specific examples (a non-exhaustive list) of the computer-readable medium may include the following: an electrical connection (electronic) having one or more wires, a portable computer diskette (magnetic), a random access memory (RAM) (electronic), a read-only memory (ROM) (electronic), an erasable programmable read-only memory (EPROM, EEPROM, or Flash memory) (electronic), and a portable compact disc read-only memory (CDROM) (optical).","With further reference to , network interface device  comprises various components used to transmit and\/or receive data over a network environment. By way of example, the network interface  may include a device that can communicate with both inputs and outputs, for instance, a modulator\/demodulator (e.g., a modem), wireless (e.g., radio frequency (RF)) transceiver, a telephonic interface, a bridge, a router, network card, etc.). The viewing apparatus  may further comprise mass storage . For some embodiments, the mass storage  may include a database  to store and manage data. Such data may comprise, for example, editing files which specify special effects for a particular movie title.","Reference is made to , which is flowchart of a method for determining whether a player application is authorized to play protected content. Beginning in block , a digital signature associated with the player application is read from a predetermined memory location. As outlined above, a determination is made on whether the player application  is authorized to play the protected content  based on the digital signature , wherein the digital signature  contains one or more disk file designations  and one or more image file designations .","In block , the one or more file designations  and one or more image file designations  are read from the digital signature . In blocks -, these file designations ,  are then mapped to corresponding files , . In block , a determination is made on whether play application  is an authorized player based on whether the file designations ,  match the mapped files , .","It should be emphasized that the above-described embodiments are merely examples of possible implementations. Many variations and modifications may be made to the above-described embodiments without departing from the principles of the present disclosure. All such modifications and variations are intended to be included herein within the scope of this disclosure and protected by the following claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Many aspects of the disclosure can be better understood with reference to the following drawings. The components in the drawings are not necessarily to scale, emphasis instead being placed upon clearly illustrating the principles of the present disclosure. Moreover, in the drawings, like reference numerals designate corresponding parts throughout the several views.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIGS. 2A-C","FIG. 1"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 3","FIG. 2A-C"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 4","FIG. 1"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
