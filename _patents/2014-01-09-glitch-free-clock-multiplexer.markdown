---
title: Glitch free clock multiplexer
abstract: Apparatus for glitch-free switching between two clock sources on an integrated circuit. Clock gaters provide a clock from a single source that can be turned on and off without causing partial pulses to be created. Control circuitry going to the individual clock gaters provides the ability to shut all clocks off for a period of time equal to the longest clock period. By combining the clocks with an OR gate and gating all clocks off before switching from one clock to another, a glitch-free train of clock pulses can be created from individual clock inputs. Since clock glitches can cause erratic behavior in integrated circuits, this invention allows one to switch between different (unrelated) clocks without causing erratic behavior.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09024661&OS=09024661&RS=09024661
owner: The United Sates of America as represented by the Secretary of the Air Force
number: 09024661
owner_city: Washington
owner_country: US
publication_date: 20140109
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["PRIORITY CLAIM UNDER 35 U.S.C. \u00a7119(e)","STATEMENT OF GOVERNMENT INTEREST","BACKGROUND OF THE INVENTION","OBJECTS AND SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT"],"p":["This patent application claims the priority benefit of the filing date of provisional application Ser. No. 61\/817,362, having been filed in the United States Patent and Trademark Office on Apr. 30, 2013 and now incorporated by reference herein.","The invention described herein may be manufactured and used by or for the Government for governmental purposes without the payment of any royalty thereon.","The Joint Test Action Group developed a 5 pin test access port standard which is commonly referred to as JTAG. JTAG is used for a variety of Integrated Circuit (IC) and board level tests. Currently some commercial tools allow automatic insertion of logic to switch between the IC's main clock and having the JTAG (TCK) clock driven onto the main clock distribution network. This functionality allows the standard JTAG interface to more effectively drive the inputs during test since the non-clock inputs can be scanned in and held steady while a clock is provided to the chip without having to perform another entire boundary scan just to change one signal.","A clock gater is a circuit that combines a latch (with inverted clock) and an AND gate. It has a \u201cgate\u201d input and a \u201cclock\u201d input. The latch with inverted clock ensures the gate (or control) signal cannot change while the clock is high. The gater's output is taken from the AND gate's output. The AND gate gets a slightly delayed clock on one input and the latch's output on its other input. Just before the clock goes high at the AND gate input the latch captures and holds the value of the gate signal. The AND gate will follow the clock with a slight delay if the gate signal was high just before the clock went high at the AND gate. The AND gate will stay low if the gate signal is low just prior to the clock going high. Had just an AND gate been used without the latch the gate signal may have cut short one of the clocks positive pulses, a clock gater prevents this. Typically clock gaters are used to save power by not clocking circuitry when it doesn't need to be active, and also to control functionality such as only clocking a register when you wish to load it with new data.","Prior art has simply multiplexed between the two clocks without ensuring only whole positive clock pulses were presented to the system and without ensuring there was adequate time between the last pulse of the clock being turned off and the first pulse of the clock being turned on. Alternatively custom circuitry (such as pass gates) in the prior art was not provided as standard cells for use in standard cell based designs and that custom circuitry does not work well with standard cell design flows.","Of particular concern is that the prior art does not insert special clock gaters and does not properly time the control of the two (or more) clocks. As a result, it is possible to get a partial clock pulse out of JTAG control circuitry in either the positive (short time at \u201c1\u201d) or negative (short time at \u201c0\u201d) sense. A partial clock can cause erratic behavior from the integrated circuit.","It is therefore an object of the present invention to provide an apparatus that overcomes the prior art's limitations in selecting one of several clocks to be used in clocking an integrated circuit. This apparatus will switch between two clocks ensuring no short pulses are created, either a short time at \u201c1\u201d or a short time at \u201c0\u201d","Another object of the present invention is to provide an apparatus that uses bits from the JTAG instruction register (or a data register) to control properly gated clock signals. The JTAG control bit or bits can be properly timed with hardware or by requiring multiple JTAG scans such that there is a clean switch between the processor's main clock and the JTAG clock. By using glitch-free clock gaters on the individual clocks, properly timed controls to those gaters, and an OR logic gate; the resulting output provides full width positive pulses when switching between clocks.","Yet another object of the present invention is to provide an apparatus that ensures one bit of the JTAG instruction register drives the \u201cgate\u201d input for the main clock gater and another bit drives the \u201cgate\u201d input for the JTAG clock gater, while an OR gate performs an OR function on the two clocks, its output passes through a 1 when either input is a 1.","Briefly stated, the present invention provides an apparatus for glitch-free switching between two clock sources on an integrated circuit. Clock gaters provide a clock from a single source that can be turned on and off without causing partial pulses to be created. Control circuitry going to the individual clock gaters provides the ability to shut all clocks off for a period of time equal to the longest clock period. By combining the clocks with an OR gate and gating all clocks off before switching from one clock to another, a glitch-free train of clock pulses can be created from individual clock inputs. Since clock glitches can cause erratic behavior in integrated circuits, this invention allows one to switch between different (unrelated) clocks without causing erratic behavior.","The above and other objects, features and advantages of the present invention become apparent from the following description read in conjunction with the accompanying drawings, in which like reference numerals designate the same elements.","Referring to , the key components of a generic prior art clock gater  include a gate input , which determines if the clock will be passed through or if the output  will drive a zero instead. Positive pulses from the clock input  are optionally passed to the clock gater output  based on the latched value captured by latch . Delay cell  ensures that the latch  has a stable output  feeding into AND gate  prior to the clock rising edge arriving from delay . The clock gater circuitry  along with appropriate timing constraints ensures that only whole clock pulses pass through to its output .","Referring to , the key components of this invention , are two or more clock gaters , , control inputs , and  from the JTAG instruction or other suitable register, and an OR gate . JTAG instruction register bits  and  drive the individual clock gator inputs  and . STAG register bit  resets to 1, register bit  resets to 0, (input  is 1, input  is 0), on reset the main clock  is passed through to output . In order to change the clock driving output , a JTAG instruction scan (and update) would be performed setting both bit  and bit  to zero. Followed by a second STAG instruction scan (and update) keeping bit  at zero and setting bit  to 1. The individual gaters , , ensure only whole positive pulses are provided to OR gate , resulting in whole pulses at the output . A JTAG scan time period is much longer than either the main clock period presented at  or the JTAG clock period presented at . By setting both bit  and  to zero for a JTAG scan any overlap in the output of the two gaters ,  is avoided.","Referring to , depicts an alternate embodiment of the present invention which ensures a time period where both clocks are gated. Two flip-flops , , one AND gate with inverting inputs , and one AND gate , are used to switch between the two clock enable inputs , , without concern for timing of the switch. One input  is provided to select one of the two inputs. Input  is registered in flip-flop . The output of  is registered in flip-flop . Inverting input AND gate  provides a \u201c1\u201d upon reset or whenever both flip-flops ,  are \u201c0\u201d. The output of  drives , when  is \u201c1\u201d Clock Gater  passes the clock input applied on  through OR gate  to output . Conversely if the input , is driven high, first flip-flop  and then flip-flop  (on the following clock cycle) will go high resulting in AND gate  providing a \u201c1\u201d to . The JTAG clock is used to drive the clock inputs for both  and . The JTAG clock period is longer than the main clock period, (applied at input ). The output of the AND gate  goes to zero as soon as the flip-flop  registers a \u201c1\u201d, not waiting until both  and  output \u201c1\u201d. Likewise AND gate  does not output \u201c1\u201d until both  and  output \u201c1\u201d. Similarly when input  transitions from \u201c1\u201d to a \u201c0\u201d the circuitry ensure there is a one JTAG clock period when both , and  are \u201c0\u201d.","Having described preferred embodiments of the invention with reference to the accompanying drawings, it is to be understood that the invention is not limited to those precise embodiments, and that various changes and modifications may be effected therein by one skilled in the art without departing from the scope or spirit of the invention as defined in the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
