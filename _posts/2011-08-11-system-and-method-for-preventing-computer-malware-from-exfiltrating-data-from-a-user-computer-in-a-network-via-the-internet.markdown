---
title: System and method for preventing computer malware from exfiltrating data from a user computer in a network via the internet
abstract: A system for preventing computer malware from exfiltrating data from a user computer in a network via the internet. A host-based network process monitor intercepts network traffic information from the user computer and transmits a network request including user and application information including the network traffic information. An authorization server cooperates with the host-based network process monitor for i) verifying whether the user and process in the network request should have network access, and ii) cryptographically signing the intercepted network traffic information with an authorization server key, to authorize network access for the intercepted network traffic information. A firewall system is operably connected to the user computer and the authorization server configured to inspect the network traffic information from the user computer and reject any traffic information not signed with the authorization server key.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08631244&OS=08631244&RS=08631244
owner: Rockwell Collins, Inc.
number: 08631244
owner_city: Cedar Rapids
owner_country: US
publication_date: 20110811
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["1. Field of the Invention","The present invention relates generally to communication networks and more particularly to an enhanced system for protecting communication networks from malware.","2. Description of the Related Art","Sophisticated attacks against computer systems are increasing dramatically. For example, aerospace and defense contractors are especially targeted by foreign entities. It is extremely difficult to guard a system against these attacks. Many attacks now utilize zero-day (unknown before hand) attack factors that are not recognized by virus scanners. Attacks often combine highly sophisticated social-engineering and custom exploits to induce victims to load malicious software. These custom exploits are not recognized by available anti-virus\/anti-spyware systems. Subverted machines use standard mechanisms to leak information. Exploits use standard protocols (i.e. HTTP) to transmit information, with network traffic indistinguishable from legitimate traffic.","U.S. Publicn. No. 2005\/0262558, entitled \u201cON-LINE CENTRALIZED AND LOCAL AUTHORIZATION OF EXECUTABLE FILES,\u201d discloses a system and method for controlling the execution of executable files. The executables are identified by either a cryptographic digest or a digital certificate. The cryptographic digest is computed from the binary image of the executable. An executable that is attempting to execute is intercepted by a protection module that consults a database of stored rules over a secure channel to determine whether or not the executable can be identified as a permitted executable and whether or not it has permission to execute on a particular computer system under certain specified conditions. If a stored permission is available, it is used to control the execution. Otherwise, the user is consulted for permission.","U.S. Publicn. No. 2010\/0077445, entitled \u201cGRADUATED ENFORCEMENT OF RESTRICTIONS ACCORDING TO AN APPLICATION\u2032S REPUTATION,\u201d discloses security software on a client that observes a request for a resource from an application on the client and then determines the application's reputation. The application's reputation may be measured by a reputation score obtained from a remote reputation server. The security software determines an access policy from a graduated set of possible access policies for the application based on the application's reputation. The security software applies the access policy to the application's request for the resource. In this way, the reputation-based system uses a graduated trust scale and a policy enforcement mechanism that restricts or grants application functionality for resource interactivity along a graduated scale.","In a broad aspect, the present invention is a system for preventing computer malware from exfiltrating data from a user computer in a network via the internet. A host-based network process monitor is operably connected to a user computer and configured to intercept network traffic information from the user computer and transmit a network request comprising user and application information including the network traffic information. An authorization server is operably connected to the host-based network process monitor containing a database of users and applications. The authorization server is configured to cooperate with the host-based network process monitor for i) verifying whether the user and process in the network request should have network access, and ii) cryptographically signing the intercepted network traffic information with an authorization server key, to authorize network access for the intercepted network traffic information. A firewall system is operably connected to the user computer and the authorization server. It is configured to inspect the network traffic information from the user computer and reject any traffic information not signed with the authorization server key.","Unlike US 2005\/0262558, discussed above, the present invention uses file hashes at the firewall to decide whether to allow packets to pass or not. The '558 system, on the other hand, uses file hashes to decide whether to allow an executable to launch. It is a host-based system.","Unlike US 2010\/0077445, discussed above, the present invention provides off-host firewalling of untrusted applications. The '445 system uses file reputation to enable\/disable various amounts of user-rights on a host, which could include network access. It is also a host-based approach, not a proxy\/firewall.","The present invention prevents malware from connecting to the outside world by adding process-level authentication and authorization to network traffic. The term \u201cmalware\u201d as defined herein refers to malicious software (programming code, scripts, active content and other software) designed to gain unauthorized access to computer systems, gain unauthorized access to data stored on computer systems or networks, exfiltrate data stored on a computer or network, and\/or provide a command and control interface to unauthorized users.","Referring now to the drawings and the characters of reference marked thereon,  illustrates the system for preventing computer malware from exfiltrating data from a user computer in a network via the internet of the present invention, designated generally as . The system  includes a host-based network process monitor ; an authorization server  and a firewall system . The host-based network process monitor  is operably connected to a user computer  and is configured to intercept network traffic information from the user computer  and transmit a network request comprising user and application information including the network traffic information. The authorization server  is operably connected to the host-based network process monitor . The authorization server  contains a database of users and applications. It is configured to cooperate with the host-based network process monitor  for i) verifying whether the user and process in the network request should have network access, and ii) cryptographically signing the intercepted network traffic information with an authorization server key, to authorize network access for the intercepted network traffic information. The firewall system  is operably connected to the user computer  and the authorization server  and is configured to inspect the network traffic information from the user computer  and reject any traffic information not signed with the authorization server key.","The host-based network process monitor is a software component running on the user host computer. The authorization server can be a software component running on a common computer server, or a standalone network appliance (a specialized computer system). The firewall system can be a software component providing functionality to a commercially available firewall proxy system, a standalone software component running on a computer server, or a standalone specialized computer system. The host-based network process monitor  may be incorporated into the user computer  or may be a specialized piece of computer hardware. Thus, the phrase that the host-based network process monitor  is \u201coperably connected\u201d to the computer  is deemed to be broadly construed to encompass both potential scenarios. Furthermore, as defined herein the term \u201cinternet\u201d is meant to broadly refer to any internet working between disparate computer networks, including NIPRNet and SIPRNet.","The authorization server  may provide the cryptographic signing by signing individual network packets. This may be provided by, for example, applying internet protocol (IP) encapsulation by adding a cryptographic hash field to the intercepted network traffic information. Alternatively, it may be accomplished by applying an Internet Protocol header field such as an IPv4 header option field or IPv6 header chain field to the intercepted network traffic information. Or, such a signing may be accomplished by applying a transport layer wrapping protocol to the intercepted network traffic information.","The authorization server  may provide the cryptographic signing by adding a token. This may be by adding a tag-value pair to an application layer protocol.","Alternatively, the authorization server  may provide the cryptographic signing by a decision making technique. Referring now to , an example decision making technique, designated generally as , may be as follows:","a) receiving cryptographic signatures of the application and the network traffic information to provide received cryptographic signature and network traffic information (process block );","b) identifying the user authentication or host machine authentication of the received network traffic information and the received cryptographic signature to provide identified intercepted network information and cryptographic signature (process block );","c) computing a cryptographic signature of the identified traffic information including user authentication and user host OS configuration to provide computed cryptographic hash of the identified traffic information (process block );","d) comparing the computed network traffic information and the cryptographic signature against a whitelist and\/or a blacklist database or comparing intercepted network information against whitelist or backlist database to provide compared computed networked information and compared computed cryptographic signature (process block ); and,","e) digitally signing the network traffic information only if the compared computed network information and compared computed cryptographic signature are contained in the whitelist, and not contained in the blacklist (process block ).","Referring now to , the host-based network process monitor may provide monitoring of the network traffic information by the following process, designated generally as :","a) intercepting the transmit network request or the network traffic information to provide the intercepted transmit network request or the network traffic information (process block );","b) identifying the user computer and application information of the intercepted network request or the network traffic information to provide identified the user computer and application information (process block );","c) computing a cryptographic hash of the identified application information to provide computed cryptographic hash of the network traffic information (process block ); and,","d) forwarding the intercepted transmit network request or the network traffic information, with the computed cryptographic hash of the identified application information, to the authorization server (process block ).","In general terms, the firewall system  of the present invention operates by the following process:","The firewall system  of the present invention is designed to properly cooperate with the type of authorization server used. For example, if individual network packets are signed, by i) applying internet protocol (IP) encapsulation by adding a cryptographic hash field to the intercepted network traffic information or, ii) by applying an IPv4 header option field or IPv6 header chain field to the intercepted network traffic information, then the firewall system  may provide inspection of the network traffic information by the process of:","a) receiving the cryptographically signed network traffic information;","b) testing the validity of the cryptographic signature to provide validated cryptographic signature;","c) stripping the signature to restore the request to provide original state prior to interception by host process monitor, and","d) forwarding the original intercepted network traffic information to an internet destination only if the signature is valid.","If the authorization server provides the cryptographic signing by signing individual network packets, by applying a transport layer wrapping protocol to the intercepted network traffic information then the firewall system  may operate as follows:","a) receiving the cryptographically signed token within the application layer protocol;","b) testing validity of the cryptographic signature to provide validated cryptographic signature;","c) stripping the token to restore the application layer request to provide original state prior to interception by host process monitor, and","d) forwarding the original intercepted network traffic information to internet destination only if signature is valid.","Other embodiments and configurations may be devised without departing from the spirit of the invention and the scope of the appended claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
