---
title: Monitoring devices and systems for monitoring frequency hopping wireless communications, and related methods
abstract: Monitoring devices and systems comprise a plurality of data channel modules coupled to processing circuitry. Each data channel module of the plurality of data channel modules is configured to capture wireless communications for a selected frequency channel. The processing circuitry is configured to receive captured wireless communications from the plurality of data channel modules and to organize received wireless communications according to at least one parameter. Related methods of monitoring wireless communications are also disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09641216&OS=09641216&RS=09641216
owner: BATTELLE ENERGY ALLIANCE, LLC
number: 09641216
owner_city: Idaho Falls
owner_country: US
publication_date: 20090407
---

{"@attributes":{"id":"description"},"GOVINT":[{},{}],"heading":["GOVERNMENT RIGHTS STATEMENT","TECHNICAL FIELD","BACKGROUND","BRIEF SUMMARY","DETAILED DESCRIPTION"],"p":["This invention was made with government support under Contract Number DE-AC07-05ID14517awarded by the United States Department of Energy. The government has certain rights in the invention.","Embodiments of the present invention relate generally to monitoring devices and methods. More particularly, embodiments of the present invention relate to monitoring devices and systems for detecting and monitoring wireless communications employing multiple frequency channels and hopping between frequency channels, as well as to associated methods.","Wireless technologies employing frequency hopping are becoming more pervasive in industry and government environments. One popular technology employing frequency hopping is BLUETOOTH\u00ae, which may be found on a wide variety of mobile devices or other wireless devices, such as personal digital assistants, smart phones, cell phones, micro PCs, laptops, printers, personal music players, digital cameras, video recorders, etc. Such BLUETOOTH\u00ae devices may be configured to operate as either discoverable or undiscoverable. When a device is configured to work in discoverable mode, the device is detectable by other BLUETOOTH\u00ae devices within communications range. When a device is configured in undiscoverable mode, the device may communicate with other BLUETOOTH\u00ae devices but will not be detectable by standard BLUETOOTH\u00ae communications adapters. Such a configuration may allow BLUETOOTH\u00ae communications to occur in areas not necessarily desired by an organization.","Conventional monitoring devices may be employed to monitor these wireless communications in order to discover security breaches or malicious communications. Conventional monitoring systems are configured to capture the wireless communications from and between wireless devices by communicating with the master device or the slave device to obtain clock synchronization as well as the frequency hopping sequence. Such communication between the monitoring device and the master or slave device is conventionally referred to as \u201chandshaking.\u201d In order to carry out such handshaking communications with a master or slave device, it is typically required that the devices be discoverable. Therefore, conventional monitoring devices are unable to monitor wireless communications including one or more devices configured in undiscoverable mode, since the conventional monitoring device is unable to monitor without syncing to the clock and the frequency hopping sequence.","Various embodiments of the present invention comprise monitoring devices and systems configured to monitor frequency hopping wireless communications without handshaking or other transmission by the device or system. In one or more embodiments, the wireless communication monitoring device may comprise one or more data channel modules coupled to processing circuitry. The one or more data channel modules may be configured to capture wireless communications for at least one selected frequency channel of a plurality of frequency channels. The processing circuitry may be configured to receive captured wireless communications from the one or more data channel modules and to organize the captured wireless communications according to at least one parameter.","In one or more embodiments, the wireless communication monitoring system may comprise a receiver module configured to capture wireless communications transmitted over a plurality of frequency channels. The receiver module may comprise one or more data channel modules, and the one or more data channel modules may be configured to capture wireless communications for at least one selected frequency channel of the plurality of frequency channels. Processing circuitry may be coupled with the receiver module and configured to organize the captured wireless communications according to at least one parameter. Furthermore, an external device may be in communication with the processing circuitry and configured to receive and to process wireless communications that have been organized.","Other embodiments comprise methods of monitoring wireless communications, including frequency-hopping wireless communications. One or more embodiments of such methods may comprise monitoring a plurality of frequency channels at least substantially concurrently. At least one packet transmission may be captured on at least some of the frequency channels of the plurality of frequency channels. The plurality of packet transmissions may be organized according to at least one parameter.","In the following detailed description, circuits and functions may be shown in block diagram form in order not to obscure the present invention in unnecessary detail. Additionally, block definitions and partitioning of logic between various blocks as depicted is non-limiting, and comprise examples of only specific embodiments. It will be readily apparent to one of ordinary skill in the art that the present invention may be practiced in a variety of embodiments implementing numerous other partitioning solutions.","Also, it is noted that the embodiments may be described in terms of a process that is depicted as a flowchart, a flow diagram, a structure diagram, or a block diagram. Although a flowchart may describe operational acts as a sequential process, many of these acts can be performed in another sequence, in parallel, or substantially concurrently. In addition, the order of the acts may be re-arranged. A process is terminated when its acts are completed. A process may correspond to a method, a function, a procedure, a subroutine, a subprogram, etc. Furthermore, the methods disclosed herein may be implemented in hardware, firmware, software, or combinations thereof.","Various embodiments of the present invention comprise monitoring devices for detecting and monitoring multi-channel wireless communications.  illustrates a configuration of a monitoring device  according to at least some embodiments. A monitoring device  may comprise a communications module , processing circuitry  and storage media . Other arrangements within the scope of the invention are contemplated, including more, fewer and\/or alternative components.","The communications module  is configured to implement wireless and\/or wired communications of the monitoring device . For example, in some embodiments, the communications module  may be configured to capture wireless communications between wireless devices over a plurality of data channels and to communicate information bi-directionally with respect to other devices of a monitoring system. The communications module  may be coupled with an antenna . By way of example and not limitation, in some embodiments, the antenna  may comprise a high-gain directional antenna configured to allow a user to direct the range of coverage to a specific area or areas. The communications module  may comprise software, firmware, hardware, and combinations thereof for capturing wireless communications from wireless devices, as well as for wireless communicating with other devices of the monitoring system. The communications module  may also include a network interface card (NIC), serial or parallel connection, USB port, FIREWIRE\u00ae interface, Flash memory interface, or any other suitable arrangement for communicating with respect to public (e.g., Internet) and\/or private networks or other wired arrangements.","In at least some embodiments, the communications module  may be configured to detect and capture wireless communications of one or more wireless devices within a monitored area, and send and\/or receive communications to\/from one or more other devices of the monitoring system. By way of example and not limitation, the communications module  may include a receiver module  configured for capturing wireless communications between wireless devices that are transmitted over a plurality of data channels, and a system communication module  configured to communicate with other devices of the monitoring system.","In some embodiments, processing circuitry  is arranged to obtain data, process data, send data, and combinations thereof. The processing circuitry  may also control data access and storage, issue commands, and control other desired operations. Processing circuitry  may comprise circuitry configured to implement desired programming provided by appropriate media in at least one embodiment. For example, the processing circuitry  may be implemented as one or more of a processor, a controller, a plurality of processors and\/or other structure configured to execute executable instructions including, for example, software and\/or firmware instructions, and\/or hardware circuitry. Embodiments of processing circuitry  may include a general purpose processor(s), a digital signal processor (DSP), an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic component, discrete gate or transistor logic, discrete hardware components, or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but, in the alternative, the processor may be any conventional processor, controller, microcontroller, or state machine. A processor may also be implemented as a combination of computing components, e.g., a combination of a DSP and a microprocessor, a number of microprocessors, one or more microprocessors in conjunction with a DSP core, or any other such configuration. These examples of processing circuitry  are for illustration and other suitable configurations within the scope of the invention are also contemplated for use within the scope of the invention.","The storage media  is configured to store programming such as executable code or instructions (e.g., software, firmware, or a combination thereof), electronic data, databases, or other digital information and may include processor-usable media. A non-limiting example of a database may include information regarding a plurality of network traffic profiles relating to network communications in one or more monitored areas. A storage medium may be any available media that can be accessed by a general purpose or special purpose computer. By way of example and not limitation, a storage medium may comprise one or more devices for storing data, including read-only memory (ROM), random access memory (RAM), magnetic disk storage mediums, optical storage mediums, Flash memory devices, solid-state hard disk, other computer-readable mediums for storing information, and combinations thereof.","Processor-usable media may be embodied in any computer program product(s) or article(s) of manufacture that can contain, store, or maintain programming, data and\/or digital information for use by or in connection with an instruction execution system including processing circuitry in the exemplary embodiment. For example, suitable processor-usable media may include any one of physical media such as electronic, magnetic, optical, electromagnetic, infrared or semiconductor media. Some more specific examples of processor-usable media include, but are not limited to, a portable magnetic computer diskette, such as a floppy diskette, zip disk, hard drive, random access memory, read only memory, Flash memory, cache memory, and\/or other configurations capable of storing programming, data, or other digital information.","At least some embodiments described herein may be implemented using programming stored within appropriate storage media described above and\/or communicated via a network or other transmission media and configured to control appropriate processing circuitry. For example, programming may be provided via appropriate media including, for example, programming embodied within articles of manufacture, embodied within a data signal (e.g., modulated carrier wave, data packets, digital representations, etc.) communicated via an appropriate transmission medium, such as a communication network (e.g., the Internet, a private network, and combinations thereof), wired electrical connection, optical connection and\/or electromagnetic energy, for example, via a communications interface, or provided using other appropriate communication structure or medium. Programming including processor-usable code may be communicated as a data signal embodied in a carrier wave, in but one example.","Various wireless communication technologies implement wireless communications over a plurality of frequency channels (also referred to herein as \u201cdata channels\u201d) by employing a form of frequency hopping, wherein the wireless communications are transmitted by rapidly switching among the many frequency channels, using a pseudorandom sequence known to both the transmitting and receiving wireless devices. One example of such communication methods is found in conventional BLUETOOTH\u00ae wireless technology, which employs a method known as frequency-hopping spread spectrum (FHSS). In at least some embodiments, the receiver module  may be configured to monitor a plurality of frequency channels concurrently.  illustrates at least one embodiment of a receiver module  configured to capture wireless communications for devices configured to communicate over a plurality of frequency channels without handshaking with the communicating wireless devices. The receiver module  may comprise one or more data channel modules . The number of data channel modules  in the receiver module  may depend on the specific embodiment of the receiver module .","In some embodiments, the receiver module  may comprise one data channel module  configured to scan each frequency channel of the plurality of frequency channels at a rate substantially greater than the rate at which the wireless communications hop between the plurality of frequency channels. For example, such a receiver module  may scan the plurality of frequency channels at a rate sufficient to scan each data channel equal to the Nyquist rate, or two times the hopping frequency. For example, for BLUETOOTH\u00ae wireless technology, the wireless communications change data channels up to 1600 times per second. Thus, each data channel would be scanned at least 3200 times per second.","In other embodiments, the receiver module  may comprise a plurality of data channel modules . The plurality of data channel modules  may be configured so that each data channel module  may scan two or more frequency channels of the plurality of frequency channels. In such embodiments, when one data channel module  detects wireless communications on one of the frequency channels it is assigned to monitor, the one data channel module  may stop monitoring the assigned frequency channels to capture the detected wireless communication on the one frequency channel. While the one data channel module  is capturing the detected wireless communications on the one frequency channel, at least one other data channel module  may be assigned to monitor the other frequency channels assigned to the one data channel module  that the one data channel module  is unable to monitor. In still other embodiments, one receiver module  may be configured to scan each of the data channels, and to assign another data channel module  to capture wireless communications on a data channel when communications are detected.","In other embodiments, a data channel module  may be provided for each frequency channel used for a given communication technology. For example, current BLUETOOTH\u00ae wireless technology employs seventy-nine (79) frequency channels for wireless communications. Therefore, by way of example and not limitation, in some embodiments of a receiver module  configured to monitor BLUETOOTH\u00ae communications, the receiver module  may comprise seventy-nine individual data channel modules , each data channel module  being configured to detect and capture wireless communications for one frequency channel of the seventy-nine frequency channels.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 3","b":["210","210","310","320","330","310","310","310","310","310","320","340","350","360"]},"The logic module  may be implemented as software, firmware, hardware, and combinations thereof to perform at least a data formatting function in the data channel module . In some embodiments, the logic module  may comprise a buffer configured to at least temporarily store data received by the RF receiver . By way of example only, at least some embodiments of the logic module  may comprise a shift register configured to store bit data from the detected wireless communications and to output the stored bit data to some processing circuitry or storage media.","In other embodiments of a data channel module , one or more logic module  may be associated with a plurality of RF receivers  and may be assigned dynamically to a frequency channel as wireless communications are detected on one or more frequency channels. By way of example and not limitation, an RF receiver  of a data channel module  may scan one or more frequency channels and a logic module  may be assigned to a frequency channel when an RF receiver  detects a communication thereon.","Additional embodiments of the present invention comprise a system for monitoring multi-channel wireless communications.  illustrates a block diagram of a monitoring system  according to some embodiments comprising a monitoring device  having a plurality of data channel modules  and an external system , which may also be referred to herein as an external device. The monitoring device  may comprise embodiments of the monitoring device  described above including a receiver module , a system communication module , storage media  and processing circuitry . In some embodiments, the processing circuitry  and storage media  may comprise a conventional CPU and memory, referred to herein as CPU . The external system  may comprise a computational system comprising an input device, an output device, a processor device and a memory device. By way of example and not limitation, the external system  may comprise a conventional desktop or laptop computer. The external system  may be configured to communicate with the monitoring device  through the system communication module .","The operation of a monitoring system according to some embodiments of the invention is set forth with reference to . One or more wireless devices (not shown) may transmit a wireless communication employing a wireless technology utilizing frequency hopping on multiple frequency channels. An antenna  coupled to the monitoring device  may receive the signals relating to those wireless communications and provide the wireless communication signals to a receiver module  comprising a plurality of data channel modules . As described above, each data channel module  of the plurality of data channel modules  may be configured to receive wireless communication signals for at least one predetermined frequency channel. As the wireless communications hop between different frequency channels, different data channel modules  may be tuned to one or more respective frequency channels for receiving packets of the wireless communications on each frequency channel to which the wireless communications may hop. When the wireless communications hop to a frequency channel to which a specific data channel module  is tuned, that specific data channel module  captures the packet data of the packet transmission for the wireless communications. The data channel modules  may then extract the bit data from the wireless communications and communicate the bit data to the processing circuitry .","In the embodiments illustrated in , the data channel modules  are configured similar to the data channel module  of  comprising an RF receiver  coupled with a logic module . When a packet transmission is present on a specific frequency channel, the RF receiver  tuned or configured to scan that frequency channel detects an RSSI level change and indicates to the logic module  that the packet transmission is present on that frequency channel. For varying signal levels, there is typically a varying delay between occurrence of the signal related to the packet transmission and the generation of the RSSI level change. Accordingly, the data channel modules  or the CPU  or both may be configured to store sampled bit data of the packet transmission from a point in time previous to detection of the RSSI level change. In order to store bit data received at a point in time prior to detecting the RSSI level change, the data channel modules  are configured to continuously stream data being received by each data channel module .","Upon detection of the RSSI level change, the RF receiver  may be configured to generate timing information to the logic module . The timing information may comprise a clock signal generated by the RF receiver  and synchronized to the bit data received by the RF receiver . This timing information enables the logic module  to sample the received bit data at the proper time by syncing the clock signal with bits of the bit data. As the bit data is streamed from the RF receiver  to the logic module , the bit data is sampled and stored by the logic module . In some embodiments, the logic module  comprises a shift register or similar circuitry for serially storing the bit data and for providing serial or parallel output to the CPU .","The CPU  may be configured to receive the bit data comprising the packet transmissions from the data channel modules  and to organize the bit data according to one or more specific parameters. Because the bit data may be received asynchronously from the data channel modules , the data may not be in proper time sequence. Furthermore, because the plurality of data channel modules  may simultaneously receive any wireless communications on the respective frequency channels, the bit data streamed to the CPU  may relate to several different wireless communications between multiple devices. Therefore, the CPU , according to some embodiments, may be configured to order the bit data according to the transmission sequence, the transmitting device, the receiving device, and combinations thereof. This may be accomplished in the CPU  by analyzing the packet transmission to identify the portions of the bit data comprising the packet header and the packet information. The header may be analyzed by the CPU  to identify one or more parameters for grouping, ordering, or both. By way of example and not limitation, the CPU  may identify parameters such as the identification of the transmitting and receiving devices for grouping the packets into groups of related wireless communications, as well as the sequence number of the packet for ordering the packets into their proper transmission sequence.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 5","b":["420","420","510","520","530","540","550"]},"After one or more groups are formed, the bit data of at least one group may be ordered according to at least one ordering parameter. The at least one ordering parameter may be identified in the packet header . By way of example and not limitation, a parameter used for ordering the bit data comprising the packet transmissions may include the transmission sequence number found in the header. Thus, the bit data received on a plurality of data channel modules  may be ordered according to the transmission sequence. Upon identifying the ordering parameter, the bit data received from each data channel module  may be ordered according to the identified ordering parameter . In embodiments in which the bit data is both grouped and ordered, the packet data for each group may be ordered according to the identified ordering parameter. In other embodiments, the packet transmissions may only be grouped or ordered as described herein.","Returning to , the organized bit data may be communicated from the monitoring device  to the external system  for further analysis or processing. In some embodiments, the external system  may further comprise an application programming interface (API) configured to control the detection and monitoring processes of the monitoring device . In some embodiments, the external system  may request one or more of a number of preprocessing functions and configuration functions from the monitoring device . In some embodiments, such preprocessing functions and configuration functions may comprise specifying parameters for grouping the packets of the wireless communications, as well as requesting the monitoring device  to communicate only those packets appertaining to the specified group. By way of example and not limitation, the monitoring device  may be requested to perform one or more of the following functions: provide all packets from time tup to and including time t; provide all packets for a specific profile of the wireless technology (e.g., service discovery, cordless telephone, intercom, serial port, headset, fax, file transfer, and others); provide all packet communications between a specific master device and specific slave device(s); provide all inquiry message packets; provide all inquiry response packets; provide all page message packets; provide all page response packets; provide all Frequency Hop Synchronization packets; monitor specific wireless devices; monitor specific wireless profiles; as well as any permutation or combination of the above.","In a more specific example, and by way of example and not limitation, some embodiments of the monitoring system  may be configured to detect and capture BLUETOOTH\u00ae wireless communications. In some embodiments, such a monitoring device  may comprise a receiver module  having seventy-nine data channel modules . Each of the data channel modules  is configured to be tuned to one of the seventy-nine,  MHz-wide frequency channels in the 2.4 GHz band used by BLUETOOTH\u00ae wireless communications. In other embodiments, the receiver module  may comprise ten data channel modules , each data channel module  being configured to scan nine frequency channels, with one extra data channel module  to monitor a group of frequency channels when the respective data channel module  is unavailable. As set forth herein above, other configurations of data channel modules  may be employed.","As wireless communications between devices occurs, packets are transmitted on several of the frequency channels. For each data channel module  that is tuned to a frequency channel over which a packet transmission occurs, the bit data of the packet transmission is stored and communicated to the CPU . The CPU  may be configured to analyze the header information for each packet transmission received to group and\/or order the bit data. For example, in some configurations, the CPU  may analyze the header and group the packets according to the master device and the slave device(s). The CPU  may then order the packets according to the sequence number of each packet. The grouped and ordered packets comprising the wireless communications between wireless devices may then be communicated to the external system  for further analysis or processing.","Additional embodiments of the present invention comprise methods of monitoring wireless communications, and, more particularly, monitoring frequency-hopping wireless communications. According to at least one embodiment, wireless communications comprising a plurality of packet transmissions hopping between a plurality of frequency channels may be captured. The plurality of packet transmissions may be captured with at least one data channel module, as described above. The one or more data channel modules may be configured to concurrently monitor multiple frequency channels of the plurality of frequency channels, including concurrently monitoring each frequency channel of the plurality of frequency channels. The plurality of packet transmissions may be captured by detecting the presence of the packet transmissions with a data channel module and storing the bit data of the packet transmission in the data channel module. As discussed above, the detection of the packet transmissions may include detecting an RSSI level change with an RF receiver of the data channel module.","Upon capturing the plurality of packet transmissions, the packet transmissions may be organized according to at least one parameter. The at least one parameter may be identified from a portion of each packet transmission as discussed above and then grouping and\/or ordering the packet transmissions according to the identified parameter(s). As set forth herein above by way of example and not limitation, in some embodiments, the at least one parameter may comprise a transmission sequence, an identification of a transmitting device, an identification of a receiving device, a transmission time, a wireless technology profile, a device ID, and a transmission type.","While certain embodiments have been described and shown in the accompanying drawings, such embodiments are merely illustrative and not restrictive of the scope of the invention, and this invention is not limited to the specific constructions and arrangements shown and described, since various other additions and modifications to, and deletions from, the described embodiments will be apparent to one of ordinary skill in the art. Thus, the scope of the invention is only limited by the literal language, and legal equivalents, of the claims that follow."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
