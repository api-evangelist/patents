---
title: Methods and systems for designing electromagnetic wave filters and electromagnetic wave filters designed using same
abstract: Methods and systems for designing electromagnetic wave filters and electromagnetic wave filters designed using the methods and systems are disclosed. In one method, functions are selected whose linear combination define the surface of a filter for producing a desired phase-encoded image. Free parameter values are selected for the function and are varied. The values of the free parameters are observed with regard to an optimization function. Final values of the free parameters are selected based on the optimization function having a specific value or range of values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08254714&OS=08254714&RS=08254714
owner: Wake Forest University
number: 08254714
owner_city: Winston-Salem
owner_country: US
publication_date: 20040916
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","GOVERNMENT INTEREST","TECHNICAL FIELD","BACKGROUND ART","DISCLOSURE OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION","General Characterization of Imaging Systems","Strehl Ratio-Based Methods","Computer Modeling and Optical System Simulation","Computing the Design Parameters","Design Parameters for the Symmetric Phase Mask","Design Parameters for the Zernike Expansion Phase Mask","Restoring the Intermediate Image","Conclusions for Strehl-Ratio-Based Design Methods","Use of Symmetric Polynomials to Characterize Phase Masks","Fisher-Information-Based Optimization Methods","Computer Modeling and Image Restoration in the Presence of Spatially Varying Defocus","Comparison with Previously Described Degree-Three Mask","Pupil Phase Engineering (PPE) Based Control of Optical System Aberrations","Spherical Aberration and Pupil-Phase Engineering: Basics","Spherical Aberration and Pupil-Phase Engineering: Numerical Optimization","Restoration of Phase-Encoded Iris Images in the Presence of Spherical Aberration","Conclusions for FI and Minimax Optimizations"],"p":["This application claims the benefit of U.S. Provisional Patent Application Ser. No. 60\/503,536, filed Sep. 16, 2003, the disclosure of which is incorporated herein by reference in its entirety.","This invention was made with Government support under Grant Nos. F49620-01-1-0321 and F49620-02-1-0107 awarded by the Air Force Office of Scientific Research (AFOSR) and DAAD19-00-1-0540 awarded by the Army Research Office (ARO). The U.S. Government has certain rights in the invention.","The present invention relates to methods and systems for designing electromagnetic wave filters. More particularly, the present invention relates to methods and systems for designing electromagnetic wave filters that alter the phase of electromagnetic waves being collected by an image acquisition system so that an original image can be restored using standard restoration algorithms.","In image acquisition systems, desired system performance can be achieved by optimizing one or more design parameters. One particular parameter that it may be desirable to optimize in some image acquisition systems is depth of focus. The depth of focus of an image acquisition system is the range of distances in object space in which objects are considered to be in focus. In some image acquisition systems, such as those used for surveillance and biometric identification, it is important that the image acquisition system be capable of producing clear images of objects located at different distances from the image plane. However, conventional image acquisition systems have limited depth of focus. As a result, only objects at a fixed predetermined distance from the lens will appear in focus.","One method improving the depth of focus is to reduce the size of the lens aperture. However, reducing the lens aperture size reduces flux collected by the imaging system and increases distortion in the final image caused by diffraction.","Another method for improving depth of focus of the image acquisition system is to provide a lens that moves relative to the image plane and thereby mechanically increases the depth of focus. However, mechanically focusing an image acquisition system using moving parts may be undesirable in surveillance systems because the motion or the sound made by the moving parts may be detected by the party under surveillance. In addition, the mechanical parts used to move the lens and\/or the image plane are subject to wear and may increase the overall cost of the image acquisition system. Another problem with image acquisition systems that use moving parts to focus on objects at different distances is that they are incapable of simultaneously capturing in-focus images of objects at different distances from the lens.","In light of the difficulties associated with conventional image acquisition systems, wavefront encoding methods have been developed to reduce the spatially varying blur in an acquired image caused by objects being located at different depths. Current wavefront encoding methods involve placing a cubic phase mask in front of the lens to alter the phase of incident light based a weighting factor and the cube of the x and y coordinates of each point. The mathematical expression for the phase variation produced by one common cubic mask is as follows:\n\n\u03a6()=(),\u2003\u2003(1)\n\nwhere \u03a6(x,y) is the amount of phase variation applied by the cubic mask to each point (x,y) in the point in the image plane, x and y are the Cartesian coordinates of each point in the image plane, with (0,0) being the center of the image plane, and a is the weighting factor or strength of the mask.\n",{"@attributes":{"id":"p-0009","num":"0008"},"figref":["FIG. 1A","FIG. 1A","FIG. 1B","FIG. 1B","FIG. 1C","FIG. 1B","FIG. 1C","FIGS. 1A-1C"]},"While cubic masks reduce the spatial variance in defocus caused by objects being located at different distances, simulations have shown that cubic masks can produce artifacts in the restored images, such as stripe patterns or bright streaks, which bear no resemblance to the true object being imaged. Another problem associated with cubic masks is that iterative optimization methods described herein have used cubic masks as a basis function and did not converge to the cubic mask as the optimal result. If the cubic mask were the optimal solution, the iterative optimization process would converge to the cubic mask as its solution. Thus, depending on the optimization method being used, cubic masks are not the optimal choice for phase encoding of an incident image so that an image of the original object can be produced from the phase-encoded image.","Yet another problem with phase encoding in general is that there has been no well-defined methodology for optimizing phase variation in the image plane using basis functions with multiple free parameters. For example, if a cubic phase mask is utilized, the only parameter to be selected is the weighting parameter a. Using a cubic phase mask with a single free parameter oversimplifies the filter design problem and can result in suboptimal phase masks.","Accordingly, in light of these difficulties associated with conventional phase masks and methods for designing such masks, there exists a long felt need for improved methods and systems for designing electromagnetic wave filters and for filters designed using the methods and systems.","Methods and systems for designing electromagnetic wave filters, also referred to as phase masks, result in a phase mask that produces a phase-encoded image capable of being restored into a viewable or machine-readable image according to user specifications. According to one method for designing a phase mask, the phase mask is characterized using a predetermined set of functions whose linear combination describes the shape of the phase mask. In one implementation, Zernike polynomials are used to characterize the shape of the phase mask. In an alternate implementation, symmetric polynomials are used to characterize the shape of the phase mask.","Once the polynomials have been selected, a plurality of free parameters associated with the set of functions is chosen. Values of the free parameters are varied and a relationship between the values of the free parameters and a predetermined optimization function are observed. In one implementation, the optimization function includes derivatives of the Strehl ratio with regard to a defocus parameter. In an alternate implementation, the optimization function is based on Fisher information. In yet another implementation, the optimization function is a min-max function. Based on the observations, sets of parameter values are chosen for the electromagnetic wave filter based on the optimization function having a predetermined value or range of values.","Once the parameter values for the optimization function have been selected, an electromagnetic wave filter whose surface corresponds to the set of functions with the selected parameter values can be produced. The electromagnetic wave filter can then be placed in an optical system and used to encode images and produce an intermediate image. If the parameter being optimized is depth of focus, the intermediate image will have nearly uniform blur or defocus across all points in the image plane. As a result, standard restoration algorithms can be used to restore the original image.","Because the electromagnetic wave filter design methods described herein use multiple free parameters in characterizing the filter shape, phase variation in the resulting image can be finely tuned according to user specifications.","The methods and systems described herein for designing electromagnetic wave filters can be implemented in hardware, software, firmware, or any combination thereof. Thus, a method for designing an electromagnetic wave filter may be implemented using computer executable instructions embodied in a computer-readable medium. Exemplary computer-readable media suitable for use with embodiments of the present invention include storage devices, such as disk storage devices and chip memory devices, as well as downloadable electrical signals.","Accordingly, it is an object of the invention to provide methods and systems for designing electromagnetic wave filters that minimize spatially varying blur in an intermediate image.","It is another object of the invention to provide a method for designing an electromagnetic wave filter that allows values of a plurality of free parameters to be varied in selecting the optimal filter design.","Some of the objects of the invention having been stated hereinabove, other objects will become evident as the description proceeds when taken in connection with the accompanying drawings as best described hereinbelow.","As stated above, the present invention includes methods and systems for designing electromagnetic wave filters for image acquisition systems.  illustrates an exemplary image acquisition system in which electromagnetic wave filters designed using the methods and systems described herein may be utilized. Referring to , an image acquisition system  includes a lens , a phase mask , a detector , and a restoration algorithm . Lens  may be any suitable lens selected according to the type of image being acquired. Phase mask  may be designed using the methods and systems described herein using functions whose linear combination describes the shape of phase mask  and varying free parameter values such that an optimization function has a predetermined value. In one exemplary implementation where it is desirable to optimize depth of focus, phase mask  may be selected to reduce spatially varying defocus in blurred image  of object  such that restoration algorithm  can produce a final image  where objects at different distances appear in focus. Restoration algorithm  may be any suitable image restoration algorithm for producing a clear image from a uniformly blurred image. In one exemplary implementation, restoration algorithm  may include a Wiener filter.",{"@attributes":{"id":"p-0063","num":"0062"},"figref":["FIG. 3","FIG. 3"],"b":["300","302"]},"In step , the parameter values are varied and a relationship between the parameter values and an optimization function is observed. In one exemplary implementation, the optimization function comprises derivatives of the Strehl ratio with regard to a defocus parameter. The Strehl ratio is defined as the ratio of on-access intensity given a particular phase mask characterized by the equations and a particular set of values for the free parameters and on-access intensity assuming a diffraction-limited image acquisition system. The rates of change of the Strehl ratio with regard to the defocus parameter (represented by first and higher-order derivatives of the Strehl ratio with regard to defocus) reflect how defocus changes for objects located at different depths. Thus, it is desirable to minimize these derivatives so that the intermediate image has reduced spatially varying defocus.","In addition to minimizing the derivatives of the Strehl ratio, it may be desirable to ensure that the Strehl ratio itself has at least a predetermined value, even when the derivatives are minimized, to ensure that there is sufficient information in the intermediate image to allow restoration of the final image. For example, gray clouds in the sky form a phase mask that produces an image with spatially invariant defocus. That is, if a manually focusing camera is used to obtain images of a gray sky with the focus adjustment on the camera set at different depths, the acquired image will be the same for all depths. Thus, a gray sky functions as a nearly perfect phase mask with regard to depth of focus. However, original information regarding images in the sky is lost. For example, an image of the sun or an airplane flying above the clouds is incapable of being restored in the final image, despite the spatially invariant depth of focus. In order to avoid this difficulty, a penalty function may be used to ensure that the Strehl ratio is at least a predetermined value. The penalty function and its relationship to the Strehl ratio will be described in detail below.","In an alternate implementation, the optimization function may be selected based on Fisher information. Like the Strehl-ratio-based methods, the methods that use Fisher information include measuring the sensitivity of the optimization function with regard to a defocus parameter. Penalty functions may also be used to ensure that sufficient information remains in the intermediate image to allow restoration of the final image.","In yet another implementation, a min-max function may be used as the optimization function. The min-max function has proved to be particularly useful in removing spherical aberrations from the final image. Methods for using the min-max function as the optimization function will be described in detail below.","Returning to , in step , a set of parameter values is selected so that the optimization function has a predetermined value or range of values. As discussed above, it may be desirable to select the parameter values such that the Strehl ratio, the derivatives of the Strehl ratio, the Fisher information, or the min-max function has a predetermined value or range of values. In step , a filter is created corresponding to the set of functions and the set of parameter values. Since the set of parameter values and the set of functions describe the desired phase variation, and phase variation corresponds to lens shape, phase masks can be created using standard optical element manufacturing techniques. In one implementation, the phase mask may be created using an electromagnetic-radiation-translucent material, such as glass, whose thickness corresponds to the desired phase variation. In an alternate implementation, a liquid crystal spatial light modulator can be used to generate the spatially varying index of refraction required for the phase mask. In yet another implementation, a deformed or deformable mirror may be used to create the desired spatial variations in the phase mask.","A well-designed incoherent imaging system can be treated as a linear shift-invariant system. The image plane intensity can be expressed in terms of a convolution given by\n\n()=()*()+\u03b7(),\u2003\u2003(2)\n\nwhere * denotes convolution, I(x, y) represents the observed two-dimensional image intensity distribution, O(x, y) the unknown true object intensity distribution, h(x, y) the intensity point spread function (PSF), and \u03b7(x, y) represents noise in the system. The point spread function represents the amount by which a photon from the object spreads out in the image. The PSF is governed by the aberrations, including defocus errors, and the geometry of the pupil aperture (V. N. Mahajan, , SPIE Press, 2001). Letting H=F(h) denote the complex 2-D Fourier transform of the PSF h=h(x, y), H can be written as\n\n\u2003\u2003(3)\n\nHere H is the optical transfer function (OTF), its modulus |H| is the modulation transfer function (MTF) and \u03c8 is its phase. In order to make the final image insensitive to varying degrees of defocus, a phase mask must be selected such that the PSF and also the optical transfer function are the same for different points in the image, despite spatially varying defocus.\n","As described above, one approach for extending the depth of field is based on managing the Strehl ratio as a function of the field defocus, accomplished by aberration balancing. The Strehl ratio (SR) is defined as the ratio of the on-axis intensity (generally, although not always, the peak intensity) with a nontrivial pupil phase and that without any pupil phase. As used herein, the term \u201cpupil phase\u201d refers to the phase variation introduced by the phase mask in the image plane (also referred to herein as the pupil plane). The pupil phase can be expressed as \u03c6({right arrow over (p)};\u03b4)\u2261(r,\u03b8;\u03b4), where \u03b4 represents the defocus parameter. By applying the Fresnel propagation formulas to the imaging problem of interest here, the Strehl ratio can be reduced to a ratio of pupil integrals in polar coordinates (V. N. Mahajan, , SPIE Press, 2001),",{"@attributes":{"id":"p-0071","num":"0070"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03b4"}},"mo":"=","mfrac":{"msup":[{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msubsup":{"mo":"\u222b","mn":"0","mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"}},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"z"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mrow":[{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["r","\u03b8"],"mo":","}}},{"mi":"exp","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03d5","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"r","mo":",","mrow":{"mi":["\u03b8","\u03b4"],"mo":";"}}}}}}},{"mo":"\u2146","mi":"r"},{"mo":"\u2146","mi":"\u03b8"}],"mo":["\u2062","\u2062","\u2062","\u2062"],"mi":"r"}}}},"mn":"2"},{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msubsup":{"mo":"\u222b","mn":"0","mrow":{"mn":"2","mo":"\u2062","mi":"\u03c0"}},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mn":"0","mi":"z"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mrow":[{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["r","\u03b8"],"mo":","}}},{"mo":"\u2146","mi":"r"},{"mo":"\u2146","mi":"\u03b8"}],"mo":["\u2062","\u2062","\u2062"],"mi":"r"}}}},"mn":"2"}]}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]}}}},"br":[{},{},{}],"sup":["2","2"],"in-line-formulae":[{},{}],"i":["i","r"]},"Expressing the exponential in terms of trigonometric functions, the Strehl ratio can be rewritten as\n\n\u03c7(\u03b4)=\u2261<cos \u03c6(,\u03b8;\u03b4)> and \u2261<sin \u03c6(,\u03b8;\u03b4)>.\u2003\u2003(6)\n","As described above, designing a filter according to the methods described herein involves selecting a set of functions whose linear combination described the shape of the filter. Since the shape of the filter corresponds to the desired phase variation in the pupil plane, the set of functions may be selected to describe the phase as a function of defocus and location in the pupil plane. In the material to follow a variety of parameterizations of the phase is considered. One parameterization uses Zernike polynomials (V. N. Mahajan, , SPIE Press, 2001 and Roggeman et al., , CRC Press, 1996), which describe departures from a constant pupil phase that would lead to perfect (diffraction-limited) imagery. These polynomials have interesting and useful properties: they form a complete set, they are readily separated into radial and angular functions, and the individual polynomials are orthogonal over the (entire) unit circle, see, e.g., (Roggeman et al., , CRC Press, 1996). They can be used to build error or metric functions, and linear combinations of them can be used to specify aspheric surfaces for wavefront phase encoding in order to balance aberrations (B. Walker, , SPIE Press, 1997).","The Zernike polynomials used herein for the defocus problem, as well as their corresponding aberration names, are listed here for completeness:",{"@attributes":{"id":"p-0075","num":"0074"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"14pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Z(r, \u03b8) = {square root over (3)}(2r\u2212 1)","defocus","(7)"]},{"entry":[{},"Z(r, \u03b8) = {square root over (6)}rsin 2\u03b8","astigmatism, 45\u00b0"]},{"entry":[{},"Z(r, \u03b8) = {square root over (6)}rcos 2\u03b8","astigmatism, 0\u00b0"]},{"entry":[{},"Z(r, \u03b8) = {square root over (8)}(3r\u2212 2r) sin \u03b8","coma, x-direction"]},{"entry":[{},"Z(r, \u03b8) = {square root over (8)}(3r\u2212 2r) cos \u03b8","coma, y-direction"]},{"entry":[{},"Z(r, \u03b8) = {square root over (8)}rsin 3\u03b8","field curvature, 30\u00b0"]},{"entry":[{},"Z(r, \u03b8) = {square root over (8)}rcos 3\u03b8","field curvature, 0\u00b0"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"The pupil-phase polynomial used herein includes a quadratic defocus term, represented by the Zernike polynomial Z(r, \u03b8), and certain higher-order phase terms introduced deliberately via a phase mask. The effects of some specific forms of these additional phase terms on the defocus term, including the standard cubic phase mask given by Equation (1) are examined. For example, the choice of the weighting, or strength, parameter a in order to approximately maximize the resulting optical system Strehl ratio is examined. Extending this approach another step leads to a symmetric form of the mask, namely a simple symmetrical set involving two cubic polynomials,\n\n\u03c6()=\u03b4()+()+(),\u2003\u2003(8)\n\nwhere x=r cos \u03b8 and y=r sin \u03b8, and \u03b4Z(r,\u03b8) is the same as \u03b4rapart from an unimportant scaling factor and an additive phase term.\n","Alternatively, the phase can be parameterized by a collection of N higher-order Zernike polynomials,",{"@attributes":{"id":"p-0078","num":"0077"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"\u03d5","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"z","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["r","\u03b8","\u03b4"],"mo":[",",",",","],"mover":{"mi":"u","mo":"\u2192"}}}}},{"mrow":[{"mi":"\u03b4","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":"Z","mn":"4"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["r","\u03b8"],"mo":","}}}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"i","mo":"=","mn":"5"},{"mi":"N","mo":"+","mn":"4"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["u","i"]},"mo":"\u2062","mrow":{"mrow":{"msub":{"mi":["Z","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["r","\u03b8"],"mo":","}}},"mo":"."}}}],"mo":"+"}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"9"}}]}}}}},"As described above, one step in designing a phase mask is selecting free parameter values to be varied. The set of coefficients u, i=5, . . . , N+4, (or a, b for the symmetric form of the pupil-phase) are chosen to solve an optimization problem that guarantees that the phase-encoded, blurred image has minimum sensitivity to defocus errors, subject to certain sensitivity-related constraints.","In one exemplary implementation, the coefficient values can be selected by requiring that the Strehl ratio \u03c7(\u03b4), when expanded in a power series in \u03b4, differs from its in-focus value \u03c7(0) at most by terms of order O(\u03b4) and higher. By choosing N to be sufficiently large, \u03c7(\u03b4), an important radiometric measure of image fidelity, can thus be rendered relatively insensitive to changes of defocus around its zero value. The depth of focus can be greatly increased in this way, the more so the larger the value of N.","To implement this method, the first N derivatives of \u03c7(\u03b4) are set to 0 at \u03b4=0. For the symmetrical set of two cubic polynomials given by \u03c6s in Equation (8), all odd order derivatives of the Strehl ratio \u03c7(\u03b4) are identically zero at \u03b4=0, due to certain symmetry properties of the resulting integrals in Equation (4). This is not the case for \u03c6z, however. For the phase mask characterized by Equation (9) the second and fourth order derivatives are set to zero.","In general, the derivatives can be taken by means of the Leibnitz rule for arbitrary-order derivatives of a product of two functions. Use of Equation (6) leads to the following nth order derivative of \u03c7(\u03b4) at \u03b4=0:",{"@attributes":{"id":"p-0083","num":"0082"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mrow":[{"mfrac":{"mrow":[{"msup":{"mo":"\u2202","mi":"n"},"mo":"\u2062","mi":"\u03c7"},{"mo":"\u2202","msup":{"mi":["\u03b4","n"]}}]},"mo":"\uf604"},{"mi":"\u03b4","mo":"=","mn":"0"}]},"mo":"=","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"0"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"n"}},{"mtd":{"mi":"k"}}]}},{"mrow":[{"msup":[{"mi":"C","mrow":{"mo":["(",")"],"mi":"k"}},{"mi":"C","mrow":{"mo":["(",")"],"mrow":{"mi":["n","k"],"mo":"-"}}}],"mo":"\u2062"},{"msup":[{"mi":"S","mrow":{"mo":["(",")"],"mi":"k"}},{"mi":"S","mrow":{"mo":["(",")"],"mrow":{"mi":["n","k"],"mo":"-"}}}],"mo":"\u2062"}],"mo":"+"}],"mo":["[","]"]}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"10"}}]}}}},"br":{}},{"@attributes":{"id":"p-0084","num":"0083"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mo":"\u2062","mrow":{"mo":"\u2003","mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"n"}},{"mtd":{"mi":"k"}}]}}}}}},"br":{}},"Because of the trigonometric forms of the functions C and S, the linearity of the phase in Equation (10) in its coefficients, and the commutativity of the differentiation and pupil averaging operators, the required derivatives of C and S can be expressed by the formulas\n\n=(\u22121)(()cos \u03c6(0)),\n\n=(\u22121)+1(+1()sin \u03c6(0)),\n\n=(\u22121)(()sin \u03c6(0)),\n\n=(\u22121)(+1()cos \u03c6(0)).\u2003\u2003(11)\n","A similar consideration applies when the symmetrical pupil phase in Equation (8) is used instead, the only difference being that no more than two derivatives of the SR are forced to 0 by properly choosing the two unknown parameters a, b. One may thus regard N as being equal to 2 in this case, without loss of generality.","Setting Equation (10) to 0 for n=1, . . . ,N, or n=2 and 4 for the case of Equation (8), which can be ignored at present for the sake of simplicity, results in the following N equations can be used to find the needed values of the N coefficients in {right arrow over (u)}:",{"@attributes":{"id":"p-0088","num":"0087"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"msub":{"mi":["F","n"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"\u2192"}}},{"mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"0"},"mi":"n"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":[{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mi":"n"}},{"mtd":{"mi":"k"}}]}},{"mrow":[{"msup":[{"mi":"C","mrow":{"mo":["(",")"],"mi":"k"}},{"mi":"C","mrow":{"mo":["(",")"],"mrow":{"mi":["n","k"],"mo":"-"}}}],"mo":"\u2062"},{"msup":[{"mi":"S","mrow":{"mo":["(",")"],"mi":"k"}},{"mi":"S","mrow":{"mo":["(",")"],"mrow":{"mi":["n","k"],"mo":"-"}}}],"mo":"\u2062"}],"mo":"+"}],"mo":["[","]"]}},"mo":"=","mn":"0"}],"mo":"="},{"mi":"n","mo":"=","mn":"1"},{"mi":"N","mo":"."}],"mo":[",",",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}}},{"mrow":{"mo":["(",")"],"mn":"12"}}]}}}}},"Here {right arrow over (u)} is the vector of unknown design parameters.","Before Equation (12) can be solved numerically, additional optimization criteria must be utilized to exclude trivial solutions. Without further constraints, the problem has multiple families of undesirable trivial solutions, namely those in which one or more of the design parameters are infinitely large. The vanishing SR that results from such coefficient values trivially has vanishing derivatives relative to the defocus parameter \u03b4 to all orders, but that is hardly of any physical interest.","In view of this difficulty, additional constraints can be imposed that tend to reject solutions that depress the SR to such small values that the blurred signal cannot be distinguished from noise. One approach is to minimize the norm squared of the vector expression\n\n()=[(), (), . . . , (\u2003\u2003(13)\n\nplus a penalty term that constrains the parameter components {right arrow over (u)} from becoming too large, and a second penalty term which constrains the Strehl ratio from becoming too small. A nonlinear optimization method can then be used to solve\n",{"@attributes":{"id":"p-0092","num":"0091"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"munder":{"mi":"min","mover":{"mi":"u","mo":"\u2192"}},"mo":"\u2062","mrow":{"mrow":{"mo":["{","}"],"mrow":{"msup":{"mrow":{"mo":["\uf605","\uf606"],"mrow":{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"\u2192"}}}},"mn":"2"},"mo":["+","+"],"mrow":[{"mi":"\u03b3","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"J","mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"\u2192"}}}},{"msub":{"mi":["J","\u03c7"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"\u2192"}}}]}},"mo":"."}}},{"mrow":{"mo":["(",")"],"mn":"14"}}]}}}},"br":{},"sub":"2","sup":"2"},{"@attributes":{"id":"p-0093","num":"0092"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["J","\u03c7"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"\u2192"}}},{"mrow":[{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mover":{"mi":"u","mo":"\u2192"}}}}}}},{"mo":["[","]"],"mrow":{"mn":"1","mo":"-","mfrac":{"mn":"1","mrow":{"mn":"1","mo":"+","msup":{"mi":"e","mrow":{"mo":"-","mrow":{"mi":"c","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mover":{"mi":"u","mo":"\u2192"}}}},"mo":"\u2062","mover":{"mi":"\u03c7","mo":"^"}}}}}}}}}}],"mo":"\u2061"}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"15"}}]}}}},"br":{}},"The factor",{"@attributes":{"id":"p-0095","num":"0094"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mn":"1","mo":"-","mfrac":{"mn":"1","mrow":{"mn":"1","mo":"+","msup":{"mi":"e","mrow":{"mo":"-","mrow":{"mi":"c","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mover":{"mi":"u","mo":"\u2192"}}}},"mo":"-","mover":{"mi":"\u03c7","mo":"^"}}}}}}}}}},{"mrow":{"mo":["(",")"],"mn":"16"}}]}}}},"br":{}},{"@attributes":{"id":"p-0096","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mfrac":{"mn":["1","2"]}}},"br":{},"b":"1"},"Filter designs numerically computer and described below are evaluated using computer simulation software. The simulator models a parabolic cone-shaped object surrounded by a set of wings arranged in a spiral at equal angles and linearly progressive distances away from a reference plane coincident with the center point. The central point is visually nearest to the observer, while the wings spiral away from the observer in the counter-clockwise direction.  illustrates the parabolic, cone-shaped object.",{"@attributes":{"id":"p-0098","num":"0097"},"figref":["FIG. 4B","FIG. 4A","FIG. 4B"]},"The electromagnetic wave filters described herein are simulated by adding a chosen fixed pupil phase function to the defocus phase at each point in the image. The result of adding the pupil phase function to the defocus phase at each point is an image with nearly spatially constant blur or defocus. Examples of images with spatially constant blur or defocus will be described in detail below.","In the following two sections, the defocus aberration is balanced by using the phase representations given in Equations (8) and (9).","A pupil phase design with a single design parameter will first be explored, leading to the two-parameter representation given in Equation (8). The following representations will be considered for Equation (8):\n\n\u03c6(\u03b4)=\u03b4()+()\u2003\u2003(17)\n\n\u03c6(\u03b4)=\u03b4()+().\u2003\u2003(18)\n\nThe numerical problem is to find a solution u to the nonlinear equation,\n",{"@attributes":{"id":"p-0102","num":"0101"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mrow":[{"mrow":{"mrow":{"msub":{"mi":"F","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},"mo":"=","mfrac":{"mrow":[{"msup":{"mo":"\u2202","mn":"2"},"mo":"\u2062","mi":"\u03c7"},{"mo":"\u2202","msup":{"mi":"\u03b4","mn":"2"}}]}},"mo":"\uf604"},{"mi":"\u03b4","mo":"=","mn":"0"}]},"mo":"=","mn":"0"},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"19"}}]}}}},"br":{},"sub":["c","d"]},{"@attributes":{"id":"p-0103","num":"0102"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"mfrac":{"mrow":[{"mo":"\u2202","mi":"\u03c7"},{"mo":"\u2202","mi":"\u03b4"}]},"mo":"\u2062","msub":{"mo":"|","mrow":{"mi":"\u03b4","mo":"=","mn":"0"}}},"mo":"=","mn":"0"}}},"br":{},"sub":["c ","d"]},{"@attributes":{"id":"p-0104","num":"0103"},"figref":"FIGS. 5A and 5B","sub":["2","2","2"],"i":"Applied Optics"},"It can also be observed empirically from  that F(u) approaches zero as the magnitude of u increases. In particular, solutions to the problem can be taken as values of u which are not necessarily at the roots but large enough so that F(u)\u2248. For example for the cubic representation given in Equation (17) a value of a=20 results in |F(a)|\u22480.01 with an acceptable Strehl ratio of 0.012.","The two-parameter pupil-phase design problem using \u03c6s as given in Equation (8) will now be considered. In solving the equation, the second and fourth derivatives of the Strehl ratio, \u03c7, were considered, since the odd derivatives are zero for arbitrary a and b. The numerical problem is to find a solution u=(a, b) to the nonlinear system,\n\n()=0()=0\u2003\u2003(20)\n\nA root finding procedure was used to obtain solutions to Equation (20) from a grid of initial approximations about the origin of the a-b plane. A large number of solutions were obtained.  respectively illustrate the simulated blurred and noisy image (SNR=64), the PSF, and the restored image for one of the particular solutions found. The design parameters computed are a=22.0808 and b=\u22126.46691. The second and fourth derivatives of the Strehl ratio at \u03b4=0 for these values are F(0)=\u22122.10866E-7, and F(0)=2.3603E-6.\n","A pupil-phase design problem in which the pupil-phase encoding function \u03c6z(r, \u03b8, \u03b4, {right arrow over (u)}) is given by a linear combination of Zernike polynomials as described by Equation (9) will now be considered. In this example, encoding functions in the space of polynomials spanned by six Zernike polynomials Z, Z, . . . , Z(see Equation (7)) are considered. This set includes all Zernike polynomials of total degree two, and of total degree three, excluding the Zernike polynomial Z, which represents defocus. Lower degree Zernike polynomials, which correspond to tip, tilt and piston, are also excluded. While pupil-phase functions of higher polynomial degree are of interest, they lead to computationally challenging optimization problems. An example of a pupil phase function of total degree five will be described in detail below.","Instead of a direct root finding approach, the problem can be formulated as a non-linear optimization problem. Referring to Equations (12) and (15), the optimization problem is given by:",{"@attributes":{"id":"p-0109","num":"0108"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mover":{"mi":"u","mo":"^"},"mo":"=","mrow":{"mi":"arg","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"munder":{"mi":"min","mover":{"mi":"u","mo":"->"}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"msub":{"mi":["J","z"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"->"}}}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"21"}}]}}}},"br":{}},{"@attributes":{"id":"p-0110","num":"0109"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["J","z"]},"mo":"\u2062","mover":{"mrow":{"mo":["(",")"],"mi":"u"},"mo":"\u27f6"}},{"mrow":[{"munderover":{"mo":"\u2211","mrow":{"mi":"n","mo":"=","mn":"1"},"mn":"6"},"mo":"\u2062","msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["F","n"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"u","mo":"->"}}}},"mn":"2"}},{"mi":"\u03b3","mo":"\u2062","msup":{"mrow":{"mo":["\uf605","\uf606"],"mover":{"mi":"u","mo":"->"}},"mn":"2"}},{"mrow":[{"mi":"M","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mn":"1","mo":"-","mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mover":{"mi":"u","mo":"->"}}}}}}},{"mo":["[","]"],"mrow":{"mn":"1","mo":"-","mfrac":{"mn":"1","mrow":{"mn":"1","mo":"+","msup":{"mi":"\u2147","mrow":{"mo":"-","mrow":{"mi":"c","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mover":{"mi":"u","mo":"->"}}}},"mo":"-","mover":{"mi":"\u03c7","mo":"^"}}}}}}}}}}],"mo":"\u2061"}],"mo":["+","+"]}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"22"}}]}}}},"br":{},"sub":"n"},"The objective function Jis highly oscillatory with numerous local minima. Computational tests with a variety of starting values suggest that there are a very large number of pupil-phase encoding functions that can be used to produce good extended depth of focus results. Local minima of the objective function are found using an implementation of the Levenberg-Marquardt algorithm from the minpack software in Netlib (see www.netlib.org). Numerical evaluation of the non-elementary integrals (see Equation (11)) is performed by an adaptive quadrature routine, as described by A. C. Genz, Washington State University, also available in Netlib.","Several filters which exhibit distinctively different point spread functions will now be described. The restorations shown in , C, and C correspond to a signal to noise ratio equal to 64. In these examples, signal to noise ratio for an n-pixel image refers to the total signal divided by n\u03c3, where \u03c3 is the standard deviation for zero mean, Gaussian noise.  respectively illustrate a phase-encoded image, the point spread function, and a restored image corresponding to the coefficient vector {right arrow over (u)}listed below. In , it can be seen that blur in the image is nearly uniform for all points. In , the point spread function illustrates that a photon in the original object is likely to spread from the center to the lower left hand quadrant of the image. In , the arms of the spiral in the restored image are nearly in focus.","The first group of filters, illustrated in  may fairly be called \u201ccubic-like\u201d filters. These point spread functions are typically \u201cL\u201d shaped, similar in appearance to the point spread function for the cubic the cubic filter, but rotated and skewed, i.e., the two characteristic \u201cbranches\u201d of the PSF are not at an angle of \u03c0\/2. For the filter shown in \n\n=[\u22120.007581, 0.1349, \u22123.707, 3.512, 0.5899, 0.7914].\u2003\u2003(23)\n\nThe components of the vector F({right arrow over (u)}) (see Equations (10), (11), (12), and (13)) are\n\n()=[\u22128.109\u00d710, 0.001041, 0.0002009, \u22120.001792, \u22120.001120, 0.02940].\u2003\u2003(24)\n","A second type of filter is closely related to the Zernike polynomials Zand Z. These filters exhibit a characteristic curved triangle shaped PSF. The PSF tends to cluster a significant amount of energy near the peak, and thus tends to produce reasonable restorations in the presence of noise. The effect of the filter on the spatially varying defocus can be clearly seen in the blurred image in : the \u201cwings\u201d of the object appear blurred in nearly the same manner. Thus, it is reasonable to expect that a spatially invariant restoration method (e.g. regularized Wiener filtering) can produce a restored image with excellent invariance to defocus. A moderate amount of geometric distortion is observed for filters of this type. It should be noted that the standard cubic filter also causes some geometric distortion.  illustrate one such filter with\n\n=[0, 8.453, 0, 0, 0, 8.453].\u2003\u2003(25)\n\nThe components of the vector F({right arrow over (u)}) (see Equations (10), (11), (12) and (13)) are\n\n()=[\u22120.00529, 0.00532, 0.00581, \u22120.0195, 0.00914, 0.303].\u2003\u2003(26)\n\nThe PSF in  is similar to the PSF shown in .\n","A third type of filter, illustrated in  and , has a point spread function distinctly different from either of the filters in  and A-C. This filter is one of the more interesting filters discovered using the design methodology described herein. It exhibits very good invariance to defocus, low geometric distortion and good restorability as the noise level is increased. The simulation illustrated in  was computed using an extended region of support to accommodate the extent of the PSF in this example. The resulting extended images were cropped so that they appear in the same scale as the corresponding images in  and A-C. The filter shown in  and  corresponds to the values\n\n=[4.070, \u22122.757, 7.921, \u22126.459, \u22127.248, 7.549]\u2003\u2003(27)\n\nThe components of the vector F({right arrow over (u)}) (see Equations (10), (11), (12) and (13)) are\n\n()=[1.422E-04, \u22126.070E-04, 9.924E-05, \u22125.058E-06, 8.704E-06, 6.435E-06].\u2003\u2003(28)\n","As illustrated in , the point spread function for the filter defined by the coefficients of Equation (27) and the polynomial of Equation (9) has a double-v shape. This point spread function is believed to evince a novel filter design regardless of the design method used to create the filter, as point spread functions for cubic masks appear as centralized \u201cblobs.\u201d Thus, a phase mask having a double-v point spread function is one aspect of the present invention.","To date, researchers have emphasized direct linear methods to restore wavefront coded images (Bradburn et al., \u201cRealizations of focus invariance in optical-digital systems with wavefront coding,\u201d 26, pp. 9157-9166,1997 and Dowski et al., \u201cExtended depth of field through wavefront coding,\u201d 34, pp. 1859-1866, 1995) because of good computational efficiency that allows for real-time restoration. In many applications, real-time results are essential and direct methods are used. In some applications, direct linear methods should be used to identify regions of interest in real-time and more computationally intensive iterative algorithms could be subsequently applied in an attempt to improve restoration fidelity (Nagy et al., \u201cSpace-varying restoration of optical images,\u201d ., Vol. 14, pp. 3162-3174, 1997). A preliminary study of iterative restoration of wavefront coded imagery for focus invariance has recently been given in (van der Gracht et al., \u201cIterative restoration of wavefront coded imagery for focus invariance,\u201d in (), , OSA Technical Digest, Washington, D.C., 2001). They have found that nonlinear iterative methods perform better than linear methods for restoring the intermediate image for cases where the noise level is high. This new image restoration work can be applied to the methods and systems described herein.","In the preceding sections, a multi-parametric optimization technique of engineering an appropriate pupil-phase mask to extend the depth of focus of an imaging system has been presented. The approach has been based on the use of the SR as a most important metric of image quality. Rendering the SR focus insensitive ensures that the phase-encoded, intermediate image\u2014and hence the digitally restored image\u2014is also focus insensitive. Computer simulations of a 3-D nose cone have successfully verified these assertions.","A different class of desirable solutions may consist of those that correspond to modulus transfer functions (MTF) that are not too narrow, so resolution is not degraded greatly while searching for the best focus invariance. This can be implemented by constraining the first few moments of the MTF to be not too small by means of additional penalty terms, and the process corresponds to maximizing the Hopkins ratio (V. N. Mahajan, , SPIE Press, 2001) instead of the Strehl ratio.","Yet another class of optimal solutions are those that ensure that the MTF itself does not become too small throughout the spatial-frequency range over which the image must be restored. This requirement, well met by the cubic-phase mask and advanced by its proponents as its chief merit, greatly improves the process of digital restoration from the blurred, phase-encoded, intermediate image. In the multi-parametric pupil phase engineering (PPE) approach described herein, this requirement can be implemented.","In one of the examples described above, Zernike polynomials were used to characterize a phase mask. The Zernike polynomials used to characterize the phase mask were asymmetric, resulting in an asymmetric phase mask. While the results shown above indicate that such asymmetric phase masks effectively reduced spatially-varying blur, there is no known scientific reason to begin the filter design process with asymmetric polynomials because there is no reason to prefer one axis over another axis in the image or pupil plane. In addition, using asymmetric polynomials results in more free parameters and thus increases the time and computation required to determine an optimal solution. Accordingly, in an alternate implementation of the invention, symmetric polynomials may be used to characterize the pupil phase.","The most general polynomial form of the pupil phase \u03c6(x, y) added by a phase mask can be given by:",{"@attributes":{"id":"p-0123","num":"0122"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"\u03d5","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","y"],"mo":","}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"m","mo":"=","mn":"1"},"mi":"\u221e"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"n","mo":"=","mn":"1"},"mi":"\u221e"},"mo":"\u2062","mrow":{"msub":{"mi":["a","mn"]},"mo":["\u2062","\u2062"],"msup":[{"mi":["x","m"]},{"mi":["y","n"]}]}}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"29"}}]}}}},"br":{}},"In the examples below, both cubic phase forms as well as combinations of cubic and pentic terms in two different truncated phase forms are addressed. The most general, non-separable, symmetric cubic-pentic phase form,\n\n\u03c6()=()+()+()+()+(),\u2003\u2003(30)\n\nis optimized via a Fisher information (FI) metric for the defocus-extension problem, while the following two phase forms are used to control spherical aberration:\n\n\u03c6()=()+()\u2003\u2003(31)\n\n\u03c6()=()+()\u2003\u2003(32)\n\nAny global optimization over the first of these forms requires exploring a 5 dimensional parameter space, which is considerably more computer intensive than over the latter two forms that have only two independent parameters. A useful optimization strategy that greatly improves computational speed is to explore only those parameter values that are near the surface of a search hypercube, rather than throughout its full volume. This is justified since even a more exhaustive search strategy inevitably produces optimum parameter values that lie near the surface of such a hypercube as such parameter values correspond to phases that most effectively counter the dependence of the PSF on variables like defocus.\n","The PSF h(r) in the image plane [coordinate vector: r=(x, y)] is the squared modulus of the amplitude PSF K,\n\n()=|()|,\u2003\u2003(33)\n\nwhere K is the following pupil integral involving the total pupil phase, [\u03c6(r)+\u03b8(r)]:\n",{"@attributes":{"id":"p-0126","num":"0125"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"K","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["r","i"]}}},{"mfrac":{"mn":"1","mrow":{"mi":["\u03bb","f"],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msqrt":{"mi":"A"}}},"mo":"\u2062","mrow":{"mo":"\u222b","mrow":{"mrow":[{"mo":"\u2146","mi":"x"},{"mo":"\u2146","mrow":{"mi":"yP","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"r"}}},{"msup":{"mi":"\u2147","mrow":{"mi":"\u2148","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mfrac":{"mrow":[{"mn":"2","mo":"\u2062","mi":"\u03c0"},{"mi":["\u03bb","f"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},"mo":"\u2062","mrow":{"msub":{"mi":["r","i"]},"mo":"\u00b7","mi":"r"}},{"mi":"\u03d5","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"r"}},{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"r"}}],"mo":["+","+"]}}}},"mo":"."}],"mo":["\u2062","\u2062"]}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"34"}}]}}}},"br":{},"sub":["i","i "],"sup":["2","2"]},"As described above, one possible optimization function suitable for designing phase masks in accordance with the invention is based on Fisher information (FI). In this section results for the FI-based optimization metric are presented. Fisher information is ideally suited to address the problem of extending the depth of focus, as noted above.","Fisher information measures the sensitivity of the PSF to defocus, and may be defined as (See H. Van Trees, , Wiley, 1968)",{"@attributes":{"id":"p-0129","num":"0128"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"msub":{"mi":["J","I"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c4"}},{"mo":"\u222b","mrow":{"msup":{"mrow":{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["r","i"]},"mo":";","mi":"\u03c4"}}},{"mo":["[","]"],"mfrac":{"mrow":[{"mrow":[{"mo":"\u2202","mn":"1"},{"mi":"nh","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["r","i"]},"mo":";","mi":"\u03c4"}}}],"mo":"\u2062"},{"mo":"\u2202","mi":"\u03c4"}]}}],"mo":"\u2061"},"mn":"2"},"mo":"\u2062","mrow":{"msup":{"mo":"\u2146","mn":"2"},"mo":"\u2062","msub":{"mi":["r","i"]}}}}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mo":"\u222b","mrow":{"msup":{"mrow":{"mfrac":{"mn":"1","mrow":{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["r","i"]},"mo":";","mi":"\u03c4"}}}},"mo":"\u2061","mrow":{"mo":["[","]"],"mfrac":{"mrow":[{"mo":"\u2202","mrow":{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["r","i"]},"mo":";","mi":"\u03c4"}}}},{"mo":"\u2202","mi":"\u03c4"}]}}},"mn":"2"},"mo":"\u2062","mrow":{"mrow":{"msup":{"mo":"\u2146","mn":"2"},"mo":"\u2062","msub":{"mi":["r","i"]}},"mo":"."}}}}}}]}},{"mrow":{"mo":["(",")"],"mn":"35"}}]}}}}},"The FI optimization metric is based on the following integral of [J(\u03c4)].",{"@attributes":{"id":"p-0131","num":"0130"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"I","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03c4","mn":"0"}}},{"msubsup":{"mo":"\u222b","mrow":{"mo":"-","msub":{"mi":"\u03c4","mn":"0"}},"msub":{"mi":"\u03c4","mn":"0"}},"mo":"\u2062","mrow":{"msup":{"mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["J","I"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c4"}}},"mn":"2"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":{"mo":"\u2146","mi":"\u03c4"}}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"36"}}]}}}},"br":{},"sub":["0","0"]},"The following Fermi-Dirac regularization implements the digital restorability constraint that in the optimization the Strehl ratio must not be allowed to drop below a threshold:",{"@attributes":{"id":"p-0133","num":"0132"},"maths":{"@attributes":{"id":"MATH-US-00018","num":"00018"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["J","\u03c7"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"mrow":{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mi":"u"}}}}}},"mo":"\u2062","mfrac":{"mn":"1","mrow":{"msup":{"mi":"\u2147","mrow":{"mi":"k","mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":{"mi":"\u03c7","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"0","mo":",","mi":"u"}}},"mo":"-","mover":{"mi":"\u03c7","mo":"^"}}}}},"mo":"+","mn":"1"}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"37"}}]}}}},"br":{}},"A globally optimal solution to the FI-based minimization problem is sought over the five-parameter space of symmetric cubic-pentic masks represented by Equation (30). A total of 640 random starting points were chosen in the hypercube bounded by \u221250\u2266a\u226650. The Levenburg-Marquart method was then used to find a minimum local to the given starting point. The resulting optimization computations consumed approximately 1.3 CPU years on a 32-processor SGI Origin 2000 computer.","A simulation of the image of an object with spatially varying defocus was computed for each of the 640 candidate filters. The results of the simulations were then evaluated based on 1) the degree of insensitivity to defocus and 2) the quality of restorations with respect to artifacts. Filters with these two properties were identified as candidates worthy of further study. One such filter has coefficients given by:\n\na=\u221221.65, a=41.91, a=338.2, a=\u2212318.6, a=586.6\u2003\u2003(38)\n\nThe filter defined in Equation (30) with the coefficients of Equation (38) is illustrated using a simulated object consisting of a sequence of fan blades which are arranged in a spiral away from the plane of focus, as shown in .  represent an image formed with no filter (), an image formed with phase mask filter in Equation (28) (), a restored image (), and the filter point spread function (). The point spread function is shown in a modified log-scale to better illustrate its structure. Two percent (SNR=50) additive zero-mean Gaussian noise is added to each image. The depth-dependent detail in the restored image () is much clearer in the restored image than in the image formed without any filter or restoration (). The restoration can be implemented using simple regularized Wiener filtering. A more powerful conjugate-gradient, least-squares (CGLS) restoration tried on the same phase-encoded noisy image also produced visually similar results.\n",{"@attributes":{"id":"p-0136","num":"0135"},"figref":["FIG. 13","FIG. 14","FIG. 13","FIG. 14","FIGS. 13 and 14","FIG. 13"]},{"@attributes":{"id":"p-0137","num":"0136"},"figref":"FIGS. 15A-15D","br":[{},{}],"in-line-formulae":[{},{}],"i":["x,y","x","+xy","x","+y"],"sup":["2","2","3","3"]},"A comparison is made by computing the difference between the restored image and the blur-free image, for the same value of SNR, namely 50, used in the images simulated here.  illustrates a restored image created from an image filtered using the degree three mask, and  illustrates a restored image created from an image filtered using the degree five mask.  illustrates the difference image corresponding to an optimized filter of total degree three, and  illustrates the difference image corresponding to an optimized filter of total degree five. The relative errors are 0.3252 () and 0.2477 () for the given filters of total degree three and five, respectively. In this example, relative error is the 2-norm of the difference image divided by the 2-norm of the blur-free image. When the noise is eliminated altogether, i.e., the SNR is set in effect to \u221e(apart from a 64-bit machine-precision related noise of simulation), the relative errors of restoration for the two filters are somewhat closer at 0.2575 and 0.2034, respectively. While these examples do not represent an exhaustive study, they are an indication that the degree-five terms allow for better extended depth of focus, in the sense that relative error is smaller for the optimized filter of total degree five.","Having demonstrated the efficacy of an engineered pupil phase in extending the depth of focus, a similar approach can be employed to control monochromatic aberrations of the imaging system as well. Such aberrations correspond to pupil phases that depend both on the pupil coordinate vector r and the object coordinate vector r. For a centered circularly symmetric pupil, the pupil phase for the lowest-order Seidel aberrations takes the form (see V. N. Mahajan, Aberration Theory Made Simple, SPIE Tutorial Text TT106, 1993.)\n\n\u03c6()=()()(),\u2003\u2003(40)\n\nwhere the care the coefficients of the spherical aberration (i=0), coma (i=1), astigmatism (i=2), curvature (i=3), and distortion (i=4), and r=(x+y) and r=(x+y) are the squared norms of the pupil and object coordinate vectors, respectively. Because of the object-coordinate dependence of the pupil phase, the PSF of an aberrated optical system is not shift-invariant, and the image of a transversely extended object is not uniformly resolved over the full image plane. Aberrations therefore restrict the off-axis extension of well-resolved images. Pupil phase masks can once again be employed to control these aberrations and thus extend the off-axis range of imagable distances.\n","By contrast with the other phase terms in Equation (40), the spherical-aberration phase is not object dependent, and thus does not affect the relative quality of off-axis vs. on-axis imaging. It does, however, lower the effective resolution of the overall image by forcing the larger-angle oblique rays to reach focus at a different distance from the focus of the smaller-angle rays that leave the same object point. Pupil-phase engineering provides a convenient approach for lifting the spherical-aberration MTF off the noise floor, so post-processing can rather effectively deblur the phase encoded image to yield a final image that possesses full diffraction-limited resolution. A minimax optimization procedure that directly controls the restorability of phase-encoded images is the more powerful of the two optimization methods for this purpose. In the following example, PPE is used to control spherical aberration alone. PPE may also be used to recoup the resolution in the presence of field-dependent aberrations.","Inexpensive imaging systems are likely to exhibit fabrication-related variations in the coefficients of the different aberrations even when the systems are designed to the same specifications. For such systems, it is important to design a single PPE mask that is well optimized to the full range of variation of the aberration coefficients. Unlike the focus-extension problem, the optimization is aimed here at maximizing restorability, rather than seeking invariance, over such variations of the aberration coefficients.","Since the singular values of a block-circulant-with-circulant-blocks (BCCB) matrix like the shift-invariant PSF are the moduli of its FFT, namely the corresponding MTF values, their sum over all spatial frequencies represents a measure of the invertibility of the associated image deconvolution problem. For this problem the two different two-parameter forms of the phase mask given in Equations (31) and (32) are sought to be optimized. Adding to the PPE phase the spherical-aberration pupil phase c(x+y)yields the full pupil phase for each phase mask. If the MTF values corresponding to the full pupil phase are denoted as \u03c3(a,b,c), then the minimax optimization procedure seeks to find",{"@attributes":{"id":"p-0143","num":"0142"},"maths":{"@attributes":{"id":"MATH-US-00019","num":"00019"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"munder":{"mi":"min","mrow":{"mi":["a","b"],"mo":","}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"munder":{"mi":"max","mrow":{"msub":[{"mi":"c","mo":"-"},{"mi":"c","mn":"0"},{"mi":"c","mo":"+"}],"mo":["<","<"]}},"mo":"\u2062","mrow":{"mo":"-","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"msub":{"mi":["\u03c3","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["a","b"],"mo":[",",","],"msub":{"mi":"c","mn":"0"}}}}}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"41"}}]}}}},"br":{},"sub":["\u2212","+","0 ","0 "]},"In numerical simulations, the lower and upper limits are taken on spherical aberration at the pupil edge to be 2.5 and 10 waves, respectively: c=2.5, c=10. For this range of values for c, the values of a and b for each of the two PPE phase masks were varied over a disk of radius equal to 100 in the a-b plane to determine the optimum values of a and b consistent with the minimax formulation in Equation (41). The minmax optimization was solved numerically using Matlab's fminimax subroutine. For each mask, fminimax was run at 160 starting points over the disk in the a-b plane.","Of the 160 possible solutions found with fminimax for the symmetric cubic form of Equation (31), the most promising phase mask in terms of insensitivity to noise and to spherical aberration is specified by the following coefficients:\n\na=90.7401, b=6.4175.\u2003\u2003(42)\n","Similarly, of the 160 possible solutions found with fminimax for the separable cubic-pentic phase mask of Equation (31), the most promising phase mask in terms of insensitivity to noise and to spherical aberration is specified by the following coefficients:\n\na=91.0336, b=78.1710.\u2003\u2003(43)\n","One particular application of interest for the methods and systems described herein is biometrics for personnel identification or verification using computational imaging systems for iris recognition. Computational imaging systems are modern systems that consist of generalized aspheric optics and image processing capability. These systems can be optimized to greatly increase the performance for iris recognition applications above systems consisting solely of traditional optics. (See J. van der Gracht, V. P. Pauca, H. Setty, R. Narayanswamy, R. J. Plemmons, S. Prasad, and T. Torgersen, \u201cIris recognition with enhanced depth-of-field image acquisition,\u201d Proc. SPIE 5358, 2004 and R. Plemmons, M. Horvathiiii, E. Leonhardt, P. Pauca, S. Robinson, H. Setty, T. Torgersen, J. van der Gracht, E. Dowski, R. Narayanswamy, and P. Silveira, \u201cComputational Imaging Systems for Iris Recognition,\u201dProc. SPIE 5559, 2004.)","In one iris recognition experiment, an ideal iris image at best focus was considered to be at a distance of 0.5 m from the system's pupil plane and with no spherical aberration. The system is modeled as having a focal length of 50 mm with a circular pupil of 7 mm diameter. A blurred iris image was computed numerically using 10 waves of spherical aberration of the pupil edge with two percent (SNR=50) zero-mean white Gaussian noise. The wavelength of incident light was assumed to be 760 nm and the detector pixel size was 7.6 mm. The nominal spherical aberration introduced by a lens at the pupil edge was taken to be 6.5 waves.","The point spread function associated with the symmetric cubic phase mask used in the iris recognition experiment is shown in . The phase mask was used to encode an image of an iris in a system whose lens introduces  waves of spherical aberration at the pupil edge, a fabrication-related variation of 3.5 waves over the nominal 6.5 waves. This phase-encoded image of the iris was restored using a CGLS iteration algorithm. The restored image removed a sufficient amount of the spherical aberration to allow iris identification.","As intended, the modulation transfer function (MTF) of systems with no phase mask with spherical aberration over the desired range is lifted significantly over the noise floor by the symmetric cubic phase mask (see . Also, it is important to note that the symmetric cubic phase mask outperforms the one-parameter cubic phase mask (b=0) in that it has a relatively larger range of insensitivity over spherical aberration.","The point spread function associated with the separable cubic-pentic phase mask of Equation (32) is shown in . This phase mask was tested by encoding an image of an iris in a system whose lens introduced  waves of spherical aberration at the pupil edge, a fabrication-related variation of 3.5 waves over the nominal 6.5 waves. As before, the intermediate image was restored using a CGLS iteration algorithm. The restored image corresponding to the best result from the sequence of iterations produced an even better result than the symmetric cubic phase mask whose PSF is illustrated in .",{"@attributes":{"id":"p-0152","num":"0151"},"figref":"FIGS. 19A and 19B"},"The present work expands the concept of pupil phase engineering to include higher-order phase masks than cubic to show how such phase masks when optimized can further improve the quality of digitally restored images. The Fisher information and minimax optimization metrics have different advantages: The first stresses PSF invariance to the variables being compensated while the second maximizes restorability over the range of those variables.","Two different physical problems where PPE methods are useful were described above. The first is the widely discussed extension-of-focus problem, the addition of optimized fifth-order (x,y) symmetric phase terms to the cubic pupil phase was examined to see how these terms improve the focus insensitivity in the final image. Use was made here of the FI metric, which is better suited than the minimax metric for the focus extension problem because it directly ensures a proper balance between maximum focus invariance and restorability, while the minimax metric does not directly address focus invariance. The second problem is the control of aberrations in poorly corrected optical imaging systems. The case of spherical aberration was discussed at length and numerical results presented for the simulation of an iris image and its restoration under varying strengths of that aberration. The minimax formulation was used here because of its direct emphasis on restorability. Its application yielded optimized 3rd-order and 5th-order symmetric phase masks that led to the restoration of well-resolved iris images, even with 10 waves of spherical aberration at the pupil edge. The 5th-order mask led to visually improved restorations when compared to the 3rd-order mask.","These calculations can be extended to include other Seidel aberrations as well, so that the overall focal-volume extension made possible by these PPE methods can be achieved. Analytical results that provide insight into the fundamental limits on the maximum image quality improvement can also be pursued.","Although the examples described above related primarily to optical imaging systems, the present invention is not limited to designing phase masks or to phase masks for only visible light wavelengths. The methods and systems described herein can be used to design phase masks for any frequency or range of frequencies of electromagnetic radiation desired to be filtered.","Each of the publications referenced herein is hereby expressly incorporated herein by reference in its entirety.","It will be understood that various details of the invention may be changed without departing from the scope of the invention. Furthermore, the foregoing description is for the purpose of illustration only, and not for the purpose of limitation, as the invention is defined by the claims as set forth hereinafter."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Preferred embodiments of the invention will now be explained with reference to the accompanying drawings of which:",{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1A"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 1B","FIG. 1A"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 1C","FIG. 1B"]},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4A"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 4B","FIG. 4A"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 5A"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 5B"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 6A","FIG. 4A"]},{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 6B","FIG. 6A"]},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 6C","FIG. 6A"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 7A","FIG. 4A"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 7B","FIG. 7A"]},{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 7C","FIG. 7A"]},{"@attributes":{"id":"p-0037","num":"0036"},"figref":["FIG. 8A","FIG. 4A"]},{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 8B","FIG. 8A"]},{"@attributes":{"id":"p-0039","num":"0038"},"figref":["FIG. 8C","FIG. 8A"]},{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 9A","FIG. 4A"]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 9B","FIG. 9A"]},{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 9C","FIG. 9A"]},{"@attributes":{"id":"p-0043","num":"0042"},"figref":["FIG. 10","FIG. 9A"]},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":["FIG. 12A","FIG. 11"]},{"@attributes":{"id":"p-0046","num":"0045"},"figref":["FIG. 12B","FIG. 11"]},{"@attributes":{"id":"p-0047","num":"0046"},"figref":["FIG. 12C","FIG. 12B"]},{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 12D","FIG. 12B"]},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 14","FIG. 13"]},{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIG. 15A","FIG. 11"]},{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 15B","FIG. 11"]},{"@attributes":{"id":"p-0053","num":"0052"},"figref":["FIG. 15C","FIG. 15A"]},{"@attributes":{"id":"p-0054","num":"0053"},"figref":["FIG. 15D","FIG. 15B"]},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 17A"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 17B"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 19A"},{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 19B"},"The patent or application file contains at least one drawing executed in color. Copies of the patent with color drawings will be provided by the United States Patent and Trademark Office upon request and payment of the necessary fee."]},"DETDESC":[{},{}]}
