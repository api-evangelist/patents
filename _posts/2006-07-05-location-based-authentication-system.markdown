---
title: Location based authentication system
abstract: An improved location based authentication (LBA) system for detecting fraudulent transactions committed by means of misuse of payment cards is disclosed. The improved LBA system performs a series of transaction analysis and generates a fraud-score which provides an indication as whether to authorize an attempted transaction. The system is designed to increase profitability of credit card companies by reducing the accumulated losses due to fraud. In one embodiment, the system detects fraud by analyzing the behavior patterns of card holders and merchants.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08285639&OS=08285639&RS=08285639
owner: mConfirm, Ltd.
number: 08285639
owner_city: Tel Aviv
owner_country: IL
publication_date: 20060705
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["REFERENCE TO RELATED APPLICATIONS","REFERENCES CITED","Patents and Published Applications","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF EMBODIMENTS"],"p":["This application claims the benefit of U.S. Provisional Patent Application No. 60\/695,893 filed on Jul. 5, 2005 and U.S. Provisional Patent Application No. 60\/702,605 filed on Jul. 27, 2005, are wholly incorporated herein by reference.",{"@attributes":{"id":"p-0003","num":"0002"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"U.S. Pat. No. 6,097,938","August 2000","Paxson"]},{"entry":[{},"US 20020073044","June 2002","Singhal"]},{"entry":[{},"US 20030061163","March 2003","Durfield"]},{"entry":[{},"US 20040073519","April 2004","Peder"]},{"entry":[{},"US 20040242201","December 2004","Toyoki; et al."]},{"entry":[{},"US 20050027543","February 2005","Yannis; et al."]},{"entry":[{},"US 20050065875","March 2005","Beard"]},{"entry":[{},"US 20050027667","February 2005","Kroll"]},{"entry":[{},"PCT\/IL2004\/000224","March 2004","Eden; et al."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"The present invention relates generally to location based authentication (LBA) systems, and more particularly to the use of location based authentication in fraud assessment.","In recent years, payments using a credit card instead of cash payments have become widespread, thus avoiding the dangers of carrying large amounts of money in the form of cash. However, theft or forgery of cards is also increasing rapidly and thus suitable countermeasures to this are extremely important. Many solutions have been proposed for ensuring against fraudulent use of stolen and forged credit and cash cards. These solutions include limited withdrawals, time limits for availability of credit cards, duplicate encryption, and identification of card owners, to name a few. Identification is performed by means of PIN codes, fingerprints, one-time passwords, and so on. Still against the increasing of card related crime, these traditional security solutions are insufficient.","Location based authentication (LBA) systems provide an improved solution for preventing fraudulent transactions made using credit or cash cards. Examples of such LBA systems may be found in WO 02\/052879 (also published as US 2004\/0073519 and WO 03\/058936 (also published as US 2004\/0242201), published US patent application Nos. US 2003\/0135470 and US 2005\/0065875 as well as in U.S. Pat. No. 6,097,938, each of which is incorporated herein by reference for their useful background descriptions of the state of the art heretofore. Generally, a LBA system detects fraudulent transactions by verifying the user's presence at the place of transaction. Specifically, the LBA system evaluates the authenticity of a user's requests by retrieving the location of a transmitting and receiving device, such as a mobile phone, carried by the user and comparing it with the location of a point of sale (POS) terminal (or a cash-withdrawal terminal). If the terminal and mobile phone are located within a calculated and acceptable distance the transaction is approved. The location of the user is retrieved from the mobile network while the terminal location is considered fixed.","LBA systems provide a higher level of security over traditional solutions; however, they fail to provide a reliable means of identifying fraudulent transactions. One of many reasons for this inability is that fraud identification is based solely on the geographical distance between the merchant's terminal and the user's mobile phone. In addition, LBA systems are not designed to track changes in merchants' locations or in the coverage of a cellular network. Accordingly, prior art LBA systems typically generate a large number of false alarms and thus cannot be considered a reliable solution for the detection of frauds committed using stolen cards.","It would be, therefore, advantageous to provide an improved LBA system that accurately detects fraudulent transactions It would be further advantageous if the provided system would detect fraudulent transactions based on behavior patterns of cards holders and merchants.","According to a first aspect of the invention, there is provided a computer-implemented method for determining a fraud score associated with a monetary transaction facilitated using a payment card in a store, the method comprising:","receiving data representative of an incoming payment transaction;","analyzing a location of a cellular telephone of an owner of said payment card and a location of the store for determining a location rating;","analyzing a location behavior profile (LBP) related to said payment card for determining a behavior rating;","computing a transaction rating using the location rating and the behavior rating in combination with a first weight factor;","analyzing historical payment transactions related to said payment card for determining a card rating; and","computing said fraud-score using said transaction rating and said card rating in combination with a second weight factor.","According to a second aspect of the invention, there is provided a method for accurately and adaptively learning the locations of merchants for the purpose of performing location-based analysis of payment transactions, the method comprising:","identifying pairs of payment transactions occurred within a predefined time interval and submitted by different merchants;","for each pair of payment transactions,","computing a transaction velocity;","computing a merchant location score (MLS) for each merchant if said transaction velocity is lower than a maximum allowable velocity; and","saving the computed MLS of a merchant if its computed MLS is below a maximum value of MLS.","According to a third aspect of the invention, there is provided a method for accurately and adaptively learning in real-time the locations of merchants for the purpose of performing precise location-based analysis of payment transactions, said method comprising:","receiving a payment transaction submitted by a merchant;","obtaining the location of said merchant;","retrieving a plurality of location based services (LBS) locations of one or more mobile phones associated with a user that initiates said payment transaction;","for each of said plurality of LBS locations, increasing a merchant location score (MLS) of said merchant if said merchant location matches said at least one of said LBS locations; and","saving said each of said plurality LBS locations as a new location of said merchant if said one of said LBS locations matches the obtained merchant location.","According to a fourth aspect of the invention, there is provided an authentication system for determining a fraud score associated with a monetary transaction facilitated using a payment card in a store, said authentication system comprising:","a transaction processor for processing data representative of an incoming payment transaction for determining said fraud-score based on at least the location of a cellular telephone of an owner of said payment card and a location of a store;","a database for storing incoming payment transactions and fraud scores computed for incoming payment transactions; and","a display unit for displaying data representative of processed incoming payment transactions.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 1","b":["100","100","110","120","130","120","140","120","140","140","160","150","150","140","160","150","170","180","150"]},"The authentication process carried out by the network system  starts with a subscriber (i.e., a credit card holder making a purchase) who initiates a purchasing transaction at the merchant's place of business. Then, the merchant terminal  connects with the transaction server  and sends to it the transaction information. The transaction information includes, but may not necessarily be limited to, details of the merchant (e.g., merchant's ID, type, name, and address), payment card details (e.g., card number and expiry date), sums to be charged, date of purchase, and so on. The transaction server  sends the transaction information to the authentication server  for authenticating the transaction. As part of the authentication process, the authentication server  generates a location request to the LBS server  to locate a mobile phone  associated with the card owner. Upon receiving the location of the mobile phone , the authentication server  performs a series of analyses to authenticate the transaction. Specifically, the authentication server  produces a fraud-score that indicates to some extent the reliability of the transaction. Based on the fraud-score, the transaction server  decides whether or not to authorize the transaction and produce an alert.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 2","FIG. 3"],"b":["140","140","210","220","230","210","210","120","150","170","210","210","120","150","220","230","230","140","220"]},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 3","b":["300","310","140","120","230","312","150","314","230","140"]},"At S, a location rating that indicates if a subscriber is located in proximity to the merchant is generated. The location rating is determined by matching location of the mobile phone  associated with the owner of the credit card, as received from the LBS server , to the learnt location of the merchant, and generating a location rating that is, in one embodiment of the disclosed invention, a function of the distance between the compared locations. This rating may be generated by normalizing the resultant distance to 1, where a good rating is 1 and a poor rating is 0. In one embodiment of the present invention a cellular analysis is applied if S results in a poor rating. This analysis checks if the reason for the outcome rating is the inability to detect the location of the mobile phone (e.g., due to the inactiveness of the phone). Then, it is further checked whether it is a normal behavior for the subscriber not to activate the mobile phone on certain days or in certain locations. For example, the subscriber may shut-off the mobile phone when visiting theaters or museums. If the inability to detect the phone's location is determined as a normal behavior, the location rating may be refined or may be given a lower weight when calculating the final fraud-score.","At S, a behavior rating is generated. This is performed by detecting deviations from a location behavioral profile (LBP), which characterizes the behavior pattern of both subscribers and merchants, and generates a value proportional to the detected deviations. The resultant value may be normalized to 1, where a good rating is one and a poor rating is 0. As will be described in greater detail below, the LBP includes historical information gathered on each subscriber and merchant with respect to their geographical locations and time periods (e.g., time of day, day of week, and so on) in which transactions were recorded. At S, a transaction rating is generated. The transaction rating is a function of the location rating and behavior rating. For example, the transaction rating may be a weighted average of both the location rating and behavior rating normalized to 1, where a good rating is 1 and a poor rating is 0.","At S, a card rating is determined that indicates the number of previous suspected transactions recorded for a specific card of a subscriber. The card rating is determined by accumulating the number of all transactions indicated as suspected, for example, all transactions with a transaction rating below a reconfigurable threshold. The counted number of transactions may be normalized to 1, where a good rating is 1 and a poor rating is 0. At S, the fraud-score is generated using the computed transaction rating and card rating. The fraud-score is a function of both the transaction rating and card rating and may be, for example, a weighted average of both ratings normalized to 1, where one represents the least suspicious. At S, the fraud-score is sent to the transaction server .","The transaction server  authorizes the transaction if the fraud-score is within a trust range; otherwise, the transaction is denied. The upper and lower bounds of a fraud-score are configurable and may be set by a system administrator or automatically determined by the authentication server . The computed fraud-score, transaction and card ratings are saved in the database .","It will be appreciated by a person skilled in the art that the fraud-score provides a superior advantage over prior art solutions that produce an indication whether to authorize the transaction merely based on the locations of the merchant terminal  and a mobile phone .",{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 4","b":"400"},"At S, for each subscriber, the geographical regions in which the subscriber performs most of the transactions (hereinafter the \u201csubscriber zones\u201d) are identified. Each subscriber zone defined by a group of merchants (i.e., places of business a transaction took place at) relatively located in the same distance region and the number of transactions above a predefined threshold associated with each such merchant. The distance region is defined as the maximum distance between each pair of merchants in a subscriber zone. At S, the location (e.g. a set of GPS coordinates) of each identified subscriber zone is added to the LBP of the respective subscriber zone. At S, for each merchant, the minimal average distance (MAD) between subscribers and their respective subscriber zones is computed. For example, subscribers X, Y and Z are respectively related to subscriber zones A, B and C and the minimal distances from a merchant-1 (i.e., where the purchases were made) to subscriber zones A, B and C are respectively 10 km, 15 km, and 2 km. In such a scenario the MAD of merchant-1 is 9 km. The MAD may be significantly different from one merchant to another, as the types of businesses are different. For instant, the MAD computed for a hotel may be higher than the MAD computed for a local grocery store. At S, the MAD computed for each merchant is added to the profile. At S, for each merchant the MAD is computed for different profiles of transactions or cards for instance time periods, amount, type of card etc., i.e., using transactions recorded in designated time periods. The time periods may be, but are not limited to, time of day, day of week, holidays, sessions, and so on. As a non-limiting example, a LBP may include MADs computed for a grocery store in two different time periods: Saturdays and Sundays between 10 AM and 12 PM as well as Mondays through Thursdays between 2 PM and 6 PM. At S, the MADs computed at S are saved together with their respective time periods in the LBP.","Other statistics related to transactions performed in respect to the subscriber zones may be computed and added to the LBP. These statistics include, but are not limited to, average amount of purchases where the distance between the merchant and a subscriber zone is less than a pre-defined distance, e.g., the distance between a subscriber zone is between 10-15 km, standard deviation of the MAD between the merchant and a subscriber zone, and so on. As mentioned above, the LBP is utilized for detecting a fraudulent transaction by identifying any deviation from data stored in the MAD.",{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 5"},"The authentication server  holds and constantly updates a lookup table, in the database , of the locations of all possible merchants  in a specific area. At S, a batch of historical payment transactions sent from merchants is uploaded to the authentication server . A payment transaction is a request sent from a merchant terminal , to the transaction server , for authorizing the transaction. As mentioned above, all transactions are recorded by server . At S, all pairs of historical transactions that occurred within a pre-defined time interval and performed by the same card holder are identified. This is performed in order to determine if transactions of each such pair can be paired. At S, the identified pairs of transactions are saved in a list (hereinafter the \u201cpair list\u201d). At S, the variables' maximum acceptable velocity (\u201cVmax\u201d) and maximum merchant location score (\u201cMLSmax\u201d) are set to their initial values, e.g., 80 kph and 100 kph respectively. A merchant whose calculated MLS is above MLSmax is considered as an \u2018established\u2019 location.","At S, a pair of transactions is selected from the pair list. At S, it is checked if at least one of the merchants who submitted transactions in the selected pair is considered as an anchor location. An anchor location is a location that was verified and considered accurate, i.e., a location with a relatively high MLS. If S results with an affirmative answer, execution continues with S; otherwise, execution ends. If none of the merchants is considered as an anchor location, then a process for updating the MLS of each merchant is applied. One example for such process is described below with reference to . Another process that may be used for updating the MLS is the method described herein, where in this case, execution proceeds to S regardless to the results yielded at S.","At S, the distance between the merchants (\u201c\u0394D\u201d) is computed. At S, a transaction velocity (Vt) is computed. Vt is equal to \u0394D divided by a time interval \u0394T between transactions in the selected pair. For example, if a pair of transactions associated with merchants A and B is performed in a time interval \u0394T and the distances between merchants A and B is \u0394D, then Vt is computed as follows:",{"@attributes":{"id":"p-0055","num":"0054"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":["V","i"]},"mo":"=","mrow":{"mfrac":{"mrow":[{"mi":["\u0394","D"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":["\u0394","T"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},"mo":"."}}}}},"At S, it is checked if Vis lower than Vmax, and if so execution continues with S where a new value of MLS is computed for each of the merchants. Specifically, the MLS of the first and second merchants MLSand MLSare computed as follows:",{"@attributes":{"id":"p-0057","num":"0056"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"msub":{"mi":["MLS","A"]},"mo":"=","mrow":{"msubsup":{"mi":["MLS","A","\u2032"]},"mo":"+","mrow":{"mfrac":{"mrow":{"msub":{"mi":["V","max"]},"mo":"-","mi":"V"},"msub":{"mi":["V","max"]}},"mo":"*","msub":{"mi":["MLS","B"]}}}},"mo":";","mi":"and"}}}},{"@attributes":{"id":"p-0058","num":"0057"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":["MLS","B"]},"mo":"=","mrow":{"msubsup":{"mi":["MLS","B","\u2032"]},"mo":"+","mrow":{"mfrac":{"mrow":{"msub":{"mi":["V","max"]},"mo":"-","mi":"V"},"msub":{"mi":["V","max"]}},"mo":"*","mrow":{"msub":{"mi":["MLS","A"]},"mo":"."}}}}}}},"The MLS\u2032 is the previous score assigned to each merchant location. This score may be a default or pre-computed value. At S, it is checked if a MLS computed for each merchant is below the value of MLSmax, and if so execution continues with S where a MLS value or values below MLSmax are saved in their respective entries in the lookup table. If the operation in S results with a negative answer, then at S, the coordinates of the anchor location are saved as the location of a merchant with MLS greater than MLSmax. The new computed MLS of each such merchant is also saved.","Execution proceeds to S if the result of S yields that Vmax is higher than Vt. At S, the location coordinates of the merchant which is the anchor location are saved as the location of the second merchant (hereinafter the \u201cremote merchant\u201d). At S, a radius for the remote merchant is computed and added to the lookup table in the respective entry. The radius is computed as follows:\n\nRadius=Radius\n","where, TDFC is a difference factor that equals to \u0394T*Vmax and RadiusC is the radius of the anchor location. At S, a new MLS is calculated for the remote merchant as follows:\n\n\n\nwhere, MLSC is the score of the merchant considered as the anchor location and \u03b2 is a configurable parameter that may vary, for example, between 0.1-0.2. The new computed MLS is added to the lookup table. At S, it is checked if all pairs of transactions in the pair list were handled, and if so execution terminates; otherwise, execution returns to S.\n",{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 6","b":["600","140","120","180","150"]},"At S, a subscriber-cellular score (SCS) and a maximum SCS (\u201cSCSmax\u201d) are set to their initial values. The SCS provides an indication if the mobile phone  of a user can be indicative of his location. For example, on the one hand, if a user always carries his phone then the SCS may be set to a higher value; on the other hand, if the user rarely carries his phone, the SCS may be set to a lower value. The SCS may be a function of a number of prior \u2018on-location\u2019 transactions. The SCS and SCSmax are relevant only if a user has two or more mobile phones. In the case that a user has only a single phone the SCS and SCSmax are set to 1.","At S, a payment transaction sent from a merchant terminal  is received at authentication server  (through the transaction server ). A transaction carries information that includes, but may not necessarily be limited to, details of the merchant (e.g., merchant's ID, type, name, and address), payment card details (e.g., card number and expired date), sums to be charged, date of purchase, and so on. At S, the known location of the merchant that initiates the transaction is obtained from the lookup table in database . At S, the authentication server  generates a location request to the LBS server  to locate each of the user (i.e., card holder) mobile phones. Specifically, first the authentication server  gets from database  a list of phone numbers of the user and send a LBS request to one or more cellular networks to retrieve the mobile phones' locations (hereinafter the \u201cLBS locations\u201d). All LBS locations are kept in a LBS locations list. At S, a single LBS location is selected from the list. At S, it is checked if the chosen LBS location matches the merchant location as retrieved at S, and if so execution proceeds to S where the incoming transaction is declared as \u2018on-location\u2019 and the MLS of the merchant is increased; otherwise, execution continues S. The transactions declared as \u2018on-location\u2019 can be used later for determining the SCS of the user mobile phone. The new MLS is set to:",{"@attributes":{"id":"p-0065","num":"0064"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"MLS","mo":"=","mrow":{"msup":{"mi":["MLS","\u2032"]},"mo":"+","mrow":{"mi":"\u03bb","mo":"*","mfrac":{"mi":"SCS","msub":{"mi":["SCS","max"]}}}}}}},"br":{}},"At S, is it checked if all LBS locations in the list were handled; and if so execution continues with S where a new merchant location is added to the lookup table; otherwise, execution returns to S. A new location is added only if none of the user's mobile phones is \u2018on-location\u2019. Specifically, at S, each of the LBS locations in the list is added to the lookup table. For each such location, a set of coordinates as well as the radius of the LBS location are saved. Furthermore, a MLS is computed and added to the table. The MLS is computed as follows:",{"@attributes":{"id":"p-0067","num":"0066"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mi":"MLS","mo":"=","mrow":{"mfrac":{"mi":"SCS","msub":{"mi":["SCS","max"]}},"mo":"*","mi":"\u03b1"}}}},"br":{}},"At S, once one or more locations are created, a merging process takes place to eliminate duplicate newly created locations covering same areas. Specifically, the merging process compares all merchant locations of each merchant and identifies groups of two or more locations which cover the same area. Once a group is identified, all the relevant merchant locations are merged into one inclusive location. The MLS of the merged location is the sum of the original locations' scores. In a case where at least one of the merged locations is an established location, the merged location is also considered established.","After executing the real-time learning process, the transactions coupling process (described above with reference to ), or a cleaning process, can further be performed to ensure a higher level of accuracy. The cleaning process comprises checks that all merchant locations are valid and no duplicates exist. The process checks all the merchant locations' scores and update dates. If the update date is older than a configurable expiration date the merchant location is purged. An \u2018un-established\u2019 merchant location can also be purged if its date is older than a configurable semi-expiation date and its MLS is less than a configurable semi-expiration score.","It will be understood that while the invention has been described with regard to payment using a credit card, actual payment may be made by other means and the purchaser's credit card may be used only to authenticate the purchaser. For example, once it is established that the purchaser's location, as identified by his cellular telephone for example, is within correct proximity of the merchant, payment itself can be charged to the purchaser's cellular telephone bill or to another charging account associated with the purchaser.","It will also be understood that the system according to the invention may be a suitably programmed computer. Likewise, the invention contemplates a computer program being readable by a computer for executing the method of the invention. The invention further contemplates a machine-readable memory tangibly embodying a program of instructions executable by the machine for executing the method of the invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["In order to understand the invention and to see how it may be carried out in practice, an embodiment will now be described, by way of non-limiting example only, with reference to the accompanying drawings, in which:",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
