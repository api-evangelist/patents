---
title: Method and system of integrating instant messaging with other computer programs
abstract: Described is a system and method by which client programs such as desktop applications can use instant messaging functionality. An application program interface is provided that allows a client program (e.g., an application program) to interact with an instant messaging infrastructure, such as via event calls to initiate conversations, send messages and/or obtain presence information. This enables other programs to create new user experiences that integrate the messaging infrastructure, such as displaying presence, or enabling instant messages to be sent from within an application program. Document collaboration is also facilitated, by allowing users to send instant messages (or the document) to other users, including sending an instant message directly to a user associated with a specific comment or change to the document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07451186&OS=07451186&RS=07451186
owner: Microsoft Corporation
number: 07451186
owner_city: Redmond
owner_country: US
publication_date: 20040810
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","Internal Apple Events Interface"],"p":["The invention relates generally to computing systems, and more particularly to instant messaging on a computer system.","Instant messaging is a communications service that enables one user to communicate text in real time over the Internet to and from another user. Typically, the instant messaging service allows each a user to build a private list of other users, and for each listed user, provides an alert whenever another user on that private list is online. An instant messaging session may then be initiated.","While instant messaging applications are generally free, standalone programs used for simple chat-like communications, other real-time communication scenarios could benefit from having instant messaging communications. For example, enterprise personnel and others computer users such as students could benefit from being able to seamlessly communicate instant messages while working with other application programs. At present, however, instant messaging programs are independent of any other programs. What is needed is a way for other programs to access instant messaging functionality in a manner that benefits users who work in various real-time communication scenarios.","Briefly, the present invention is directed towards a system and method that provide application and other programs (e.g., operating system components) with access to an instant messenger service's functionality. In one implementation, an instant messaging program is separated into a user interface component by which users may send instant messages in a more traditional manner, and a background component (e.g., a daemon process) in which much of the communication-related structure and functionality of the instant messaging service is provided. An application programming interface allows programs to work with the background component, allowing instant messaging functionality to be integrated with other programs on a computer system. Further, the background component communicates integration data with other programs, allowing an application to richly interact with the instant messenger service.","In one implementation, an application programming interface (or interfaces) supports a primary client (e.g., the user interface application) that fully interacts with the messenger service, and one or more secondary clients (e.g., a word processor program). This secondary client can expose the contact list, and can also take advantage of complete instant messaging functionality, such as by launching the instant messenger user interface component and sending the user to the interface. In this implementation, the various components and client programs may communicate via a defined set of AppleEvents. Further, the background application is also responsible for communicating integration data with other select applications. These AppleEvents thus define the API that allows rich interaction with the Messenger service.","The various clients thus communicate with the messenger background component through the API set, and may also provide callback data to the messenger background component. Actions that client programs may perform via this API set include determining when the user signs in or signs out, and obtaining the instant messaging contact list, obtaining presence information as to who else is online, and so forth. Other operations that the client programs can perform include changing a stored password, changing the online status and changing the familiar name. Further, the client programs may initiate an instant message conversation with another user, obtain a list of currently online users (buddies), and initiate invitations to allow application sharing, remote control, gaming, and so forth. New functionality may be added to the messenger component and\/or messenger user interface component, such as to add contacts from the messenger program.","The present invention thus allows an application (or suite of applications) to become an instant message hub by allowing users to communicate in real-time, based on presence information (e.g., which other users are signed in). Instant messaging access from programs may be provided in various ways, such as via an icon. Further, document collaboration using instant messaging is facilitated, such as by allowing a user to send an instant message or document to another user identified in a interlineations markup balloon.","Other advantages will become apparent from the following detailed description when taken in conjunction with the drawings, in which:","Exemplary Operating Environment",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1","b":"100"},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to: personal computers, server computers, hand-held or laptop devices, tablet devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, and so forth, which perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in local and\/or remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of the computer  may include, but are not limited to, a processing unit  containing one ore more processors, a system memory , and a bus structure (e.g., memory controller\/bus bridge)  that couples various system components including the system memory to the processing unit . The bus structure  and\/or other bus bridge mechanisms  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus, and\/or PCI-X.","The computer  typically includes a variety of computer-readable media. Computer-readable media can be any available media that can be accessed by the computer  and includes both volatile and nonvolatile media, and removable and non-removable media. By way of example, and not limitation, computer-readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer-readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by the computer . Communication media typically embodies computer-readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer-readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM) and random access memory (RAM). A boot ROM , containing the basic routines that help to transfer information between elements within computer , such as during start-up, may be independently coupled to the system, as shown in . The memory typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by the processing unit . By way of example, and not limitation, examples include a host operating system, a guest operating system, application programs, other program modules and program data.","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  and interface  that reads from or writes to non-removable, nonvolatile magnetic media, an optical disk drive  and interface  that reads from or writes to a removable, nonvolatile optical disk such as a CD-ROM or DVD-ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, USB drives, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like.","The drives and their associated computer storage media, discussed above and illustrated in , provide storage of computer-readable instructions, data structures, program modules and other data for the computer . For example, the hard disk drive  may store the host and guest operating systems, application programs, other program modules and program data. Note that these components may be the same as or different from those loaded in the memory , although they are typically different instances.","A user may enter commands and information into the computer  through input devices such as a keyboard  and pointing device  (e.g., a mouse), and\/or via other well-known input means including a tablet, electronic digitizer, microphone, trackball or touch pad. Other input devices not shown in  may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a wired and\/or wireless input interface  that is coupled to the system such as via an I\/O device and disk controller , but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB) port  and its controller . Other mechanisms that may be connected to the controller  include a power controller .","A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . The monitor  may also be integrated with a touch-screen panel or the like. Note that the monitor and\/or touch screen panel can be physically coupled to a housing in which the computing device  is incorporated, such as in a tablet-type personal computer. In addition, computers such as the computing device  may also include other peripheral output devices such as speakers  connected via audio circuitry  and\/or audio jacks  and\/or a printer, which may be connected through an output peripheral interface or the like.","The computer  may operate in a networked environment using logical connections to one or more remote computers, which may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . Such networks include a local area network (LAN) and a wide area network (WAN), which may be accessed via a modem  and modem interface  and\/or an Ethernet interface  and jack  and\/or, but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Instant Messaging for Other Programs","The present invention is generally directed towards a system and method by which various application programs and other programs (such as operating system components) can integrate with an instant messaging service. As will be understood, numerous ways to implement the present invention are feasible, and only some of the alternatives are described herein. For instance, many of the examples herein will be described with reference to a Macintosh-based operating system and architecture, using AppleEvents as a communication protocol. However, the present invention is not limited to any alternative described herein, nor is it limited to particular architecture, operating environment, platform and\/or operating system. Rather, the present invention provides benefits and advantages in computing in general.","As represented in , there is shown an example architecture  in which a messenger service has been separated into two components, namely a messenger background component , which may comprise a daemon process, and a messenger user interface (UI) component . A first API (application programming interface) set  interfaces the messenger background component  with the messenger UI component ; traditionally, there has been no such separation.","In general, the messenger background component  is responsible for interfacing with a remote messenger server , while the UI component  allows the user to interact with the messenger service. In essence, the user need not know about the separation, and, for example, may work with the UI component  and not recognize any difference from conventional standalone instant messaging systems. As can be readily appreciated, which functions are performed by the messenger background component  and which are performed by the messenger UI component  is somewhat arbitrary, except for efficiency purposes and avoiding duplication.","In one implementation, the messenger background component  and the UI component  communicate via a defined set of AppleEvents, that is, the set of AppleEvents defines the first API set . It is understood, however, that any other protocols and\/or ways to interface between components, including providing a library of function calls, providing defined methods, providing defined web service messages, and so forth are equivalent. For example, the components can be implemented in an object model, in which clients call object methods, or in a web services environment, in which a client calls a web service, with SOAP\/XML (Simple Object Access Protocol\/extensible Markup Language) messages exchanged. Some of these other alternatives are shown in ; e.g., in  there is shown background, UI and client objects ,  and , respectively, while in  there is shown a single messenger object  with internal UI methods and data and some methods and data exposed to other clients .  shows a web services environment, in which instant message functionality is accomplished via communications exchanged between a web service client , a messenger web service  and a messenger UI web service . For purposes of simplicity herein, the present invention will be primarily described with reference to , generally using AppleEvents for communications. In accordance with an aspect of the present invention, the messenger background component  may be accessed by other client programs  that are aware of the messenger background component . Such programs may include application programs such as word processing programs, spreadsheet programs, web browsers, email programs, suites (such as Microsoft\u00ae Office) and\/or project management programs. Other programs such as operating system components, utilities, debugging programs and so on may also interface with the messenger background component . To this end, a second API set  is provided. As described below, the messenger background component  is also responsible for communicating integration data to the other programs . In general, each program  represents a client that wants to start sessions with other users, wherein a session may be an instant message session (chat) or a file transfer. Other types of sessions, such as \u201capp invites,\u201d are feasible.","In one implementation, the messenger UI component  comprises a primary client that can fully interact with the messenger background component . In general, the first API set  allows the messenger UI component  to perform any actions that a standalone program's user interface can perform, as if there was not any separation. The secondary client program or programs can interact with the messenger background component , but generally have a more limited interaction. The second API set  may thus be a subset of the first API set .","In general and as described below, the clients  communicate with the messenger background component  through the API set , and may also provide callbacks to the messenger background component . Actions that the other clients  may perform via the second API set  include determining when the user signs in or signs out, and obtaining the instant messaging contact list, obtaining presence information as to who else is online, and so forth. Further, the other clients  may take advantage of other instant messaging functionality by launching the messenger user interface component  and sending the user to the user interface component , e.g., by transferring focus to a window of the user interface component . Alternatively, the program could provide its own user interface, such as a dialog box or the like, or host the user interface component . In another alternative, a client program  could send messages and data on its own via the messenger background component , without invoking the user interface component .","The operations that the client programs  can perform include sign-in\/sign-out, changing a stored password, changing the online status and changing the familiar name. Further, the client programs may initiate an instant message conversation with another user, obtain a list of currently online users (buddies), and initiate invitations to allow application sharing, remote control, gaming, and so forth.","To this end, the client programs communicate with the messenger background component , which may be accomplished in various ways in alternative implementations. For example, one way (in a suitable environment) is via AppleEvents, that is, while the messenger component  is running, the messenger component  can receive AppleEvents from the other client programs . Further, the messenger component  may export functions, e.g., instead of sending AppleEvents, the clients may map the exported functions and call them as if they were in a library. A shared library solution is similar to the exported functions, but cannot work without a background application running.","Exporting functions is straightforward from the client program's perspective, since the client program does not need to construct and send events, but rather simply calls functions as if part of a library. However, every application runs in its own address space, leading to problems. For example, consider two clients, A and B, which use the messenger component's API . If client A decides to change the user's friendly name, the new name will be stored in some variable local to client's A address space; not only client B will never see this change, but neither will the messenger component . Shared memory may be used to store relevant information, however this does not solve the problem completely, since every client (as well as the messenger component ) will need to be pooling the shared memory checking for changes. Further, the shared memory implementation depends on the underlying platform. Note that a shared library solution has similar issues, but needs to have an application running to receive messages from the server, and thus is a less desirable solution.","Thus, a combination of events and function calls is one suitable implementation, e.g., while the APIs are implemented using AppleEvents, an additional shared library may be created to translate function calls to corresponding AppleEvents. At the same time, this shared library may contain functions that capture the AppleEvents sent by the messenger component  and translate them into callbacks in the client programs . As a result, for example, automation scripts may use AppleEvents, while client programs such as a browser may use the shared library without needed to understand the underlying mechanism.","In any event, the underlying events model will generally be described herein. For example, when a client program wants to use instant messaging functionality, the client may send a \u201cRegisterApplication\u201d event. The messenger component  maintains a list of registered clients, and sends appropriate AppleEvents back when some relevant property has changed. In one particular implementation, the messenger program's contact list is stored in a local cache that is filled the first time the client program calls the \u201cGetContact\u201d function, and will be updated each time a callback comes from the messenger component. This contact list can be stored using the structures described below.","The messenger background component  sends different events to the client programs, including callbacks as described below.","Note that some new functionality may be added to the client application  as a result of integration with the messenger component . One examples of this includes adding contacts, which may launch the messenger user interface component , and provide an empty \u201cAdd Contact\u201d wizard as if the user had chosen the \u201cAdd a Contact . . . \u201d option in the messenger user interface component . For such an implementation, the \u201cby email\u201d dialog may be started to pre-populate the e-mail address edit box with the selected address. Sending attachments (files) may be accomplished by calling the code that starts file transfers, as when dragging and dropping a file in the contact table. Viewing instant messaging history for a contact is another enhancement.","To use functionality from a client program , during a sign-in process, a message request launches the messenger user interface component  and behaves as if the user had selected \u201cSign In . . . \u201d from the user interface main menu. That results in signing in automatically if the password is saved, or asking the user to enter the password (and any related data) if not saved. The client can also obtain sign-in status, e.g., a current implementation of \u201cGetSignInStatus\u201d receives an email address and evaluates the status of that logon user. The functionality may respond with the current user's status.","Data structures are provided to store the instant messenger contact list, as set forth in the tables below:",{"@attributes":{"id":"p-0043","num":"0042"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"typedef struct"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003Str255","stEmail;"]},{"entry":[{},"\u2003\u2003UniChar"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u2003\u2003rgwchFriendlyName[256];"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2003UInt32","status;"]},{"entry":[{},"\u2003\u2003Boolean","fBlocked;"]},{"entry":[{},"\u2003\u2003uchar","unused[3];"]},{"entry":[{},"} IMsgrContact;"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"To represent the contact list:",{"@attributes":{"id":"p-0045","num":"0044"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"typedef struct",{}]},{"entry":[{},"{"]},{"entry":[{},"\u2003\u2003SInt32","cch;"]},{"entry":[{},"\u2003\u2003IMsgrContact","*pcContacts;"]},{"entry":[{},"} IMsgrContactList;"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}}},"In this manner, the present invention thus allows an application (or suite of applications) to become a central communications hub by allowing users to communicate in real-time, based on presence information (e.g., which other users are signed in). In other words, any program may offer presence and instant messaging capabilities, whereby instant messaging becomes a highly-useful communication option along the lines of telephone and e-mail. For example, the option to send an instant message may be presented alongside user interface entry points that were previously e-mail only. Further, new entry points will allow users to obtain messenger information of other users (\u201cbuddy\u201d information) such as to display a username and online\/offline status, and access messenger-specific functionality including sign-in to messenger, add contact to messenger, send and instant message and view recent instant messenger conversations. Note that at present, email-based contacts and messenger buddies comprise distinct lists that are not managed together, but these may be merged based on the present invention, e.g., the buddy list (or different buddy lists) may be a subset of at least one contacts list.","Instant messaging access may be provided in a number of ways. For example, a messenger icon may be provided on an appropriate application toolbar such as a reviewing toolbar, such that that when the icon is clicked, the program provides a dropdown menu or the like that lists any online buddies. These options allow the user to either initiate an instant message session or send the document for review via the messenger's file transfer capabilities. Other mechanisms can be used to access instant messaging options, such as right-clicking at an appropriate location, pressing a keyboard key combination, and any other suitable way to instruct the program that instant messaging is desired, e.g., clicking on a pop-up notification shown within the program that indicates that another user has signed in.","By way of example,  shows a screenshot  of a word processing program in which an instant messenger icon  is provided in a toolbar. As represented in , clicking this icon  may, for example, result in a dropdown menu , which may have a submenu  comprising the buddy list with current status information. Thus, the instant messenger icon may be used to list online buddies, from which the user may initiate an instant messaging session or send the document (the one currently being edited) for review via messenger's file transfer feature.","In accordance with another aspect of the present invention, there is provided a mechanism to facilitate document collaboration using instant messaging. For example, word processing programs are on example of a by which programs that may be used in collaborative environments, with a document shared among one or more originators and reviewers. One way to maintain the integrity of a document is to track which user made which changes, so that anyone reviewing the edited document can trace specific changes back to their originators. To this end, interlineations  (), or markup balloons, represent document changes that are shown in a manner that does not obscure the original document.","The present invention may be used to integrate applications and instant messaging by incorporating document sharing directly into the workflow, without having to leave the program. More particularly, a markup balloon contains an originator\/reviewer label. By connecting this label to an instant message address, the present invention can provide a direct way for a user to communicate with another user via instant messaging. In one implementation, in documents with many markup balloons, having the <Originator\/Reviewer Name> and <Type of Change:> highlighted in the beginning of their respective balloon body parts allows for more effective navigation.","Quick and seamless collaboration between users via instant messaging, when working on a shared document, is accomplished by having a button  that appears on the comment or change bubbles that provides access to an instant message conversation. To this end, the name of the user who created the bubble is taken (from the Word document), and the user looked up in a contact list, locating an instant messaging address when available. If an instant messaging address is available, this button will be enabled and will allow the user to launch an instant messaging conversation. In one implementation, the button is only enabled if there is an exact user name match and as long as there are no name conflicts.","The general logic of an \u201cAuthor-to-IM-contact matching\u201d is represented in , where the author name is looked up in a contacts for a matching display name at step , and evaluated for a match at step . If that succeeds, it is used. Otherwise, if the author name looks like an email address as tested via step , an attempt is made try to match it against the messenger buddy list at step ; if that succeeds as evaluated at step , it is used.","If exactly one contact is found at step , the instant messaging address is looked up at step  (if there is no instant messaging address, the email address is used). That contact is then looked up in the messenger list (step ). If found and the user is online (step ), the button (e.g.,  of ) is enabled.","In one particular implementation represented in , the comment bubble code is enabled by obtaining the user name for the current bubble, (step ) which is found in a ABX.pxstzBubbleAuthor field. A function named use FGetContactNameRange is used at step  to determine if the author has contact information. Note that this function allows the mechanism to determine if there is exactly one match for the name at step ; if more matches are found, the button will be disabled because this implementation supports only a single match. This call also uses a cached list of contacts, providing performance benefits.","Step  represents obtaining the instant messaging address information for that contact, using email if no instant messaging address is explicitly specified. Step  looks up that instant messaging address in the messenger list. If it exists with the appropriate online status (step ), the button will be operational via step .","Programming Interface","The exported functionality is divided into four parts, with the \u201cbasic functionality\u201d comprising an enhancement of what other messenger services support. The basic functionality allows the client to sign-in\/out, get\/set user properties and open a preferences dialog. Two other parts, \u201cContacts\u201d and \u201cGroups\u201d allow the client to manage contacts and groups, respectively, generally by adding, removing and getting properties such as name or status. A \u201cSessions\u201d part allows the client to register in order to receive callbacks from the messenger component , and initiate sessions with other users to send messages, files, and so forth. This part also implements lock and key functionality, that is, functions and those which require the API to be \u201cunlocked\u201d verify that the calling program is authentic, in order to avoid third party applications faking AppIds and making the messenger component  believe it is another client that unlocked the interface. This may be accomplished by checking the process identifier of the AppleEvent sender.","Basic Functionality","Sign in\/out","Get\/set sign in name","Get sign in status","Get\/set friendly name","Get MSN Messenger version","Show preferences","Get Hotmail count","Send Instant message","Send file","Send Hotmail","Callbacks","On sign in\/out","On status change","On friendly name change","On Hotmail count change","Notes that to have callbacks, RegisterApplication and UnRegisterApplication or the like may be provided (e.g., in the \u201cSessions\u201d section).","Contacts","Get contact count","Start add contact","Remove a contact","Get contact properties (sign-in name, friendly name, sign-in status block\/page status)","Block\/unblock contact","View instant message history","Get whole contact list","Callbacks","On add\/remove contact","On contact property changed","Groups","Get group count","Add a new group","Remove a group","Rename a group","Get\/set group name","Get whole group list","Move\/Copy contact between groups","Remove contact from group","Callbacks","On add\/remove group","On group name changed","On contact moved\/copied","On contact removed from group","Sessions","Register\/unregister application","Get lock status","Request\/responde challenge","Callbacks","On challenge","On result","On enable","In one implementation, a generic method is used that reads \u201cevent descriptions\u201d from a static table. These event descriptions contain the event number, the type for each parameter, and the function\/method to call after getting the parameters. As a result, adding new functionality to the API is straightforward, and is performed by adding a new entry to the table, without having to use the main method or add methods to get the parameters from an AppleEvent. Note that the opposite may be done to implement callbacks, e.g., by including in the code functions or methods equivalent to the callbacks. Each of these methods will generate an AppleEvent and send it to the client application. Note that these two sets of APIs may be reused when implementing a Messenger Shared Library to be loaded by the client program. Callbacks require locating the proper places to add calls to the equivalent functions, e.g., if an application requests to change the user friendly name, the messenger component  receives the event, inform the server, updates the messenger interface and then calls back other clients to inform them of the new name.","Clients may also use version control in order to verify which APIs are implemented in the version of the messenger component that is running. Calling an IMsgr_Version function will return a major and a minor version number, by which the client may verify compatibility. Additionally, when introducing new APIs in subsequent versions, the new corresponding functions in the shared library may check for the messenger component version and return a \u201cfunction not implemented\u201d error.","In one implementation, the code contains an AppleEvent dictionary stored in an aedt resource, which specifies the translation between FOUR_CHAR_CODE and integer event IDs. This resource is contained in the file BMMSApp.rsrc.","An event related data structure is shown below, where N is the maximum number of parameters allowed in an event or function:\n\n","In one implementation, the number is three, with the structure implemented in a series of macros that automatically generate functions that read each of the parameters from an AppleEvent and store them into variables; to later call an implementation function that takes them as input parameters. The table contains AENumber and FunctionPointer in each record.","IMsgrSessionManager is a class that is basically a list of registered programs; registering assigns an identifier to the program and adds it to the list, while unregistering removes the specified program. There is only one session manager:\n\nApplication=<AppId, Name, Lock>\n\nwhere AppId is an identifier for the application, such as the operating system process ID, and Lock is the object that handles the lock and key status of the application.\n","The following describe an internal AppleEvents implementation, which is use to communicate; for events except IMsgrSessionManager_RegisterApplication, IMsgrSessionManager_UnRegisterApplication, and IMsgr_GetVersion, if the Application is not registered to Messenger App, nothing will be done and an error returned.","The events will have class id \u201cRmsg\u201d,",{"@attributes":{"id":"p-0111","num":"0111"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Basic functionality"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SignIn"},{"entry":"Try to sign in using the email and password provided in the message."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg0",{},{}]},{"entry":["Parameters","MemA","Char","Email address"]},{"entry":[{},"MpwD","Char","User password"]},{"entry":[{},"Mchk","Long","Checksum (not used, must be"]},{"entry":[{},{},{},"0)"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212101","User already signed in"]},{"entry":[{},"\u221212102","Cannot access preferences file"]},{"entry":[{},"\u221212103","Already signing in\/signing out"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_AutoSignIn"},{"entry":"Will try to sign in using the default credentials stored in the preference"},{"entry":"file."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Masi",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212101","User already signed in"]},{"entry":[{},"\u221212102","Cannot access preferences file"]},{"entry":[{},"\u221212103","Already signing in\/signing out"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SignOut"},{"entry":"Try to sign out."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg1",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212102","Cannot access preferences file"]},{"entry":[{},"\u221212103","Signing in\/already signing out"]},{"entry":[{},"\u221212106","Checksum does not match"]},{"entry":[{},"\u221212107","Email doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212108","Password doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212109","User selected cancel in the quit alert"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_ShowSignInDialog"},{"entry":"Show the sign in dialog."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MVsi",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212101","User already signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetSignInName"},{"entry":"Get the current user's email address."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGsn",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Char","Email address of the signed in user"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SetDefaultSignInName"},{"entry":"Set the default sign-in user's email address stored in Messenger's local"},{"entry":"preferences."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MSsn",{},{}]},{"entry":["Parameters","Msin","Char","Email address"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"(OSErr)","cannot write preferences file"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SetPassword"},{"entry":"Changes the default password stored in messenger's local preferences."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg3",{},{}]},{"entry":["Parameters","MemA","Char","Email address"]},{"entry":[{},"MpwD","Char","User password"]},{"entry":[{},"Mchk","Long","Checksum (not used, must be"]},{"entry":[{},{},{},"0)"]},{"entry":[{},"MnpW","Char","New password"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212106","Checksum does not match"]},{"entry":[{},"\u221212107","Email doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212108","Password doesn't match currently signed in"]},{"entry":[{},{},"user"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetStatus"},{"entry":"Get the current user's online status."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGst",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","UInt32","Online status."]},{"entry":[{},{},"\u2018FLN\u2019: offline"]},{"entry":[{},{},"\u2018NLN\u2019: online"]},{"entry":[{},{},"\u2018HDN\u2019: hidden"]},{"entry":[{},{},"\u2018BSY\u2019: busy"]},{"entry":[{},{},"\u2018IDL\u2019: idle"]},{"entry":[{},{},"\u2018BRB\u2019: be right back"]},{"entry":[{},{},"\u2018AWY\u2019: away"]},{"entry":[{},{},"\u2018PHN\u2019: on the phone"]},{"entry":[{},{},"\u2018LUN\u2019: out to lunch"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SetStatus"},{"entry":"Changes the current user's online status."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg4",{},{}]},{"entry":["Parameters","MemA","Char","Email address"]},{"entry":[{},"MpwD","Char","User password"]},{"entry":[{},"Mchk","Long","Checksum (not used, must be"]},{"entry":[{},{},{},"0)"]},{"entry":[{},"MnsT","Uint32","New status"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212106","Checksum does not match"]},{"entry":[{},"\u221212107","Email doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212108","Password doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212110","Status same as requested"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetFriendlyName"},{"entry":"Get the current user's email address."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGbn",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Unicode text","Buddy friendly name"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SetFriendlyName"},{"entry":"Changes the current user's buddy name."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg2",{},{}]},{"entry":["Parameters","MemA","Char","Email address"]},{"entry":[{},"MpwD","Char","User password"]},{"entry":[{},"Mchk","Long","Checksum (not used, must be"]},{"entry":[{},{},{},"0)"]},{"entry":[{},"MnnM","Unicode text","New friendly name"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212106","Checksum does not match"]},{"entry":[{},"\u221212107","Email doesn't match currently signed in"]},{"entry":[{},{},"user"]},{"entry":[{},"\u221212108","Password doesn't match currently signed in"]},{"entry":[{},{},"user"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_Preferences"},{"entry":"Brings up the preferences dialog"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Pref",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetVersion"},{"entry":"Returns Messenger's version number."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Mver",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Char","Version number (currently 3.0)"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetSignInStatus"},{"entry":"Get the current sign-in status for the specified user."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGss",{},{}]},{"entry":["Parameters","MemA","Char","Email address"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Uint32","Signed in\/Not signed in\/Signing in or"]},{"entry":[{},{},"out"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetAnySignInStatus"},{"entry":"Get the current sign-in status for the current user."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGAs",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","UInt32","Signed in\/Not signed in\/Signing in or"]},{"entry":[{},{},"out"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_GetUnreadEmailCount"},{"entry":"Get the current count of Hotmail's inbox unread messages."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MUEC",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Uint32","Email count"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_ShowContactWindow"},{"entry":"Show the main window and bring it to the front."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCWn",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Callbacks"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnSignIn"},{"entry":"Sent when sign-in process finishes successfully or failing."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Masi",{},{}]},{"entry":["Parameters","MBoo","Boolean","Did the process finish"]},{"entry":[{},{},{},"successfully"]},{"entry":[{},"Mrtn","SInt16","Error code if sign-in"]},{"entry":[{},{},{},"failed"]},{"entry":[{},"MEMs","Str255","Error description if sign-"]},{"entry":[{},{},{},"in failed"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnSignOut"},{"entry":"Sent when a user logged off successfully."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg1"]},{"entry":["Parameters","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"DMsgr_OnMyFriendlyNamechange"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg3",{},{}]},{"entry":["Parameters","MnnM","Unicode text","New friendly name"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnMyStatusChange"},{"entry":"Sent when the user online status is changed successfully."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Msg4",{},{}]},{"entry":["Parameters","MnsT","UInt32","New user status"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnNewEmail"},{"entry":"Sent when a new email message is received by Hotmail."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MNEm",{},{}]},{"entry":["Parameters","Mfrn","Unicode text","Sender's friendly name"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnUnreadEmailChange"},{"entry":"Sent when Hotmail's inbox unread email message count changes."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MUEC",{},{}]},{"entry":["Parameters","MEmC","Long Integer","New unread email count"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgr_OnQuit"},{"entry":"Sent when the Messenger Daemon is quitting."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Mqui"]},{"entry":["Parameters","None"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0112","num":"0112"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Contacts"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_Count"},{"entry":"Get the number of contacts on messenger's contact list"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCCo",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Long","Number of contacts"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_GetItem"},{"entry":"Get the ID of the contact at the specified index"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCIt",{},{}]},{"entry":["Parameters","Mind","Long","Index for the contact"]},{"entry":[{},{},{},"inside the contacts list"]},{"entry":["Return value","Char","Contact ID"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Invalid index"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_Add"},{"entry":"Brings up the add contact dialog to add contacts in the default group."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCAd",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_Remove"},{"entry":"Remove a contact from all the groups"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCRm",{},{}]},{"entry":["Parameters","Mcid","Char","Contact ID to be removed."]},{"entry":[{},{},{},"Returned by"]},{"entry":[{},{},{},"IMsgrContacts_GetItem."]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Invalid Contact ID"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_GetList"},{"entry":"Get the contact list."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCGL",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","AEDescList","AEDescList of AERecord, where each"]},{"entry":[{},{},"record represents a contact.Each AERecord"]},{"entry":[{},{},"contains:"]},{"entry":[{},{},"Char: sign-in name"]},{"entry":[{},{},"Unicode text: friendly name"]},{"entry":[{},{},"UInt16: status"]},{"entry":[{},{},"Boolean: blocked?"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContacts_ImportContactList"},{"entry":"Add the contacts specified in the list."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCIL",{},{}]},{"entry":["Parameters","IDsc","AERecord","The record contains:"]},{"entry":[{},{},{},"XML (Char): XML string"]},{"entry":[{},{},{},"containing the contacts as"]},{"entry":[{},{},{},"in a ctt file"]},{"entry":[{},{},{},"Mgnm (Unicode text):"]},{"entry":[{},{},{},"optional group name"]},{"entry":[{},{},{},"fPCt (Boolean): preserve"]},{"entry":[{},{},{},"the contacts already in the"]},{"entry":[{},{},{},"group"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","USer not signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_GetSignInName"},{"entry":"Gets the contact's email address."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCSN",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Char","Contact's email address"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_GetFriendlyName"},{"entry":"Gets the contact's friendly name."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCFN",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Unicode text","Contact's friendly name"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_GetStatus"},{"entry":"Gets the contact's status."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCSt",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Uint32","Contact's status (see IMsgr_GetStatus)"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_CanPage"},{"entry":"Check if the user can page this contact."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCCP",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Boolean","Contact's page status"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_GetBlocked"},{"entry":"Check if the user decided to block this contact."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCGB",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Boolean","Contact's block status"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_SetBlocked"},{"entry":"Try to set the blocked status for a contact."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCSB",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"MBoo","Boolean","New block status"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact Id is invalid"]},{"entry":[{},"\u221212200","Block\/unblock failed (current user not"]},{"entry":[{},{},"signed in or user canceled in the dialog)"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_AddToList"},{"entry":"Bring up the add contact dialog and prepopulate the email field with the"},{"entry":"specified address"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCAL",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","User not signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrContact_ViewIMHistory"},{"entry":"Show instant message history for the specified contact."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MVHi",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","User not signed in"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0113","num":"0113"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Callbacks"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContacts_OnAdd"},{"entry":"Sent when a new contact is added to the buddy list."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MAdc",{},{}]},{"entry":["Parameters","MCRc","AERecord","Full contact information as"]},{"entry":[{},{},{},"in IMsgrContacts_GetList"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContacts_OnRemove"},{"entry":"Sent when a contact is removed from the buddy list."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MRmC",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContact_OnFriendlyNameChange"},{"entry":"Sent when a contact's friendly name changed."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCFN",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"Mfrn","Unicode text","New friendly name"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContact_OnStatusChange"},{"entry":"Sent when a contact's status changed."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCSt",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"Mstt","UInt32","New contact's status"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContact_OnPagerChange"},{"entry":"Sent when a contact's pager status changed."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCCP",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"MBoo","Boolean","New pager status"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrContact_OnBlockedChange"},{"entry":"Sent when a contact's blocked status changed."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MCGB",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"MBoo","Boolean","New blocked status"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0114","num":"0114"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Groups"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_Count"},{"entry":"Get the number of groups on messenger's contact list"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGCo",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","Long","Number of groups"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_GetItem"},{"entry":"Get the ID of the contact at the specified index"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGIt",{},{}]},{"entry":["Parameters","Mind","Long","Index for the group inside"]},{"entry":[{},{},{},"the groups list"]},{"entry":["Return value","Long","Group ID"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212111","Invalid index"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_Create"},{"entry":"Get the ID of the contact at the specified index"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGCr",{},{}]},{"entry":["Parameters","Mgnm","Char","Name to be given to the"]},{"entry":[{},{},{},"group"]},{"entry":["Return value","none"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_Remove"},{"entry":"Get the ID of the contact at the specified index"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGRm",{},{}]},{"entry":["Parameters","Mgid","Long","Group ID to be removed."]},{"entry":[{},{},{},"Returned by"]},{"entry":[{},{},{},"IMsgrGroups_GetItem."]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212111","Invalid group ID"]},{"entry":[{},"\u221212112","Group cannot be removed because it is not"]},{"entry":[{},{},"empty"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_RemoveNamedGroup"},{"entry":"Get the ID of the contact at the specified index"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGRN",{},{}]},{"entry":["Parameters","Mgnm","Unicode","Name of the group to be"]},{"entry":[{},{},"string","removed"]},{"entry":[{},"fPCt","Boolean","Preserve contacts"]},{"entry":[{},"QIET","Boolean","Don't show any dialogs"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","User not signed in"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroups_GetList"},{"entry":"Get the group list."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGGL",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","AEDescList","AEDescList of AERecord, where each"]},{"entry":[{},{},"record represents a contact.Each AERecord"]},{"entry":[{},{},"contains:"]},{"entry":[{},{},"SInt32: service type"]},{"entry":[{},{},"Long: group ID"]},{"entry":[{},{},"Unicode text: group name"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_GetName"},{"entry":"Get group name"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGNm",{},{}]},{"entry":["Parameters","Mgid","long","Group ID whose name we"]},{"entry":[{},{},{},"want to get Returned by"]},{"entry":[{},{},{},"IMsgrGroups_GetItem."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Unicode text","Group name"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212111","Group ID invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_SetName"},{"entry":"Rename a group"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGRn",{},{}]},{"entry":["Parameters","Mgid","Long","Group ID to be renamed."]},{"entry":[{},{},{},"Returned by"]},{"entry":[{},{},{},"IMsgrGroups_GetItem."]},{"entry":[{},"Mgnm","Unicode text","New group name"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212111","Group ID invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_MoveContact"},{"entry":"Move a contact from one group to another"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGMv",{},{}]},{"entry":["Parameters","Mgif","long","Group ID containing the"]},{"entry":[{},{},{},"contact"]},{"entry":[{},"Mgid","Long","Group ID where we want to"]},{"entry":[{},{},{},"move the contact"]},{"entry":[{},"Mcid","Char","Contact ID we want to move"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact ID invalid"]},{"entry":[{},"\u221212111","Group ID invalid"]},{"entry":[{},"\u221212113","Contact is not included in original group"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_CopyContact"},{"entry":"Copy a contact to another group"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGCp",{},{}]},{"entry":["Parameters","Mgid","Long","Group ID where we want to"]},{"entry":[{},{},{},"copy the contact"]},{"entry":[{},"Mcid","Char","Contact ID we want to copy"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact ID invalid"]},{"entry":[{},"\u221212111","Group ID invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_RemoveContact"},{"entry":"Remove a contact from the specified group"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGRC",{},{}]},{"entry":["Parameters","Mgid","Long","Group ID where we want to"]},{"entry":[{},{},{},"remove the contact from"]},{"entry":[{},"Mcid","Char","Contact ID we want to"]},{"entry":[{},{},{},"remove"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact ID invalid"]},{"entry":[{},"\u221212111","Group ID invalid"]},{"entry":[{},"\u221212113","Contact is not included in group"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrGroup_ContainsContact"},{"entry":"Check if the group contains a contact"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MGCC",{},{}]},{"entry":["Parameters","Mgid","Long","Group ID where we want to"]},{"entry":[{},{},{},"search for the contact"]},{"entry":[{},"Mcid","Char","Contact ID we want to find"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","Boolean","Boolean value specifying if the contact is"]},{"entry":[{},{},"included in the group or not"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212105","Contact ID invalid"]},{"entry":[{},"\u221212111","Group ID invalid"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0115","num":"0115"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Callbacks"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroups_OnAdd"]},{"entry":[{},"Sent when a group is added"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGCr",{},{}]},{"entry":[{},"Parameters"]},{"entry":[{},{},"Mgid","Long","Group Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroups_OnRemove"]},{"entry":[{},"Sent when a group is removed"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGRm",{},{}]},{"entry":[{},"Parameters"]},{"entry":[{},{},"Mgid","Long","Group Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroup_OnNamechange"]},{"entry":[{},"Sent when a group name changes"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGRn",{},{}]},{"entry":[{},"Parameters"]},{"entry":[{},{},"Mgid","Long","Group Id"]},{"entry":[{},{},"Mgnm","Unicode text","Group name"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroup_OnContactMove"]},{"entry":[{},"Sent when a contact is moved from one group to another"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGMv",{},{}]},{"entry":[{},"Parameters","Mcid","Char","Contact Id"]},{"entry":[{},{},"Mgif","Long","Group Id the contact is"]},{"entry":[{},{},{},{},"moved from"]},{"entry":[{},{},"Mgid","Long","Group Id the contact is"]},{"entry":[{},{},{},{},"moved to"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroup_OnContactCopy"]},{"entry":[{},"Sent when a contact is copied from one group to another"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGCp",{},{}]},{"entry":[{},"Parameters","Mcid","Char","Contact Id"]},{"entry":[{},{},"Mgid","Long","Group Id the contact is"]},{"entry":[{},{},{},{},"copied to"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DMsgrGroup_OnContactRemove"]},{"entry":[{},"Sent when a contact is removed from a group"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Event ID","MGRC",{},{}]},{"entry":[{},"Parameters","Mcid","Char","Contact Id"]},{"entry":[{},{},"Mgid","Long","Group Id"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0116","num":"0116"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Sessions"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrSessionManager_RegisterApplication"},{"entry":"Register an application with messenger so that it can receive callback"},{"entry":"notifications."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MReg",{},{}]},{"entry":["Parameters","Mapp","Char","Application Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212300","Session manager not created yet"]},{"entry":[{},"\u221212301","Application already registered"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrSessionManager_RegisterAndRetain"},{"entry":"Register an application with messenger so that it can receive callback"},{"entry":"notifications. Additional flag specifying if the client retains the Messenger"},{"entry":"Daemon running."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MRgR",{},{}]},{"entry":["Parameters","Mapp","Char","Application ID"]},{"entry":[{},"Mkrn","Boolean","Keep running (retain"]},{"entry":[{},{},{},"Daemon)"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212300","Session manager not created yet"]},{"entry":[{},"\u221212301","Application already registered"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrSessionManager_UnRegisterApplication"},{"entry":"UnRegister an application with messenger so that it will no longer receive"},{"entry":"callback notifications."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MUnr",{}]},{"entry":["Parameters","None"]},{"entry":["Return value","None"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212300","Session manager not created yet"]},{"entry":[{},"\u221212302","Application is not registered"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrLock_Status"},{"entry":"Get the lock & key status."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MLgs",{},{}]},{"entry":["Parameters","Mapp","Char","Application Id"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","SInt16","Lock & key status"]},{"entry":[{},{},"1: Locked"]},{"entry":[{},{},"2: Tying to unlock"]},{"entry":[{},{},"3: Unlocked"]},{"entry":[{},{},"4: Unlock failed"]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212302","Application is not registered"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrLock_RequestChallenge"},{"entry":"Request a challenge from the server."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MLrc",{},{}]},{"entry":["Parameters","Mapp","Char","Application Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212302","Application is not registered"]},{"entry":[{},"\u221212304","Already tried to unlock and failed"]},{"entry":[{},"\u221212305","Already trying to unlock"]},{"entry":[{},"\u221212306","Already unlocked"]},{"entry":[{},"\u221212307","Server doesn't support lock & key"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgrLock_SendResponse"},{"entry":"Send the lock&key response to the server."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MLsr",{},{}]},{"entry":["Parameters","Mapp","Char","Application Id"]},{"entry":[{},"MLSt","Char","Response string"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Return value","None",{}]},{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212302","Application is not registered"]},{"entry":[{},"\u221212304","Already tried to unlock and failed"]},{"entry":[{},"\u221212305","Already trying to unlock"]},{"entry":[{},"\u221212306","Already unlocked"]},{"entry":[{},"\u221212307","Server doesn't support lock & key"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_InstantMessage"},{"entry":"Initiate a chat session with the contact with the Contact id."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MSim",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212104","Current user isn't online"]},{"entry":[{},"\u221212105","Contact Id invalid"]},{"entry":[{},"\u221212300","Session manager not created yet"]},{"entry":[{},"\u221212302","Application is not registered"]},{"entry":[{},"\u221212309","Interface is locked"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SendMail"},{"entry":"Send an email to the contact specified"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MShm",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212104","Current user isn't online"]},{"entry":[{},"\u221212105","Contact Id invalid"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"IMsgr_SendFile"},{"entry":"Transfer a file to the contact specified"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"112pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","MSFl",{},{}]},{"entry":["Parameters","Mcid","Char","Contact Id"]},{"entry":[{},"Mfss","URL","File to send"]},{"entry":["Return value","None"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Error codes","\u2009\u2009\u2003\u20030","Succeeded"]},{"entry":[{},"\u221212100","No user currently signed in"]},{"entry":[{},"\u221212104","Current user isn't online"]},{"entry":[{},"\u221212105","Contact Id invalid"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0117","num":"0117"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Callbacks"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrLock_OnChallenge"},{"entry":"Sent to all registered applications when received a challenge string from"},{"entry":"the server."},{"entry":"And sent to the challenge requester when the request failed to go through."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"126pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Mloc",{},{}]},{"entry":["Parameters","MLSt","Char","Challenge string"]},{"entry":[{},"Mrtn","Sint16","OSErr or"]},{"entry":[{},{},{},"0: Succeed"]},{"entry":[{},{},{},"12303: Request failed to go through"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrLock_OnResult"},{"entry":"Sent to unlock requester"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"126pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Mlor",{},{}]},{"entry":["Parameters","Mboo","Boolean","Unlock succeed?"]},{"entry":[{},"Mrtn","Sint16","OSErr or"]},{"entry":[{},{},{},"0: Succeed"]},{"entry":[{},{},{},"12303: Request failed to go through"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"DMsgrLock_OnEnable"},{"entry":"Sent to unlock requester"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"126pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Event ID","Mloe",{},{}]},{"entry":["Parameters","Mboo","Boolean","Unlock succeed?"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0118","num":"0118"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"OSErr IMsgr_Preferences( );"]},{"entry":[{},"OSErr IMsgr_SignIn(Str255, Str255, long);"]},{"entry":[{},"OSErr IMsgr_SignOut( );"]},{"entry":[{},"OSErr IMsgr_SetFriendlyName(Str255, Str255, long, UniStr255);"]},{"entry":[{},"OSErr IMsgr_SetPassword(Str255, Str255, long, Str255);"]},{"entry":[{},"OSErr IMsgr_SetStatus(Str255, Str255, long, UInt32);"]},{"entry":[{},"OSErr IMsgr_GetVersion(Str255);"]},{"entry":[{},"OSErr IMsgr_AutoSignIn( );"]},{"entry":[{},"OSErr IMsgr_ShowSignInDialog( );"]},{"entry":[{},"OSErr IMsgr_GetSignInName(Str255);"]},{"entry":[{},"OSErr IMsgr_SetDefaultSignInName(Str255);"]},{"entry":[{},"OSErr IMsgr_GetFriendlyName(UniStr255);"]},{"entry":[{},"OSErr IMsgr_GetStatus(UInt32*);"]},{"entry":[{},"OSErr IMsgr_InstantMessage(Str255);"]},{"entry":[{},"OSErr IMsgr_SendFile(Str255, FSSpec, Boolean);"]},{"entry":[{},"OSErr IMsgr_SendMail(Str255);"]},{"entry":[{},"OSErr IMsgr_GetSignInStatus(Str255,UInt32*);"]},{"entry":[{},"OSErr IMsgr_GetAnySignInStatus(UInt32*);"]},{"entry":[{},"OSErr IMsgr_GetUnreadEmailCount(long*);"]},{"entry":[{},"OSErr IMsgr_ShowContactWindow( );"]},{"entry":[{},"OSErr IMsgrContacts_Count(long*);"]},{"entry":[{},"OSErr IMsgrContacts_GetItem(long,Str255);"]},{"entry":[{},"OSErr IMsgrContacts_Add( );"]},{"entry":[{},"OSErr IMsgrContacts_Remove(Str255);"]},{"entry":[{},"OSErr IMsgrContacts_GetList (AEDescList*);"]},{"entry":[{},"OSErr IMsgrContacts_ImportContactList(AERecord);"]},{"entry":[{},"OSErr IMsgrContact_GetSignInName(Str255,Str255);"]},{"entry":[{},"OSErr IMsgrContact_GetFriendlyName(Str255,UniStr255);"]},{"entry":[{},"OSErr IMsgrContact_GetStatus(Str255,UInt32*);"]},{"entry":[{},"OSErr IMsgrContact_CanPage(Str255,Boolean*);"]},{"entry":[{},"OSErr IMsgrContact_GetBlocked(Str255,Boolean*);"]},{"entry":[{},"OSErr IMsgrContact_SetBlocked(Str255, Boolean);"]},{"entry":[{},"OSErr IMsgrContact_AddToList(Str255);"]},{"entry":[{},"OSErr IMsgrContact_ViewIMHistory(Str255);"]},{"entry":[{},"OSErr IMsgrGroups_Count(long*);"]},{"entry":[{},"OSErr IMsgrGroups_GetItem(long, long*);"]},{"entry":[{},"OSErr IMsgrGroups_Create(Str255);"]},{"entry":[{},"OSErr IMsgrGroups_Remove(long);"]},{"entry":[{},"OSErr IMsgrGroups_RemoveNamedGroup(UniStr255, Boolean,"]},{"entry":[{},"Boolean);"]},{"entry":[{},"OSErr IMsgrGroups_GetList(AEDescList*);"]},{"entry":[{},"OSErr IMsgrGroup_GetName(long,UniStr255);"]},{"entry":[{},"OSErr IMsgrGroup_SetName(long, UniStr255);"]},{"entry":[{},"OSErr IMsgrGroup_MoveContact(Str255, long, long);"]},{"entry":[{},"OSErr IMsgrGroup_CopyContact(Str255, long);"]},{"entry":[{},"OSErr IMsgrGroup_RemoveContact(Str255, long);"]},{"entry":[{},"OSErr IMsgrGroup_ContainsContact(Str255,long,Boolean*);"]},{"entry":[{},"OSErr IMsgrSession_RegisterApplication(Str255 stAppID,"]},{"entry":[{},"CallbackFunctions cb);"]},{"entry":[{},"OSErr IMsgrSessionManager_RegisterAppAndRetain( Str255,"]},{"entry":[{},"CallbackFunctions, Boolean);"]},{"entry":[{},"OSErr IMsgrSessionManager_UnRegisterApplication( );"]},{"entry":[{},"OSErr IMsgrLock_Status(SInt16*);"]},{"entry":[{},"OSErr IMsgrLock_RequestChallenge( );"]},{"entry":[{},"OSErr IMsgrLock_SendResponse(Str255);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"The CallbackFunctions structure contains the pointers to the handlers for each of the desired callback events. The pointer should be NULL if the application does not want to handle the corresponding type of event.",{"@attributes":{"id":"p-0120","num":"0120"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"typedef struct {"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnSignIn) ( );"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnSignOut) ( );"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnBuddyNameChange) (UniStr255);"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnStatusChange) (UInt32);"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnUnreadEmailChange) (long);"},{"entry":"\u2003\u2003OSErr (*pfnMsgrOnQuit) ( );"},{"entry":"\u2003\u2003OSErr (*pfnContactsOnAdd) (Str255);"},{"entry":"\u2003\u2003OSErr (*pfnContactsOnRemove) (Str255);"},{"entry":"\u2003\u2003OSErr (*pfnContactOnFriendlyNameChange) (Str255,UniStr255);"},{"entry":"\u2003\u2003OSErr (*pfnContactOnStatusChange) (Str255,UInt32);"},{"entry":"\u2003\u2003OSErr (*pfnContactOnPagerChange) (Str255,Boolean);"},{"entry":"\u2003\u2003OSErr (*pfnContactOnBlockedChange) (Str255,Boolean);"},{"entry":"\u2003\u2003OSErr (*pfnGroupsOnAdd) (long);"},{"entry":"\u2003\u2003OSErr (*pfnGroupsOnRemove) (long);"},{"entry":"\u2003\u2003OSErr (*pfnGroupOnNameChange) (long,Str255);"},{"entry":"\u2003\u2003OSErr (*pfnGroupOnContactMove) (Str255,long,long);"},{"entry":"\u2003\u2003OSErr (*pfnGroupOnContactCopy) (Str255,long);"},{"entry":"\u2003\u2003OSErr (*pfnGroupOnContactRemove) (Str255,long);"},{"entry":"\u2003\u2003OSErr (*pfnLockOnChallenge) (SInt16,Str255);"},{"entry":"\u2003\u2003OSErr (*pfnLockOnResult) (SInt16,Boolean);"},{"entry":"\u2003\u2003OSErr (*pfnLockOnEnable) (Boolean);"},{"entry":"} CallbackFunctions;"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"As described above, the functionality was divided into two different components, which communicate using an internal AppleEvents interface comprised of messages. These messages basically respond to the following situations:","From the ServerApp to the Up:","Start logon\/logoff","Signed in\/out","Logon user status changed","Show sign-in dialog","Logon user friendly name changed","Logon user rename failed","Show add contact dialog","Add contact to list","Remove contact from list","Contact online status","Contact add\/remove failure","Contact allowed\/blocked","Allow\/block contact failed","Import contact list","Group added","Add group failed","Group removed","Group renamed","Contact copied\/moved to group","Contact removed from group","Begin IM\/send file","Contact started a chat with you","Open IM window","View IM history","Show contact window","Show preferences","Preferences changed","Hotmail count","Hotmail count changed\/new mail","Notification received","New URLs from server","Client application update","System messages","Disconnected from the server","Error message from the server","Network connection lost","From the UIApp to the ServerApp","UIApp has launched","UIApp is quitting","Start logon","Cancel logon","Logoff","Is logged on?","Get logon user info","Change logon user friendly name","Set logon user status","Set\/get next logon user","Edit logon user page properties","Set logon user save\/delete log properties","Set logon user spam preferences","Set\/get preferences","Get group\/contact lists","Add contact","Batch add users","Remove a contact","Allow\/block contact","Batch block\/unblock contacts","Send hotmail to contact","Send recruitment mail","Page contact","Upload contact properties","Add a group","Remove a group","Rename a group","Copy\/move contact to group","Remove user from group","Expand\/collapse group","Get inbox count","Forget Hotmail messages","Get chat connection","Request URL from server","As can be seen from the foregoing detailed description, there is provided a method and system for integrating instant messaging with other computer programs. Instant messaging can thus be used in many real-time scenarios without leaving a running program, such as when collaborating on documents. The method and system thus provide significant advantages and benefits needed in contemporary computing.","While the invention is susceptible to various modifications and alternative constructions, certain illustrated embodiments thereof are shown in the drawings and have been described above in detail. It should be understood, however, that there is no intention to limit the invention to the specific forms disclosed, but on the contrary, the intention is to cover all modifications, alternative constructions, and equivalents falling within the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIGS. 3A-3C"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
