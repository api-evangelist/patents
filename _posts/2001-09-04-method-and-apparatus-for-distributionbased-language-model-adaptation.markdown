---
title: Method and apparatus for distribution-based language model adaptation
abstract: A method and apparatus are provided for adapting a language model to a task-specific domain. Under the method and apparatus, the relative frequency of n-grams in a small training set (i.e. task-specific training data set) and the relative frequency of n-grams in a large training set (i.e. out-of-domain training data set) are used to weight a distribution count of n-grams in the large training set. The weighted distributions are then used to form a modified language model by identifying probabilities for n-grams from the weighted distributions.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07043422&OS=07043422&RS=07043422
owner: Microsoft Corporation
number: 07043422
owner_city: Redmond
owner_country: US
publication_date: 20010904
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["The present application claims priority from a Provisional Application having Ser. No. 60\/240,390, filed on Oct. 13, 2000 and naming inventors Mingjing Li, Zheng Chen, Kai-Fu Lee and JianFeng Gao.","The present invention relates to language models. In particular, the present invention relates to training language models for specific domains.","Language models provide a measure of the likelihood of a series of words appearing in a string of text. Such models are used in speech recognition, character segmentation, and pinyin-to-character conversion to identifying a most likely sequence of words given a lattice of possible sequences. For example, in speech recognition, a language model would identify the phrase \u201cgo to bed\u201d as being more likely than the phonetically similar phrase \u201cgo too bed\u201d.","Since most current techniques of language modeling are statistically based, a language model is usually trained on text that is similar to the text that the language model will decode. If the training data and the user data are too different, the probabilities used by the language model will not accurately reflect the likelihood of the text in the user data. In particular, if the user data is focused on a specific domain and that domain is not well represented in the training data, the language model probabilities will not be reliable for most of the text in the user data. This causes the language model to give preference to a sequence of words that does not accurately match the user data.","To overcome this problem, the prior art has built task-specific language models that are trained only on data from the task-specific domain, which is always insufficient to train a reliable language model. So during decoding, the task-specific model usually works with a general language model\u2014that is, both models provide probabilities for certain sequences of words,\u2014and the resulting probabilities are linearly combined by applying a weight to the task-specific language model. This technique was thought to shift the probability of the general language model toward the probability provided by the task-specific language model.","To set the weights for the linear combination of probabilities, the prior art adjusted the weights to minimize perplexity, which is defined as:",{"@attributes":{"id":"p-0008","num":"0007"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"PP","mo":"=","mrow":{"msup":{"mn":"2","mrow":{"mo":"-","mfrac":{"mn":"1","mi":"N"}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"N"},"mo":"\u2062","mrow":{"mi":"log","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["w","i"]},{"mi":"w","mrow":{"mi":"i","mo":"-","mn":"1"}}],"mo":"|"}}}}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"1"}}]}}}},"br":{},"sub":["i","i\u22121"],"sup":["th ","th "]},"However, systems that combine the probabilities provided by a task-specific model and a general model have not provided a significant reduction in the error rate associated with task-specific data. One reason for this is that the perplexity does not correlate well with error rate when language model probabilities are linearly combined. Thus, a language model is needed that can perform well on task-specific words even when there is only a limited amount of task-specific training data available.","A method and apparatus are provided for adapting a language model to a task-specific domain. Under the method and apparatus, the relative frequency of n-grams in a small training set and the relative frequency of n-grams in a large training set are used to weight a distribution count of n-grams in the large training set. The weighted distributions are then used to form a modified language model by identifying probabilities for n-grams from the weighted distributions.",{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, telephony systems, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 3","FIGS. 1 and 2","FIGS. 5 and 6"],"b":["300","300","302","304","304","308","310","308","310"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 4","FIGS. 1 and 2","FIG. 4"],"b":["400","402","404","406"]},"A-to-D converter  converts the analog signal from microphone  into a series of digital values. In several embodiments, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second.","The digital data created by A-to-D converter  is provided to an optional noise reduction module , which removes some of the noise in the digital signal using one or more noise reduction techniques.","The output of noise reduction module  is provided to a feature extractor , which extracts a feature from the digital speech signal. Examples of feature extraction modules include modules for performing Linear Predictive Coding (LPC), LPC derived cepstrum, Perceptive Linear Prediction (PLP), Auditory model feature extraction, and Mel-Frequency Cepstrum Coefficients (MFCC) feature extraction. Note that the invention is not limited to these feature extraction modules and that other modules may be used within the context of the present invention.","The feature extraction module receives the stream of digital values from noise reduction module  and produces a stream of feature vectors that are each associated with a frame of the speech signal. In many embodiments, the centers of the frames are separated by 10 milliseconds.","Note that although noise reduction module  is shown before feature extractor  in the embodiment of , in other embodiments, noise reduction module  appears after feature extractor .","The stream of feature vectors produced by the extraction module is provided to a decoder , which identifies a most likely sequence of words based on the stream of feature vectors, a lexicon , a language model , and an acoustic model .","Acoustic model  provides a probability that an input feature vector was created by the pronunciation of a linguistic unit such as a senone, phoneme, diphone, or triphone.","Language model  provides a set of likelihoods that a particular sequence of words will appear in the language of interest. Under the present invention, the language model is a statistical n-gram model that predicts the likelihood of a next word given n\u22121 previous words. Thus, in an embodiment that uses a trigram model, the language model predicts the likelihood of a next word given the two previous words. The formation of the language model is discussed further below in connection with .","Based on the acoustic model, the language model, and the lexicon, decoder  identifies a most likely sequence of words from all possible word sequences. The particular method used for decoding is not important to the present invention and any of several known methods for decoding may be used.","The most probable sequence of hypothesis words is provided to a confidence measure module . Confidence measure module  identifies which words are most likely to have been improperly identified by the speech recognizer, based in part on a secondary frame-based acoustic model. Confidence measure module  then provides the sequence of hypothesis words to an output module  along with identifiers indicating which words may have been improperly identified. Those skilled in the art will recognize that confidence measure module  is not necessary for the practice of the present invention.","Under the present invention a task specific language model is formed by adapting general out-of-task training data based on a small set of task-specific training data. For example, under one embodiment, the out-of-task training set consists of 300 million characters collected from Chinese web sites while the task-specific data contains 40 million characters taken from specialized documents. A method for forming this language model under one embodiment of the present invention is described below using the block diagram of  and the flow diagram of .","In step  of , an n-gram is selected from a set of possible n-grams in the language. For example, in an embodiment that uses bi-grams, a pair of words would be selected in step . In an embodiment that uses tri-grams, a set of three words would be selected.","At step , a distribution adapter  determines the relative frequency of the selected n-gram in a set of task-specific data . Thus, if the n-gram selected is (dog, a), distribution adapter  determines the relative frequency with which \u201ca dog\u201d appears in the task-specific data. Under one embodiment the relative frequency is defined as:",{"@attributes":{"id":"p-0049","num":"0048"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},"mo":"=","mfrac":{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"munder":{"mo":"\u2211","mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}},"mo":"\u2062","mrow":{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"2"}}]}}}},"br":{},"sub":["1","n","1","n","1","n"]},{"@attributes":{"id":"p-0050","num":"0049"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"munder":{"mo":"\u2211","mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",",","],"mi":"\u2026"}},"mo":"\u2062","mrow":{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}}}},"br":{}},"After the relative frequency of the n-gram in the task-specific data has been determined, a set of out-of-task training data  is selected at step . Under some embodiments, only a single set of out-of-task training data is provided. However, in other embodiments, multiple sets of out-of-task training data are available. The number of out-of-task training sets used with the present invention is a matter of design choice.","At step , the relative frequency of the n-gram in the selected out-of-task training set is determined using equation 2 above. Note that in determining the relative frequency of the n-gram, the count for the n-gram is also determined.","At step , a weight is calculated for the selected n-gram. This weight will later be used to adapt the count of the n-gram in the out-of-task training set so that it reflects the count of the n-gram in the task-specific data set . Under one embodiment, the weight is determined as:",{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mi":["W","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},"mo":"=","msup":{"mrow":{"mi":"log","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":[{"msub":{"mi":["p","specific"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"msub":{"mi":["p","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}]}}},"mi":"\u03b1"}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"3"}}]}}}},"br":{},"sub":["i","1","n","i","1","n","specific","1","n"]},"Once the weight for the selected training set has been calculated, the process continues at step  where distribution adapter  determines if there are more out-of-task training sets . If there are more out-of-task training sets, the process returns to step  where the next training set is selected. Steps  and  are then repeated for the next training set.","Once a weight has been formed for all of the training sets, each weight is multiplied by the count of the n-gram in the respective out-of-task training set. The resulting products are summed together to form an adapted count for the n-gram at step . In terms of an equation, step  is defined as:",{"@attributes":{"id":"p-0057","num":"0056"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"munderover":{"mo":"\u2211","mrow":{"mi":"i","mo":"=","mn":"1"},"mi":"J"},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["W","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"msub":{"mi":["C","i"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":["w","n"]}],"mo":[",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}],"mo":"\u00d7"}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"4"}}]}}}},"br":{},"sub":["i","1","n","i","1","n","1","n"]},"After the adapted count has been formed for the selected n-gram, the process continues at step , where distribution adapter  determines if there are any other n-grams to be processed. If there are additional n-grams, the process returns to step  where the next n-gram is selected. Steps , , , , , and  are then repeated for the newly selected n-gram.","When there are no more n-grams to be processed at step , an adapted count has been formed for each n-gram. These adapted counts are then passed to a probability calculator , which determines probabilities that describe the distribution of n-grams at step . For example, under some embodiments, probability calculator  determines the probability of each n-gram by dividing the adapted count of the n-gram by the sum of the counts of n-grams that share the same set of previous words. For example, if the two tri-grams (w, w, w) and (w, w, w) are the only tri-grams that start with (w, w) then the probability of (w, w, w) would be calculated as:",{"@attributes":{"id":"p-0060","num":"0059"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"3"}],"mo":[",",","]}}},"mo":"=","mfrac":{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"3"}],"mo":[",",","]}}},{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"3"}],"mo":[",",","]}}},{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"4"}],"mo":[",",","]}}}],"mo":"+"}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"5"}}]}}}},"br":{},"sub":["1","2","4"]},{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"4"}],"mo":[",",","]}}},"mo":"=","mfrac":{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"4"}],"mo":[",",","]}}},{"mrow":[{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"3"}],"mo":[",",","]}}},{"mi":"C","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"w","mn":"1"},{"mi":"w","mn":"2"},{"mi":"w","mn":"4"}],"mo":[",",","]}}}],"mo":"+"}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"6"}}]}}}}},"The resulting probabilities are then stored as language model  of .","To further improve the adaptation provided by the present invention, some embodiments of the present invention use a cross-validation process to select the adaptation coefficient \u03b1. This cross-validation process is described in the flow diagram of .","In step  of , the set of task-specific training data  is divided into multiple sets of training data by distribution adapter . At step , distribution adapter  selects one of the sets as a test set and groups the other sets to form a seed set. The seed set will be used to identify the weights for the adaptation while the test set will be used to generate a perplexity measure to estimate the effectiveness of various values of \u03b1.","At step , a starting value for \u03b1 is selected. Under some embodiments, this starting value is 0. At step , the seed set and the selected \u03b1 are used in the process of  to generate a modified count. This modified count is then used in step  to form a set of probabilities that form a modified language model.","At step , the modified language model is used to generate probabilities used in the perplexity calculation of equation 1. At step , this perplexity is compared to previous perplexity calculations to determine if the perplexity is increasing. During the first pass through the flow diagram of , the perplexity has not been calculated. As such, it is not considered to be increasing at step .","If the perplexity is not increasing, \u03b1 is increased at step . The amount of increase is a matter of choice that balances accuracy in the final \u03b1 with resources used in determining \u03b1. After \u03b1 has been increased, the process returns to step , and steps , , , and  are repeated using the new \u03b1.","When the perplexity begins to increase at step , the previous value for \u03b1 is considered to be the best \u03b1 for the current test set because it provides the lowest perplexity. This value for \u03b1 is thus stored at step .","At step , distribution adapter  determines if each of the sets formed from the task-specific data has been used as a test set. If a set has not been used as a test set, it is selected as the test set at step , and the remaining sets of task-specific data are grouped as a new seed set. The process of  then returns to step , where \u03b1 is reset to its starting value. Steps , , , , , and  are then repeated for the new test set to identify a best value for \u03b1 for the new test set.","After all of the sets of task-specific data have been used as a test set at step , an average value for \u03b1 is calculated at step  by averaging the best values for a that were stored for each test set. The average value for \u03b1 is then used in the process of , together with all of the task-specific data, to modify the count of the out-of-task data. This modified count is then used to calculate the probabilities that form the final language model at step .","By modifying the counts of a large out-of-task data set based on the counts provided by a small set of task-specific data, the present invention provides a significant decrease in the error rate associated with decoding task-specific user data. In particular, the present invention performs much better than prior art systems that formed language models by linearly combining the probabilities provided by a general (i.e. out-of-task) model and a task-specific model.","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
