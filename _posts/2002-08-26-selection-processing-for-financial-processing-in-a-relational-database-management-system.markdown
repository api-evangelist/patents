---
title: Selection processing for financial processing in a relational database management system
abstract: A Value Analyzer system is a data-driven computer-facilitated financial model that provides accurate and consistent profitability calculations using account and event data stored in a relational database managed by a relational database management system (RDBMS), wherein the account data comprises attributes of the accounts being measured and the event data comprises attributes of account-related transactions. A selector function uses selection criteria to select accounts and events from the relational database in order to generate a number of inputs for profitability calculations.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07680709&OS=07680709&RS=07680709
owner: Teradata US, Inc.
number: 07680709
owner_city: Miamisburg
owner_country: US
publication_date: 20020826
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT","Overview","Hardware and Software Environment","Value Analyzer Operation","Value Analyzer Data Flow","Selector Function","Logic of the Preferred Embodiment","CONCLUSION"],"p":["This application is a continuation-in-part of the following co-pending and commonly assigned patent applications:","Utility application Ser. No. 10\/227,909, filed on same date herewith, by Brian J. Wasserman and Thomas K. Ryan, entitled \u201cPLATFORM INDEPENDENT ARCHITECTURE FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 10\/227,726, filed on same date herewith, by Richard C. Schwarz, Brian J. Wasserman, Sang Y. Yum and Thomas K. Ryan, entitled \u201cDRIVER AMOUNT\/COUNT SELECTION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 10\/228,031, filed on same date herewith, by Brian J. Wasserman, entitled \u201cOBJECT-ORIENTED REPRESENTATION OF A GENERIC PROFITABILITY RULE FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 10\/227,976, filed on same date herewith, by Brian J. Wasserman, George R. Hood and Thomas K. Ryan, entitled \u201cDISCRETE PROFITABILITY CALCULATIONS FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 10\/228,022, filed on same date herewith, by Brian J. Wasserman, George R. Hood and Thomas K. Ryan, entitled \u201cRULES-BASED, DATA-DRIVEN PROFITABILITY CALCULATIONS FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 10\/016,779, filed on Dec. 10, 2001 now U.S. Pat. No. 7,249,138, by Brian J. Wasserman, entitled \u201cPARALLEL SELECTION PROCESSING FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 10\/013,422, 10\/013,434 and 10\/016,452;","Utility application Ser. No. 10\/013,422, filed on Dec. 10, 2001, by Brian J. Wasserman, entitled \u201cACCOUNT SELECTION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 10\/016,779, 10\/013,434, and 10\/016,452;","Utility application Ser. No. 10\/013,434, filed on Dec. 10, 2001 now U.S. Pat. No. 7,461,025, by Brian J. Wasserman, entitled \u201cDRIVER AMOUNT AND COUNT SELECTION PROCESSING FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 10\/016,779, 10\/013,422, and 10\/016,452;","Utility application Ser. No. 10\/016,452, filed on Dec. 10, 2001 now U.S. Pat. No. 7,383,214, by Brian J. Wasserman, George R. Hood, and Thomas K. Ryan, entitled \u201cDYNAMIC EVENT SELECTION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 10\/016,779, 10\/013,422, 10\/013,434, 09\/845,461, 09\/845,924, 09\/845,851, 09\/608,355, 09\/610,646, 09\/608,681, 09\/608,675, 09\/608,342, and 09\/608,682;","Utility application Ser. No. 09\/845,461, filed on Apr. 30, 2001 now U.S. Pat. No. 7,512,554, by George R. Hood, entitled \u201cTAX ADJUSTMENT FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 09\/608,355, 09\/610,646, 09\/608,681, 09\/608,675, 09\/608,342, and 09\/608,682;","Utility application Ser. No. 09\/845,924, filed on Apr. 30, 2001 now U.S. Pat. No. 7,308,427, by George R. Hood, entitled \u201cAMORTIZATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 09\/608,355, 09\/610,646, 09\/608,681, 09\/608,675, 09\/608,342, and 09\/608,682;","Utility application Ser. No. 09\/845,851, filed on Apr. 30, 2001 now U.S. Pat. No. 7,337,134, by George R. Hood, entitled \u201cSHAREHOLDER VALUE ADD FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 09\/608,355, 09\/610,646, 09\/608,681, 09\/608,675, 09\/608,342, and 09\/608,682;","Utility application Ser. No. 09\/608,355, filed on Jun. 29, 2000 now U.S. Pat. No. 7,343,332, by George R. Hood and Paul H. Phibbs, Jr., entitled \u201cADVANCED AND BREAKTHROUGH NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 09\/610,646, filed on Jun. 29, 2000 now U.S. Pat. No. 7,349,875, by George R. Hood and Paul H. Phibbs, Jr., entitled \u201cBASIC AND INTERMEDIATE NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 09\/608,681, filed on Jun. 29, 2000 now U.S. Pat. No. 7,349,874, by George R. Hood, entitled \u201cOTHER REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 09\/608,675, filed on Jun. 29, 2000 now abandoned, by George R. Hood, entitled \u201cDIRECT EXPENSE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d;","Utility application Ser. No. 09\/608,342, filed on Jun. 29, 2000 now abandoned, by George R. Hood, entitled \u201cINDIRECT EXPENSE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM\u201d; and","Utility application Ser. No. 09\/608,682, filed on Jun. 29, 2000 now U.S. Pat. No. 7,409,365, by George R. Hood, entitled \u201cRISK PROVISION IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d;","all of which applications are incorporated by reference herein.","Finally, this application is related to the following co-pending and commonly assigned patent applications:","Utility application Ser. No. 09\/943,060, filed on Aug. 30, 2001, by Paul H. Phibbs, Jr., entitled \u201cCAPITAL ALLOCATION IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which claims the benefit under 35 U.S.C. \u00a7119(e) to Provisional Application Ser. No. 60\/253,281, filed Nov. 27, 2000, by Paul H. Phibbs, Jr., entitled \u201cCAPITAL ALLOCATION IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d and Provisional Application Ser. No. 60\/253,254, filed Nov. 27, 2000, by Paul H. Phibbs, Jr., entitled \u201cALLOCATED BALANCES IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d and which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 09\/608,355 and 09\/610,646;","Utility application Ser. No. 09\/943,059, filed on Aug. 30, 2001, by Paul H. Phibbs, Jr., entitled \u201cALLOCATED BALANCES IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d which claims the benefit under 35 U.S.C. \u00a7119(e) to Provisional Application Ser. No. 60\/253,254, filed Nov. 27, 2000, by Paul H. Phibbs, Jr., entitled \u201cALLOCATED BALANCES IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d and Provisional Application Ser. No. 60\/253,281, filed Nov. 27, 2000, by Paul H. Phibbs, Jr., entitled \u201cCAPITAL ALLOCATION IN A NET INTEREST REVENUE IMPLEMENTATION FOR FINANCIAL PROCESSING IN A RELATIONAL DATABASE MANAGEMENT SYSTEM,\u201d and which is a continuation-in-part of the applications listed herein that are identified by Ser. Nos. 09\/608,355 and 09\/610,646;","both of which applications are incorporated by reference herein.","1. Field of the Invention","This invention relates in general to financial processing systems performed by computers, and in particular, to the implementation of selection processing for financial processing using data accessed from a relational database management system.","2. Description of Related Art","Financial processing systems provide tools for financial analysis of accounting data. Typically, each financial processing system operates in a unique way and approaches financial analysis differently. Some financial processing systems are advanced in their approach to profitability calculations, and others are still at a more basic level. In addition, there is no agreement as to the rules for profitability calculations, outside of generally accepted accounting policies that external auditors use.","Yet, the majority of financial processing systems are inefficient in their accessing of relational databases. There is a need, then, for an improved approach to selecting account and event data from a relational database.","A Value Analyzer system is a data-driven computer-facilitated financial model that provides accurate and consistent profitability calculations using account and event data stored in a relational database managed by a relational database management system (RDBMS), wherein the account data comprises attributes of the accounts being measured and the event data comprises attributes of account-related transactions. A selector function uses selection criteria to select accounts and events from the relational database in order to generate a number of inputs for profitability calculations.","The present invention performs financial processing in a computer by: (a) selecting accounts and events from a database through a selector function, wherein the selector function uses event thresholding to select the accounts and events from the database; and (b) performing one or more profitability calculations in the computer using attributes of the accounts and events selected from the database. The event thresholding uses a specified number of a specified combination of attributes of the events to select the accounts, wherein the specified number comprises an amount of the attributes or a count of the attributes, and the accounts are selected when the specified number exceeds a specified threshold.","The present invention also performs financial processing in a computer by: (a) selecting accounts and events from a database through a selector function that uses one or more selection criteria to select the accounts and events from the database, wherein the selector function groups the selection criteria, so that the grouped selection criteria are processed in parallel; and (b) performing one or more profitability calculations in the computer using attributes of the accounts and events selected from the database. The grouped selection criteria comprise similar selection criteria, and the selection criteria are grouped when the selection criteria are applied to a same level of the accounts, or when the selection criteria are of a same type, or when the selection criteria access identical attributes, or when the selection criteria access identical tables. The grouped selection criteria are processed independently. The profitability calculations use one or more rules, and the grouped selection criteria aggregate sources for the rules, or the grouped selection criteria aggregate drivers for the rules.","In addition, the present invention performs financial processing in a computer by: (a) selecting accounts and events from a database through a selector function that uses one or more selection criteria to select the accounts and events from the database, wherein the selector function invokes one or more macros to perform the selection of the accounts and events; and (b) performing one or more profitability calculations in the computer using attributes of the accounts and events selected from the database. The macros are SQL macros, and are performed by a relational database management system. The macros are grouped together for execution in parallel, and are executed in a correct order by nesting the macros and grouping the nested macros into a high-level control macro. The macros are selected from a group comprising one or more Non-Event Based Selection and Aggregation Macros, one or more Event-Based Selection and Aggregation Macros, and one or more Collation Macros.","Finally, the present invention performs financial processing in a computer by: (a) selecting accounts and events from a database through a selector function that uses one or more selection criteria to select the accounts and events from the database, wherein the selector function generates statements that are executed by a database management system to perform the selection of the accounts and events, and the statements are optimized by the selector function; and (b) performing one or more profitability calculations in the computer using attributes of the accounts and events selected from the database. The statements are optimized to satisfy the selection criteria using as few of the statements as possible. The statements are also optimized so that the statements are executed in parallel by the database management system.","In the following description of the preferred embodiment, reference is made to the accompanying drawings which form a part hereof, and in which is shown by way of illustration a specific embodiment in which the invention may be practiced. It is to be understood that other embodiments may be utilized and structural changes may be made without departing from the scope of the present invention.","A Value Analyzer system is a data-driven computer-facilitated financial model that provides accurate and consistent profitability calculations using account and event data stored in a relational database managed by a relational database management system (RDBMS), wherein the account data comprises attributes of the accounts being measured and the event data comprises attributes of account-related transactions. A selector function uses selection criteria to select accounts and events from the relational database in order to generate a number of inputs for profitability calculations.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 1","b":["100","102","104","106"]},"In the preferred embodiment, the RDBMS  includes at least one Parsing Engine (PE)  and one or more Access Module Processors (AMPs) A-E storing the relational database in one or more data storage devices A-E. The Parsing Engine  and Access Module Processors  may be implemented in separate machines, or may be implemented as separate or related processes in a single machine. The RDBMS  used in the preferred embodiment comprises the Teradata\u00ae RDBMS sold by NCR Corporation, the assignee of the present invention, although other DBMS's could be used.","Generally, the Value Analyzer Client  includes a graphical user interface (GUI) for operators of the system , wherein requests are transmitted to the Value Analyzer Calculation Engine  and\/or the RDBMS , and responses are received therefrom. In response to the requests, the Value Analyzer Calculation Engine  performs the functions described below, including formulating queries for the RDBMS  and processing data retrieved from the RDBMS . Moreover, the results from the functions performed by the Value Analyzer Calculation Engine  may be provided directly to the Value Analyzer Client  or may be provided to the RDBMS  for storing into the relational database. Once stored in the relational database, the results from the functions performed by the Value Analyzer Calculation Engine  may be independently retrieved from the RDBMS  by the Value Analyzer Client .","Note that the Value Analyzer Client , the Value Analyzer Calculation Engine , and the RDBMS  may be implemented in separate machines, or may be implemented as separate or related processes in a single machine. Moreover, in the preferred embodiment, the system  may use any number of different parallelism mechanisms to take advantage of the parallelism offered by the multiple tier architecture, the client-server structure of the Value Analyzer Client , Value Analyzer Calculation Engine , and RDBMS , and the multiple Access Module Processors  of the RDBMS . Further, data within the relational database may be partitioned across multiple data storage devices  to provide additional parallelism.","Generally, the Value Analyzer Client , Value Analyzer Calculation Engine , RDBMS , Parsing Engine , and\/or Access Module Processors A-E comprise logic and\/or data tangibly embodied in and\/or accessible from a device, media, carrier, or signal, such as RAM, ROM, one or more of the data storage devices A-E, and\/or a remote system or device communicating with the computer system  via one or more data communications devices.","However, those skilled in the art will recognize that the exemplary environment illustrated in  is not intended to limit the present invention. Indeed, those skilled in the art will recognize that other alternative environments may be used without departing from the scope of the present invention. In addition, it should be understood that the present invention may also apply to components other than those disclosed herein.","The Value Analyzer system is a data-driven computer-facilitated financial model that provides accurate and consistent profitability calculations using account, event and organization data stored in the RDBMS , wherein: (1) the account attributes comprise data about accounts being measured, (2) the event attributes comprise data about account-related transactions, and (3) the organization attributes comprise data about the organization's financial status. The profitability calculations performed by the Value Analyzer system rely on a Five Factor Atomic Profit Metric (FFAPM):",{"@attributes":{"id":"p-0050","num":"0049"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"105pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Profit","=","Net Interest Revenue (NIR)"]},{"entry":[{},{},"+","Other Revenue (OR)"]},{"entry":[{},{},"\u2212","Direct Expense (DE)"]},{"entry":[{},{},"\u2212","Indirect Expense (IE)"]},{"entry":[{},{},"\u2212","Risk Provision (RP)"]},{"entry":[{},{},"=","NIR + OR \u2212 DE \u2212 IE \u2212 RP"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"In the above equation, it is assumed that the sign of elements that reduce profit are negative and those that contribute are positive.","Each of the five factors of FFAPM are defined below:\n\n","Each of these five factors can be measured for a desired period (daily, weekly, monthly, quarterly, etc.). Moreover, each factor is essentially discrete and independent with fundamentally different characteristics, which strengthens the user's ability to fully utilize the output to determine relationships between account, event and organization data, and enable consistent multiple dimensional aggregation.","The FFAPM is \u201catomic\u201d in that profitability is computed using data stored in the RDBMS . There are three aspects to this:\n\n","The Value Analyzer generally defines \u201cindirect\u201d components of profitability to be those which must be apportioned to accounts and \u201cdirect\u201d components to be those which are either computed at the account level, or are rolled up to the account level from lower level events.",{"@attributes":{"id":"p-0056","num":"0063"},"figref":"FIG. 2","b":["104","200","202","204","206","208","200","210","212","214","214"]},"Input Definitions","Account Attributes  comprise data about the accounts being measured. This data includes: balance, rate (or interest accrued), product identification, limits, expected default frequency, and various dates (e.g., open, rate reset, last payment, next payment, maturity, etc.).","Event Attributes  comprise data about account-related events or transactions. This data includes: account identification, event or transaction amounts, event or transaction location, event or transaction time, counter-party identification, event or transaction type (e.g., loan payment, interest paid, loan draw down amount, etc.).","Organization Attributes  comprise data about the financial status of the organization. This data includes: balance sheet and profit statement amounts aggregated by the legal or management entities that own the account base being measured.","Profit Factors  include parameter values necessary to perform the Profitability Calculations . The major classifications of this data include:\n\n","Rules","The Profitability Calculations  use one or more Rules  applied to data retrieved from the RDBMS . These Rules  include, inter alia, the following:","Treatments. Every account with cash flows affecting a organization's balance sheet requires a method of valuing the account's use of internal funds. One approach is \u201cmatched maturity funds transfer pricing,\u201d which uses a canonical representation of an account's funding characteristics and then determines a value based on adjusted market yields for each instance that requires an interest rate transfer price to calculate an account's marginal Net Interest Revenue.","Equity Allocation. In order to provide precise Net Interest Revenue calculations, the amount of equity funds required at an account must be determined. This rule allows for equity allocation using any of the following methods: simple ratios; regulatory definitions; economic allocations, or user defined allocations.","Apportionment. Other Revenue, Risk Provision and Indirect Expense calculations are applied at the account level using Organization Attributes  that are not related directly to account activity. These profit adjustments are made so that the sum of all account-level Profitability Calculations  comprises the overall profit. One approach is to pool indirect costs and revenues and then apportion them. Apportionment rules specify how the pooled indirect costs and revenues is completely allocated to appropriate accounts, wherein the preferred embodiment uses closed form allocation rules, which require only information known in the current period and not iterative computation.","Amortization. Some types of income or expense are deferred or accrued over multiple periods, including and subsequent to the current accounting period. This is common to accrual accounting methods used in profit presentations of financial statements, and gives rise to timing differences between cash flows and their related profit as presented in a financial statement in any accounting period. Since the Value Analyzer system is designed to reconcile to the financial statement's profit values, it supports deferral and accrual accounting principles. Amortization methods that account for these timing differences are: interest amortization (used for interest income and expense accruals and for deferral of fees that are in lieu of interest), and straight line or declining balance amortizations (used for cost deferrals and investment depreciation).","Other Revenue Pricing. In situations where account and event activity can be used to derive account level income or fees, the Value Analyzer system calculates these drivers of the profitability in the Other Revenue calculations. These calculations comprise linear combinations of event or account values and modeled coefficients.","Direct Expense. The calculation of account profit adjustments due to account-related activity requires rules that take the form of linear combinations of event or account values and modeled coefficients.","Indirect Expense. In situations where expense apportionment or amortization amounts are aggregated, the user may want different rules applied depending on the path (or dimension) of aggregation. These rules allow for multiple Profitability Calculations rules to be applied to derive multiple account level Indirect Expense amounts.","Risk Provision. Adjusting current profit for expected future losses is known as \u201cactuarial\u201d profit provisioning. The Value Analyzer system applies actuarial-based methods in its account level Profitability Calculations, where the actuarial reserve that the provisions maintain represents the expected loss associated with all accounts.","Taxable Equivalent Gross-up. Profit is an after-tax measure, and thus some events or portions of some accounts' profits may be excluded from normal taxation. The Value Analyzer system adjusts these pre-tax values, so that a singular tax rate can be used to convert pre-tax profit into after-tax values, which are also known as taxable equivalent adjustment. These rules use account and event attributes to adjust each of the five factors of the FFAPM to a taxable equivalent basis.","Interest Yield Adjustments. Since the Value Analyzer system can calculate profits for any number of periods, the adjustment of cash interest payments, and the financial statement's accrual or smoothed representation of interest-related Profit, the Value Analyzer system provides a method for converting cash interest amounts to accrual amounts for financial statements. The Value Analyzer system implements an \u201ceffective interest rate\u201d conversion to accomplish this type of calculation.","Profitability Calculations","The following describes the method used by the Profitability Calculations :\n\n","Note that steps 2 through 6 perform account-level calculations. Steps 2, 3, 4, 5, and 6 can be performed independently and in parallel, while step 7 requires values derived in steps 2, 3, 4, 5, and 6, and therefore must be performed after steps 2, 3, 4, 5, and 6 are completed.","Output Definition","The Profitability Calculations  generate one or more values for the five factors of the FFAPM , and specifically, the NIR, OR, DE, IE, RP, and Profit values. These values are used to generate the Database , which comprises one or more tables stored by the RDBMS  in the relational database.",{"@attributes":{"id":"p-0079","num":"0102"},"figref":"FIG. 3","b":["300","104","300","106","200","202","204","206","208","200","300","300"]},"Selection Criteria","In the Value Analyzer system, the Selector function  uses one or more sets of Selection Criteria  to determine which accounts and events should be processed. In the preferred embodiment, the following types of Selection Criteria  may be used:\n\n","The Selection Criteria  may comprise attributes, predicates, operators and\/or functions, wherein a group of accounts or events that satisfy the Selection Criteria  comprise partitions. For example, it is possible to compare an account attribute (i.e., a column) to another account attribute, a literal value, or a domain value (which is an indirect reference to a literal value that is resolved by a lookup function). Operators may include any number of different relational operators, i.e., =, >=, <=, <, >, BETWEEN, etc., and functions may comprise aggregations or other functions.","The Selection Criteria  may also include dynamic event attributes. For example, multiple event attributes may be defined for each account. The event attribute definition can vary both in the number of event attributes used to identify account events, and in the identity of the event attributes. This means that the selection of accounts having specific combinations of event attributes is dynamic, rather than static.","Source, Target and Driver Components","In the Value Analyzer system, each Rule  performed by the Profitability Calculation  can include multiple sets of Selection Criteria . Specifically, each Rule  performed by the Profitability Calculation  is comprised of Source, Target and Driver components, and each of these components can have Selection Criteria . In this context, a Source component is a source of funds to be allocated, a Target component is a target of funds to be allocated, and a Driver component is an attribute or function that controls the allocation of funds from the source to the target (e.g., account attributes, number of accounts, event attributes, event counts, event amounts, etc.). The Selection Criteria  for these components can be dynamically specified by the user.","Amounts and Counts","An amount can be specified by the user for the Source component, and both amounts and counts can be specified for Driver components. The specification of amounts or counts, combined with the Selection Criteria , requires that the Selector function  dynamically select the proper sets of accounts or events, and aggregate the user-specified amounts or counts. Generally, this selection and aggregation will be different from one rule to another, and from one Profitability Calculation  to another.","Event Thresholding","The Selector function  may use the amounts and counts to perform event thresholding when forming an Account or Master Account Event Group. For example, the Selector function  may be programmed to only select accounts that have some specified number of some specified combinations of event attributes. Specifically, the Selector function  looks for accounts that meet any of the Selection Criteria  specified above, wherein the amount or count of the occurrences of the event attributes is summed to determine whether they meet a user-specified threshold test. The SQL statements used for processing the user-specified threshold test are optimized so that the RDBMS  can perform them in parallel to avoid making multiple passes through large tables in the relational database.","In the preferred embodiment, financial institutions can identify one or more event attributes in their Rules  in order to form an Event Group (whether for Accounts or Master Accounts). Threshold tests are then applied by the Selector function  to these event attributes in the Event Group to select Accounts or Master Accounts. The threshold tests must be completed before the Profitability Calculations  can be performed.","Rule Screening","Once the lists of Selection Criteria  have been specified, the next step is to screen the Rules  and Selection Criteria  of the Profitability Calculation . Specifically, any Rules  or Selection Criteria  that the Selector function  does not need to execute can be removed. For example:\n\n","Operation","Using the Selection Criteria  for each of the components, the Selector function  dynamically generates SQL statements to select the proper Accounts or Master Accounts, and to aggregate the appropriate Source or Driver amounts and counts, using an Account table and Event log table in the relational database. The Account table contains all of the accounts at a financial institution, and the Event log table contains all of the account events or transactions that occurred during a specified period at the financial institution. The present invention optimizes the dynamic generation of the SQL statements, so that multiple selection predicates can be processed in parallel by the RDBMS .","In the preferred embodiment, the Selector function  dynamically creates temporary work tables. Once these tables have been generated, the Selector function  dynamically invokes a set of SQL macros to perform the selection and aggregation of data from the relational database.","The SQL macros are grouped together for execution in parallel (where appropriate). Further, the SQL macros are executed in the correct sequential order through the use of a single high-level macro and a series of nested macros generated by the Selector function . Using this process, similar Selection Criteria  are grouped together and processed independently and in parallel by the RDBMS , and the results therefrom are stored in temporary work tables.","The Selector function  uses one or more parameterized templates to dynamically generate the SQL statements. This parameterized template typically comprises a join of (potentially) multiple tables within the relational database to a constraint table (storing the Selection Criteria ) and an in-list table (storing IN clauses for the SQL templates). Both the constraint and in-list tables are created and populated from the Selection Criteria .","Specifically, there are several very important steps in generating the SQL statements:\n\n","Standardizing Selection Criteria","For the purpose of grouping Selection Criteria , the Selector function  treats the relational operators, e.g., =, <, >, =>, <=, as equivalent to a BETWEEN operation. In fact, the Selector function  converts these relational operators into an equivalent BETWEEN operation according to the mappings in the following table:",{"@attributes":{"id":"p-0101","num":"0137"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Operator","Maps to","BETWEEN","Left Value","AND","Right Value"]},{"entry":["= X","Maps to","BETWEEN","X","AND","X"]},{"entry":["< X","Maps to","BETWEEN","MIN(X)","AND","LOWER(X)"]},{"entry":["<= X","Maps to","BETWEEN","MIN(X)","AND","X"]},{"entry":["> X","Maps to","BETWEEN","HIGHER(X)","AND","MAX(X)"]},{"entry":[">= X","Maps to","BETWEEN","X","AND","MAX(X)"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}}}},"wherein:\n\n","If the relational operator in the Selection Criteria  is of the type \u2018>=\u2019, \u2018<=\u2019, \u2018>\u2019, or \u2018<\u2019, then there may exist another Selection Criteria  within the group of Selection Criteria  that matches, i.e., that would form a valid BETWEEN operation. To match first and second Selection Criteria , the first and second Selection Criteria  must be the same attribute, and if the relational operator of the first Selection Criteria  is either \u2018>=\u2019 or \u2018>\u2019, then it will match either \u2018<=\u2019 or \u2018<\u2019 in the second Selection Criteria . Likewise, if the relational operator of the first Selection Criteria  is \u2018<=\u2019 or \u2018<\u2019, then it will match either \u2018>=\u2019 or \u2018>\u2019 in the second Selection Criteria . Once a matching pair of first and second Selection Criteria  is found, the combination into one BETWEEN operation is straightforward. It is worth noting that, just as in the simple case, \u2018<X\u2019 results in \u2018BETWEEN Y AND LOWER(X)\u2019 and \u2018>X\u2019 results in \u2018BETWEEN HIGHER(X) and Y\u2019.","Grouping Selection Criteria, Sources and Drivers","As noted above, the Selector function  optimizes the dynamic generation of SQL statements, so that multiple Selection Criteria  can be processed in parallel by the RDBMS . Generally, this requires an understanding of the operation of the Parsing Engine  of the RDBMS , and how it transforms SQL statements into an operator tree that, in turn, can be used to generate multiple, parallelized access plans for execution by Access Module Processors A-E of the RDBMS .","In generating the SQL statements, the Selector function  groups multiple sets of Selection Criteria  together and processes the groups in parallel to the extent possible, and generates several sets of output tables. The goal is to process similar selection predicates together at the same time, so that fewer passes need to be made through the tables in the relational database. In a final pass, these output tables are filtered and combined to produce the correct sets for each Source, Target, and Driver component in the Rules  of the Profitability Calculation .","This step is necessary because the Profitability Calculations  are scripts that operate against known, statically defined, tables. In the Value Analyzer system, the specification of Selection Criteria , and the attributes that can be used in the selection process, are completely dynamic and user-driven. There is no way for the scripts to contain this knowledge, nor can it be predefined as part of the scripts.","When grouping Selection Criteria , the following is required:\n\n","Using the above, each distinct group of Selection Criteria  can be processed independently. This allows the Selector function  to process each distinct group of Selection Criteria  in parallel. In this context, a partition is a set of one or more accounts that satisfy one or more Selection Criteria , in order to apply costs and revenues to each account.","Some groups of Selection Criteria  are used for more than simply the selection of Accounts or Master Accounts. In some cases, they are used to aggregate Sources or Drivers. These groups of Selection Criteria  follow slightly more complex grouping rules.","When grouping Sources, the following conditions must be true. These conditions are checked before the grouping conditions for normal Selection Criteria  are checked. Only if all conditions are true can groups of Selection Criteria  be grouped together.\n\n","When grouping Drivers, the following conditions must be true. These conditions are checked before the grouping conditions for normal Selection Criteria  are checked. Only if all conditions are true can groups of Selection Criteria  be grouped together.\n\n","SQL Optimization","In the preferred embodiment, the Selector function  optimizes the SQL statements that are dynamically generated based on user-specified Selection Criteria . The basic principles of this optimization are:\n\n","Two features of the RDBMS  motivate the method chosen for optimization.","First, it is assumed that every SQL statement that partitions accounts needs to perform a full file scan of one or more tables in the relational database. A full file scan reads every single row of a table and, since it is assumed that the tables are distributed evenly across, all AMPs A-E in the RDBMS , it therefore means that every AMP A-E uses one worker task to read the rows to satisfy the query. However, each AMP A-E has a limited pool of worker tasks. Hence, only a limited number of full file scans can take place at any time and therefore only a limited number of SQL statements generated by the Selector function  can take place at any time.","The synchronous scan feature of the RDBMS  allows multiple worker tasks to share the same read activity. If two tasks are scanning the same table in the relational database the same time, then the RDBMS  is only going to perform the scan once. If one of the tasks starts the scan earlier than the other one, the second task starts reading wherever the first task happens to be. When the scan reaches the end of the table, the first task is completed, but the second task starts the scan again at the beginning of the table, in order to pick up whatever it missed in the first pass. Because the queries generated by the Selector function  will tend to scan many of the same tables in the relational database, it is an overall performance improvement if all of the queries can run at the same time in order to minimize the total amount of disk scanning necessary to complete all of the SQL statements.","Macro Creation","The Selector function  uses a series of nested macros to group SQL statements together for parallel execution, and to ensure that all steps or SQL statements are executed in the proper order. These nested macros are, in turn, grouped into a high-level control macro that is responsible for executing all macros in the correct sequence.","In the general case, there are three types of SQL macros:\n\n","Of course, not all three macros may be used in every situation.","Each of these macros can be executed in parallel. Moreover, these three macros are, in turn, nested into a Control Macro. The Control Macro is responsible for executing all types of SQL macros in the correct sequence. By nesting all of the macros into a hierarchical series of macros, the Control Macro becomes the single point of execution for processing the dynamic selection and aggregation of data.","Output Tables","After the temporary work tables have been created, the Selector function  filters and combines the temporary work tables, yielding output tables corresponding to the inputs for the Profitability Calculations , namely, the Account Attributes  and Event Attributes . These output tables include the account partitions for the rule, wherein the account partitions represent the target accounts against which the profitability rules are applied. The output tables are then processed by one or more of the Profitability Calculations  in the Value Analyzer Calculation Engine  to accomplish a final result.",{"@attributes":{"id":"p-0125","num":"0178"},"figref":"FIG. 4"},"Block  represents the Value Analyzer Client  accepting one or more Selection Criteria  from the user, which may include Selection Criteria  for Source, Target and Driver Components, Amounts and Counts, as well as event thresholding values.","Block  represents the Value Analyzer Calculation Engine  invoking a Selector function  for selecting accounts and events from the relational database based on the specified Selection Criteria  prior to the execution of the Profitability Calculations . Preferably, the Selector function  uses event thresholding to select the accounts and events from the relational database, wherein the event thresholding uses a specified number of a specified combination of attributes of the events to select the accounts. The specified number comprises an amount of the attributes or a count of the attributes, and the accounts are selected when the specified number exceeds a specified threshold.","Block  represents the Selector function  performing rule screening for the selected accounts and events from the relational database based on the specified Selection Criteria .","Block  represents the Selector function  standardizing the Selection Criteria .","Block  represents the Selector function  grouping the standardized Selection Criteria , so that the grouped Selection Criteria, which comprise similar Selection Criteria , are processed independently and in parallel. The Selection Criteria  are grouped when the Selection Criteria  are applied to a same level of the accounts, when the Selection Criteria  are of a same type, when the Selection Criteria  access identical attributes, or when the Selection Criteria  access identical tables. Moreover, the grouped Selection Criteria  may aggregate Sources or Drivers for the Rules .","Block  represents the Selector function  dynamically generating SQL statements for the selected accounts and events from the relational database based on the specified Selection Criteria , wherein the SQL statements are optimized for processing by the RDBMS . Preferably, the SQL statements are optimized to satisfy the Selection Criteria  using as few of the SQL statements as possible, and so that the SQL statements are executed in parallel by the RDBMS .","Block  represents the Selector function  invoking the dynamically generated SQL statements as SQL macros performed within the RDBMS , in order to perform the selection of the accounts and events. Preferably, the SQL macros are grouped together for execution in parallel by the RDBMS . Moreover, the SQL macros are executed in a correct order by nesting the SQL macros and grouping the nested SQL macros into a high-level control macro. The nested SQL macros are selected from a group comprising one or more Non-Event Based Selection and Aggregation Macros, one or more Event-Based Selection and Aggregation Macros, and one or more Collation Macros.","Block  represents the Parsing Engine  of the RDBMS  transforming the SQL statements into an operator tree.","Block  represents the Parsing Engine  of the RDBMS  generating one or more access plans from the operator tree.","Block  represents the Parsing Engine  of the RDBMS  parallelizing the access plans, and then transmitting the access plans to their assigned Access Module Processors A-E of the RDBMS .","Block  represents the Access Module Processors A-E of the RDBMS  executing the access plans, and thereby performing the required data manipulation associated with the access plans received from the Parsing Engine , wherein the required data manipulation associated with the access plans are performed in parallel by the Access Module Processors A-E.","Block  represents the Parsing Engine  of the RDBMS  standardizing the results received from the Access Module Processors A-E and providing the standardized results to the Value Analyzer Calculation Engine  as account and event attributes.","Block  represents the Value Analyzer Calculation Engine  invoking and performing the Profitability Calculations  using the account and event attributes accessed from the RDBMS , as well as one or more organization attributes, profit factors and rules.","Block  represents the Value Analyzer Calculation Engine  delivering the output or results from the Profitability Calculations  to the Value Analyzer Client  and\/or the RDBMS . With regard to the Value Analyzer Client , the results may be presented to the user, printed, or used by various other computer programs, as desired. With regard to the RDBMS , the results may be stored for later use by the Value Analyzer Client , the Value Analyzer Calculation Engine , or other computer programs, as desired.","This concludes the description of the preferred embodiment of the invention. The following paragraphs describe some alternative embodiments for accomplishing the same invention.","In one alternative embodiment, any type of computer or configuration of computers could be used to implement the present invention. In addition, any database management system, decision support system, on-line analytic processing system, or other computer program that performs similar functions could be used with the present invention.","In summary, the present invention discloses a Value Analyzer system, which is a data-driven computer-facilitated financial model that provides accurate and consistent profitability calculations using account and event data stored in a relational database managed by a relational database management system (RDBMS), wherein the account data comprises attributes of the accounts being measured and the event data comprises attributes of account-related transactions. A selector function uses selection criteria to select accounts and events from the relational database in order to generate a number of inputs for profitability calculations.","The foregoing description of the preferred embodiment of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of the above teaching. It is intended that the scope of the invention be limited not by this detailed description, but rather by the claims appended hereto."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Referring now to the drawings in which like reference numbers represent corresponding parts throughout:",{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
