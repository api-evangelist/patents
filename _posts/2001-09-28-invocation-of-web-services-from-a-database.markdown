---
title: Invocation of web services from a database
abstract: The present invention provides a method, system and program product for integrating a service external to a database into a database such that the service may be easily invoked from the database. Preferably, the service is a web service available over the internet The service may be invoked from any of a number of invoking mechanisms of the database. In a first specific embodiment, the mechanism comprises a user-defined function within an SQL statement. In a second specific embodiment, the mechanism comprises a virtual table. In a third specific embodiment, the mechanism comprises a stored procedure. In a fourth specific embodiment, the mechanism comprises a trigger. In a fifth specific embodiment, the mechanism comprises a federated table accessed via a nickname and implemented using a wrapper.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08166006&OS=08166006&RS=08166006
owner: International Business Machines Corporation
number: 08166006
owner_city: Armonk
owner_country: US
publication_date: 20010928
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"p":["Application Ser. No. 09\/871,475 to Preisig et al., entitled \u201cSystem, Method and Computer Program Product for Reformatting Non-XML Data for Use with Internet Based Systems\u201d, filed May 31, 2001.","The present invention relates generally to the invocation of web services, and more particularly to incorporating a web service into a database so that it may be invoked from within the database.","Web services are an emerging technology that offers the dual promise of simplicity and pervasiveness. Web services represent the next level of function and efficiency in e-business. In the most primitive sense, Web services can be viewed as any mechanism by which an application service may be provided to other applications on the internet.","Web services may be informational or transactional. That is, some services provide information of interest to the requestor while other services may actually lead to the invocation of business processes. Examples of publicly available Web services today include stock quote services, services to retrieve news from Web news sources, and currency conversion services.","Because Web services are modular, related Web services can be aggregated into a larger Web service. For example, one can envision a wireless application composed of separate Web services that do such things as obtaining stock quotes, subscribing to news services, converting currency, and managing calendars. One particularly nice aspect of Web services is that the level of abstraction they provide makes it relatively simple to wrap an existing enterprise application and turn it into a Web service.","Web services provide a way to make key business processes accessible to customers, partners, and suppliers. For example, an airline could provide its airline reservation systems as a Web service to make it easier for its large corporate customers to integrate the service into their travel planning applications. A supplier can make its inventory levels and pricing accessible to its key buyers. This emerging technology enables e-business applications to be connected more easily both inside and outside the enterprise.","Web services are based on the eXtensible Markup Language (XML) standard data format and data exchange mechanisms, which provide both flexibility and platform independence. With Web services, requesters typically do not know or care about the underlying implementation of Web services, making it easy to integrate heterogeneous business processes.","One example of web-services are the services responsive to SOAP messages. Simple Object Access Protocol (SOAP) envelopes. SOAP is an application invocation protocol developed by IBM, Microsoft, and others that defines a simple protocol for exchanging information encoded as XML messages. It is more fully described in the working draft of SOAP version 1.2, available at Http:\/\/www.w3.org\/2000\/xp\/, incorporated by reference herein. Often, the services are described by WSDL (Web Service Description Language) notation stored in WSDL documents. WDSL is described in the Web Services Description Language 1.1 document, available at http:\/\/www.w3.org\/TR\/wsdl, incorporated by reference herein. A WSDL document may be stored in numerous ways; in a file, in a DB2 XML Registry\/Repository (such as the DB2 XRR(XML Registry\/Repository)), or in a DB2 based UDDI Registry, for example. UDDI (Universal Description, Discovery, Integration) is a protocol for describing Web services such that interested parties may easily discover them. Specifications for this registry and use of WSDL in the registry are available currently at http:\/\/www.uddi.org\/. Service providers may register their services in a UDDI, specifying technical information about how to invoke the service. IBM operates a publicly available UDDI service using DB2 and WebSphere.","Databases are computerized information storage and retrieval systems. A Relational Database Management System (RDBMS) is a database management system (DBMS) which uses relational techniques for storing and retrieving data. A DBMS is structured to accept commands to store, retrieve, and delete data. One widely used and well known set of commands is called the Structured Query Language (SQL). Relational databases are organized into tables which consist of rows and columns of data. The rows are formally called tuples. A database will typically have many tables and each table will typically have multiple tuples and multiple columns. The tables are typically stored on direct access storage devices (DASD) such as magnetic or optical disk drives for semi-permanent storage.","In a web services environment, a number of advantages would be obtained by integrating web services into a database, and to enable simple invocation of those web services. One advantage is efficient set-oriented processing and parallel execution of web service invocations. Another advantage is that users could easily combine web service transactions and information with data residing in the database. A further advantage would be realized by automatically generating a database mechanism for invoking a web service to enable integration of the web service into the database.","A further advantage would be provided by exposing the data and appropriate processes of a database (e.g., stored procedures and user-defined functions) as web services.","The present invention provides the desired capabilities as a method, system and program product for integrating a service external to a database into a database such that the service may be easily invoked from the database. Preferably, the service is a web service available over the internet The service may be invoked from any of a number of invoking mechanisms of the database. In a first specific embodiment, the mechanism comprises a user-defined function within an SQL statement. In a second specific embodiment, the mechanism comprises a virtual table. In a third specific embodiment, the mechanism comprises a stored procedure. In a fourth specific embodiment, the mechanism comprises a trigger. In a fifth specific embodiment, the mechanism comprises a federated table accessed via a nickname and implemented using a wrapper.","Although the invention will be described with reference to a specific embodiment, it will be understood by the reader that the following description is merely illustrative of the principles of the invention and that other embodiments may be devised by those skilled in the art without departing from the spirit and scope of the invention. The described invention may be implemented in software, hardware, or a combination thereof.","Software embodying the invention may be contained in a program product, e.g., tape, CD-ROM, floppy diskette, computer memory or direct access storage device.","The nature of Web services make them natural components in a service-oriented architecture. A typical service-oriented architecture is shown in . Service providers  host a network accessible software module. A service provider defines a service description for a Web service and publishes it to a service registry , as depicted by arrow . A service requester  at a client computer uses a find operation, represented by arrow , to retrieve the service description from the registry  and uses the service description to bind with the service provider, as represented by connector , and to invoke or interact with the Web service implementation. To facilitate this architecture, the client is connected to a router (not shown) at the service provider's server. Preferably, the connection between the client computer and the router is established via the Internet, but other connections can be used. It can be appreciated that the client computer connects to the Internet via telephone modem, cable modem, LAN, WAN, T1 or any other means well known in the art.","Applying the preceding model to web services and referring to , a service provider  makes an application available over the web as a Web service by wrapping the application in such a way that it can be accessed using standard XML messages, i.e., application-specific messages  are sent in standard XML document formats conforming to the corresponding service description. The XML messages  are themselves placed in a wrapper  in such a way that masks the underlying transport protocol. For example, an application message is placed in an XML wrapper by an XML extender administrative servlet (DXX admin servlet, not shown) included in the router at the service provider's database . XML messages  are then wrapped in Simple Object Access Protocol (SOAP) envelopes  at SOAP server  and posted to the web via HTTP server .","The DXX admin servlet configures at least one DXX invoker, which in turn can access at least one document access definition extension (DADx) file. The DADx file, in turn, can access one or more document access definition (DAD) files.","DXX is a collection of stored procedures, user defined types (UDTs), and user defined functions (UDFs) that are typically used in programs written in SQL, Java, C++, and other languages. The DXX invoker handles universal resource locators (URLs) having the extensions \u201c.dadx\u201d that reference web services and \u201c.dtd\u201d that reference document type definition (DTD) documents. Specifically, the DXX invoker provides runtime support for invoking DADx documents as web services written, e.g., in Apache Simple Object Access Protocol (SOAP). The servlet of the router connects to a database at invocation times. Preferably, this connection is established by a Java database connection (JDBC).","In one possible embodiment, the DXX Invoker, a Java component, interfaces with Apache SOAP 2.1 runtime using a pluggable provider support. A web application developer creates an instance of the DXX Invoker for each database that is to be accessed. Each instance of the DXX Invoker is associated with a database connection and a set of DADx files. The DXX Admin servlet is provided to simplify the task of creating instances of the DXX Invoker. Specifically, the DXX Admin servlet provides a web user interface for configuring instances of the DXX Invoker. Someone, e.g., a database administrator, sets up the databases and enables them for use by DXX. The service provider creates DAD and DADx documents and deploys them to the web application. Each DADx document is associated with a URL that identifies a specific web service.","As previously noted, SOAP is an application invocation protocol developed by IBM, Microsoft, and others that defines a simple protocol for exchanging information encoded as XML messages . SOAP is in the process of being more formally specified by the World Wide Web Consortium (WC) as XML Protocol. The beauty of SOAP is that it makes no assumptions on the implementation of the endpoints. This means that a service requester  needs only to create an XML request, send it to a service provider , and understand the XML response that comes back.","A SOAP request 33 consists of the envelope itself, which contains the namespaces used by the rest of the SOAP message, an optional header, and the body, which may be a remote procedure call (RPC) or an XML document. SOAP builds on existing Internet standards such as HTTP and XML, but can be used with any network protocol, programming language, or data encoding model. For example, it is possible to send SOAP messages over IBM MOSeries\u00ae), FTP or even as mail messages.","The logical interface and the service implementation are described by the Web Services Description Language (WSDL). WSDL is an XML vocabulary used to automate the details involved in communicating between Web services applications. There are three pieces to WSDL: a data type description (XML schema), an interface description, and binding information. The interface description is typically used at development time and the binding information may be used at either development or execution time to actually invoke a particular service at the specified location. The service description is key to making the Web services architecture loosely coupled and reducing the amount of required shared understanding and custom programming between service providers and service requesters. As previously noted, the WSDL description is stored in a WSDL document. This WSDL document may be stored in numerous ways: in a file, in a DB XML Registry\/Repository, or in a DB based UDDI Registry, for example.","Referring back to , the service can be publicized by being registered in a standard-format web registry . This registry makes it possible for other people or applications to find and use the service. For example, one can publish descriptive information, such as taxonomy, ownership, business name, business type and so on, via a registry that adheres to the Uniform Description, Discovery and Integration (UDDI) specification or into some other XML registry. The UDDI information can include a pointer to WSDL interfaces, the binding information, and a business name (the name that makes the purpose of the Web service understandable to humans). A UDDI registry is searchable by programs, enabling a service requester to bind to a UDDI provider to find out more information about a service before actually using it.","The ability to compose Web services together is provided, for example, by Web Services Flow Language (WSFL), another specification defined by IBM and others. WSFL can be used to describe a business process (that is, an execution flow from beginning to end), or a description of overall interactions between varying Web services with no specified sequence. It is more fully described in the WSDL V1.0 specification available at http:\/\/www-4.ibm.com\/software\/solutions\/webservices\/pdf\/WSFL.pdf, incorporated herein by reference. The mechanism for creating a WSFL description is described in an article at Http:\/\/www-106.ibm.com\/developerworks\/webservices\/library\/ws-ref4, and incorporated herein by reference.","Looking at how all of these specifications work together, a Web service can be defined as a modular application that can be:\n\n","Access to Web services may be restricted much as one would restrict access to Web sites that are not available to everyone. For example, IBM WebSphere \u00ae provides many options for controlling access and for authentication. The standards for this are still emerging. Microsoft and IBM have proposed a SOAP security extension to the WC as the mechanism for XML digital signatures. The SOAP security extension included with WebSphere Application Server 4.0 is intended to be a security architecture based on the SOAP Security specification, and on widely-accepted security technologies such as secure socket layer (SSL). When using HTTP as the transport mechanism, there are different ways to combine HTTP basic authentication, SSL, and SOAP signatures to handle varying needs of security and authentication.","IBM is enabling its key programming models and application servers with Web services and is providing and developing tools to automatically generate Web services from existing artifacts such as Java Beans, EJBs, and stored procedures. The following types of web service operations are provided: XML-based query or storage, wherein an XML document is decomposed for storage in DB2 relational tables and composed again on retrieval; and SQL-based operations, such as calling stored procedures, or inserting, updating, deleting DB2 data.","XML-based query: Referring now to , XML-based querying permits composition of XML documents  from relational data stored in tables  of a database . One may also break an XML document  down into its component parts and store it into relational tables  of the database . Part of the underlying support for this functionality is provided by DB2 XML Extender. The store and retrieve operations are handled by special stored procedures that are shipped with DB2 XML Extender.","One of the inputs into both storage and retrieval is the user-specified mapping file  that creates the association between relational data and XML document structure. This mapping file  is called a Document Access Definition (DAD)  and provides a way to create an XML document  and specify the XML elements, attributes and shape desired. The focus of this approach is in moving and manipulating XML documents.","SQL-based query: Referring now to , SQL-based querying is simply the ability to send SQL statements, including stored procedure calls, to the database  and to return results with a default tagging .","The focus of this approach is actually the data in and out of the database , not on shaping the results in a particular way. SQL-based query does not require the use of an XML Extender because there is no user-defined mapping of SQL data to XML elements and attributes. Instead, the data is returned using only a simple mapping of SQL data types, using column names as elements.","However, if one is using DB2 XML Extender to store XML documents within a single column of a table, one may use SQL-based queries to retrieve those documents intact as a character large object (CLOB), or to invoke the user-defined functions that extract parts of the document. Another feature of DB2 XML Extender is the ability to store frequently-accessed data in side tables, thereby enabling speedy searches on XML documents that are stored in columns.","Another useful thing one may do with SQL-based query is to invoke DB2 stored procedures. Stored procedures are natural for conversion to Web services since they are themselves an encapsulation of programming logic and database access. A Web service invocation of a stored procedure makes it possible to dynamically provide input parameters and to retrieve results.","Both the XML-based and SQL-based forms of querying are controlled by the DADX, a configuration file shown in . The DADX configuration file defines the operations that can be performed by the Web service. For example, one might have a DADX file that specifies the operations to find all orders for parts, find all orders for parts with a particular color, and orders for parts that are above a certain specified price. The color or price can be specified at runtime as input parameters by using host-variable style notation in the query.","Use of DADX or similar mechanisms has enabled the development of a tool that automatically generates the WSDL description of the interfaces and publishes the interfaces to a UDDI registry or some other service directory. The tool also generates the artifacts needed to deploy the Web service into a web development tool such as WebSphere, and the client proxies that may be utilized for testing and as a basis for building the client part of one's Web application.","To help with the configuration task, a database connection configuration servlet is also provided. This servlet provides a Web-based interface to guide a user through the task of configuring database connections. One may have many DADX files that use the same database configuration.","A database both manages data and provides intelligent access to it. Optimized queries, complex analysis, and efficient execution of business logic may all be provided by the database engine. The database can be viewed as an efficient and powerful set-oriented execution engine that typically works on locally managed data. Indeed, the sel-oriented processing of DB2 can be used to operate on more than just locally managed data. DB2 Relational Connect allows remote, heterogeneous relational databases to be treated as local resources. DB2 also provides features built-in to SQL that enable external applications and systems to be manipulated in a set-oriented manner.","According to the present invention, a database can invoke a web service by representing the remote web service as a virtual table or function residing on the database. The virtual table may then be manipulated within an SQL statement. The mechanisms proposed for representing the remote web service according to the preferred embodiment are a user-defined function (UDF) contained within an SQL statement, a stored procedures (SP) containing calls or SQL statements to invoke the web service, or a wrapper created around the web service and providing the machinery for communicating with the external web service.","User defined functions (UDFs) are a powerful SQL mechanism enabling users to define new operators to SQL that return either a single value or that return a tabular value. This UDF mechanism may be used to invoke external applications and to return virtual tables of data back to DB2.",{"@attributes":{"id":"p-0052","num":"0057"},"figref":["FIG. 6","FIG. 6","FIG. 6"],"b":["63","61","61","62","29","65","69","66","68"],"i":["a","b"]},{"@attributes":{"id":"p-0053","num":"0058"},"figref":["FIG. 7","FIG. 7"],"b":["71","73","77","71","73","75","77","71"],"ul":{"@attributes":{"id":"ul0003","list-style":"none"},"li":"ex 1: string GET_PO_STATUS( string URL, string PO_NUM)"}},"The preceding function is implemented as a very simple Web service by the suppliers  according to emerging web service protocols. Implementing the function as a Web service allows it to be easily invoked by a wide variety of clients. The invoking application may execute, for example, on a Unix-based system, a laptop, a mainframe, a browser or a Java application . However, according to the present invention the manufacturer  preferably invokes the application from within its database . Invocation is accomplished from a DB2 database with a user-defined function (UDF)  having the following signature:\n\n","Here the return value is the PO status and the input parameters are the URL to which the request is to be sent and the identity of the purchase order whose status is of interest. To find the status of a specific purchase order, e.g., \u201c12345\u201d, at a supplier  that offers this service at http:\/\/www.Asupplier.com\/GET_PO_STATUS, the following SQL statement is issued:\n\n","Now assume that the manufacturer  has a table  filled with outstanding purchase orders and another  containing information about the web service operations each supplier offers. Such tables might look like:",{"@attributes":{"id":"p-0057","num":"0065"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"PURCHASE_ORDERS"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Customer","Supplier","PO_NUM","O_NUM"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"C1","ASupplier","12345","a456"]},{"entry":[{},"C1","BSupplier","12347","b456"]},{"entry":[{},"C3","BSupplier","34656","d435"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0058","num":"0066"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"273pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"SUPPLIER_OPS"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Supplier","Operation","URL"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["ASupplier","GET_PO_STATUS","http:\/\/www.Asupplier.com\/GET_PO_STATUS"]},{"entry":["ASupplier","GET_QUOTE","http:\/\/www.Asupplier.com\/GET_QUOTE"]},{"entry":["Bsupplier","GET_QUOTE","http:\/\/www.Bsupplier.com\/services\/GET_QUOTE"]},{"entry":["BSupplier","GET_PO_STATUS","http:\/\/www.Bsupplier.com\/services\/GET_PO_STATUS"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"To find out the status of outstanding purchase orders from ASupplier for all of the manufacturer's customers, the following SQL is issued:\n\n","In the forgoing example, the address of the service to be invoked is explicitly stated. It is more likely that the manufacturer  would like to find the status of all outstanding purchase orders from all suppliers  offering a web service interface. This is achieved by replacing the web address with a parameter, e.g.:\n\n","Alternatively, one may query the UDDI or other registry directly rather than having to maintain a Supplier_Ops table. For example, the UDDI can be browsed for web services that satisfy the required information, and those web services of interest may be incorporated into the select statement. Or, the manuacturer  may require suppliers  to name their web services with a pre-determined name and then query the registry for the name directly in the query.","A further aspect of the invention, described subsequently, a tool may be used to automatically generate a user-defined function from the WSDL definition of a web service for use in the SQL query.","For convenience, the query of example 5, above may be represented as an output table or \u201cview\u201d to provide a simpler interface:",{"@attributes":{"id":"p-0064","num":"0074"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ex 6:","create view order_status as"]},{"entry":[{},"select o.customer, o.po_num, o.supplier,"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"get_po_status(s.URL, o.po_num) as status"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"from purchase_orders o, supplier_ops s"]},{"entry":[{},"where o.supplier = s.supplier and s.operation = \u2018GET_PO_STATUS\u2019"]},{"entry":["ex 7:","select * from order_status"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"This query may be extended to exploit features of SQL. For instance, to sort the result by supplier and purchase order status one simply appends an order by clause such as:",{"@attributes":{"id":"p-0066","num":"0076"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"231pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["ex 8:","select Customer, Supplier, PO_NUM,"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"GET_PO_STATUS(P.PO, S.Service_Address) as PO_STATUS"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"from order_status"]},{"entry":[{},"order by Supplier"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"All the examples so far show how a web service that returns a single value can be integrated with DB2 SQL, but how are multiple return values handled? Assume that the manufacturing company , excited by the power of such a simple Web service as GET_PO_STATUS, now convinces its suppliers  to implement a service to respond to quotation requests (RFQs). This RFQ Web service would have the following signature:",{"@attributes":{"id":"p-0068","num":"0078"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"RFQ"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Inputs","part_num string","qty","desired_date"]},{"entry":[{},{},{},"ilnteger","date"]},{"entry":[{},"Outputs","price","proposed_date"]},{"entry":[{},{},"decimal","date"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}},"ul":{"@attributes":{"id":"ul0008","list-style":"none"},"li":"ex 9: RFQ inputs: String part_num, Integer qty, Date desired_delivery_date outputs: Decimal price, Date proposed delivery_date"}},"This service may be made accessible to DB2 by turning it into a DB2 Table Function, i.e., by creating a virtual table representative of the web service. Other relational database products may provide similar mechanisms for creating a virtual table. The DB2 Table function has the following parameters:",{"@attributes":{"id":"p-0070","num":"0081"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"357pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"GET_Quote"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"9"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"7","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"8","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"9","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Inputs","supplier","URL","part_num","qty","desired_date",{},{},{}]},{"entry":[{},"varchar(30)","varchar(80)","varchar(20)","ilnteger","date"]},{"entry":["Outputs","supplier","URL","part_num","qty","desired_date","price","currency","proposed_date"]},{"entry":[{},"varchar(30)","varchar(80)","varchar(20)","ilnteger","date","decimal","varchar(10)","date"]},{"entry":{"@attributes":{"namest":"1","nameend":"9","align":"center","rowsep":"1"}}}]}}]}}},"To provide more meaningful context, the table function includes as outputs all of the interesting input parameters. The Get_Quote table function is invoked inside of a query such as:\n\n","This statement will return back a table containing a single row with the response from this supplier. But what if the manufacturing company  dealt with suppliers in other countries? The Get_Quote function contains the currency units, so it would be an easily matter to convert the price to dollars. Now to perform the conversion one could, of course, try to manually maintain a table of currency conversion data\u2014but given the volatile nature of foreign exchange, it would be better to invoke another Web service, perhaps provided by a foreign exchange trading firm, to perform this conversion for us using up to the minute information. The DB2 function to invoke this service will be:\n\n","Using this additional service, one may obtain a more accurate quote using a query such as:\n\n","In the preceding example the columns have been explicitly stated and, using the power of SQL, an output column named timeliness has been defined to reflect the deviation between the manufacturers desired date and the date proposed by the supplier  for the part. The currency conversion web service, to_dollars, has been utilized to convert the quoted price to U.S. currency. This query will return a single row with the quote from a single vendor for a single part. What if the manufacturer  had a list of needed parts that it wished to get quotes on? A table called NEEDED_PARTS is defined for this purpose:",{"@attributes":{"id":"p-0075","num":"0090"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"NEEDED_PARTS"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"part_num","qty","desired_date"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]},{"entry":[{},"34dsaf","20","Jul. 1, 2001"]},{"entry":[{},"35gfds","34","Aug. 1, 2001"]},{"entry":[{},"809gds","10","Jun. 30, 2001"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}]}}},"Now to get quotes on all of these parts from ASupplier, the following SQL is issued:\n\n","This query returns a table of quotes for each part listed in the NEEDED_PARTS table from Asupplier. But what the manufacturer  wanted to get quotes for each of its suppliers? To do so, the following query is issued:\n\n","So the above query generates quotes for all the needed parts from all the suppliers that offer the GET_QUOTE Web service and returns a table of these quotes ordered by part number and timeliness. Very powerful, yet simple, standard DB2 SQL.","Finally, the manufacturer  may want to expose this query as a Web service itself so that its purchasing agents can invoke the query from wherever they are as long as they have access to the internet. DB2 7.2 with the XML Extender provides a simple mechanism that allows Web services to be created in support of such queries. The extender allows stored procedures and SQL statements to be exposed as invokable Web service operations, as is described more fully in http:\/\/www.ibm.com\/software\/data\/db2\/extenders\/xmlext, incorporated by reference herein. Any catalogued stored procedure may be exposed. The operation signature includes the input and output parameters and will also return one or more stored procedure result sets as an XML document.","To summarize, the preceding example illustrates how Web services may be integrated into DB2 SQL as User Defined Functions. Once Web services can be invoked as UDFs one can leverage the full power of SQL to perform queries across combinations of Web services and persistent data.","Additional invocation mechanisms available for integrating a web service into a database are described below.","In a third specific embodiment, the mechanism for invoking a web service is a stored procedure. Stored procedures are well-known in the art of relational databases. A stored procedure is invoked by a call, e.g., from a database client, e.g., a command line processor, a JDBC client, another stored procedure, a static c program or embedded SQL application. The stored procedure invokes a web service with, for example, an embedded java class or an SQL statement containing an invocation of the service, e.g., through a UDF or table function, or through any of a number of common client interfaces to web services known to those skilled in the art. For example, creation of Java classes to invoke web services is described in the IBM web services toolkit.","In a fourth specific embodiment, the mechanism for invoking a web service comprises a trigger. Triggers are well-known in the art of relational databases. A trigger is invoked by a triggering event, e.g., a table state change such as inserting a row into a table. The trigger invokes the web service with a call to the web service, or an SQL statement containing an invocation of the service, e.g., through a UDF or table function.","In a fifth specific embodiment, the mechanism comprises a federated table accessed via a nickname and implemented using a wrapper. Such federated tables are known to those skilled in the art of federated databases. The federated table looks like a local table to the database. The wrapper, e.g., a DB2 Relational Connect wrapper, provides the machinery for invoking the external service and receiving the response back.","As a further aspect of the invention, a unique tool is provided for generating user defined functions (UDFs) from web services defined by the WSDL (Web Services Definition Language) notation. These UDFs may then be invoked through standard SQL statements. Used in conjunction with UDDI and the XML Registry\/Repository, this means that a user may easily locate useful web services using UDDI, retrieve descriptions of these web services using UDDI and\/or XRR and then extend a database with access to these web services by using this tool to generate UDFs.","The steps preformed by the UDF generator are described below, with reference to . A user browses a UDDI or other registry for a desired web service, e.g., a web service that will return the current exchange rate to US dollars from a given currency. This step is represented as step a) in  and may be executed, for example, using an XML query wrapped as a SOAP request. The web service description is returned, for example, as an XML document.","The user then issues a query to XRR or UDDI to find the name of the WSDL file that implements this web service, as shown in  by step b). The contents of the WSDL file of the present example are:",{"@attributes":{"id":"p-0088","num":"0105"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<?xml version = \u201c1.0\u201d?>"]},{"entry":[{},"<definitions name = \u201cCurrencyExchangeService\u201d targetNamespace ="]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u201chttp:\/\/www.xmethods.net\/sd\/CurrencyExchangeService.wsdl\u201d"},{"entry":"xmlns:tns=\u201chttp:\/\/www.xmethods.net\/sd\/CurrencyExchangeService.wsdl\u201d xmlns:xsd ="},{"entry":"\u201chttp:\/\/www.w3.org\/2001\/XMLSchema\u201d xmlns:soap = \u201chttp:\/\/schemas.xmlsoap.org\/wsdl\/soap\/\u201d"},{"entry":"xmlns = \u201chttp:\/\/schemas.xmlsoap.org\/wsdl\/\u201d>"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<message name = \u201cgetRateRequest\u201d>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<part name = \u201ccountry1\u201d type = \u201cxsd:string\u201d\/>"]},{"entry":[{},"<part name = \u201ccountry2\u201d type = \u201cxsd:string\u201d\/>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/message>"]},{"entry":[{},"<message name = \u201cgetRateResponse\u201d>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<part name = \u201cResult\u201d type = \u201cxsd:float\u201d\/>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/message>"]},{"entry":[{},"<portType name = \u201cCurrencyExchangePortType\u201d>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<operation name = \u201cgetRate\u201d>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<input message = \u201ctns:getRateRequest\u201d \/>"]},{"entry":[{},"<output message = \u201ctns:getRateResponse\u201d \/>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<\/operation>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/portType>"]},{"entry":[{},"<binding name = \u201cCurrencyExchangeBinding\u201d type ="]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\u201ctns:CurrencyExchangePortType\u201d>"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<soap:binding style = \u201crpc\u201d transport ="]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\u201chttp:\/\/schemas.xmlsoap.org\/soap\/http\u201d\/>"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<operation name = \u201cgetRate\u201d>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<soap:operation soapAction=\u201c\u201d\/>"]},{"entry":[{},"<input>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<soap:body use = \u201cencoded\u201d namespace ="]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u201curn:xmethods-CurrencyExchange\u201d encodingStyle ="},{"entry":"\u201chttp:\/\/schemas.xmlsoap.org\/soap\/encoding\/\u201d\/>"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/input>"]},{"entry":[{},"<output>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<soap:body use = \u201cencoded\u201d namespace ="]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\u201curn:xmethods-CurrencyExchange\u201d encodingStyle ="},{"entry":"\u201chttp:\/\/schemas.xmlsoap.org\/soap\/encoding\/\u201d\/>"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<\/output>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<\/operation>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/binding>"]},{"entry":[{},"<service name = \u201cCurrencyExchangeService\u201d>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<documentation>Returns the exchange rate between the two"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"currencies<\/documentation>"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<port name = \u201cCurrencyExchangePort\u201d binding ="]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"280pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"\u201ctns:CurrencyExchangeBinding\u201d>"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"224pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<soap:address location = \u201chttp:\/\/services.xmethods.net:80\/soap\u201d\/>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<\/port>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"252pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"<\/service>"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<\/definitions>"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"A simple form of the command is executed with the following:\n\n","This command will result in an SQL script file called CurrencyExchangeService.SQL that contains the definition and implementation of a user-defined function to invoke the currency exchange web service.","Optionally, the user may then query the UDDI or other repository to determine all suppliers who offer the identified web service, as shown in step a) of . For example, the user may issue an SQL query to the remote UDDI and receive tuples containing information about the suppliers. As represented by the forward arrow in step b) of , the UDF may then be invoked within standard SQL statements such as the following:\n\n","In addition to creating scalar functions such as above, one may also create table functions where the invocation of the web service yields a table of one or more rows, as represented by the backward arrow in step b) of . For instance, assume that there is a web service that returns status about commercial flights. Using the UDF generating tool one may generate a table function getFlightInfo that returns a table containing the airline, flight number, location, speed, altitude and equipement. The following query illustrates how this may be used:\n\n","Of course, once a table function is created, it may be utilized in a variety of ways. For instance, one may return the status of a set of flights, combine this information from other tables and web services, and store information about this flight in a table.","The constructed UDFs make use of general Web Service invocation functions. A general function to invoke HTTP based Web Services, soaphttp, accepts as input parameters the URL of the web service provider, the name of the web service and the name of the particular operation or method to be performed in addition to a string containing the input parameters. The function returns the a single string containing the result of the invocation.","The following example shows an invocation of a very simple web service that accepts a single input parameter (country) and returns a single output parameter.",{"@attributes":{"id":"p-0096","num":"0117"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Values soaphttp(\u2018http:\/\/services.xmethods.net:80\/soap\u2019,"]},{"entry":[{},"\u2003\u2018urn:xmethods-CurrencyExchange\u2019,"]},{"entry":[{},"\u2003\u2018getRate\u2019,"]},{"entry":[{},"\u2003\u2018UK\u2019)"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Most web services are more complex with multiple input and output parameters, often with complex structures. The web service UDF generator creates the code to construct the input parameters and parse the result into one or more values.","In the examples above, the tool is shown to create UDFs that invoke the web service from a particular provider. Often, a web service will be defined such that it may be implemented by multiple providers. For instance if a company worked with its suppliers to develop a standard web service interfaces to get the order status of outstanding orders, one might want to invoke the same UDF implementing the web service request against many different web service providers, perhaps even in the same statement. The tool currently allows you to specify that a UDF be generated to support this by allowing an additional parameter containing the location of the service provider to be passed at execution time. For example, if we had a table containing the names of suppliers and the URL of the po_status web service they implement then we could issue the following query:\n\n","This query invokes the po_status web service for each row in the purchase orders table sending each request to the appropriate supplier service.",{"@attributes":{"id":"p-0100","num":"0122"},"figref":"FIG. 10","b":["81","82","83","84","85","86","87","88","89","91","92","93","94","95","96","97"]},"In conclusion, a system, method and program product have been described for invoking a web service from within a database by representing the web service as an artifact local to the database. In addition, a tool has been described for automatically generating a user-defined function from a standard description of a web service, for use in invoking the web service from a database."],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","Web Services Fundamentals","Accessing DB2 Data through Web Services","Invoking Web Services from a Database","Invocation with User-Defined Functions\/Virtual Tables.","Invoking a Web Service through a Stored Procedure","Invoking a Web Service with a Trigger Function","Wrapping a Web Service Within the Database","Generating a UDF from WSDL","Conclusion"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["A more complete understanding of the present invention may be obtained from a consideration of the following description when read in conjunction with the accompanying drawing in which:",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 10"}]},"DETDESC":[{},{}]}
