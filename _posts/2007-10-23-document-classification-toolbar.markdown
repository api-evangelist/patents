---
title: Document classification toolbar
abstract: Electronic document classification is disclosed. A toolbar adds the ability to classify documents based on specific properties such as security classification, information type, document type, document retention, document caveats, and the like associated. The toolbar through dropdown selections allows users to select the appropriate classification and properties based upon the content of the document and have appropriate classifiers added to the document. Document classification properties are generated that are associated with the document in the document properties and by inserting visual markings that allow users to quickly identify the security, sensitivity, intended distribution or retention. By utilizing the classification toolbar a user can classify an document by one or more classification levels and be ensured that the classification will be visible to any person viewing the document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08024304&OS=08024304&RS=08024304
owner: Titus, Inc.
number: 08024304
owner_city: 
owner_country: CA
publication_date: 20071023
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This application claims priority from U.S. provisional application No. 60\/863,067 filed Oct. 26, 2006 which is hereby incorporated by reference.","The present disclosure relates to computer systems and software, and in particular to electronic document management and security using a document classification toolbar.","Electronic documents commonly used in the corporate and government environments are generated being word processing applications, spreadsheets, slide presentations, the most common being MICROSOFT OFFICE\u2122 application suite. With today's pervasive networking systems such as local area networks (LANs), wide area networks (WANs) and the Internet, and software tools such as e-mail, it is very easy for individuals to move these documents around to different computers, computer systems and other individuals without little or no thought as to the sensitivity of the content contained therein. As a matter of security in the electronic workplace there is therefore a need to classify, manage and control the creation and flow of documents, e-mail correspondence and the like.","Some document management solutions allow the user to associate classifications to a document when a document is added to a document management repository governed by document management systems. These classification properties are stored in the document library database and are not actually attached to the document itself and are dependent on the document management system for identification and enforcement.","When a document is removed from the document management repository and sent to or shared with someone, it loses the associated properties because the properties are not part of the document. The classification may not also be visible on any printed copies of the document itself. As a result, the person receiving the document has no easy way to identify the classification of the document, and they therefore do not know what limitations should be placed on the handling and distribution of the document. In addition, compliance systems verifying the handling or distribution of the document have no way to decide what to do with the document as there are no properties attached to the document and potential contained in the document itself.","There is therefore a need for an improved classification and management system for electronic documents.","In an aspect there is provided a method for document classification in a document creation application comprising the steps: providing a classification toolbar within a document in the document creation application, the classification toolbar providing at least a first classification selection input; populating classification selections in the classification toolbar based upon pre-defined classification criteria; receiving a classification selection input, selected by a user, from the classification selections populated in the toolbar; determining if classification input is valid based upon administrator defined classification policy; applying visual cues to the document to identify that the document has been classified; and assigning XML classification properties to the document metadata based upon the classification selections when the classification input is valid.","In accordance with another aspect there is provided a method for document classification in a document creation application comprising the steps: providing a classification toolbar within the document, the classification toolbar providing at least a first classification selection input; populating classification selections in the classification toolbar based upon pre-defined classification criteria; receiving identification of a selected text portion of the document from a user; receiving a portion classification selection input, selected by the user, from the classification selections populated in the toolbar; determining if portion classification input is valid based upon administrator defined classification policy; applying visual cues to the document to identify a portion of the document has been classified; applying visual markers identifying the selected classification at the beginning and end of the portion that has been classified; and applying XML properties within the document representing the classification of the portions.","In accordance with yet another aspect there is provided a computer readable medium containing instructions for providing document classification in a document creation application, the instructions which when executed by a processor perform the steps of providing a classification toolbar within a document in the document creation application, the classification toolbar providing at least a first classification selection input; populating classification selections in the classification toolbar based upon pre-defined classification criteria; receiving a classification selection input, selected by a user, from the classification selections populated in the toolbar; determining if classification input is valid based upon administrator defined classification policy; applying visual cues to the document to identify that the document has been classified; and assigning XML classification properties to the document metadata based upon the classification selections when the classification input is valid.","In accordance with still yet another aspect there is provided a computer readable medium containing instructions for providing document classification in a document creation application, the instruction which when executed by a processor perform the steps of: providing a classification toolbar within the document, the classification toolbar providing at least a first classification selection input; populating classification selections in the classification toolbar based upon pre-defined classification criteria; receiving identification of a selected text portion of the document from a user; receiving a portion classification selection input, selected by the user, from the classification selections populated in the toolbar; determining if portion classification input is valid based upon administrator defined classification policy; applying visual cues to the document to identify a portion of the document has been classified; applying visual markers identifying the selected classification at the beginning and end of the portion that has been classified; and applying XML properties within the document representing the classification of the portions.","Other aspects and features will become apparent to those ordinarily skilled in the art upon review of the following description of specific embodiment of the invention in conjunction with the accompanying figures.","It will be noted that throughout the appended drawings, like features are identified by like reference numerals.","Embodiments are described below, by way of example only, with reference to .","Due to compliance legislation such as the Sarbanes-Oxley Act in the United States (or more precisely, the Public Company Accounting Reform and Investor Protection Act of 2002), policies such as the Health Insurance Portability and Accountability Act (HIPAA), or other legal or corporate guidelines there is a need for greater security of information. Companies need to be able to determine the classification of documents so that their employees will handle information correctly in terms of privacy, security, distribution and retention. The best way to do this is to generate recognizable classification properties and visual markers in the documents when they are being created so that everyone will know the level of sensitivity of the documents and how to handle them.","By creating classification criteria metadata properties inserted in a document travel with the document and also allow automatic processes to check the handling of the document. For example, a messaging gateway or content scanner can verify the classification of documents being sent out of the company via e-mail for any violations of policy. In addition classification criteria can allow the automatic insertion of to visual cues to identify the associated classification in a standard manner. Heretofore, this cannot be done with productivity suites such as MICROSOFT\u2122 OFFICE\u2122 software, ADOBE\u2122 ACROBAT, OPENOFFICE\u2122, COREL\u2122 WORDPERFECT\u2122 OFFICE and VISIO\u2122. Most document creation applications allow users to add optional properties to the document such as Title, Author, Subject, but cannot force the user to enter any properties before a document is saved or enforce classification standards. The document classification system described herein can force the user to select classification properties to be associated with the document, or portions therein, in addition to providing visual cues inserted within the document in standard format to ensure classification properties are appropriately identified and transmitted. Automatic insertion of visual markings in document including headers and footers in addition to advanced formatting capabilities which allow the user to apply the classification markings to specific areas of the header and footer (left justified, center, right justified etc.) to provide a consistent level of visibility not previously available. Custom properties that are associated with the document travel with the document and reflect the classification of the document can be integrated with rights management systems to limit access and distribution of document based upon the associated classification.","Event driven logic is utilized to force user to classify a documents before saving, sending or printing as described in more detail below. In addition to providing overall document classification, portions of the document can be classified at a different level than the document classification with unique classification markings associated to clearly identify the selected portion. All SAVE, PRINT and SEND events are interpreted within the document productivity software and ensure that classification selections have been made before these actions. Prevention or warning can be displayed when the user attempts to downgrade a classification of a document. In the downgrade prevent mode, if the user tries to downgrade the classification, for example from SECRET to UNCLASSIFIED, they can be prevented based upon the existing properties associated with it. Alternatively the document can be automatically classified based on the users profile. For example, all users in the finance department could be configured to automatically apply a classification of FINANCIAL INFO to all their documents. Visual markings within the document such as header, footer or watermarks can be automatically inserted based upon the selected classification.","Context sensitive classification selections which change based on user selection can also be provided by the toolbar. For example, if the user selects CONFIDENTIAL as a classification they can then be prompted to indicate which department generated the confidential information and how long the information should be retained as a corporate record.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 1","b":["114","108","110","112","114","116","118","108","110","112","104","102","104","106","106","108","110","112","108","110","112"]},"Classification selection enables the automatic creation of properties that will travel with the document and may be enforced by document classification software either residing on the computer , , or , or by a central server . Trusted label support provides verification that classification of the document has not been modified (tampered with) which can be done by calculating a hash of the document properties on saving and recalculating the hash on re-opening of the document by the software operating on the client. In addition, the classification policy allows users to search a network or PC for documents with specific classifications. Automatic logging may be provided for all classification actions by the user can be provided which can be used to audit user compliance. For example all classification warnings, classification errors, or all classification events (who classified, when classification properties were assigned, name of document etc) can be logged and reviewed by an administrator. Digital rights management policies such as Windows No Print or No Change can also be applied and controlled.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 2","b":["202","204","206","208","208","210","212","214","216"]},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3","b":["300","300","302","306","302","304","306","308"]},"The collection of classification properties can be context sensitive and the selections are configurable. For example, if the user selects Confidential as the security classification, they could then be prompted for a retention property or a distribution property. On the other hand, if the user selects Unclassified as the document type, there would be no need to collect any other classification properties. As an example, the classification collection logic could be implemented as follows:",{"@attributes":{"id":"p-0038","num":"0037"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"IF"]},{"entry":[{},"\u2003First Level Selection is CONFIDENTIAL"]},{"entry":[{},"THEN"]},{"entry":[{},"\u2003DISPLAY Second Level RETENTION selection"]},{"entry":[{},"ELSE"]},{"entry":[{},"\u2003NO MORE CLASSIFICATIONS"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"This example can be extended to many levels of classification allowing the organizations to collect many classification properties for each document. The toolbar is built dynamically based on the user selections. As an example of a possible configuration, if the user selected a sensitivity of PERSONAL, no other selections are necessary. If the user selects a sensitivity of COMPANY CONFIDENTIAL the toolbar is dynamically configured to further prompt the user for the allowed distribution of the document (e.g. LEGAL DEPT ONLY). In this way the toolbar can expand as the user is entering the classification information. Only subsequent classification criteria associated with the first selection is dynamically presented in the toolbar as will be discussed in connection with .",{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 4","b":["400","402","404"]},"It should be understood that although on two classification criteria are shown each in , a toolbar may present multiple classification criteria for selection by the user.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 5","FIGS. 3 & 4"],"b":["500","520","502","502","504","506","508","510","520","522","524"]},"Context sensitive text such as disclaimers can be added within the document body or within the header of footer portions. These disclaimers can be intelligently added to be tailored to the classification of the document and the associated content. For example, if UNCLASSIFIED was the selected classification the following text could be appended \u201cThis document is the property of XXX Corp. If you are not the intended recipient of the document please note the originator\u201d, whereas a different postfix such as \u201cThis document has been marked as Confidential to XXX Corp. Unauthorized reproduction or transmission of the document is prohibited\u201d if the classification selected was CONFIDENTIAL. Visual cues such as font characteristics can also be used in the added text for instance color, special fonts, font size, or formatting (table etc) can all be applied to text.","Portions of the document content may also be classified independently of the overall document, however when a portion classification is selected which is higher then the document selection, the document properties may be upgraded to match the selection, such as for example a security or sensitivity related criteria. In document , paragraph  is selected by the user for individual classification. By making selections using toolbar , visual cues  and  can be added within the document to clearly identify the associate classification criteria. In this example a classification of SECRET has been selected and a caveat RelToUSA_CAN which is not the same as the current selected document caveat RelToNATO. The classification markings for portions are represented within the document as Extensible Markup Language (XML) properties of the document as shown in . In the case or MICROSOFT WORD\u2122, for example, the base XML version of the document is modified with custom classification properties which represent the classification portion markings and the overall document classification. The markings may be custom to the application or organization or may be defined as per the Intelligence Community Classification and Control Markings Manual also known as the CAPCO Guide.","High level functions are available to the user when composing a document through operation of the toolbar. These functions are also available if the user wants to apply classification information to an opened document that currently has no classification properties, or an opened document that already has assigned classifications. Classification selection can be forced on Save, Exit or Print from a pop-up dialog rather than presenting a classification toolbar. In addition a downgrade warning for preventing downgrades when Saving or Printing can also be provided. Although a word processing document is shown should be understood that the application of the classification criteria is equally applicable to any form of document, including but not limited to MICROSOFT WORD\u2122, EXCEL\u2122 and POWERPOINT\u2122 formats. Any document creation product can be utilized which do not currently allow classification of documents.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":["FIG. 6","FIG. 12"],"b":["600","602","604"]},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 7","b":["700","704","706"]},"The classification toolbar can also provide built-in integration for users of the MICROSOFT WINDOWS\u2122 Rights Management Services (RMS) platform. Administrators can define associated RMS permissions such as Read, Full Control, Printing, Copy and Paste, and document expiration based on the classification label chosen. The RMS permissions or templates are defined within the MICROSOFT\u2122 RMS Administration tool. Once these RMS permissions are defined they can be associated with classification criteria. This is done via Windows registry settings that indicate to the document classification toolbar if RMS protection should be automatically assigned based on a classification selection by the user. If RMS protection is to be applied, then another Windows registry would be used to indicate what protection should be assigned for each classification. As an example, a presentation assigned an HR ONLY label could be automatically assigned RMS permissions that would not allow anyone outside the HR department to view the presentation. The Document Classification Administration tool sets the correct Windows Registry settings based on the configuration selected by the administrator. These settings can then be applied to user desktops using scripts or MICROSOFT\u2122 Group Policy.",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 8","b":["800","802","804","806","808"]},"Administrator defined settings are captured in the configuration file which is the central source of configuration information. The configuration file may be local on the computer ,  and  or be provided by the document server . This enables customization of the list of labels for classification; ability for administrator to configure warnings or prevent users from downgrading classifications; ability for administrator configuration to apply different customized headers, footers and watermarks depending on the classification selected; administrator can define default labels; define if\/when the label(s) will appear in the document title or file name; define the formatting and color of any visual marking text within the document such as the header or footer portions; define if\/when the label(s) will appear including the ability to display abbreviations of the classifications; force the user to make an explicit selection of a label before saving; and sort and search a PC's or network's document database based on the document's classification.",{"@attributes":{"id":"p-0051","num":"0050"},"figref":["FIGS. 9 and 10","FIG. 10"],"b":["902","904","906","908","910","912","910","912","914","914","1002","1002","910","1002","1004","1004"]},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 11","b":["1102","1104","1106","1104","1106","1108","1108","1110","1112","1112","1114","1116","1112","1116","1114"]},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 12","b":["1200","1202"]},{"@attributes":{"id":"p-0054","num":"0053"},"figref":["FIG. 13","FIG. 5","FIG. 5"],"b":["1300","1302","1304","526"]},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 14","b":["1400","1402","1404","1410","1412","1414","1416","1418","1420"]},"The following logic describes some example modules in the software and the methods associated with those modules. It also describes the events associated with each module. The COfficeDocument module contains the following methods:","i. AddHeaderFooter","ii. BuildPropertyString","iii. CalcDropdownWidths","iv CheckDowngrade","v. Cleanup","vi. CreateCommandBar","vii. CreateHash","viii. EnableCommandBar","ix. EnableSecondLevel","x. ExtractFrom Signature","xi. GetClassificationList","xii. GetDropdownSelections","xiii. GetProperty","xiv. GetSignatureShape","xv. HasClassifications","xvi. HashProperties","xvii. HasSignature","xviii. Has ValidProperties","xix. Has ValidPropertiesHashed","xx. Initialize","xxi. InsertFieldCode","xxii. InsertSignature","xxiii. InsertTitusTemplate","xxiv. Invoke","xxv. ProcessCommand","xxvi. ReadBuiltlnProperty","xxvii. ReadSignature","xxviii. SelectClassifications","xxix. SetDropdownSelections","xxx. SetHeader","xxxi. SetRMSPermission","xxxii. SetWatermark","xxxiii. UpdateClassifications","xxxiv. UpdateFleaderFooter","xxxv. ValidClassifications","xxxvi. WriteClassifications","The CClassificationList module contains the following methods:","xxxvii. ReadC lassi ficationsFromDocument","xxxviii. WriteClassificationsToDocument","xxxix. WritePlaceholdersToDocument","The CWordApplicationEventhandler module contains the following methods:","xl. AddOfficeDocument","xli. Cleanup","xlii. CleanupStrayDocuments","xliii. CreateHelpAbout","xliv. FindOfficeDocument","xlv. Initialize","xlvi. Invoke","xlvii. ProcessCommand","The following provide more detail on the actual methods:","i. bool COfficeDocument::AddHeaderFooter(Word::RangePtr pRange, bool fInsert)","Summary: Adds text to a header\/footer","Parameter pRange: Range to add too","Parameter fInsert: Can we insert into the document","Returns: Success of adding text","Determine if any of the fields in the range match the value for the first property or match the value for the second property","For all fields in range","If the value for the first property was not found and we can insert\n\n","If the value for the second property was not found and we can insert\n\n","ii. std::string COfficeDocument::BuildPropertyString(Word:: DocumentPtr pDocument)","Summary: Combine statistics from document and classifications into one string","Parameter pDocument: Document to get properties from","Returns: String containing the properties","iii. void COfficeDocument::CalcDropdownWidths( )","Summary: Calculate the width for each dropdown","iv. bool COfficeDocument::CheckDowngrade( )","Summary: Determines if the classification level is okay in terms of downgrade","Returns: True if the save is allowed","If classification downgrade has occurred\n\n","v. void COfficeDocument::Cleanup( )","Summary: Cleanup the commandbar","vi. void COfficeDocument::CreateCommandBar(bool fTampered)","Summary: Set up our custom toolbar","Parameter flampered: Has the document been tampered with","Calls GetClassificationList","Adds a new toolbar","Adds the dropdowns to our toolbar","Calls EnableCommandBar","Calls GetDropdownSelections","Calls WriteClassifications","vii. bool COfficeDocument::CreateHash(std::string strData, std::string& strHashedData)","Summary: Creates a hash of the data","Parameter strData: Data to hash","Parameter strHashedData: Hash of data","Returns: Hash creation success","Use the Crypt APT to create a hash of the data","viii. bool COfficeDocument::EnableCommandBar(bool fEnable)","Summary: Enable or disable our command bar","Parameter fEnable: Enable CommandBar","Returns: True if CommmandBar enabled","Calls SetDropdownSelections","Enables or Disables CommandBar","Calls EnableSecondLevel","ix. void COfficeDocument::EnableSecondLevel(bool bFirstEnabled)","Summary: Enables second Level Dropdown","Parameter bFirstEnabled: Enabled second level","x. std::string COfficeDocument::ExtractFromSignature(std::string strSignature, std::string strName)","Summary: Extracts a value of a name-value pair from the signature","Parameter strSignature: Signature to extract from","Parameter strName: Name of name-value pair to extract","Returns: Value of name-value pair to extract","xi. CClassificationList* COfficeDocument::GetC lassificationList(bool fTampered)","Summary: Returns the classification list","Parameter (Tampered: Has the document been tampered with","Returns: Classification list","If we have previously set the classification list\n\n","Else\n\n","xii. bool COfficeDocument::GetDropdownSelections( )","Summary: Retrieve the dropdown selections from the toolbar","Returns: If dropdown selection has changes since we last checked","Calls GetClassificationList","Get the selection for each dropdown","xiii. STDMETHODIMP COfficeDocument::GetProperty(LPDISPATCH pDisp, LPOLESTR pszName, VARIANT* pvResult)","Summary: Retrieve a named property from the document","Parameter pDisp: Object to get property from","Parameter pszName: Name of property","Parameter pvResult: Value of property","Returns: Success","xiv. Word::ShapePtr COfficeDocument::GetSignatureShape (Word::_Documentptr Pdocument, Bool Fcreatenew)","Summary: Returns the signature shape that matches our signature name from the document","Parameter pDocument: Document to get signature shape from","Parameter fCreateNew: Create a new shape if requested","Returns: The signature shape","Match all shape names against our signature name","If a match is found\n\n","Else\n\n","xv. bool COfficeDocument::HasClassifications(Word::_DocumentPtr pDocument)","Summary: Determines if the document has classifications","Parameter pDocument: Document to check","Returns: True if the document has classifications","Calls ReadClassificationsFromDocument","xvi. bool COfficeDocument::HashProperties(Word::_DocumentPtr pDocument)","Summary: Creates a signature of the document properties","Parameter pDocument: Document to get properties from","Returns: Success of creating hash","Calls BuildPropertyString","Calls CreateHash","Calls InsertSignature","xvii. bool COfficeDocument::HasSignature(Word::_DocumentPtr pDocument)","Summary: Determines if the document has a signature","Parameter pDocument: Document to check","Returns: True is document has a signature","Calls GetSignatureShape","xviii. bool COfficeDocument::HasValidProperties(Word::_DocumentPtr pDocument)","Summary: Determine if the document has valid properties","Parameter pDocument: Document to check","Returns: True if valid Properties","Return False if we can't find all of our document properties","xix. bool COfficeDocument::HasValidPropertiesHashed (Word::_DocumentPtr pDocument)","Summary: Determines if the hash in the signature matches the current document","Parameter pDocument: Document to check","Returns: True if signature matches properties of document","Calls ReadSignature on document","Calls ExtractFromSignature on the signature","Calls BuildPropertyString on document","Calls CreateHash","Compares hash from document and hash just created","xx. void COfficeDocument::Initialize(LPDISPATCH\/*lpDispatch*\/)","Summary: Get the handle to the window for the document","Parameter IpDispatch: unused","xxi. bool COfficeDocument::InsertFieldCode(Word::FieldPtr pField, LPCSTR szName)","Summary: Insert a new field code using the given property name","Parameter pField: Field to insert into","Parameter szName: Name of document property","Returns: Success of insertion","xxii. void COfficeDocumentAnsertSignature(Word::_DocumentPtr pDocument, std::string strValue)","Summary: Inserts the text into the signature shape","Parameter pDocument: Document to insert signature into","Parameter strValue: Value to put in signature","Calls GetSignatureShape","Sets the text of the signature shape","xxiii. bool COfficeDocumentAnsertTitusTemplate( )","Summary: Insert a Word template into the document","Returns: True if template inserted","Open a named word template file (.dot)","Copy the contents of the template document into the current document","xxiv. STDMETHODIMP COfficeDocument::Invoke(DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags, DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)","Summary: Event handler for COfficeDocument","Parameter dispIdMember: Event type","Parameter riid: Interface type","Parameter Icid: unused","Parameter wFlags: unused","Parameter pDispParams: unused","Parameter pVarResult: unused","Parameter pExcepInfo: unused","Parameter puArgErr: unused","Returns: Success","New Event:\n\n","Open Event:\n\n","Close Event:\n\n","xxv. HRESULT COfficeDocument::ProcessCommand(int nControllD, int nCommand, bool fMakeDirty)","Summary: Process commands sent from the toolbar","Parameter nControllD: What control is sending the command","Parameter nCommand: unused","Parameter fMakeDirty: unused","Returns: Success","If Control is first level dropdown\n\n","Else If Control is second level dropdown\n\n","Else if Control is third level button\n\n","xxvi. std:: string COfficeDocument::ReadBuiltInProperty(Word:: DocumentPtr pDocument, std::string strPropertyName)","Summary: Return a string for the named built in property","Parameter pDocument: Document to read from","Parameter strPropertyName: Name of property to read","Returns: Value of property","xxvii. std::string COfficeDocument::ReadSignature(Word::_DocumentPtr pDocument)","Summary: Gets the text from the signature shape","Parameter pDocument: Document to read from","Returns: Text of signature","Calls GetSignatureShape\\","xxviii. bool COfficeDocument::SelectClassifications( )","Summary: Shows Select Classification Dialog","Returns: Classifications set from dialog","Calls GetClassificationList","Shows Select Classifications Dialog <<Screenshot of dialog>>","xxix. void COfficeDocument::SetDropdownSelections( )","Summary: Set the selections on each dropdown","Calls GetClassificationList","Set the selection for each dropdown","xxx. void COfficeDocument::SetHeader(bool flnsert)","Summary: Updates or inserts text in all headers and footers","Parameter flnsert: Are we allowed to insert text into the header if it doesn't exist already","For all sections of the document","Calls UpdateHeaderFooter on the PrimarylleaderRange\n\n","Calls UpdateHeaderFooter on the EvenPageHeaderRange\n\n","xxxi. bool COfficeDocument::SetRMSPermission( )","Summary: Sets the RMS template to be applied to the document","Returns: Success","Get the RMS template assosiated with the current classification","Calls GetProperty passing in \u201cPermission\u201d","Retrieves current RMS template applied","If RMS is required\n\n","Else\n\n","If RMS failed\n\n","xxxii. void COfficeDocument::SetWatermark(std::string strClassification, bool finsert)","Summary: Updates or inserts the watermark using the given classification","Parameter strClassification: Text to put as the watermark","Parameter finsert: Are we allowed to insert a watermark if one isn't there","If the Titus watermark is found by matching the name of the watermark against a known name\n\n","Else\n\n","xxxiii. void. COfficeDocument::UpdateClassifications(bool fTampered)","Summary: Updates the header, footer, watermark, and selected fields within the document","Parameter fTampered: Has the document been tampered with","If the document has not been tampered with\n\n","Update fields in the document that match our property names","xxxiv. bool COfficeDocument::UpdateHeaderFooter(Word::RangePtr& pRange, bool fInsert)","Summary: Update a header\/footer","Parameter pRange: Range of a header\/footer","Parameter flnsert: False to hide the text","Returns: True if update successful","For all fields in the range of the document\n\n","xxxv. bool COfficeDocument::ValidClassifications( )","Summary: Determines if all dropdowns that require a selection have been set","Returns: True if no dropdown requires a selection","xxxvi. bool COfficeDocument::WriteClassifications(bool fAskIfRequired, bool fTampered)","Summary: Writes classifications to document","Parameter fAsklfRequired: Ask for classifications if they are not valid","Parameter fTampered: Has the document been tampered with","Returns: True if classifications are valid","Calls GetClassificationList","Calls ValidClassifications","If ForceSelect is on and classifications are not valid\n\n","If the classifications are valid","Calls WriteClassificationsToDocument","Calls UpdateClassifications","xxxvii. short CClassificationList::ReadClassificationsFromDocument (Word::_DocumentPtr pDocument)","Summary: Reads the classifications from the document","Parameter pDocument: Document to read classifications from","Returns: Number of levels","Get the custom document properties from the document","Get the value from the named property for the first level","Get the value from the named property for the second level","Get the value from the named property for the third level","xxxviii. short CClassificationList::WriteClassificationsToDocument (COfficeDocument* pDocument)","Summary: Writes classifications into the custom document properties","Parameter pDocument: Document to write classification to","Returns: Zero","Gets the custom document properties","Adds or updates the value of the custom document property with the value of the first dropdown","Adds or updates the value of the custom document property with the value of the second dropdown","Adds or updates the value of the custom document property with the value of the third level","xxxix. short CClassificationList::WritePlaceholdersToDocument(COfficeDocument* pDocument)","Summary: Write classifications to document properties","Parameter pDocument: Document to write to","Returns: Zero","Add a custom document property for the first level","Add a custom document property for the second level","Add a custom document property for the third level","xl. COfficeDocument* CWordApplicationEventHandler::AddOfficeDocument (Word::_DocumentPtr pDocument, bool fNew, bool fIsE-mail)","Summary: Add the word document to our collection","Parameter pDocument: Document to add","Parameter fNew: Is the document new","Parameter fIsE-mail: Is the document an e-mail","Returns: COfficeDocument","Calls FindOfficeDocument","If that returns NULL\n\n","xli. void CWordApplicationEventHandler::Cleanup( )","Summary: Cleanup help command bar","xlii. void CWordApplicationEventHandler::CleanupStrayDocuments( )","Summary: Remove any documents from our collection that we don't need anymore","xliii. void CWordApplicationEventHandler::CreateHelpAbout( )","Summary: Add a menu item to the Help About menu.","If the menu item is already there delete it","Add the menu item","xliv. COfficeDocument* CWordApplicationEventHandler::FindOfficeDocument (Word::_DocumentPtr pDocument)","Summary: Find the document in our collection","Parameter pDocument: Document to find","Returns: Document in our collection","Match the document in our collection with the one passed in","If matched\n\n","Else\n\n","xlv. void CWordApplicationEventHandler::Initialize(LPDISPATCH\/*lpDispatch*\/)","Summary: Initialize event handler","Parameter lpDispatch: unused","Calls CreateHelpAbout","xlvi. STDMETHODIMP CWordApplicationEventHandler::Invoke(DISPID dispIdMember, REFIID riid, ECM lcid, WORD wFlags, DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)","Summary: Event handler for CWordApplicationEventHandler","Parameter dispIdMember: Event type","Parameter riid: Interface type","Parameter lcid: Unused","Parameter wFlags: Unused","Parameter pDispParams: Parameters for event","Parameter pVarResult: Unused","Parameter pExcepInfo: Unused","Parameter puArgErr: Unused","Returns: Success","Quit Event:\n\n","DocumentBeforePrint Event:\n\n","DocumentBeforeSave Event:\n\n","WindowActivate Event:\n\n","WindowDeactivate Event:\n\n","xlvii. HRESULT CWordApplicationEventHandler::ProcessCommand(int nControlID, int nCommand, bool fMakeDirty)","Summary: Show the about dialog","Parameter nControllD: ID of control","Parameter nCommand: unused","Parameter fMakeDirty: unused","Returns: Success","Show About dialog","It will be apparent to persons skilled in the art that many alternatives, modifications, and variations can be made without departing from the scope as defined in the claims. The method steps described may be embodied in sets of executable machine code stored in a variety of formats such as object code or source code. Such code is described generically herein as programming code, or a computer program for simplification. Clearly, the executable machine code may be integrated with the code of other programs, implemented as subroutines, by external program calls or by other techniques as known in the art.","A computing environment for executing the document creation application and the classification toolbar may be implemented as computer software in the form of computer readable code executed. The computing environment may be any number of computing or computer based platforms such as mobile devices, personal computer, notebook computers, or personal digital assistants. The computer comprises central processing unit (CPU) and memory. The CPU may be a single processor or multiprocessor system. In various computing environments, main memory and storage can reside wholly on computer environment, or they may be distributed between multiple computers.","Input devices such as a keyboard and mouse may be coupled to a bi-directional system bus of a computer for receiving input for creating documents within the web client. The keyboard and mouse are for introducing user input to a computer and communicating that user input to processor if required. Computer may also include a communication interface. Communication interface provides a two-way data communication coupling via a network link to a network by wired or wireless connection or may provide an interface to other host devices by a direct radio frequency connection. In any such implementation, communication interface sends and receives electrical, electromagnetic or optical signals which carry digital data streams representing various types of information. Communication between the communication interface unit and the network or host use electrical, electromagnetic or optical signals which carry digital data streams. The signals through the various networks and the signals on network link and through communication interface, which carry the digital data to and from computer, are exemplary forms of carrier waves transporting the information.","The computer processor or similar device may be programmed in the manner of method steps, or may be executed by an electronic system which is provided with means for executing these steps. The storage device may include both fixed and removable media, such as magnetic, optical or magnetic optical storage systems, Random Access Memory (RAM), Read Only Memory (ROM) or any other available mass storage technology. The storage device or media may be programmed to execute such method steps. As well, electronic signals representing these method steps may also be transmitted via a communication network.","The embodiments described above are intended to be illustrative only. The scope of the invention is therefore intended to be limited solely by the scope of the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Further features and advantages will become apparent from the following detailed description, taken in combination with the appended drawings, in which:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIGS. 9 and 10"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 13","FIG. 5"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 14"}]},"DETDESC":[{},{}]}
