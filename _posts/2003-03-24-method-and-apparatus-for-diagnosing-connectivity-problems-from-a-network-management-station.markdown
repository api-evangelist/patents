---
title: Method and apparatus for diagnosing connectivity problems from a network management station
abstract: A network management station manages multiple devices on a network, which may include storage appliances, caching appliances, and other devices. The network management station includes software that assists a network administrator by diagnosing a connectivity problem relating to a device on the network. To diagnose the connectivity problem, the software attempts to communicate with the device from the management station by separately using each of multiple communication protocols, including one or more device type-specific protocols. The software identifies possible causes for the connectivity problem based on the results of using the different protocols. The software generates a graphical user interface indicating the individual results of attempting to communicate with the device using the different protocols and the possible causes for the connectivity problem. Based on the information presented, the administrator can more effectively troubleshoot the connectivity problem.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07457866&OS=07457866&RS=07457866
owner: NetApp, Inc.
number: 07457866
owner_city: Sunnyvale
owner_country: US
publication_date: 20030324
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["COPYRIGHT NOTICE","FIELD OF THE INVENTION","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure, as it appears in the Patent and Trademark Office patent file or records, but otherwise reserves all rights whatsoever.","At least one embodiment of the present invention pertains to diagnosing connectivity problems on a network, and more particularly, to a method and apparatus for diagnosing connectivity problems from a network management station.","In most computer networks, system and network administrators use software programs, i.e., network management applications, to monitor the network and to help recognize problems with systems attached to the network. Sometimes either the network management stations or the systems on the network are misconfigured in such a way that the network management stations cannot communicate with the systems on the network or cannot determine the health of the systems on the network. Examples of such misconfigurations include: system names not matching the network addresses being used; passwords being configured differently between management stations and network nodes; and routers and switches being configured to block some network ports between the management stations and network nodes.","A conventional approach to addressing this problem is for network administrators to use various software tools to try to identify the source of the problem. For example, network administrators can use name and address resolution tools on the management station and on the network nodes to ensure that the names and addresses match; they can check passwords on both management station and network nodes to see if they match; and so on. This approach is inadequate, however, because the set of tools continually evolves (making it very difficult to administrators to know which tools are useful), and because the set of tools is different on different network nodes (making it very difficult to apply knowledge learned with one network node to another). What is needed, therefore, is a more effective way of diagnosing connectivity problems from a network management station.","The invention includes a method and apparatus for a network management station to diagnose a connectivity problem on a network. The method includes detecting a connectivity problem related to accessing a device on the network, attempting to communicate with the device from the network management station by separately using each of multiple communication protocols, and identifying a possible cause for the connectivity problem, based on results of attempting to communicate with the device.","Other features of the present invention will be apparent from the accompanying drawings and from the detailed description which follows.","A method and apparatus for a network management station to diagnose a connectivity problem on a network are described. Note that in this description, references to \u201cone embodiment\u201d or \u201can embodiment\u201d mean that the feature being referred to is included in at least one embodiment of the present invention. Further, separate references to \u201cone embodiment\u201d or \u201can embodiment\u201d in this description do not necessarily refer to the same embodiment; however, such embodiments are also not mutually exclusive unless so stated, and except as will be readily apparent to those skilled in the art from the description. For example, a feature, structure, act, etc. described in one embodiment may also be included in other embodiments. Thus, the present invention can include a variety of combinations and\/or integrations of the embodiments described herein.","As described in greater detail below, a network management station manages multiple devices on a network, which may include storage appliances, caching appliances, and other devices. The network management station includes network management software that assists a system or network administrator by diagnosing a connectivity problem relating to a device on the network. To diagnose the connectivity problem, the management software attempts to communicate with the device from the management station by separately using each of multiple communication protocols, which may include one or more device type-specific protocols. The management software identifies possible causes for the connectivity problem based on the results of using the different protocols. The software generates a graphical user interface indicating the individual results of attempting to communicate with the device using the different protocols and the possible causes for the connectivity problem. Based on the information presented, the administrator can more effectively troubleshoot the connectivity problem.","One of the barriers to deployment of network management software in general is the time and expertise it takes to get the software set up in a particular network environment. The solution described herein addresses this issue by making it easier for network administrators and other users to configure the management software to work in their networks and helping to find problems and errors elsewhere in the network. The described solution provides diagnostic tools needed for multiple devices in a single place (on a network management station), using them in the appropriate ways for different types of systems on the network, and hiding differences between network diagnostic tools across different management stations and network device operating systems.","Refer now to , which illustrates a network  in which the present invention is employed. The network is based around a local area network (LAN) interconnection . However, a wide area network (WAN), virtual private network (VPN) implementation (utilizing communication links over the Internet, for example), or a combination thereof can alternatively be used. Connected on the LAN  may be various devices, such as one or more personal computers (PCs) , servers , network storage appliances , and network caching appliances . Although only one storage appliance  and one caching appliance  are shown in , it will be understood that more than one of each of these devices may be connected on the LAN  in any given embodiment. The network storage appliances  can include appliances that operate as file servers (e.g., \u201cfilers\u201d), such as a NetApp\u00ae filer made by Network Appliance, Inc. of Sunnyvale, Calif. The network caching appliances  can include appliances such as a NetCache\u00ae, also made by Network Appliance, Inc.","Also connected to the LAN  may be a switch\/router  that provides a gateway to the well-known Internet  for devices on the LAN , thereby enabling the devices on the LAN  to transmit and receive internet based information, such as e-mail, World Wide Web content, and the like.","Also connected to the LAN  is a management station . The management station  can include a server or PC-based computer with a network interface for communicating over the LAN . A network management software application (\u201cmanagement software\u201d)  resides and executes within the management station . The management software  enables an administrator or other user to monitor status, performance and usage of devices on the LAN , including the storage appliances  and caching appliances . In certain embodiments, the management station  utilizes a simple network management protocol (SNMP) communication process to obtain and manipulate information on the networked devices. SNMP is designed to enable networks to be remotely managed from a centralized management station. In particular, it comprises a packet-based protocol using messaging to communicate with networked devices and clients. The messages are provided as management information blocks (MIBs). The MIBs and SNMP protocol, and their use in providing network management information between SNMP management stations and agents are well-known and are described in, for example, William Stallings, \u201cSNMP, SNMPv2 and RMON\u201d, Addison Wesley Publishing Company, 1996. The status, performance and usage information is displayed and manipulated on the station using a graphical user interface (GUI) generated on a display device of the management station  or a remote terminal.","Each of the devices attached to LAN  includes an appropriate, conventional network interface arrangement (not shown) for communicating over the LAN  using desired communication protocols, such as the well-known Transport Control Protocol\/Internet Protocol (TCP\/IP), User Datagram Protocol (UDP), Hypertext Transfer Protocol (HTTP) or Simple Network Management Protocol (SNMP).",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2A","b":["10","10","21","22","23","24","25","26","27","21","22","23","10"]},"The monitor unit  includes a variety of sub-units (which may be processes) that continuously examine each appliance or other device in the network to determine if it is behaving within the configured operational parameters. The appliance APIs  are used to communicate with the various appliances on the LAN . The sub-units monitor parameters such as appliance CPU usage, disk space, temperature, licenses, user quotas, and so on. Each sub-unit saves the results of its operations in the database . The monitor unit  determines whether an event has been detected regarding the monitored parameters, which requires reporting. The monitor unit  can be provided with appropriate threshold values for this purpose, which can be easily stored by an administrator or preset in the database . The monitor unit  performs a comparison of received statistical information to the threshold information.","Generally the database  also includes the names, network addresses, and device types (e.g., storage appliance, caching appliance) of all devices that the management software  is managing. The names and addresses may be entered into database  either by a network administrator or automatically when the management software  discovers the devices. According to one embodiment, the database  is a relational-type database. However, any acceptable data storage arrangement can be employed. In this embodiment, the database can be organized and accessed using Structured Query Language (SQL) and the Open DataBase Connectivity (ODBC) standard.","If an event occurs, such as a monitored parameter being out-of-threshold, the monitor unit  transmits a message with the details of the event to the event unit  using an appropriate messaging protocol, such as hypertext transfer protocol (HTTP). The event unit  then queries the database  to determine if any interested parties should be notified of the event. If the database  contains entries relating to the affected device, these data are returned to the event unit . These entries can include web links for related information as well as e-mail addresses, pager numbers, and other communication addresses for the interested parties.","The event unit  uses the appropriate notification APIs  to generate e-mail messages, pages, or other forms of notification, to notify each interested party, using communication addresses retrieved from the database. In this manner, specific administrators and other users are immediately informed of any critical information involving devices relevant to them. The management station  can include an appropriate e-mail server and\/or paging application (not shown), which interact with the event unit  to facilitate the sending of event notifications. Alternatively, the notification of an event can take the form of an alarm, alert, telephone call, or other messaging mechanism to an interested party that is implemented through appropriate automated systems.","The database  is also queried by the command unit . The command unit  generates web-based reports on particular devices using, for example, a common gateway interface (CGI). CGI can be used as an interface between the command unit  and its associated command tools and the Web server . Device information is accessed via the Web server , which provides Web content (e.g., Web pages) to a Web browser  operating in the management station , for displayed to an administrator or other interested user. The content can be displayed in any acceptable and useful form, including screen displays such as described below.","As noted above, the monitor unit  includes a variety of sub-units (e.g., sub-processes) that examine each appliance or other device in the network to determine if it is behaving within the configured operational parameters. As shown in , one of these sub-units is a discovery unit . The discovery unit  attempts to locate new devices on the LAN  to begin monitoring them. This discovery process  can fail because of configuration mistakes in the network. Until the management station  can first communicate with a node on the network, the other monitor sub-processes  cannot begin their work.","Accordingly, the management software  provides multiple interfaces, including a command line interface and a GUI, to allow administrators to examine a list of the network devices that the management station  is managing.  shows an example of the screen display containing such a list.","Referring now to , if the administrator determines that a particular device should be included in the list of managed devices but is not, the administrator can input (block  in ) the name or network address of the device into field  in the GUI, as shown in , or into the command line interface, as a request to add the device to the set of managed devices. The management software  then attempts to locate the specified device (a host) on the network (block ). If the device is added successfully, the GUI is updated to show the device among the set of managed devices (block ).","If this attempt fails for any reason (block ), the management software  offers to diagnose the causes of the failure (block ). For example, if the management software  is unable to locate or communicate with the device to be added, then as shown in , the management software  may display an appropriate error message and a prompt, such as \u201cClick here to troubleshoot.\u201d The prompt may be a hyperlink, which when activated by the user, initiates a diagnostic process relative to that device. The diagnostic process may be a sub-process of the discovery unit  in the monitor unit .","To diagnose the possible causes of failure, the diagnostic process uses a set of heuristics to perform several types of tests, to help determine the cause of the connectivity problem.  is an example of a screen display including results of performing the diagnostic process on a device. As shown, the display includes the results (e.g., \u201cTimed out, \u201cFailed\u201d) of attempts by the diagnostic process to communicate with the device using several different communication protocols, including SNMP, Internet control message protocol (ICMP) and HTTP.","In addition, the diagnostic process may use one or more device type-specific protocols to attempt to access the device. For example, if the diagnostic process determines that the device is a network caching appliance, then it uses one or more protocols that are specific to that type of network caching appliance, in attempting to access the device. Likewise, if the diagnostic process determines that the device is a network storage appliance, then uses one or more protocols that are specific to that type of network storage appliance, in attempting to access the device. As a more specific example, if a device is a network storage appliance, the diagnostic process may use network data management protocol (NDMP) to communicate with the device. Alternatively, or additionally, if the device is either a network storage appliance or a network caching appliance, the diagnostic process may use a version of extensible markup language (XML) and\/or simple object access protocol (SOAP) known to be specific to that type of device, to communicate with the device (e.g., over HTTP).",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIGS. 8 and 9","FIG. 7"]},"The diagnostic process is not limited to use when there is a problem adding an unmanaged device to the set of managed devices. For example, the diagnostic process can be useful when a connectivity problem is detected with a managed device.  shows an example of a screen display from which the diagnostic process can be triggered with respect to a managed device. For a particular managed device, the user can request the diagnostic process to diagnose connectivity to the device using a pull down menu . The results of running the diagnostic process may be presented in a screen display such as shown in . Note that the diagnostic results are more detailed for a managed device (e.g., ) than for an unmanaged device (e.g., ,  and ).",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIGS. 12A through 12C","b":["1201","24","9","24"]},"For an unmanaged device for which the administrator provided an IP address, that address is used.","If the administrator entered a device name, the DNS is used to resolve the name to an address.","At block , the diagnostic process determines whether the address of the device is part of one of the networks that the management station  is managing. If the address is not part of a managed network, the diagnostic process prompts the administrator at block  to provide details of that network (i.e., its address and network mask) to enable the diagnostic process to discover devices on that network.","Next, at block  the diagnostic process attempts to contact the device using SNMP. In particular, the diagnostic process collects the \u201csysObjectID\u201d and \u201csysName\u201d variables (see RFC 1155). If this attempt fails, one of several problems could be the cause: 1) the device may be down; 2) the device may have SNMP disabled; 3) the device may require a different SNMP Community (the GUI may provide a link to fix this problem); or 4) network devices between the management station  and the device may disallow SNMP traffic. At block  the diagnostic process displays the results of the SNMP request, as well as the SNMP Community string it used, for comparison with the values on the device.","At block  the diagnostic process attempts to contact the device using ICMP ECHO requests. Failure of these requests may indicate that the device is not powered on or connected to the network. At block  the diagnostic process attempts to contact the device using HTTP. Specifically, the diagnostic process tries to open the HTTP port () on the device. If block  succeeds but block  fails, it is likely that a router, switch, or firewall is configured to block HTTP traffic, and that device needs to be reconfigured. Similarly, if block  succeeds but block  fails, a router, switch, or firewall is configured to block SNMP traffic, and that device needs to be reconfigured. The results of blocks  through  are displayed in the GUI at block .","Next, the diagnostic process determines whether the device is a managed network storage appliance  (block ) or a managed network caching appliance  (block ) (although it might be neither). The device is a managed device if its name or address is in database . If the device is a managed device, the type of device can be determined from its device type data stored in database . Thus, if the device is a managed storage appliance , the diagnostic process attempts at block  to connect to the NDMP port  and to authenticate the device using the login names and passwords previously provided to the management software . If the attempt is successful (block ), the results are displayed at block . If the attempts fail, the diagnostic process prompts the administrator at block  to update either the device or the management software  so that the passwords match. The GUI may provide a link to fix this problem.","If the device is a managed network caching appliance  (block ), the diagnostic process attempts to retrieve information about the device, using one or more HTTP uniform resource locators (URLs) specific to different versions of the internal software of those devices. For example, a first URL may link to detailed system information about the device, while a second URL may link to information about the network interface cards on the device.","If the device is not a managed storage appliance  or caching appliance , but it is a managed appliance that appears to be operative (block ), the diagnostic process attempts at block  to run a \u201cversion\u201d command (or the like) on the device using remote shell (RSH) and, if that fails, using secure remote shell (SSH). If these attempts fail, but the preceding access attempts succeeded, the device is using a different password than the one configured in the management software , and the resulting display (block ) prompts the administrator to adjust either the management software  or the device so that the passwords agree.","Also if the device is a managed appliance that appears to be operative, the diagnostic process also attempts to contact the device using any device type-specific programming interfaces (which could be proprietary) that are known to the management software , if any. As noted above, examples of such device type-specific programming interfaces might include one or more forms of XML and\/or SOAP over HTTP. As a more specific example, for a particular type of network storage appliance, the diagnostic process might attempt a \u201cvolume-list\u201d request (or the like) using XML-over-HTTP interfaces defined for such devices. The requests might have the form \u201c<volume-list\/>\u201d, while a response might have the following form:\n\n","Any of the processing systems illustrated in  (e.g., the management station , the storage appliances , the caching appliances , etc.) can be implemented using well-known hardware components arranged in conventional architectures.  is a high-level block diagram showing an example of such a processing system. Note that  is a conceptual representation which represents any of numerous possible specific physical arrangements of hardware components; however, the details of such arrangements are not germane to the present invention and are well within the knowledge of those skilled in the art. Also note that, in certain embodiments, some of the above-mentioned processing systems can be distributed between two or more separate (but interconnected) physical devices.","The processing system shown in  includes one or more processors , i.e. a central processing unit (CPU) and memory  connected to a bus system . Memory  may include read-only memory (ROM), random access memory (RAM), Flash memory, and\/or other types of memory, or a combination thereof. Also coupled to the bus system  are secondary storage  (e.g., one or more non-volatile mass storage devices), a data communication device , and in some embodiments, one or more additional input\/output (I\/O) devices .","The processor(s)  may be, or may include, one or more programmable general-purpose or special-purpose microprocessors or digital signal processors (DSPs), microcontrollers, application specific integrated circuits (ASICs), programmable logic devices (PLDs), or a combination of such devices. The bus system  includes one or more buses or other physical connections, which may be connected to each other through various bridges, controllers and\/or adapters such as are well-known in the art. For example, the bus system  may include a \u201csystem bus\u201d, which may be connected through one or more adapters to one or more expansion buses, such as a Peripheral Component Interconnect (PCI) bus, HyperTransport or industry standard architecture (ISA) bus, small computer system interface (SCSI) bus, universal serial bus (USB), or Institute of Electrical and Electronics Engineers (IEEE) standard 1394 bus (sometimes referred to as \u201cFirewire\u201d). In alternative embodiments, some or all of the aforementioned components may be connected to each other directly, rather than through a bus system.","The secondary storage  may be, or may include, any one or more devices suitable for storing large volumes of data in a non-volatile manner, such as a magnetic disk or tape, magneto-optical (MO) storage device, or any of various types of Digital Versatile Disk (DVD) or Compact Disk (CD) based storage, or a combination of such devices.","The communication device  is a device suitable for enabling the processing system to communicate data with a remote processing system over a communication link , and may be, for example, a conventional telephone modem, a wireless modem, an Integrated Services Digital Network (ISDN) adapter, a Digital Subscriber Line (DSL) modem, a cable modem, a radio transceiver, a satellite transceiver, an Ethernet adapter, or the like.","The I\/O device(s)  may include, for example, one or more of: a pointing device such as a mouse, trackball, touchpad, or the like; a keyboard; audio speakers; and\/or a display device such as a cathode ray tube (CRT), a liquid crystal display (LCD), or the like. However, such I\/O devices may be omitted in a system that operates exclusively as a server and provides no direct user interface. Other variations upon the illustrated set of components can be implemented in a manner consistent with the invention.","Software (including instructions and data)  to implement the techniques described above may be stored in memory , secondary storage , or both. In certain embodiments, the software  may be loaded into the processing system by downloading it from a remote processing system through the communication device .","Note that while the diagnostic process and other features are described above as being software-implemented, in alternative embodiments some or all of these features can be implemented in circuitry specially designed for such purposes, or in a combination of specially designed circuitry and software.","Thus, a method and apparatus for a network management station to diagnose a connectivity problem on a network have been described. Although the present invention has been described with reference to specific exemplary embodiments, it will be recognized that the invention is not limited to the embodiments described, but can be practiced with modification and alteration within the spirit and scope of the appended claims. Accordingly, the specification and drawings are to be regarded in an illustrative sense rather than a restrictive sense."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["One or more embodiments of the present invention are illustrated by way of example and not limitation in the figures of the accompanying drawings, in which like references indicate similar elements and in which:",{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIGS. 8 and 9"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIGS. 12A through 12C"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 13"}]},"DETDESC":[{},{}]}
