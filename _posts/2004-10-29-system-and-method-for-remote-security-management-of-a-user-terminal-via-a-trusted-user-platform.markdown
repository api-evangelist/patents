---
title: System and method for remote security management of a user terminal via a trusted user platform
abstract: A user system includes terminal equipment configured to receive and send data through a communication network; a terminal security support system removably insertable in, and configured to cooperate with, the terminal equipment; and a trusted user platform for the terminal equipment. The trusted user platform includes an information protection system configured to implement security functionalities, configuration instances for the information protection system, and a trusted communication agent configured to provide a safe communication between the terminal security support system and a remote management centre through the terminal equipment to allow the information protection system to be remotely configured from the remote management centre. The terminal security support system includes an integrated circuit card and/or a memory card which wholly supports the trusted user platform, and the terminal equipment is configured to send data to be subjected to security control to, and to receive security-controlled data from, the trusted user platform.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09049223&OS=09049223&RS=09049223
owner: TELECOM ITALIA S.P.A.
number: 09049223
owner_city: Milan
owner_country: IT
publication_date: 20041029
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATION","TECHNICAL FIELD OF THE INVENTION","BACKGROUND ART","OBJECT AND SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION"],"p":["This application is a national phase application based on PCT\/EP2004\/052726, filed Oct. 29, 2004, the content of which is incorporated herein by reference.","Page 5, lines 30-33, cancel the paragraph in its entirety and substitute two (2) paragraphs therefor as follows:","This aim is achieved by the present invention in that it relates to a user system including:\n\n","The aim of the present invention is also achieved by a method for supporting security in a user system wherein said terminal security support system (TSSS) includes a first card (ICC) and a second card (MC), and a trusted user platform (TUP) is partitioned between said first and second cards (ICC, MC), and wherein said first and second cards are an integrated circuit card (ICC) and a memory card (MC), and further including:\n\n","The present invention relates in general to mobile and fixed communications, and in particular to support, implementation and management of information security in a user terminal equipment. More specifically, the present invention relates to a user terminal equipment with a trusted user platform which allows the user to safely access added-value services through a data communications network.","As is known, services supported by the next generation user terminal equipments, such as personal digital assistants, smart phones or laptops connected to wireless local area networks (WLAN), allow users to access high value-added contents in the network and also to exchange sensitive information in commercial transactions and in many other applications now accessible to mobile users.","These enhanced functionalities require a careful consideration of security aspects for protecting both the terminal equipment and the communication channel. This protection has to be provided by means of the elements usually available in the terminal equipment, i.e. the terminal equipment itself, an integrated circuit card, such as the subscriber identity module (SIM) card, and a memory card, such as a multimedia card or a secure digital\u2122 card.","Several examples exist of integration of functionalities supported partly on the terminal equipment and partly on the integrated circuit card for implementing security applications, such as virtual private networks based on various technologies and protection of end-to-end communications by security session layer protocol. These methods allow secrecy by the encryption of exchanged data and the authentication of the counterparts, besides that of the data itself.","EP-A-1 094 682 discloses a mobile phone incorporating security firmware and a method for transmitting data packets in a communication system including a remote host (laptop, stand alone computer, or personal digital assistant), an independent access unit, and a receiving computer acting as a security gateway to an Intranet, wherein security firmware, in the form of IPsec (IP security protocol) or software, is located inside the independent access unit, and the independent access unit is used as a security gateway between the remote host and the Intranet in order to provide security in the communication to the remote host when the communication is performed over the Internet. The communication between the independent access unit and the remote host is performed by means of a wireless connection, and client private information required per client authentication are stored in a personal tamperproof storage in the form of a SIM card\/smart card, and used in combination with the independent access unit as a security gateway upon establishment of a IPsec tunnel. The solution of moving the security function to the mobile telephone or the independent access unit, preferably a wireless independent access unit, where a lightweight security gateway or firewall is implemented, enables a user to borrow any remote host in order to access the Intranet by means of a mobile communication network or a fix network, e.g. PSTN. In this way, an employee staying away from his ordinary office may, by means of a personal independent access unit functioning as a security gateway, communicate with the protected Intranet of his employer.","WO-A-03\/065181 discloses a method for controlling the use of digital contents by means of a security module or a chipcard comprising the security module, wherein any use of digital content is protected by an initial verification before any access of two types of access, the authorization of the user himself and the authorization associated with the digital content. The authorizations are stored on a security module provided for authorized users and controlled by the user security module. At least a private section of a digital content is stored in the security module and transmitted to the terminal after authorization. The solution disclosed in this document finds application in the field of electronic commerce essentially concerning the management of digital authorization for use of digital contents.","However, the support of virtual private networks does not protect from attacks directed against the terminal equipment that can exploit code downloads during web surfing and results in uncontrolled storage or even execution of malicious code. The use of an embedded firewall proves to be a strong prevention from dangerous user's behavior and external attacks. The firewall must be statefull and be able to track terminal equipment's activities during time.","In order to assure the effectiveness of a firewall protection, security policies should be configured and updated to protect data from unauthorized access and to minimize user's vulnerability to attacks from shared networks.","Key firewall features are:\n\n","Moreover, the security level provided by a firewall can be further improved by adding:\n\n","Implementing the above-described functionalities requires the availability of enough memory and computational power in the user terminal equipment. For instance, in a common approach, when encryption is needed the central processing unit of the terminal equipment fetches user's certificates and secret keys stored on the integrated circuit card, and performs the intensive computation based upon them. For instance, in a mobile terminal equipment, memory and cycles of the central processing unit are precious resources and adding to the system the security functionalities just described can spoil the performance for the network services accessed by the user. In order to make it interesting for mobile applications, a strong requirement for a security technology is therefore to overcome these drawbacks, that is to be light enough not to impact the performances of the system for other functions. In fact, having a security engine (including firewall, antivirus, and intrusion detection system functionalities) inside a user terminal equipment brings requirements in terms of how to manage it in a secure, automatic and easy way: finding a suitable mechanism to do this from remotely becomes an essential point not to make the security tools an issue to the user. So these tools should require very little effort and expertise of the user, and, on the other hand, it should be possible for a service provider or a corporate service manager to manage the security remotely in a guaranteed and controlled manner, offering turn-key solutions. Moreover, the configuration data can include sensitive information, such as personal keys for encryption, passwords, etc., and storing them in a safe location becomes a stronger requirement as the spectrum and range of the applications accessible become wider, in order to protect both the user and the provider or corporate network. Protection\/prevention against the theft of the user terminal is therefore a relevant issue.","The aim of the present invention is to provide a trusted user platform for a user terminal equipment which overcomes the aforementioned drawbacks.","This aim is achieved by the present invention in that it relates to a user system, as defined in claim , and to a method for supporting security in a user system, as defined in claim .","The present invention meets the aforementioned needs as it makes use of a distributed architecture for the security system, which distributed architecture is based upon the use of an integrated circuit card, such as the SIM card of a mobile phone, and\/or a memory card, which can be for instance a multimedia card, a secure digital\u2122 input\/output card or any other kind of memory cards used, where all the operation phases needed for security functions are performed and relative data and configuration parameters stored.","In this distributed architecture the terminal equipment is not required to perform tasks other than providing a connection towards the network and between the other elements by which the security architecture is composed. In this approach the terminal equipment's resources are still in large part available for high valued applications accessed by the user, while security relies on the additional elements of the user system, namely the integrated circuit card and the memory card.","In this way, the terminal equipment is offloaded and the security support becomes independent of the specific terminal equipment.","This terminal-independent, distributed architecture is suitable for a service provider environment in which a service provider\/enterprise would like to provide an integrated solution of security services to its customers\/employees, since the SIM card (or the integrated circuit card) is usually controlled by the operator. Storing these sensitive data on a removable support that the user can easily and safely take with himself\/herself represents an optimal solution to the problem of possible theft of the terminal with consequent loss of sensitive information. In this way, in fact, a trusted environment is created at the user platform layer, allowing to store locally and securely the sensitive configuration parameters (including passwords, keys, etc.) obtained from the service provider.","The following discussion is presented to enable a person skilled in the art to make and use the invention. Various modifications to the embodiments will be readily apparent to those skilled in the art, and the generic principles herein may be applied to other embodiments and applications without departing from the spirit and scope of the present invention. Thus, the present invention is not intended to be limited to the embodiments shown, but is to be accorded the widest scope consistent with the principles and features disclosed herein and defined in the attached claims.",{"@attributes":{"id":"p-0029","num":"0045"},"figref":"FIG. 1","ul":{"@attributes":{"id":"ul0010","list-style":"none"},"li":{"@attributes":{"id":"ul0010-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0011","list-style":"none"},"li":["a terminal equipment (TE), such as a smart phone, a personal digital assistant, an access gateway, a digital camera, etc., configured to receive and send data through a communication network (CN), and provided with an integrated circuit card reader (ICCR) and a memory card reader (MCR);","a terminal security support system (TSSS) separate from, and configured to cooperate with the terminal equipment and physically made up of:\n        \n        ","a trusted user platform (TUP) wholly resident on the terminal security support system and including:\n        \n        "]}}}},"The information protection system has specific security functionalities and performs the proper data processing (both for data flow and stored data) according to the configuration instances that are locally stored and tightly coupled with the security functionalities.","In particular, the information protection system may include both software and hardware modules which implement engines for the following functionalities:\n\n","This approach allows the service provider to offer a turn-key, robust security support to the customers thanks to the possibility, besides that of providing a safe repository on the cards for the personal certificates and security policies, of configuring the firewall remotely from the remote management centre and providing periodic updates according to the subscribed service level agreement (SLA).","The trusted communication agent is an application which performs the following operations:\n\n","A data-exchange mechanism between the trusted communication agent and the remote management centre must be available for downloading the configuration instances and the updates of locally stored security policies and databases, and uploading the logs for off-line processing and statistics collection. This relies on the operation of the trusted communication agent and will be described in the following.","The invention does not address a single technology for the interworking with the terminal security support system and relies on the possibility of establishing a direct logical communication between it and the provider's remote management centre. Therefore, the invention can be supported by any available technology for the communication between the involved parts, i.e. the remote management centre and the terminal security support system, and it is therefore bearer-independent because the bearer is provided by the terminal equipment. The communication mechanism grants the link security performing the mutual authentication with the other entity (remote management centre and terminal equipment), optionally encrypting the data exchanged and performing the data integrity check.","The communication mechanism between the terminal security support system and the remote management centre can be wireless, e.g. short message service (SMS), or wireline, e.g. Internet protocol (IP), and grants the link security performing the mutual authentication with the other entity, optionally encrypting the data exchanged and performing the data integrity check. The configuration instances are provided and updated through the connection to the remote management centre that prepares, coordinates and sends them to the trusted communication agent, which transfers them to the information protection system in the appropriate format. The latter generates logs, alarms, warnings and event notifications that are sent back to the remote management centre through the trusted communication agent, in order to allow remote monitoring and to allow complex attack identification.","In particular, the configuration instances include the following configuration parameters, security policies and databases for the information protection system:\n\n","The configuration instances are downloaded from the remote management centre through the trusted communication agent and stored in the following files:\n\n","The user can manage only the file UFR, whereas all the other files are under the control of the service provider.","There is not need to implement any user configurable rules for the antivirus and intrusion detection system agents, as these engines rely on information commonly not accessible to the user.","The trusted communication agent uses other elementary files to store the event notification, warning and alarms generated by the information protection system. When one of these events occurs, the terminal equipment writes it in the appropriate file. The trusted communication agent processes the event and sends a message containing the event record to the remote management centre, which processes the message and decides the appropriate action to be taken (e.g. simply log the event or notify an attack and take countermeasures to block it).","In the previously described architecture, all the security functionalities are performed on the terminal security support system, which also stores relative data and configuration parameters and eventually returns the checked data to the terminal equipment for user application processing and\/or transmission by the network interface. Therefore, the terminal equipment simply acts as a link towards the remote management centre and the terminal security support system and between the information protection system and configuration instances. The information protection system performs all the security functionalities and retrieves the required configuration instances, the last updates, and policies\/databases\/tables for firewall, antivirus and intrusion detection system using the trusted communication agent trusted communication agent.","The network drivers running on the terminal equipment must be such as to allow capturing the information flow and addressing it to the trusted user platform on the terminal security support system. After accomplishing its security tasks, the trusted user platform returns the checked data back to the drivers in the terminal equipment in a similar way. In a similar way, all packets in a data stream originated in the UT are sent to the trusted user platform for firewall rule application and, only after the terminal equipment gets them back from the trusted user platform, the checked packets are sent to the network.","As this is attainable with the state of the art card and processor technology, the requirement will not be pointed out anymore in the following.","The terminal security support system is preferably based upon the use of user-removable cards, although the concepts here expressed can be applied also to a context in which one or both the cards are hard-wired and physically inaccessible to the user.","The three entities which form the trusted user platform, i.e., information protection system, configuration instances and trusted communication agent, and which are resident on the terminal security support system, may be partitioned between the two cards forming the terminal security support system, i.e., the integrated circuit card and the memory card, or located on either of them according to optimization requirements.",{"@attributes":{"id":"p-0047","num":"0090"},"figref":["FIGS. 2 to 5","FIGS. 2 to 5","FIG. 2","FIG. 5"]},"In particular, in the embodiment shown in , the terminal security support system includes only the integrated circuit card, and the trusted user platform is wholly supported by the integrated circuit card. In this embodiment, the memory card, possibly in use in the terminal equipment, is not involved in security functionalities and hence it is not part of the terminal security support system.","In the embodiment shown in , the terminal security support system includes both the integrated circuit card and the memory card, and the information protection system is on the memory card, which has a central processing unit and possibly an hardware engine, while the configuration instances and the trusted communication agent are on the integrated circuit card. The use of the configuration instances by the information protection system is made possible through the terminal equipment, which simply acts as a physical support for the communication, by the mechanism described hereinafter.","In the embodiment shown in , the configuration instances and the information protection system are on the memory card, while the trusted communication agent is on the integrated circuit card and allows controlling and configuring the configuration instances and the information protection system through the terminal equipment.","In the embodiment shown in , finally, the information protection system, the configuration instances and the trusted communication agent are on the memory card, which completely covers the functionalities related to security. The integrated circuit card is shown in  because, both in a removable fashion or hard-wired, it is in principle needed for the access to network services. In this embodiment, the integrated circuit card is not involved in security functionalities and hence it is not part of the terminal security support system.","Further comments on the possible partitioning of the trusted user platform will be given in the following sections through some examples.","Described hereinafter are three examples of how the embodiments shown in ,  and  may be reduced to practice.","In particular, the embodiment shown in  may conveniently be used as a firewall support scheme, wherein the terminal equipment is a mobile phone, the terminal security support system is made up of a SIM card only (ICC), the trusted user platform (information protection system, configuration instances and trusted communication agent) is fully supported by the SIM card, the information protection system is made up of a firewall only, and the remote management centre is a provider's SIM toolkit (STK) server.","In this example, the users are provided with a turn-key firewall configuration of which the provider takes care and grants periodical updates thanks to an over the air (OTA) interface, which supports the communication between the provider's central office and the SIM card. The mobile phone simply gives the physical connection (radio carrier) with the network from the point of view of security. The mobile phone can support a pool of high-level content services, but it is not involved in the firewall support. Firewall operations are supported totally on the SIM card. The firewall can in principle be hardware and\/or software.","At power-up, the information protection system running on the central processing unit of the SIM card retrieves the configuration data and the rules from the configuration instances in the SIM card, and, after that, it configures the firewall, thus making it ready for operation. When a new update of the configuration instances is available from the remote management centre, the trusted communication agent receives it from the over the air interface, converts the data in the firewall rule table format (because the data on the SIM card are coded in tag length value (TLV) format), updates the configuration instances, as described hereinafter, and warns the firewall, which reads the new configuration instances. The SIM card contains two files managed by the operator, namely the OFC and the OFR, in order to allow the operator to define the firewall configuration and rules, and a file managed by the user, namely the file UFR, in order to allow the user to define his own rules. The operator access condition both for the files OFC and the OFR must be \u201cadministrator\u201d (ADM).","The following is an indicative list of firewall configuration parameters:\n\n","This is only one of the possible sets of configuration parameters. Different sets are in principle equivalent and may differ in the type of service and the level of control the operator wants to have on the security of the mobile phone.","A general firewall rule can be defined by means of the following fields:\n\n","The last two fields can be optional, whereas the others are usually required. This list has to be considered as an instance among the various possible implementations and the addition of one or more fields for new possible filtering functionalities is possible, as well as the use of a sub-set of the listed fields. This also gives the flexibility to adapt it to new applications and protocols requirements.","When the SIM card does not have all the required memory resources, for instance because the size of the configuration database is too large, it can be convenient to adopt the embodiment shown in , wherein the terminal security support system is made up of both a SIM card (ICC) and a memory card, and the trusted user platform is partitioned between the SIM card and the memory card, in particular the information protection system (firewall, antivirus and intrusion detection system) and the configuration instances are on the memory card and the trusted communication agent is on the SIM card.","The memory card supports part of the security functionalities and the presence of the trusted communication agent on the SIM card optimizes the control of the security applications done by the same service provider that also gives access to the network. The configuration data are downloaded in the memory card via the over the air interface thanks to the previously described procedure and communication protocols, that allow opening a secure logical channel between the memory card and the SIM card. At power-up, the information protection system running on the central processing unit of the SIM card retrieves the configuration data for all the functionalities supported by the information protection system and the firewall rules from the configuration instances in the memory card. When a new update of the configuration instances is available from the remote management centre, the trusted communication agent receives it from the Over The Air interface, converts the data in the rule table format of each engine in the information protection system, updates the configuration instances, as described hereinafter, and warns the engines, which read the new configuration instances.","The configuration instances for the firewall have the same structure and characteristics as those previously described with reference to the previous example, and also the management procedures are exactly the same, with the only variation that in this embodiment the trusted communication agent interacts with the configuration instances and the engines in the information protection system through the interfaces that connect the memory card and the SIM card to the terminal equipment, which provides the physical interconnection.","The service supporting antivirus, content filtering or intrusion detection system is in many aspects the same, and is in any case similar to the one previously described with reference to the firewall. In this embodiment, there is not a rule-based filtering, but a filtering based on known strings, which can be virus footprints, specific uniform resource locators (URLs), generic data patterns or malicious strings to be identified in the packet payload. In all these applications, the strings to be searched for are stored in specific databases. As the complete size of the databases can be quite large, they can be stored more easily on the memory card, but the updates to these files are at first downloaded into the SIM card using an over the air bearer (if the file dimension is limited it is also possible to download the complete file). As an example, a detailed description may be given of what happens for the antivirus functionality. Thanks to the mechanism described hereinafter, the trusted communication agent running on the central processing unit of the SIM card stores the antivirus update file in the memory card, updating the Virus List. In this way, when the trusted communication agent receives, for instance, an SMS with the antivirus Update, it changes the corresponding file.","Analogous considerations may be made for the intrusion detection system, URL filtering or a generic content filtering application, in which the database of the virus footprints is substituted with a file of appropriate patterns. For optimizations purposes, antivirus and content filtering update files can be written into the same memory area on the SIM card, using a proper mechanism to avoid conflicts.","To support this with present wireless technology, applets are required. The SIM toolkit applet on the SIM card must be able to download periodically the data-pattern updates OTA and correspondingly reconfigure the configuration instances and the engines. The applet must also resize the file AVU, which contains the antivirus configuration modifiable by the operator only, in order to adapt it to the new dimension and delete the old file before downloading the new one. A mechanism must be provided to ensure that this happens only after full completion of the previous update. In case the user wants to download a complete database, then the opportunity of doing it over the air rather than by other means (e.g. PC intermediation) depends on the available bandwidth for the used wireless transport. The operator access condition for the file AVU must be \u201cadministrator\u201d (ADM).","The following is a possible list of antivirus configuration parameters:\n\n","The embodiment shown in , wherein the terminal security support system is made up of a memory card only which fully supports the trusted user platform (information protection system, configuration instances and trusted communication agent) is of a particular interest for example for a company willing to provide to its corporate users a communication protection system controlled and managed centrally by the company itself, while still relying on a service provider\/operator for the general access and network services.","This scheme requires that the memory card be equipped with all the needed processing resources, i.e., memory and Central Processing Unit, and the secure digital\u2122 input\/output cards presently available on the market meet these requirements. The scheme also includes an integrated circuit card which performs functions other than security, such as enabling access of the terminal to the network.","In this embodiment, when the configuration data are received from the remote management centre, they are delivered to the trusted communication agent on the memory card through a logical channel opened between the remote management centre and the memory card. From then on, the whole process is handled in the same way as that previously described, with the only difference that all the interacting entities run on the central processing unit of the memory card and exploit its memory resources. In this embodiment, the communication flow has to be by default directed to the memory card before being delivered to any other elements in the system for execution or storage, in order to have it analyzed by the firewall. This can be done by means of appropriate network drivers as already mentioned before.","As previously mentioned, implementation of the configuration instances requires that the terminal equipment provides direct access to the data stream by either the memory card or the integrated circuit card, or both. A communication mechanism must therefore be provided in order to make the integrated circuit card and the memory card communicate with each other when both are involved.","To do so, as shown in  the user system further includes a card link application, hereinafter referred to as MC_Link, which is a software module stored in and running on the integrated circuit card (ICC) and having the aim to set up and manage a secure logical connection between the integrated circuit card and the memory card (MC), and an application programming interface, hereinafter referred to as MC_Link_API, which is a software stored in and running on the terminal equipment (TE) and having the aim to interpret the MC_Link requests and to adapt and\/or forward the data which comes from the integrated circuit card to the memory card interface and vice versa. In particular, in the former case (adaptation and forwarding), the MC_Link sends to the MC_Link_API the instruction for the memory card, and the MC_Link_API codes the instruction in the memory card protocol, whereas in the latter case (only forwarding) the MC_Link sends to the MC_Link_API the command for the memory card, and the MC_Link API forwards the command without change its coding.","The MC_Link provides the other software applications running on the integrated circuit card with a protocol to interact with the memory card. In particular, the MC_Link provides the other applications with the following functions:\n\n","The algorithm used to cipher and decipher data depends on the implementation of the MC_Link, and for example my be a DES or 3DES algorithm or a proprietary algorithm.","In addition, the MC_Link exchange data and commands with the MC_Link_API in order to reach the memory card on the terminal equipment. In particular, the MC_Link performs the following functions:\n\n","In response to the command, the MC_Link_API checks the status of the memory card reader(s) and sends the information to the integrated circuit card.\n\n","In response to the command, the MC_Link_API checks the memory card capabilities in terms of memory size, file system, security and sends the information to the integrated circuit card;\n\n","Upon receiving a command, the MC_Link_API interprets and executes it, receives the memory card response relating to the execution of the command and sends it to the integrated circuit card. The MC_Link_API also manages errors reported by memory card and sends them to the integrated circuit card.",{"@attributes":{"id":"p-0079","num":"0179"},"figref":"FIG. 7"},"In particular:\n\n","The cases related to the other memory card commands are similar to that previously described, the only difference lying in the memory card command sent by the MC_Link to the MC_Link_API within the \u201cPerform MC Command\u201d.","What has been previously described with reference to  also applies to scenarios where the memory card is the master and the integrated circuit card is the slave, i.e., where the MC_Link runs on the memory card. To do so, the memory card has necessarily to be of the type with a microprocessor. Practical examples of these scenarios may be an application running on the memory card which wants to update some data and needs to be connected with a remote server. In this scenario, the memory card asks the SIM card to set up a connection over the air with the remote server in order to retrieve the data, and after the memory card reads the data on the SIM card.","Finally, it is clear that numerous modifications and variants can be made to the present invention, all falling within the scope of the invention, as defined in the appended claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["For a better understanding of the present invention, a preferred embodiment, which is intended purely as an example and is not to be construed as limiting, will now be described with reference to the attached drawings, wherein:",{"@attributes":{"id":"p-0024","num":"0040"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0041"},"figref":"FIGS. 2 to 5"},{"@attributes":{"id":"p-0026","num":"0042"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0027","num":"0043"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
