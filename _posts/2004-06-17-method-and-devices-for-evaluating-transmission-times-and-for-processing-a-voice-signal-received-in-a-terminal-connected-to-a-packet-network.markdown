---
title: Method and devices for evaluating transmission times and for processing a voice signal received in a terminal connected to a packet network
abstract: A method for evaluating the processing delay of a speech signal contained in data packets received in a receiver terminal having a telephony module during a voice call to a terminal sending the data packets over a packet-switched network. The method includes the step of obtaining from the received data packets a stream of audio packets containing the speech signal. Within a predetermined decoding time, the stream of obtained audio packets is decoded and a first reconstituted speech signal is created. At least a portion of the speech reconstituted by the telephony module is duplicated to create a second reconstituted speech signal. The time difference between the first and the second reconstituted speech signals is determined. The processing delay of the speech signal in the receiver terminal is calculated from at least the determined time difference between the reconstituted first and second speech signals and the predetermined decoding time.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07742916&OS=07742916&RS=07742916
owner: France Telecom
number: 07742916
owner_city: Paris
owner_country: FR
publication_date: 20040617
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE DRAWINGS"],"p":["This is a U.S. National Phase Application under 35 USC 371 of International Application PCT\/FR2004\/001636, filed on 17 Jun. 2004.","The present invention relates generally to packet-switched networks, such as the Internet, and more particularly to telephony over IP networks.","To be more precise, the invention relates to a method of evaluating the processing delay of a speech signal contained in data packets received in a receiver terminal equipped with a telephony module during a voice call via a packet-switched network with a sender terminal sending the data packets. The invention further relates to a method of evaluating the end-to-end transmission delay of a speech signal received in a receiver terminal, that end-to-end transmission delay including the speech signal processing delay referred to above. The invention also relates to devices for implementing the methods referred to above.","The increased possibilities of contacting and communicating with anybody, anywhere, at any time and for an insignificant cost, and the possibility of making local calls via the worldwide interconnection network provided by the Internet have developed a taste for telephony over packet-switched networks and more particularly for telephony over Internet Protocol (IP) networks.","Unlike conventional fixed network telephony over the public switched telephone network, the quality of telephony over a packet-switched network, in particular over an IP network, is usually mediocre, there being no guaranteed minimum quality level.","This lack of a guaranteed voice quality in telephony over an IP network is inherent to the design of the network, which gives priority to interconnecting the parties, to the detriment of the bandwidth finally allocated to the speech signal, the only criterion in terms of allocated bandwidth that is permitted being a best effort criterion. In particular, the bit rate of the information transmitted in the form of digital packets representing speech signals decreases as more and more users of the IP network log onto the network to use it for IP telephony or other purposes.","The deployment of satisfactory IP telephony services therefore necessitates control of the quality of the services offered and in particular necessitates the use of tools to measure that quality.","The main defects of IP telephony transmission, also known as Voice over IP (VoIP) transmission, are as follows:\n\n","The end-to-end transmission delay of the speech signal represents the cumulative result of all the delays generated in the speech signal transmission and processing chain. As such, it constitutes the delay actually perceived by the user, and is sometimes called the mouth to ear delay.","The end-to-end transmission delay is therefore made up of the transmission delay over the packet mode (IP, ATM\u2014Asynchronous Transfer Mode) network and the processing and transmission delays in the IP terminating equipments (IP telephone, gateway, local area network).","The transmission delay over the packet mode network takes into account the processing delay in the equipment and in particular in the routers. That processing delay depends in particular on the number of units the signals pass through, the functions implemented in those units (proxy, transcoding, firewall, etc.), and the available bandwidth.","The processing delay in the terminating equipment and networks takes into account the delays introduced by the audio codec (coder\/decoder), the jitter buffer, packetization, voice activity detection, etc., and where applicable transmission over a transmission network or circuit mode access network. The processing delay in the terminating equipment and networks can be broken down into a send portion and a receive portion.","It can therefore be very useful to measure the end-to-end transmission delay in the context of evaluating the quality of voice calls over the packet-switched network, because the measured transmission delay can be correlated with the quality level perceived by the user. Consequently, if limiting values, in terms of perceived quality, for the end-to-end transmission delay are known, action may be taken at the level of network engineering or terminating equipment configuration with a view to keeping the end-to-end transmission delay within acceptable limits.","The end-to-end transmission delay of a speech signal is typically measured intrusively, i.e. by setting up test calls between two probes simulating or substituted for the terminals.","The transmission delay as such is measured by comparing the signal sent by a sender probe and the signal received by a receiver probe. It is essential that the two signals are recorded using the same clock and that the two probes are synchronized.","The test signals used for these measurements can be speech signals, composite signals or single frequencies.","Probes available off the shelf that use this kind of intrusive measurement include those using the perceptual evaluation of speech quality (PESQ) psycho-acoustic model standardized by Recommendation P.862 of the ITU-T (International Telecommunications Union), for example.","Evaluating the end-to-end transmission delay by means of intrusive probes has two drawbacks. Firstly, the measurements obtained do not relate to real calls between users. Secondly, they do not take account of processing of the speech signal in the real terminals of users. Consequently, this type of evaluation can be used to characterize the quality of a telephone service in a general way but not to characterize the voice quality of real calls between two users.","Accordingly, given the increasing expansion of IP telephony, there is a real need for tools for evaluating the voice quality actually perceived by the user of a Voice over IP telephone terminal during real telephone calls. There is also a correlated need for tools for non-intrusively evaluating the real processing delay for a speech signal received in a terminal, and thereafter the end-to-end transmission delay for a speech signal during real calls between two IP terminating equipments, such as IP telephones (known as IPphones) or PCs equipped with IP telephony software (known as softphones).","An object of the present invention is to meet this need. To this end, a first aspect of the invention is directed to a method of evaluating the processing delay of a speech signal contained in data packets received in a receiver terminal equipped with a telephony module during a voice call to a terminal sending said data packets over a packet-switched network. This method includes the following steps:\n\n","This method provides a tool for evaluating the processing delay of a speech signal in a receiver terminal connected to a packet-switched network non-intrusively, i.e. during real calls. This tool can therefore contribute to evaluating the voice quality actually perceived by a telephone terminal user.","According to one particular feature of the invention, the measured delay difference between said first and second speech signals is measured by intercorrelation of the envelope signals of said first and second speech signals.","A second aspect of the invention is directed to a method of evaluating the end-to-end transmission delay of a speech signal received in a receiver terminal during a voice call to a terminal sending said speech signal over a packet-switched network. This method is remarkable in that it includes a step of evaluating the processing delay of the speech signal in the receiver terminal by an evaluation method as succinctly defined above.","According to a particular feature of the invention, the method of evaluating the transmission delay of a speech signal further includes the following steps:\n\n","The above method of evaluating the end-to-end transmission delay is an effective tool for evaluating the voice quality perceived by the user of a telephone terminal during real calls, in particular because it is non-intrusive.","The invention further relates to a device adapted to be installed in a terminal for voice communication over a packet-switched network and including means for implementing the method or methods of the invention succinctly defined above.","In a preferred embodiment of the invention, the above device takes the form of program modules executed in an electronic data processing system constituting or incorporated in terminating equipment for voice communication over a packet-switched network. Consequently, the present invention is also directed to a computer program stored on an information medium, the program being adapted to execute the above method or methods when it is loaded into and executed in an electronic data processing system.","The advantages of the above device and the above computer program are identical to those of the methods of the invention briefly explained above.",{"@attributes":{"id":"p-0034","num":"0046"},"figref":"FIG. 1","b":"2"},"To the network  are connected IP terminal equipments , , , certain of which are able to set up Voice over IP (VoIP) calls and are usually referred to as IP terminals, for example IP telephones  or multimedia personal computers (PC)  equipped with appropriate telephone software, while other equipments, for example a server , provide particular services on the network.","To simplify the explanation of the invention,  shows only one network , although the network  may encompass a certain number of subnetworks associated with gateway and\/or router type equipments for interconnecting those subnetworks and thereby enabling end-to-end IP communication between the IP terminals.","The above subnetworks typically include a public switched telephone network (PSTN) and local area networks (LAN), e.g. Ethernet networks.","In a preferred embodiment, the IP terminals ,  communicate with each other using the set of communication protocols defined in Recommendation H.323 of the International Telecommunications Union (ITU-T). For more information on this set of protocols, see the website www.itu.org.","In a different embodiment, the IP terminals ,  communicate with each other using the Session Initiation Protocol (SIP) architecture of the Internet Engineering Task Force (IETF). For more information on this architecture, see the website www.ietf.org.","Of course, the invention is in no way limited to the above two protocol families and to the contrary applies to any protocol architecture supporting Voice over IP.","As explained in more detail later, the server  is a collection server for recovering quality information relating to voice calls set up in the IP terminals , . In particular, this information includes end-to-end transmission delay values obtained in accordance with the invention.","To this end, each IP terminal ,  is equipped with a device of the invention for evaluating the end-to-end transmission delay of a speech signal reconstituted in the terminal from IP data packets received during a call.",{"@attributes":{"id":"p-0043","num":"0055"},"figref":"FIG. 2"},"The above means, constituting a device of the invention, are incorporated into an IP telephony terminal. In this embodiment, the IP terminal in question is a multimedia personal computer (PC)  on which a telephony application has been installed.","The terminal  equipped in accordance with the invention includes a set of essentially software modules -. A certain number of these modules are conventionally included in the terminal, namely:\n\n","The other modules are specific to the present invention and comprise:\n\n","The network interface  conventionally includes a network card and components needed for the terminal  concerned to be able to log onto the network  and receive electrical signals conveying coded information. Those components include in particular a modem (modulator\/demodulator).","The network interface delivers as output a stream of IP packets containing in particular digitized voice frames.","The IP packets are then taken over by the protocol manager  and subjected to protocol disencapsulation processing appropriate to the set of communication protocols (protocol stack) used on top of the Internet Protocol.","Protocol disencapsulation typically yields:\n\n","In a preferred embodiment using the H.323 protocol set, the call signaling messages conform to the H.225.0 call signaling protocol, the call negotiation messages conform to the H.245 negotiation protocol, the audio packet stream containing digitized audio signal frames conforms to the real time protocol (RTP), and the stream of call control data packets conforms to the real time control protocol (RTCP). The RTP and RTCP are both used on top of the User Datagram Protocol (UDP).","In another preferred embodiment using the Session Initiation Protocol (SIP) architecture protocol set, the call request signaling messages and the call request negotiation messages are contained in messages conforming to the SIP, the audio packet stream containing digitized audio signal frames conforms to the RTP, and the stream of call control data packets conforms to the RTCP.","In one particular embodiment, the operating system of the PC  is Windows\u2122 from Microsoft and the protocol manager  consists of the Winsock function library. The set of standardized functions provided by the Winsock library enables TCP\/UDP-IP applications to run in Windows\u2122, independently of the hardware used.","On leaving the protocol stack , the various streams of messages and data packets, i.e. the call request signaling messages, the call request negotiation messages, the stream of audio data packets, and the stream of call control data packets, are delivered to the network filter module  (described below).","The API (A in ) is provided by the operating system of the terminal  and enables electronic data processing applications designed to access the network to access it via the protocol manager  using a library of standardized primitives or functions. These primitives thus enable the applications to access the communication protocols installed in the terminal and to receive and send data.","As mentioned above, in the case of an implementation conforming to the H.323 protocols, the following data streams are obtained at the output of the protocol manager :\n\n","The above streams of information are typically delivered to the input of the telephony application . In the embodiment described here, the telephony application used is NetMeeting\u2122 from Microsoft.","In accordance with the present invention, the device of the invention includes a network filtering module  between the protocol manager module  and the telephony module .","The module  is transparent with respect to data streams leaving the protocol manager (i.e. it does not modify them). It includes software means, i.e. particular programmed functions, for detecting the setting up of a voice call and identifying the call.","In , a voice call has been set up between the IP telephone  and the PC . In practice, the network filter  detects the setting up of a voice call on receiving a call request signaling message characteristic of setting up a connection conforming to the call request signaling protocol used.","According to the invention, the network filter  comprises means for obtaining the stream of audio packets conforming to the RTP containing the speech signal sent by the sending terminal from UDP packets supplied by the protocol stack . In practice, the network filter extracts the stream of RTP packets from the stream of UDP packets, duplicates it, and then supplies it to the input of the control decoding module .","In one embodiment, the network filter  takes the form of a data link library (DLL) which is loaded automatically when an application invokes the Winsock API.","This library communicates with the Winsock protocol manager through particular interfaces provided by Winsock: the API and another interface known as the service provider interface (SPI), which is used to implement each of the various functions constituting the network filter in the form of a layered service provider (LSP).","An instantiation of the network filter is created when the telephony module  requests the creation of a network communication channel (socket). To be more precise, a network filter is instantiated when the telephony application invokes the WSPSocket and WSPAccept functions of the Winsock API.","The network filter of the invention is designed to be compatible with a plurality of communication protocols. To this end, it is designed as a generic filter adapted to be instantiated as specific (protocol) filters. These specific filters are adapted to process data transmitted in accordance with different protocols of the same level or protocols of a particular family of protocols (SIP, H.323).","The control decoder  is an audio decoder, for example of the G.711 type, identical to that used in the telephony module . In this way, the control decoder processing time Tdec is the same as that of the telephony module. However, a decoder different from that of the telephony module can be used instead, provided that the processing delay difference between the two decoders is constant and known.","The function of the control decoder  is to decode the stream of RTP audio packets supplied by the network filter  within a decoding time that is predetermined because it is known in advance. A reconstituted speech signal, typically in the form of samples in the pulse code modulation (PCM) format, is therefore obtained at the output of the control decoder module.","The reconstituted speech signal is then saved in the memory  in the form of a data file F. That memory can be a portion of the memory space of a hard disc, for example, or a particular region of a random-access memory (RAM).","Referring again to , the streams of data leaving the protocol manager  (Winsock) are supplied to the telephony (NetMeeting) module  via the network filter , which does not modify this data.","The telephony module  conventionally includes, in addition to the audio decoder , a jitter buffer and a signal processing unit (comfort noise generation, echo cancellation, level adjustment, etc.).","In operation, the telephony module  extracts RTP packets from the stream of UDP packets it receives and then extracts from them the digitized and encoded audio signal frames. The audio signal is then reconstituted using the audio decoder , after which it is processed by the signal processing unit (jitter, echo, etc.).","The telephony module delivers at its output a reconstituted audio signal, typically in the form of samples in the pulse code modulation (PCM) format.","The PCM coded voice samples are then delivered to the audio mixer  which applies predefined adjustments to the speech signal with a view to its acoustic reproduction, and the speech signal leaving the audio mixer is therefore the final audio signal that is converted into sound and therefore heard by the user of the terminal .","It will be noted here that the delay introduced by the audio mixer is negligible compared to the overall processing delay of the speech signal in the receiver terminal .","The audio signal reconstituted by the telephony module  is supplied to the input of the audio filter module  of the invention via the audio mixer. This filter module samples the audio signal reconstituted by the telephony module and stores it in the memory  in a second data file F.","The audio filter  is activated synchronously with the network filter , so that storage of the file F on leaving the control decoder  and of the file F on leaving the audio filter  are effected either simultaneously or at different times determined by the same clock, the exact difference between these times being known.","Like the network filter, the audio filter  does not modify the audio signal that it receives and, in conjunction with the network filter, it samples, i.e. copies, at least a portion of the reconstituted speech signal (stream of PCM samples), just before delivering it to the sound card  via the sound card driver . The reconstituted speech signal is finally converted by a digital-to-analog converter on the sound card into an electrical signal that is converted into acoustic waves by the loudspeaker .","In practice, the Windows Driver Model (WDM) architecture is used to implement the audio filter . This architecture enables interfacing with device drivers belonging to the same class, representing the same type of device. Data addressed to a particular device of that class can then be filtered. Using this architecture, the audio filter is implemented by installing a MEDIA class device driver which is automatically loaded when the Windows\u2122 operating system is started up.","Referring again to , according to the invention, the receiver terminal  comprises a module  for evaluating the processing delay of the received speech signal. This module receives at its input, from the memory , the speech signal F decoded by the control decoder module  and the speech signal F decoded by the telephony module . In the context of the present explanation of the invention, the processing delay of the speech signal received in the terminal  is denoted D.","According to the invention, the module  for evaluating the delay D comprises a certain number of submodules. It includes a voice activity detection submodule, not shown in , for measuring the level of voice activity in each of the stored voice signals F and F. Voice activity detection algorithms are well known in the art. As will be explained below with reference to , the remainder of the process for evaluating the processing delay D is carried out if the voice activity detected in the first and second speech signals F and F is above a predetermined threshold.","The module  for evaluating the delay D further includes a submodule (not shown) for determining the delay difference between the two speech signals F and F. In accordance with the invention, the delay difference between the signals F and F that is determined takes account of the processing delay difference for the stream of RTP packets leaving the network filter  and processed by the telephony module  and the control decoder module .","Because the processing delays of the control decoder  and the decoder are identical or very close, the measured delay difference represents the cumulative delay introduced by the buffer and the signal processing unit , which is inherently variable and therefore difficult to measure directly.","Finally, the module  includes a submodule (not shown) for calculating the overall processing delay D of the speech signal in the form of RTP streams received in the communication terminal . As is explained below with reference to , the delay D is evaluated taking into account the measured value of the delay difference between the signals F and F.","The communication terminal  of the invention further comprises a module  for evaluating the transmission delay D in the network  of the speech signal received in the terminal . The method of the invention for evaluating the delay D is described in more detail with reference to .","The terminal  further comprises a module  for evaluating the processing delay D introduced when the sender terminal sent the speech signal that has been received in the terminal . In practice, the delay D corresponds to the speech signal coding delay in the sending terminal. The method of the invention of evaluating the delay D is also described in more detail below with reference to .","The above delays D, D, D evaluated by the invention are supplied to the module  for evaluating the end-to-end transmission delay of the speech signal received in the terminal . According to the invention, the module  computes the end-to-end delay Dbb from the send processing delay D, the transmission delay D, and the receive processing delay D. The computation of the delay Dbb is described in more detail below with reference to .","Finally, the terminal  of the invention comprises a module  for generating and sending delay information. The module  recovers each of the end-to-end delay values obtained by the module  and generates information representing the end-to-end delay values obtained. This information is grouped in the form of transmission quality tickets, for example, each corresponding to one or more voice calls set up in the communication terminal  concerned.","These transmission quality tickets are then sent over the network to a collection server  for managing end-to-end delay information sent by a set of communication terminals connected to the network.","Quality tickets are transmitted over the network via the protocol manager  and the network interface . In a preferred embodiment, each quality ticket is incorporated in a TCP message sent via the IP network .","The collection server  processes quality tickets sent by a set of communication terminals ,  connected to the network in order to evaluate the transmission quality of speech signals received in all the terminals. The collection server therefore receives generated quality tickets for each terminal from the set of communication terminals equipped with a device of the invention, either periodically or after each voice call.","In one embodiment, the collection server generates from the received tickets a line of text for each received ticket in a transmission quality measurement report that is stored in the server. The information in this quality report can then be viewed by a human operator via an appropriate man-machine interface, for example a graphical user interface displayed on a computer screen. The displayed information can then be used to supervise the quality of service in relation to the Voice over IP offer on the network.","The method of the invention of evaluating the end-to-end transmission delay of a speech signal, including the method of the invention of evaluating the processing delay of a speech signal received in a communication terminal, is described next with reference to .","In , in the step E, the data packets (UDP packets) containing the speech signal are supplied by the protocol stack  to the network filter  which uses a timer to determine the times required for evaluating the end-to-end transmission delay.","Thus the purpose of the above timer is to time these delay evaluations. In one embodiment, the evaluation rate is set at one evaluation every 15 seconds. In another embodiment, the evaluation is effected in the form of a burst of measurements to obtain an average value of the delay measurements at a given time.","If the delay must be evaluated (E, yes), in the step E, the network filter  extracts from the UDP stream the RTP packets containing the speech frames and copies that stream of packets.","In the step E, the stream of RTP audio packets duplicated by the network filter is supplied to the control decoder module  which reconstitutes a speech signal from them. The reconstituted speech signal is then saved in the file F.","In parallel with this, in the step E, the audio filter  duplicates the speech signal reconstituted by the telephony module  and saves it in the file F.","The audio signal from the control decoder  and the audio signal from the audio filter  are preferably stored at the same time in the file F and the file F, respectively.","It will be noted here that, to simplify the explanation, the audio signals referred to above are designated by the names of the files that contain them, that is to say F and F.","In the present, embodiment, extraction of audio data by the network filter and the audio filter is halted after a predetermined time, which in one embodiment is five seconds.","In the step E, the module  for evaluating the processing delay D measures the vocal activity of the speech signals F and F and then compares the measured values to a predetermined voice activity threshold that in practice is set at 30%. In the step E, the delay difference between the two speech signals F and F is determined only if the vocal activity measured in the two signals F and F is above the predetermined threshold.","Consequently, in the present embodiment, the delay difference between the two speech signals F and F, each sampled over five seconds, is determined (E) if the voice activity of those signals exceeds 30% (E, yes). Otherwise (E, no), the process returns to the step E. This voice activity criterion verifies whether the two signals contain sufficient speech to enable the delay difference between the two signals to be measured.","In the step E, the delay evaluation module  computes the delay difference between the two speech signals F and F.","In a preferred embodiment the delay difference between the signals F and F is measured as a function of the intercorrelation of the envelope signals of the signals F and F.","For example, the delay difference between the signals F and F may be measured using the method described in French Patent document No. 2 733 867 \u201cProc\u00e9d\u00e9 et dispositif de mesure sans intrusion de la qualit\u00e9 de transmission d'une ligne t\u00e9l\u00e9phonique\u201d [\u201cA method and apparatus for measuring the transmission quality of a telephone line without intrusion\u201d]. The method described in the above document is explained therein with particular reference to , and is applied to a speech signal and to a corresponding echo signal. In the context of the present invention, the measurement method described in the above document is applied to the speech signals F and F.","Thus, using the method described in the above document, samples of the speech signal F from the control decoder are filtered by a low-pass filter over a particular time period and samples of the signal F from the audio filter are also filtered, over a time period substantially equal to half that particular time period but offset by half the period, which yields envelope signals of the signals F and F. A plurality of coefficients of the intercorrelation between the signals F and F is established for successive separate times with a particular time increment. Comparing the intercorrelation coefficients discriminates the intercorrelation coefficient with the highest value for a specific time value that represents the measured delay difference Dt between the signals F and F.","In the step E, the delay D representing the processing delay of the speech signal received in the communication terminal  concerned is obtained by summing the measured delay difference Dt between the speech signals F and F and the predetermined decoding time Tdec of the control decoder ; in other words D=Dt+Tdec.","According to the invention, the processing delay D of the speech signal received in the terminal is measured in the context of evaluating the end-to-end transmission delay of the speech signal.","To this end, the processing delay D on sending the speech signal is evaluated (E) and the transmission delay D of the speech signal in the network is measured (E), as shown in , during the steps E and E.","In the present embodiment, the processing delay D on sending the speech signal is evaluated by consulting a table stored in the receiver terminal. That table stores a predefined maximum value and a predetermined minimum value of the delay D for each type of coder used for sending the received speech signal, these predefined values taking into account the payload of the received IP packets.","The sending coder type and the received IP packet payload are identified in the receiver terminal from call request signaling messages contained in the received IP packets. In the present embodiment, the signaling messages conform to the H.225.0 call request signaling protocol.","The method of evaluating the delay D described here is described in the document \u201cEstimating E-model Id within a VoIP network, Technical note\u201d from Psytechnics. The method described is derived from ITU-T Recommendation G.114: \u201cTRANSMISSION SYSTEMS AND MEDIA, DIGITAL SYSTEMS AND NETWORKS\u2014One-way transmission time\u201d.","It will be noted here that the send coder type (negotiated codec) may equally be obtained from call request negotiation (H.245) messages extracted from the data packets received in the terminal. These call request negotiation messages are extracted by the network filter , from which voice call identification information is obtained, in particular the start and end of call times, the codec (audio coder-decoder) negotiated between the calling terminal and the called terminal, the payload of the received IP packets, the identifiers, for example the IP addresses, of the called and calling terminals, and the path linking the two terminals via the network.","The table below gives a list of the best case and worst case encoding delays D for three of the most widely used VoIP codecs. This table is taken from the above Psytechnics document.",{"@attributes":{"id":"p-0115","num":"0151"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"91pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]},{"entry":[{},"Codec","D1, best case (ms)","D1, worst case (ms)"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"G.711","Packet_size","Packet_size + 0.125"]},{"entry":[{},"G.729","Packet_size + 5","Packet_size + 5 + 10"]},{"entry":[{},"G.723.1","Packet_size + 7.5","2 * Packet_size + 7.5 + 30"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}}}},"In practice, in most situations, the send encoding delay D will be closer to the best case delay and consequently a reasonable estimate of the coding delay D is the minimum (best case) value +20%.","In this evaluation, the time that elapses between the moment at which a packet is ready to send in the sender terminal and the time at which it appears on the transmission line is insignificant and is therefore ignored.","Accordingly, knowing the send codec type and the payload of the IP packets, it is possible to estimate the coding delay (send processing delay) within a range of delays.","Referring again to , once the send encoding delay D has been computed, it is supplied to the module  for evaluating the end-to-end delay, as shown in the step E.","The transmission delay D of the speech signal in the network is evaluated in the step E. In a preferred embodiment of the invention, this delay is evaluated by either of two alternative methods.","The first is to use sender report (SR) packets in the RTCP packets contained in the UDP frames of the received IP packets. The transmission delay D from the sender terminal to the receiver terminal can easily be calculated from the information contained in the SR packets. For more details on the method of calculating this delay from the information contained in the SR packets, see the Internet Engineering Task Force (IETF) document RFC 1889. See in particular therein item 6.3.2, which is associated with  of the document, which is entitled \u201cExample for round-trip time computation\u201d.","An alternative method is used to evaluate the transmission delay D on the network if the SR packets are not available during the call because the sender terminal or the telephone application of the sender terminal does not allow it, because the voice call is too short, or for any other reason leading to the absence of sending reports in the packets received.","In a preferred embodiment of the invention, the alternative method uses the utility program Ping, which uses the echo function of the Internet Control Message Protocol (ICMP), details of which can be found in the IETF document RFC792.","In the context of the present invention, the receiver terminal  sends a small packet over the network to the IP address of the sender terminal . The receiver terminal  then waits for a return (echo) packet from the sender terminal . Then, by halving the time that elapses between sending the Ping packet and receiving the echo packet, an evaluation is obtained of the average transmission delay D over the network between the sender terminal and the receiver terminal.","As for the delay D, once the transmission delay D over the network has been calculated, it is supplied to the module  for evaluating the end-to-end delay in the step E.","In the step E, the end-to-end transmission delay Dbb is calculated from the send processing (encoding) delay D, the transmission delay D over the network, and the receive processing delay D. In practice, the end-to-end delay is obtained by summing the calculated values of the delays D, D, D.","Finally, in the step E, the calculated end-to-end delay value is stored so that it may be sent over the network to a collection server, if necessary, as explained above with reference to . If this is the case, the following steps (not shown in ) are executed:\n\n","To summarize, the present invention relates in particular to a method of evaluating the processing delay of a speech signal contained in data packets received in a receiver terminal equipped with a telephony module during a voice call over a packet-switched network to a terminal sending the data packets. The invention also relates to a method of evaluating the end-to-end transmission delay of a speech signal received in a receiver terminal, that end-to-end delay including the above speech signal processing delay.","In the embodiment described above, the steps of these methods are determined by computer program instructions and are executed when these programs are loaded into a computer, or more generally an electronic data processing system, the operation of which is then controlled by the execution of the programs.","Consequently, the invention applies equally to computer programs adapted to implement the invention, especially computer programs on or in an information medium. These programs may use any programming language and take the form of source code, object code or an intermediate code between source code and object code, such as a partially compiled form, or any other form that is desirable for implementing a method of the invention.","The information medium may be any entity or device capable of storing the program. For example, the medium may include storage means, such as a ROM, for example a CD-ROM or a semiconductor ROM, or magnetic storage means, for example a diskette (floppy disc) or a hard disc. Also, the above medium may be a transmissible medium such as an electrical or optical signal, which may be carried by an electrical or optical cable, by radio waves or by other means; in particular, a program according to the invention may be downloaded via the Internet.","Alternatively, the information medium may be an integrated circuit into which the program is incorporated, the circuit being adapted to execute or to be used in the execution of the method in question.","The invention also relates to voice call terminal equipment equipped with a device of the invention, such as an IP telephone or a multimedia PC equipped with telephony software. The invention relates more generally to any IP terminal equipment equipped with a delay evaluation device of the invention.","Of course, the present invention is in no way limited to the embodiments described and shown here, but to the contrary encompasses all variants that will be evident to the person skilled in the art."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Other features and advantages of the invention will become more apparent upon reading the following description of the invention, which is given with reference to the appended drawings, in which:",{"@attributes":{"id":"p-0031","num":"0043"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0032","num":"0044"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0033","num":"0045"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
