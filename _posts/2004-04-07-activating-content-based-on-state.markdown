---
title: Activating content based on state
abstract: A content author provides content to be displayed, including some content elements for which display is conditional on the state of the machine in which the content will be viewed. The conditional statements controlling the display of these content elements, in one embodiment refer to states provided by a state monitor. The state may refer to the state of any aspect of the viewing environment, including hardware, software, firmware, user preferences, software operating modes, and any other detectable state. The resulting content is optionally combined with other similar content via a structural transform. This content is transformed with a presentation transform. One of the transforms checks the states and resolves the conditional statements included by the content author. The result of the transforms is presentation data. A display of this presentation data includes the content which, according to the conditional statements and the state of the viewing environment is appropriate for display.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07890744&OS=07890744&RS=07890744
owner: Microsoft Corporation
number: 07890744
owner_city: Redmond
owner_country: US
publication_date: 20040407
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"p":["The subject matter described herein is related to the subject matter disclosed in co-pending application Ser. No. 10\/754,984 filed on Jan. 9, 2004 entitled \u201cSystem and Method for Context Sensitive Searching.\u201d The subject matter described herein is also related to co-pending U.S. patent application Ser. No. 10\/819,661, entitled \u201cPresentation-Independent Semantic Authoring of Content,\u201d and U.S. patent application Ser. No. 10\/819,607 entitled \u201cIn-Place Content Substitution via Code-Invoking Link,\u201d both filed on the same date as the present application.","This invention relates in general to the field of information technology. More particularly, this invention relates to a computing environment context to facilitate state-dependent selection and presentation of content to a user. Such adaptive content may be utilized in, e.g., a help system for software applications.","In certain contexts, such as help systems for software applications, where information is presented to a user of a computer system, the information discusses the state of the machine. For example, when a user inquires as to how to change a specific setting for a printer attached to a printer running an operating system, the operating system's associated help system may provide the user with help information regarding changing the setting. The help content presented may require the user to have knowledge about and understand details about the setup and current functioning of the user's computer system. For example, the help content may ask how the printer is attached (e.g. local or networked), what version of some software application is running on the user's computer, or other details dependent on the setup and functioning of the user's computer, and may guide the user based on the answers to these questions. Providing help information in the alternative based on some detail of the user's computer system may be done by including all the information in the help content (e.g. \u201cif the printer is a networked printer\u201d will be followed by directions on changing the setting for a networked printer, but the same help screen may include \u201cif the printer is a local printer\u201d and directions on changing the setting for a local printer.) Providing help information in the alternative may also be accomplished by requesting that the user make a selection (e.g. \u201cis the printer a networked or local printer?\u201d) and then presenting the applicable help information to the user.","In either instance, the user in such a situation is required to have some sophistication in knowing the setup of their computer system and the current state of the computer system. This requirement produces some confusion and dissatisfaction with less sophisticated users and requires additional time for even sophisticated users who are consulting the help system.","Additionally, help information may be related to certain higher-level tasks which are the domain of a computer system administrator, and not the lay user. This help information should riot be viewable by the lay user.","In prior art help systems, state-dependent content could be viewed, however, the functionality for providing this adaptable content had to be built into the application which was being queried used for the content. This introduced some security concerns, because a viewer could be modified to allow a user to view content which the user should not view. Additionally, having the viewer determine which content should be displayed requires the viewer to access certain state information about the computer system, which may introduce privacy concerns and complexity. An additional drawback is that each viewer would need identical functionality to view some item of content or the content could not be reused.","Thus, there is a need for a system and method to overcome these deficits in the prior art. The present invention addresses the aforementioned needs and solves them with additional advantages as expressed herein.","In order to allow for states of the user's computing environment to be reflected in the content presented to the user, conditional marking is used by a content author. This conditional marking is used with respect to certain elements of content. The conditional markings are evaluated to determine which elements of content the user will see when the user requests to see the content. For example, help content will be modified according to the conditionality in the help content to allow the user to see help content which is more closely tailored to the current situation on the user's computer.","In one embodiment, the content presented to the user is determined by accepting content including conditional content (content with conditions applied to the display of that content) and the conditions, including at least one state condition describing the user's environment (such as user's state, the state of the user's machine, or the state of the user's application) are evaluated. The resulting content can then be used for display to a user.","Other features of the invention are described below.","Overview","According to one embodiment of the invention, an improved authoring scheme for content which is to be displayed to a user is provided. A help system will be used in this specification to describe the invention, however, the invention is not limited to use in help systems, but rather can be more widely used, for example, in other systems where content is authored so that different elements of the content are displayed to a user based on the state of the user's computer system environment.","Exemplary Computing Environment",{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 1","b":["100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, embedded systems, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network or other data transmission medium. In a distributed computing environment, program modules and other data may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The processing unit  may represent multiple logical processing units such as those supported on a multi-threaded processor. The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus (also known as Mezzanine bus). The system bus  may also be implemented as a point-to-point connection, switching fabric, or the like, among the communicating devices.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CDROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk , such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies. A user may enter commands and information into the computer  through input devices such as a keyboard  and pointing device , commonly referred to as a mouse, trackball or touch pad. Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","State Monitors","In one embodiment, the information describing the state of the user's computer system is provided by state monitors.","As described in application Ser. No. 10\/754,984 filed on Jan. 9, 2004 entitled \u201cSystem and Method for Context Sensitive Searching,\u201d state monitors can be used to monitor the state of the computing environment and use the individual states of the various components of the environment, including hardware, software, firmware, user preferences, software operating modes, and any other detectable state to provide a context to searches for information such as help information. State information can include any information about the user, the state of the user's machine, and the state of application(s) being run by the user.","A collection of monitors is used to provide state information. Each monitor tracks information about a particular state including whether it is currently true or false. States may be very simple like having a printer attached or complex like having an HP 770 printer attached that has low toner and is the current user's default printer. In one embodiment, the only states that are monitored are ones that have been explicitly requested by some application.","Examples of states which may be useful in determining the context of a search include hardware, software, and user preferences and controls. Hardware states may include the type, model, and make of hardware attached to the user computing device . Internet connection state, the local network and the presence of a shared printer, multiple displays, and the type of network are also examples of states in a computing environment. Examples of software states may be the version of operating system used or the application being run and the mode of the application such as editing a document or creating an equation for calculation in a spreadsheet. Examples of user related states include user preferences and conditions such as whether the user is a system administrator, whether the user has selected specific styles or modes in the generation or viewing of documents. Additional states representative of the computing environment may be monitored as new content is downloaded or new applications are installed.","One type of monitor may be an installed hardware monitor. The monitor may be used to indicate a state of specific hardware installed in the local computing environment. Based on the hardware monitors, results, such as the presentation of data resulting from help searches, may be modified. The modification may be of the form of an exclusion of search result data from presentation to the user. The modification may also involve the use of logical Boolean functions such as AND, OR and NOT in relation to data and the state of other monitors.","Monitors can be used in a logical manner as well to sense the combined condition of multiple states within a computing environment to enhance searches. Given a search for information concerning the printing of a file to a printer, the search may use the state monitors for both the presence of a CDRW as well as the type of printer connected to the user's system under a logical AND function. Thus, where help information would normally only provide information concerning printing a file to a printer, but the file to be printed may be resident on the CDRW in the user's environment, the hardware monitors for the CDRW and the printer under the logical AND function may indicate that not only information concerning generic file printing may be appropriate, but also information that specifically relates to printing a file from a CDRW to the specific type of printer which the monitor indicates is attached to the computer system may be relevant to the user. Other logical functions (NOT, OR, etc.) may also be used to combine state monitor information.","Use of the State Information to Provide State-Dependent Information",{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 2","FIG. 2"],"b":["200","205","210","200"]},"The pre-transformation content files  include content which is conditioned on a state\/context of the computer system in which it is to be displayed. For example, the pre-transformation content may include instructions for administrators, as in the following pseudo code example:",{"@attributes":{"id":"p-0036","num":"0035"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Changing A Password -"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"In order to change a password, select the Change"]},{"entry":[{},"Password option in the session management menu. Type"]},{"entry":[{},"in the User ID and the current password in the"]},{"entry":[{},"indicated fields. A new prompt will ask you for the"]},{"entry":[{},"new password in an additional field. This new"]},{"entry":[{},"password will need to be typed in twice in order to"]},{"entry":[{},"take effect."]},{"entry":[{},"<para condition=\u201cIsAdmin\u201d>"]},{"entry":[{},"If the current password has been lost by a user, an"]},{"entry":[{},"administrator may reset the password by opening the"]},{"entry":[{},"Reset User Password menu in the administration menu,"]},{"entry":[{},"which will be viewable only when logged on as an"]},{"entry":[{},"administrator. Enter the User ID and a new password"]},{"entry":[{},"in the indicated fields."]},{"entry":[{},"<\/para>"]},{"entry":[{},"<para condition=NOT(\u201cIsAdmin\u201d)>"]},{"entry":[{},"If you have forgotten your password, please consult an"]},{"entry":[{},"administrator."]},{"entry":[{},"<\/para>"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"The header (\u201cChanging a Password\u201d) and the first paragraph will appear whenever the state-independent content is viewed. The second paragraph (surrounded by <para condition=\u201cIsAdmin\u201d> and <\/para> in the pseudo code) will appear if the content is rendered where the state of the \u201cIsAdmin\u201d monitor is true, indicating that the user who will view the content is an administrator. If the state of \u201cIsAdmin\u201d is false, then the last paragraph will be displayed to the user. Thus, state-dependent content is presented only in the correct context for its display.","As another example, pre-transformation content files  can also include conditional references based on the presence or absence of certain hardware. Thus, a user who looks for help in printing will be given help instructions for the specific printer which is attached to the user's computer system. A user who requests help in saving a file will receive instructions on saving the file to whichever of: a hard disk, a floppy disk, a CDRW, or an external storage device is attached to the user's computer. In the above pseudo code, the state \u201cIsAdmin\u201d has a value of true or false. In one embodiment, all states have values of true or false. In other embodiments, states may contain varied values, for example, with a \u201cPrinterCondition\u201d state having a number of possible values (e.g. \u201coff\u201d, \u201cout-of-paper\u201d, \u201cbusy\u201d, or \u201cready\u201d, among others.)","The way this information is presented to a user is via the transformations shown in . A number of pre-transformation content files  may be combined in order to provide content for a display to the user. For example, in the context of a help system, it may be helpful to have a fragment of a help topic displayed along with one other fragment in one help topic, and with other fragments in a different help topic. If a number of help topics will direct a user to a control panel, for example, only one fragment needs to describe the access for that control panel, and then other fragments can describe different actions to take once the control panel is accessed. In order to execute such a combination of fragments of content for a single display, as shown in , the pre-transformation content file  for each of the help fragments is an input to a structural transformation . Any number of structural transformations  may be performed (including none). The result of any structural transformations is a complete structurally-transformed content file . Additional inputs to the structural transformation  are state information  and structural transform data . The state information  provides state information for the structural transform , for evaluating any conditional statements that are to be evaluated during the structural transformation stage. The structural transform data includes data describing how the structural transformation should be accomplished. For example, where the pre-transformation content files  are in XML (extensible markup language), the format for the structural transform data may be XSLT (extensible style sheet language transform) which defines how a transformation should be applied to the XML-formatted pre-transformation content files .","A presentational transform  is then applied to the resulting structurally-transformed content file . Again, inputs to this include transform data (presentational transform data ) and state information . The final result of this presentation transform  is presentation content data . This presentation content data  is presentation data in a format which can be used on the user's computer system. For example, where the user's computer system has the ability to display data in HTML (hypertext markup language) format, the presentation content data may be in HTML format.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 3","FIG. 3","FIG. 3","FIG. 4","FIG. 4"],"b":["300","310","320","320","400","410","420"]},"With reference again to , depending on a number of factors, the evaluation of conditional statements may be performed in a structural transformation  or in the presentation transform . If, for example, the evaluation of conditional statements is performed in the structural transformation, the structural transformation  may remove the non-applicable content from the structurally-transformed content file . In this case, even by examining the source for the presentation content data  (the actual HTML file, e.g., rather than the display resulting from the HTML file) a user could not see the non-applicable content. This provides security benefits.","The evaluation of conditional statements may also be performed in the presentational transformation . In this case, the non-applicable content may be hidden from the user, however it may still be present in the presentation content data , for example as hidden or invisible text. The source for the presentation content data  may therefore include that non-applicable content. Depending on the viewing options, the option may be provided to a user to view hidden text. This allows a user flexibility, to see what the content would have been in other situations. In another embodiment, the presentation transform  functions as a \u201ccold filter\u201d in which content gets excluded from the presentation content data  and is not viewable.","The transformation(s) as shown in  occurs, in one embodiment, in a content transformation engine. In one embodiment, the structural transformations (if any) and the presentational transformation occur on the user's computer system.  shows one example of the content transformation engine on a user's computer system. A content producer  provides one or more pre-transformation content files . These files may come from one content producer, or from a number of content producers. A content transformation engine  on the user system  transforms these into presentation content data . In one embodiment, the transformation occurs when the pre-transformation content files  are needed in the help system.","Conclusion","It is noted that the foregoing examples have been provided merely for the purpose of explanation and are in no way to be construed as limiting of the present invention. While the invention has been described with reference to various embodiments, it is understood that the words which have been used herein are words of description and illustration, rather than words of limitations. Further, although the invention has been described herein with reference to particular means, materials and embodiments, the invention is not intended to be limited to the particulars disclosed herein; rather, the invention extends to all functionally equivalent structures, methods and uses, such as are within the scope of the appended claims. Those skilled in the art, having the benefit of the teachings of this specification, may effect numerous modifications thereto and changes may be made without departing from the scope and spirit of the invention in its aspects."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing summary, as well as the following detailed description of preferred embodiments, is better understood when read in conjunction with the appended drawings. For the purpose of illustrating the invention, there is shown in the drawings exemplary constructions of the invention; however, the invention is not limited to the specific methods and instrumentalities disclosed. In the drawings:",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 2","FIG. 3"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
