---
title: Information processing apparatus and method thereof for generating drawing data of a moving image object in a raster format for printing an image based on a web page by a printing apparatus if it is determined that the web page contains the moving image object and drawing data of the moving image object cannot be created in the vector format
abstract: If a web page contains a moving image object, an information processing apparatus generates drawing data of the moving image object in a raster format and creates captured data by incorporating the generated drawing data of the moving image object into drawing data of the web page generated in a vector format.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08850302&OS=08850302&RS=08850302
owner: Canon Kabushiki Kaisha
number: 08850302
owner_city: Tokyo
owner_country: JP
publication_date: 20110616
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENTS","Other Embodiments"],"p":["1. Field of the Invention","The present invention relates to an information processing apparatus configured to process a moving image object, a processing method of the information processing apparatus, and a non-transitory computer-readable storage medium.","2. Description of the Related Art","Conventionally, web pages composed of a structured document written in a structured language such as HTML (Hyper Text Markup Language), XHTML (Extensible Hyper Text Markup Language), or the like have been known. In addition, it has been known that software called a web browser is used to reference web pages.","A technology for extracting a required portion within a web page displayed in a web browser and printing the extracted required portion has been known. Moreover, a technology for selecting a desired still image from a plurality of still images constituting a moving image on a web page and printing the selected desired still image has also been known (see Japanese Patent Laid-Open No. 2000-181924).","Moving image objects contained in web pages are divided into objects whose drawing data can be captured in a vector format and objects whose drawing data cannot be captured in the vector format.","In printing a web page, in the case where the image quality of characters and the like is of a great importance, it is preferable to capture the web page itself in the vector format. However, if the web page contains a moving image object that cannot be captured in the vector format, this moving image object portion will not be captured and will be missing.","The present invention provides a technology by which any moving image object portion can be captured and will not go missing even if it is a moving image object that cannot be captured in the vector format.","According to a first aspect of the present invention there is provided an information processing apparatus comprising: a determination unit configured to determine whether a web page contains a moving image object; a generation unit configured to generate drawing data of the moving image object in a raster format if the determination unit has determined that the web page contains the moving image object; a creation unit configured to create captured data by incorporating the drawing data of the moving image object generated by the generation unit into drawing data of the web page generated in a vector format; and an output unit configured to output the captured data created by the creation unit.","According to a second aspect of the present invention there is provided a processing method of an information processing apparatus that can process a web page, the method comprising: determining whether a web page acquired by the information processing apparatus contains a moving image object; generating drawing data of the moving image object in a raster format if it has been determined that the web page contains the moving image object; creating captured data by incorporating the generated drawing data of the moving image object into drawing data of the web page generated in a vector format; and outputting the created captured data.","Further features of the present invention will be apparent from the following description of exemplary embodiments with reference to the attached drawings.","An exemplary embodiment of the present invention will now be described in detail with reference to the drawings. It should be noted that the relative arrangement of the components, the numerical expressions and numerical values set forth in this embodiment do not limit the scope of the present invention unless it is specifically stated otherwise.","Note that a \u201cprinting medium\u201d means not only a paper sheet for use in a general printing apparatus but also a member which can fix ink, such as cloth, plastic film, metallic plate, glass, ceramics, resin, lumber, or leather in a broad sense.",{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 1"},"The printing system includes a personal computer (hereinafter simply referred to as a \u201cPC\u201d) , a printer  connected to the PC, and a plurality of WWW servers  connected to the PC via the Internet . A communicable connection is established between the PC  and the printer  using, for example, a LAN (Local Area Network), a USB (Universal Serial Bus), or the like. It should be noted that the overall configuration illustrated here is merely an example, and for example, a plurality of PCs  and a plurality of printers  may be provided, or an apparatus other than these may be connected.","The PC  is an information processing apparatus, which is handled by a user. The PC  downloads a web page from a WWW server  via the Internet  and displays the downloaded web page. Examples of the web page include those composed of a structured document written in HTML, XHTML, XML, or the like and acquired via the Internet . A structured document refers to a document written in a structured description language (e.g., a markup language) that defines the structure of a document. It should be noted that the PC  can handle any such document as a web page as long as a display screen can be created based on the document, even if it is not acquired via the Internet . Moreover, the PC can handle various types of content as web pages as long as the content is in a format that can be handled by a web browser (hereinafter simply referred to as a browser), even if the content is in a format other than the structured document formats. Moreover, after acquiring a web page via the browser, the PC  can also instruct the printer  to print the web page.","The printer  is a printing apparatus that performs printing by forming an image on a printing medium (e.g., paper) using a printing agent (ink, toner, or the like). It should be noted that there is no particular limitation to the printing method of the printer . For example, an inkjet method may be used, or an electrophotographic method may be used.","The WWW servers  store web pages written in HTML, XHTML, or the like, images, and the like and provide the stored information via the Internet  in response to a request from the PC  or the like.","Next, an example of a hardware configuration of the PC  shown in  will be described using .","The PC  includes a CPU , a RAM , a ROM , a hard disk , a USB interface , the display device , an input device , and a LAN interface . It should be noted that these units constituting the PC  are communicably connected to each other via a bus .","The CPU  conducts integrated control of operations in the PC . More specifically, the CPU  performs calculations and the like of data or instructions in accordance with programs stored in the ROM , the hard disk , or the like.","The RAM  is used as a work area when the CPU  performs various types of processing. The hard disk  stores an operating system (OS), a browser, other types of application software, and the like.","The USB interface  is an interface through which a USB device is connected, and is used to perform data communication with, for example, the printer . The LAN interface  is an interface for connecting the PC  to a LAN and is used to perform data communication with, for example, a WWW server  via the Internet . It should be noted that data communication using the USB interface  and using the LAN interface  can be performed by wired transmission or by wireless transmission.","The display device (a display)  is, for example, a CRT, a liquid crystal display, or the like and displays various types of screens (e.g., a web page, a print preview image, and a graphical user interface (GUI)) based on information and the like downloaded from a WWW server . The input device  is, for example, a mouse, a keyboard, or the like and is used to input instructions from the user.","Next, an example of a functional configuration implemented on the PC  will be described using . It should be noted that a functional configuration implemented in a structured document printing module  can be implemented by, for example, the CPU  executing a program (e.g., the structured document printing module) that has been read out from the ROM  using the RAM  as a work area.","Here, a browser  is an application that analyzes a web page and displays the web page according to the result of the analysis. Moreover, the browser  downloads a web page on a WWW server  to the hard disk  of the PC  and displays the downloaded web page on the display device . As described above, a web page contains a structured document written in a structured language such as HTML, XHTML, or the like, and elements constituting the structured document, such as text, images, and the like, are described using tags. Moreover, a separate file called a style sheet (CSS: Cascading Style Sheet) that defines the display style of these elements is designated in the structured document. The browser  can analyze such structured documents and display them on the display device . It should be noted that a general-purpose browser can be used as the browser .","The structured document printing module  is a piece of plug-in software invoked from the browser . For example, in the case where the user has designated a print region to the browser , this structured document printing module  will be executed. Once an installer for installing the structured document printing module  has been activated, the module  is saved in the hard disk . Then, a menu or the like for invoking the structured document printing module  or designating various types of functions of the module  is incorporated into the browser .","Here, with regard to a functional configuration of the structured document printing module , the module includes a detection unit , a structured document drawing unit , a window generation unit , a display processing unit , an intermediate data generation unit , and a print control unit .","The detection unit  includes a moving image detection unit that analyzes a web page (a structured document) to detect a moving image object and a type determination unit that further determines the type of the moving image object if the moving image object has been detected.","The structured document drawing unit  generates drawing data  based on the result of parsing the web page. It should be noted that in the case where a moving image object has been detected by the detection unit , different drawing processing is performed for each type of moving image object. Moreover, the structured document drawing unit  generates the drawing data (drawing data in a vector format or a raster format)  for the moving image object at constant time intervals on the RAM . In the case where drawing data in the vector format and drawing data in the raster format have been generated, the structured document drawing unit  combines the drawing data in these different formats. In drawing data in the vector format, for example, characters are expressed as character codes and codes that indicate the font type and the like, and line drawings are expressed as codes that indicate direction, distance, and the like.","The window generation unit  generates a print preview window (a child window) for displaying the drawing data  stored in the RAM . A drawing unit  that draws the drawing data  generated on the RAM  on the child window is provided within the window generation unit . It should be noted that the drawing unit  updates data corresponding to the moving image object in the drawing data as required based on the drawing data generated by the structured document drawing unit  at constant time intervals, and draws the updated data on the child window. Thus, on the child window, the moving image object portion is updated as required, and therefore the moving image object is displayed in a playback (movement) state in which it is being played back. It should be noted that the child window has the same size as, for example, a display region of the browser .","The display processing unit  allows various types of screens to be displayed on the display device. The display processing unit  displays various types of information on the display device  in accordance with drawing data supplied to a display driver. A window display processing unit  and a selected region display processing unit  are provided within the display processing unit . The window display processing unit  allows the child window that has been generated by the window generation unit  to be displayed in front of the display region of the browser . The selected region display processing unit  allows a selected region that defines a print range to be displayed on the child window. In the case where a change in the size or the like of the selected region has been instructed by the user, the selected region display processing unit  changes the range of the selected region in accordance with the change instruction and displays the changed selected region.","The intermediate data generation unit  retrieves data corresponding to the selected region displayed by the selected region display processing unit  from the drawing data  generated by the structured document drawing unit , and generates intermediate data  based on the retrieved data. The intermediate data  is data into which data in the vector format, data in the raster format, and text data are integrated. It should be noted that the intermediate data can be in any data format as long as it can be interpreted by the printer . For example, the intermediate data can be generated in EMF (Enhanced Meta File) format. The intermediate data may also be in PDF (Portable Document Format) format or in XPS (XML Paper Specification) format. With regard to the method for creating intermediate data in PDF and in XPS, a commonly-used technology is employed as is the case with EMF.","The print control unit  controls printing based on the intermediate data  generated by the intermediate data generation unit . More specifically, this unit causes a printer driver  to perform drawing processing of the intermediate data  via the OS .","The OS  provides various types of APIs (Application Programming Interfaces). Examples of the APIs include the GDI (Graphics Device Interface) used in Windows (registered trademark) of Microsoft Corporation in the U.S., a specialized graphics API, and the like. The GDI can handle data in the vector format and processes drawing data containing the data in the vector format. The processing result of the GDI can be output to both the display driver and the printer driver. The specialized graphics API processes, for example, drawing data that can be processed by a high-performance graphics accelerator. The processing result of the specialized graphics API can be output to the display driver, but is not output to the printer driver. Moreover, although the OS  contains various types of control software, such as a spooler system that manages a print job, a port monitor that outputs a printer command to a port, and the like, these technologies are well-known technologies, and therefore a detailed description thereof is omitted.","The printer driver  performs drawing processing as controlled by the print control unit  to create print data, and converts the print data to a printer command. Afterward, the printer command is transmitted to the printer  via the OS . Thus, the printer  performs printing onto a printing medium.","Next, an example of a GUI screen displayed on the display device  will be described using  and B.",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 4","b":"51"},"Here, a region  is a display region of the structured document. A region  is a GUI of a plug-in module executed by processing of the structured document printing module , and a \u201cClip\u201d button  and a \u201cPrint\u201d button  are arranged in this region. Once the structured document printing module  has been installed, a GUI such as this is incorporated into the browser .","At the time of printing, the user presses the \u201cClip\u201d button  via the mouse or the like. Then, as shown in , a child window  is displayed in front of the browser . In the child window , the drawing data of the structured document is displayed, and a selected region  is also displayed. The user can freely change the size or the location of the selected region  using the mouse or the like. It should be noted that although the child window  shown here is horizontally and vertically shifted with respect to the position of the display region  on the browser  for better understanding, the display position of the child window is not limited to this. For example, the child window  may be displayed at the same position as, and completely superposed on, the display region  on the browser .","Here, the user adjusts the selected region  on the child window  and determines a desired print range. Once the print range has been determined, the user presses the \u201cPrint\u201d button  via the mouse or the like. Thus, printing of the range of the structured document selected by the selected region  can be performed.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":["FIG. 6","FIGS. 4 and 5"],"b":"51"},"Here, reference numerals  and  respectively indicate moving image objects in the structured document. It is assumed that the moving image object  here is data whose drawing data can be generated in the vector format (data that can be captured in the vector format). Moreover, it is assumed that the moving image object  is data whose drawing data can only be generated in the raster format (data that cannot be captured in the vector format). The data whose drawing data can be generated in the vector format refers to data with respect to which, after drawing processing of the moving image object is performed via the GDI, the printer driver  can handle the drawing data to generate print data. The data whose drawing data can only be generated in the raster format refers to data with respect to which, after drawing processing of the moving image object is performed via the graphics API through which processing can be performed by the high-performance graphics accelerator, the printer driver  cannot receive the processing result in the vector format as is. This is because the drawing data of the latter moving image object is supplied to the display driver without passing through the GDI. Although details will be described later, the latter moving image object is changed to the raster format temporarily and then incorporated into the intermediate data. It should be noted that the raster format refers to data in, for example, bitmap format, png format, jpg format, or the like. Moreover, which of the above-described two different formats a moving image object contained in a web page corresponds to is determined depending on the type of moving image. The type of moving image can be determined by referencing tags indicated by a structured language contained in the web page to make the determination based on information indicating the type of operation or can be determined by an extension of a moving image file.","At the time of printing, the user presses the \u201cClip\u201d button  via the mouse or the like. Then, as shown in , the child window  is displayed in front of the browser . In this child window , the drawing data of the structured document is displayed, and the selected region  also is displayed.","Here, only the moving image object  whose drawing data can be generated in the vector format is present in the selected region  shown in . Therefore, with respect to a web page portion containing the moving image object in the selected region , the drawing data is entirely created in the vector format except a bitmap image object.","In contrast, the moving image object  whose drawing data can be generated in the vector format and the moving image object  whose drawing data can only be generated in the raster format are present in the selected region  shown in . In this case, if drawing processing for acquiring data in the vector format is performed as is the case with , a portion where the moving image object  is present will be missing, leaving a blank. Thus, here, for the moving image object , the drawing data is created in the raster format, and for the other region (the moving image object  and a region of the web page in which no moving image object is arranged), the drawing data is created in the vector format. Afterward, the drawing data created in the raster format is combined with (embedded into) the drawing data created in the vector format, and thus a single piece of drawing data is created.","Next, an example of the flow of capturing processing and print processing in the PC  when printing a structured document will be described using . Here, processing from creation of intermediate data in EMF format of a print region of the structured document to printing of the created intermediate data will be described. Processing of the flowcharts shown in  is performed by the CPU  executing a program of the structured document printing module  stored in the hard disk .","This processing is started when the user presses the \u201cClip\u201d button  on the browser  shown in  via the mouse or the like (YES in S). Once this processing has started, the moving image detection unit of the PC  analyzes the structured document displayed on the browser  and performs a detection (a first determination) of whether or not a moving image object is contained in the document of interest (S).","If the result of the detection is that no moving image object has been detected (NO in S), the structured document drawing unit  of the PC  generates the drawing data  in the vector format on the RAM  (S). Then, the window generation unit  generates the child window  containing the generated drawing data , and the window display processing unit  displays the child window  on the display device  (S).","On the other hand, if the result of the detection in S is that a moving image object has been detected (YES in S), the type determination unit of the PC  performs a determination (a second determination) of the type of each of the detected one or more moving image objects (S). Then, playback (movement) of a moving image is suspended depending on the type determined (S).","Once the playback of the moving image has been suspended, the structured document drawing unit  of the PC  generates drawing data from a still image of each moving image object in the suspended state while changing the drawing method depending on the type of each moving image object (S). For example, in the case of the structured document shown in  above, drawing data in the vector format is generated for the moving image object , and drawing data in the raster format is generated for the moving image object . The structured document drawing unit  creates the drawing data  in the vector format for a region other than the moving image objects (a region that can be drawn in the vector format) (S). At this time, if this region contains a bitmap image, the drawing data is created with the bitmap image portion remaining as is, that is, as the bitmap image.","Afterward, the structured document drawing unit  of the PC  combines the drawing data in the raster format or the vector format that has been generated by the processing in S with the drawing data that has been generated by the processing in S (S). Then, the window generation unit  of the PC  generates the child window  containing the generated drawing data , and the window display processing unit  displays the child window  on the display device  (S). It should be noted that the processing from S to S is repeatedly performed after the child window has been displayed until a print instruction is provided (until the \u201cPrint\u201d button is pressed). That is to say, playback and (temporary) suspension of a moving image object is repeated at constant time intervals to create drawing data of frames (still images) of the moving image object that are displayed at points in time when the moving image object is suspended. The created drawing data is drawn on the child window.","It should be noted that the drawing data drawn on the child window in S contains all the objects within the web page. In the drawing data drawn on the child window, data except the drawing data of the bitmap image and the moving image object that cannot be captured in the vector format is data captured as data in the vector format. The drawing data created by processing in this S serves as captured data containing the data in the vector format.","Now,  will be described. The selected region display processing unit  of the PC  displays the selected region  on the child window  that contains the result of drawing processing performed in the processing of S or S (S). As described above, the selected region  is a region that defines a range to be printed. It should be noted that in order to make it easy for the user to recognize the region, the color outside of the selected region  can be displayed in grayscale, for example.","Here, if a change in the range of the selected region  is instructed through an operation via the mouse or the like by the user (YES in S), the selected region display processing unit  of the PC  changes the range of the selected region  based on the instruction and displays the changed range (S). Moreover, if the \u201cPrint\u201d button  is pressed through an operation via the mouse or the like by the user (YES in S), the intermediate data generation unit  of the PC  creates the intermediate data  (S). More specifically, coordinates corresponding to the selected region  are specified from the drawing data , data of a portion corresponding to the specified coordinates is retrieved, and the intermediate data  is created based on the retrieved data. It should be noted that even though the drawing data may be scaled at this time according to the size of a printing medium to be used in printing or the content of print settings, deterioration of the image quality of the portion in the vector format will be reduced.","Afterward, the print control unit  of the PC  instructs the OS  to print the intermediate data  on the printer . Then, the OS  invokes the printer driver  for the printer  and causes the printer driver  to convert the intermediate data  to a print command and spool the print command to the spooler of the OS . Then, the OS  transmits the print command to the printer  (S). Thus, the printer  performs printing based on the intermediate data .","As described above, according to the present embodiment, when outputting a web page as data in the vector format, even if the web page contains a moving image object whose drawing data cannot be generated in the vector format, the moving image object is prevented from going missing. Moreover, according to the present embodiment, drawing data is generated while changing the drawing method depending on the type of moving image object in a structured document.","Thus, it is possible to output an image showing the moving image object contained in the web page irrespective of the type of the moving image object. Moreover, it is possible to select any desired region in the web page and print the selected region.","Moreover, although the foregoing description has assumed that the region to be printed is freely designated by the user, the region to be printed may be a predetermined fixed range or may be the full range. Furthermore, although a case where the above-described processing is performed by the plug-in module added to the browser  has been described in the foregoing description, this is not a limitation, and it is also possible that the browser  itself has an equivalent function.","Moreover, the same processing as the processing described above is applicable not only to a moving image object contained in a web page but also to moving image objects displayed in various types of applications.","Moreover, although a case of printing a content containing a moving image object has been described in the foregoing description, printing may be replaced by the following processing. That is to say, it is also possible to capture data in the vector format (excluding a bitmap image portion and a moving image portion that cannot be subjected to drawing processing in the vector format) and store the captured data in a hard disk or the like as a file. Moreover, at this time, it is also possible to convert the captured data to another format before storing it as a file.","Moreover, although a case where Windows (registered trademark) of Microsoft Corporation is used as the OS has been described in the foregoing description, this is not a limitation. For example, the present invention is also applicable to cases where various types of OSs are used, such as the case where Quartz of Mac OS of Apple Inc. in the U.S. is used instead of GDI of Windows (registered trademark).","Although an example of exemplary embodiments of the present invention has been described, the present invention is not limited to the embodiment described above and illustrated in the drawings, and modifications can be made as appropriate without departing from the gist of the invention.","Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment, and by a method, the S of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment. For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable storage medium).","Moreover, this program may be executed by a single computer or may be executed by a plurality of computers operating in conjunction with each other. Furthermore, it is not necessarily required that the entire processing described above be realized by software, and the processing may be realized partly or entirely by hardware.","While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.","This application claims the benefit of Japanese Patent Application No. 2010-162210 filed on Jul. 16, 2010, which is hereby incorporated by reference herein in its entirety."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate an embodiment of the invention, and together with the description, serve to explain the principles of the invention.",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 2","FIG. 1"],"b":"10"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3","b":"10"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4","b":"16"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5","b":"16"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6","b":"16"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIGS. 7A and 7B","b":"16"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 8","FIG. 1"],"b":"10"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 9","FIG. 1"],"b":"10"}]},"DETDESC":[{},{}]}
