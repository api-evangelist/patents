---
title: Method and apparatus for constructing a speech filter using estimates of clean speech and noise
abstract: A method and apparatus identify a clean speech signal from a noisy speech signal. To do this, a clean speech value and a noise value are estimated from the noisy speech signal. The clean speech value and the noise value are then used to define a gain on a filter. The noisy speech signal is applied to the filter to produce the clean speech signal. Under some embodiments, the noise value and the clean speech value are used in both the numerator and the denominator of the filter gain, with the numerator being guaranteed to be positive.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07725314&OS=07725314&RS=07725314
owner: Microsoft Corporation
number: 07725314
owner_city: Redmond
owner_country: US
publication_date: 20040216
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS","Joint Model for Speech and Noise","ML Estimation of Noise Distribution","MMSE Estimation of Clean Speech and Noise","Simplified Determination of Model Parameters and Estimates of Clean Speech and Noise"],"p":["The present invention relates to speech processing. In particular, the present invention relates to speech enhancement.","In speech recognition, it is common to enhance the speech signal by removing noise before performing speech recognition. Under some systems, this is done by estimating the noise in the speech signal and subtracting the noise from the noisy speech signal. This technique is typically referred to as spectral subtraction because it is performed in the spectral domain.","Since it is impossible to estimate the noise in a speech signal perfectly, any estimate that is used in spectral subtraction will have some amount of error. Because of this error, it is possible that the estimate of the noise in the noisy speech signal will be larger than the noisy speech signal for some frames of the signal. This would produce a negative value for the \u201cclean\u201d speech, which is physically impossible.","To avoid this, spectral subtraction systems rely on a set of parameters that are set by hand to allow for maximum noise reduction while ensuring a stable system. Relying on such parameters is undesirable since they are typically noise-source dependent and thus must be hand-tuned for each type of noise-source.","Other systems attempt to enhance the speech signal using a Wiener filter to filter out the noise in the speech signal. In such systems, the gain of the Wiener filter is generally based on a signal-to-noise ratio. To arrive at the proper gain value, the level of the noise in the signal must be determined.","One common technique for determining the level of noise is to estimate the noise during non-speech segments in the speech signal. This technique is less than desirable because it not only requires a correct estimate of the noise during the non-speech segments, it also requires that the non-speech segments be properly identified as not containing speech. In addition, this technique depends on the noise being stationary (non-changing). If the noise is changing over time, the estimate of the noise will be wrong and the filter will not perform properly.","Another system for enhancing speech attempts to identify a clean speech signal using a probabilistic framework that provides a Minimum Mean Square Error (MMSE) estimate of the clean signal given a noisy speech signal. Unfortunately, such systems can provide poor estimates of the clean speech signal at times, especially when the signal-to-noise ratio is low. As a result, using the clean speech estimates directly in speech recognition can result in poor recognition accuracy.","Thus, a system is needed that does not require as much hand-tuning of parameters as in spectral subtraction while avoiding the poor estimates that sometimes occur in MMSE estimation.","A method and apparatus identify a clean speech signal from a noisy speech signal. To do this, a clean speech value and a noise value are estimated from the noisy speech signal. The clean speech value and the noise value are then used to define a gain on a filter. The noisy speech signal is applied to the filter to produce the clean speech signal. Under some embodiments, the noise value and the clean speech value are used in both the numerator and the denominator of the filter gain, with the numerator being guaranteed to be positive.",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well-known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, telephony systems, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention is designed to be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules are located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general-purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  is operated in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.","The present invention provides a method and apparatus for enhancing a speech signal.  provides a block diagram of the system and  provides a flow diagram of the method of the present invention.","At step , a noisy analog signal  is converted into a sequence of digital values that are grouped into frames by a frame constructor . Under one embodiment, the frames are constructed by applying analysis windows to the digital values where each analysis window is a 25 millisecond hamming window, and the centers of the windows are spaced 10 milliseconds apart.","At step , a frame of the digital speech signal is provided to a Fast Fourier Transform  to compute the phase and magnitude of a set of frequencies found in the frame. The magnitude or the square of the magnitude of each FFT is then selected\/determined by block  at step .","At step , the magnitude values are optionally applied to a Mel-scale filter bank , which applies perceptual weighting to the frequency distribution and reduces the number frequency bins that are associated with the frame. The Mel-scale filter bank is an example of a frequency-based transform. In such transforms, the level of filtering applied to a frequency is based on the identity of the frequency or the magnitudes of the frequencies are scaled and combined to form fewer parameters. Thus, in , if the frequency values are not applied to the Mel-scale filter bank, they are not applied to a frequency-based transform.","A log function  is applied to the values from magnitude block  or Mel-Scale filter bank  (if the filter bank is used) at step  to compute the logarithm of each frequency magnitude.","At step , the logarithms of each frequency are applied to a discrete cosine transform (DCT)  to form a set of values that are represented as an observation feature vector. If the Mel-scale filter bank was used, the observation vector is referred to as a Mel-Frequency Cepstral Coefficient (MFCC) vector. If the Mel-scale filter bank was not used, the observation vector is referred to as a High Resolution Cepstral Coefficient (HRCC) vector, since it retains all of the frequency information from the input signal.","The observation feature vector is applied to a maximum likelihood (ML) estimation block  at step . ML estimation block  builds a maximum likelihood estimation of a noise model based on a sequence of observation feature vectors that represent an utterance, typically a sentence. Under one embodiment, this noise model is a single Gaussian distribution that is described by its mean and covariance.","The noise model and the observation feature vectors are provided to a clean speech and noise estimator  together with parameters  that describe a prior clean speech model. Under one embodiment the prior clean speech model is a Gaussian Mixture Model that is defined by a mixture weight, a mean, and a covariance for each of a set of mixture components. Using the model parameters for the clean speech and the noise, estimator  generates an estimate of a clean speech value and a noise value for each frame of the input speech signal at step . Under one embodiment, the estimates are Minimum Mean Square Error (MMSE) estimates that are computed as:",{"@attributes":{"id":"p-0040","num":"0039"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mover":{"mi":"x","mo":"^"},"mi":"t"},"mo":"=","mrow":{"mo":"\u222b","mrow":{"mi":"xp","mo":"(","mrow":{"mi":"x","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"mrow":{"msub":[{"mi":["y","t"]},{"mi":["\u039b","x"]},{"mi":["\u039b","n"]}],"mo":[",",","]}},{"mo":"\u2146","mi":"x"}]}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"1"}}]},{"mtd":[{"mrow":{"msub":{"mover":{"mi":"n","mo":"^"},"mn":"1"},"mo":"=","mrow":{"mo":"\u222b","mrow":{"mi":"np","mo":"(","mrow":{"mi":"n","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"mrow":{"msub":[{"mi":["y","t"]},{"mi":["\u039b","x"]},{"mi":["\u039b","n"]}],"mo":[",",","]}},{"mo":"\u2146","mi":"n"}]}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"2"}}]}]}}},"br":{},"sub":["t ","t ","t ","n ","x "]},"At steps , the clean speech estimate and the noise estimate, which are in the cepstral domain, are applied to an inverse discrete cosine transform . The results of the inverse discrete cosine transform are applied to an exponential function  at step . This produces spectral values for the clean speech estimate and the noise estimate.","At step , the spectral values for the clean speech estimate and the noise estimate are smoothed over time and frequency by a smoothing block . The smoothing over time involves smoothing each frequency value in the spectral values across different frames of the speech signal. Under one embodiment, the smoothing over frequency involves averaging values of neighboring frequency bins within a frame and placing the average value at a frequency position that is in the center of the frequency bins used to form the average value.","The smoothed spectral values for the estimate of the clean speech signal and the estimate of the noise are then used to determine the gain for a Wiener filter  at step . Under one embodiment, the gain of the Wiener filter is set as:",{"@attributes":{"id":"p-0044","num":"0043"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"mi":"H","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","f"],"mo":","}}}},"mo":"=","mfrac":{"mrow":[{"msup":{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mover":{"mi":"P","mo":"^"},"mi":"x"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","f"],"mo":","}}}},"mn":"2"},"mo":"+","mrow":{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"-","mi":"\u03b1"}},"mo":"\u2062","msup":{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mover":{"mi":"P","mo":"^"},"mi":"n"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","f"],"mo":","}}}},"mn":"2"}}},{"msup":[{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mover":{"mi":"P","mo":"^"},"mi":"x"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","f"],"mo":","}}}},"mn":"2"},{"mrow":{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mover":{"mi":"P","mo":"^"},"mi":"n"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","f"],"mo":","}}}},"mn":"2"}],"mo":"+"}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"3"}}]}}}},"br":{},"sub":["x","n","x","n"],"sup":["2 ","2 ","2 ","2"]},"In Equation 3, actual estimates of the noise and clean speech are used in the denominator. In addition, the estimate of the noise in the numerator is multiplied by the factor 1-\u03b1 such that the product is always guaranteed to be positive. This ensures that the gain will be positive regardless of the value estimated for the noise. This makes the system of the present invention much more stable than spectral subtraction systems and does not require the setting of as many parameters as spectral subtraction.","Once the filter gain has been determined at step , the power spectrum of the noisy frequency domain values produced by magnitude block  or Mel-Scale filter bank  is applied to the Wiener filter at step  to produce a filtered clean speech power spectrum. Specifically:\n\n()|()|()|\u2003\u2003EQ. 4\n\nwhere |H(t, f)| is the gain of the Wiener filter, |{tilde over (P)}(t, f)|is the filtered clean speech power spectrum, and |P(t, f)|is the power spectrum of the noisy speech signal.\n","At step , the filtered clean speech power spectrum  can be used to generate a clean speech signal that is to be heard by a user or it can be applied to a feature extraction unit , such as a Mel-Frequency Cepstral Coefficient feature extraction unit, as pre-processing for speech recognition.","It is assumed that the speech and noise waveforms mix linearly in the time domain. As a result of this assumption, it is common to model the noisy cepstral features y as a first order Taylor series in x and n.",{"@attributes":{"id":"p-0049","num":"0048"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"y","mo":"=","mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"x","mn":"0"},{"mi":"n","mn":"0"}],"mo":","}}},{"mrow":[{"mi":"G","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"x","mn":"0"},{"mi":"n","mn":"0"}],"mo":","}}},{"mo":["(",")"],"mrow":{"mi":"x","mo":"-","msub":{"mi":"x","mn":"0"}}}],"mo":"\u2062"},{"mrow":[{"mo":["(",")"],"mrow":{"mi":"I","mo":"-","mrow":{"mi":"G","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"x","mn":"0"},{"mi":"n","mn":"0"}],"mo":","}}}}},{"mo":["(",")"],"mrow":{"mi":"n","mo":"-","msub":{"mi":"n","mn":"0"}}}],"mo":"\u2062"}],"mo":["+","+","+"],"mi":"\u025b"}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"5"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"A","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","n"],"mo":","}}},{"mi":"C","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"log","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}},"mo":"\u2062","mi":"x"}}},{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}},"mo":"\u2062","mi":"n"}}}],"mo":"+"}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"6"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"G","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","n"],"mo":","}}},{"mi":"C","mo":["\u2062","\u2062"],"mfrac":{"mn":"1","mrow":{"mrow":{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["n","x"],"mo":"-"}}}}},"mo":"+","mn":"1"}},"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"7"}}]}]}}}},"The symbol I denotes the identity matrix. From now on, we will use the shorthand notation A=A(x,n) and G=G(x,n). In practice, it is useful to set all of the off-diagonal elements of Gto zero. This reduces computational requirements drastically, while introducing a slight increase in distortion.","Assuming the residual error term \u03b5 is an independent Gaussian, this induces a Gaussian probability distribution on y given x and n.\n\n()=(,\u03a3)\u2003\u2003EQ. 8\n\n\u03bc()+()()\u2003\u2003EQ. 9\n","Before using this model to enhance speech, it is necessary to add a prior model for speech, \u039b, and a prior model for noise, \u039b. Under one embodiment of the present invention, the prior model for speech is a Gaussian mixture model, and the prior model for noise is a single Gaussian component:\n\n()=((),\u03a3())\u2003\u2003EQ. 10\n\n()=(,\u03a3)\u2003\u2003EQ. 11\n","Finally, the joint model of noisy observation, clean speech, noise, and speech state is:\n\n(,\u039b)=()()()\u2003\u2003EQ. 12\n","The joint model of equation 12 can be manipulated to produce several formulae useful in estimating clean speech, noise, and speech state from the noisy observation.","First, the clean speech state can be inferred as:\n\n()=((),\u03a3())\u2003\u2003EQ. 13\n\n\u03bc()=(()\u2212)+()()\u2003\u2003EQ. 14\n\n\u03a3()=()\u03a3()\u2032+\u03a3\u2032+\u03a3\u2003\u2003EQ. 15\n","Second, the clean speech vector can be inferred as:\n\n()=((),\u03a3())\u2003\u2003EQ. 16\n\n\u03bc()=()+(\u03a3())\u03a3()(())\u2003\u2003EQ. 17\n\n\u03a3()=(\u03a3())(()\u03a3()\u2032+\u03a3)\u03a3()\u2003\u2003EQ. 18\n","Third, the noise vector can be inferred as:\n\n()=(()\u03a3())\u2003\u2003EQ. 19\n\n\u03bc()=+(\u03a3())()\u03a3(())\u2003\u2003EQ. 20\n\n\u03a3()=(\u03a3())(\u03a3()\u2032+\u03a3)\u03a3\u2003\u2003EQ. 21\n","Step , in which a Maximum Likelihood estimate of the noise distribution is determined, involves identifying parameters, \u039b, that maximize the joint probability P(Y,X,N,I|\u039b,\u039b) given yand \u039b, where Y is the sequence of observation vectors, X is the sequence of clean speech vectors, N is the sequence of noise vectors, I is the sequence of mixture component indices, \u039brepresents the parameters of the clean speech model, which consist of mixture component weights c, mixture component means m(i), and mixture component covariances \u03a3(i), and \u039brepresents the parameters of the noise model, which consist of a mean mand a covariance \u03a3.","Under one embodiment of the present invention, an iterative Expectation-Maximization algorithm is used to identify the parameters of the noise model. Specifically, the parameters are updated during the M-step of the EM algorithm as:",{"@attributes":{"id":"p-0060","num":"0059"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mover":{"mi":"m","mo":"^"},"mi":"n"},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"msub":{"mi":"\u03bc","mrow":{"mi":["n","y"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}],"mo":"\u2062"}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}}}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"22"}}]},{"mtd":[{"mrow":{"mover":{"munder":{"mo":"\u2211","mi":"n"},"mo":"^"},"mo":"\u2062","mrow":{"mo":"=","mrow":{"mi":"diag","mo":["[","]"],"mrow":{"mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"mrow":[{"mrow":{"msub":{"mi":"\u03bc","mrow":{"mi":["n","y"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},"mo":"\u2062","msup":{"mrow":{"msub":{"mi":"\u03bc","mrow":{"mi":["n","y"],"mo":"\u2758"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},"mi":"\u2032"}},{"munder":{"mo":"\u2211","mrow":{"mi":"n","mo":"\u2758","msub":{"mi":"y","mn":"1"}}},"mo":"\u2062","mrow":{"mo":["(",")"],"mi":"i"}}],"mo":"+"}],"mo":["[","]"]}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}}}}]},"mo":"-","mrow":{"msub":{"mover":{"mi":"m","mo":"^"},"mi":"n"},"mo":"\u2062","msubsup":{"mover":{"mi":"m","mo":"^"},"mi":["n","\u2032"]}}}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"23"}}]}]}}},"br":{},"sub":["n ","n ","n ","t","n|y","n|y",{"sub2":"t"}]},"The covariance matrix, \u03a3, of the residue error can be derived with an iterative EM process by:",{"@attributes":{"id":"p-0062","num":"0061"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mover":{"munder":{"mo":"\u2211","mi":"\u025b"},"mo":"^"},"mo":"\u2062","mrow":{"mo":"=","mrow":{"mi":"diag","mo":["[","]"],"mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"mo":["{","}"],"mrow":{"mrow":{"mrow":{"msub":{"mi":["\u025b","t"]},"mo":"\u2062","msubsup":{"mi":["\u025b","t","\u2032"]}},"mo":"\u2758","msub":{"mi":["y","t"]}},"mo":",","mi":"i"}}],"mo":["\u2062","\u2062"],"mi":"E"}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}}}}]}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"24"}}]}}}},"br":{},"sub":["t","t","t"]},{"@attributes":{"id":"p-0063","num":"0062"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mover":{"munder":{"mo":"\u2211","mi":"\u025b"},"mo":"^"},"mo":"\u2062","mrow":{"mi":"max","mo":["(",")"],"mrow":{"mn":"0","mo":",","mrow":{"munder":{"mo":"\u2211","mi":"\u025b"},"mo":"\u2062","mrow":{"mo":"+","mrow":{"mi":"diag","mo":["[","]"],"mfrac":{"mrow":[{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"mo":["(",")"],"mrow":{"msub":{"mi":["y","t"]},"mo":"-","mrow":{"msub":{"mi":["\u03bc","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}}],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mtext":"["},"msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["y","t"]},"mo":"-","mrow":{"msub":{"mi":["\u03bc","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}},"mi":"\u2032"}}}},{"munder":{"mo":"\u2211","mi":"y"},"mo":"\u2062","mrow":{"mo":["(",")"],"mi":"i"}}],"mo":"-"},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}}}}]}}}}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"25"}}]}}}},"br":{}},"The convergence of equations 22 and 23 becomes very slow if \u03a3is small. Under one embodiment, this is overcome by maximizing P(Y,I|\u039b\u039b) instead of P(Y,X,N,I|\u039b\u039b). By setting the derivative of the corresponding auxiliary function with respect to mto zero, the update for the mean becomes:",{"@attributes":{"id":"p-0065","num":"0064"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mover":{"mi":"m","mo":"^"},"mi":"n"},"mo":"=","mrow":{"msub":{"mi":["m","n"]},"mo":"+","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"mo":["(",")"],"mrow":{"mi":"I","mo":"-","msub":{"mi":"G","mn":"0"}}},{"munderover":{"mo":"\u2211","mi":"y","mrow":{"mo":"-","mn":"1"}},"mo":"\u2062","mrow":{"mrow":[{"mo":["(",")"],"mi":"i"},{"mo":["(",")"],"mrow":{"msub":{"mi":["y","t"]},"mo":"-","mrow":{"msub":{"mi":["\u03bc","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}}],"mo":"\u2062"}}],"mo":["\u2062","\u2062"]}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"\u2758","msub":{"mi":["y","t"]}}}},{"mo":["(",")"],"mrow":{"mi":"I","mo":"-","msub":{"mi":"G","mn":"0"}}},{"munderover":{"mo":"\u2211","mi":"y","mrow":{"mo":"-","mn":"1"}},"mo":"\u2062","mrow":{"mo":["(",")"],"mi":"i"}}],"mo":["\u2062","\u2062"]}}}]}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"26"}}]}}}}},"The update for the covariance {circumflex over (\u03a3)}remains the same as shown in Equation 23. Note that in Equation 26, the covariance of the noise model \u03a3has been removed from the numerator, making the update converge faster if the covariance \u03a3is small.","Once the noise model has been constructed, an estimate of the noise for each frame is computed as:",{"@attributes":{"id":"p-0068","num":"0067"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mover":{"mi":"n","mo":"^"},"mi":"i"},"mo":"=","mrow":{"mo":"\u222b","mrow":{"mi":"np","mo":"(","mrow":{"mrow":[{"mi":"n","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["y","t"]}},{"mo":"\u2146","mi":"n"}]},{"mrow":[{"mo":["\u2003","\u2003"]},{"munderover":{"mo":"\u2211","mi":"i","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"p","mo":"(","mrow":{"mi":"i","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["y","t"]}},{"mo":"\u222b","mrow":{"mrow":[{"mi":"np","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"n","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"mrow":{"msub":{"mi":["y","t"]},"mo":",","mi":"i"}},{"mo":"\u2146","mi":"n"}]},{"munderover":{"mo":"\u2211","mi":"i","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":["p","i"],"mo":["(","\uf604"]},"mo":"\u2062","msub":{"mi":["y","t"]}}}],"mo":"="}}},{"msub":{"mi":"\u03bc","mrow":{"mi":"n","mo":"\u2062","mrow":{"mo":"\uf603","mi":"y"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}],"mo":"\u2062"}}]}}}],"mo":"\u2062"}],"mo":"="}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"27"}}]}}}},"br":{}},{"@attributes":{"id":"p-0069","num":"0068"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mover":{"mi":"x","mo":"^"},"mn":"1"},"mo":"=","mrow":{"munderover":{"mo":"\u2211","mi":"i","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"p","mo":"(","mrow":{"mi":"i","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["y","t"]}},{"msub":{"mi":"\u03bc","mrow":{"mi":"x","mo":"\u2062","mrow":{"mo":"\uf603","mi":"y"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}]}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"28"}}]}}}}},"Under one embodiment, the ML computations and the noise and clean speech estimations described above are simplified. A flow diagram of the simplified technique is shown in .","At step  of , an observation vector for a frame is selected. At step , the posterior probability p(i|y) for each mixture component i is computed. The mixture component with the highest posterior probability is then selected at step . Instead of using all of the mixture components in computing the noise estimate, only the selected mixture component is used.","At step , a variable ddnxis initialized for the frame. This variable is defined as:\n\n=(())\u2212(())\u2003\u2003EQ. 29\n\nHowever, it is not computed explicitly using this definition.\n","For the first frame, ddnxis initialized to zero. For each subsequent frame, the initial value for ddnxis set to the value in the past frame plus the difference between the mean of the posterior of the selected mixture component in the current frame and the mean of the posterior of the selected mixture component in the past frame. Note that different mixture components may be selected in different frames.","After ddnxhas been initialized, it is iteratively updated at steps  and  using an update equation of:\n\n=(\u03a3())(()\u03a3\u03a3())(())\u2003\u2003EQ. 30\n","After a desired number of iterations have been performed at step  (in one embodiment four iterations are used), the process continues at step  where the value for ddnxis used to compute the clean speech and noise estimates for the frame according to the above equations, where Gcan be computed from ddnxaccording to equation 31, and equation 14 is modified according to equation 32.",{"@attributes":{"id":"p-0076","num":"0075"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mi":"G","mn":"0"},"mo":"=","mrow":{"mi":"C","mo":["\u2062","\u2062"],"mfrac":{"mn":"1","mrow":{"mrow":{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["d","d","n"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mi":"x","mn":"0"}},{"mo":["(",")"],"mrow":{"msub":{"mi":["m","n"]},"mo":"-","mrow":{"msub":{"mi":["m","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}}],"mo":"+"}}}}},"mo":"+","mn":"1"}},"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"31"}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03bc","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},{"mrow":[{"msub":{"mi":["m","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},{"mi":"C","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"log","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"+","mrow":{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msup":{"mi":"C","mrow":{"mo":"-","mn":"1"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":["d","d","n"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mi":"x","mn":"0"}},{"mo":["(",")"],"mrow":{"msub":{"mi":["m","n"]},"mo":"-","mrow":{"msub":{"mi":["m","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}}],"mo":"+"}}}}}}}}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"I","mo":"-","msub":{"mi":"G","mn":"0"}}},"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mi":["d","d","n"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mi":"x","mn":"0"}}],"mo":["+","-"]}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"32"}}]}]}}}},"After the clean speech and noise estimates have been determined for the frame, the method determines if there are more frames to process at step . If there are more frames, the method returns to step  to select the next frame. If the last frame has been processed, the method ends after step .","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
