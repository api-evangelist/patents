---
title: Storage of advanced video coding (AVC) parameter sets in AVC file format
abstract: There is provided a method for employing Parameter Set information corresponding to an Advanced Video Coding (AVC) file. The method includes the step of embedding the Parameter Set information into a Hint Track of the AVC file.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08879641&OS=08879641&RS=08879641
owner: Thomson Licensing
number: 08879641
owner_city: Boulogne-Billancourt
owner_country: FR
publication_date: 20040210
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"p":["This application claims the benefit, under 35 U.S.C. \u00a7365 of International Application PCT\/US2004\/003,883, filed Feb. 10, 2004, which was published in accordance with PCT Article 21(2) on Sep. 22, 2005 in English.","1. Field of the Invention","The present invention generally relates to the Advanced Video Coding (AVC) file format and, more particularly, to the storage of AVC Parameter Sets in the AVC file format.","2. Background of the Invention","The Advanced Video Coding (AVC) file format provides support for both streaming media data over a network as well as local playback. The most common streaming servers use the Real Time Streaming Protocol (RTSP) along with the Session Description Protocol (SDP) as a control protocol for the set up and teardown of multimedia streaming sessions between clients and servers. Further, the Real Time Transport Protocol (RTP) is used as the protocol for data transport for the multimedia information between the servers and clients.","An AVC codec provides a means for decoupling specific information from the video stream that is relevant for more than one video frame. It is intended that this specific information be sent over a reliable transport protocol (such as, e.g., Transmission Control Protocol (TCP)), in addition to being sent over an unreliable transport protocol (such as, e.g., User Datagram Protocol (UDP)), embedded within the multimedia stream. This specific information combined together form a Parameter Set. An AVC Parameter Set may include information such as, for example: picture or image size; display window size; macro block allocation map; and so forth.","One or many Parameter Sets may exist for any given AVC video stream. The encoder and decoder should maintain an identical list of the Parameter Sets. Each slice header within the AVC video stream includes a code that indicates the Parameter Set to be used when decoding. Based on this code, the decoder can then determine which Parameter Set to use for proper decoding. Since the Parameter Sets are decoupled from the main video stream, it is possible and desirable to send them from a multimedia streaming server to a multimedia streaming client in an out-of-band fashion.","A description of a typical scenario of a streaming multimedia transaction will now be given. When a multimedia streaming client requests streaming multimedia from a server, an initial negotiation is typically done prior to the streaming. The initial negotiation sequence involves the client sending a request to the server to obtain information about a particular stream. Afterwards, the server sends a response to the client with the minimal necessary details required for receiving and decoding the stream. This initial negotiation is commonly done using a network protocol such as the Real Time Streaming Protocol (RTSP). The RTSP protocol can be used to send the Parameter Sets from the multimedia streaming server to the multimedia streaming client. However, due to the nature of the streaming server, for the streaming server to send the media dependent data to the client, the Parameter Sets must be stored in the file in a manner such that the streaming server does not know or care what type of multimedia file it is.","Accordingly, it would be desirable and highly advantageous to have a method for enabling the RTSP protocol of the multimedia streaming server to transport Parameter Sets in a media independent manner to the client.","The problems stated above, as well as other related problems of the prior art, are solved by the present invention, a method for storing AVC Parameter Sets in the AVC file format. The present invention provides an extension to the AVC file format for the purpose of storing enhanced metadata to improve streaming services. The extension involves inserting AVC Parameter Sets into the Hint Track metadata of the AVC file format while still being able to provide backwards compatibility with existing streaming servers.","According to an aspect of the present invention, there is provided a method for employing Parameter Set information corresponding to an Advanced Video Coding (AVC) file. The method includes the step of embedding the Parameter Set information into a Hint Track of the AVC file.","According to another aspect of the present invention, there is provided an apparatus for employing Parameter Set information corresponding to an Advanced Video Coding (AVC) file. The apparatus includes an embedding device for embedding the Parameter Set information into a Hint Track of the AVC file.","According to yet another aspect of the present invention, there is provided a method for employing Parameter Set information corresponding to an Advanced Video Coding (AVC) file. The method includes the steps of embedding the Parameter Set information into a Hint Track of the AVC file, and transmitting the Parameter Set information in an out of band and media independent transmission.","These and other aspects, features and advantages of the present invention will become apparent from the following detailed description of preferred embodiments, which is to be read in connection with the accompanying drawings.","The present invention is directed to an extension to the AVC file format, a commonly known streaming digital media storage format, for the purpose of storing enhanced metadata to improve streaming services. The extension involves inserting AVC Parameter Sets into the Hint Track metadata of the AVC file format while still being able to provide backwards compatibility with existing streaming servers. The Parameter Sets are embedded within the AVC file format Hint Track such that the RTSP protocol of the multimedia streaming server is able to transport the Parameter Sets in a media independent fashion to the client.","It is to be appreciated that the present invention generally relates to the Advanced Video Coding (AVC) file format (International Organization for Standardization\/International Electrotechnical Commission (ISO\/IEC) 14496, Part 15), jointly developed by the International Telecommunication Union (ITU) and the Moving Pictures Experts Group (MPEG). However, given the teachings of the present invention provided herein, one of ordinary skill in the related art will contemplate this and various other file formats to which the present invention may be applied while maintaining the spirit and scope of the present invention.","It is to be understood that the present invention may be implemented in various forms of hardware, software, firmware, special purpose processors, or a combination thereof. Preferably, the present invention is implemented as a combination of hardware and software. Moreover, the software is preferably implemented as an application program tangibly embodied on a program storage device. The application program may be uploaded to, and executed by, a machine comprising any suitable architecture. Preferably, the machine is implemented on a computer platform having hardware such as one or more central processing units (CPU), a random access memory (RAM), and input\/output (I\/O) interface(s). The computer platform also includes an operating system and microinstruction code. The various processes and functions described herein may either be part of the microinstruction code or part of the application program (or a combination thereof) that is executed via the operating system. In addition, various other peripheral devices may be connected to the computer platform such as an additional data storage device and a printing device.","It is to be further understood that, because some of the constituent system components and method steps depicted in the accompanying Figures are preferably implemented in software, the actual connections between the system components (or the process steps) may differ depending upon the manner in which the present invention is programmed. Given the teachings herein, one of ordinary skill in the related art will be able to contemplate these and similar implementations or configurations of the present invention.","The AVC file format provides support for both streaming media data over a network as well as local playback. An AVC file that supports streaming multimedia includes additional information about the data units to stream. This additional information is included in additional tracks of the file known as Hint Tracks. A Hint Track provides streaming instructions to a server such as, for example, packet formatting information to ensure suitable delivery and timing information to ensure proper transmission timing. In additional, a Hint Track may also provide more information such as details on the type of media that the client is requesting, which then may be sent to the client during an initial interaction between the client and server.","The most common streaming servers use the Real Time Streaming Protocol (RTSP) along with the Session Description Protocol (SDP) as a control protocol for the set up and teardown of multimedia streaming sessions between clients and servers. Further, the Real Time Transport Protocol (RTP) is used as the protocol for data transport for the multimedia information between the servers and clients. It is to be appreciated that the present invention is directed towards streaming servers that use RTSP as their control protocol for session establishment. Of course, one of ordinary skill in the related art will readily appreciate that the present invention may also be modified and implemented with respect to streaming servers that use a protocol other than RTSP as their control protocol, while maintaining the spirit and scope of the present invention.","RTSP is a text-based protocol where messages include a header and payload. The header is commonly defined by the standard, whereas portions of the payload can be application dependent. In the case of an RTSP based multimedia streaming server, the server by default inserts Session Description Protocol (SDP) information included within the AVC file into the RTSP message during initial media streaming negotiation with a client. Therefore, by embedding the AVC Parameter Sets within the SDP information, it is possible for the server to transmit the Parameter Sets of the media stream to the client without having knowledge of the media format. As a result, the Parameter Sets are transmitted prior to any media, and in addition, they are transmitted using a reliable transport protocol since RTSP by default uses Transmission Control Protocol (TCP).",{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 1","b":["100","100","160","165","170","175","100","110","120","130","130"]},"The Hint Tracks  within the AVC file  include special instructions for a streaming server to assist in the formation of packets. This information is provided in such a way that a server is able to packetize the media data in the manner suitable for streaming using a specific network transport. In addition to the inclusion of special streaming instructions, other data may be embedded within the Hint Track that the server is instructed to send immediately to the client (for example and in accordance with the present invention, the other data may include Parameter Sets).","The process of storing AVC parameter Sets within the Hint Track of an AVC file will now be described.  is a diagram illustrating an Advanced Video Coding (AVC) video encoder  to which the present invention may be applied, according to an illustrative embodiment of the present invention. Initially, the AVC video encoder  will have at least one output interface for delivering the compressed video data and the corresponding metadata to a second module for storage purposes. Also included in  is a transmitter  for transmitting the Parameter Sets in an out-of-band transmission. The Parameter Sets are transmitted while embedded within the SDP payload of an AVC file.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 3","FIG. 2"],"b":["300","200","300","200","210","215","220","225","230","230","230","230"]},"When Parameter Sets  are part of the Metadata  output from the AVC video encoder, they are copied and stored in a repository for later referencing when the Hint Track is created. This allows the Hint Track creation to be more streamlined and straightforward because the media track does not need to be parsed beginning to end to find the Parameter Sets.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 4","b":["400","230","400","230","230","400","410","420","430"]},{"@attributes":{"id":"p-0037","num":"0036"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"v=0"]},{"entry":[{},"s=AVC Streaming Media Program"]},{"entry":[{},"u=http:\/\/"]},{"entry":[{},"e=admin @"]},{"entry":[{},"a=control:*"]},{"entry":[{},"a=range:npt=0 - 60.96"]},{"entry":[{},"m=video 0 RTP\/AVP 96"]},{"entry":[{},"a=rtpmap:96 AVC\/90000"]},{"entry":[{},"a=paramset:\u201ddata:video\/jvt;base64,MIME encoded Parameter Sets\u201d"]},{"entry":[{},"a=control:trackID=2"]},{"entry":[{},"m=audio 0 RTP\/AVP 14"]},{"entry":[{},"a=rtpmap:14 MPA\/22050"]},{"entry":[{},"a=control:trackID=6"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 5","b":["500","599","500","510","520","530","540","550","560","570"]},"Video data  and metadata  are received by the media and metadata manager . The media and metadata manager  ensures the file writing process is done properly and that the file is not written in an inconsistent manner. In most cases, the metadata  should reside within the file first, followed by the media data tracks and the hint tracks. Therefore, the media and metadata manager  is present to control the writing process.","There are three main writing modules (, , ) that interface to the generic file writing module . It may appear that each of these modules are sending data to the generic file writing simultaneously, but they are actually sending data to be written in a particular order (e.g., the order described above, that being metadata, media data, and hint data). These writing modules will now be further described with respect to .",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 6","FIG. 7","FIG. 8"]},"Referring to , metadata is input to the media and metadata manger . As is known, metadata is a set of data structures for storing media dependent information such as, but not limited to, timestamps, frame sizes, parameters sets, and so forth. Metadata is used, for example, to keep the corresponding media in synchronization with additional data for the purposes of, e.g., decoding, encoding, displaying, access, and transmission.","The media and metadata manager  extracts the metadata from the media and parses the metadata for Parameter sets (see ). Thus, if parameter sets are present in the metadata, the metadata parser  will extract the Parameter Sets and feed them into the Hint track's SDP data structure. Otherwise, when a Parameter Set is not found, the metadata parser  transforms the metadata into standardized data structures that provide a means for writing the information to a file. The metadata writing module  uses the Application Programming Interface (API) of the generic writing module  to write the metadata to the AVC file .","In , the media and metadata manager  extracts the media and the total size of the media. The data is then fed directly to the media writing module . The media writing module also uses the API of the generic writing module  to write the media samples to the AVC file .","Although the illustrative embodiments have been described herein with reference to the accompanying drawings, it is to be understood that the present invention is not limited to those precise embodiments, and that various other changes and modifications may be affected therein by one of ordinary skill in the related art without departing from the scope or spirit of the invention. All such changes and modifications are intended to be included within the scope of the invention as defined by the appended claims."],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 1","b":"100"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 2","b":"200"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 3","FIG. 2"],"b":["300","200"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 4","b":"400"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 5","b":["500","599"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
