---
title: Empirical database access adjustment
abstract: Computer implemented methods, apparati, and computer-readable media for empirically adjusting access to a database (). An apparatus embodiment comprises: coupled to the database (), a database discovery module () for determining authorized accesses to the database (); coupled to the database (), a command monitoring module () for monitoring actual accesses to the database (); and coupled to the database discovery module () and to the command monitoring module (), an analysis module () for comparing actual accesses with authorized accesses.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08266177&OS=08266177&RS=08266177
owner: Symantec Corporation
number: 08266177
owner_city: Mountain View
owner_country: US
publication_date: 20040316
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND ART","DISCLOSURE OF INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["Commonly assigned U.S. patent application Ser. No. 10\/612,198 filed Jul. 1, 2003, entitled \u201cReal-Time Training for a Computer Code Intrusion Detection System\u201d and commonly assigned U.S. patent application Ser. No. 10\/632,857 filed Jul. 31, 2003, entitled \u201cComputer Code Intrusion Detection System Based on Acceptable Retrievals\u201d are hereby incorporated by reference in their entireties into the present patent application.","This invention pertains to the field of thwarting intrusions to computer databases perpetrated by malicious attackers.","Databases are perhaps the most critical resource of an enterprise, and therefore it is of prime importance to secure them. Standard database products have access control interfaces for setting permissions on the defined tables and columns of the database. Such access control interfaces can allow, deny, or revoke permissions for a given user and for a given operation on each database table and column.","Databases are managed by database administrators (DBAs), who determine access control settings for the database by participating in the design and implementation of the applications using the database and\/or by reviewing suggestions made by the application developer or provider. The DBA obtains knowledge of users, groups, roles, and applications accessing the database. This information is not always readily and easily available.","In any case, the access control settings are configured on the basis of perceived application behavior, i.e., the application is expected to access specific parts of the database for specific operations, and as such, the DBA chooses to apply relevant access control settings. This process is complicated, since database applications are typically huge, with many components developed by large teams. Thus, to consolidate all the features to focus access to parts of the database for specific operations is almost impossible. As a result, it is often the case that unnecessarily loose (open) access control settings are applied to the database to account for the various unknowns.","These loose access control settings give rise to concerns that malicious individuals are thereby able to access parts of the database that could have been protected without disturbing access by benign individuals (or applications). They are not prevented from doing so by conventional techniques, since said access is within the bounds of permissible access settings as originally configured by the DBA.","What is needed is a solution for ensuring that minimal access control settings are applied to the database, so that each application can continue to function as usual, while avoiding loose settings.","Computer implemented methods, apparati, and computer-readable media for empirically adjusting access to a database (). An apparatus embodiment comprises: coupled to the database (), a database discovery module () for determining authorized accesses to the database (); coupled to the database (), command monitoring module () for monitoring actual accesses to the database (); and coupled to the database discovery module () and to the command monitoring module (), an analysis module () for comparing actual accesses with authorized accesses.","\u201cDatabase\u201d is used broadly herein to comprise any collection of data stored on any computer readable medium. A database normally comprises tables and columns, and is accessed by some query language such as SQL (Structured Query Language).","\u201cCoupled\u201d is used broadly herein to encompass any type of direct or indirect communicative coupling.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1","b":["1","1","15"]},"SQL  is the current standard version of SQL. It is published in many places, including on the World Wide Web. Each vendor of a database  tends to have its own flavor of SQL, a flavor compatible with SQL .","An example of a SQL command  is the SELECT command:","SELECT C1,C2 FROM T1,T2","In the above command, a user is attempting to select columns C1 and C2 from T1 and T2. Each of T1 and T2 can be a table or a view. (Views are discussed below.) Without additional information, we don't know whether C1 belongs to T1 or T2; and we don't know whether C2 belongs to T1 or T2.","GRANT, DENY, and REVOKE commands can be used to limit access database . Not every database vendor has a REVOKE command. For example, Oracle does not. In this case, DENY is used instead. Most access control modules  work on the basis that a DENY command overrides a GRANT command.","In the case where database  is not a relational database, the commands can be written in a language other than SQL, such as XML.","Database  may have associated therewith an internal audit table  and\/or an external database log file  for storing audit and\/or ancillary information pertaining to database . Database  is typically packaged within a dedicated computer known as a database server, which may also contain communications and other modules. The database server can contain more than one database .","Access control module  is a hardware, firmware, or software device that determines what users and operations can access the various tables and columns within database . Access control settings within module  can be set and\/or changed by a human database administrator (DBA) .","Database discovery module  and command monitoring module  are coupled to database . The purpose of database discovery module  is to i.) determine database  structure in terms of its tables and columns, and in terms of artifices (views, stored procedures, etc.) that manipulate the tables and columns, and ii.) determine (uncover) authorized (permitted) accesses to database . The purpose of command monitoring module  is to monitor actual accesses to database . Analysis module  is coupled to modules  and . The purpose of analysis module  is to compare actual database accesses with authorized accesses, and to make and implement appropriate decisions based upon the results of such comparisons. Module  can generate one or more third party reports . Storage area  is coupled to modules  and . The purpose of storage area  is to accumulate data generated by command monitoring module  during a training phase (observing step ). Storage area  may be part of monitoring module .","Modules - can be implemented in hardware, firmware, software, or any combination thereof. When implemented in software, modules - can reside on one or more computer-readable media, such as one or more hard disks, floppy disks, CDs, DVDs, etc.","Command monitoring module  is usually a sniffer, because a sniffer does not modify the input stream of data emanating from commands . Alternatively, monitoring module  can be a proxy. A proxy does affect the input stream, because the queries it receives must be rerouted to the database server. The inputs to module  are a plurality of commands .  illustrates n such commands, where n is a positive integer. Module  examines the data streams generated by commands  and extracts the relevant information therefrom. Module  decrypts commands  if commands  are encrypted.","A method embodiment of the present invention will now be described in conjunction with .","At step , authorized accesses of database  are discovered by database discovery module . An \u201cauthorized access\u201d comprises the following combination: the authorized database  (in those embodiments where the database server has more than one database), the authorized table, the authorized column, the authorized operation, and the authorized user. An individual record produced by database discovery module  can have the forms:","Permitted [database][table][operation][user]=0 or 1","Permitted[database][table][column][operation][user]=0 or 1","INSERT and DELETE permission settings are made only at the table level, not the column level. One cannot \u201cinsert\u201d or \u201cdelete\u201d an individual column as this is really an UPDATE operation. So, we will be granting\/denying INSERT and DELETE permissions only at the table level. SELECT and UPDATE permission settings can be made at a column granularity, or at a table granularity. Typically, we will be granting\/denying SELECT and UPDATE at the column level on a per user basis, unless all of the columns of a given table are granted\/denied for a given user for a SELECT or UPDATE, in which case we will do the granting\/denying at the table level.","A view V is a command  involving multiple tables. An example of a view V is:","CREATE V AS SELECT C1,C2 FROM T1,T2","The discovery step  ascertains the definitions of the views associated with database , i.e., discovery module  resolves the views into individual accessed tables and columns along with the operations used on them. Thus, for example, if a command  monitored during the observing step  is \u201cSELECT A from V\u201d, it is known what columns and tables within database  are implicated because discovery module  has determined this information.","A stored procedure is a procedure that is performed on the data within database . An example of a stored procedure SP is:","CREATE SP (X,Y) AS STORED PROCEDURE","In the above example, X and Y are parameters representing users, commands, tables, columns, dates, functions, constants, etc. Again, database discovery module  resolves (breaks down) each stored procedure into accessed tables and columns along with the operations used on them.","The database discovery module  must resolve (break down) any database  artifice that performs operations on database tables or columns in a \u201cblack box\u201d manner, as do views, stored procedures, user-defined functions, triggers, etc.","In addition to views and stored procedures, user-defined functions and triggers will also be \u201cdiscovered\u201d. In fact, any SQL entity that reads\/writes column values or table rows must be discovered. For example, min\/max column value checking can be specified using values from other columns. Also, there can be many levels of nesting. T1 (from the above SELECT example) can really be a view (V). But V itself might be composed of other views (and tables), ad infinitum.","Module  can be programmed to automatically determine the relevant information. Alternatively, or in addition to information determined automatically by module , a human such as DBA  can provide information to analysis module  regarding authorized combinations. This can be done, for example, if there are complicated views, stored procedures, etc., associated with database .","The information uncovered by database discovery module  is stored in a storage area, for later use by command monitoring module . The storage area can be part f database discovery module , or a separate module.","During the observing step (training phase) , command monitoring module  monitors incoming commands , keeping track (by means of updating storage area ) as to which users perform which operations on which tables and columns within database . There are four main operations that are tracked. SELECT is used to read a column value. UPDATE is used to modify (write) a column value. INSERT is used to insert a new row of column values into a table. DELETE is used to delete an existing row of column values from a table.","Monitoring module  first breaks down commands  into their constituent elements using information provided by database discovery module . For example, in the illustration given above, the command SELECT C1,C2 from T1,T2 is ambiguous in that it is not known a priori whether C1 belongs to T1 or T2, it is not known whether C2 belongs to T1 or T2, and it is not known whether T1 and T2 are tables or views. But this information is determined by database discovery module  in step , and command monitoring module  uses this information in step  to resolve the command and then store the observed combination in storage area . An entry in storage area  may have one of the forms:","Observed[database][table][operation][user]=0 or 1","Observed[database][table][column][operation][user]=0 or 1","The duration of the observing step  is normally defined in terms of a preselected time period. Alternatively, the duration of observing step  can be defined in terms of a preselected number of entries made to storage area . In either case, the duration of the observing step  should be sufficiently long that monitoring module resolves and records many commands , and all expected functionalities of the applications accessing database  are exercised. This will enable analysis module  to completely understand database access patterns.","Monitoring module  can employ any technique of in-line interception or real-time auditing to obtain the desired information.","Real-time auditing can be used in cases where database  has an auditing feature. The auditing information may be placed into an audit table  internal to database  or into an external database log file . In real-time auditing, module  instructs database  to generate a stream of events every time a command  enters database . The stream can include such items as the text of the command , a date\/time stamp, information pertaining to the user that issued the command , the IP (Internet Protocol) address of the issuing computer, the application that issued the command , etc. The stream can appear to module  in string or binary form, and can be extracted using a number of different techniques, depending upon the implementation, including APIs (Application Programming Interfaces) that access database . One example is to use ODBC (Open DataBase Connectivity), a set of C language API's that allows one to examine or modify data within database . If the Java programming language is used, JDBC (Java DataBase Connectivity) can be used instead.","Another way that module  extracts the needed information from database  is to use code injection or patching to inject logic into one or more modules associated with database , to transfer control to module .","In another embodiment, called \u201cdirect database integration\u201d, the database  vendor, who has access to the commands  in conjunction with the normal operation of the database , makes the commands  available to module .","In yet another embodiment, in cases where database  supports it, external database log file  may be examined without the need to resort to special software.","Once a command  has been processed by module , the command  can optionally be expunged from any table  or log file  it is stored in, to make room for subsequent commands .","Module  normally obtains its information in real time, but, alternatively, the information could be extracted in a non-real time manner, e.g., in those embodiments where audit table  or log file  is used.","At step , analysis module  compares the actual accesses of database , as gathered in storage area , with the normally larger universe of authorized accesses as determined by database discovery module . Analysis module  can generate a map of which parts (tables and columns) of which database  were accessed during step  via which operations emanating from which users. The map can then be displayed to DBA  by any conventional means. For example, the map can be displayed on a computer monitor, with actual accesses being portrayed in one color, and authorized accesses that were not observed during the observing step  portrayed in a different color.","At step , analysis module  and\/or DBA  adjust access control settings to database , based upon results of comparing step  and possibly based upon pre-established criteria. The adjustments are made by changing settings within access control module . Such adjustments can include one or more of the following:","1) DBA  receives a report from module  containing suggested revised access control settings that should be applied to database . The suggestion is normally to harden database , i.e., impose stricter access control settings. For example, the suggestion may be to deny access to operations by certain users on database  columns and tables that were preconfigured to be authorized, but which were not observed during observing step .","2) Analysis module  is allowed to automatically harden database  (for all times of the day), i.e., apply access control settings as determined by module . Again, the criterion can be to deny access to operations by certain users on certain columns and tables of certain databases that were preconfigured to be authorized, but which were not observed during observing step .","3) Module  is allowed to harden database  dynamically based upon time of day, i.e., access control module  is programmed to harden database  during certain times of the day but not during other times.","4) DBA  can be alerted by module  regardless of time of day or in a time-based access pattern. The alerts can convey those combinations of databases, tables, columns, operations, and users that were preconfigured to be authorized, but which were not observed during observing step .","5) Command monitoring module  can be allowed to continue monitoring commands  past the duration of the observing step . During the extended time period, for example, analysis module  can be programmed to alert DBA  in real time regarding commands  that are observed by monitoring module  during the extended time period but that were not observed during observing step .","Adjustments involving the automatic hardening of database  can be implemented by using a bypass connection  between analysis module  and access control module  to bypass DBA . The hardening commands can be written as standard SQL commands as supported by database , or by using database specific proprietary APIs (Application Programming Interfaces). Examples of such APIs are OCI for an Oracle database , or DMO for a Microsoft SQL Server. OCI and DMO are libraries that enable programming languages other than SQL to access database , by translating the commands into SQL. OCI is a set of subroutines in programming language C. DMO uses COM objects in C or in Visual Basic.","In optional step , analysis module  generates one or more third party reports , e.g., a regulatory compliance report such as the data security report required by HIPAA (Health Insurance Portability and Accountability Act). As used herein, \u201cthird party\u201d means a report to be processed by an entity other than DBA  or access control module .","Normal operations of database  can continue uninterrupted during steps - of the present invention. This is an important attribute.","Returning to , we see an exemplary database  having one table (People) with four columns (ID, Name, Phone, and Social Security Number). Command monitoring module  monitors two incoming commands  from user John. Command () is an UPDATE, and command () is a SELECT. Module  monitors these commands  and dissects which operations are being performed on which tables and columns within database . At step , analysis module  concludes that user John has not selected column SSN, has not updated column ID, and has not updated column SSN. (John has implicitly selected column ID, because of the WHERE subcommand embedded within command ()). At step , module  can perform one or more tasks as described above, such as to automatically deny future access to John to these unobserved combinations, generate an alert to DBA  if a subsequent command  arrives that attempts to access one of these previously unobserved combinations, etc.","The above description is included to illustrate the operation of the preferred embodiments and is not meant to limit the scope of the invention. The scope of the invention is to be limited only by the following claims. From the above discussion, many variations will be apparent to one skilled in the art that would yet be encompassed by the spirit and scope of the present invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and other more detailed and specific objects and features of the present invention are more fully disclosed in the following specification, reference being had to the accompanying drawings, in which:",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"}]},"DETDESC":[{},{}]}
