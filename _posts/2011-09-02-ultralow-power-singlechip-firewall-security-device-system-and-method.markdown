---
title: Ultra-low power single-chip firewall security device, system and method
abstract: A firewall security device, system and corresponding method are provided that includes an operating system of an entirely new architecture. The operating system is based fundamentally around a protocol stack (e.g., TCP/IP stack), rather than including a transport/network layer in a conventional core operating system. The firewall security device may include a processor and an operating system (OS) embedded in the processor. The OS may include a kernel. The operating system kernel is a state machine and may include a protocol stack for communicating with one or more devices via a network interface. The OS may be configured to receive and transmit data packets and block unauthorized data packets within one or more layers of the protocol stack based on predetermined firewall policies.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08875276&OS=08875276&RS=08875276
owner: IOTA Computing, Inc.
number: 08875276
owner_city: Palo Alto
owner_country: US
publication_date: 20110902
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS REFERENCES TO RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This nonprovisional patent application is related to U.S. patent application Ser. No. 12\/938,290, filed Nov. 2, 2010, titled: \u201cTCP\/IP Stack-Based Operating System\u201d, which is hereby incorporated by reference in its entirety.","This application relates generally to computing systems and, more particularly, to a firewall security device, system, and method based on a protocol stack operating system.","Communication networks are widely deployed to provide communication services, such as transmitting packet data, multimedia, voice, video, broadcast, and the like. Traditionally, networks such as the Internet are configured to provide communication services between different computing systems and\/or computers, servers, hosts, portable devices, mobile phones, and other consumer electronic devices via wired and\/or wireless networking technologies. Network communication may be facilitated by standard communication transport protocols such as the Transmission Control Protocol\/Internet Protocol (TCP\/IP), the User Datagram Protocol\/Internet Protocol (UDP\/IP), or similar transport protocols.","One issue experienced by computing devices and systems using these communication transport protocols relates to issues of malicious attacks, unauthorized accesses, and the like. To address this issue, computing systems typically utilize a firewall controlling the data flow and preventing access by unauthorized users.","A firewall is a software application, hardware, or a combination thereof that controls network traffic between networks or hosts and allows or blocks specific data packets based on a comparison of network traffic characteristics to the existing policies. Several types of firewall technologies are available. Typically, firewalls operate on one or more TCP\/IP layers which include an application layer, a transport layer, a network layer (also known as an IP layer), and a physical layer (also known as a hardware layer or link layer).","Network-layer firewalls operate at a relatively low level of the TCP\/IP protocol stack, not allowing packets to pass through the firewall unless the packets match the established rule set. However, network-layer firewalls cannot make more complex decisions based on which stage of communications has been reached between hosts.","Application-layer firewalls work on the application level of the TCP\/IP stack, and may intercept packets traveling to or from an application. Generally, an application firewall can prevent unwanted outside traffic from reaching a protected device. However, one disadvantage of application-layer firewalls is their effect on performance of the devices protected. Examining the contents of packets requires time and thus slows down processing. Another disadvantage of application-layer firewalls is administrative overhead. Because application-layer firewalls add complexity, there is a potential for misconfiguration, which leads to access issues and could also lead to blocking communications that were never intended to be blocked.","Advanced firewalls that combine lower-layer access control with upper-layer functionality are also widely utilized. One example of such an advanced firewall includes application-proxy gateways. However, application-proxy gateways also experience the above-mentioned complexity problems, which cause a reduction in overall performance.","The causes of the performance problems relate to the antiquated design of conventional computing devices practicing firewall features. Typically, these devices and other conventional operating systems follow similar architectures, including a layered design, device drivers, and Application Programming Interfaces (APIs).","Moreover, conventional processor designs use a fixed-frequency, continuously running crystal as the timing mechanism for clocking through processor execution cycles. Thus, the crystal and the microprocessor continue running even if nothing is being accomplished in the system, uselessly cycling around and waiting for a process to actually perform an action (e.g., process an incoming TCP\/IP packet at the Ethernet interface). The foregoing architecture is inefficient in two respects. First, the crystal and microprocessor transistors typically execute at their maximum speed at all times, thereby consuming excess power and generating excess heat. Secondly, it is inefficient to continue running clock cycles if no substantive process is actually running.","Furthermore, conventional operating systems require various modifications and enhancements each year, such as incorporation of new communications layers for Ethernet drivers, TCP\/IP stacks, Web browsers, and the like. Generally, these new layers are added on top of the conventional operating system, thereby increasing complexity, decreasing performance, and leading to software crashes and security flaws.","This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to identify key features or essential features of the claimed subject matter, nor is it intended to be used as an aid in determining the scope of the claimed subject matter.","In accordance with various embodiments disclosed herein, a firewall security device is provided that includes an operating system of an entirely new architecture. This operating system may be based fundamentally around the TCP\/IP stack (instead of including a TCP\/IP layer as in a conventional core operating system) and utilize a conventional interface or similar extensions of the standard Berkeley Sockets (or WinSock) API.","In one embodiment, a firewall security device is provided. The firewall security device comprises a processor and an operating system (OS) embedded in the processor. The OS may comprise a kernel. The OS kernel may include a state machine comprising a protocol stack for communicating with one or more devices via a network interface. Based on predetermined firewall policies, the OS may be configured to receive and transmit data packets and block unauthorized data packets.","In an example, the network interface may comprise at least one Network Interface Controller (NIC) coupled to the processor. The firewall security device may further comprise a Universal Asynchronous Receiver\/Transmitter (UART) coupled to the processor. The firewall security device may further comprise a memory coupled to the processor. The memory may comprise one or more of a read only memory (ROM) and a random access memory (RAM). The memory may store instructions executable by the processor. The instructions may comprise predetermined firewall policies for transmitting or blocking data packets. The protocol stack may comprise a TCP\/IP stack.","According to another example, the protocol stack may comprise a UDP\/IP stack. The firewall security device may further comprise an asynchronous clock to serve as an internal clock for the operating system kernel. The asynchronous clock may be configured to automatically stop when clock cycles are not needed. A time reference for the operating system kernel may communicate via a Network Time Protocol (NTP), Simple Network Time Protocol (SNTP), or other suitable time protocol from a remote time server coupled to the network. The network may comprise the Internet and the operating system utilizing sockets style API of sockets and ports on IP addresses for implementing firewall policies. The predetermined firewall policies may comprise predetermined policies based on IP addresses and\/or protocols, applications, user identity, and network activity.","According to another embodiment, a method for providing a firewall security device is provided. The method may comprise receiving a data packet within an OS, with the OS being a state machine comprising a protocol stack for processing the data packets according to a network protocol, and the operating system being embedded within a processor and processing a received data packet to determine whether the data packet is authorized based on firewall policies, wherein unauthorized data packets are blocked while authorized data packets are transmitted.","The protocol stack may comprise a TCP\/IP. The protocol stack may comprise a UDP\/IP stack. Data packets may be transmitted via a network interface comprising at least one NIC. Executable instructions for the OS may be stored in a memory of the processor and executed through a sockets API. The predetermined firewall policies may comprise policies based on IP addresses and\/or protocols, applications, user identity, and network activity.","According to some embodiments, a computer-readable storage medium may be provided. The computer-readable storage medium may embed instructions. The instructions executable by the processor may perform the method comprising receiving a data packet within an OS, with the OS being a state machine that comprises a protocol stack for processing the data packets according to a network protocol, the operating system being embedded within a processor, and processing the received data packet to determine whether the data packet is authorized based on predetermined firewall policies, wherein unauthorized data packets are blocked while authorized data packets are transmitted.","A system for routing data packets across communication networks is provided in some embodiments. The system may include a plurality of communication ports, and a switch, the switch being configured to transmit multiple data packets between the plurality of communication ports. The system may also include at least one firewall security device, the firewall security device comprising a processor and an operating system (OS) embedded in the processor. The OS may comprise an operating system kernel, the operating system kernel being a state machine having a protocol stack for communicating with one or more devices via a network interface. The OS may be configured to receive and transmit data packets and block unauthorized data packets based on predetermined firewall policies.","Various aspects of the subject matter disclosed herein are now described with reference to the drawings, wherein like reference numerals are used to refer to like elements throughout. In the following description, for purposes of explanation, numerous specific details are set forth in order to provide a thorough understanding of one or more aspects. It may be evident, however, that such aspect(s) may be practiced without these specific details. In other instances, well-known structures and devices are shown in block diagram form in order to facilitate describing one or more aspects.","Various embodiments disclosed herein provide firewall security devices embedding an operating system based entirely on a protocol stack. The protocol stack may be a TCP\/IP protocol stack, UDP\/IP stack, combinations thereof, or other protocols. The devices may include a processor, which in turn includes an operating system embedded therein. The operating system is fundamentally a state machine. The kernel of the operating system is fundamentally a protocol stack.","One of the advantages of such an operating system is that it is inherently Internet-oriented. All Internet type functionality is natural and inherent in the protocol stack-based processor design and implementation. In addition to many advantages provided by various embodiments are a small hardware design, very compact and efficient software, minimal clock cycles for execution, a natural Internet connectivity model, and low power consumption.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 1","FIG. 1"],"b":["100","100","110","120","130","140","130","140","140","100","110","130","140"]},"The edge device  and client devices A-C may include a desktop computer, a laptop computer, a server, a network host, a handheld computer, a mobile phone, a smartphone, a personal digital assistant (PDA), and other consumer electronic devices such as smart light bulbs, smart water\/electricity meters, wireless detectors, and so forth.","As shown in , the firewall security device  (\u201cfirewall\u201d for short) may be coupled between the edge device  to be protected and the network . According to various embodiments, the firewall security device  may be implemented as a single chip, microchip, integrated circuit, or the like. As shown in , the firewall security device  may be implemented within three different layers of the stack, applications , an Operating System (OS) , and hardware . The hardware layer may be more important in stopping packets from reaching the other two layers, thus representing the first line of defense in preventing of saturation of the system with the unnecessary traffic.","The firewall security device  is configured to control network traffic between the network  and the edge device , and to prevent unauthorized users from accessing the edge device (i.e. prevent malicious attacks, hostile attacks, computer virus attacks, and the like). The firewall security device  compares traffic characteristics to existing policies and, based on comparison, allows or blocks specific data packets for further transmission. Traffic characteristics may include IP addresses, protocols, thread characteristics, user identity, and the like. Firewall policies may be based on different technologies such as packet filtering, stateful inspection, stateful protocol analysis, application-proxy gateway managing, dedicated proxy server managing, network control access, unified threat management, and virtual private networking. Those who are skilled in the art would understand that any firewall policies could be applied for protection the edge device  from malicious attacks when it interacts over the network . The firewall security device  is described below in greater detail. According to an example embodiment, the firewall security device  and the edge device  may be incorporated, integrated or housed together.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 2","b":["200","200","200","210","210","220","230","240","250","210"]},"The element  also comprises a state machine  for executing various instructions and modules stored in the memory . The state machine  may include one or more state machines.","A module should be generally understood as one or more routines that perform various system-level functions and may be dynamically loaded and unloaded by hardware and device drivers as needed. The modular software components described herein may also be integrated as part of an application specific component.","According to various embodiments disclosed herein, the modules may each include executable instructions for the operating system embedded into the element  and may be executed through a sockets API.","The I\/O request receiver module  is configured to receive I\/O requests. The protocol handling module  is configured to handle a specific protocol (e.g., TCP\/IP, UDP\/IP, or the like) for the protocol stack state machine implementation. The I\/O request processing module  is configured to process the I\/O requests from an application according to the network protocol using the operating system. The optional network interface module  may be included and is configured to provide an interface between the protocol stack state machine and a network interface controller, which is described further in more details.","The element  may also comprise a clock, or, alternatively, clocking may be provided externally. For example, the state machine  may utilize a time reference using the NTP or SNTP from a remote time server.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 3","FIG. 1"],"b":["120","120","310","320","310"]},"The processor  may comprise a Computer Processing Unit (CPU), a controller, a micro-controller, a microprocessor, an electronic device, other electronic units designed to perform the functions described herein, or a combination thereof. The processor  may be implemented as a multi-core processor, or, alternatively, the firewall security device  may include several processors . The processor  is configured to execute processor executable instructions.","According to various embodiments disclosed herein, the processor  embeds an operating system based on a protocol stack. The protocol stack may be a TCP\/IP protocol stack, UDP\/IP stack, combinations thereof, or other appropriate protocols. One particular example of the processor  embedding a TCP\/IP stack-based operating system is described with reference to .","Although it is not shown in , the processor  may include a memory storing an operating system and\/or any further executable instructions and\/or data (e.g., firewall policies). The memory can be implemented within the processor  or externally to the processor . As used herein, the term \u201cmemory\u201d refers to any type of long term, short term, volatile, nonvolatile, or other storage devices and is not to be limited to any particular type of memory or number of memories, or type of media upon which memory is stored. In some embodiments, the memory may comprise one or more of a read only memory (ROM) and a random access memory (RAM).","The firewall security device  further comprises two NICs  coupled to the processor . The NICs  are configured to couple the processor  and a network such as a LAN and\/or a WAN. Examples of NIC  include an Ethernet controller and\/or a wireless interface controller (e.g., 802.11 controller, ZigBee controller, Bluetooth controller, etc.). It will be apparent to those skilled in the art that the NIC  can support many wired and wireless standards, and provides communication over a Universal Serial Bus (USB) connection, a firewire connection, an Ethernet connection, a serial connection, a parallel connection, an Analog Telephone Adapter (ATA) connection, a wireless USB connection, an IEEE 802.11 connection, and so forth.","The NICs  may provide a network interface, for example, to the Internet. In some embodiments, the NIC  may be a software-based controller. In an example, the first NIC  is used for connecting to a LAN or an edge device, while the second NIC  is used for connecting to a WAN. Although  shows two NICs , those skilled in the art may understand that the firewall security device  may comprise any number of NICs , or may not include them at all.",{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 4","FIG. 1"],"b":["120","120","310","320","310","410","310"]},"The processor  may embed an operating system based on a protocol stack. The protocol stack may be a TCP\/IP protocol stack, UDP\/IP stack, combinations thereof, or other appropriate protocols. Thus, the operating system is a TCP\/IP stack state machine, UDP\/IP stack state machine, or alike.","The UART  relates to hardware configured to provide communication between the processor  and a peripheral device via a serial port. The UART  may be used to out-of-band control and setup the processor . For example, the firewall policies and corresponding routine (software) may be uploaded, updated, changed, accessed, and so forth, via the UART .","Alternatively, the UART  may be used to communicate with an edge device to be protected (e.g., the edge device  of ), while one of the NICs  may be used to out-of-band control and setup software of the processor . One of ordinary skill in the art would readily understand that any other arrangement is possible for controlling and managing the routine stored in the firewall security device .",{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 5","FIG. 1"],"b":["120","120","310","320","410","120","510","520","120","510"]},"The term \u201cmemory\u201d as used herein relates to a computer-readable storage medium used to participate in providing executable instructions to the processor  for further execution. According to various embodiments, the memory stores instructions (code) and data for the operating system and instructions and data for implementing firewall security features.","According to various embodiments, executable instructions and data for the operating system are stored separately. Thus, the read-only executable instructions may be executed directly from ROM, and only the read\/write data needs to be saved in some type of RAM. As a result, there are both substantial power and cost savings. Moreover, the assembled and linked code of the operating system may be highly optimized for low power consumption, as well as reduced ROM and RAM size.",{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 6","b":"600"},"In step , a data packet is received by the firewall security device. According to the embodiments disclosed herein, the data packet is an IP packet comprising source and destination addresses, a header, flags, checksums, data payload, and so forth. The data packet may be transmitted from a WAN to a LAN or to an edged device, or vice versa.","In step , the received data packet may optionally be processed by the firewall security device. Processing may comprise any firewall techniques such as packet filtering, stateful inspection, stateful protocol analysis, application-proxy gateway managing, dedicated proxy server managing, network control access, unified threat management, virtual private networking, and so forth. Generally, at this step, predetermined firewall policies are applied to the received data packet to determine whether it is authorized or not. Firewall policies may include policies based on IP addresses and\/or protocols, policies based on applications, policies based user identity, policies based on network activity, and so forth. Firewall policies may be applied for incoming and\/or outgoing traffic.","In step , it is determined whether the data packet is authorized or not, e.g., based on predetermined firewall policies. For example, it is checked whether source and\/or destination addresses are valid, whether these addresses have a private destination or are encrypted or improperly flagged. According to another example, it can be checked what protocol is used in the data packet (e.g., packets having IPv6 format shall be blocked if the edge device handles IPv4 only). In yet another example, it can enforce user identity policy by using digital certificates, cryptographic tokens, authentication user IDs, and the like. According to still another example, time-based policies can be applied to reveal inactive periods. One of ordinary skill in the art would understand that any other policies can be applied to determine authorization of data packets.","If it is determined in step  that the data packet is authorized, the method  proceeds to step , where the data packet is further transmitted by the firewall security device (e.g., to an edge device). If, on the other hand, it is determined that the data packet is not authorized, the method  proceeds to step  to block the data packet.",{"@attributes":{"id":"p-0060","num":"0059"},"figref":"FIG. 7","b":["700","120","700","700","710","720"]},"The system  comprises a number of ports A-E to provide connection of the system  with said networks and\/or computing devices. In the , four ports A-E are shown; however, there could be any number of them as can be understood by one of ordinary skill in the art. The system  may optionally comprise a Wireless Transmitting\/Receiving Unit (WTRU) , which may provide wireless connection with one or more computing\/edge devices of the LAN .","The system  further comprises a switch  configured to route data packets between ports A-E and the WTRU  (if any). The switch  may comprise a processor, a microprocessor, a controller, a chip, or any other circuitry for data routing.","In addition, the system  may include a firewall security device , according to any embodiment disclosed herein with reference to . The firewall security device  may be coupled between the port A and the switch  in such a way that all data packets transmitted from the WAN  are first processed by the firewall security device  to prevent malicious attacks and unauthorized access to the computing devices of LAN . If the data packets are authorized by the firewall security device , they are transmitted to the switch  for further routing.",{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 8","b":["800","120","800","800","730","710","720","740","750","120","120","730","740","750"]},"The arrangement of the system  shown in  allows for applying firewall policies for data packets at each port A-D and the WTRU  prior to reaching the switch , thereby preventing the edge device(s) from malicious attacks.","Some of the above-described functions can be composed of instructions that are stored on storage media (e.g., computer-readable medium). The instructions may be retrieved and executed by the processor . Common forms of computer-readable media include, for example, a floppy disk, a flexible disk, a hard disk, magnetic tape, any other magnetic medium, a CD-ROM disk, digital video disk (DVD), any other optical medium, any other physical medium with patterns of marks or holes, a RAM, a PROM, an EPROM, an EEPROM, a FLASHEPROM, any other memory chip or cartridge, or any other medium from which a computer can read.","The following gives an overview of the advantages of protocol stack-based processors, which can be used in firewall security devices according to various embodiments, disclosed herein.","Conventional operating systems manage internal tasks and external programs in a dictatorial manner, by preemptively multitasking through threads and processes. Such a system is flexible and of general purpose in nature. However, it may not be optimal since applications and unknown driver components have little or no control over their scheduling.","In contrast to conventional operating systems, the operating system according to the various embodiments disclosed herein regards the whole environment as being inherently cooperative and friendly. To that end, the whole system is essentially a state machine. There is no executive, but a cooperative state machine model. All systems and application components are built together in an open and symbiotic relationship. Only components actually required in a target system are built into the environment.","In a conventional operating system, the kernel and other systems components would comprise all the normal functions of file and memory management, timers, input and output, TCP\/IP, and the like. There are numerous threads and processes going on, such as kernel executive cycles around all the running processes, updating clocks, checking communication ports, updating displays, checking on Ethernet traffic, and so forth. In this way, the conventional operating system provides a highly sophisticated and flexible system, but with the downside of a tremendous number of activities (and hence clock cycles and, therefore, energy) going on all the time.","In contrast, an implementation according to various embodiments disclosed herein may include only the required components. As a result, execution times and minimal code size would be optimized, resulting in fewer energy cycles. Such a simple firewall device has just the state machine handling the lower operations of forwarding Ethernet data packets up through the TCP\/IP stack. When no tasks need to be done, the state machine is idle. Therefore, the protocol stack-based processor according to various embodiments disclosed herein may eliminate wasted internal clock cycles through the use of intelligent tasking, in contrast to multi-tasking.","Various application areas for the system include clean tech (green energy), medical, military, aerospace, automotive, Smartphone, PDA, Pocket Computer, and so forth. In the clean tech area, for example, one application for the firewall security device may be \u201ca tiny firewall security chip for a smart light bulb,\u201d where the network traffic may be transmitted over the powerline. Another application example may relate to smart meters (water meters, electricity meters). Said devices may possess an integrated processor and a transmitter for delivering measured data or other relevant information. Application of a firewall security device in these devices may help to prevent any malicious attacks.","Similarly, firewall security devices may be integrated in medical electronic devices, such as a stent. A stent is a synthetic tube inserted into a natural passage\/conduit in the body to prevent, or counteract, a disease-induced, localized flow constriction. A tiny chip implementing data transmission and a tiny firewall security device could be built into each stent along with a tiny ultra long life and low power RF transmitter\/receiver. The modified stent could send data about the state of the artery in real-time over the wireless network, such that the patient's condition can be properly monitored.","The present system could also be used for other medical patient monitoring applications where the small size, low power and Internet monitoring aspects would provide enormous benefits (e.g., used in a \u201cdigital plaster\u201d stuck to a patient's body to track vital signs, such as heart rate and breathing, and then send alerts to doctors over the Internet).","The ultra low power aspect of the firewall security device according to the various embodiments disclosed herein may provide greatly improved battery life for various devices. Boot up time for devices may be greatly reduced by executing instructions from the ROM, saving general state information in battery-backed SRAM, and saving crucial microprocessor register setting and other state information saved in special registers in custom application-specific integrated circuits (ASICs), for example.","A full IP stack typically includes an application layer, transport layer, internet layer, and link layer. The basic operating system for the firewall security device may not normally have all the components of a full Internet Protocol stack. A basic kernel may have, for example, just HTTP on top of TCP on top of IP on top of Ethernet. Alternatively, the kernel may be built with SNMP on UDP on IP on Ethernet.","The above description is illustrative and not restrictive. Many variations of the embodiments will become apparent to those of skill in the art upon review of this disclosure. The scope of the subject matter should, therefore, be determined not with reference to the above description, but instead should be determined with reference to the appended claims along with their full scope of equivalents.","While the present embodiments have been described in connection with a series of embodiments, these descriptions are not intended to limit the scope of the subject matter to the particular forms set forth herein. It will be further understood that the methods are not necessarily limited to the discrete steps or the order of the steps described. To the contrary, the present descriptions are intended to cover such alternatives, modifications, and equivalents as may be included within the spirit and scope of the subject matter as disclosed herein and defined by the appended claims and otherwise appreciated by one of ordinary skill in the art."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Embodiments are illustrated by way of example and not limitation in the figures of the accompanying drawings, in which like references indicate similar elements.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIGS. 3","b":["4","5"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
