---
title: Method and apparatus for a pilot search using a matched filter
abstract: The present invention includes a cellular pilot signal detector or searcher for use in a cellular mobile communications unit. The signal detector uses a matched filter to detect a pilot signal transmitted from a cellular base station. The matched filter includes a plurality of taps and a plurality of delays located between adjacent taps. The signal components of a received digital signal are held on the taps of the matched filter by the delays. The matched filter compares the signal components of the received signal to an expected or searched for digital pattern. The matched filter puts out a relatively large signal if the received digital signal matches the expected digital pattern. The matched filter can also be used in parallel with a correlator.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07130334&OS=07130334&RS=07130334
owner: Qualcomm, Inc.
number: 07130334
owner_city: San Diego
owner_country: US
publication_date: 20040116
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CLAIM OF PRIORITY UNDER 35 U.S.C. \u00a7120","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The present Application for Patent is a Continuation and claims priority to patent application Ser. No. 09\/450,265, entitled \u201cMETHOD AND APPARATUS FOR A PILOT SEARCH USING A MATCHED FILTER\u201d filed Nov. 29, 1999 now U.S. Pat. No. 6,760,366, now allowed, and assigned to the assignee hereof and hereby expressly incorporated by reference herein.","1. Field","The present invention is related to detection of pilot signals by a digital cellular communications mobile unit. Specifically, the present invention relates to a method and apparatus of using a matched filter in a digital cellular communications mobile unit to search for and detect pilot signals generated by cellular base stations.","2. Background","In a code division multiple access (CDMA) spread spectrum communication system, a shared frequency band is used for communication with all base stations within that system. An example of such a system is described in the TIA\/EIA Standard TIA\/EIA-95-B entitled \u201cMobile Station-Base Station Compatibility Standard for Dual Mode Wideband Spread Spectrum Cellular System,\u201d incorporated herein by reference. The generation and receipt of CDMA signals is disclosed in U.S. Pat. No. 4,901,307 entitled \u201cSPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEMS USING SATELLITES OR TERRESTRIAL REPEATERS\u201d and in U.S. Pat. No. 5,103,459 entitled \u201cSYSTEM AND METHOD FOR GENERATING WAVEFORMS IN A CDMA CELLULAR TELEPHONE SYSTEM,\u201d both of which are assigned to the assignee of the present invention and incorporated herein by reference.","Radio Frequency (RF) signals are exchanged between a respective mobile unit and one or more base stations. Mobile units do not communicate directly with one another. Base stations communicate with a base station cellular or personal communication system controller, referred to herein as a base station controller (BSC) using various media such as ground based wires or a microwave link, for example. The BSC can route calls to a public switching telephone network (PSTN) or can route packets to a packet switched network, such as the Internet. The base station also coordinates the operation of base stations within the system during soft handoff for example.","TIA\/EIA-95 is one example of a CDMA communication system. Communication from a mobile unit to one or more base stations in a TIA\/EIA-95 CDMA system takes place over shared frequency channels each of which occupies approximately 1.25 MHz of radio frequency bandwidth. More specifically, communication signals occupying a given frequency band are discriminated at a receiving station through the spread spectrum CDMA waveform properties based on the use of a high rate pseudonoise (PN) code. A PN code is used to modulate signals transmitted from the base stations and mobile units. Signals from different base stations can be separately received at a given mobile unit either by the discrimination of different PN codes, and\/or by the discrimination of shifted versions of the same PN code. The high rate PN spreading also allows a receiving station to receive a signal from a single transmission station where the signal has traveled over distinct propagation paths. Demodulation of multiple signals is disclosed in U.S. Pat. No. 5,490,165 entitled \u201cDEMODULATION ELEMENT ASSIGNMENT IN A SYSTEM CAPABLE OF RECEIVING MULTIPLE SIGNALS\u201d and in U.S. Pat. No. 5,109,390 entitled \u201cDIVERSITY RECEIVER IN A CDMA CELLULAR TELEPHONE SYSTEM,\u201d both of which are assigned to the assignee of the present invention and incorporated herein by reference.","The various channels within a given \u201cforward\u201d (base station to mobile unit) TIA\/EIA-95 CDMA channel include data channels, a synchronization channel, a pilot channel, and a set of paging channels, all transmitted from the base station to mobile units. The pilot channel carries a reference signal, commonly known as the pilot signal. The pilot signal is a regularly repeated digital pattern of \u201cchips,\u201d wherein each chip is represented by a single binary digit. In the exemplary embodiment, the pilot signal is a pattern that is 32,768 \u201cchips\u201d in length, which repeats at a chip rate of 1.2288 MHz. Thus, the pattern repeats itself every 26.6 milliseconds (ms).","The pilot provides for time reference and for amplitude and phase tracking. The pilot signal allows mobile units to identify and become synchronized with the relative phase of a base station that is within range of the mobile units' communication capability. Synchronization with a base station allows the mobile unit to further refine its timing and receive data signals from the base station.","However, as the mobile unit moves, the base stations with which it is synchronized may become more distant or become blocked, and the signal from various stations may become too weak for continued reception. Further, as the mobile unit moves, a closer base station that was previously blocked may become unblocked. The more powerful signal from the closer base station may then suppress the reception of the weaker signal from the more distant, synchronized base station.","Accordingly, a mobile unit must periodically perform searches for pilot signals transmitted from other, alternative base stations in order to identify a base station with a stronger or higher power pilot signal with which to synchronize. In general, in order to facilitate these searches, the synchronized base station sends signals to the mobile unit that identify phase offsets of pilot channels for base stations neighboring the synchronized base station. Typically, to avoid pilot signal overlap, the pilot signals of neighboring base stations are phase shifted by at least 64 chips from each other. Thus, if a mobile unit is synchronized with a base station transmitting a pilot signal at a relative phase shift of 128 chips, the synchronized base station could have neighboring base stations broadcasting at relative phase shifts of 64 chips, 192 chips and, perhaps, 256 chips, for example. The mobile unit can then search for neighboring base station pilot signals around the specific phase offsets identified by the currently synchronized base station (e.g. 64, 172 and 256) on a periodic basis to determine whether to synchronize with another base station.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1","b":["10","10","12","14","16","18"]},"The base station creates a pilot signal having two components: an in-phase, or \u201cI\u201d component; and a quadrature, or \u201cQ\u201d component. Using these two components, the base station modulates or \u201cspreads\u201d the pilot signal. Most often, the specific protocol used in spreading a CDMA signal is referred to as Quadrature Phase Shift Keying (QPSK) spreading. QPSK spreading is discussed in detail, for example, in R. Prasad, CDMA for Wireless Personal Communications, (Artech House, 1996). After receiving a signal and passing the signal through an analog to digital converter (not shown), despreader  performs a mathematical algorithm on the I- and Q-components of a signal to ensure that the correct signal magnitude is detected. The mathematical algorithm used for PN despreading involves the exclusive-oring (XORing) of expected I- and Q-components with the I and Q components received. The specifics of the mathematical algorithm, as well as the specific components used in a typical despreader are well known in the art.","Correlator  compares an input despread signal from despreader  and compares it with a reference signal, commonly termed an expected signal. The expected signal can include a portion of the 32,768 chip pattern of the PN pilot signal provided to the correlator at a certain phase offset. Correlator  produces an energy output indicative of the level of correlation between the input despread signal and the reference signal. For example, while an exact match of all compared chips will yield a high energy output, and a match of 50% or less of all compared chips will yield a low energy output, various energy outputs between the high and low range will be yielded in accordance with a match that falls between these levels.",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2","b":["14","112","114","112","116","112","114","116","118","114","116","118","112"]},"Output  is then fed into integrator  which sums the outputs of comparator  over the total period of the portion of the PN signal used as the expected signal. For example, if the expected signal is 1024 chips in length, then the integration time will be (1024)(0.81 microseconds)=829 microseconds, because a chip arrives every 0.81 microseconds in the preferred embodiment. In this way, the output  of the correlator will have a relatively large magnitude when the detected signal matches the expected signal.","Additionally, even when there is a match of the pilot signal with the expected signal, the magnitude of the correlator output will be larger for a stronger signal. This is because as a signal becomes weaker, that is, if it is transmitted over a relatively long distance or reflected off various objects, it degrades. This degradation results in changes of the individual chip values of the pattern of the transmitted pilot signal. Thus, for a weaker signal, even though the pilot signal is being transmitted at a phase offset that is being searched for, it is likely that fewer chip values will result in matches, and the integrator of the correlator will therefore not sum as many positive values as would be summed were the signal stronger. Thus, the output of the integrator is a relative representation of the strength or energy of a given phase pilot signal that was searched for. The larger the magnitude of the correlator output , the stronger or higher energy of the detected pilot signal.","The output of the correlator  is fed into energy storage and sorting module . Energy storage and sorting module  can perform a number of functions. It can place in memory output energies from correlator  that are above a certain threshold. It can also place in memory the corresponding phase offset of the pilot signal that generated the stored energies. Alternatively, it can place in predetermined memory locations corresponding to given pilot phase offsets (such as offsets corresponding to neighbors of the synchronized base stations) the energy output of the correlator  at that phase offset. Specific components used for, and the operation of, typical energy storage and sorting modules are well known in the art and generally include RAM for storing energy levels and phase offsets, and logic for sorting the different energy levels.","Processing control  provides general control for the mobile unit and makes determinations concerning with which pilot signal, and therefore which base station, the mobile unit should synchronize. It can access the energy information in energy storage and sorting module  for data on which to base such determinations. Processing controls such as processing control  typically include a microprocessor, memory, and busses, the configuration of which is well known in the art.","Because processing control  provides general control for the mobile unit, it may only be able to allocate a small amount of time to checking the energy storage and sorting module  to determine if the mobile unit should be re-synchronized with another base-station. Additionally, the sequential collection of information concerning magnitudes of pilot signals having phase offsets other than that of the currently synchronized pilot signal can be time consuming. Thus, from time to time, the mobile unit may remain synchronized with a pilot signal of a given base station even though it could synchronize with the pilot signal of another closer, or otherwise more suitable, base station instead. This can undesirably lead to the signal jamming or weak signal difficulties described above.","Additionally, due to reflections off of buildings, hills or other obstacles and\/or atmospheric conditions, the neighboring base stations may not appear to be phase shifted by exactly 64 chips from the synchronized base station. And, depending on the location of the synchronized base station, there may be other base stations in the area for which phase offsets were not provided by the synchronized base station. Thus, it may be desirable to search the full sequence of 32,768 phase offsets for pilot channels, not just pilot channels that are phase shifted by predetermined multiples of 64 chips from the currently synchronized base station. The searching, sorting, storing and processor control checking associated with such full sequence searches can consume considerable processing control resources.","Methods and apparatus are also known for determining when to handoff a signal from one base station to another as a mobile unit moves. One such method using a matched filter is disclosed, for example, in U.S. Pat. No. 5,864,578, to Yuen, et al., for a \u201cMATCHED FILTER BASED HANDOFF METHOD AND APPARATUS.\u201d However, the matched filter disclosed by Yuen must be programmable. Such a programmable matched filter can be relatively expensive to manufacture and can require a relatively large amount of power to operate and require extra circuitry. This can be disadvantageous as mobile cellular units typically operate with a limited power supply battery and have limited space for circuitry.","Accordingly, cellular pilot searching improvements are desired. In particular, such searching should be able to be performed relatively quickly while still encompassing a broad portion of the full PN pilot sequence. A searcher should also allow for relatively high frequency checks of high priority pilot phase offsets, such as those of base stations that neighbor the synchronized base station. Additionally, such searching should require a relatively small amount of processing control time to monitor. Also, the searcher should be relatively low cost to manufacture, consume relatively low power, and be relatively compact.","The present invention includes a signal detection circuit or \u201csearcher\u201d in a mobile unit of a digital cellular communications system. The signal detection circuit includes a matched filter for comparing a received digital input pattern with a predetermined expected digital pattern. The matched filter includes a plurality of taps, each tap for detecting a single digital signal component. The matched filter also includes at least one summer connected to the taps. The summer generates a relatively large signal when the digital signal components detected by the plurality of taps match the predetermined digital pattern.","The signal detection circuit can also include a correlator that is connected in parallel with the matched filter. The correlator is also for comparing the received digital input pattern with the predetermined digital pattern. Preferably, both the matched filter and the correlator are separate from a central processing control of the mobile unit.","The matched filter is advantageously able to search through an entire sequence of pilot signal phase offsets in a relatively short period of time. By including the correlator as part of the detection circuit, a parallel search for a small number of specific pilot signal phase offsets can advantageously be performed in an even shorter period of time. Additionally, if the matched filter and correlator are separate from a central processing control of the receiver, a minimum of processor resources are necessary to monitor search results from the matched filter and correlator.","Another aspect of the present invention includes a method for detecting a digital cellular communications signal. According to the method, the digital signal is input into a matched filter. The matched filter compares a digital pattern of the input digital signal to a predetermined digital pattern. The matched filter then generates a relatively high output signal if the digital pattern of the input digital signal matches the predetermined digital pattern.","The present invention includes a method and apparatus for rapidly detecting the strength or power of different phase pilot signals being received by a mobile cellular unit. Because, as discussed above, each base station transmits a pilot signal at a different phase offset, by rapidly detecting the strength of the received pilot signals having different phases, the mobile cellular unit can efficiently determine the most appropriate base station with which to synchronize.",{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIGS. 3A","FIG. 3A","FIGS. 3A\u20133D"],"b":["3","3","3","310","310","312","312"]},"When the mobile unit receives a pilot signal , it actually receives a mixture of the transmitted signal and noise. For the purposes of simplicity, the received mixture of pilot signal  and noise is hereinafter referred to as pilot signal . As pilot signal  is serially received by the mobile unit, a portion of digital signal pattern of the pilot signal  is compared to the digital signal pattern configured in the matching detector . Because the matching detector  is configured with at least a portion of the specific digital pilot signal pattern, at some point during the serial receipt of the pilot signal , the portion of the pattern of the pilot signal  that is being compared will likely match the pattern configured in the matching detector . This situation is shown in FIG A. Specifically, the portion  of the pilot signal  matches the portion of the pilot signal pattern configured in matching detector . When the match occurs, the matching detector can generate a match signal.","Although  shows a complete match between matching detector  and portion  of pilot signal , due primarily to noise in a received pilot signal, a complete match of all the chips of the portion of the pilot signal pattern that is configured in the matched detector may not occur. Thus, preferably, the matching detector can be configured to generate a different magnitude signal depending upon the number of chips that match. Preferably, though not necessarily, the greater the number of chips that match, the greater the magnitude of the signal generated by the matching detector . Thus, as shown in , the signal  generated by the matching detector  can, for example, be a voltage, and the more chips that match, the higher the voltage signal generated. Accordingly, on a relatively complete match, the matching detector  would generate a relatively high voltage spike , as shown on grid  in , at the point in time during which the relatively complete match occurs. Indicating time on horizontal axis , the relative time is indicated as t. The magnitude of the voltage spike, indicating a match, and the relative time at which the spike occurred, t, can then be stored in a local memory.","As discussed in the background section, the digital chip pattern is the same for a pilot signal transmitted by any base station. However, the phase of the pilot signals transmitted by different base stations is shifted.  shows a second pilot signal  having the same digital pattern of +1s and \u22121s as first pilot signal , but shifted in phase by time t. This can be seen by the fact that the portion  of pilot signal  that matches the chips configured in matching detector  is shifted from the identical portion , in pilot signal , by time t. Thus, no match will occur between matching detector  and second pilot signal  at relative time t. Therefore, the signal  output by matching detector , shown on time vs. voltage grid , will have a relatively small magnitude at relative time t.","However, as shown in , at relative time t, which is offset from time t by the phase shift time of t, matching detector  will indicate a match of the pilot signal . Thus, as shown on time vs. voltage grid , the signal  output by matching detector  will be relatively large at time t. As with pilot signal , the magnitude of signal , indicating a match, and the relative time at which the match occurred, t, can be stored in a local memory.","As discussed in the background section, when the mobile unit synchronizes with a base station, it receives an absolute time base from that base station in the form of a chip offset assigned to the base station. Thus, the mobile unit can use this absolute chip offset to assign absolute chip offsets to the relative times, such as t and t, at which relatively large magnitude signals have been detected. For example, the mobile unit can determine that relative time t occurred at a chip offset of 64, and the relative time t occurred at a chip offset of 128, 64 chips after t.","Additionally, because the magnitude of the signal generated by matching detector  is proportional to the number of chips that match, the relative magnitude of the matching detector signal indicates the relative strength of the detected signal. This is because the weaker or lower power the pilot signal, the more noise will be received with it. And, the more noise, the greater the errors in the chip pattern received by the mobile unit. Thus, on average, for a relatively weaker pilot signal, relatively fewer chips will match in the portion of the pilot signal configured in the matching detector.","This situation is shown in , which shows a third pilot signal  that is weaker than first pilot signal . Box  shows the portior in of the digital chip pattern of pilot signal  that is configured in matching detector . This portion of pilot signal  should match with the chips configured in matching detector  at time t. However, as shown, because of errors due to noise, fewer than all of the chips configured in the matching detector  are matched in the portion  of pilot signal . Specifically, the third and fourth chips in portion  have been inverted, by noise arriving with the signal, from a 1 to a \u22121 and from a \u22121 to a 1, respectively. Thus, as shown in time vs. voltage grid , the magnitude of the signal  generated by matching detector  is relatively lower than the magnitude of the signal  generated by more powerful pilot signal . This indicates that while the mobile unit is receiving a pilot signal , it is weaker than pilot signal , and, therefore, probably less appropriate for synchronization.","By collecting pilot signal phase and magnitude information as discussed above, a mobile unit can determine whether a base station other than the one with that it is currently synchronized is more appropriate for synchronization. For example, a mobile unit may currently be synchronized on a base station transmitting a pilot signal at a chip offset of 64. And, matching detector  detects a pilot signal at a chip offset of 128 that has a larger magnitude (that is, generates a higher magnitude output signal on a match) than the pilot signal detected at chip offset 64. Thus, the mobile unit may operate more effectively, that is, generate a clearer transmission and\/or be less likely to drop a received transmission, if it re-synchronizes with the base station transmitting the pilot signal of chip offset of 128.","The above described method and apparatus can advantageously check the entire sequence of pilot signal phase offsets for relatively strong pilot signals in a relatively short period of time. Specifically, as noted in the Background section, each pilot signal chip pattern extends for 32,768 chips before repeating itself. Thus, there are 32,768 possible phases of pilot signals. For each possible phase of pilot signal, the portion of the pilot signal pattern that is configured in the matching detector will necessarily occur once in the time it takes an entire pilot signal serially pass through the matching detector . Accordingly, to check for a match at each of the possible 32,768 phases of pilot signals, a received signal must be serially passed through the matching detector for the amount of time it takes to pass an entire pilot signal through the matching detector. And, because pilot signals are transmitted at a frequency of 1.2288 MHz, this takes 26.6 ms. Therefore, using the method and apparatus of the present invention, the entire sequence of pilot signal phase offsets can be advantageously checked in 26.6 ms using a single matched filter. In alternate embodiments, two or more matched filters operate in parallel, in which each matched filter searches a different phase offset. In this manner, the entire sequence of phase offsets could be checked in a fractional portion of 26.6 ms (for example, 13.3 ms when two matched filters are present, 8.87 ms when three matched filters are present, etc.).","It is also within the ambit of the present invention to use a matching detector as described above in parallel with the type of correlator shown in  and described in the Background section. As discussed in the Background section, the correlator can search at a first phase offset and then, if no significant energy is being detected, switch to searching at any other phase offset, which may be hundreds or thousands of chips from the first phase offset, simply by changing the phase of the reference signal. Additionally, while the maximum energy information in a correlator would be obtained by a full 26.6 ms search, if no significant or unexpected energy is being detected at a given phase offset after only a portion of 26.6 ms, the search could be abandoned and a new search could be initiated at another phase offset.","Thus, by using a correlator in parallel with a matching detector such as matching detector , the correlator can check phase offsets of base stations around the phase offset of the pilot signal with which the mobile unit is currently synchronized. Simultaneously, the matching detector can advantageously sweep through the entire sequence of phase offsets to check for any other strong pilot signals that the correlator might miss because it is checking only a small subset of the total sequence of pilot signal phase offsets. This advantageously provides the mobile unit with information concerning pilot signal strength over the entire sequence of pilot signal phase offsets in a relatively short period of time (\u02dc26.6 ms) while still allowing monitoring of high priority phase offsets (e.g., the phase offsets of base stations neighboring the currently synchronized base station) at an even higher rate (e.g. two, three or more neighboring phase offsets could be checked in \u02dc26.6 ms).","As described above, a correlator provides an efficient means of searching for pilots at particular offsets. Additionally, correlators, which typically sum large numbers of chips, can often provide more reliable estimates than a matched filter as to whether a pilot signal has actually been detected. Although a matched filter may not provide as reliable an estimate as a comparable costing correlator, as described above, a matched filter provides a very quick and efficient means of detecting relatively strong pilot signals at unknown offsets. Thus, a matched filter can prove useful in various situations, such as locating a first pilot signal as soon as a phone is powered on. As well, when a neighbor list transmitted by a base station fails to advertise a pilot that is receivable by a mobile station, a matched filter would allow the mobile station to quickly find the pilot nonetheless. Solely using correlators to find such a pilot could prove to take a much longer time, since the neighbor list would not have indicated to the correlators the offset to search for this pilot at.","Specific embodiments of the present invention are described below. It is to be understood that the present invention is not limited to the specific embodiments described above. Many widely different embodiments of the present invention may be constructed without departing from the spirit and scope of the present invention.",{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 4","b":["210","210","212","214","214","218","210","216","212","216","10","216","218"]},"Despreading matched filter  is for despreading and detecting pilot signals received by a mobile unit in which searcher  is deployed.  is a schematic diagram showing one embodiment of despreading matched filter . As discussed in the Background section, a PN pilot signal includes both an in-phase (I) and quadrature (Q) component. To accommodate these two signal components, matched filter  includes an I-input  and a Q-input . Matched filter  also includes a plurality of I-taps A, B, C, and D for holding and reading values of a single pilot signal pattern component (e.g., a single bit or chip). I-Taps A\u2013D are distributed sequentially along an I-primary line . A Q-primary line  includes a plurality of Q-taps A, B, C and D distributed sequentially there-along. Between each adjacent pair of taps A\u2013D and A\u2013D, is a delay circuit  for holding a chip value on each tap for a predetermined amount of time. Delay circuits  can be any devices that will delay transmission of a signal from the input to the output for a predetermined period of time and are preferably simple latches.","Preferably, at the end of the I-primary line , adjacent to an I-output , is an I-integrator  and at the end of the Q-primary line , adjacent to a Q-output , is a Q-integrator . The I-integrator  and Q-integrator  are for summing chip values held on the taps A\u2013D and A\u2013D. A plurality of tap lines \u2013connect the I-taps A\u2013D and Q-taps A\u2013D to the I-integrator  and Q-integrator . The I-output  and Q-output  are then fed into a final integrator . Final integrator , in the exemplary embodiment, sums the squares of I-output  and Q-output , and produces a matched filter voltage output, matched filter output , accordingly. Matched filter output  feeds into energy storage and sorting module . Matched filter  detects a pilot signal that matches a predetermined digital pattern by outputting a relatively large energy signal when a match is detected. Additionally, it despreads the pilot signal that was initially spread by the base station, as discussed in the background section. This despreading is implemented to compensate for any relative shift in phase that may have occurred to the pilot signal in transmission of the signal from the base station. Preferably, matched filter  implements a QPSK despreading scheme. However, it is within the scope of the present invention for matched filter  to implement any type of despreading scheme.","To perform these functions, the I-component of a received digital pilot signal is fed into the I-input  and the Q-component of the received pilot signal is fed into the Q-input . The rate at which the Q- and I-components of the pilot signal are fed into the inputs  and , respectively, that is, the \u201csampling\u201d rate of matched filter , allows one chip of the pilot signal to be placed on the taps A and A, respectively, per sample. This sampling rate is preferably simply the frequency of the pilot signal, which in the present embodiment is 1.2288 MHz. The first delay circuits  in the I-primary line  and Q-primary line  then delay the pilot signal, preferably holding the chip values on the first taps A and A for approximately 0.81 microseconds, the period of a pilot chip. The delays  then pass the chip values on taps A and A to taps B and B, respectively.","Because in a presently preferred embodiment, 0.81 microseconds is the period of a pilot chip, this delay time allows a second chip value of the pilot signal to be placed on the taps A and A simultaneously with the transfer from taps A and A to taps B and B, respectively, of the first chip value. This process continues until each tap A\u2013D and A\u2013D in matched filter  has a chip value.","Each time a sample is taken, that is, preferably approximately every 0.81 microseconds, the chip values at the nth tap are routed to the I- and Q-integrators  and , respectively, via tap lines A\u2013H, according to chart 1 below.",{"@attributes":{"id":"p-0060","num":"0059"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"70pt","align":"center"}}],"thead":{"row":[{"entry":[{},"CHART 1"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"I-expected","Q-expected","I-out","Q-out"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"char","char":"."}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"char","char":"."}},{"@attributes":{"colname":"3","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"70pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1","1","I","Q"]},{"entry":[{},"1","\u22121","\u2212Q","I"]},{"entry":[{},"\u22121","1","Q","\u2212I"]},{"entry":[{},"\u22121","\u22121","\u2212I","\u2212Q"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},"By routing the I-and Q-component chip values to the I- and Q-integrators as in Chart 1, the matched filter  both despreads the input QPSK pilot signal and provides a maximum output when a predetermined signal is matched. The predetermined sequence of chip values for which the matched filter searches is configured into the matched filter by the interconnection or mapping of tap lines A\u2013H with I- and Q-integrators  and , respectively, an example of which is shown in . In the manner explained below, Chart 1 can be used as a \u201ckey\u201d to determine how to interconnect tap lines A\u2013H with I- and Q-integrators  and  respectively to QPSK despread the input pilot signal and provide a maximum output when a predetermined signal is matched.","To detect the predetermined pilot sequence having an I-chip sequence of, for example, 1,\u22121,\u22121,1 and Q-chip sequence of, for example, \u22121,\u22121,1,1, according to a QPSK despreading scheme, the tap line interconnection or mapping shown in  would be implemented. This mapping is completed according to Chart 1. The first and second columns of chart 1, labeled (I-expected, Q-expected), respectively, show each of the four I- and Q-chip value combinations that could possibly make up a single set of simultaneous I- and Q-chip values of a predetermined pilot sequence, that is, the four possible values for the pair (I-expected, Q-expected). Specifically, (1,1) in the first row, (1, \u22121) in the second row, (\u22121, 1) in the third row, and (\u22121, \u22121) in the fourth row. The third and fourth columns of chart 1 show how the actual value on an I-tap (In) and Q-tap (Qn) are routed to the I-integrator  (I-outn) or Q-integrator  (Q-outn) in order to both QPSK despread the pilot signal and to provide a maximum output of matched filter  when the predetermined pilot signal is received.","For example, the first row of Chart 1 shows how to connect an I-tap and Q-tap to the I-integrator  and Q-integrator  if the expected chip value on the I-tap will be 1 simultaneous with an expected chip value of 1 on the Q-tap, that is, for an (I-expected, Q-expected) combination of (1,1). The \u201cIn\u201d in the I-outn column (the third column) of the first row indicates that, for an (I-expected, Q-expected)=(1,1), the actual value on the I-tap is directly routed to, that is, directly wired to, the I-integrator . The \u201cQn\u201d in the Q-outn column (the fourth column) of Chart 1 indicates that for an (I-expected, Q-expected)=(1,1) the actual value on the Q-tap is directly routed to, that, directly wired to, the Q-integrator .","For a predetermined pilot sequence having an I-chip sequence of, 1,\u22121,\u22121,1 and Q-chip sequence of, \u22121,\u22121,1,1, the I-tap and Q-tap that would be interconnected to integrators  and  to produce a maximum output for an (I-expected, Q-expected)=(1,1) would be taps and . This is because in the expected pilot sequence, the (I-expected, Q-expected) of (1,1) is the fourth combination to occur in the predetermined pilot sequence, and I-tap D and Q-tap D are the pair of taps that are fourth along the I-primary line  and Q-primary line , respectively, from the I-input  and Q-input , respectively.","Thus, as shown in , the I-tap value, 1, is directly routed to the I-integrator  via tap line and the Q-tap value, 1, is directly routed to the Q-integrator  via tap line . This provides the maximum values, 1 and 1, to I- and Q-integrators  and , respectively, to generate a maximal output value.","The second row of Chart 1 shows how an I-tap and Q-tap would be interconnected to integrators  and  for an (I-expected, Q-expected)=(1,\u22121). To generate a maximum matched filter output signal, and QPSK despread the input pilot signal, for (I-expected, Q-expected)=(1,\u22121) the \u201c\u2212Qn\u201d in the I-outn column of the second row indicates that the actual value on the Q tap be inverted and routed to the I-integrator . The \u201cIn\u201d in the Q-outn column of the second row indicates that the actual value on the I-tap be directly routed to the Q-integrator . For the example, predetermined pilot sequence having an I-chip sequence of, 1,\u22121,\u22121,1 and Q-chip sequence of, \u22121,\u22121,1,1, the (I-expected, Q-expected) of (1,\u22121) occurs as the first combination. Thus, I-tap and Q-tap that would be interconnected to integrators  and  to produce and maximum output for an (I-expected, Q-expected)=(1,\u22121) would be I-tap D and Q-tap D, the first pair of taps in the primary lines  and  after inputs  and .","Thus, as shown in , the I-tap value, 1, on I-tap A is routed to the Q-integrator  via tap line A and the Q-tap value, \u22121, on Q-tap A is routed via tap line E through an inverter E, to the I-integrator . Thus, when the input chip value matches the expected chip value, a 1 is routed to both integrators  and  to maximize the sum for taps A and A.","The third and fourth rows of Chart 1 are implemented in the manner described above with respect to the first and second rows of Chart 1. In the third row, for (I-expectedn, Q-expectedn)=(\u22121,1), as is the case on taps C and C, the I-tap value, \u22121, is routed via tap line C through inverter C, to the Q-integrator  and the Q-tap value, 1, is routed via tap line G directly to the I-integrator . Because the I value, \u22121, is inverted, and the Q value, 1, is routed directly, the integrators  and  add maximally to the sum for taps C and C when there is a match on taps C and C to the expected values of (\u22121,1). Finally, if (I-expectedn, Q-expectedn)=(\u22121,\u22121), as it would on taps, B and B the I-tap value, \u22121, is routed through inverter B to the I-integrator  via tap line B and the Q-tap value, \u22121, is routed through inverter B to the Q-integrator  via tap line F. Again, this mapping generates a maximal sum in integrators  and  for taps D and D when there is a match on these taps to the expected value of(1,1).","Each integrator  and  sums the inputs from the tap lines A\u2013H. The I-output  and Q-output  are then fed into a final integrator . Final integrator  preferably squares value of the I-output  and Q-output  signals and preferably sums the result. In this way, the final integrator  effectively generates an energy measurement from the voltage signals. This energy measurement can be a multiple bit digital signal and will be relatively large for times at which the digital signal on the taps of the matched filter match the matched filter's predetermined sequence.","Only eight taps D and A\u2013D are shown in matched filter . For a digital signal length of 32,768 chips, up to 32,768 taps in each primary line of the matched filter could be used. However, to manufacture a matched filter with such a large number of taps would be extremely difficult and relatively expensive, and it is unnecessary. In order to detect the presence of the pilot signal pattern, only a portion of the chip pattern need be used. However, to minimize the likelihood of a false match, matched filter  preferably has at least 16 taps in each primary line , . More preferably, matched filter  includes approximately 1024 taps; 512 in I-primary line  and 512 in Q-primary line .","By sampling at a rate of 1.2288 MHz and shifting the samples through and holding them on successive taps, matched filter  can build up a history of received signal samples. Further, as discussed in the background section, the pilot signals transmitted by different base stations are identical to each other but shifted or offset in phase. Thus, because the sampling rate of matched filter  is the same as the frequency of the broadcast pilot signals, and assuming there are 512 taps in each primary line ,  of matched filter , upon the acquisition of each single chip sample, the matched filter  effectively checks for a match of a full 512 chips of a pilot signal at a given phase offset. Matched filter  detects a match when a large preponderance of the taps (ideally all) route +1's to each integrator  and , rather than \u22121's.","As discussed above, in matched filter , 1 values are routed from the taps to the integrators  and  only when the actual value on a tap matches an expected value. Otherwise, a \u22121 is routed to the integrators  and , which reduces the magnitude of the output of the integrators  and  and reduces the magnitude of the output of matched filter  from final integrator . Thus, the greater the number of received chip values that match the expected chip values on the taps of matched filter , the greater the magnitude of the output of matched filter . As explained above with respect to , the stronger the pilot signal, the greater the number of received chip values of that pilot signal which will match the predetermined pilot sequence. Thus, the magnitude of the output of matched","Therefore, a relatively high voltage magnitude generated at output  of matched filter  would indicate the presence of a relatively strong pilot signal at a given phase offset. Matched filter  transmits the output energy level to energy storage and sorting module  via output .","Energy storage and sorting module  can include memory capability (such as RAM) and logic to provide for sorting of signals having different energy levels. If a relatively large magnitude signal is detected at matched filter primary output  the magnitude and phase offset of the signal can be stored by energy storage and sorting module . There are a variety of ways in which energy storage and sorting module  can be configured to store detection information from matched filter . For example, energy storage and sorting module  can be configured to store information only about signals that are of a magnitude larger than a predetermined value. Alternatively, energy storage and sorting module  can store information about signals of a given magnitude at memory locations associated with the given magnitude. Implementation and configuration of memory and logic components to perform these functions is well known in the art.","As shown in , the output of energy storage and sorting module  is fed into processing control . Processing control  can include a standard microprocessor, memory elements, and data and address busses. Processing control  generally controls the operation of the mobile unit. Additionally, processing control can monitor or control the operation of matched filter  and energy storage and sorting module  via bus lines  and , respectively. For example, it could set threshold energy values which energy storage and sorting module  is to store or clear stored values out of energy storage and sorting module . Implementation and configuration of a microprocessor and other components to perform these functions are described below.","As discussed in the background section, once the mobile unit locates and acquires a relatively strong pilot signal, the pilot signal synchronizes the time base of the mobile unit with the base station that sent the pilot signal. In this way, the mobile unit is provided with the absolute phase offset of the relatively strong pilot signal it is receiving. By comparing when primary searcher  detects the pilot of the currently synchronized base station to the times at which matched filter  detects each relatively strong pilot signal, processing control  can determine the absolute phase offsets of each pilot signal detected by matched filter .","The information concerning phase offset and energy of detected pilot signals can be used by processing control  in a variety of ways. Processing control  could, for instance, alert primary searcher  to begin searching at one or more of the absolute phase offsets mentioned above. Additionally, as noted in the Background section, processing control  makes decisions concerning with which base station the mobile unit should synchronize. Also, as noted in the Background section, processing control  may have synchronized on a base station that is not the closest base station to the mobile unit. Thus, the energy storage and sorting module  could alert processing control  when a signal having a magnitude above a certain threshold is detected. This would allow processing control  to determine whether it should synchronize with a base station other than the one with which it is currently synchronized. This would occur when it is determined from the output of energy storage and sorting module  that a pilot signal detected by matched filter  having an energy level above a certain threshold constitutes the earliest arriving pilot. Alternatively, rather than energy storage and sorting module  provide measurements to processing control  whenever energies above a certain threshold are determined, processing control  could periodically poll the energy storage and sorting module  to check for relatively large magnitude pilot signals at phase offsets other than the phase offset with which the mobile unit is currently synchronized.","As discussed above, each sample received by matched filter  allows searcher  to effectively check for the presence of a pilot signal at a given phase offset. In a preferred embodiment, searcher  preferably acquires a sample about every 0.81 microseconds. Thus, to check for the presence of a pilot signal over the sequence of 32,768 phase offsets requires only about 26.67 milliseconds (ms) due to the incorporation of matched filter , which can advantageously search the entire pilot signal phase offset sequence in a relatively short period of time.","Additionally, matched filter  does not have to be programmable. As discussed above, the digital pattern of a pilot signal is the same for all base stations. It is the phase of the pattern that changes between base stations, and not the pattern itself. Thus, a single portion of this pattern can be permanently configured into matched filter . This advantageously allows matched filter  to be manufactured relatively at a relatively low cost. Also, because matched filter  does not have to be programmable, it can advantageously consume relatively little power.","As shown in , matched filter  and energy storage and sorting module  is preferably used in parallel with primary searcher .  is a block diagram showing the components of primary searcher . Primary searcher  is similar to searcher  discussed in the Background and includes a despreading correlator  and an energy storage and sorting module . A schematic illustrating a preferred embodiment of despreading correlator  is shown in . Despreading correlator  correlates I- and Q-input signals with an expected, or searched for, I- and Q-input signal, as correlator  does with a single expected signal. Correlator  also despreads the pilot signal input, preferably using a QPSK scheme, to correct for any relative phase shifts that may have occurred to pilot signal  during transmission.","Despreading correlator  includes an I-input  and a Q-input , each of which are connected to a Q-multiplexer (Q-MIUX)  and an I-multiplexer (I-MUX) . The output of Q-MUX  is determined by the state of control line  and the output of I-MUX  is determined by the state of control line . The state of control lines  and  is determined by I-expectedinput  and Q-expectedinput  to exclusive-or (XOR) gate . I-expectedand Q-expectedare the I- and Q-components, respectively, of the pilot signal for which despreading correlator  is searching, that is, the expected pilot signal. Control line  contains an inverting buffer  to invert the state output by XOR gate . The output of Q-MUX  serves as one input into XOR gate . The other input to XOR gate  is I-expected, the I-component of the pilot signal for which primaiy searcher  is searching. The output of I-MUX  serves as one input into XOR gate . The other input to XOR gate  is Q-expected, the Q component of the pilot signal for which primary searcher  is searching.","The output of XOR gate  is fed into a Q-integrator  and the output of XOR gate  is fed into I-integrator . Both Q-integrator  and I-integrator  sum the signals on their respective inputs over a predetermined period of time. The outputs of I-integrator  and Q-integrator  are then fed into final integrator , which squares both the values from the outputs of the Q-integrator and I-integrator, and then adds the squared values together to produced an energy output at final output . This value can then be fed into energy storage and sorting module .","Despreading correlator  performs QPSK despreading and correlating on an input signal according to Chart 1 above. Despreading correlator  outputs the (In, Qn) required by chart 1 for an expected digital signal input (I-expected, Q-expected). For example, for (I-expected, Q-expected)=(1,\u22121), according to the second row of Chart 1, the I-outn, which is the signal routed to the I-integrator , should be \u2212Qn, and the Q-outn, which is the signal routed to the Q-integrator, should be In. Thus, if the received Iin and Qin is the expected signal, that is (1,\u22121), then\u2014Qn=1 and this value is routed to the I-integrator  and In=1, and this value is routed to the Q-integrator .","Despreading correlator performs this function as follows: For (I-expected, Q-expected)=(1,\u22121), the output of XOR gate  is 1. Thus, Q-MUX  selects the value of Q, \u22121, to feed XOR gate . If the sampled pilot signal matches this expected signal, that is (I, Q)=(1,\u22121), then I-expected=1 and XOR gate  outputs a 1 to maximally add to the sum performed by Q-integrator . On the I-channel, if the output of XOR 276 is 1, then, due to inverter 278, the control input to I-MUX  will have a value of \u22121. This places Ion I-MUX output . For I=1, and Q-expected=\u22121, the output of XOR gate  will be 1, which maximally adds to the sum performed by I integrator . Matching of other possible combinations of (I-expected, Q-expected) listed in Chart 1 similarly result in 1's being summed by integrators  and . In this way, the signals generated by Q-integrator  and I-integrator  will be relatively large when the pattern of the input signal (I, Q) matches the pattern of the expected signal (I-expectedn, Q-expectedn).","As noted above, the outputs of Q-integrator  and I-integrator  are fed into final integrator , and preferably squared and summed. Thus, if the input into despreading correlator  matches the expected signal, the energy output of final integrator  will be relatively high. Because to generate a high energy output, the input signal must match the expected signal, and the phase of the expected signal must be that of the signal that the primary searcher is attempting to detect.","Additionally, the time over which data for a given phase is to be collected to determine if there is a match is the integration time of integrators  and . Thus, to search for a given phase offset pilot signal, an expected signal of the same phase offset is fed into despreading correlator . Also, the integration time for integrators  and  is set to be equal to the amount of time which data for a given phase offset is to be collected. In this way, matches only for a given phase offset are being added to a final output energy at final output . Like matched filter , despreading correlator  takes input samples at the pilot signal frequency of preferably 1.2288 MHz. This is the same frequency that the expected signal is fed into despreading correlator .","Because 1's are routed to integrators  and  only when there is a match of an expected signal, if the received signal does not precisely match the expected signal, some \u22121's will be routed to integrator  and . This reduced the magnitude of the output of these integrators and, therefore, the output of despreading correlator  from final integrator . As discussed above with respect to , the stronger the pilot signal being received, the more actual chip values will match the ideal, predetermined pilot sequence chip values. Thus, the stronger the pilot signal being received, the more +1's are summed by integrators  and , and the fewer \u22121's that are summed thereby, and the higher magnitude of the output of despreading correlator . In this way, the magnitude of the output of despreading correlator provides an indication of the relative strength of a received pilot signal.","Each match will add only a relatively small amount to the total energy value at output . Therefore, correlator  must take enough samples to be compared with an expected signal to generate a high enough energy so that it may be reasonably determined whether a relatively strong pilot signal has been detected or there is just some random matching occurring. Thus, a given phase expected signal must be fed into despreading correlator  for a long enough period of time collect match data to allow for a reasonable determination of whether a relatively strong match has been detected. Although a predetermined number of consecutive samples must be taken before it can be determined whether a pilot signal is likely present at a given offset, it is possible to terminate the collection of samples prematurely if there is a clear lack of correlation prior to collecting the aforementioned predetermined number of consecutive samples. If, for example, a relatively high energy is being generated, samples can continue to be taken. If, however, a relatively low energy is being generated after a significant portion of the desired samples have been collected, the collected information in integrators ,  and  can be dumped, the phase of the expected signal can be shifted, and the integrations can be restarted from time zero.","The final output  of despreading and correlating module  is preferably fed into energy storage and sorting module . This module can be substantially identical to energy storage and sorting module , shown in , and can operate in substantially the same manner. It is also contemplated that both matched filter  and despreading correlator  feed into the same energy storage and sorting module.","The output of energy storage and sorting module  is connected to processing control . Processing control  can use information stored in energy storage and sorting module  to determine whether the mobile unit is synchronized and receiving data signals from the most appropriate base station. As with energy storage and sorting module , processing control  can poll energy sorting and storage module  on a periodic basis or energy storage and sorting module  can otherwise alert processing control  of energies higher than a predetermined threshold value.","As discussed above, which phase offset pilot signal despreading correlator  is searching for is determined by the phase of the expected signal. Thus, it is possible to search at a first phase offset and then, if no significant energy is being detected, switch to searching at any other phase offset, which may be hundreds or thousands of chips from the first phase offset, simply by changing the phase of the reference signal. Additionally, while the maximum energy information would be obtained by a full 26.6 ms search, if no significant or unexpected energy is being detected at a given phase offset after only a portion of 26.6 ms, the search could be abandoned and a search could be initiated at another phase offset.","Thus, by using correlator  in parallel with matched filter , the correlator  can check phase offsets of base stations around the phase offset of the pilot signal with which the mobile unit is currently synchronized. Simultaneously, matched filter  can advantageously sweep through the entire sequence of phase offsets to check for any other strong pilot signals that correlator  might miss because it is checking only a small subset of the total sequence of pilot signal phase offsets. This advantageously provides the mobile unit with information concerning pilot signal strength over the entire sequence of pilot signal phase offsets in a relatively short period of time (\u02dc26.6 ms) while still allowing monitoring of high priority phase offsets (e.g., the phase offsets of base stations neighboring the currently synchronized base station) at an even higher rate (e.g. two, three or more neighboring phase offsets could be checked in \u02dc26.6 ms).","While use of matched filter  in parallel with despreading and correlating module  provides the above advantages, it is also contemplated to use only matched filter  by itself. Additionally, it is within the ambit of the present invention to use more than one matched filter either in parallel with a correlator or without a correlator. If more than one matched filter is used, the amount of time required to search the entire sequence of pilot signal phase offsets can be reduced. For example, if two matched filters are used, they can be configured to search for pilot signals that are half of the total sequence of 32,768 phase offsets apart from each other, that is 16,384 chips apart from each other. In this way, the total pilot signal phase offset sequence space could be searched in half the time. It is also contemplated to use more than two matched filters in a similar manner.","Both the matched filter , correlator  and energy storage and sorting modules  and  can run substantially independent of processing control . Thus, high energy pilot signals can be detected and their energy and phase offsets stored using only minimal processing control resources. This can advantageously free processor control time for other important mobile unit functions.","It is to be understood that the present invention is not limited to the specific embodiments described above. Many widely different embodiments of the present invention may be constructed without departing from the spirit and scope of the present invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Prior art  is a block diagram of an earlier pilot signal searcher for use in a digital cellular mobile unit.","Prior art  is a block diagram of a greatly simplified correlator for use with the pilot signal searcher shown in .","FIG A is a diagram illustrating a first phase pilot signal and matching detection device detecting of a portion of the first phase pilot signal, and the output of such a matching detection device, in accordance with the present invention.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 3B","FIG. 3"],"i":"a "},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 3C","FIG. 3B","FIG. 3A"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 3D","FIG. 3A"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 5","FIG. 3"]},{"@attributes":{"id":"p-0037","num":"0036"},"figref":["FIG. 6","FIG. 3","FIG. 5"]},{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 7","FIG. 5"]}]},"DETDESC":[{},{}]}
