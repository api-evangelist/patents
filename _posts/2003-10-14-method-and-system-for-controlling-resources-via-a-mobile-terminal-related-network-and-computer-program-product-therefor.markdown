---
title: Method and system for controlling resources via a mobile terminal, related network and computer program product therefor
abstract: Access to resources is controlled via a mobile terminal operatively connected to a network operator, wherein the mobile terminal has an associated authentication module configured for authenticating the mobile terminal with the network operator. The method includes the steps of providing in the mobile terminal at least one facility having authentication capability and adapted for accessing the resources, and authenticating the authentication module with the at least one facility, whereby the at least one facility is authenticated with the network operator via the authentication module.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07734279&OS=07734279&RS=07734279
owner: Telecom Italia S.p.A.
number: 07734279
owner_city: Milan
owner_country: IT
publication_date: 20031014
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATION","FIELD OF THE INVENTION","DESCRIPTION OF THE RELATED ART","OBJECT AND SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION"],"p":["This application is a national phase application based on PCT\/EP2003\/011363, filed Oct. 14, 2003, the content of which is incorporated herein by reference.","The present invention relates to techniques for controlling resources in mobile terminals such as e.g. mobile phones.","Next generation mobile phones will generally be more complex than present-day mobile phones. Specifically, a sophisticated processor (the application processor) will be added to the communication processor in charge of performing the digital signal processing tasks and supporting the basic user interface and applications in current mobile phones. Additional peripherals will also expectedly be present.","In present-day mobile phones, the SIM (Subscriber Identification Module) authentication capabilities are used only to register the user with the network operator, as specified in the 3GPP TS 03.20 Specification \u201cSecurity related network functions\u201d. A description of SIM commands and security related functions available in the SIM can also be found in the 3GPP TS 11.11 Specification \u201cSpecification of the Subscriber Identity Module-Mobile Equipment (SIM-ME) interface\u201d. Present-day mobile phones are thus essentially mobile terminals adapted to be operatively connected to a network operator, each such mobile terminal having an associated authentication module configured for authenticating the mobile terminal with the network operator.","In addition, in US 2002\/0169717 a system and a method are described for installing a remote credit card authorization on a system with a TCPA (Termination Customer Provided Access) compliant chipset.","In U.S. Pat. No. 5,608,778 and U.S. Pat. No. 6,397,333 the possibility is generally disclosed of using a cellular telephone as an authenticated transaction controller and within the framework of a copy protection system, respectively.","Finally, in GB-A-2 373 679 the possibility is described of accessing bookmarks in a mobile communication device, in the arrangement disclosed, the memory is neither protected nor authenticated by the SIM.","The Applicant has tackled the problem of controlling the access to resources of a mobile terminal, e.g. a multimedia card or an application processor, restricting such access to authorized\/authenticated users.","The basic object of the present invention is thus to provide improved exploitation of SIM capabilities within the framework of a sophisticated mobile phone terminal including e.g. an application processor and\/or adapted to efficiently support additional peripherals with respect to present-day mobile phone layouts.","According to the present invention, that object is achieved by means of a method having the features set forth in the claims that follow. The invention also relates to a corresponding system, a related network as well as a related computer program product, loadable in the memory of at least one computer and including software code portions for performing the steps of the method of the invention when the product is run on a computer. As used herein, reference to such a computer program product is intended to be equivalent to reference to a computer-readable medium containing instructions for controlling a computer system to coordinate the performance of the method of the invention.","A preferred embodiment of the invention is thus a method of controlling resources via a mobile terminal operatively connected to a network operator. The mobile terminal has an associated authentication module (e.g. a SIM-type card) configured for authenticating the mobile terminal with the network operator. A preferred embodiment of the invention includes the step of providing in the mobile terminal at least one facility having authentication capability and adapted for accessing said resources, and the step of authenticating the authentication module with the at least one facility. The facility is thus authenticated with the network operator via the authentication module.","In brief, the basic idea underlying the invention is to control e.g. access to peripherals and the applications running on the application processor associated with a mobile phone\/terminal with the help of the SIM card.","At present, no terminal equipment architectures are known that take advantage of the SIM authentication capabilities to restrict the access to some of the resources available in the terminal or terminal peripherals. The core of the arrangement described herein thus lies in that, in addition to performing authentication towards the network(s), the operator authentication mechanism can likewise authenticate on-board peripherals or applications.","Additionally, the possibility of authenticating peripherals makes it possible to selectively reserve at least part of the peripheral functionalities for use by the operator. The remaining part of the peripheral functionalities can be accessed in a transparent manner by the user applications.","As indicated,  is a schematic representation of a typical environment of use of the arrangement described herein. In , two mobile terminals (e.g. two mobile phones) TM are shown included in respective mobile communication networks operated by respective network operators NO. Each of the terminals TM includes a SIM card as well as a MMC\/SD (MultiMediaCard\/Secure Digital) module. Specifically, the right hand portion of  shows how the network operator NO may enlarge its trusted environment from the SIM card to the added peripherals","In order to allow the enlargement of the environment trusted by the network operator NO, a controller and some authentication capabilities, equivalent to those that are typically present in a GSM SIM card (i.e., more generally, a \u201cSIM-type\u201d card), are embedded in the added peripheral.","It will be appreciated that\u2014as used herein\u2014the designation \u201cSIM-type\u201d card is intended to cover also those cards configured for performing within the framework of a system different from a GSM system authentication functions that are equivalent to those functions performed by a SIM card in a GSM system. Exemplary of such \u201cSIM-type\u201d cards are e.g. U-SIM cards (for UMTS systems), R-UIM (as described in the 3GPP2.C S0023 specification in connection with CDMA 2000 Spread Spectrum systems), authentication smart cards for use in WLANs, and the like.","In the arrangement described herein, one added peripheral is represented by a MMC module containing the service application code and data. A typical MMC is only a storage medium, which can store a certain amount of information. In the arrangement described herein an embedded card controller CC is added to the MMC, in order to allow the network operator NO to control a part of this medium and to restrict only to trusted users some services contained in the medium.","In order to perform these tasks the Card Controller has authentication capabilities equivalent to a GSM SIM card. In a GSM SIM card, the authentication capabilities are: the presence of a unique identification number (named IMSI), the presence of a secret authentication key K, and the possibility to execute the authentication algorithm named A3 (Administration, Authorization, and Authentication). This algorithm uses the authentication key Kin order to compute a unique response SRES to a given input value RAND.","When a GSM SIM card user tries to connect to the network operator, the network operator identifies the GSM SIM card by means of the IMSI, generates a random number RAND, and sends it to the GSM SIM card. Starting from the value RAND, the GSM SIM card computes the response SRES by means of the authentication algorithm A3 and of its secret key K.","This response SRES is sent back to the network operator NO. Since the network operator NO knows the GSM SIM card secret key K, it can evaluate what the expected response SRES is and verify if the received SRES is the same it calculated for itself. If the received response and the computed expected response are the same, then the network operator can successfully authenticate the GSM SIM card.","A similar mechanism can be used to let the network operator NO authenticate the MMC card. For that purpose the card controller embedded in the MMC contains a unique MMC id number (equivalent to the IMSI), a unique secret key K(equivalent to K), and the capability of performing the A3 algorithm. By means of this authentication procedure, the network operator can trust the MMC card and operate with it.","Moreover, as will be detailed in the following, a similar procedure can be used to restrict the access to the MMC card contents only to trusted users. In this case, when a user tries to access the MMC card, the MMC Card Controller CC requests the user to authenticate itself. The user authenticates itself by means of the GSM SIM card. As will be detailed later, in this case, in order to perform the authentication procedure with the MMC card the GSM SIM card must know the secret key Kof the MMC card, and must be able to perform the authentication algorithm A3 using the key Kinstead of its own key K.","As shown in , a possible architecture for the arrangement described herein is comprised of:\n\n","More in detail, the application processor AP is an off-the-shelf processor running an advanced operating system (in a preferred case, Embedded Linux). The processor is not protected by any logic and is not specifically authenticated. It runs the basic applications required to manage the mobile terminal.","The user can control these applications and can insert own programs. At least in principle, an expert user may maliciously control also the inner part of the operating system: stated otherwise, the operator NO has no knowledge of what the processor AP is doing and cannot trust on the behavior of these applications.","The application processor AP communicates with the rest of the system through a bus . Specifically, it will communicate with the other peripherals via read and write operations performed through this bus.","The communication processor CP is in charge of establishing the communication channels towards the network. It communicates with the radio frequency part of the terminal TM and processes the digital information. It strictly communicates with the SIM card to manage the network authentication phase and basic functionalities such as address book, text messages and so on. Additionally, it provides the SIM card with some API (Application Programming Interface) functionalities to be used through a so-called SIM toolkit.","The smart card reader  is adapted to manage the SIM card, e.g. by delivering to it the commands coming from the communication processor CP. In the arrangement described herein the smart card reader  is made available to the application processor AP and to the other peripherals . In that way the authentication features are made available not just to the network but also locally to the different devices or applications in the mobile terminal TM. The smart card reader  can thus be used by different peripherals through a shared bus such as the bus .","The multimedia\/secure digital reader  is configured to read the MMC\/SD card. The corresponding interface is in compliance with MultiMediaCard (MMC) Specification V2.2 and the SD Memory Card Specification V1.0. As previously stated, in comparison with a usual MMC\/SD card (used only for storage purposes), in the arrangement described herein a modified MMC\/SD card is used, which has the same interface to access data stored in the MMC\/SD card, but which also includes some logic (the card controller CC) to perform the authentication tasks. This can be accomplished just with some logic which only performs the exchange of the value RAND, the management of the key Kand the generation of the response SRES; however more complex logic which also performs other service specific tasks can be used, or even an embedded processor.","The additional peripherals  can be connected and accessed by the application processor AP. The respective interfaces can include the logic required in order to authenticate the SIM card as better described in connection with the (modified) MMC\/SD card.","Of course, the authentication method described herein can be used also with other peripherals different from a MMC card, provided these have a controller similar to the card controller CC, adapted to perform the authentication operations. The access method will thus be identical to the one described in connection with the MMC card, while the application processor AP will use another interface in order to communicate with the peripheral in question.","As is well known, the SIM card is a small printed circuit (PC) board adapted to be inserted in any GSM-based mobile phone when signing on as a subscriber. It contains the subscriber details, security information and a memory area for a personal directory of numbers. The card includes a microchip that stores information and encrypts voice and data transmissions, thus making it difficult and virtually impossible to eavesdrop on-going calls. The SIM card also stores data D that identifies the caller to the network, i.e. the IMSI (International Mobile Subscriber Identity, which uniquely identifies the SIM card owner) and an authentication key KAdditionally, the SIM card can perform the so-called A3 or AAA (Administration, Authorization, and Authentication) algorithm.","In order to perform the authentication scheme considered herein, a MMC\/SD card including at least some authentication capability is required: the card must contain some logic (e.g. a card controller) allowing access to the contents therein only when the authentication algorithm has been successfully completed. In the MMC\/SD card, a processor or some accelerators will be present that can export functions or procedures. The application processor AP can ask for a Remote Procedure Call passing to the MMC\/SD the argument of the function. In that way, the application can be partitioned between the application processor AP and the MMC\/SD.","The sensitive part of the application, adapted to give value to the service(s) rendered by the system, can be inserted in the MMC\/SD. The arrangement described herein is adapted to enhance mobile terminal performance based on \u201cscalable\u201d solution starting from a simple mobile terminal. The concept can be extended to other peripherals that are required for providing a service. In that way, the portfolio of services offered is no longer limited by the resource of the terminal.","A card controller CC is in charge of keeping track of those services that require authentication. In order to do so, the controller CC may partition the memory space of the card in two regions. One of these (indicated as UFS) is for free services and data, while the other (indicated as RS) is for services requiring authentication. The card controller CC adjusts the amount of space reserved to one area with respect to the other as new space becomes necessary for authentication-requiring services.","In the proposed architecture, it is assumed that the MMC\/SD card controller will perform an authentication algorithm exactly as is the case for the SIM card. With that purpose, the card contains a unique MMC \u201cid card\u201d number, a unique 128 bit authentication key, K, which is the equivalent of the Kkey for a SIM card. Additionally it can run the GSM A3 (or AAA) algorithm, which is used in conjunction with the application key Kin order to complete authentication, as specified in 3GPP TS 03.20 Standard \u201cSecurity related network functions\u201d.","The application processor is configured for running a number of software modules.","A basic one of these is the operating system (OS), such as e.g. a Linux operating system. The operating system is in charge of managing the processes on the application processor AP, communication with the peripherals , the first user authentication, and the file system.","The OS is a multi-user OS, adapted to grant simultaneous access to at least two different users, namely:\n\n","Optionally, also other users, as for example third parties offering other services, can be supported by the OS.","The smart card reader interface module manages communication with the SIM card. It translates a user readable protocol into the smart card command protocol. The applications involved can be both system applications, which manage the user interaction and the man-machine interface (MMI), and algorithms that perform certain functionalities or user specific applications.","The MMC\/SD filesystem management module performs the management of the MMC\/SD storage space. The presence of the MMC\/SD is thus made transparent to the application. It becomes part of the usual filesystem of the operating system, by leaving access to the files stored into the device essentially unchanged with respect to the case of a file stored in the usual file storage memory. As better detailed in the following, before access of an application to the MMC\/SD card, this module performs a dialogue with the card controller in order to authenticate the user SIM card.","By means of the architecture shown in , the operator NO can improve performance of the terminal equipment TM with advanced services stored in a MMC\/SD card, thus exploiting the computing power of the application processor AP and\/or additional features provided by possibly customized peripherals, while at the same time controlling the availability of these services by restricting access to SIM authenticated users only.","In the arrangement described herein, a proprietary application (such as a game application) may be executed in a transparent mode by the application processor AP, while the basic data and functions related thereto are stored in the MMC\/SD card.","As detailed in , when the application processor AP requests a Remote Procedure Call which involves the MMC\/SD card, the MMC\/SD filesystem management module (indicated MMC FSMM) initiates (step ) a dialogue with the MMC\/SD card controller CC (MMC CC). The card controller verifies (step ) if the service that the module is trying to access is a \u201cfree\u201d service (UFS) or a \u201crestricted\u201d service (RS) requiring authentication.","If the service does not require authentication, the service is simply provided (step ).","If the service requires authentication, the card controller CC initiates a procedure that, through SIM authentication, checks if the current user can access the requested service.","In the first place, the card controller CC passes (step ) the MMC\/SD card number to the management module, which verifies (steps  and ) if the MMC\/SD card is registered in the SIM card of the user: a MMC\/SD card is registered in the SIM card if the MMC\/SD card number and its authentication key Kare stored in the SIM card.","If this is not the case, then this is the first time that this MMC\/SD card is used with that SIM, and a registering procedure involving the network operator must be performed (step ), as better detailed in the following later.","Conversely, if the MMC\/SD card number and authentication key are found in the SIM card, the management module acknowledges the card controller (step ) and continues the access procedure. The card controller sends (step ) a random value RAND to the management module. The module passes (step ) the RAND value to the SIM together with the command RUN GSM ALGORITHM.","The SIM uses the value RAND and the MMC\/SD authentication key Kas an input for the algorithm A, which generates the value SRES (step ). The module sends (step ) SRES to the card controller. The card controller compares (step ) this value with the value of SRES calculated by using its stored key K.","If the comparison is unsuccessful, the authentication phase is aborted (step ).","Conversely, a successful comparison of the SRES values provides the authentication and grants access to the MMC\/SD card contents (step ). These can be, for example, the application code and data of an advanced service either downloaded by the network or embedded in the card (e.g, games, transaction and distributed applications, MP3s).","As previously stated, the authentication procedure here described can be completed only if the MMC\/SD card is registered in the SIM. If the MMC\/SD card number passed by the card controller is not found in the SIM card, the MMC\/SD filesystem module MMC FSMM starts the procedure shown in .","As a first step (step ) the module opens a connection with the network operator NO, and performs the classical SIM card authentication algorithms: the network sends (step ) a Random Number (RAND) to the management module, and the module (step ) passes the RAND to the SIM together with the command RUN GSM ALGORITHM. The SIM uses the value RAND and the authentication key Kas input for the algorithms Aand A, which generate respectively the values SRES and K. The SIM module sends SRES and Kto the MMC FSMM module (step ) and this latter in turns relays these values to the network. This occurs in a step , preferably over an enciphered link designated . The value Kis used by the mobile equipment TM to encipher the communication with the network.","The network compares (step ) the value for SRES with the value of SRES calculated locally by means of the Kkey, which is known to the network. The comparison of these SRES values negates (step ) or recognizes authentication (step ).","Once the SIM card is authenticated with the network and a secure enciphered communication link is established, the MMC\/SD filesystem management module should require the network to authenticate the MMC\/SD card. This is accomplished by sending (step ) the MMC\/SD card number to the network: the network verifies (step ) that the number is an available one and that the SIM identified user is authorized to use that MMC card.","A negative outcome of comparison leads to service failure (step ). In the case of a positive outcome authentication of the MMC card is effected with the same authentication procedure previously described, i.e.:\n\n","Once the MMC\/SD card is authenticated, the networks registers (step ) the MMC\/SD card number and the authentication key Kin the SIM card. From here onwards the MMC\/SD card will be recognized as \u201cregistered\u201d, and the authentication procedure initiated by the card controller will be performed as described previously.","The same authentication procedure described in the foregoing in connection with access to a MMC\/SD card, can be implemented in order to restrict access to whatever peripheral possibly associated with the terminal TM.","This is possible as long as an authentication module equivalent to the card controller CC is embedded in the peripheral and the driver module of the peripheral is configured in order to manage the dialogue with this controller.","Since the authentication keys and the registering information are stored in the SIM card and in the peripheral controller, the peripheral can still be used with the registered SIM card even if the terminal is changed.","This is made possible by the availability of a SIM card that can perform the authentication algorithm Ausing the peripheral authentication key, K, instead of its authentication key K. Moreover, the SIM card will provide the possibility to store in a protected manner the secret authentication key of the peripheral, K.","As an alternative, the MMC\/SD card can be used only to store the fundamental data of new services, instead of both data and procedures. In that case, a processor embedded in the MMC\/SD card will not be required, since only a minimum amount of logic necessary to implement the card controller functionalities is required.","The authentication mechanism will remain unchanged, the only difference being that, instead of being started when the application processor asks for a Remote Procedure Call involving the MMC\/SD, the mechanism will be started when the application processor tries to access the portion of memory that the card controller has reserved for authentication requiring data.","The authentication arrangement described herein can be applied also to a non-GSM wireless connection (e.g. a WLAN environment), as long as the following elements are present:\n\n",{"@attributes":{"id":"p-0073","num":"0092"},"figref":"FIG. 5"},"As is shown, the following steps are involved:\n\n","As shown at step  in , if not available with the authentication module AM, the necessary information for authentication is downloaded from the network operator NO.","This is accomplished by means of a registration procedure that is presented in  and involves the following steps:\n\n","The presence of an advanced authentication module AM that can \u201clearn\u201d from the network operator how to provide authentication via the MMC\/SD card avoids that the network operator NO may be involved in the authentication procedure each time that the user tries to use an authentication-requiring service offered by the MMC\/SD card.","However, this module can be reduced to a classical authentication module that establishes the connection with the network operator NO, and the authentication procedure can be implemented as shown in  and detailed in the following steps:\n\n","Of course, without prejudice to the underlying principles of the invention, the details and the embodiments may vary, also appreciably, with reference to what has been described by way of example only, without departing from the scope of the invention as defined by the annexed claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE ANNEXED DRAWINGS","p":["The invention will now be described, by way of example only, by referring to the enclosed figures of drawing, wherein:",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIGS. 3 to 7"}]},"DETDESC":[{},{}]}
