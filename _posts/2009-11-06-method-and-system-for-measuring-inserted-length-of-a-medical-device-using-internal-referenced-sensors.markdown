---
title: Method and system for measuring inserted length of a medical device using internal referenced sensors
abstract: Measured locations of position sensors on a steerable medical device are used to determine the insertion depth of the steerable medical device with respect to a foundation point, which is initialized by an operator. The insertion depth, in turn, is used to determine the state of each segment that has passed the foundation point, i.e., is distal to the foundation point.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09055865&OS=09055865&RS=09055865
owner: INTUITIVE SURGICAL OPERATIONS, INC.
number: 09055865
owner_city: Sunnyvale
owner_country: US
publication_date: 20091106
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The present application claims the benefit of U.S. Provisional Patent Application No. 61\/113,444 filed Nov. 11, 2008 entitled \u201cMethods for Measuring the Inserted Length of an Endoscope Based Using Internal Global-Referenced Sensors\u201d naming as inventor, Caitlin Donhowe, the entirety of which is hereby incorporated by reference.","1. Field of Invention","Aspects of this invention are related to measuring the inserted length of an endoscope, and more particularly to measuring the inserted length of an endoscope without an external position sensor at the body entry point of the endoscope.","2. Related Art","An endoscope is a medical instrument for visualizing the interior of a patient's body. Endoscopes have been used for a variety of medical diagnostic procedures and for a variety of medical interventional procedures.","Many different types of endoscopes are known. For example, one steerable endoscope has an elongated body with a steerable distal portion and an automatically controlled proximal portion. Such an endoscope is described in U.S. Pat. No. 6,468,203 B2, entitled \u201cSteerable Endoscope and Improved Method of Insertion,\u201d of Amir Belson issued on Oct. 22, 2002, which is incorporated herein by reference in its entirety.","A common problem with using an endoscope is determining the insertion depth of the endoscope during the procedure. One way to determine the insertion depth is to use an external position sensor at the entry point of the endoscope into the body of the patient. See for example, U.S. Patent Application Publication No. US 2007\/0249901 A1 published on Oct. 25, 2007 for U.S. patent application Ser. No. 11\/648,408, entitled \u201cInstrument Having Radio Frequency Identification Systems and Method for Use,\u201d of Ohline et al. filed on Dec. 28, 2006.","Unlike prior art methods that required an external position sensor to determine the insertion depth of a steerable medical device, the measured locations of position sensors on a steerable medical device are used to determine the insertion depth of the steerable medical device with respect to a foundation point. The foundation point, in one aspect, is initialized by an operator. The insertion depth, in turn, is used to determine the state of each medical device segment that has passed the foundation point, i.e., each segment that is distal to the foundation point.","In one aspect, a set of position data from a plurality of position sensors on the steerable medical device is received by a processor. The steerable medical device includes a plurality of segments. In one embodiment, a segment is bounded by a pair of the position sensors such that the number of position sensors is one more than the number of segments.","The processor generates a number of active segments of the steerable medical device and a number of articulating segments of the steerable medical device using the set of position data and a location of a foundation point. The processor sends a command to the controller for the steerable medical device to configure the steerable medical device to have the number of active segments and the number of articulating segments.","To generate the number of active segments of the steerable medical device and the number of articulating segments, the processor analyzes data of a first position sensor located on the proximal end of the most proximal currently active segment to determine a position of the first position sensor relative to the foundation point. The processor also analyzes data of a second position sensor located on the distal end of the most proximal currently active segment to determine a position of the second position sensor relative to the foundation point.","The analyzing includes generating a distance dfrom the proximal position sensor to the foundation point. The analyzing also includes generating a distance dfrom the distal position sensor to the foundation point, and generating a distance dfrom the proximal position sensor to the distal position sensor.","After determination of the distances, in one aspect, the processor compares the distance dand the distance dto determine whether distance dis less than distance d. The processor changes the number of articulating segments upon finding that the distance dis less than distance dif the most proximal active segment does not already have state articulating.","In another aspect, the processor compares the distance dand the distance dto determine whether distance dis greater than distance d. The processor changes the number of active segments upon finding distance dis greater than distance d.","In another aspect, each segment includes a plurality of links. In this aspect, generating the number of active segments of the steerable medical device and the number of articulating segments of the steerable medical device includes generating locations of a plurality links in a segment using a kinematic model for the segment. A centerline representation of the steerable medical device is generated using the locations. An insertion depth of the steerable medical device is generated using the centerline representation.","In one aspect, the processor is included in an apparatus that also includes a memory coupled to the processor. The memory has instructions stored therein. Executing the instructions on the processor performs the various operations described above.","In yet another aspect, an apparatus includes a steerable medical device. The steerable medical device includes a plurality of articulatable segments and a plurality of position sensors.","This apparatus also includes a controller coupled to the steerable medical device. The controller includes (i) a processor coupled to the steerable medical device to receive position data from the plurality of sensors and to receive data defining a foundation point, and (ii) a steerable medical device controller coupled to the steerable medical device to configure the plurality of articulatable segments.","The processor analyzes the position data with reference to the foundation point to generate a number of the plurality of segments having an active state and a number of the plurality of segments having an articulating state. The processor outputs a command to the steerable medical device controller to configure the steerable medical device to have the number of the plurality of segments having the active state and the number of the plurality of segments having the articulating state.","In the drawings, the first digit of a figure number indicates the figure in which the element with that figure number first appeared.","In one aspect, a steerable endoscope  () includes a plurality of segments -, -, . . . -. Steerable endoscope  includes a plurality of global position sensors , , , . . . , ,  fixed at known locations on steerable endoscope . Steerable endoscope  has a distal end , where the tip of steerable endoscope  is located, e.g., where the camera is located. The operator commands the position and orientation of the tip directly.","Herein, steerable endoscope  is an example of a steerable medical device that includes a plurality of segments. Accordingly, the description of steerable endoscope  is illustrative only and is not intended to be limiting to this specific steerable medical device.","Unlike prior art methods that required an external position sensor to determine the insertion depth of steerable endoscope , the measured locations of at least a pair of global position sensors in global position sensors , , , . . . , ,  is used to determine the insertion depth of steerable endoscope  with respect to a foundation point . Foundation point  is initialized by an operator, such as a surgeon. The insertion depth, in turn, is used to determine the state of each segment that has passed foundation point , i.e., is distal to foundation point .","Foundation point  can be either internal or external to the body of the patient. In some procedures, foundation point  is a physiological reference position inside the body of the patient. However, in general, the location of foundation point  depends on the entry point for endoscope .","When the tip of endoscope  reaches a location that the operator wants to use as a foundation point, the operator selects the location of the tip as foundation point . Thus, the spatial location of foundation point  is the spatial location of the tip of endoscope  at the moment selected by the operator so that subsequent to that moment, the spatial location of foundation point  is known.","In this aspect, three states are defined for each segment of endoscope . The three states are passive, active, and articulating. Each segment has either an active or a passive state. In addition, a segment with an active state may also have an articulating state. Thus, in this aspect, a single segment may be in one of three conditions: a passive state, an active state, and dual active and articulating states. These states are illustrative only and are not intended to be limiting. In view of this disclosure, other states could be used.","In one aspect, segments completely proximal to foundation point  each have a passive state. Segments completely distal to foundation point  each have both an active state and an articulating state. A segment with a first portion distal to foundation point  and a second portion proximal to foundation point  can have either an active state alone, or this segment can have both an active state and an articulating state, as described more completely below.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIGS. 1A to 1G","b":["150","100","100"]},"First segment - is an edge case and is always set to state active and state articulating because the tip of endoscope  is assumed to be active and articulating. Thus, in , the number of active segments is one, and the number of articulating segments is one.","In , endoscope  has been moved (e.g., inserted) so that the plane perpendicular to the insertion direction of endoscope  containing foundation point  is between global position sensor  and  (within segment -). After the movement and before the conclusion of the processing of the new data set for the position in , the two global position sensors bounding the most proximal currently active segment are global position sensors  and .","In , endoscope  has been moved (e.g., withdrawn) so that the plane perpendicular to the insertion direction of endoscope  containing foundation point  is back in segment -. After the movement and before the conclusion of the processing of the new data set for the position in , the two global position sensors bounding the most proximal currently active segment are global position sensors  and . After this movement, foundation point  is bounded by global position sensors  and .","In , endoscope  has been moved back to the same position as in .","In , endoscope  has been moved farther into the patient, but foundation point  is not past the half-way point of segment -. After the movement and before the conclusion of the processing of the new data set for the position in , the two global position sensors bounding the most proximal currently active segment are global position sensors  and . After this insertion movement, foundation point  is still bounded by global position sensors  and .","In , endoscope  has been moved even farther into the patient so that foundation point  is positioned past the half-way point of segment -. After the movement and before the conclusion of the processing of the new data set for the position in , the two global position sensors bounding the most proximal currently active segment are global position sensors  and . After this insertion, foundation point  still is bounded by global position sensors  and .","In , endoscope  has been withdrawn from the patient so that foundation point  is no longer positioned past the half-way point of segment -. After the withdrawal and before the conclusion of the processing of the new data set for the position in , the two global position sensors bounding the most proximal currently active segment are global position sensors  and . After this withdrawal, foundation point  is still bounded by global position sensors  and .","As endoscope  is moved as illustrated in , a processor determines the number of active and the number of articulating segments when a new set of global position data is received. The movements used are illustrative only and are not intended to be limiting.","Further, the determination of the numbers of active and articulating segments for each new set of global position data is illustrative only and is not intended to be limiting Depending on the frequency that a new set of global position data is generated, every new set of global position data may not be processed, e.g., every n-th new set might be processed where n is an integer number. As explained more completely below, in one aspect, an assumption is made about state transitions of segments in endoscope . The position of endoscope  relative to foundation point  should be updated using a new set of global position data at a frequency that supports this assumption.","For each new set of global position data processed, at least three distances are generated: a distance dfrom the distal global position sensor to the foundation point; a distance dfrom the proximal global position sensor to the foundation point; and a distance dbetween the proximal global position sensor and the distal global position sensor. In one aspect, the distal global position sensor and the proximal global position sensor used in the distance determinations are the proximal global position sensor and the distal global position sensor bounding the currently most proximal active segment. As used herein, an active segment is a segment with a state of active.","With respect to index i, the global position sensors are numbered starting at distal end  of endoscope  and proceeding towards proximal end  (), with sensor  at distal end  of endoscope  having an index with a value of one (i=1). For a pair of global position sensors, the value of index i is the number of the proximal global position sensor in the pair.","Also, in this example, each segment is bounded by a pair of global position sensors. The total number of global position sensors is the number of segments plus one.","In one aspect, the positions of the global position sensors are sampled at least with a frequency such that at most a single state change occurs in only a single segment between adjacent sets of global position data that are analyzed. This means that if endoscope  has two segments articulating and two segments active, the next state of endoscope  is one of the following combinations: unchanged; two segments articulating and three segments active; and one segment articulating and two segments active, e.g., at most a single state change for a single segment has occurred between new sensor data sets that are analyzed.","Table 1 includes for the position of foundation point  in each of : the distal and proximal sensors of the most proximal active segment; the most proximal active segment; a result of the comparison of d<d; a result of the comparison of d>dor d>d; and a command that is set to the motors of endoscope  as a result of the movement of endoscope .",{"@attributes":{"id":"p-0056","num":"0055"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"7"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"63pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"56pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"6","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"7","colwidth":"49pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}},{"entry":[{},"Distal Sensor","Proximal Sensor","Most Proximal",{},"d> d",{}]},{"entry":[{},"i \u2212 1 for most","i for most Proximal","Active Segment",{},"(Seg. i Active)",{}]},{"entry":["Current","Proximal Active","Active Segment","Prior to New",{},"or d> d","Motor"]},{"entry":["FIG.","Segment (Ref No)","(Ref No)","Data (Ref No)","d< d","(Seg. i Passive)","Command"]},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["FIG. 1B","1 (111)","2 (112)","(101-1)","Don't","d> d","Num. Act. = 2"]},{"entry":[{},{},{},{},"Care","True","Num. Art. = 1"]},{"entry":["FIG. 1C","2 (112)","3 (113)","(101-2)","Don't","d> d","Num. Act. = 1"]},{"entry":[{},{},{},{},"Care","True","Num. Art. = 1"]},{"entry":["FIG. 1D","1 (111)","2 (112)","(101-1)","Don't","d> d","Num. Act. = 2"]},{"entry":[{},{},{},{},"Care","True","Num. Art. = 1"]},{"entry":["FIG. 1E","2 (112)","3 (113)","(101-2)","d< d","d> d","Num. Act. = 2"]},{"entry":[{},{},{},{},"False","False","Num. Art. = 1"]},{"entry":["FIG. 1F","2 (112)","3 (113)","(101-2)","d< d","Don't","Num. Act. = 2"]},{"entry":[{},{},{},{},"True","Care","Num. Art. = 2"]},{"entry":["FIG. 1G","2 (112)","3 (113)","(101-2)","d< d","Don't","Num. Act. = 2"]},{"entry":[{},{},{},{},"False","Care","Num. Art. = 1"]},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}}]}}}}},"With respect to , the distances generated are a distance dfrom distal global position sensor  to the foundation point , a distance dfrom proximal global position sensor  to foundation point , and a distance dbetween proximal global position sensor  and distal global position sensor ill. Foundation point  is bounded by a new set of global position sensors (sensors , ), and so foundation point  is located in a new segment (segment -). The insertion depth of endoscope  has increased relative to foundation point .","Distance dis greater than distance d, because foundation point  is farther from distal global position sensor  than the distance between proximal global position sensor  and distal global position sensor . Thus, the result of the comparison of d>dis TRUE.","When the comparison of d>dis TRUE, it is not necessary to determine whether the comparison of d<dis TRUE, because of the limitation that at most a single state change occurs in only a single segment between adjacent sets of global position data. Thus, the comparison of d<dfor this movement of endoscope  is listed as a Don't Care condition in TABLE 1.","When the comparison of d>dis TRUE, the segment (segment -) proximal to the previously most proximal segment (segment -) must be activated. Thus, the number of active segments is changed from one to two, and the number of articulating segments remains unchanged at one. When the controller for endoscope  (See ) receives the command with the number of active segments and the number of articulating segments, the controller activates the specified numbers starting with the most distal segment.","With respect to the movement of endoscope from the position shown in  to the position shown in , the distances generated for the new set of global data are a distance dfrom distal global position sensor  to the foundation point , a distance dfrom proximal global position sensor  to foundation point , and a distance dbetween proximal global position sensor  and distal global position sensor . Foundation point  is bounded by a new set of global position sensors (sensors , ) and so foundation point  is located in a new segment (segment -). The insertion depth of endoscope has decreased relative to foundation point .","Distance dis greater than distance dbecause foundation point  is farther from proximal global position sensor  than the distance between distal global position sensor  and proximal global position sensor . Thus, the result of the comparison of d>dis TRUE.","When the comparison of d>dis TRUE, it is not necessary to determine whether the comparison of d<dis TRUE, because of the limitation that at most a single state change occurs in only a single segment between adjacent sets of global position data. Thus, the comparison of d<dfor this movement of endoscope  is listed as a Don't Care condition in TABLE 1.","When the comparison of d>dis TRUE, the currently most proximal active segment (segment -) must be made passive. Thus, the number of active segments is changed from two to one, and the number of articulating segments remains unchanged at one.","The movement of endoscope  from  to  is the same as that in . Thus, when endoscope  is inserted farther into the patient as represented by the transition for , the number of active segments is changed from one to two, and the number of articulating segments remains unchanged at one.","With respect to the movement of endoscope from the position shown in  to the position shown in , the distances generated for the new set of global data are a distance dfrom distal global position sensor  to the foundation point , a distance dfrom proximal global position sensor  to foundation point , and a distance dbetween proximal global position sensor  and distal global position sensor . Foundation point  is not bounded by a new set of global position sensors and so foundation point  is not located in a new segment.","Distance dis greater than distance d, because distal global position sensor  is closer to foundation point  than proximal global position sensor . Thus, the result of the comparison of d<dis FALSE.","However, since most proximal active segment - does not have state articulating, this comparison could be true because the foundation point remained in the same segment or because the foundation point is now located in a more distal segment. Thus, to determine whether the foundation point is located in the more distal segment, distance dis compared to distance d. Since the foundation point remained in the same segment in , this comparison is FALSE.","Thus, when the result of the comparison of d<dis FALSE and the most proximal segment with state active does not have state articulating and the result the comparison of d>dis also FALSE, the state of the most proximal active segment - remains active. Thus, the number of active segments is unchanged and remains at two. The number of articulating segments remains at one.","With respect to the movement of endoscope  from the position shown in  to the position shown in , the distances generated for the new set of global data are a distance dfrom distal global position sensor  to the foundation point , a distance dfrom proximal global position sensor  to foundation point , and a distance dbetween proximal global position sensor  and distal global position sensor . Foundation point  is not bounded by a new set of global position sensors and so foundation point  is not located in a new segment.","Distance dis less than distance d, because proximal global position sensor  is closer to foundation point  than distal global position sensor . Thus, the result of the comparison of d<dis TRUE.","When the comparison of d<dis TRUE, it is not necessary to determine the outcome of the comparison of d>dor the outcome of the comparison of d>dbecause of the limitation that at most a single state change occurs in only a single segment between adjacent sets of global position data. Thus, the comparisons of d>dand d>dfor this movement of endoscope  are listed as a Don't Care condition in TABLE 1.","When comparison of d<dis TRUE, the state of most proximal active segment - remains active, and the state of most proximal active segment - also is changed to articulating if that segment does not already have state articulating. Thus, the number of active segments is unchanged, and remains at two. The number of articulating segments is changed from one to two.","When endoscope  moves so that foundation point  remains in segment -, and the comparison of d<dis TRUE, the state of current segment - remains unchanged. The number of active segments is unchanged and remains at two. The number of articulating segments also is unchanged and remains at two.","However, if endoscope  moves from the position shown in  to the position shown in , the distances generated for the new set of global data are a distance dfrom distal global position sensor  to the foundation point , a distance dfrom proximal global position sensor  to foundation point , and a distance dbetween proximal global position sensor  and distal global position sensor . Foundation point  is not bounded by a new set of global position sensors, and so foundation point  is not located in a new segment.","Distance dis greater than distance d, because distal global position sensor  is closer to foundation point  than proximal global position sensor . Thus, the result of the comparison of d<dis FALSE.","When the result of the comparison of d<dis FALSE and the most proximal segment with state active also has state articulating, it is not necessary to determine the outcome of the comparison of d>dor the outcome of the comparison of d>dbecause of the limitation that at most a single state change occurs in only a single segment between adjacent sets of global position data. Thus, the comparisons of d>dand d>dfor this movement of endoscope  are listed as a Don't Care condition in TABLE 1.","Thus, when the result of the comparison of d<dis FALSE and the most proximal segment with state active also has state articulating, the state of the most proximal active segment - remains active and the state of articulating is dropped. Thus, the number of active segments is unchanged and remains at two. The number of articulating segments is changed from two to one.","The above examples assumed that the first time endoscope  moved so that foundation point  was bounded by a new segment, the state of the new segment was changed to active. However, such movement could be an anomaly. If foundation point  is very close to the edge of a region, force on endoscope , patient breathing, or some other external interaction could cause foundation point  to be in a different region for a long enough period that a segment would have time to transition to a new state.","To prevent this undesirable motion that can result in oscillatory state changes, hysteresis is added to change the calculated position of foundation point . For example, not only must distance dbe greater than distance dfor example, but also distance dmust be greater than distance dby some margin, e.g., one centimeter. This condition inhibits segments from transitioning state without significant endoscope motion.","Also, low pass filtering could be used for the sets of global position data so that transient data does not affect the determination of the number of active segments and the number of articulating segments. In one aspect, as described below, the low pass filtering is implemented by requiring a fixed number of datasets to give the same result before that result is implemented.","The information in TABLE 1 could be implemented, for example, as a look-up table. However, in one aspect, a method is implemented on a processor for controlling the number of active segment and the number of articulating segments as a medical device is moved relative to a foundation point.","In one aspect, the method uses the locations of the global position sensors to calculate the distances that were described above. In another aspect, the method uses a kinematic model to generate locations for each link in a segment. The locations are connected to generate a centerline representation of the endoscope. The foundation point is fitted to the centerline representation and the insertion depth is the distance along the centerline representation distal to the foundation point.","Each of these methods is considered more completely below. Both methods effectively determine the number of active segments and the number of articulating segments relative to the foundation point.","To demonstrate aspects of one method, a steerable endoscope  (), sometimes referred to as endoscope , is considered. Endoscope  is similar to endoscope , but, in this example, endoscope  includes four segments  to . Global position sensors ,  are provided at distal end  and proximal end  of steerable endoscope , respectively. While not shown in , the tip of endoscope is located at distal end . Global position sensors , , , are also provided, one between each segment. Using global position sensors  to , the start and end spatial coordinates of each segment can be measured using conventional techniques, e.g., radio frequency, electromagnetic, or optical techniques, and so are known.","The number of segments is illustrative only and is not intended to be limiting to the specific number described herein. Also, the use of global position sensors is illustrative of use of sensors relative to the body of the patient that provide information on position data of at least one segment relative to the foundation point. Thus, the description of global position sensors is illustrative only and is not intended to be limiting.","As an operator starts to insert endoscope  into a patient, method  () is started. As explained more completely below, method  analyzes the measured global position for at least a pair of global sensors  to  relative to foundation position  and each other. Method  requires little processing, and may be useful for simpler modes of endoscope operation as well as other medical devices having articulatable segments.","As used herein, global position and global position data refer to position measurement or tracking of endoscope segments or endoscope links using a reference location, foundation point  in this example, that is the same for all segments and links. This is contrasted with local position or shape measurement methods that determine the position or shape of each segment or link relative to other segments or links.","In method , a segment is active if any part of the segment has passed foundation point . The segment is active and articulating if half or more of the segment has passed foundation point . The use of the half-way point to change the state of a segment from active to active and articulating is illustrative only and is not intended to be limiting. In view of this disclosure, one knowledgeable in the field can select criteria relative to the foundation point for sending segments active and articulating based on the particular steerable medical device and procedure of interest. Irrespective of the criteria, the position of foundation point  is known.","In , selected positions of endoscope  are considered to demonstrate method . Typically, following INITIALIZE operation  () and FOUNDATION POINT INITIALIZED check operation , ACTIVE\/PASSIVE process  (shown bounded by dashed lines in ) is repeated each time global position data A is updated. Thus, ACTIVE\/PASSIVE process  may be performed more frequently than indicated by the endoscope positions in . These positions were selected to demonstrate elements of process  and so are illustrative only and are not intended to be limiting.","Initially, in method , INITIALIZE operation  initializes elements used in method . For example, a value of a number of segments active variable NumAct is set to one, a value of a number of segments articulating variable NumArt is set to one, and a value of a maximum count variable countMax is set to five.","Upon completion of INITIALIZE operation , method  remains in FOUNDATION POINT INITIALIZED check operation , until foundation point  is initialized. When the tip of endoscope  reaches a point that the operator wants to use as a foundation point, the operator takes an action that initializes foundation point  as the current location of the tip. The particular action taken by the operator is not essential so long as the system recognizes the action, e.g., pushing a button, as direction to use the current tip position of endoscope  as foundation point .","Also, check operation  should not be interpreted as requiring polling. Check operation , for example, could be implemented as part of an event handler and when a foundation point initialized event occurs, method  is launched.","Upon initialization of foundation point , active\/passive method  is launched and processing transfers from FOUNDATION POINT INITIALIZED check operation  to GENERATE DISTANCES TO FOUNDATION POINT operation . Operation  accesses the location of foundation point  and the global position data for at least the pair of global position sensors bounding the currently most proximal active segment. Operation  generates the distance from each of these global position sensors to foundation point .","For the example, in , operation  generates distance dfrom distal global position sensor  to foundation point , and generates distance dfrom proximal global position sensor  to foundation point . Also, the distance from global position sensor  to global position sensor  is generated and is shown in  as distance d. Upon completion of operation  processing transfers to FOUNDATION POINT NEAREST TIP check operation .","FOUNDATION POINT NEAREST TIP check operation  determines whether foundation point  is closest to the most proximal global position sensor , e.g., closest to the tip of endoscope . The segment of endoscope  that includes the tip is expected to be active and articulating and so method  must preserve this characteristic.","In one aspect, check operation  determines whether distance dis less than distance d, and whether the value of number of segments active variable NumAct is equal to one. If both these conditions are true, foundation point  is nearest the tip and check operation  transfers processing to SET TEMPORARY ACTIVE AND ARTICULATING operation . If either or both of the conditions are not true, check operation  transfers processing to INITIALIZE INDEX operation .","In the example of , distance dis less than distance dand so the first condition is true. Also, the value of number of segments active variable NumAct is equal to one and so the second condition is true. Thus, foundation point  is nearest the tip, as shown in , and check operation  transfers processing to SET TEMPORARY ACTIVE AND ARTICULATING operation .","SET TEMPORARY ACTIVE AND ARTICULATING operation  sets a value of a temporary active segments variable tempAct to one and a value of a temporary articulating segments variable tempArt to one. Operation  transfers processing to GO ACTIVE\/PASSIVE operation  ().","GO ACTIVE\/PASSIVE operation  sets the value of number of segments active numAct to the value of temporary active segments variable tempAct. Operation  also sets the value of number of segments articulating numArt to the value of temporary articulating segments variable tempArt. Operation  then sends a command to the motors for endoscope  that configures the number of articulating segments of endoscope  to be the value of number of segments articulating numAct, and configures the number of active segments of endoscope  to be the value of number of segments active numAct. Thus, operation  sends a command to a controller to configure endoscope  to have number of segments articulating numAct and number of segments active numAct.","Upon completion, GO ACTIVE\/PASSIVE operation  () transfers to NEW GLOBAL DATA check operation  (). When a new set of global position data is available, check operations transfers to GENERATE DISTANCES TO FOUNDATION POINT operation  and ACTIVE\/PASSIVE method  is started again. Check operation  can be configured to transfer to method  for other than every new set of global position data. Method  is initiated when a new set of global position data is saved by check operation , e.g., when a new set of global position data is received.","Turning now to  and considering the new global data set to represent the configuration illustrated in , operation  generates distance dfrom distal global position sensor  to foundation point , and generates distance dfrom proximal global position sensor  to foundation point . The distance from global position sensor  to global position sensor  also is generated and is shown in  as distance d. Upon completion of operation  processing transfers to FOUNDATION POINT NEAREST TIP check operation .","As described above, FOUNDATION POINT NEAREST TIP check operation  determines whether foundation point  is closest to the most proximal global position sensor , e.g. closest to the tip of endoscope . In the example of , distance dis greater than distance dand so the first condition is not true. The value of number of segments active variable NumAct is equal to one and so the second condition is true. Thus, foundation point  is not nearest the tip, as shown in , and check operation  transfers to INITIALIZE INDEX operation .","INITIALIZE INDEX operation  sets the value of index i to the value of number of segments active variable NumAct plus one. Thus, for this example, index i has a value of two. Upon completion, INITIALIZE INDEX operation  transfers processing to d<dcheck operation .","In one aspect, d<dcheck operation  determines whether foundation point  is closer to the distal global position sensor i than to proximal global position sensor (i\u22121). If the foundation point is closer to distal global position sensor i than to proximal global position sensor (i\u22121), check operation  transfers processing to SET TEMPORARY ARTICULATING operation  and otherwise to INDEX EQUALS NUMBER OF ACTIVE check operation .","In  with the value of index i equal to two, distance dis less than distance d, i.e., foundation point  is closer to proximal global position sensor  for segment  than to distal global position sensor . Thus, check operation  transfers processing to SET TEMPORARY ARTICULATING operation .","SET TEMPORARY ARTICULATING operation  sets the value of temporary articulating segments variable tempArt to the value of index i minus one. In this example, index i has a value of two and so the value of temporary articulating segments variable tempArt is one. Upon completion, SET TEMPORARY ARTICULATING operation  transfers processing to d<dcheck operation .","d<dcheck operation  determines whether distance dfrom the foundation point to the distal global position sensor is less than the distance between proximal and distal global position sensors d. If distance dis greater than distance d, check operation  transfers to SET TEMPORARY ACTIVE operation , which in turn sets the value of temporary active segments variable tempAct to the value of index i. If distance dis less than distance d, check operation  transfers to SET TEMPORARY ACTIVE operation , which in turn sets the value of temporary active segments variable tempAct to the value of index i minus one. Both SET TEMPORARY ACTIVE operation , and SET TEMPORARY ACTIVE operation  transfer processing to low pass filter  ().","Continuing with the example of , index i has the value two and so the distances of interest are distances dand d. Distance dfrom global position sensor  to foundation point  is less than distance dbetween global position sensor  and global position sensor . It is not necessary to activate another segment at this time. Thus, check operation  transfers to SET TEMPORARY ACTIVE operation . In this example, index i has a value of two and so the value of temporary active segments variable tempArt is one, i.e., is maintained at the same value.","In low pass filter  (), TEMPORARY ACTIVE AND ARTICULATING UNCHANGED AND DIFFERENT FROM NUMBER OF ACTIVE AND ARTICULATING check operation  is used in combination with check operation  to assure that transient conditions do not result in changing the number of articulating and the number of active segments in endoscope .","Check operation  determines whether a change in the number of active segments or the number of articulating segments has occurred. Check operation  assures that a predefined number of samples of global position data, i.e., the value of maximum count variable countMax, gives the same change before the number of articulating and active segments in endoscope  is changed.","Specifically, TEMPORARY ACTIVE AND ARTICULATING UNCHANGED AND DIFFERENT FROM NUMBER OF ACTIVE AND ARTICULATING check operation  compares the value of temporary active segments variable tempAct with a saved value of that variable. Check operation  also compares the value of temporary articulating segments variable tempArt with a saved value of that variable. If either comparison shows a change, i.e., the values are not equal, check operation  transfers processing to RESET COUNT operation .","Conversely, if both comparisons show that no change has occurred in the value of either variable tempAct or variable tempArt, check operation  compares the value of temporary active segments variable tempAct to the value of number of segments active variable numAct and compares the value of temporary articulating segments variable tempArt to the value of number of segments articulating variable numArt. If both comparisons are true, i.e., the values are equal, check operation  transfers processing to RESET COUNT operation . If either of the comparisons is not true, at least one set of the values are not equal, check operation  transfers processing to COUNT EQUAL COUNT MAXIMUM check operation  that is described more completely below.","For the example of , check operation  determines that the values of both temporary active segments variable tempAct and temporary articulating segments variable tempArt are unchanged. However, the value of temporary active segments variable tempAct equals the value of number of segments active variable numAct and the value of temporary articulating segments variable tempArt equals the value of number of segments articulating variable numArt. Thus, check operation  transfers processing to RESET COUNT operation .","RESET COUNT operation  sets a count variable COUNT to zero, in this example. RESET COUNT operation  transfers processing to NEW GLOBAL CHECK operation  (), which was described above.","Turning now to , prior to endoscope  being moved to the location shown in , endoscope  had been moved from the location shown in  so that foundation point  was proximal to global position sensor . As a result of this prior move, the state of segment  was set to active and the number of segments active variable numAct was set to two. After the prior move, endoscope  was moved to the position shown in  and a new set of global position data has been received. Since segment  is active when the new set of global position data was received, number of segments active variable numAct has the value two and number of segments articulating variable numArt has the value one.","In this example, operation  distance dfrom global position sensor  to foundation point ; and generates distance dfrom global position sensor  to foundation point . Distance dfrom global position sensor  to global position sensor  is also generated. Upon completion of operation  processing transfers to FOUNDATION POINT NEAREST TIP check operation .","As described above, FOUNDATION POINT NEAREST TIP check operation  determines whether foundation point  is closest to the most proximal global position sensor , e.g. closest to the tip of endoscope . In the example of , distance dis greater than distance dand so the first condition is not true. The value of number of segments active variable NumAct is not equal to one. Thus, foundation point  is not nearest the tip, as shown in , and check operation  transfers to INITIALIZE INDEX operation .","Note that for ease of illustration FOUNDATION POINT NEAREST TIP check operation  is considered in each iteration of method  as endoscope  is moved. However, in one aspect, check operation  is not performed after the pass through method  that sets the state of the first segment to active and articulating, because after that pass, endoscope  is known to have the first segment set to state active and articulating. Thus, the consideration of FOUNDATION POINT NEAREST TIP check operation  simply demonstrates that it is unnecessary to consider operation  in iterations after the edge case has been handled.","INITIALIZE INDEX operation  sets the value of index to the value of number of segments active variable NumAct plus one. Thus, for this example, index i has a value of three. Upon completion, INITIALIZE INDEX operation  transfers processing to d<dcheck operation .","In  with index i equal to three, distance dis greater than distance d, i.e., foundation point  is closer to distal global position sensor  for segment  than to proximal global position sensor . Thus, check operation  transfers processing to INDEX EQUALS NUMBER OF ACTIVE CHECK operation .","INDEX EQUALS NUMBER OF ACTIVE CHECK operation  compares the value of index i with the value of number of segments active variable NumAct. At this time, index i equals three and the value of number of segments active variable NumAct is two. Thus, the comparison is false, and check operation  transfers processing to UPDATE INDEX operation .","UPDATE INDEX operation , in this example, decrements the value of index i. Thus, index i now has a value of two. UPDATE INDEX operation  transfers processing to SET TEMPORARY ACTIVE operation .","SET TEMPORARY ACTIVE operation  sets the value of temporary active segments variable tempAct to the value of index i. In this example, index i has a value of two and so the value of temporary active segments variable tempArt is two. Upon completion, SET TEMPORARY ACTIVE operation  transfers processing to TEMPORARY ACTIVE AND ARTICULATING UNCHANGED AND DIFFERENT FROM NUMBER OF ACTIVE AND ARTICULATING check operation .","In the example of , check operation  determines that the values of temporary active segments variable tempAct and temporary articulating segments variable tempArt are unchanged. However, the value of temporary active segments variable tempAct equals the value of number of segments active variable numArt and the value of temporary articulating segments variable tempArt equals the value of number of segments articulating variable numArt. Thus, check operation transfers processing to RESET COUNT operation  that was described above.","Turning now to , endoscope  has moved so that the insertion depth has increased and a new set of global position data has been received. Recall number of segments active variable numAct has the value two. However, foundation point  has just passed the center point of segment  and the value of number of segments articulating numArt is still one.","For the configuration in , operation  generates distance dfrom global position sensor  to foundation point , and generates distance dfrom global position sensor  to foundation point . Distance dfrom global position sensor  to global position sensor  is also generated. Upon completion of operation  processing transfers to FOUNDATION POINT NEAREST TIP check operation .","As described above, FOUNDATION POINT NEAREST TIP check operation  determines whether foundation point  is closest to the most proximal global position sensor , e.g. closest to the tip of endoscope . In the example of , distance dis greater than distance dand so the first condition is not true. The value of number of segments active variable NumAct is not equal to one. Thus, foundation point  is not nearest the tip, as shown in , and check operation  transfers to INITIALIZE INDEX operation .","INITIALIZE INDEX operation  sets the value of index i to the value of number of segments active variable NumAct plus one. Thus, for this example, index i has a value of three. Upon completion, INITIALIZE INDEX operation  transfers processing to d<dcheck operation .","In  with the value of index i equal to three, distance dis less than distance d, i.e., foundation point  is closer to proximal global position sensor  for segment  than to distal global position sensor . Thus, check operation  transfers processing to SET TEMPORARY ARTICULATING operation .","SET TEMPORARY ARTICULATING operation  sets the value of temporary articulating segments variable tempArt to the value of index i minus one. In this example, index i has a value of three and so the value of temporary articulating segments variable tempArt is two. Upon completion, SET TEMPORARY ARTICULATING operation  transfers processing to d<dcheck operation .","Continuing with the example of , index i has the value three and so the distances of interest in check operation  are distances dand d. Distance dfrom global position sensor  to foundation point  is less than distance dbetween global position sensor  and global position sensor .","Operation  transfers to SET TEMPORARY ACTIVE operation . SET TEMPORARY ACTIVE operation  sets the value of temporary active segments variable tempAct to the value of index i minus one. In this example, index i has a value of three and so the value of temporary active segments variable tempArt is two. Upon completion, SET TEMPORARY ACTIVE operation  transfers processing to TEMPORARY ACTIVE AND ARTICULATING UNCHANGED AND DIFFERENT FROM NUMBER OF ACTIVE AND ARTICULATING check operation .","In the example of , check operation  determines that the value of temporary active segments variable tempAct is unchanged, but the value of temporary articulating segments variable tempArt has changed. The value of temporary active segments variable tempAct equals the value of number of segments active variable numAct, but the value of temporary articulating segments variable tempArt does not equal the value of number of segments articulating variable numArt. Thus, check operation  transfers processing to COUNT EQUALS COUNT MAXIMUM check operation .","COUNT EQUALS COUNT MAXIMUM check operation  compares the value of variable COUNT with the value of maximum count variable countMax. The value of variable COUNT depends on the number of times in a row that processing has reached check operation . If variable COUNT has any value less than the value of maximum count variable countMax, check operation  transfers processing to CHANGE COUNT operation , which increments the value of variable COUNT, and transfers to NEW GLOBAL DATA check operation  that was described above. Conversely, if the value of variable COUNT equals the value of maximum count variable countMax, check operation  transfers processing to GO ACTIVE\/PASSIVE operation .","GO ACTIVE\/PASSIVE operation  sets the value of number of segments active numAct to the value of temporary active segments variable tempAct. Operation  also sets the value of number of segments articulating numArt to the value of temporary articulating segments variable tempArt. Operation  then sends a command to the motors for endoscope  that configures the number of articulating segments of endoscope  to be the value of number of segments articulating numAct, and configures the number of active segments of endoscope  to be the value of number of segments active numAct. Thus, operation  sends a command to a controller to configure endoscope  to have the number of segments articulating numAct and the number of segments active numAct. Upon completion, GO ACTIVE\/PASSIVE operation  transfers to NEW GLOBAL DATA check operation  that was described above.","In method , a command was not sent to the motors of endoscope  until the same number of active segments and the same number of articulating segments were found in a predetermined number of consecutive sets of global position data. If low pass filter  were eliminated, each iteration of method  would send a command to the motors of endoscope . However, sensor noise might cause segments to transition between active and passive states or articulating and non-articulating states often. To prevent excessive transitions, the low pass filter was implemented before sending a new command to the motors. As illustrated in process , multiple (for example five) consecutive sensor readings are required to produce the same command before the command is sent to the actuators","If the foundation point is very close to the edge of a region, force on the endoscope, patient breathing, or some other external interaction could move a segment beyond the foundation point for a long enough period that the segment would have time to transition state. To prevent this undesirable motion, hysteresis is added to change the calculated position of the foundation point. For example, in check operation  not only must distance dbe greater than distance dfor example, but also distance dmust be greater than distance dby some margin, e.g., one centimeter. A similar margin can be used in check operation . Use of hysteresis, as defined herein, inhibits segments from transitioning state without significant motion.","Active\/Passive method  looked only at the positions of position sensors relative to a foundation point and each other. Another method, as described below, uses the position and orientation of each of the position sensors to find the best configuration fit to the kinematics of endoscope .","As described above, in one aspect, steerable endoscope , sometimes referred to as endoscope , includes four segments  to . As illustrated in , steerable endoscope  also includes four segments  to  and each segment includes eight links.","Global position sensors ,  are provided at distal end  and proximal end  of steerable endoscope , respectively. While not shown in , the tip of endoscope is located at distal end . A global position sensor , , , is also provided between each segment so that each segment is bounded by a pair of global position sensors, in this embodiment. Using global position sensors  to , the start and end spatial coordinates of each segment can be measured using conventional techniques, e.g., radio frequency, electromagnetic, or optical techniques, and so are known. The number of segments is illustrative only and is not intended to be limiting to the specific number described herein.",{"@attributes":{"id":"p-0142","num":"0141"},"figref":"FIG. 4B","b":["400","401","404"]},"The transform for the pitch-links is:",{"@attributes":{"id":"p-0144","num":"0143"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["T","xi"]},"mo":"=","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mi":["R","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}}},{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mn":"0"}},{"mtd":{"mn":"0"}},{"mtd":{"mrow":{"mo":"-","mrow":{"mi":"a","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"xi"}}}}}]}}}]},{"mtd":[{"mn":"0"},{"mn":"1"}]}]}}},{"mi":"i","mo":"=","mrow":{"mn":["1","4"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":"to"}}],"mo":","}}}},"a(xi) is the displacement for link xi; and",{"@attributes":{"id":"p-0146","num":"0145"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["R","x"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}},{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mn":"1"},{"mn":"0"},{"mn":"0"}]},{"mtd":[{"mn":"0"},{"mrow":{"mi":"cos","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}}},{"mrow":{"mo":"-","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}}}}]},{"mtd":[{"mn":"0"},{"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}}},{"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","xi"]}}}}]}]}}],"mo":"="}}}},"The transform for the yaw-links is:",{"@attributes":{"id":"p-0148","num":"0147"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["T","yi"]},"mo":"=","mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mi":["R","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":"-","msub":{"mi":["\u03b8","yi"]}}}}},{"mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mn":"0"}},{"mtd":{"mn":"0"}},{"mtd":{"mrow":{"mo":"-","mrow":{"mi":"a","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"yi"}}}}}]}}}]},{"mtd":[{"mn":"0"},{"mn":"1"}]}]}}},{"mi":"i","mo":"=","mrow":{"mn":["1","4"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":"to"}}],"mo":","}}}},"a(yi) is the displacement for link yi",{"@attributes":{"id":"p-0150","num":"0149"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":["R","y"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":"-","msub":{"mi":["\u03b8","yi"]}}}},{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","yi"]}}}},{"mn":"0"},{"mrow":{"mo":"-","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","yi"]}}}}}]},{"mtd":[{"mn":"0"},{"mn":"1"},{"mn":"0"}]},{"mtd":[{"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","yi"]}}}},{"mn":"0"},{"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["\u03b8","yi"]}}}}]}]}}],"mo":"="}}}},"In the transform there are eight variables, but the global position data has only six coordinates. The angle of rotation for each transform Tis estimated with a constrained minimization. The constraint, in one aspect, is:\n\nT=TTTTTTTT\n\nwhere T is the transform from global position sensor i at the proximal end of segment j to global position sensor (i\u22121) at the distal end of segment j. Transform T for segment j is known based on the global position data, e.g., the relative positions and orientations, of two adjacent global position sensors i, (i\u22121).\n","With respect to index i, the global position sensors are numbered starting at distal end  of endoscope  and proceeding towards proximal end , with sensor  at distal end of endoscope having index one. For a pair of global position sensors, the value of index i is the number of proximal global position sensor in the pair.","A minimized cost function is used in the solution for the orientation of the individual links in segment j. The minimized cost function can minimize angle, change in angle, deviation from equal angle, some combination of the three, or another cost function.","This kinematic fitting process is used for each segment in endoscope  for which global position data is available. The solution provides in a memory a configuration for endoscope  including a global position for each joint.","For example, in , foundation point  is bounded by global position sensors  and  and so is located in second segment . Use of the kinematic model provides data points such as those illustrated in  for segments , . In one aspect, a straight line fit is done between the points of segments ,  to obtain a centerline representation -C of steerable endoscope .","A length L of centerline -C distal to foundation point  is the length of endoscope  that is inserted. Length L is compared to segment lengths to determine the number of segments active and articulating. Centerline -C is used in determining distances to foundation point  from various global sensor positions.","Method  in  is one example of using a kinematic model in determining the number of active and articulating segments inserted in a patient. Again, in method , a segment is active if any part of the segment has passed foundation point . The segment is active and articulating if half or more of the segment has passed foundation point . However, with method , various points in a segment could be used to make a segment articulating, because by walking centerline -C the positions can be determined more accurately than in method .","Use of the half-way point to change the state of a segment from active to active and articulating is illustrative only and is not intended to be limiting. In view of this disclosure, one knowledgeable in the field can select criteria relative to the foundation point for sending segments active and articulating based on the particular steerable medical device and procedure of interest. Irrespective of the criteria, the position of foundation point  is known.","Initially, in method , INITIALIZE operation  initializes elements used in method . For example, a number of segments active variable NumAct is set to one; a number of segments articulating variable NumArt is set to one; and a maximum count variable countMax is set to five.","Upon completion of INITIALIZE operation , method  remains in FOUNDATION POINT INITIALIZED check operation , until foundation point  is initialized. When the tip of endoscope  reaches the point that the operator wants to use as a foundation point, the operator takes an action that initializes foundation point  as the current location of the tip. The particular action taken by the operator is not essential so long as the system recognizes the action, e.g., pushing a button, and uses the current position of the endoscope tip as foundation point .","Also, check operation  should not be interpreted as requiring polling. Check operation , for example, could be implemented as part of an event handler and when a foundation point initialized event occurs, processing transfers to USE KINEMATIC MODEL TO GENERATE LINK LOCATIONS FOR SEGMENT process .","USE KINEMATIC MODEL TO GENERATE LINK LOCATIONS FOR SEGMENT process , in one aspect, uses the kinematic model described above with respect to  to generate the locations for links in a segment. Specifically, global position data for the appropriate global position sensors is retrieved from global position sensor data A. The kinematic model is processed with the constrained minimization and a minimized cost function, as described above, to obtain link location data that is stored in link location data B. Upon completion of processing the segment, process  transfers to LAST SEGMENT CHECK operation .","LAST SEGMENT CHECK operation  determines whether all the segments have been processed by the kinematic model. In one aspect, a quality number is provided for each sensor bounding a segment. If additional segments bounded by sensors having valid quality numbers exist, not all segments have been processed. If the necessary segments have been processed, check operation  transfers to GENERATE ENDOSCOPE REPRESENTATION operation  and otherwise returns to process .","GENERATE ENDOSCOPE REPRESENTATION operation  retrieves the data from link location data B and generates a centerline representation of endoscope . Upon completion, GENERATE ENDOSCOPE REPRESENTATION operation  transfers processing to POSITION FOUNDATION POINT ON ENDOSCOPE REPRESENTATION operation .","POSITION FOUNDATION POINT ON ENDOSCOPE REPRESENTATION operation  finds the point in the centerline representation of endoscope  that is closest to the location of foundation point . This point is used to determine the insertion depth of endoscope , which is the distance along the centerline representation distal to this point.","In some embodiments, POSITION FOUNDATION POINT ON ENDOSCOPE REPRESENTATION operation  increments or decrements the insertion depth to compensate for global position sensor errors or movement of foundation point  relative to the global reference frame. In one aspect, an offset is added to the determined insertion depth before comparison to segments lengths is done.","In one aspect, upon completion, operation  transfers processing to ACTIVE\/PASSIVE method . in ACTIVE\/PASSVIE method , the lengths of each segment starting with distal segment  are added together and compared with the insertion depth, e.g., the length of segment  is compared with the insertion depth; the length of segments  and  is compared with insertion depth, etc.","Based on the insertion depth, the number of complete segments and any partial segment that have been inserted past the foundation point is determined. Each segment that is completely inserted has state active and state articulating. For a segment that is partially inserted, the state is active and the percentage of the segment inserted is used to determine whether the state articulating is appropriate.","Thus, all segments that are active and do not contain the foundation point are articulating. If the foundation point is more than a specified distance from the distal end of the most proximal active segment, the most proximal active segment is also articulating. In making these determinations, low passing filtering and hysteresis is included in one aspect.","Upon sending the number of active segments and the number of articulating segments in a command to the motors of endoscope , method  transfers processing to NEW GLOBAL DATA check operation  that was described above and that description is incorporated herein by reference. Hence, in one aspect, method  is repeated each time a new set of global position data is received.",{"@attributes":{"id":"p-0171","num":"0170"},"figref":"FIG. 7","b":["775","700","740","720","745","740","745","740"]},"A sensing system that senses the positions of the position sensors on steerable endoscope  is connected to a position controller  in system controller . A display controller  in system controller  receives video data from steerable endoscope  and displays that data on display device . A memory , in one aspect, has stored therein, position data ; a method  module ; and a method  module . The method modules ,  include at least some of the instructions executed by a processor in processor module  in performing methods  and  or any equivalent method. Also, in one aspect, memory  has stored therein data and any other information needed in the execution of the methods.","System controller  is illustrated as a unified structure in  for ease of illustration and understanding. This is illustrative only and is not intended to be limiting. The various component of system controller  can be located apart and still perform the functions described.","In the Figs., two-dimensional representations have been used for convenience. The drawings should not be interpreted as limiting the description to only a two-dimensional coordinate system, because the various aspects are carried out in a three-dimensional coordinate system. As is known to one knowledgeable in the field, the global position data for a global position sensor includes at least x-coordinate, y-coordinate, and z-coordinate values and so the various distances etc. discussed above are determined in a three-dimensional coordinate system. Further, in view of the description, one knowledgeable in the field can determine each of the defined distances in such a three-dimensional coordinate system.","The above description and the accompanying drawings that illustrate aspects and embodiments of the present inventions should not be taken as limiting\u2014the claims define the protected inventions. Various mechanical, compositional, structural, electrical, and operational changes may be made without departing from the spirit and scope of this description and the claims. In some instances, well-known circuits, structures, and techniques have not been shown or described in detail to avoid obscuring the invention.","Further, this description's terminology is not intended to limit the invention. For example, spatially relative terms\u2014such as \u201cbeneath\u201d, \u201cbelow\u201d, \u201clower\u201d, \u201cabove\u201d, \u201cupper\u201d, \u201cproximal\u201d, \u201cdistal\u201d, and the like\u2014may be used to describe one element's or feature's relationship to another element or feature as illustrated in the figures. These spatially relative terms are intended to encompass different positions (i.e., locations) and orientations (i.e., rotational placements) of the device in use or operation in addition to the position and orientation shown in the figures. For example, if the device in the figures is turned over, elements described as \u201cbelow\u201d or \u201cbeneath\u201d other elements or features would then be \u201cabove\u201d or \u201cover\u201d the other elements or features. Thus, the exemplary term \u201cbelow\u201d can encompass both positions and orientations of above and below. The device may be otherwise oriented (rotated 90 degrees or at other orientations) and the spatially relative descriptors used herein interpreted accordingly. Likewise, descriptions of movement along and around various axes include various special device positions and orientations.","The singular forms \u201ca\u201d, \u201can\u201d, and \u201cthe\u201d are intended to include the plural forms as well, unless the context indicates otherwise. The terms \u201ccomprises\u201d, \u201ccomprising\u201d, \u201cincludes\u201d, and the like specify the presence of stated features, steps, operations, elements, and\/or components but do not preclude the presence or addition of one or more other features, steps, operations, elements, components, and\/or groups. Components described as coupled may be electrically or mechanically directly coupled, or they may be indirectly coupled via one or more intermediate components.","The term \u201cflexible\u201d in association with a mechanical structure or component should be broadly construed. In essence, it means the structure or component can be bent without harm. For example, a flexible mechanical structure may include a series of closely spaced components that are similar to \u201cvertebrae\u201d in a snake-like arrangement. In such an arrangement, each component is a short link in a kinematic chain, and movable mechanical constraints (e.g., pin hinge, cup and ball, and the like) between each link may allow one (e.g., pitch) or two (e.g., pitch and yaw) degrees of freedom (DOF) of relative movement between the links. As another example, a flexible mechanical structure may be continuous, such as a closed bendable tube (e.g., nitinol, polymer, and the like) or other bendable piece (e.g., kerf-cut tube, helical coil, and the like). Accordingly, a short, flexible structure may serve as, and be modeled as, a single mechanical constraint (joint) providing one or more DOFs between two links in a kinematic chain, even though the structure itself may be a kinematic chain made of several coupled links.","While the memory in  is illustrated as a unified structure, this should not be interpreted as requiring that all memory is at the same physical location. All or part of the memory can be in a different physical location than a processor. Memory refers to a volatile memory, a non-volatile memory, or any combination of the two.","A processor is coupled to a memory containing instructions executed by the processor. This could be accomplished within a computer system, or alternatively via a connection to another computer via modems and analog lines, or digital interfaces and a digital carrier line.","Herein, a computer program product comprises a medium configured to store computer readable code needed for any one or any combination of the operations described with respect to modules ,  or in which computer readable code for any one or any combination of operations described with respect to module ,  is stored. Some examples of computer program products are CD-ROM discs, DVD discs, flash memory, ROM cards, floppy discs, magnetic tapes, computer hard drives, servers on a network and signals transmitted over a network representing computer readable program code. A tangible computer program product comprises a tangible medium configured to store computer readable instructions for any one of, or any combination of operations described with respect to modules ,  or in which computer readable instructions for any one of, or any combination of operations described with respect to the shape information processing module are stored. Tangible computer program products are CD-ROM discs, DVD discs, flash memory, ROM cards, floppy discs, magnetic tapes, computer hard drives and other physical storage mediums.","In view of this disclosure, instructions used in any one of, or any combination of operations described with respect to modules ,  can be implemented in a wide variety of computer system configurations using an operating system and computer programming language of interest to the user.","All examples and illustrative references are non-limiting and should not be used to limit the claims to specific implementations and embodiments described herein and their equivalents. The headings are solely for formatting and should not be used to limit the subject matter in any way, because text under one heading may cross reference or apply to text under one or more headings. Finally, in view of this disclosure, particular features described in relation to one aspect or embodiment may be applied to other disclosed aspects or embodiments of the invention, even though not specifically shown in the drawings or described in the text."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1A"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIGS. 1B to 1G"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIGS. 2B to 2E"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIGS. 3A and 3B","FIGS. 2B to 2E"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 4A"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIG. 4B","FIG. 4A"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 6A","FIG. 4A"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 6B","FIG. 6A"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 6C","FIG. 6A"]},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
