---
title: Method and system for establishing a communications pipe between a personal security device and a remote computer system
abstract: The present invention provides a method and a system for establishing a communications path (the “pipe” ) over a communications network () between a Personal Security Device (PSD ) and a Remote Computer System () without requiring means for converting high-level messages such as API-level messages to PSD-formatted messages such as APDU-formatted messages (and inversely) to be installed on a local Client () in which a PSD () is connected.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07853789&OS=07853789&RS=07853789
owner: Activcard Ireland, Limited
number: 07853789
owner_city: Dublin
owner_country: IE
publication_date: 20020409
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["RELATED APPLICATIONS","1. FIELD OF INVENTION","2. BACKGROUND OF INVENTION","3. SUMMARY OF INVENTION","5. DETAILED DESCRIPTION OF THE INVENTION","5.1. Detailed Description of a First Embodiment of the Invention","5.1.1. Client Specific Features","5.1.2. Remote Computer System Specific Features","5.1.3. Other Inventive Features","5.2. Detailed Description of a Second Embodiment of the Invention"],"p":["This application is a 371 US National Stage application of PCT\/EP02\/03928 filed Apr. 9, 2002, which is a continuation of U.S. application Ser. No. 09\/844,246 filed Apr. 30, 2001, now abandoned.","The present invention relates to a method and system for establishing a communications path (the \u201cpipe\u201d) over a communications network between a Personal Security Device (PSD) and a Remote Computer System.","The current art involving the use of Personal Security Devices (PSD), for example, smart cards, subscriber identity module (SIM) cards, biometric devices, or combinations thereof, requires specialized messaging software or firmware to be installed on a local Client in which the PSD is connected. These specialized routines are used to translate messages from high-level messaging formats into low-level messaging formats (i.e. into PSD-formatted messages). An example of such routines is what is generally known in the art as an Application Protocol Data Unit (APDU) interface. Installing and maintaining APDU interfaces for a large number of local Clients can be a substantial and costly challenge in a multi-user organization. In addition, Client resources such as disk space, memory and computing resources are unnecessarily tied up by the software, which could be better utilized for other purposes.","Another significant limitation of the current art is that security mechanisms are implemented on a local Client to gain access to secure functions contained within a connected PSD. In a typical secure transaction with a PSD, a request is generated in the local Client by way of high-level software such as API-level software, which is subsequently encrypted in the Client and translated into APDU messaging format using an APDU interface, and sent to the PSD to access the intended secure function.","The potential exposure of secure information weakens the basic functionality of current PSDs, which is to protect private keys and other proprietary information from being unnecessarily disclosed. The limitations of the current art are such that localized key generating mechanisms, APDU interface software and transactions involving this software are potentially vulnerable to compromise by unauthorized programs running on the local Client or by other illicit means intending to monitor the key generation process and thus gaining access to security codes, algorithms and other sensitive data contained within the PSD or elsewhere. These limitations are magnified in a multi-user environment where the ability to control unauthorized access to local Clients and vulnerable software contained therein is increased.","It is an object of the present invention to provide a method for establishing a communications path (the \u201cpipe\u201d) over a communications network between a Personal Security Device (PSD) and a Remote Computer System without requiring means for converting high-level messages such as API-level messages to PSD-formatted messages such as APDU-formatted messages (and inversely) to be installed on a local Client in which a PSD is connected.","This object is achieved with a method for establishing a communications pipe between at least one PSD and at least one Remote Computer System over a network using at least one Client as a host to said at least one PSD, said at least one Client and said at least one Remote Computer System being in functional communications using a packet-based communications protocol over said network, said method comprising the steps of:\n\n","The local Client acts as a transparent host which allows a connected PSD to communicate with one or more Remote Computer Systems over a network.","The communications pipe generation may be initiated automatically upon connection of a PSD to a local Client, by a Client side request for access to information contained on another networked Client or Remote Computer System, or by a Remote Computer System requesting access to a PSD.","In this invention, PSD-formatted messages are preferentially encapsulated into a common communications protocols, such as TCP\/IP, WAP, etc. which are used to communicate between one or more Clients with one or more Remote Computer Systems. A program installed on each local Client and each Remote Computer System separates the incoming low-level PSD-formatted messages from the incoming message packets and routes the PSD-formatted messages to a connected PSD via its hardware device interface. In a multi-tasking operating environment, the Client is free to perform other data processing functions while transactions between a PSD and a Remote Computer System using the pipe are executed in the background. In situations where a firewall may mask individual Client network addresses, remote computer based pipe software should be installed on the proxy server. Other solutions common to virtual private networking may also be employed.","With this invention, conversion of high-level messages such as API-level messages to PSD-formatted messages such as APDU-formatted messages, and inversely, is made in the Remote Computer System. By moving means for converting high-level messages such as API-level messages to PSD-formatted messages such as APDU-formatted messages (and inversely) from numerous local Clients to one or a few secure Remote Computer Systems, the overall data processing system is much easier to maintain and significantly less susceptible to unauthorized access or compromise.","For purposes of this invention a Client may be any intelligent device such as a personal computer, laptop, cellular telephone, Personal Data Assistant (PDA), etc. which provides the network communications interface between a PSD and a Remote Computer System. A Remote Computer System includes any intelligent device which provides the necessary communications interface between networked devices and a PSD.","In a first embodiment of the invention, a communications pipe is formed when a Remote Computer System generates the proper PSD-formatted messages which are encapsulated into an agreed upon communications protocol, transmitted (broadcast for general polling or specific IP address of Client) over a network, invoking a reply by one or more PSDs which is (are) subsequently received by the requesting Remote Computer System. The latter described pipe formation process is equivalent to a handshake between a PSD and a Remote Computer System.","This first embodiment of the invention is useful in determining the status, identification and other derived information related to responding PSDs. For example, an APDU formatted polling command may be transmitted from the Remote Computer System over a network to all PSDs capable of receiving the command requesting each PSD to return its unique identification number or some other non-proprietary information. Based on the replies received, it is possible to determine which PSDs are active, their relative location, length of time each PSD has been active, network traffic information, etc. This first embodiment of the method of the invention does not require the use of secure communications protocols.","In a second embodiment of the invention, referred to as secure pipe generation, security mechanisms are employed to protect against unauthorized disclosure of proprietary information. The secure pipe generation process is equivalent to the pipe generating process described above but includes the added steps of generating cryptographically secured PSD-formatted messages, which are then encapsulated into a secure communications protocol, examples of which include TCP\/IP with secure socket layer (SSL) encryption, IPSEC, etc. to generate a secure pipe between a Remote Computer System and a PSD.","In this second embodiment of the invention, PSD-formatted messages are encrypted using the proper keys to unlock secure applications and data contained within the secure domain of a PSD. Response PSD-formatted messages containing sensitive or proprietary information are likewise encrypted by the PSD and decrypted by the Remote Computer System.","The cryptographically secured PSD-formatted messages are encapsulated into outgoing message packets using the agreed communications secure protocol, sent over a network and routed through the PSD hardware interface by the Client and into the PSD as before. This second embodiment of the invention is useful in initializing a PSD, personalizing a PSD, accessing secure information contained within a PSD, changing, upgrading or deleting proprietary algorithms or data contained in a PSD, authenticating an end user, etc.","It is another object of the invention to provide a system for implementing the above-mentioned method.","This invention provides a method and system to establish a remote communications pipe over a network between a Remote Computer System and a Personal Security Device connected to a host local Client. In this invention, Personal Security Devices (PSD) are intelligent devices such as smart cards, biometric devices, Subscriber Identification Module (SIM) cards, or combinations thereof having a microprocessor, runtime operating environment, an input\/output communication port, memory storage including nonvolatile memory and random access memory and embedded software applications.","Two embodiments of the invention are described; a first embodiment () in which security mechanisms are not employed and a second embodiment () where security mechanisms are employed.","Note also that the following description of the invention will be based on a PSD which receives and sends APDU-(Application Protocol Data Unit)-formatted messages.","APDU messaging format, which is per se known in the art, is a lower-level messaging format which allows a PSD to communicate with higher-level applications located in devices to which the PSD is to be connected.","It must be clear that the present invention is not limited to the use of an APDU messaging format, and that any other low-level messaging format that can be processed by the PSD enters within the scope of the present invention.","In the appended claims, a message having such a format will be designated by the generic expression \u201cPSD-formatted message\u201d.","Referring now to , a generalized system block diagram of a first embodiment of the invention depicted. The various layers shown are based on the Open System Interconnection model (OSI). For simplicity, certain layers common to both the Client and Remote Computer System are not shown and should be assumed to be present and incorporated into adjacent layers. The layers common to both a Client and Remote Computer System include:\n\n","A specialized program contained within the API Layer  of the Client and referred to as a Pipe Client , interacts with Communications Programs contained within the Communications Layer . The Pipe Client  functions to separate encapsulated APDU requests from incoming messaging packets received from a network  for processing by a locally connected PSD . Alternately, outbound APDU responses generated by a locally connected PSD , are processed by the Pipe Client for encapsulation into an agreed upon communications protocol by Communications Programs contained within the Communications Layer .","A software driver contained within the Communications Layer  of the Client and referred to as a PSD Software Interface  directs incoming APDUs communicated by the Pipe Client  into the I\/O device port connecting the PSD Hardware Device Interface  to the locally connected PSD . Outgoing APDUs generated by the PSD are communicated through the PSD Hardware Device Interface  through the I\/O device port to the PSD Software Interface  and subsequently communicated to the Pipe Client .","A first specialized program contained within the API Layer  of the Remote Computer System  and referred to as an APDU Interface , translates higher level messaging formats into low-level APDU messaging format required to communicate with a PSD . Alternately, the APDU Interface  translates incoming APDU responses received from a PSD  into higher level messaging formats used by programs in the API Layer  and Applications Layer  of the Remote Computer System.","A second specialized program contained within the API Layer  of the Remote Computer System  and referred to as a Pipe Server  interacts with Communications Programs contained within the Communications Layer . The Pipe Server  functions to separate encapsulated APDU requests from incoming messaging packets received from a network  for processing by the APDU Interface . Alternately, outbound APDU requests translated by the APDU Interface  are processed by the Pipe Server for encapsulation into an agreed upon communications protocol by Communications Programs contained within the Communications Layer .","The connection  between the PSD  and PSD Hardware Interface  includes but is not limited to traditional electrical or optical fiber connections or wireless means including optical, radio, acoustical, magnetic, or electromechanical. Likewise the connection  between the Client  and the network , and the connection  between the Remote Computer System  and the network  may be accomplished analogously.","The network, shown generally at , includes both public and private telecommunications networks connected by traditional electrical, optical, electro-acoustical (DTMF) or by other wireless means. Any mutually agreed upon communications protocol capable of encapsulating APDU commands may be employed to establish a communications pipe including open or secure communications protocols.","Referring now to , depicts initiating a communications pipe between the Remote Computer System  and the PSD  connected to a Client . In this depiction, the Remote Computer System  is sending a request to PSD  for non-proprietary embedded information , for example an identification number. PSD  is connected  to the local Client  using PSD Interface . PSD Interface  communicates with the Client  via hardware device port .","To initiate a communications pipe between Remote Computer System  and PSD , the Remote Computer System  generates a request  by way of API programs  which is translated into APDU format  by the APDU Interface  and sent to the Pipe Server  for message encapsulation. The encapsulated APDUs are then sent  to the Communications Programs S for incorporation into outgoing message packets .","The message packets  containing the encapsulated APDUs are transmitted  over the network  via a Network Interface Card (I\/O) S. The Client  receives the message packets  containing the encapsulated APDUs which are received from the network  via a Network Interface Card (I\/O) C installed on the local Client. The incoming messages are processed by Client-side Communications Programs C and routed  into the Pipe Client  for APDU extraction. The extracted APDUs are sent  through hardware device port , routed  into the PSD Interface  and sent to PSD  via connection  for processing within PSD domain .","Alternative requests to form a communications pipe  between a Remote Computer System  and a PSD  may be initiated by Client  requesting access to information contained on one or more networked local Clients, by connecting a PSD  to PSD Interface  which initiates a request to form a communications pipe , or by another Remote Computer System requesting access to PSD .","Referring now to , depicts a PSD response which establishes the communications pipe between PSD  and Remote Computer System . In this depiction, the request previously received is processed within the PSD domain , which generates a response message. The PSD response is sent in APDU format from PSD  through connection  and into PSD interface . The PSD response is then routed  through hardware device port  and sent  to the Pipe Client  for processing and encapsulation. The resulting message packets are then sent  to the Client-side Communications Programs C for incorporation into outgoing message packets . The message packets  containing the encapsulated APDUs are transmitted  over the network  via the Network Interface Card (I\/O) C.","The Remote Computer System  receives the message packets  containing the encapsulated APDUs, which are received from the network  via the Network Interface Card (I\/O) S installed on the Remote Computer System. The incoming messages are processed by server-side Communications Programs S and routed  into the Pipe Server  for APDU extraction. The extracted APDUs are sent  to the APDU Interface  for processing and translation into a higher-level format and sent  to API Level programs  for processing and further transactions with the PSD  if desired.","Referring now to , a generalized system block diagram of one implementation of a secure communications pipe is shown. The general system block diagram includes an additional software-based Cryptography Module  installed on the Remote Computer System, which is not shown in .",{"@attributes":{"id":"p-0048","num":"0064"},"figref":"FIG. 4B","b":["440","475","100","130","485","440","430"]},"Both APDU messaging security mechanisms shown in  are used to generate cryptographic keys necessary to unlock secure functions and data contained within the secure domain of a PSD, encrypt outgoing APDUs and decrypt incoming encrypted APDUs. The security mechanisms employed in generating a secure pipe may include synchronous, asynchronous or any combination of cryptography methods.","Secure communications protocols used to communicate over a network are accomplished by the Communications Programs contained within the Communications Layers . Cryptography used in generating secure communications may employ the security mechanisms described for APDU messaging, employ separate mechanisms or employ any combination thereof.","Referring now to , depicts the initiating of a secure pipe between the Remote Computer System and the PSD  connected to Client . In this depiction, Remote Computer System  is sending a secure request to PSD  for proprietary embedded information , for example an authentication password. PSD  is connected  to the local Client  using PSD Interface . PSD Interface  communicates with the Client  via hardware device port .","To initiate a secure communications pipe between Remote Computer System  and PSD , a request  is generated on Remote Computer System  to access PSD  by way of API programs  which are translated into APDU format by the APDU Interface . The APDUs are then sent  to a Security Module  for encryption using a pre-established cryptography method. The proper cryptographic parameters may be determined by using a look-up table or database, which cross-references the PSD's unique internal identification information with one or more codes necessary to implement the appointed cryptography method.","The encrypted APDUs are then routed  to the Pipe Server  for message encapsulation. The encapsulated APDUs are then sent  to the Communications Programs  for processing, encryption using a pre-established secure communications protocol and incorporation into outgoing message packets . The secure message packets  containing the encrypted and encapsulated APDUs are transmitted  over the network  via a Network Interface Card (I\/O) S.","The Client  receives the message packets  containing the encrypted and encapsulated APDUs which are received from the network  via a Network Interface Card (I\/O) C installed on the local Client .","The incoming encrypted message packets are decrypted and processed using the pre-established cryptography employed in the secure communications protocol by Client-side Communications Programs C. The unencrypted message packets still containing the encrypted APDUs are routed  into the Pipe Client  for APDU extraction. The extracted APDUs are sent  through hardware device port , routed  into the PSD Interface  and sent to PSD  via connection  for decryption and processing within the secure domain  of the PSD . Using a pre-established cryptography method, incoming secure APDUs are decrypted and requests processed.","Referring now to , depicts a PSD secure response, which establishes the secure communications pipe between PSD  and Remote Computer System . In this depiction, the secure request previously received is processed within the secure domain  of the PSD , which causes the PSD to generate a secure response message using a pre-established cryptography method.","The PSD secure response is sent in APDU format from PSD  through connection  and into PSD interface . The PSD secure response is then routed  through hardware device port  and sent  to the Pipe Client  for processing and encapsulation. The resulting message packets are then sent  to the Client-side Communications Programs  for processing, encryption using a pre-established secure communications protocol and incorporation into outgoing message packets . The message packets  containing the encapsulated APDUs are transmitted  over the network  via the Network Interface Card (I\/O) C.","The Remote Computer System  receives the message packets  containing the encapsulated APDUs from the network  via the Network Interface Card (I\/O) S installed on the Remote Computer System . The incoming messages are processed and decrypted using the pre-established cryptography method employed in the secure communications protocol by the server-side Communications Programs  and routed  into the Pipe Server  for secure APDU extraction. The extracted secure APDUs are sent  to the Security Module  for decryption of the secure APDUs using the pre-established cryptography method. The decrypted APDUs are then routed  to the APDU Interface  for processing and translation into a higher-level format and sent  to API programs  for processing and further transactions with the PSD  if desired. This step establishes the secure \u201cpipe\u201d to communicate with the PSD. The secure pipe is maintained until the Remote Computer System signals the Client to close the hardware interface port .","No limitation is intended in the number of PSDs and Clients forming secure pipes  with one or more Remote Computer System(s) , nor should any limitation on the number of Remote Computer Systems  available for generating secure pipes  be construed from the drawings. Lastly, no limitation is intended concerning the initiating event to establish a communications pipe.","The foregoing described embodiments of the invention are provided as illustrations and descriptions. They are not intended to limit the invention to precise form described. In particular, it is contemplated that functional implementation of the invention described herein may be implemented equivalently in hardware, software, firmware, and\/or other available functional components or building blocks. Other variations and embodiments are possible in light of above teachings, and it is not intended that the scope of the invention be limited by this Detailed Description, but rather by the Claims following herein."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"4. BRIEF DESCRIPTION OF THE DRAWINGS","p":["A more complete understanding of the present invention may be accomplished by referring to the following Detailed Description and Claims, when viewed in conjunction with the following drawings:","FIG. \u2014is a generalized system block diagram for implementing present invention (first embodiment),","FIG. \u2014is a detailed block diagram depicting initiating a communications pipe where non-proprietary information is being requested (first embodiment),","FIG. \u2014is a detailed block diagram depicting establishing a communications pipe where non-proprietary information is being requested (first embodiment),","FIG. A\u2014is a generalized system block diagram for implementing present invention which includes software-based security mechanisms (second embodiment),","FIG. B\u2014is a generalized system block diagram for implementing present invention which includes HSM based security mechanisms (second embodiment),","FIG. \u2014is a detailed block diagram depicting initiating a secure communications pipe (second embodiment), and","FIG. \u2014is a detailed block diagram depicting establishing a secure communications pipe (second embodiment)."]},"DETDESC":[{},{}]}
