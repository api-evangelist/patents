---
title: Ray tracing core and method for processing ray tracing
abstract: A ray tracing core comprises a ray tracing unit (RTU), a control unit, and a tree build unit (TBU). The ray tracing unit performs ray tracing based on a spatial partitioning structure. The control unit calculates the degree of complexity of the spatial partitioning structure by monitoring the load state of the ray tracing unit. The tree build unit builds the spatial partitioning structure having the degree of complexity which is calculated. The load state is determined based on a frame rate which is processed in the pertinent unit. The spatial partitioning structure applies a K-dimensional tree. For example, the degree of complexity can be modified according to either the maximum primitive number of a leaf node with respect to a K-dimensional tree structure or a tree depth.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08836702&OS=08836702&RS=08836702
owner: Industry-Academia Cooperation Group of Sejong University
number: 08836702
owner_city: 
owner_country: KR
publication_date: 20110218
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND ART","TECHNICAL SOLUTION","BEST MODE","Mode for Invention"],"p":["This disclosure relates to three-dimensional graphic processing, and more particularly to a ray tracing core and a method of processing ray tracing.","A three-dimensional graphic technology is a graphic technology using a three-dimensional expression of geometric data stored in a computer, and has been extensively used for various industries such as a media industry and a game industry. In general, the three-dimensional graphic requires a high performance graphic processor due to a large amount of computation.","In recent years, with advancement of the processor technology, researches and studies have been performed toward a ray tracing technology capable of creating a realistic three-dimensional graphic.","The ray tracing technology is a rendering scheme according to global illumination, and may generate a realistic 3D image because reflection, refraction, shadow effect are naturally provided by considering an influence of light reflected and refracted from another object.","According to an embodiment of the invention, there is provided a ray tracing core including a ray tracing unit (RTU), a control unit, and a tree build unit (TBU). The ray tracing unit performs ray tracing based on a spatial partitioning structure. The control unit calculates a degree of complexity of the spatial partitioning structure by monitoring the load state of the ray tracing unit. The tree build unit builds the spatial partitioning structure having the degree of complexity which is calculated. In one embodiment, the load state is determined based on a frame rate which is processed in the pertinent unit. In another embodiment, the spatial partitioning structure applies a K-dimensional tree. For example, the degree of complexity can be modified according to either the maximum primitive number of a leaf node with respect to a K-dimensional tree structure or a tree depth. In an embodiment, the ray tracing core may further include: a primitive cache which provides a primitive scene to the tree build unit; and an acceleration structure result buffer which receives a processing result with respect to the primitive scene from the tree build unit. In another embodiment, the ray tracing core may further include: an acceleration structure cache which provides tree build information with respect to a primitive scene processed by the tree build unit to the ray tracing unit; a texture cache which provides a texture to the ray tracing unit; and a color result buffer which receives the tree build information and a processing result with respect to the texture from the ray tracing unit.","According to an embodiment of the invention, there is provided a method of processing ray tracing by a ray tracing processing apparatus, the method including: (a) performing ray tracing based on a spatial partitioning structure; (b) calculating a degree of complexity of the spatial partitioning structure by monitoring a load state when the ray tracing is performed; and (c) building the spatial partitioning structure having the calculated degree of complexity. The step (b) may include: (b1) monitoring a load state of a ray tracing unit and a load state of a tree build unit; (b2) comparing a load in the ray tracing unit with a load of the tree build unit to control the degree of complexity of the spatial partitioning structure; and (b3) providing the controlled degree of complexity to the tree build unit. The step (b1) may include: (b1-1) confirming a frame processing speed of the ray tracing unit; (b1-2) confirming a frame processing speed of the tree build unit; (b1-3) calculating a frame rate per unit time processed by the ray tracing unit and a frame rate per unit time processed by the tree build unit; and (b1-4) determining a load state of the ray tracing unit and a load state of the tree build unit based on the calculated frame rate. The spatial partitioning structure may apply a bounding volume Hierarchy (BVH) or K-dimensional (KD) tree, and the degree of complexity is modified according to either the maximum primitive number of a leaf node with respect to a BVD, or KD tree structure and\/or a tree depth. In one embodiment, when the load of the ray tracing unit is larger than a load of the tree build unit, the control unit reduces the degree of complexity of the spatial partitioning structure by increasing the maximum primitive number and reducing the tree depth. In another embodiment, when the load of the ray tracing unit is less than the load of the tree build unit, step (b2) may increase the degree of complexity of the spatial partitioning structure by increasing the maximum primitive number and reducing the tree depth.","According to an embodiment of the invention, there is provided a ray tracing processing apparatus including: a central processing unit which executes a three-dimensional application; a system memory which stores graphic data information necessary for the three-dimensional application; and a dynamic ray tracing accelerator (DRTX) which builds the spatial partitioning structure based on the graphic data information, performs ray tracing based on the spatial partitioning structure, and rebuilds the space partitioning structure with respect to the graphic data information by monitoring ray tracing speed. The ray tracing processing apparatus may further include an external memory operatively associated with the DRTX, and storing an acceleration structure of the spatial partitioning structure built according to the graphic data information necessary for the three-dimensional application and providing the acceleration structure of the spatial partitioning structure to the DRTX. The system memory may include: a primitive static scene (PPS) area which stores static scene information necessary for the three-dimensional application; a primitive dynamic scene (PDS) area which stores dynamic scene information necessary for the three-dimensional application; and a texture map area which stores an MIP-MAP for mapping a texture. In another embodiment, the DRTX may include: a ray tracing unit (RTU) which performs ray tracing with respect to a static scene and\/or a dynamic scene based on the spatial partitioning structure; a control unit which calculates a degree of complexity of the spatial partitioning structure by monitoring a load state of the ray tracing unit; and a tree build unit which builds the spatial partitioning structure having the degree of complexity which is calculated with respect to the dynamic scene. The ray tracing processing apparatus may further include an external memory which stores an acceleration structure of the spatial partitioning structure built according to a corresponding static scene and\/or dynamic scene built in the tree build unit, and provides the acceleration structure of the spatial partitioning structure to the ray tracing unit.","The embodiments and the configurations depicted in the drawings are illustrative purposes only and do not represent all technical scopes of the invention, so it should be understood that various equivalents and modifications may exist at the time of filing this application. Although a preferred embodiment of the disclosure has been described for illustrative purposes, those skilled in the art will appreciate that various modifications, additions and substitutions are possible, without departing from the scope and spirit of the invention as disclosed in the accompanying claims.","Terms and words used in the specification and the claims shall be interpreted as to be relevant to the technical scope of the invention based on the fact that the inventor may property define the concept of the terms to explain the invention in best ways.","The terms \u201cfirst\u201d and \u201csecond\u201d can be used to refer to various components, but the components may not be limited to the above terms. The terms will be used to discriminate one component from the other component. For instance, the first component may be referred to the second component and vice versa without departing from the right of the disclosure.","The term \u201cand\/or\u201d will be used to refer to the combination of plural items or any one item of the plural items. For example, \u201ca first item, a second item, and\/or a third item\u201d signify all combinations of at least two of the first item, the second item, and\/or the third item as well as the first item, the second item, and\/or the third item.","In addition, when a component is referred to as being \u201cconnected to\u201d or \u201clinked to\u201d another component, the component may be directly connected to or linked to another component or an intervening component may be present therebetween. In contrast, if a component is referred to as being \u201cdirectly connected to\u201d or \u201cdirectly linked to\u201d another component, an intervening component may not be present therebetween.","The terms used in the specification are for the purpose of explaining specific embodiments and have no intention to limit the disclosure. Unless the context indicates otherwise, the singular expression may include the plural expression. In the following description, the term \u201cinclude\u201d or \u201chas\u201d will be used to refer to the feature, the number, the step, the operation, the component, the part or the combination thereof without excluding the presence or addition of one or more features, the numbers, the steps, the operations, the components, the parts or the combinations thereof.","Reference numerals, for example, a, b, c, . . . are used for the purpose of illustration. The reference numerals do not describe an order of respective steps. The respective steps may be performed differently from an expressed order if the context does not describe a specific order. That is, the respective steps may be performed in the same order as the expressed order, may be simultaneously performed and may be performed in an opposite order.","Unless defined otherwise, the terms including technical and scientific terms used in this specification may have the meaning that can be commonly apprehended by those skilled in the art. The terms, such as the terms defined in the commonly-used dictionary, must be interpreted based on the context of the related technology and must not be interpreted ideally or excessively.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1"},"Referring to , the ray tracing core includes a ray tracing unit (RTU) , a control unit , and a tree build unit (TBU) .","The RTU  performs ray tracing based on a spatial partitioning structure. The method of performing the ray tracing will be described in detail later.","The control unit  calculates the degree of complexity of the spatial partitioning structure by monitoring a load state of the RTU . For example, the load state may be determined based on a frame rate which is processed in the RTU  and\/or the TBU .","The TBU  builds the spatial partitioning structure having the degree of complexity which is calculated. For example, the spatial partitioning structure may apply a bounding volume Hierarchy (BVH) or K-dimensional (KD) tree. The degree of complexity may be modified according to either the maximum primitive number of a leaf node with respect to the BVD, or KD-tree structure and\/or a tree depth. The BVD or KD-tree will be described in detail later. For example, if the maximum primitive number of leaf nodes or the total tree depth increases, the quality in an acceleration structure (AS) is degraded, but processing speed of the TBU  may be improved. As another example, if the maximum primitive number of leaf nodes reduces or the total tree depth increases, the quality in an acceleration structure (AS) is improved, which may result in an increase in the performance of the ray tracing, but the processing speed of the TBU  may be reduced. Accordingly, if the performance of the TBU  is degraded, the TBU  may control and improve the processing speed of the TBU . If the performance of the TBU  is sufficient, the TBU  may control and improve the quality in the AS.",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5"},"Referring to , the ray tracing core generates a primary ray P from a position of a camera  per pixel and calculates an object  meeting with the primary ray P. When an object meeting a corresponding ray P is an object  having a refractive property or objects  and  having a reflective property, a refraction ray F for a refractive effect and\/or a reflection ray R for a refractive effect may be generated at a location with which the corresponding ray P and the object meet, and a shadow ray S may be generated in a direction of a light . In an embodiment, if the shadow ray S meets with another object , a shadow may be generated at a point at which the corresponding shadow ray S is generated.",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 6"},"In , it is assumed that an acceleration structure AS uses a KD-tree. The KD-tree is a type of spatial partitioning structure and may be used for ray-triangle intersection test. For example, the KD-tree includes a box node , an inner node , and a leaf node . For example, the leaf node  may include a triangle list pointing at least one triangle information included in geometric data. For instance, the triangle information may include color coordinates, normal vectors, and\/or texture coordinates. For example, when the triangle information included in the geometric data is arranged, the triangle list included in the leaf node may correspond to an arrangement index.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIG. 3","FIG. 1"]},"Referring to , a control unit  may monitor load states of an RTU  and a TBU , respectively (step S). For example, the RTU  may perform ray tracing based on a spatial partitioning structure, and the TBU  may build the spatial partitioning structure.","When the load of the RTU  is greater than the load of the TBU , the control unit  may control and reduce the degree of complexity of the spatial partitioning structure. In contrast, when the load of the RTU  is less than the load of the TBU , the control unit  may control and increase the degree of complexity of the spatial partitioning structure (step S).","The control unit  may provide the controlled degree of complexity to the TBU  (step S). For example, the TBU  may reconfigure the spatial partitioning structure corresponding to the controlled degree of complexity provided from the control unit .",{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 2","FIG. 1"]},"Referring to , the ray tracing apparatus  may include a central processing unit (CPU) , a system memory , a dynamic ray tracing accelerator (DRTX) , and an external memory .","The CPU  may process a three-dimensional application, and may include an application  such as a three-dimensional game engine, an application programming interface (API) , and\/or a scene manager.","The system memory  may store graphic data information necessary for the three-dimensional application, and may include a primitive static scene (PPS) area  storing a PPS, a primitive dynamic scene (PDS) area  storing a PDS, and\/or a texture map area  storing an MIP-MAP for mapping a texture.","The DRTX  includes the ray tracing core  shown in , and may further include a bus interface unit , an AS result buffer , a primitive cache , a working memory , an AS cache , a texture cache , a color result buffer , and\/or a stack memory . For example, the DRTX  may build the spatial partitioning structure based on graphic data information, perform ray tracing based on the spatial partitioning structure, provide a result of the performed ray tracing to the CPU , and rebuild the space partitioning structure with respect to the graphic data information by monitoring the ray tracing speed.","The external memory  may temporarily store information processed by the DRTX , and may include a geometric information storage area , a static scene AS storage area , a dynamic scene AS storage area , a texture map storage area , and\/or a color information storage area .",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 4","FIG. 3"]},"Referring to a configuration of  in , if an application  of the CPU  is driven, a scene manger  may perform a preprocessing procedure to store a static scene, a dynamic scene, and a texture map in each area of the system memory . In an embodiment, the CPU , the system memory , and the DRTX  may transmit data through a high speed bus.","The DRTX  transmits a static scene stored in the system memory  to the TBU  through the bus interface unit , and the TBU  builds a tree with respect to the static scene (step S). The built static scene tree structure may be stored in a static scene AS structure storage area  through the AS result buffer .","The DRTX  transmits a dynamic scene stored in the system memory  to the TBU  through the bus interface unit , and the TBU  builds a tree with respect to the dynamic scene (step S). The built dynamic scene tree structure may be stored in a dynamic scene AS structure storage area  through the AS result buffer .","The DRTX  may store geometric information of each structure in a geometric information storage area  while storing the static scene tree structure and the dynamic scene tree structure. The DRTX  may interwork the work memory  in a procedure of generating a tree structure of each scene.","The RTU  may call the static scene tree structure and the dynamic scene tree structure stored in the external memory  through the AS cache  to perform the ray tracing (step S). For example, the RTU  may perform the ray tracing using the stack memory . In an embodiment, the texture map stored in the texture map area  of the system memory  is stored in a texture map storage area  of the external memory , and may be transmitted to the RTU  through the texture cache .","When the ray tracing is continuously performed without terminating the three-dimensional application (step S), the control unit  may monitor load states of the RTU  and the TBU  (step S). In an embodiment, the control unit  may confirm frame processing speed of the RTU  and frame processing speed of the TBU , calculate a frame rate per unit time processed by the RTU  and a frame rate per unit time processed by the TBU , and determine the load states based on the calculated frame rates.","When performance of the RTU  is higher than performance of the TBU  (step S), the control unit  may determine that a large load is applied to the TBU . In order to reduce the load of the TBU , the control unit  may control the TBU  to reduce the degree of complexity of the spatial partitioning structure (S). In an embodiment, the TBU  controls to reduce the degree of complexity of the spatial partitioning structure by increasing the maximum primitive number of leaf nodes or reducing the tree depth.","When performance of the RTU  is lower than performance of the TBU  (step S), the control unit  may determine that a suitable load is applied to the TBU  and may control the TBU  to increase the degree of complexity of the spatial partitioning structure in order to improve the quality of the AS (step S). The TBU  controls and increases the degree of complexity of the spatial partitioning structure by reducing the maximum primitive number of leaf nodes or increasing the tree depth.","The TBU  may rebuild a dynamic scene tree structure under control of the control unit  (step S).","Steps S to S by the RTU , the control unit , and the TBU  may be repeatedly performed until request of the three-dimensional application or termination of the three-dimensional application is achieved.","The disclosed technology has follow effects. However, since a specific embodiment may provide all the following effects or a few of them, the scope of the disclosure is not limited thereto.","The ray tracing core and the method of processing ray tracing according to an embodiment can improve ray tracing performance. That is, a resource required by each unit may be prevented from becoming insufficient or unnecessarily wasted, by monitoring or controlling the each unit.","The ray tracing core and the method of processing ray tracing according to an embodiment can improve performance of an apparatus for processing a three-dimensional image. That is, image processing of a rendering scheme according to global illumination may be performed in real time by improving processing speed of ray tracing.","The ray tracing core and the method of processing ray tracing according to an embodiment is applicable to a three-dimensional image processor which has been developed and a three-dimensional image processor which is currently used. This is because the disclosed technology may be performed by replacing only a ray tracing core according to a technology disclosed in an existing device and by updating a program.","Although embodiments have been described with reference to a number of illustrative embodiments thereof, it should be understood that numerous other modifications and embodiments can be devised by those skilled in the art that will fall within the spirit and scope of the principles of this disclosure. More particularly, various variations and modifications are possible in the component parts and\/or arrangements of the subject combination arrangement within the scope of the disclosure, the drawings and the appended claims. In addition to variations and modifications in the component parts and\/or arrangements, alternative uses will also be apparent to those skilled in the art."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DESCRIPTION OF DRAWINGS","p":[{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0011","num":"0010"},"figref":["FIG. 3","FIG. 1"]},{"@attributes":{"id":"p-0012","num":"0011"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
