---
title: Context harvesting from selected content
abstract: A system and process for harvesting context information from selected content is described. One may use a stylus to indicate what content is to be captured. The context information that may be associated with selected content may include URLs, file names, folder names, text from the content, and ink.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07966352&OS=07966352&RS=07966352
owner: Microsoft Corporation
number: 07966352
owner_city: Redmond
owner_country: US
publication_date: 20040126
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","BRIEF SUMMARY","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","Aspects of the present invention relate to image processing and information manipulation. More specifically, aspects of the present invention relate to obtaining and using context information related to selected content.","2. Description of Related Art","People often rely on graphical representations more than textual representations of information. They would rather look at a picture than a block of text that may be equivalent to the picture. For instance, a home owner may cut out pictures of magazines to show contractors exactly what is desired when remodeling a kitchen or bathroom. Textual representations of the same material often fall short. The tool that the home owner may use is no more complex than a pair of scissors.","In the computing world, however, attempting to capture and convey the identical content is cumbersome. Typical computer systems do not provide an easy interface for capturing and conveying graphically intensive content. Rather, they are optimized for capturing and rendering text. For instance, typical computer systems, especially computer systems using graphical user interface (GUI) systems, such as Microsoft WINDOWS, are optimized for accepting user input from one or more discrete input devices such as a keyboard for entering text, and a pointing device such as a mouse with one or more buttons for driving the user interface.","Some computing systems have expanded the input and interaction systems available to a user by allowing the use of a stylus to input information into the systems. The stylus may take the place of both the keyboard (for data entry) as well as the mouse (for control). Some computing systems receive handwritten electronic information or electronic ink and immediately attempt to convert the electronic ink into text. Other systems permit the electronic ink to remain in the handwritten form.","Despite the existence of a stylus, selection of displayed content remains difficult and cumbersome. One needs to copy a screen to a paint program, crop the information, and then forward the information as one desires. However, this process can become difficult with a stylus.","One company, TechSmith Corporation, has introduced Snagit\u00ae, a product for capturing screens. Snagit\u00ae is mouse-based and requires multiple steps prior to capturing content. Content alone can be bland and not useful. Additional approaches are needed to provide a better user experience by capturing additional information from selected content.","Aspects of the present invention address one or more of the issues mentioned above, thereby providing a better context gleaning and associating approach. Information relating to how, when, where, and others may be associated with selected content.","These and other aspects are addressed in relation to the Figures and related description.","Aspects of the present invention relate to determining and associating context information with selected content.","A user may initiate a capture process, capture content, and then perform an action on the content. The action may include, but is not limited to, the following:\n\n","The content capturing may then be combined with context information gleaned from the captured content. This context information may come in a variety of forms. In some instances, it may be referred to as metadata. In other instances, it may represent actual content contained within a selection. To some extent, these latter instances may or may not be referred to as metadata.","This document is divided into sections to assist the reader. These sections include: characteristics of ink, terms, general-purpose computing environment, content capture and use, context capture and association with content, types of context information, and processes for determining context.","Characteristics of Ink","As known to users who use ink pens, physical ink (the kind laid down on paper using a pen with an ink reservoir) may convey more information than a series of coordinates connected by line segments. For example, physical ink can reflect pen pressure (by the thickness of the ink), pen angle (by the shape of the line or curve segments and the behavior of the ink around discreet points), and the speed of the nib of the pen (by the straightness, line width, and line width changes over the course of a line or curve). Because of these additional properties, emotion, personality, emphasis and so forth can be more instantaneously conveyed than with uniform line width between points.","Electronic ink (or ink) relates to the capture and display of electronic information captured when a user uses a stylus-based input device. Electronic ink refers to a sequence of strokes, where each stroke is comprised of a sequence of points. The points may be represented using a variety of known techniques including Cartesian coordinates (X, Y), polar coordinates (r, \u0398), and other techniques as known in the art. Electronic ink may include representations of properties of real ink including pressure, angle, speed, color, stylus size, and ink opacity. Electronic ink may further include other properties including the order of how ink was deposited on a page (a raster pattern of left to right then down for most western languages), a timestamp (indicating when the ink was deposited), indication of the author of the ink, and the originating device (at least one of an identification of a machine upon which the ink was drawn or an identification of the pen used to deposit the ink) among other information.","Terms","Ink\u2014A sequence or set of strokes with properties. A sequence of strokes may include strokes in an ordered form. The sequence may be ordered by the time captured or by where the strokes appear on a page or in collaborative situations by the author of the ink. Other orders are possible. A set of strokes may include sequences of strokes or unordered strokes or any combination thereof Further, some properties may be unique to each stroke or point in the stroke (for example, pressure, speed, angle, and the like). These properties may be stored at the stroke or point level, and not at the ink level","Ink object\u2014A data structure storing ink with or without properties.","Stroke\u2014A sequence or set of captured points. For example, when rendered, the sequence of points may be connected with lines. Alternatively, the stroke may be represented as a point and a vector in the direction of the next point. In short, a stroke is intended to encompass any representation of points or segments relating to ink, irrespective of the underlying representation of points and\/or what connects the points.","Point\u2014Information defining a location in space. For example, the points may be defined relative to a capturing space (for example, points on a digitizer), a virtual ink space (the coordinates in a space into which captured ink is placed), and\/or display space (the points or pixels of a display device).","General-Purpose Computing Environment",{"@attributes":{"id":"p-0034","num":"0042"},"figref":["FIG. 1","FIG. 1"],"b":["100","110","120","130","110","130","120","140","150"]},"A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within the computer , such as during start-up, is stored in the ROM . The computer  also includes a hard disk drive  for reading from and writing to a hard disk (not shown), a magnetic disk drive  for reading from or writing to a removable magnetic disk , and an optical disk drive  for reading from or writing to a removable optical disk  such as a CD ROM or other optical media. The hard disk drive , magnetic disk drive , and optical disk drive  are connected to the system bus  by a hard disk drive interface , a magnetic disk drive interface , and an optical disk drive interface , respectively. The drives and their associated computer-readable media provide nonvolatile storage of computer readable instructions, data structures, program modules and other data for the personal computer . It will be appreciated by those skilled in the art that other types of computer readable media that can store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, Bernoulli cartridges, random access memories (RAMs), read only memories (ROMs), and the like, may also be used in the example operating environment.","A number of program modules can be stored on the hard disk drive , magnetic disk , optical disk , ROM  or RAM , including an operating system , one or more application programs , other program modules , and program data . A user can enter commands and information into the computer  through input devices such as a keyboard  and pointing device . Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner or the like. These and other input devices are often connected to the processing unit  through a serial port interface  that is coupled to the system bus, but may be connected by other interfaces, such as a parallel port, game port or a universal serial bus (USB). Further still, these devices may be coupled directly to the system bus  via an appropriate interface (not shown). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video adapter . In addition to the monitor, personal computers typically include other peripheral output devices (not shown), such as speakers and printers. In one embodiment, a pen digitizer  and accompanying pen or stylus  are provided in order to digitally capture freehand input. Although a direct connection between the pen digitizer  and the serial port interface  is shown, in practice, the pen digitizer  may be coupled to the processing unit  directly, parallel port or other interface and the system bus  by any technique including wirelessly. Also, the pen  may have a camera associated with it and a transceiver for wirelessly transmitting image information captured by the camera to an interface interacting with bus . Further, the pen may have other sensing systems in addition to or in place of the camera for determining strokes of electronic ink including accelerometers, magnetometers, and gyroscopes.","Furthermore, although the digitizer  is shown apart from the monitor , the usable input area of the digitizer  may be co-extensive with the display area of the monitor . Further still, the digitizer  may be integrated in the monitor , or may exist as a separate device overlaying or otherwise appended to the monitor .","The computer  can operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  can be a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above-relative to the computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the local network  through a network interface or adapter . When used in a WAN networking environment, the personal computer  typically includes a modem  or other means for establishing a communications over the wide area network , such as the Internet. The modem , which may be internal or external, is connected to the system bus  via the serial port interface . In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in the remote memory storage device. Further, the system may include wired and\/or wireless capabilities. For example, network interface  may include Bluetooth, SWLan, and\/or IEEE 802.11 class of combination abilities. It is appreciated that other wireless communication protocols may be used in conjunction with these protocols or in place of these protocols.","It will be appreciated that the network connections shown are illustrative and other techniques for establishing a communications link between the computers can be used. The existence of any of various well-known protocols such as TCP\/IP, Ethernet, FTP, HTTP and the like is presumed, and the system can be operated in a client-server configuration to permit a user to retrieve web pages from a web-based server. Any of various conventional web browsers can be used to display and manipulate data on web pages.",{"@attributes":{"id":"p-0041","num":"0049"},"figref":["FIG. 2","FIG. 1","FIG. 2"],"b":["201","201","202","203","204","202","202","201","204"]},"The stylus  may be equipped with one or more buttons or other features to augment its selection capabilities. In one embodiment, the stylus  could be implemented as a \u201cpencil\u201d or \u201cpen\u201d, in which one end constitutes a writing portion and the other end constitutes an \u201ceraser\u201d end, and which, when moved across the display, indicates portions of the display are to be erased. Other types of input devices, such as a mouse, trackball, or the like could be used. Additionally, a user's own finger could be the stylus  and used for selecting or indicating portions of the displayed image on a touch-sensitive or proximity-sensitive display. Consequently, the term \u201cuser input device\u201d, as used herein, is intended to have a broad definition and encompasses many variations on well-known input devices such as stylus . Region  shows a feedback region or contact region permitting the user to determine where the stylus  as contacted the display surface .","In various embodiments, the system provides an ink platform as a set of COM (component object model) services that an application can use to capture, manipulate, and store ink. One service enables an application to read and write ink using the disclosed representations of ink. The ink platform may also include a mark-up language including a language like the extensible markup language (XML). Further, the system may use DCOM as another implementation. Yet further implementations may be used including the Win32 programming model and the Net programming model from Microsoft Corporation.","Content Capture and Handling","One of the benefits of a stylus-based computing system is the closeness it brings a user to interacting with printed paper. Instead of being separated by a keyboard and mouse, a stylus-based computer permits a user to more intimately interact with a document and displayed content as easily as one would interact with physical paper. One may use the application with an electromagnetic digitizer, may use a resistive touch screen or the like. The application may use functionality provide with ink (strokes, properties, methods, events, and the like) or may rely on bit mapped images of ink encircling content.","As to capturing and sending content, conventional image capturing tools require significant interaction between the user and the capturing application to specify which type of capturing process is desired and navigation of distracting menus to indicate how the content is handled, even before content is captured.","Aspects of the present invention attempt to eliminate these distractions by making content capturing and handling more intuitive. In one aspect, the system may allow initiation of the capture process, capture, and initiation of an action associated with captured content with three clicks or taps of the stylus.",{"@attributes":{"id":"p-0047","num":"0055"},"figref":"FIG. 3","b":["301","301","302","303","301","303","304","304","302","304"]},{"@attributes":{"id":"p-0048","num":"0056"},"figref":"FIG. 4","b":["401","402","402","403","403","404","404","404","402","404","402","402","403","403"]},{"@attributes":{"id":"p-0049","num":"0057"},"figref":"FIG. 5","b":["501","501","404","501","403","501","403"]},"Toolbar  includes a number of options that may be used with the designated content in selected region . For instance, a user may copy designated content in selected region  to a clipboard upon selection of a first button . A user may save the content of region  by selection of button . A user may e-mail the content of region  upon selection of button . The email feature permits users to easily share information by emailing the captured image and any annotation, or by copying it to a clipboard so that it can be pasted into another program.","A user may print the content of region  upon selection of button . Upon selection of button , the system may open a content selection editor where the content of designated region . Further, the system may display multiple selection regions  to a user at the same time, providing a user with the ability to compare the content of multiple selection regions  against each other. This may facilitate comparison shopping over the Internet without the need to open and maintain separate open windows.","Upon selection of button , the user may be able to change a pen width and\/or color of the ink. Using the pen functionality of button , the user may then annotate the captured content as simply as annotating on a piece of paper. Upon selection of button , the user may be able to change the pen width of a highlighter and\/or color of the highlighter. Users may write words, circle objects, highlight objects (with, for instance, subtractive rendering so that the object below can be seen through the highlighting or with opaque ink), and effectively do anything else akin to annotating a piece of paper with a pen.","Upon selection of button , the user may erase some or all of the content in region . Upon selection of button , the user may operate a selection tool to further select some or all of the content of region . Finally, upon selection of button , the toolbar  and region  may be closed.",{"@attributes":{"id":"p-0054","num":"0062"},"figref":"FIG. 6","b":["601","602","603","602","604","603","604","605","602","606","602","602","607","608","610","602","608","610"]},"The content captured by aspects of the present invention may include static content (for example, images) or underlying data. For instance, underlying text (for example, HTML links, words, sentences, and\/or paragraphs) may be captured. Also, underlying objects (for instance, stock tickers, calendars, files being displayed or played) and underlying associations with remote content (for instance, the location of a music file being played locally) may be captured. Further, meta-data including the person capturing the information, the date and time capture may be associated with the captured information as well. The source of the content may be identified as well.","More than one region may be selected. For instance, by holding down a button (performing a gesture or the like) one may designate that additional content should be selected. In this regard, one may have another gesture or a button act as the indication that all desired content has been selected.","Aspects of the present invention may be implemented as a stand-alone application. Alternatively, aspects of the present application may be incorporated into a shell providing a graphical user interface to a user. In one example, the capturing tool may be integrated into an Internet browser.","Context Capture and Association with Content","Content alone can be meaningless. For instance, the fact that someone selects a statistic on a web page and sends a selected area with the statistic alone may have no value. However, a link back to the location of the web site may make the statistic have significant value. The same rationale may be applied to news stories, photographs, text, and the like. The link may be implicit or explicit. An implicit link may be hidden behind a displayed selection so that tapping on the displayed selection may activate the link. This link may never be exposed to a user, may be exposed during a mouse-over or stylus hover event, or may be exposed to the user upon request. An explicit link may be shown in conjunction with the selected content (for instance, above, below, around the side, and the like).",{"@attributes":{"id":"p-0059","num":"0067"},"figref":"FIG. 7","b":["701","702","703","701","702"]},"Further, two users may invoke the process of . A first user may designate content . A second user may harvest context information  from the designated content and associate it with the designated content in step . For instance, the first user may highlight a URL while the second user may navigate to the site identified by the URL and harvest content from that location. Other variations are possible. The content may be forwarded in various forms to another user as shown in . For instance, one may email the selected content with context information to another. Also, one may send the selected content with context information to another. The context information may be stored as a separate file or may be stored with the image of the selected content. For instance, if the selected content is transmitted as a JPEG format or any file format that includes a comment field or fields, the context information may be parsed and transmitted in the comment field or fields. If the recipient has a system that is enabled to use the context information, this information may be extracted and provided to the user.",{"@attributes":{"id":"p-0061","num":"0069"},"figref":["FIGS. 8 and 9","FIG. 8"],"b":["801","802","803"]},{"@attributes":{"id":"p-0062","num":"0070"},"figref":"FIG. 9","b":["901","902","903","902","901","904","901","902","905","901","902","906","907"]},"Types of Context Information",{"@attributes":{"id":"p-0063","num":"0071"},"figref":["FIG. 10","FIGS. 8 and 9"],"b":["1001","1002","1003","1004","1003","1005","1002","1006","1002","1007","1002","1008","1001","1009","1002"]},"The context information may be displayed to the user in various ways. For instance, the context may be displayed as a property in a window or when hovering over the content . Also, to some extent, the context may be modified. For instance, a derived title of the content may be taken from a URL. However, as some URLs are meaningless to users when the URLs include CGI script or ASP information, titles of the content may be modified to provide a better understanding of what is represented by the content. As an example, a title may be represented by a web address including data.asp?loc=123&sku=70012330 that attempts to look up sku number 70012330. Sku numbers are meaningless to the average consumer while the content of the page (e.g., a camcorder) has value. Accordingly, a user may edit the title to reflect a title that they can use to more accurately indicate the significance of the content to them, e.g. \u201cCamcorder on Sale.\u201d","Some content may be restricted by digital rights management (DRM) licenses. The context information may include preventive measures that prevent the association of context with content. These measures may or may not be used to prevent the designation of content in the first place. Further, these measures may enable one to determine the history of content. For instance, these measures may prevent any history from being associated with content. Alternatively, these measures may only allow the most recent history to be associated with content. Further, these measures may permit all history and information to be associated with content. These measures may be controlled by the operating system or may be controlled by an application.","Referring back to , designated content  encompasses at least part of a web page. The URL of the web page may be determined and added to context .","Referring to , a user has selected with a selection region  a portion of text  as displayed in region . At least two approaches may be used to capture the text underlying the selected region . In a first instance, the entire text  from region  may be captured and added to context . Amount of information captured from region  may be defined by the size of the physical display (text not shown on a display are not captured), the size of region  (text not actually shown but scrollable through region ), the punctuation in text  (so as to capture full sentences, full paragraphs, full chapters, etc.), and the like.","In an alternative approach, only complete characters or words may be captured. This may depend on the size of selection . The resulting text  may then be added to context .","The capturing of text may also include the capturing of associated links to embedded pictures, photographs, and the like. Active content information may also be captured including, for instance, content and how the content has changed.",{"@attributes":{"id":"p-0070","num":"0078"},"figref":"FIG. 12","b":["1201","1","1202","2","1204","3","1203","1205","1","1201","1205","1208","1205","1208","1205","1","1201","1","1201","1","1201","1208","1208","1","1201"]},"Selection by selection  of a file, for instance file  , may or may not include an indication of the folder (folder  ) storing the file . In one example, the path with the folder may be stored. In another example, no path may be stored. In a third example, the identification of the file  may be stored so as to eliminate the need to remember the path or location of a file to access it.","Annotations  may also be stored in context . The annotations may take the form of text or electronic ink. If in ink, they may be kept in their original ink form, may be converted to text, or may be stored in both their original and converted forms to enable searching and reproduction of the original ink.","Processes for Determining Context","For sake of explanation, the extracted context is separated into two categories. The first category relates to information related to the visual information in the content. The visual information may or may not be independent of any text actually displayed in the content. The second category relates to actual text drawn from the content.",{"@attributes":{"id":"p-0074","num":"0082"},"figref":"FIG. 13","b":["1301","1302"]},"The following describes the COM Accessibility APIs. Of course, other approaches may be used. The system next uses the AccessibleObjectFromWindow API to retrieve an IAccessible interface from the window of interest in step . Whether an IAccessible can be retrieved depends on the application that created the window. Many applications support this interface as Assistive Technology products rely on the interface to make the application accessible.","The IAccessible interface provides a name property and a value property. These properties are both text strings. The contents of these strings are defined by the application which created the window of interest. These strings are also accessed by Assistive Technology products, (e.g. screen readers), and so the text will normally relate to the window. The system attempts to find a URI in at least one of the value and name properties in step . The system may first query the value field or the name field or use information from both. If, in step , a URI is found, then the process ends in step . If not, then the system uses the parent window of the current window being examined as shown in step . If the parent window exists in step , then the parent window becomes the current window in step  and the system performs steps - again. If there are no parent windows, then the system ends in step .","The above steps often lead to a URI being found that is related to the visuals being selected. For example, the URI might be an Internet URL if the selected region relates to a web page in a browser, or the URI may be a document name if the selected region relates to a document viewing application.","The second group relates to determining text displayed in a selected region. In a first approach, a system may apply optical character recognition to the visual content of a selected region. The result may then be stored as context information.","In a second approach, shown in , a system has access to the underlying text and needs to determine which characters, words, sentences, paragraphs, and the like should be included as part of the context information.","In this illustrative example, the system attempts to find only the text that is displayed within the selected region (for instance, the region defined by loop ). Accessibility information is helpful in determining the underlying text. For accessibility information that does not provide the location of the text, one may attempt to do a graphical match for the text in the selected region with the underlying text to determine the actual text shown in the selected region.","Alternatively, for accessibility information that may include the location of text, one may use the accessibility information to determine an element in the selected region (step ). The selected element may be anywhere in the selected region or may be in the center of the selected region. The element may be considered to be an object that can provide information used by assistive technology products (for instance, text enlargers for visually impaired individuals), and may be associated with a window on the screen. Next, in step , the system attempts to determine the type of element (text, picture, drawing, etc.). If text, then the system moves to step .","In step , the system obtains a text pointer from the element or starts at a default location in the text and starts working its way through the text. In step , the system navigates through the text associated with the window in different ways. For example, the text could be navigated through at a character-by-character level or at a word-by-word level.","In step , the system may then use the above pointer to navigate through the text or a pointer assigned at a default location. The pointer may then be used to obtain details of the text itself. The system may navigate through the text and, for each character or word in the text, determines the bounding box for the character or word. Next in step , the system compares this bounding box with the region that defines the selection. If the character or word is determined to lie entirely within the region, the system then looks up the word or character corresponding to the bounding box and includes this character or word with the harvested context in step . If the character does not lie entirely within the selected region then it may be ignored. The system then repeats the process with the next character or word in the text.","The process may function as described above. Alternatively, performance may be improved by comparing the bounding box of the characters with the bounding box of the selected region itself, prior to testing whether the character lies within the complex border of the selected region. If assumptions are made that the text being obtained is horizontal, then performance may be improved further. (For example, once the text lies beneath the bottom of the bounds of the selected region then all subsequent text lies beneath the bottom of the bounds of the selected region.)","Aspects of the present invention have been described in terms of illustrative embodiments thereof. Numerous other embodiments, modifications and variations within the scope and spirit of the appended claims will occur to persons of ordinary skill in the art from a review of this disclosure."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIGS. 8 and 9"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIGS. 11-12"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 14"}]},"DETDESC":[{},{}]}
