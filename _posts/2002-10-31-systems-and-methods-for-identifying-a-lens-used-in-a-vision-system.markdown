---
title: Systems and methods for identifying a lens used in a vision system
abstract: Systems and methods for identifying an interchangeable lens in a vision system having a controllable light source, a camera, and the lens to be identified. Light provided by the light source is transferred to the camera by the lens to be identified. The amount of light transferred to the camera for a particular reference configuration of the vision system depends distinguishably on the characteristics of the lens to be identified. A camera output is measured for a desired light source setting and the desired light source setting and associated measured camera output are compared with stored lens identification calibration data. The stored lens identification calibration data is obtained by measuring the camera output for a plurality of lenses using a plurality of light source settings. In various exemplary embodiments, the light transferred from the light source to the camera is reflected and/or backscattered light from the lens to be identified.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07110036&OS=07110036&RS=07110036
owner: Mitutoyo Corporation
number: 07110036
owner_city: Kawasaki
owner_country: JP
publication_date: 20021031
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF EXEMPLARY EMBODIMENTS"],"p":["1. Field of Invention","This invention relates to automatic machine vision systems.","2. Description of Related Art","Conventional machine vision systems perform dimensional measurements of specific target features of a sample workpiece. One such use of a vision system is, for example, measuring the position or other characteristic of specific target features of a sample workpiece for comparison to a standard or reference value for the position or other characteristic of the workpiece. In such an application, a lens is used to focus on specific target features.","Different magnifying objective lenses having different optical characteristics are often appropriate when viewing different target features and\/or when measuring different characteristics. To use different lenses, one lens is removed from the vision system and another is used in its place. When replacing the lens, the physical characteristics of the lens must be known so that an operator can accurately measure specific target features. These physical characteristics include, but are not limited to, the aperture, the optical configuration of the lens, the optical resolution of the lens, as well as other imaging characteristics that are unique to the lens.","One method of identifying the lens is for the operator to observe the manufacturing label on the lens in order to determine identification information on the label. The identification information includes information regarding the physical characteristics of the lens. However, such methods require that the operator locate the label. Locating the label can be difficult if it is not done before the lens is inserted into the vision system. This occurs because the operator often must position himself awkwardly to observe the label. Furthermore, the operator may have to position himself unsafely close to the machine to positively identify the lens.","After the operator identifies the lens, the operator must then input the identification information into a machine vision controller, such that various image-processing operations or other control operations properly correspond to the lens. To input the identification information, time and effort is expended by the user. Also, errors can occur in the operation of the vision machine if the operator does not accurately input the correct identification information.","Another method for identifying the lens is for a lens label to be automatically scanned by a scanner or for a sensor of the machine vision systems to otherwise optically or electronically obtain information encoded in features on the lens. These methods use a scanner or sensor that is located within the vision system. Thus, the information located on the lens can be obtained and input into the controller. However, increased hardware costs and increased difficulties in modifying legacy vision systems are created. Furthermore, various lens identification systems will be incompatible with various lenses that might otherwise be used on a vision system.","Thus, in many practical cases, conventional methods do not offer reasonable solutions for accurately and quickly determining the physical characteristics of a lens. Thus, there is a need for simple and automatic methods or devices that can identify interchangeable lenses in an automatic machine vision system.","This invention provides systems and methods that automatically identify a lens that does not include specially-created identifying marks or features.","This invention separately provides systems and methods that identify a lens using a limited number of automatic setup conditions.","This invention separately provides systems and methods that use a vision system camera and lighting system to identify a lens based on a consistent light transfer characteristic of the lens.","This invention separately provides systems and methods that identify a lens by taking a series of featureless image measurements using a vision system camera and lighting.","This invention provides systems and methods that identify a lens by taking a series of featureless-image based measurements that allow the classification of a current lens based on a database of measurements of known lenses.","This invention separately provides systems and methods that take advantage of a predetermined set of lens identification calibration values for a particular lens set.","This invention separately provides systems and methods that take advantage of varying reflection characteristics of various lenses.","This invention separately provides systems and methods that identify a lens by positioning an inherent part of the workpiece stage in the field of view.","This invention separately provides systems and methods that identify a lens without the need for repositioning an X-Y stage or workpiece of the vision system.","This invention separately provides systems and methods that identify a lens by measuring its effect on the energy transfer from a light source to a camera system.","This invention separately provides systems and methods that identify a lens without placing a target in focus on the field of view of the lens.","This invention separately provides systems and methods that are insensitive to unpredictable variations that may occur in a field of view illuminated by a light source used for the lens identification.","This invention separately provides systems and methods that are compensated or calibrated for the different coatings, properties and tolerances of different lenses.","This invention separately provides systems and method that compensate for unpredictable energy level output variations that occur over the life of a light source used for the lens identification.","This invention separately provides systems and methods that select a plurality of optical system components used to return light from a lens to a camera in order to normalize the measurements used to identify the lens.","This invention separately provides systems and methods that are compensated or calibrated for using a family of lenses for a plurality of vision systems having certain design variations.","In various exemplary embodiments of the systems and methods according to this invention, the vision system includes a motion system, a camera, a light source that emits source light at desired light source settings, a lens to be identified that transfers light from the light source to the camera, and a controller. The controller and the motion system are used to put the vision system into a reference configuration. The controller receives a camera output for the desired light source settings and compares the desired light source settings and associated measured camera outputs with stored lens identification calibration data for various lenses. In various exemplary embodiments, each measured camera output is the total of all light intensity values, or gray level values, of all the pixels of the camera.","In various other exemplary embodiments, each measured camera output is the sum of the intensity values of a consistent subset of the pixels of the camera. In various exemplary embodiments, each measured camera output is an average intensity value based on the intensity values, or gray level values, of all the pixels of the camera or a subset of all the pixels of the camera. In various other exemplary embodiments, each measured camera output is the result of an image processing operation that includes analyzing more than one consistent subset of the pixels of the camera for their intensities and\/or a relationship between their intensities. The lens is identified based on the comparison. The stored lens identification calibration data was previously obtained by measuring the camera output for a plurality of lenses using a plurality of light source settings.","In various exemplary embodiments, the light source is a coaxial light source, and the reference configuration includes moving the lens to be identified out of its focus range relative to any objects in the field of view. The light transferred from the lens to be identified to the camera includes a significant proportion of the coaxial light reflected and\/or backscattered from the lens to be identified.","In various other exemplary embodiments, the light source is a surface light or a stage light and the reference configuration includes positioning a known surface portion or target of the vision system in a reference position relative to the lens to be identified.","In various other exemplary embodiments, the vision system further includes a turret assembly with at least two different turret lenses that differently modify the light transferred from the lens to be identified before it is received by the camera. The camera receives the modified transmitted light from the turret assembly. The controller measures at least two camera outputs for the at least two turret lenses at a desired light source setting and compares the at least two camera outputs and the at least two turret lenses with stored lens identification calibration data. The lens is identified based on the comparison.","These and other features and advantages of this invention are described in, or are apparent from, the following detailed description of various exemplary embodiments of the systems and methods according to this invention.","For simplicity and clarification, the operating principles and design factors of this invention are explained with reference to one exemplary embodiment of a vision system according to this invention, as shown in . The basic explanation of the operation of the vision system shown in  is applicable for the understanding and design of any vision system that incorporates the illumination selection systems and methods according to this invention.",{"@attributes":{"id":"p-0045","num":"0044"},"figref":["FIG. 1","FIG. 1"],"b":["10","10","100","200","200","205","210","212","205","260","250","400","230","250","400","400"]},"A workpiece  to be imaged using the vision system  is placed on the stage . One or more of the light sources ,  and  emits source light , , or , respectively, that is usable to illuminate the workpiece . Light emitted by the light sources ,  and\/or  illuminates the workpiece  and is reflected or transmitted as workpiece light , which passes through the interchangeable objective lens  and the turret lens assembly  and is gathered by the camera system , which together act as an imaging system to generate an image of the workpiece . The image of the workpiece , captured by the camera system , is output on a signal line  to the control system portion .","The light sources \u2013 used to illuminate the workpiece  can include a stage light , the coaxial light , and a surface light , such as a ring light or a programmable ring light, all connected to the control portion  through signal lines or busses ,  and , respectively. As a primary optical assembly of the vision system , the optical assembly portion  may include, in addition to the previously discussed components, other lenses, and other optical elements such as apertures, beamsplitters and the like, such as may be needed for providing coaxial illumination, or other desirable vision system features. As a secondary optical assembly of the vision system , the turret lens assembly  includes at least a first turret lens position and lens  and a second turret lens position and lens . The control portion  rotates the turret lens assembly  along axis  between, at least the at least first and second turret lens positions through a signal line or bus .","The distance between the stage  and the optical assembly portion  can be adjusted to change the focus of the image of the workpiece  captured by the camera system . In particular, in various exemplary embodiments of the vision system , the optical assembly portion  is movable in a vertical \u201cz-axis\u201d direction relative to the stage  using a controllable motor  that drives an actuator, a connecting cable, or the like, to move the optical assembly portion  along the z-axis. The term z-axis, as used herein, refers to the axis that is intended to be used for focusing the image obtained by the optical assembly portion . The controllable motor , when used, is connected to the input\/output interface  via a signal line .","As shown in , in various exemplary embodiments, the control portion  includes an input\/output interface , a controller , a memory , including a lens identification calibration data portion , an area of interest generator , and a power supply  including an illumination power supply portion , each interconnected either by one or more data\/control busses and\/or application programming interfaces  or by direct connections between the various elements. The signal lines or busses ,  and  of the stage light , the coaxial light , and the surface light , respectively, are all connected to the illumination power supply portion . The signal line  from the camera system  and the signal line  from the controllable motor  are connected to the input\/output interface . In addition to carrying image data, the signal line  may carry a signal from the controller  or the image generating circuit or routine  that initiates image acquisition.","A display device  can also be connected to the input\/output interface  over a signal line . One or more input devices  can be connected to the input\/output interface  over one or more signal lines . The display device  and the one or more input devices  can be used to view, create and\/or modify part programs, to view the images captured by the camera system  and\/or to directly control the vision system components portion . However, it should be appreciated that, in a fully automated system having a predefined part program, the display device  and\/or the one or more input devices , and the corresponding signal lines  and\/or , may be omitted.","The memory portion  stores data usable to operate the vision system components portion  to capture an image of the workpiece  such that the input image of the workpiece  has desired image characteristics. The memory portion  further stores data usable to operate the vision system  to perform various inspection and measurement operations on the captured images, either manually or automatically, and to output the results through the input\/output interface . The memory  also contains data defining a graphical user interface operable through the input\/output interface . The lens identification calibration data portion  stores various lens identification calibration data comparing various camera outputs and light source settings for various lenses to be identified. In various exemplary embodiments, turret lens position data are included in the lens identification calibration data.","As shown in , the vision system  also includes an image generating circuit, routine or application . The image generating circuit, routine or application  is usable to determine image acquisition settings and\/or acquire an image of the workpiece  such that the input image of the workpiece  has desired image characteristics in a region of interest. The image generating circuit, routine or application  can use a tool, such as a dual area contrast tool, an edge tool or a multi-channel lighting tool, as variously disclosed in U.S. patent application Ser. Nos. 09\/484,897, 09\/736,187, 09\/921,886, and 09\/987,986, each incorporated herein by reference in its entirety.","The term image characteristic, as used herein, in various exemplary embodiments, can refer to relatively high level image results, such as texture characteristics, edge characteristics and the like, that support the proper operation of various image tools, such as the dual area contrast tool, edge tools and the like discussed above. The term image characteristic, as used herein, furthermore can include within its scope the various determined parameters, operation results, and combinations of results underlying various vision system tools, including the various determined parameters, operation results, and combinations of results referred to as image results in the various incorporated references.","Additional exemplary tools and methods usable in combination with this invention are evident in commercial machine vision systems such as the Quick Vision series of vision inspection machines and QVPAK software available from Mitutoyo America Corporation (MAC), located in Aurora, Ill. However, it should be appreciated that any such tool, whether currently available or later developed, can be used to determine image acquisition settings and\/or acquire an image of the workpiece  having desired image characteristics in a region of interest.","It should be appreciated that, in various exemplary embodiments, the systems and methods according to this invention utilize the varying degrees of energy transfer between a light source and a camera, which occur due to the different lens characteristics of different intervening lenses, to identify the lens. Thus, in various exemplary embodiments according to this invention, conditions are provided which establish the lens to be identified as the primary variable controlling the transfer of the light from a particular light source to the camera of the vision system. When the lens to be identified is the primary variable, then one lens can be distinguished from another based on the different transfer relationship that each lens establishes for the camera output level relative to the light source level.","Accordingly, in various exemplary embodiments disclosed with reference to , the vision system is configured in a reference configuration as one part of the lens identification operations. In general, the reference configuration encompasses at least selecting the reference light source and the relative positions of the optical assembly portion  relative to the stage . In general, the reference configuration provides a standard configuration that tends to reduce, and ideally minimize, and\/or control certain other variables and variations that may influence the transfer of the light from the particular light source to the camera during lens identification. Furthermore, in various exemplary embodiments according to this invention, the reference configuration also tends to reduce, and ideally minimize, or control any effects caused by ambient light, a reflectance of a workpiece that may be in the nominal field of view, and the like. Various particular reference configurations are discussed in greater detail below.",{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIGS. 2\u20135","FIG. 2","FIG. 3","FIG. 4","FIG. 5"]},"For the first exemplary embodiment, the vision system light source that is being used is a stable, calibrated light source. That is, the light source reliably produces the same illumination intensity for a particular input light control level over long periods of time, due to the particular design and\/or calibration procedures used for that light source. Such light sources are increasingly available in commercial machine vision systems. A related system is described in U.S. Pat. No. 6,239,554, which is incorporated herein by reference in its entirety. The camera is similarly stable and\/or calibrated. Thus, for a given reference configuration on a particular machine having an associated lens set with associated lens identification calibration data, ideally only a single light source setting and an associated camera output is sufficient to identify a lens.","If a turret lens assembly, such as the turret lens assembly , is included in the vision machine, then only one turret lens position is required to be used, and that position can be considered one element of the reference configuration. A plurality of light source settings and\/or a plurality of turret lens positions is not required, although that data could be gathered, because the stable, calibrated light source outputs a well known energy or intensity, and the corresponding camera output should in that case vary only as a function of the light transfer characteristic of the lens to be identified. Once the calibrated data is obtained, to identify the lens, the user only has to use one desired light source setting and reference configuration, determine the camera output at that light source setting and reference configuration, and then compare the camera output at the desired light source setting and reference configuration with the corresponding stored lens identification calibration data.",{"@attributes":{"id":"p-0060","num":"0059"},"figref":["FIG. 2","FIG. 2"],"b":["100","102","104","106"]},"The z-height that is set is the reference configuration z-height. In various exemplary embodiments, the z-height is defined as the distance between the camera system and a stage. In various other exemplary embodiments, the z-height is the distance between the camera and a specific target. In various other exemplary embodiments, the z-height is simply the maximum z-height of the vision system. That is, the optical system, such as the optical assembly portion  including the lens to be identified, such as the lens , is sufficiently or fully retracted away from the stage  and any workpiece , as described in greater detail below.","It should be appreciated that, in various exemplary embodiments, the z-height is chosen such that limited or minor variations in the z-height have an insignificant effect on the lens identification procedure and results. In particular, such z-height configurations tend to insure that the minor z-height variations do not become a significant variable in the lens identification procedure. Thus, it should be appreciated that, in some exemplary embodiments, the z-height is any z-height in a defined range. In various other exemplary embodiments, the machine vision system may include an auto-focusing capability. In such cases, the reference configuration may also include auto-focusing each lens on the surface of a known target, or the like. That is, the Z-heights vary for various lenses, but are consistent for any single lens based on the Z-height established for that particular lens by the auto-focus operation.","More generally, the z-height can be any z-height that has been established to provide a satisfactory reference configuration that is usable both during lens identification calibration operations and when an unknown lens is to be identified. However, it should be appreciated that the procedure used to establish the z-height and, more generally, the entire reference configuration, should be usable for all lenses to be calibrated and\/or identified on a particular vision machine.","In step S, the current reference configuration light source control level setting is set to an initial value, for example, by the illumination power supply portion  shown in . Next, in step S, all of the light sources are turned off. Then, in S, the camera output is determined for the current background. The camera output for the current background is determined to compensate for background lights and other influences that affect the camera output independently of the light that is intended to be received from a particular light source during the calibration operations. Also, the variation in background light during the lens identification calibration and when identifying an unknown lens is compensated for by removing the camera output determined when the light sources are turned off. Operation then continues to step S.","In step S, the reference configuration light source is turned on. In various other exemplary embodiments, more than one reference configuration light source is turned on. However, it should be appreciated that the number of reference configuration light sources used to calibrate the lens is the same as the number of reference configuration light sources used when identifying the unknown lens. Next, in step S, the camera output for the current light source setting of the reference configuration light source is determined. Then, in step S, a net camera output is determined. The net camera output is determined by subtracting the determined camera output for the current background, obtained in step S, from the determined camera output for the current reference configuration light source settings, determined in step S. Operation then continues to step S.","In step S, the current light source setting and determined net camera output for the selected lens is stored in any convenient form, such as a look-up table, or the like. Then, in step S, a determination is made whether the camera output or light source setting is greater than a desired maximum value. The light source setting is greater than the desired maximum value at least when the light source setting has either been fully turned on or set to a maximum desired value. The camera output is greater than the desired maximum value at least when the camera output reaches a maximum value corresponding to saturation. Thus, further increases in the light source setting are not required, as any further increases in the light source setting would not result in a different camera output. If at least one of the camera output and light source setting is not greater than the desired maximum value, the operation proceeds to step S. Otherwise, the operation continues to step S.","In step S, the current light source setting is increased by an incremental value. Operation then returns to step S. In contrast, in step S, a determination is made whether all of the lenses have been calibrated. If not all the lenses have been calibrated, operation returns to step S. Otherwise, operation continues to step S, where operation of the method ends.",{"@attributes":{"id":"p-0068","num":"0067"},"figref":["FIG. 3","FIG. 2","FIG. 3","FIG. 3","FIG. 3"],"b":"210"},"It should be appreciated, from , that with a light source setting that is less than a predetermined value, the results for various lenses are practically indistinguishable. Furthermore, it should be appreciated that the camera output for each of the lens saturates at the same predetermined camera output. Thus, when determining a light source setting to be used when identifying an unknown lens, a light source setting that emits a camera output that is greater than a minimum light source setting such that there is a measurable difference in the camera output for the various lenses should be used. Likewise, a light source setting which is less than the saturation value should be used, so that two or more lenses can be reliably distinguished based on a relationship between the light control level and the camera output value that is characteristic of each lens. For example, as shown in , at the brightness level  the corresponding light control levels LCL, LCL, and LCLreadily distinguish the different 1\u00d7, 2.5\u00d7 and 5\u00d7 lenses, respectively.","It should be appreciated that lens calibration curves similar to those shown in  can be obtained for a variety of other reference configurations. For example, in one exemplary reference configuration, a stage light, such as the stage light , provides illumination through the central transparent portion , shown in . In such exemplary reference configurations, the z-height includes full or sufficient retraction of the optical assembly portion  away from the stage .","It should be appreciated that, in some exemplary embodiments, \u201csufficient retraction\u201d or \u201csufficient defocusing\u201d means that the optical assembly portion  is retracted away from the stage  until the camera output does not appreciably decrease due to further retraction or defocusing. It should be appreciated that this condition approximately corresponds to only ambient light reaching the camera through the lens to be identified. Stated another way, this condition approximately corresponds to diminishing the effects of the stage  and\/or workpiece  to insignificance for the purposed of lens identification. It should be appreciated that, for a given vision system, full retraction or full defocusing is the best that can be done in this regard. However, for various vision systems, less than full retraction or defocusing may be sufficient.","In a second exemplary reference configuration, a coaxial light, such as the coaxial light  shown in , provides the illumination, and the z-height includes full or sufficient retraction of the optical assembly portion  away from the stage . In each case, distinguishable lens calibration curves are obtained, similar to those shown in .","It should be appreciated that, in various exemplary embodiments, the lens calibration data need not cover as broad a range of brightness values as the curves shown in . In various exemplary embodiments, a smaller range of brightness values and light control level combinations, or even a single brightness value and light control level combination from each curve, are usable, provided that the range or values from each curve provide a distinguishable results for the various lenses to be identified. Thus, it should be appreciated that a great variety of possible lens identification calibration data sets and identification techniques are possible. Accordingly, it should be appreciated that the related description outlined above and below is exemplary and explanatory only, and not limiting in various exemplary embodiments according to this invention.",{"@attributes":{"id":"p-0074","num":"0073"},"figref":["FIG. 4","FIG. 2","FIG. 4","FIG. 4"]},"As shown in , operation of the method starts in step S, and proceeds to step S, where, when a specific reference configuration target is provided in the nominal field of the vision system, the distance between the target and the camera is determined. The target, as discussed above, should be the same reference configuration target as that used when the lens identification calibration data was obtained. It should be appreciated that, in various exemplary embodiments according to this invention, a specific \u201cexternal\u201d target need not be used. In such exemplary embodiments, step S may be omitted. Then, in step S, the desired reference configuration z-height is set. The desired z-height set should be the same z-height as that used when the lens identification calibration data was obtained. Then, in step S, the desired turret position is set. In exemplary embodiments, step S may be omitted. Next, in step S, a desired reference configuration light source reference configuration setting is selected. As discussed above, the desired reference configuration light source setting is generally more useful when it is greater than a minimum light source setting where there is no significant measurable difference in camera outputs for various lenses. The desired light source setting is also generally more useful when it is less than a predetermined value that results in a saturated camera output, so that two or more lenses do not have the same maximum camera output. Operation then continues to step S.","In step S, all light sources are turned off. Then, in step S, the camera output for the current background is determined. Next, in step S, the reference configuration light source is turned on. It should be appreciated that the same reference configuration light source that was used to generate the lens identification calibration data should be used in step S. Then, in step S, the camera output for the current light source setting of the reference configuration light source is determined. Operation then continues to step S.","In step S, the net camera output is determined, by subtracting the determined camera output for the current background, determined in step S, from the determined camera output for the current light source setting, determined in step S. Then, in step S, a determination is made whether another light source control level setting is desired. In various exemplary embodiments, the operator can select whether another reference configuration light source setting should be used to compare light source settings and associated camera outputs with stored lens identification calibration data. In various other embodiments, the selection can be made automatically. In various other embodiments, only a single light source control level setting is used. It should be appreciated that, in various exemplary embodiments where more light control level points are selected, corresponding to more points on a graph shown in , for example, the more reliable the lens identification may become. If another light source setting is desired, operation proceeds to step S. Otherwise, operation continues to step S.","In step S, the next desired light source setting is selected. Operation then returns to step S. In contrast, in step S, the reference configuration light source settings and associated camera outputs are compared with the previously-determined stored lens identification calibration data. Then, in step S, the operational lens to be identified is identified based on the comparison. Operation then continues to step S, where operation of the method ends.",{"@attributes":{"id":"p-0079","num":"0078"},"figref":["FIG. 5","FIG. 5","FIG. 3","FIG. 5","FIG. 5"]},"The curves shown in  are also representative of the results obtained using a coaxial light when the optical system is sufficiently or fully retracted along the z-axis away from any object positioned in the nominal field of view. It should be appreciated that, in such sufficiently-or fully-retracted \u201ccoaxial\u201d exemplary embodiments, the coaxial light received by the camera is primarily light that has been reflected and\/or backscattered from the lens to be identified itself. The inventors have determined that such reflected and\/or backscattered light provides a highly individual and repeatable light transfer characteristic that is usable to identify various lenses. Thus, such a characteristic is usable in various exemplary embodiments according to this invention. Furthermore, when using this lens characteristic with coaxial lighting, both lens calibration and lens identification can be performed simply by retracting the lens. That is, in various exemplary embodiments, it is not necessary to remove a workpiece or to reposition the stage to a particular X-Y location. Furthermore, no particular \u201cexternal\u201d target or surface needs to be provided. All of these features are advantageous in various exemplary embodiments according to this invention.","For the curves shown in , similarly to the curves shown in , at sufficient brightness levels, such as, for example, the brightness level , the corresponding light control levels LCL, LCL, and LCLreadily distinguish the different 2.5\u00d7, 5\u00d7 and 10\u00d7 lenses, respectively.",{"@attributes":{"id":"p-0082","num":"0081"},"figref":["FIGS. 6\u20138","FIG. 6","FIG. 7","FIG. 8"]},"Unlike the first exemplary embodiment, the light source used in the second exemplary embodiments does not need to be a stable, calibrated light source. Thus, a camera output for a given light source control level setting using one turret lens position does not need to remain stable over long periods of time. In general, the light source needs to remain stable only during the short term, over which the calibrations operations using the reference configurations for a particular lens occur. Similarly, at a later time, the camera output for a given light source control level setting only needs to remain stable for the short term over which the identification operations using the reference configurations for a particular lens occur.","Thus, this second exemplary embodiment requires a variable element, such as the turret lens assembly , or the like, but does not require a calibrated, or long-term stable, light source and\/or camera. However, the proportion by which the camera output increases or decreases for a plurality of turret lens positions should remain stable for any one lens, as discussed in greater detail below, with reference to . In this exemplary embodiment to identify a lens, the camera outputs for at least two turret lens positions using the same light source setting are measured and compared with the stored lens identification calibration data. Such a method is insensitive to reasonably expected long term variations in the light source output relative to a given light control level command.",{"@attributes":{"id":"p-0085","num":"0084"},"figref":"FIG. 6"},"As shown in , operation of the method begins in step S, and proceeds to step S, where a lens to be calibrated is selected. Then, in step S, a desired z-height is set, according to the principles previously described. As previously described, the z-height can be any z-height that has been established to provide a satisfactory reference configuration that is usable both during lens identification calibration operations and when an unknown lens is to be identified. Operation then continues to step S.","In step S, the current light source setting is set to an initial value. Next, in step S, all of the light sources are turned off. Then, in S, the camera output is determined for the current background. The camera output for the current background is determined to compensate for background lights and other influences which affect the camera output independently of the light that is intended to be received from a particular light source during the calibration operations, as previously described. Operation then continues to step S.","In step S, the reference configuration light source is turned on. In various other exemplary embodiments, more than one reference configuration light source is turned on. However, it should be appreciated that the number of reference configuration light sources used to calibrate the lens should be the same as the number of reference configuration light sources used when identifying the lens that is used. Next, in step S, the camera output for the one or more current light source setting(s) of the reference configuration light source(s) is determined. Then, in step S, a net camera output is determined. The net camera output is determined by subtracting the determined camera output for the current background, obtained in step S, from the determined camera output for the one or more current light source setting(s), determined in step S. Operation then continues to step S.","In step S, the current light source setting and determined net camera output for the selected lens are stored in any convenient form, such as, for example, into a look-up table. Then, in step S, a determination is made whether the camera output and\/or light source setting(s) is greater than a corresponding desired maximum value, as previously described with reference to step S shown in . If one or more of the camera output and the reference configuration light source(s) setting(s) is not greater than the appropriate desired maximum value, the operation proceeds to step S. Otherwise, the operation continues to step S.","In step S, one or more of the current light control level(s) of the reference configuration light source(s) is altered by an incremental value. Operation then returns to step S. In contrast, in step S, a determination is made whether all of the desired reference configuration turret lens positions have been selected. If not all of the reference configuration turret lens positions have been selected, the operation proceeds to step S. Otherwise, operation jumps to step S. In step S, another desired turret lens position is selected. Operation then returns to step S. In contrast, in step S, a determination is made whether all of the lenses have been calibrated. If not all the lenses have been calibrated, operation returns to step S. Otherwise, operation continues to step S, where operation of the method ends.",{"@attributes":{"id":"p-0091","num":"0090"},"figref":["FIG. 7","FIG. 6","FIG. 7","FIG. 6","FIG. 7"]},"In one exemplary embodiment, a simple ratio provides such a combination characteristic. For example, as shown in , at a point Bon the lens calibration data curve corresponding to turret lens position , the camera output values is 200 units. The turret lens position \u201c0\u201d is herein referred to as a \u201creference turret position\u201d, since the point Bis associated with the reference level camera output of 200 units on the curve corresponding to that turret position. The corresponding light control level of approximately 21 units is then taken as the reference configuration light control level in this example. The point Bon the lens calibration data curve corresponding to the turret lens position \u201c1\u201d corresponding the same reference configuration light control level of approximately 21 units. A ratio of the camera output values Band B, provides one exemplary \u201ccombination characteristic\u201d that reliably distinguishes a wide variety of lenses.","It should be appreciated that a ratio of light control levels associated with the points Band Bcould be established by steps analogous to those outlined immediately above, and such a ratio is also usable as a combination characteristic that reliable distinguishes a wide variety of lenses.",{"@attributes":{"id":"p-0094","num":"0093"},"figref":["FIG. 8","FIGS. 6 & 7"]},"As shown in , operation of the method starts at step S, and proceeds to step S, where the distance between the target and the camera is determined. The target, as discussed above, should be the same target as that used when the lens identification calibration data was obtained. It should be appreciated that, in various exemplary embodiments according to this invention, a specific \u201cexternal\u201d target is not used for the reference configuration, as previously described. For example, in various exemplary embodiments, the coaxial light source is used, and the reference configuration ensures that the light transmitted from the light source to the camera is primarily the light reflected and\/or backscattered from the lens to be identified, as previously described. In such exemplary embodiments, step S may be omitted. Then, in step S, the desired z-height is set. The desired z-height set should be the same reference configuration z-height as that used when the lens identification calibration data was obtained. Operation then continues to step S.","In step S, the desired net camera output is selected. The desired net camera output is a prescribed reference configuration camera output associated with the \u201creference\u201d turret lens position, as described below. In various exemplary embodiments, the desired net camera output is generally a relatively high camera output when the \u201creference\u201d turret lens position is the one that provides the maximum output among the turret lens positions used in these lens identification operations. In such a case, the desired net camera output should be selected to be less that the saturation camera output by at least the value of the maximum background or ambient light value expected from the operations of step S below. The camera output value  associated with the point B, previously described with reference to , provides one example of a desirable net camera output. Then, in step S, the \u201creference\u201d turret lens position is selected.","The selected \u201creference\u201d turret lens position should be one of the turret lens positions that were used when the lens identification calibration data was obtained. In various exemplary embodiments, the \u201creference\u201d turret lens position is the turret lens position with the lowest magnification. When the \u201creference\u201d turret position is used to establish the reference configuration light control level, as described below with reference to steps S\u2013S, it is advantageous when the selected \u201creference\u201d turret lens position is the turret lens position that produces the highest camera value output for all lenses to be identified. When such a turret lens position is chosen as the \u201creference\u201d turret lens position, then it is not possible for a later-chosen \u201ccomparison\u201d turret lens position to cause a saturated camera output. However, provided that camera saturation is avoided for all reference configuration turret lens positions, it should be appreciated that the \u201creference\u201d turret lens position can be at any position included in the lens identification calibration data that can be used to set a reference configuration light level that is usable with a second \u201ccomparison\u201d turret lens position according to the systems and methods of this invention, as described above and below.","In any case, it should be appreciated that a particular \u201creference\u201d turret lens position is used in the operations described with reference to steps S\u2013S below to actively determine the reference configuration light control level according to the desired net camera output shown in step S. By actively determining the reference configuration light control level in this way, the results obtained in the following operations of this exemplary method are compensated or \u201cnormalized\u201d so that the final lens identification results are substantially insensitive to the light source variations associated with uncalibrated and\/or unstable light sources. Next, in step S, all light sources are turned off. Then, in step S, the camera output for the current background is determined. Operation then continues to step S.","In step S, the initial or current light source setting is set. When operation first proceeds to step S, the current light source setting has not been set. Thus, the initial light source setting is set when the operation first proceeds to step S. Then, in step S, the light source is turned on. It should be appreciated that the same reference configuration light source(s) used when the lens identification calibration data was obtained is the reference configuration light source turned on in step S. Next, in step S, a determination is made whether the current turret lens position is the \u201creference\u201d turret lens position. It should be appreciated that the initial turret lens position is the \u201creference\u201d turret lens position. If the current turret lens position is the \u201creference\u201d turret lens position, the operation proceeds to step S. Otherwise, operation continues to step S.","In step S, a determination is made whether the current camera output for the current light source setting minus the background output is less than the selected desired net camera output. As previously described, this background output subtraction tends to make this method insensitive to ambient light variations. If the current camera output for the current light source setting minus the background output is less than the desired net camera output, the operation proceeds to step S. In step S, one or more of the reference configuration light source(s) setting is adjusted. The operation then returns to step S. Otherwise, operation continues from step S to step S.","In contrast, in step S, a determination is made whether the current camera output for the current light source setting minus the background output is more than the desired net camera output. If the current camera output for the current light source setting minus the background output is more than the selected net camera output, the operation proceeds to step S. Otherwise, operation proceeds to step S. In step S, at least one of the reference configuration light source(s) setting is decreased. The operation thereafter returns to step S.","It should be appreciated that, in reaching step S, the previous steps, in particular steps S\u2013S, have determined the reference configuration light source(s) setting that achieves the desired net camera output. It should be appreciated that there are many alternative efficient techniques for determining the reference configuration light source(s) setting that achieves the desired net camera output that can be used in place of the exemplary techniques described above in the various exemplary embodiments of the methods described herein. Such techniques include binary searches and the like. In various exemplary embodiments, the current camera output for the light source setting minus background output can be within a predetermined range of the desired net camera output, rather than precisely equal to the selected net camera output. In step S, the reference configuration light source setting(s) or light control level(s) is stored and\/or maintained as the reference configuration light control level for various subsequent operations. Operation then continues to step S.","In step S, a determination is made whether all \u201ccomparison\u201d turret lens positions have been measured. The comparison turret lens positions include at least one, if not all, of the turret lens positions included in the lens identification calibration data, except for the turret lens position used as the \u201creference\u201d turret lens position. In various exemplary embodiments, a single \u201ccomparison\u201d turret lens position is used. If not all the desired comparison turret lens positions have been measured, operation proceeds to step S. Otherwise, operation continues to step S.","In step S, the next \u201ccomparison\u201d turret lens position is set. The first time that step S is reached, this will be the initial \u201ccomparison\u201d turret lens position. Then, in step S, the reference configuration light source setting, saved in step S, is designated to be used as the light source setting in the following light source setting operation(s). Operation then returns to step S.","In step S, all light sources are turned off. Then, in step S, a new current background camera value is taken to compensate for the respective amount of ambient light that is transferred to camera when using the current respective turret lens position. Next, in step S the light source setting designated in step S is set. Operation then continues to step S.","In step S, the reference configuration light source(s) is turned on. Next, in step S, the \u201ccomparison\u201d turret position causes operation to continue to step S. In step S, when the \u201ccomparison\u201d turret lens position is being used, the net camera output for the one or more current light source setting(s) is determined by subtracting the camera output for the current background from the determined camera output for the current determined reference configuration light source setting. Then, in step S, the net camera output for the current \u201ccomparison\u201d turret lens position is stored. Operation then continues to step S.","In step S, after all \u201ccomparison\u201d turret lens positions have been measured, a relationship for the determined net camera output of the \u201creference\u201d turret lens position relative to the determined net camera output(s) of the \u201ccomparison\u201d turret lens position(s) is compared with that same relationship for the previously stored lens identification calibration data for the various lenses. Then, in step S, the current lens to be identified in the vision system is identified based on the comparison. As previously described, in various exemplary embodiments, the relationship is simply a ratio between the outputs of the \u201creference\u201d and \u201ccomparison\u201d turret lens positions. Operation then continues to step S, where the method ends.",{"@attributes":{"id":"p-0108","num":"0107"},"figref":["FIGS. 9 and 10","FIGS. 9 and 10"]},"It should be appreciated from the description of the systems and methods outlined above that, in various exemplary embodiments according to this invention, it is important to perform lens identification operations using the same reference configuration that is used when acquiring the lens identification calibration data that is used for the lens identification. It should be appreciated further that the inherently different physical configurations of two different vision machine types, one hereafter called a particular or current machine type and the other hereafter called a chosen standard machine type, effectively prevents providing a matching reference configuration between the two types of machines.","However, it is convenient in a number of practical applications to be able to use a standard set of lenses and a standard set of lens identification calibration data with different types of vision system machines. For example, various manufacturers may have different sizes of similar machines, or different product families of machines that are at least roughly comparable in design. In such cases, the inventors have determined that, in various exemplary embodiments according to this invention, the results of lens identification operations on a different particular machine type using a particular machine reference configuration can be made comparable to the lens identification calibration data obtained on a chosen standard machine type using a standard machine reference configuration, as outlined in greater detail below.",{"@attributes":{"id":"p-0111","num":"0110"},"figref":"FIG. 9"},"As shown in , operation of the method begins at step S and proceeds to S, where a reference configuration objective lens is selected and installed where various lenses to be identified are normally installed. In various exemplary embodiments, the reference objective lens is a lens that has a minimum effect on the camera output for a reference turret lens position and comparison turret lens position. Then, in step S, a target in the field of view is located. In one exemplary embodiment, the target is a surface of the stage. In another exemplary embodiment, the target is a specific featureless target, such a diffusely reflecting surface with high reflectance positioned on the stage. Next, in step S, a desired z-height between the camera system and the target is set. In particular, in various exemplary embodiments, this desired z-height is the height that provides a focused image of the target surface. Operation then continues to step S.","In step S, the desired net camera output is selected. The desired net camera output is a prescribed reference configuration camera output associated with the \u201creference\u201d turret lens position, as described below. The desired net camera output is chosen as previously described with reference to step S, shown in . However, for the purposes of the \u201cmachine-to-machine standardization\u201d method shown in , in various exemplary embodiments, the desired net camera output used in step S is the same each time the method is used on a chosen standard machine type and a particular machine type. In such embodiments, the reference configuration light control level is set for each type of machine to a level the produces the same camera output value for the \u201creference\u201d turret lens position on each type of machine.","Steps S to S of  corresponds to steps S to S of . In these steps, a determined net camera output of a reference turret lens position and a net camera output of comparison turret lens positions is obtained. Thus, an explanation of these steps will be omitted. The only significant difference between the operations of steps S to S of  and steps S to S of , is that steps S to S are performed with the vision machine focused on an external target surface in the present method. The inventors have determined that this is one exemplary procedure that provides turret lens position attenuation ratios that reliably reflect the inherent light transfer characteristics of various vision machines that are independent of the light transfer characteristics of the lens to be identified, as previously discussed.","In step S, the turret lens position attenuation ratios for the current machine are obtained. The turret lens position attenuation ratios can be used to compensate for the varying outputs for various vision system machine types, as outlined above. Each turret lens position attenuation ratio is obtained by dividing the determined net camera output of the reference turret lens position with the determined net camera output of one or more comparison turret lens positions. Next, in step S, each respective attenuation ratio with each respective turret lens position is stored. Operation then continues to step S, where the method ends.",{"@attributes":{"id":"p-0116","num":"0115"},"figref":"FIG. 10"},"Steps S to step S of  correspond to steps S to step S of , respectively. In these steps, a lens to be identified is identified based on a net camera output of a reference turret lens position and a net camera output of a comparison turret lens position that is compensated using the appropriate turret lens position attenuation ratio for the current particular vision machine. Thus, an explanation of these steps will be omitted except for the following points of emphasis.","As previously discussed with reference to step S shown in , in various exemplary embodiments the desired net camera output used in step S is the same as the desired net camera output used on the chosen standard machine type when determining the standard lens identification calibration data used to identify the lens to be identified in step S.","In step S, the net camera output is compensated for the turret lens position light transfer characteristics of the current particular machine by using the appropriate turret lens position attenuation ratio. That is, when the \u201ccomparison\u201d turret lens position is being used, the \u201cturret-compensated\u201d net camera output for the one or more current light source setting(s) is determined by subtracting the camera output for the current background from the determined camera output for the current determined reference configuration light source setting and then multiplying this difference by the appropriate current turret lens position attenuation ratio. As previously discussed, this step effectively compensates, and\/or removes as a variable, the inherent light transfer characteristics of the current particular machine type in comparison to the chosen standard machine type. Thus, the light transfer characteristics of a lens to be identified on this particular machine can be compared to the lens identification calibration data obtained using the chosen standard machine type in order to identify the lens.","In step S, after all \u201ccomparison\u201d turret lens positions have been measured and their turret-compensated net camera outputs determined, a relationship for the determined net camera output of the \u201creference\u201d turret lens position relative to the determined turret-compensated net camera output(s) of the \u201ccomparison\u201d turret lens position(s) is compared with that same relationship for the previously stored lens identification calibration data provided based on the chosen standard machine type and a lens set including the lens to be identified in the current particular machine. Then, in step S, the current lens to be identified in the vision system is identified based on the comparison.","While this invention has been described in conjunction with the exemplary embodiments outlined above, it is evident that many alternatives, modifications and variations will be apparent to those skilled in the art. For example, it should be appreciated that the machine-to-machine standardization method described with reference to , is an embodiment usable where the reference configuration light source available in the various different machine types is of the uncalibrated variety. It should be appreciated that analogous and simpler methods can be applied to achieve similar machine-to-machine standardization among different machines that each have a stable and calibrated reference configuration light source available. Accordingly, the exemplary embodiments of the invention, as set forth above, are intended to be illustrative, not limiting. Various changes may be made without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Various exemplary embodiments of this invention will be described in detail, with reference to the following figures, wherein:",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 10"}]},"DETDESC":[{},{}]}
