---
title: Auto discovery and auto provisioning of set top boxes
abstract: A system and method for the automatic discovery and provisioning of a video set top box within an IPTV network is provided. When first connected to a residential gateway, the set top box requests the address information of the residential gateway. The set top box then sends a request to a video operations and support server (VOSS) with the identifying information for the set top box and the residential gateway. Once the VOSS determines that the residential gateway is authorized for video service, the VOSS associates the residential gateway with the set top box. The VOSS then communicates the authorization to a middleware server, which downloads client software and encryption keys to the set top box, enabling the set top box to request and receive video content. The set top box may be reconnected to any port on the residential gateway and receive video service without being re-provisioned.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09602775&OS=09602775&RS=09602775
owner: CenturyLink Intellectual Property LLC
number: 09602775
owner_city: Denver
owner_country: US
publication_date: 20090507
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["The present disclosure relates generally to delivery of in-home video services, and in particular, to an improved system and method for auto-discovery and auto-provisioning of set top boxes.","The in-home wiring and installation of video services for a new customer is a labor intensive process. With advent of internet protocol television (IPTV), this process is made more complicated due the various pieces of equipment that have to be configured by the installer in the customer's home. Because much of the intermediate equipment involved is software-based, the configuration of such equipment has become more difficult, adding to the installer time and knowledge required to perform an installation. In addition, many companies are now providing customers with telephone, internet, and video (TV) services all in one package.","In order to provide the different services, and to minimize the types of equipment required, a device known as a residential gateway (RG) is normally installed in the customer's home. Because all of the services are being transmitted to the customer over the internet, the RG serves as the connection point between the various internet-provided services and the individual devices in the customer's home that require the services. The individual devices normally comprise personal computers (for internet browsing), telephones, and one or more television set-top boxes for television viewing.","To complete an installation, the installer must normally configure the residential gateway device before connecting any of the downstream customer equipment. Various standardized protocols and methods are known in the art for automatically configuring residential gateways so that the installer does not have to perform the operation manually. In addition to the gateway, however, the set top boxes which provide video services to televisions in the house also need to be configured. Because IPTV often involves \u201cupstream\u201d data requests from the set top box to initiate reception of a particular program (as opposed to general broadcast TV), the configuration of the set top boxes can be quite complicated and time consuming for the installer.","Unfortunately, prior art methods for automatically provisioning gateways and other customer premises equipment are lacking in a number of respects. For example, U.S. Patent Application Publication No. US 2008\/0117902 A1 to Vinneras describes a bridged-ethernet residential gateway unit which uses a dedicated virtual local area network (VLAN) for each device (i.e., phones, TVs, computers) being connected to the gateway. However, the gateway unit of Vinneras operates only at the Ethernet (Layer 2) level and does not perform any Internet Protocol (IP Layer 3) routing functions. Because of this, the gateway cannot perform network address translation (NAT) and cannot \u201chide\u201d the address details of the set top box, telephone, or personal computer from the outside network, causing an increased security risk. The ability to remotely troubleshoot problems with the individual devices connected to the gateway is also limited.","In addition, the installer must still manually configure the television set top box if any interactive IPTV features are to be enabled. This is typically done by manually inputting the appropriate system equipment identifiers of the set top box, such as internet protocol (IP) addresses, media access control (MAC) addresses, and globally unique identifiers (GUIDs), into the system. The manual input process requires that the installer either key the system identifiers (each of which can be up to thirty-two characters long) into the system before traveling to the customer's home or call the main office of the system provider from the customer's home and verbally convey the set top box identifiers so that another employee can key them in. This not only increases the time required to provision the set-top box, but introduces more opportunities for human error and subsequent rework during the provisioning process.","Accordingly, in one aspect, a method for providing video services is disclosed, comprising: connecting a set top box to a video services network and powering on the set top box, the video services network including a residential gateway, a video operational support system and a middleware server; the residential gateway supplying an internet protocol address to the set top box; the set top box transmitting a video service request to a video operational support system within the video services network; the video operational support system authenticating the set top box via the internet protocol address, determining the user account associated with the set top box, and determining the authorized video services associated with the user account; the video operational support system transmitting authorization of provisioning of the authorized video services associated with the user account to the middleware server; and the middleware server transmitting client software to the set top box and loading the client software on the set top box, the client software representing the authorized video services associated with the user account.","In another aspect, a method for providing video services is disclosed, comprising: applying an application programming interface to a set top box to enable communication between the set top box and a middleware server; connecting a set top box to a video services network and powering on the set top box, the video services network including a middleware server; the set top box transmitting a video service request to the middleware server within the video services network; the middleware server determining the authorized video services associated with the user account; and the middleware server transmitting client software to the set top box via the application programming interface and loading the client software on the set top box, the client software representing the authorized video services associated with the user account.","According to another aspect, a video services system is disclosed, comprising: a set top box configured to be operatively coupled to a television; a video services network configured for providing video services to the television via the set top box, wherein the video services network includes a residential gateway operatively coupled to the set top box, a video operational support system operable to communicate with the set top box, and a middleware server operable to communicate with the video operational support system and the set top box; wherein the residential gateway is operable to supply an internet protocol address to the set top box, wherein set top box is operable to transmit a video service request to a video operational support system, wherein the video operational support system is operable to authenticate the set top box via the internet protocol address, determine the user account associated with the set top box, and determine the authorized video services associated with the user account, wherein the video operational support system is operable to transmit authorization of provisioning of the authorized video services associated with the user account to the middleware server, and where the middleware server is operable to transmit client software to the set top box and loading the client software on the set top box, the client software representing the authorized video services associated with the user account.","For the purposes of promoting an understanding of the principles of the invention, reference will now be made to the embodiment illustrated in the drawings and specific language will be used to describe the same. It will nevertheless be understood that no limitation of the scope of the invention is thereby intended, and alterations and modifications in the illustrated device, and further applications of the principles of the invention as illustrated therein are herein contemplated as would normally occur to one skilled in the art to which the invention relates.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1","b":["100","102","104","104","102","104","106","104","106","126","108","108","106","108","108","110","112","108","108","110","108","108"]},"A set top box (STB)  is operatively connected to a port  on the residential gateway . The television  is connected to and receives video signals from the STB . Each residential gateway  may be connected to multiple customer devices including, but not limited to, telephones , personal computers , and set top boxes . The individual ports  on the residential gateway  may be configured in a variety of physical formats, including, but not limited to, Ethernet, coaxial cable (HPNA), and universal serial bus (USB), to suit the type of device being connected and\/or the type of existing in-home wiring. For example, if the residential gateway  is located close to the set top box , a standard Ethernet cable may be used to connect the set top box  to the residential gateway . However, if the set top box  is located in a different room than the residential gateway , the existing in-wall coaxial or twisted pair cabling may be used to connect the two devices using the Home Phoneline Networking Alliance (HPNA) or Multimedia Over Coax Alliance (MOCA) protocols. HPNA and MOCA are protocols that allow various networking protocols such as Ethernet to be delivered over legacy wiring systems such as RG- coaxial or standard phone line cables.","In a preferred embodiment, residential gateway  is implemented as a packet routing device having the ability to perform Layer  network address translation (NAT) when sending or receiving IP packet data to or from the access node . The residential gateway  is therefore able to \u201chide\u201d the media access control (MAC) addresses of the individual customer devices connected to the residential gateway  from other systems connected to the network , providing increased security to the individual customer. In certain embodiments, a virtual private LAN service (VPLS) may be used to establish the connection between the video head-end server  and the residential gateway . For example, the VPLS service can provide a single VLAN to each residential gateway . Each VLAN contains all of the data services (i.e., IPTV, VoIP phone, internet) being sent to a single residential gateway . To preserve bandwidth, a single VLAN may also be used to deliver all of the broadcast TV channels being sent to the access node , with the access node  distributing the individual channels to each residential gateway based on the individual customer access plans.","In order to administer the access of the various services to individual subscribers, a video operational support system (VOSS) server  is operatively connected to the access node  via network . The VOSS server  maintains a database which keeps track of which services an individual customer has subscribed to and may optionally contain sensitive customer information. In addition, the middleware server  is operatively connected to the access node  via network  and maintains a separate database and other software for managing video content delivery including MPEG4 video, video-on-demand (VOD) and pay-per-view to the customers. In certain embodiments, the middleware server  only has access to the data needed to determine if a particular residential gateway (based on some form of device identifier or GUID) is authorized for video service and does not have access to other sensitive customer information (such as social security numbers, addresses, etc.) on the VOSS server . The video head-end server  is configured to provide requested video channels to the set top box  via middleware server , access node  and residential gateway . It shall be understood that the functionality of the middleware server  may be incorporated into the video head-end server  or vice versa. It shall be further understood that the middleware server , the video head-end server , and\/or the VOSS server  may be located in the same physical location (i.e., a video head-end office (VHO)) or in separate locations from one another.","Each of the set top box , the residential gateway , the access node , the VOSS server , the video head-end server , and\/or the middleware server  may include a processing unit, memory, storage, and input\/output devices. The processing units may be formed of various processors which execute software, such as one or more PENTIUM or DUAL-CORE processors supplied by INTEL Corporation of 2200 Mission College Boulevard, Santa Clara, Calif. 95052, USA. The software, depending on the system functionality, may be configured to store and (i) manage information, such as video content, (ii) manage routing of video streams, and\/or (iii) manage interaction with an end-user to download video content and images for display on a television .","Each memory may include one or more types of solid-state electronic memory, magnetic memory, or optical memory, just to name a few. By way of non-limiting example, each memory may include solid-state electronic Random Access Memory (RAM), Sequentially Accessible Memory (SAM) (such as the First-In, First-Out (FIFO) variety or the Last-In-First-Out (LIFO) variety), Programmable Read Only Memory (PROM), Electronically Programmable Read Only Memory (EPROM), or Electrically Erasable Programmable Read Only Memory (EEPROM); an optical disc memory (such as a DVD or CD ROM); a magnetically encoded hard disc, floppy disc, tape, or cartridge media; or a combination of any of these memory types. Also, each memory may be volatile, nonvolatile, or a hybrid combination of volatile and nonvolatile varieties.","Network  can be in the form of a wireless or wired Local Area Network (LAN), Municipal Area Network (MAN), Wide Area Network (WAN), such as the internet, a combination of these, or such other network arrangement as would occur to those skilled in the art. Within network , additional devices, such as routers, servers, or other computing devices may be included to achieve the transmission of data between the customer and provider equipment. In addition, the various components, such as middleware server  and video head-end server , may be connected using various sub-networks, such as a LAN, within or in addition to network . For example, video head-end server  may be connected directly to middleware server , with middleware server  acting as a gatekeeper and providing the actual video signals to the access node .","When an installer arrives at a customer premises to install new service, both the residential gateway  and the set top box  must be provisioned by the system . Various methods are known in the art for provisioning residential gateways, the details of which are not important to the present disclosure. For example, if the residential gateway  has been manufactured to be compliant with the TR-069 standard provisioning protocol, the residential gateway  will automatically be recognized by the access node . The access node  will then forward the provisioning request with a unique identifier, such as the MAC address of the residential gateway, to the VOSS server . The VOSS server  then determines whether the residential gateway  is authorized for use.","Once the residential gateway  has been authorized, each of the set top boxes  must be discovered and provisioned by the system before IPTV content can be delivered to the set top boxes .  is a flow chart of an exemplary process  for automatically discovering and provisioning a set top box  according to one embodiment of the present disclosure. The process  starts at step , where the user connects the set top box  to the residential gateway . The set top box  is pre-loaded with an application-layer (Layer 7 of the standard OSI model) software boot program which communicates with the residential gateway  upon being connected. The set top box  requests an IP address from the residential gateway  at step . At step , the residential gateway  supplies the set top box  with an IP address. In a preferred embodiment, the IP address supplied to the set top box  by the residential gateway  is a private IP address. The supplied IP address is typically generated by the residential gateway using a Dynamic Host Control Protocol (DHCP) program. The residential gateway may also work in conjunction with additional servers and protocols to manage and assign the IP address to the set top box . For example, Remote Authentication Dial In User Service (RADIUS) with Authentication, Authorization and Accounting (AAA) management, may be implemented within the network path to provide greater security for the data.","After being assigned its own IP address, the set top box  queries the residential gateway  to determine the IP address and\/or MAC address of the residential gateway  at step . The set top box  then bundles the identifying information for both the residential gateway  and the set top box  into a provisioning request and sends the request to the VOSS server  via the residential gateway  at step . The identifying information for the residential gateway  may include the IP address, the MAC address, and\/or the software GUID of the residential gateway . The identifying information for the set top box  may include the IP address, the MAC address, and\/or the software GUID of the set top box . In certain embodiments, the residential gateway  performs network address translation on the provisioning request packets so that the MAC address of the set top box  is hidden from other devices within the network  until the packets are reassembled and their application layer payloads (containing the residential gateway and set top box identifiers) are decrypted and read by the VOSS server .","At step , the VOSS server  uses the identifying information contained in the provisioning request to determine whether the customer is authorized to receive video services. In one embodiment, the VOSS server  looks up the IP address and\/or MAC address of the residential gateway  in a relational database containing a list of authorized devices. If the customer is authorized to receive video services, the identifying information (IP address, MAC address and\/or software GUID) of the set top box  is added to a list of authorized set top boxes for the customer's account at step . If the customer is not authorized to receive video services, the VOSS server  instructs the set top box  to display a message on the television  stating that the customer is not currently authorized to receive video service.","If the set top box  has been authorized for service (step ), the VOSS server  transmits an authorization of video rights for the set top box  to the middleware server  at step . The middleware server  then updates its database records to show that the particular set top box  is authorized for video service over the particular residential gateway . At step , the middleware server  downloads video client software, in addition to a digital rights management (DRM) encryption key, to the set top box , enabling the set top box  to request and receive video content from the middleware server . In a preferred embodiment, the middleware server  acts as a gatekeeper by receiving video content from the video head-end server  and providing the content to the set top box . In other embodiments, the video head-end server may provide video content to the set top box , with the DRM keys and other security filters being first loaded onto the set top box  from the middleware server .","The set top box  is now able to request video service using any of the ports  on the residential gateway . For example, if the user disconnects the set top box  from one port  on the residential gateway  and reconnects it to a different port  on the residential gateway , the middleware server  will still recognize that the newly connected set top box  is authorized for video service on the residential gateway  based on the MAC address and\/or GUID of the set top box  and will respond to video service requests from the set top box . In other words, the set top box  does not have to be re-provisioned if it is moved from one room to another in the customer's home. However, if the set top box  is taken to another customer's home and plugged into a different residential gateway , the middleware server  will recognize that the MAC address and\/or GUID of the set top box  is not associated with the MAC address and\/or GUID of the new residential gateway  in the database and will therefore deny the video content request.",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 3","b":["300","114","300","200","114","126","124","114","126"]},"The process  begins at step  with the set top box  being connected to the residential gateway. Again, the set top box requests an IP address from the residential gateway  at step  and the residential gateway  supplies an IP address to the set top box  at step . At step , the set top box  queries the residential gateway  to determine the IP address of the residential gateway . At step , the set top box  sends a provisioning request to the middleware server , with the identification information of the set top box  and residential gateway  included in the request payload. The middleware server  then authenticates the residential gateway  at step  and communicates with the VOSS server  to determine whether the customer is authorized to receive video services. If the customer is authorized to receive video services, the middleware server  authorizes video service for the set top box  and associates the IP address and\/or MAC address of the set top box with the user's account at step . Lastly, at step , the middleware downloads a provisioning message along with the required video client software and DRM encryption keys to the set top box .","Once the set top box  has been provisioned, it may request video content (i.e., a particular video channel) by sending an internet group management protocol (IGMP) join request to the middleware server . In IPTV, video channels have an assigned IP address that the IGMP protocol software in the middleware server  knows and delivers to the requesting device (in this case, the set top box ). After receiving the IGMP join request, the middleware server  sends a request for a particular video channel to the video head-end server . It shall be understood that the middleware server  may already be receiving the particular video channel or may need to send a request to the video head-end server  to acquire the desired video content. Once the middleware server  receives the video content from the video head-end server , it passes the content to the set top box . The DRM encryption keys used by the middleware server  and video head-end server  ensure that unauthorized users are not able to send a rogue IGMP join request to receive video content. It shall be appreciated by those of ordinary skill in the art that other protocols for requesting and delivering IPTV channels may also be utilized and are considered to be within the scope of the present disclosure.","Although the principles of the present disclosure have been described in association with set top boxes, it should be understood that the set top box functionality may be incorporated into a television or digital video recorder (DVR) and use the principles of the present disclosure in the same or similar manner.","While the invention has been illustrated and described in detail in the drawings and foregoing description, the same is to be considered as illustrative and not restrictive in character, it being understood that only the preferred embodiment has been shown and described and that all changes and modifications that come within the spirit of the invention are desired to be protected."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
