---
title: Control of engineering systems utilizing component-level dynamic mathematical model with single-input single-output estimator
abstract: A control system comprises an actuator, a control law and a processor. The actuator positions a control surface and the control law controls the actuator. The processor comprises an open loop module, a corrector, a comparator, and an estimator, and generates model output to direct the control law. The open loop module generates the model output as a function of a model state and a model input. The corrector generates a corrector output as a function of the model output. The comparator generates an error by comparing the corrector output to the model input. The estimator generates the model state as a function of the error, such that the error is minimized as a function of single-input, single-output gain matrix.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08195311&OS=08195311&RS=08195311
owner: United Technologies Corporation
number: 08195311
owner_city: Hartford
owner_country: US
publication_date: 20090529
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This application is a continuation of Boris Karpman et al., SYSTEM AND METHOD FOR DESIGN AND CONTROL OF ENGINEERING SYSTEMS UTILIZING COMPONENT-LEVEL DYNAMIC MATHEMATICAL MODEL, Ser. No. 12\/264,014, filed Nov. 3, 2008. This application is related to Boris Karpman et al., DESIGN AND CONTROL OF ENGINEERING SYSTEMS UTILIZING COMPONENT-LEVEL DYNAMIC MATHEMATICAL MODEL WITH MULTIPLE-INPUT MULTIPLE-OUTPUT ESTIMATOR, Ser. No. 12\/475,020, filed on even date herewith.","The U.S. Government has a paid-up license in this invention and the right in limited circumstances to require the patent owner to license others on reasonable terms as provided for by the terms of Contract No. N00019-02-C-3003, awarded by U.S. Navy.","The subject matter of this application relates generally to the design and control of engineering systems. Across a broad range of industries, modern engineering systems are characterized by marked increases in complexity and simultaneous decreases in component tolerances. As a result, engineering control systems are subject to greater operational demands, which require more sophisticated and detailed modeling techniques.","Fluid-based engineering systems provide a range of relevant examples. These include gas turbine engines for aviation and power generation, HVAC&R (heating, ventilation, air-conditioning and refrigeration), fuel cells, and other, more generalized fluid processing systems for hydrocarbon extraction, materials processing, and manufacture. These systems contain any or all of the following components: turbo-machinery, fuel cell stacks, electric motors, pipes, ducts, valves, mixers, nozzles, heat exchangers, gears, chemical apparatuses and other devices for generating or modifying a fluid flow.","Each of these applications places different operational demands on the engineering control system. In gas turbine engines, for example, the relevant cycle is typically a Brayton turbine or first Ericsson cycle, and the basic thermodynamic parameters (or process variables) are the pressure, temperature and flow rate of the working fluid at the inlet, compressor, combustor, turbine, and exhaust. The parameters are related to the overall thrust, rotational energy, or other measure of power output. In order to precisely control this output while maintaining safe, reliable and efficient engine operation, the engineering control system should be fast, accurate and robust, and provide real-time control capability across a range of performance levels. While the relevant process variables vary depending on the system type and configuration, the need for precise, efficient and reliable engineering control remains the same, as do the economic constraints on overall cost and operational\/maintenance requirements.","This invention concerns a system and a method for design and control of an apparatus, with a single-input single-output estimator. The system utilizes a control law to control actuators that position control elements of the apparatus, as a function of a model output vector generated by a component-level physics-based mathematical model of the apparatus. The system also includes diagnostics and fault detection\/accommodation software modules.","The model comprises mathematical descriptions of interconnected components and constraints that combine to produce the output vector and a physics state derivative, as a function of a constraint input and an external input vector. The constraint output is related to internal system, and the external input vector is related to effector\/actuator states and boundary conditions of the apparatus. A comparator checks a subset of the output vector against a \u201ctruth\u201d vector represented by measured or high fidelity modeled data, in order to generate an error vector. The discrete model state estimator synthesizes (estimates) next time step values of the state vector, including both constraint and physics subsets, such that the error vector is minimized. The estimator is a single-input, single-output estimator. Distinct elements of the error vector are associated with distinct constraint elements, and not substantially cross-correlated, such that gain formulation for individual elements is substantially decoupled.","In the case of a gas turbine or other flow-processing apparatus, the method provides means for controlling physics states, including rotational states, for given working fluid flow conditions at an inlet and an outlet. The method also provides means for adjusting the position of control elements along the working fluid flow, using actuation mechanisms and a digital control system built around the dynamic component-level mathematical model.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1","b":["10","11","11","20","10","11"]},"In general, system  includes at least some of the following software (S\/W) modules: system parameter on-board synthesis (SPOS) module , control law (CLW) , on-board diagnostics (OBD) module , sensor fault detection and accommodation (SFDA) module , output conditioning module (OCM) , and input conditioning module (ICM) . These modules are incorporated in a \u201cblack box\u201d type processor assembly mounted proximate apparatus , or in a number of individual processors. SPOS  is build around a component-level mathematical model of apparatus , also referred to as closed loop model (CLM) , such that CLM  is a subset of SPOS . System  also incorporates at least some of the following hardware (H\/W) elements: digital-to-analog (D\/A) converter , analog-to-digital (A\/D) converter , actuator(s) , system sensor(s) , actuator sensor(s) .","As shown in , CLW  obtains control feedbacks from CLM \/SPOS  and control commands (the desired values of outputs from apparatus ) from operator interface (I\/F) . CLW  generates control requests in engineering units, which are transformed into actuator requests compatible with D\/A converter  by OCM . D\/A converter  generates electrical signals that operate on actuators . Actuators  use control hardware to position various control elements of apparatus  in accordance with the control request, resulting in quick and accurate control of apparatus .","System sensors  measure operational parameters associated with apparatus . For example, fluid-based systems often include system sensors  that measure the working fluid pressure, temperature and flow at various axial and radial locations in the flow path. Actuator sensors  measure the state of actuators , where the actuator states (or positions) are related to the physical configuration of the various control elements in apparatus . For example, fluid-based systems often include actuators whose linear or angular positions are sensed by actuator sensors , and which are related to the physical position of control surfaces or other control devices located proximate a compressor, combustor, turbine or nozzle\/exhaust assembly.","Sensor hardware modules  and  send electrical signals to A\/D converter , which converts the electrical signals into a digital format compatible with the software and hardware architecture of control system . ICM  filters the raw signals and transforms them into engineering units compatible with the control system software architecture. In some embodiments, CLM  also communicates with CLW  via one or more SFDA module  and OBD module .","Apparatus  comprises an engineering system such as a gas turbine engine, an environmental control system or a fluid processing system. In various embodiments, the physical components of apparatus  include, but are not limited to, compressors, combustors, turbines, shafts, spools, fans, blowers, heat exchangers, burners, fuel cells, electric motors and generators, reactor vessels, storage vessels, fluid separators, pipes, ducts, valves, mixers and other fluid processing or flow control devices.","CLM  comprises elements designed to provide a component-level dynamic mathematical model of apparatus , utilizing a mixture of physics-based and data-derived descriptions of the individual physical components of apparatus . CLM  also models relationships among these components, including operational constraints based on physics and engineering considerations. That is, CLM  models not only the engineering components of apparatus , but also the physical laws that govern their behavior.","Operator I\/F  comprises a real-time interface such as a cockpit navigation system or operator workstation. Alternatively, operator I\/F  comprises another, more generalized process control interface, which is suitable for logging control commands to CLW .","CLW converts the control demands to control requests for actuators , which satisfy the control requests by changing the operational configuration of apparatus . Some actuators , for example, change the configuration of a fuel flow controller, a variable vane surface, or another control surface positioned along a fluid flow inside apparatus . Other actuators  change the state, position or configuration of additional devices for controlling the operation of apparatus , including, but not limited to, fuel pumps, variable compressor or turbine vanes, variable-area nozzle, inlet or bypass duct elements, and variable-area orifice elements.","System sensors  comprise a variety of different sensing devices, including, but not limited to, temperature sensors, pressure sensors, flow sensors, vibration sensors, debris sensors, current sensors, voltage sensors, level sensors, altitude sensors and blade tip sensors. System sensors  are positioned to measure operational parameters related to the function of apparatus , in particular as related to control commands submitted to CLW  and control requests generated by CLW , in order to direct actuators  to control apparatus .","In some embodiments, CLM  communicates with CLW  both directly and via one or more of OBD module  and SFDA module . Modules  and  monitor the state of system hardware including actuators , sensor modules  and , and apparatus . For example, the health of apparatus  and system sensors  is assessed based on a comparison of sensor values with the predictions of CLM . The health of actuators  and actuator sensors  is assessed based on the difference between requested and sensed actuator positions.","Under some conditions, OBD module  and SFDA module  allow CLW  to compensate for operationally-dependent changes in actuator response, including changes due to variations in temperature, pressure and power input or output. Modules  and  also utilize system parameters synthesized by CLM  to correct or recalibrate aberrant sensor signals, in order to provide more accurate and stable input to CLW . Alternatively, modules  and  replace failed sensor signals with synthesized values from CLM , or allow CLW  to deploy one actuator (or set of actuators) in order to compensate for another actuator (or set of actuators) that has failed. In these embodiments, SFDA module  typically generates a real-time alarm signal or other fault indicator, such as a fuel status warning, a damage report, a temperature alarm or a maintenance request.","Typically, apparatus  performs a thermodynamic cycle on a working fluid in order to generate rotational energy, electrical power or reactive thrust, to provide heating, ventilation, air conditioning and refrigeration, or to perform other fluid processing functions. The range of available cycles includes, but is not limited to, the following cycles and their derivatives: Otto cycles, Diesel cycles, Brayton turbine (or first Ericsson) cycles, Brayton jet (Barber\/Joule) cycles, Bell-Coleman (reverse Brayton) cycles, Ericsson (second Ericsson) cycles, Lenoir (pulse-jet) cycles, and Carnot, Stoddard and Stirling cycles.","Alternatively, apparatus  performs a number of individual thermodynamic processes for heating, cooling, flow control, or for processing applications in agriculture, transportation, food and beverage production, pharmaceutical production, or manufacturing, or for the extraction, transportation or processing of a hydrocarbon fuel. The range of available thermodynamic processes includes, but is not limited to, adiabatic, isothermal, isobaric, isentropic, and isometric (isochoric or isovolumetric) transformations, exothermic reactions, endothermic reactions and phase changes.","In operation of system , CLW  receives a control command from real-time operator I\/F , and a control feedback or model output from CLM . The control command is related to the operation of apparatus , and the feedback is related to the control command. In one embodiment, for example, apparatus  comprises a gas turbine engine, and the command comprises an operator-generated demand for increased engine power or thrust output. Alternatively, the request is automatically generated by system , or by another control system, in response to changing ambient conditions or operational demands.","Control signals are transmitted in either digital or analog form, depending upon the characteristics of control system . For example, CLW  typically generates a digital control request in engineering units. OCM  converts the digital request into units compatible with D\/A converter , which in turn generates an electrical signal such as voltage or current for actuator . Typical examples include analog voltage signals for a fuel pump, analog current signals for a valve controller, and pulsed digital signals for a stepper motor or other mechanical actuator. The actuator is attached to a variable-position control device located within apparatus , such as a variable-position blocker door for a bypass duct, a variable-position vane, or a variable-geometry exhaust nozzle. Compound signals are sometimes utilized for more complex actuator systems, such as fuel, oxidant and cooling fluid flows through a thrust augmentor\/afterburner assembly, counter-rotating fan thrust and attitude control signals for STOVL (short takeoff or vertical landing) operations, or flow management through a regenerator, heat exchanger, reaction vessel, catalytic converter or other component of a fluid processing system.","Actuators  address the control request by manipulating or adjusting one or more control devices (or control elements) within apparatus . Apparatus  responds to the action of actuators , such that the control command provided to CLW  is satisfied. For the case of a gas turbine, these manipulations take a variety of forms, including changes in the fuel flow or other fluid flow rate, changes in vane, bypass duct or nozzle configurations, and other changes in the configuration of apparatus . The typical responses of apparatus  include an increase or decrease in total thrust or power output, changes in a cooling flow or fluid processing rate, and on\/off switching of supplementary systems such as counter-rotating fans, regenerators and heat exchangers.","System sensors  sense parameters related to the operation of apparatus . In particular, these parameters are related to the control requests raised by CLW , and the response of actuators . Typical sensor parameters include, but are not limited to, positions, velocities, acceleration, currents, and voltages, rotational speeds of spools or shafts, fuel flow rates, working fluid flow rates, power input, power output, and pressures and temperatures proximate various components of apparatus , such as inlets, outlets, compressors, combustors, turbines, exhaust systems, reaction or storage vessels and flow conduits. Additional sensors such as altimeters, air speed indicators or accelerometers are sometimes utilized to determine higher-order operational parameters such as thrust, climb or Mach number. In some embodiments, these higher-order parameters are directly measured by a particular sensor or sensor group. In other embodiments, including virtual sensor embodiments, higher-order parameters are calculated as a function of lower-order (directly measured) parameters.","The conditions of actuators  and apparatus  are represented by sensors  and  in software form, and made available to any of CLM , CLW , OBD  and SFDA  via ICM , providing an accurate assessment of the control influences acting on apparatus . In the case of an increased thrust request for a gas turbine engine, for example, CLM  directs CLW  to control actuators  in order to increase the fuel flow rate, and to change the position of various vane and nozzle components along the working fluid flow path through apparatus . Apparatus  responds with faster spool rotation, higher flow and increased exhaust temperature and pressure, which is sensed by system sensors  and reflected by synthesized system parameters generated by CLM .","In operation of system , CLW receives control demands from operator I\/F  and converts them into control requests for OCM , as described above. CLM  directs CLW  to dynamically adjust the control requests as a function of feedback or model output that represents the real-time operational condition of apparatus . The feedback signals include operational parameters related to specific control commands, such as commands related to shaft speeds and fuel flow rates. This allows system  to satisfy each control demand and control request quickly and accurately, without overshooting or oscillating about the target value. In some embodiments, CLM  also generates diagnostic and fault outputs for OBD  and SFDA .","System  and CLM  provide fast, accurate and robust response to real-time control commands. In particular, CLM  utilizes nonlinear functions to provide faster convergence and lower response time than other, highly iterative techniques, or that rely on linear, piecewise linear and \u201clightly\u201d non-linear estimates, rather than fully non-linear state variable functions. This allows system  to provide greater operating efficiency, particularly when apparatus  is subject to highly variable loads and unstable operational configurations.","In general, CLM  is comprised within a \u201cblack-box\u201d processor mounted proximate apparatus , as described above. CLM  communicates with CLW , system sensors , actuator sensors  and the other elements of system , as shown in , and estimates model states non-iteratively, with execution speed sufficient to provide stable and responsive control of apparatus .","In gas turbine engine embodiments, system  is applicable to a range of FADEC (full authority digital engine control) or \u201cfly-by-wire\u201d aviation applications, including STOVL operations for high-performance military aircraft. In these embodiments, apparatus  typically comprises a low-bypass turbofan engine having a core flow length on the order of a few meters. In further embodiments, the turbofan is configured for afterburning operations, and operates under conditions of choked inlet flow and substantially transonic or sonic core flow.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 2","b":["12","10","12","21","22","23","24","10","11"]},"Closed-loop model  receives external inputs  from sensor modules  and , via the A\/D converter  and ICM . Inputs  comprise effecter vector U, truth vector Yand boundary conditions U, which are combined to form external input vector U.","Effector vector Udescribes the configurations, positions and states of various control elements in apparatus . In a gas turbine engine, for example, individual elements of effector vector Udescribe fuel flow rates, nozzle areas, variable vane angles, flow path orifice areas, and other control element parameters.","In real-time execution of control system , truth vector Ydescribes the actual (sensed) values of parameters related to the operation of apparatus . The elements of truth vector Yare based on measurements by sensors  and , or, alternatively, a well-understood and trusted model of sensed parameters, such as a flow rate model based on a differential pressure drop across a Pitot tube or Venturi tube. For gas turbine engines, typical truth vector elements describe spool speeds and gas path temperatures or pressures proximate engine components such as compressors, combustors and turbines. In the context of non-real time applications, including calibration, truth vector Ycorresponds to high fidelity data which can either be physical tested or is model-based.","The elements of boundary vector Udescribe boundary conditions related to the operation of apparatus . Some boundary conditions are directly measured by system sensors , such as fluid temperatures, pressures and flow rates at physical boundaries of apparatus . In fluid-based applications, the boundary conditions include boundary flow conditions at inlet and outlet locations. Other boundary conditions specific to aircraft applications include, but are not limited to, flight velocity, altitude, and bleed or power extractions parameters.","In addition to external inputs , OLM  also operates on states of CLM . These states include two major subsets, which are referred to as constraint input states  (U) and physics states  (X). Constraint input states  (U) comprise corrector subset Uand solver subset U. Constraint corrector states Uare used to correct subset Yof outputs Y, and constraint solver states Uare used to minimize solver errors E. Physics states  (X) comprise a subset of dynamic states of apparatus , whose elements are determined based on their impact on the dynamic fidelity of CLM . Physics states  (X) typically exhibit relatively slow dynamics with respect to the execution speed of CLM , which is limited by the digital control system hardware (that is, the capability of the \u201cblack box\u201d processor or other computing platform).","Compared to physics states X, constraint input states Uare generally characterized by a faster time scale, for example the time scale associated with inter-component fluid volumes in a gas turbine engine or other fluid processing system. In particular, the latency time for elements of constraint input states Uis by definition less than the execution speed of CLM , outside the dynamic range of physics states X, and does not affect the fidelity of model outputs from CLM  that impact the quality of control system .","Constraint corrector states Uform a vector of adjustable model parameters utilized to correct a subset of model outputs Yfrom COM , such that they match corresponding elements of truth vector Y. The model parameters include both physics and engineering considerations, and empirical relationships based on actual operating conditions. Corrector outputs Yand truth vector Yare compared within a particular tolerance defined by comparator (CMP) , which outputs the difference by generating error corrector vector E. Corrector errors Eare combined with solver errors Eto produce error vector E. Essentially, CLM  seeks constraint vector Uthat drives both subsets of error vector E to zero.","Constraint solver states Uimpose both system and component constraints on CLM . In contrast to physics states X, these constraints often, but not always, are based on physical laws of flow continuity, thermodynamics, and other engineering limitations. This also contrasts with constraint corrector states U, which are model-adjustable parameters meant to compensate for incorrectly modeled and\/or omitted physics phenomena, and not always based on physics and engineering principles.","In the case of gas turbine-based systems, the elements of physics state vector Xdescribe \u201cimportant\u201d states such as spool speeds, which directly affect the transient fidelity of the CLM  through their direct impact on outputs corresponding to control commands such as thrust commands. There is also a subset of physics states Xthat is not directly sensed, but nevertheless is modeled in CLM , such as metal temperatures along a hot gas flowpath. The relatively long response time for physics model states Xcontrasts with the relatively short latency time of constraint corrector states Uand corrector outputs Y, which correspond to faster dynamical variables including flowpath temperatures and pressures.","Additional outputs Y do not necessarily correspond to parameters that are directly measured or controlled, for example gas path parameters in locations where it would be difficult, expensive or dangerous to place physical sensor devices. Further outputs Y are generalized outputs, which do not necessarily correspond to any particular physical quantity at all. Some generalized outputs are nonetheless empirically useful as inputs to CLW , because they allow system  to more quickly and accurately satisfy particular control commands.","OLM  also generates physics state vector derivatives defined by:",{"@attributes":{"id":"p-0050","num":"0049"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"X","mo":"."},"mi":"f"},"mo":"\u2261","mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["X","f"]}},{"mo":"\u2146","mi":"t"}]}},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"1"}}]}}}},"br":{},"sub":["S","f ","f","S ","S ","C","f ","C ","T"],"b":["24","22","21"]},"CMP  compares Yto the corresponding elements of truth vector Y, generating corrector errors E. Corrector errors Eare combined with solver errors Eto generate error vector E, which is minimized via MSE . Model parameters from OLM  are adjusted by corrector vector Uin order to minimize the difference between corrector outputs Yand truth vector Y, reducing errors between the output of CLM  and the actual condition of apparatus , as sensed by system sensors  and actuator sensors .","CLM  operates in both an on-board or online mode for real-time control of apparatus , and an off-board or offline mode. Off-board applications include system plant representation in control hardware testing environments, transient and steady state simulations to support design activities for system  and apparatus , and off-board hardware diagnostics to support field maintenance activities. Consequently, the particular pairing of constraint corrector states Uand corrector outputs Ydepends upon whether system  is operating in on-board or off-board mode. In particular, on-board and off-board sensor configurations often vary. Corrector subset Yof model output vector Y varies accordingly, in order to compare with the appropriate suite of sensors corresponding to truth vector Y.","As defined above, MSE  synthesizes physics state vector Xand constraint input state vector Ufrom error vector E and physics state vector derivative {dot over (X)}. Specifically, MSE  advances vectors Xand Uby the CLM cycle time, producing time-advanced physics state vector Xand time-advanced constraint input state vector U. The time-advanced vectors are fed back into OLM , completing the closed-loop structure of CLM .","Vectors Xand Uprovide complementary utility. Constraint input state vector Uallows CLM  to explicitly predict the elements of state vector Xin a feed-through (non-iterative) fashion, and to converge on time-advanced physics state vector Xwithin a reasonable processing time. This provides a high fidelity model that accurately represents engineering system\/apparatus , so that control system  operates in a reliable, efficient and effective manner.","In general, MSE  seeks time-advanced vectors Xand Uthat minimize error vector E (that is, drive the error toward zero). Typically, MSE  also minimizes physics state vector derivative {dot over (X)}. Thus MSE  generates outputs that minimize its inputs, such that CLM  more accurately describes the physical condition of apparatus , and such that CLW  more quickly, accurately and reliably satisfies the control commands raised by operator I\/F .","OLM  performs a non-iterative (single-pass or feed-through) analysis, in order to generate Y, {dot over (X)}and Eon a short time scale appropriate for a range of highly responsive dynamical embodiments of apparatus . In general, vectors {dot over (X)}, E and Y are functions of vectors X, Uand U; that is,\n\n(),\u2003\u2003[2]\n\n(),\u2003\u2003[3]\n\nand\n\n(),\u2003\u2003[4]\n\nwhere vector Y is the output (or feedback) from CLM . Feedback vector Y is used by CLW  to direct actuators  to position various control elements of apparatus , in order to achieve desired behavior. In a fluid based system such as gas-turbine engine, for example, the desired result is safe and efficient steady state and transient operation, which satisfies operational requirements for aircraft propulsion or power generation.\n","While vectors U, U, X, E and Y perform different functions within CLM , in some cases the individual vector elements are related. In particular, for some elements of output vector Y, transformation function \u0192takes on a relatively simple one-to-one form, such that output vector Y comprises one or more elements of physics state vector X. Alternatively, output vector Y is a function of one or more elements of external input vector U. This allows CLM  to perform additional fidelity checks based on truth vector Y, as described above and below.","MSE  generates time-advanced physics state vector Xand time-advanced constraint input state vector Uin order to minimize error vector E, physics state vector derivative {dot over (X)}, or both. In particular, vector Xis directed toward minimization of state vector derivative {dot over (X)}, and vector Uis directed toward minimization of error vector E. Furthermore, vector Uis directed toward minimization of corrector error vector E, and vector Uis directed toward minimization of solver error vector E.","Since vector Xtypically has relatively slow dynamic response with respect to the execution speed of CLM , the time-advanced form (X) can be estimated using an appropriate numerical approximation such as the forward rectangle rule. That is,\n\n()\u00d7\u0394\u2003\u2003[5]\n\nwhere \u0394T is the step time.\n","A more general result, without assuming any particular numerical integration algorithm, is:\n\n(. . . ),\u2003\u2003[6]\n\nwhere the \u201ck\u22121\u201d superscript denotes time-retarded forms of state vector Xand state vector derivative {dot over (X)}; that is, forms derived in a finite number of previous executions of CLM . The ellipses indicate that any number of additionally retarded forms can be utilized.\n","The additional requirements imposed on vector Umake the determination of time-advanced form Ua difficult technical problem. The process is best described by considering a small region around a particular operational point or base point BP, where a linear representation holds to sufficient accuracy. In this region, changes (or differences) in external input vector U, constraint state vector Uand physics state vector Xare defined by:\n\n\u0394U\u2261U\u2212U|,\u2003\u2003[7]\n\n\u0394U\u2261U\u2212U|,\u2003\u2003[8]\n\nand\n\n\u0394X\u2261X\u2212X|,\u2003\u2003[9]\n\nwhere the \u201c|\u201d subscript indicates evaluation at the location of base point BP.\n","In a linear approximation, the differences in physics state vector derivative {dot over (X)}, error vector E and output vector Y are linear combinations of the differences in vectors X, Uand U. That is,\n\n\u0394{dot over (X)}\u2248A\u00b7\u0394X+A\u00b7\u0394U+A\u00b7\u0394U,\u2003\u2003[10]\n\n\u0394E\u2248A\u00b7\u0394X+A\u00b7\u0394U+A\u00b7\u0394U,\u2003\u2003[11]\n\nand\n\n\u0394Y\u2248A\u00b7\u0394X+A\u00b7\u0394U+A\u00b7\u0394U.\u2003\u2003[12]\n\nNote that Eqs. 10-12 utilize a generalized tensor form, in which the product of tensors Aand vectors X, Uand Utend to mix or cross-couple contributions from different vector elements. This contrasts with Eqs. 2-6, which are vector equations in which particular scalar functions f-fare applied to individual components of vectors X, {dot over (X)}, E and Y. Eqs. 7-9 are similarly interpretable in terms of individual vector elements.\n","In linear models, the change in constraint vector Ucan be explicitly calculated, for example by setting the change in the error vector (\u0394E) in Eq. 11 to zero. Provided that the inverse of tensor Ais sufficiently definable over the relevant parameter space, this yields:\n\n\u0394U\u2248\u2212[A](A\u00b7\u0394X+A\u00b7\u0394U).\u2003\u2003[13]\n","For some embodiments of apparatus , the number of parameters is relatively small and constraint vector Ucan be directly approximated as a nonlinear function of state vector Xand input vector U. For many practical engineering systems, however, the complexity of apparatus  limits applicability of Eq. 13. The accuracy of linear representations also decreases with distance from base point BP, and the required execution speed is often impractical because the computational load increases exponentially.","In larger-scale practical engineering systems where the model cycle time (the step size) must be increased to keep up with the processing rate of apparatus , nonlinearities must be addressed in a more sophisticated way, which does not yield an impractical processing load. This is accomplished via a combined feed-forward and feedback-based approach to error correction, where feed-forward term Fis based on time-advanced state vector Xand time-advanced external input vector U, and feedback term Fincludes contributions from the accumulated error. That is,\n\n|()+(\u0394),\u2003\u2003[14]\n\nwhere error integral \u222bE dt is performed over a number of control system time steps. The more general approach of Eq. 14 allows CLM  and MSE  to address non-linear couplings among the various elements of input vector U, state vector Xand error vector E, which affect constraint vector Uand thus determine overall performance.\n",{"@attributes":{"id":"p-0066","num":"0065"},"figref":["FIG. 3","FIG. 1"],"b":["12","11","12","31","32","33","34","12"]},"As shown in , external inputs  describe a number of actuator-based and sensor based parameters that are variously categorized as elements of effector vector (or actuator vector) U, boundary condition vector U, or truth vector Y. Some of these categorizations overlap. At compressor module , for example, inputs  include elements of effector vector Uthat describe vane angle Vand other variable inlet parameters, and elements of boundary condition vector Udescribe inlet pressure Pand inlet temperature T, where the inlet forms an external flow boundary upstream of the compressor. For combustor module  and turbine module , inputs  include components of truth vector Ythat describe turbine exhaust case (TEC) or turbine exit temperature T. For nozzle module , inputs  include elements of actuator vector Uthat describe nozzle area Aand other variable nozzle parameters.","As described above, constraint input states  comprise vectors Uand U, which are combined to form constraint input state vector U. In , for example, vector Uincludes component-specific elements such as compressor outlet pressure P, as determined at an intermediate location between the compressor corresponding to software module , and the combustor corresponding to software module . Additional constraint vector components are generated within downstream component modules, for example TEC pressure or turbine exit pressure P, as determined within a transition flow duct between the physical turbine corresponding to software module  and the physical exhaust nozzle corresponding to software module .","In the example of , physics state vector  (X) contains an element corresponding to shaft speed N. Shaft speed N is utilized by compressor module  and turbine module , in order to calculate corresponding module outputs for the model. As with other elements of physics state vector X, shaft speed N is determined by engineering principles, has relatively slow response time compared to the model time step, and reflects system dynamics that are accurately modeled by CLM .","The change in spool speed N depends upon the net power delivered to the shaft:",{"@attributes":{"id":"p-0071","num":"0070"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mfrac":[{"mrow":[{"mo":"\u2146","mi":"N"},{"mo":"\u2146","mi":"t"}]},{"mrow":[{"msub":[{"mi":["S","T"]},{"mi":["S","C"]}],"mo":"-"},{"mi":["N","I"],"mo":"\u00d7"}]}],"mo":"="},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"15"}}]}}}},"br":{},"sub":["T ","C "],"b":["33","31"]},"Component modules ,  and  produce model outputs A, B and C, which are a representative subset of the model outputs used to form relationships between vectors Xand {dot over (X)}, and between vectors Uand E. Compressor module output A, for example, includes compressor flow rate Wand power demand S. Turbine module output B includes turbine flow rate Wand power output S, and nozzle output C includes nozzle flow rate W. Additional outputs include various gas path temperatures, gas path pressures and specific corrector outputs Y, such as turbine exit temperature T. Corrector outputs Yare compared to specific elements of truth vector Y, in order to generate errors (specifically, corrector errors E), and CLM  reduces the errors to enhance model fidelity and response.","The elements of constraint vector Uare divided into constraint corrector states U, which are utilized to correct subset Yof outputs Y (that is, to minimize corrector error E), and constraint solver states U, which are used to minimize solver errors E. Vector Uincludes adjustable (empirical) parameters, while constraint solvers Uare based on established rules of engineering and essentially inviolable laws of physics.","Applying control volume mass conservation law, it can be shown that the time rate of change in turbine module  exit pressure P, for example, depends upon ideal gas constant R, temperature Tand rate of flow into (W) and out of (W) volume V, as defined between the physical turbine and nozzle components corresponding to software modules  and , respectively:",{"@attributes":{"id":"p-0075","num":"0074"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["P","T"]}},{"mo":"\u2146","mi":"t"}]},"mo":"=","mrow":{"mfrac":{"msub":[{"mi":["RT","T"]},{"mi":["V","T"]}]},"mo":"\u00d7","mrow":{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["W","T"]},{"mi":["W","N"]}],"mo":"-"}},"mo":"."}}}},{"mrow":{"mo":["[","]"],"mn":"16"}}]}}}},"br":{}},{"@attributes":{"id":"p-0076","num":"0075"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["E","S"]},"mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["W","T"]}}},{"mfrac":{"msub":[{"mi":["RT","T"]},{"mi":["V","T"]}]},"mo":"\u00d7","mrow":{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["W","T"]},{"mi":["W","N"]}],"mo":"-"}},"mo":"."}}],"mo":"="}},{"mrow":{"mo":["[","]"],"mn":"17"}}]}}}}},"In general, corrector errors Edepend upon the difference between the elements of corrector output vector Yand the corresponding elements of truth vector Y. For turbine temperature T, for example, the appropriate element is:\n\n()=()\u2212().\u2003\u2003[18]\n\nThat is, the corrector error element corresponding to temperature Tis the difference between the turbine exit temperature as modeled by turbine module , and the corresponding element of truth vector Y. Depending on application, this element is sometimes an actual measurement from a physical sensor located in the core flow proximate the turbine exit assembly, and sometimes a high fidelity model output, which is accepted as accurate.\n","In general, particular constraint state parameters are utilized in a number of different forms, including both physics engineering relationships and empirical associations, in order to minimize error corrector Eand error solver E. Further, Eqs. 16-18 are not limited in application to the turbine\/nozzle interface, but can be applied to any control volume at any flow transition, including transitions between the physical components corresponding to compressor module , combustor\/burner module  and turbine module , or between an exhaust nozzle and an augmentor or afterburner assembly. At the same time, changes in one constraint parameter will necessarily influence a number of different errors, state vectors and model outputs. This makes stable error correction a high priority for fast, accurate and robust modeling and control systems.",{"@attributes":{"id":"p-0079","num":"0078"},"figref":["FIG. 4","FIG. 3"],"b":["12","12","21","22","23","24","12","25","35","35","35","35"]},"As shown in , inputs  to CLM  describe boundary conditions such as inlet pressure Pand inlet temperature T, and control states of apparatus , such as variable vane and nozzle configurations Vand A. These are input directly to OLM , while truth states such as turbine exit temperature Tare also input to CMP .","Typically, the inputs to OLM  are delivered to one or more individual component-level software modules, such as compressor module , combustor\/burner module , turbine module  and exhaust nozzle module  of , above. In turn, each of the component-level software modules utilizes processor components that perform the module-level functions of OLM , COM , CMP  and MSE .","Constraints  comprise vectors Uand U, which are combined to form vector U. Constraint state vector Uincludes component-specific elements such as compressor outlet pressure P, as determined at an intermediate location between the compressor and combustor. Additional constraint vector components are generated by downstream component modules, for example turbine exit pressure P, as determined within a transition flow duct between the turbine section and the exhaust nozzle.","The elements of constraint vector Udescribe component-specific elements such as compressor outlet pressure Pand turbine outlet pressure P. Constraint correctors Uare utilized to improve the accuracy of corrector outputs (modeled values) Yat COM , which correspond to truth (measured or high fidelity modeled) values Y, for instance the \u201ctrue\u201d value of turbine exit temperature T. This minimizes corrector errors E, as determined by CMP . Constraint solver states Uare utilized to minimize solver errors E, including the error in turbine flow parameters as described above.","Physics state vector  (X) comprises elements describing physics states of the apparatus, including spool speed N. OLM  determines the time rate of change in spool speed ({dot over (N)}) and other state vector elements, based on physics and engineering principles such as moment of inertia and net power delivered to the shaft.","Model state estimator (MSE)  generates time-advanced physics state vector Xand time-advanced constraint vector Ufor feedback into OLM , such that state vector derivatives {dot over (X)}and error vector E are driven toward zero (that is, minimized). This allows CLM  to quickly, accurately and reliably model the physical apparatus, ensuring fast response and high fidelity control.","In order to achieve these goals, MSE  must predict (or estimate) future model state values with some degree of accuracy, in order to reduce the magnitude of error vector E. In particular, MSE  must be able to accurately formulate the feedback term Fin Eq. 14, and must employ a gain design scheme that addresses cross-dependencies among the different elements of constraint vector Uand error vector E.","There are two basic approaches to gain design, depending upon how strong the cross-dependencies are. In the single-input, single-output (SISO) approach, distinct elements of error vector E are closely associated with distinct elements of constraint vector U, and not substantially cross-correlated, so gain formulation can be decoupled for each individual element. In the multiple-input, multiple-output (MIMO) approach, error vector E and constraint vector Uare substantially cross-correlated with one another, and the problem is not decoupled. The MIMO approach is further divided into control and observer formulations, as described below.","The SISO approach applies when distinct components of error vector E are closely associated or paired with distinct components of constraint vector U. In this case, tensors Ain Eqs. 10-12 take on substantially diagonal form, with relatively small-magnitude off-diagonal elements. Alternatively, the SISO approach applies when there is one-way coupling. In this case, tensors Ahave substantially triangular form, in which the elements on one side of the diagonal are zero, or at least small as compared to elements on the other side of the diagonal.","In SISO embodiments, the feedback contribution in Eq. 14 is approximated by the following single-input, single-output model state estimator equation:\n\n|()\u00b7\u2003\u2003[19]\n\nEssentially, Eq. 19 provides a difference equation (or a set of difference equations) for obtaining time-advanced constraint vector U. The difference equations define the change in time-advanced constraint vector Ufrom its value at base point BP, in terms of the tensor product of gain matrix S and error vector E, scaled by time step \u0394T.\n","In the decoupled case, gain tensor S is substantially diagonal; that is, each element of time-advanced constraint vector Uis associated with exactly one element of error vector E, and is not closely associated with the others. In this case, the estimation process for time-advanced constraint state vector Uis simply repeated for each set of paired elements. Because the mapping from constraint vector Uto error vector E is substantially one-to-one, the computations are independent and can be performed in any order.","CLM  utilizes non-linear approximations, such that the particular form of gain tensor S varies as a nonlinear function of input vectors X, U, Uand Y. In addition, the gain design process is repeated over a rich set of inputs, representing the full operational envelope of each individual vector element. The elements of gain tensor S are then determined on the basis of model fidelity, control response, and stability over the entire operational range.","During the gain design process, additional correlations typically appear between elements of constraint vector Uand elements of error vector E. To the extent that these additional cross-couplings are small, the SISO estimator approach holds and it is sufficient to approximate gain tensor S with a substantially diagonal or substantially triangular form. To the extent that these additional cross-couplings are not small, the SISO approximation does not hold and multiple-input, multiple-output (MIMO) design approach is employed.","In the MIMO embodiment, MSE  utilizes a twofold design approach in which a linear analysis is used to formulate initial gain parameters (that is, to estimate the gain tensor elements), followed by derivation of a model state estimator difference equation analogous to Eq. 19, above, but using a gain integral to accommodate additional cross-couplings. There are two basic approaches to the MIMO gain design equation, which are known as control formulation and observer formulation.","In the control formulation approach, the elements of error vector E are assumed to depend upon the time derivative of an unknown state vector X. That is,",{"@attributes":{"id":"p-0095","num":"0094"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":["\u0394","E"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mi":"\u0394","mo":"\u2062","mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["X","d"]}},{"mo":"\u2146","mi":"t"}]}}],"mo":"="},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"20"}}]}}}},"br":{},"sub":"d "},{"@attributes":{"id":"p-0096","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"X","mo":"."},"mi":"d"},"mo":"\u2261","mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["X","d"]}},{"mo":"\u2146","mi":"t"}]}},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"21"}}]}}}},"br":{},"sub":["f","f ","d"]},{"@attributes":{"id":"p-0097","num":"0096"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"X","mo":"\u2261","mrow":{"mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":["X","f"]}}},{"mtd":{"msub":{"mi":["X","d"]}}}]}},"mo":"."}}},{"mrow":{"mo":["[","]"],"mn":"22"}}]}}}}},"The control formulation views constraint vector Uas a control input. The change in Udepends upon augmented state vector X through a multiple-input, multiple-output (MIMO) gain function, which is expressed in matrix form as gain tensor M. That is,\n\n\u0394\u2003\u2003[23]\n\nwhere M is the MIMO gain tensor in the control formulation. Note that this approach also requires augmentation of constraint vector Uand MIMO gain tensor M, for example\n\nM\u2261\u2514MM\u2518,\u2003\u2003[24]\n\nwhere submatrices Mand Mare associated with physical state vector Xand solution vector X, respectively.\n","Gain design seeks gain tensor M that allows MSE  to direct solution state vector Xtoward quick and reliable minimization of error vector E, which in turn achieves stability and fidelity for CLM  and facilitates stable and accurate control response for system . A general form for estimating time-advanced (augmented) state vector Xis based on the forward rectangular rule for integral approximation:\n\n\u0394\u2003\u2003[25]\n\nIn this expression, the augmented state vector derivative\n",{"@attributes":{"id":"p-0100","num":"0099"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mover":{"mi":"X","mo":"."},"mo":"\u2261","mfrac":{"mrow":[{"mo":"\u2146","mi":"X"},{"mo":"\u2146","mi":"t"}]}}},{"mrow":{"mo":["[","]"],"mn":"26"}}]}}}},"br":{},"sub":["X","K","f ","d"]},{"@attributes":{"id":"p-0101","num":"0100"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mover":{"mi":"X","mo":"."}},{"mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"msub":{"mi":"f","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["U","X"]},{"mi":["U","K"]},{"mi":["X","f"]}],"mo":[",",","]}}}}},{"mtd":{"mrow":{"msub":{"mi":"f","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["U","X"]},{"mi":["U","K"]},{"mi":["X","f"]}],"mo":[",",","]}}}}}]}},"mo":"."}],"mo":"="}},{"mrow":{"mo":["[","]"],"mn":"27"}}]}}}}},"MIMO gain tensor M is defined as a function of the time rate of change in the augmented state vector:",{"@attributes":{"id":"p-0103","num":"0102"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mover":{"mi":"X","mo":"."},"mo":"=","mrow":{"mrow":[{"mrow":{"mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"msubsup":{"mi":["A","f","f"]}},{"mn":"0"}]},{"mtd":[{"msubsup":{"mi":["A","d","f"]}},{"mn":"0"}]}]}},{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msubsup":{"mi":["A","f","d"]}}},{"mtd":{"msubsup":{"mi":["A","d","d"]}}}]}},{"mo":["[","]"],"mtable":{"mtr":{"mtd":[{"msub":{"mi":["M","f"]}},{"msub":{"mi":["M","d"]}}]}}}],"mo":"\u00b7"}],"mo":"-"}},"mo":"\u00b7","mi":"\u0394"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"X"},{"mrow":{"mi":["B","\u0394"],"mo":"\u00b7"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["U","X"]}}],"mo":"+"}},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"28"}}]}}}},"br":{}},{"@attributes":{"id":"p-0104","num":"0103"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"A","mo":"\u2261","mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"msubsup":{"mi":["A","f","f"]}},{"mn":"0"}]},{"mtd":[{"msubsup":{"mi":["A","d","f"]}},{"mn":"0"}]}]}},{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msubsup":{"mi":["A","f","d"]}}},{"mtd":{"msubsup":{"mi":["A","d","d"]}}}]}},{"mrow":{"mo":["[","]"],"mtable":{"mtr":{"mtd":[{"msub":{"mi":["M","f"]}},{"msub":{"mi":["M","d"]}}]}}},"mo":"."}],"mo":"\u00b7"}],"mo":"-"}}},{"mrow":{"mo":["[","]"],"mn":"29"}}]}}}},"br":{},"b":"12"},"Time-advanced constraint vector Uis defined analogously:\n\n\u0394U\u2261\u2212M\u00b7\u0394X\u2003\u2003[30]\n\nIn some embodiments, solution states Xare decoupled from physical states X, such that the solution vector and physical state vector are well separated in terms of the bandwidth (the respective bounds in the frequency domain) In these embodiments, independent forms are obtained for solution states X:\n",{"@attributes":{"id":"p-0106","num":"0105"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msubsup":{"mi":["X","d"],"mrow":{"mi":"k","mo":"+","mn":"1"}}},{"mrow":[{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["X","d"]}},{"mfrac":{"mrow":[{"mo":"\u2146","msub":{"mi":["X","d"]}},{"mo":"\u2146","mi":"t"}]},"mo":["\u00d7","\u2062","\u2062"],"mi":["\u0394","T"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"+"}],"mo":"="},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"31"}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"d"}},{"msub":{"mi":["f","d"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["U","X"]},{"mi":["U","K"]},{"mi":["X","f"]}],"mo":[",",","]}}}],"mo":"="},"mo":[",","\u2062"],"mstyle":{"mtext":{}},"mi":"and"}},{"mrow":{"mo":["[","]"],"mn":"32"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msubsup":{"mi":["U","k"],"mrow":{"mi":"k","mo":"+","mn":"1"}}},{"mrow":[{"mrow":{"mo":"-","msub":{"mi":["M","d"]}},"mo":"\u00b7","mi":"\u0394"},{"msubsup":{"mi":["X","d"],"mrow":{"mi":"k","mo":"+","mn":"1"}},"mo":"."}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"="}},{"mrow":{"mo":["[","]"],"mn":"33"}}]}]}}},"br":{},"b":"12"},"In the observer formulation approach, an assumption is made that constraint vector Uis the unknown or solution state X, and that its time derivative is zero. That is,\n\n\u0394U=\u0394X\u2003\u2003[34]\n\nand\n\n\u0394{dot over (U)}=0.\u2003\u2003[35]\n\nApplying linear observer methodology, the following estimator is constructed to drive error vector E to zero:\n",{"@attributes":{"id":"p-0108","num":"0107"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"f"}}}},{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"d"}}}}]}},{"mrow":[{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"msubsup":{"mi":["A","f","f"]}},{"msubsup":{"mi":["A","c","f"]}}]},{"mtd":[{"mn":"0"},{"mn":"0"}]}]}},{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["X","f"]}}}},{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["X","d"]}}}}]}}],"mo":"\u00b7"},{"mrow":{"mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msubsup":{"mi":["B","f","x"]}}},{"mtd":{"mn":"0"}}]}},"mo":"\u00b7","mi":"\u0394"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["U","X"]}},{"mrow":{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":["L","f"]}}},{"mtd":{"msub":{"mi":["L","d"]}}}]}},"mo":"\u00b7","mi":"E"}],"mo":["+","-"]}],"mo":"="},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"36"}}]}}}},"br":[{},{},{}],"sub":["f ","d ","X"],"in-line-formulae":[{},{}],"i":["{dot over (X)}=A\u00b7\u0394X+B\u00b7\u0394U","\u2212L\u00b7E,"]},{"@attributes":{"id":"p-0109","num":"0108"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"f"}}}},{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"d"}}}}]}},{"mrow":[{"mrow":[{"mo":["{","}"],"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":[{"msubsup":{"mi":["A","f","f"]}},{"msubsup":{"mi":["A","c","f"]}}]},{"mtd":[{"mn":"0"},{"mn":"0"}]}]}},{"mi":"L","mo":"\u00b7","mrow":{"mo":["[","]"],"mtable":{"mtr":{"mtd":[{"msubsup":{"mi":["A","d","f"]}},{"msubsup":{"mi":["A","d","c"]}}]}}}}],"mo":"-"}},{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["X","f"]}}}},{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["X","d"]}}}}]}}],"mo":"\u00b7"},{"mrow":{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msubsup":{"mi":["B","x","f"]}}},{"mtd":{"mn":"0"}}]}},{"mi":"L","mo":"\u00b7","msubsup":{"mi":["B","x","d"]}}],"mo":"-"}},"mo":"\u00b7","mi":"\u0394"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["U","X"]}}],"mo":"+"}],"mo":"="},"mo":","}},{"mrow":{"mo":["[","]"],"mn":"38"}}]}}}},"br":{},"b":"12"},"The resulting difference equations for augmented state vector X are:\n\n\u0394X\u2261\u0394X+\u0394{dot over (X)}\u00d7\u0394T,\u2003\u2003[39]\n\nas above, and\n",{"@attributes":{"id":"p-0111","num":"0110"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"f"}}}},{"mtd":{"mrow":{"mi":"\u0394","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mover":{"mi":"X","mo":"."},"mi":"d"}}}}]}},{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"mrow":{"msub":{"mi":"f","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["U","X"]},{"mi":["U","K"]},{"mi":["X","f"]}],"mo":[",",","]}}}}},{"mtd":{"mn":"0"}}]}},{"mrow":[{"mo":["[","]"],"mtable":{"mtr":[{"mtd":{"msub":{"mi":["L","f"]}}},{"mtd":{"msub":{"mi":["L","d"]}}}]}},{"mrow":{"msub":{"mi":"f","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["U","X"]},{"mi":["U","K"]},{"mi":["X","f"]}],"mo":[",",","]}}},"mo":"."}],"mo":"\u00b7"}],"mo":"-"}],"mo":"="}},{"mrow":{"mo":["[","]"],"mn":"40"}}]}}}},"br":[{},{},{},{},{}],"sub":["d ","d","d","d","2","X","K","f","d","2","X","K","f"],"in-line-formulae":[{},{},{},{},{},{}],"i":["X","=\u0394X","\u2212L","\u00b7f","U",",U",",X","T","{dot over (X)}=\u2212L","\u00b7f","U",",U",",X"],"sup":"k+1","b":"12"},{"@attributes":{"id":"p-0112","num":"0111"},"figref":"FIG. 5","b":"50","sub":["1 ","2"]},"Optimum scheduling parameters are determined on the basis of unique criteria including base point field coverage, independence, surface smoothness, variability validity, and gain margin statistics. The criteria are evaluated both with respect to the gain parameters themselves, and with respect to vector derivatives such as dE\/dU.","Typical candidate scheduling parameters include elements of external input vector U, constraint vector U, state vector X, output vector Y or error vector E that sufficiently define the apparatus to allow effective gain scheduling. Alternatively, the scheduling parameters incorporate elements of augmented vectors such as augmented state vector X, or other parameters not contained in the augmented vectors, but which nonetheless provide for effective gain scheduling.","Plot  illustrates a bi-variant or two-dimensional approach with two arbitrary scheduling parameters Pand P, plotted against each other with first parameter Pon the horizontal and second parameter Pon the vertical. Typically, engineering complexity requires at least two scheduling parameters, and no more than two parameters are used when sufficient to effectively design the gain, in order to reduce computational requirements. Alternatively, a one-dimensional (univariant) approach is used, or a multi-variant (multi-dimensional) approach.","Scheduling parameters Pand Pare defined for steady state and transient operational conditions spanning a rich data set of design, off-design and failure conditions. A linear space representation is obtained at each design point, applying various linearization techniques to accurately predict system behavior in the vicinity of each data point  (triangles). Linearization is verified by a step-response time domain analysis or other validation process, which is applied to a subset of the design data points.","Linear system variables are scaled by maximum values, to improve accuracy of numerical tensor operations during gain design. Correcting linear system variables improves effectiveness of MSE, when operating at non-standard boundary conditions. Scaled and corrected linear models are then used in the gain design process.","The linear representation and gain size vary between points of the design data set. An optimum base point system is synthesized, where each base point  (circles) contains a complete specification of the linear system. The operating envelope is covered by a finite number of base points, each defined with scheduling parameters Pand P, or another set of scheduling parameters. This results in a rectangular grid of base points , forming a base point field than spans the relevant scheduling parameter range.","A linear state space representation is synthesized at each base point , from a finite number of design data points located in close proximity to the base point. Proximity is defined by base point cloud , with radius r selected as an optimization parameter. One approach utilizes a weighted average of data points  located within base point cloud . The weighting factor is defined, for example, as a function of the non-dimensional distance between base point  and data point .","The gain is sized for each system of base points , and the discrete model state estimator obtains values of the gain at each time step by interpolating between the base points. That is, the field of optimized base points  provides a \u201clookup table\u201d from which the gains can be interpolated, so that the elements of gain matrices S, M and L can be rapidly and effectively determined as functions of scheduling parameters Pand P.","While this invention has been described with reference to exemplary embodiments, it will be understood by those skilled in the art that various changes may be made and equivalents may be substituted for elements thereof, without departing from the scope of the invention. In addition, modifications may be made to adapt a particular situation or material to the teachings of the invention without departing from the essential scope thereof. Therefore, it is intended that the invention not be limited to the particular embodiments disclosed, but that the invention will include all embodiments falling within the scope of the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0012","num":"0011"},"figref":["FIG. 3","FIG. 1"]},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 4","FIG. 1"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 5","FIG. 1"]}]},"DETDESC":[{},{}]}
