---
title: Printer driver identification for a remote printer
abstract: In a multi-user server-client environment, a printer can be attached to a client computer. The server selects a corresponding printer driver to install on the server in order to allow applications executing on the server to print to the printer attached to the remote client computer. The selection process allows the server to intelligently identify closely matching printer drivers in the event that a particular printer driver that the server is notified of is not available for installation.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07401113&OS=07401113&RS=07401113
owner: Microsoft Corporations
number: 07401113
owner_city: Redmond
owner_country: US
publication_date: 19991209
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","CONCLUSION"],"p":["This invention relates to server-client systems and, in particular, to a server-client system in which a proper printer driver for a printer attached to the client is identified.","In a typical server-client system, a server computer is connected to several client computers or terminals via a network. In such a system, applications are executed at the server rather than at the client. The server transmits display information to the client for display at the client, and user inputs (e.g., via keyboard or mouse) at the client are transmitted to the server for processing by an application(s) executing at the server. The \u201cclient\u201d may be an entire client computer, or alternatively an application executing at the client computer.","A server in such a system typically has an operating system that can run several client sessions concurrently. Each client user has access to various resources of the server, including the processor, data storage, application programs, etc. Software applications that are resident on the server are available to each client for independent execution by the client. Each session is independent from the other sessions and, therefore, one client cannot access information relating to another client. In this manner, the server provides a logically independent machine for each client connected to the server.","Client users frequently use peripheral devices physically attached to the client machines. For example, a user may wish to attach a printer to the user's client computer (a \u201clocal\u201d printer) in order to print data generated by an application that is running on the server computer. To do this, currently the user must manually install the local printer and redirect the printer queue created by the server to the I\/O port of the client computer to which the printer is connected. Such manual installation of peripheral devices is undesirable because it requires significant time and effort on the part of the user. U.S. Pat. No. 6,789,111 entitled \u201cAutomatic Detection And Installation Of Client Peripheral Devices By A Server\u201d, describes a system which resolves many of these manual installation problems by automatically detecting such devices and installing and corresponding device drivers at the server.","However, one problem that can be encountered with either manual identification or automatic detection of peripheral devices is the identification of the proper driver to be installed. In order to properly install a peripheral device, the correct driver needs to be installed at the server. Typically, the client notifies the server of the correct driver to use for a particular device. However, situations can arise where the driver that the client indicates should be used for a particular peripheral device is not available at the server, thereby preventing installation of that particular device.","The invention described below addresses these disadvantages, providing for printer driver identification for a remote printer.","In a server-client environment, a peripheral device can be attached to a client computer. The server selects a corresponding printer driver to install on the server to allow applications executing on the server to print to the printer attached to the remote client computer. For purposes of discussion, reference herein is made primarily to printers. However, the driver selection described herein can be analogously applied to any of a variety of peripheral devices, such as scanners, card readers, zip drives, etc.","An embodiment of the server selects a printer driver to install at the server for use with the printer attached to the remote client computer using an \u201cexact match\u201d technique. In this embodiment, the server receives a printer driver identifier and checks whether any of a plurality of printer drivers maintained at the server has a corresponding identifier that matches the received printer driver identifier. If such a match is found, then the matching printer driver from the plurality of printer drivers is installed on the server.","Another embodiment of the server selects a printer driver to install at the server for use with the printer attached to the remote client computer using a \u201cdriver name mapping\u201d technique. In this embodiment, the server receives a printer driver identifier and checks whether any of a plurality of printer drivers maintained at the server has a corresponding identifier that is different than the received printer driver identifier but that corresponds to the same printer driver as the received printer driver identifier. Such differences can occur, for example, when a manufacturer or distributor of a printer driver changes the name of the printer driver. If such a match is found, then the matching printer driver from the plurality of printer drivers is installed on the server.","Another embodiment of the server selects a printer driver to install at the server for use with the printer attached to the remote client computer using a \u201cclose match\u201d technique. In this embodiment, the server receives a printer driver identifier and checks whether any of a plurality of printer drivers maintained at the server has a corresponding driver name that is the same as a driver name received as part of the printer driver identifier. If such a match is found, then the matching printer driver from the plurality of printer drivers is installed on the server without regard for whether that particular printer driver has a corresponding driver version that is the same as a driver version received as part of the printer driver identifier.","Another embodiment of the server issues a notification when a printer driver is installed that is not an exact match to a received printer driver identifier. Such an \u201cinexact\u201d match could be due to a change in driver name, installation of a previous version of a requested printer driver, installation of a more recent version of a requested printer driver, etc. The notification can be used, for example, to make a system administrator or the user of the client computer aware that the inexact match occurred.","Another embodiment of the server attempts to automatically update a printer driver under certain circumstances. In this embodiment, if a received printer driver identifier indicates a more recent version of a printer than is available on the server, the server attempts to locate the more recent version and add it to the server so that the most recent version can be installed on the server.",{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 1","b":["30","32","34","36","38","32","34","36","38","32","34","36","38","34","26","40","42"]},"The server  is a computer. A client ,  may be a computer having Plug and Play capability, a computer that is not Plug and Play compatible, or a terminal, which does not have the processing capability of a computer. Implications of utilizing the different types of clients will be discussed in greater detail below.","It is noted that, although the server\/client computer system  depicted in  has a first client  and a second client , there may be one to any number of clients connected to the server  concurrently. The number of clients that may be connected to a server is limited only by the architecture of a particular server.","The server  is configured to provide a logically independent machine for each client ,  connected to the network . That is, the server  establishes a session for each client , , provides the desktop ,  for each client , , and makes server resources available to the clients , . Such resources include, but are not limited to, allocations of processor time, memory, data storage, video processing, application programs, etc. A user of either of the clients ,  interacts with the desktop ,  on the client ,  to run software applications that reside on the server . While the user provides input to and receives output from the client , , most processing is performed at the server .","The network  provides a communications link between the server  and the clients ,  through which data is transmitted. The network  may be a local area network (LAN), a wide area network (WAN), the Internet, or the like, provided that it can accommodate server\/client functionality.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2","b":["50","52","54","52","56","58","52","60","38","60","52","38"]},"The server  can be implemented as a common personal computer or other type of computer, such as a laptop computer, etc. The server  runs an operating system , which is stored in memory  and executes on the processor . The operating system  is a multitasking operating system such as a Windows\u00ae brand operating system from Microsoft Corporation (e.g., Windows\u00ae 98, Windows\u00ae 95, Windows\u00ae NT, or other derivative of Windows\u00ae). However, other multi-tasking operating systems may be used.","The server  has a printing subsystem  implemented in the operating system  stored in memory . The printing subsystem  is used to direct all operations involving printers and printing, including installing printers, creating and managing printer queues, removing printers, uninstalling printers, etc. The printing subsystem includes a peripheral mapping unit  that is configured to map, or redirect, printer queues to printer ports. The printing subsystem  may be an integral part of the operating system  or it may be a software function that is callable by the operating system  or by application programs.","The server  is shown having a printer driver  and a printer queue  installed and resident within the memory . It is noted, however, that the server  will only include the printer driver  and the printer queue  when a printer has been connected to the system  and installed on the server . The printer driver  is a printer-specific software program that provides an interface between a printer and the server  and allows the server  to provide print functions via the printer. When the printer driver  is installed on the server , the printer queue  is created. The printer queue  accepts print jobs from the server  and queues them for printing.","The server  further includes a driver library , which is a set of multiple peripheral device drivers that are available for installation on the server  (e.g., as the printer driver ). In the illustrated example, the driver library  is maintained at the server . Alternatively, the driver library may be maintained at some other location (e.g., a remote location accessible via the network ) that is accessible to the server . When a driver is installed on the server  for a device attached to the client , the driver is obtained from driver library .","The operating system  further includes a driver matching module . When a driver is to be installed on the server , the server  receives an indication (e.g., automatically detected by the client  or manually input by a user) of the driver that is to be installed. However, situations can arise when the received indication identifies a driver that is not available to the server  (e.g., is not in the driver library ) and thus is not available for installation at the server . The driver matching module  remedies such situations by attempting to select, for installation at the server , a driver that most closely matches the driver identified in the received indication.","The server  further includes a driver mapping . The driver mapping  is a record (e.g., a list) of old driver names and new driver names. Situations can arise where the name of a driver is changed. Such changes are maintained by the server  in order to install the appropriate driver in the event that the driver is identified by its old name, as discussed in more detail below.","The client  includes memory  and a display . Similar to the server , the client  also has a network port  to facilitate access to the network . The network port  may be implemented as a modem, network card, or other device, which interfaces the client  to the network . The client  also includes a printing subsystem  resident in the memory , a first I\/O port , a second I\/O port , and a printer  connected to the first I\/O port . The printing subsystem supports the concept of printing queues, which are logical containers that encompass a physical printer's driver information, properties, and pending print jobs.","The client  has a system registry  located in the memory . The printing subsystem  may be an integral part of the operating system  or it may be a software function that is callable by the operating system  or by application programs. The server\/client system  also includes the printer , which is connected to the first I\/O port . A printer queue  is installed in the memory  for the printer .","It is noted that, although the client  is depicted as being a computer, the client  may also be a terminal, which does not have the mass storage or processing capabilities of a computer. The present invention functions similarly whether the client  is a computer or a terminal.","The client  may automatically detect the printer , or the printer  may be manually identified to the client  and\/or the server . For example, a user may manually notify the server  or the client  of the location of the printer  and an I\/O port of the client  to which the printer  is attached (e.g., by use of a printer setup \u201cwizard\u201d).","When the printer  is attached to the client , information identifying a A corresponding printer driver to use for the printer  is provided to the server . This information can be automatically detected by the client  or alternatively can be supplied manually by the user of the client . Additionally, the information can be provided when the user of the client  logs on to the server , or alternatively at some subsequent time. Regardless of the source of the printer driver information or when the information is provided, this received printer driver information is used by the server  in selecting an appropriate printer driver from the driver library  to install on the server  in order to allow applications executing on the server  to print to the printer .",{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 3","FIGS. 1 and 2"]},"At step  in , the client  establishes a connection with the server . After the client  establishes the connection, the client  waits for an announcement package from the server . When the server  detects the connection from the client  (step ), the server  sets up a session for the client  at step . At step , the server  initializes the data structures necessary to provide the session for the client . When this is completed, the server  sends an announcement package to the client , which signals the client  that it can commence interactive communications with the server .","At step , the printer(s) attached to the client  are identified. As previously discussed, the client  is a computer having a printing subsystem. The printing subsystem provides an interface, such as an Application Programming Interface (API) that allows applications (such as operating system  or another application separate from operating system ) to identify printer queues installed at the client  (e.g., the printer ). Such queues can be installed at client  in any of a variety of manners, such as automatically (e.g., using a Plug and Play (PnP) subsystem), or manually. At step , information describing these identified queues, such as a particular driver name and version or a PnP identifier, is sent to the server .","At step , the server  installs the identified printer(s). The printing subsystem  on the server  parses the information to determine the printer driver corresponding to the printer  that should be installed on the server . This identified printer driver is then used to determine which printer driver from library  to install as printer driver , as discussed in more detail below. The printer driver  is installed on the server  and the printer queue  is created. The peripheral mapping unit  then redirects the printer queue  to the I\/O port  to which the printer  is connected.",{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 4","FIG. 4","FIG. 2"]},"Initially, the server  obtains the printer driver information (step ), which identifies a printer driver that is expected to be installed on the server  for use with the printer . This \u201cexpected driver\u201d can be determined in various manners. For example, the user of the client  may indicate a particular printer driver to use, or alternatively a PnP subsystem on the client  may indicate that a particular printer driver is to be used (e.g., by driver name and version number, by a PnP identifier that can be resolved by server  into a driver name and version (e.g., via a lookup table), etc.). The printer driver information includes both a printer driver name and a printer driver version. Typically the printer driver information for one printer will identify a single printer driver, although alternatively multiple printer drivers (including multiple names and multiple versions) may be identified in the printer driver information.","Situations can arise where the identified printer driver is not available on the server . Such situations can arise for a variety of different reasons. For example, the name of the printer driver (and\/or the version of the printer driver) may have been changed by the manufacturer (or developer, distributor, etc.) of the driver, so that the identified printer driver name no longer exists. By way of another example, the version of the identified printer driver may be a new or older version of the printer driver than is available on the server .","Thus, the server  attempts to match the received printer driver information to a particular printer driver available to the server  (step ). The server  then takes different actions depending on whether the attempt to match the received printer driver information to a particular printer driver is successful (step ). If the attempt to match is successful, then the matching printer driver is installed at the server (step ). However, if the attempt to match is unsuccessful, then the driver installation process fails (step ).","The server  uses various techniques to attempt to match the received printer driver information to a particular printer driver. In the illustrated example, three such techniques are used, referred to as \u201cexact match\u201d (step ), \u201cdriver name mapping\u201d (step ), and \u201cclose match\u201d (step ). Each of these techniques involves comparing at least a portion of the received printer driver information to information corresponding to the printer drivers available to the server . Such comparisons can be done by accessing each of the printer drivers individually, by accessing a record of the printer driver information for each of the available printer drivers (having identifiers or links to the corresponding printer driver(s)), or by a combination thereof.","The server  may follow a particular ordering in using these techniques, such as using the exact match technique first, followed by the driver name mapping and close match techniques if necessary. Alternatively, two or more of these techniques could be used concurrently.","In the exact match technique (step ), the driver matching module  searches for an exact match between the received printer driver information and the information corresponding to the printer drivers available to the server . An exact match between the received printer driver information and a particular printer driver available to the server  refers to the printer driver names being the same and the printer driver versions being the same.","In the driver name mapping technique (step ), the driver matching module  searches for a change in driver name. Situations can arise where the name of a particular driver is changed. The server  maintains a record (e.g., driver mapping ) of changes to driver names. This record includes the previous name(s) for printer drivers as well as their new names. If a received driver name is included in this record as a previous name, then the server  searches the available printer drivers for the new name identified from this record.","For example, assume that at the time the printer  is initially attached to the client  the correct name for the printer driver for the printer  is \u201cdriverY\u201d, and this information is recorded at the client . Subsequently, the manufacturer of the printer  changes its naming convention, so that the correct name for the printer driver for the printer  is changed to \u201cX printer driver\u201d. Further assume that the server  is distributed after the naming convention change occurs, so the server  has available to it the printer driver with the name \u201cX printer driver\u201d but does not have \u201cdriverY\u201d available to it. In this situation, a record of the change in printer driver name is maintained by the server  (e.g., the manufacturer making the change in naming convention notifies a system administrator of the change in naming convention or the old and new driver names for the printer drivers affected by the naming convention change). Thus, if the client  subsequently identifies to the server  \u201cdriverY\u201d in its printer driver information, the server  knows that \u201cX printer driver\u201d is the matching printer driver to be installed.","The driver name mapping technique can be used as an additional technique in the event the exact match technique (and\/or the close match technique) fails. Alternatively, the driver name mapping technique may be used prior to either the exact match technique or the close match technique, with the new driver name resulting from application of the driver name mapping technique being used as the received driver name (and possible driver version) during application of the exact match and close match techniques.","In the close match technique (step ), the driver matching module  searches for an available printer driver with the same name as the received printer driver but a different driver version. Situations can arise where one of the server  and the client  is aware of a more recent version of the printer driver than the other is aware of. In such situations, as long as the printer driver name matches, the server  will select the version of the printer driver it has available to it for installation. This selection by the server  occurs regardless of whether the version identified by the client  is a newer version or an older version than the version available to the server .","For example, the client  may be aware of version 2.1 of \u201cdriverZ\u201d and identify to the server , as the printer driver information for a particular printer, version 2.1 of \u201cdriverZ\u201d. However, the server  may only have version 2.0 of \u201cdriverZ\u201d and not yet have version 2.1 available to it. In this situation, the server  selects version 2.0 of \u201cdriverZ\u201d for installation. By way of another example, the client  may be aware of version 3.10 of \u201cdriverA\u201d and identify to the server , as the printer driver information for a particular printer, version 3.10 of \u201cdriverA\u201d. However, the server  may have a newer version of \u201cdriverA\u201d available to it, version 3.11. In this situation, the server  selects version 3.11 of \u201cdriverA\u201d for installation.","Alternatively, the driver name mapping technique (step ) and the close match technique (step ) can be combined into a single step. The record maintained by server  of changes to driver names (e.g., driver mapping ) can also include mappings of \u201crequested driver to available driver\u201d for all clients or alternatively on a per-client basis. For example, server  may maintain a record that when a request is made for version 3.10 of \u201cdriverA\u201d, that the driver to be installed is version 3.11 of \u201cdriverA\u201d. Such mapping information can be identified for storage at server  in a variety of manners, such as manual identification by a system administrator, automatic detection the first time it arises (e.g., close match technique step ), etc.","The server  may also optionally take additional actions depending on which of the various mapping techniques were used in obtaining a printer driver match. One such action is to issue a notification in the event that anything other than the exact match technique was used in selecting the printer driver for installation. The notification could simply be a warning that a technique other than exact match was used, or alternatively may include additional information describing the matching process or results, such as what technique(s) was used, what driver was selected as the matching driver, what printer driver information was received, etc. Such notifications can be made in any of a wide variety of forms, such as: sending an electronic mail message to the user of the client  or a system administrator; displaying a dialog box on either the client  or the server ; sounding an audible \u201calarm\u201d at the server ; adding an entry to a notification log; placing a telephone call (e.g., to a phone or pager); etc.","Another action that may be taken is to automatically attempt to add a new driver to the drivers available to the server . For example, if the received printer driver information identifies a newer version of a particular driver that is not available to the server , the server  can automatically attempt to obtain that new driver. The new driver can be obtained in any of a variety of manners, such as accessing a remote server computer for the distributor (or manufacturer, etc.) of the printer driver via the Internet, via a direct-dial connection, etc. The server  can be programmed with information identifying how to connect to such a remote server (e.g., including a telephone number, uniform resource locator (URL), etc.). Once the new driver is obtained, it could be installed at the server  immediately, or alternatively could be used the next time the client  logs on to the server  (so that subsequent matching attempts would result in an exact match).","In a server-client environment as described herein a printer can be attached to a client computer and made available for printing to by applications executing on the server computer. The server receives information identifying a printer driver to be used for the printer and attempts to identify a closest matching printer driver to be installed at the server.","Although the invention has been described in language specific to structural features and\/or methodological steps, it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features or steps described. Rather, the specific features and steps are disclosed as preferred forms of implementing the claimed invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention is illustrated by way of example and not limitation in the figures of the accompanying drawings. The same numbers are used throughout the figures to reference like components and\/or features.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
