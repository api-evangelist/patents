---
title: Information processing apparatus, printing data generation method, and printing control program
abstract: This invention provides an information processing apparatus having a generation function of generating printing data to be transmitted to a printer, including a storage which saves printing data of each original page in an intermediate format together with printing setting data, a printing controller which causes the user to change a printing setting and issue a printing instruction, and a printing data reading unit which reads out the printing setting data from the storage in accordance with the printing instruction, changes the color mode setting of the read printing setting data in accordance with the color mode setting in the printer that is changed by the printing controller, and generates by using the generation function the printing data containing an instruction of changing the color mode on the basis of the printing setting data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07911640&OS=07911640&RS=07911640
owner: Canon Kabushiki Kaisha
number: 07911640
owner_city: Tokyo
owner_country: JP
publication_date: 20031104
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS","First Embodiment","Configuration of Printing System According To First Embodiment","Other Embodiment"],"p":["The present invention relates to an information processing apparatus and printing control method and, more particularly, to a printing system which uses a personal computer or the like and generates printing data for causing an output apparatus such as a printer to perform printing processing.","It is conventionally popular to connect a printer and an information processing apparatus such as a personal computer into a printing system, and transmit printing data from the information processing apparatus to the printer to print. Some information processing apparatuses have a function of temporarily saving (spooling) data in a data format different from the format of printing data before generating printing data in a format (e.g., printer control language) processible by the printer. The temporary save data format is a format which is called an intermediate format independently of an application, printer description language, or the like. Data of the intermediate format (to be also referred to as intermediate data or intermediate code) can be converted into formats processible by various printers.","In an information processing apparatus of this type, data which is temporarily saved as an intermediate code is read out by a despool means, and printing data of a format to be finally transmitted to a printer is generated by a printer driver. This data format is a string of printer control commands to the printing apparatus, and transmitted to the printer for each printing job.","A representative known technique of a system including such information processing apparatus and printer is disclosed in Japanese Patent Laid-Open No. 10-285421. When a color printer is used in this system, the printer driver provides a function of causing the user to set color or monochrome printing for each printing job. The printer driver also provides an auto-color function of determining whether a page to be printed contains color data, and if so, setting color printing for the page; otherwise, setting monochrome printing. When a printing job having color or monochrome setting is transmitted to the printer, the printer prints in a color mode or monochrome mode in accordance with the setting.","This printing system, however, cannot perform color or monochrome setting for each page in accordance with user's designation.","For example, when a document is created by a DTP (DeskTop Publishing) application, a page containing a color figure or color image and a page substantially formed by a text generally coexist. In printing such document, a figure or image is often preferably printed in color, but a text suffices to be printed in monochrome.","In some cases, a page substantially formed by a text contains an annotation which is created in color such as red by the DTP application. Although the user wants to print such page in monochrome, the page is determined as a color page because of the red annotation, and color printing is set in printing processing using the auto-color function provided by the printer driver. As a result, the user is charged the color printing fee for the page.","By monochrome setting for the entire printing job, monochrome printing can also be set for such page. In this case, monochrome printing is also set for even a page to be printed in color.","If the user wants to divide pages to be printed in color and pages to be printed in monochrome, he\/she must separately designate pages to be printed in color and pages to be printed in monochrome in designating printing through the DTP application program. In this case, not only the operation becomes cumbersome, but also the user must arrange printouts. Even if the printer has optional functions such as a sorting function and stapling function, the user cannot utilize them.","In the prior art, the user cannot set color printing or monochrome printing for each page, posing many problems.","The present invention has been made to overcome the conventional drawbacks, and has as its object to provide a mechanism capable of designating color printing or monochrome printing for a page desired by the user in a document of pages that is created by an application, and performing printing processing designated by the user.","To achieve the above object, the present invention comprises the following arrangement.","A printing control apparatus having a generation function of generating printing data to be transmitted to a printer comprises","save means for saving printing data of each original page in an intermediate format together with printing setting data,","printing control means for causing a user to change a printing setting and issue a printing instruction, and","printing data reading means for reading out the printing setting data from the save means in accordance with the printing instruction, changing a color mode setting of the read printing setting data in accordance with a color mode setting in the printer that is changed by the printing control means, and generating by using the generation function the printing data containing an instruction of changing the color mode on the basis of the printing setting data.","In this arrangement, a color\/monochrome instruction can be issued in accordance with a changed setting.","The printing setting changed by the printing controller preferably includes the color mode setting of each original page in the printer, and the printing data reading unit preferably changes the color mode setting of the read printing setting data for each printing medium including the original page whose printing setting has been changed.","The printing setting changed by the printing controller preferably includes the color mode setting of each chapter formed by a plurality of original pages in the printer, and the printing data reading unit preferably changes the color mode setting of the read printing setting data for a set of printing media corresponding to the chapter whose printing setting has been changed.","The printing data reading unit preferably determines whether the printer copes with a change of the color mode before the printing data containing the instruction of changing the color mode is generated by using the generation function, when the printer copes with the change, generates, by using the generation function, printing data containing the instruction of changing the color mode, and when the printer does not cope with the change, generates, by using the generation function, printing data containing no instruction of changing the color mode.","The printing data reading unit preferably determines whether the printing setting changed by the printing controller includes the color mode setting of each original page in the printer, when the printing setting includes the color mode setting of each original page, changes the color mode setting of the read printing setting data for each printing medium including the original page whose printing setting has been changed, when the printing setting does not include the color mode setting of each original page, determines whether the printing setting includes the color mode setting of each chapter formed by a plurality of original pages in the printer, when the printing setting includes the color mode setting of each chapter, changes the color mode setting of the read printing setting data for a set of printing media corresponding to the chapter whose printing setting has been changed, and when the printing setting does not include the color mode setting of each chapter, changes the color mode setting of the whole printing data in the printer.","Alternatively, to achieve the above object, the present invention comprises the following arrangement.","An information processing apparatus which generates printing data to be transmitted to a printer, comprises","a save unit which saves document data to be printed together with printing setting data;","a printing setting unit which sets in printing setting data a color mode of whether color printing or monochrome printing is performed for a predetermined unit of document data; and","printing data generation means for generating the printing data by issuing a color mode designation instruction in order to change the color mode for the predetermined unit on the basis of the printing setting data.","The save unit preferably converts data input from an application, and stores the converted data as the document data of an intermediate format in a document file.","The save unit preferably manages the document data by a tree structure having a plurality of chapters defined by dividing the document data into a plurality of original pages.","The printing setting unit preferably can set designation of the color mode for each original page, each chapter, and the whole document data.","The printing setting unit preferably can designate whether the color mode for a chapter of the document data is set to the color mode of the whole document data or separately set.","Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings, in which like reference characters designate the same or similar parts throughout the figures thereof.","A printer control system according to a preferred embodiment of the present invention will be described.  is a block diagram for explaining the configuration of the printer control system. The present invention can be applied to a single apparatus, a system comprised of a plurality of devices, or a system which is connected via a network such as a LAN or WAN and performs processing, as far as the function of the present invention is executed.","In , a host computer  comprises a CPU , RAM , ROM , and the like. The CPU  executes document processing in which figures, images, characters, tables (including spreadsheets and the like), and the like coexist, on the basis of a document processing program or the like stored in the program ROM of the ROM  or an external memory . The CPU  comprehensively controls devices connected to a system bus . The program ROM area of the ROM  or the external memory  stores, e.g., an operating system program (to be referred to as an OS hereinafter) serving as the control program of the CPU . The font ROM area of the ROM  or the external memory  stores, e.g., font data used in document processing. The data ROM area of the ROM  or the external memory  stores various data used in document processing or the like. The RAM  functions as a main memory, work area, or the like for the CPU .","A keyboard controller (KBC)  controls a key input from a keyboard  or a pointing device (not shown). A CRT controller (CRTC)  controls the display of a CRT display (CRT) . A disk controller (DKC)  controls access to the external memory  such as a hard disk (HD) or flexible disk (FD). The external memory  stores a boot program, various applications, font data, user files, edited files, a printer control command generation program (to be referred to as a printer driver hereinafter), and the like. A printer controller (PRTC)  is connected to a printer  via a bidirectional interface (interface) , and executes communication control processing with the printer .","The CPU  executes, e.g., rasterization processing of an outline font to a display information RAM set in the RAM , and enables WYSIWYG on the CRT display . The CPU  opens various registered windows and executes various data processes on the basis of commands designated on the CRT  with a mouse cursor (not shown) or the like. When the user executes printing, he\/she opens a printing setting window provided by the printer driver, and can perform setting of a printer and setting of a printing processing method to the printer driver that includes selection of a printing mode.","The printer  is controlled by a CPU . The printer CPU  outputs an image signal as output information to a printing unit (printer engine)  connected to a system bus  on the basis of a control program stored in the program ROM area of a ROM  or a control program stored in an external memory . The program ROM area of the ROM  stores, e.g., the control program of the CPU . The font ROM area of the ROM  stores, e.g., font data used to generate the output information. The data ROM area of the ROM  stores, e.g., information used in the host computer for a printer having no external memory  such as a hard disk.","The CPU  can communicate with the host computer via an input unit , and notify the host computer  of internal printer information or the like. A RAM  functions as a main memory, work area, or the like for the CPU , and the memory capacity can be expanded by an optional RAM connected to an expansion port (not shown). The RAM  is used as an output information mapping area, environment data storage area, NVRAM, or the like. Access to the external memory  such as a hard disk (HD) or IC card is controlled by a memory controller (MC) . The external memory  is connected as an option, and stores font data, emulation programs, form data, and the like. Reference numeral  denotes an operation panel having operation switches, an LED display, and the like.","The number of external memories  is not limited to one, and a plurality of external memories  may be arranged. A plurality of external memories which store an option card and a program for interpreting the printer control languages of different language systems in addition to built-in fonts may be connected. Further, an NVRAM (not shown) may be adopted to store printer mode setting information from the operation panel .",{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 2","b":["201","202","203","204","111","102","201","203","111","111","201","111","102","500","201","202","102"]},"The application  is an application program which provides functions such as wordprocessing, spreadsheet, photo-retouch, draw, paint, presentation, and text editing. The application  has a printing function. Such applications utilize a predetermined interface provided by the OS (Operating System) in printing application data such as created document data or image data. To print created data, the application  transmits an output command which is determined in advance for the output module of the interface-providing OS and has an OS-dependent format. The output module which has received the output command converts the command into a format processible by an output device such as a printer, and outputs the converted command. Since the format processible by the output device changes depending on the type of device, the manufacturer, and the model, a device driver is provided for each device. The OS uses the device driver to convert a command. When the OS is Microsoft Windows\u00ae, the output module is a GDI (Graphic Device Interface) module.","When the OS is Windows\u00ae, the graphic engine  corresponds to a GDI. The graphic engine  loads the printer driver  prepared for each printing apparatus from the external memory  to the RAM , and sets the printer driver  as the output destination of the application . For example, in Windows\u00ae, the graphic engine  converts a GDI (Graphic Device Interface) function received from the application  into a DDI (Device Driver Interface) function, and outputs the DDI function to the printer driver .","Based on the DDI function received from the graphic engine , the printer driver  generates a control command such as PDL (Page Description Language) which can be recognized by the printer. The generated printer control command is spooled by the system spooler  loaded to the RAM  by the OS, and output as printing data to the printer  via an interface .","In addition to the printing system which is comprised of the printer and host computer shown in , the printing system according to the first embodiment has an arrangement of saving printing data from an application as intermediate code data (document file), as shown in . Note that data contained in the document file will also be referred to as a document file.",{"@attributes":{"id":"p-0068","num":"0067"},"figref":["FIG. 3","FIG. 2","FIG. 3"],"b":["202","203","303","302","303","304","305","306","201","202"]},"Note that data contained in the editing information file will also be referred to as an editing information file. In the first embodiment, the document file  and editing information file are processed as separate files, but when no file is opened, are combined as an archive file in order to hold the unity.","In the system shown in , data contents saved in the document file  can be processed. This realizes a function which is not provided to an application, such as a function of enlarging\/reducing printing data from an application or a function of reducing a plurality of pages into one page and printing the page. For this purpose, the system in  is so expanded as to spool intermediate code data, as shown in . Processing of printing data is generally set through a window provided by the printing control application , and the setting contents are saved in the RAM  or external memory .","As shown in , according to the expanded processing method, printing data from an application  is saved as the document file  in the system via the printing data save driver . The document file  is also called an intermediate file, and contains content data of a print material, printing setting data, or the like. Content data of a print material is data prepared by converting data created in an application by the user into an intermediate code. Printing setting data is data which describes how to output content data (output format or the like). In addition, the document file  contains application expansion data called an editing information file for providing a user interface in causing the user to edit the contents of a document file or issue an output instruction via a printing control application.","The document file  is loaded to the printing control application . The printing control application  can change, display, save, and print the output format of the loaded document file . Printing processing is actually executed by the printing application (despooler) . The printing application (despooler)  which has received a printing command from the printing control application  inputs data to the graphic engine  in a predetermined format such as a GDI function in accordance with the output format set by the printing control application . The graphic engine  converts the input data of the GDI function format into a DDI function, and outputs the DDI function to the printer driver . The printer driver  generates a printer control command in the page description language or the like on the basis of the DDI function acquired from the graphic engine , and outputs the command to the printer  via the system spooler .","<Data Format of Permanent File>","Before a detailed description of the printing control application , the data format of the document file will be described. The document file contains data of each original page (data of each page generated by an application: to be also referred to as a logical page) as content data, and data of a job ticket format as printing setting data. An editing information file for changing setting of printing setting information contained in the document file is also stored by a printing control application (to be described later) together with the document file. In the document file, original page data of the PDF format and data of the job ticket format are intermediate data.","In the document file, original page data is defined by the PDF format or the like, and contains designation of the character font and color, and layout information of characters, figures, and the like within an original page.","The job ticket serving as a document file is data having a structure whose minimum unit is an original page. The structure of the job ticket defines the layout of an original page on a paper sheet. One job ticket corresponds to one printing job. The node of the whole document is set at the top of the structure, and defines the attribute of the whole document such as double-sided printing\/single-sided printing. This node is accompanied with a document structure and information representing setting of each building component. More specifically, a sheet bundle node belongs to the document node, and contains attributes such as the identifier of paper for use and designation of a feed port in the printer. The node of a sheet contained in the sheet bundle belongs to each sheet bundle node. One sheet corresponds to one paper sheet. A printing page (physical page) belongs to each sheet. One physical page belongs to one sheet in single-sided printing, and two physical pages belong to one sheet in double-sided printing. An original page to be laid out on a physical page belongs to the physical page. The physical page attribute contains an original page layout. An original page contains association information (link information) to original page data which is the entity of the original page.","Settings of the whole document include pieces of following information.\n\n","As for printing settings of each sheet bundle, the following parameters can be set.\n\n","As for printing settings of each sheet belonging to each sheet bundle, the following parameter can be set.\n\n","As for printing settings of each physical page (plane) belonging to each sheet, the following parameters can be set.\n\n","As for printing settings of each original page laid out on each physical page, the following parameters can be set.\n\n","In this manner, the job ticket is data having a hierarchical structure whose minimum unit is an original page. Most of printing settings defined by the job ticket are common on each layer set for each document, but some printing settings such as N-up setting and color type are common between layers. In principle, as for a common setting, a lower layer inherits the same setting value as that of an upper layer. When an attribute common between layers has different values, a value set for a layer of interest is used as the value of the attribute. For example, the color type can be set for a whole document, sheet bundle (set of sheets), and physical page (to be also referred to as a plane or printing page). The color type is a setting which designates a mode in the printing apparatus. Printing data is generated such that, if the monochrome mode is set, the printing apparatus prints in monochrome; if the color mode is set, prints in color.","<Document Structure Managed by Editing Information File>","The printing control application  is a program which provides a user interface for causing the user to designate data contained in a document file by various methods and change printing settings. The document file is a file having the above-described structure. The printing control application  manages the above-mentioned editing information file in correspondence with the document file in order to manage the document file. Based on editing information contained in the editing information file, the printing control application  manages a document with a management structure independent of a document defined by, e.g., a job ticket. The management structure is a hierarchical structure similar to the job ticket, but is formed by layers \u201cbook\u201d, \u201cchapter\u201d, and \u201coriginal (logical) page\u201d from the top, unlike the job ticket. Of these layers, the original page corresponds to the original page of the job ticket. The chapter corresponds to the sheet bundle (set of sheets).","A virtual file displayed as a user interface is not a file which is permanently saved and managed, unlike the document file , but is temporarily created for a user interface when the user changes the printing settings of the document file or designates printing by using the printing control application . The printing control application  opens the document file  together with a corresponding editing information file , creates a virtual book file having a structure defined by editing information from the document file, and displays the book file as a user interface. When the user changes printing settings while referring to the book file via the user interface, the settings are reflected in the editing information file.","A book file temporarily created by the printing control application, i.e., a data format defined by the editing information file will be explained.","The book file has a three-layered structure similar to a paper-medium book. The upper layer is called a \u201cbook\u201d, resembles one book, and defines the attributes of the entire book. The intermediate layer corresponds to a chapter in the book, and is also called a \u201cchapter\u201d. As for each chapter, its attributes can be defined. The lower layer is a \u201cpage\u201d, and corresponds to each original page (i.e., logical page) defined by an application program. As for each original page, its attributes can be defined. One book may include a plurality of chapters, and one chapter may include a plurality of original pages. In the following description, an original page will be simply called a page.",{"@attributes":{"id":"p-0086","num":"0106"},"figref":["FIG. 16A","FIG. 16A"],"b":"303"},"In , a book  defines a book attribute, and is linked to two chapters A and B. These links display that the chapters A and B are included in the book . The chapter A is linked to original pages A and B, which represents that these original pages are included in the chapter A. The original pages A and B define attribute values, and contain links to original page data (1) and (2) serving as entities. These links correspond to data (1) and (2) of original page data  contained in the document file  shown in , and display that the entities of the pages A and B are original page data (1) and (2).",{"@attributes":{"id":"p-0088","num":"0108"},"figref":["FIGS. 17A and 17B","FIGS. 17A and 17B"]},{"@attributes":{"id":"p-0089","num":"0109"},"figref":["FIG. 18","FIG. 19"]},"Items unique to book attributes are six items: printing method, details of bookbinding, front\/back cover, index sheet, slip sheet, and chaptering. These items are defined over the book. As the printing method setting, three values: single-sided printing, double-sided printing, and bookbinding printing can be designated. Bookbinding printing is a method of printing data in a format which allows bookbinding by bundling a separately designated number of paper sheets, folding the bundle into two, and binding the bundle. As the detailed bookbinding setting, the opening direction and the number of paper sheets to be bundled can be designated when bookbinding printing is designated. The front\/back cover setting includes designation of adding paper sheets serving as front and back covers when original page data combined as a book are printed. The index sheet setting and slip sheet setting are settings for inserting an index sheet and slip sheet in a printing apparatus for chaptering. The chaptering setting includes designation of whether to use a new paper sheet, use a new printing page, or do nothing particular at a chapter break.","As for the chapter attribute, there is no item unique to the chapter, and all items overlap those of the book attribute. If the definition of the chapter attribute is different from that of the book attribute, a value defined by the chapter attribute precedes. Items common to only the book and chapter attributes are five items: paper size, paper direction, N-up printing designation, enlargement\/reduction, and delivery method.","N-up printing designation is an item for designating the number of original pages included in one printing page. Layouts which can be designated are 1\u00d71, 1\u00d72, 2\u00d72, 3\u00d73, 4\u00d74, and the like. The delivery method attribute is an item for designating whether to staple discharged paper sheets. The effectiveness of this attribute depends on whether the printing apparatus has a stapling function.","Items unique to the page attribute are page rotation setting, zoom, layout designation, annotation, and page division. The page rotation setting is an item for designating the rotation angle when an original page is laid out on a printing page. The zoom setting is an item for designating the zoom ratio of an original page. The zoom ratio setting is designated on the basis of a virtual logical page region size=100%. The virtual logical page region is a region occupied by one original page when original pages are laid out in accordance with N-up designation or the like.","Attributes common to the book, chapter, and page are a watermark attribute, header\/footer attribute, and color type. The watermark is a separately designated image or character string printed over data created by an application. The header and footer are watermarks printed at the upper and lower margins of each page. The color type is a setting which designates the mode of the printing apparatus. Printing data is generated such that, if the monochrome mode is set, the printing apparatus prints in monochrome; if the color mode is set, prints in color.","Each printing setting item also includes a flag representing \u201cexceptional setting\u201d when a chapter or original page has a setting different from that of a book (document).","<Generation Sequence of Editing Information File>","The editing information file has the above-described structure and contents. A sequence of creating an-editing information file by the printing control application  and printing data save driver  will be explained. Creation of an editing information file is realized as part of editing operation of an editing information file by the printing control application .  shows a sequence when the printing control application  opens an editing information file.","Whether an editing information file to be opened is one to be newly created or an existing one is determined (step S). If YES in step S, an editing information file including no chapter is newly created (step S). In the example shown in , the newly created editing information file is a book node which has only the book node  without any link to a chapter node. As the book attribute, a set of attributes prepared in advance for creation of a new editing information file are applied. A UI (User Interface) window for editing the new editing information file is displayed (step S). In the UI window upon newly creating an editing information file, a UI window  in  has no content.","If NO in step S, a designated editing information file is opened (step S), and data are rasterized in accordance with the structure, attributes, and contents of the editing information file to display a UI (User Interface) window. Data mapped in the RAM  also takes the same structure as that in . Attributes included in the node of each layer are also mapped in the RAM  in the format shown in . For example, the structure of these attribute items can be realized with a pointer or the like, and each item at the attribute can be identified by the identifier of the item or the like.  shows an example of the UI window. The UI window  has a tree portion  representing a book structure, and a preview portion  displaying a state to be printed. The tree portion  displays chapters included in the book and pages included in each chapter by a tree structure as shown in . Pages displayed at the tree portion  are original pages. The preview portion  displays reduced printing page contents. The display order reflects the book structure.","Original page data of an intermediate format can be added as a new chapter to the open editing information file by the printing data save driver . This function is called an import function. Application data is imported to the editing information file newly created by the sequence of , and the original page data is made to belong to the chapter of the editing information file, thereby giving an entity to the editing information file. This function is activated by drag-and-drop operation of application data to the window of .  shows an import processing sequence.","An application program which has generated designated application data is activated. The printing data save driver  is designated as a device driver, and application data is printed out to convert the data into data of an intermediate format (e.g., PDF format) (step S). After conversion, whether the converted data is image data is determined (step S). This determination can be done on the basis of the file extension of application data under the Windows\u00ae OS. For example, an extension \u201cbmp\u201d represents Windows\u00ae bitmap data; \u201cjpg\u201d, jpeg-compressed image data; and \u201ctiff\u201d, tiff-format image data.","If NO in step S, the intermediate data generated in step S is added as a new chapter to the book of a currently open editing information file (step S). That is, a new chapter and new original pages belonging to this chapter are added by import. Link information to the entity of an original page is written at each page node. The entity of the original page is generated by the printing data save driver .","In import, as for chapter attributes which are common to book attributes, the values of the book attributes are copied. As for unique chapter attributes, predetermined values are set. Chapter attributes which are common to those of the whole document of the document file inherit the values of the attributes of the documents.","If YES in step S, no new chapter is added in principle, and image data is added to a designated chapter by using one file as one original page (step S). For an empty file in which an editing information file is newly created, a new chapter is created, and image data is added as an original page belonging to the chapter. As for the page attribute, attributes common to the attributes of an upper layer are given the attribute values of the upper layer, and attributes which are defined in application data and inherited to the document file are given values defined in the application data. For example, when N-up designation is defined in application data, the page inherits this attribute value. In this way, a new editing information file is created, or a new chapter is added.","As for a document file, added original page data is newly added and saved if data generated by the printing data save driver is an addition to an existing document file. At this time, if printing settings designated by an application are reflected in data generated by the printing data save driver, the printing settings can also be reflected in the document file.",{"@attributes":{"id":"p-0105","num":"0125"},"figref":["FIG. 22","FIG. 21","FIG. 16A","FIG. 16B"],"b":["302","801","901","302","302","902","901","903","903","904","302"]},"<Editing of Editing Information File>","As described above, an editing information file can be created from application data. The chapter and page of the generated editing information file can be edited as follows.\n\n","The color mode setting can also be changed for a book. In addition, an operation of canceling executed editing operation, and an operation of restoring canceled operation can be performed. These editing functions enable editing operations such as consolidation of a plurality of editing information files, rearrangement of chapters and pages within an editing information file, delete of chapters and pages within an editing information file, layout change of an original page, and insertion of a slip sheet and index sheet. By these operations, operation results are reflected in attributes shown in  or on an editing information file structure. For example, a blank page is inserted into a designated portion by an operation of newly adding a blank page. The blank page is processed as an original page. If the layout of an original page is changed, the change contents are reflected in attributes such as the printing method, N-up printing, front\/back cover, index sheet, slip sheet, and chaptering.","<Output of Editing Information File>","The ultimate goal of an editing information file created and edited in the above manner is to print it out. If the user selects a file menu from the UI window  of the printing control application shown in  and selects printing from this menu, the editing information file is then printed out by a designated output device. At this time, the printing control application  creates a despool table from a currently open editing information file and corresponding document file (e.g., job ticket), and transfers the despool table to the despooler . This sequence will be described in detail. The despooler  converts the document file into an OS output command, e.g., a Windows GDI command, and transmits the command to a GDI serving as a graphic engine. The graphic engine  generates a command complying with a device by a designated printer driver , and transmits the command to the device.","<Processing Sequence by Printing Control Application>",{"@attributes":{"id":"p-0109","num":"0142"},"figref":["FIGS. 5 to 15","FIGS. 5 to 15"],"b":["304","305"]},{"@attributes":{"id":"p-0110","num":"0143"},"figref":["FIGS. 5 and 6","FIGS. 7 and 8","FIG. 9","FIGS. 10 to 13","FIG. 9"],"b":["304","305","304"]},"The printing control application  can newly create an editing information file in the above-described fashion, or designate and open an existing editing information file. An editing information file mapped in the memory will be called editing information data. In mapping, the window in  is displayed on the basis of the editing information file and document file.","In , if the user selects a \u201cprint format\u201d column , a popup menu including columns \u201cdetailed settings of document\u201d, \u201cdetailed settings of chapter\u201d,and \u201cdetailed settings of page\u201d is displayed. In these columns, the attributes of a whole document, chapter, and original page can be set.  show user interface windows displayed when \u201cdetailed settings of document\u201d, \u201cdetailed settings of chapter\u201d, and \u201cdetailed settings of page\u201d are designated from the popup menu. Exceptional setting check boxes  and  for defining settings different from those of a document are prepared for a chapter and original page. When the check box is checked, monochrome\/color setting can be selected as an exceptional setting. If the user checks the exceptional setting check box, a flag representing \u201cexceptional setting\u201d is set and stored as part of editing information data. If the exceptional setting is checked, a full-color\/monochrome radio button can be designated. As for a whole document (book), automatic full-color\/monochrome switching can be selected (see ). If the user designates the exceptional setting check box and radio button of full color or monochrome, a value corresponding to the exceptional setting flag and designated button is set as data of the editing information file mapped in the RAM , i.e., as the value of the \u201ccolor type\u201d item for the book attribute (), chapter attribute (), and page attribute () in .","The user can designate color\/monochrome setting on the user interface window of  for each book, chapter, or page.","If a \u201cfile\u201d column  in  is selected, a popup menu including a \u201cprint\u201d column is displayed. If \u201cprint\u201d is designated, the window in  is displayed. If an OK button  is clicked in , this signal is sent as a printing instruction to start outputting printing data.",{"@attributes":{"id":"p-0115","num":"0148"},"figref":["FIG. 5","FIG. 5"],"b":"304"},"In , if the user inputs an instruction through any UI, determination processing of whether the instruction is a printing instruction is performed in step . Assume that the user inputs a printing instruction through the UIs shown in . Despool table creation processing  including color\/monochrome designation (color type) is then executed. The despool table has a structure as shown in , and is a table which designates printing information to the printing application. In step , a despool table including color\/monochrome designation is created.",{"@attributes":{"id":"p-0117","num":"0150"},"figref":["FIG. 14","FIG. 14"],"b":["102","1400","1410","1420","1411","1412","1413","1411"],"i":"a "},"In step , printing instruction processing to the printing application (despooler)  is done. In this processing, the printing application (despooler) is instructed to print in accordance with the contents of the despool table. The printing control application  transfers to the printing application  original page data to be printed and data which specifies a physical page for specifying a plane subjected to printing, and causes the printing application  to convert the data into the parameter of the GDI function.","In processing of step , a despool table is created, and color\/monochrome information is written as the item value of the color type in accordance with designation through the UI windows in .  shows a processing sequence of mapping a despool table and then setting again the color type as one of printing settings on the basis of designation in the printing control application .","In , editing information data set through the UI is referred to. Determination processing  of checking the attribute of the original-page node of the editing information data, and determining whether color setting has been done as an exceptional page setting within each sheet (paper sheet) and a logical page is included is executed. The printing control application can perform color setting of each page as an exceptional setting in detailed settings of a page through the UI shown in . In step , a page having color setting as an exceptional setting of a logical page is determined. This setting is a setting to a logical page, and the settings in the despool table are designated on a physical page in accordance with the device specifications. Even if a given logical page has monochrome designation, whether another logical page included in the same physical page as that of the target logical page has full-color setting as an exceptional setting must be determined. In double-sided printing, whether a back surface has full-color setting is determined. After that, whether the paper sheet has full-color setting as an exceptional page setting can be determined. The correspondence between a logical page and a sheet on which the logical page is laid out can be determined by looking up the despool table or job ticket. If the full color has been set as an exceptional page setting in step , the processing branches to step . In step , \u201cfull color\u201d is written as the color type of the printing setting in the despool table for respective sheets which include all logical pages having full-color setting as an exceptional page setting.","If NO in step , determination processing  of whether the target paper sheet has monochrome setting as an exceptional page setting is executed. Similar to step , whether exceptional monochrome setting has been done is determined. If YES in step , write processing  of monochrome information in the despool table is executed without performing subsequent determination processing. In step , \u201cmonochrome\u201d is written as the color type in the despool table for respective sheets which include all logical pages having this exceptional page setting.","If NO in step , determination processing  of whether color setting has been done as an exceptional chapter setting is executed. Similar to an original page, the printing control application can perform color setting of each chapter in detailed settings of a chapter through the UI shown in . Color setting is determined even if no color setting is determined in determination processing  of whether color setting has been done as an exceptional page setting within a paper sheet, but no monochrome setting has been done as an exceptional page setting, and color setting has been done in chapter setting. If full-color setting has been done as an exceptional chapter setting, the processing branches to step . In step , \u201cfull color\u201d is written as the color type of the printing setting in the despool table for respective sheet bundles (sets of sheets) corresponding to all chapters having full-color setting as an exceptional chapter setting.","If NO in step , determination processing  of whether monochrome setting has been done as an exceptional chapter setting is executed. Whether the chapter has exceptional monochrome setting is similarly determined. If YES in step , write processing  of monochrome information in the despool table is executed without performing subsequent determination processing. In step , \u201cmonochrome\u201d is written as the color type of the printing setting in the despool table for respective sheet bundles (sets of sheets) corresponding to all chapters having the exceptional chapter setting \u201cmonochrome\u201d.","If NO in step , determination processing of whether color setting has been done in detailed settings of a document is executed. If no exceptional setting of a page or chapter exists, color\/monochrome setting is written for the first time in accordance with detailed settings of a document. This is achieved by write processing  of color information in the despool table or write processing  of monochrome information in the despool table. In this case, the color type in the printing settings of the document is written.",{"@attributes":{"id":"p-0125","num":"0158"},"figref":["FIG. 15","FIG. 15","FIG. 15"],"b":["1510","1520"]},"The despool table created by the above sequence is transferred to the printing application together with data of each original page and designation of a printing range.","<Processing Sequence by Printing Application>","An operation when the printing application (despooler)  receives printing instruction processing from the printing control application will be explained.","Despool table loading processing  is performed. In this processing, the despool table created by the sequences of  is loaded to the printing application (despooler) . Printing settings effective for a whole document, printing settings effective for a set of sheets, printing settings effective for a sheet, and printing settings effective for a physical page are sequentially loaded. After loading, these printing settings are held, and attention is sequentially given to physical pages (printing pages) represented by the despool table to perform processes in step  and subsequent steps. Together with the despool table, the printing application  receives information for specifying physical pages in the printing range from the printing control application. This information is obtained by converting pages designated by the user via the user interface of the printing control application  into physical pages. Pages can be easily converted from correspondence between sheet bundles, sheets, physical pages, chapters, and logical pages.","In , a color\/monochrome printing instruction (color type) is included in loaded printing settings effective for a set of sheets. In determination processing , a color type set for a whole document, each set of sheets, or each physical page is determined for a physical page of interest. In step , if the physical page of interest is determined to have a full-color instruction, the next color command transmission preparation processing  is executed. A full-color instruction to the physical page of interest means that the physical page of interest has full-dolor setting, or a sheet bundle including the physical page of interest or the whole document has full-color setting. If the physical page of interest does not have any color instruction, the processing branches to step .","Color command transmission preparation processing  is performed prior to subsequent printing mode command transmission processing . Processing  is executed by a sequence shown in . Monochrome command transmission preparation processing  is also performed prior to subsequent printing mode command transmission processing . Processing  is also executed by the sequence shown in .","In , performance acquisition processing  of acquiring performance information of a device, e.g., printer is performed. Since the device may not cope with a change of the printing mode, the device is inquired whether it copes with printing mode change processing. That is, the printer is inquired whether it can process in one job a printing mode change command for changing the printing mode. This also applies to a device which cannot print in color. Processing  is executed through the printer driver. When the printer driver or OS holds device function information, this determination can also be achieved by referring to the function information.","After that, determination processing  of whether the device for use copes with the printing mode change command is executed by referring to the acquired performance information. If the device is determined in determination processing  to be able to cope with a change of the printing mode, a printing mode change command including a color command or monochrome command is created for the physical page of interest. If this processing is executed in step , data for creating a printing instruction including a printing mode change command (color command) which designates a change of the color mode to \u201cfull color\u201d is created in step .","If the processing is executed in step , data for creating a printing instruction including a printing mode change command (monochrome command) which designates a change of the color mode to \u201cmonochrome\u201d is created.","The printing instruction is a structure which is designated by the application to the device via the graphic engine and driver. This printing instruction also depends on the device, and is created by the graphic engine  via the driver . For this purpose, in steps  and , the printing application  creates data to be processed by the graphic engine . The created data is identical to data created by the application program which prints via the graphic engine. That is, the printing application has a data format in which a page designated as a printing target by the printing control application and the printing settings of the page are transferred to the graphic engine.","The processing returns to step  to invoke the graphic engine  to create a printing instruction.","The GDI serving as a Windows\u00ae graphic engine manages image information processing for a display card or printer. The GDI dynamically links a module called a device driver in order to absorb dependency of each device such as a display card or printer, and performs output processing to the device. A device driver for the printer is the printer driver . The printer driver  has a basic function group called DDI (Device Driver Interface) which is determined to be installed in the device driver in advance in accordance with the performance and function. The GDI converts an API (Application Programming Interface) call by the printing application into device driver data. The DDI function group is properly called by the GDI to generate the above-mentioned printing instruction, and this instruction is transmitted to the printer  via the system spooler . The GDI sequentially processes a printing request from the printing application  via the printer driver. When the printer  is equipped with a controller capable of processing a printing mode command called PDL (Printer Description Language), the printer driver  performs processing of replacing drawing information having a high degree of abstraction with the PDL. This printing mode command includes a color command or monochrome command.","In steps  and , processing of creating data to be processed by the graphic engine  is executed. In step , processing is achieved by the GDI.","Whether the page of interest is the final physical page to be printed is determined in step . If NO in step , the page of interest shifts to the next page (), and the processing is repeated from step .","The printing mode command created by the graphic engine  and printer driver  is output from the printer driver , and temporarily held by the spooler . The printing mode command is then transmitted from the spooler  to the printer  asynchronously to printing mode command generation processing. In this processing, a printing instruction is transmitted to the device.","If a color command or monochrome command is transmitted, the printer  changes the color mode in accordance with the command, and performs actual image formation processing.","With this arrangement, the printing system according to the first embodiment can provide a mechanism capable of designating color printing or monochrome printing for a page desired by the user in a document of pages that is created by an application, and performing printing processing designated by the user.","More specifically, the printing control application performs an exceptional color\/monochrome setting for each page or chapter. The color\/monochrome printing mode in the printer can be switched for each page or chapter during one output operation.","A page to be printed in monochrome can be printed in monochrome, saving the expandable and charging of the page. Further, arrangement of printouts or the like can also be achieved using an optional function of the printer.","<Printer Arrangement>",{"@attributes":{"id":"p-0144","num":"0177"},"figref":"FIG. 4","b":"500"},"This printer forms an electrostatic latent image by scanning a photosensitive drum  with a laser beam which is modulated by image data of each color obtained on the basis of printing data input from the host computer . The electrostatic latent image is developed with toner to obtain a visible image. Visible images for all colors are transferred to an intermediate transfer-member  to form a color visible image. The color visible image is transferred to a transfer medium  to fix the image onto the transfer medium . An image forming section which performs this control comprises a drum unit having the photosensitive drum , a primary electrification section having a charged contact roller , a cleaning section, a developing section, a sheet feed section which includes the intermediate transfer member , a sheet cassette , and various rollers , , , and , a transfer section which includes a transfer roller , and a fixing section .","A drum unit  is constituted by integrating the photosensitive drum (photosensitive member) , and a cleaner vessel  having a cleaning mechanism also serving as the holder of the photosensitive drum . The drum unit  is detachably supported by the printer main body, and can be replaced in accordance with the service life of the photosensitive drum . The photosensitive drum  is formed by coating the outer surface of an aluminum cylinder with an organic photoconductive layer, and rotatably supported by the cleaner vessel . The photosensitive drum  is rotated by transmitting the driving force of a driving motor (not shown). The driving motor rotates the photosensitive drum  counterclockwise in accordance with image forming operation. The surface of the photosensitive drum  is selectively exposed to form an electrostatic latent image. In a scanner section , a modulated laser beam is reflected by a polygon mirror which is rotated by a motor in synchronism with the horizontal sync signal of an image signal, and the photosensitive drum is irradiated with the laser beam via a lens  and reflecting mirror .","The developing section comprises three color developing units Y, M, and C which develop images in yellow (Y), magenta (M), and cyan (C), and one black developing unit B which develops an image in black (B). The color developing units Y, M, and C and the black developing unit B respectively comprise sleeves YS, MS, CS, and BS, and spreading blades YB, MB, CB, and BB which are respectively pressed against the outer surfaces of the sleeves YS, OMS, CS, and BS. The three color developing units Y, M, and C comprise spreading rollers YR, MR, and CR.","The black developing unit B is detachably attached to the printer main body. The color developing units Y, M, and C are detachably attached to a developing rotary  which rotates by using a rotation shaft  as a center.","The sleeve BS of the black developing unit B is spaced apart from the photosensitive drum  at a small interval of, e.g., about 300 \u03bcm. The black developing unit B supplies toner by an internal supply member, and electrifies toner by triboelectrification so as to apply toner by the spreading blade BB to the outer surface of the sleeve BS which rotates clockwise. A developing bias is applied to the sleeve BS to develop an electrostatic latent image on the photosensitive drum , thus forming a visible image with black toner on the photosensitive drum .","In forming an image, the three color developing units Y, M, and C rotate along with rotation of the developing rotary . The predetermined sleeves YS, OMS, and CS face the photosensitive drum  at a small interval of about 300 \u03bcm. The predetermined color developing units Y, M, and C stop at a developing position where they face the photosensitive drum , and visible images on the photosensitive drum .","In forming a color image, the developing rotary  rotates every rotation of the intermediate transfer member , and the developing step is done in order of the yellow developing unit Y, magenta developing unit M, cyan developing unit C, and black developing unit B. The intermediate transfer member  rotates four times to sequentially form visible images with yellow, magenta, cyan, and black toners. As a result, a full-color visible image is formed on the intermediate transfer member .","The intermediate transfer member  is so constituted as to rotate along with rotation of the photosensitive drum  in contact with the photosensitive drum . In forming a color image, the intermediate transfer member  rotates clockwise to receive multiple transfer of four visible images from the photosensitive drum . In forming an image, the transfer roller  (to be described later) is brought into contact with the intermediate transfer member , the transfer medium  is clamped and conveyed, and multiple color visible images on the intermediate transfer member  are simultaneously transferred to the transfer medium . A TOP sensor and RS sensor for detecting the position of the intermediate transfer member  in the rotational direction, and a density sensor for detecting the density of a toner image transferred onto the intermediate transfer member are arranged on the outer surface of the intermediate transfer member .","The transfer roller  comprises a transfer charger which is so supported as to be brought into contact with or separated from the photosensitive drum . The transfer roller  is formed by winding a middle-resistance foamed elastic member on a metal axis.","As represented by the solid line in , the transfer roller  is separated down so as not to disturb a color visible image while multiple color visible images are transferred onto the intermediate transfer member . After color visible images in the four colors are formed on the intermediate transfer member , the transfer roller  is positioned upward, as represented by the dotted line in , by a cam member (not shown) in synchronism with the timing at which the color visible images are transferred onto the transfer medium . The transfer roller  is pressed against the intermediate transfer member  at a predetermined press force via the transfer medium . At the same time, a bias voltage is applied to transfer the color visible images on the intermediate transfer member  onto the transfer medium .","The fixing section  fixes the transferred color visible image while the transfer medium  is conveyed. The fixing section  comprises a fixing roller  which heats the transfer medium , and a press roller  which brings the transfer medium  into press contact with the fixing roller . The fixing roller  and press roller  are hollow, and incorporate heaters  and . That is, the transfer medium  bearing the color visible image is conveyed by the fixing roller  and press roller , and the toner is fixed onto the surface of the transfer medium  by applying heat and the pressure.","The transfer medium  on which the visible image is fixed is discharged to a delivery section  by delivery rollers , , and , thereby ending image forming operation.","The cleaning means cleans the toner left on the photosensitive drum  and intermediate transfer member . Waste toner after a visible toner image formed on the photosensitive drum  is transferred to the intermediate transfer member , or waste toner after color visible images in four colors formed on the intermediate transfer member  are transferred to the transfer medium  is stored in the cleaner vessel .","A transfer medium (printing sheet)  subjected to printing is picked up from the sheet cassette  by the pickup roller , and so conveyed as to be sandwiched between the intermediate -transfer member  and the transfer roller . A color toner image is printed on the transfer medium , and the transfer medium  passes through the fixing section  to fix the toner image. In single-sided printing, a guide  forms a convey path so as to guide a printing sheet to the upper delivery section. In double-sided printing, the guide  forms a path so as to guide a printing sheet to a lower double-sided printing unit.","A printing sheet guided to the double-sided printing unit is temporarily fed below the tray  (convey path represented by a chain double-dashed line) by a convey roller , then conveyed in an opposite direction, and fed to a double-sided printing tray . The sheet is turned upside down from the state on the sheet cassette  on the double-sided printing tray , and the convey direction is reversed. In this state, a toner image is transferred and fixed again to realize double-sided printing","As another embodiment, data may be transmitted from an application to a device without the mediacy of any graphic engine. In this case, the printer driver is directly instructed to issue a command without performing color command transmission preparation processing  or monochrome command transmission preparation processing . The printing application is different from that in the first embodiment in that data is created in accordance with not the graphic engine but the printer driver interface and the printer driver invokes a prepared function.","The present invention may be applied to a system including a plurality of devices. (e.g., a host computer, interface device, reader, and printer) or an apparatus (e.g., a copying machine, printer, or facsimile apparatus) formed from a single device.","The present invention can be summarized into the following arrangement.","(1) An information processing apparatus having a generation function of generating printing data to be transmitted to a printer comprises","a save unit which saves printing data of each original page in an intermediate format together with printing setting data,","a printing controller which causes the user to change a printing setting and issue a printing instruction, and","a printing data reading unit which reads out the printing setting data from the save unit in accordance with the printing instruction, changes the color mode setting of the read printing setting data in accordance with the color mode setting in the printer that is changed by the printing controller, and generates by using the generation function the printing data containing an instruction of changing the color mode on the basis of the printing setting data.","(2) In (1), the printing setting changed by the printing controller includes the color mode setting of each original page in the printer, and the printing data reading unit changes the color mode setting of the read printing setting data for each printing medium including the original page whose printing setting has been changed.","(3) In (1), the printing setting changed by the printing controller includes the color mode setting of each chapter formed by a plurality of original pages in the printer, and the printing data reading unit changes the color mode setting of the read printing setting data for a set of printing media corresponding to the chapter whose printing setting has been changed.","(4) In (1), the printing data reading unit determines whether the printer copes with a change of the color mode before the printing data containing the instruction of changing the color mode is generated by using the generation function, when the printer copes with the change, generates, by using the generation function, printing data containing the instruction of changing the color mode, and when the printer does not cope with the change, generates; by using the generation function, printing data containing no instruction of changing the color mode.","(5) In (1), the printing data reading unit determines whether the printing setting changed by the printing controller includes the color mode setting of each original page in the printer, when the printing setting includes the color mode setting of each original page, changes the color mode setting of the read printing setting data for each printing medium including the original page whose printing setting has been changed, when the printing setting does not include the color mode setting of each original page, determines whether the printing setting includes the color mode setting of each chapter formed by a plurality of original pages in the printer, when the printing setting includes the color mode setting of each chapter, changes the color mode setting of the read printing setting data for a set of printing media corresponding to the chapter whose printing setting has been changed, and when the printing setting does not include the color mode setting of each chapter, changes the color mode setting of the whole printing data in the printer.","(6) The present invention also includes a method corresponding to any one of (1) to (5).","(7) The present invention also includes a computer program for executing a printing control method using a generation function of generating printing data to be transmitted to a printer, wherein the computer program executes","a save step of saving printing data of each original page in an intermediate format together with printing setting data,","a printing control step of causing the user to change a printing setting and issue a printing instruction, and","a printing data reading step of reading out the printing setting data in the save step in accordance with the printing instruction, changing the color mode setting of the read printing setting data in accordance with the color mode setting in the printer that is changed in the printing control step, and generating by using the generation function the printing data containing an instruction of changing the color mode on the basis of the printing setting data.","(8) The present invention also includes an information processing apparatus having a generation function of generating printing data to be transmitted to a printer, comprising","a spooler which stores a document file containing printing setting data and printing data of each original page in an intermediate format,","a printing control application which provides the user with an operation window which is mapped from the document file in order to change a printing setting and issue a printing instruction, and","a despooler which reads out the printing setting data from the spooler in accordance with the printing instruction, changes the color mode setting of the read printing setting data in accordance with the color mode setting in the printer that is changed by the printing control application, and generates by using the generation function the printing data containing an instruction of changing the color mode on the basis of the printing setting data.","The object of the present invention is also achieved when a storage medium which stores software program codes for realizing the functions of the above-described embodiments are read out and executed by the computer (or the CPU or MPU) of a system or apparatus.","In this case, the program codes read out from the storage medium realize the functions of the above-described embodiments, and the storage medium which stores the program codes constitutes the present invention.","The storage medium for supplying the program codes includes a flexible disk, hard disk, optical disk, magnetooptical disk, CD-ROM, CD-R, magnetic tape, nonvolatile memory card, and ROM.","The functions of the above-described embodiments are realized when the computer executes the readout program codes. Also, the functions of the above-described embodiments are realized when an OS (Operating System) or the like running on the computer performs part or all of actual processing on the basis of the instructions of the program codes.","Furthermore, the present invention includes a case where, after the program codes read out from the storage medium are written in the memory of a function expansion board inserted into the computer or the memory of a function expansion unit connected to the computer, the CPU of the function expansion board or function expansion unit performs part or all of actual processing on the basis of the instructions of the program codes and thereby realizes the functions of the above-described embodiments.","As has been described above, the present invention can provide a mechanism capable of designating color printing or monochrome printing in a printer in accordance with settings desired by the user for a document of pages that is created by an application, and performing printing processing designated by the user.","More specifically, color\/monochrome exceptional setting for each page or chapter is done by a printing control application. The color\/monochrome printing mode in the printer can be switched for each page or chapter in one output operation.","A page to be printed in monochrome can be printed in monochrome, saving the expandable and charging of the page. Arrangement of printouts or the like can also be achieved using an optional function of the printer.","The present invention is not limited to the above embodiments and various changes and modifications can be made within the spirit and scope of the present invention. Therefore, to apprise the public of the scope of the present invention, the following claims are made."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate embodiments of the invention and, together with the description, serve to explain the principles of the invention.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIGS. 16A and 16B"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIGS. 17A and 17B"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 22"}]},"DETDESC":[{},{}]}
