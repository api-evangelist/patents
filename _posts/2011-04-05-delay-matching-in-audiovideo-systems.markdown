---
title: Delay matching in audio/video systems
abstract: An audio/video system comprises an audio signal processing path having an audio path delay and a video signal processing path having a video path delay. The audio path delay may be different from the video path delay. The audio path delay and/or the video path delay may change, for example because of replacement of a component within the audio signal processing path or the video signal processing path. Delay matching (synchronization) in the audio/video system comprises adjusting the audio path delay to be substantially equal to the video path delay. Matching the audio path delay to the video path delay generally includes adding delay to the signal processing path with the lesser delay.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08284310&OS=08284310&RS=08284310
owner: Sony Computer Entertainment America LLC
number: 08284310
owner_city: Foster City
owner_country: US
publication_date: 20110405
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY","DETAILED DESCRIPTION"],"p":["This application is a continuation and claims the priority benefit of U.S. patent application Ser. No. 12\/615,942 filed Nov. 10, 2009, now U.S. Pat. No. 7,920,209, which is a continuation of U.S. patent application Ser. No. 11\/165,473 filed Jun. 22, 2005, now U.S. Pat. No. 7,636,126. The disclosure of each of the aforementioned applications is incorporated herein by reference.","1. Field of the Invention","This invention relates generally to audio\/video systems and relates more particularly to delay matching in audio\/video systems.","2. Description of the Related Art","Many home theater systems today include a number of audio\/video sources connected to an audio\/video processor and a video display. For example, the audio\/video sources may include a DVD player, a satellite TV receiver, a video game console and the like, for playing content such as a movie. The content from a selected audio\/video source is decoded in the audio\/video processor to yield an audio portion and a video portion. The audio portion is decoded in the audio\/video processor and played through an audio amplifier and a number of audio speakers. The video portion is shown on the video display, which may comprise an analog format television (TV) or a digital format high-definition television (HDTV).","The audio portion and the video portion can be considered as being processed through an audio signal processing path and a video signal processing path in the home theater system. One limitation with the home theater system is that the audio signal processing path and the video signal processing path can have differing delays. For example, the audio signal processing path might have less than three frames of delay and the video signal processing path might have six or more frames of delay (generally, an analog TV has a delay of about 1\/60th of a second in the video signal processing path, in comparison with about \u215bth to \u2155th of a second of delay for a digital HDTV). In general, a digital TV has significantly more delay than an analog TV.","Differing delays between the audio signal processing path and the video signal processing path can cause the audio portion of the content and the video portion of the content to become \u201cout of sync\u201d in time (i.e., the audio lagging behind the video, or with the video delayed with respect to the audio). For example, in DVD video playback, an actor's lips may be moving out of sync with his speech, or a gunshot flash and its associated sound may not be coincident in time. As little as 1\/30th of a second of time offset between the audio and video portions can generally be detected by a viewer. In a specific example, the viewer can easily detect the actor's lips moving out of sync with his speech if the audio portion leads the video portion by about 25 milliseconds (msec) or more, or if the audio portion lags the video portion by about 80 msec or more. The time mismatch between the audio portion and the video portion can cause significant distraction and dissatisfaction to the viewer.","A system in accordance with the invention comprises an audio signal processing path configured to generate an audio stimulus, a video signal processing path configured to generate a video stimulus, a sensor, and a delay generator. The sensor is configured to detect a difference between an audio path delay of the audio signal processing path and a video path delay of the video signal processing path, based on the audio stimulus and the video stimulus. The delay generator is configured to adjust the audio path delay to be substantially equal to the video path delay. In some embodiments, the delay generator is configured to add delay into the audio signal processing path if the audio path delay is less than the video path delay, and add delay into the video signal processing path if the video path delay is less than the audio path delay.","In some embodiments, the audio signal processing path and the video signal processing path comprise a home theater system, which may comprise substitutable audio\/video components. The sensor may comprise an audio\/video camera, and may comprise a microphone and a light sensor.","A method comprises generating an audio stimulus in an audio signal processing path and a video stimulus in a video signal processing path, detecting the audio stimulus after an output of the audio signal processing path, detecting the video stimulus after an output of the video signal processing path, measuring a time offset between the detected audio stimulus and the detected video stimulus, and determining a calibration value that substantially cancels the measured time offset. The method may include prompting a user to provide the audio stimulus and the video stimulus into an audio\/video camera. The method may include adding delay to the audio signal processing path if the detected audio stimulus leads (precedes) the detected video stimulus, or adding delay to the video signal processing path if the detected video stimulus leads the detected audio stimulus.","Generally, an audio\/video system comprises an audio signal processing path having an audio path delay and a video signal processing path having a video path delay. Delay refers to a time duration between an input being presented to the audio\/video system (e.g., by content such as a movie played on a DVD player) and an output being generated by the audio\/video system (e.g., a frame of the movie displayed on a video display). The audio path delay may be different from the video path delay. The audio path delay and\/or the video path delay may change, for example because of replacement of a component within the audio signal processing path or the video signal processing path. Delay matching (i.e., synchronization) in the audio\/video system comprises adjusting the audio path delay to be substantially equal to the video path delay. Matching the audio path delay to the video path delay generally includes adding delay to the signal processing path with the lesser delay.","As described further herein, methods for delay matching may be performed manually or fully automatically. In manual matching, a user (viewer) of the audio\/video system determines whether the audio path delay matches the video path delay, and accordingly adds delay to the appropriate signal processing path to synchronize the audio path delay to the video path delay. In fully automated calibration, the audio\/video system autonomously generates an audio\/video stimulus, which stimulus is detected by one or more audio and video sensors. The audio\/video system measures the time offset between the detected audio stimulus and the detected video stimulus. The audio\/video system adds delay to the appropriate signal processing path to synchronize the audio path delay to the video path delay.","Matching the delay between the audio signal processing path and the video signal processing path may be particularly beneficial in audio\/video systems such as home theater systems, in which audio\/video components with differing delays are connected or substituted over time. For example, replacing an analog TV with a digital HDTV may necessitate matching the delay between the audio signal processing path and the video signal processing path, because the digital HDTV may include significantly more video processing and video path delay than the analog TV. Similarly, replacing purely analog speakers with wireless speakers or speakers that include other audio processing circuitry such as digital surround sound decoding may necessitate matching the delays in the audio signal processing path with respect to the video signal processing path.",{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 1","b":["100","140","100","110","115","120","125","130","110","130","130","130","152","150","151","150","152","151"]},"A video output  of the audio\/video processor  drives a video display . For example, the video output  may comprise composite video, S-video, or digital video such as High Definition Multimedia Interface (HDMI) or Digital Visual Interface (DVI) signals driving the video display . The video display  may comprise an analog TV, a digital HDTV, or other video monitor. The audio\/video processor  includes one or more audio outputs  to drive a number of audio speakers . The audio speakers  may include left and right front speakers, left and right rear speakers, and a subwoofer, for example.","Although not specifically enumerated in , the audio\/video system  includes an audio signal processing path with an audio path delay. The audio signal processing path includes audio processing circuitry within the selected audio\/video source -, the audio\/video processor , and the audio speakers . The audio path delay comprises the total delay in time between the content played by the audio\/video source - and the output of the audio speakers . The audio speakers  may contribute to the audio path delay, for example if the audio speakers  are connected to the audio\/video processor  by a wireless link, or other delay-inducing components such as digital surround sound decoding.","Similarly, the audio\/video system  includes a video signal processing path with a video path delay. The video signal processing path includes video processing circuitry within the selected audio\/video source -, the audio\/video processor , and the video display . Consequently, the video path delay comprises the total delay in time between the content played by the audio\/video source - and the output of the video display .","As described further herein, the delay matching unit  is configured to match the audio path delay with the video path delay by way of a video delay generator  and\/or an audio delay generator . The video delay generator  and the audio delay generator  may comprise configurable analog delay lines or, preferably, digital delay mechanisms. For example, the video processor  and the audio processor  of some embodiments include digital signal processing (DSP) circuitry (not shown). Based upon a determination that the video display  is lagging (delayed in time from) the sound from the audio speakers , the delay matching unit  may command the DSP circuitry to add delay into the audio signal processing path by way of the audio delay generator . Alternatively, based upon a determination that the audio speakers  are lagging (delayed in time from) the video display , the delay matching unit  may command the DSP circuitry to add delay by way of the video delay generator  into the video signal processing path.","The delay matching unit  may be \u201cupstream\u201d (before) the audio\/video processor , or may be \u201cdownstream\u201d (after) the audio\/video processor . Further, the delay matching unit  is shown as separate from the audio\/video processor  and the audio\/video sources -, but may be integrated into the audio\/video processor  or the audio\/video sources -. With the delay matching unit  integrated into the audio\/video sources -, the audio and video portions of the content from the audio\/video sources - may be directly controlled by the delay matching unit .","With the delay matching unit  as a separate unit from the audio\/video sources -, the assumption is made that the audio portion is in sync the video portion from the audio\/video sources -, or that manual matching is performed as described with respect to . Further, as described with respect to , the delay matching unit  may be configured to generate an audio\/video stimulus used to match the audio path delay and the video path delay in the audio\/video system .","As described further with respect to , the audio\/video system  includes an audio\/video sensor . The audio\/video sensor  is shown connected to the delay matching unit , but the audio\/video sensor  may be connected to other devices within the audio\/video system  such as the Karaoke player  or the PC . The audio\/video sensor  provides hardware and\/or software elements that allow the audio\/video system  to detect and \u201ctimestamp\u201d an audio\/video stimulus, by which the audio\/video system  may detect errors in synchronization of the audio signal processing path and the video signal processing path. For example, the audio\/video sensor  may comprise a microphone or other audio sensor capable of detecting an audio stimulus (e.g., a sound or tone) and determining a timestamp for the audio stimulus. The audio\/video sensor  may include a light sensitive device such as a photodiode or phototransistor, a charge-coupled device (CCD), or a CMOS image sensor for detecting and determining a timestamp for a video stimulus. Typically, the audio\/video sensor  has a predetermined relationship between the audio stimulus and its associated audio timestamp, and the video stimulus and its associated video timestamp, or may be calibrated within the system  as described further with respect to .","The audio\/video sensor  of some embodiments comprises an EyeToy\u2122 incorporating a CMOS image sensor, available from Sony Computer Entertainment America Inc. of Foster City, Calif., connected to a Sony PlayStation\u00ae2 computer entertainment system, also available from Sony. In other embodiments, the audio\/video sensor  comprises a \u201cwebcam\u201d coupled to the PC , or a camcorder coupled to the Karaoke player .","The audio\/video sensor  can be considered as able to detect the audio\/video stimulus \u201cafter\u201d the outputs of the audio signal processing path and the video signal processing path. For example, the audio\/video sensor  detects the audio stimulus after it has been projected from the audio signal processing path into the environment (e.g., as an audible sound) around the audio\/video system . Similarly, the audio\/video sensor  detects the video stimulus after it has been projected from the video signal processing path (e.g., as a visible light pattern).",{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 2","FIG. 1"],"b":["140","260","260","251","252","260"]},"The video delay generator  and the audio delay generator  may comprise configurable analog delay lines or, preferably, digital delay mechanisms. For example, the video processor  and the audio processor  of some embodiments include digital signal processing (DSP) circuitry (not shown). Based upon a determination by the viewer that the video display  is lagging (delayed in time from) the sound from the audio speakers , the viewer may move the slider  and thence command the DSP circuitry to add delay into the audio signal processing path by way of the audio delay generator . Alternatively, based upon a determination by the viewer that the audio speakers  are lagging (delayed in time from) the video display , the viewer may move the slider  and thence command the DSP circuitry to add delay by way of the video delay generator  into the video signal processing path.","The slider  for controlling the delay of the audio signal processing path with respect to the video signal processing path may be implemented in a number of ways. For example, in some embodiments, the slider  comprises a \u201cvirtual slider\u201d graphic element (not shown) displayed on the video display  which the viewer can control by use of a front panel control or remote control. The slider  can be considered to adjust to the relative delay (i.e., relative time offset or synchronization) between the audio signal processing path and the video signal processing path in the audio\/video system .",{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 3","FIG. 1"],"b":["100","310","100","100","100","110","130"]},"In still other embodiments, the audio\/video system  initiates matching based upon signals prestored on the media to be played by the audio\/video system  along with the desired content. For example, assuming audio and video outputs of the DVD player  are relatively well synchronized, the signals that initiate matching of audio and video may be stored on a DVD-ROM in the DVD player , along with the movie (content) to be played by the DVD player . The DVD-ROM may also include the actual audio and video stimuli by which the audio path delay and the video path delay are synchronized.","At step , the audio\/video system  generates an audio stimulus by way of the audio speakers  and a video stimulus by way of the video display . The audio stimulus and the video stimulus may be simultaneous, or may be offset by a predetermined time. The audio stimulus and the video stimulus may also comprise step-function, impulsive, or periodically changing signals. For example, the audio stimulus may cause a periodic change in the output of the audio speakers  from inaudible to audible, or from one tone (frequency) to a second tone, at about a 2 to 4 Hz rate. Similarly, the video stimulus may cause the video display  to change from a low intensity light output to a high intensity light output, to cycle between low and high intensity light output at about a 2 to 4 Hz rate, and\/or to change color, for example from solid green to solid red.","In some embodiments, the audio stimulus comprises a predetermined audio tone of known duration with an associated video stimulus comprising a signal to switch the video display  from bright red to bright green. For example, the audio tone may be generated and persist for approximately one-half second, during which time the video display  displays bright red. Upon the end of the audio tone, the video stimulus substantially simultaneously causes the video display  to switch to bright green. In other embodiments, the audio\/video stimulus comprises a varying intensity of light output from the video display  by switching between white and black screens, for example, in conjunction with an audio pattern such as two tones switching back-and-forth.","At step , the audio\/video sensor  detects the change in the video display  and the audio speakers  caused by the audio\/video stimulus. Although the audio\/video sensor  (e.g., the EyeToy\u2122) may face the viewer and not directly face the video display , the audio\/video sensor  can detect light reflected off the face of the viewer or other objects in the room. Reflected light detection is generally sufficient in most viewing rooms in which the viewer prefers relatively low ambient light levels. For example, the EyeToy\u2122 can generally discern a bright green screen generated by the video display  illuminating the room, because the color balance of the detected image is significantly changed with respect to a bright red screen generated by the video display  illuminating the room. Alternatively, the audio\/video sensor  may be pointed toward the video display  to directly sample the light output of the video display , which may be advantageous if the ambient light is very bright in the room, for example because of direct sunlight.","Prior to step , the audio\/video sensor  may have been programmed to provide filtering, time-gating, and\/or threshold functions to prevent false detection of the audio\/video stimulus. For example, the EyeToy\u2122 may be programmed to disable auto white balance settings to enhance color change detection.","At step , the delay matching unit  measures the time offset between the audio\/video stimulus detected at step . At step , the delay matching unit  computes a corresponding audio or video calibration value to be applied to the audio signal processing path or the video signal processing path that would substantially cancel the measured time offset.","At step , the delay matching unit  applies the computed audio or video calibration value to the audio delay generator  or the video delay generator . The calibration value substantially equalizes the delays of the audio signal processing path and the video signal processing path.","An advantage of delay matching in the audio\/video system  described with respect to  is relatively easy, low cost delay matching. For example, the delay matching mechanisms described are easily configured to operate with existing, commercially-available components.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 4","FIG. 1"],"b":["400","410","415","420","400","440","150","155","160","110","130","400","400"]},"The remote control  includes audio\/video sensors: a microphone  to detect an audio stimulus, and a light sensor  to detect a video stimulus. The light sensor  of some embodiments comprises a light-sensitive photocell configured to detect whether the video display  is lit or dark. In some embodiments, the light sensor  is configured to detect color changes in the video display .","The remote control  also includes timestamp and comparator circuitry  to measure the time difference between the detected audio stimulus and the detected video stimulus. An infrared (IR) or radio frequency (RF, e.g. Bluetooth) transceiver  in the remote control  allows communication of the measured time offset to a corresponding transceiver  in the delay matching unit . The remote control  may include filtering, time-gating, and\/or threshold circuitry to prevent false detection of the audio\/video stimulus.","Referring to the method depicted in and described with respect to , at step  the delay matching unit  of the audio\/video system  initiates delay matching of the audio signal processing path and the video signal processing path. At step , the audio\/video system  generates an audio stimulus and projects the audio stimulus into the home theater room via the audio speakers . The audio\/video system  generates a video stimulus and projects the video stimulus into the home theater room via the video display .","At step , the remote control  detects the audio\/video stimulus. The microphone  detects the audio stimulus and the light sensor  detects the video stimulus. The remote control  can be considered to be detecting the audio\/video stimulus after the outputs of the audio signal processing path and the video signal processing path. Prior to step , the remote control  may be initialized, for example to tune the remote control  to detect the particular audio\/video stimulus.","At step , the comparator circuitry  measures the time difference between the detected audio and video stimuli. The transceiver  of the remote control  communicates the measured time offset to the corresponding transceiver  in the delay matching unit .","At step , the delay matching unit  computes a corresponding audio or video calibration value to be applied to the audio signal processing path or the video signal processing path that would substantially cancel the measured time offset. At step , the delay matching unit  applies the computed audio or video calibration value to the audio delay generator  or the video delay generator . The calibration value substantially equalizes the delays in the audio signal processing path and the video signal processing path.","In an alternative embodiment, rather than the remote control  measuring the time offset between the detected audio\/video stimulus, the remote control  acts as a \u201cmirror\u201d with a predetermined delay with respect to the incoming audio\/video stimulus, and sends a mirror signal to be measured by the delay matching unit . The remote control  has a deterministic delay between the time that it detects the audio\/video stimulus and the time that it transmits the mirror signal. For example, upon detecting the audio signal generated by the audio speakers , the remote control  sends a first mirror signal to the delay matching unit  after a predetermined delay, and upon detecting the video signal generated by the video display , the remote control  sends a second mirror signal to the delay matching unit  after a predetermined delay. Comparator circuitry (not shown) in the delay matching unit  measures the time difference between the first mirror signal and the second mirror signal. The delay matching unit  computes a corresponding audio or video calibration value to be applied to the audio signal processing path or the video signal processing path that would substantially cancel the measured time offset. The delay matching unit  applies the computed audio or video calibration value to the audio delay generator  or the video delay generator  to substantially equalize the delays in the audio signal processing path and the video signal processing path.","The mirror signal may comprise an IR or RF signal to be detected by the corresponding transceiver  in the delay matching unit . Alternatively, the mirror signal may comprise an IR or visual signal (e.g., from an LED on the remote control ) to be detected by the audio\/video sensor  coupled to the delay matching unit . For example, a predetermined time after detecting the audio stimulus, the remote control  may transmit an IR signal to the delay matching unit . A predetermined time after detecting the video stimulus, the remote control may transmit a second IR signal to the delay matching unit . Comparator circuitry in the delay matching unit  measures the time between the first IR signal and the second IR signal, which time delay corresponds to the difference between the audio path delay and the video path delay. In this fashion, the remote control  acts like a mirror with a predetermined delay to signal detection of the audio stimulus and the video stimulus so that the delay matching unit  can measure the time offset between the audio and video stimuli.","An advantage of the embodiments described with respect to  is that the remote control  is typically in the \u201cline of sight\u201d of the video display , and\/or pointed at the video display , which obviates the detection of reflected light as described with respect to . Another advantage is that the remote control  is in the reference of the viewer, not at the reference of the video display , so any flight time delay in the room or reflections in the room are not included in the computation of calibration values.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 5","FIG. 1","FIG. 5"],"b":["180","180","180"]},"The method provides an event in the real world (e.g., a handclap of the user) to be sensed by the audio\/video sensor , so that any audio\/video sensor  (e.g., a camcorder or webcam) may be calibrated for use in delay matching as described herein. For example, with a webcam for the audio\/video sensor , the webcam may \u2018see\u2019 and \u2018hear\u2019 the handclap and convert the handclap into an audio signal and a video signal. The audio signal and the video signal into the PC  may include unknown delays in the video and\/or audio paths before the signals reach the PC . If the audio\/video system  measures the time at which the PC  receives the audio and video signals resulting from the handclap, the PC  may receive the audio and video signals at different times (out of synchronization). Essentially, the method of  corrects mismatch of the audio path delay and the video path delay due to the audio\/video sensor . In other words, a predetermined simultaneous audio and video event is used to calibrate the audio\/video sensor  so that the audio stimulus and the video stimulus are measured as simultaneous even if the audio\/video sensor  reports otherwise.","At step , the user of the audio\/video system  initiates audio\/video sensor  calibration, for example by selecting a menu option on a display (not shown) of the delay matching unit  or the video display . At step , the audio\/video system  prompts the viewer to generate an audio\/video stimulus. For example, the audio\/video system  may prompt the viewer to stand relatively close to the audio\/video sensor  and say \u201cHi\u201d into the audio\/video sensor . Alternatively, the audio\/video system  displays on the video display  a live image of the viewer as captured by the audio\/video sensor (e.g., the EyeToy\u2122) , and superimposes a graphic of a box on the video display  beside the image of the viewer. The audio\/video system  then prompts the viewer (e.g., by text on the video display ) to clap his hands inside the box graphic.","At step , the audio\/video sensor  detects the audio\/video stimulus, e.g., the movement of the user's lips and the corresponding speech, or the hands of the viewer entering the box on the video display  and the sound of the associated handclap. The audio\/video sensor  then generates an audio timestamp and a video timestamp for the detected audio\/video stimulus. The audio and video timestamps may be generated in a number of ways. For example, the detection of the audio stimulus may trigger sampling of a running digital counter, which yields a digital timestamp for the audio signal.","At step , the delay matching unit  measures the time offset between the detected audio stimulus and the detected video stimulus. The time offset may be computed by subtracting the lesser of the audio timestamp and the video timestamp from the greater of the audio timestamp and the video timestamp. At step , the delay matching unit  computes a corresponding audio or video calibration value that would substantially cancel the measured time offset and synchronize the audio signal processing path with the video signal processing path. For example, the calibration value may comprise a value that sets the audio path delay equal to the video path delay, with a resolution less than 1\/30th of a second. At step , the delay matching unit  applies the computed audio or video calibration value to substantially equalize the detected delays in the audio signal processing path and the video signal processing path from the audio\/video sensor .","The invention has been described above with reference to specific embodiments. It will, however, be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. For example, the audio\/video sensors may be implemented in a variety of ways, the computation of the calibration value may be performed with various methods, and the sensing, measuring, and computation functions may be implemented in other parts of the audio\/video system without departing from the scope of the invention. In a specific example, the audio\/video sensor  of  may be connected to the video game console  which is directly connected to an HDTV video display  with relatively large video path delay and to the audio speakers  via an audio amplifier with little audio path delay. The functions of the delay matching unit  and the audio\/video processor  are therefore distributed between the HDTV and the audio amplifier, but principles of the invention still apply for delay matching. In another example, a microphone connected to the Karaoke player  may be used for detecting the audio stimulus described with respect to . The foregoing description and drawings are, accordingly, to be regarded in an illustrative rather than a restrictive sense."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE FIGURES","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 3","FIG. 1"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 1"]}]},"DETDESC":[{},{}]}
