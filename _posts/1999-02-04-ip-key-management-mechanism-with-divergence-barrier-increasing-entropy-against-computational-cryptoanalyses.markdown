---
title: IP key management mechanism with divergence barrier increasing entropy against computational crypto-analyses
abstract: A key generator () generates, from an IP-key () for entering a closed IP network (), a set () of session keys () indexed for identification, an index pointer () points an index (i, j) to identify a session key (), the set () of session keys has a divergence barrier incorporated therein for barring a computational approach to any session key (), and an unbar data set (i, j, ) unbars the divergence barrier.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06917685&OS=06917685&RS=06917685
owner: Meteora System Co., Ltd.
number: 06917685
owner_city: 
owner_country: JP
publication_date: 19990204
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND ART","DISCLOSURE OF INVENTION","BEST MODE FOR CARRYING OUT THE INVENTION"],"p":["The present invention relates to an IP (internet protocol) key management mechanism for an internet security architecture.","More specifically, the invention relates to a key management mechanism for an IP-layer security, as a component mechanism of a security architecture for internets, in which a crypt-system employs an algorithm for automatic generation of session keys to support the Perfect Secrecy, i.e. a perfect forward secrecyagainst break-backward analyses and\/or a perfect backward secrecy against known-key attacks, by information-theoretically isolating the session keys from each other, without relying on computational difficulties.","For the IP-layer security of router networks, proposed protocolseach require a pair of unique encryption and decryption keys for a respective IP datagram.","A solution for the requirement may be such an automatic key generation system that derives a series of pairs of session keys from an original keying material. A respective derived pair is employable to generate a sequence of pairs of encryption and decryption keys for an extensive use of the original keying material, with a problem that a compromised secrecy of a session key permits an access to past, used keys and future, yet unused keys.","An IPSEC (Internet Protocol Security) Working Group of the IETF (International Engineering Task Force) has drafted an ISAKMP (Internet Security Association and Key Management Protocol)as a framework for key management to support a current IPSEC protocol and a subsequent IPv6 (Internet Protocol version 6), and an Oakleyas a set of key determination protocols for current use, with a postponed solution to the problem.","The ISAKMP and Oakley support the perfect forward secrecy to a practical extent.","However, in the IP-layer with a mechanism to a standard default algorithm DES(Data Encryption Standard)-CBC(Cipher Block Chaining), a conforming session key has a reduced security due to cookies transmitted on a net, and a resultant short-term security service calls for a frequent Diffie-Hellman key exchange to an extent that causes a fairly high traffic overhead via out-of-band mechanisms. The performance subjected to high overhead and the security of session keys have a trade-off relationship to each other.","The present invention has been achieved with such points in view.","It therefore is an object of the invention to provide an IP key management mechanism, in which the conventional trade-off relationship is eliminated, permitting a long-term security service of an original keying material, supporting the Perfect Secrecy of session keys, providing an IP-Inline security service free from frequent interruptions via out-of-band mechanisms.","To achieve the object, according to an aspect of the invention, there is provided a key management mechanism comprising an IP-key for entering a closed IP network, a key generator for generating from the IP-key a set of session keys indexed for identification, the set of session keys having a \u201cdivergence\u201d barrier incorporated therein for barring a computational approach to an arbitrary session key, an index pointer for pointing an index to identify a session key, and an unbar data set for unbarring the divergence barrier.","According to the aspect of the invention, a key management mechanism includes an IP key, a key generator, and an index pointer. The IP key is for entering a closed IP network. The key generator is responsive to the IP key, to generate a set of session keys employable in the network. Session keys in the generated key set are each indexed for identification, and the index pointer points an index to identify a session key used or to be used in the network, permitting a voluntary key selection to be independent of an order of key generation.","One may fetch a used session key, and try a computational approach therefrom in either or both of forward and backward senses of a temporal direction of the key selection, i.e., toward any session key that may be a past, used key or a future, yet unused key.","However, the key set has an always effective \u201cdivergence\u201d barrier, i.e. a \u201cbi-directional or universal divergent nature\u201d as a barrier, incorporated therein for barring the computational approach, whether the approach is forward and\/or backward with respect to the temporal direction of the key selection which may be wholly or partially identical to or different from the order of key generation.","Any such approach should have a practical limit, so along as it is computational. On the contrary, the barring divergence can be a voluntary setting in a mathematical field, which can by far over-range the computational limit with ease, with a sufficient allowance to absorb or eliminate the conventional trade-off relationship, permitting a long-term security service of the keying material, supporting the Perfect Secrecy of session keys, providing an IP-inline security service free from frequent interruptions via out-of-band mechanisms.","In this respect, the key management mechanism further comprises an unbar data set as a set of data for unbarring the divergence barrier, unveiling the set of session keys to associated peers, allowing the IP-inline security service for the peers.","Preferably, an arbitrary pair of session keys in the key set may be information-theoretically isolated from each other by a drop of information therebetween having a corresponding entropy difference, and the divergence barrier may develop as an integrated entropy difference along a way of the computational approach. The key generator can have a huge key space for generation of session key sets, and each key set generated can have a sufficient size for the entropy integration to diverge beyond a computationally secure entropy difference. The drop of information makes even a theoretical approach for unique solution unsuccessful in any way. The unbar data set may preferably define the drop of information between the arbitrary pair of session keys. The drop of information may preferably comprise a lost data on either or both of a sign data and a numeral data of a respective session key.","Moreover, the divergence barrier may comprise a tree of candidate keys for the arbitrary session key, the tree of candidate keys may diverge with an increasing number of candidate keys beyond a computationally secure number, as the computational approach makes a way in the key set, and the unbar data set may define a unique candidate key to be the arbitrary session key.","Further, the index pointer may preferably point the index of any session key no more than one time. It is ideal for security to use a current key simply one time. Any session key in the generated key set can be a current key, as it's index always permits a current choice by the index pointer.","Further, part of the unbar data set may preferably be built in an outer IP header as a cleartext and transmitted on networks to a communication peer for a connection-less mission of a key agreement in the IP-layer.","There will be described an IP key management mechanism according to an embodiment of the invention, with reference to the accompanying drawings. Like components are designated by like reference characters.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIGS. 1 and 2","b":["1","10"]},"The closed IP network  includes: a first internal network  having a first group of personal computers as communication peers ; a second internal network  having a second group of personal computers as communication peers ; and an internet  communicating via a first router  with the first network  and via a second router  with the second network .","The IP-inline key management mechanism  has:","an IP key  as a data to be manually keyed for peers and to enter the closed IP network ;","first equipment  furnished to the first router , including a first \u201csession key automatic generator\u201d (hereafter called \u201cSKGn\u201d)  responsive to the IP key  to generate a first sequence of I key boxes  each indexed for identification by a corresponding index i, each key box  containing a first sequence of J session keys  each indexed for identification by a corresponding index j, and control programs therefor;","second equipment  furnished to the second router , including a second SKGn  identical to the first SKGn  and responsive to the IP key  to generate a second sequence of I key boxes  each indexed for identification by a corresponding index i, each key box  containing a second sequence of J session keys  each indexed for identification by a corresponding index j, and control programs therefor; and","a communication system  including a first index pointer  for controlling a first combination (i,j) of the indices i and j at the first router end, a second index pointer  for controlling a second combination (i,j) of the indices i and j at the second router end, and a set of programmed implements  for connection-less communications for IP security ESP (encapsulating security payload) and AH (authentication), from a source peer via the internet  to a destination peer (or vice versa), ensuring that the first and second index combinations (i,j) are identical to each other. The first and second index pointers ,  each comprise a combination of a first or second i-pointer and a first or second j-pointer for independently pointing the indices i and j, respectively.",{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 3A","sup":"*6"},"an application layer  having an application process based on an application protocol is linked with a socket layer of a communication hierarchy  including the socket layer, a transport layer (TCP [transmission control protocol], UDP [user datagram protocol]), an IP layer and a link layer; and","an ISAKMP  linked with the socket layer cooperates with a DOI definition  and a key exchange definition  to provide a short-term key via an API (application programming interface)  for a security protocol  covering AH and ESP and linked with the link layer. The ISAKMP  and associated elements are responsible for key establishment, i.e. key generation and transport, and constitute an out-of-band mechanism relative to session keys.","This algorithm supports a perfect forward secrecy at the sacrifice of performance causing a fairly high overhead.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":["FIG. 3B","FIG. 3A","FIG. 2"],"b":["10","10","11"],"sup":"*3"},"Each session key generator SKGn ,  of  generates the I key boxes ,  of J session keys ,  by partially overlapped or separated three portions, sections or steps (hereafter collectively called \u201cstep\u201d), as follows.","At a first step, the SKGn responds to an input data [Xof FIG. ] of the IP key  to temporally sequentially generate a set of \u201cintermediate keys having a backward divergent nature as a barrier incorporated therein for supporting a perfect forward secrecy\u201d (hereafter called \u201cforward-barrier keys [Xof FIGS.  and A]\u201d).","At a second step, the SKGn responds to the forward-barrier keys to generate a set of temporally sequential \u201cintermediate keys having a forward divergent nature as a barrier incorporated therein for supporting a perfect backward secrecy, in addition to the backward divergent nature for the perfect forward secrecy\u201d (hereafter called \u201cperfect-barrier keys [sXof FIG. B]\u201d).","At a third step, the SKGn have index combinations (i,j) sequentially allotted to the perfect-barrier keys and recognizes I subsequences of thus indexed perfect-barrier keys to be the key boxes ,  and J indexed perfect-barrier keys therein to be the session keys , .","More specifically, as illustrated by , the session key generator SKGn is adapted at the first step to generate from the IP-key Xa set {X} of unique forward-barrier keys X, by way of a logistic mapping (see ) such that: X=4X(1\u2212X), where 0<X<1, and n is an arbitrary integer.","The logistic mapping allows a trace-back operation from an arbitrary forward-barrier key Xto an antecedent forward-barrier key X, such that X={1\u00b1\u221a{square root over ( )}(1\u2212X)}, which gives a pair of equally suspicious candidate keys: Y (=1+\u221a{square root over ( )}(1\u2212X)) and Y (=1\u2212\u221a{square root over ( )}(1\u2212X)) for the antecedent key X, with an uncertainty of 1 bit to be (+) or (\u2212). Therefore, the trace-back operation between the forward-barrier keys Xand Xis barred with the uncertainty, which constitutes an entropy difference of 1 bit that corresponds to a drop of information on whether (+) or (\u2212).","In other words, a respective pair of neighboring forward-barrier keys Xand Xare information-theoretically isolated in a backward direction by an entropy difference of 1 bit, which gives a backward divergent nature to the key pair Xand X, which nature appears in the form of a backward divergent tree of candidate keys, constituting a forward-barrier for barring a trace-back operation in the key pair Xand X.","Therefore, an arbitrary pair of forward-barrier keys Xand X(0<p\u2266n) are isolated in the backward direction by an entropy difference of p bits equivalent to an integration or sum of intervening p entropy differences, which gives a backward divergent nature to the key pair Xand X, which nature appears as a p-times diverged backward divergent tree of 2candidate keys (like Y, Y, Y, Y, . . . , Yi, Yj, Yk, Ym, . . . in FIG. ), and constitutes a forward-barrier for barring a trace-back approach between Xand X. The forward-barrier supports a perfect forward secrecy, as p is increased.","At the second step, the session key generator SKGn is adapted for a shift operation on a respective forward-barrier key X, to drop a total of s (s>0) leading digits of the forward-barrier key X, to provide a shifted barrier key sXas a corresponding perfect-barrier key.","For example, letting s=4, and a concerned forward-barrier key Xbe such that:\n\n","Therefore, any reverse-shift operation from the perfect-barrier key sXto the forward-barrier key Xis subjected to a total of 10(10in this case) equally suspicious solutions. This uncertainty constitutes an entropy difference of q bits (12<q<13 for s=4), which directionally acts as a backward barrier for barring the reverse-shift operation between the barrier keys Xand sX.","An antecedent forward-barrier key Xis likewise shifted to an antecedent perfect-barrier key sX. Between these barrier keys Xand sXalso, there is an entropy difference of q bits acting as a directional backward barrier for barring a reverse-shift operation therebetween.","Like this, there is generated a set of perfect-barrier keys {sX}, such that: \n\n","As each effective q-bit backward barrier is additive to any effective 1-bit forward barrier, an arbitrary perfect-barrier key sXis information-theoretically isolated (as in ) by an entropy difference of q bits along a route (sX\u2192X\u2192X\u2192sX) from an antecedent perfect-barrier key sX, and by an entropy difference of q+1 bits along a route (sX\u2190X\u2190X\u2190sX) from a subsequent perfect-barrier key sX. With respect to an r-th (r>0) subsequent perfect-barrier key sX, the isolation enlarges as r increments. Along a direct route (sX\u2190sX\u2190 . . . \u2190sX\u2190sX), the isolation appears as an entropy difference of (q+1)*r bits, exceeding (12*r+r) bits for s=4.","Like this, an arbitrary pair of perfect-barrier keys sXand sXare bi-directionally isolated from each other by entropy differences to be integrated along associated routes therebetween. The bi-directional isolation gives a bi-directional or universal divergent nature to the key pair sXand sX, which nature appears as a bi-directionally divergent tree of candidate keys, constituting a bi-directional barrier for barring any computational approach, to support the Perfect Secrecy.","At the third step, all perfect-barrier keys {sX} are arrayed to be sequentially identified in a forward or reverse direction by combinations (i,j) of discrete or apparently sequential indices i and j, and recognized as a set of I*J session keys  or  contained in I key boxes , . Then, simply an arbitrary i-th key box ,  is pointed by the index pointer , , to be registered for use.",{"@attributes":{"id":"p-0061","num":"0062"},"figref":["FIG. 6","FIGS. 7 and 8"],"b":"10","sub":"0"},"At a step S, a data Xof the IP key  is manually entered, and input to each SKGn , .","At a step S, each SKGn generates a set of forward-barrier keys {X}.","At a step S, each SKGn generates a set of perfect-barrier keys {sX}, identifies I*J perfect-barrier keys by labeling with indices i and j, and recognizes them as a set of I*J sequential session keys ,  divided in subsets and placed in I key boxes ,  in memories.","At a step S, with the first i-pointer=B (default=200 in this case), a pointed key box (hereafter referred as \u201ckey box (B)\u201d)  is left in a memory region, while the remaining key boxes  are abandoned. The key box (B) has J session keys  for selection by the first j-pointer under control of programs.","At a step S, as the j-pointer is operated at the first router end, there is provided a defined unbar data (B,j [=K in Step S]), which will be informed in a later-described manner to the second router end, where it will be processed for the second pointer  to identify a corresponding session key (B, j) in the sequence of I*J session keys . The unbar data (B, j) is thus cooperative with the session keys (i, j)  to constitute an unbar data set for unbarring the divergence barrier.","At a step S, the operated j-pointer designates j=K (to be 1 at first), and a pointed session key (B, K) is selected for encryption.","At a step S, a random flicker is read, which is a random number of 8 digits in decimal notation. As the session key (B, K) has 64 digits in decimal notation, the random flicker is small enough, in information quantity, to provide a relatively secure cookie.","At a step S, the selected session key (B, K) is modified with the random flicker, to provide a nonce key for one-time use. The random flicker thus constitutes part of the unbar data set.","At a step S, a transform is performed by using a stream cipher. The transform is what is used to secure the communication channel. For the stream cipher, an engine produces a sequence of binary bits having as high entropy as the nonce key.","At a step S, an inner IP packet encrypted at the step S is carried in accordance with a tunnel-mode ESP payload format of  A combination of the steps S to S is responsible for one ESP to be processed in milliseconds.","At a step S, the first j-pointer increments in a forward indexing manner, such that j=j+1 (i.e. K=K+1), to support a perfect forward secrecy. The flow again goes to step S along Loop-j.","At a step S, after j=J, the first j-pointer again goes to j=1, so long as one-time security is effectively held.","At a step S, as the key box (B) is fully used, the i-pointer decrements in a backward indexing manner, such that i=i\u22121 (i.e. B=B\u22121), to support the perfect backward secrecy against known-key attacks. The flow again goes to step S along Loop-i.","After i=1 or while B>0, the flow again goes to step S.","Incidentally, as to Step S, the integer X(IP key ) may be stored as a data in a 3.5-inch disk or IC (integrated circuit) card, to be read therefrom.","In connection with Step S, the key box (B) has a divergence barrier incorporated therein as an entropy barrier, which is intrinsic in barrier key generation by SKGn itself, and needs an unbar data set as vital crypt-information for unbarring the divergence barrier. In a sense, the unbar data set comprises a sequence of key boxes, and a sequence of index combinations (i, j) for identifying a sequence of unique session keys in the sequence of key-boxes, and a combination of i-pointer and j-pointer constitutes a deterministic crypt-data for opening a key box (B), which data however is stored as a cleartext in a memory. Communication peers , must share the unbar data set for a key agreement, for which a communication medium is necessary and provided in the form a tunnel-mode ESP payload format as in FIG. . This shows that the index pointers are unencrypted, and never occupy part of an inner IP header, but parts of an outer IP header () as a cleartext, which allows for communication peers , to successfully commit a key agreement in connection-less communication. A third party may access to the crypt-data with ease, and may try crypt-analyses thereon, but will only be left trying for an exhaustive search in the filed of 10keys. The current proposalrequires an originator to control SA's (security associations) of recipients. The present embodiment is different, in which a source peer simply controls an unbar data set of its own site, without having unbar data sets of other sites. Such a simplicity is an epoch-making for router networks as VPN's (virtual private networks), as the IP traffic is a mere connection-less flow from an originator to recipients.","As to Step S, the random flicker may be designed as a random number carrying event data in its initial value, such as setup date and time at a respective site, and programmed to appear with an even probability in respect of the initial value. Note that random flickers are so randomly initialized at every site as to be independent of the randomness of session keys.","The Step S corresponds to an entropy generation system in which a small entropy of a flicker is converted into a large entropy of a nonce key. As the flicker is selected from a group of integers having decimal 8 digits appearing with an even probability to an initial value, the entropy generation system can prepare 10different nonce keys from a session key. Such a nonce key is different by site. The nonce key aims at one-time pad to be shared by communication peers.","At the step S, the unbar data set (i=B, j=K, flicker) is unecrypted but covered with authentication and integrity.","At the step S, for a respective IP-security ESP, one session key is employed. After encryption of a single datagram, the j-pointer increments by unity. In IP-inline key management mechanism , the perfect forward secrecy is supported by virtue of an information-theoretical independency or isolation established between a respective current key and any past, used key. In this connection, each session key has an effective forward barrier and an effective backward barrier, as it is identified in a given set of perfect-barrier keys {sX} in a thinning manner. Letting t be a thinning interval, a respective pair of neighboring session keys comprise a perfect-barrier key sXand another perfect-barrier key sX, from which the former sXis isolated by an apparent entropy difference of (q+1)*(t+1) bits, exceeding 13*(t+1) bits for s=4.","At the step S, the effect of one-time security depends on a size of the field of nonce keys that is J(=512)*10. As respective sites have their random timings for flicker initialization, an arbitrary site may execute a manual and\/or programmed control for limiting the reuse of key box (B) to avoid uneven or inclined probability in flicker selection that may develop with an increased number of times of reuse of session keys.","At the step S, as the key box (B) is reused to a limit, any site is allowed after abandonment of the box (B) to set up a new key box (B\u22121). As i=i\u22121 (=B\u22121), the flow goes to the step S, where it has the new key box (B\u22121) and an updated unbar data {B\u22121, j [=K]}of own site. This unbar data will be shared in a described manner between communication peers, who will thus share the new key box (B\u22121). The backward indexing provides a key box of future, unused session keys free from known-key attacks.","The Loop-j has been observed to be competent with an IP security to DES-CBC.","In the current proposal, an out-of-band mechanism  is responsible for session key establishment, i.e. key generation and transport. In the embodiment, an in-band mechanism  makes it. The current proposal supports a perfect forward secrecy through the out-of-band mechanism. The embodiment supports the Perfect Secrecy at the in-band mechanism. The current proposal controls a short-term key needing a frequent ISAKMP SA update with a fairly high overhead. The embodiment employs an IP key  to be set up simply once before subsequent IP-inline actions free of overhead. Ping speed is competent.","The IP-inline key management system  has broken through difficulties of the Internet Draftin which, before a security association can be established, at least one pair of messages need to be exchanged between communication peers. For efficiency, this suggests that ISAKMP setup should be infrequent However, general principles of key management suggest that individual keys should be used as smaller times as practical and changed as frequently as possible.","According to the embodiment, indexed session keys are information-theoretically isolated from each other by entropy barriers incorporated therein, and prevents a compromise of secrecy on any past, used session key nor future, yet unused session key. The session key is large enough in size to diverge the candidate-key tree beyond a computationally secure number of candidate keys. Therefore, the IP-inline key management mechanism ensures that an original keying material is unconditionally secure, in spite of an automatic key generation.","The session key generator SKGn drops crypt-information to make entropy barriers in a set of session keys it is generating, and provides an unbar data for use to unbar corresponding entropy barriers in a separately prepared set of like session keys. The dropped information is inaccessible. However, the unbar data is accessible at communication peers, as it simply represents a combination of indices, which can be effective unbar data merely when used for pointing a session key in an identical session key set.","Industrial Applicability","The invention provides VPN's (virtual private networks), whose security services support Perfect Secrecy for session keys in a cost effective manner, and unconditional security for an original keying material, even to a manual keying.","The invention allows a long-term service of the keying material for IP-layer, permitting a manually configured keying to realize a selectively encrypting firewall.","The invention can contribute to a business-to-business tunneling protocol without needing CA's (certificate authorities).","References",{"@attributes":{"id":"p-0092","num":"0000"},"ul":{"@attributes":{"id":"ul0003","list-style":"none"},"li":{"@attributes":{"id":"ul0003-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0004","list-style":"none"},"li":["*1: C. E. Shannon, \u201cCommunication Theory of Secrecy Systems\u201d, Bell Systems Technical Journal, 28 (1949), 665-715.","*2: Handbook of Applied Cryptography, CRC Press, U.S.A., 1997, by Alfred J. Menezes, Paul C. van Oorschot, and Scott A. Vanstone, pp. 49-496.","*3: RFC (Recommend for Comment) 1825; RFC 1826; and RFC 1827.","*4: Draft-ietf-ipsec-isakmp-10.txt,.ps\/Jul. 3, 1998.","*5: Draft-ietf-ipsec-oakley-02.txt, \u201cOAKLEY Key Determination Protocol\u201d; and","\u2003Draft-ietf-ipsec-isakmp-oakley-08.txt\/June 1998, \u201cInternet Key Exchange\u201d.","*6: Draft-ietf-ipsec-inline-isakmp-01.txt (March 1997)","*7: Japanese Patent Application Laid-open Publication No. 9-292978, published Nov. 11, 1997."]}}}}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":["The above and further objects and novel features of the present invention will more fully appear from the following detailed description when the same is read in conjunction with the accompanying drawings, in which:",{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 3A","sup":"*6"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 4","FIG. 2"],"sup":"*7 "},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 5A"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5B"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 6","FIG. 2"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 7","FIG. 2","FIG. 6"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
