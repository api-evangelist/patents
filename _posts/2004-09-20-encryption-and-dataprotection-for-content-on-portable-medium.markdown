---
title: Encryption and data-protection for content on portable medium
abstract: A source generates a medium key (KM) and a media secret table including a plurality of entries, each entry including (KM) encrypted by a public key (PU-PD) of a plurality of devices, obtains the medium ID of a medium therefrom, generates a content key (KD) for a piece of content, encrypts the content with (KD) to result in (KD(content)), encrypts (KD) with (KM) to result in (KM(KD)), generates a package for the content including (KD(content)), (KM(KD)), the medium ID, and a signature based on at least the medium ID and verifiable with (KM), and copies the generated package and the media secret table to the medium. Thus, a device with the medium and a private key (PR-PD) corresponding to an entry of the media secret table can access and render the content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07644446&OS=07644446&RS=07644446
owner: Panasonic Corporation
number: 07644446
owner_city: Osaka
owner_country: JP
publication_date: 20040920
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["This application claims the benefit of U.S. Provisional Patent Application Ser. No. 60\/513,897 entitled \u201cENCRYPTION AND DATA-PROTECTION FOR CONTENT ON PORTABLE MEDIUM,\u201d filed Oct. 23, 2003, naming Alkove et al. as inventors, the entire disclosure of which is incorporated by reference herein.","The present invention relates to an architecture for enforcing rights in digital content. More specifically, the present invention relates to such an enforcement architecture that allows access to encrypted digital content on a portable medium only in accordance with rules associated with the content. Even more specifically, the present invention relates to such an architecture that ties the content to a uniquely identifiable portable medium such that the content cannot be rendered from any other medium.","As is known, and referring now to , a rights management (RM) and enforcement system is highly desirable in connection with digital content  such as digital audio, digital video, digital text, digital data, digital multimedia, etc., where such digital content  is to be distributed to users. Upon being received by the user, such user renders or \u2018plays\u2019 the digital content with the aid of an appropriate rendering device such as a media player on a personal computer, a portable playback device, or other user computing device .","Typically, a content owner distributing such digital content  wishes to restrict what the user may do with such distributed digital content . For example, the content owner may wish to restrict the user from copying and re-distributing such content  to a second user, or may wish to allow distributed digital content  to be played only a limited number of times, only for a certain total time, only on a certain type of machine, only on a certain type of media player, only by a certain type of user, etc.","However, after distribution has occurred, such content owner has very little if any control over the digital content . An RM system  allows the controlled rendering or playing of arbitrary forms of digital content , where such control is flexible and definable by the content owner of such digital content. Typically, content  is distributed to the user in the form of a package  by way of any appropriate distribution channel. The digital content package  as distributed may include the digital content  encrypted with a symmetric encryption\/decryption key (KD), (e.g., (KD(CONTENT))), as well as other information identifying the content, how to acquire a license for such content, etc.","The trust-based RM system  allows an owner of digital content  to specify rules to be satisfied before such digital content  is allowed to be rendered. Such rules may include those aforementioned and\/or others, and may be embodied within a digital license  that the user\/user's computing device  (hereinafter, such terms are interchangeable unless circumstances demand otherwise) obtains from the content owner or an agent thereof, or such rules may already be attached to the content . Such license  may for example include the decryption key (KD) for decrypting the digital content , perhaps encrypted according to another key decryptable by the user's computing device or other playback device.","The content owner for a piece of digital content  would prefer not to distribute the content  to the user unless such owner trusts that the user will abide by the rules specified by such content owner in the license  or elsewhere. The user's computing device  or other playback device is provided with a trusted component or mechanism  that will not render the digital content  except according to such rules.","The trusted component  typically has an evaluator  that reviews the rules, and determines based on the reviewed rules whether the requesting user has the right to render the requested digital content  in the manner sought, among other things. As should be understood, the evaluator  is trusted in the RM system  to carry out the wishes of the owner of the digital content  according to the rules, and the user should not be able to easily alter such trusted component  and\/or the evaluator  for any purpose, nefarious or otherwise.","As should be understood, the rules for rendering the content  specify whether the user has rights to so render based on any of several factors, including who the user is, where the user is located, what type of computing device  or other playback device the user is using, what rendering application is calling the RM system , the date, the time, etc. In addition, the rules may limit rendering to a pre-determined number of plays, or pre-determined play time, for example.","The rules may be specified according to any appropriate language and syntax. For example, the language may simply specify attributes and values to be satisfied (e.g., a DATE later than X), or may specify the performance of functions according to a specified script (e.g., IF DATE greater than X, THEN DO Y).","Upon the evaluator  determining that the user satisfies the rules, the digital content  is rendered. In particular, to render the content , the decryption key (KD) is obtained from a pre-defined source and is applied to (KD(CONTENT)) from the content package  to result in the actual content , and the actual content  is in fact rendered.","In an RM system , content  is packaged for use by a user by encrypting such content  and associating a set of rules with the content , whereby the content  is renderable only in accordance with the rules. Because the content  is only rendered in accordance with the rules, the content  may be freely distributed. Significantly, the content , the rules, and an encrypted version of the decryption key (KD) are communicated to the computing device  or other playback device. Moreover, in preparing at least the encrypted version of the decryption key (KD), it would be useful to tie the decryption key (KD) to an object in such a manner that the encrypted version of the decryption key may not be accessed to decrypt and render the content  except in the presence of such object. Thus, the content , the rules, and the encrypted version of the decryption key (KD) may not be redistributed in a manner so that the content  may be rendered widely and in contravention to the wishes of the content owner. As may be appreciated, such object to which the encrypted decryption key (KD) is tied to may be a computing device  or other playback device or may be a storage medium such as a disk drive, an optical or magnetic storage disk, or the like.","Accordingly, a copy protection system for personal computers, consumer electronic devices, and other computing devices that is secure, simple, lightweight, and affordable is desired to address one or more of these and other disadvantages.","The aforementioned needs are satisfied at least in part by the present invention in which a source stores a piece of digital content on a storage medium in a manner accessible by any of a plurality of devices having a public-private key pair (PU-PD, PR-PD) and able to receive or have the storage medium. In one embodiment, the invention provides a method and mechanism that allows the RM system  to tie the encrypted decryption key (KD) to an object such that the encrypted decryption key (KD) may not be obtained except in the presence of such object. In another embodiment, the object is portable, such as an optical or magnetic storage disk, so that a user transports the object with the encrypted decryption key thereon among multiple computing devices  or other playback devices.","A device may be assigned more than one set of public-private key pairs. The source generates a medium key (KM) and obtains a master key list that includes a plurality of entries therein and a version number. Each entry includes a (PU-PD) of one of the plurality of devices. The source generates a media secret table based on (KM) and the master key list, where the media secret table includes a plurality of entries corresponding to at least a sub-set of the plurality of entries of the master key list. Each entry of the media secret table includes (KM) encrypted by the (PU-PD) of the corresponding entry of the table (PU-PD(KM)).","The source obtains the medium identifier (ID) of the medium therefrom, generates a content key (KD) for the piece of content, encrypts the content with (KD) to result in (KD(content)), encrypts (KD) with (KM) to result in (KM(KD)), generates a package for the content including (KD(content)), (KM(KD)), the medium ID, and a signature based on at least the medium ID and verifiable with (KM), and copies the generated package, the master key list, and the media secret table to the medium. Further, usage rules (e.g., a license) associated with the content may also be stored on the medium.","Thus, a device with the medium upon receiving a request to render the content thereon obtains the media secret table from the medium, obtains (PR-PD) thereof, indexes into an entry of the media secret table based on the obtained (PR-PD), obtains (PU-PD(KM)) from the indexed-into entry of the media secret table, applies (PR-PD) to (PU-PD(KM)) to expose (KM), verifies the digital signature of the content package based on (KM), obtains the medium ID from the content package, obtains the medium ID from the medium, verifies that the medium ID from the content package matches the medium ID from the medium, and, if the digital signature verifies and the medium IDs verify, obtains (KM(KD)) from the package, applies (KM) to (KM(KD)) to expose (KD), obtains (KD(content)) from the content package on the storage medium, applies (KD) to (KD(content)) to expose the content, and renders the exposed content in accordance with the usage rules stored on the medium.","In accordance with one aspect of the invention, a method encrypts content with copy protection for storage on a destination computer-readable medium. The method includes generating a medium key to be associated with a destination computer-readable medium and encrypting the generated medium key with one or more public keys. Each of the public keys correspond to an end user device. The method includes encrypting the content with a content key and encrypting the content key with the medium key. The method also includes defining a medium identifier associated with the destination computer-readable medium and associating the defined medium identifier with the encrypted content. The method also includes storing the encrypted content, encrypted content key, encrypted medium keys, and associated medium identifier to the destination computer-readable medium, wherein comparing the defined medium identifier with the medium identifier associated with the encrypted content prior to rendering the content provides copy protection for the content.","In accordance with another aspect of the invention, a method decrypts copy-protected content stored on a computer-readable medium for rendering by an end user device. The computer-readable medium stores a package including encrypted content, an encrypted content key, one or more medium keys each being encrypted by a public key associated with one of a plurality of end user devices, and a medium identifier. The end user device has a private key associated therewith. The method includes calculating a medium key for the end user device from the encrypted medium keys as a function of the private key. The method also includes defining a medium identifier for the computer-readable medium and comparing the defined medium identifier with the medium identifier stored in the package. The method further includes decrypting the encrypted content key with the calculated medium key and decrypting the encrypted content with the decrypted content key if the defined medium identifier corresponds to the medium identifier stored in the package as a function of comparing.","In accordance with still another aspect of the invention, a system records content with copy protection onto a computer-readable medium. The system includes a memory area for storing content, a medium identifier associated with the computer-readable medium, one or more public keys each corresponding to an end user device, and one or more usage rules associated with the stored content. The system also includes a processor configured to execute computer-executable instructions for generating a medium key to be associated with the computer-readable medium, encrypting the generated medium key with each of the public keys stored in the memory area, encrypting the content stored in the memory area with a content key, encrypting the content key with the medium key, and storing the encrypted content, the encrypted content key, the encrypted medium keys, and the associated medium identifier to the computer-readable medium.","In accordance with yet another aspect of the invention, a system renders copy protected content stored on a computer-readable medium by an end user device. The system includes a memory area for storing a medium identifier associated with the computer-readable medium, encrypted content, a medium identifier associated with the encrypted content, an encrypted content key, one or more medium keys each encrypted by a public key associated with one of a plurality of end user devices, and a private key associated with the end user device. The system also includes a processor configured to execute computer-executable instructions for calculating a medium key for the end user device from the encrypted medium keys stored in the memory area as a function of the private key, and comparing the medium identifier associated with the computer-readable medium with the medium identifier associated with the encrypted content. The processor is further configured to execute computer-executable instructions for decrypting the encrypted content key with the calculated medium key and decrypting the encrypted content with the decrypted content key if the medium identifier associated with the computer-readable medium corresponds to the medium identifier associated with the encrypted content as a function of the compared medium identifier.","In accordance with another aspect of the invention, one or more computer-readable media have computer-executable components that provide copy protection for content. The components are executable on an end user device. The components include an encryption component for encrypting the content by generating a medium key to be associated with a computer-readable medium and encrypting the generated medium key with one or more public keys. Each of the public keys corresponds to an end user device. The encryption component creates a media secret table for the content. The media secret table includes the encrypted medium keys. The encryption component further encrypts the content with a content key, encrypts the content key with the medium key, defines a medium identifier associated with the destination computer-readable medium, associates the defined medium identifier with the encrypted content, and stores the encrypted content, encrypted content key, media secret table, and associated medium identifier as a group on the computer-readable medium. The components also include a decryption component for decrypting the content encrypted by the encryption component and enforcing copy protection by calculating the medium key for the end user device from the media secret table as a function of the private key, determining a reference medium identifier for the computer-readable medium, and comparing the determined reference medium identifier with the medium identifier stored in the group. The decryption component further decrypts the encrypted content key with the calculated medium key and decrypts the encrypted content with the decrypted content key if the determined reference medium identifier corresponds to the medium identifier stored in the group as a function of the compared medium identifier.","Alternatively, the invention may comprise various other methods and apparatuses.","Other features will be in part apparent and in part pointed out hereinafter.","Typically, an RM system  such as has been set forth above protects digital content  by among other things having a user's computing device  authenticate itself as a legitimate RM component and transmitting one or more cryptographic keys for purposes of constructing and receiving an encrypted version of a decryption key (KD) by which the content  may be accessed. Such authentication and key transmittal may include, but is not limited to, an interactive process including signed certificates, negotiations, exchanges of asymmetric and symmetric keys, and the like, where the interactive process is accomplished over a network connection or the like between the computing device  and a remote entity such as a license server.","However, it is to be appreciated that in doing so the content  is in effect tied to the computing device  and therefore is not able to be rendered except in the presence of such computing device . Especially in the case when a user of the content  may wish to transport such content  among several computing devices  and\/or other playback devices, it would be desirable to store the content  on a portable medium along with rules for accessing the content  and the encrypted version of the decryption key (KD). However, it would also be desirable to prevent such items from being widely redistributed in a manner contrary to the wishes of the content owner. Accordingly, in one embodiment of the present invention, at least the encrypted decryption key (KD) is tied to the portable medium in a manner such that such decryption key (KD) may not be accessed except in the presence of such portable medium.","As may be appreciated, such portable medium may be any portable medium without departing from the spirit and scope of the present invention. For example, such portable medium may be an optical or magnetic disk such as a CD or DVD disk or a floppy disk, or may be a portable smart card, a portable RAM card, a portable media card, a portable hard drive, or the like with digital memory thereon. Significantly, to tie the encrypted version of the decryption key (KD) to the portable medium, such portable medium should include a unique identification or ID that is not easily alterable or copied and that is machine-readable. Such ID may for example be the unique bar code ID on every DVD disc that is located near the hub thereof, or the like.","Thus, in the present invention, and referring now to , a playback device  renders or plays back the content  on a portable medium  or other destination computer-readable medium by appropriately receiving such medium  or otherwise including the medium  therein. Significantly, and as will be set forth in more detail below, the playback device  is pre-authorized to access the content  on the medium  by being granted one or more public-private key pairs (PU-PD, PR-PD) and some form of a trusted component , and authorization is confirmed through a media secret table  included on the medium  with the content , where the trusted component  of the device  uses (PR-PD) to decrypt the encrypted version of the decryption key (KD). The device  is thus authorized to render and otherwise use the content  by virtue of having (PR-PD) and the trusted component , which allows access into the table . Public-private key pair technology is known in the art.","In one mode of obtaining and rendering digital content , and still referring to , such digital content  is downloaded or otherwise obtained from a source  and is placed on the portable medium  that is either mounted to the playback device  or internal to such device . Such device  may be any appropriate device  without departing from the spirit and scope of the present invention. For example, such device  may be a portable player with relatively limited functionality, a computing device  with relatively extensive functionality, or the like. Moreover, the device  may merely be able to render the content  or may be able to copy the content  to another portable medium , if so allowed by the associated rules, as will be set forth in more detail below.","The source  may be any appropriate source without departing from the spirit and scope of the present invention, as long as a connection  exists between the source  and the portable medium . For example, the source  may be a host computer, a remote server location, or a combination thereof, with the content  thereon or available therethrough. It may for example be the case that the content  and associated data are downloaded from the source  at a kiosk, perhaps at a retail outlet. In another example, source  is a DVD recorder while portable medium  is a computer-readable media suitable for use in the DVD recorder. Alternatively, it may for example be the case that the device  is coupled to a source  such as for example a host computer and the content  and associated data are downloaded directly thereto.","In one embodiment of the present invention, when the content  is downloaded to the medium , a corresponding set of usage rules is also obtained and downloaded or otherwise placed on the medium . The rules may take any appropriate form without departing from the spirit and scope of the present invention. For example, the rules may be attached to or separate from the content  on the medium , and may take the form of a more formal license  or a less formal set of statements that may be interpreted by and abided by the trusted component  on the device . Methods and mechanisms for generating such rules are known or should be apparent to those skilled in the art and therefore need not be set forth herein in any detail. Generally, the rules may specify the limitations, if any, to be satisfied to render the corresponding content  on the medium  at the device . In addition, the rules may set forth other provisions such as for example whether the content  may be copied to another medium .","Note that the content  prior to being placed on the medium  may or may not already be in an RM-protected form. If so, and assuming that the content  at the source  is encrypted by a content key (KD) and also that the content key (KD) at the source  is encrypted according to an asymmetric key such as the public key of the source , (PU), the source  obtains the content key (KD) by applying a corresponding private key (PR) and re-encrypting the content key (KD) according to a key of the medium  (KM) to form (KM(KD)), where (KM(KD)) is the encrypted version of the content key (KD) and is placed on the medium  along with the encrypted content . Thus, and as should be appreciated, the content key (KD) as encrypted according to the medium key (KM) to form (KM(KD)) is tied to the medium  and not any device  in particular.","If not already in an RM-protected form, the content  is placed thereinto. In particular, the source  selects a content key (KD) for the content  and with such content key (KD) encrypts the content  to form (KD(content)). Thereafter, the source  encrypts the content key (KD) according to the medium key (KM) to form (KM(KD)), where (KM(KD)) is the encrypted version of the content key (KD) and is placed on the medium  along with the encrypted content . Thus, and again, the content key (KD) as encrypted according to the medium key (KM) to form (KM(KD)) is tied to the medium  and not any device  in particular.","Referring still to , to download the digital content  and associated items to the medium , such medium  is coupled to the source  by way of a connection  which may be any appropriate connection without departing from the spirit and scope of the present invention. As may be appreciated, if the medium  is some form of portable writable storage, the connection  is an appropriate drive to which the medium  is mounted. Likewise, if the medium  is internal to the device , the connection  may be an appropriate cable, a wireless link such as an RF or IR link, or the like. Such connections  and hardware and\/or software in support thereof are known or should be apparent to members of those skilled in the art and therefore need not be described herein in any further detail.","Bearing in mind that the encrypted content , the rules therefore, and the content key (KD) encrypted according to the medium key (KM) to form (KM(KD)) are on a storage medium , and also bearing in mind that the content key (KD) of the content  encrypted according to the medium key (KM) to form KM(KD), and presuming that the medium key (KM) is a symmetric key, such medium key (KM) should also travel with such medium . However, and importantly, (KM) should not be exposed, and is therefore stored in an encrypted form on the medium . In particular, and in one embodiment of the present invention, (KM) is encrypted by the public key of the device  (PU-PD) to form (PU-PD(KM)), and (PU-PD(KM)) is stored in the aforementioned media secret table  on the medium .","It is to be assumed for purposes of the present invention that the device  is unable to communicate its public key (PU-PD) to the medium  or the source , even though such capability may indeed be present without departing from the spirit and scope of the present invention. Moreover, inasmuch as the medium  may be received by any of a multitude of devices , the source  and\/or the user may not know each of the intended receiving devices  at the time the content  and related items are placed on the medium . Accordingly, the source  that is encrypting (KM) with (PU-PD) to form (PU-PD(KM)) is already in possession of every possible (PU-PD) key from every possible device .","Notably, there could potentially be millions of such devices , if not more, and each device  could have its own presumably unique (PU-PD) key. However, the aforementioned encrypting entity likely could not be expected to know the unique (PU-PD) key for every such device . Accordingly, in one embodiment of the present invention, (PU-PD) keys and corresponding (PR-PD) keys are assigned to participating devices  in an organized manner, such as for example by a centralized authority or a standards body. As a result, the number of (PU-PD) keys is kept at a manageable level. In such embodiment, and as may be appreciated, the centralized authority or standards body (hereinafter, \u2018master\u2019) maintains a master key list  of the public keys (PU-PD) in an indexed fashion, where the master key list  is accessible, either directly or indirectly, by each source .","Distributing the key pairs (PU-PD, PR-PD) to devices  by or on behalf of the master may be done in any appropriate manner without departing from the spirit and scope of the present invention. For example, each manufacturer of a device  could be assigned one or more particular key pairs, whereby all devices  manufactured thereby are provided with such manufacturer-specific key pairs. Likewise, each model of a device  could be assigned one or more particular key pairs. Similarly, each manufacturer or model of a device  could be assigned a number of key pairs that are either randomly or purposefully provided to specific ones of devices . Note that if a particular manufacturer or model becomes untrustworthy, each key pair thereof may merely be revoked (as will be discussed below) without affecting other manufacturers or models.","Again, a source  downloading protected content , rules, and an (KM(KD)) to a medium  doesn't necessarily know what device  the medium  is to be mounted to or is internal to. Accordingly, and as seen in , in one embodiment of the present invention, the source  also downloads the media secret table  to the medium , where such table  has therein (KM) encrypted according to each of several public keys of devices (PU-PD) that are known. Importantly, and as should now be appreciated, the table  is compiled based on the public keys (PU-PD) in the aforementioned master key list . As seen, in the table , each encrypted (PU-PDx(KM)) has a corresponding index value x specifying an identifier of the (PU-PD) that encrypted the secret. For example, (PU-PD) is specified by index value . As may be appreciated, such index x corresponds to the indexing in the master key list  such that any device  knowing an index x of a particular (PU-PDx) thereof may index into the table  based on same to obtain (PU-PDx(KM)). In one example, the identifier is 16 bits.","In one embodiment of the present invention, the table  includes therein (KM) encrypted according to the (PU-PDx) of the device  that is to be employed to render the corresponding content . Note that the table  may have (KM) encrypted according to every (PU-PDx) that is known to the source  based on knowledge of the master key list , or to a specific sub-set thereof, all without departing from the spirit and scope of the present invention. For example, a user effectuating such a download may specify that the device  is manufactured by a particular manufacturer, and the table  thus includes (KM) encrypted according to every (PU-PDx) of the manufacturer. Likewise, the user may specify that the device  may be any of a number of particular devices , and the table  thus includes (KM) encrypted according to every (PU-PDx) of such number of particular devices . In another example, the source  creates a table such as table  that allows access by all non-revoked devices .","Remembering that the medium  includes a unique medium identifier (ID) that is not easily alterable or copied and that is readable or definable by the device , the encrypted content  on the medium  should be tied thereto based on such medium ID. In one embodiment, the medium ID is a serial number that is written to the medium  during manufacturing. Accordingly, as part of copying the content  to the medium , and in one embodiment of the present invention, the source  reads the ID from the medium  and attaches the ID to the encrypted content  before copying same to the medium . As will be explained in more detail below, tying occurs because the device  is trusted to render the content  from the medium  only if such content  includes the medium ID of such medium .","As shown in , the medium  with the content  as placed thereon includes the medium ID, the encrypted content (KD(content)), the encrypted content key (KM(KD)), the usage rules for using the content, and the table  with a set of (PU-PDx(KM)).","Note that nothing as yet ties the encrypted content key (KM(KD)) to the medium  and the medium ID thereof. Accordingly, in one embodiment of the present invention, the encrypted content (KD(content)) is packaged into a content package  or file that includes the encrypted content key (KM(KD)), the usage rules for using the content, and a copy of the medium ID. Thus, (KM(KD)) and the medium ID are now tied together by being in the same package . Of course, a nefarious entity may attempt to alter the package , and so to thwart such an attempt, at least the medium ID within the package  is employed as the basis for a digital signature which is appended to the package . Thus, any attempt to alter the medium ID would cause the signature to fail to verify. In such embodiment, the medium key (KM) may be employed as the signature verification key in the manner set forth below.","Note, too, that as yet nothing ties the package  to the table . Put another way, it may be the case that content  is placed on the medium  in multiple sessions, where the medium key (KM) employed is different for each session. In such case, the medium  may include multiple packages  and tables  thereon, where each media secret table is based on a different session and therefore a different medium key (KM). Each session is independent. Accordingly, in one embodiment of the present invention, a table ID identifies each table  and each package  includes a table ID of a table  that is to be employed in connection with such package . Thus, the table ID in the package  is employed to locate the corresponding table  to be employed therewith.","Note that it may be the case that the device  is itself capable of acting as a derivative source such as source  and therefore itself placed content  on another medium . To do so, however, the device  acting as the derivative source needs a current copy of the master key list . If, however, the device  cannot itself obtain the current copy of the master key list  directly from the master or an agent thereof, and in one embodiment of the present invention, such device  may obtain such current copy of the master key list  by way of such copy being stored on the medium  by the source  that itself obtains the current copy directly from the master or an agent thereof.","Accordingly, and in one embodiment of the present invention, the source  does indeed place the current copy of the master key list  on the medium  to be available to any device  acting as a derivative source. In such embodiment, the master upon updating the master key list  applies a non-decreasing version number thereto, and may sign the master key list  with an appropriate key. Thus, a device  which acts as a secondary source such as source  upon encountering a medium  determines based on the version number of the master key list  thereon whether the medium  has a more current master key list  than the master key list  of such device , and if so, the device  copies the master key list  from the medium to the device . Of course, in doing so, the device  ensures that the signature of the master key list  verifies to ensure that such list  has not been altered.","As shown in , the medium  with the content  as placed thereon includes:\n\n","To render the content  on the medium , the device  refers to the table  on the medium  that corresponds to the content  and indexes to (KM) encrypted according to the (PU-PDx) of such device . In particular, and referring now to , the device  upon being directed to render the content  at  refers to the rules for such content  as set forth within the package  having such content , and determines by way of the evaluator  of the trusted component  whether the rules are satisfied at .","Assuming that such rules are in fact satisfied, the device  obtains the table  corresponding to the content \/package  based on the table ID in the package  and in the table  at , obtains the private key of such device  (PR-PDx) and the index value x of such device  at , indexes into the table  based on the obtained index value x at , and selects the corresponding (PU-PDx(KM)) at . The device  applies the obtained (PR-PDx) to the encrypted (PU-PDx(KM)) to expose the medium key (KM) of the table  at .","With (KM), the device  verifies the signature appended to the package  to authenticate at least the medium ID within the package at , and also ensures that the medium ID within the package  matches the medium ID on the medium  itself at . As may be appreciated, in doing so, the device confirms that the package  is indeed properly tied to the medium  on which it resides, and that a nefarious entity has not improperly copied the package  and related items from another medium .","Once proper tying is confirmed, the device  may obtain (KM(KD)) from the package  of the content  at , and applies (KM) to (KM(KD)) to expose (KD) at . The device  obtains (KD(content)) from the package  and applies (KD) to (KD)content)) to expose and render the content at . Finally, if the device  acts as a derivative source, the device  checks copy of the master key list  on the medium  for the version number thereof, and if earlier than the version number of the copy of the master key list  on the device , such device  adopts the copy of the master key list  from the medium  by copying same at .","As set forth above, the table  produced by the source  may have (KM) encrypted according to every (PU-PDx) that is known to the source , or to a specific sub-set thereof. As may be appreciated, to revoke a particular (PU-PDx), such (PU-PDx) may be excluded from the table , and a corresponding device  therefore cannot obtain (PU-PDx(KM)) the table  to render the corresponding content . Alternatively, a corresponding device  is barred from rendering the content  by leaving blank the field in the table  for the corresponding (PU-PDx(RND)), wherein RND represents a random integer, or by filling the field with any alternate data such as zeroes, gibberish or nonsense data. As may be appreciated, the master decides when a (PU-PDx) is no longer trustworthy and therefore is to be invalidated, or receives such decision from another entity.","If it is the case that the device  is provided with more than a single key pair (PU-PDx, PR-PDx), the device  attempts to employ each available (PR-PDx) on the table  until one is found to expose (KM). In such embodiment, to invalidate the device  (e.g., as being non-trustworthy), the source  leaves out from the table  the entries that would correspond to all of the (PU-PDx)s of the device . In such a situation, an invalidated device  with (PU-PDx)s A, B, C, and D would result in the \u2018cancellation\u2019 of such device keys A, B, C, and D from the table . Note that in such situation, a device  with (PU-PDx)s B, C, D, and E would still be able to access from the table  the secret as indexed under device key E, assuming device key E was not canceled too, but not the (PU-PDx)s as indexed under device keys B, C, or D.","In the manner that the package  with the content  is tied to the medium  by having the medium ID therein, the table  may in addition or in the alternative be tied to the medium  by having the medium ID therein. Thus, the table  cannot be freely transported to other media . In such case, the table  may include a signature based at least in part on the medium ID to prevent tampering, and such signature may be verified in conjunction with operations  and  of .","Note that the table  is placed on the medium  with the content  during a session and pertains only to the content  of such session and not to content  of any future session. Such table  is not ever updated or modified, even if one or more (PU-PDx)s within the table  have subsequently been added or revoked in the master key list  by the master. Put another way, revocation of a (PU-PDx) is only with regard to tables  created after the revocation, and content  tied thereto. In such a situation, it is to be recognized that as a policy matter older content  will be accessible even by a revoked device , but newer content  will not likewise be accessible by such a revoked device .","Referring now to , to write one or more pieces of content  to a medium  during a particular session, the source  generates a medium key (KM) for the session at , obtains the master key list  from the master or else ensures that the master key list  is current at , and generates a media secret table  for the session based on (KM) and the master key list  at . Production of the table  may be done by any appropriate method without departing from the spirit and scope of the present invention.","For example, for each valid (PU-PDx) in the master key list , such (PU-PDx) is employed to encrypt (KM), and such (PU-PDx(KM)) is appropriately placed in the table  being produced. Note, though, that for each invalid (PU-PDx) in the master key list , (KM) is not encrypted thereby and placed in the table  being produced. Instead, the space for such (PU-PDx(KM)) is merely left blank, filled with some pre-determined value such as zeroes, or completely omitted. In addition, a table ID is placed in the table  in an appropriate location, and any other items are produced and placed in the table  as well. Such other items may include a signature and the medium ID of the medium  to which the table  is to be copied, among other things.","As should now be appreciated, one or more tables  may be generated or partially generated in advance and placed in a cache  available to the source, especially if production of each table  is especially computationally exhaustive. If so, the tables  may be generated and placed into the cache  by a media secret table server or the like (not shown) for removal and use by the source , where the media secret table server performs operations -. It may alternately be the case that a new table  is obtained on demand directly from the media secret table server operating as the cache . Note that the source  may use a table  from the cache  once or more than once without departing from the spirit and scope of the present invention.","At this point, the source has for the session (KM) and the table  that hides (KM), where the table has a table ID. In addition, the source  obtains the medium ID of the medium  therefrom at , and for each piece of content , the source : generates a content key (KD) at ; encrypts the content  with the content key (KD) to result in (KD(content)) at ; encrypts (KD) with the medium key (KM) to result in (KM(KD)) at ; and generates a package  for the content  with (KD(content)), (KM(KD)), the medium ID, the table ID, usage rules for using the content, and a signature based on at least the medium ID and verifiable with (KM) at .","Once the source  has generated all the packages  for the session, the source  copies each generated package , the media secret table , and the master key list  to the medium  at  to finalize the session. Thereafter, the source  may take any appropriate post-copying action. For example, if the content  is supplied as part of a financial transaction, the source  may mark the transaction complete, charge an account, increment or decrement a count value, etc.","Note that the medium  may or may not allow additional copying sessions to take place at later times. If so, and as was set forth above, each new session is signified by a different table , where the content packages  of such session are tied to the table  of such session. Note, too, that in an alternate embodiment of the present invention and to simplify matters, the session medium key (KM) may be employed to encrypt content directly.","Note, further, that the operations performed in connection with  take place without regard to any particular device . In particular, the operations do not take into consideration whether the device  to which the medium  is to be mounted or is internal to is valid and thus has valid (PU-PDx) key(s). In fact, the source  likely has no way of verifying such validity prior to copying the packages  to the medium . If in fact an invalidated device  attempts to render the content  on the medium , where the content  is encrypted according to a copy of the master key list  later than the revocation of the invalidated device , the attempt will fail, but if the content  is encrypted according to a copy of the master key list  earlier than the revocation of the invalidated device , the attempt will succeed.","Once content  has been copied to the medium , such content  may be rendered by any device  that has compatible software and is capable of reading the medium  and capable of accepting same, if the medium  is separate therefrom. The device  should have an appropriate trusted component  and a private key (PR-PDx) that indexes into the table  on the medium . In addition, the device  is not a device that has been revoked or invalidated from the table  and not able to access from the table  the secret needed to render the content .","Referring next to , a block diagram illustrates an exemplary architecture of an embodiment of the invention. In particular, a recording device encrypts content for storage on a compliant media for ultimate rendering by a playback device. Further, while the invention is operable with any encryption and decryption technology, the example of  illustrates Advanced Encryption Standard (AES) block cipher encryption and decryption in Cipher Block Chaining (CBC) mode. Alternatively or in addition, the invention is also operable with encryption technology such as Elliptic Curve Cryptography (ECC) (e.g., an elliptic curve ElGamal cipher algorithm or an elliptic curve digital signature algorithm). Further, in the example of , the media key is 128 bits, the media secret table has a maximum memory of two megabytes, the medium identifier is 64 bits, the MAC is 128 bits, and the content key is 128 bits.",{"@attributes":{"id":"p-0074","num":"0083"},"figref":"FIG. 6"},"As shown in , an exemplary general purpose computing system includes a conventional personal computer  or the like, including a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. The system memory includes read-only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within the personal computer , such as during start-up, is stored in ROM .","The computer  typically has at least some form of computer readable media. Computer readable media, which include both volatile and nonvolatile media, removable and non-removable media, may be any available medium that may be accessed by computer . By way of example and not limitation, computer readable media comprise computer storage media and communication media. Computer storage media include volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. For example, computer storage media include RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium that may be used to store the desired information and that may be accessed by computer . Communication media typically embody computer readable instructions, data structures, program modules, or other data in a modulated data signal such as a carrier wave or other transport mechanism and include any information delivery media. Those skilled in the art are familiar with the modulated data signal, which has one or more of its characteristics set or changed in such a manner as to encode information in the signal. Wired media, such as a wired network or direct-wired connection, and wireless media, such as acoustic, RF, infrared, and other wireless media, are examples of communication media. Combinations of any of the above are also included within the scope of computer readable media.","The personal computer  may further include a hard disk drive  for reading from and writing to a hard disk (not shown), a magnetic disk drive  for reading from or writing to a removable magnetic disk , and an optical disk drive  for reading from or writing to a removable optical disk  such as a CD-ROM or other optical media. The hard disk drive , magnetic disk drive , and optical disk drive  are connected to the system bus  by a hard disk drive interface , a magnetic disk drive interface , and an optical drive interface , respectively. The drives and their associated computer-readable media provide non-volatile storage of computer readable instructions, data structures, program modules and other data for the personal computer .","Although the exemplary environment described herein employs a hard disk, a removable magnetic disk , and a removable optical disk , it should be appreciated that other types of computer readable media which stores data that is accessible by a computer may also be used in the exemplary operating environment. Such other types of media include a magnetic cassette, a flash memory card, a digital video disk, a Bernoulli cartridge, a random access memory (RAM), a read-only memory (ROM), and the like.","A number of program modules may be stored on the hard disk, magnetic disk , optical disk , ROM  or RAM , including an operating system , one or more application programs , other program modules  and program data . A user may enter commands and information into the personal computer  through input devices such as a keyboard  and pointing device . Other input devices (not shown) may include a microphone, joystick, game pad, satellite disk, scanner, or the like. These and other input devices are often connected to the processing unit  through a serial port interface  that is coupled to the system bus, but may be connected by other interfaces, such as a parallel port, game port, or universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video adapter . In addition to the monitor , a personal computer typically includes other peripheral output devices (not shown), such as speakers and printers. The exemplary system of  also includes a host adapter , a Small Computer System Interface (SCSI) bus , and an external storage device  connected to the SCSI bus .","The personal computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be another personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the personal computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet.","When used in a LAN networking environment, the personal computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the personal computer  typically includes a modem  or other means for establishing communications over the wide area network , such as the Internet. The modem , which may be internal or external, is connected to the system bus  via the serial port interface . In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in the remote memory storage device. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Although described in connection with an exemplary computing system environment, including computer , the invention is operational with numerous other general purpose or special purpose computing system environments or configurations. The computing system environment is not intended to suggest any limitation as to the scope of use or functionality of the invention. Moreover, the computing system environment should not be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary operating environment. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, mobile telephones, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","An interface in the context of a software architecture includes a software module, component, code portion, or other sequence of computer-executable instructions. The interface includes, for example, a first module accessing a second module to perform computing tasks on behalf of the first module. The first and second modules include, in one example, application programming interfaces (APIs) such as provided by operating systems, component object model (COM) interfaces (e.g., for peer-to-peer application communication), and extensible markup language metadata interchange format (XMI) interfaces (e.g., for communication between web services).","The interface may be a tightly coupled, synchronous implementation such as in Java 2 Platform Enterprise Edition (J2EE), COM, or distributed COM (DCOM) examples. Alternatively or in addition, the interface may be a loosely coupled, asynchronous implementation such as in a web service (e.g., using the simple object access protocol). In general, the interface includes any combination of the following characteristics: tightly coupled, loosely coupled, synchronous, and asynchronous. Further, the interface may conform to a standard protocol, a proprietary protocol, or any combination of standard and proprietary protocols.","The interfaces described herein may all be part of a single interface or may be implemented as separate interfaces or any combination therein. The interfaces may execute locally or remotely to provide functionality. Further, the interfaces may include additional or less functionality than illustrated or described herein.","The present invention may be practiced with regard to any appropriate source , medium , and device . More concretely, the present invention for example could be used to enable a CD player to play a CD with protected music, to allow a set-top box to have access to a premium television broadcast, etc. Accordingly, the device  is to be interpreted to encompass any device that has a set of device keys (PU-PD, PR-PD) and is capable of receiving content  and an accompanying table  and obtaining the keys to render the received content  from the table  based on (PR-PD), or the like.","Programming that effectuates the processes performed in connection with the present invention is relatively straightforward and should be apparent to the relevant programming public. Accordingly, such programming is not attached hereto. Any particular programming may be employed to effectuate the present invention without departing from the spirit and scope thereof.","In the foregoing description, it can be seen that the present invention comprises a new and useful method and mechanism that allows the RM system  to tie the encrypted decryption key (KD) to an object such as a medium  such that the encrypted decryption key (KD) cannot be obtained except in the presence of such object\/medium . The object\/medium  may thus be portable, such as an optical or magnetic storage disk, so that a user transports the object\/medium  with the encrypted decryption key thereon among multiple computing devices  or playback devices .","In operation, computer  executes computer-executable instructions such as those illustrated in  and  to implement embodiments of the invention.","The order of execution or performance of the methods illustrated and described herein is not essential, unless otherwise specified. That is, elements of the methods may be performed in any order, unless otherwise specified, and that the methods may include more or less elements than those disclosed herein. For example, it is contemplated that executing or performing a particular element before, contemporaneously with, or after another element is within the scope of the invention. Further, the methods in whole or in part may be implemented in hardware (e.g., a large-scale integration implementation), software, or any combination therein (e.g., firmware) and be within the scope of the invention.","When introducing elements of the present invention or the embodiment(s) thereof, the articles \u201ca,\u201d \u201can,\u201d \u201cthe,\u201d and \u201csaid\u201d are intended to mean that there are one or more of the elements. The terms \u201ccomprising,\u201d \u201cincluding,\u201d and \u201chaving\u201d are intended to be inclusive and mean that there may be additional elements other than the listed elements.","In view of the above, it will be seen that the several objects of the invention are achieved and other advantageous results attained. As various changes could be made in the above constructions, products, and methods without departing from the scope of the invention, it is intended that all matter contained in the above description and shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense. It should be understood, therefore, that this invention is not limited to the particular embodiments disclosed, but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["As should be understood, the invention is not limited to the precise arrangements and instrumentalities shown in the following figures.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 3","FIG. 2","FIG. 2"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 4","FIG. 2","FIG. 2"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 6"},"Corresponding reference characters indicate corresponding parts throughout the drawings."]},"DETDESC":[{},{}]}
