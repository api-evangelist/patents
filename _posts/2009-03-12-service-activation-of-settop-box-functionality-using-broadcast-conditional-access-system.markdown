---
title: Service activation of set-top box functionality using broadcast conditional access system
abstract: A method, apparatus, and article of manufacture provide the ability to activate functionality in a set-top box . A feature authorization message is received in a set-top box . The feature authorization message comprises one or more rules to be evaluated (wherein each of the rules comprises one or more tests for a status of one or more conditional access module  attributes), one or more event requirements for rule evaluation, and one or more features that are dependent by the rule evaluation result (wherein each of the one or more features represents a set of one or more abilities of hardware and/or software of the set-top box ). When one or more of the event requirements have been met, the one or more rules are evaluated to obtain a result. The ability to use the one or more features are then set based on the result.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08079043&OS=08079043&RS=08079043
owner: The DIRECTV Group, Inc.
number: 08079043
owner_city: El Segundo
owner_country: US
publication_date: 20090312
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS","CONCLUSION"],"p":["1. Field of the Invention","The present invention relates to systems and methods for activating functionality in a set-top box and in particular to a method and system for a feature authorization scheme for activating set-top box capabilities.","2. Description of the Related Art","In recent years, there has been an increase in the interest and use in cable and satellite television services. Set-top boxes (STB) utilized to receive such services may also be used to offer additional advanced functionality that may require a monthly subscription. For example, personal video recording (PVR) and video games may be offered through the STB by a broadcast provider. In order to provide such STB services to customers of multi-channel programming, it is advantageous to have a method of activating services in a manner that is flexible and secure.","In the prior art, PVR service activation has utilized a two-way communication (such as by phone modem). For broadcast satellite receivers, it is advantageous if the STB service could be activated by one-way communication over the satellite.","It is especially advantageous if such a system were able to utilize the existing conditional access infrastructure for broadcast service authorization and billing using a secure smart-card in the STB. Such a system should preferably allow for flexible activation of a multitude of set-top box services with a similar level of security as the broadcast services. The prior art fails to provide such a method or capability. These problems may be better understood by a description of prior art conditional access services.","Broadcast service activation in the prior art involves authorization to receive an encrypted broadcast service, such as subscription television channels, or pay-per-view movie programs, or music or data services. These broadcast services are generally encrypted at the broadcast headend, and the conditional access controls include service activation and entitlement checking and the delivery of a decryption key (or control word CW) for the correct decryption of such broadcast services.","Conditional access for digital broadcast satellite (DBS) systems usually use a conditional access module (CAM) such as a smart card, for broadcast service activation. Authorization for services provided by the CAM are received by the CAM in over-the-air conditional access packets (CAPs). Broadcast services and programs have associated program access data (PAD) that specifies the services required for reception of that program, as well as possible limitations (e.g., regional blackout, parental rating controls). The PAD and CW for current programs are delivered via control word packets (CWP) to the CAM. The CAM checks the PAD, and if authorized, delivers the CW to the STB for program decryption.","The PAD for a future program is delivered to the CAM via program information packet (PIP) to allow pre-purchase of impulse pay-per-view (IPPV) programs or for checking authorizations before the broadcast (e.g., for guide \u201ccoloring\u201d). The CAM checks the future PAD and responds to the PIP test with the CAM status regarding the future program, for example \u201cauthorized\u201d, \u201cnot authorized\u201d, \u201cblacked out\u201d or \u201cIPPV allowed\u201d.","STB functions and services generally do not involve an encrypted stream of information, but merely the activation of advanced capabilities in the STB. Authorization for services provided by the STB may be activated in the CAM by over-the-air CAPs, and such authorizations may be checked by the STB via PIP test of the CAM.","The following description illustrates the service activation of DIRECTV DVR\u2122 service in a STB in the prior art using CAPs. Except for the STB's initial factory state (DIRECTV DVR Service State 0=\u201cunknown\u201d), the STB could only be in one of two states, DVR (digital video recorder) service authorized (e.g., DIRECTV DVR Service State 3=\u201cgood\u201d) and DVR service not authorized (e.g., DIRECTV DVR Service State 13=\u201cdeclined\u201d). Authorization for DIRECTV DVR service activation is provided by CAP authorization of a DVR service identifier in the CAM, which the STB checks via a PIP test \u201cIs DVR service authorized?\u201d for which the CAM status is \u201cauthorized\u201d or \u201cnot authorized\u201d.","The PIP for testing DIRECTV DVR Service is encapsulated within a vendor object (VO) sent via the advanced program guide (APG) stream, and stored in the APG database or hard disk drive of the STB. If a new version of the VO is received, and on a periodic daily basis, the PIP test is performed by the STB to check for the activation status of the DIRECTV DVR service. This check can result in the service being turned on or turned off.","If the service is off, and the user attempts to access a DVR function, the STB rechecks whether the service has been activated using the PIP. This check may result in the service being turned on or remaining off.","Upon power-up of the STB, or upon card removal or insertion, the service state reverts to off (i.e., service not active). The STB must test the CAM using the PIP to check whether the service is authorized. Similar to above, the check may result in the service being turned on or remaining off.","Thus, in view of the above description of the prior art, the only verification that occurs to activate STB functionality is that of periodically checking to determine if the CAM has been authorized for a particular service. In comparison, the broadcast television services require the CAM to supply a frequently changing decryption CW.","The present invention addresses the above-described problems of the prior art and provides verification rules to activate STB functionality. This invention also allows these verification rules and the corresponding STB functions to be flexibly defined by over-the-air feature authorization messages.","Activation of card-based services are allowed using conditional access packets and by a set-top box querying and verifying such activation in a secure and continuous manner. When a test packet and a rule for evaluating the CAM response is received from a service provider, verification techniques already existing in the smart card and embedded software in the STB may be used to ensure that the authorization is valid.","In accordance with one or more embodiments of the invention, a multitude of authorization tests may occur, with each test having a different response if the service is authorized, as specified by the evaluation rule.","Various examples may be used to illustrate the use of one or more of these methods. For example, the STB may issue a PIP test to the smart card in such a manner that the smart card must use the PAD information in the PIP test and the service authorization data in the smart card and return an answer that the STB would expect to receive but which response may not be predicted without an authorized card.","For example, there may a be a PIP test \u201cIs service A authorized?\u201d where the appropriate response is \u201cauthorized\u201d when service A is authorized. There may be a different PIP test \u201cIs service B authorized?\u201d where the appropriate response is \u201cnot authorized\u201d when service A is authorized. There may be a third PIP test \u201cIf service A is authorized, then a blackout applies\u201d where the appropriate response is \u201cblacked out\u201d when service A is authorized. In the prior art, the CAM status is explicit in the CAM response to a PIP test, whereas here the CAM status relative to service A must be evaluated by comparing the CAM response with the appropriate CAM response for each PIP test, as specified by the evaluation rule. With each test and correct response the confidence in the CAM status increases.","As another example, the packet being used for the test could be a control word packet (CWP), which would allow the additional step of incorporating the resulting control word (CW) into the response from the CAM. For example, the test provided to the STB may be a CWP where the appropriate response from the authorized CAM is the correct value of the CW. This also could be done in such a manner that each smart card\/STB combination would have a different value in response to the test, such as where the CW is encrypted.","In these examples, the unauthorized smart card would not respond correctly, especially if the test or the response were encrypted, or if multiple tests were issued in random order and performed on a regular basis within a relatively short time span.","This invention includes a flexible message structure, which delivers data from the broadcaster to the set-top receiver, to define the tests and rules for evaluating the status based on the responses from the CAM, to specify the corresponding set-top box features and services that may be activated if the response is appropriate, and the applicable period between consecutive queries.","To provide such functionality (e.g., DVR functions, games or other digital services), one or more embodiments of the invention utilize a feature authorization message (FAM) that contains rules that test the status of conditional access module (CAM) attributes, event requirements that provide the timing for evaluating the rules, and features (of the STB) that are dependent on the rule evaluation result. The FAM may be delivered to the STB in a variety of manners and is then utilized within the STB. A feature authorization manager within the STB determines when the event requirements have been met, evaluates the rules accordingly, and activates\/deactivates the dependent features depending on the result of the rule evaluation.","In the following description reference is made to the accompanying drawings which form a part hereof and which show, by way of illustration, several embodiments of the present invention. It is understood that other embodiments may be utilized and structural changes may be made without departing from the scope of the present invention.","Overview","The present invention is directed to a feature authorization scheme for activating set-top box capabilities. Specifically, the invention provides a software module that the receiver software must interact with to determine whether a customer's use of specific set top box features was authorized. The software code module is integrated with the main receiver software.","The general concept behind the invention may rely on two critical components of the conditional access system: the smart card and the conditional access software resident inside the set-top box (STB). If the STB software could ask the smart card to process a packet in such a way that only an authorized card could do correctly, then this may be used to activate features and functions within the STB. If the question is answered correctly once, then the authorization can be validated for a short time period. If a different question was asked again a short time later (e.g., 10 seconds), and the answer is still correct, then there is a higher confidence in the response. This round of questions and answers can continue until there is a very high confidence and feature authorization can be approved for a defined time (e.g., 24 hours) before the entire challenge process begins again. If at any time during this process, a question is answered incorrectly then the authorization for that service could be terminated immediately. This would ensure the service provider a high level of confidence that those who are receiving their services are actually authorized for its reception and those that are not authorized would have their access to that content stopped.","Video Distribution System",{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 1","b":["100","100","102","104","114","110","120","102","104","110"]},"The uplink center  receives program material and program control information from the control center , and using an uplink antenna  and transmitter , transmits the program material and program control information to the satellite . The satellite receives and processes this information, and transmits the video programs and control information to the subscriber receiver station  via downlink  using transmitter . The subscriber receiving station  receives this information using the outdoor unit (ODU) , which includes a subscriber antenna and a low noise block converter (LNB).","In one embodiment, the subscriber receiving station antenna is an 18-inch slightly oval-shaped Ku-band antenna. The slight oval shape is due to the 22.5 degree offset feed of the LNB (low noise block converter) which is used to receive signals reflected from the subscriber antenna. The offset feed positions the LNB out of the way so it does not block any surface area of the antenna minimizing attenuation of the incoming microwave signal.","The video distribution system  can comprise a plurality of satellites  in order to provide wider terrestrial coverage, to provide additional channels, or to provide additional bandwidth per channel. In one embodiment of the invention, each satellite comprises 16 transponders to receive and transmit program material and other control data from the uplink center  and provide it to the subscriber receiving stations . Using data compression and multiplexing techniques the channel capabilities, two satellites  working together can receive and broadcast over 150 conventional (non-HDTV) audio and video channels via 32 transponders.","While the invention disclosed herein will be described with reference to a satellite-based video distribution system , the present invention may also be practiced with terrestrial-based transmission of program information, whether by broadcasting means, cable, or other means. Further, the different functions collectively allocated among the control center  and the uplink center  as described above can be reallocated as desired without departing from the intended scope of the present invention.","Although the foregoing has been described with respect to an embodiment in which the program material delivered to the subscriber  is video (and audio) program material such as a movie, the foregoing method can be used to deliver program material comprising purely audio information or other data as well.","Uplink Configuration",{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 2","FIG. 2"],"b":["108","108","102","104","206","208"]},"The video channels are provided by a program source of video material A-C (collectively referred to hereinafter as video source(s) ). The data from each video program source  is provided to an encoder A-C (collectively referred to hereinafter as encoder(s) ). Each of the encoders accepts a program time stamp (PTS) from the controller . The PTS is a wrap-around binary time stamp that is used to assure that the video information is properly synchronized with the audio information after encoding and decoding. A PTS time stamp is sent with each I-frame of the MPEG encoded data.","In one embodiment of the present invention, each encoder  is a second generation Motion Picture Experts Group (MPEG-2) encoder, but other decoders implementing other coding techniques can be used as well. The data channel can be subjected to a similar compression scheme by an encoder (not shown), but such compression is usually either unnecessary, or performed by computer programs in the computer data source (for example, photographic data is typically compressed into *.TIF files or *.JPG files before transmission). After encoding by the encoders , the signals are converted into data packets by a packetizer A-F (collectively referred to hereinafter as packetizer(s) ) associated with each source .","The data packets are assembled using a reference from the system clock  (SCR), a control word (CW) generated by the conditional access manager , and a system channel identifier (SCID) generator  that associates each of the data packets that are broadcast to the subscriber with a program channel. This information is transmitted to the packetizers  for use in generating the data packets. These data packets are then multiplexed into serial data, encoded, modulated, and transmitted.","A special packet known as a conditional access packet or CAP, which comprises conditional access information (CAI) and other control data used in support of providing conditional access to the program material is also encrypted and transmitted. Thus, CAI is sent to the subscriber's receivers to authorize presentation of the media programs. CAI may also used to cancel service, renew service, and to transmit other information to the subscriber's receiver. The user's receiver routes the packets to a conditional access module (CAM) (see detailed description below). Using the CAI, the CAM allows the encrypted media programs to be decrypted, this activating\/deactivating service. Generally, CAPs are transmitted to all subscribers on all channels.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 3A","b":["302","1","200","304","206","306","5","200","1","200","216","218","220","222","106"]},"Subscribers  receive media programs via a subscriber receiver (also referred to as an integrated receiver-decoder [IRD] or set-top box [STB]). Using the SCID, the IRD reassembles the packets to regenerate the program material for each of the channels. As shown in , null packets created by the null packet module  may be inserted into the data stream as desired.",{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 3B","b":["302","316","320","322","324","200","326"]},"As shown in , when the data packet is a CAP, first packet segment  or the second packet segment  can include data ( or , respectively) indicating whether the CAP is a first type that is transmitted by all transponders (type A) or a data  or a type that is only transmitted by a subset of the transponders (type S). The first packet segment  or the second packet segment  can also be used to include data ( or , respectively) including a channel identifier that indicates which channel is transmitting the CAP. In one embodiment, one or more signal bits can used to indicate that some of the bits in the first  or second packet segments  include CAI type and\/or channel information. In another embodiment, data bits in the packet segment are dedicated to the transmission of the CAI type and\/or channel information (although other information may be transmitted using these bits when no CAI type or channel information is included in the data packet). The CAI can also be transmitted by substituting bits in the data payload .","Although the header of the illustrated embodiment is eight (8) bits, the size of the header can be increased or decreased in order to provide sufficient room to identify more CAP data types or to accommodate additional channel identifiers. If desired, the header size can be different for CAPs (versus packets that have media program information) or can adaptively change based on data requirements.","The continuity counter increments once for each packet type and SCID. The next packet segment  comprises 127 bytes of payload data, which is a portion of the video program provided by the video program source . The final packet segment  is data required to perform forward error correction.","Program Guide Subsystem",{"@attributes":{"id":"p-0059","num":"0058"},"figref":"FIG. 4","b":["206","206","402","404","406","406","406","408","408","408"]},"Schedule feeds  provide electronic schedule information about the timing and content of various television channels, such as that found in television schedules contained in newspapers and television guides. Schedule feeds  preferably include information from one or more companies that specialize in providing schedule information, such as GNS\u2122, TRIBUNE MEDIA SERVICES\u2122, and T.V. DATA\u2122. The data provided by companies such as GNS\u2122, TRIBUNE MEDIA SERVICES\u2122 and T.V. DATA\u2122 are typically transmitted over telephone lines to program guide database . These companies provide television schedule data for all of the television stations across the nation plus the nationwide channels, such as SHOWTIME\u2122, HBO\u2122, and the DISNEY CHANNEL\u2122. The specific format of the data that are provided by these companies varies from company to company. Program guide database  preferably includes schedule data for television channels across the entire nation including all nationwide channels and local channels, regardless of whether the channels are transmitted by the transmission station.","Program guide database  is a computer-based system that receives data from schedule feeds  and organizes the data into a standard format. Compiler  reads the standard form data out of program guide database , identifies common schedule portions, converts the program guide data into the proper format for transmission to users (specifically, the program guide data are converted into objects as discussed below) and outputs the program guide data to one or more of sub-databases .","Program guide data can also be manually entered into program guide database  through data entry station . Data entry station  allows an operator to enter additional scheduling information, as well as combining and organizing data supplied by the scheduling companies. As with the computer organized data, the manually entered data are converted by the compiler into separate objects and sent to one or more of sub-databases .","The program guide objects (referred to as program guide vendor objects) are temporarily stored in sub-databases  until cyclers  request the information. Each of cyclers  may transmit objects at a different rate than the other cyclers . For example, cycler A may transmit objects every second, while cyclers B and C may transmit objects every 5 seconds and every 10 seconds, respectively.","Since the subscriber's receivers may not always be on and receiving and saving objects, the program guide information is continuously re-transmitted. Program guide objects for programs that will be shown in the next couple of hours are sent more frequently than program guide objects for programs that will be shown later. Thus, the program guide objects for the most current programs are sent to a cycler  with a high rate of transmission, while program guide objects for later programs are sent to cyclers  with a lower rate of transmission. One or more of the data outputs  of the cyclers  are forwarded to the packetizer of a particular transponder, as depicted in .","It is noted that the uplink configuration depicted in  and the program guide subsystem depicted in  can be implemented by one or more hardware modules, one or more software modules defining instructions performed by a processor, or a combination of both.","Encryption of Media Programs","Media programs are encrypted by the encryption module  before transmission to assure that they are received and viewed only by authorized subscribers. Each media program is encrypted according to a numeric encryption key referred to hereinafter as a control word (CW). This can be accomplished by a variety of data encryption techniques, including symmetric algorithms such as the data encryption standard (DES) and the asymmetric algorithms such as the Rivest-Shamir-Adleman (RSA) algorithm.","To decrypt the media programs, the subscriber's  IRD must also have access to the CW. To maintain security, CWs are not transmitted to the IRD plaintext. Instead, CWs are encrypted before transmission to the subscriber's IRD. The encrypted CW is transmitted to the subscriber's IRD in a control word (data) packet (CWP).","In one embodiment, the data in the CWP, including the CW, is encrypted and decrypted via what is referred to hereinafter as an input\/output (I\/O) indecipherable algorithm.","An I\/O indecipherable algorithm is an algorithm that is applied to an input data stream to produce an output data stream. Although the input data stream uniquely determines the output data stream, the algorithm selected is such that it's characteristics cannot be deciphered from a comparison of even a large number of input and output data streams. The security of this algorithm can be further increased by adding additional functional elements which are non-stationary (that is, they change as a function of time). When such an algorithm is provided with identical input streams, the output stream provided at a given point in time may be different than the output stream provided at another time.","So long as the encryption module  and the IRD share the same I\/O indecipherable algorithm, the IRD can decode the information in the CWP to retrieve the CW. Then, using the CW, the IRD can decrypt the media program so that it can be presented to the subscriber .","Broadcast services and programs have associated program access data (PAD) that specifies the services required for reception of that program, as well as possible limitations (e.g., regional blackout, parental rating controls). The CAM compares the access requirements and limitations with service authorizations and subscriber attributes stored in the CAM, to determine whether or not service is permitted. The PAD may include expressions (or data structures equivalent to expressions) such as \u201crequired service=A\u201d, \u201cblackout service if geographic region B\u201d, \u201cif condition C do not evaluate the following expression\u201d, \u201cpurchase IPPV service=D at price=P\u201d, and \u201cprogram rating=R\u201d.","The PAD for a future program is delivered to the CAM via program information packet (PIP) to allow pre-purchase of impulse pay-per-view (IPPV) programs or for checking authorizations before the broadcast (e.g., for guide \u201ccoloring\u201d). The CAM checks the future PAD and responds to the PIP test with the CAM status regarding the future program, for example \u201cauthorized\u201d, \u201cnot authorized\u201d, \u201cblacked out\u201d, \u201cparental rating exceeded\u201d or \u201cIPPV allowed\u201d.","The PAD and CW for current programs are delivered via control word packets (CWP) to the CAM. The CAM checks the PAD, and if authorized, delivers the CW to the STB for program decryption. The CW may be encrypted by the CAM for delivery to the STB, using a key that is shared between the CAM and STB, which protects the value of the CW, and uniquely pairs the CAM and the STB.","Feature Authorization Message Overview","As described above, embodiments of the invention provide a feature authorization scheme for activating STB capabilities, such as personal video recording (PVR), video games, and other advanced functions that may require a monthly subscription for operation. In order to provide a variety of STB services to customers of multi-channel programming, it is advantageous to have a method of activating services in a manner that is secure and expandable.","To provide such functionality, the invention utilizes a feature authorization message (FAM). A FAM is an encapsulation of three elements: (1) one or more rules to be evaluated; (2) one or more timing requirements for rule evaluation; and (3) the features that are dependent by that evaluation result. A FAM may be transmitted to a an STB from a network operator (i.e., from uplink center ) in a variety of ways. The STB channels the received FAM to a specialized piece of software (which may be integrated with the main STB software), referred to as the vault manager (also referred to as a feature authorizer), that may store the FAM in random access memory and processes it. The vault manager interacts with a verifier in the STB (see detailed description below) but may run in a different address space from the verifier.","Thus, the vault manager may be asked (at particular times) whether a particular function\/features of the STB is authorized. The vault manager may interact with the verifier and\/or smart card to determine such authorization. As described above, the simplest form this interaction could take is the submission of a PIP for evaluation by the smart card and checking whether the response is consistent with the desired authorization. Rather than a direct query for authorization status, the PAD in the PIP may trigger an unpredictable response from the smart card, from which the authorization status can be deduced by comparison with a correct response delivered to the vault manager by the evaluation rule of the FAM. Additional interactions may also be permitted and with each test and correct response the confidence increases. Such additional interactions may rely on testing the card attributes like subscription ownership and region membership (all of which may be set or cleared via a standard CAP mechanism).","The vault manager's interactions with the smart card may generally involve delivery of some kind of data objects (e.g., PIPs in the simplest case) to the smart card. For example, when received, these objects may be packaged into FAMs that may only be kept in volatile memory and may never be stored on disk.","Feature Authorization Message Transmission","A FAM or FAMs can be embedded in a CAP that carries a data-to-sts (set top software) command. This allows signature validation and supports all modes of CAP addressing. In this regard, a CAP is one DSS (digital satellite system) packet, hence a CAP delivered token is small unless a frame layer is added so that two or more CAPs are formatted to deliver portions of the same FAM. A FAM or FAMs can also be delivered in a file to the feature authorizing client (in the receiver) using the satellite  data broadcast protocol specification. Additionally, a FAM or FAMs can be delivered in a System Information (SI) control stream, such as in the program guide or in a MPEG private section. An example of delivering a FAM in the SI is embodying a FAM inside a program guide Vendor Object (VO).","In view of the above, a FAM may be targeted to specific IRDs via a targeting mechanism in the CAP header (i.e., for FAMs delivered via the data-to-sts command). In addition to targeting a FAM to a specific IRD, FAMs may be targeted internally depending on the FAM structure. For example, a FAM be targeted based on one or more of the following:","(1) brand of IRD;","(2) hard disk;","(3) model;","(4) characteristics of the IRD; and","(5) any other property\/characteristic of the hardware of the IRD.","Thus, a FAM may be targeted regardless of whether it is sent via APG, data file broadcast, and\/or CAP.","Feature Authorization Message Details","The rules in a FAM can be complex Boolean expressions, or they can be compounded with other rules to strengthen the confidence of the result. In the former case, a rule could be \u201cif HBO\u2122 service is active or SHOWTIME\u2122 service is active and not CINEMAX\u2122 service is active.\u201d In the later case, a series of tests could be executed, and reexecuted, each progressively building confidence that the customer is legitimately entitled to a service.","The timing requirements in a FAM can be basic time of day instructions, such as every hour or at 10 pm, as well as event based, such as at subscriber service level adjustment.","There also can be two sets of testing rules and timing requirements: one to enable the set of features and another to maintain or disable the set of features.","The features described within a FAM are symbolic, and match those inherent in the receiver hardware or software. Features are switched on or off based on the rule evaluation. A feature is an abstract identifier that the receiver recognizes and maps to a set of abilities of the receiver's hardware or software. The receiver has abilities, and some are referred to as an activatable feature, and they are called f, f, f, . . . . Features are hard coded in the receiver's software and a feature's identifier is hard coded. A feature's identifier may be a hierarchical string (e.g. \u201cdvr.trick.pause\u201d), numbers, or a hybrid (e.g., a hierarchical string and\/or numbers).","As described herein, features of the STB may also be either hard features, soft features, or a combination of both hard and soft features. Soft features are arbitrarily defined features provided in the software of the STB (e.g., network offered services). Alternatively, hard features are features dependent on the hardware of the STB (e.g., commands to control or configure the hardware of the STB).","The receiver has these activatable features organized in sets, called s, s, s, . . . . The sets of features are defined via the interface and are not hard coded. Sets can be empty, or have one or more features. For ease of management and to achieve deterministic results, every feature may be required to be in exactly and only one set. The following provides examples of some sets:\n\ns1={f1, f2}\n\ns2={f3}\n\ns3={ }\n","Thus, as described herein, a FAM references a set of features, and supplies a rule and evaluation instructions. The set of features may be independently enabled or disabled by a rule's evaluated result. The rule may be called r. A receiver\/STB evaluates the rule per an evaluation instruction, called e.","Features may be mapped to sets based on network control (not hardcoded groupings). Additionally, a receiver might restrict the flexibility so that some features must be grouped together. Rules may be based on services authorized in a conditional access module (CAM) as described above or delivered straight to the STB in the form of commands addressed by data-to-sts commands (e.g. turn ON, turn OFF). Further, evaluation methods may be expressed for two phases: currently disabled checking to become on; currently enabled checking to become off. Evaluation events can be periodic time intervals, system states, or customer actions.","In addition to standard FAMs (as described above), one or more embodiments of the invention may provide for alternative types of FAMs. For example, in various embodiments, feature values may be set and can stack up. In this regard, a mechanism for resetting and deleting features and states that are no longer needed\/useful may be beneficial. Accordingly, embodiments of the invention may provide a FAM that lists those features that are currently valid. The vault manager may then process the FAM and delete those features that are not listed in the FAM.","It also may be desirable to configure properties of the vault manager via the broadcast. For example, it may be beneficial to set\/configure the cycles of the vault manager and examine features to see if events have occurred. Accordingly, an alternative type of FAM allows properties of the vault manager to be configured. For example, the FAM may provide the ability to set one or more of the following properties:","(1) the maximum number of features per FAM;","(2) the maximum number of events per FAM;","(3) the maximum number of targets per FAM;","(4) the maximum number of configurations per FAM;","(5) the maximum number of methods per FAM;","(6) the maximum total features;","(7) the maximum total number of soft features;","(8) the maximum total number of hard features;","(9) the maximum total number of events;","(10) the maximum total number of methods;","(11) the maximum total number of FAMs that may be stored;","(12) the maximum signature length; and","(13) the maximum conditional expression length.","Alternatively, instead of specifying maximum values for the above properties, such a FAM may specify minimum values, or specific values.","Feature Authorization Message Syntax Example","The description below is merely an illustrative example, lacking the data type definitions for a FAM. The example illustrates how features are combined into a set, and that set of features is clustered with rules to turn on and rules to turn off. Note that there can be multiple triggers to executing a given rule, and that there can be one or more methods of supplying the test to the IRD (by a data-to-STS command, an APG VO or a file delivered using the satellite data broadcast protocol).","The XML (extensible markup language) provided herein may be compiled or compressed into a binary format to reduce its size. Alternatively, a binary structure can be created similar to an MPEG private section, to present the same type of information as this XML example provides.","Table 1 provides an example of the terminology used herein.",{"@attributes":{"id":"p-0111","num":"0110"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"210pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Feature","A core capability of the IRD (e.g., pause, rewind, etc.). Features are"]},{"entry":[{},"hard coded in the receiver's software and a feature's identifier is hard"]},{"entry":[{},"coded. A feature's identifier is a hierarchical string (e.g."]},{"entry":[{},"\u201cdvr.trick.pause\u201d)."]},{"entry":["FeatureSet","A grouping of Features. A Feature can be included in more than one"]},{"entry":[{},"FeatureSet. The Features that comprise a FeatureSet is defined via"]},{"entry":[{},"network control. The FeatureSet is activated and deactivated via"]},{"entry":[{},"network control. A FeatureSet can be empty."]},{"entry":["RuleMethod","The method used for testing a Rule. A RuleMethod can be: (1) test one"]},{"entry":[{},"or more services authorized in the CAM; or (2) test one or more"]},{"entry":[{},"parameters delivered straight to the IRD via commands addressed by"]},{"entry":[{},"data-to-sts commands."]},{"entry":["RuleMethodSet","A grouping of methods to test a Rule. Any one RuleMethod in a"]},{"entry":[{},"RuleMethodSet can be used interchangably with all other RuleMethods"]},{"entry":[{},"in the RuleMethodSet."]},{"entry":["RuleEvent","The trigger used to test a Rule. A RuleEvent can be based on: (1)"]},{"entry":[{},"periodic time intervals, (2) system states, or (3) customer actions."]},{"entry":["RuleEventSet","A grouping of events to test a Rule. Any one RuleEvent in a"]},{"entry":[{},"RuleEventSet can trigger a test of the Rule. The result of which can"]},{"entry":[{},"enable and\/or disable the FeatureSet."]},{"entry":["Token","A record containing a FeatureSet, RuleMethodSet and RuleEventSet."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Table 2 provides an example of an XML definition for a FAM in accordance with one or more embodiments of the invention.",{"@attributes":{"id":"p-0113","num":"0112"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"char"}},{"@attributes":{"colname":"2","colwidth":"203pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 2"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","<!ELEMENT FeatureAuthorization ( Title, FileHeader, Token ) >"]},{"entry":["2","<!ELEMENT Title ( #PCDATA ) >"]},{"entry":["3","<!ELEMENT FileHeader ( FileType, FormatVersion, DataSource,"]},{"entry":[{},"CreationTime ) >"]},{"entry":["4","\u2003<!ELEMENT FileType ( #PCDATA ) >"]},{"entry":["5","\u2003<!ELEMENT FormatVersion ( #PCDATA ) >"]},{"entry":["6","\u2003<!ELEMENT DataSource ( #PCDATA ) >"]},{"entry":["7","\u2003<!ELEMENT CreationTime ( #PCDATA ) >"]},{"entry":["8","<!ELEMENT Token ( FeatureSet, RecordMethodSet, RecordEventSet)"]},{"entry":["9","<!ATTLIST Token RecordNumber NMTOKEN #REQUIRED >"]},{"entry":["10","\u2003<!ELEMENT FeatureSet ( Feature+ ) >"]},{"entry":["11","\u2003\u2003<!ELEMENT Feature ( #PCDATA ) >"]},{"entry":["12","\u2003<!ELEMENT RuleMethodSet ( RuleMethod+ ) >"]},{"entry":["13","\u2003\u2003<!ELEMENT RuleMethod ( RuleMethodID, RuleMethodType,"]},{"entry":["14","\u2003\u2003Code, Operand?, FileID?, VOObjectID? ) >"]},{"entry":["15","\u2003\u2003\u2003<!ELEMENT RuleMethodID ( #PCDATA ) >"]},{"entry":["16","\u2003\u2003\u2003<!ELEMENT RuleMethodType ( #PCDATA ) >"]},{"entry":["17","\u2003\u2003\u2003<!ELEMENT Code ( #PCDATA ) >"]},{"entry":["18","\u2003\u2003\u2003<!ELEMENT Operand ( #PCDATA ) >"]},{"entry":["19","\u2003\u2003\u2003<!ELEMENT FileID ( #PCDATA ) >"]},{"entry":["20","\u2003\u2003\u2003<!ELEMENT VOObjectID ( #PCDATA ) >"]},{"entry":["21","\u2003<!ELEMENT RuleEventSet ( RuleEvent+ ) >"]},{"entry":["22","\u2003\u2003<!ELEMENT RuleEvent ( Every | RuleEventID | RuleEventType |"]},{"entry":["23","\u2003\u2003RuleFunction | RuleMethodID )* >"]},{"entry":["24","\u2003\u2003\u2003<!ELEMENT Every ( #PCDATA ) >"]},{"entry":["25","\u2003\u2003\u2003<!ELEMENT RuleEventID ( #PCDATA ) >"]},{"entry":["26","\u2003\u2003\u2003<!ELEMENT RuleEventType ( #PCDATA ) >"]},{"entry":["27","\u2003\u2003\u2003<!ELEMENT RuleFunction ( #PCDATA ) >"]},{"entry":["28","\u2003\u2003\u2003<!ELEMENT RuleMethodID ( #PCDATA ) >"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Table 3 provides an XML example of a FAM that complies with the XML definition of Table 2. In this example, there are five (5) DVR features (i.e., rewind, fast-forward, skip-to-live TV, record and find), three (3) methods (i.e., data-to-sts, file and SI vendor object) and four (4) events (i.e., every 5 minutes, every 24 hours, IRD reset and CAM inserted) in a FAM. Any one (1) of the four (4) events can trigger the evaluation of a method, the result of which can authorize or de-authorize the five (5) features. For example the 5 minute periodic event results in the evaluation of the first method (i.e., the data-to-sts) method. For this method, the FAM provides a unique reference (i.e., \/code) to a previously specified data-to-sts command. This data-to-sts command can be a PIP test (i.e., as described above) or a CWP test (i.e., as described above). The evaluation of the PIP or CWP test results in a boolean (i.e., TRUE or FALSE). If the PIP test result is TRUE, the five (5) features are authorized; if FALSE, they are de-authorized.",{"@attributes":{"id":"p-0115","num":"0114"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"21pt","align":"char"}},{"@attributes":{"colname":"2","colwidth":"196pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 3"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["1","<?xml version=\u201c1.0\u201d?>"]},{"entry":["2","<FeatureAuthorization>"]},{"entry":["3",{}]},{"entry":["4","<Title>Feature Authorization Information<\/Title>"]},{"entry":["5",{}]},{"entry":["6","<FileHeader>"]},{"entry":["7","\u2003<FileType>feature authorization<\/FileType>"]},{"entry":["8","\u2003<FormatVersion>01<\/FormatVersion>"]},{"entry":["9","\u2003<DataSource>caus<\/DataSource>"]},{"entry":["10","\u2003<CreationTime>2002\/1\/12 23:30:05<\/CreationTime>"]},{"entry":["11","<\/FileHeader>"]},{"entry":["12",{}]},{"entry":["13","<Token RecordNumber=\u201c1\u201d>"]},{"entry":["14","\u2003<FeatureSet>"]},{"entry":["15","\u2003\u2003<Feature>dvr.trick.pause30min<\/Feature>"]},{"entry":["16","\u2003\u2003<Feature>dvr.trick.Multi-speed_REW<\/Feature>"]},{"entry":["17","\u2003\u2003<Feature>dvr.trick.Multi-speed_FF<\/Feature>"]},{"entry":["18","\u2003\u2003<Feature>dvr.trick.Skip-to-live<\/Feature>"]},{"entry":["19","\u2003\u2003<Feature>dvr.trick.Record<\/Feature>"]},{"entry":["20","\u2003\u2003<Feature>dvr.trick.Find<\/Feature>"]},{"entry":["21","\u2003<\/FeatureSet>"]},{"entry":["22","\u2003<RuleMethodSet>"]},{"entry":["23","\u2003\u2003<RuleMethod>"]},{"entry":["24","\u2003\u2003\u2003<!--Test with the Data_to_STS code 12345 value 1-->"]},{"entry":["25","\u2003\u2003\u2003<!--Data_to_STS code and structure is TBD-->"]},{"entry":["26","\u2003\u2003\u2003<RuleMethodID>1<\/RuleMethodID>"]},{"entry":["27","\u2003\u2003\u2003<RuleMethodType>DataToSTS<\/RuleMethodType>"]},{"entry":["28","\u2003\u2003\u2003<Code>12345<\/Code>"]},{"entry":["29","\u2003\u2003\u2003<Operand>1<\/Operand>"]},{"entry":["30","\u2003\u2003<\/RuleMethod>"]},{"entry":["31","\u2003\u2003<RuleMethod>"]},{"entry":["32","\u2003\u2003\u2003<!--Test with the file id 12345-->"]},{"entry":["33","\u2003\u2003\u2003<!--The file is transmitted per the satellite file broadcast -->"]},{"entry":["34","\u2003\u2003\u2003<!--protocol. The file structure is TBD-->"]},{"entry":["35","\u2003\u2003\u2003<RuleMethodID>2<\/RuleMethodID>"]},{"entry":["36","\u2003\u2003\u2003<RuleMethodType>File<\/RuleMethodType>"]},{"entry":["37","\u2003\u2003\u2003<FileID>12345<\/FileID>"]},{"entry":["38","\u2003\u2003<\/RuleMethod>"]},{"entry":["39","\u2003\u2003<RuleMethod>"]},{"entry":["40","\u2003\u2003\u2003<!--test using VO object ID 12345-->"]},{"entry":["41","\u2003\u2003\u2003<!--VO structure TBD-->"]},{"entry":["42","\u2003\u2003\u2003<RuleMethodID>3<\/RuleMethodID>"]},{"entry":["43","\u2003\u2003\u2003<RuleMethodType>VO<\/RuleMethodType>"]},{"entry":["44","\u2003\u2003\u2003<VOObjectID>12345<\/VOObjectID>"]},{"entry":["45","\u2003\u2003<\/RuleMethod>"]},{"entry":["46","\u2003<\/RuleMethodSet>"]},{"entry":["47","\u2003<RuleEventSet>"]},{"entry":["48","\u2003\u2003<RuleEvent>"]},{"entry":["49","\u2003\u2003\u2003<!--test every 5 minutes-->"]},{"entry":["50","\u2003\u2003\u2003<RuleEventID>1<\/RuleEventID>"]},{"entry":["51","\u2003\u2003\u2003<RuleEventType>Periodic<\/RuleEventType>"]},{"entry":["52","\u2003\u2003\u2003<Every>00:05:00<\/Every>"]},{"entry":["53","\u2003\u2003\u2003<RuleMethodID>1<\/RuleMethodID>"]},{"entry":["54","\u2003\u2003\u2003<RuleFunction>enable<\/RuleFunction>"]},{"entry":["55","\u2003\u2003<\/RuleEvent>"]},{"entry":["56","\u2003\u2003<RuleEvent>"]},{"entry":["57","\u2003\u2003\u2003<!--test every 24 hours-->"]},{"entry":["58","\u2003\u2003\u2003<RuleEventID>2<\/RuleEventID>"]},{"entry":["59","\u2003\u2003\u2003<RuleEventType>Periodic<\/RuleEventType>"]},{"entry":["60","\u2003\u2003\u2003<Every>24:00:00<\/Every>"]},{"entry":["61","\u2003\u2003\u2003<RuleMethodID>3<\/RuleMethodID>"]},{"entry":["62","\u2003\u2003\u2003<RuleFunction>disable<\/RuleFunction>"]},{"entry":["63","\u2003\u2003<\/RuleEvent>"]},{"entry":["64","\u2003\u2003<RuleEvent>"]},{"entry":["65","\u2003\u2003\u2003<!--test every time the receiver resets-->"]},{"entry":["66","\u2003\u2003\u2003<RuleEventID>3<\/RuleEventID>"]},{"entry":["67","\u2003\u2003\u2003<RuleEventType>IRD Reset<\/RuleEventType>"]},{"entry":["68","\u2003\u2003\u2003<RuleMethodID>2<\/RuleMethodID>"]},{"entry":["69","\u2003\u2003\u2003<RuleFunction>enable<\/RuleFunction>"]},{"entry":["70","\u2003\u2003\u2003<RuleFunction>disable<\/RuleFunction>"]},{"entry":["71","\u2003\u2003<\/RuleEvent>"]},{"entry":["72","\u2003\u2003<RuleEvent>"]},{"entry":["73","\u2003\u2003\u2003<!--test every time the CAM is inserted-->"]},{"entry":["74","\u2003\u2003\u2003<RuleEventID>4<\/RuleEventID>"]},{"entry":["75","\u2003\u2003\u2003<RuleEventType>CAM Inserted<\/RuleEventType>"]},{"entry":["76","\u2003\u2003\u2003<RuleMethodID>3<\/RuleMethodID>"]},{"entry":["77","\u2003\u2003\u2003<RuleFunction>enable<\/RuleFunction>"]},{"entry":["78","\u2003\u2003\u2003<RuleFunction>disable<\/RuleFunction>"]},{"entry":["79","\u2003\u2003<\/RuleEvent>"]},{"entry":["80","\u2003<\/RuleEventSet>"]},{"entry":["81","<\/Token>"]},{"entry":["82",{}]},{"entry":["83","<\/FeatureAuthorization>"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"In addition to the above, Table 4 provides examples of the functions that may be utilized with a FAM.",{"@attributes":{"id":"p-0117","num":"0116"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"thead":{"row":[{"entry":"TABLE 4"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Void initialize (char**","This function is called by the STS at"]},{"entry":["fam_buf)","power-up (at least) to initialize its internals."]},{"entry":[{},"The argument is the address of a buffer to"]},{"entry":[{},"use for FAM storage. The size of this"]},{"entry":[{},"buffer must be at least 4096 bytes."]},{"entry":["int FamReceived(char*","This function must be called by the STS"]},{"entry":["fam)","whenever a new FAM is received, whether"]},{"entry":[{},"in a FAM vendor object or in a FAM data-"]},{"entry":[{},"to-STS command. The buffer may be"]},{"entry":[{},"reused by the STS immediately after the"]},{"entry":[{},"call. The return value is zero if the FAM is"]},{"entry":[{},"valid and nonzero otherwise (e.g., due to"]},{"entry":[{},"authentication failure)."]},{"entry":["int TestFeature(int","The STS calls this function to determine"]},{"entry":["feature_code)","whether use of a controlled feature is"]},{"entry":[{},"authorized. The argument is one of a"]},{"entry":[{},"predefined set of feature codes. The return"]},{"entry":[{},"value is zero if the feature is not authorized."]},{"entry":[{},"Otherwise the return value is a positive"]},{"entry":[{},"value indicating the number of seconds into"]},{"entry":[{},"the future for which the feature is to be"]},{"entry":[{},"considered authorized. The STS must call"]},{"entry":[{},"TestFeature( ) again within the specified"]},{"entry":[{},"interval to extend the authorization."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"To disable one or more features quickly (e.g., within T seconds), TestFeature( ) would not return a time larger than T. Thus, the functions of Table 4 provide a polling solution with customizable polling intervals. The expectation is that if a playback is begun after TestFeature( ) returns a time of one minute, then TestFeature( ) would be called again within one minute and the playback would be stopped if the answer the second time does not return a time period.","The application programming interface (API) functions described above are intended to be examples of the various types of functions that may be implemented and utilized. Variations and alternative API functions are also within the scope of this invention. For example, instead of the TestFeature( ) method specifying a time (for polling the vault manager) (as described above), the vault manager may utilize a push methodology. In a push model, the vault manager would asynchronously push a feature state change every time it occurs in the feature manager. Further, the feature manager would maintain a state table.","Accordingly, various additional API functions for a feature manager (i.e., from the vault manager to the feature manager) may be provided. For example, a function may provide the ability to: clean out\/delete\/purge soft features in the feature manager; set default feature state values; query existing feature states; and\/or react to the default state of hard\/soft features.","Integrated Receiver\/Decoder",{"@attributes":{"id":"p-0121","num":"0120"},"figref":"FIGS. 5A-D","b":["500","500","118","100","500"]},"The IRD  is communicatively couple-able to a conditional access module (CAM) . The CAM  is typically implemented in a smart card or similar device, which is provided to the subscriber  to be inserted into the IRD . Vault Manager  and\/or other applications in IRD  have a need to frequently check the state of IRD's  features. However, the evaluation of the features' rules may not be continuously executed. Such non-continuous execution is because rule evaluation is a high resource task that could interfere with normal conditional access functions of the IRD .","Vault manager  is responsible for maintaining information relating to the features in IRD . For example, when IRD  starts up or resets, vault manager may initialize the state of the IRD's  features. In this regard, vault manager  may push values into a feature state table. Additionally, timing requirements may cause the vault manager  to occasionally send newly evaluated rule results to the feature state table throughout the IRD's  normal operation.","The feature state table may also be referred to as a \u201cfeature manager\u201d or cache since it may provide a high-speed cache of all feature states. Accordingly, the feature state table may be a random access memory (RAM) resident table so that tampering with the table while the IRD  is inactive is not possible.","Each row of the feature state table represents the state of a single feature. If a feature is internally represented by an integer, then indexing the table is straight forward. If features are internally represented as strings, then a prior step may be needed to map the string into an integer to allow table indexing. Alternatively, some higher order languages provide symbol indexed tables intrinsically and the compiler or interpreter may handle the indexing via strings.","Once the vault manager  receives one or more FAMs, the vault manager  obeys the timing requirements and sends initial evaluation results to the feature manager\/feature state table. In order to get a FAM, the vault manager  either receives it from the broadcast  or retrieves it from non-volatile memory (NVM) . Upon IRD  initialization, fresh acquisition of a FAM is preferred. In the later case, NVM  storage must be signed so that no FAM tampering could have occurred while the receiver  was powered off. In either case, signature validation may be required on all retrieved FAMs from the transmission broadcast  or from NVM .","Two methods may be used to protect and validate FAMs stored in NVM  from unauthorized tampering.","Encryption by the Receiver for NVM Storage","If storage in NVM  is to be performed, a unique key is needed to prevent wide spread distribution of a tampered FAM.  illustrates how such an encryption\/decryption could be done, using a unique private key  assigned to the receiver . These unique keys  must be securely handled by the receiver  hardware (e.g., using encrypting  and decrypting  modules) so that the keys  are never exposed. Every receiver  would store a FAM that is uniquely encrypted  for successful read-back and subsequent acceptance by the vault manager . The advantage of this approach is that the receivers  need not acquire FAMs from the satellite  upon IRD  initialization. This potentially minimizes satellite  bandwidth requirements and receiver  initialization processing delay for older subscribers . However, because the broadcast still needs to support new subscribers  that must acquire FAMs for the first time, there may not be any bandwidth savings.","Encryption Only by the Broadcaster","A second method is to broadcast every FAM as an already encrypted entity and never allow NVM  storage.  illustrates such a methodology. The broadcaster's encryption key would provide sufficient security in this case, because the FAM in RAM  would not be exposed by the receiver  application for external tampering and replacement back to RAM . The FAM will be encapsulated in a super-structure that can be used to (1) decrypt  the FAM and to (2) authenticate the FAM as being from the network operator.",{"@attributes":{"id":"p-0130","num":"0129"},"figref":["FIG. 6","FIG. 5B","FIG. 5B"],"b":["600","602","604","606","504","504","514","502","504","504","600","514"]},"The steps to process the file super structure  to derive the FAM are illustrated in . Vault Manager , which is communicatively coupleable to the CAM , receives the file superstructure . The CAM  interfaces with a conditional access verifier (referred to as verifier)  which performs at least some of the functions necessary to verify that the subscriber  is entitled to access the media programs.","The Vault Manager communicates with the verifier  by delivering the CWP  from the file superstructure  to verifier . The control word (CW) key is obtained from the CWP  using the verifier  and the CAM . The CW key is then transferred back to the Vault Manager  from the verifier .","Once Vault Manager  receives the appropriate CW key, it may use the key to decrypt  the encrypted FAM  received in the file super-structure . In this regard, the CW key may be processed in a hash function  to obtain a hash value. The hash value may then be combined  with the signature  from the file super-structure  and a public key in order to validate and authenticate the FAM. If the validation is successful, the decrypted FAM is provided to the feature manager .","It should be noted that the use of such a CWP and CW to successfully decrypt and validate the FAM may only be performed when the CAM has the appropriate authorizations. Note also that this novel use of a CWP and CW may be applied instead of or in addition to the use of one or more CWP and CW in the evaluation of a rule in processing a FAM, as disclosed earlier herein.","In accordance with various embodiments of the invention, Vault Manager  processes all FAMs, evaluates them according to the rules, and sends their results to the feature manager .  further illustrates the processing of a FAM. As illustrated, The FAM may be transmitted to the IRD  via APG VOs, data broadcast files, or data-to-sts commands via multiple CAPs (bundled by an STS client). Once received, the new verifier  (which essentially comprises the existing verifier  [as described above] and the vault manager ) processes the FAMs, evaluates them according to the rules, and send their results to the feature manager  which may interact with other IRD  applications. Thus, FAMS provide the capability to activate set-top box  functionality. Further, the FAM allows structured rules and timing requirements to improve confidence of entitled services.","Logical Flow",{"@attributes":{"id":"p-0136","num":"0135"},"figref":"FIG. 7","b":["700","500","502","500"]},"At step , a determination is made if one or more of the event requirements have been met. As illustrated, the process does not continue until an event requirement has been met. Event requirements may comprise a periodic time interval, a system state, or a customer action, for example. Once an event requirement has been met, one or more rules are evaluated at step  to obtain a result at step . In this regard, the features that are tested may be evaluated using a cache that is maintained in the STB  that contains states for each of the one or more features. Additionally, the features may comprise an abstract identifier that the STB  recognizes and maps to the set of one or more abilities. The ability to use the one or more features set forth in the FAM is then set based on the result at step . Setting such an ability may comprise setting an interval of time for which the one or more features are enabled\/disabled.","As described above, the FAM may be embedded in a conditional access packet that carries a data-to-sts command, may be received in an encrypted file via a satellite data broadcast protocol specification, may be received in a system information control system, and\/or may be embodied inside a program guide vendor object. Accordingly, the FAM may be uniquely encrypted and then stored in the nonvolatile memory of the STB . Alternatively, the FAM be stored in random access memory. Further, the FAM may be received in a super-structure that contains a control word packet (that generates a decryption key), a signature that authenticates the FAM, and an encrypted FAM.","This concludes the description of one or more embodiments of the present invention. The foregoing description of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of the above teaching.","It is intended that the scope of the invention be limited not by this detailed description, but rather by the claims appended hereto. The above specification, examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention, the invention resides in the claims hereinafter appended."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Referring now to the drawings in which like reference numbers represent corresponding parts throughout:",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 3A"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 3C"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 5A"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 5B"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 5C"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 5D"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
