---
title: Systems and processes for call and call feature administration on a telecommunications network
abstract: Improved systems and methods for call and call feature setup, administration and processing on PSTN and other telecommunications networks are provided. Calls are set up on a service plane of a conceptual switch that includes a switch plane, control plane, and service plane that are analogous to the OSI layered model of networks including a physical layer, network layer and application layer. Call set-up logic is separated from the switching fabric, allowing for flexible, on-demand, modification of service options using software while maintaining the same switching fabric in hardware. Call set-up is accomplished by a call request made upon connection of a call to the switch. This causes a call agent to search an eXtensible Markup Language knowledge base to find a web page corresponding to the initiating caller. The Web page may be collocated with the switch or on a LAN with the switch or on the “Web,” even on the caller's termination equipment (telephone).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07069291&OS=07069291&RS=07069291
owner: CopperCom, Inc.
number: 07069291
owner_city: Boca Raton
owner_country: US
publication_date: 20020614
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE ILLUSTRATED EMBODIMENT"],"p":["This application is a continuation of same-titled U.S. patent application Ser. No. 09\/965,659, filed Sep. 27, 2001, which is a continuation of same-titled U.S. patent application Ser. No. 09\/735,288, filed Nov. 21, 2000, which is a continuation of same-titled U.S. patent application Ser. No. 09\/519,557, filed Mar. 6, 2000, which claims the benefit of priority of U.S. patent application Ser. Nos. 60\/123,322 (filed Mar. 6, 1999 for SYSTEM AND PROCESS FOR SERVICE PLANE CALL SET-UP FOR TELEPHONY NETWORKS), 60\/142,250 (filed Jul. 2, 1999 for SYSTEM AND PROCESS FOR EXTENSIBLE TELEPHONY SERVICE POLICY) and 60\/147,633 (filed Aug. 6, 1999 for SYSTEM AND PROCESS FOR SERVICE PLANE CALL HANDLING FOR TELEPHONY NETWORKS).","The invention pertains to telephony and, more particularly, to systems and processes for call and call feature setup, administration and processing on public switched telephone networks (PSTN) and other telecommunications networks.","Voice telephony (and data communication via telephone modem) today is conducted primarily by \u201ccopper loops\u201d or wireless transmission (via base station) from the user or subscriber to a central office (Class 4) switch that initiates the process of connecting the call to its ultimate destination, whether in the same local exchange handled by the central office, or to a remote central office. The call set-up process involves a series of \u201ctrigger points\u201d wherein the service options available to the caller are checked against a database that is periodically downloaded to the switch from the local carrier's database (typically relational, i.e., table-based). At the central office switch of the receiving subscriber, a similar sequence is followed to check such service options as call waiting or call forwarding. Updates of the databases are cumbersome, and adding new services requires additional programming and trigger points in an already complex code.","The process of call set up outside the local service area further requires an \u201cout of band\u201d communication over the SS7 (\u201cSignaling System 7) network and protocols distinct from the network over which voice traffic flows. It is this system that allows the proper switching of traffic for roaming cellular subscribers and for 800- and 900-numbers. It also provides caller identification. The system, however, is limited in its bandwidth and by the small number of knowledgeable programmers.","The prior art has made advances in the middle or \u201ccontrol\u201d layer of a three-layer network model for voice telephony as part of a trend towards \u201cAdvanced Intelligent Networks\u201d (\u201cAIN\u201d). These advances have involved call agents using the SS7 network to control new functionality in call set up and the upgrading of the International Telecommunications Union H.323 Internet protocol for coordination of voice, data, and video traffic on the Public Switched Telephone Network (PSTN). For example, Bellcore and Cisco developed the Simple Gateway Control Protocol (SGCP) to improve on H.323 and Level 3 developed the Internet Protocol Device Control (IPDC). The Media Gateway Control Protocol (MGCP) is a merger of SGCP and IPDC sponsored by the Internet Engineering Task Force to migrate SS7 functions into Internet Protocol (IP).","The current state of the art remains one of limited service options. Any change in service requires the reloading of service maps stored in relational data bases; each new variable for service requires another table, essentially another dimension in the relational database. Each variable is implemented at a stop point in switching fabric. Switches still require complex programming and cost in the millions of dollars.","It is an object of the present invention to provide improved systems and methods for call and call feature setup, administration and processing.","The foregoing are among the objects attained by the invention, which provides improved systems and methods for call and call feature setup, administration and processing on PSTN and other telecommunications networks.","According to aspects of the invention, calls are set up on a service plane of a conceptual switch that includes a switch plane, control plane, and service plane that are analogous to the OSI layered model of networks, which includes a physical layer, network layer and application layer. Call set-up logic is separated from the switching fabric, allowing for flexible, on-demand modification of service options using software, while maintaining the same switching fabric in hardware.","In related aspects of the invention, call set-up is accomplished by a call request made upon connection of a call to the switch. This causes a call agent to search an eXtensible Markup Language knowledge base to find a Web page corresponding to the initiating caller. The Web page may be collocated with the switch or on a LAN with the switch or on the \u201cWeb,\u201d even on the caller's termination equipment (telephone). The Web pages may be modified easily and flexibly. The control of call set-up using Internet search techniques results in a highly flexible system of telephony that can be characterized as \u201cVoice Under IP.\u201d\u2122","In further and related aspects, the invention provides a network architecture referred to herein as Extensible Service Policy Architecture (ESPA) for delivering telephony and other services utilizing web-based service logic and IP message distribution for signaling. ESPA divides the functions of call processing into manageable layers. At the top layer, it provides a platform that unifies service definition across multiple systems and protocols.","ESPA provides a bridge between the IP-based information community and the SS7-based PSTN, thus opening the PSTN to a wealth of new services driven by IP. By combining IP\/web-based technology like LDAP (Lightweight Directory Access Protocol), web search engines, JAVA, CORBA, and\/or Call Policy Markup Language or CPML (discussed below) with traditional telecommunications technology such as SS7 and TCAP, aspects of the invention achieve a service network whereby web-based applications and customers can reach the information resource and customers of the PSTN and visa versa.","ESPA provides the environment to integrate services supported by prior art systems, through AIN\/IN and services supported through CTI (Computer Telephony Interface). In doing so, ESPA simplifies the network configuration and management. Moreover, by using proven and open standard technology and using web pages to house service logic, ESPA gains the advantage of speeding the time-to-market for new services and applications.","Due to the mobility of web pages (because of search engine), and due to the accessibility of web page (because of http), ESPA puts the control of features and service into the hands of customer and service providers instead of vendors. It gives to customers new services in a controllable environment and to service providers the tools to differentiate themselves from others.","Further and related aspects of the invention provide a client\/server architecture in which a switch performs as a client responsible for collecting call information, monitoring caller activities, and performing basic call process. As a server, an IP based network is responsible for creating and maintaining service information (the logic and the data) as well as providing the service information to switches upon request.","Yet still further and related aspects of the invention provide for the use of XML-based script language to define call processing and services.","Systems according to still yet further and related aspects of the invention permit the creation, maintenance and provision of service logic and related data through a distributed architecture at least in part separate from switches. Such systems can be implemented utilizing the web technologies, such that\n\n","These and other aspects of the invention, as well as advantages thereof, are evident in the drawings and in the detailed description that follows.","Subscriber features in telephone network are created to provide telephone users with varieties of services in terms of pricing, quality of service, security, performance, accessibility, information sharing, and etc. Several examples are listed below to illustrate subscriber features.\n\n","Over the decades, a large number of subscriber features have been implemented in the telephone network which greatly empower individuals as well as business community. In today's competitive telecom market, differentiating services and features becomes one of the most important strategies for telephone service providers.","While the existing telecommunication technologies, including digital switching system (called switch), database, intelligent network, enable hundreds of subscriber features, they fail to meet the expectation at least at two fronts. First, it takes long time and high cost to implement features. This causes problem not only for adding new features to existing equipment, but also making it hard for vendors to introduce next generation of equipment. Second, the existing approach does not fully take the advantage of information available outside telephone network.","Specially, the information available on Internet is growing, and the combination of telephone network and Internet creates a previously unrealized potential for more advanced and powerful subscriber features. For example, in contrast to traditional Call Forward, a feature according to the present invention may allow a called party to redirect a terminating call to a new destination or an recorded announcement, based on the called party's personal schedule listed on web-site. By way of further example, a caller may also be allowed to make a call using name and address instead of telephone directory number, and the translation of name and address to direction number can be done through Directory Service on the Internet.","To understand the difficulty of features creation, one must understand how today's switched telephone network works.",{"@attributes":{"id":"p-0055","num":"0062"},"figref":"FIG. 1"},"To establish or tear down a communication path between a caller and the called party (call setup and call release), call information such as called party number as well as line and trunk status has to be passed through the originating CPE to switches and to the terminating CPE. This is done through a system called signaling system.  show two typical signaling systems used for call setup and tear down between two switches. In the configuration of , the so-called MF (Multi-Frequency) wink-start signaling system is used to carry calling party's billing, called party number, and carrier selection information. The line or trunk status is conveyed through \u201crobbed-bit\u201d.","In the configuration of , the so-called System Signaling No. 7 (SS7) is used. Unlike MF signaling, SS7 utilizes an external packet data network to convey call information from one switch to the next. The signaling network consists of SSPs (Signaling Service Point)\u2014switches with SS7 capability, and STPs (Service Transfer Point)\u2014packet data switches capable of routing SS7 messages to destinations. The connectivity between signaling points is provided with a set of links (called A-, B-, C-, D-, E-, or F-link depending on the functionality of the link) each with a bandwidth of 56 kbits\/s. Comparing with MF signaling, SS7 provides not only faster call control but also delivers a lot more call information to support features.","There are several matters involved in providing subscriber features: call information, service logic, basic call processing, and the status of facility. The call information provides, inter alia:\n\n","Call events typically include:\n\n","Call events are monitored in switches. A subscriber feature may be involved in any of these events.","Service logic for controlling subscriber features utilizes call information, the status of facilities and call events. In a layered model, the service logic is sitting on top of call control logic and signaling control logic as well.",{"@attributes":{"id":"p-0062","num":"0081"},"figref":"FIG. 4"},"Many features can be provided to subscribers in terms of choosing service providers. For instance, customer can be allowed to choose two carriers: one for local toll calls, the other for domestic and international toll calls. More sophisticated routing features may involve other information, such as time scheduling, the origination location of the call and etc. With the present invention, many useful route schemes can be implemented easily.","According to the prior art, the control logic, including signaling, basic call control and service logic, as well as data for supporting features are tightly associated with the hardware.  demonstrates a typical configuration of such switches. Other than the switching fabrics and interface for transportation and signaling, a switch system is equipped with CPUs running signaling, call control and service logic. To support subscriber features, it is also equipped with a local memory for storing database. In such system, the hardware, software and data are tightly coupled in the sense that the format of the data only is applicable to the specific implementation of the software, and the software from a vendor can only be run on a specific hardware environment. The hardware can not be upgraded and new customer features can not be added without major rework on the software.","To make situation even worse, relational databases, which are widely used in prior art systems, require highly rigid and complicated structures of information. Very often the data used to support a feature has to be mapped into tables regardless whether table is a good fit for the problem or not. When the features are simple and are not subject to frequent modifications, this approach may be acceptable. However, it becomes a big problem when features are required to be personalized or to be changed in real-time.","The difficulty comes from several fronts. The complexity of the relationship among tables is increased exponentially when the factors related to features increased. Second, the redesign of the schema of database is often needed when a new feature is introduced, no matter whether the new features are used by one customer or all customers. Every time when the schema is changed the whole database has to be rebuilt. In the routing example shown in , a relational database can be designed such that the destination type (like 911 call, operator call, long distance call etc) is used as index to the desired trunk groups. However, the database becomes complicated when time-sensitive or location-sensitive routing is desired for instance, even if there is few customers subscribed to that feature.","A simple configuration of Advanced Intelligent Network (AIN) is depicted in . In this architecture, a signaling point called SCP (Signaling Control Point) is provided. A SCP is a computer platform with SS7 connectivity, and it is loaded with software that has access to external database. In AIN, a switch (SSP) has the capability of setting up triggers and providing standard basic functions. When a call event occurs, a trigger may be encountered, and an AIN query is sent to SCP. Based on the query certain service logic is invoked on the SCP and a response will be sent back to SSP. A SCP can be accessed by any SSPs in the network, therefore the service logic and the supporting data in the SCP can be shared by many switches in the telephone network.",{"@attributes":{"id":"p-0068","num":"0087"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0069","num":"0088"},"figref":"FIG. 8"},"At the transmission level, technologies such as Ethernet, ATM, TMD, SONET, and etc. are used. The connection in the network is TCP\/IP based, and on top of it, HTTP (Hypertext Transfer Protocol) is used for communication between client users and web-servers. The information is presented in formats like HTML or XML. The messages between clients and servers are routed via IP switch or router. Comparing with SS7 network, the bandwidth of IP based network is much cheaper, and the implementation of software is easier.","The client can be a browser or any application software with HTTP to communicate with servers. One of the main functions of a client in the network is to retrieve and transfer information. It is done through \u201cGET\u201d\u2014retrieve information, \u201cPOST\u201d\u2014transfer information, and \u201cPUT\u201d. As part of a client user, there is an HTML parser or XML parser used to abstract the information in web pages and present it in a tree fashion. The applications in a client take the information and process them.","The information in IP network is transferred and stored in either HTML or XML format, within so-called web pages that are identified with URLs (Uniform Resource Locators). In SS7 based network, the physical location of service information is important for SSP and STP in order to send service requests to the right servers. In contrast, in web-based information world, knowledge (web pages) is defined, maintained and stored independently. One page is related to others through hyperlink (a URL embedded in a web page). This allows information with complicated contents to be organized in a distributed and loosely coupled fashion.","HTML and XML (eXtensible Markup Language) are text based script languages, using \u201ctag\u201d and attributes to represent information objects. Unlike HTML, XML allows user to define new tags and attributes as needed to present the logic structure of information in a natural way. In comparison with traditional data structure used in database, information presented with XML is machine-readable and human-readable.",{"@attributes":{"id":"p-0074","num":"0093"},"figref":"FIG. 9","b":["10","15","20","20","25","30","35","40","45","30","50","55","60","40","65"]},"In the illustrated embodiment of the invention, call service logic is decoupled from the switch. In operation, a call request comes through the switch . The switch proxy  allows the call setup system to operate with existing switches. So, the switch  may be any one of a number of existing switches used in telephone networks.","The call request is forwarded to the service agent . A service agent  manages the call data retrieval process. The service agent  has a number of search engines, the XML-enabled originating server , the XML-enabled terminating server , and the XML-enabled Digit translation server , that go through the Web server , using the index server , to find Web pages in the knowledge base . The Web pages in the knowledge base have data on how a particular call should be handled. Once the service agent , finds the appropriate Web page in the knowledge base , it parses that Web page into switch instructions. The service agent  sends the switch instructions back to the switch through the switch proxy . The switch instructions are layered onto the switch and the switch handles the call according to the delivered instructions.","The service agent, in the illustrated embodiment of the invention is XML-based meaning XML or a similar standard (e.g., CPML, as described below). eXtensible Markup Language (XML) was developed by the SGML Editorial Board formed under the auspices of the World Wide Web Consortium (W3C) in 1996. XML is a pared-down version of Standard Generalized Markup Language (SGML), designed especially for Web documents. However XML is also useful for object-oriented databases.","The following is a list of intelligent telephony services that may be offered using one preferred embodiment of the present invention. The list of services is merely exemplary and the services available using the present invention is not limited to those listed.","Abbreviated dialing (ABD): This service is an originating line feature that allows business subscribers to dial others in their company using, e.g. only four digits even if the calling user's line and the called user's line are served by different switches.","Account card calling (ACC): This service allows the caller to be automatically charged on a telephone account subscribed with the network operator, for any type of outgoing call. The caller has to dial his or her card number and a PIN, then the called number. As an option, forward calls may be allowed, without dialing the card number and PIN again.","Automatic alternative billing (AAB): This service allows a user to call another user and ask him or her to receive the call at his or her expense. Two steps are involved: the calling party is welcomed to record a brief message giving the caller's name and explaining the call reason, then the called party is alerted, receives the recorded message and is asked to accept to be charged for that call.","Call distribution (CD): This service allows a subscriber to having incoming calls routed to different destinations, according to an allocation law which may be real-time managed by the subscriber. Three types of law may exist: 1) circular distribution, where the calls are routed to the different locations with a uniform load; 2) percentage distribution, where the calls are routed to the different locations according to a percentage; and 3) hierarchical distribution, where the first location to be chosen is the first met in the priority list. In addition, congestion at one location may cause overflow calls to be routed to an alternate location.","Call forwarding (CF): Call forwarding allows the called user to forward calls to another telephone number when this service is activated. With this service, all calls destined to the subscriber's number are redirected to the new telephone number. This service is under control of the subscriber and can be activated\/deactivated by the subscriber. When this service is activated, the subscriber's line will receive an alerting ring, \u201creminder ring\u201d, to indicate that the service is activated.","Call rerouting distribution (CRD): This service permits the subscriber to have his or her incoming calls encountering a triggering condition (busy, specified number of rings, queue overload or call limiter) rerouted according to a predefined choice: the calls may be rerouted to another destination number (including pager or vocal box), rerouted on a standard or customized announcement, or queued.","Conference calling add-on: This service allows the user to reserve a conference resource for making a multi-party call, indicating the date, time and conference duration. Once the conference is active, the user controls the conference, and may add, drop, isolate, reattach or split parties.","Conference calling meet-me: This service allows the user to reserve a conference resource for making a multi-party call, indicating the date, time and conference duration. In due time, each participant in the conference has to dial a special number which has been attached to the booked conference, in order to access the conference bridge.","Credit card calling (CCC): This service allows the caller to be automatically charged on a bank card account, for any type of outgoing call. The caller has to dial his card number and a PIN, then the called number.","Destination call routing (DCR): This service allows customers to specify the routing of their calls to destinations according to: a) time of day, day of week, etc.; b) area of call origination; c) calling line identity of customer; d) service attributes held against the customer; c) priority (e.g. from input of a PIN); f) charge rates applicable for the destinations; and g) proportional routing of traffic.","Follow-me diversion (FMD): With this service, a user may register for incoming calls to any terminal access. When registered, all incoming calls to the user will be presented to this terminal access. A registration for incoming calls will cancel any previous registration. Several users may register for incoming calls to the same terminal access simultaneously. The user may also explicitly deregister for incoming calls.","Originating call screening (OCS): Originating calls may be controlled by the originating call screening capability. This allows the subscriber to specify that outgoing calls be either restricted or allowed, according to a screening list and, optionally, by time of day control. This can be overridden on a per-call basis by anyone with the proper identity code. Typical scenarios might include: 1) Calling user A attempts to make a call. The call is screened via the screening list assigned to the originating line. The call is allowed to complete and is connected; 2) Calling user A attempts to make a call to a line with deactivated override feature. The call is screened via the screening list assigned to the originating line. The call is not allowed to complete. Because the override option is not active, there are no override prompts; 3) Calling user A attempts to make a call to a line with an activated override feature. The call is screened via the screening list assigned to the originating line. The call is not allowed to complete. Because the override option is active, the user is prompted for the identity code and enters the proper code. The call is connected.","Security screening (SEC): This capability allows security screening to be performed in the network before an end-user gains access to the subscriber's network, systems, or applications. Access code abuse detection is a capability which will generate a report on the invalid access attempts: how many, over what time period, by whom, and from where. This provides an added layer of security. The following are typical call scenarios for these capabilities: 1) Caller A dials subscriber's DN, enters correct personal identification number (PIN) when prompted, clears network screening and is connected. Call data is recorded. 2) Caller B dials subscriber's DN, enters invalid PIN on first and subsequent prompts, fails network screening, and is connected to announcement. Call data is recorded and reports of invalid codes attempted are printed. 3) Caller C dials subscriber's DN, initially enters incorrect PIN, but corrects it upon re-prompt, clears network screening, and is connected. Call data is recorded along with re-prompts\/re-entries.","Selective call forwarding on busy\/don't answer (SCF): Selective call-forwarding\u2014busy\/don't answer (SCF-BY\/DA) allows the called user to forward particular pre-selected calls if the called user is busy or does not answer within Y seconds or X rings. The calls will be pre-selected based upon an SCF-BY\/DA list. This list will have 1 to 5 or 1 to 10 numbers with a default call forward number for calling users not in the list. There will also be remote access and time of day indicators for this capability. Typical scenarios may include: 1) Called user B has SCF-BY\/DA assigned. Caller A dials B's number, called B does not answer the phone with Y seconds. Based upon the SCF-BY\/DA list, caller A is forwarded to user C. 2) Called user B has SCF-BY\/DA assigned. Caller D dials called B's number, called B is busy with called user C. Based upon the SCF-BY\/DA list, caller D is forwarded to user E. 3) Called user B has SCF-BY\/DA assigned. Call A and Caller C dial called B's number, called B does not answer the phone within Y seconds. Based upon the SCF-BY\/DA list entry for caller A, caller A is forwarded to user D. Caller C is not in the list, therefore caller C is forwarded to default user E.","Selective call forwarding: This service permits the user to have his incoming calls addressed to another number, no matter what the called party line status is, if the calling line identify is included in, or excluded from, a screening list. The user's originating service is unaffected, even for charging.","Call forwarding on busy: This service permits the user to have his incoming calls addressed to another number, if they encounter a busy condition. The user's originating service is unaffected, even for charging.","Call forwarding on don't answer (no reply): This service permits the user to have his incoming calls addressed to another number, if they encounter no reply. The user's originating service is unaffected, even for charging.","Terminating call screening (TCS): Terminating calls may be controlled by the terminating call screening capability. This allows the subscriber to specify that incoming calls be either restricted or allowed, according to a screening list and optionally, by time of day control. Typical scenarios might include: 1) Calling user A attempts to make a call to B. The call is screened via the screening list assigned to B's line. The call is allowed to complete and is connected. 2) Calling user A attempts to make a call to B. The call is screened via the screening lit to B's line. The call is not allowed to complete and is connected to an announcement.","Universal access number (UAN): This service enables a service provider to publish a national number and have incoming calls routed to a number of different destinations based on the geographical location of the caller. One typical scenario might have the published national number as a free phone number. There should be an option to provide the service provider with subscriber data on all incoming calls such as date and time of call and the service provider's location that the call was routed to.","User-defined routing (UDR): This capability allows the subscriber to specify how outgoing calls, from the subscriber's location, shall be routed, either through private, public, or virtual facilities or a mix of facilities, according to the subscriber's routing preference list. These lists will apply to individual lines or to several lines at the subscriber's location. Typical scenarios might include: 1) Calling user A dials from the subscriber's line; the subscriber's routing list specifies the call will only be routed over private facilities. 2) Calling user A dials from the subscriber's line and the subscriber's routing list allows public facilities between 1600 and 0800 and private facilities 0800 to 1600. Time is 1531, so call is routed only over private facilities to location. Calling User A now dials from subscriber's line at 1608 and so call is routed over public route to the destination.","Time-dependent CF: Forward call depending on time-of-day, day-of-week, holiday, etc.",{"@attributes":{"id":"p-0100","num":"0119"},"figref":"FIG. 10"},"Extensible Service Policy Architecture (ESPA)","Voice services make up two-thirds of the revenues of even the most data-centric major carrier, and custom calling services provide more local exchange revenues than all data services combined. While data will certainly make up a major new source of profits, the winning carrier in today's competitive market will be the one who makes the most of voice. Thus, voice service creation is an essential ingredient for differentiation, and ultimately the success of the next generation communications provider.","A pure IP network promises to deliver a rich set of telecommunications features, but circuit, packet, and cell switching will coexist for years to come. A solution that recognizes the transitional and fragmented state of the network is needed for providing carriers with the ability to rapidly implement new, customized services.","The Extensible Service Policy Architecture (ESPA) of the invention defines a network architecture for delivering services that utilizes web-based service logic and IP message distribution. ESPA provides a framework for services creation, deployment, and administration based upon the model of the Internet. It is designed to provide a common structure on which to implement and scale applications that can be used over any transmission or switching media.","As discussed, historically, telecom networks were constructed from a generic set of class 4 and 5 switches. Now they are built from an expanding set of multi-service, multi-media network elements. AIN's drive for functionality led to increased complexity and has proven itself not conducive to robust service creation.","ESPA recognizes the need for interoperability with AIN based switches yet rejects the notion that the complexity of an AIN interface should be extended to other network elements. Instead, ESPA draws upon the full range of Internet, XML, and Web tools to deliver a service creation and delivery environment for next generation networks. It brings the legacy PSTN under the supervision of a powerful and flexible IP based control network to immediately achieve the robust functionality promised by IP called \u201cVoice under IP\u2122\u201d. VoIP (Voice over IP) delivers simplified and more economical networks, however \u201cVoice under IP\u2122\u201d delivers services.","With different network models being introduced as rapidly as the number of carriers and their corresponding business models, service creation must be simplified. ESPA separates service creation from network control and achieves its power through simplicity. Today, carriers must rapidly deliver new services, differentiated from those of their competitors, over networks based upon different transmission methodologies and consisting of varied switching elements, protocols, and APIs. ESPA offers a common, simple method of service definition that binds these different environments and can scale from a personal or enterprise to a large carrier.","ESPA is set-apart, at least in part, by its reliance upon a combination of search engine technology and new tools (based on XML) for storing knowledge along with data to distribute call policy (applications) to web pages. It is an open architecture which relies on APIs to communicate with network elements such as switches and an open XML-based language called Call Policy Markup Language (CPML) for service definition.","CPML is an open language according to the invention that is used to simply describe call processing. CPML is an extension of XML (eXtensible Markup Language) that is a standards-based, meta-language from which other languages are derived. CPML permits migration of the operations of the telecommunications network, including its features, functions, and enhanced services, out of the world of proprietary operating systems, structured databases, and complex programs or APIs. CPML opens the telecommunications network to basic IP tools that bring order to its complexity and empowers carriers, and ultimately customers, to control, customize, and extend the functionality and usefulness of the telecommunications network.","Like HTML, CPML is used to create web pages. Unlike HTML pages that are used to present visual context, CPML pages are designed to be used by a network switching element to present the appropriate service logic (switch action) for a particular customer, or group of customers.","ESPA makes use of search engine technology in a real time mode. This attribute is called the \u201cDynamically Searchable Policy.\u201d An ESPA based network has the power to quickly locate among a loosely coupled body of data the correct web page for needed service logic and then to interpret that page into switch functions. Central to this ability is CPML which leverages internet technologies to enable the execution of service logic in an interpretive manner rather than from compiled code.","For a typical call in an ESPA based network, a switch will convert the information associated with a call (i.e. calling party number, destination number, carrier choice, time schedule) into keywords in an internet type search which are used to locate the correct CPML web page. That page will incorporate service logic (i.e. routing, restrictions, digit-translation, etc.), scripted in CPML, which will be interpreted into switch function.",{"@attributes":{"id":"p-0112","num":"0131"},"figref":"FIG. 11"},"1. A Service Switching Element  is a physical switching element in the network that may be a Class 5 switch, ATM switch, DSLAM, RAS, PBX, IAD, Router, or other.","2. A Service Agent  is a network based software module adapted to the underlying Service Switching Element in order to mediate signaling and interpret control. It functions as a proxy to underlying protocols such as MGCP, or APIs such as PARLEY. The Service Agent  communicates with a higher level Service Portal for service logic.","3. A Service Portal  is a web site used to house, access, organize, and index service logic elements. The service portal incorporates a number of functional elements including directory servers, a firewall if open to the internet, search engines, call policy servers, application servers, a billing event manager, an SNMP agent, a CPML interpreter, and a repository for CPML pages. The Service Portal continuously indexes the locations of service logic elements, and upon query from a service-switching element, searches and interprets service logic and associated data points into switch function.","4. Service Logic Elements  include CPML pages, databases (i.e. LNP, calling name, LDAP . . . ), a configuration directory, and other internet-based information that might be used in call processing. The CPML repository and other call processing information can be co-located with the Service Portal or at any desirable web site. A strength of ESPA is that it can incorporate into call processing any information available on the Internet (at a carriers option).","An application of the extensible service policy architecture is the DXC Class 4\/5 switch , shown in . The DXC switch performs switch and routing configuration, SS7 functions, and service definition. A second application of the extensible service policy architecture is the switch , shown in . The switch  is a multi-service switch that incorporates the basic functionality of a Class 4\/5 switch. The switch  improves upon the scale and density of the DXC switch , offering superior interface flexibility, and incorporating voice processing and VoIp capabilities.","Designed to play a critical role in many network configurations for next generation carriers, the switch  is a powerful DSP based voice-processing platform. It can fill the roll of a carrier tandem, end office, an enhanced services platform, an intelligent peripheral, or a VoIP gateway.","A real differentiation for the switch  is its capability to deliver features. Its fabric incorporates tremendous voice processing capability, and it is the flexibility of the Telecommunication Services Portal that enables the switch  to translate those capabilities into services.","In operation, the Telecommunication Services Portal (TSP) is queried upon receipt of a call into the switch. The TSP locates and interprets the appropriate CPML page that defines the call process model. For example, a typical call process for call setup includes the following components:\n\n","Upon searching and interpreting all relevant service logic and data, the TSP delivers to the switch instructions.",{"@attributes":{"id":"p-0122","num":"0146"},"figref":"FIG. 14"},"1. Separation of service logic from transmission, hardware, and signaling\u2014ESPA separates into logical planes, as shown in , the functions required for call processing, making them easier to manage and enhance. The CPML pages, themselves, relate only to a definition of the service and avoid characteristics that would tie the service logic to a particular switching platform or transmission methodology. Through this abstraction, ESPA CPML can be simplified to the degree where authors of services do not have to have detailed technical knowledge.","2. Compatibility\u2014A natural extension of the abstraction and layering used by ESPA is its ability to be made compatible with multiple systems, protocols, and transmission methods. As a language for defining service logic, CPML is independent of the underlying network (i.e. TDM, ATM, or IP) and is system independent in the sense that CPML defines call behavior that operates across multiple network elements. Through the use of a service portal and appropriate service agents, call behavior can be located and presented via the correct protocol to multiple types of systems.","3. Loosely coupled and distributed information\u2014One functional element of a Service Portal is a Policy Server that performs the search and interpretation function: first locating the controlling CPML page and then interpreting its content into switch function. In a world where carriers can have thousands, or millions of customers, each desiring custom call behavior, the data and the applications, themselves, have to be decoupled to achieve scale and reliability. The ability to define CPML pages for individual subscribers enables powerful flexibility without the complexity of rigidly organizing all customer data into a relational database. The interdependency between customer applications is broken. Just as a nonfunctional web page does not impact the operation of the Internet as a whole, a poorly written feature does not affect other customers. In additional, the logic and data referenced for call processing may easily be distributed onto different servers or networks.","4. Searchable information\u2014The loose coupling of data presents a problem with access to that information by a real time application. Fortunately, the Internet has spawned powerful tools such as search engines to solve this problem. ESPA relies upon the fuzzy logic of search engines to quickly locate requested data, and can operate efficiently with a widely distributed base of information.","5. Interpretative logic execution\u2014Today's dynamic market demands more features, carrier differentiation, and subscriber customization. Modern techniques such as object-oriented programming make software easier to adapt to the requirements of an evolving market but do not change the basic model common in telecommunications of shared program logic coupled to a relational database. The nature of this model makes software upgrades that require a change to the database cumbersome. The tight coupling of service logic and database mandates significant regression testing of features upon upgrade. Rather than being a repository for service logic programming (i.e. compiled code), the Call Policy Server module of the Service Portal functions as a CPML interpreter. This interpretative function allows the editing of individual features or specific subscriber implementations of features and is one of the key reasons that ESPA enables rapid service creation.","6. Concise, open language\u2014CPML is a concise language that reduces the description of call processing to the minimal set of approximately 30 elements. The simplicity of this open message set is the essence of its power.","7. XML defined service logic\u2014CPML is an extension of XML (Extensible Markup Language). One way of thinking of XML is as a universal data translator. XML provides a standard framework with which data can be organized, and through this organization it allows knowledge to be stored along with data. Data stored in XML is often referred to as a knowledge base rather than a database.","8. Extensibility\u2014Because of its open architecture and reliance upon the basic tools of the Internet, ESPA allows tremendous extension of its functions. Its Services Logic Elements may include widely distributed CPML pages as well as data elements inclusive of any data present on the Internet. For example, an Internet based personal calendar (i.e. \u201cvCalender\u201d) may be referenced to determine that a subscriber's calls should be forwarded because he\/she is out of town. In addition, CPML pages can be enhanced with JAVA servlets or linked to other applications.","9. Scalability\u2014ESPA operates with low latency under heavy call load and can easily scale to handle millions of busy hour call attempts through a single Service Portal. Additionally, its architecture allows software functions to be distributed for even greater scale and reliability.","Robust service creation requires a solution that bridges switched and IP networks\u2014one that is simple, nimble, scaleable and leverages tools that have proven themselves by handling the incredible expansion of the Internet. The answer is to bring the legacy PSTN under the supervision of a powerful and flexible IP based control network to achieve now the robust functionality promised by IP.","By using XML (eXtensible Markup Language) to create a simplified telecommunications control language common to PSTN and VoIP networks, system integrators, service providers and subscribers are empowered to create and maintain features with the same ease that people publish and maintain web pages. By further leveraging the high transaction search and interpret tools available today, a carrier can create a service network that is scaleable in capacity, extensible in function, highly accessible and reliable. By combining all these functions, a carrier can take control of telecommunications services with a software architecture that will outlive the network's transition from circuit switched to IP based transmission. The architecture that delivers this control is the Extensible Service Policy Architecture.",{"@attributes":{"id":"p-0134","num":"0158"},"figref":"FIG. 15"},"Advantages of using XML in this manner includes the low-cost associated with software development because of the widely availability of third party software such XML parser and authoring tools.","In an IP network-based system according to the invention, a web-server provides services to clients by receiving request (GET, POST, PUT) from clients through HTTP, processing it and sending response back in HTML or XML format. Normally a web-server maintains web pages, and when a retrieval request is received from a client the URL is used to identify the page. Several technologies such as Java, CGI and Servlet further empower a server. With these technologies, information in legacy format (such relational database) can be available to web client. The data conversion is done by applications in server \u201con-fly\u201d. Comparing with proprietary technologies like SS7, web-server as information repository provides excellent scalability, security, reliability, and maintainability in a much lower cost.","The IP network, as used in systems according to the invention, endorses a distributed architecture in which information (web page and legacy data) are loosely coupled in the sense that they are stored, created and maintained individually. Updating and creating data imposes minimum impact on using other data. The format or structure of one group of data does not depend on the format or structure of other data. The programmers and users of client software is not required to know in advanced the location of the information of interest.","The search engine plays a role in an Internet architecture. When certain information is desired, the users use \u201ckeywords\u201d to describe the piece of information, and send them to the search engine. A search engine normally contains indexed tables that consist of URLs of information available in the network and the corresponding searchable keywords. A component called \u201cspider\u201d is constantly running to visit every known web-side, and the indexed tables are updated based on that. When a request from a HTTP client is received, a search engine takes the keywords and applies a set of pre-defined rules (such as full-text-search, tag-search, and etc) to retrieve the URL of relevant information from the index tables. The accuracy of the information retrieved pretty much depends on the keywords and the search rules applied. With the capability to define \u201ctag\u201d based applications, using XML to describe information can improve search accuracy greatly. \u201cCache\u201d technology and \u201csearch tree\u201d technology usually is used in search engine to improve the search performance.","Call Policy and Call Policy Markup Language","The text based script language, Call Policy Markup Language (CPML), according to the invention describes call-related policy. CPML is an application of XML. It defines a set of \u201ctags\u201d called \u201celements\u201d that are used to describe call conditions and actions. A collection of conditions, called \u201cscenario\u201d together with one action, such as \u201crelease a call\u201d or \u201credirect a call\u201d, forms a rule, called \u201ccase\u201d. When a call event matches a condition, the call control takes the action. Service logic behind subscriber features is presented as a series of policies each further presented as a collection of rules.","A policy can be designed to be associated with a specific call process.","For example, an \u201coriginating policy\u201d for call originating process, \u201crouting policy\u201d for call routing process, \u201cterminating policy\u201d for call terminating process. A policy may cover multiple service features. For instance, a \u201coriginating policy\u201d can be designed to cover to features like authentication, ANI screening, destination restriction, service denial, and etc. Additional user information like PIN may be collected in the process. A \u201crouting policy\u201d can be designed to cover all the features PIC-routing, location-sensitive routing, time-sensitive routing, service-sensitive routing, scheduled routing, PIN-based routing, and etc. A \u201cterminating policy\u201d may cover features like, \u201cselective call acceptance\u201d, \u201csecurity screening\u201d, \u201ccall forwarding\u201d, and etc. A policy can be designed for an individual, a group of individuals, and a network facility such as a trunk group or even a switch to realize a specific set of service features.","A rule can be as simple as \u201cunconditionally reject any incoming call request\u201d by setting the condition set as empty and the action as \u201crelease call\u201d. A more complicated rule could be \u201cif a call is a toll call, use carrier A on Monday to Friday from 8:00 AM to 18:00 PM\u201d. In this case, the condition is \u201cthe call is a toll call\u201d, the schedule is \u201cMonday to Friday from 8:00 AM to 18:00 PM\u201d, and the action is \u201croute the call to carrier A\u201d.","Multiple rules may be used with a policy. A possible routing policy, for example, may consist of the following three rules:\n\n","In one preferred implementation, a policy may be presented on pages written in CPML language. A CPML page (simple called \u201cpage\u201d when meaning is clear) consists of an identifier, a title, policy type, the owner of the policy, the priority, and rules.\n\n","In the highest level, a CPML script includes like a collection of CASEs (rules), and each CASE contains one scenario, one schedule (optional), and one action. The scenario describes \u201cWhat happens\u201d, the schedule describes \u201cWhen it happens\u201d, and the action describes \u201cWhat to do\u201d. Multiple CASEs are allowed on a page, and they should be listed on the page in linear sequential order. When a query is received from a switch, the call information is used to check against each CASE in sequential order from the top to the bottom. In the checking process, the scenario and schedule within a CASE will be tested. A scenario is satisfied if the call information match the condition described by the scenario. A schedule is satisfied if the current time matches the schedule condition. An action is selected, only if both the scenario and the schedule are satisfied. The \u201cchecking process\u201d stops when an action is selected.","Like any other web page, a CPML page can be linked to other CPML pages through hyperlink.","CASE Element. It describes a rule by associating a collection of a snapshot of call condition (SCENARIO element) with a schedule (SCHEDULE element) and an action (ROUTE element, RELEASE element, REDIRECT element, COLLECT element, and LINK element). When a query is received from a switch, the call information will be used to test against SCENARIO and the current time is used to test against SCHEDULE.","The result of testing SCENARIO and SCHEDULE will be either \u201cYes\u201d or \u201cNo\u201d. The action in the CASE should be taken when \u201cYes\u201d is returned from both SCENARIO and SCHEDULE.  shows a simple CASE used as part of routing policy. It states that \u201cBlock international calls\u201d. CASE can have an attribute NAME.",{"@attributes":{"id":"p-0149","num":"0182"},"figref":["FIG. 17","FIG. 18"]},"SCENARIO and INFO elements. SCENARIO lists a collection of snapshots on a call condition described by INFO element. Each INFO element describes a test condition that includes two parts: 1) a specific parameter of a call, defined by attribute \u201cELEMENT\u201d, 2) how the parameter should be checked, defined by attribute \u201cLOOKUP\u201d. A parameter could be a destination number (destType), a carrier identification code (CIC), a calling party number (CPN), a personal identification number (PIN), an authorization code (AuthCode), and etc. See table 1 for pre-defined call parameters. A call parameter is checked against an object presented with an URL. In this following example,\n\n","Basically, there are three different types of checking:\n\n","Check a call parameter by invoking a plug-in Servlet module. This allows to develop customized software for checking a call parameter, thus provides powerful extensibility to CPML.","The return of LOOKUP is either \u201cTRUE\u201d or \u201cFALSE\u201d. The test result of INFO is \u201cTRUE\u201d when\n\n","The result of INFO is \u201cFALSE\u201d when\n\n","The return of SCENARIO is a production of each return of INFOs when the attribute \u201cLogic\u201d has value of \u201cAND\u201d; the return of SCENARIO is a sum of each return of INFOs when the Logic has value of \u201cOR\u201d.",{"@attributes":{"id":"p-0156","num":"0197"},"figref":"FIG. 22"},"SCHEDULE and PERIOD element. This element is used to define a time condition. It consists of a collection of time period defined by PERIOD element. PERIOD uses attribute \u201cStart\u201d and \u201cEnd\u201d to indicate the beginning and the end of a time period. Like INFO element, PERIOD can be associated with attribute unitLogic with value \u201cnot\u201d for reversed logic. Like SCENARIO, SCHEDULE element can be associated with an attribute \u201clogic\u201d with value of \u201cand\u201d and \u201cor\u201d. The return of testing SCHEDULE depends on the return of PERIODs as well as attributes unitLogic and Logic.","In the example shown in  is the same as shown in , except that the call restriction is limited to Saturday and Sunday.  demonstrates the power of negative logic. In this case, the call restriction is limited to Monday, Tuesday, Wednesday, Thursday, and Friday. Notice that without the reversed logic, the script will be much longer as shown in .","The basic time are presented as follows:\n\n","Listed below is valid PERIOD:\n\n","The first one indicates Monday through Friday. The second one indicates Jan. 31, 1999 to Oct. 31, 1999. The third one indicates 5:000 AM on Jan. 31, 1999 to 8:00 PM on Oct. 31, 1999. The last one indicates 5:00 AM to 6:00 PM on everyday.","COLLECTION, ROUTE, REDIRCT, RELEASE and LINK elements. These elements describe the basic service actions. The attribute TARGET is an URL, which is used to describe the application software module that executing an action. In , the \u201croute\u201d action is executed by routing software module residing within the policy server. In , an external servlet is linked through the URL \u201chttp:\/\/www.MyHost.com\/servel\/MySpecialTask\u201d.","The COLLECT function is used to collect user information such as PIN, menu selection, authorization code, and etc. There are several attributes associated with this element to indicate the things like\n\n","In , the 12-digit PIN is collected through entity \u201csw\u201d with pre-prompt \u201cannc\u201d.","At the highest level, a voice service consists of a connection resource (a network for voice paths) and a service logic resource. A connection resource could be a Time Division Multiplex (TDM) based network, or an ATM based circuit network or an IP based network. ESPA defines a structure for the service logic resource that is compatible with any type of connection network. shows a preferred implementation of ESPA. It is made up of the following major elements:\n\n","A Service Switching Device (SSD) that provides the actual voice switching, DSP functions like voice compression, recognition, DTMF, MF tone detection and generation, call progress tone generation and detection, recorded announcement, n-party conference, and etc.","In another preferred implementation of ESPA as shown in , a Proxy Server instead of Service Agent is implemented. In this configuration, the SSD has more intelligence than the SSD in in the sense that it performs not only switching function and DSP functions but also signaling control and call control functions. In this configuration, standard protocol such as TCAP or IN, or a proprietary protocol or API may be used by the SSD, and the PS's main function is to link a SSD to TSP.","The ESPA adopts a client\/server model. The SSD is a client to the SA and the SA is a server to the SSD. On the other hand, a SA or a PS functions as a client to the PS and the PS functions as the server to SA or PS. In ESPA, there could be multiple platforms for each function element. Most likely, one TSP can provide service to multiple SAs or PSs, one SA can be provide service to multiple SSDs.","The SS7 and IP protocol are the preferred communication protocols used in ESPA. A SSD can be connected to SA through varieties of approaches. It could be TCP\/IP based protocol such as MGCP and IPDC, it could be an API such as TAPI (Telephony API), S.100, SCAI, and etc. A SSD may also choose SS7 to communicate with SA. A SA is connected to PS of TSP through UDP of TCP\/IP protocol. TSP is an IP network. Within it, the Policy Server is communicated with Search Engine (SE) through HTTP, communicated with Directory Server (DS) through Lightweight Data Access Protocol (LDAP), communicated with application modules through TCP\/IP or COBRA, communicated with CPML repository servers with HTTP. The application software may choose any proper protocol to communicate with other modules or network elements. For example, the application software responsible for LNP translation can be implemented such that it uses TCP\/IP to communicate to Policy Server and use SS7 TCAP to communicate to AIN (Advanced Intelligent Network). A SSD may also use TCAP or IN to communicate with Proxy Server.  shows the connectivity of the main elements in ESPA.","The ESPA adopts a client\/server model. As a client, SSD and SA always initiates a request and response session with TSP. There are two types of request, one is request for initialization and another is request for call process.","The request of initialization results in the information download for signaling control and call handling. It includes data and control logic. In one preferred implementation, the original data, including basic line or trunk configurations, tables for digit analysis, signaling interface configurations, are stored in directory server and also CPML in TSP. When a facility of SSD (such as a line or a trunk group) is power up and after recovery, it sends a request to SA or PS for initialization information. The call control logic such as basic call model is also downloadable. A basic call model defines various stages of the life of a call. Typically, it may contain the following states:\n\n","In each state a service request could be sent to TSP in order to support service features. For example, an in \u201cverification\u201d, a request with call information could be sent to TSP to determine a \u201croute\u201d for the call. CPML page or other means can be used to describe the call model and \u201ctrigger\u201d for sending request. By allowing SSD and SA to download configuration data and control logic, greatly enhanced'the programmability of telephone network.","Message Flow of Request for Call Process","A request for incoming call setup is initiated by SSD (when the SSD contains call control functions) or SA (when the call control functions is in SA) as shown in . The service request contains call information such as calling party number, called party number, line information, carrier information as well as facility information such as line or trunk ID, Trunk group ID and switch ID. The request is sent to TSP and is handled by a Policy Server.","In order to handle the request, the Policy Server needs to identify the proper policy page that contains the service logic to support the services the caller subscribed. The Policy Server takes the call information and converts them into key words and sends them to a CPML search engine through HTTP. The URLs of matched CPML pages are returned to Policy Server. The CPML pages are, therefore, retrieved from the web-server where they reside.","A Policy page associated with the facility or the caller is identified and parsed. The call condition is used to map the rules described by the policy, and a proper action (release, route, collect, redirect and etc) sent back to SA as a response.","The Basic Model\u2014a Perspective from a Switch Device","Major events:",{"@attributes":{"id":"p-0176","num":"0000"},"ul":{"@attributes":{"id":"ul0032","list-style":"none"},"li":"1. Incoming call set-up. An incoming call is a call incoming in from another switch, or a terminal (phone set and PBX for example) connected with this switch through a circuit (a DS trunk or a pair of copper wire). This Switch monitors circuits and response to call set-up request with proper action based-on signaling protocol."}},"The format of set-up request varies depending on the specific signaling protocol used. In in-band signaling case, a typical protocol is E&M wink-start, in which the proceeding switch signals an off-hook through so called robbed-bit signaling. In out-band signaling case, a typical protocol is SS7, in which an Initial Address Message (IAM) is sent to this switch.","This switch collects call information. Call information normally includes address information like called party number, caller's information like calling party number and redirecting party number, billing information like charge party number and ANI, call type like residential call and prison call etc, carrier selection information like carrier identification code and other. The among of information available varies depending on the signaling protocol. Normally, out-band signaling like SS7 and ISDN carries more call information than in-band signaling.","In out-band signaling, it may take one or multiple messages for the other end conveying the call information to the switch. In in-band signaling, it may take one or multiple sections of digit sequences. It is assumed that the knowledge of signaling used in the switch is pre-configured such that there is no need for switch to communicate with the service network.","The Switch sends query with information it collected to Call Policy Server through proxy, and then pause the call process. A response from Policy Server or an application server should be received within a short period of time\u2014in one preferred implementation it should be within 200 ms. The response contains actions the Policy Server or an application server wants the switch to take. Possible actions are call routing, information collection, call termination, call redirection, call hold, call release and etc.\n\n","Switch detects release signal and as an option it may or may not report the event to Call Policy Server. If the switch is configured such that reporting release event is not required, it simply releases the call according to call process procedure. If the switch is configured such that reporting release is required, it should send a query with release information to Policy Server through proxy, and stop the call process and wait for response from Policy Server.","The response from Policy Server should contain a specific action the server wants to the switch to take. The possible actions are \u201crelease the call with recorded announcement\u201d, \u201crelease call with busy tone\u201d, \u201crelease call with message\u201d, \u201cdetect certain signal from calling party\u201d, and etc.\n\n","When such event occurs the switch should report the event to Policy server or the application server and continue monitoring the call. The PS or AS may or may not response to the event. When it responses it should contain action it wants the switch to take, including \u201ccall hold\u201d, \u201crelease call\u201d, \u201ccollect information\u201d, and etc.","Basic Call Process Functions",{"@attributes":{"id":"p-0184","num":"0000"},"ul":{"@attributes":{"id":"ul0035","list-style":"none"},"li":"1 Call Routing. Call routing is a process in which the switch selects an idle circuit to place the call to the next switch. \u201cCall routing\u201d is one of the possible actions the PS may want the switch to take in response to the incoming call setup event. There are two levels of logic for circuit selection: 1) selecting a trunk group (a trunk group is a collection of circuit with same characteristics), 2) selecting a circuit within a given trunk group. In one preferred implementation, the logic for the later is pre-configured. That is, the PS does not provide any request in its response to the switch on this matter. There are different ways to select a trunk group. Based on the subscriber and network services involved, the PS should explicitly indicate to the switch how to select a trunk group as part of the response. The possible methods of selecting a trunk group in one preferred implementation are discussed as follows:\n    \n    "}},"Call termination is a call process used when the called party number belong to the switch, that is the called party a customer serving by the switch. In call termination, the switch uses the called party number to identify the port that connects to the customer's phone or terminal. The port in used could be in numerous status, such as \u201cidle\u201d, \u201cbusy\u201d, \u201cunequipped\u201d, \u201cblocked\u201d, \u201cin test\u201d and etc. In one preferred implementation, the switch should react differently when the port is in different status. Here is a detail discussion.\n\n","A switch may receive \u201crelease call\u201d request from PS or AS as a response to a \u201ccall setup\u201d query, or a \u201ccall release\u201d query; it may the request from an AS without the switch sending a query. The call release procedure should be invoked. Depending on the call type and the stage of the call, a release procedure may involve one party (the caller) or two-party (the caller and called party). When PS or AS requests call release, it should state explicitly whether to release the caller or the called party or both. The call release procedure varies depending on the signaling protocol used. In one preferred implementation, the logic of call release procedure is embedded in the signaling protocol stack, and there is no need for SA's further assistance.","Collecting User Information.","Possible user information includes:",{"@attributes":{"id":"p-0187","num":"0000"},"ul":{"@attributes":{"id":"ul0039","list-style":"none"},"li":{"@attributes":{"id":"ul0039-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0040","list-style":"none"},"li":["Identification Code\u2014examples are Personal Identification Number (PIN), authorization code, account code, project code, security code, and etc.","Address information\u2014called party number (in calling card and debit card calling)","Menu selection\u2014for application like voice mail and call center"]}}}},"User information is presented in DTMF (Dual Tone Multiple Frequency) digits format. The length of information may vary, and the PS or AS should specify the length of the digits or provide a timeout value for ending the digit collection procedure. Also as part of the request, a pre-collection prompt\u2014used before collecting information, and a post-collection prompt\u2014used after collecting information. The prompts may be a call progress tone like 350 Hz+440 Hz dial tone or a recorded announcement.","Collected User information should be reported to the PS or AS.","The Basic Model\u2014a Perspective from Call Policy Server (CPS).","CPS is an entity in service network responsible for providing service to switch devices through taking request from switch and sending response back to switch. It connects to switch through proxy, connects search engine, policy repository, LDAP-based directory server and servlets through IP-based network. Its main functions include 1) accept service request from switch, 2) search a policy profile for the user, 3) identify and interpret the policy that is applicable to the call, 4) hand over the service request to a servlet, 5) send a response to the switch.","There are several important characteristics of PS. First, it works in a stateless fashion. That is, a PS does not contain a state machine for each call, and therefore it treats each request for the same call individually. There is no relation between one request from the others. There is no timer assigned within PS in processing the service request. It does not take responsibility for failing to response to the request from switches due to any error situation. It does not have the capability to identify missing request or miss-sequencing request. In one preferred implementation, the switch should keep a state machine of call control for each call (example of a state machine for SS7 ISUP signaling can be found in GR-246). The principle of stateless is critically important in order to achieve scalability in a centralized control environment.","Another important characteristic of PS is that it uses pattern-matching approach to identify the rule applicable to the call. It takes the call information it receives and uses them to check against the all the rules of a particular policy. A policy is defined through explicitly listing all the rules","The network connectivity of PS:\n\n","A detailed discussion of PS's functions follows:","Receiving query from switch device and sending response back to switch. A PS receives queries from switch through proxy. A query is a data packet in UDP format, and it consists of two parts: the head and the payload. The head contains general information regarding to the data packet, and is defined by the TCP\/IP. The payload contains information in regarding to the call and used by both the switch and the PS. The content of payload is defined by this invention.","The payload of a query contains the following information: 1) facility ID, 2) the call reference, 3) the query ID, 4) query type, and 5) the call information.","The facility name is a character string. It services for two purposes. First, it is used for identifying the switch that sends the query message. In the response, the PS copies the facility name to make sure the response reaches to the sender switch. Second, the facility name is used when a PS to identify the policy profile that is designated to the switch facility. In preferred implementation, a facility name should contain information such as the switch name, the shelf name, and interface name, and etc. The facility name in a query message is always generated in the switch, and the PS processing the query bears no responsibility on the correctness of the name. A wrong facility name may cause either mismatching policy profile, or failure of identifying a policy profile, and PS is not responsible for either case.","The call reference is an integer used to identify uniquely a call related to a specific facility. This parameter is always generated in the switch. Call reference does not have impact on identifying a policy profile. In the response back to the switch, PS copies the call reference. Like facility name, it is the switch's responsibility to ensure the correctness of the call reference.","The query ID is an integer used to identify uniquely query message associated with a specific call. This is important because there could be more than one query involving the lifetime of a call. The switch uses this parameter to detect the missing query message or message missequencing. Like call reference, switch is the only user of query ID; in the response message, a PS copies the query ID from the original query message. It is the switch's responsibility to ensure the correctness of a query ID.","The query type indicates the purpose of the query. Therefore, it has a direct impact on identify the policy profile. In fact, a query type is used as one of the keyword for searching a policy profile. In preferred implementation, the following values of query type are defined as a basic set.\n\n","The payload of a response contains 1) facility name, 2) the call reference, 3) query ID, 4) action type, and 5) the details of action. The definition of facility name, call reference, and query ID are the same as those in the query message. The action type indicates the result of the query. In one preferred implementation, the possible values are\n\n","As a summary, the query and expected response in our preferred implementation are listed in the table.",{"@attributes":{"id":"p-0203","num":"0308"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"center"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"5","align":"center","rowsep":"1"}}]},{"entry":[{},{},"Originat-",{},"Trans-",{}]},{"entry":[{},"CallSetup","ing","Routing","lation","Terminating"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"5","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Announcement","X","X","X",{},"X"]},{"entry":["CPT","X","X","X",{},"X"]},{"entry":["CollectInfo","X","X","X",{},"X"]},{"entry":["Routing","X",{},"X"]},{"entry":["Accept",{},"X"]},{"entry":["RelsCall","X","X","X",{},"X"]},{"entry":["Terminate","X",{},{},{},"X"]},{"entry":["Acknowledge",{},{},{},"X"]},{"entry":["Error","X","X","X","X","X"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}},"ul":{"@attributes":{"id":"ul0047","list-style":"none"},"li":"1. Allocating policy page for the call. In one preferred implementation, the way that the PS identifies policy page is quite similar to use web-page search desired information on the internet. There are parts: the keywords used to best describe the desired information and the search engine."}},"The keywords used by a PS may come from the following information. The facility name, trunk group ID, the call information\u2014such as calling party number, called party number, the ANI and line information, the query type\u2014such as CallSetup, Originating, Routing, Terminating, and etc. Correspondingly, in each valid policy page there should be a special \u201cmegatag\u201d For a particular query of a particular, information available to search may not be complete. The \u201cbest effort\u201d approach should be applied. For example, in processing CallSetup query, information like \u201ccalling party number\u201d and \u201coriginal line information\u201d may not be available. In its \u201cbest effort\u201d the PS should use \u201cCallSetup\u201d and the trunk group information It reformats information into key-words, search for policy page through web search engine (Ultraseek from Infoseek).",{"@attributes":{"id":"p-0205","num":"0311"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"center"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"5","align":"center","rowsep":"1"}}]},{"entry":[{},{},{},{},"Trans-",{}]},{"entry":[{},"CallSetup","Originating","Routing","lation","Terminating"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"5","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"6"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"42pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Query Type","X","X","X",{},"X"]},{"entry":["CPN","X","X","X",{},"X"]},{"entry":["CDPN","X","X","X",{},"X"]},{"entry":["TG ID","X",{},"X"]},{"entry":["OLI",{},"X"]},{"entry":["CN","X","X","X",{},"X"]},{"entry":{"@attributes":{"namest":"1","nameend":"6","align":"center","rowsep":"1"}}}]}}]}},"ul":{"@attributes":{"id":"ul0048","list-style":"none"},"li":["1. Executing policy. XML-parser should go through the page and establish the parser-tree. CPS then will match the call event (calling party number, destination number etc) with the scenario, the time with schedule, and identify a proper action for switch to take.","2. Cache\u2014improve efficiency","3. Multiple search result\n\nThe Role of Search Engine\n\nThe Examples of Subscribers Services Covered by Policies\n","1. Call originating policy\n    \n    ","2. Routing policy\n    \n    ","3. Terminating policy\n    \n    ","4. Translation policy\n    \n    ","5. Call record tracking\n    \n    "]}},"It is to be understood that the above-described embodiments are simply illustrative of the principles of the invention. Various and other modifications and changes may be made by those skilled in the art which will embody the principles of the invention and fall within the spirit and scope thereof."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["A more complete understanding of the invention may be attained by reference to the drawings, in which:",{"@attributes":{"id":"p-0021","num":"0024"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0022","num":"0025"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0023","num":"0026"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0024","num":"0027"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0025","num":"0028"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0026","num":"0029"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0027","num":"0030"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0028","num":"0031"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0029","num":"0032"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0030","num":"0033"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0031","num":"0034"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0032","num":"0035"},"figref":["FIG. 12","FIG. 11"]},{"@attributes":{"id":"p-0033","num":"0036"},"figref":["FIG. 13","FIG. 11"]},{"@attributes":{"id":"p-0034","num":"0037"},"figref":["FIG. 14","FIG. 11"]},{"@attributes":{"id":"p-0035","num":"0038"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0036","num":"0039"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0037","num":"0040"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0038","num":"0041"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0039","num":"0042"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0040","num":"0043"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0041","num":"0044"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0042","num":"0045"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0043","num":"0046"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0044","num":"0047"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0045","num":"0048"},"figref":["FIG. 25","FIG. 24"]},{"@attributes":{"id":"p-0046","num":"0049"},"figref":"FIG. 26"},{"@attributes":{"id":"p-0047","num":"0050"},"figref":"FIG. 27","b":"1"},{"@attributes":{"id":"p-0048","num":"0051"},"figref":"FIGS. 28","i":["a","b "],"b":"28"},{"@attributes":{"id":"p-0049","num":"0052"},"figref":"FIG. 29"}]},"DETDESC":[{},{}]}
