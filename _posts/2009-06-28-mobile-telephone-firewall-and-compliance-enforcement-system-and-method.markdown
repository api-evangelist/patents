---
title: Mobile telephone firewall and compliance enforcement system and method
abstract: Methods, systems, and software for mediating SMS messages, and especially type 0 SMS messages, in a wireless mobile communications device configured to send and receive data using a GSM protocol and including a subscriber identity module (“SIM”) including electronic hardware and computer software executed by the hardware such that the SIM is configured to send, receive, and process messages using a Short Message System (“SMS”) between the wireless mobile communications device and a communications network. One aspect includes a method for mediating SMS messages comprising: configuring electronic hardware on the wireless mobile communications device to implement a firewall on the wireless mobile communications device, the firewall configured to identify and optionally mediate infrastructure SMS messages.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09071974&OS=09071974&RS=09071974
owner: Oceans Edge, Inc.
number: 09071974
owner_city: Reston
owner_country: US
publication_date: 20090628
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["1 CROSS REFERENCE TO RELATED APPLICATION","2 NOTICE OF COPYRIGHT","3 BACKGROUND","4 SUMMARY OF THE INVENTION","6 DESCRIPTION OF SOME EXEMPLARY, NON-LIMITING IMPLEMENTATIONS","7 CONCLUSION"],"p":["The present application claims priority under 35 U.S.C. \u00a7119(e) to provisional U.S. Patent Application Ser. No. 61\/076,665, filed 29 Jun. 2008, the disclosure of which is incorporated herein by reference in its entirety and for all purposes.","Portions of this patent application include materials that are subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document itself, or of the patent application, as it appears in the files of the United States Patent and Trademark Office, but otherwise reserves all copyright rights whatsoever in such included copyrighted materials.","3.1 Field of the Invention","The exemplary, illustrative technology herein relates to wireless telecommunication. More particularly, the exemplary, illustrative technology herein relates to systems, software, and methods for monitoring and managing SMS messaging, and the effects of such monitoring and managing on various devices, with or without the knowledge or assistance of a device user. Methods of preventing or misleading device tracking attempts through SMS messaging are also described. The technology herein has applications in the areas of computer and electronic communications security, telecommunications, business methods for providing regulatory compliance, defense, law enforcement, and surveillance avoidance arts.","3.2 The Related Art","Wireless mobile devices are common today, and increasingly they are relied upon for both business and personal communication. As used herein, the phrase \u201cwireless mobile devices\u201d includes pagers, mobile phones, combination devices that include the functionality of mobile phones, pagers, and personal digital assistants (PDAs) or any other devices having similar capabilities to enable wireless communication of voice and\/or data from a plurality of locations or while in transit between locations. These devices typically allow the exchange of textual information as well as voice and data, without the need for a physical connection (i.e., a wire or cable) between the devices, typically by use of electromagnetic transmissions (e.g. radio and\/or light waves). Devices using wireless communications can be at a fixed location or be mobile. Fixed location wireless device allow wireless communication between a fixed location and a mobile device or between devices at two fixed locations. Mobile wireless devices permit communication between mobile devices; as well as between mobile wireless devices and fixed location devices. Mobile devices typically communicate using radio-frequency transmissions, though some can also communicate by way of modulated light waves, usually in the infrared frequency spectrum.","Wireless communication can be accomplished by short-range transmissions, where the distances are measured in inches or feet, such as wireless Local Area Networks (WLANs) (e.g. Wi-Fi, supported by the Wi-Fi Alliance) or wireless personal area networks (PANs, e.g., Bluetooth), or longer-range transmissions, where distances are measured in miles, such as cellular technologies (e.g., cdmaOne, defined by the International Telecommunications Union, an agency of the United Nations, which is often referred to as \u201cCDMA\u201d) or Global System for Mobile communications (GSM: originally from Groupe Special Mobile, of France). These capabilities result in a plurality of ways to access wireless mobile devices, from locations that are near the wireless mobile device as well as locations that could be anywhere in the world.","GSM is a commonly used mobile telephony standard that includes not only voice communication capability, but also specifies protocols for transmitting non-voice digital data. Short Message System (SMS) is one such protocol. SMS data is sent over the control channel used to communicate device presence to a cell tower or other cellular network access point, do call setup, assign frequencies for voice calls, and the like. SMS can be used to support services such as Wireless Application Protocol (WAP) alerts or access, and \u201ctext messaging\u201d as well as Multimedia Messaging Service (MMS), which is a telecommunications standard for sending messages that include multimedia objects such as images, audio, video and Rich Text. These protocols can also be used to move data and software over-the-air (OTA) to and from mobile wireless devices for purposes such as installing software updates or communicating between users. The ability to exchange data wirelessly enables many useful functions of wireless mobile devices, and has helped make them almost ubiquitous for both business and personal uses. This capability also creates some problems, such as making it harder for organizations to monitor and control the movement of sensitive data, permitting installation of various forms of harmful software, such as viruses, covert monitoring applications, device trackers, identity theft software and software for authorizing purchases of goods or services without the device owner's knowledge or permission, and software that permits unauthorized data access. Means to detect, control and\/or block these types of activities are needed, but current methods do not adequately accomplish this. In some cases only some communication paths are controlled (e.g. TCP\/IP over WiFi), and in others only some protocols, or portions of protocols, are dealt with (e.g. SMS text messaging, but not other types of SMS messages).","In some cases the control or blocking of harmful activities is done in the network access provider's infrastructure, not in the mobile device; and if means are used to contact the device directly, without going through the network access provider, or if the device is taken to a location where a different network provider's service is used (\u201croaming\u201d) that does not supply such protection to the device, the device, and its information and user, become vulnerable. The critical aspects of the means of detecting, controlling and\/or blocking harmful activities need to be accomplished on the mobile device itself to eliminate these problems.","SMS, as used on current devices, was defined in the GSM series of standards in 1985 as a means of sending messages of up to 160 characters to and from GSM mobile devices. The popularity of SMS \u201ctext messaging\u201d has led to SMS, or protocols substantially similar to SMS, being implemented on non-GSM networks and devices, often with gateway systems providing protocol translations between systems. Most SMS messages sent today by users are mobile-to-mobile \u201ctext messages\u201d, though the standard supports other types of SMS messaging as well, such as WAP Push Service Load\/Indication and SMS Class 2 SIM specific messages. Most users lack understanding of these other message types, and even when a device includes a capability to limit or disable them, users may not make use of this, or may use it incorrectly. This leaves the devices vulnerable to cyber attack. Other mobile devices may lack such limiting or disabling capabilities entirely, or provide them in ways that are insufficiently flexible and so discourage their use.","SMS messages comprise various information fields that specify their purpose, content, format, and handling. For example, the TP-PID field specifies the Protocol Identifier, which either refers to the higher layer protocol being used, or indicates interworking with a certain type of telematic device, and the TP-DCS field, which specifies the DataCodingScheme (defined in 3GPP TS 23.038) that can be used to specify the character type in use for the message, whether the message is classless or of class 0, 1, 2, or 3, message compression, etc. Used together, the TP-PID and TP-DCS fields determine the \u201cmessage type\u201d as used herein and described in Table 1.",{"@attributes":{"id":"p-0013","num":"0012"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"center"}},"thead":{"row":{"entry":"TABLE 1"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Message Types"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"49pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Message",{},{},{}]},{"entry":["Type","TP-PID","TP-DCS","Comment"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["Text","00000000 - Simple Text SMS","xxxxxxxx - any","TP-DCS is"]},{"entry":[{},{},{},"typically"]},{"entry":[{},{},{},"0-general"]},{"entry":[{},{},{},"data"]},{"entry":[{},{},{},"coding,"]},{"entry":[{},{},{},"uncompressed,"]},{"entry":[{},{},{},"no"]},{"entry":[{},{},{},"class,"]},{"entry":[{},{},{},"default"]},{"entry":[{},{},{},"alphabet."]},{"entry":[{},"001xxxxx - telematic","xxxxxxxx - any"]},{"entry":[{},"interworking"]},{"entry":["Application","000xxxxx - SME-to-SME","xxxxxxxx - any","SM-AL"]},{"entry":[{},"protocol",{},"protocol"]},{"entry":[{},{},{},"ID in bits"]},{"entry":[{},{},{},"4- 0 of"]},{"entry":[{},{},{},"TP-PID."]},{"entry":[{},{},{},"PID of 0"]},{"entry":[{},{},{},"used for"]},{"entry":[{},{},{},"MS to SC"]},{"entry":[{},{},{},"SM"]},{"entry":[{},{},{},"transfer"]},{"entry":["Data","01111100 - ANSI-136 R-DATA","1111xx10 or","SM sent to"]},{"entry":[{},{},"00x1xx10 -","(U)SIM."]},{"entry":[{},{},"Class 2","See GSM"]},{"entry":[{},{},{},"TS 11.14"]},{"entry":[{},{},{},"and 3GPP"]},{"entry":[{},{},{},"TS 31.102"]},{"entry":[{},"01111101 - ME Data download","1111xx01 or"]},{"entry":[{},{},"00x1xx01 -"]},{"entry":[{},{},"Class 1"]},{"entry":[{},"01111111 - SIM Data download","1111xx10 or","SM sent to"]},{"entry":[{},{},"00x1xx10 -","(U)SIM."]},{"entry":[{},{},"Class 2","See GSM"]},{"entry":[{},{},{},"TS 51.011"]},{"entry":[{},{},{},"and 3GPP"]},{"entry":[{},{},{},"TS 31.102"]},{"entry":["Message","01000xxx - Replace SM Type 1-7","xxxxxxxx - any"]},{"entry":["Replace","01011111 - Return Call Message"]},{"entry":["Detect\/Locate","01000000 - SM Type 0","xxxxxxxx - any","\u201cSilent"]},{"entry":[{},{},{},"SMS\u201d"]},{"entry":["Device","01111110 - ME","00010001 -","see 3GPP"]},{"entry":["Settings","Depersonalization SM","Uncompressed,","TS 22.022"]},{"entry":[{},{},"Default"]},{"entry":[{},{},"Alphabet, and"]},{"entry":[{},{},"Message Class 1"]},{"entry":[{},{},"(MEspecific)"]},{"entry":["Unknown","11xxxxxx - SC specific use","xxxxxxxx - any","Use not"]},{"entry":[{},{},{},"defined in"]},{"entry":[{},{},{},"the"]},{"entry":[{},{},{},"standard"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"Message types not typically available to applications running on the wireless mobile device, such as Class 2 messages that are forwarded to the SIM for processing (e.g., ANSI-136 R-DATA and SIM Data download), or Type 0 \u201csilent SMS\u201d messages that can be deleted after they are acknowledged, are referred to herein as \u201cinfrastructure\u201d messages. Some message types can be infrastructure messages or not, depending on the setting of the TP-DCS field, such as the Application message types, while others are defined by standards as being Class 2 messages and therefore infrastructure messages, such as the ANSI-136 R-DATA and SIM Data download variants of the data message type. Table 2 describes which message types can be infrastructure messages, and whether these should be mediated when being sent from a wireless mobile device (\u201cMO\u201d, for \u201cMobile Originated\u201d) or sent to a wireless mobile device (\u201cMT\u201d, for \u201cMobile Terminated\u201d), and what the concerns are for each (see Table 2).",{"@attributes":{"id":"p-0015","num":"0014"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 2"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Mediation and Infrastructure"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"70pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},"Possibly",{}]},{"entry":["Message","Mediated","Mediated","Infra-"]},{"entry":["Type","MO?","MT?","structure?","Concerns"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":["Text","Y","N","N","Improper information"]},{"entry":[{},{},{},{},"sharing."]},{"entry":["Application","Y","Y","Y","Information leaks,"]},{"entry":[{},{},{},{},"application abuse and"]},{"entry":[{},{},{},{},"exploitation."]},{"entry":["Data","Y","Y","Y","Software and (U)SIM"]},{"entry":[{},{},{},{},"interaction."]},{"entry":["Message","N","N","N","No serious concerns."]},{"entry":"Replace"},{"entry":["Detect\/","N","N","Y","With radio"]},{"entry":["Locate",{},{},{},"equipment, or SP"]},{"entry":[{},{},{},{},"cooperation, can"]},{"entry":[{},{},{},{},"locate device to a cell."]},{"entry":[{},{},{},{},"In some cases more"]},{"entry":[{},{},{},{},"precisely Change of"]},{"entry":[{},{},{},{},"SP, denial of use,"]},{"entry":[{},{},{},{},"malware."]},{"entry":["Device","N","Y","Y","Change of SP, denial"]},{"entry":["Settings",{},{},{},"of use, malware"]},{"entry":[{},{},{},{},"install, information"]},{"entry":[{},{},{},{},"leaks, location"]},{"entry":[{},{},{},{},"detection, etc."]},{"entry":["Unknown","Y","Y","Y","Unknown"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"A wireless mobile device can, in some exemplary devices such as cell phones, comprise a \u201chandset\u201d and a Subscriber Identity Module, or \u201cSIM\u201d. Typically a handset comprises user interface subsystems, one or more receivers and transmitters, at least one processor (CPU), and the wireless mobile device's operating system. The construction of wireless mobile devices such as telephony devices is well understood to those skilled in the art.","SIMs are usually one part of a removable smart card, and the combination of a SIM and the smart card is commonly referred to as a \u201cSIM card\u201d. In some exemplary GSM 3G devices these are referred to as a \u201cUSIM card\u201d. Both SIM and USIM will be referred to herein as \u201cSIM\u201d when the context does not require specification of the 2G or 3G versions specifically. SIM cards securely store the service-subscriber key used to identify a subscriber to a given wireless network, and they also typically support a \u201cSIM Application Toolkit\u201d (STK), which is a standard of the GSM system that enables the SIM to initiate actions that can be used for various value added services, such as payment authorization for purchases. In GSM 2G networks, the STK is defined in the GSM 11.14 standard. In GSM 3G networks, the USIM Application Toolkit (USAT) is the equivalent of the STK, and is defined in standard 3GPP 31.111. (Both STK and USIM are referred to herein as \u201cSTK\u201d when the context does not require specification of the 2G or 3G versions specifically.)","The STK comprises a set of functions programmed into the SIM card that define how the SIM can interact directly with the mobile device (commonly referred to in this context as a \u201chandset\u201d), and\/or the network. The STK provides functions that can give commands to the handset, for example: to display a menu and ask for user input, to dial phone numbers, to send SMS, to communicate with handset via AT commands, to obtain Network Measurement Report (NMR) information regarding device location, or to control or access other device features. These functions enable the SIM to carry out an interactive exchange between a network application and the end user, and to provide or control access to the network. Details of STK capabilities and use are defined in the 3rd Generation Partnership Project (3GPP) Specification of the SIM Application Toolkit (STK) for the Subscriber Identity Module-Mobile Equipment (SIM-ME) interface (also known as the 11.14 specification) and related standards documents.","In addition to the STK, SIM cards can implement additional systems for supporting application programs that run on the SIM card. There are a plurality of systems and standards for such support, including the Open Platform and Java Card standards. Some standards support only one operating system or hardware smart card, others, like the Java Card standard, are supported on a plurality of smart cards under a plurality of operating systems. These systems can provide mechanisms for installing applications programs, selecting applications to execute, and means for the application programs to interact with each other or with the world outside of the smart card they are running on. Such systems typically provide for only one application to execute at a time, as is the case with the Java Card 2.2.1 standard, but others can provide for a plurality of applications to be active at the same time, or in a time-sliced multi-processing arrangement as is well known to those of skill in the art. These systems can provide mechanisms to isolate applications from each other, or provide only limited or controlled interaction between applications. For example, the Java Card 2.2.1 standard includes a \u201cfirewall\u201d capability, sometimes referred to as a \u201csandbox\u201d, that prevents applications from accessing each other's data or code objects, unless the applications are part of the same package or take special steps to permit such access. This \u201cfirewall\u201d is between applications and does not include capability for filtering, blocking or otherwise monitoring or controlling the application's interaction with the world outside of the smart card, however, so the term \u201cfirewall\u201d in this instance can be misleading. Due to the open-ended capabilities of applications installed on SIM cards there is a potential security hazard to SIM cards and to devices in which the cards are installed, similar to that of other general purpose computing devices. Given the use of SIM cards as means to authenticate users for purchase of goods and services over the network, such security hazards can involve identity theft and monetary losses. Therefore, methods for monitoring and controlling the communication activities of applications running on SIM cards in wireless mobile devices are needed to prevent such applications from being used to harm the wireless mobile device, the data held on or passing through such devices, for improper information disclosure, purchase authorization, or other abuses.","Although SIM cards originated with GSM devices, the cards have proven so useful that other network types have adopted similar mechanisms. For example, CDMA systems have implemented a SIM-like device called a Removable User Identity Module (R-UIM), and a more advanced version of this called a CDMA Subscriber Identity Module (CSIM), which are cards developed for CDMA handsets that are equivalent to a GSM SIM. The CSIM is physically compatible with GSM SIM cards, can fit into existing GSM phones, and is an extension of the GSM standard but is capable of working on both CDMA and GSM networks. As used hereinafter, \u201cSIM card\u201d refers to SIM, R-UIM, CSIM or similar devices where the capabilities are these are equivalent.","Most mobile wireless devices include a capability to be \u201cprovisioned\u201d, that is to have their software updated and configuration values set, using the above-described OTA methods. In some cases, software can be installed even without notification to, or permission from, the user of the mobile device. Physical security of the device can protect against the installation of unwanted software using wired means, such as cables or by exchanging the SIM card, but due to the possibility of installing software OTA, physical security methods alone are not sufficient to protect a device. One common method of OTA provisioning involves the use of SMS messages that are interpreted by systems already installed on the device. In response to properly constructed SMS messages, a device can be induced to report its status, accept software updates, accept changes to device configuration, report the device's current location, and many other actions. Some such systems are incorporated into the SIM, the device OS or device hardware, while others are optionally installed by the network provider or device user.","It is not usually practical to block all OTA software installations and configuration changes, because many service providers use these methods to update the device's operating system, network access configuration, and other applications. Blocking all OTA software installations and configuration changes would interfere with normal device use and the functioning of the provider's system. Users may also want to acquire additional software OTA for legitimate purposes. Some means is needed to prevent, or at least detect, OTA installation of some software, while permitting OTA installation of other software on wireless mobile devices. Such means would enable the device user to be aware of OTA installation of software, and the user could then take appropriate action, such as approving the installation, rejecting the installation, or not using the device until improperly installed software can be removed. Similarly, it would be desirable to establish rules that control whether specific software or configuration changes can be made on a mobile device, and the circumstances under which they might be made.","Improper software installation is not the only hazard created by the use of wireless mobile devices. The potential for their use in improperly disclosing confidential information, whether intentionally or accidentally, is of great concern to government security agencies, the military, corporate entities, and others who deal with regulated, confidential, or classified information. Monitoring of an installation's phone and computer systems, and searching vehicles and packages at gates or exits is no longer sufficient to prevent classified or confidential information being sent to parties that should not have access to it. In some cases, there can be regulatory requirements to record certain information exchanges for future reference, such as is required by the Sarbanes-Oxley Act of 2002 (Public Law 107-204). Means to address such requirements exist for e-mail, telephone calls, traditional postal mail, and other forms of communication, but means to address SMS messages, or other similar protocols, such as MMS, are lacking. Attempting to monitor communications by means such as tracking e-mail messages at an e-mail server can be defeated by some device capabilities, such as the BLACKBERRY \u201cPIN-to-PIN\u201d message system, where e-mail messages are sent from a first wireless mobile device to a second wireless mobile device without using an e-mail server, or by configuring the mobile device to use a different e-mail server that does not perform tracking of messages. Some devices can make use of encryption to render messages opaque to monitoring attempts located on infrastructure components, such as SMSC or e-mail servers. Some means for monitoring and controlling information sent from or to a wireless mobile device, whether intentionally by the device user, or without the device user's knowledge or permission, and whether encrypted or not, and regardless of the path taken by the information, is required to restore the ability to monitor and control, or at least detect, information transmission between a wireless mobile device and other systems. There is a need for monitoring and control located in the wireless mobile device itself, because only systems located in the wireless mobile device have access to all information sent to or from the device in an accessible (not encrypted) form.","OTA message traffic can currently be monitored or captured using network hardware, such as the Short Message Service Center (SMSC), telephone switch, Internet-to-SMS gateway, or other server at a service provider. This requires explicit cooperation by the service provider and can require expensive monitoring equipment, making this method suitable for some government agencies, such as law enforcement, but not practical for use by corporate entities or other civilian organizations that do not have such access and may lack the required expertise or equipment. When using this technique, device control to prevent undesired use of the device, such as to improperly disclose information, is generally limited as well. Methods that operate on the device to detect, capture, store and relay SMS message traffic are needed.","In addition to the issues related to external message traffic, additional problems can be generated by message traffic between the SIM and the handset (sometimes referred to as \u201cSIM pro-active commands\u201d). Applications running in the SIM can cause the handset to make voice calls, send SMS messages, launch the handset's browser, display messages to the user, etc. Applications running in the handset can request that the SIM send messages, such as for purposes of making purchases, or to reveal the device's current location. Some means of monitoring and\/or controlling such SIM\/handset interaction is needed to limit potential harm to the device, device misuse, or improper information exchange.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 1","b":["1100","1110","1120","1130","1140","1150","1160","1170","1180","1190","1200"]},"SMS messages sent from a wireless mobile device to an SMSC (SMS-SUBMIT messages) have a slightly different structure from those sent to wireless mobile devices as is known in art and shown in . Some fields, such as MTI (), RP (), UDHI (), PID (), DCS (), UDL () and UD () are similar to the same fields in SMS-DELIVER messages. Other fields include the following: Reject Duplicated (RD) () specifies whether duplicate messages should be accepted or not; Validity Period Format (VPF) () specifies whether the optional Validity Period (VP) () field is present; Status Receipt Request (SRR) () specifies whether a receipt report is wanted for this message; Message Reference (MR) () specifies an incrementing integer that identifies this particular SMS-SUBMIT message; and Destination Address (DA) () specifies the address of the intended recipient of the SMS message. Validity Period (VP) () specifies how long the message can remain undelivered before the SMS message expires.","In both SMS-DELIVER and SMS-SUBMIT messages, the User Data (UD) field can contain either a Short Message, or a Header and a Short Message. The UDHI field specifies the presence of a Header in the UD.  depicts the format of a User Data (UD) field as known to those having ordinary skill in the art. The UD field contains a Header (-) in addition to a Short Message (). The Length of User Data Header field () specifies the Header's length and is followed by one or more Info Element (IE) entries, each of which comprises three fields: an Info Element ID (,  & ), an Info Element Length (, , & ), and an Info Element Data field (, , & ). The Info Element entries specify additional information or further describe the Short Message content. For example, an IE with an ID of \u201809\u2019 (hexadecimal) specifies a Wireless Control Message (WAP). An IE with an ID of \u201820\u2019 (hexadecimal) specifies an RFC 822 e-mail header. An IE with an ID of \u201870\u2019 through \u20187F\u2019 (hexadecimal) specifies a SIM Toolkit Security Header, as defined in 3GPP TSG 31.115. Info Element ID values essentially specify the \u201cmessage type\u201d of the SMS message.","The SMS message fields described above permit identification of the message type, its size, and its content; so that different types of SMS messages, those originating at various addresses, being sent to various addresses, or which specify particular operations, can be treated in different ways by the device OS as well as by exemplary embodiments of the current invention. Within the message structure described above, SMS messages exist in a variety of forms, and are used for a plurality of purposes. The most widely known form is called Simple Text SMS. Simple Text SMS messages are used by device users to send short text messages to other devices, and can be used by harmful software to exfiltrate (i.e. the opposite of \u201cinfiltrate\u201d . . . to transfer out of a targeted device into one or more second devices) data or to receive control commands. SMS messages are limited to a few dozen bytes each, but by breaking messages into segments, sending each segment in a separate SMS message and reassembling the segments into the original message on the receiving device, larger messages can be transmitted. SMS Simple Text messages can easily be used to disclose confidential information. A method of monitoring, limiting, or blocking SMS Simple Text messages is required if prevention or detection of improper uses of SMS Simple Text capabilities is to be achieved, such as by blocking the sending of SMS Simple Text messages or recording them to detect and inhibit their use to disclose confidential information. Known methods for blocking SMS text messages typically exist as infrastructure applications running on network provider server equipment, not in the mobile device, and are usually intended to prevent sending of \u201cspam\u201d messages or to prevent Simple Text SMS messages from specific senders. SMS text message blocking on the wireless device is known, and generally involves use of \u201callow lists\u201d (numbers permitted to send SMS text messages), or \u201cdeny lists\u201d (numbers not permitted to send SMS text messages). Such applications can often be subverted or bypassed, such as by using a device that is not on a deny list or that is listed on an allow list, and there is nothing to prevent the device user from disabling or removing the blocking application, making such programs unsuitable for involuntary use (e.g. for corporate or government security monitoring and preservation). Other known applications can suppress SMS text messages based on message content, but such applications operate at the application programming interface (API) level, and access already-delivered messages from the \u201cinbox\u201d (i.e. the received message storage area). While this may be sufficient to prevent a user from seeing unwanted messages, there is usually no way to prevent other applications from having access to the received SMS message, or to know if one or more of them have processed the message content prior to suppression of the message. Dealing with messages after they have been received and processed into the device inbox is insufficient for preventing harm from hostile SMS messages. Unrestricted and unmonitored Simple Text SMS messages pose a risk for sensitive information dissemination, and can contribute to compromising the security of a device by providing a control and update pathway for covertly installed software. A means of blocking, filtering, modifying and\/or recording Simple Text SMS messages is needed, and for some purposes this means should be resistant to disabling or removal by the device user, or may need to be covertly implemented so that the user is unaware that the blocking, filtering, modifying and\/or recording of Simple Text SMS messages is occurring.","If a device has been compromised by the installation of covert monitoring or control software, the collected monitoring results, or other desired information present on the device, must be sent without detection by the device user (covertly exfiltrated). One method of covertly exfiltrating collected monitoring results is by way of SMS messages. An ability to detect, monitor, block, or limit SMS messages being sent from a device can remove this exfiltration pathway from the available methods that can be used by such software, and improve the security of wireless mobile devices and the data that passes through them. Current methods for preventing SMS use for covertly exfiltrating data lack flexibility and can be subverted or bypassed. Methods are needed which are flexible and which at least detect SMS messages in those cases where they can't monitor and\/or control them.","Still other risks from unrestricted SMS use exist. For instance, SMS messages can be used to trigger applications installed on a device into responding to the SMS message. This response can include location information concerning the cell or cells that the device is currently located in. Such location information can be useful for locating the device user for purposes of tracking, kidnapping, or harming the device user. When devices include GPS receivers, SIM card interactions can result in the GPS-derived location information being sent to unauthorized recipients, making the current location of the device, and therefore its user, known to a very precise degree. In some situations the device location can be determined to within a 30-foot radius. Some means of limiting or preventing such location information being disclosed inappropriately are needed, while not interfering with desirable sharing of location information or use of GPS receiver hardware for navigation or other purposes, such as location of nearby businesses or services.","Two other commonly used SMS message types are WAP Push Service Load (SL) and WAP Push Service Indication (SI) messages. SI messages are used to notify the device user that new WAP content is available. SL messages cause the device's browser to load the referenced content, optionally without user intervention on some devices. Other devices, such as those running the Symbian OS, require user interaction. SL message actions can be limited based on the security level settings of the device in some cases. Unrestricted and unmonitored WAP Push messages can pose a serious risk to the security of a wireless device when combined with an unaware user who follows a pushed link to a hostile web service, or with browser flaws that permit hostile web services to exploit the wireless device without user interaction or awareness. Some means of monitoring, limiting, or at least detecting SL and SI messages is required.","Another form of SMS message is the SIM Application Toolkit (STK) message. STK messages allows access to the SIM to use or alter the services supported by the device, and to download new services using OTA methods. For example, network operators can remotely provision a wireless device by sending text and\/or binary commands and\/or binary data embedded in SMS messages. Unlike a typical device application program, the STK executes on the SIM card, not in the device processor(s). STK messages on some devices are not processed at all by the handset, other than to recognize that they are STK messages, and such messages are passed into the SIM card and processed there. Applications that deal with SMS messages on the handset through OS-provided APIs may not have access to STK messages as they typically are not placed into the SMS \u201cinbox\u201d by the wireless device. Such applications are blind to STK messages, and can not block, control, log or do anything else to detect or prevent harm from them. Since the STK comprises functions that can cause the handset to perform potentially harmful actions, such as sending confidential or classified data in SMS Simple Text messages or establishing voice communication between the handset and a remote device, some means of detecting, monitoring, limiting or blocking STK messages is needed.","Within the STK specification, SMS is a key mechanism for personalizing the SIM in each device. The STK has been fully ratified as part of the GSM standard and is incorporated into several manufacturers' devices, both those intended for use on GSM phone networks, and others. The STK has been incorporated into several commercial and trial network services, from mobile banking to information services and email. Given the sensitivity of the information involved, and the potential for altering the device's basic settings, without user awareness in some cases, unrestricted and unmonitored STK messages are a risk to the security of wireless devices that support them, and to the data integrity and confidentiality of the information stored or passing through them. Some means of monitoring, limiting, or at least detecting such messages is required. This requirement exists whether the SMS messages are received over the GSM command channel, an equivalent SMS mechanism in a non-GSM system, such as CDMA, or a different type of communication channel, such as TCP\/IP over WiFi or another transport, such as Bluetooth, or by other means, such as IRdA, USB, or Ethernet.","Some network providers (e.g. Verizon Wireless, T-Mobile and AT&T) include filtering of SMS messages as part of their service or security infrastructure. In some cases this filtering involves suppression of \u201cspam\u201d text messages, and\/or allow\/deny listing for a particular device of particular sender numbers specified by a user of the device. In some cases the SMS filtering goes farther, and suppresses relaying of messages having types that are potentially harmful, such as messages that can be used to change the provisioning of a device, messages that can be used to find the location of a device, and messages that invoke STK functions. Such filtering and suppression of harmful messages is worthwhile, but since it is done in the provider's infrastructure servers, such as an SMSC, there is no protection offered for devices that receive SMS messages by other pathways. For instance, a transmitter in the vicinity of a wireless device could broadcast a signal that overrides that of a local cell tower, and masquerades as that cell tower. The wireless device, not being able to tell the difference between the actual cell tower and the transmitter acting as the local cell tower, will accept SMS messages as coming from the provider's systems, and process them normally. If the masquerading transmitter sends SMS messages that alter provisioning, install software, access files, or other improper actions, these will succeed when the wireless device is relying on the provider's systems to provide security. In a more common scenario, when the mobile device user leaves his home area and is \u201croaming\u201d, the mobile device will be connecting to a different provider network, which may or may not provide SMS filtering or blocking similar to that of the user's own network provider. The mobile device thus becomes vulnerable when it roams to any provider network that doesn't provide SMS filtering and blocking services. A method for the wireless device to provide its own filtering and blocking functions for improper messages is needed.","Some wireless device OSs provide mechanisms to permit the an application to easily become part of the SMS message processing flow, while others do not. For example, the Microsoft Mobile OS provides an Application Programming Interface (API) that permits capture of certain types of SMS message. One problem with relying on such mechanisms for intercepting SMS message traffic is that other applications can also make use of them, and can interfere with the proper operation of the intercepting application, such as by gaining access to SMS messages prior to their being processed by the intercepting application. In addition, such APIs do not typically permit the required operations to be carried out on all SMS message types, or do not ensure that the SMS messages will not have effects on the device even if they are available through the API. APIs can also limit what effects an application can have on an SMS message, such as not supporting modification of SMS messages prior to any other process gaining access to them. For these and other reasons, an intercepting application can not rely on such APIs, and must use other means to ensure interception of all SMS messages prior to their resulting in unwanted effects on the device or the information it contains.","There are some on-device SMS filtering systems in the prior art, such as MCleaner (Beijing Mobile Security Technology Co. Ltd, China), and Kaspersky Anti-Virus Mobile Enterprise Edition (Kaspersky Lab, Woburn, Mass.), but these have some limitations that keep them from providing all of the security capabilities needed to address the risks described herein. For example, a well known limitation is that these applications do not intercept all SMS message types because they access messages using the \u201cinbox\u201d, typically through an OS-provided API. They typically provide allow\/deny filtering by sender number, but little else. Some include filtering by matching text against the message content. Most only filter incoming messages, and do not limit what is sent from the mobile device (outgoing messages), rendering them useless for purposes of monitoring SMS communication for policy, legal or regulatory compliance purposes. By limiting filtering and blocking to short text messages, they leave the mobile device open to messages that change configuration settings or installed software. In addition, existing SMS on-device \u201cfirewalls\u201d typically intercept messages after they are placed in the \u201cin box\u201d on the mobile device, and can not guarantee that the message has not already been processed by other on-device software, such as the OS, other user level applications, or the STK, thus the message might already have had an effect on the device before these prior art systems take any actions. A message might even have been processed and deleted without being seen by these programs. To be truly effective in protecting the mobile device from unwanted SMS messages, or for monitoring and\/or limiting SMS message use for exchange of information, SMS messages must be intercepted as early in the process of receiving them on the mobile device as possible, within the constraints created by the mobile device hardware and OS designs.","Thus a need exists to provide methods, software, systems, and devices that better protect SMS messaging, particularly those messages that cause a mobile device's configuration to be changed without a user's knowledge or permission, and this protection needs to be provided in the mobile device, not just on provider infrastructure systems. Additionally, there is a need for preventing the use of wireless mobile device SMS capabilities for unwanted purposes, such as disclosing confidential information, or the installation of software for covert monitoring or control of a mobile device's operation or improper disclosure of the device location, while allowing the device to remain normally functional. The exemplary illustrative technology herein addresses these and other important needs.","The present invention provides systems, methods, and software that provide improved protection for SMS messaging, particularly those messages that cause a mobile device's configuration to be changed without a user's knowledge or permission. The systems, methods and software described herein work on the mobile device in contrast to the prior art's focus on protecting infrastructure systems. In addition, the systems, methods, and software provided herein prevent the use of wireless mobile device SMS capabilities for unwanted purposes.","In a first aspect, the present invention provides a wireless mobile electronic communications device. In one embodiment, the wireless electronic device provided by the invention includes an electronic apparatus configured to send and receive signals using a GSM protocol. The device further includes a subscriber identity module (\u201cSIM\u201d) device, which includes electronic hardware and computer software executed by the electronic hardware such that the SIM is configured process messages using a Short Message System (\u201cSMS\u201d) between the wireless mobile electronic communications device and a communications network. The device of the invention also includes electronic hardware and computer software executed by the electronic hardware effective to provide a firewall on the wireless mobile electronic communications device, the firewall configured to identify and optionally mediate substantially all infrastructure SMS messages.","In a more specific embodiment, the firewall is configured to identify and optionally mediate substantially all \u201ctype 0\u201d SMS messages.","In another more specific embodiment, the firewall is embedded into the operating system of the wireless mobile communications device. In a still more specific embodiments, the firewall is a design feature of the operating system. In an alternative embodiment, the firewall is a modification of the operating system of the wireless mobile communications device. In still another more specific embodiment, the firewall is separate from the operating system of the wireless mobile communications device. In yet another more specific embodiment, the firewall is an application instantiated on the wireless mobile communications device.","In another more specific embodiment, the firewall is a component of the SMS message processing scheme of the wireless mobile communications device. In still other more specific embodiments, the firewall mediates substantially all infrastructure SMS messages sent between the SIM card and the electronic apparatus, and in still more particular embodiments the firewall mediates substantially all \u201ctype 0\u201d messages sent between the SIM and the electronic apparatus.","In another aspect, the present invention provides methods for mediating SMS messages in a wireless mobile communications device that is configured to send and receive data using a GSM protocol and including a subscriber identity module (\u201cSIM\u201d) that includes electronic hardware and computer software executed by the hardware such that the SIM is configured process messages using a Short Message System (\u201cSMS\u201d) between the wireless mobile communications device and a communications network. In one embodiment, the methods provided herein include configuring electronic hardware on the wireless mobile communications device to implement a firewall on the wireless mobile communications device, the firewall configured to identify and optionally mediate infrastructure SMS messages.","In more specific embodiments, the configuring comprises providing the wireless mobile communications device with computer software configured to enable the hardware to implement the firewall. In more specific embodiments, the providing computer software comprises providing an operating system including the software for the wireless mobile communications device. In still more specific embodiments, the providing computer software comprises modifying the operating system of the wireless mobile communications device to include the software.","In other embodiments, the providing computer software comprises providing a software application configured to implement the firewall on the wireless mobile communications device. In still other embodiments, the infrastructure messages are \u201ctype 0\u201d SMS messages. Still more specific embodiments include those in which further comprise mediating the infrastructure SMS messages sent between the SIM device and the electronic apparatus.","In still other embodiment, the method of the invention further include mediating the infrastructure SMS messages sent between the SIM device and the electronic apparatus.","In a third aspect, the present invention provides a computer-readable medium containing computer-readable program code devices thereon. The computer-readable program code devices are configured for execution on computer hardware of a wireless mobile communications device, that is configured to send and receive data using a GSM protocol and includes a subscriber identity module (\u201cSIM\u201d) includes electronic hardware and computer software executed by the hardware such that the SIM is configured to process messages using a Short Message System (\u201cSMS\u201d) between the wireless mobile communications device and a communications network. In one embodiment, the computer-readable programmed code devices comprise computer instructions for configuring the wireless mobile communications device to implement a firewall on the wireless mobile communications device, the firewall configured to identify and optionally mediate infrastructure SMS messages. In a more specific embodiment, the computer-readable program code devices further comprise computer instructions for configuring the wireless mobile communications device to identify and optionally mediate \u201ctype 0\u201d SMS messages.","6.1 Overview","The current exemplary illustrative non-limiting implementation of the technology herein provides systems, methods, procedures, processes, apparatus, and techniques that enable monitoring, identification, limiting, and, in some cases, blocking of SMS message traffic to and from wireless mobile devices. Typically, SMS messages are detected and monitored, and most forms can be limited or blocked at the SMSC; but an effective means of detecting, monitoring, blocking, or otherwise limiting the effects of received messages, and the proactive reversal of unblockable messages, can only be performed at the mobile device itself. Message can have their effects (such as configuration changes or software installations) partially or completely reversed, thus achieving the logical equivalent of limitation or blockage without actually blocking or limiting those message types. The above-described capabilities constitute an \u201cSMS Firewall\u201d with respect to SMS messages received at the wireless device as provided by the present invention. Those having ordinary skill in the art will appreciate that while an SMS Firewall provided by the invention may have certain superficial similarities to a traditional TCP\/IP firewall, the SMS Firewall's functions are significantly different and involve significant technical challenges that are different from those of TCP\/IP-based firewalls, as will be apparent to those having ordinary skill in the art upon reading the disclosure herein.","The term \u201cSMS message\u201d, as used herein, refers to mobile-originated and mobile-terminated short messages as described by the 3rd Generation Partnership Project (of Valbonne, France, http:\/\/www.3gpp.org) \u201cTechnical realization of the Short Message Service (SMS)\u201d document 3GPP TS 23.040, or prior versions (e.g. 3GPP TS 03.40), equivalents, or descendents, thereof. SMS mobile originated messages are sent from a mobile device to a Short Message Service Center (SMSC). SMS mobile terminated messages are typically sent from an SMSC to a mobile device. Communication between an SMSC and a mobile device are typically performed using the control channel that is also used to arrange call setup for voice calls, provide location information for cell selection and other uses, but can make use of other communication pathways, such as 3G networks, or TCP\/IP packets over WiFi local wireless connections. While SMS messaging originated with GSM networks, similar capabilities have been implemented on other networks, such as Code Division Multiple Access (CDMA, used by Sprint PCS of Overland Park, Kans., and Verizon Wireless of Basking Ridge, N.J.) and Time Division Multiple Access (TDMS, used by AT&T Mobility of Atlanta, Ga.) networks. SMS messages can also be originated using other protocols and sent through gateways that convert the other protocols to SMS messages, or originated as SMS messages and sent through gateways that convert the SMS messages to other protocols. Examples of such gateways include e-mail to SMS, web site generated SMS messages, and text-to-speech conversion systems.","The term \u201cmediate\u201d or \u201cmediation\u201d is used herein to refer to the monitoring, limiting, reversing effects of, (e.g. returning configuration changes made as a result of a message to their prior settings, uninstalling software installed as a result of a message, etc.), and blocking of SMS messages sent to a mobile device (SMS mobile terminated messages) or from a mobile device (SMS mobile originated messages). In some exemplary embodiments, mediation performed in accordance with the present invention as described herein prevents improper access to the device The actions required to implement mediation can be performed with, or without, the device user's assistance or knowledge. Similarly, in other embodiments, SMS messages being sent from the device are mediated in order to prevent, or to detect and log, improper disclosure of information or other unauthorized communication. Such mediation may be required by security regulations for military or government agencies, by regulatory requirements on certain businesses or by professional practices (e.g. the Health Insurance Portability and Accountability Act (HIPAA) for medical records), to prevent improper disclosure of organizational data, such as plans, accounts, or confidential reports, or identity theft through the improper disclosure of personal information or the misuse of a wireless device; for instance, to improperly authorize online or other purchases. In some cases, there can be a legal requirement to monitor and log certain kinds of communication, whether being sent to the device or from the device, for future reference by auditors or government agencies, such as the record requirements of the Sarbanes-Oxley Act. In these scenarios, an SMS Firewall embodiment is able to resist unauthorized disablement or bypassing by the mobile device user, by other device software, by OTA messages, and by entities or systems external to the device so as to ensure that the mediation and other capabilities of the SMS Firewall remain operable. Where resistance to disablement is not possible, some embodiments of the SMS Firewall are constructed and installed such that disabling the firewall prevents SMS transmission or reception by the device. Some embodiments also comprise an ability to detect when the SMS Firewall is disabled, and some of these comprise systems for re-enabling the SMS Firewall automatically.","To ensure that all SMS messages are mediated, preferably before they have an adverse effect on the device, its configuration or the information it contains, the SMS Firewall can not rely on an application-level API to access SMS messages after they are received (e.g. the Microsoft (Redmond, Wash.) Short Message Service (SMS) API). Such APIs typically limit access to incoming or outgoing SMS messages by supporting only a subset of possible SMS message types, or only those types handled by the handset, with SMS message types destined for the SIM not being available through such APIs. Application-level APIs also typically do not guarantee interception by a first application prior to processing by a second application. This does not ensure mediation of all SMS message types, or mediation prior to processing by device applications. For example, an SMS Type 0 message, sometimes referred to as a \u201cflash\u201d SMS, is processed, potentially updates the device display, and can then be discarded without being made available through an application-level API. In another example, a SIM Data download SMS message is typically received by the device OS and handed off to the SIM for processing, and is not made available to handset applications through the SMS application-level API. The SMS Firewall must intercept all SMS message traffic at a lower level, as close to the point where the message is received by the device hardware as possible. To accomplish this, the SMS Firewall is embedded into the device operating system processing flow by the design of the OS, by modifications to the OS installation by the SMS Firewall or its associated software, such as an installer, as described below, or by other means as will be apparent to those with skill in the art.","The relationship between the SMS Firewall and other relevant components of an SMS message system () is depicted in . The SMS Firewall (), is a component of an electronic apparatus that is configured to send and receive signals, more particularly signals encoded using the GSM protocol. In the exemplary embodiment depicted, the SMS Firewall executes on a Wireless Device's () handset's () CPU (), and is logically located between a Wireless Device's () Operating System (OS) () and the wireless network point-of-presence () that connects the Wireless Device () to the Short Message Service Center (SMSC) (). This location protects the Wireless Device () from all SMS message traffic, regardless of whether it originates at a Network Administrator () working through an OTA Provisioning Server (), that connects to the SMSC () through a wireless Data Network () (such as GSM or CDMA), or from another wireless device () or covert monitoring device () using a wireless network modem () to connect through a wireless network point-of-presence () and SMSC (). The device is also protected from local transmitters masquerading as network provider wireless network points-of-presence () and SMSCs () so as to bypass any SMS message content restrictions being enforced by the network provider. A typical Wireless Device () handset component () also typically comprises at least one informational display (), such as an LCD screen, LED display, light, etc., and at least one type of user input device (), such as a keypad, touchscreen, trackball, etc. The handset () also typically comprises a microphone, speaker, sensors (motion, GPS, etc.), radios, batteries and other components (not shown), as will be well understood by those with ordinary skill in the art.","In some embodiments, the SMS Firewall () is implemented, at least in part, as an application instantiated on the wireless device it protects () and thus comprises a barrier to SMS messages between the protected wireless device and other devices or systems. The SMS Firewall of the present invention identifies and optionally mediates substantially all infrastructure SMS messages, particularly infrastructure SMS messages between the SIM card () and the mobile device handset () components of the Wireless Device (). In more specific embodiments, the infrastructure SMS messages are type 0 SMS messages. Alternatively, the SMS Firewall () is implemented as part of the wireless device operating system (OS) () software. In yet other alternative embodiments, the SMS Firewall () is provided in the SIM card () installed in the wireless device (). Regardless of the specific method of implementation, the SMS Firewall () functionally adds itself into the wireless device's () SMS message processing scheme and becomes a part of it. In some exemplary systems, the SMS Firewall () also mediates messages sent between processes running on the mobile device (), whether they are running on the mobile device handset (), or communicating between the SIM card () and mobile device handset () components.","In some embodiments the SMS Firewall identifies and optionally mediates all SMS messages, regardless of message type. For example, the SMS Firewall can intercept and identify SIM Data download messages as they arrive, and before they are passed on to the SIM card, thus mediating such messages. In some alternative embodiments the SMS Firewall is implemented at least partially within the SIM card in such a manner as to permit mediation of SMS messages on the SIM card before other aspects of the SIM card can process them. This is in contrast with prior art on-device SMS filtering applications that only deal with a subset of possible SMS message types, such as Simple Text SMS messages, usually for \u201cspam\u201d reduction or to block messages from specific senders.","Without being bound to any particular theory of operation, those having ordinary skill in the art will appreciate that unlike a typical Internet protocol (ICMP, TCP\/IP, etc.) firewall, which deals with packets primarily based on address data, and secondarily and optionally, dealing with session data through mechanisms such as Network Address Translation (NAT), the SMS Firewall primarily deals with message data, such as the SMS Message type (text, WAP push, etc.), or message content. Sender information, such as the originating phone number, can be used to further categorize SMS messages; however, SMS message information, such as an SMS message type, is an indicator of how an SMS message is treated by the SMS Firewall. In short, Internet (e.g., TCP\/IP-based) firewalls are primarily concerned with \u201cwho\u201d is being let through and only tangentially are concerned with the contents of the communication; the SMS Firewalls provided by the invention are concerned with the types of messages that are allowed to pass through and their effects on the mobile device. Moreover, the SMS Firewall of the current invention mediates intra-device communication, such as between the SIM card and the mobile device handset, while Internet firewalls are typically concerned only with external, inter-device communication.","In one embodiment, the SMS Firewall is deployed OTA as a downloaded application. In more specific embodiments the SMS Firewall is deployed covertly. In other specific embodiments, the SMS Firewall is deployed overtly. In still other embodiments, the SMS Firewall is included with the device by its manufacturer. In still other embodiments, the SMS Firewall is deployed through a wired connection, a peer-to-peer wireless connection such as Bluetooth, or by any other means of installing application software useful to the wireless mobile device as will be known to those having skill in the art. In some exemplary implementations, the SMS Firewall is deployed as a SIM application within the wireless mobile device's SIM card. In some exemplary implementations where the SMS Firewall is deployed as a SIM application, the SMS Firewall includes an \u201cagent\u201d aspect that is configured to address aspects of SMS Firewall functionality that require a presence on the handset to enable mediation of incoming or outgoing SMS messages, or mediation of SIM\/handset internal messaging. In embodiments that deploy the SMS Firewall in a SIM card and that require an \u201cagent\u201d on the handset to implement full SMS Firewall functionality, the agent software can be separately installed on the handset, included in the handset OS, or be installed on the handset by the SMS Firewall portion that is running on the SIM card. In some device types the SMS Firewall portion running on the SIM card must use indirect methods, such as sending SMS messages to the handset or cooperating with an external server system, to cause the agent software to be installed on the mobile device handset. Other aspects of such functionality will be apparent to those having ordinary skill in the art.","As depicted in , the SMS Firewall of the invention can be installed in a variety of configurations (, & ) on varioud mobile devices , & that communicate with a Monitoring and Control System (). The Monitorng and Control System comprises one or more applications, such as a Module Repository (), a Control Service (), an Exfiltration Data Service (), a Listen-Only Recording Service (), and a WAP Gateway () running on one or more servers, and communicating through a Device Controller application () using SMS () or other protocols or networks (), such as TCP\/IP over Wi-Fi or other connections (e.g. GSM\/GPRS EDGE) in devices and locations that support these. The Monitoring and Control System () can be used to configure or re-configure the SMS Firewalls (, & ) to receive collected data (e.g. logs, debugging or other data sent by the the SMS Firewalls or queried from the device using known SMS message types or other methods such as HTTP or FTP protocol exchanges over a TCP\/IP connection), to provide additional software useful for securing the wireless mobile device (, , or ) from threats detected by use of the SMS Firewall (, & ), or for other purposes related to SMS Firewall (, & ) functionality. The Device Controller () can connect to the SMS Wireless Network () through a wired connection () to a wireless network modem () or by other appropriate means as will be clear to those with ordinary skill in the art. The Device Controller () can connect to other wireless networks (), when these are used, through a wired connection () to a wireless network modem () or by other appropriate means as will be clear to those with ordinary skill in the art. Each wireless mobile device (, , or ) can comprise additional components, processes, and parts (, , , , , & ), such as device operating systems, data storage systems, e-mail and web clients, and\/or GPS mapping systems. The provision and implementation of the foregoing operations will be understood by those having ordinary skill in the art.","In addition to the protocols and networks shown in  (& ) and discussed above, in some exemplary implementations, peer-to-peer (P2P) technologies (, , & ), such as Bluetooth or IRdA, are used to enable communication between wireless mobile devices or between mobile wireless devices and wired devices, such as network access points, for communication between the SMS Firewall and the Monitoring and Control System.","As indicated in , in some embodiments the SMS Firewall mobile device clients function as protection for the mobile device (as in wireless mobile device ), monitor device communication (as in wireless mobile device ), or both (as in wireless mobile device ). In some exemplary implementations, these three modes of operation are determined by configuration settings in the SMS Firewalls (, & ). In some embodiments, SMS Firewall's configuration is stored within the SMS Firewall itself. In alternate embodiments, the SMS Firewall's configuration is installed as a separate file or store within the mobile device. In some embodiments, the configurations are unified; alternatively, they are comprised of disparate rules. In some embodiments, the configurations are, in whole or in part, downloaded into a mobile device, both for initial use and for subsequent changes or updates. In other exemplary implementations, the mode of operation is determined by the design of the particular SMS Firewall (, & ) and the appropriately designed version is selected based on the intended use.","The SMS Firewall in some exemplary implementations, e.g., those intended for covert deployment or involuntary monitoring, runs \u201csilently\u201d, without a user interface (UI) and in ways that limit the wireless device user's ability to detect its presence or affect its functioning. In some embodiments, e.g., when monitoring device use to comply with the requirements of the Sarbanes-Oxley Act or otherwise monitor confidential information transfer, the user is prevented from disabling the SMS Firewall or undetected tampering with any data it has logged. In other embodiments, the user is prevented from transmitting data without detection when the user is unable to delete logged data before it is exfiltrated or shut down the SMS Firewall without also shutting down the device to maintain thereby the credibility and utility of the data logged by the SMS Firewall. In some embodiments, when used in a covert or involuntary manner, the configuration and control of the SMS Firewall is completely, or partially, performed through the Monitoring and Control System. In some embodiments, the SMS Firewall functionality that is under the device user's control is determined by configuration settings, or, in other embodiments, by omitting a UI entirely.","In other exemplary implementations where covert or involuntary deployment and operation are not factors, or where the device user is given at least some control over the SMS Firewall functionality, the SMS Firewall provides a user interface that can be used to alert the device user to SMS message traffic. In more specific embodiments the degree of control includes enabling the user to provide input as to how the SMS message traffic is to be dealt with, such as whether to block a WAP Push Service Load message or permit it, whether to record an SMS Simple Text Message for export to a logging server or not, or whether to permit provisioning of a new ringtone or software application or not. In exemplary implementations that lack a UI, such interaction is performed through the monitoring console; in other exemplary implementations it is omitted.","In some embodiments, for both covert and non-covert deployments the configuration of the SMS Firewall specifies the behavior of the SMS Firewall. For example, the configuration settings can specify that WAP Push SL messages are to be blocked, WAP Push SI messages are allowed only when they specify URLs in a particular set of domains (an \u201callow list\u201d, also sometimes referred to as a \u201cwhitelist\u201d) and otherwise blocked, or allowed unless they specify a URL in a particular set of domains (a \u201cdeny list\u201d, also sometimes referred to as a \u201cblacklist\u201d), and that the device user is not permitted to alter the allow list or deny list, or turn off WAP Push SL blocking based on either list. In another example, configuration settings specify that Simple Text SMS messages are recorded for exfiltration to a logging server whether being sent from or to the device or that STK messages are allowed (or both), unless they will result in removal or shutdown of the SMS Firewall application, in which case they are blocked or their effects reversed to the extent possible and their receipt logged regardless. In other embodiments, the device user can enable the above-described restrictions as desired.","In still other embodiments, the configuration of the SMS Firewall is altered by the deploying server as required at any time through specially coded SMS messages, or by other means such as commands sent to the SMS Firewall using other networks and protocols, such as TCP\/IP over a Wi-Fi or cellular data network connection (e.g. EDGE). In some exemplary implementations, any configuration options and rules for the SMS Firewall are collected into named sets as \u201cbehavior profiles\u201d. In more specific embodiments, the SMS Firewall stores a plurality of different behavior profiles, and a particular behavior profile designated as \u201cactive\u201d specifies the functioning of the SMS Firewall. In still more specific embodiments, the behavior profile designated as \u201cactive\u201d at any given time is specified by the Monitoring and Control System by use of an appropriate command to the SMS Firewall, by the SMS Firewall in response to detection of specified conditions, or, in deployments comprising a UI supporting and permitting this, by the device user. Additional detailed embodiments concerning this aspect of the SMS Firewall are described below.","In some exemplary implementations the Monitoring and Control System is used to download additional software to the wireless mobile device by way of the SMS Firewall, or enables the device to query threat databases. In some exemplary implementations, the additional software is selected based on data collected and sent by the SMS Firewall to the Monitoring and Control System. For example, if the SMS Firewall detects a pattern of SMS messages that may constitute an attempt to compromise the device's security (e.g. a pre-determined or computed number of messages that cause a WAP Push Service Load from a deny listed URL, or a message that causes the SIM to issue an AT command to dial a phone number silently), the SMS Firewall can relay data indicating the possible attack to the Monitoring and Control System, where software designed to collect additional data or protect the device from the attempt to compromise it, or both, is selected or created and sent back to the wireless mobile device. In some embodiments, these actions are done automatically; in other embodiments, the actions are performed with human assistance. In another example, receipt of a WAP Push Service Load (SL) message causes the SMS Firewall to contact the Monitoring and Control System to determine if the URI specified in the SL message is on a list of prohibited URIs (a \u201cdeny list\u201d) or, in other embodiments, if the URI is on a list of specifically permitted URIs (an \u201callow list\u201d) before blocking or permitting the SL message to be processed. This capability permits protection of wireless mobile devices from a wider range of possible abuses than the device might have storage space to support on its own, permits adapting responses as threats change, and can involve expert human assistance as needed for diagnosis and response without a requirement for action, or even awareness, on the part of the device's user.","Those having ordinary skill in the art will understand that the ability to monitor or limit SMS messages received by a device can protect, or help protect, the device from harmful software installation, improper sharing of information stored on the device, improper use of the device, improper disclosure of the device location, and other misuse, whether this is done by covertly loaded software or by use of \u201cTrojan horse\u201d techniques where a device user is induced or tricked into downloading harmful software or fraudulently convinced to reveal confidential data such as by redirecting the user to a web site constructed to simulate a trusted website. Control and monitoring of SMS messages also benefits organizations concerned with protection of confidential information, whether by actually limiting information transmission by blocking data sending completely or partially, or by monitoring transmitted data and thus providing an inhibition against sending data improperly. Such protection of information from improper sharing can support organizational requirements, such as compliance with the Sarbanes-Oxley act, HIPPA, or other laws requiring limitations on information disclosure and\/or monitoring and recording of disclosures of particular types of information. By limiting, misdirecting, or preventing device location tracking, the SMS Firewall also can help protect the device user from harm in some scenarios.","6.2 Exemplary System Architecture","As depicted in , the components involved in implementing an exemplary SMS Firewall on a wireless mobile device include, but are not limited to: a Wireless Mobile Device () (comprising, in addition to the typical components, such as various Device Processes () and other components such as an Operating System (not shown) and User Interface (not shown), an SMS Firewall () and an Exfiltration Cache ()), a Monitoring and Control System () (comprising at least a Logging Server ()), and a GSM or other suitable network () to permit the Wireless Mobile Device () to receive and send SMS messages () from or to other devices, such as a disparate Wireless Device (), and to permit the Wireless Mobile Device to send ( & ) data collected in the Exfiltration Cache () to the Logging Server (). The provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In at least one exemplary embodiment, the SMS Firewall () comprises a plurality of configuration settings. These configuration settings are used by the SMS Firewall () to control specific aspects of functionality during operation. Configuration settings can be default settings, which are provided as part of the SMS Firewall () installation, or they can be dynamic settings, which are altered as required by the device user through a User Interface (UI) in some embodiments, by commands sent from the Monitoring and Control System in some other embodiments, by the SMS Firewall () in response to certain detected events in yet other embodiments, or by any or all of these in still other embodiments. Specific configuration settings can have default values that are used until such time as the setting is altered by UI, Monitoring and Control System or SMS Firewall () action.","Configuration settings can be communicated and\/or stored in simple arrangements, such as the \u201cname=value\u201d method used by \u201c.ini\u201d files on some versions of the Windows operating system sold by Microsoft Corporation (Redmond, Wash.), or in more complex formats, such as the standard eXtended Markup Language (XML). In some exemplary embodiments, a plurality of methods are used for communicating and storing configuration information. For example, one possible exemplary embodiment uses XML to format configuration information for transmission between the Monitoring and Control System and the SMS Firewall on the mobile device, but stores the settings in a relational database on the mobile device and in the Monitoring and Control System. Configuration settings can be stored in the mobile device memory, in files on the device, by altering specific portions of the SMS Firewall () itself, or in any other manner as determined to be proper by those with skill in the art. A non-limiting, exemplary list of some possible configuration settings comprises:\n\n","In some embodiments, the SMS messages sent from disparate devices () must traverse the SMS Firewall () before they are passed () to any of the Device Processes () on the Wireless Mobile Device () that would normally deal with them. In more detailed embodiments, the SMS Firewall () records the SMS Messages it processes, whether these are blocked or not and regardless of the type of SMS message being processed, in the Exfiltration Cache () for later sending () to the Logging Server () where they are stored, displayed, or otherwise processed, recorded, or forwarded as required. The provision and implementation of these elements will be familiar to those having ordinary skill in the art.","Continuing with , in exemplary implementations, data accumulated in the Exfiltration Cache () can be sent to the Logging Server () on a specified or computed periodic basis, when cache resources are reduced to a specified or computed level, or when the Logging Server () requests transmission, as determined by the design of the exemplary implementation and its configuration. When exfiltrating data, all cached data can be sent, or a subset of the cached data, selected by various means, such as SMS message type, date, most or least recent, the action taken on the device, or a text match, or partial match, or a match with a specified pattern (e.g., a pattern specified with a \u201cregular expression\u201d, or \u201cregex\u201d, as is widely used in the software industry for specifying search patterns in text editors such as Emacs or utility commands such as the Unix \u201cgrep\u201d command) with the contents of stored SMS messages. These actions can be implemented by persons having ordinary skill in the art.","In some exemplary embodiments of the current invention, data in the Exfiltration Cache () is protected against tampering or loss. Methods of preventing deletion or alteration of cached data include, but are not limited to, encryption to prevent viewing or editing of the data, inclusion of regular time-stamps to detect deletion of portions of the data, and hiding the data through means such as placing the data in files having names similar to other files normally found on the device, appending the data to existing and expected files, placing the data in files that are not listed in a normal file directory, alteration of the device OS file access functions to block access to the cache files, or any combination of these or other methods that will be well understood by those having skill in the art. The method chosen will depend to some extent on the design of the mobile device in question, and will vary from one device to another.","Data can be sent as SMS messages, or using any other method supported by the wireless mobile device () and the Logging Server (), such as a TCP\/IP connection over a Wi-Fi link or other connection means, using a sync cradle and wired connection, over a Peer-to-Peer connection, such as Bluetooth, or by removal of the Wireless Mobile Device's storage components and connecting them to the Logging Server for extraction of the cached data. When the exfiltration must be done covertly, some methods are inappropriate, and other methods can require care in their employment to prevent detection using methods known to those with skill in the art. For example, U.S. patent application Ser. No. 12\/209,874, incorporated herein in its entirety and for all purposes, describes several methods by which data can be covertly exfiltrated from wireless mobile devices. These actions can be implemented by persons having ordinary skill in the art.","A schematic diagram illustrating one embodiment of SMS message reception and processing flow for a wireless mobile device () and three exemplary methods for inserting an SMS Firewall into the SMS message reception and processing flow of a typical wireless mobile device (, , ) are depicted in , , and respectively. (), illustrates an SMS message processing flow comprising Data Reception (), distribution of received data by the Operating System () to an SMS Queue Insertion mechanism (), and processing of SMS Queue entries by one or more SMS Queue processing mechanisms (). The provision and implementation of these elements will be familiar to those having ordinary skill in the art. It should be noted that the use of \u201cSMS Queue\u201d to refer to the structure or structures used to handle an SMS message during processing is not meant to imply a particular architecture for any specific implementation. Exemplary devices can use one or more queues, one or more stacks, or any other appropriate structure as determined by those with skill in the art, or any combination of these without exceeding the scope of what is meant by \u201cSMS Queue\u201d herein, which is simply an arrangement whereby SMS messages can be maintained in forms and relationships suitable for their processing.","In some embodiments, Data Reception () involves receiving the radio frequency (RF) signal from a wireless point-of-presence, such as a cell tower, converting it into digital data, and handling any protocol requirements, such as handshaking, removal of transmission headers, error checking, and other actions well known to those with skill in the art. Received data comprising SMS messages are routed by the Operating System (), or supporting systems employed by it, such as device drivers, library routines, or special purpose hardware, to the SMS Queue Insertion mechanism (). The provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In some embodiments, the SMS Queue Insertion mechanism () places the received SMS message data into a data repository, such as an SMS message queue, a set of SMS message queues, a database of received messages, or other appropriate structure where they can be accessed and acted upon by the SMS Queue Processing mechanism (). The provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In some embodiments, the SMS Queue Processing mechanism () processes SMS messages in a variety of ways, depending on the message type and content. For example, in some embodiments, SMS Simple Text messages are displayed for the user to read, and perceptible signal, such as an audible beep or a blinking light, is activated to alert the user to the availability of a Simple Text message for reading, or a WAP Push Service Load message causes the device's browser to access a specified URI. The provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In some embodiments, such as the one depicted in , the insertion of the SMS Firewall () into the SMS message reception and processing flow is accomplished by a variety of means, the selection of which depending on the design of the device and the device operating system (). In some exemplary implementations, the operating system () employs a loadable device driver, comprising a set of software instructions implementing a method of responding to data being made available by the Data Reception hardware () by transferring such data from the receiving hardware to a data storage structure, such as an input queue, or to a destination specified by a device process, such as the SMS Queue Insertion process () that has control of the input hardware, or has otherwise requested delivery of data arriving through it. Such mechanisms are well known to those having skill in the art. In exemplary implementations that use loadable device drivers, the SMS Firewall is inserted into the processing flow by constructing it to replace such loadable device drivers, and installing the SMS Firewall on the wireless mobile device as the loadable device driver to be used for SMS data reception. In such exemplary implementations, the device operating system loads the SMS Firewall as the device driver for SMS data reception, and the SMS Firewall has access to all SMS data received by the wireless device prior to any other device software and can perform its functions. In some exemplary implementations the SMS Firewall can be implemented in two or more parts, one or more of which function as loadable device drivers, and the remainder of which work in conjunction with the parts that do act as loadable device drivers. In such implementations the part or parts functioning as loadable device drivers are responsible for diverting SMS data to the remaining parts of the SMS Firewall, and, in some exemplary implementations, accepting back those data that are passed, whether modified or not modified by the SMS Firewall, for normal routing to the SMS Queue Insertion mechanism () or other processes. In some cases data are not passed back, such as when a message is being blocked. The non-loadable device driver parts are responsible for the remainder of the SMS Firewall functionality. Provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In other exemplary implementations, the device software is adapted to the requirements of the particular hardware using dynamically loadable libraries (DLLs), such as, for example, the MOBILE WINDOWS OS's Radio Interface Layer (RIL) DLL. As is familiar to those having ordinary skill in the art, a dynamically loadable library is a collection of software modules that support one or more functions, such as reading data from data reception hardware, which is separate from, but called as needed by, various processes, such as those that make up the device operating system or utility software. Thus, in some embodiments the SMS Firewall is inserted into the flow in a way that permits it to perform its intended functions by replacement of one or more of the DLLs used to interface with the device's data reception hardware, transfer data to device processes such as the SMS Queue Insertion process, or used in the transfer of SMS data from the receiving hardware to components of the SMS message reception and processing flow. In some exemplary implementations, the SMS Firewall performs at least some of the processing that would have been carried out by the DLL it replaced, when appropriate, and in other exemplary implementations the SMS Firewall passes control to the required function from the DLL it replaced when its own processing is done, before it begins its own processing, or at any other required point in the processing. Either method of implementation permits the remainder of the device's software to continue functioning normally despite the presence of the SMS Firewall in the SMS message reception and processing flow. Provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In some exemplary implementations of the current invention, the SMS Firewall is inserted into the SMS message reception and processing flow prior to the SMS Queue Insertion step, as depicted in (). Here, the SMS Firewall is inserted into the processing flow such that the Operating System () routes SMS message data to the SMS Firewall () rather than the SMS Queue Insertion mechanism (). The SMS Firewall is thereby able to examine received SMS messages prior to their being processed by other aspects of the device, and can discard messages which are to be blocked, record messages which are to be logged, and pass messages, intact or altered as required, that qualify for passage through the SMS Firewall to the SMS Queue Insertion mechanism () for the processing that would have occurred for the message in the absence of the SMS Firewall. All components of the SMS message reception and processing flow shown at , other than the SMS Firewall () are identical to those described above (()). Message data is received and converted by Data Reception (), routed by the Operating System or its supporting systems (), inserted into an appropriate SMS message queue () (if it is passed by the SMS Firewall), and processed as appropriate to the message type and the device's design and configuration ().","In still other exemplary device implementations the SMS Firewall is inserted into the SMS message reception and processing flow by operating system function calls, modification of operating system or other software, reconfiguration of hardware settings, such as interrupt vector registers, or by other means known to those with skill in the art. Provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In exemplary implementations where insertion of the SMS Firewall into the SMS message reception and processing flow cannot be performed as described above for and depicted at , the SMS Firewall is provided as a part of the SMS Queue Insertion mechanism, as depicted in (). In this implementation, the data is received and converted by Data Reception (), and routed by the Operating System or its supporting systems () to the SMS Queue Insertion mechanism (). The SMS Queue Insertion mechanism (), as part of its functioning, invokes the SMS Firewall (), which then has an opportunity to examine the SMS message data and decide whether to discard it and abort further processing by the SMS Queue Insertion mechanism () if the message is to be blocked, to record messages which are to be logged in an exfiltration cache, and permit messages that qualify for passage through the SMS Firewall to be queued normally by the SMS Queue Insertion mechanism (). In some embodiments the foregoing is performed after modification of the message, and in other embodiments the foregoing is performed with no modification of the message. The SMS Queue Processing mechanism () then processes the SMS messages that were not blocked in the normal way. The method of including the SMS Firewall into the SMS Queue Insertion mechanism in this way varies with the design of the SMS Queue Insertion mechanism. In some exemplary implementations, the SMS Queue Insertion mechanism supports \u201cplug-in\u201d modules, and the SMS Firewall is implemented as a plug-in module. In other exemplary implementations, the SMS Queue Insertion mechanism makes use of DLLs of supporting software and the SMS Firewall is implemented to take the place of one or more of the DLLs. In more specific embodiments, this implementation is performed while still providing the functionality of the library it replaces, or calling on a DLL when appropriate to carry out its functions. Those with skill in the art will know still other methods of including SMS Firewall functionality within the processing of the SMS Queue Insertion mechanism, for example, by completely replacing the SMS Queue Insertion mechanism, and performing the functions of that system in the SMS Firewall, or calling on the original SMS Queue Insertion mechanism to perform its functions only when appropriate (e.g. when an SMS message is not blocked). Provision and implementation of these elements will be familiar to those having ordinary skill in the art.","In still other exemplary implementations, the SMS Firewall is installed as an SMS Queue Processing element as depicted in (). In this method, the Data Reception (), Operating System (), and SMS Queue Insertion mechanism () function as described above for (). The SMS Firewall is the only SMS Queue Processing element (), or, in other embodiments, the highest priority SMS Queue Processing element when there are additional SMS Queue Processing elements () on the device. These actions can be accomplished by hiding (such as by renaming elements, moving their location, or deleting pointers to them) the remaining SMS Queue Processing elements, and allowing them access to the SMS message data only after the SMS Firewall has completed processing an SMS message and determined that the message should not be blocked. In exemplary device implementations where SMS Queue Processing elements are dynamically added by other device processes, the SMS Firewall is required to take over such dynamic addition functions from the operating system or other software and control the order of access to SMS message data. In some embodiments, the SMS Firewall is the first to process the message data. In other embodiments, the SMS Firewall checks for dynamic additions and removes or supersedes them. Provision and implementation of these elements will be known to those having ordinary skill in the art.","In some embodiments, the SMS Firewall records the device's configuration, either at boot time or prior to receipt of an SMS message (or, alternatively, at specified or computed intervals), and compares the configuration after processing each SMS message, or, alternatively, each SMS message capable of altering the device configuration, to the recorded configuration. If the device configuration is found to be different from the recorded configuration, the discrepancies can be partially or completely reversed or simply recorded for logging. Configuration elements of concern include, but are not limited to, security settings, installed software, software boot order, stored text messages or other data, plug-in registrations, and communication settings. In more specific embodiments, desirable changes are retained and only undesirable changes are reversed. For example, if a user receives a message that adds or changes a ringtone, reversal of the change could compromise the covert nature of the SMS Firewall; but a message that causes the device to restore its SMS message reception and processing flow to a \u201cfactory default\u201d state effectively renders the SMS Firewall ineffective and must be reversed at least to the extent of reinstalling the SMS Firewall into the message reception and processing flow after the normal processing of the SMS message is complete.","Mediation of outgoing SMS messages is handled in a manner similar to that of incoming SMS messages. That is, the SMS Firewall inserts itself into the message processing flow where it can mediate all SMS message traffic, using one or more of the techniques described herein. Exemplary devices can use similar, or different, mechanisms for handling incoming and outgoing SMS messages, and can, in some cases, use different mechanisms depending on the network interfaces that are available at a given time. For example, using GSM mechanisms unless a WiFi connection is available. Regardless of the specific methods employed, the techniques described herein can be used to mediate the SMS messages being sent by, or sent to the device.","6.2.1 User Interface","When deployed non-covertly, the SMS Firewall can comprise an optional User Interface (UI) to permit the device user to interact with the SMS Firewall on the device for purposes of altering SMS Firewall configuration settings, to view SMS Firewall current configuration settings or to receive alerts and other messages from the SMS Firewall. In some exemplary embodiments, the UI comprises a Graphical User Interface (GUI) made up of various icons, images, text, indicators or other elements as are familiar to those with ordinary skill in the art. In other exemplary embodiments, the UI comprises a \u201ctext-only\u201d display. In still other exemplary embodiments the UI comprises various indicators, such as lights, vibrations, sounds or similar methods of signaling relevant status or setting information to the device user. In still other exemplary embodiments, any or all of these methods can be used, as determined by the SMS Firewall configuration.","One possible, exemplary, non-limiting embodiment of an SMS Firewall UI comprises a GUI, the initial (main) display of which provides the following status information:\n\n","The main display also comprises controls for switching to an \u201coptions\u201d display, and for returning to a previous display. The \u201coptions\u201d control causes a list of available settings for the currently selected item to be displayed, and permits selection of one of these. For example, if the \u201cIncoming SMS message behavior profile\u201d item is selected when the \u201coptions\u201d control is activated, a display that permits selection of \u201clow\u201d, \u201cmedium\u201d, or \u201chigh\u201d settings for this configuration setting is presented. The options display further comprises an \u201cOK\u201d control and a \u201cCancel\u201d control. Activation of the \u201cOK\u201d control causes the currently selected option to be set, while activation of the \u201cCancel\u201d control results in a return to the previous display without alteration of any configuration settings. Activation of the \u201cOptions\u201d control while other items are selected works in a similar manner, as will be clear to those with skill in the art.","In some exemplary embodiments, the display of status values such as \u201clow\u201d, \u201cmedium\u201d, and \u201chigh\u201d is done as a summary of a more complex arrangement of configuration settings. For example, the \u201cIncoming\u201d behavior profile can comprise settings for handling incoming calls, with values of \u201callow all\u201d, \u201callow except for deny list\u201d, \u201cdeny auto-answered\u201d, \u201cdeny all except allow-list\u201d, or \u201cdeny all\u201d, settings for incoming SMS messages, with settings such as \u201callow all\u201d, \u201callow all except deny list\u201d, \u201cconfirm with user\u201d, \u201cdeny except for allow list\u201d, and \u201cdeny all\u201d, and settings for Bluetooth such as \u201callow all\u201d, \u201cdisable\u201d, \u201cinvisible\u201d, \u201cinactive disabled\u201d, and \u201cinactive invisible\u201d. Each individual setting can have a related value, the average of which for all selected settings determines the \u201clow\u201d, \u201cmedium\u201d or \u201chigh\u201d choice for the main status display. Other methods are possible, as will be apparent to those with skill in the art. In other exemplary embodiments the actual settings for each item are displayed on the status display without summarizing. Outgoing settings are done in a similar manner, with settings such as \u201coutgoing call\u201d (\u201callow\u201d, \u201cconfirm\u201d, \u201cdeny\u201d, etc.), \u201cinternet connections\u201d (\u201callow outbound\u201d, \u201callow all\u201d, \u201cconfirm\u201d, \u201cdeny all\u201d, etc.), \u201coutgoing SMS\u201d (\u201callow\u201d, \u201callow except deny list\u201d, \u201cconfirm\u201d, \u201cdeny except allow list\u201d, \u201cdeny\u201d, etc.) and \u201cSIM Tool Kit\u201d (\u201callow\u201d, \u201callow except deny list\u201d, \u201cconfirm\u201d, \u201cdeny except allow list\u201d, \u201cdeny\u201d, etc.).","6.2.2 Server Communication","In some exemplary implementations, the SMS Firewall on the mobile device communicates with a Monitoring and Control System for purposes such as verifying proper functioning of the SMS Firewall, exfiltration of logged messages, updating SMS Firewall software or provision of additional software modules as needed to cope with threats or other events, as described elsewhere herein.","The SMS Firewall and the Monitoring and Control System can use any or all methods for exchanging data, requests, or commands as are well understood by those with skill in the art, such as, without limitation, SMS or MMS messages, TCP\/IP connections over WiFi, wired Ethernet, GSM EDGE, Bluetooth or any other connection method that supports TCP\/IP communication. TCP\/IP connections can make use of standard protocols, such as HTTP, FTP, Telnet, or SSH, or use proprietary protocols designed or adapted for the purpose.","Data, requests or commands can be sent as ASCII, UTF or other encoded format text, mutually understood binary bit patterns, executable software objects, structured arrangements of data, such as XML, or any other method of exchange as known to those with skill in the art and usable by the mobile device and the Monitoring and Control System. Some embodiments of the current invention make use of any or all of the above communication methods, protocols and formats, as determined to be appropriate by those having skill in the art.","One possible method used by an exemplary, non-limiting embodiment of the current invention on a mobile device for sending an event notification to a Monitoring and Control System uses an ASCII text-based message format, sent over a TCP\/IP connection using the standard HTTP protocol. The exchange involves the following (standard protocol connection and header information omitted for clarity):","SMS Firewall Sends:","GET <URL>&imei=<number>&imsi=<number>&os=<os_name>&action=<action>&message-<description>","The Monitoring and Control System replies with: <status> or <error_code>","Or, in a specific example, a notification that a call was blocked, the SMS Firewall sends:","GET \/SMSFirewall.cgi&imei=343434343434348&imsi=5676767676767676 &os=symbian&action=block&message=call: 18475553456","The Monitoring and Control System replies with: OK","In another exemplary, non-limiting embodiment of the current invention, the exchange of messages is done using a shared binary message formatting, sent using a simple Telnet-like protocol. For example, an SMS Firewall detects an attempt to install software on the mobile device, and requests a decision about how to proceed from the Monitoring and Control System, and the Monitoring and Control System responds with a message telling the SMS Firewall whether to allow the installation, block the installation or to ask the device user:","SMS Firewall Sends:","<validate software message type code> <software fingerprint data>","The Monitoring and Control System replies with:","<validate software message response type code> <action code>","A specific example, where the software installation is permitted, the SMS Firewall sends binary data equivalent to the following hexadecimal byte values:\n\n","Monitoring and Control System replies with \u201callow\u201d, encoded as binary data equivalent to the following hexadecimal byte values:","In another exemplary, non-limiting embodiment of the current invention, the SMS Firewall uses the HTTP protocol to interact with a web server that is supporting the Monitoring and Control System. The SMS Firewall running on the mobile device first determines the most recent version number of the SMS Firewall software by requesting this information from the web server. It compares this version number with its own version. If the latest version number is greater than the version number of the SMS Firewall running on the mobile device, the latest version is requested, and installed. The exchange involves the following:","SMS Firewall Requests the Following URL:","https:\/\/www.smsfirewallserver.com\/latestversion","Server Responds: E1.2.3","SMS Firewall Requests the Following URL:","https:\/\/www.smsfirewallserver.com\/downloadlatest","Server responds by sending the binary installation package for the latest version of the SMS Firewall.","Other exchanges between exemplary embodiments of an SMS Firewall and a Monitoring and Control System of the current invention can be performed similarly to those described above, or using other methods as described herein, or any other method as will be well understood by those having skill in the art.","6.2.3 Reboot, Reinitialization and Reset","Even if the SMS Firewall closely controls all SMS message traffic, and STK interactions with the handset, there are some events that cannot be prevented. For example, a device can be rebooted by removal and reinstallation of the power source (e.g. the battery), some devices incorporate a reset switch that is a hardware method of causing the device to return to factory default settings, and some STK commands might not be subject to interception by the SMS Firewall on some devices. A means of detecting and responding to a disablement of the SMS Firewall in such cases is needed.","When the SMS Firewall is deployed overtly, it can signal its presence and proper operation through interaction with the user interface (UI) of the device. By use of on-screen display of text or icons, by audible signal, or such means as flashing lights, the user can be made aware of the state of the SMS Firewall, and can take corrective action, such as reinstallation, if it is not functioning. Such methods are well understood by those having ordinary skill in the art.","In some exemplary implementations, the SMS Firewall periodically contacts the Monitoring and Control System; and a failure to make such contact can indicate the removal or disabling of the SMS Firewall. In still more specific exemplary embodiments, in response to such indication, the SMS Firewall is redeployed, OTA or otherwise, as described herein. In some embodiments, the mobile device's use of the provider network and servers can be disabled at the provider to prevent use of the device until the SMS firewall is restored to functionality. This ensures that the device is protected from harmful messages, and unauthorized data exchanges are prevented, while the SMS Firewall is not functioning. In covert deployments, such disabling of service can prompt the user to take the device for servicing, where the SMS Firewall can be restored and service re-enabled. Provision and implementation of these elements will be familiar to those having ordinary skill in the art.","6.2.4 Incoming Message Processing",{"@attributes":{"id":"p-0122","num":"0138"},"figref":"FIG. 8","b":["8005","8010","8020","8040","8020","8030"]},"In some embodiments, SMS message log processing determines whether or not to record an SMS message in an exfiltration cache for later sending to a logging server in the monitoring and control console. In more specific embodiments, all SMS messages are recorded; in other embodiments, only those of particular types are recorded; and in still other embodiments, rules determine whether a particular message should be recorded, such as by specifying times, sources, or included content, or combinations of message features, such as specific content from specified sources, or particular message types during certain times of day, or between particular points in time.  illustrates an exemplary process of the invention in which the SMS Firewall checks its configuration to see if all SMS messages are to be logged (), and if so, adds the SMS message to the exfiltration cache () for later sending to a logging server, after which the process is complete. If all SMS messages are not being logged (), a check is made to see if the message is of a message type that is being logged (), and if so, the SMS message is added to the exfiltration cache () for later sending to a logging server and the process is complete. If the message is not of a type that is being logged (), the message is checked to see if it matches any existing logging rules (). If it matches at least one rule (), it is added to the exfiltration cache for later sending to a logging server () and the process is complete. Otherwise the message is not added to the exfiltration cache, and the process is complete. Those persons having ordinary skill in the art will be able to implement these actions.","In some embodiments, each type of SMS message is processed according to methods related to the type of SMS message. As shown in , one exemplary process first checks to see if the SMS message is a Simple Text SMS message (). If the SMS message is a Simple Text SMS message, then the Text Message processing (described below) () is performed and the process is complete. If the SMS message is not a Simple Text SMS message, then a check is made to see if it is a WAP Push Service Indication (SI) message (). If the SMS message is an SI message, then the WAP Push Service Indication processing () (described below) is performed on it, after which the process is complete. If the SMS message is not an SI message, then a check is made to see if it is a WAP Push Service Load (SL) message (), and if it is, then the WAP Push Service Load processing () (described below) is performed and the process is complete. If the SMS message is not an SL message, then a check is made to see if it is a SIM Application Toolkit (STK) message (), and if it is, then the STK message processing () (described below) is performed, and the process is complete. If the SMS message is not a STK message, then a check is made of the SMS Firewall configuration to see if unknown SMS message types are to be blocked (). If unknown SMS message types are to be blocked (), then the SMS message is discarded or its effects are reversed (), or both, and the process is complete. If unknown SMS message types are permitted, then the SMS message is processed normally () and the process is complete. As will be apparent to those with skill in the art, the method of checking SMS message type and invoking the required processing steps for each type just described is only one of many possible methods, and the substitution of a different, but functionally equivalent, method, such as performing type checks in another order, or using a lookup table to branch to the proper procedure, has no adverse effect on the functioning of the SMS Firewall and is merely an implementation detail.","6.2.4.1 Simple Text SMS Messages","As depicted in , in one embodiment Simple Text SMS message processing begins with a check of the SMS Firewall configuration settings to see if such messages are blocked (), and if so, then the message is discarded () and the process is complete. If Simple Text SMS messages are not blocked, then a check of the rule set for Simple Text SMS messages is made to see if any rule in the rule set matches the message being processed (). If there is no match, then the message is permitted through the SMS Firewall, and is processed normally (). If there is a match (), then the action specified by the rule is processed () as described below. If the processing of the rule resulted in the message being discarded (), then the process is complete. If processing of the rule did not result in the message being discarded (), then a check is made to see if the rule specified that the remaining rules should be skipped (). If the remaining rules are skipped (), then the normal message processing is performed and the process is complete. If the remaining rules are not skipped, then a check is made to see if the SMS message matches another rule (). If there are no more rules that match the message (), then the message is permitted through the SMS Firewall and processed normally (), after which the process is complete. If the message does match another rule (), then the rule is processed (), a check is made to see if the rule processing discarded the message (), and the process either continues checking for matching rules () and processing their actions () until the message has been discarded (), which completes the process, or all rules have been checked () without discarding the message and normal message processing permitted (), thus completing the process. These actions can be implemented by persons having ordinary skill in the art.","In some embodiments, the rules for matching Simple Text SMS messages include partial or complete matching of message data, such as, without limitation, origin address, subject, time or time interval of transmission or delivery, sender, message text, or any combination of these. Specifications can include \u201cwild cards\u201d, which match some or all of a given message attribute or attributes, or even \u201cregular expressions\u201d, which permit complex and flexible specification of matching conditions. Exemplary implementations can specify any or all of these methods. Still other methods will be apparent to those having ordinary skill in the art.","Actions associated with rules can include, for example and without limitation, discarding the matching SMS message, permitting normal processing of the matching SMS message without checking additional rules, saving the SMS message to the exfiltration cache for sending to a logging server, processing the SMS message in some manner other than normal, such as with a special background color, for example green or red, to indicate the importance, safety, potential danger, security level, or other aspect of the message, use of a different audible alert to indicate reception of the message, modification of the message data, or forwarding of the message to one or more additional recipients, with or without the knowledge of the current recipient. As indicated by the process flow of , when a Simple Text SMS message matches a plurality of rules, a plurality of actions can be processed for the message. These actions can be implemented by persons having ordinary skill in the art.","6.2.4.2 WAP Push Service Indication (SI) Messages",{"@attributes":{"id":"p-0128","num":"0144"},"figref":"FIG. 12","b":["12010","12020","12030","12030","12020","12030","1200","12050","12040","12060","12050","12070"]},"In some exemplary implementations, \u201cdeny list\u201d and \u201callow list\u201d as used above do not refer to literal lists of full URL specifications, but include partial URL specifications and \u201cwildcards\u201d or make use of \u201cregular expressions\u201d (as described above) to permit matching between the specification and a particular example of a URL found in an SI message. In still other exemplary implementations, the \u201cdeny list\u201d and \u201callow list\u201d can refer to a procedure for determining the acceptability or non-acceptability of a particular URL, for example by contacting a server where such information is available, asking the device user for a decision, or through other means as determined to be proper by those having skill in the art.","6.2.4.3 WAP Push Service Load (SL) Messages",{"@attributes":{"id":"p-0130","num":"0146"},"figref":"FIG. 13","b":["13010","13020","13030","13030","13020","13030","1300","13050","13040","13060","13050","13070"]},"In some exemplary implementations, \u201cdeny list\u201d and \u201callow list\u201d as used above do not refer to literal lists of full URL specifications, but include partial URL specifications and \u201cwildcards\u201d or \u201cregular expressions\u201d to permit matching between the specification and a particular example of a URL found in an SL message. In still other exemplary implementations, the \u201cdeny list\u201d and \u201callow list\u201d can refer to a procedure for determining the acceptability or non-acceptability of a particular URL, for example by contacting a server where such information is available, asking the device user for a decision, or through other means as determined to be proper by those having skill in the art.","6.2.4.4 SIM Application Toolkit (STK) Messages",{"@attributes":{"id":"p-0132","num":"0148"},"figref":"FIG. 14","b":["14010","14020","14030","14030"]},"If no fingerprint matches are found, then the message is sent to a server for validation and determination of the proper action(s) to take (). The server computes a fingerprint for the message, and determines the appropriate action(s) to take for the message. The server can determine the appropriate action(s) by looking up the fingerprint in a database or known messages (which can be significantly larger than what is supportable on a mobile wireless device), by performing an automated analysis of the message, by requesting a determination of proper action from human operators, or by a combination of these or other methods as determined to be proper by those having skill in the art. In some exemplary implementations, the server returns a preliminary action to the SMS Firewall to limit delay while analysis, particularly human analysis, is in progress. In some embodiments, preliminary actions are not stored for future use by the SMS Firewall, and are designed to be conservative in what is allowed. For example, a preliminary action can be to block the message. Once a preliminary or non-preliminary action or actions are determined, the server returns the fingerprint and the action to the SMS Firewall. Non-preliminary actions are stored () for future reference. The SMS Firewall can delete stored fingerprints to free storage space when storage space reaches a configured or computed level, when the number of stored fingerprints reaches a configured or computed count, when fingerprints have not been used for a configured or computed period of time, or by other criteria as determined by those having skill in the art.","Once a fingerprint match is determined, whether from previously stored fingerprint data or from values returned from a server query, the associated action is executed. One possible action is to approve the message for normal processing. If the action is to approve the message (), then the message is processed () and the process terminates. If the message is not approved (), then a check is made to see if the message is to be blocked (). If the message is to be blocked, then it is discarded or its effects reversed (), and the process is complete. If the message is not to be blocked, then a check is made to see if it should be modified (), such as by altering the commands or data contained in it. If modification is specified as an action for the STK message (), then the message is so modified (). A check is then made to see if a response watch should be triggered for the STK message (). Some STK messages, such as a \u201cRead Binary\u201d message, optionally result in response messages being sent, which the SMS Firewall should block or modify. In more specific embodiments, the triggering of a response watch results in the SMS Firewall expecting such a response message to be sent and retaining data about the STK message that generated the response for use in deciding whether to block or modify the response message. If a response watch is triggered, then the watch is set () and the message is then processed (), and the process is complete. These actions can be implemented by persons having ordinary skill in the art.","Persons having ordinary skill in the art will appreciate that the use of fingerprints to determine actions to take for STK messages is not only efficient in terms of SMS Firewall storage and processing workload, but it can be necessary in some cases, e.g., where the STK message contains proprietary protocols, the effects of which are not computable by the SMS Firewall. Humans can analyze such messages, and determine appropriate actions for dealing with them. This information, and the identifying fingerprint of the message, can be stored in a server database for use by the SMS Firewall when it encounters a matching message. This is similar in some ways to how anti-virus software on personal computers detects and deals with computer viruses and the concepts and techniques are well understood by those with skill in the art.","Some known uses for STK messages that can be detected, logged, blocked or modified, include:\n\n","By providing a capability to block or otherwise limit STK messages, the exemplary SMS Firewall can prevent use of the STK for making unauthorized purchases, dialing phone numbers silently and using the device as a remote listening unit, disclosing the device's location, installing software without permission, transferring device data files without permission, or other such actions, as well as using STK messages to interfere with the proper functioning of the SMS Firewall, such as by altering device configuration settings.","6.2.5 Outgoing Message Processing",{"@attributes":{"id":"p-0138","num":"0162"},"figref":"FIG. 15","b":["15010","15020","15030"]},"If all outgoing SMS messages are not currently blocked (), then a check is made to see if there is a response watch set for this message (). If there is a response watch set, the associated action is performed () and the process is complete. If there is no response watch set for this message (), and the message is an SMS Simple Text message (), the SMS Firewall configuration is checked to see if outgoing SMS Simple Text messages are currently blocked (). If outgoing SMS Simple Text messages are currently blocked (), then the message is deleted (), and the process is complete. If SMS Simple Text messages are not currently blocked (), then the message is matched against rules that apply to outgoing SMS Simple Text messages (). If no rules match, then the message is permitted to be sent () and the process is complete. If a rule does match (), then the action associated with the rule is performed (). If the rule action resulted in the message being blocked (), then the message is deleted (), and the process is complete. If the rule action did not result in the message being blocked (), and the rule bypassed all remaining rules (), then the message is permitted to be sent normally (), and the process is complete. If the rule action did not result in the remaining rules being bypassed (), then the next matching rule is located. If there are no more rules that match the message (), then the message is sent normally (), and the process is complete. If there are additional rules that match the message (), then the actions associated with the rule are performed (), and the process continues until all rules have been checked (), the message is blocked (), or remaining rules are bypassed (). If the message was not blocked as a result of this, then the message is permitted to be sent normally () and the process is complete. These actions can be implemented by persons having ordinary skill in the art.","Actions associated with rules for outgoing SMS Simple Text messages can include, for example and without limitation: discarding the matching SMS message, permitting normal processing of the matching SMS message without checking additional rules, saving the SMS message to the exfiltration cache, use of an audible, vibratory or visual alert to indicate sending of the message, modification of the message data, forwarding of the message to one or more additional recipients, with or without the knowledge of the current recipient, or, when not deployed covertly, asking the device user for authorization to send the message. As indicated by the process flow of , when a Simple Text SMS message matches a plurality of rules, a plurality of actions can be processed for the message.","If the message is not an SMS Simple Text message (), then the SMS Firewall configuration settings are checked to see if other types of outgoing SMS messages are to be blocked (). If other types of outgoing SMS messages are to be blocked (), then the message is discarded (), and the process is complete. If other types of outgoing SMS messages are not blocked (), then the message is permitted to be sent normally (), and the process is complete. These actions can be implemented by persons having ordinary skill in the art.","Persons having ordinary skill in the art will understand that by supporting a flexible method of dealing with outgoing SMS messages that can treat messages differently based on content, destination, source, type or other factors, the SMS Firewall permits desirable communications while blocking undesirable communications, and optionally logs either or both types for future reference, in an auditable manner that does not permit device user tampering with the data so collected. These capabilities support regulatory compliance, such as Sarbanes-Oxley or HIPPA, security concerns in government, military, or other organization environments, limit the capability of covertly installed software to exfiltrate data, and prevent unauthorized data transfers of all types.","6.2.6 Dealing With Software Installation Attempts","Persons having ordinary skill in the art will understand that new software installed on a wireless mobile device can pose a threat to the integrity of the SMS Firewall. Some software, such as anti-virus software, is designed to detect and prevent some of the mechanisms used by the SMS Firewall, and could reduce its effectiveness, or disable it entirely. Other software is intended to interfere with device operation, to transmit data without authorization, or to make use of the device in ways that are not appropriate. There is a desire, both for SMS Firewall integrity and to protect the wireless mobile device and the data it contains or processes, to limit or prevent installation of software on the wireless mobile device unless that software is authorized, and determined to be benign to the SMS Firewall.","Some embodiments of the invention include methods for preventing unauthorized software installation, including: blocking SMS message types that can be used to install software, and blocking the establishment of data links over which software can be downloaded to the wireless mobile device, by redirecting data connections through the monitoring and control console so that all data, including software downloads, are vetted and approved before reaching the wireless mobile device, or, in other embodiments, by redirecting data connections through the monitoring and control console so that alternative, more benign, software can be substituted for harmful software. Redirecting connections through the monitoring and control console can be done, for example, by re-provisioning the wireless mobile device, and setting its WAP gateway to be the monitoring and control console's WAP Gateway server, rather than the WAP Gateway the wireless mobile device was originally provisioned with. The monitoring and control console's WAP Gateway server then functions as a proxy, allowing or blocking access to other network servers as appropriate, and filtering or substituting data in transit to or from the wireless mobile device. These actions can be implemented by persons having ordinary skill in the art.","In some embodiments, the SMS Firewall blocks only some software installations, while permitting others. Configuration of the SMS Firewall includes, among other aspects, provision of a means of recognizing permitted software. Such means can comprise an \u201callow list\u201d of software that is permitted, while all other software installations are to be blocked. Alternatively, some embodiments comprise a \u201cdeny list\u201d of software that is not to be permitted, while all other software installations are allowed. Still other alternative embodiments comprise more complex means, such as specification of byte patterns to be searched for in software, expressions that specify permitted sources of software or sources that should be blocked, and actions that should be taken by the SMS Firewall when messages attempting installation of software matching any of these are detected. Actions can include, for example, blocking installation, permitting installation, forwarding software to a Monitoring and Control System, quarantine of the message until permission to install it is received from the monitoring and control console or, in some exemplary embodiments, from the device user, requesting additional analysis software or data from the Monitoring and Control System or other server to be used in deciding whether the software in question should be installed or blocked, or other actions as may be deemed proper by those having skill in the art. Some exemplary implementations can make use of a plurality of these methods, such as allow listing some software, deny listing some software, analyzing the rest for specific byte patterns and forwarding software that matches a byte pattern to a Monitoring and Control System while quarantining the software and blocking installation until the Monitoring and Control System returns a command to install or not install the software.",{"@attributes":{"id":"p-0146","num":"0170"},"figref":"FIG. 16","b":["16010","16060","16110","16020","16050"]},"If the software is not on an allow list or deny list, the SMS Firewall then checks to see if the software matches any known expressions (). Expressions can involve any known aspect of a message or device, such as the message source, message type, software being requested for installation, size of the software, size of the software in relation to the device's remaining resources, time of message arrival, current device location, the number of applications installed in a specified prior time period, etc. The result of the expression evaluation is the performance of one or more actions, and a decision as to whether to permit () or block () installation of the software. Actions can comprise any number of actions, such as quarantine of the software () until a decision whether to install it or not is provided by another entity, such as the device user or the Monitoring and Control System, obtaining additional software modules () to use for evaluating the software, its source or other aspects of the situation or for collecting additional data to use in making the decision, obtaining other software to substitute for the software requesting installation (), and querying the device user or Monitoring and Control System for a decision. One exemplary sequence of actions might comprise quarantine of the software, obtaining additional software modules to evaluate the situation, using the output of those modules to determine that substitution of different software is appropriate, obtaining substitute software and permitting installation of the substitute software, while sending the originally requested software to the Monitoring and Control System for logging and review, followed by deletion of the originally requested software from the mobile device. Regardless of the actions taken, the process is not complete () until a decision has been made about whether to permit installation () or to block it ().","6.2.7 Non-SMS Firewalls","In some embodiments, the device uses communication technologies such as TCP\/IP over Wi-Fi, various protocols over wired interfaces such as USB or Ethernet, wirelessly using TCP\/IP over cellular data networks (e.g. GPRS or EDGE), or P2P technologies such as Bluetooth or IRdA. There are well-understood methods for providing firewall protection to such technologies, particularly when TCP\/IP protocols are used. The SMS Firewall can optionally comprise such additional firewall protection technologies where this is advantageous, or can co-exist with such technologies when they are provided by other means, such as being incorporated into the device operating system, added as a separate processing facility, or otherwise. Due to its ability to be inserted into the SMS processing of the device, the SMS Firewall can operate on all SMS message traffic, regardless of the communication path that is used to transmit it. For example, if an SMS message is received via a TCP\/IP WiFi communication path, it is placed into the SMS message processing flow just as if it had arrived via the GSM control channel. The SMS Firewall, by the methods described elsewhere herein, is capable of mediating the message once it enters the SPS message processing flow. In some exemplary embodiments, the SMS Firewall can be constructed to make use of specific capabilities of particular non-SMS Firewall firewalls, such as a TCP\/IP firewall's application programming interface (API), and make use of such capabilities to mediate any SMS message that is processed by the non-SMS Firewall. This capability is useful when dealing with \u201ccombination attacks\u201d, where a plurality of communication protocols and methods are used in combination. For example, an SMS Short Text message might be sent to a device user with instructions to follow a URL link to obtain some benefit. When the user follows the link using a web browser over a Wi-Fi link using TCP\/IP, malicious code is installed on the device. In another example, a malicious application is installed using an SMS WAP Service Load attack, and the application then uses a Wi-Fi connection to improperly exfiltrate confidential data from the device. By protecting the device from SMS-based threats, and interacting as needed with protection systems that deal with threats of other types, combination attacks are prevented.","6.2.8 Blocking Transmission and Reception","As described above, incoming and outgoing SMS message traffic can be blocked by deleting messages in the SMS Firewall processing. This method is necessary when a subset of messages must be blocked, but when all messages are to be blocked, an alternative method involves the SMS Firewall turning off the wireless mobile device's radio. This method can also result in blocking voice phone calls, data exchange using other networks, such as Wi-Fi, and in some situations, such as when the SMS Firewall has been deployed covertly, can result in the user presuming the device has suffered hardware or software failure.","There are scenarios, such as when a device is being tracked by its radio emissions, when turning the device's radio off is desirable, and in such scenarios the user can be notified with a message or indicator on the device display, an audible or vibratory alarm, flashing lights, or by other means when the SMS Firewall has not been deployed covertly. In some embodiments, such radio disablement is performed by user command. This is useful when the device cannot be temporarily silenced by means such as removing its power source, and can also be useful even when the device is not being tracked, but radio emissions are not desirable, such as during travel on commercial airliners.","When device tracking is being performed such as by accessing a location-reporting application installed on the device, which can return, among other data, the ID of the cell that the device is currently receiving service from, other cells the device can detect, the signal strength of the cell signals, or the GPS-determined location of the device, and turning off the device radio is not desired, the SMS Firewall can block such messages, or alter the response messages to contain erroneous ID or location information. Such alterations can cause the device to appear to be in a location where it is not, or to be moving when it is static, or to be static when it is moving, and thus defeat tracking or location attempts. In some embodiments, the SMS Firewall indicates a specific erroneous cell ID, or a sequence of specific erroneous cell IDs, or specific erroneous GPS locations, or a sequence of specific erroneous GPS locations, so that it is known where those attempting to track the device will be looking for it, potentially making it easier to locate them. Behavior profiles that define the pattern of alterations to be made to location-reporting SMS messages can be pre-established and enabled as required, such as when specified patterns of SMS message activity is monitored by the SMS Firewall, or when a command to activate them is received from the UI or Monitoring and Control System. These functions can be implemented by persons having ordinary skill in the art.","Turning off the wireless mobile device's radio circuitry is also advantageous when certain cells in the network have been deny listed as insecure or hostile in some way. For example, Class 0 (\u201csilent SMS\u201d) messages can be used to cause a device to respond and thus permit detection of the device, either through the cell with cooperation from the service provider, or by use of other radio detection equipment. In some embodiments, the SMS Firewall can periodically re-enable the radio to see if the device has been moved to a location with a non-deny listed cell, and turn the radio off again if not. In embodiments including devices with GPS receivers, the SMS Firewall can use the GPS-determined location of the device to tell when the device has been moved, and thus avoid the need for periodic checks involving communication with the local cell transmitter. In exemplary embodiments that comprise a user interface, the user can be informed when radio transmission is disabled to avoid such detection. These actions can be implemented by persons having ordinary skill in the art.","6.2.9 Behavior Profiles","Some embodiments support named sets of configuration parameters and associated value settings (\u201cbehavior profiles\u201d), that when activated cause the SMS Firewall to implement particular device and SMS Firewall configurations on command, by user request (when deployed non-covertly and with a UI), or in response to particular events or threat level settings. Behavior profiles specify such configuration options as, for example and without limitation:\n\n","In some exemplary embodiments, behavior profiles can be \u201cnested\u201d. That is, a first behavior profile can optionally specify one or more second behavior profiles. When the first behavior profile is activated, the one or more second behavior profiles are also activated. The effect is as if a third behavior profile that encompasses all of the settings specified by the first behavior profile and the one or more second behavior profiles were activated. Conflicts between settings of the first and one or more second behavior profiles can be dealt with in different ways by various exemplary embodiments. For example, some exemplary embodiments will treat the first behavior profile as authoritative, and ignore conflicting settings from any second behavior profiles named by the first behavior profile. In other exemplary embodiments will treat the second behavior profiles as more authoritative than the first behavior profile, and override the first behavior profile's settings where there is a conflict. When two or more second behavior profiles conflict, they can be processed in the order they are named, or in the order they were defined, or in some other established sequence as may be deemed proper by those having skill in the art. In yet other exemplary embodiments, behavior profiles comprise a priority attribute, and the behavior profile with the higher priority will supersede those with lower priorities where there are conflicts between them. Other methods of dealing with conflicting settings are possible, as will be understood by those having skill in the art.","In more specific exemplary embodiments, the configuration settings of the behavior profile, or profiles, after resolving any conflicts, are set as the current configuration of the SMS Firewall, replacing the previous configuration when the threat level changes or, in other embodiments, upon user and\/or monitoring console command. In some embodiments, behavior profiles can be updated as needed, either by the user, through interactions with a UI, or by commands sent from a Monitoring and Control System.","In some exemplary embodiments, additional software modules can be provided to the SMS Firewall. These additional software modules can be instantiated immediately upon receipt in some exemplary embodiment, while in other exemplary embodiments instantiation can be tied to one or more behavior profiles and activated only when such a behavior profile is active. In some exemplary implementations instantiation can be tied to a particular threat level, with the module being active only while a particular threat level, or set of threat levels, are set. The particular additional software modules provided to the SMS Firewall can be determined, in some exemplary embodiments, by a human operator at a Monitoring and Control System, and in some exemplary embodiments, by the device user. In some exemplary embodiments, the modules to be provided to the SMS Firewall can be determined automatically, either by the SMS Firewall or by the Monitoring and Control System. Automatic determination can be based on a plurality of factors, such as the types of messages being detected by the SMS Firewall, the specifics of software installations being attempted (e.g. the type of software involved, the specific software package involved, the frequency of installation attempts, etc.), the type of mobile device the SMS Firewall is installed on, the kind of service plan the user has signed up for, etc. Additional software packages can be used to collect additional information, enable the SMS Firewall to deal with particular message types more efficiently or with a greater specificity as to message content, to counteract changes made by specific message types, to provide additional protection to the mobile device, its data or configuration, or for any other purpose as determined to be useful by those having skill in the art.","6.2.10 Threat Levels","Some exemplary implementations of the SMS Firewall provide a capability referred to herein as \u201cthreat levels\u201d. A \u201cthreat level\u201d as defined herein is a configuration setting that indicates the level of concern currently existing for one or more aspects of wireless mobile device security. Some exemplary embodiments provide for only one threat level to be active at any given time, while other exemplary embodiments can provide for a plurality of threat levels to be active simultaneously.","In some embodiments, the threat level is determined by using one or more of a variety of factors, such as device location or current cell ID, SMS message reception rate, the number of SMS messages that have been blocked or altered in the recent past, attempts to install hostile software on the device, attempts to disable the SMS Firewall, the receipt of deny listed URLs in WAP Push messages, detection of specified content in Simple Text SMS Messages being sent to or from the wireless mobile device, or commands from the Monitoring and Control System that specify the threat level to set. In some embodiments, threat levels determine which of a set of defined behavior profiles to activate so as to limit mobile wireless device use and functionality consistent with the types of threats being encountered or anticipated. In other embodiments, alteration of threat level results in a change in the behavior profiles used so as to match the new threat level, whether this is a greater level of threat, a lesser level of threat or simply a different type of threat (e.g. location tracking rather than attempting installation of software).","In some alternative exemplary embodiments, threat levels can comprise a time after which the threat level is reduced or eliminated if the condition that resulted in the threat level being set is no longer present. For example, if a threat level of \u201csoftware-install-attempt\u201d was set due to detection of SMS messages attempting improper software installation, this threat level can, in exemplary embodiments supporting such a feature, be implemented such that if 1 hour passes with no SMS software install messages arriving, the \u201csoftware-install-attempt\u201d threat level is removed. If a particular embodiment uses a different threat level scheme, such as a numerical sequence where lower number indicate lower threat levels and higher numbers indicate greater threat levels, the automatic threat level reduction can reduce the threat level by one step per hour, or at any other rate that is deemed proper by those having skill in the art, the device user, a company policy committee or others having an interest in the security of the device. In some exemplary embodiments the rate of threat level reduction or increase happens at a rate that is at least partially random, so that attackers can not know exactly when the threat level will be reduced. For example, such embodiments might permit specifying the rate as \u201cone step per hour, plus or minus 1 to 15 minutes\u201d.","Threat level determination is made, in some embodiments, by the SMS Firewall using information available to it or calculated by it. In other exemplary embodiments, the threat level is provided to the SMS Firewall by a Monitoring and Control System. The Monitoring and Control System can determine the appropriate threat level by having it set by a human operator, or by calculation using information obtained from the SMS Firewall, from a plurality of second SMS Firewalls on other mobile devices, or through other sources such as security organization announcements. In some exemplary embodiments, a plurality of these methods are used.","A \u201cThreat Level\u201d specification in some exemplary embodiments comprises a single value, such as a number, letter, or word (e.g. \u201clow\u201d, \u201cmedium\u201d or \u201chigh\u201d) that results in the SMS Firewall adopting a pre-defined set of behavior profiles, or a set of behavior profiles matching a pre-defined pattern (e.g. if the Threat Level is specified as \u201cmedium\u201d, all behavior patterns whose names start with \u201cmedium\u201d, or which specify association with \u201cmedium\u201d threat levels in their definitions, become active).","Some exemplary embodiments indicate threat levels within a device as a point on a numerical scale in some exemplary embodiments, such as a scale where a threat level of \u201c1\u201d indicates little or no threat, and \u201c10\u201d indicates a serious threat, with intermediate integers indicating intermediate levels of threat. In other exemplary embodiments the numerical scale can be continuous, with real numbers indicating threat level, such as 1.0, 2.6, or 7.98. Likewise, negative values can also be used, for example with a scale extending from \u22125 to +5. In other exemplary embodiments, threat level is associated with a color code, such as green for little or no threat, yellow for intermediate threat levels and red to indicate the greatest threat. In such embodiments the color code can also be equated to an underlying sequential sequence, such as integer threat levels where this is seen as advantageous by those having skill in the art. Such associations can have utility, for example, when implementing a user interface, where the threat level is maintained internally as, for example, an integer, and ranges of integers are mapped to color codes for use in displaying the threat level to the device user. Other mappings are possible, such as real number threat levels to a \u201cslider\u201d indicator such as those used by many software installations to show progress, an icon that changes size as threat level increases and decreases, an audible indication, such as a sequence of beeps that change pitch, count or rate with threat level, a device vibration that occurs when threat level passes a defined level, or a combination of these or other methods of conveying threat level to the device user or to device software as required.","In yet other exemplary embodiments, threat levels are not organized into an ordered sequence, such as integers or real numbers, but are used to indicate the existence or absence of a particular class of threat, and can be active or inactive individually. For example, an exemplary embodiment can define a threat level called \u201ctracking\u201d that indicates whether or not there have been, or might be, unauthorized attempts to determine the device's location, a second threat level called \u201cdata access\u201d that indicates whether or not there have been, or might be, unauthorized attempts to access data stored on the device, and a third threat level called \u201ceavesdrop\u201d that indicates that there has been, or might be, an attempt to activate the device's microphone and send the sounds collected by it to another device. Other threat levels are possible, such as those concerning the device's user disclosing confidential information using SMS or voice methods, software being installed OTA on the device, or just unwanted advertising messages being sent to the device. A given device at a particular time might have no threat levels active, might have a plurality of them active at once, or might have any combination of the threat levels it defines active simultaneously. Indication of the state of any given threat level can be provided by use of icons that represent threat levels and their current state, text displays listing similar information, audible outputs such as voice or tones, vibration of the device, or other methods as will be known to those with skill in the art.","In alternative embodiments, a Threat Level comprises a more complex object, such as an XML file, and\/or an executable software object that specifies or implements a plurality of changes to be undertaken by the SMS Firewall as a result of the particular Threat Level being made active. Such changes can comprise activation or deactivation of one or more behavior profiles, download or definition of additional or replacement behavior profiles, deletion of existing behavior profiles, or alterations to device configuration or functioning outside of those specified by behavior profiles, such as by altering the configuration of device applications, installation of additional software, or removal of existing software as well as such actions as alerting of the device user or the monitoring console. For example, in response to a threat of device tracking by hostile entities, an application that is used to report device location, such as a GPS logger application, can be shut down or deleted, or can be reconfigured to report incorrect location data.","6.2.11 Threat Levels and Behavior Profile Activation","In some exemplary embodiments, threat levels are used to activate and\/or deactivate behavior profiles or to perform other actions such as executing application software, changing the user interface state, or turning the device off. Threat levels in some exemplary embodiments are determined by events that are detected by the SMS Firewall. Some non-limiting, exemplary events and their associated exemplary behavior profiles and\/or actions are:\n\n","The specification of the threat level or levels to associate with particular events, what behavior profiles to activate in response to detection of specific events, or with particular threat levels, and what other actions to take when a given event is detected can be implemented as default behavior in the SMS Firewall in some exemplary embodiments. In other exemplary embodiments such specifications are done through configuration settings of the SMS Firewall, whether performed by the device user through a user interface, by the monitoring console through messages sent to the SMS Firewall, by the SMS Firewall itself, or by other means.","When such event\/threat level\/behavior profile\/action specifications must be transmitted or stored, or for ease in editing the specifications, the specification data can be represented in any convenient form, such as text, and converted to any convenient internal data structure for use by the SMS Firewall, as will be well understood by those with skill in the art. A non-limiting, exemplary embodiment of event\/threat level\/behavior profile\/action specification data in text form is described below. Other embodiments are possible, as will be apparent to those with skill in the art.","In one exemplary embodiment, event\/threat level\/behavior profile\/action specification data comprises a set of rules and relationships between them. Individual rules specify an event, and what is to be done when the event is detected, such as activating a particular threat level and\/or behavior profile, or performing a specified action. Rules can have IDs that comprise numbers and\/or one or more names so that the rule can be referred to by other rules, by the user interface, in log files, or for other purposes. Numbers and\/or names can be unique or shared with other rules, or both within a given embodiment. Rules can be \u201cenabled\u201d or \u201cdisabled\u201d. A rule that is \u201cenabled\u201d is implemented when the associated event is detected, while a rule that is \u201cdisabled\u201d is ignored and has no effect, even when the event associated with it is detected. Relationships between rules can comprise grouping them together, specifying Boolean relationships, such as AND, OR, EXCLUSIVE OR or NOT, or no relationship.","Grouping of rules is useful, for example, so that that they can be enabled or disabled together, without a requirement to specify each individual rule, or so that they can be selected for deletion, editing or other purposes as a group.","Boolean relationships can be between individual rules, or between groups of rules, or both. Such relationships permit specification of more complex patterns of events. For example, one might specify that an incoming SMS message event should result in the logging of the event with a first rule, and that an SMS message from a specified phone number that is requesting device location should result in the requested information being returned with a second rule. Such a pair or rules would result in the logging of the location request message, which might not be desirable in all scenarios. For example, if the application requesting the location information repeats the request often so as to perform detailed tracking of the device, a large number of log entries will result. Without an ability to specify relationships between rules is can be difficult or impossible to avoid such results. With the ability to specify Boolean relationships between rules and groups of rules this problem is easily handled by specifying and \u201cAND NOT\u201d relationship between the first, SMS logging, rule and a third rule that specifies reception of an SMS message from the location-requesting phone number. This would result in logging of SMS messages unless the SMS message is from the location-requesting phone number, while still responding to the request using the second rule.","Specification of rule grouping and relationships can be done in many ways well understood by those with skill in the art. One non-limiting example is to use a standard description language, such as XML, that permits specification of objects and their relationships. By defining XML \u201ctags\u201d for rules, rule groups, and relationships between these, any arbitrary arrangement of rules and relationships is possible. When the event, with any qualifiers that are specified by a rule, is detected, the rule is said to be \u201ctriggered\u201d. The actions associated with a rule do not occur unless the rule is \u201ctriggered\u201d. When there are relationships between rules or groups of rules, these relationships must also be satisfied for the rules comprising the relationship to be triggered. Relationships can be \u201cAND\u201d, to specify that all rules and groups in the relationship must be triggered for any of them to be triggered, \u201cOR\u201d, to specify that if any of the rules or groups in the relationship are triggered, then the rules or groups are triggered, or \u201cXOR\u201d to specify that the rules or groups are triggered only if exactly one of them is triggered. A rule or group's triggered status can be reversed for purposes of deciding such relationships by use of a \u201cruleNegation\u201d tag. For example:",{"@attributes":{"id":"p-0172","num":"0210"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<?xml version=\u201c1.0\u201d?>"]},{"entry":[{},"<ruleset>"]},{"entry":[{},"\u2003<ruleRelation type=\u201cAND\u201d>"]},{"entry":[{},"\u2003\u2003<ruleType name=\u201cRule-A\u201d>"]},{"entry":[{},"\u2003\u2003\u2003[rule definition goes here]"]},{"entry":[{},"\u2003\u2003<\/ruleType>"]},{"entry":[{},"\u2003\u2003<ruleGroup name=\u201cGroup-1\u201d>"]},{"entry":[{},"\u2003\u2003\u2003<ruleRelation type=\u201cOR\u201d>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<ruleType name=\u201cRule-B\u201d>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003[rule definition goes here]"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/ruleType>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<ruleNegation>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<ruleType name=\u201cRule-C\u201d>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003\u2003[rule definition goes here]"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<\/ruleType>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/ruleNegation>"]},{"entry":[{},"\u2003\u2003\u2003<\/ruleRelation>"]},{"entry":[{},"\u2003\u2003<\/ruleGroup>"]},{"entry":[{},"\u2003<\/ruleRelation>"]},{"entry":[{},"<\/ruleset>"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In this example there are three rules, \u201cRule-A\u201d, \u201cRule-B\u201d and \u201cRule-C\u201d. The details of the definitions of these rules are omitted for clarity. Rule-B and Rule-C are grouped into a group known as \u201cGroup-1\u201d. Rule-A and Group-1 have an \u201cAND\u201d relationship; meaning that neither Rule-A nor Group-1 result in any actions, are triggered, unless both are triggered. Within Group-1 there is an \u201cOR\u201d relationship between Rule-B and a negation of Rule-C. This means that the event specified by Rule-B must be detected, or the event specified by Rule-C must not be detected, for Group-1 to be triggered. So if Rule-A's event occurs and Rule-C's event also occurs, both rules' actions are executed. If Rule-B is also triggered, its actions will be executed too, since the Rule-B\/Rule-C relationship is an \u201cOR\u201d, not an \u201cXOR\u201d. If Rule-C's event is detected, then Rule-B's event must also be detected for any actions to be executed.","In the exemplary embodiment being described, individual rules are specified by text in a defined format, such as:",{"@attributes":{"id":"p-0175","num":"0213"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<rule ID> : <event> : [<qualifier> [, <qualifier> ... ] : ] <action>"]},{"entry":[{},"\u2002[, <action> ...]}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0176","num":"0214"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<ruleType name=\u201cRule-n\u201d>"]},{"entry":[{},"\u2003<ruleID>"]},{"entry":[{},"\u2003\u2003<ruleName value=\u201cname\u201d>"]},{"entry":[{},"\u2003\u2003<ruleID \u2003value=\u201c1234\u201d>"]},{"entry":[{},"\u2003<\/ruleID>"]},{"entry":[{},"\u2003<ruleEvent type=\u201cSMS-Message-Received\u201d>"]},{"entry":[{},"\u2003\u2003<ruleQualifier Number=\u201c123-456-7890\u201d>"]},{"entry":[{},"\u2003\u2003<ruleQualifier Provider=\u201c34571\u201d>"]},{"entry":[{},"\u2003\u2003<ruleQualifier SMS-Msg-Type=\u201c0\u201d>"]},{"entry":[{},"\u2003<\/ruleEvent>"]},{"entry":[{},"\u2003<ruleActionList>"]},{"entry":[{},"\u2003\u2003<ruleAction Value=\u201cLog\u201d>"]},{"entry":[{},"\u2003\u2003<ruleAction Value=\u201cIncrement-SMS-Counter\u201d>"]},{"entry":[{},"\u2003<\/ruleActionList>"]},{"entry":[{},"<\/ruleType>"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"The following tables are non-limiting examples of some events and the qualifiers and actions that can be associated with them in the exemplary embodiments being described.",{"@attributes":{"id":"p-0178","num":"0216"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Qualifiers","Action"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: SMS-Message-Received"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Message-Type=<type>","Log-Event"]},{"entry":["Number-From=<number>","Alert-User=<method, message>"]},{"entry":["Body-Contains=<text pattern>","Drop-Message"]},{"entry":["Body-Contains=<binary pattern>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: SMS-Message-Send"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Message-Type=<type>","Log-Event"]},{"entry":["Number-To=<number>","Alert-User=<method, message>"]},{"entry":["Body-Contains=<text pattern>","Block-Send"]},{"entry":["Body-Contains=<binary pattern>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: MMS-Message-Received"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["MIME-Type=<type>","Log-Event"]},{"entry":["Number-From=<number>","Alert-User=<method, message>"]},{"entry":["Body-Contains=<text pattern>","Drop-Message"]},{"entry":["Body-Contains=<binary pattern>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: MMS-Message-Send"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["MIME-Type=<type>","Log-Event"]},{"entry":["Number-To=<number>","Alert-User=<method, message>"]},{"entry":["Body-Contains=<text pattern>","Block-Send"]},{"entry":["Body-Contains=<binary pattern>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: TCP-Firewall-Blocked-Packet"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Protocol=TCP|UDP|ICMP|IP|OTHER","Log-Event"]},{"entry":["IP-From=<IP Address>","Alert-User=<method, message>"]},{"entry":["Port-To=<Port Number>","Set-Threat-Level=<level>"]},{"entry":["Packet-Contains=<text pattern>","Set-Behavior-Profile=<profile>"]},{"entry":["Packet-Contains=<binary pattern>","Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: Voice-Call-Dialed"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Number=<phone number>","Log-Event"]},{"entry":["Time-Of-Day=<start-time>\/","Hang-Up"]},{"entry":["<end time>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: Voice-Call-Incoming"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Number=<phone number>","Log-Event"]},{"entry":["Time-Of-Day=<start-time>\/","Hang-Up"]},{"entry":["<end time>","Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Event: Silent-Call-Answer"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Number=<phone number>","Log-Event"]},{"entry":[{},"Hang-Up"]},{"entry":[{},"Set-Threat-Level=<level>"]},{"entry":[{},"Set-Behavior-Profile=<profile>"]},{"entry":[{},"Activate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Deactivate-Rule=<rule ID>"]},{"entry":[{},"or <rule group ID>"]},{"entry":[{},"Null-Action"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"Thus the present invention provides important methods, software, systems, and devices for securing wireless mobile devices. Although various specific embodiments and examples have been described herein, those having ordinary skill in the art will understand that many different implementations of the invention can be achieved without departing from the spirit or scope of this disclosure. For example, encryption and decryption can be performed using a single software module or more than two software modules. The modules described herein can be implemented using a variety of techniques and can be part of the operating system as well as plug-ins. Still other variations will be clear to those having ordinary skill in the art."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"5 BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIGS. 7","i":["a","b","c ","d "],"b":["7","7","7"]},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIG. 9","FIG. 8"]},{"@attributes":{"id":"p-0058","num":"0057"},"figref":["FIG. 10","FIG. 8"]},{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 11","FIG. 10"]},{"@attributes":{"id":"p-0060","num":"0059"},"figref":["FIG. 12","FIG. 10"]},{"@attributes":{"id":"p-0061","num":"0060"},"figref":["FIG. 13","FIG. 10"]},{"@attributes":{"id":"p-0062","num":"0061"},"figref":["FIG. 14","FIG. 10"]},{"@attributes":{"id":"p-0063","num":"0062"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":"FIG. 16"}]},"DETDESC":[{},{}]}
