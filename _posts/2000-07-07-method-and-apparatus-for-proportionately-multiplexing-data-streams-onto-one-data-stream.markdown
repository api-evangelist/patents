---
title: Method and apparatus for proportionately multiplexing data streams onto one data stream
abstract: A method and system that enables proportionately multiplexing a plurality of data stream into one data stream is disclosed. A mobile station has applications that produce separate data streams. Example applications include voice, signaling, E-mail and web applications. The data streams are combined by a multiplexer module into one data stream called the transport stream. The transport stream is sent over the reverse link to a BTS. The multiplexer module combines the data streams onto the transport stream according to their relative proportions and priorities.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06909722&OS=06909722&RS=06909722
owner: 
number: 06909722
owner_city: 
owner_country: 
publication_date: 20000707
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["I. Field of the Invention","The present invention pertains generally to the field of communications and more specifically to a novel and improved system and method for proportionately multiplexing a plurality of data streams into one data stream.","II. Description of the Related Art","The use of code division multiple access (CDMA) modulation techniques is one of several techniques for facilitating communications in which a large number of system users are present. Although other techniques such as time division multiple access (TDMA), frequency division multiple access (FDMA), and AM modulation schemes such as amplitude companded single sideband (ACSSB) are known, CDMA has significant advantages over these other techniques. The use of CDMA techniques in a multiple access communication system is disclosed in U.S. Pat. No. 4,901,307, entitled \u201cSPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEM USING SATELLITE OR TERRESTRIAL REPEATERS,\u201d and U.S. Pat. No. 5,103,459, entitled \u201cSYSTEM AND METHOD FOR GENERATING WAVEFORMS IN A CDMA CELLULAR TELEPHONE SYSTEM,\u201d both of which are assigned to the assignee of the present invention, the disclosures of which are incorporated by reference herein.","Choosing an allocation scheme for allocating frames from multiple data streams onto one data stream is difficult. Many allocation schemes fall short of performance requirements. For example, a shortest-job-first (SJF) scheme would starve longer jobs. An application residing on a subscriber unit\/mobile phone may produce a data stream comprising many frames that must be processed in a timely fashion. Yet, in an SJF scheme, the processing of a data stream having many frames may be starved because of other data streams having fewer frames to be processed. Likewise, a last-in-first-out (LIFO) scheme could starve frames from a data stream that was first in a LIFO queue. On the other hand, a first-in-first-out (FIFO) scheme does not accommodate the relative importance of data streams. In FIFO, every data stream must wait its turn. Consequently, an extremely important data stream may have to wait for a number of less important data streams to be processed. An allocation scheme that does not starve any data stream is desired. It is desirable to have a limit as to when a frame from a data stream will be processed.","Some allocation schemes do not take into account the number of frames that are in a data stream. For example, FIFO and LIFO are only concerned with when a frame from a data stream enters a processing queue. They do not take into consideration the size of data streams. An allocation scheme that takes into consideration the size of the data streams while at the same time not starving a data stream is desired.","The present invention is directed to a system and method for multiplexing a plurality of data streams onto one data stream for transmission. The method creates a list of queues, each queue representing a data stream and having a length inversely proportional to a proportion value of the data stream, wherein each data stream comprises at least one packet or frame. In one embodiment of the invention, each data stream comprises at least one packet. In another embodiment of the invention, each data stream comprises at least one frame. Each queue is incremented by the inverse of the proportion value for each transport frame. In one embodiment of the invention, a packet is scheduled from the data stream corresponding to a filled queue. In another embodiment of the invention, frames are distributed from the plurality of data streams onto a single data stream based on both whether a queue representing a data stream is full and on priority values of the data streams. In still another embodiment of the invention, frames are distributed based primarily on whether a queue representing a data stream is full and secondarily based on the priority of the queues.","In one embodiment of the invention, a plurality of applications provides a plurality of data streams to be multiplexed by a multiplexer. In another embodiment of the invention, subcriber units provide a plurality of data streams to be multiplexed by a multiplexer within a base station. In still another embodiment of the invention, a plurality of base stations provides a plurality of data streams to be multiplexed by a multiplexer within a base station controller.","In one embodiment of the invention, a subscriber unit comprises a memory, a plurality of applications residing in the memory, each application producing a data stream wherein each data stream comprises at least one frame, and a multiplexer configured to receive each data stream and uniformly distributing frames from the plurality of data streams onto a single data stream. In one embodiment of the invention, the multiplexer is configured to receive each data stream and uniformly distribute frames from the plurality of data streams onto a single data stream based on the proportion value.","In another embodiment of the invention, the multiplexer is configured to receive each data stream and uniformly distribute frames from the plurality of data streams onto a single data stream based primarily on the data streams' proportion value and secondarily on the data streams' priority.","In still another embodiment of the invention, a wireless communication system comprises a subscriber unit, a base station coupled to the subscriber unit and a base station controller coupled to the base station. The subscriber unit has a plurality of applications and a multiplexer, wherein each application produces a data stream as input to the multiplexer and each data stream comprises at least one frame. The multiplexer uniformly distributes frames from the data streams onto a single stream based on the data streams' proportion value.","An exemplary cellular mobile telephone system in which the present invention is embodied is illustrated in FIG. . For purposes of example this system is described herein within the context of a W-CDMA cellular communications system. However, it should be understood that the invention is applicable to other types of communication systems, such as personal communication systems (PCS), wireless local loop, private branch exchange (PBX) or other known systems. Furthermore, systems utilizing other well known transmission modulation schemes such as TDMA and FDMA as well as other spread spectrum systems may employ the present invention.","As illustrated in , a wireless communication network  generally includes a plurality of mobile stations (also called subscriber units or user equipment) -, a plurality of base stations (also called base station transceivers (BTSs) or Node B) -, a base station controller (BSC) (also called radio network controller or packet control function ), a mobile station controller (MSC) or switch , a packet data serving node (PDSN) or internetworking function (IWF) , a public switched telephone network (PSTN)  (typically a telephone company), and an Internet Protocol (IP) network  (typically the Internet). For purposes of simplicity, four mobile stations -, three base stations -, one BSC , one MSC , and one PDSN  are shown. It would be understood by those skilled in the art that there could be any number of mobile stations , base stations , BSCs , MSCs , and PDSNs .","In one embodiment the wireless communication network  is a packet data services network. The mobile stations -may be any of a number of different types of wireless communication device such as a portable phone, a cellular telephone that is connected to a laptop computer running IP-based, Web-browser applications, a cellular telephone with an associated hands-free car kit, a personal digital assistant (PDA) running IP-based, Web-browser applications, a wireless communication module incorporated into a portable computer, or a fixed location communication module such as might be found in a wireless local loop or meter reading system. In the most general embodiment, mobile stations may be any type of communication unit.","The mobile stations -may advantageously be configured to perform one or more wireless packet data protocols such as described in, for example, the EIA\/TIA\/IS-707 standard. In a particular embodiment, the mobile stations -generate IP packets destined for the IP network  and encapsulate the IP packets into frames using a point-to-point protocol (PPP).","In one embodiment the IP network  is coupled to the PDSN , the PDSN  is coupled to the MSC , the MSC  is coupled to the BSC  and the PSTN , and the BSC  is coupled to the base stations -via wirelines configured for transmission of voice and\/or data packets in accordance with any of several known protocols including, e.g., E1, T1, Asynchronous Transfer Mode (ATM), IP, PPP, Frame Relay, HDSL, ADSL, or xDSL. In an alternate embodiment, the BSC  is coupled directly to the PDSN , and the MSC  is not coupled to the PDSN . In another embodiment of the invention, the mobile stations -communicate with the base stations -over an RF interface defined in the 32 \u201c3GPP2\u201d, \u201cPhysical Layer Standard for cdma2000 Spread Spectrum Systems,\u201d 3GPP2 Document No. C.P0002-A, TIA PN-4694, to be published as TIA\/EIA\/IS2000-2-A, (Draft, edit version 30) (Nov. 19, 1999), which is fully incorporated herein by reference.","During typical operation of the wireless communication network , the base stations -receive and demodulate sets of reverse-link signals from various mobile stations -engaged in telephone calls, Web browsing, or other data communications. Each reverse-link signal received by a given base station -is processed within that base station -. Each base station -may communicate with a plurality of mobile stations -by modulating and transmitting sets of forward-link signals to the mobile stations -. For example, as shown in , the base station communicates with first and second mobile stations , simultaneously, and the base station communicates with third and fourth mobile stations , simultaneously. The resulting packets are forwarded to the BSC , which provides call resource allocation and mobility management functionality including the orchestration of soft handoffs of a call for a particular mobile station -from one base station -to another base station -. For example, a mobile station is communicating with two base stations , simultaneously. Eventually, when the mobile station moves far enough away from one of the base stations , the call will be handed off to the other base station ","If the transmission is a conventional telephone call, the BSC  will route the received data to the MSC , which provides additional routing services for interface with the PSTN . If the transmission is a packet-based transmission such as a data call destined for the IP network , the MSC  will route the data packets to the PDSN , which will send the packets to the IP network . Alternatively, the BSC  will route the packets directly to the PDSN , which sends the packets to the IP network .","The wireless communication channel through which information signals travel from a mobile station  to a base station  is known as a reverse link. The wireless communication channel through which information signals travel from a base station  to a mobile station  is known as a forward link.","In an exemplary embodiment, a mobile station communicates with a base station using wideband code division multiple access (W-CDMA) techniques. W-CDMA is a recently proposed 3G communication system. One example of a W-CDMA system is described in the European Telecommunications Standards Institute (ETSI) Terrestrial Radio Access (UTRA) International Telecommunications Union (ITU) Radio Transmission Technology (RTT) Candidate Submission forwarded by ETSI to the ITU for consideration for the IMT-2000 CDMA standard. The base station s in a W-CDMA system operate asynchronously. That is, the W-CDMA base stations do not all share a common universal time reference. Different base stations are not time-aligned. Thus, although a W-CDMA base station has a pilot signal, a W-CDMA base station may not be identified by its pilot signal offset alone. Once the system time of one base station is determined, it cannot be used to estimate the system time of a neighboring base station . For this reason, mobiles in a W-CDMA system use a three-step PERCH acquisition procedure to synchronize with each base station in the system. Each step in the acquisition procedure identifies a different code within a frame structure called a PERCH channel. An industry standard for a wireless system using code division multiple access (CDMA) is set forth in the TIA\/EIA Interim Standard entitled \u201cMobile station-Base Station Compatibility Standard for Dual-Mode Wideband Spread Spectrum Cellular System\u201d, TIA\/EIA\/IS-95, and its progeny (collectively referred to herein as IS-95), the contents of which are also incorporated herein by reference. More information concerning a code division multiple access communication system is disclosed in U.S. Pat. No. 4,901,307, entitled \u201cSPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEM USING SATELLITE OR TERRESTRIAL REPEATERS,\u201d and U.S. Pat. No. 5,103,459, entitled \u201cSYSTEM AND METHOD FOR GENERATING WAVEFORMS IN A CDMA CELLULAR TELEPHONE SYSTEM,\u201d both of which are assigned to the assignee of the present invention, and are incorporated in their entirety by reference herein.","Third-generation CDMA wireless communications systems have also been proposed. The cdma2000 ITU-R Radio Transmission Technology (RTT) Candidate Submission proposal forwarded by the Telecommunications Industry Association (TIA) to the International Telecommunication Union (ITU) for consideration for the IMT-2000 CDMA standard is an example of such a third-generation wireless communication system. The standard for cdma2000 is given in draft versions of IS-2000 and has been approved by the TIA. The cdma2000 proposal is compatible with IS-95 systems in many ways. For example, in both the cdma2000 and IS-95 systems, each base station time-synchronizes its operation with other base stations in the system. Typically, the base station synchronize operation to a universal time reference such as Global Positioning System (GPS) signaling; however, other mechanisms can be used. Based upon the synchronizing time reference, each base station in a given geographical area is assigned a sequence offset of a common pseudo noise (PN) pilot sequence. For example, according to IS-95, a PN sequence having 2chips and repeating every 26.67 milliseconds (ms) is transmitted as a pilot signal by each base station . The pilot PN sequence is transmitted by each base station at one of 512 possible PN sequence offsets. Each base station transmits the pilot signal continually, which enables mobile stations to identify the base station's transmissions as well as for other functions.","In an exemplary embodiment of the invention, a mobile station has a plurality of applications. The applications reside within the mobile station and each application produces a separate data stream. An application may produce more than one data stream.",{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 2","b":["12","12","32","34","36","38","49","12","32","34","36","38","40","42","44","46","48","50","50","14"]},"The multiplexer module  combines the data streams - onto the transport stream  according to their relative proportions and priorities. Each data stream - has a proportion value and a priority. The proportion value determines the proportion of the transport stream  that the data stream - is scheduled to occupy. The priority determines which data stream - will provide a packet to the multiplexer module  when the scheduled data stream - is empty. Initially, the relative proportions of the data streams are used to schedule frames from the data streams - to be sent over the reverse link. If a frame is scheduled from a data stream - that is empty, then a frame is taken from the highest priority non-null data stream - to be sent over the reverse link.","Each data stream - has a proportion value that determines the proportion of the transport stream  that the data stream - is scheduled to occupy. If a data stream - is empty, then the multiplexer module  uses the priorities of the data streams - to determine where to get the next frame. The multiplexer module  gets the next frame from the highest priority non-null data stream -.","The data stream proportions determines the mapping of the data streams onto the transport stream. The mapping determines where the multiplexer module  will initially look to get a frame. In one embodiment of the invention, the mapping is established in real-time, i.e., when an application is producing a data stream for the multiplexer module  to process. In another embodiment of the invention, the mapping can be established before an application produces a data stream for the multiplexer module  to process. As would be apparent to one of ordinary skill in the art, the mapping does not have to be real-time. For example, the mapping can be done at compile time. That is, an algorithm to do the mapping can be compiled off-line.","Once a mapping table (not shown) is created, the mapping table can then be advantageously traversed repeatedly during frame transmissions, so that each mapping table element determines which data stream frame should be sent in the transport frame slot corresponding to the mapping table element.","In yet another embodiment of the invention, a mapping algorithm is executed continuously when sending frames onto the transport stream . The advantage of continuously executing the mapping algorithm is that the mapping algorithm can be enhanced to quickly adapt to changes in the number and the proportional mix of the data streams - without disturbing the data stream distribution statistically. However, this algorithmic usage is less efficient than the table method when the number and proportionality of the data streams - do not change often compared to the transport frame rate.","The priorities of the data streams - matter only when a frame is scheduled to come from a data stream - that is empty\/null, i.e., when an application does not produce any more frames. If a data stream - does not have any frame to be sent, its frame slots are used to send frames from the highest priority data stream - among the data streams - that have frames to be sent. That is, when a frame is schedule to come from an empty data stream -, the multiplexer module  takes the next frame from the highest priority non-null data stream -.","In an exemplary embodiment of the invention, the multiplexer module  operates within the media-access control (MAC) layer and gets the proportion values and data stream priorities from a higher network layer. As would be apparent to one of ordinary skill in the art, the data streams - can be prioritized with any priority scheme known in the art, such as first-in-first-out (FIFO), last-in-first-out (LIFO), and shortest-job-first (SJF). As would be apparent to one of ordinary skill in the art, the multiplexer module  can operate on a plurality of network levels.","In another embodiment of the invention, the multiplexer module  is executed in hardware. In yet another embodiment of the invention, the multiplexer module  is executed in a combination of software and hardware. As would be apparent to one of ordinary skill in the art, the multiplexer module  can be executed by any combination of software and hardware.","The mapping algorithm creates a map table that specifies a scheduling sequence the multiplexer module  uses to schedule frames from the data streams -. Each data stream - is scheduled to provide frames to the multiplexer module .","If each data stream - is non-null, i.e., not empty, then each data steam - will occupy its relative proportion of the transport stream . Let p, p, . . . , pn be the relative proportions taken by n data streams - sharing the same transport stream , then for every p frames from data stream , there are p frames from data stream , and p frames from data stream , . . . , and pn frames from data stream n.","If there are three non-null data streams -, then data stream  will occupy p\/(p+p+p) of the transport stream , where pn is the proportion value of data stream n. For example, given non-null data streams -, a data stream , a data stream , and a data stream , where data stream  has a proportion value of 5 (p=5;), data stream  has a proportion value of 3 (p=3), and data stream  has a proportion value of 2 (p=2), then data stream  will occupy {fraction (5\/10)} of the transport stream , data stream  will occupy {fraction (3\/10)} of the transport stream and data stream  will occupy {fraction (2\/10)} of the transport stream . The length of the map table is p+p+p, which in this example is 10 frames long.","The map table is an array of numerals representing the number of the data stream - that is scheduled to provide a frame to the multiplexer module . Each array is a mapping of the data stream frames onto the transport stream . The map table [1,2,3,1,2,1,3,1,2,1] means that the first frame is scheduled to be sent from data stream , the second frame is scheduled to be sent from data stream , the third frame is scheduled to be sent from data stream , the fourth frame is scheduled to be sent from data stream , the fifth frame is scheduled to be sent from data stream , the sixth frame is scheduled to be sent from data stream , the seventh frame is scheduled to be sent from data stream , the eighth frame is scheduled to be sent from data stream , the ninth frame is scheduled to be sent from data stream , and the tenth frame is scheduled to be sent from data stream .","The mapping algorithm multiplexes multiple streams - of data frames onto one transport stream  so that the frames from each stream - are distributed uniformly. That is, the frames in each stream - are distributed uniformly across the transport stream . Thus, given a 3-data-stream situation with p=5, p=3, and p=2, then, in every ten transport frames, there are five frames in stream , three frames in stream , and two frames in stream , and the frames belonging to each stream - are distributed uniformly on the transport stream .","Although the multiplexer module  places data stream frames onto the transport stream  in a uniform fashion, there may be more than one way to fairly distribute multiple data streams - onto one transport stream . Thus, with p=5, p=3, and p=2, the first 10 frames sent on the transport stream  can be [1,2,3,1,2,1,3,1,2,1], or [1,3,2,1,2,1,3,1,2,1], or [2,1,3,1,2,1,3,1,2,1], or [2,3,1,1,2,1,3,1,2,1], or [3,1,2,1,2,1,3,1,2,1], or [3,2,1,1,2,1,3,1,2,1] where each numeral in an array represents the data stream number. The left number in the array represents the first frame sent. The mapping algorithm can advantagously be modified to produce any sequence satisfying the fair distribution requirement.","Once the mapping table is determined, the multiplexer module  uses the mapping table to schedule frames from the data streams - and continues to repeat the mapping table sequence as long as there are frames in a data stream - to be sent over the reverse link.","The mapping algorithm is a \u201cbucket\u201d approach to multiplexing data streams - onto a single stream. Each data stream - is represented by a \u201cbucket.\u201d When a bucket is filled, the represented data stream - can be scheduled to provide a frame.","The proportion values of the data streams - determine the depths of the data stream buckets. Each data steam bucket has a depth inversely proportional to its proportion value. Each bucket has a fill rate based on the bucket's proportion value. The fill rate is the rate at which the bucket is filled. The level within each bucket is incremented at its fill rate for every frame step. Only when a data stream bucket is full can a frame be scheduled to be taken from the data stream bucket by the multiplexer module .","In an exemplary embodiment of the invention, a mapping algorithm is as shown below in pseudo-code. In alternate embodiments of the invention, the initial values of the Ss and the Ds are changed to change the sequence of the data streams - in the mapping table.\n\n",{"@attributes":{"id":"p-0069","num":"0079"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"{","Let Dbe the D field of the element to be re-inserted."]},{"entry":[{},{},"Start with the i=2 element."]},{"entry":[{},{},"Block Traverse the list L:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"{","If there is no more list element (i\u2267 n):"]},{"entry":[{},{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Insert the removed element as the nth element;"]},{"entry":[{},"Terminate the list traversal;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"else"]},{"entry":[{},"("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"If D>  D:"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Change Dto D\u2212D;"]},{"entry":[{},"Move on to the next element (i=i+1);"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"else:"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Change Dto D\u2212D;"]},{"entry":[{},"Insert the removed element before the i-th"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"element;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"((The previous i-th element has become the"]},{"entry":[{},"new (i+1)th element.))"]},{"entry":[{},"Terminate the list traversal;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"Wait for the next transport frame slot;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0070","num":"0080"},"figref":["FIGS. 4-5","FIG. 4"]},"p, . . . , p, pare the relative proportions of data streams -, respectively . In one embodiment of the invention, Product is set to n* LeastCommonMultiple(p,p, . . . ,pn) . In an alternative embodiment, LeastCommonMultiple(p,p, . . . ,pn) is set to the product of p,p, . . . ,p.","q() is set to Product\/p, q() is set to Product\/p, . . . , and q(n) is set to Product\/p. A list L is created with n elements, where each element has two fields: S and D . Sdenotes the value of the S field of the i-th element in the list, and Ddenote the value of the D field of the i-th element in the list . The first element in the list is the head of the list .","Sis set to 1, Sis set to 2, . . . , and Sis set to n. The S field represents the stream number. Dis set to 1, Dis set to1, . . . , and Dis set to1. The D field represents the depth of a stream .","A frame is transmitted from the data stream identified by S. If D\u2267q(S) , then Dis set to D\u2212q(S)  and the algorithm waits for the next transport frame slot . If D<q(S) , then Dis set to q(S)\u2212D, then the head element is temporarily removed from the list and the remaining elements in the list are renumbered in ascending order as i=1, 2, . . . , respectively . That is, the previous i+1th element becomes the new ith element; for example, the previous 2element has become the new head element and the 3element has become the new second element.","Dis the D field of the removed element to be re-inserted . i is set to 2 . If there is no more list element (i\u2267n) , then the removed element is inserted as the nth element  and the algorithm waits for the next transport frame . If i is not \u2267n , then Dis compared to D. If D>Dthen Dis set to D\u2212Dand move on to the next element in the list, that is, i is incremented(i=i+1) . If Dis not >D, then Dis set to D\u2212D and the removed element is inserted before the i-th element . The algorithm waits for the next transport frame slot .","When it is time for the next transport frame slot, i.e., when the next transport frame condition is true , a frame is transmitted  from data stream Sto the transport stream .","Each list element represents a bucket for a data stream identified by the S field. The depth of the bucket is the \u201cq\u201d value of the data stream, which is inversely proportional to the data stream proportion value. All the buckets are incremented every transport frame slot. When a bucket is filled to the top, a frame in the corresponding data stream is scheduled to be sent, and the bucket restarts from empty. In the list L, the buckets are ordered according to the amounts left to fill them, in ascending order. The D field gives the difference between the amount left to fill for the current bucket and the amount left to fill for the preceding bucket. This is illustrated in  where there are four buckets for four data streams. Buckets S, S, and S are partially filled and bucket S is empty. As would be apparent to one of ordinary skill in the art, the mapping algorithm may advantageously be maintained in memory, software, hardware, or any combination thereof, in accordance with one embodiment.","A trace of the mapping algorithm given p=1, p=2, p=3, is shown below.\n\n",{"@attributes":{"id":"p-0079","num":"0093"},"figref":"FIG. 6","b":["1","1","60","2","1","62","3","1","64"]},"Since Sis 1, a frame from data stream  is transmitted.","D=1, which is less than q(S) since q()=18, therefore Dis changed to q(S)\u2212D=18\u22121=17. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=17 is greater than D=D=1, D is changed to D\u2212D=17\u22121=16 as shown in FIG. .","The flow of the algorithm then moves on to the next element in the list by incrementing i and going back up to the Traverse-the-list block. Now i=3, which equals n=3, therefore the removed element is inserted as the n=3 element as shown in FIG.  and the list traversal is terminated. The head element is -. The second element is -. The third element is -.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 2, a frame from data stream  is transmitted. Thus, the mapping table at this point is [1,2], which means that a frame from data stream  will be sent first and a frame from data stream  will be sent second.","Now D=1, which is less than q(S) since q()=9, therefore Dis changed to q(S)\u2212D=9\u22121=8. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=8 is not greater than D=D=16, Dis D\u2212D=16\u22128=8 as shown in FIG. . The head element is - again. The removed element is inserted before the i-th element as shown in FIG.  and the list traversal is terminated. The head element is now -. The second element is -. The third element is -.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 3, a frame from data stream  is transmitted. Thus, the mapping table at this point is [1,2,3], which stands for data stream , data stream  and data stream , and is the order with which frames from that data streams shall be sent.","Now D=8, which is greater than than q(S) since q()=6, therefore Dis changed to D\u2212q(S)=8\u22126=2  as shown in FIG. . The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 3, a frame from data stream  is transmitted. Thus, the mapping table at this point is [1,2,3,3].","Now D=2, which is less than q(S) since q()=6, therefore Dis changed to q(S)\u2212D=6\u22122=4. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=4 is not greater than D=D=8, Dis changed to D\u2212D=8\u22124=4  as shown in FIG. . The removed element  is inserted before the i-th element as shown in FIG.  and the list traversal is terminated.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 2, a frame from data stream  is transmitted. Thus, the mapping table at this point is [1,2,3,3,2].","Now D=4, which is less than q(S) since q()=9, therefore Dis changed to q(S)\u2212D=9\u22124=5. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=5 is greater than D=D=4, D is changed to D\u2212D=5\u22124=1 as shown in FIG. . The flow of the algorithm then moves on to the next element in the list by incrementing i and going back up to the Traverse-the-list block. Now i=3, which equals n=3, therefore the removed element is inserted as the n=3 element  as shown in FIG.  and the list traversal is terminated.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 3, a frame from data stream  is transmitted. Thus, the mapping table at this point is [1,2,3,3,2,3], which is the final mapping table because it is length p+p+p.","The mapping table is used to schedule frames from the data streams. If the mapping algorithm is continuously run, then it will continually produce the sequence [1,2,3,3,2,3]. To show that this is true, the trace of the algorithm is shown for two more frames, in which case a list pattern is shown to repeat itself.","Now D=4, which is less than q(S) since q()=6, therefore Dis changed to q(S)\u2212D=6\u22124=2. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=2 is greater than D=D=1, D is changed to D\u2212D=2\u22121=1 as shown in FIG. . The flow of the algorithm then moves on to the next element in the list by incrementing i and going back up to the Traverse-the-list block. Now i=3, which equals n=3, therefore the removed element is inserted as the n=3 element  as shown in FIG.  and the list traversal is terminated.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 1, a frame from data stream  is transmitted.","Now D=1, which is less than q(S) since q()=18, therefore Dis changed to q(S)\u2212D=18\u22121=17. The head element  is removed from the list as shown in FIG.  and the Dfield is the D field of the removed head element. Now i=1 refers to the new head element - and i=2 refers to the new second element -.","Now i=2 and the list will be traversed. Since i=2 is not greater than or equal to n=3, Dis compared to D. Since D=17 is greater than D=D=1, D is changed to D\u2212D=17\u22121=16 as shown in FIG. . The flow of the algorithm then moves on to the next element in the list by incrementing i and going back up to the Traverse-the-list block. Now i=3, which equals n=3, therefore the removed element is inserted as the n=3  element as shown in FIG.  and the list traversal is terminated.","The algorithm then waits for the next transport frame slot. Then during the transport frame slot, the frame from the data stream identified by Sis transmitted. Since Sis 2, a frame from data stream  is transmitted.","After the sequence [1,2,3,3,2,3] was transmitted, frames from data stream  and data stream  were transmitted.  is the same as , which shows that the algorithm will continue to repeat the sequence.","In other embodiments of the invention, the algorithm may be started with different initial values for the Ss and the other five sequences given for the p=5, p=3, p=2 example are generated. For example, for S=2, S=3, S=1, the sequence [2,1,3,1,2,1,3,1,2,1] is generated. In still other embodiments of the invention, the initial values of Ds may be modified to generate different sequences.","In one embodiment of the invention, packets instead of frames advantageously are multiplexed from multiple data streams into one data stream.","In yet another embodiment of the invention, the algorithm is optimized to let multiple data streams with the same proportion value share one list element so that there are a number m of unique proportion values even though there may be more than m data streams (i.e., m<n). Then, the \u201cn\u201d in the algorithm should be replaced by \u201cm\u201d so that all the ps are unique and the S field of the algorithm represents a set of data streams sharing the same proportion value. In addition, the pseudo-code \u201cTransmit a frame from the data stream identified by S\u201d of the algorithm on p. 14 is replaced by \u201cTransmit a frame from each of the data streams contained in the set S. \u201d The q(S) value represents Product\/px, where px is the proportion value shared by the data streams in the set S. This optimization improves algorithm efficiency.","In an alternative embodiment of the invention, a mapping algorithm employing same size buckets, but different fill rates are used. As would be apparent to one of ordinary skill in the art, the disclosed mapping algorithm can be rewritten such that the buckets have the same size, but the fill rates are inversely related to the bucket sizes and are based on the proportion values of the respective data streams.","In an alternative embodiment of the invention, when there are only two data streams, the above algorithm is advantageously replaced by the following simpler one. If pis a multiple of p2, a mapping algorithm in accordance with this embodiment is shown in pseudo-code as follows:","Initialize the following variables:\n\n",{"@attributes":{"id":"p-0109","num":"0127"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"if (SkipCount == 0)"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"Transmit a frame from data stream #2;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(a)","FractionCount = FractionCount + InitialFraction;"]},{"entry":[{},{},"if (FractionCount >= p)"]},{"entry":[{},{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"SkipCount = SkipBase + 1;"]},{"entry":[{},"FractionCount = FractionCount \u2212 p;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(b)","else"]},{"entry":[{},{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"SkipCount = SkipBase;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"}"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},"else"]},{"entry":[{},"{"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Transmit a frame from data stream #1;"]},{"entry":[{},"SkipCount = SkipCount \u2212 1;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"As would be apparent to one of ordinary skill in the art, the mapping algorithm can be applied to other interconnections between network modules. It can be applied to any situation where a module has a plurality of inputs and produces a multiplexed ouput from the plurality of inputs. For example, a multiplexer module can be located within a BTS wherein the BTS multiplexes data streams from a plurality of mobile stations and produces a multiplexed data stream to be sent to the BSC.","Thus, a novel and improved method and apparatus for multiplexing multiple data streams onto one data stream have been described. Those of skill in the art would understand that the various illustrative logical blocks, modules, and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware, computer software, or combinations of both. The various illustrative components, blocks, modules, circuits, and steps have been described generally in terms of their functionality. Whether the functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans recognize the interchangeability of hardware and software under these circumstances, and how best to implement the described functionality for each particular application. As examples, the various illustrative logical blocks, modules, and algorithm steps described in connection with the embodiments disclosed herein may be implemented or performed with a processor executing a set of firmware instructions, an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic device, discrete gate or transistor logic, discrete hardware components such as, e.g., registers, any conventional programmable software module and a processor, or any combination thereof designed to perform the functions described herein. The multiplexer may advantageously be a microprocessor, but in the alternative, the multiplexer may be any conventional processor, controller, microcontroller, or state machine. The applications could reside in RAM memory, flash memory, ROM memory, EPROM memory, EEPROM memory, registers, hard disk, a removable disk, a CD-ROM, or any other form of storage medium known in the art. As illustrated in , a base station  is advantageously coupled to a mobile station  so as to read information from the base station . The memory  may be integral to the multiplexer . The multiplexer  and memory  may reside in an ASIC (not shown). The ASIC may reside in a telephone .","The previous description of the embodiments of the invention is provided to enable any person skilled in the art to make or use the present invention. The various modifications to these embodiments will be readily apparent to those skilled in the art, and the generic principles defined herein may be applied to other embodiments without the use of the inventive faculty. Thus, the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The features, objects, and advantages of the present invention will become more apparent from the detailed description set forth below when taken in conjunction with the drawings in which like reference characters identify correspondingly throughout and wherein:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8","sub":"x "},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 11","sub":"i "},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 13","sub":"2 "},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 15","sub":"i "},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 18","sub":"x "},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 21","sub":"x "},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 24","sub":"x "},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 25"}]},"DETDESC":[{},{}]}
