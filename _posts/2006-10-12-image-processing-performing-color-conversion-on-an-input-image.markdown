---
title: Image processing performing color conversion on an input image
abstract: An image processing apparatus performs color conversion processing on an input image. The image processing apparatus includes a block pallet conversion unit, a first color converting unit and a restoration unit. The block pallet conversion unit converts the input image in units of blocks into (i) pallet color information including pallet colors number of which is less than pixels included in one of the blocks and (ii) selection information used to select one of the pallet colors for each pixel. The first color converting unit performs color conversion on the pallet color information obtained by the block pallet conversion unit. The restoration unit selects for each pixel, based on the selection information, one of the pallet colors of the pallet color information, which is color-converted by the first color converting unit, to restores an image.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07881526&OS=07881526&RS=07881526
owner: Fuji Xerox Co., Ltd.
number: 07881526
owner_city: Tokyo
owner_country: JP
publication_date: 20061012
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["1. Technical Field","The invention relates to an image processing technique of performing color conversion processing on an input image.","2. Related Art","Color conversion processing is performed on an image in various situations such as a situation that image processing is performed on a scanned-in image and a resulting processed image is output to a print engine in a copier. Among conventional color conversion methods in copiers, a method, which uses a multi-dimensional look-up table with interpolation, is called \u201cDLUT\u201d (direct look-up table).",{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 9"},"For interpolation operation, each divisional cube or rectangular parallelepiped is further divided into six tetrahedrons as shown in . To which tetrahedron input values (L*, a*, b*) belong are judged on the basis of the input values (L*, a*, b*) themselves, and an interpolation operation is performed by using CMYK values corresponding to the four vertexes (lattice points) of the tetrahedron thus found. In this manner, arbitrary input values (L*, a*, b*) can be converted into CMYK values.","According to an aspect of the invention, an image processing apparatus performs color conversion processing on an input image. The image processing apparatus includes a block pallet conversion unit, a first color converting unit and a restoration unit. The block pallet conversion unit converts the input image in units of blocks into (i) pallet color information including pallet colors number of which is less than pixels included in one of the blocks and (ii) selection information used to select one of the pallet colors for each pixel. The first color converting unit performs color conversion on the pallet color information obtained by the block pallet conversion unit. The restoration unit selects for each pixel, based on the selection information, one of the pallet colors of the pallet color information, which is color-converted by the first color converting unit, to restores an image.",{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 1","FIG. 1"],"b":["1","2","3","4","5","6","7","8","9","1"]},"The block pallet conversion section  converts an image input through the input processing section  in units of blocks into pallet color information, which includes number of colors less than number of pixels of a block, and selection information used to a pallet color for each pixel in the block.","The first color conversion section  performs a color conversion on respective pallet colors of the pallet color information obtained by the block pallet conversion section . If the input image color space and the output image color space are different from each other, the first color conversion section  also performs a color space conversion. In this exemplary embodiment, the first color conversion section  performs a color conversion on images for which importance is attached to the gradation performance rather than the resolution, such as pictorial images (e.g., photographs). The first color conversion section  can perform a highly accurate color conversion using a DLUT, for example. Since the image has been converted into the pallet color information, which includes the number of colors less than the number of pixels in the block, the number of colors of the processing subject is much smaller than that of the original image and hence the amount of processing can be made much smaller than in the case where a color conversion is performed without the pallet conversion.","The restoration section  selects the pallet color information on which the color conversion is performed by the first color conversion section , in accordance with the selection information obtained by the block pallet conversion section  to restore the image in units of the block.","The attribute judgment section  judges attributes of respective regions of the input image and passes judgment results to the output image generation section  and the output processing section . The attribute judging method is arbitrary and may be a known method. The attribute judgment section  distinguishes between text\/line-drawing portions and other portions.","The filtering section  extracts edges from the input image and performs adaptive filtering on the input image. This is edge emphasis processing for increasing the image quality of the text\/line-drawing portions. Also, the filtering section  may be omitted.","The second color conversion section  performs a color conversion on a filtered image received from the filtering section . If the input image color space and the output image color space are different from each other, the second color conversion section  also performs a color space conversion. In this exemplary embodiment, the second color conversion section  performs a color conversion on images for which importance is attached to the resolution, such as text images and line-drawing images. Although the second color conversion section  may also be configured to use a DLUT or the like, the second color conversion section  is not required to perform a highly accurate color conversion because the gradation performance is not very important. Therefore, the second color conversion section  can employ a color conversion method that is smaller in the amount of calculation than a color conversion method, which is employed by the first color conversion section . The processing speed can be increased by simplifying the processing, for example, decreasing the number of reference data to simplify an interpolation method. Naturally, color conversion methods other than the method using a DLUT, such as a matrix conversion, may be used.","The output image generation section  generates an output image from the image restored by the restoration section  in units of the block and\/or a color-converted image received from the second color conversion section . Which of the image restored by the restoration section  and the color-converted image received form the second color conversion section  should be selected can be determined on the basis of, for example, judgment results of the attribute judgment section , preset processing modes, and\/or system resources situations. For example, an output image may be generated in the following manner. The color-converted image received form the second color conversion section  is selected for regions that have been judged to be text\/line-drawing regions by the attribute judgment section  and the image restored by the restoration section  is selected for other regions, and an output image is formed by synthesizing the thus-selected portions.","For example, the processing modes may include a document mode and a color mode. An output image may be generated by selecting the color-converted image received form the second color conversion section  if the document mode is a text mode and selecting the image restored by the restoration section  if the document mode is a photograph mode. An output image may be generated by selecting the image restored by the restoration section  if the color mode is color and selecting a black-and-white-gradation-converted image received from the second color conversion section  or a filtered image produced by the filtering section  (no color conversion is performed by the second color conversion section ) if the color mode is black and white. Furthermore, image switching may be made in accordance with a processing speed mode indicating whether importance is attached to the processing speed or the image quality. The image restored by the restoration section  may be selected in a speed priority mode in which importance is attached to the processing speed, and the color-converted image received form the second color conversion section  may be selected in an image quality priority mode in which importance is attached to the image quality. Naturally, where another processing mode exists, image switching may be made in a similar manner, that is, either image may be selected depending on whether importance is attached to the gradation performance or the resolution.","Still further, the above processing modes and judgment results of the attribute judgment section  may be used in combination. One example is such that the image restored by the restoration section  is selected throughout the image in the speed priority mode and either image is selected on a region-by-region basis in accordance with the judgment results of the attribute judgment section  in the image quality priority mode. Another example is such that either image is selected on a region-by-region basis in accordance with the judgment results of the attribute judgment section  if the document mode is a text\/photograph mixture mode and either image is selected throughout the image if the document mode is the text mode or the photograph mode. The judgment results of the attribute judgment section  may be combined with other processing modes in similar manners. Conversely, where image switching is performed in accordance with only the processing modes, the attribute judgment section  may be omitted.","The output processing section  performs various kinds of image processing on an image produced by the color conversion processing. This processing may be performed in accordance with the judgment results of the attribute judgment section .",{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 2","FIG. 2(A)"],"b":["2","3","4","6","7"]},"The image of  is processed by the input processing section  and then input to the block pallet conversion section  and the attribute judgment section . The block pallet conversion section  converts the image shown in  into the pallet color information and the selection information in units of the block.  shows one of blocks included in the image shown in . In , the one of the blocks shown in  is converted into the pallet color information and the selection information as shown in . In this example, one block consists of 4\u00d74 pixels. Colors of the pixels included in this block are approximated to some of pallet colors of the pallet color information shown in . The number of the pallet colors is less than the number of pixels included in the block. In this example, colors of 16 pixels included in one block are condensed into four pallet colors at maximum. Then, each pixel is converted into the selection information used top select any of the pallet colors. At this time, if a color of a pixel is different from any of the pallet colors, a pallet color similar to the color of the pixel is selected. By this processing, a color of each pixel is approximated to any of the pallet colors.","The first color conversion section  performs a highly accurate color conversion process for pictorial images on each pallet color of the thus-obtained pallet color information. The first color conversion section  performs this color conversion process the number of times, which is equal to the number of the pallet colors less than the number of pixels included in the block.","Thereafter, the restoration section  selects a pallet color from the pallet color information, which has been subjected to the color conversion process, in accordance with the selection information shown in  to obtain a color-converted block shown in . Although a single block is shown in  as an image stored by the restoration section , the above described series of processings are performed on each of blocks included in the input image.","On the other hand, the attribute judgment section  judges, for each pixel or each set of plural pixels, an attribute of the image processed by the input processing section . Assume here that as shown in  the attribute judgment section  has judged that the upper photograph portion has a picture attribute and the lower text portion has a text\/line-drawing attribute.","The filtering section  performs the filtering on the image processed by the input processing section  to emphasize the edges of the image and then, the second color conversion section  performs the color conversion processing for a text\/line drawing, on the filtered image. The color conversion processing for a text\/line drawing is not required to be highly accurate and hence may be of a type that the amount of processing is small and enables high-speed processing.  shows a color-converted image generated by the second color conversion section .","The output image generation section  generates an output image in accordance with the judgment results of the attribute judgment section . Based on the judgment results shown in , the output image generation section  selects the restored image of  for the upper portion of the image and selects the color-converted image of  generated by the second color conversion section  for the lower portion of the image. As a result, the output image generation section  generates an output image of . The output image is processed by the output processing section  and then output.","As described above, whereas the photograph portion of the output image is lowered in substantial resolution because it has been subjected to the pallet conversion process and the color conversion process, it is color-converted with high accuracy. The text portion is color-converted while the resolution is maintained.","In the configuration of , further increase in processing speed is possible in the attribute judgment section  and the filtering section .  is a block diagram showing an example of the attribute judgment section . In , reference numeral  denotes a first edge detection section and reference numeral  denotes a second edge detection section. Whereas various attribute judging methods are available, this example employs a simple attribute judging method that uses the edge amount.","The first edge detection section  detects an edge amount by means of a simple edge detection filter, for example. The first edge detection section  produces a judgment result \u201ctext attribute\u201d if the edge amount is larger than a first threshold value, produces a judgment result \u201cpicture attribute\u201d if the edge amount is smaller than a second threshold value, which is smaller than the first threshold value, and produces a judgment result \u201cattribute unknown\u201d in the other case. The first and second threshold values may be varied in accordance with the attribute judgment result of the preceding pixel. For example, only the first threshold value or both of the first and second threshold values are decreased if a judgment result \u201ctext attribute\u201d is produced for the preceding pixel. This increases the probability that a judgment result \u201ctext attribute\u201d is also produced for the subject pixel. For example, only the second threshold value or both of the first and second threshold values are increased if a judgment result \u201cpicture attribute\u201d is produced for the preceding pixel. This increases the probability that a judgment result \u201cpicture attribute\u201d is also produced for the subject pixel. Varying the threshold values in the above manner can increase the number of pixels whose attributes are determined by the first edge detection section , which requires a small amount of processing.","The second edge detection section  judges attributes by more detailed processing than the first edge detection section , and can judge attributes by one or a combination of various methods. For example, even where the second edge detection section  uses an edge detection filter, it may employ a filter having a lager size than the first edge detection section . An attribute judgment, which uses an edge amount obtained in this case, may be made by comparing the edge amount with another prescribed threshold value. This threshold value may be weighted by using the edge amount obtained in the first edge detection section , more specifically, by the difference between the edge amount and the intermediate value of the first and second threshold values of the first edge detection section .","A pixel (or a region consisting of plural pixels) that has been judged to be a text attribute pixel by the first edge detection section  or the second edge detection section  is subjected to filtering in the filtering section . Edge amounts obtained in the first edge detection section  of the attribute judgment section  may be used in the filtering. For example, a result of a sum-of-products operation on the edge amounts and edge intensities obtained by an edge emphasis filter may be employed as a filtering result.","Also in the filtering section , the filtering may be switched in accordance with the judgment results of the attribute judgment section , in particular, whether a text attribute has been detected in the first edge detection section  or the second edge detection section . For example, filtering may be performed by a small-size emphasis filter if a text attribute has been detected in the first edge detection section , and by a large-size emphasis filter if a text attribute has been detected in the second edge detection section . Naturally, the filtering method may be changed.","The configuration of the attribute judgment section  shown in , the modification to the processing of the filtering section , and other features can also be applied to the following exemplary embodiments in similar manners.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":["FIG. 4","FIG. 4","FIG. 1"],"b":["5","2","6","5","2","2"]},"In the exemplary embodiment of , color conversion processing is performed by the first color conversion section  and the second color conversion section  for regions that will not be selected by the output image generation section . In contrast, in the second exemplary embodiment, color conversion processing is performed by only one of the first color conversion section  and the second color conversion section . Therefore, the total processing time can be shortened and the total processing speed can be increased even in the case where, for example, the second color conversion section  performs color conversion processing that is relatively high in accuracy.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":["FIG. 5","FIG. 5","FIG. 4"],"b":["3","7","2"]},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 6"},"The input processing section  interprets input image data that are written in PDL and judges attributes of respective drawing objects. Therefore, in this modification, the input processing section  also performs the function of the attribute judgment section . For example, if a PDL-judged attribute is a text attribute, data in that region are input to the filtering section  and then subjected to the color conversion processing of the second color conversion section . If a PDL-judged attribute is a picture attribute, data in that region are input to the block pallet conversion section  and then subjected to the color conversion processing of the first color conversion section . If PDL data include a raster image, the raster image may be subjected to area separation processing and then subjected to color conversion processing for a text or a picture.","This configuration is effective in applying the invention to a printer or an apparatus having a printer function.",{"@attributes":{"id":"p-0050","num":"0049"},"figref":["FIG. 7","FIG. 7","FIG. 1"],"b":["2","2","3"]},"The attribute judgment section  produces control information on the basis of attribute judgment results, a given processing mode, etc. and supplies it to the block pallet conversion section  and the restoration section . In this exemplary embodiment, the processing of the filtering section  is performed for regions that have been judged to be text\/line-drawing regions.","The block pallet conversion section  sets the maximum number of pallet colors of the pallet color information based on control information received from the attribute judgment section . Then, the block pallet conversion section  converts the image received through the attribute judgment section  into the pallet color information and the selection information in units of the blocks. The first color conversion section  performs the color conversion process on the respective pallet colors included in the pallet color information. The restoration section  selects any of the pallet colors of the pallet color information, which has been subjected to the color conversion process, in accordance with the selection information. Then, the restoration section  outputs the selected pallet color.","With the above configuration, in a high-speed processing mode or for pictorial regions such as photograph regions, the amount of processing of the first color conversion section  can be reduced by decreasing the maximum number of the pallet colors of the pallet color information to be less than the number of pixels of a single block. Hence, the total processing speed can be increased. In an image quality priority mode or for text\/line-drawing regions, the color conversion processing of the first color conversion section  may be performed by increasing the maximum number of the pallet colors of the pallet color information, for example, to be equal to the number of pixels in a single block. In this case, an image that is high in both resolution and gradation performance can be obtained.","As described above, by controlling the number of the pallet colors of the pallet color information generated by the block pallet conversion section , the third exemplary embodiment can increase the processing speed and suppress reduction in resolution to an extent desired.","Even if the number of the pallet colors of the pallet color information is increased in text\/line-drawing regions, the number of colors is small number inmost cases. Therefore, number of pallet colors actually used is small number.","Furthermore, if number of colors in text\/line drawings is limited, a color of each pixel may be approximated using pallet colors number of which is similar to number of pallet colors for the pictorial regions. In this case, the pallet conversion process, the color conversion process and the restoration process may be performed on the entire image region.",{"@attributes":{"id":"p-0057","num":"0056"},"figref":["FIG. 8","FIG. 8"],"b":["21","22","31","32","33","34","41","42","43"]},"All or part of the configuration of each of the above-described embodiments and modifications can be realized by the program  which can be run by a computer. Where it is realized by the program , the program , data used by the program , and other information can be stored in a computer-readable storage medium. The term \u201cstorage medium\u201d means a medium which makes it possible to transmit the description contents of a program to a reading device as a hardware resource of a computer in the form of a signal corresponding to variation states of magnetic, optical, electrical, or like energy that are caused according to the description contents of the program. Examples of the storage medium are the magneto-optical disc , the optical disc  (including a CD and a DVD), the magnetic disk , and the memory  (including an IC card and a memory card). Naturally, the storage medium is not limited to portable ones.","The functions of image processing apparatus according to the invention can be performed or processing can be performed according to the image processing method according to the invention by storing the program  in one of those storage media in advance, mounting the storage medium in the magneto-optical disc drive , the optical disc drive , the magnetic disk drive , a memory slot (not shown), or an interface (not shown) of the computer , for example, and causing the computer  to readout the program . The functions of image processing apparatus can be performed or processing can be performed according to the image processing method by mounting or incorporating a storage medium in the computer  in advance, transferring the program  to the computer  over a network, for example, and storing the program  in the storage medium, and causing the computer  to run the program . Naturally, all or part of the functions may be implemented by hardware.","[]",{"@attributes":{"id":"p-0060","num":"0000"},"ul":{"@attributes":{"id":"ul0001","list-style":"none"},"li":[{"@attributes":{"id":"ul0001-0001","num":"0059"},"b":"1"},{"@attributes":{"id":"ul0001-0002","num":"0060"},"b":"2"},{"@attributes":{"id":"ul0001-0003","num":"0061"},"b":"3"},{"@attributes":{"id":"ul0001-0004","num":"0062"},"b":"4"},{"@attributes":{"id":"ul0001-0005","num":"0063"},"b":"5"},{"@attributes":{"id":"ul0001-0006","num":"0064"},"b":"6"},{"@attributes":{"id":"ul0001-0007","num":"0065"},"b":"7"},{"@attributes":{"id":"ul0001-0008","num":"0066"},"b":"8"},{"@attributes":{"id":"ul0001-0009","num":"0067"},"b":"9"},"A: INPUT IMAGE","B: JUDGMENT RESULTS","C: PROCESSING MODE","D: OUTPUT IMAGE\n\n[]\n","A: Character Character . . .","B: PALLET COLOR INFORMATION","C: PALLET COLOR","D: SELECTION INFORMATION","E: COLOR CONVERSION FOR PICTURE","F: RESTORE","G: FILTERING","H: COLOR CONVERSION FOR TEXT\/LINE DRAWING","I: PICTORIAL PORTION","J: TEXT\/LINE-DRAWING PORTION","K: JUDGMENT RESULTS\n\n[]\n",{"@attributes":{"id":"ul0001-0025","num":"0083"},"b":"6"},{"@attributes":{"id":"ul0001-0026","num":"0084"},"b":"11"},{"@attributes":{"id":"ul0001-0027","num":"0085"},"b":"12"},"A: PICTURE","B: TEXT","C: UNKNOWN","D: EDGE AMOUNT","E: PICTURE ATTRIBUTE","F: TEXT ATTRIBUTE\n\n[]\n",{"@attributes":{"id":"ul0001-0034","num":"0092"},"b":"1"},{"@attributes":{"id":"ul0001-0035","num":"0093"},"b":"2"},{"@attributes":{"id":"ul0001-0036","num":"0094"},"b":"3"},{"@attributes":{"id":"ul0001-0037","num":"0095"},"b":"4"},{"@attributes":{"id":"ul0001-0038","num":"0096"},"b":"5"},{"@attributes":{"id":"ul0001-0039","num":"0097"},"b":"6"},{"@attributes":{"id":"ul0001-0040","num":"0098"},"b":"7"},{"@attributes":{"id":"ul0001-0041","num":"0099"},"b":"8"},{"@attributes":{"id":"ul0001-0042","num":"0100"},"b":"9"},"A: INPUT IMAGE","B: JUDGMENT RESULTS","C: PROCESSING MODE","D: OUTPUT IMAGE\n\n[]\n",{"@attributes":{"id":"ul0001-0047","num":"0105"},"b":"1"},{"@attributes":{"id":"ul0001-0048","num":"0106"},"b":"2"},{"@attributes":{"id":"ul0001-0049","num":"0107"},"b":"3"},{"@attributes":{"id":"ul0001-0050","num":"0108"},"b":"4"},{"@attributes":{"id":"ul0001-0051","num":"0109"},"b":"5"},{"@attributes":{"id":"ul0001-0052","num":"0110"},"b":"6"},{"@attributes":{"id":"ul0001-0053","num":"0111"},"b":"8"},{"@attributes":{"id":"ul0001-0054","num":"0112"},"b":"9"},"A: INPUT IMAGE","B: JUDGMENT RESULTS","C: PROCESSING MODE","D: OUTPUT IMAGE\n\n[]\n",{"@attributes":{"id":"ul0001-0059","num":"0117"},"b":"1"},{"@attributes":{"id":"ul0001-0060","num":"0118"},"b":"2"},{"@attributes":{"id":"ul0001-0061","num":"0119"},"b":"3"},{"@attributes":{"id":"ul0001-0062","num":"0120"},"b":"4"},{"@attributes":{"id":"ul0001-0063","num":"0121"},"b":"6"},{"@attributes":{"id":"ul0001-0064","num":"0122"},"b":"7"},{"@attributes":{"id":"ul0001-0065","num":"0123"},"b":"8"},{"@attributes":{"id":"ul0001-0066","num":"0124"},"b":"9"},"A: INPUT IMAGE (PDL DATA)","B: JUDGMENT RESULTS","C: OUTPUT IMAGE"]}},"[]\n\n"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Exemplary embodiments of the invention will be described in detail based on the following figures, wherein:",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 9"}]},"DETDESC":[{},{}]}
