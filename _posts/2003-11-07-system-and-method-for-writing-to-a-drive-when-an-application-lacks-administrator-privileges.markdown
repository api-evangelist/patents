---
title: System and method for writing to a drive when an application lacks administrator privileges
abstract: A system and method are provided which enable a user of a computer application without administrator privileges to write to a drive without using a third party driver and without using a customized driver acting in conjunction with an IDE bus. The system includes a driver programming interface in communication with the application, a service proxy in communication with the driver interface, a service with administrator privileges in communication with the service proxy, a driver in communication with the service with administrator privileges, and a drive in communication with the driver.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07434232&OS=07434232&RS=07434232
owner: Hewlett-Packard Development Company, L.P.
number: 07434232
owner_city: Houston
owner_country: US
publication_date: 20031107
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["To write (also referred as \u201cprint\u201d) to a disc in a CD drive, an interface is needed to allow an imaging application to send data to the drive. In a personal computer (\u201cPC\u201d) with a Windows operating system (\u201cOS\u201d), access to the CD drive is usually done through the cdrom.sys class driver. Interfacing with the class driver requires very low level programming and is not an easy way for an imaging application to send to send print data.","As shown in , a standard computer system  includes a CD-ROM drive  which is modified to support printing and is programmed to recognize specific small computer system interface\/attachment packet interface (\u201cSCSI\/ATAPI\u201d) commands that are only used for printing. In this system , a Windows application  (shown as \u201cA\u201d and \u201cB\u201d) interfaces with an OS class driver  using input\/output control (\u201cIOCTL\u201d) language. However, because these commands are non-standard, it is necessary to bypass error checking protocols. Accordingly, the traditional approach is to use an SCSI-pass-through-interface (\u201cSPTI\u201d)  interfaced with the OS driver .","As shown in , if the Windows application  is an application with administrator privileges A (i.e., the user has administrator privileges and this status is recognized by the system ), when using an SPTI , the class driver  passes the raw print command data to the CD drive  via a port driver , an intelligent drive electronics (also known as \u201cintegrated drive electronics\u201d or \u201cIDE\u201d) bus driver , and an IDE bus ; the SPTI does not interfere with or check the data. The driver  confirms the administrator privileges status before sending signals to the SPTI. For those applications with administrator privileges A, the SPTI will send SCSI\/ATAPI print commands to the CD drive . By way of contrast, as shown in , if the application does not have administrator privileges B (i.e., the user does not have administrator privileges and this status is recognized by the system ), this status information is also passed to the driver ; as a result, the driver  will not send print signals to the SPTI which, in turn, prevents the signals from reaching the CD drive .","As a result, to use an SPTI, an application must have administrator privileges (i.e., the user must have administrator privileges). However, as most PC users, particularly those on a network, do not have administrator privileges, the SPTI is usually unavailable, thereby preventing print commands from reaching the CD drive .","There are two predominant prior solutions to this administrator access problem. First, as shown in , another system  has been developed using an IDE bus  but not using standard SCSI commands or drivers. This system  uses a second, customized driver  to control the data and control lines of the IDE bus  to send print data to the CD drive .","Unfortunately, as a result of using specialized commands to overcome the print access problem associated with no administrator privileges, this system  does not support standard drivers such as the class driver  that is already a part of the OS. As a result, the second driver  is necessary to act as an interface between the application without administrator privileges B and the IDE bus  via the port driver  and IDE bus driver . The second driver  may receive the same print commands as the OS driver  or may receive specialized print commands as a result of being interfaced with the custom driver. However, the second driver  is customized to convert the driver commands of the application B into non-SCSI commands which are sent through the bus  to the CD drive .","The second solution, shown in , involves a system  which, like the standard OS shown in , uses SCSI commands to control the CD drive . However, in this system , the SCSI commands reach the CD drive  via a third party CD driver  that is not part of the OS. An example of such a driver is the Advanced SCSI Programming Interface (\u201cASPI\u201d). Unfortunately, third party drivers require license fees and have limited technical support in current operating systems. It should be recognized that in this system, the application without administrator privileges B interfaces with the system driver , the SPTI , and the third party driver . The OS driver  and the third party driver  receive the same print commands and unlike the previously described systems (in which administrator status signals were communicated to the system driver ), in this system , the status signals are communicated to the SPTI . However, like the previously described system , the SPTI  is bypassed; in this system , the bypass is via the third party driver .","One embodiment of the invention is a system and method which enable a user of a computer application without administrator privileges to write to a drive without using a third party driver and without using a customized driver acting in conjunction with an IDE bus. The system includes a driver programming interface in communication with the application, a service proxy in communication with the driver interface, a service with administrator privileges in communication with the service proxy, a driver in communication with the service with administrator privileges, and a drive in communication with the driver.","These and other features, aspects, and advantages of the present invention will become more apparent from the following description, appended claims, and accompanying exemplary embodiments shown in the drawings.","One embodiment of the invention comprises a system for sending write commands to a drive from a computer application lacking administrator privileges. This system includes: (a) a computer application lacking administrator privileges; (b) a driver programming interface in communication with the computer application; (c) a service proxy in communication with the driver programming interface; (d) a service with administrator privileges in communication with the service proxy; (e) a driver in communication with the service with administrator privileges, wherein the driver is either in communication with an SPTI or is configured in SPTI mode; and (f) a drive in communication with the SPTI or with the SPTI configured driver.","Another embodiment of the invention comprises a method of sending write commands to a drive from a computer application which does not have administrator privileges. This method includes: (a) transmitting write commands between a computer application which does not have administrator privileges and a driver programming interface; (b) transmitting second commands based at least in part on the write commands between the driver programming interface and a service proxy; (c) transmitting third commands based at least in part on the second commands between the service proxy and a service with administrator privileges; (d) transmitting fourth commands based at least in part on the third commands between the service with administrator privileges and a driver; (e) transmitting fifth commands based at least in part on the fourth commands between the driver and an SPTI; and (e) transmitting sixth commands based at least in part on the fifth commands between the SPTI and a drive.","Another embodiment of the invention comprises a method of sending write commands to a drive from a computer application which does not have administrator privileges, the method comprising the steps of: (a) transmitting write commands between a computer application which does not have administrator privileges and a driver programming interface; (b) transmitting second commands based at least in part on the write commands between the driver programming interface and a service proxy; (c) transmitting third commands based at least in part on the second commands between the service proxy and a service with administrator privileges; (d) transmitting fourth commands based at least in part on the third commands between the service with administrator privileges and a driver configured in SPTI mode; and (e) transmitting fifth commands based at least in part on the fourth commands between the driver and a drive.","Another embodiment of the invention comprises a program product for sending write commands to a drive from a computer application which does not have administrator privileges. The program product includes machine-readable program code stored on a computer-readable medium for causing, when executed, a machine to perform the following method: (a) transmitting write commands between a computer application which does not have administrator privileges and a driver programming interface; (b) transmitting second commands based at least in part on the write commands between the driver programming interface and a service proxy; (c) transmitting third commands based at least in part on the second commands between the service proxy and a service with administrator privileges; (d) transmitting fourth commands based at least in part on the third commands between the service with administrator privileges and a driver; (e) transmitting fifth commands based at least in part on the fourth commands between the driver and an SPTI; and (f) transmitting sixth commands based at least in part on the fifth commands between the SPTI and a drive.","Reference will now be made in detail to various embodiments of the invention, which are illustrated in the drawings. An effort has been made to use the same reference numbers throughout the drawings to refer to the same or like parts.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 4","b":["200","102","112","110","114","102","116","118","120","104","106","108"]},"The computer application without administrator privileges B may be, for example, a Windows application. This application B transmits commands (e.g., write commands) to the driver programming interface  by means of a high level language.","The driver programming interface  is the top level interface which uses the service proxy  to communicate with the CD drive . The driver interface  provides write\/print specific commands that allow the imaging components to read information about the drive  and media, and to send settings, as well as actual image data to be printed, to the drive . The driver programming interface  interprets the high level language commands from the application B and communicates with the service proxy  by means of high level language (\u201cHLL\u201d) and\/or application programming interface (\u201cAPI\u201d) language.","The service proxy  abstracts the need to use inter-process communication (\u201cIPC\u201d) mechanisms for an application without administrator privileges B to communicate with the service with administrator privileges . Upon recognizing the lack of administrator privileges, the proxy  provides generic commands to the service with administrator privileges .","The commands transmitted by the service proxy  direct the service with administrator privileges  to send an input, output, or status (e.g., is the drive running) commands to the drive . An input command is a command where the driver  wants to read some information from the drive  such as the media parameters. An output command is a command such as sending a track of pixel data to the drive . The service proxy  may also provide standard mechanisms to find all print capable drives on the local system, get a description and drive letter for the drives, send commands to open and close a particular drive for printing, send commands giving the driver  an exclusive lock on the drive , etc.","To send these commands, the service proxy  interfaces with the service with administrator privileges . The service with administrator privileges  provides administrator access to the driver  and is programmed to use the SPTI mode of the class driver . Accordingly, in communicating with the driver , the service with administrator privileges  uses SCSI-pass-through (\u201cSPT\u201d) direct and\/or IOCTL commands, i.e., the service with administrator privileges  is programmed to send corresponding low-level commands to the drive  via the SPTI .","As shown, the driver  and the SPTI  may be separate. In this case, the driver  communicates with the SPTI and the SPTI communicates with the drive  by means of SCSI commands. By way of contrast, the drive  could be combined in a driver  configured in SPTI mode in which case the driver  could communicate directly with the drive  by means of SCSI commands.","Similarly, as shown the service proxy  and the service with administrator privileges  may be separate. However, it should be recognized that the service proxy  and the service with administrator privileges  may be combined into one integrated device .","It also should be recognized that if the computer application is an application with administrator privileges A, the system  will work much like the system  shown in . In addition, implicit in this system  is an assumption that the firmware for the drive  is programmed to recognize the SCSI commands it receives as writing\/printing commands.","The aforementioned system and method of transferring data to a disc provide numerous advantages. For example, the system allows an imaging system to communicate with an optical disc drive, without having to deal with the low-level complexities of SCSI drivers. By way of another example, the system does not require the user to have administrator privileges to access the drive through the SPTI . In addition, by using standard OS components and thereby eliminating the need for a new driver, the system: (a) does away with the licensing costs associated with using a third party CD-ROM driver that is not part of the operating system; and (b) does not require certification by the Microsoft Hardware Quality lab.","Although the aforementioned describes embodiments of the invention, the invention is not so restricted. It will be apparent to those skilled in the art that various modifications and variations can be made to the disclosed embodiments of the present invention without departing from the scope or spirit of the invention. Accordingly, these other systems and methods of transmitting write commands from an application without administrator privileges to a drive are fully within the scope of the claimed invention. Therefore, it should be understood that the apparatus and method described herein are illustrative only and are not limiting upon the scope of the invention, which is indicated by the following claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1A"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1B"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
