---
title: Adaptive Kalman Filter process for controlling an ensemble clock
abstract: In an ensemble oscillator system including multiple free-running oscillators, a voltage controlled oscillator having a frequency responsive to a control signal, and a differencer unit that measures time differences between the oscillators, an adaptive Kalman Filter Processor (AKFP) generates the control signal responsive to the time differences. The AKFP uses oscillator noise models to model noise/errors of the ensemble system oscillators, including random noise parameters, and adaptively estimates the errors and the random noise parameters to derive the control signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06958951&OS=06958951&RS=06958951
owner: The Johns Hopkins University
number: 06958951
owner_city: Baltimore
owner_country: US
publication_date: 20040723
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","STATEMENT OF GOVERNMENTAL INTEREST","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT(S)"],"p":["This application claims priority to U.S. Provisional Application No. 60\/489,396, filed Jul. 23, 2003, and is related to U.S. Provisional Application No. 60\/488,894, filed Jul. 21, 2003, each of which is incorporated herein in its entirety by reference.","This application is also related to U.S. Non-provisional application Ser. No. 10\/898,417, filed Jul. 23, 2004, entitled \u201cEnsemble Oscillator and Related Methods,\u201d by Duven et al., which is incorporated herein in its entirety by reference.","This invention was made with Government support under Navy Contract Nos. N00039-01-C-2233 and N00039-02-C-2217 awarded by Space and Naval Warfare Systems Command. The Government has certain rights in the invention.","1. Field of the Invention","The present invention relates generally to multiple oscillator systems.","2. Description of the Related Art","Conventional systems, such as satellite systems, disadvantageously use complex and expensive atomic oscillators, such as rubidium or cesium oscillators, to provide precise and stable reference frequencies. In such systems, there is a need to provide reference frequencies approaching the accuracies available from atomic standards, without using the atomic standards.","An embodiment of the present invention includes a method of controlling an ensemble oscillator system. The system is configured to generate: a reference frequency; multiple free-running frequencies; a controlled frequency having a frequency responsive to a control signal; and difference measurements indicative of time and frequency-based errors associated with each free-running frequency and the controlled frequency relative to the reference frequency. The method generates the control signal responsive to the difference measurements, and comprises: (a) using dynamic relationships associated with each free-running frequency and the controlled frequency to represent time and frequency-based errors corresponding to variances and covariances having magnitudes and rates of growth determined by random process weighting (RPW) parameters; and (b) the following adaptive Kalman filtering steps that, when executed in a steady-state condition, use the difference measurements to produce their respective results: (i) adaptively estimating the RPW parameters associated with each free-running frequency; (ii) generating, using the RPW parameter estimates from step (i), variances and covariances associated with each free-running frequency; (iii) generating, using the variances and covariances from step (ii), error weights associated with each free-running frequency; (iv) estimating weighted time and frequency-based errors associated with each free-running frequency, wherein the weighted error estimates are weighted with the corresponding error weights from step (iii); and (v) estimating, based on the weighted error estimates from step (iv), time and frequency-based errors associated with the controlled frequency.","Further apparatus and method embodiments of the present invention will be apparent from the ensuing description.","Overview",{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 1","b":["100","102","104","106","108","110","112"]},"OEU  includes multiple (m) ensemble frequency sources or oscillators -that generate corresponding ensemble free-running frequency signals -(also referred to as frequencies . . . ). The ensemble oscillators  generate frequencies  concurrently. Each ensemble oscillator is a stand-alone or free-running oscillator in that system  does not control the phase and frequency of the free-running oscillator. OEU  provides ensemble free-running frequency signals  to respective inputs of TMU .","Oscillators  can include any type or a mix of types of oscillators, including quartz oscillators, temperature-compensated quartz oscillators, ovenized quartz oscillators, micro-mechanical oscillators, atomic clocks, and so on. Oscillators  may be co-located with one another and with the other modules of ensemble oscillator system . Alternatively, one or more of oscillators  may be located at a remote location with respect to the other oscillators and connected to OEU  by either wired or wireless links, and\/or a telecommunication network.","Each of free-running frequency signals  may be represented as any type of waveform, such as a sine wave, a square wave, a trapezoid or triangle wave, or a pulsed waveform, for example. In an embodiment, each of frequency signals  is at approximately the same frequency as the other frequency signals, such as at or near 10 MHz. In another embodiment, the frequencies of frequency signals  are substantially different from one another.","SGU  generates a controlled frequency signal  (also referred to as a controlled frequency  or an output signal ) having a frequency and a phase responsive to a control signal , and provides the controlled frequency signal to IOU . In an embodiment, the frequency of controlled frequency signal  is approximately matched to the frequencies of ensemble frequency signals . SGU  also generates a feedback signal  and provides the feedback signal to an input of TMU . Like controlled frequency signal , the frequency and phase of feedback signal  are responsive to control signal . In an embodiment, feedback signal  and controlled frequency signal  are the same signal. Thus, feedback signal is also referred to herein as controlled frequency signal  or controlled frequency signal .","IOU  receives a master time reference signal  (also referred to as a precise time signal  or a reference signal ) from an external source (not shown), in addition to controlled frequency signal . Examples of such precise time include GPS time, including, for example, a GPS derived 1PPS signal, a JTIDS\/ETR signal, and a Have Quick signal. IOU  passes precise time signal  to TMU . From controlled frequency signal  and precise time signal , IOU  produces a plurality of output signals . IOU  includes logic to produce output signals  such as 1\/1M\/5M PPS signals (where M=10), 1\/10\/1M\/10M PPMinute signals, Have Quick, IRIG-B or other time codes, and 5 MHz\/10 MHz\/other clocks, etc.","TMU  (also referred to as differencer unit ) measures differences, such as time differences or intervals, for example, between controlled frequency signal  and each of (i) time reference signal , and (ii) ensemble frequency signals , and passes the measured time differences as signals  to controller . Measured differences (or difference measurements)  are indicative of frequency and phase differences between controlled frequency signal  and each of (i) time reference signal , and (ii) ensemble signals . Specifically, measured differences  indicate time and frequency-based errors associated with each of (i) controlled frequency , and (ii) each or free-running frequencies , relative to reference signal .","CPU  controls ensemble oscillator system . CPU  includes an Adaptive Kalman Filter Processor (AKFP)  (also referred to as an AKFprocessor ). AKFP  processes time interval date  to produce control signal  for controlling the phase and\/or frequency of controlled frequency signal  and feedback signal . CPU  and AKFP are computer based controllers including memory, input\/output modules and ports, software or computer program modules, and any other digital and\/or analog logic as is know in the art to support all of the functionality required of CPU  and AKFP  described herein.","CPU  also includes an optional sensor module  configured to operate as described below.","Environmental sensors  include one or more vibration sensors for sensing a level of vibration associated with one or more corresponding oscillators . Environmental sensors  may also include a temperature sensor for sensing the temperature of oscillators . Environmental sensors  provide sensed data , including vibration levels and temperature, to sensor module  of CPU . Sensor module  passes difference measurements  from differencer unit  to AKFP  only when the sensed vibration levels indicated in signal  are below a predetermined level.","TMU",{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 2","b":["104","104","202","208","202","202","116","116","212","212","212","202","124","214","214","202","116","124","212","214"],"sub":["1","m "],"i":["a","n ","i"],"sup":"7"},"Differencer  measures time differences between controlled time signal  and (i) each of ensemble time signals , and (ii) precise time signal , to produce time difference signals . TMU  provides time difference signals  to AKFP  in the form of a vector including the time differences .","SGU",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 3","b":["110","110","302","122","304","306","304","308","312","120","308"]},"Adaptive Kalman Filter Processor (AKFP)","As is known in the art, a frequency source or oscillator generates a frequency having a frequency error y(t) (or \u201cy\u201d). The frequency error tends to wander or drift randomly at a rate. This error is referred to as frequency drift or rate error d(t) (or \u201cd\u201d). The oscillator frequency may be divided-down to produce a time signal. The time signal has a time error x(t) (or \u201cx\u201d). An oscillator error model or set of dynamic relationships, i.e., equations, may be used to quantify the aforementioned oscillator time, frequency and frequency drift errors. In the present invention, AKFP  uses or assumes such oscillator error models or dynamic relationships of oscillators in system  to transform time interval data  into control signal .",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 4","b":["134","402","404","406","114","110","312","112","100","402","402","114","114","402","402","221","212","116","116"],"sub":["1","m ","1","m","1","m","1 ","m ","1 . . . m","1 ","m","1 ","m ","1 ","m","1 ","m ","1 ","m"]},"Oscillator error model  represents errors associated with VCO . Specifically, oscillator error model  represents time error xof time signal , frequency error yof signal , and frequency drift error dassociated with frequency error y.","IOU  is modeled as a reference time source that generates a reference frequency, from which is derived precise time signal . The reference time source is represented as oscillator error model . Oscillator error model  represents time error xof time signal .","Models  and  include unit random noise inputs a, b and c weighted with respective weighting parameters alpha \u201c\u03b1,\u201d beta \u201c\u03b2,\u201d and gamma \u201c\u03b3,\u201d to derive the time, frequency and frequency drift errors of the respective oscillators. In the embodiment depicted in FIG. :","(i) the frequency errors yare represented as first and second integrals of the product of weighting parameters betaand alpha(also referred to herein as random process weighting (RPW) parameters) with unit variance whit e noise random processes, and","(ii) the time errors xare represented as first integrals of the sum of the fractional frequency errors and the product of weighting parameters gammawith additional unit variance white noise random processes.","Thus, generally, the time, frequency, and frequency drift errors are functions of both the corresponding alpha \u03b1, beta \u03b2, and gamma \u03b3 parameters, and the noise processes. The alpha and beta parameters determine the magnitudes and rates of growth of the variances and covariances of the time, frequency and frequency rate errors.","As mentioned above, TMU  generates time differences (i.e., signals ) between time signal  and (i) each of time signals , and (ii) time signal . Accordingly, also depicted in  are subtractive adders  and , fed by the respective outputs of error oscillator models -, that model the time differencing action of TMU  (i.e., differencer ) with respect to time errors associated with the oscillators. Adders ,  yield time difference errors z (specifically, errors z. . . zand z) as functions of time errors x and error perturbation signals v. These errors are associated with time interval data .","AKFprocessor  receives time interval . AKFprocessor  uses time interval  together with the oscillator error models or dynamic relationships depicted in  to:","(a) compute running estimates of the time, frequency, and frequency drift errors of each of ensemble oscillators  and VCO  relative to the reference time scale or external time reference provided, e.g., by a GPS timing receiver;","(b) control VCO  such that its time and frequency errors are maintained close to zero relative to the reference time scale; and","(c) adaptively estimate the alpha and beta parameters corresponding to each of the ensemble oscillators  and VCO .","AKFprocessor  uses the estimates of the time x, frequency y, and frequency drift d errors of each of ensemble oscillators  and VCO  as state variables in a Kalman filter process. AKFprocessor  also uses the alpha and beta parameters in the Kalman filter process. The estimated errors and alpha and beta parameters are used to update the oscillator error models.","The significance of the alpha and beta parameters is that they determine the rate of error growth in the time and frequency errors of each oscillator. Adaptive estimation of these parameters in the present invention permits the VCO control aspect of AKFprocessor  to select weighting parameters such that ensemble oscillators having relatively lower noise (that is, lower time, frequency and frequency drift errors) exert more influence on the frequency control of VCO  than do ensemble oscillators associated with relatively higher noise. Also, maintaining time, frequency, and frequency drift estimates on ensemble oscillators  during periods of precise time signal (e.g., GPS) availability allows AKFprocessor  to maintain tighter control on VCO error growth during precise time signal (e.g., GPS) outages than is possible when there is only one free-running oscillator.","As depicted in , AKFprocessor  includes an adaptive Kalman filter  that  receives time interval measurements  and produces (i) state variable estimates x, y and z, and (ii) estimates of the alpha, beta and gamma parameters. AKFprocessor  also includes a State Space Controller (SSC)  that produces control signal  based on the state variable estimates from Kalman filter .",{"@attributes":{"id":"p-0047","num":"0046"},"figref":["FIG. 5","FIG. 5"],"b":["500","134","500","5","420","500","134"]},"Listed first below are the overall inputs to and outputs from AKFprocessor  and method . Then, a description of each of the Steps 1-8 of method  ensues. In the embodiment described below, AKFprocessor  operates on time, fractional frequency, and fractional frequency rate errors. \u201cFractional frequency error\u201d is equal to frequency error divided by the nominal center frequency of a given frequency signal, and \u201cfractional frequency rate error\u201d is equal to frequency rate error divided by the nominal center frequency. Frequency error, fractional frequency error, frequency rate error and fractional frequency rate error are generally referred to herein collectively and individually as frequency-based error(s).",{"@attributes":{"id":"p-0049","num":"0048"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Inputs"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Z","(m + 1)-dimensional vector of time difference measurements"]},{"entry":[{},"corresponding to time interval measurements 132"]},{"entry":[{},"[x\u2212 x, . . . , x\u2212 x, x\u2212 x]"]},{"entry":["SigmaV","(m + 1)-dimensional vector of measurement error \u03c3's"]},{"entry":["Tcompute","Number of seconds needed to compute the VCO"]},{"entry":[{},"control values"]},{"entry":["Tcrank","Number of seconds between input measurement sets to the"]},{"entry":[{},"Kalman filter"]},{"entry":["Ncranks","Number of input measurement sets between re-evaluations"]},{"entry":[{},"of the \u03b1, \u03b2 estimates"]},{"entry":["kValues","(m + 1,3)-dimensional matrix of initial \u03b1, \u03b2, \u03b3 values"]},{"entry":[{},"for the m free-running oscillators and the VCO"]},{"entry":["kMin","(m + 1,2)-dimensional matrix of minimum allowable values"]},{"entry":[{},"for the \u03b1, \u03b2 estimates"]},{"entry":["kMax","(m + 1,2)-dimensional matrix of maximum allowable values"]},{"entry":[{},"for the \u03b1, \u03b2 estimates"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0050","num":"0049"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Outputs"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["FracFreqRate","Digital values to be used by the SGU to"]},{"entry":[{},"generate a VCO control voltage\/signal"]},{"entry":[{},"that drives the VCO time and frequency"]},{"entry":[{},"errors to zero"]},{"entry":["kEstimate","Current value of the estimated \u03b1 and \u03b2 parameters"]},{"entry":["Out2","Current value of the a posteriori estimates of the time,"]},{"entry":[{},"frequency, and frequency drift errors of the"]},{"entry":[{},"VCO and m free-running oscillators"]},{"entry":["Out3","Square-root of the diagonal of the a posteriori"]},{"entry":[{},"covariance matrix"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"Step 1\u2014Initialize Parameters.","Purpose: When the AKFprocessor  receives control for the first time, in step numerous parameters and matrices needed by the algorithm, i.e., method , are initialized to appropriate values. The parameters initialized and their significance are as follows:",{"@attributes":{"id":"p-0053","num":"0052"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Uk","Current VCO fractional frequency rate control"]},{"entry":["ControlPoles","Location in the z-plane of the VCO controller's poles"]},{"entry":["m","Number of free-running oscillators"]},{"entry":["n","Number of state variables to be estimated"]},{"entry":["Xm","Current a priori estimates of the state variables"]},{"entry":[{},"(estimates of x, y and d before incorporating"]},{"entry":[{},"current measurements)"]},{"entry":["Xp","Current a posteriori estimates of the state variables"]},{"entry":[{},"(estimates of x, y and d after incorporating"]},{"entry":[{},"current measurements)"]},{"entry":["Pm","Current a priori covariance matrix"]},{"entry":["Pp","Current a posteriori covariance matrix"]},{"entry":["Hmatrix","Measurement matrix"]},{"entry":["dXmdTh","Partials of Xm with respect to \u03b1and \u03b2"]},{"entry":["dXpdTh","Partials of Xp with respect to \u03b1and \u03b2"]},{"entry":["dPmdTh","Partials of Pm with respect to \u03b1and \u03b2"]},{"entry":["dPpdTh","Partials of Pp with respect to \u03b1and \u03b2"]},{"entry":["dJdTh","Partials of J with respect to \u03b1and \u03b2"]},{"entry":["Twait","Tcrank - Tcompute"]},{"entry":["PhiVCO","VCO transition matrix with \u0394t = Tcrank"]},{"entry":["GammaVCO","VCO input matrix with \u0394t = Tcrank"]},{"entry":["PhiCompute","VCO transition matrix with \u0394t = Tcompute"]},{"entry":["GammaCompute","VCO input matrix with \u0394t = Tcompute"]},{"entry":["PhiWait","VCO transition matrix with \u0394t = Twait"]},{"entry":["GammaWait","VCO input matrix with \u0394t = Twait"]},{"entry":["PhiMatrix","Transition matrix for all n states, \u0394t = Tcrank"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"ul":{"@attributes":{"id":"ul0001","list-style":"none"},"li":["Inputs: None.","Outputs: The parameters listed above."]}},"Step 2\u2014Save Input Parameters.","Purpose: Since parameters Tcompute, Tcrank, Ncranks, kValues, kMin, and kMax are usually constant over many calls to the AKFprocessor , these values are saved in persistent memory when supplied, and the saved values are used when the input parameters are not supplied. In addition, a few parameters that are derived from the input parameters are also computed and saved in persistent memory.\n\n","Step3\u2014Kalman Measurement Update.","Purpose: Adaptive processing starts with a standard Kalman Measurement Update as described by the equations shown below. This results in an optimal estimate of the state vector up to and including the current set of measurements. It also provides the matrices needed in Steps 4 and 5 for adaptive estimation of the \u03b1 and \u03b2 parameters.\n\n","Step 4\u2014Adaptive Measurement Update.","Purpose: Together, Steps 4 and 5 adaptively estimate the \u03b1 and \u03b2 parameters. These parameters determine the rate of growth of a clock\/oscillator's time and frequency uncertainty. In a given class of oscillator (e.g., ovenized crystal oscillators) these parameters can vary by factors of 2-10, and between different classes of oscillators (e.g., crystal vs. atomic oscillators) these parameters can vary by several orders of magnitude. In an ordinary (non-adaptive) Kalman filter, these parameters are typically specified by a human operator\/analyst. This is frequently done by a separate (i.e., side) analysis of time sequences of clock\/oscillators that are similar to those being processed, and usually requires an iterative trial-and-error process in which the performance of the Kalman filter with a certain set of parameter values is observed and then modified until acceptable performance is achieved. The AKFprocessor  of the present invention uses the principles of advanced statistical estimation theory to estimate the parameter values from data provided by the actual oscillators being processed, including the ensemble of free-running oscillators . The general principles for adaptive Kalman filter processing are given in References [1], [2] and [3], each of which is incorporated herein by reference in its entirety. Step 4 computes matrices that are used in Step 5 to estimate the \u03b1 and \u03b2 parameter estimates. The equations used in Step 4 to compute the matrices are as follows: \n\n\n\n\n\n\n\n\n\n","Step 5\u2014Compute New \u03b1 and \u03b2 Estimates.","Purpose: New Maximum Likelihood (ML) estimates of \u03b1and \u03b2are computed in this step on a schedule of one new set of estimates per Ncranks calls to the AKFprocessor . The equations used to calculate these estimates are as follows:\n\ndiag(inv)=(1+1\/invDiv)*diag(inv)\n\ninv=inv[inv(inv)+\n\nTheta=max{Min, min[Max, Theta\u2212inv*)]}\n\n","Step 6\u2014Compute VCO Control Value.","Purpose: This component of the AKFprocessor  uses estimates of the current time and fractional frequency error of the VCO\/clock  produced by the adaptive Kalman filter to compute what the rate of change of fractional frequency error (Uk=dy\/dt) must be so that both the time and fractional frequency errors of the VCO\/clock are quickly driven to zero. These control values are converted into a time-varying control voltage V(t) in the Signal Generation Unit (SGU) and are applied as input to the VCO to achieve the desired time and frequency control for this oscillator. The control values are calculated by the equation\n\ncontrol*\n\n","Step 7\u2014Kalman Time Update.","Purpose: This step produces the expected a priori state vector (Xm) and associated covariance matrix (Pm) for the next measurement time, t=t+Tcrank. The equations used for computing these quantities are as follows: \n\n\n\n\n\n\n\n\n\n\n\n\n","Step 8\u2014Adaptive Time Update.","Purpose: Calculations needed to complete the adaptive estimation of the \u03b1 and \u03b2 parameters are executed in this step. In this case the partials of Xm and Pm at the next measurement time, t=t+tCrank, are computed from the partials dXpdTh and dPpdTh generated in Step 4 for time t. The equations to be used for these calculations are as follows: \n\n\n","Outputs: dXmdTh=Partials of Xm(t) with respect to \u03b1and \u03b2\n\n",{"@attributes":{"id":"p-0069","num":"0132"},"figref":"FIG. 6","b":["600","500","600","134","100","132","134","134"]},"It is also assumed that AKFP  uses the dynamic relationships depicted in  to represent time errors and frequency-based errors (e.g., fractional frequency and fractional frequency rate errors) associated with oscillators  and . The errors are relative to the reference signal . The alpha and beta parameters mentioned above are random process weighting (RPW) parameters that determine the magnitudes and rates of growth of the variances and covariances of the time and frequency-based errors.","A first step  of method  includes adaptively and optimally estimating the RPW parameters (i.e., the alpha and beta parameters) associated with each free-running frequency (e.g., of free-running frequency signals ). These RPW estimates effectively indicate relative noise levels associated with each free-running oscillator or its free-running frequency.","A next step  includes generating, using the RPW parameter (i.e., alpha and beta) estimates from step , variances and covariances associated with each free-running frequency.","A next step  includes generating, using the variances and covariances from step , error weights associated with each free-running frequency.","A next step  includes optimally estimating weighted time and frequency-based errors associated with each free-running frequency, wherein the weighted error estimates are weighted with the corresponding error weights from step .","Steps ,  and  collectively represent a step of deriving, based on the RPW parameters from the first module, weighted time and frequency-based error estimates associated with each free-running frequency, wherein the weighted errors estimates are weighted to favor less noisy free-running frequencies over more noisy free-running frequencies.","A next step  includes optimally estimating, based on the weighted error estimates from step , time and frequency-based errors associated with the controlled frequency (e.g., of controlled frequency signal ). Steps - can be performed by adaptive Kalman filter .","A next step  includes generating a frequency control signal (e.g., frequency control signal ) based on the error estimates from step . State Space Controller  can perform step . In steps -, lower noise oscillators are used more heavily than higher noise oscillators in generating the frequency controlled signal. Specifically, the weighted error estimates from step  favor the lower noise oscillators, as indicated by the RPW parameters.","Conclusion","While the above description contains many specifics, these specifics should not be construed as limitations of the invention, but merely as exemplifications of preferred embodiments thereof. Those skilled in the art will envision many other embodiments within the scope and spirit of the invention as defined by the claims appended hereto.","References",{"@attributes":{"id":"p-0079","num":"0000"},"ul":{"@attributes":{"id":"ul0021","list-style":"none"},"li":["[1] M. D. Shuster, D. W. Porter, and B. D. Gibbs: \u201cMaximum Likelihood Estimation Techniques for Trident Missile System Parameters\u201d, Business and Technological Systems, Inc. report number BTS 10-82-64\/rb 1037, September 1983.","[2] P. S. Maybeck: \u201cStochastic Models, Estimation, and Control\u201d, vol. 2, Academic Press, New York, 1982.","[3] G. F. Franklin, J. D. Powell, and M. Workman: \u201cDigital Control of Dynamic Systems\u201d, 3rd Ed., Addison-Wesley, Menlo Park, Calif. 1998."]}}],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Various embodiments are described below with reference to the drawings",{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3","b":"1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4","b":"1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
