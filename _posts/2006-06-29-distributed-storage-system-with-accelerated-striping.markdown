---
title: Distributed storage system with accelerated striping
abstract: A data storage apparatus and associated method is provided wherein a software system is resident in a memory space and is configured to encode data retrieved from a first number of logical units into a single channel in order to store the data in a second number of logical units.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07913038&OS=07913038&RS=07913038
owner: Seagate Technology LLC
number: 07913038
owner_city: Scotts Valley
owner_country: US
publication_date: 20060629
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application is a continuation-in-part of U.S. application Ser. No. 11\/145,403 filed Jun. 3, 2005 and assigned to the assignee of this application.","The claimed invention relates generally to the field of distributed data storage systems and more particularly, but not by way of limitation, to an apparatus and method for restriping data stored in memory.","Computer networking began proliferating when the data transfer rates of industry standard architectures could not keep pace with the data access rate of the 80386 processor made by Intel Corporation. Local area networks (LANs) evolved to storage area networks (SANs) by consolidating the data storage capacity in the network. Users have realized significant benefits by the consolidation of equipment and the associated data handled by the equipment in SANs, such as the capability of handling an order of magnitude more storage than would otherwise be possible with direct attached storage, and doing so at manageable costs.","More recently the movement has been toward a network-centric approach to controlling the data storage subsystems. That is, in the same way that the storage was consolidated, so too are the systems that control the functionality of the storage being offloaded from the servers and into the network itself. Host-based software, for example, can delegate maintenance and management tasks to intelligent switches or to a specialized network storage services platform. Appliance-based solutions eliminate the need for the software running in the hosts, and operate within computers placed as a node in the enterprise. In any event, the intelligent network solutions can centralize such things as storage allocation routines, backup routines, and fault tolerance schemes independently of the hosts.","While moving the intelligence from the hosts to the network resolves some problems such as these, it does not resolve the inherent difficulties associated with the general lack of flexibility in altering the presentation of virtual storage to the hosts. For example, stored data may need to be moved for reliability concerns, or more storage capacity may need to be added to accommodate a growing network. In these events either the host or the network must be modified to make it aware of the existence of the new or changed storage space. What is needed is an intelligent data storage subsystem that self-deterministically allocates, manages, and protects its respective data storage capacity and presents that capacity as a virtual storage space to the network to accommodate global storage requirements. This virtual storage space is able to be provisioned into multiple storage volumes. A distributed computing environment uses these intelligent storage devices for global provisioning as well as for global striping and restriping of stored data. It is to this solution that embodiments of the present invention are directed.","Embodiments of the present invention are generally directed to a distributed storage system with restriping capability that avoids the intensive overhead associated with backing up the originally stored data and restoring it in the restriped arrangement.","In some embodiments a data storage device is provided with a software system resident in a memory space that is configured to encode data retrieved from a first number of logical units into a single channel in order to store the data in a second number of logical units.","In some embodiments a method is provided for encoding data that is striped across a first number of logical units into a single channel, and decoding the encoded data across a second number of logical units.","In some embodiments a data storage system is provided with an intelligent storage element having a memory space, and means for restriping data in logical units of the memory space.","These and various other features and advantages which characterize the claimed invention will become apparent upon reading the following detailed description and upon reviewing the associated drawings.",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 1","b":["100","102","104","106","106","102","104","108","110","104","108","108","109"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 2","FIG. 1"],"b":["100","102","108","110","108","112","1","2","1","2","109","112","109","112","100","109"]},"It is further contemplated that the A host computer  and the A ISE  can be physically located at a first site, the B host computer  and B ISE  can be physically located at a second site, and the C host computer  can be yet at a third site, although such is merely illustrative and not limiting. All entities on the distributed computer system are connected over some type of computer network.",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 3","b":["108","114","112","116","114","118","114","116","116","122","124","126","118"]},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 4","FIG. 3"],"b":["118","118","130","132","128","130","132","128","134","136","116","138","118","118"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 5","FIG. 4"],"b":["128","140","142","140","143","143","144","143","140","143","145","146","145","128","148","145","128","134","118"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 6","b":["108","112","150","150","112","118","108"]},"The controllers  are responsive to remote access commands to data packs ,  via communication ports , , respectively. For purposes of illustration the controller  in  has created logical unit (\u201cLUN\u201d)  and LUN  from data pack , and LUN  from data pack , all in response to host commands for storage capacity. Also for the sake of the present description, the data packs ,  will be assumed to contain eight data storage devices  for data storage and two spare data storage devices .","Aspects of the managed reliability include invoking reliable data storage formats such as RAID strategies. For example, by providing a system for selectively employing a selected one of a plurality of different RAID formats creates a relatively more robust system for storing data, and permits optimization of firmware algorithms that reduce the complexity of software used to manage the MDA , as well as resulting in relatively quicker recovery from storage fault conditions. These and other aspects of this multiple RAID format system is described in patent application Ser. No. 10\/817,264 entitled Storage Media Data Structure and Method which is assigned to the present assignee and incorporated herein by reference.","Managed reliability can also include scheduling of diagnostic and correction routines based on a monitored usage of the system. Data recovery operations are executed for copying and reconstructing data. The ISP  is integrated with the MDAs  in such as way to facilitate \u201cself-healing\u201d of the overall data storage capacity without data loss. These and other aspects of the managed reliability aspects contemplated herein are disclosed in patent application Ser. No. 10\/817,617 entitled Managed Reliability Storage System and Method which is assigned to the present assignee and incorporated herein by reference. Other aspects of the managed reliability include responsiveness to predictive failure indications in relation to predetermined rules, as disclosed for example in patent application Ser. No. 11\/040,410 entitled Deterministic Preventive Recovery From a Predicted Failure in a Distributed Storage System which is assigned to the present assignee and incorporated herein by reference.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 7","b":["152","150","150","109","110","150","150","152","154","156","158","154","150","110","109","160","162","154","164","150","164","166","168"]},{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 8","FIG. 8"],"b":["154","150","170","180","182","184","186","170","180","186","182","184","150","182","184","170","180","186"]},"The policy processor  can be programmed to execute desired operations via the ISP . For example, the policy processor  can communicate with the list managers , , that is send and receive messages, via the CPS . Responses to the policy processor  can serve as interrupts signaling the reading of memory  registers.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 9","b":["108","112","102","108","109"]},"For present purposes, the term \u201cvirtual storage volume\u201d means a logical entity that generally corresponds to a logical abstraction of physical storage. \u201cVirtual storage volume\u201d can include, for example, an entity that is treated (logically) as though it was consecutively addressed blocks in a fixed block architecture or records in a count-key-data architecture. A virtual storage volume can be physically located on more than one storage element.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 10","b":["108","102","128","128","128","128","108"],"sub":["1","2","3 ","n"]},"In  the ISE  has created another LUN  in response to a host command for more storage capacity. The present embodiments contemplate a manner of accelerating a restriping of data that already exists in LUN  and LUN  across all three LUNS. Advantageously, the accelerated restriping of the present embodiments does not require the comparatively time-consuming procedure in related art solutions of backing up the existing data and then restoring it to the newly configured storage space. That is, in the present solution the ISE  can be otherwise available to the system  based solely on the time when the restriping process is initiated and the rate of restriping, according to the procedure described herein. The time it is initiated and the rate with which data are transferred can be varied, such as in relation to other system  resource requirements, in order to minimize the restriping process adverse effects on the system  performance. Also, by simplifying the inputs to the restriping application, and by offloading the application from the remote host , the present embodiments accelerate the process at less overhead expense to the distributed system  as a whole.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 12","b":["1","2","128","151","1","1","1","1","2","5","5","1","2"]},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 13","b":["150","199","200","202","199","204"]},"Preferably, the software system  executes a multiplexing operation (\u201cmux\u201d)  to encode the data and a demultiplexing operation (\u201cdemux\u201d)  to decode the encoded data. For purposes of the present discussion the data originally stored in LUN  and LUN  () will be restriped across LUNS - in accordance with embodiments of the present invention. In other words, presently stored data will be restriped from two LUNS to three LUNS. Accordingly, n=2 and m=3 in .",{"@attributes":{"id":"p-0049","num":"0048"},"figref":["FIG. 14","FIG. 15","FIG. 16"],"b":["1","1","1","168","1","5","5","168","2","1"]},"In  the data stripe A-H is read from cache  and stored to LUN . In  the multiplex-demultiplex circuitry sequences to next read data stripe A-H from cache  and store it to LUN . In  data stripe A-H is stored to LUN . In  data stripe A-H is stored to LUN . Finally, in  data stripe A-H is stored to LUN .","The restriping utility described in  is reversible by carrying out basically the same procedure but where n=3 and m=2. Considering the originally stored data as being in the state shown by ,  begins a restore process by storing data stripe A-H in LUN . In  the multiplexing-demultiplexing circuitry has sequentially sequenced in order to store data stripe A-H in LUN .  shows the circuitry next stores data stripe A-H in LUN ; in  data stripe A-H is stored in LUN ; in  data stripe A-H is stored in LUN ; in  data stripe A-H is stored in LUN ; in  data stripe A-H is stored in LUN . Finally, in  data stripe A-H is stored in LUN .",{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 30","FIGS. 14-21"],"b":["250","250","252","254","256","256","250","258","258","254"]},"Finally,  is a view similar to  but with the plurality of data storage devices  and circuit board  contained within a sealed enclosure made from a base  with a cover  sealingly attached thereto. Sealingly engaging the data storage devices  forming the MDA A provides numerous advantages to the user including guaranteeing the arrangement of the data storage devices  is not altered from a preselected optimal arrangement. Such an arrangement also permits the MDA A manufacturer to tune the system for optimal performance, given that the number, size, and type of data storage devices  can be clearly defined.","The sealed MDA A also allows the manufacturer to maximize the reliability and fault tolerance of the group of storage medium within. This is done by optimizing the drives in the multi-spindle arrangement. Design optimizations can reduce cost, increase performance, increase reliability, and generally extend the life of data within the MDA A. Furthermore, the design of the MDA A itself provides an almost zero rotational vibration and high cooling efficiency environment, which is the subject matter of pending U.S. application Ser. No. 11\/145,404 entitled Storage Array with Enhanced RVI and assigned to the assignee of the present application. This allows the storage medium within to be manufactured to less costly standards without compromising the MDA  reliability, performance, or capacity. The sealed MDA A thus provides no single point of failure and near perfect rotational vibration avoidance and cooling efficiency. This allows designing the MDA A for optimal disc medium characteristics, and reduces cost while at the same time increasing reliability and performance.","In summary, a self-contained ISE for a distributed storage system is provided, including a plurality of rotatable spindles each supporting a storage medium adjacent a respective independently moveable actuator in a data storing and retrieving relationship with the storage medium. The ISE further includes an ISP adapted for mapping a virtual storage volume to the plurality of mediums for use by a remote device of the distributed storage system.","In some embodiments the ISE has the plurality of spindles and mediums contained within a common sealed housing. Preferably, the ISP allocates memory in the virtual storage volume for storing data in a fault tolerant manner, such as in a RAID methodology. The ISP is furthermore capable of performing managed reliability methodologies in the data storage process, such as initiating in-situ deterministic preventive recovery steps in response to an observed predicted storage failure. Preferably, the ISE is made of a plurality of data storage devices each having a disc stack made of two of more discs of data storage medium.","In other embodiments an ISE is contemplated for a distributed storage system comprising a self-contained plurality of discrete data storage devices and an ISP communicating with the data storage devices and adapted for abstracting a command received from a remote device and associating related memory accordingly. Preferably, the ISP is adapted for mapping a virtual storage volume to the plurality of data storage devices for use by one or more remote devices of the distributed storage system. As before, the plurality of data storage devices and mediums can be contained within a common sealed housing. Preferably, the ISP allocates memory in the virtual storage volume for storing data in a fault tolerant manner, such as in a RAID methodology. The ISP can furthermore initiate in-situ deterministic preventive recovery steps in the data storage devices in response to an observed predicted storage failure.","In alternative embodiments a distributed storage system is provided comprising a host; and a backend storage subsystem in communication with the host over a network and comprising means for virtualizing a self-contained storage capacity independently of the host.","The means for virtualizing can be characterized by a plurality of discrete individually accessible data storage units. The means for virtualizing can be characterized by mapping a virtual block of storage capacity associated with the plurality of data storage units. The means for virtualizing can be characterized by sealingly containerizing the plurality of data storage units and associated controls. The means for virtualizing can be characterized by storing data in a fault tolerant manner, such as without limitation to RAID methodology. The means for virtualizing can be characterized by initiating in-situ deterministic preventive recovery steps in response to an observed predicted storage failure. The means for virtualizing can be characterized by a multiple spindle data storage array.","For purposes herein the term \u201cmeans for virtualizing\u201d expressly does not contemplate previously attempted solutions that included the system intelligence for mapping the data storage space anywhere but within the respective data storage subsystem. For example, \u201cmeans for virtualizing\u201d does not contemplate the use of a storage manager to control the functions of data storage subsystems; neither does it contemplate the placement of the manager or switch within the SAN fabric, or within the host.","The present embodiments further contemplate a data storage device having a software system that is resident in a memory space and configured to encode data retrieved from a first number of logical units into a single channel in order to store the data in a second number of logical units. Preferably the software system is configured to decode the encoded data before storing the data in the second number of logical units.","For example, the software system can be configured to multiplex the data that is originally striped across the first number of logical units to encode the data. In this case the software system can be configured to demultiplex the encoded data in order to restripe the data across the second number of logical units. Preferably, the software system synchronously loops the data multiplexing and the data demultiplexing across one or more input sources and one or more output destinations, respectively.","The first number of logical units and the second number of logical units can be different; that is, in some cases the second number is greater than the first number and in other cases the first number is greater than the second number.","The software system can also restore the original striping of the data across the first number of logical units by multiplexing the restriped data from the second number of logical units.","In some embodiments the software system can be resident in an intelligent storage element of a distributed storage system.","In other embodiments a method is provided for encoding data that is striped across a first number of logical units, and decoding the encoded data across a second number of logical units. The encoding step can be characterized by multiplexing data originally striped in the first number of logical units, and the decoding step can be characterized by demultiplexing the encoded data in order to restripe the data across the second number of logical units. Preferably, the encoding step and decoding step are characterized by synchronously looping the data multiplexing and the data demultiplexing to one or more input sources and one or more output destinations, respectively. The method can also contemplate restoring the original striping of the data across the first number of logical units by multiplexing the restriped data from the second number of logical units.","In other embodiments a data storage system is provided having an intelligent storage element with a memory space, and means for restriping data in logical units of the memory space. For purposes of the present description and meaning of the appended claims the meaning of the phrase \u201cmeans for restriping\u201d explicitly requires an encoding\/decoding operation as described herein, such as but not limited to the multiplexing and demultiplexing operations described. The meaning of \u201cmeans for restriping\u201d expressly does not include previous attempted solutions involving backing up the originally stored data and then restoring it in the new striped arrangement.","It is to be understood that even though numerous characteristics and advantages of various embodiments of the present invention have been set forth in the foregoing description, together with details of the structure and function of various embodiments of the invention, this detailed description is illustrative only, and changes may be made in detail, especially in matters of structure and arrangements of parts within the principles of the present invention to the full extent indicated by the broad general meaning of the terms in which the appended claims are expressed. For example, the particular elements may vary depending on the particular processing environment without departing from the spirit and scope of the present invention.","In addition, although the embodiments described herein are directed to a data storage array, it will be appreciated by those skilled in the art that the claimed subject matter is not so limited and various other processing systems can be utilized without departing from the spirit and scope of the claimed invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIG. 6","FIG. 3"]},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 7","FIG. 3"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":["FIG. 8","FIG. 3"]},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 9","FIG. 3"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 10","FIG. 3"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 11","FIG. 6"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 12","FIG. 6"],"b":["1","2"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIGS. 14-21"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIGS. 22-29"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 30"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 31","FIG. 4"]}]},"DETDESC":[{},{}]}
