---
title: Method and system for authenticating user of data transfer device
abstract: The invention relates to a method and system for authenticating a user of a data transfer device (such as a terminal in a wireless local area network, i.e. WLAN). The method comprises: setting up a data transfer connection from the data transfer device to a service access point. Next, identification data of the mobile subscriber (for example an MSISDN) are inputted to the service access point. This is followed by checking from the mobile communications system whether the mobile subscriber identification data contains an access right to the service access point. If a valid access right exists, a password is generated, then transmitted to a subscriber terminal (for example a GSM mobile phone) corresponding to the mobile subscriber identification data, and login from the data transfer device to the service access point takes place with the password transmitted to the subscriber terminal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07395050&OS=07395050&RS=07395050
owner: Nokia Corporation
number: 07395050
owner_city: Espoo
owner_country: FI
publication_date: 20021217
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD","BACKGROUND","BRIEF DESCRIPTION","DESCRIPTION OF EMBODIMENTS"],"p":["The invention relates to a method for authenticating a user of a data transfer device and to a system for authenticating a user of a data transfer device.","Prior art knows different methods for authenticating users of data transfer devices. One authentication method is based on the use of a SIM card (Subscriber Identity Module) placed in the data transfer device, the method requiring, however, a smart card reader in the data transfer device. Moreover, the solution is not easy to apply in situations where a data transfer service is to be used temporarily, maybe only once, on the data transfer service, because for that purpose a SIM card would have to be delivered to the data transfer device of the user.","U.S. Pat. No. 6,112,078, which is incorporated herein as a reference, discloses a solution which does not include a SIM card and in which at least some of the authentication data are transmitted to a mobile station or a paging device which the user of the data transfer device has at his\/her disposal. For reasons of data security, all the authentication data, for example the user ID and the password, are not sent over the same the transmission path.","It is an object of the invention to provide an improved method for authenticating a user of a data transfer device and an improved system for authenticating a user of a data transfer device.","One aspect of the invention is a method for authenticating a user of a data transfer device, comprising: setting up a data transfer connection from the data transfer device to a service access point; inputting identification data of a subscriber of a mobile communications system to the service access point; checking from the mobile communications system whether the mobile subscriber identification data contains an access right to the service access point; and, if a valid access right exists, generating a password, transmitting the password to a subscriber terminal corresponding to the mobile subscriber identification data, and logging in to the service access point from the data transfer device using the password transmitted to the subscriber terminal.","Another aspect of the invention is a system for authenticating a user of a data transfer device, comprising: a data transfer device, a service access point that can be linked to the data transfer device over a first data transfer connection, and an authentication server linked to the service access point over a second data transfer connection; the service access point is configured to receive over the first data transmission connection identification data of a subscriber of a mobile communications system inputted from the data transfer device and to transmit the mobile subscriber identification data to the authentication server over the second data transfer connection; the authentication server is configured to check from the mobile communications system over a third data transfer connection whether the mobile subscriber identification data contains an access right to the service access point, and, if a valid access right exists, to generate a password and transmit the password to a subscriber terminal corresponding to the identification data of the subscriber of the mobile communications system; and the data transfer device is configured to use the password transmitted to the subscriber terminal in connection with login to the service access point.","The invention is based on the idea that a data transfer device user is authenticated utilizing the identification data of a subscriber of a mobile communications system. A password, at least, is transmitted to a subscriber terminal corresponding to the mobile subscriber identification data. The mobile subscriber identification data shows that an access right to a desired service access point is provided.","The method and system of the invention provide a number of advantages. The authentication of the data transfer device user does not require any additional equipment or software to be used in the data transfer device, but only access to a subscriber terminal, either through ownership or by borrowing, in a mobile communications system. The solution also functions when the subscriber terminal is roaming. In addition, the solution is convenient for an operator managing a service access point; provisioning does not require the delivery of a SIM card to the user, for example, and yet authentication is in a way based on an existing SIM card placed into a subscriber terminal.",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1","b":"100"},"There are four main parts that can be distinguished: devices  at the user's disposal; a data transfer network  serving the data transfer device , a visited mobile communications system  and a home mobile communications system .","The data transfer network  comprises a Service Access Point (SAP)  that can be linked to the data transfer device  over a first data transfer connection . The service access point  forms what is known as an Access Zone (AZ, also known as a Hotspot) in an office, university campus area, hotel or airport, for example, where local area network connections are being offered to users. Users of portable computers, for example, can thus be provided with a fast broadband service via the access zone. In addition, the data transfer network  comprises an authentication server  connected to the service access point  over a second data transfer connection.","According to an embodiment, the first data transfer connection  is a radio connection. The radio connection  can be implemented by configuring the service access point  to use a Wireless Local Area Network (WLAN) to implement the radio connection . In another embodiment the service access point  comprises a short-range radio transceiver for implementing the radio connection . The short-range radio transceiver may be, for example, a radio transceiver based on the Bluetooth\u00ae technology or a wireless local area network based on IEEE (The Institute of Electrical and Electronics Engineers, Inc.) 802.11 or 802.11b standard.","The role of the service access point  is to function as a port through which the services of the data transfer network  are provided to the data transfer device . If the first data transfer connection  is implemented over a wireless local area network, the service access point  may be a service access point of the wireless local area network, such as a service access point of the type Nokia\u00ae A032 used in a wireless local area network and serving as a wireless Ethernet bridge to the local area network. In that case the service access point  comprises a radio module for implementing radio connections and the necessary equipment and software for encrypting the data on the radio connections. The service access point  may also comprise an external modem that allows a Dial-up Access to be implemented to an Internet Service Provider (ISP), in which case the service access point may comprise a firewall, for example one implemented on the basis of the NAT. (Network Address Translation) technology, for protecting the local network.","In addition, the data transfer network  may comprise an Access Controller (AC)  between the service access point  and the authentication server , the controller serving as a gateway between the access zone and the Internet. It is thus possible to gain access from the data transfer network  through the access controller  to a WWW server (World-Wide Web) with which the data transfer device  can then exchange information after authentication. The access controller  may be a Nokia\u00ae P022 type access controller, for example, which is responsible for user authentication, realtime network monitoring and for collecting accounting data for billing.","According to an embodiment, the authentication server  is an AAA server (Authentication, Authorization and Accounting), which means that the server is not only responsible for user authentication, i.e. for confirming the alleged identity of the user, but also for authorizing the use of the system and for accounting operations carried out for billing the use of the system. The authentication server  may apply an AAA protocol defined by the IETF (Internet Engineering Task Force), such as the Radius protocol (Remote Authentication Dial-In User Service, RADIUS) or the Diameter protocol. In the wireless local area network the authentication server  transfers authentication data and billing data between the data transfer network  and the mobile communications system , .","According to an embodiment, the first data transfer connection  is wired. The data transfer connection may be implemented using any prior art network technology enabling bi-directional wired data transfer between the service access point  and the data transfer device . One example of this type of network technology is a wired local area network based on IEEE 802.3 standard, i.e. an Ethernet standard, and implemented using a coaxial cable or a twisted pair, for example.",{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 1","FIG. 1"],"b":["126","134","106","102","102","134","126","134","126","134"]},"The mobile communications system ,  may be any prior art radio system that allows information to be transferred from a network part of the mobile communications system to a subscriber terminal  connected to the network part over a radio link . The following mobile communications systems can be mentioned as examples: second generation GSM (Global System for Mobile Communications), GSM-based GRPS (General Packet Radio System) that employs 2,5-generation EDGE technology (Enhanced Data Rates for Global Evolution) for increasing data transfer rate or the EGPRS (Enhanced GPRS) and the third-generation mobile communications system known at least by the names IMT-2000 (International Mobile Telecommunications 2000) and UMTS (Universal Mobile Telecommunications System). However, the embodiments are not restricted to these examples, but those skilled in the art will be able to apply the teachings of the invention also to other radio systems having similar characteristics. When necessary, additional information about the mobile communications system in question is available from specifications of the field, for example from those of the GSM system or the UMTS, and from the literature of the art, for example from Juha Korhonen: 32001. ISBN 1-58053-287-X.","The service access point  is configured to receive over the first data transfer connection  the mobile subscriber identification data inputted from the data transfer device  and to transmit the mobile subscriber identification data over a second data transfer connection to the authentication server . According to an embodiment, the identification data of the subscriber of the mobile communications system  consist of a Mobile Subscriber International Integrated Services Digital Network Number (MSISDN), which identifies the subscriber globally and unambiguously because the MSISDN consists of three parts: country code, national network identifier and subscriber number.","The authentication server  is configured to use a third data transfer connection to check from the mobile communications system  whether the subscriber identification data contains an access right to the service access point  and, if a valid access right exists, to generate a password and to transmit the password to the subscriber terminal  corresponding to the identification data of the subscriber of the mobile communications system . The authentication server  may also generate the necessary User Account, if one does not exist already. In connection with login to the service access point , the data transfer device  is configured to use the password delivered to the subscriber-terminal . The password that was generated may be a character string containing letters and\/or numbers and\/or different special characters, for example. The character string may be defined using ASCII codes (American Standard Code for Information Interchange), for example. Login may be performed using for example a WWW dialog or, in accordance with IEEE 802.1x standard, using the dial-in dialog of the operating system of the data transfer device.","The data transfer device  is of a type enabling a bi-directional data transfer connection  to be set up to the service access point . The data transfer device may thus be for example a portable computer provided with an Ethernet card, a Bluetooth\u00ae transceiver, or a card implementing a wireless local area network which may comprise a short-range radio transceiver, for example. One example of a card implementing a local area network is a wireless local area network card of the Nokia\u00ae C110\/C111-type, although it should be noted that the system for user authentication functions without the SIM card reader contained in the cards of this type. Another example is a radio card of the Nokia\u00ae D211-type, which functions in various modes for implementing a data transfer connection, such as: wireless local area network, GPRS and HSCSD (High Speed Circuit Switched Data).","The subscriber terminal  is of a type that enables a wireless data transfer connection to be set up to the mobile communications system . In the UMTS, for example, the subscriber terminal  consists of two parts: Mobile Equipment (ME) and UMTS Subscriber Identity Module (USIM), i.e. a SIM card. The SIM card contains user data and, in particular, data associated with information security, for example an encryption algorithm. In the GSM, the subscriber terminal  naturally uses the SIM card of the GSM system. The subscriber terminal  contains at least one transceiver for setting up a radio connection  to a radio access network or base station system of the mobile communications system .  shows a base station  of the mobile communications system  to which the subscriber terminal  sets up the radio connection . One subscriber terminal  may contain at least two different subscriber identity modules. In addition, the subscriber terminal  contains an antenna, a user interface and a battery. Current subscriber terminals  take diverse forms; they may be vehicle-mounted or portable, for example. Subscriber terminals  have also been provided with characteristics better known from PC's or portable computers. One example of this type of subscriber terminal  is Nokia\u00ae Communicator\u00ae.","In the example of , the devices  that are at the user's disposal, i.e. the data transfer device  and the subscriber terminal , are shown as separate devices, although according to one embodiment they may be located in one and the same physical device, for example in a Nokia\u00ae Communicator-type device, in which the characteristics required of the data transfer device  have been implemented by means of a wireless local area network card, and the characteristics of the subscriber terminal  by means of a mobile subscriber terminal incorporated in the device and a SIM card provided by a mobile operator. In this kind of combination device the processing of the information needed in authentication can be automated for example by transferring the password received at the subscriber terminal  automatically to the log-in dialog of the data transfer device .","According to an embodiment, the authentication server  is configured to transmit the password to the subscriber terminal  in the form of a packet-switched message. In one embodiment the authentication server  is configured to transmit the password to the subscriber terminal  in a Short Message (SM). The short message can be implemented using a Short Message Service (SMS), for example.  shows a Short Message Service Centre (SMSC)  of the mobile communications system , through which centre the short messages are transferred and into which they may be stored if they cannot be delivered immediately to the receiver . In principle the short message service centre  is not a part of the mobile communications system , although it is often integrated into a Mobile Service Switching Centre (MSC). There are also other ways of transmitting a text message, for example by using the Multimedia Messaging Service (MMS). MMS is a new type of service in which the method of transmission corresponds to that of the SMS. An MMS message may, however, contain three different simultaneous elements: text, audio and image.","According to an embodiment, the authentication server  is configured to check the access right to the service access point  by submitting a query to a home location register  of the mobile communications system .  only shows the base station  and the short message service centre  of the mobile communications system ; the rest of the infrastructure is depicted by block . From the infrastructure of the visited mobile communications system  there is a data transfer connection , provided for example by means of signalling system no. 7 (SS7, ITU-T No. 7) of the ITU-T, the telecommunications standardization sector of the International Telecommunications Union, to the home mobile communications system , of which only the Home Location Register (HLR)  is shown, which contains the subscriber parameters of all subscribers of the mobile communications system  permanently stored therein. Since the home location register  is usually at the mobile services switching centre, block  in  also includes the switching centre.","According to an embodiment mentioned earlier, the identification data of the subscriber of the mobile communications system  consist of the mobile subscriber international ISDN number. In that case the authentication server  may be configured to submit a query in which it first searches the home location register  of the mobile communications system  for the International Mobile Subscriber Identity (IMSI) corresponding to the mobile subscriber international ISDN number and then uses the international mobile subscriber identity to search the home location register  of the mobile communications system  for the related subscriber data, where the access right is defined.","According to an embodiment, the system further comprises an accounting server , which is configured to generate the billing data relating to the first data transfer connection  and to transfer the data to the mobile communications system , in which the billing data are formed into a bill associated with the identification data of the subscriber of the mobile communications system . In the example of  we have a situation where the subscriber terminal  is within the area of the visited mobile communications system , in which case the billing data generated at the accounting server  are transferred to an accounting server  of the home mobile communications system . The billing data may be transferred using for example Charging Records (CDR) directed to the IMSI.","According to an embodiment, the service access point  is configured to maintain the first data transfer connection  initially set up between the data transfer device  and the service access point  until login. In other words, in this embodiment the first data transfer connection  is not disconnected at any stage and therefore mere capture of a password by an unauthorized intruder does not create a major data security risk, because the intruder would also have be able to capture the first data transfer connection . The data transfer connection  uses an SSL protocol (Secure Sockets Layer), for example, for authenticating and encrypting TCP (Transmission Control Protocol) connections. Instead of the SSL, a protocol known as TLS (Transport Layer Security) can also be used. The encryption keys to be used may be derived from TLS authentication or simply from the password by means of strong password authentication protocols (such as the Secure Remote Password protocol or Encrypted Key Exchange protocol).","According to an embodiment, the authentication server  is configured to transmit a second password via the service access point  to the data transfer device  over the first data transfer connection , the data transfer device  being configured to also use the second password at login, for example such that the two passwords placed one after the other form the required password. This embodiment ensures that the user offering the second password is the same as the one who used the data transfer device  to order the password to the subscriber terminal .","According to an embodiment, the authentication server  is configured to transmit a confirmation identifier via the service access point  to the data transfer device  over the first data transfer connection  and to transmit the same confirmation identifier to the subscriber terminal  together with the password. This enables the user to compare the two confirmation identifiers received over different data transfer paths and to use the password only if the two confirmation identifiers are the same. With this embodiment the user is assured that the password came to the subscriber terminal  from the source  requested by the user with his\/her data transfer device .","According to an embodiment, the data transfer device  is configured to log in to the service access point  using the mobile subscriber identification data, for example the already mentioned mobile subscriber international ISDN or the international mobile subscriber identity, as a user ID, although the latter may be more difficult for the user to find out than the mobile subscriber international ISDN. An advantage of this embodiment is that the system does not need to transfer the user ID towards the user.","However, embodiments in which the user ID is transferred from the system towards the user are also possible. In such cases the user ID does not need to be originally known by the user but it may be generated at the authentication server , for example. According to an embodiment, the authentication server  is configured to transmit the user ID to the subscriber terminal  corresponding to the identification data of the subscriber of the mobile communications system  and the data transfer device  is configured to use the user ID received at the subscriber terminal  to log in to the service access point . According to an embodiment, the authentication server  is configured to transmit the user ID from the service access point  to the data transfer device  over the first data transfer connection  and the data transfer device  is configured to use the user ID received at the data transfer device  to log in to the service access point .","We have described above how the service access point , authentication server  and data transfer device  are to be configured to enable the system for authenticating the user of the data transfer device  to be implemented. The devices in question comprise control parts controlling their operation, the control parts being currently usually implemented as a processor with the related software, although different hardware implementations are also possible, for example a circuit consisting of separate logic components or one or more Application-specific Integrated Circuits (ASIC). Also a hybrid of these different implementations is possible. When selecting the method of implementing the configuration, a person skilled in the art will take into account for example the requirements set to the size and power consumption of the device, the required processing power, manufacturing costs and production volumes.","With reference to the flow diagram of , the method for authenticating the user of the data transfer device will be described in the following. At the same time, reference is made to the signal sequence diagram of , which illustrates the information transmitted between different network elements in connection with the authentication of the data transfer device user. For the sake of clarity, the service access point  and the service access controller  are combined into a single element in , and internal elements of the visited mobile communications system  and the home mobile communications system are not shown.","The execution of the method starts at , when the user wishes to use the service access point.","At  a data transfer connection is first set up from the data transfer device to the service access point. According to an embodiment, the data transfer connection between the data transfer device and the service access point is a radio connection. According to an embodiment, the radio connection is implemented with a wireless local area network. According to another embodiment, the radio connection is implemented using a short-range radio transceiver. In another embodiment, the data transfer connection between the data transfer device and the service access point is wired. As regards these different methods of implementing the data transfer connection reference is made to the disclosure above.","Next, at  the identification data of the mobile subscriber are inputted  to the service access point. According to an embodiment, the mobile subscriber identification data consist of the mobile subscriber international ISDN. As shown in , the MSISDN  is transmitted from the data transfer device  to the service access point\/service access controller , .","At  the access right of the subscriber identification data to the service access point is then checked from the mobile communications system. According to an embodiment, the checking is made by means of a query sent to the home location register of the mobile communications system. In the embodiment in which the mobile subscriber identification data consist of the mobile subscriber international ISDN, the query can be made as shown in  such that first the home location register of the mobile communications system  is searched for the international mobile subscriber identity (IMSI) corresponding to the mobile subscriber international ISDN by means of a MAP_SEND_IMSI message (MAP=Mobile Application Part protocol) ,  and a REPLY ,  received to the query and then, on the basis of the international mobile subscriber identity, the home location register of the mobile communications system  is searched for the subscriber data, which contains the access right definition, by means of a MAP_RESTORE_DATA message ,  and a REPLY ,  received to it. Since in the example of  the subscriber terminal  is within the area of the visited mobile communications system , the messages to and from the home mobile communications service  travel through the visited system.","At  is then checked whether the mobile subscriber identification data has access right to the service access point. If there is no access right, or it is not valid, the routine proceeds to , which means that no service can be provided to the user through the service access point, and then to  where the execution of the method is terminated.","If a valid access right exists, the routine proceeds from  to  where the password is generated. The routine then proceeds to  where the password is transmitted to the subscriber terminal corresponding to the mobile subscriber identification data. According to an embodiment, the password is transmitted to the subscriber terminal in a packet-switched message. According to another embodiment, the password is transmitted to the subscriber terminal  in a short message SMS , , , , as shown in , starting from the authentication server  and going through the visited mobile communications system , the home mobile communications system  and then again the visited mobile communications system . The embodiment can be modified as described earlier.","Next, at  the service access point is logged in from the data transfer device using the password delivered to the subscriber terminal. In  this is illustrated in the form of a log-in dialog in which the user ID and the password are transmitted from the data transfer device  to the service access point\/service access controller ,  in a LOGIN message , which is further transmitted to the authentication server  in a LOGIN message  to which a REPLY message  is received at the service access point\/service access controller , . Then at  the data transfer device user is able to use data transfer services via the service access point. A service is implemented by transferring SERVICE messages  to and from, as needed, the data transfer device  and the service access point\/service access controller , . Finally when the user switches off the connection from the data transfer device to the service access point, the execution of the method is terminated at .","According to an embodiment, the method further comprises: billing for the data transfer connection between the data transfer device and the service access point in a bill directed to the identification data of the mobile subscriber. As shown in , this may be carried out for example by transferring from the service access point\/service access controller ,  a CDR message ,  containing billing data through the authentication server  to the home mobile communications system .","According to an embodiment, the data transfer connection set up at the beginning between the data transfer device and the service access point is kept until login takes place. This provides the above described advantage of information security.","According to an embodiment, the method further comprises: transmitting a second password from the service access point to the data transfer device over a data transfer connection and using also the second password at login. Also this embodiment enhances information security, as described above.","According to an embodiment, the method further comprises: transmitting from the service access point a confirmation identifier to the data transfer device over the data transfer connection and transmitting the same confirmation identifier together with the password, the password being only used if the received confirmation identifiers are the same. This embodiment has also-been described above.","According to an embodiment, the method further comprises: using the mobile subscriber identification data as a user ID when logging in. According to an embodiment, the method further comprises: transmitting the user ID to the subscriber terminal corresponding to the mobile subscriber identification data and using the transmitted user ID when logging in. According to an embodiment, the method further comprises: transmitting the user ID to the data transfer device over the data transfer connection and using the transmitted user ID when logging in.","The method can be implemented using the system described above with reference to , although other environments are also possible.","According to an embodiment, the visited mobile communications system  is configured to inform the subscriber terminal  that if a roaming of the subscriber terminal in the visited mobile communications system  fulfils a predetermined criterion, a lower charge than usual will be applied to the data transfer connection  from the data transfer device  to the service access point . In addition, the authentication server  is configured to implement the data transfer connection  from the data transfer device  to the service access point  at a lower charge than usual, if the predetermined criterion is met. At first the predetermined criterion may be that the subscriber terminal  contacts the visited mobile communications network  and later the criterion may be that the subscriber terminal  remains in the mobile communications system  it has selected. The purpose of this is to make the user of the roaming subscriber device  to prefer that the subscriber device  use specifically the mobile communications system  managed by the operator in question for the entire duration of the roaming. The use of the mobile communications system  generates income to the operator and thus allows the operator to offer the data transfer connection  to the service access point  at a lower charge, even free of charge in extreme cases, for the duration of the visit.","Next, a method is described that can be used for implementing this kind of roaming that creates customer loyalty. The visited mobile communications system  is informed of a new subscriber terminal  by a location update performed by the subscriber terminal  upon its entry into the coverage area of the base station . Next, an SMS message (SMS=Short Message Service) is sent from the mobile communications system  to the subscriber terminal  to inform that if the user remains in this mobile communications system , the data transfer connection  will be provided free of charge, through a public wireless local area network, for example, to the service access point . In addition, the SMS message may contain instructions informing that if the user wishes to use this service, he\/she should send a reply SMS message from his\/her subscriber terminal  to a specific number. The reply SMS message should be blank or have a predetermined content, such as abbreviation \u201cWLAN\u201d.","If the user is expected to reply with an SMS message, then upon receipt of the message, and otherwise immediately after having sent the message, the visited mobile communications system  informs the authentication server  that data transfer services may be provided free of charge to the user through the service access point . The reply SMS message expected of the user allows to avoid unnecessary loading of the system by users who are not interested in the service in question. The information to the authentication server  can be transmitted in an SMS message sent from the visited mobile communications system , for example. This requires that the authentication server functions as an SME (Short Message Entity) or is capable of receiving a MAP_MT_FORWARD_SHORT_MESSAGE message based on the MAP protocol. The information contains the identifier of the user, such as an MSISDN or IMSI. The authentication server  parses the contents of the SMS message and analyses the identifier of the user.","The authentication server  is thus informed that data transfer services available from the data transfer network  may be provided free of charge to a specific user through the service access point . The authentication server  then creates a user ID for the user, such as an MSISDN or IMSI. In addition, a password is created. The user ID and the password may be delivered to the user as described above, although other suitable prior art methods for implementing authentication may possibly also be used. At the same time, it is possible to submit additional information to the user. The use provided free of charge may at first cover a predetermined period, for example fifteen minutes. The user ID is activated if the user uses it for logging in to the service access point . The contents of the user ID may include the following:","user ID: +35840123456","password: qwertyiop","time: 90 minutes","created: 19102002;09:16:48","valid: 29102002;09:16:48","service quality: low","billing: NULL","time release of session: 900 seconds.","The duration of the service provided free of charge to the user through the data transfer network  may be extended if the subscriber terminal  of the user continues roaming in the mobile communications system  for a predetermined period. A convenient way to check whether roaming continues is to send a period query to this effect, one or twice an hour, for example, to the home location register  of the home mobile communications system  of the subscriber terminal . The query may be implemented using a MAP_SEND_ROUTING_INFO_FOR_SM message of the MAP protocol, for example, which is replied by a SEND_ROU_FOR_SM message containing the PLMN address (Public Land Mobile Network) of the serving mobile services switching centre. If this address belongs to the same mobile communications system as the service access point, it is concluded that roaming continues. The session of the data transfer device  at the service access point  may be terminated either by the user or by the service access point, which switches off the connection when the time provided free of charge runs out. The user ID may be deleted from the authentication server  after a predetermined time, for example a month, or when it is detected that the user of the subscriber terminal  has terminated the roaming.","In  the arrangement  of this kind of lower charge data transfer connection takes place before the described authentication. The procedure of block  is not necessarily needed if the authentication server has received information from the visited mobile communications system stating that a data transfer connection to the service access point may be provided at a lower charge than usual for the data transfer device of the user of the subscriber terminal. The predetermined criterion is met if the subscriber terminal contacts the visited mobile communications system and\/or if the roaming by the subscriber terminal in the visited mobile communications system continues for a predetermined time. That the predetermined criterion is met can be checked by means of a period query made to the home location register of the home mobile communications system of the subscriber terminal; although the execution of the method shown in  may have been terminated at this point already, the user can be provided with a service at lower charge the next time he\/she logs in from his\/her data transfer device to the service access point. The procedures of blocks , ,  and  do not necessarily have to be carried out in connection with a subsequent login, unless the operator wishes to change the password.","Although the invention is described above with reference to an example based on the accompanying drawings, it is apparent that the invention is not restricted to it but may be varied in many ways within the scope of the inventive idea disclosed in the accompanying claims. It is to be noted, in particular, that the names of the network elements and the distribution of their functionalities may vary, because, after all, it is merely a question of the desired degree of integration of the network elements and the size of the data transfer network : in large networks a network element may be dedicated to specific tasks only, whereas in small networks one network element may carry out a plural number of functions, which in  are shown separately."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"LIST OF FIGURES","p":["In the following the invention will be described in greater detail with reference to the preferred embodiments and the accompanying drawings, in which",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
