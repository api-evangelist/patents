---
title: Updating trusted root certificates on a client computer
abstract: An update process is used to update root certificates in a root certificate store of a client computer, maintaining the integrity of the existing root certificates as well as any new root certificates. In accordance with certain aspects, the integrity of a certificate trust list identifying one or more root certificates is verified. The root certificate store of the client computer is modified in accordance with the certificate trust list if the integrity of the certificate trust list is verified.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07143165&OS=07143165&RS=07143165
owner: Microsoft Corporation
number: 07143165
owner_city: Redmond
owner_country: US
publication_date: 20041018
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","CONCLUSION"],"p":["This application is a continuation of U.S. patent application Ser. No. 09\/542,669, filed Apr. 4, 2000, entitled \u201cUpdating Trusted Root Certificates On A Client Computer\u201d to Keith R. Vogel, Charlie D. Chase, Kelvin S. Yiu, Philip J. Hallin, and Louis K. Thomas, now U.S. Pat. No. 6,816,900 which claims the benefit of U.S. Provisional Application No. 60\/174,420, filed Jan. 4, 2000, entitled \u201cUpdating Trusted Roots\u201d to Keith R. Vogel, Charlie D. Chase, Kelvin S. Yiu, and Philip J. Hallin.","This invention relates to supporting secure network connections, and more particularly to updating trusted root certificates on a client computer.","Computer technology is continually advancing, resulting in continually evolving uses for computers. One such use is communicating with other computers over a network, such as the Internet, to obtain or exchange information, purchase or sell goods or services, etc. To assist in such communication, the Internet supports the \u201cWorld Wide Web\u201d, which is a collection of facilities that links together documents (each referred to as a \u201cweb page\u201d). Web pages can be located on the same server or distributed among multiple servers worldwide.","The uses for the Internet and the World Wide Web are continually increasing, and have expanded into \u201csecure\u201d areas. Maintaining security in a large public network such as the Internet can be a difficult task. Different mechanisms for maintaining security have been developed, such as the Secure Sockets Layer (SSL) security protocol. The SSL protocol uses a public key infrastructure to maintain security. In establishing an SSL connection between a client computer and a server computer hosting a web page, the server computer transmits a certificate to the client computer for verification. If a trusted certifying authority has approved the server computer (or web page) for secure connections, then a root certificate that is maintained at the client and issued by a root certifying authority (CA) will verify the certificate received from the server.","Currently, many different certifying authorities exist and new certifying authorities are continually being established. The root certificates maintained at the client computer are typically included as part of an application, such as a web browser (which allows a user to access web pages) or an operating system. Problems arise with the use of root certificates because new certifying authorities are being established that would like to include new root certificates at the client computers, or existing certifying authorities may want to add new root certificates, after the application has been distributed to consumers. However, adding new root certificates to an application that has already been distributed to consumers can be a difficult and cumbersome process.","One solution to this problem is to re-distribute the application including the root certificates (e.g., a web browser or operating system) each time a new root certificate is to be added. However, this is cumbersome on both the application developer and distributors as well as the consumer because new versions would have to be continually distributed (e.g., changes in root certificates could occur as frequently as weekly or daily), and the consumer would be required to install each new version of the application. Such continual installation is burdensome on the consumer, particularly since the consumer may not actually use the new certificates.","Another solution to this problem is to require the user to manually install new root certificates. However, this solution is also burdensome on the consumer because the consumer is required to know that he or she needs a new certificate, as well as how to obtain such a certificate, verify the integrity of the certificate, and proceed with manually adding the certificate to his or her computer. Such manual installation is unlikely to be attempted, much less successful, by anyone except the most experienced users.","Thus, it would be beneficial to provide a more user-friendly way in which root certificates at a client computer can be updated. The updating of trusted root certificates on a client computer described below addresses these disadvantages, providing a more user-friendly approach to updating root certificates.","Updating trusted root certificates on a client computer is described herein. An update process is used to update the root certificates on the client computer, allowing the integrity of existing root certificates as well as any new root certificates to be maintained.","According to one aspect of the invention, a root certificate store on the client computer is updated by adding trusted root certificates to the store, removing root certificates from the store, or modifying usage restrictions of root certificates in the store. A cryptographically signed message including a certificate trust list, as well as any new root certificates to be added to the store, is accessed by an update root control to update the root certificates in the store. The certificate trust list includes a subject usage indication indicating that the certificates identified by the list are root certificates, and a set of one or more hash values that correspond to the root certificates being updated. The certificate trust list may also optionally include one or more hash attributes corresponding to the hash values. These hash attributes can indicate whether the root certificate corresponding to the hash value is to be added to the store, removed from the store, or what modifications are to be made to the root certificate in the store.","According to another aspect of the invention, during the update process the update root control obtains the cryptographically signed message and a signer certificate from the signer of the message. The control verifies the integrity of the message, and thus the integrity of the certificate trust list contained therein, by establishing a certificate chain from the signer certificate to a root certificate in the client's root certificate store. Once such integrity is verified, the update root control proceeds to update the root certificate store in accordance with the information in the certificate trust list. The update root control can further use the hash values in the certificate trust list to verify the integrity of root certificates in the signed message, as well as verify which root certificates in the root certificate store are to be removed or modified.","According to another aspect of the invention, root certificates in the client's root certificate store are updated when a World Wide Web web page is accessed by the client. A check is made during the access as to whether the client's root certificate store should be updated (e.g., a new root certificate is needed in order to access the web page). If the store should be updated, then the client is redirected to another web page that hosts the update root control. The update root control executes to update the client's certificate store, and then redirects the client back to the originally requested web page.","The discussion herein assumes that the reader is familiar with cryptography. For a basic introduction of cryptography, the reader is directed to a text written by Bruce Schneier and entitled \u201cApplied Cryptography: Protocols, Algorithms, and Source Code in C,\u201d published by John Wiley & Sons with copyright 1994 (or second edition with copyright 1996).","In the discussion below, embodiments of the invention will be described in the general context of computer-executable instructions, such as program modules, being executed by one or more conventional personal computers. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Moreover, those skilled in the art will appreciate that various embodiments of the invention may be practiced with other computer system configurations, including hand-held devices, gaming consoles, multiprocessor systems, microprocessor-based or programmable consumer electronics, network PCs, minicomputers, mainframe computers, and the like. In a distributed computer environment, program modules may be located in both local and remote memory storage devices.","Alternatively, embodiments of the invention can be implemented in hardware or a combination of hardware, software, and\/or firmware. For example, all or part of the invention can be implemented in one or more application specific integrated circuits (ASICs).",{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 1","FIG. 1"],"b":["102","104","106","106"]},"Each network server computer  hosts one or more World Wide Web web pages  that can be accessed by a web browser  or other application executing at a client computer . For ease of explanation, web browser  will be described as accessing web pages . However, those skilled in the art will appreciate that other applications executing on client computer  could analogously access web pages . Web browser  can establish a secure connection with one of server computers  using a secure communications protocol which relies on the existence of a trusted root certificate at client computer , such as SSL.","Each client computer  also maintains a root store  that includes one or more trusted root certificates  (also referred to as simply \u201croots\u201d). Root store  can be implemented, for example, as part of web browser  or part of an operating system  or some other application (not shown) executing on client . To establish a secure connection between a client computer  and a server computer , server computer  transmits a server certificate to the client computer . Client computer  uses the server certificate to verify that server computer  can be trusted. In order to be trusted, the server certificate must be cryptographically signed (directly or indirectly) by a trusted certifying authority having a trusted root certificate in root store .","Client computer  maintains a root certificate  for each certifying authority that client computer  trusts. Each root certificate  is a self-signed certificate that is implicitly trusted by client computer . Upon receipt of the server certificate, client computer  attempts to establish a \u201cchain\u201d of certificates from the server certificate up to one of the trusted root certificates . This chain may include one or more \u201cintermediate\u201d certificates. Each certificate in the chain will have a \u201cparent\u201d certificate that can cryptographically verify the authenticity of the certificate. Eventually, the chain leads back to a parent certificate that is one of the trusted root certificates . If such a certificate chain can be established by client computer , then the server computer  which transmitted the server certificate is verified as being trusted and a secure connection to the server computer can be established. However, if such a certificate chain cannot be established, then the server computer is not trusted and a secure connection to the server computer cannot be established.","Root store  is part of a software application (e.g., web browser  or an operating system). Root certificates  are established in root store  during development of the application. Additionally, as discussed in more detail below, additional root certificates  can be automatically added to root store  after the application has been developed, deployed and installed on client computers .","Each root certificate  may optionally include one or more usage parameters. These usage parameters are used to limit the manner in which the root certificate can be used. For example, a particular root certificate may have its usage limited to only verifying electronic mail (email) messages. Thus, that particular root certificate could not be used as a trusted root certificate in a certificate chain for establishing a secure connection to server computer . In the illustrated example, the usage parameters are denoted by properties, policy extensions, and\/or an enhance key usage (EKU) extension that are part of, or alternatively associated with, the certificate.","One or more of web pages  may also include an update root control . If a web page  is accessed by web browser  of client computer  the browser may be redirected to another web page  (hosted on the same or different server ) that includes update root control . Browser  may be redirected for a variety of different reasons, such as failure to establish a secure connection with server  because client computer  could not establish a certificate chain to a trusted root certificate , a desire by the web page author to modify usage parameters of a root certificate , a desire by the web page author to delete a root certificate  from root store , etc. Alternatively, update root control  may be included as part of the web page initially accessed by browser , thereby avoiding the re-direction to another web page. The updating of root certificates on client computer  and the use of update root control  are described in more detail below.",{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 2","FIG. 1"],"b":["142","142","104","102","142","144","146","148","146","144"]},"The bus  represents one or more of any of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, and a processor or local bus using any of a variety of bus architectures. The system memory includes read only memory (ROM)  and random access memory (RAM) . A basic input\/output system (BIOS) , containing the basic routines that help to transfer information between elements within computer , such as during start-up, is stored in ROM . Computer  further includes a hard disk drive  for reading from and writing to a hard disk, not shown, connected to bus  via a hard disk driver interface  (e.g., a SCSI, ATA, or other type of interface); a magnetic disk drive  for reading from and writing to a removable magnetic disk , connected to bus  via a magnetic disk drive interface ; and an optical disk drive  for reading from or writing to a removable optical disk  such as a CD ROM, DVD, or other optical media, connected to bus  via an optical drive interface . The drives and their associated computer-readable media provide nonvolatile storage of computer readable instructions, data structures, program modules and other data for computer . Although the exemplary environment described herein employs a hard disk, a removable magnetic disk  and a removable optical disk , it should be appreciated by those skilled in the art that other types of computer readable media which can store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, random access memories (RAMs) read only memories (ROM), and the like, may also be used in the exemplary operating environment.","A number of program modules may be stored on the hard disk, magnetic disk , optical disk , ROM , or RAM , including an operating system , one or more application programs , other program modules , and program data . Operating system  can be any of a variety of operating systems, such as any of the \u201cWindows\u201d family of operating systems available from Microsoft Corporation of Redmond, Wash. A user may enter commands and information into computer  through input devices such as keyboard  and pointing device . Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are connected to the processing unit  through an interface  (e.g., a serial port interface) that is coupled to the system bus. A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video adapter . In addition to the monitor, personal computers typically include other peripheral output devices (not shown) such as speakers and printers.","Computer  can optionally operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be another personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet. In the described embodiment of the invention, remote computer  executes an Internet Web browser program such as the \u201cInternet Explorer\u201d Web browser manufactured and distributed by Microsoft Corporation of Redmond, Wash.","When used in a LAN networking environment, computer  is connected to the local network  through a network interface or adapter . When used in a WAN networking environment, computer  typically includes a modem  or other means for establishing communications over the wide area network , such as the Internet. The modem , which may be internal or external, is connected to the system bus  via a serial port interface . In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in the remote memory storage device. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Computer  can also optionally include one or more broadcast tuners . Broadcast tuner  receives broadcast signals either directly (e.g., analog or digital cable transmissions fed directly into tuner ) or via a reception device (e.g., via an antenna or satellite dish (not shown)).","Generally, the data processors of computer  are programmed by means of instructions stored at different times in the various computer-readable storage media of the computer. Programs and operating systems are typically distributed, for example, on floppy disks or CD-ROMs. From there, they are installed or loaded into the secondary memory of a computer. At execution, they are loaded at least partially into the computer's primary electronic memory. The invention described herein includes these and other various types of computer-readable storage media when such media contain instructions or programs for implementing the steps described below in conjunction with a microprocessor or other data processor. The invention also includes the computer itself when programmed according to the methods and techniques described below. Furthermore, certain sub-components of the computer may be programmed to perform the functions and steps described below. The invention includes such sub-components when they are programmed as described. In addition, the invention described herein includes data structures, described below, as embodied on various types of memory media.","For purposes of illustration, programs and other executable program components such as the operating system are illustrated herein as discrete blocks, although it is recognized that such programs and components reside at various times in different storage components of the computer, and are executed by the data processor(s) of the computer.","Returning to , update root control  can update the root store  in a client computer . This updating can include adding new root certificates  to root store , deleting root certificates  from root store , and modifying usage restrictions of root certificates . In order to update the root store  the root certificates to be updated, along with what type of updating is to take place, are identified in a message that is cryptographically signed by a trusted party. This trusted party can be, for example, the author and\/or manufacturer of the application containing root store  (e.g., the author of the web browser  or operating system ).","In the illustrated example, root control  is an ActiveX control that is hosted on a web page maintained at a network server  of . When the web page is accessed, root control  is copied to and executed by client computer . Alternatively, root control  can be implemented in different manners, such as another type of control rather than an ActiveX control, as an application or control executing on network server , as code resident on client computer , etc.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 3","b":["212","214","216"]},"Signed message  includes a new root certificate  for each new root certificate that is to be added to root store  of a client computer  of . If a root certificate is to be removed from root store , or the usage restrictions of a root certificate are to be changed, then the root certificate may optionally be excluded from message .","In one embodiment, signed message  is a cryptographically signed message in accordance with the Public-Key Cryptography Standards (PKCS) #7 standard. Additional information regarding PKCS #7 is available from RSA Data Security, Inc. of Bedford, Mass. Alternatively, other types of cryptographically signed messages can be used.","Certificate trust list  includes a subject usage indication , one or more hash values , and optionally one or more hash attributes . Subject usage indication  indicates the default usage restrictions for the root certificates in certificate trust list . For example, subject usage indication  may contain client authentication and server authentication usage restrictions. A hash value  is included for each root certificate that is to be updated. The hash value  is generated using any of a wide variety of conventional one-way functions, such as the Secure Hash Algorithm-1 (SHA-1). A one-way hash function is a mathematical function that, given input data (e.g., a root certificate), generates an output hash value. The one-way hash function is chosen such that it is conjectured to be infeasible, knowing the one-way hash function and given a particular hash value, to find the input data that produces the particular hash value. The one-way hash function being used is made publicly known, allowing the input data to be verified given the hash value.","The hash value  allows update root control  of  to verify that a root certificate  to be added to root store  has not been altered since being signed. Control , when adding a root certificate  to root store , can apply the same one-way function to root certificate  as was applied to generate the corresponding hash value . If the root certificate  has not been altered, then the hash value generated by control  is the same as hash value . However, if the hash value generated by control  is not the same as hash value , then control  knows that the root certificate  has been altered and control  will not add the certificate to root store .","Similarly, the hash value  allows update root control  to verify which certificate in root store  is to be removed or modified (e.g., its usage restrictions changed). Control  generates hash values for the root certificates  in root store  and compares the generated hash values to the hash value . When a match is found, control  removes or modifies the corresponding root certificate  based on hash attribute(s) , as discussed in more detail below.","Certificate trust list  may optionally include one or more hash attributes  corresponding to each hash value . These hash attributes are extensions to the certificate trust list  that identify whether the corresponding root certificate is to be added to or deleted from root store  of a client computer  of , or whether the usage restrictions of the corresponding root certificate are to be modified, and if so how they are to be modified.","In one embodiment, update root control  performs the same operation for all of the root certificates identified in message . For example, all of the root certificates identified in message  are added to root store , all of the root certificates identified in message  are deleted from root store , the usage restrictions of all of the root certificates identified in message  are modified in the same manner, etc. Alternatively, different operations may be performed for different root certificates as indicated by the corresponding hash attributes .","Message  is cryptographically signed by a trusted party, which is typically the author and\/or manufacturer of the application that includes root store . Message  can be cryptographically signed in any of a wide variety of conventional manners. In one implementation, the trusted party that signs message  has a public key\/private key pair (e.g., in accordance with either of the well-known Rivest-Shamir-Adleman (RSA) or Elliptic Curve Cryptography (ECC) encryption schemes). The private key is kept secret by the trusted party while the public key is made available to anyone wishing to verify signatures from the trusted party. The public key is typically made available as a certificate (referred to herein as the signer's certificate).","A message can be cryptographically signed by the trusted party by applying a conventional hash algorithm along with the private key to message  to generate a digital signature. This digital signature is forwarded to the intended recipient along with message . The digital signature can then be verified by the recipient applying the known hash function to the received message  and comparing this generated hash value to the decrypted digital signature. If the two hash values match, then the recipient is ensured that the trusted party did in fact sign message  and that message  has been unaltered since it was signed.","Update root control  of  further verifies the integrity of certificate trust list  by verifying that the party signing message  is in fact the party it claims to be (and a party to be trusted by client ). A signer certificate corresponding to the party signing message  is made available to control  (e.g., the signer certificate may accompany message ). This signer certificate includes a public key which can be used by control  in a conventional manner to verify that the party did in fact sign message . The verification process performed by control  is referred to as generating a \u201ccertificate chain\u201d or \u201ccertificate path\u201d from the signer certificate back up to a trusted root certificate  on client . In one implementation, the certificate chain is generated using the Cryptographic Application Programming Interface (CryptoAPI), available from Microsoft Corporation of Redmond, Wash.","In one embodiment, an Application Programming Interface (API) is used to verify that a certificate trust list is a signed list of root certificates. This API is defined as follows:",{"@attributes":{"id":"p-0053","num":"0052"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"I_CertVerifySignedListOfTrustedRoots("]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"77pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"\u2003\u2002\u2009IN const BYTE","*pbCtlEncoded,"]},{"entry":[{},"\u2003\u2002\u2009IN DWORD","cbCtlEncoded,"]},{"entry":[{},"\u2003\u2002\u2009OUT BOOL","*pfRemoveRoots,"]},{"entry":[{},"\u2003\u2002\u2009OUT HCERTSTORE","*phRootListStore,"]},{"entry":[{},"\u2003\u2002\u2009OUT PCCERT_CONTEXT","*ppSignerCert"]},{"entry":[{},"\u2003\u2002\u2009);"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"For a successfully verified CTL: (1) TRUE is returned; (2) *pfRemoveRoots is set to FALSE to add roots and is set to TRUE to remove roots; (3)*phRootListStore is a certificate store containing only the roots to add or remove. *phRootListStore should be closed by calling CertCloseStore( ). For added roots, the CTL's SubjectUsage field is set as CERT_ENHKEY_USAGE_PROP_ID on all of the certificates in the store; (4) *ppSignercert is a pointer to the certificate context of the signer. *ppSignerCert should be freed by calling CertFreeCertificateContext( ).","For a CTL that is not verified, FALSE is returned with *phRootListStore and *ppSignerCert set to NULL.",{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 4","b":["232","232","234","234","232","234","232"]},"CA certificate  indicates that it has a parent certificate which is trusted party root certificate  (alternatively, there may be additional intermediate certificates between CA certificate  and root certificate ). Trusted party root certificate  is one of root certificates  in root store  of client  of . Trusted party root certificate  is installed on client  by the trusted party, as discussed above. The trusted party signs itself as well as the CA certificate . Thus, trusted party root certificate  is trusted as it is installed in root store . Similarly, trusted party root certificate  is used to verify CA certificate .","Thus, a chain is established from signer certificate  up to a root certificate in root store , thereby allowing update root control  to verify the integrity of signed message  of .",{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 5","FIG. 5","FIG. 1","FIG. 5","FIGS. 1 and 3"],"b":"118"},"Initially, update root control  traverses a certificate chain to verify the integrity of the signer of a certificate trust list (act ). Next, it extracts the public key from the signer certificate to verify the signature of the certificate trust list (act ). If the integrity of the signer or the signature of the certificate trust list cannot be verified, then the updating process fails (act ) and ends (act ). However, if the integrity of the signer and the signature of the certificate list are verified, then a hash value corresponding to a root certificate is extracted from the certificate trust list (act ).","Control  then verifies the hash value for the root certificate (act ), thereby verifying which root certificate is to be updated and, in the case of adding a root certificate, that the root certificate has not been altered. Control  then accesses the certificate attributes in the certificate trust list (act ) to determine what type of updating should be performed for the root certificate. In the illustrated example, the updating includes one of adding a root certificate, removing a root certificate, or modifying a root certificate.","If a new root certificate is to be added to the root store, then the root certificate included in the same message as the certificate trust list that corresponds to the hash value extracted in act  is installed at the client computer  (act ). The root certificate is installed by copying the root certificate from the message to root store  of client computer .","If a root certificate is to be removed from the root store, then the root certificate in root store  corresponding to the hash value extracted in act  is identified and deleted from root store  (act ). Alternatively, rather than deleting the root certificate from root store , the root certificate may be left in root store  but labeled as \u201cexpired\u201d or \u201cinvalid\u201d.","If a root certificate is to be modified, then the root certificate in root store  corresponding to the hash value extracted in act  is identified and its restrictions altered in accordance with the hash value attributes in the certificate trust list (act ). This alteration can include adding restrictions, removing restrictions, replacing restrictions, etc. Note that this alteration is performed based on the hash value attributes \u2014the root certificates  are digitally signed and thus cannot be altered to include such attributes.","Regardless of what type of updating is performed, when the updating is completed update control  checks whether there are additional hash values to be extracted from the list (act ). If there are additional hash values to be extracted, then control  returns to act  to extract another hash value. However, if there are no additional hash values to be extracted, then the updating process ends (act ).",{"@attributes":{"id":"p-0066","num":"0065"},"figref":["FIG. 6","FIG. 6","FIG. 1","FIG. 6","FIG. 1"],"b":"118"},"Initially, a user attempts to access a web page which requires a trusted root certificate that the client computer does not have (act ). This requested web page redirects the client web browser  to a new web page that hosts update root control  (act ). This redirection may be direct to the web page hosting control , or alternatively may be indirect (e.g., passing through one or more intermediate web pages). Update root control  is executed at client  (or alternatively at server ) and is passed a parameter by the new web page that specifies a uniform resource locator (URL) of a certificate trust list (act ). The URL specified by the new web page is the location where a certificate trust list resides that includes the necessary root certificates to be added to root store  of client computer .","The update root control  then obtains (act ) and verifies the integrity of (act ) the certificate trust list. If the integrity of the certificate trust list cannot be verified, then the update process fails (act ) and ends (act ). However, if the integrity of the certificate trust list can be verified, then update root control  installs the new root certificates in root store  (act ). Update root control  then redirects browser  (either directly or indirectly) to the web page originally requested in act  (act ).","Although the process of  illustrates adding new root certificates, root certificates can be removed or modified in an analogous manner. For example, when a particular web page is accessed, a request may be sent by an additional control hosted on the web page for the usage restrictions of certain root certificates in root store . A check can then be made as to whether any of the usage restrictions on the root certificates should be changed, and the appropriate changes made. By way of another example, a request may be sent by an additional control hosted on the web page for whether a particular root certificate exists (or is still valid) in root store , and the root certificate removed if it is present (or still valid).","Alternatively, the web page that is initially attempted to be accessed by the user in act  may host the update root control. In such situations, the browser does not need re-directing to another web page, but rather is directed to the update root control on that web page. Similarly, the update root control may be resident on the client computer from which the access attempt in act  is received. In such situations, the browser does not need re-directing to another web page, but rather is directed to the resident update root control (alternatively, the update root control may reside on the client computer as a web page, resulting in the browser being directed to another web page, but a web page maintained by the client computer rather than a server).","By performing an automatic updating process as illustrated in , root certificates can be updated in a more user-friendly manner. The user need not actively search out new root certificates. Rather, when a web page is accessed that requires a new root certificate, the process of  automatically installs such a certificate in the root store of the user's computer.","Thus, updating trusted root certificates on a client computer has been described. A certificate trust list identifies root certificates and how to use them to update a root certificate store (e.g., addition, removal, or modification of root certificates). The certificate trust list is advantageously included in a cryptographically signed message, allowing the integrity of the certificate trust list to be verified by establishing a certificate chain from the signer's certificate to a root certificate in the root certificate store. Additionally, the update process can advantageously be automatically initiated when a web page is accessed by a client computer, with the client computer being automatically redirected to another web page hosting a control to update the root certificates at the client computer.","Although the description above uses language that is specific to structural features and\/or methodological acts, it is to be understood that the invention defined in the appended claims is not limited to the specific features or acts described. Rather, the specific features and acts are disclosed as exemplary forms of implementing the invention."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention is illustrated by way of example and not limitation in the figures of the accompanying drawings. The same numbers are used throughout the figures to reference like components and\/or features.",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
