---
title: Method and system for communications between different types of devices
abstract: A communications system includes a packet-based data network coupled to various network elements, including a gateway that provides ports to various peripheral devices. One type of peripheral device includes a Universal Serial Bus (USB) device. A network element coupled to the data network may establish Session Initiation Protocol (SIP) sessions with the gateway. Once a SIP session is established, communications may occur between the network element and the peripheral device. SIP messaging is exchanged between the network element and the gateway. USB commands and data are exchanged between the gateway and the USB device. The gateway converts between the SIP messaging and the USB commands and data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06965614&OS=06965614&RS=06965614
owner: Nortel Networks Limited
number: 06965614
owner_city: St. Laurent
owner_country: CA
publication_date: 20000424
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This is a continuation-in-part of U.S. patent application Ser. No. 09\/439,501, entitled \u201cLocal Area Network Accessory for Integrating USB Connectivity in Existing Networks,\u201d filed Nov. 12, 1999.","The invention relates to communications between different types of devices, and more particularly, to converting data between different protocols in communications between the different types of devices.","Data networks are widely used to link various types of network elements, such as personal computers, servers, gateways, network telephones, and so forth. Data networks may include private networks (such as local area networks or wide area networks), and public networks (such as the Internet). Popular forms of communications between network elements across such data networks include electronic mail, file transfer, web browsing, and other exchanges of digital data.","With the increased capacity and reliability of data networks, voice and multimedia communications (including telephone calls, video conferencing, and so forth) over data networks have become possible. Voice and multimedia communications over data networks are unlike voice and multimedia communications in a conventional circuit-switched network such as the public switched telephone network (PSTN), which provides users with dedicated, end-to-end circuit connections for the duration of each call. Communications over data networks, such as IP (Internet Protocol) networks, are performed using packets or datagrams that are sent in bursts from a source to one or more destination nodes. Voice data, and other forms of multimedia streaming data sent over a data network typically share network bandwidth with conventional non-streaming data (e.g., data associated with electronic mail, file transfer, web access, and other traffic).","Various standards have been proposed for audio and multimedia communications over data networks. One such standard is the H.323 Recommendation from the International Telecommunications Union (ITU), which describes terminals, equipment and services for multimedia communications over data networks. Another standard for audio and multimedia communications is the Session Initiation Protocol (SIP), which establishes, maintains, and terminates multimedia sessions over a data network. SIP is part of a multimedia data and control architecture developed by the Internet Engineering Task Force (IETF).","A communications network may include a collection of different types of terminals, such as terminals coupled to packet-based networks (e.g., computers, network telephones, etc.) and terminals coupled to circuit-switched networks (e.g., standard analog or digital telephones). Inter-operation between different types of terminals may be possible, and may be accomplished by use of some type of a gateway, such as a PSTN gateway, which converts between packet-based data and circuit-switched data in a call session.","Although improvements in technology have improved inter-operability between certain different types of devices (such as packet-based telephony devices and circuit-switched telephony devices), a need continues to exist for providing inter-operability among other combinations of devices. For example, a computer system may be coupled to many different types of peripheral devices. One type of computer peripheral device is the Universal Serial Bus (USB) device, which may include a printer, scanner, camera, telephone, keyboard, mouse, joystick, or another type of peripheral device. Although peripheral devices coupled to a computer system may be readily available to a user of the computer system, it may not be available remotely.","In general, according to one embodiment, a method of communications between a first device and a peripheral device coupled over a network includes receiving, by a system, a message from the first device to establish a communications session with the peripheral device. The message is according to a first protocol defining real-time interactive sessions. A communications session is established between the first device and the system over a network. The system converts between data according to the first protocol and data according to a second protocol defining a peripheral link from the system to the peripheral device.","Advantages offered by some embodiments of the invention may include one or more of the following. By providing the ability of a first device (such as a telephony device or other device capable of participating in streaming communications sessions) to communicate with a peripheral device, inter-operability between such devices may be achieved. Thus, for example, a SIP or H.323 device may be used to access the functionality of another type of device, such as a computer peripheral device (e.g., a Universal Serial Bus device). This enables access by a remote user of the many functionalities provided by peripheral devices.","Other features and advantages will become apparent from the following description, from the drawings, and from the claims.","In the following description, numerous details are set forth to provide an understanding of the present invention. However, it will be understood by those skilled in the art that the present invention may be practiced without these details and that numerous variations or modifications from the described embodiments may be possible. For example, although reference is made to the Session Initiation Protocol (SIP) in some described embodiments, other embodiments may employ other protocols for real-time interactive sessions over packet-based data networks.","Referring to , a communications system  in accordance with one embodiment includes a packet-based data network  over which various communications sessions may be established. The packet-based data network  may be a packet-switched network, such as an Internet Protocol (IP) network. One version of IP is described in Request for Comments (RFC) 791, entitled \u201cInternet Protocol,\u201d dated September 1981. Other versions of IP, such as IPv6, or other connectionless, packet-switched standards may also be utilized in further embodiments. A version of IPv6 is described in RFC 2460, entitled \u201cInternet Protocol, Version 6 (IPv6) Specification,\u201d dated December 1998.","Packet-switched networks are based on a connectionless internetwork layer. Unlike circuit-switched networks, which provide a dedicated end-to-end connection or physical path for the duration of a call session, a packet-switched network is one in which the same path may be shared by several network elements. Packets or other units of data injected into a packet-switched data network may travel independently over any path (and possibly over different paths) to a destination point. The packets may even arrive out of order. Routing of the packets is based on one or more addresses carried in each packet.","The packet-based network  may also be connection-oriented, such as an ATM (Asynchronous Transfer Mode) network or a Frame Relay network. In a connection-oriented, packet-based network, a virtual circuit or connection is established between two end points. In such connection-oriented networks, packets are received in the same order in which they were transmitted.","The data network  is coupled to various network elements , , , and , which may be capable of establishing communications sessions on the data network  according to a Session Initiation Protocol (SIP). The data network  may also be coupled through a network cloud  (which may be a public network such as the Internet or a private wide area network) to another network element  that is also capable of performing SIP communications. A \u201cdata network\u201d or \u201cnetwork\u201d may refer to one or more communications networks, links, channels, or paths (wired, wireless, or both), as well as systems or devices (e.g., routers) used to route data between elements through such networks, links, channels, or paths. In the ensuing discussion, reference to \u201cdata network \u201d may refer to the combination of the data network , the network cloud , and other networks. In other embodiments, the various network elements coupled to the data network  may be capable of H.323 or other forms of streaming communications.","As used here, a \u201ccall session\u201d or \u201cstreaming call session\u201d refers generally to either an audio (e.g., voice) or a multimedia session in which streaming data is being communicated between two or more network elements (and parties using those elements) coupled to the data network  (or any other packet-based data network). A \u201ccommunications session\u201d may more generally refer to streaming call sessions as well as other types of communications in which any type of data may be exchanged.","An \u201cinteractive\u201d call session refers to a call session in which two or more parties are involved in an exchange of audio (e.g., voice) and\/or video data in an established session between two or more network elements. A \u201creal-time\u201d interactive call session refers to an exchange of data, such as audio and\/or video data, on a substantially real-time basis between two terminals. A session is substantially real-time if interaction is occurring between two end points or parties, with a communication from one end followed relatively quickly by a response or another communications from the other end, typically within seconds, for example. Interactive call sessions are contrasted with electronic mail messaging, for example, in which a first participant sends a message over a data network to a second participant. No indication is usually provided back to the first participant that the second participant has received the message or that the second participant is even at his or her terminal. In contrast, an interactive call session involves a request followed by some acknowledgment that a called party has accepted the call session. This enables establishment of an interactive call session in which participants exchange data.","SIP is part of the multimedia data and control architecture from the Internet Engineering Task Force (IETF). A version of SIP is described in RFC 2543, entitled \u201cSIP: Session Initiation Protocol,\u201d dated in 1999. SIP may be used to initiate call sessions as well as to invite members to a session that may be advertised by some other mechanism, such as electronic mail, news groups, web pages, and other mechanisms. The other protocols in the IETF multimedia and control architecture include the Resource Reservation Protocol (RSVP), as described in RFC 2205, for reserving network resources; the Real-Time Transport Protocol (RTP), as described in RFC 1889, for transporting real-time data and providing quality of service (QoS) feedback; the Real-Time Streaming Protocol (RTSP), as described in RFC 2326, for controlling delivery of streaming media; the Session Description Protocol (SDP), as described in RFC 2327, for describing multimedia sessions; and the Session Announcement Protocol (SAP) for advertising multimedia sessions by multicast.","Other standards may be employed in further embodiments for controlling communications sessions over the data network . One such other standard includes the H.323 Recommendation from the International Telecommunication Union (ITU).","SIP network elements may be classified as SIP clients, SIP servers, and SIP proxies. A SIP client system includes a client application program that is capable of sending SIP requests to perform call requests. A SIP server system may include an application program that accepts SIP requests to service calls and to send back responses to SIP requests. A network element can be a SIP client at certain times (when it is generating requests) and a SIP server at other times (when it is responding to requests). A SIP proxy system may include an intermediary program that acts as both a server and a client for making requests on behalf of other clients. In , the network elements , , and  may be SIP client or server systems, and the network element  may be a SIP proxy system. Examples of the SIP systems  and  include network telephones, computer systems, and other devices or systems.","The network element  may be a public switched telephone network (PSTN) gateway  that is coupled to a PSTN . Standard circuit-switched telephones  are coupled to the PSTN . The PSTN gateway  may be capable of translating telephony signaling and data between a circuit-switched format (for communication over the PSTN ) and a packet-based format (for communication over the data network ).","In accordance with some embodiments of the invention, a gateway  is also coupled to the data network . The gateway  is provided as an interface between SIP communications sessions (or other types of communications sessions such as H.323 sessions) and peripheral device data and commands. Such peripheral devices may include USB devices and other types of devices. USB stands for Universal Serial Bus, and a version of USB is described in the \u201cUniversal Serial Bus Specification,\u201d Revision 1.1, dated September 1998. USB defines a serial bus for interfacing peripheral devices to computer systems. A USB bus includes a four-wire bus that supports isochronous and asynchronous communications that can fan out up to 127 or more devices. USB provides for integrated power for low-power peripheral devices, simple connectors, and hot plug-and-play for easy addition and removal of devices by a user.","The gateway  may have a number of USB ports A, B, and so forth, to which USB devices may be connected. For additional connections of USB devices, a chain of one or more USB hub devices may be coupled, with each hub device offering multiple USB ports. In the example shown in , a USB hub  is coupled to the port A and a USB device  is coupled to port B. The USB hub  may be coupled to multiple USB devices  and , as well as to other hub devices (not shown) that can further be connected to more USB devices. A wide variety of USB peripheral devices may be coupled to the gateway , including printers, scanners, digital cameras, telephones, keyboards, mice, monitors, joysticks, speakers, and other types of devices.","In addition to USB ports A and B, the gateway  may also include one or more ports  for coupling to other types of peripheral devices . Such other ports  may include parallel ports, serial ports, SCSI (Small Computer Systems Interface) ports, PCMCIA (Personal Computer Memory Card International Association) ports, and so forth.","In accordance with some embodiments, communications sessions may be established between a network element coupled to the data network  and one of the USB devices coupled through ports A and B or one of the other peripheral devices  coupled through ports . As used here, the ports A, B, and  may be generally referred to as \u201cperipheral links\u201d that peripheral devices may be coupled to. To enable inter-working between a network element and one of the peripheral devices, the network element (such as one of the SIP systems  and  or the PSTN gateway ) can establish a SIP call session with the gateway . Standard SIP signaling may be used to establish such a call session. The call request (which according to SIP is an Invite request) to initiate the call session with the gateway  contains an indication that a communications session with one of the USB devices or other peripheral device is desired. Thus, in response to the request, the gateway  establishes a session or connection with the target USB device or other peripheral device. A communications session is thus established between the network element and the peripheral device through the gateway . A USB device or other peripheral device may also cause the gateway  to initiate a communications session with a network element on the data network .","Once a communications session is established between the SIP system and the peripheral device, data can be exchanged between the SIP system and gateway  using SIP messaging and between the gateway  and the peripheral device using USB or other signaling. For example, in streaming communications, RTP messages containing audio, video, or other forms of streaming data can be exchanged between the SIP system and the gateway . An exchange of other types of data (aside from the streaming data) may also be performed between the SIP system and the gateway . For example, such other forms of data may include data containing commands or status information to be communicated with one of the USB or other peripheral devices coupled to ports of the gateway .","To communicate such other forms of data between the SIP system and the gateway , SIP Info messages may be employed in accordance with one embodiment, which may be used to carry application-level information. The application level information may include commands, status information, and other information. A SIP Info message may be communicated along a SIP signaling path, which is the signaling path established as a result of a SIP call setup. Such an Info message may be referred to as an \u201cin-band\u201d Info message. Alternatively, the SIP Info message may be communicated outside a SIP call session (referred to as an \u201cout-of-band\u201d Info message). The Info message may be exchanged directly between the calling and called systems or through a SIP proxy system.","In an alternative embodiment, after the SIP call setup, instead of using SIP Info messages, a protocol outside of SIP may be used to communicate non-streaming information. One example protocol includes the File Transfer Protocol (FTP), which is described in RFC 959, entitled \u201cFile Transfer Protocol (FTP),\u201d dated October 1985. Another example protocol is the Hypertext Transfer Protocol (HTTP), as described in RFC 2068, entitled \u201cHypertext Transfer Protocol\u2014HTTP\/1.1,\u201d dated January 1997.","These types of protocols are appropriate for transferring files between Internet applications, including the emerging category of XML (Extensible Markup Language) files that provide a standard way of representing content across Internet applications.","Thus, for example, commands from a SIP system may be communicated through the gateway  to one of the peripheral devices to perform a desired action. If the controlled peripheral device is a camera, for example, then the desired action may be to start or stop the camera. The data communicated may also include status information, which, for example, may include the status (e.g., on\/off) of various peripheral devices coupled to the gateway . The gateway  translates between data in SIP format and data in a format for communicating with one of the USB devices or other peripheral devices.","If the gateway  is a computer system that is accessible by a user, then a user sitting at the system  has access to the features offered by the peripheral devices coupled to the system. In accordance with some embodiments, access to such features is extended to remote network elements coupled to the data network . By using network elements that are capable of participating in SIP, H.323, or other call sessions, such remote access of the features of the peripheral devices is made even more convenient and flexible. Examples of network elements include telephony devices, computers, wireless devices, and other types of devices. In one example application, the gateway  may be a home system that is coupled to various peripheral devices, such as a security camera, home appliances, telephones, and so forth. A user that is at a remote site away from the home location may be able to access such peripheral devices over the data network . Thus, if the user is at work and wishes to turn on the security camera coupled to the gateway , the user can establish a call session with the gateway  to send the necessary commands to activate the security camera. Video data recorded by the security camera may then be fed in an RTP stream from the gateway  back to the SIP system. The user may also call a USB telephone device that is coupled to the gateway .","Referring to , the gateway  includes various components. A network interface  couples the gateway  to the data network . Above the network interface  is a network device driver , a transport and network stack  (e.g., a TCP\/IP or UDP\/IP stack), and a SIP stack . An RTP layer  may also be included to control communications of RTP data to or from the data network . TCP is described in RFC 793, entitled \u201cTransmission Control Protocol,\u201d dated September 1981; and UDP is described in RFC 768, entitled \u201cUser Datagram Protocol,\u201d dated August 1980. TCP and UDP are transport layers for managing connections between end points coupled to an IP network.","A gateway module , which may be one or more application routines at the application level, performs the translation of data between a first format (e.g., SIP, H.323, or other format) and a second format (for communication with one of the USB or other peripheral devices).","In the gateway , a USB interface  is coupled to ports A and B. Above the USB interface  is a USB device driver  that provides the interface between the USB interface  and the gateway module . In addition, USB clients A and B may be present in the gateway . Each USB client  may be responsible for the control of a corresponding USB device or group of USB devices. The various layers in a system for interfacing USB devices are discussed in the USB Specification. An interface  provides a message communications link between the gateway module  and the USB clients .","Other interfaces in the gateway  include a SCSI interface  that is coupled to SCSI ports A and B, a PCMCIA interface  that is coupled to PCMCIA ports A and B, and a peripheral controller  that may be coupled to a parallel port , a serial port , or other types of ports. The SCSI controller , the PCMCIA controller , and the peripheral controller  are associated with corresponding device drivers (not shown) that enable exchanges of data with the gateway module . The other interfaces in the gateway  may similarly be connected to various types of peripheral devices that are remotely accessible by SIP, H.323, or other types of network elements.","As used here, the term \u201cperipheral device\u201d may refer to any peripheral or input\/output (I\/O) device coupled to any port of the gateway  (or other type of system). The peripheral device may be located within the system  or it may be located outside the system  and coupled over some type of a link to the system.","Referring to , an example architecture of the gateway  is illustrated. The gateway  may include a microprocessor or microcontroller  that is coupled through a host bridge controller  to a system bus . A main memory  may be coupled to a memory controller in the host bridge controller . The system bus  may be coupled to the network interface , the USB interface , the SCSI controller , and the PCMCIA controller . The system  may also include another storage device , e.g., a hard disk drive, optical medium drive, and so forth. Storage devices in the system  may include the device , main memory , and any other storage media (e.g., caches).","The gateway  may also include an expansion bus  that is coupled to the system bus  by a system bridge controller . The peripheral controller  may be coupled to the expansion bus . Other arrangements of the platform on which the gateway  may be employed in further embodiments.","The various components discussed in  are capable of performing various tasks. Such components may include hardware components or software components. To perform a specified task, one or more of the components may be involved. As used here, the one or more components may generally be referred to as a \u201ccontroller.\u201d Thus, \u201ccontroller\u201d may refer to a single software routine or module or a combination of software routines or modules. \u201cController\u201d may also refer to combinations of software routine(s) or module(s) and hardware component(s), such as the microprocessor or microcontroller .","Referring to , a message flow diagram for establishing a communications session between a SIP system and a USB device through the gateway  is illustrated. In the example of , the USB device includes a USB telephone that is capable of participating in a voice call session with the SIP system, which is configured with voice processing capabilities. The SIP system may be a network telephone, a computer with voice processing elements, a wireless telephone, or any other device capable of participating in call sessions over the data network . The participants of the message exchange includes the SIP system, the SIP stack , the gateway module , a USB client  (which is located in the gateway ), and the USB device.","The USB client controls the communication of signaling (control and data) to the USB telephone. For example, the USB client controls the ringing of the USB telephone, activation of the handset\/speakerphone, and direction of the audio stream to the handset\/speakerphone. The USB client also receives an audio stream from the USB telephone and monitors for actions taken by a user, such as on-hook\/off-hook and digit dial events. The USB client collects dialed digits, which are sent to the gateway module  for preparation of a SIP Invite request. In creating the SIP Invite request, the collected digits (corresponding to a PSTN number, for example) may be converted to a SIP address. The USB client can also preset SIP commands or destinations associated with presses of speed dial keys on the USB telephone. The speed dial keys may also be used to establish SIP sessions for other devices coupled to the gateway  (such as directing audio streams to USB speakers and directing video streams collected by a USB camera to the remote SIP system).","In the example of , the SIP system is the element that initiates the session. In another example, the USB device may be the one initiating the session. The SIP system sends an Invite request (at ) to the gateway  over the data network . The Invite message may include an IP address of the gateway . In addition, the Invite request may include an identifier associated with the target USB device. The Invite request is a SIP request that indicates that the receiving node is being invited to participate in a call session. The message body of the Invite message contains a description (e.g., in SDP format) of the session to which the receiving node is being invited. This description may be employed to identify the specific USB device.","Under control of the SIP stack , the gateway  then sends back a Trying response (at ), which indicates that some unspecified action is being taken on behalf of the call but that the target has not yet been located. The invitation request received by the gateway  is passed on to the gateway module . The gateway module  then sends a message (at ) to establish a connection with the USB client. The USB client responds with a progress indication (at ). The USB client may also maintain an indication that it is busy (that is, the USB client is involved in another session). If so, the USB client may return a busy indication. The progress indication may also indicate that call waiting or a multi-line phone capability is enabled in the USB telephone. If call waiting or multiple lines are available, a user at the USB telephone may switch to the current call while placing the other call on hold. One mechanism for implementing this is described in connection with , below.","If the USB client returns a busy indication to the gateway module , that indication is communicated to the SIP stack  which sends a SIP Busy Here response to the SIP system.","However, if the USB client is able to handle the incoming call request, the USB client sends commands (at ) to establish a USB connection. Such commands may including commands to ring the USB telephone, activate the handset or speakerphone of the USB telephone, and other actions. The USB device may respond (at ) with some acknowledgment to indicate that ringing is occurring at the target USB telephone. Upon receipt of the ringing indication, the USB client forwards the ringing indication (at ) to the gateway module . The gateway module  forwards this to the SIP stack , which sends a SIP Ringing response (at ) to the originating SIP system. The SIP Ringing response indicates that the called user agent has located a possible location where the target has registered recently and is trying to alert the target.","When a user at the USB telephone answers the call, status information indicating this event (an off-hook event) is sent (at ) by the USB telephone to the USB client. The USB client forwards the answer indication (at ) to the gateway module . This is forwarded to the SIP stack , which then sends a SIP OK response (at ) to the SIP system to indicate that the Invite request has succeeded. Next, the SIP system sends (at ) an Ack request to confirm that the SIP system has received a final response to an Invite request. After RTP setup, a voice connection is established (at ) between the SIP system and the USB client. Voice data may be exchanged between the SIP system and the gateway  in RTP format or in any other format for carrying streaming data, and voice data may be exchanged between the gateway  and the USB device in USB format.","If the SIP system wishes to terminate the call, it sends a Bye request (at ) to the gateway . In response, the gateway module  issues (at ) a command to terminate the call to the USB client. The USB client sends (at ) disconnect commands (e.g., disconnect audio stream, or deactivate handset or speakerphone) to the USB device. The gateway  then sends (at ) an OK message back to the SIP system.","The USB client also monitors for a disconnect event at the USB telephone. If such a disconnect event (e.g., on-hook) is received, the USB client informs the gateway module , which notifies the SIP stack  to cause a SIP Bye request to be sent to the SIP system.","Referring to , the USB telephone may have multi-line capability. Thus, even though the user at the USB telephone may be speaking on a first line, a call indication may be received over another line. To provide the multi-line capability in the gateway , the interface  between the gate module  and USB client  corresponding to the USB telephone may include multiple application programming interfaces (APIs). Each individual API corresponds to a line of the USB telephone. Thus, as illustrated in , a line 1 API corresponds to a first line, and a line N API corresponds to the Nth line, where N can be two or more. Thus, when an incoming call from the SIP system is received by the gateway module , the gateway module  establishes a connection with the USB client  over an available API. Each API may be associated with a different SIP uniform resource locator (URL). Alternatively, calls may overflow from one line (a first API) to another line (another API).","The gateway  is also capable of supporting conferencing. In conferencing, a SIP server may receive Invite requests from two or more clients to participate in the call session. As a result, three or more participants may be involved in the call session. In this case, the gateway  needs to handle two or more separate audio streams that may come in over the data network  from the two or more other participants. The multiple API lines as disclosed in  may also be employed to handle such a conferencing call session, in which a first incoming audio stream may be routed over a first API and another incoming audio stream may be routed over a separate API.","Referring to , in accordance with another embodiment, a communications session between a SIP system and a USB client that is a non-telephony device is illustrated. In the example of , the USB device is a \u201creceive-only\u201d device, such as a USB speaker, a disk drive used as a drop-box or answering machine, a USB display, or other like devices. To access the USB device from the SIP system, the SIP system first sends an Invite request (at ) to the gateway . The SIP stack  returns a Trying response (at ) to the SIP system. The invitation request is forwarded by the SIP stack  to the gateway module , which attempts to establish a connection with the USB client (at ) that corresponds to the receive-only USB device. The USB client maintains an indication of whether the USB device is being used. If the USB device is idle, then the USB client sends an available indication (at ) to the gateway module . This is forwarded by the gateway module  to the SIP stack , which returns a SIP Ringing response (at ) to the SIP system. This is followed by a SIP OK response (at ) from the gateway  to the SIP system. The SIP system then returns an Ack request (at ) back to the gateway . At this point, transfer of data may occur (at ) from the SIP system to the receive-only USB device. In one example, if the receive-only USB device includes USB speakers, then an audio stream in RTP format may be communicated from the SIP system to the gateway . The RTP data is received by the RTP layer  () in the gateway , which sends the data onto the USB client corresponding to the USB speakers. The USB client converts the incoming audio stream into the USB speaker data flow format, which may be raw PCM (pulse-code modulation).","The SIP system may terminate the call by sending a Bye request (at ) to the gateway . In response, the gateway module  sends a terminate connection command (at ) to the USB client. The SIP stack  may also send back an OK response (at ) to the SIP system. Additionally, if the USB device (e.g., speakers) is powered off or otherwise disconnected from the system, the USB driver stack notes such disconnection and can cause a Bye sequence to be initiated.","As noted above, the USB device may be busy if it is already in use in another session when a current Invite request is received by the gateway . One way of noting that the USB device is in the busy state is by noting that the USB device is in the Configured USB state. One way of noting that the USB device is in the idle state (available), is to set the USB device to the Addressed, but not Configured USB state. If the USB device is busy, then the USB client may send a busy indication back to the gateway module , instead of the available indication sent at  in . The gateway module  forwards this busy indication to the SIP stack , which may return a Busy Here response instead of the Ringing or OK responses sent at  and  in .","In another arrangement, a current session may be over-ridden by a new session. Thus, in this other arrangement, if the gateway  receives a new Invite request while a current session is active, the SIP gateway  may send a SIP Bye request to the remote SIP system involved in the current SIP session to close the communication session. As the current communication session is being terminated, the gateway  may participate in an exchange of SIP protocol messaging with the SIP system that originated the new Invite request to start the establishment of the new session. Thus, once the previous session is closed, the SIP Ringing and OK responses may be sent by the gateway  to the new SIP system. Whether a current session is to be over-ridden by a new session may be according to policies set by the user or a system administrator. Such policies may rely on the identity of the originating system. Thus, for example, certain calling parties may have higher priority then other calling parties.","As in the case of an interactive session between a SIP system and a USB telephone as discussed in connection with , a conferencing session may be established in which multiple remote SIP systems may send separate audio streams for output on a single set of speakers. According to a first technique, the USB client responsible for the speakers may be implemented as a conferencing-type bridge in which the audio streams from the separate sources are merged for output on the USB speakers. Alternatively, according to another technique, the separate audio streams may be played separately on corresponding separate (e.g., stereo) speakers. Thus, if the USB device includes two speakers, and two audio streams are received, then a first audio stream may be output on a first speaker while a second audio stream is output on a second speaker.","The USB client may also be programmable to handle either of these two techniques. This may be accomplished by using multiple APIs between the gateway module  and the USB client, similar to the multiple APIs employed in the interface  as shown in . Thus, in the example where the USB device includes two speakers, a first API may be used to cause the USB client to act as a conferencing-type bridge, a second API may be used to send an audio stream to a left speaker, and a third API may used to send an audio stream to a right speaker. The several APIs may have different corresponding SIP URLs. Thus, a bridging request may use a first URL, e.g., bridge.speakers@doe.nortelnetworks.com to set up streams for bridging functions. The second API may have the example URL left.speakers@doe.nortelnetworks.com to route data to the left speaker, while the third API may have the example URL right.speakers@doe.nortelnetworks.com to route data to the right speaker.","Referring to , a communications session between a send-only USB device and a remote SIP system through the gateway  is illustrated. An example of a send-only device may be some monitoring device that sends data out whenever something new is detected. For example, the send-only device may include a motion sensor that normally is inactive but transmits data when it detects motion. In , it is assumed that a communications session is not active between the SIP system and the send-only USB device when the USB device initially transmits data (at ) to the USB client. In response, the USB client sends a request connection message (at ) to the gateway module , which forwards the request to the SIP stack . The SIP stack  packages the request into an Invite request that is sent (at ) to a preselected SIP system. The gateway  may store some indication that the preselected SIP system is to be contacted if data is received from the particular send-only USB device. The SIP system sends back a Ringing response (at ) followed by sending an OK response (at ). The SIP stack responds to the OK response by sending an Ack request (at ) to the SIP system. The SIP stack  also forwards receipt of the OK response to the gateway module , which communicates a connection established message (at ) to the USB client. At this point, a communications session is established (at ) in which the data sent by the USB device may be transmitted to the SIP system through the gateway .","The USB client may include some type of a timeout mechanism. Thus, if the send-only USB device does not send data within some period of time, a timeout condition occurs (at ) which causes the USB client to send a disconnect request to the gateway module . This disconnect request is sent (at ) to the SIP stack , which issues a Bye request (at ) to the SIP system. The SIP system then responds with an OK response (at ).","The USB client may also be capable of sending to multiple destinations. Thus, for example, the USB client may be a camera that sends multiple, duplicated video streams to specified destination devices. Alternatively, the USB client may send a multicast stream that can be received by multiple destination devices.","Referring to , another example involves an interactive USB device that is a non-telephony device. The interactive USB device is capable of receiving data from and sending data to a remote SIP system. The interactive USB device is also capable of causing initiation of a communication session with the remote SIP system in response to certain events occurring at the USB device. One example is the toggling of the USB device between on and off states. Thus, for example, if the USB device is initially in the off state and it is turned on, an initialization sequence may occur between the USB device and the USB client (at ). After the initialization sequence, the USB client marks the USB device as being on (at ). In addition, the USB client sends a message indicating that the USB device has been turned on (at ) to the gateway module .","The gateway module  identifies the remote SIP system to be addressed, and sends a request on to the SIP stack . The SIP stack  sends a corresponding Invite request (at ) to the identified remote SIP system. The remote SIP system returns a Ringing response (at ) followed by an OK response (at ). The SIP stack  returns an Ack request (at ) to the SIP system. The OK response received from the remote SIP system is also forwarded by the SIP stack  to the gateway module , which then sends an indication that the call session has been established with remote SIP system (at ). Following transmission of the Ack request, a call session is established (at ) between the SIP system and the gateway module . In the call session , the gateway module  may send the message that the USB device is on to the remote SIP system. Such a message may be sent in a SIP Info message. Following this, the USB client may request that the gateway module  and SIP stack  terminate the call session with the SIP system. This may be accomplished by the SIP stack  sending a Bye request (at ), with the SIP system returning an OK response (at ).","Another type of send-only USB device may be those that are transmitting continuously. Examples of such USB devices include microphones and video cameras (e.g., security cameras). Since such send-only devices are transmitting continuously, a communications session may be actively maintained between the USB-only device and the remote SIP system. The continuous stream of data is communicated from the USB device to the gateway , which converts the stream of data into RTP format for communication to the SIP system.","Additionally, should a gateway have a number of USB peripherals attached, SIP may be used to set up inter-device communications within the gateway itself. As an example, should a user press a play button on a USB CD drive, the corresponding USB client could initiate a SIP Invite to an adjacent pair of USB speakers to render the audio stream. This type of inter-machine communications is easily facilitated through the Sockets communication layer of modern operating systems which allows multiple processes to communicate with IP style communications without actually sending IP communications over an external communications link.","Referring to , a communications system  according to another embodiment is illustrated. In this embodiment, plural gateways , , and  are present that are capable of converting between SIP messaging and data to be communicated to USB and peripheral devices. The gateways , , and  are coupled to a network hub , which is turn is coupled over a data network  to one or more SIP systems . Each of the gateways is coupled to respective USB devices. Thus, for example, the gateway  is coupled to a USB device , and the gateway  is coupled to USB devices , , and . The gateway  is coupled to a USB device . In addition, the gateway  is coupled through a bridge  to a computer . The bridge  may convert between data communicated according to USB format and data that is communicated to a port of a computer , which may be a modem port.","In the communications system , the one or more SIP systems  may be capable of communicating with any one of the USB devices coupled to respective gateways as discussed above. In addition, each of the USB devices coupled to one gateway may be capable of communicating with another USB device coupled to another gateway.","The various software layers, routines, or modules described herein may be executable on various processing elements, such as the microprocessor or microcontroller  in  (which may be generically referred to as a control unit). The control unit may be coupled to a storage device to store instructions and data associated with the software layers, routines, or modules. As used here, a \u201ccontroller\u201d may refer to software, hardware, or a combination of software and hardware.","The storage device may include one or more machine-readable storage media for storing data and instructions. The storage media may include different forms of memory including semiconductor memory devices such as dynamic or static random access memories (DRAMs or SRAMs), erasable and programmable read-only memories (EPROMs), electrically erasable and programmable read-only memories (EEPROMs) and flash memories; magnetic disks such as fixed, floppy and removable disks; other magnetic media including tape; and optical media such as compact disks (CDs) or digital video disks (DVDs). Instructions that make up the various software layers, routines or modules in the various network elements may be stored in respective storage devices. The instructions when executed by a respective control unit cause the corresponding network element to perform programmed acts.","The instructions of the software layers, routines, or modules may be transported to the network element in one of many different ways. For example, code segments including instructions stored on floppy disks, CD or DVD media, a hard disk, or transported through a network interface card, modem, or other interface device may be loaded into the system and executed as corresponding software layers, routines, or modules. In the loading or transport process, data signals that are embodied in carrier waves (transmitted over telephone lines, network lines, wireless links, cables, and the like) may communicate the code segments, including instructions, to the network element. Such carrier waves may be in the form of electrical, optical, acoustical, electromagnetic, or other types of signals.","While the invention has been disclosed with respect to a limited number of embodiments, those skilled in the art will appreciate numerous modifications and variations therefrom. It is intended that the appended claims cover all such modifications and variations as fall within the true spirit and scope of the invention."],"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIG. 3","FIG. 2"]},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 2"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 9"}]},"DETDESC":[{},{}]}
