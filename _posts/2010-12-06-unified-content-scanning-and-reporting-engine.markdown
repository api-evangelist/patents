---
title: Unified content scanning and reporting engine
abstract: A method of unified content scanning in which content is deconstructed into base formats so as to be presented to content filters in a common format. The base formats include text, image and audio. The invention also includes a system of unified content scanning and a gateway appliance embodying the method of unified content scanning.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09313173&OS=09313173&RS=09313173
owner: Bloomberg L.P.
number: 09313173
owner_city: New York
owner_country: US
publication_date: 20101206
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND TO THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["The present invention relates to the field of communication security. More particularly, the invention relates to a system, method and apparatus for protecting against leakage of information or exposure to inappropriate content during electronic communication.","The Internet has ushered in a communication revolution. Every day there is a phenomenal volume of information being exchanged via numerous electronic communication channels. Email has become the most ubiquitous form of electronic communication but other communication channels have developed and are used extensively. These other channels include instant messaging (which in early forms predates the Internet), social network sites (such as Facebook\u00ae and MySpace\u00ae), business networking sites (such as LinkedIn\u00ae and Plaxo\u00ae), micro-blogging services (such as Twitter\u00ae) and various web sites that encourage the input of personal information.","It has long been realised that the Internet has an inherent security risk by virtue of the open connection between a user and all other users. The risk is bidirectional in the sense that external threats (such as viruses and Trojans) can attack the computing equipment of a user and that sensitive internal information can be leaked from the user's computing equipment. The problem is particularly significant for a business. While most businesses are aware of the external threats and implement various firewall protocols, they are less aware of the internal threats. For example, inappropriate use of the Internet can leave a business and its owners open to legal action. Also, disgruntled employees have an ever widening range of opportunities to export sensitive company data via any one of the many electronic communication channels available. Perhaps an even greater risk is the possibility of the unintentional leakage of sensitive information.","Various technologies have been developed to try and protect against external attack and some technologies have been developed to try and protect against internal data leakage. These technologies are almost exclusively limited to email scanning, virus checking or web content rating.","For example, U.S. patent application Ser. No. 11\/604,286 describes a system and method for managing content for secure communications. The patent is concerned with decrypting encrypted messages so they can be virus checked, spam filtered or have other policy enforcement applied.","U.S. patent application Ser. No. 11\/279,213 describes a content upload tool that scans only outbound communications and it is limited to scanning for personal information only.","U.S. patent application Ser. No. 11\/331,030 describes a system for processing network content that uses one or more proxies to buffer network content and uses multiple scanning engines to scan content from different network protocols.","U.S. patent application Ser. No. 11\/867,880 describes a scanning system that uses a multifaceted scanning engine that applies rules, thresholds and policies to content to produce modified content. The multifaceted scanning engine operates directly on the received content and is limited by the combination of rules, thresholds and policies and each scanning engine must be implemented with a decoding engine for the underlying data structure.","There is no tool available to convert different formats to a common format to facilitate content scanning a broader range of electronic communications.","In one form, although it need not be the only or indeed the broadest form, the invention resides in a method of unified content scanning by:","identifying an electronic communication;","converting the electronic communication to a common format;","analysing the electronic communication in the common format to identify restricted content; and","blocking or modifying the restricted content.","In a further form the invention resides in a gateway appliance comprising:","a processor; and","memory containing an instruction set causing the processor to:\n\n","The gateway appliance may further comprise a content scanning engine that scans the electronic communications in the common format for restricted content.","In a further form the invention resides in a unified content scanning system comprising:","an application awareness engine that identifies an electronic communication and converts the electronic communication to a common format; and","a content scanning engine that scans the electronic communications in the common format for restricted content.","In a still further form the invention resides in a unified content scanning system comprising:","a gateway appliance for a communication network;","a processor in the gateway appliance;","memory in the gateway appliance containing an instruction set causing the processor to:\n\n","Further features and advantages of the present invention will become apparent from the following detailed description.","Embodiments of the present invention reside primarily in unified content scanning. Accordingly, the embodiments of the invention have been illustrated in concise schematic form in the drawings, showing only those specific details that are necessary for understanding the embodiments, but so as not to obscure the disclosure with excessive detail that will be readily apparent to those of ordinary skill in the art having the benefit of the present description.","In this specification, adjectives such as first and second, left and right, and the like may be used solely to distinguish one element or action from another element or action without necessarily requiring or implying any actual such relationship or order. Words such as \u201ccomprises\u201d or \u201cincludes\u201d are intended to define a non-exclusive inclusion, such that a process, method, article, or apparatus that comprises a list of elements does not include only those elements but may include other elements not expressly listed, including elements that are inherent to such a process, method, article, or apparatus.","Referring to , the invention provides an application awareness engine  that provides an interface between applications  and filters . The application awareness engine  processes content uploaded from or downloaded to the applications  and passes the content in a common format to one or more of the filters . The application awareness engine  deconstructs the content into chunks that are a base format. The inventors consider that the three base formats are text, image and audio but recognise that other base formats may be developed in the future. There may also be variations on these base formats, for instance video can be treated as a bunch of images and audio, or could be treated as another base format.","There are numerous applications  that are a source of potential risk due to the ability to upload or download malicious or inappropriate content. A non-exhaustive list of applications includes: Facebook\u00ae; Email; Twitter\u00ae; Web Forms; Instant Messaging; Gmail etc. Many of these applications can transfer content in different forms. For example, a Facebook\u00ae user can post text onto their own wall, can upload images, can post text onto the wall of another user, and can download images. Similarly, email can have attachments such as documents and images. Email may even have attachments which themselves have attachments, such as .ZIP files and other emails.","For many of these applications there are content filters which seek to limit the upload or download of inappropriate content. A non-exhaustive list of filters includes: text filters that filter for inappropriate words; data filters that filter for corporate data leakage; personal information filters that filter for addresses, telephone numbers; financial filters that filter for bank account details; image filters that filter for a selected group of inappropriate images or certain colours like flesh tones; etc. The known filters are specific to applications. Thus a data filter, such as described above in the background section, will either be useful only for one application, such as email, or will have a different version for other applications, such as web forms. In contrast the application awareness engine  deconstructs the content to base formats that are recognisable by any filter.","The process of deconstruction is outlined in . The method of the application awareness engine  commences with content passing to the application awareness engine. The content is scanned to identify the type of content. As shown in , the various types are checked in order. First it is decided whether the content is an email. If it is, any identified text, such as the subject line or the body text, is added to a tree structure. The remaining material is then parsed for other base formats and any images or audio are added to the tree. The content is then checked for other content. For instance, an email may have attachments or embedded files. If so, the remaining content is rescanned. If not the process is ended and the content tree is established.","When remaining content is rescanned the first check will be if the remaining chunks are emails (such as an email attachment to an email). If not the next check is made, in the example a check for whether the content is a web page, if not the process continues as shown in . For clarity, not all possible content chunks are shown in , for instance HTML is not shown. Furthermore, there may be other content forms in the future which would then form part of the invention.","The end of the checking train is whether the content is an image, audio or text. It should be noted that video content is treated as multiple images, but in another embodiment video could be considered as another type of base format. If none of the checks returns a \u2018yes\u2019 flag a message is generated such as \u201cunknown content type\u201d to indicate that the content is not recognised. A new module may be added for the new content type.","The content may loop through the process one or more times until the content is deconstructed into multiple chunks of image, audio and text. By way of example, an email with a document attachment having embedded images may result in four chunks being a text chunk for the subject of the email, a text chunk for the body of the email, a text chunk for the document and an image chunk for the image embedded in the document.","The deconstructed chunks are then in a form to be scanned by the appropriate filters . The scanning may result in modification or blocking of content depending on whether the chunks are mutable or not. The original content is then reconstructed by the application awareness engine by building the content from the tree in reverse order, albeit with some content modified or removed. The content is then transmitted in the usual manner.","In order to exemplify the invention a number of examples of content scanning are described below. Referring to  there is a shown a schematic of a typical home or business communication arrangement. A user operates a personal computer  that is connected through a gateway appliance  to the Internet . For convenience the invention will be described by reference to the communications network known as the Internet, but persons skilled in the art will appreciate that it is applicable to any communication network.","The user has access to a range of resources  via the Internet . These resources will include various resources such as web sites, other users, data storage sites and information servers. The user may choose to communicate with these resources  by various protocols. The range of available communication protocols is ever increasing but a non-exhaustive list is provided above. Each of these different communication options uses a different data packet format making it difficult to scan for forbidden content. For instance, a business may have an email content scanning engine that has a rule set that strips financial data from all outgoing emails but this will not prevent a person from sending financial data via Gmail\u00ae or instant messaging. Another example is at home where a parent may be able to use content scanning to prevent a child from passing personal information via email but may not be able to prevent the same personal information being written on a Facebook\u00ae wall. A person may also be able to upload data via FTP that would not otherwise be allowed to be transferred by email or web mail.","In  the example of a chat session is shown in which a user is in danger of releasing a personal address. The gateway appliance  recognises and intercepts the instant message. This may be done using a variety of techniques. For instance, many instant messaging clients run on known TCP and\/or UDP ports. If traffic is detected on these ports it is assumed to be an instant message. Another example is communication on a web site such as Facebook\u00ae, when a user posts to their \u201cFacebook Wall\u201d the page\/application is generally the same for every user. The message is converted to a common format by an application awareness engine  in the manner outlined in .","As depicted in  an application awareness engine scans for each communication protocol. In the example the application awareness engine identifies the content as an instant message and the content is deconstructed into text. The inventors envisage that a new application awareness engine module could be loaded to the gateway appliance  at the same time as the communication application is installed on the personal computer . Thus, if a user installs a new chat application a chat application deconstruction module would be loaded to the application awareness engine  in the gateway appliance . In the embodiment the application awareness engine is software stored in memory in the gateway appliance . Alternatively the application awareness engines may be distributed in a \u201ccomputing cloud\u201d accessible by the gateway appliance. Accessing an application awareness engine from the cloud means that all application awareness engine modules are available at all times without a need to upgrade the gateway appliance. Persons skilled in the field will understand a computing cloud to mean a distributed network of computing resources accessible via the Internet that are not necessarily owned by the user.","The application awareness engine presents a standard Application Programming Interface (API) to a scanning engine . The scanning engine may be software stored in memory in the gateway appliance  or alternatively may be accessible in a \u201ccomputing cloud\u201d. To do this the application awareness engine searches for patterns in the data stream. This data stream may have been partially deconstructed by a previous pass through the application awareness engine method (as explained by reference to ). The application awareness engine then extracts common fields from the encoded message. Every message has at least some of the following fields (which may or may not have content for a given message):","Application (eg. Facebook\u00ae)","Type (eg. chat)","From","To","Subject","Body Parts (which may be text, attachments, pictures, etc).","The Body Parts section typically includes a MIME encoded message (or text for simple applications). MIME is the protocol used by email, web and most instant messaging protocols. Various different body parts (such as attachments) are referred to as \u201cchunks\u201d. As outlined above the content is deconstructed in to base formats of text, image and audio for presentation to the content scanning engine.","A content scanning engine  scans the electronic communication in the common format to identify and remove restricted content. The process is most commonly rule-based but adaptive learning techniques may also be applicable. The inventors envisage that there would be a core rule set that is activated at commissioning of the system and a user-defined rule set that is developed over time. Various processes for rule set development are known and do not form part of the invention.","By way of example the following pseudocode describes the operation of one form of the document (chunk) creation by the application awareness engine  and used by the content scanning engine .",{"@attributes":{"id":"p-0057","num":"0061"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"knownstreams = (EmailDocument, FacebookChatDocument,"},{"entry":"FacebookMessageDocument, TwitterPostDocument...)"},{"entry":"class Document"},{"entry":"\u2003\u2003method GetText( )"},{"entry":"\u2003\u2003\u2003\u2003\/\/ A sample of a method that could be common on all documents"},{"entry":"\u2003\u2003method GetAttachements( )"},{"entry":"\u2003\u2003\u2003\u2003\/\/ A sample of a method that could be common on all documents"},{"entry":"\u2003\u2003method Block( )"},{"entry":"\u2003\u2003\u2003\u2003\/\/ A sample of action that could be common on all documents"},{"entry":"\u2003\u2003method Replace(text)"},{"entry":"\u2003\u2003\u2003\u2003\/\/ A sample of action that could be common on all documents"},{"entry":"\u2003\u2003method ProcessStream(datastream)"},{"entry":"\u2003\u2003\u2003\u2003\/\/ This method populates a common document"},{"entry":"\u2003\u2003method ReturnStream(datastream)"},{"entry":"\u2003\u2003\u2003\u2003\/\/ This method modifies the stream (if required), based on the"},{"entry":"\u2003\u2003\u2003\u2003\/\/ actions taken (eg: Block and Replace)."},{"entry":"\u2003\u2003method Match(datastream)"},{"entry":"\u2003\u2003\u2003\u2003\/\/ Figures out if this stream matches this document"},{"entry":"function FacebookChatDocument(extends Document):"},{"entry":"\u2003\u2003\/\/ implements all of Documents methods"},{"entry":"function ProcessStream(datastream)"},{"entry":"\u2003\u2003document = GetDocument(datastream)"},{"entry":"\u2003\u2003if document != unknown"},{"entry":"\u2003\u2003\u2003\u2003action = CheckRules(document)"},{"entry":"\u2003\u2003\u2003\u2003if action.block"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003document.block( )"},{"entry":"\u2003\u2003\u2003\u2003if action.replace"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003document.replace(action.replacestring)"},{"entry":"function GetDocument(datastream)"},{"entry":"\u2003\u2003for type in knowndocuments"},{"entry":"\u2003\u2003\u2003\u2003if type.match(datastream)"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003return type.documentparser(datastream)"},{"entry":"\u2003\u2003return unknown"},{"entry":"function CheckRules(document)"},{"entry":"\u2003\u2003\/\/ Check rules can work through every document without having to"},{"entry":"\u2003\u2003\/\/ know anything about the underlying application."},{"entry":"\u2003\u2003\/\/ Actions can also be taken as desired - again with no understanding"},{"entry":"\u2003\u2003\/\/ of the underlying stream."},{"entry":"\u2003\u2003\/\/ This is just an example of how rules may be processed. A similar"},{"entry":"method"},{"entry":"\u2003\u2003\/\/ is adopted for logging and recording of activity."},{"entry":"\u2003\u2003for rule in rulechain"},{"entry":"\u2003\u2003\u2003\u2003match = rule.ProcessDocument(document)"},{"entry":"\u2003\u2003\u2003\u2003if match"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003action = rule.action( )"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"For reporting purposes a log of scanning activity may be kept in local storage . Local storage  may also maintain a complete log of all electronic communication in the common format. This greatly simplifies the task of monitoring user communications. A business seeking to check the communication history of a user currently has great difficulty due to the range of available communication options. The process of monitoring is greatly simplified by converting electronic communications to a common format.","Although the embodiment is described in terms of local storage it will be appreciated by persons skilled in the art that the storage merely needs to be accessible. Central storage, external storage or storage in a data cloud would all be suitable.","When a traffic stream is intercepted it is usual to wait for the entire message to be sent from the client before sending it off to the remote server . This allows the content scanning engine  to scan the full message, and either block it, allow it or modify it, before sending on to the remote server. This has minimal impact on the user experience as messages are small, and the limiting factor is the internet speed, so the message leaves the client practically instantly (either over the LAN or on the local PC), and is then scanned as a whole, and \u201ctrickled\u201d to the internet.","The invention can handle MIME messages and various types of attachments. For example, if a PDF document is sent via email, web mail or file transfer the message is intercepted by the application awareness engine  and deconstructed into base formats. The text or image from the PDF document is sent to the content scanning engine . The content scanning engine scans the text and takes appropriate action to block the PDF document or modify it if the content scanning engine is configured to edit the PDF document.","The application awareness engine  recognises whether the content of the fields is mutable and sets a flag in the API that is readable by the content scanning engine. Each field and each chunk of the Body Part field is considered to be potentially mutable so a flag is set for each field or chunk rather than for the whole message. If mutable that content may be changed, as depicted in . If a field or chunk is not mutable the content scanning engine passes a message back to the application awareness engine to block the field, the chunk, or the entire message.","The application awareness engine  includes appropriate routines to block a message if requested by the content scanning engine, and to re-encode a message for sending if it is mutable and has been changed. By way of example, an appropriate routine for an email may be to block inappropriate content substitute a message that the content is inappropriate, for a web page it may be to simply block the page.","A message when completely decoded into chunks is presented in a \u201ctree\u201d format. This allows for the nesting of different types of data. For example, a message may have a ZIP chunk. The chunk decoding will then extract that into several parts, containing say text from a PDF and text from a document. When the content scanning engine traverses this message tree it can, using the common API, inspect all text in both the PDF and document with no further programming. Further to this, should the text need to be changed in the document, if the API flags the chunk as mutable, it can change the document. This chunk would be marked as \u201cdirty\u201d, and this information would be sent up the message tree. When the application awareness engine receives the message, it then re-serialises the message, and sends it on, with the changes in place because the root of the message tree flagged that this message had been changed.","The embodiment described above has used instant messaging as an example. If the message is traffic or HTTP (or HTTPS), the URL of each request is inspected, and if it matches a registered URL pattern, it is processed by the appropriate module of the awareness engine registered for the pattern. For example a request to *facebook.com\/* will automatically be processed by the Facebook\u00ae awareness engine module (as shown in ). The application awareness engine  may have multiple components for each type of communication, eg: chat, post etc. For protocols such as email which are extremely standard, the known ports are monitored for email traffic using existing inspection technologies. This could be in the form of an email gateway where all outgoing traffic is sent anyway, or through transparent interception. For other applications \u201csignatures\u201d are detected on each packet to determine the application, if a matching application is detected, it is passed to the relevant application awareness engine. This is ideal for protocols that use dynamic ports (eg: BitTorrent).","An example of an embodiment implementing a computing cloud is depicted in . A user operates a personal computer  that is connected through a gateway appliance  to the Internet . The user has access to a range of resources  via the Internet . In the example of  the user is sending an email to somebody@somewhere. The email contains financial information such as bank account details. The gateway appliance  recognises the email format and redirects the email to the application awareness engine  in the computing cloud  that is specifically for email. The application awareness engine  converts the email to a common API for scanning by content scanning engine . In the embodiment of  the content scanning engine  resides on the gateway device  but persons skilled in the field will appreciate that the content scanning engine  could also reside in the computing cloud . The email is identified as being unsafe but mutable so the offensive content is blocked and the modified email is returned to the gateway device  for continued forwarding. As with the first embodiment, the activity may be recorded in a log on local storage .","The invention is not limited to implementation in a gateway appliance. The only requirement is that messages are intercepted and passed to the application awareness engine. The invention could be implemented as an application on a personal computer or as an application on a server in a client\/server network. An example of a client server implementation is depicted in .","Referring to  there is a shown a schematic of a typical business client\/server arrangement. A user operates a computer  that is connected to a server . The user may access external resources  via the Internet  through a gateway appliance . For example, the user may access a remote web site that seeks private information in a web form. The URL of the site is detected by the unified content scanning invention running on the server . The application awareness engine  has a module for HTTP converts the pages to a common API (text, image and audio) for scanning by the content scanning engine . The web form is identified as being unsafe and immutable. The form is therefore blocked. As with the first embodiment, the activity may be recorded in a log on local storage .","A similar approach is taken with upload of files, such as attachments to web mail or web forms. The application awareness engine temporarily caches any uploaded files, and when the user presses \u201csend\u201d, the application awareness engine presents the body of the message, and all attachments to the common API.","The client\/server embodiment of  has the added advantage of facilitating unified content scanning of internal communications. For instance, staff can be prevented from using internal company communication channels to pass inappropriate jokes, comments and photos.","The above description of various embodiments of the present invention is provided for purposes of description to one of ordinary skill in the related art. It is not intended to be exhaustive or to limit the invention to a single disclosed embodiment. As mentioned above, numerous alternatives and variations to the present invention will be apparent to those skilled in the art of the above teaching. Accordingly, while some alternative embodiments have been discussed specifically, other embodiments will be apparent or relatively easily developed by those of ordinary skill in the art. Accordingly, this invention is intended to embrace all alternatives, modifications and variations of the present invention that have been discussed herein, and other embodiments that fall within the spirit and scope of the above described invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["To assist in understanding the invention and to enable a person skilled in the art to put the invention into practical effect, preferred embodiments of the invention will be described by way of example only with reference to the accompanying drawings, in which:",{"@attributes":{"id":"p-0028","num":"0032"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0029","num":"0033"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0030","num":"0034"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0031","num":"0035"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0032","num":"0036"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
