---
title: Deep packet inspection (DPI) using a DPI core
abstract: Illustrated is a system for performing Deep Packet Inspection (DPI) that includes a core to prepare a data packet for transmission. Further, the system includes a memory controller to direct the data packet to a DPI core. Additionally, the system includes a Network Interface Card to receive the data packet for transmission after DPI is performed on the data packet by the DPI core. The system includes a Direct Memory Management module to update a descriptor that references a received data packet stored in an Operating System buffer. Moreover, the system includes an Input/Output Memory Management Unit to direct the descriptor to be stored in a DPI memory. Additionally, the system includes an interrupt controller to transmit an interrupt to the DPI core to such that the DPI core retrieves the descriptor from the DPI memory and performs DPI on the data packet stored in the OS buffer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08122125&OS=08122125&RS=08122125
owner: Hewlett-Packard Development Company, L.P.
number: 08122125
owner_city: Houston
owner_country: US
publication_date: 20090908
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION"],"p":["Deep Packet Inspection (DPI) is used to, for example, ensure Quality of Service (QoS) for certain packet types, to meet network traffic and bandwidth requirements, to detect malware, or enforce business conduct policies on information exchanged inside and outside a company. DPI is presently used in data centers and other places where large amounts of data are processed. Through DPI, network security and efficiency can be maintained.","Illustrated is a system and method for DPI that uses a DPI-module residing on a DPI-core to perform DPI. In some example embodiments, this DPI-core resides upon the same computer system as a general purpose core (e.g., the core) and associated Operating System (OS). When receiving a data packet, a NIC associated with the core copies, using DMA, the data packet to a packet buffer in residing in the computer system's main memory. An updated descriptor from the NIC is directed by the Input\/Output Memory Management Unit (I\/O MMU) to the DPI-module. At some later point, the interrupt controller sends an interrupt to the DPI-module instructing the DPI-module to perform DPI on the received packet. When a data packet is to be transmitted, the OS is instructed, by a memory controller associated with the core, to write the data packet to a DPI buffer. This instruction is provided via a DMA module associated with the memory controller. At some later point, the interrupt controller sends an interrupt to the DPI-module instructing the DPI-module to perform DPI on the packet to be transmitted. Further, as will be more fully illustrated below, the core's I\/O MMU, interrupt controller, memory controller, and Translation Look Aside Buffer (TLB) are modified so that the DPI memory can only be accessed by the DPI-module.","In some example embodiments, the DPI-module is statically mapped on a specific DPI-core at boot time. This can be implemented at boot time by the computer system's BIOS, which effectively hides the DPI-core from the general purpose core(s) available to the OS, and bootstraps the DPI environment onto the DPI-core. With respect to memory allocation on the computer system, the DPI-module's virtual address space is mapped to a statically assigned portion of the computer system's main memory. This portion of memory is reserved as DPI memory. While the DPI-module is able to access all memory on the computer system including memory allocated for the OS, the OS and core(s) upon which it resides cannot access the DPI memory.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["100","101","102","106","101","102","107","107","107","106","107","108","109","101","102","107"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2","b":["102","201","202","201","201","212","202","213","201","202","218","204","207","204","208","208","219","209","209","210","211","211","201","202","210","216","216","217","214","216","201","202","215","217","202","203","205","206"]},"In some example embodiments, interfaces are associated with each of the I\/O MMU , interrupt controller , and memory controller  are made available only to the DPI-module to allow the DPI-module to modify the functionality of the I\/O MMU , interrupt controller , and memory controller . These interfaces may be physical interfaces or Application Programming Interfaces (APIs). Example modified functionality includes the I\/O MMU  directing updated descriptors to a DPI-module residing on the DPI-core  from the NIC , the interrupt controller  interrupting the DPI-module to perform DPI, and the memory controller  writing a data packet to be transmitted to a DPI buffer (e.g., DPI memory ) from an OS packet buffer .",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 3","b":["300","300","102","301","201","302","202","301","302","301","201","204","303","216","302","304","211","302","305","302","216","302","306","302","204","308","307","204","301"]},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4","b":["400","400","102","401","204","207","204","401","205","401","406","401","204","219","402","219","302","403","206","215","211","302","401","401","302","301","401","405","301","404","204","301"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5","b":["500","500","102","217","302","501","205","504","302","217","217","205","206","206","218","505","302","204"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 6","FIG. 4"],"b":["302","600","600","102","601","211","302","302","302","206","602","301"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 7","FIG. 4"],"b":["700","700","102","701","211","302","302","302","215","602","301"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 8","b":["800","102","101","102","801","801","802","803","803","804","803","802","803","803","805","803","803","803","806","803"]},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 9","b":["900","102","101","102","901","902","902","903","904","904","905","904","904","903","905","904","901"]},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 10","b":["800","102","101","102","1001","1002","1002","1003","1004","1004","1005","1005","1004","1004","1005","1004","1006","1004","1004","1007","1007","1007","1007","1007","1007","1004","1003"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 11","b":["1400","1100","102","1101","801","1102","802","803","1103","804","803","802","803","1104","805","805","1105","806","803"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 12","b":["1200","1200","102","1201","901","1202","903","904","1203","905","904","904","903","904","905","904","901"]},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 13","b":["1300","1300","102","1301","1001","1302","1003","1004","1303","1004","1004","1304","1004","1305","1006","1306","1007","1307","1007","1007","1308","1007","1006","1309","1007","1310","1007","1003","1311","1004","1003"]},"In some example embodiments, wherein the performance of DPI includes an inspection for at least one of a QoS for the data packet, to meet network traffic and bandwidth considerations, to detect malware associated with the data packet, or enforce business conduct policies with regard to the data packet. Further, the descriptor includes at least one of a pointer to an address in memory, or a referent to the address in the memory. Additionally, the DPI module resides on a common compute blade with the OS. Moreover, the OS is executed on a core that is distinct from an additional core upon which the DPI module is executed. In some example embodiments, the performance of DPI on the data packet includes inspecting a load of the data packet.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 14","b":["1400","102","1401","301","201","302","202","1402","301","201","1403","302","202","1404","215","1404","1405","1404","1406","1405","215","216","1406","216","203","205","206"]},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 15","b":["1500","1400","1501","216","302","1502","202","302","205","1503","202","205","302","1504","202","1804","1506","1504","1505","1506","202","1505","1505","1508","1505","1507","1507","1508","202","204","204"]},{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 16","FIGS. 6 and 7"],"b":["1600","1400","1601","204","401","1602","204","401","205","207","1603","219","302","401","1603","206","215","207","301","1604","211","302","207","211","202","1605","202","401","205","1606","202","1606","1607","1606","1608","1608","202","1608","301","301","205","1607","1609","211","301","301","401","205"]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 17","b":["1700","1700","216","206","215","1701","1701","1702","1703","1701","1703","1705","1703","1707","1705","1704","201","202","1705","1706","1705","1707"]},"In some example embodiments, a removable physical storage medium is shown to be a single medium, and the term \u201cmachine-readable medium\u201d should be taken to include a single medium or multiple medium (e.g., a centralized or distributed database, and\/or associated caches and servers) that store the one or more sets of instructions. The term \u201cmachine-readable medium\u201d shall also be taken to include any medium that is capable of storing, encoding or carrying a set of instructions for execution by the machine and that cause the machine to perform any of the one or more of the methodologies illustrated herein. The term \u201cmachine-readable medium\u201d shall accordingly be taken to include, but not be limited to, solid-state memories, optical and magnetic medium, and carrier wave signals.","The methods shown herein may be implemented as data and instructions that are stored in respective storage devices, which are implemented as one or more computer-readable or computer-usable storage media or mediums. The storage media include different forms of memory including semiconductor memory devices such as DRAM, or SRAM, Erasable and Programmable Read-Only Memories (EPROMs), Electrically Erasable and Programmable Read-Only Memories (EEPROMs) and flash memories; magnetic disks such as fixed, floppy and removable disks; other magnetic media including tape; and optical media such as Compact Disks (CDs) or Digital Versatile Disks (DVDs). Note that the instructions of the software discussed above can be provided on one computer-readable or computer-usable storage medium, or alternatively, can be provided on multiple computer-readable or computer-usable storage media distributed in a large system having possibly plural, nodes. Such computer-readable or computer-usable storage medium or media is (are) considered to be part of an article (or article of manufacture). An article or article of manufacture can refer to any manufactured single component or multiple components.","In the foregoing description, numerous details are set forth to provide an understanding of the present invention. However, it will be understood by those skilled in the art that the present invention may be practiced without these details. While the invention has been disclosed with respect to a limited number of embodiments, those skilled in the art will appreciate numerous modifications and variations therefrom. It is intended that the appended claims cover such modifications and variations as fall within the \u201ctrue\u201d spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Some embodiments of the invention are described, by way of example, with respect to the following figures:",{"@attributes":{"id":"p-0004","num":"0003"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0005","num":"0004"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 17"}]},"DETDESC":[{},{}]}
