---
title: System and method for supporting fault tolerant job management in a cloud platform environment
abstract: In accordance with an embodiment, described herein is a system and method for supporting fault tolerant job management for use with a cloud computing environment. In accordance with an embodiment, the system comprises a job manager that manages the execution of jobs within the cloud environment including their job states, and a job manager service that provides an application program interface which receives administrative commands to be processed within the cloud environment as jobs. The job manager supports fault tolerant job processing including associating the jobs with checkpoints, recognizing a failover command for the jobs, and associating the jobs with work units of the administrative commands, and storing a state for each job upon processing each work unit of the command.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09497145&OS=09497145&RS=09497145
owner: ORACLE INTERNATIONAL CORPORATION
number: 09497145
owner_city: Redwood Shores
owner_country: US
publication_date: 20140903
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CLAIM OF PRIORITY","COPYRIGHT NOTICE","FIELD OF INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION","* * *","* * *","* * *","* * *","Example","Usage Example 1","Usage Example 2","* * *"],"p":["This application claims the benefit of priority to U.S. Provisional Application titled \u201cSYSTEM AND METHOD FOR MESSAGING, JOB MANAGEMENT, AND OTHER FUNCTIONALITY IN A CLOUD PLATFORM ENVIRONMENT\u201d, Application No. 61\/880,780, filed Sep. 20, 2013, which application is herein incorporated by reference.","A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure, as it appears in the Patent and Trademark Office patent file or records, but otherwise reserves all copyright rights whatsoever.","Embodiments of the invention are generally related to cloud computing, and providing of services within such environments, and are particularly related to system and method for supporting fault tolerant job management in a cloud environment.","A cloud computing environment enables responsibilities which previously may have been provided by an organization's own information technology department, to be delivered as service layers within a cloud environment, for use by consumers that are either internal (i.e., private) or external (i.e., public) to the organization. In some cloud environments, a user can issue commands and perform operations to manage the environment, some of which commands may take a long time to execute fully. However, when a job manager is used to execute commands, problems can occur, such as commands failing in execution but already persisting data, or creating inconsistencies.","In accordance with an embodiment, described herein is a system and method for supporting fault tolerant job management for use with a cloud computing environment. In accordance with an embodiment, the system comprises a job manager that manages the execution of jobs within the cloud environment including their job states, and a job manager service that provides an application program interface which receives administrative commands to be processed within the cloud environment as jobs. The job manager supports fault tolerant job processing including associating the jobs with checkpoints, recognizing a failover command for the jobs, and associating the jobs with work units of the administrative commands, and storing a state for each job upon processing each work unit of the command.","In accordance with an embodiment, a cloud computing environment enables responsibilities which previously may have been provided by an organization's own information technology department, to be delivered as service layers within a cloud environment, for use by consumers that are either internal (i.e., private) or external (i.e., public) to the organization. Described herein are a variety of hardware and\/or software components and features, which can be used in delivering an infrastructure, platform, and\/or applications to support cloud computing.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 1","FIG. 1"],"b":["10","20","60","70","15"]},"In accordance with an embodiment, each of the IaaS, PaaS, and\/or SaaS layers can generally include a variety of components. For example, in accordance with an embodiment, the IaaS layer can include a shared database hardware (e.g., an Exadata machine), and\/or shared application server hardware (e.g., an Exalogic machine); while the PaaS layer can include one or more PaaS services, such as a database service, application server service, and\/or WebCenter service; and the SaaS layer can include various SaaS services, such as enterprise applications (e.g., Oracle Fusion SaaS), and\/or ISV or custom applications. The cloud environment can also include a shared enablement and managing infrastructure , which provides enablement and management tools that support the various service layers, for example, identity management, virtual assembly builder, system provisioning, tenant management, or other components.","In accordance with an embodiment, the cloud environment can include a PaaS platform component  (referred to herein in some embodiments as a PaaS platform, or CloudLogic), which enables the provisioning of enterprise software applications within the environment. For example, the PaaS platform can be provided as an installable software suite that provides a self-service provisioning experience for enterprise applications such as Fusion Middleware (FMW).","As shown in , in accordance with an embodiment, the PaaS platform can include one or more service definition package (SDP) , service management engine (SME) , virtual assembly (VA) , PaaS administration server , service domain  including one or more service applications (apps)  for use by one or more cloud accounts or tenants , and\/or elasticity manager  components.","The example shown in  is provided as an illustration of an exemplary cloud environment and PaaS platform. In accordance with other embodiments, different and\/or other types or arrangements of components can be included.","In accordance with an embodiment, the following terms are used herein.\n\n",{"@attributes":{"id":"p-0044","num":"0067"},"figref":["FIG. 2","FIG. 2"],"b":["108","120","121","122","124"]},"In accordance with an embodiment, the PaaS administration server can be implemented as a WebLogic (WLS) server application, together with, e.g., Glassfish modules embedded therein to provide cloud platform functionality. A service domain, including a service app and service console , can be provided for housing enterprise applications, such as FMW applications, that will ultimately service user requests. In accordance with an embodiment, the service domain components may be instantiated multiple times as part of provisioning requests.","In accordance with an embodiment, provider server types that will be used by the PaaS administration server and the service domain, examples of which include LDAP , database , and Web tier  or load-balancer  providers, can be provided in pools that are not provisioned by the administration server, but are external services registered with the cloud environment. In accordance with an embodiment, the PaaS platform can make use of a load-balancer provider to forward all incoming, e.g., Web requests, that are directed to the services. For example, each service can be associated with a virtual host name that will be registered with the load-balancer provider during service provisioning.",{"@attributes":{"id":"p-0047","num":"0070"},"figref":["FIG. 3","FIG. 3"]},{"@attributes":{"id":"p-0048","num":"0071"},"figref":["FIG. 4","FIG. 4"],"b":["141","140","142","143","144"]},{"@attributes":{"id":"p-0049","num":"0072"},"figref":["FIG. 5","FIG. 5"],"b":["150","151","152"]},"In accordance with an embodiment, some service types may support both dedicated and multitenant uses, based on their particular configuration. Other service types may support either only dedicated use, or only multitenant use. Service types that are able to support multiple tenants on the same runtime can provision their runtimes in a multitenant manner, during the instantiation process, based on the configuration of the service type. A single instantiated service runtime that has been marked as multitenant-capable will be reused for a finite number of additional service provisioning requests, as determined by the service type and based on its configuration. Generally, it is left to the service application to support a particular tenancy mode; service applications that are not multitenant will only be able to support a single account for each service instance. Once a service has been instantiated from its VM assembly, end users  can interact with the system and the instantiated services, in the same manner as they would interact with an on-premise version of that service.",{"@attributes":{"id":"p-0051","num":"0074"},"figref":["FIG. 6","FIG. 6"],"b":["160","170","162","164","166","173","180","183","184","182","174","181"]},"In accordance with an embodiment, users can either be managed within an identity store  managed by the PaaS platform, or alternatively can be provided from an external, e.g., corporate LDAP, or other means of user identification; and can access the cloud account manager through an administration interface . Account and configuration data can also be stored on a file system or other means of storage that is accessible from nodes of a CPAS cluster.","Service Definition Package (SDP)",{"@attributes":{"id":"p-0053","num":"0076"},"figref":["FIG. 7","FIG. 7"],"b":["192","196","193","197","194","198","195","199"]},"For example, in accordance with an exemplary embodiment, each SDP can include an assembly, reference, package, archive, or template, which can be used to install a service on a particular virtualization provider (e.g., OVAB); an assembly bundled within the SDP or a reference to an assembly (e.g., an EC-specific reference); a service management engine (SME) plugin for the service type, which enables platform functionality such as elasticity metric gatherers, or alerts to be used with the service; a plugin for use with a VAB deployer (e.g., OVAB Deployer) during its assembly rehydration process; and other dependency and configuration information, such as scalability limits or whether the service is a multitenant or dedicated service.","In accordance with an embodiment, installing an SDP will install, e.g., the OVAB assembly into the OVAB repository; appropriate SME plugins will be registered with the cloud platform; and metric gatherers, alerts and actions will be installed in the PaaS platform. After a System Administrator installs the SDP, a Cloud Account Administrator can then use a cloud account administration interface to request for a service of that type.","In accordance with an embodiment, when an SDP is installed into a PaaS platform domain, it is consumed by an SDP Manager , which is responsible for obtaining a list of SDPs available to be installed the local system, downloading an SDP if necessary, installing parts of the SDP into the right places, maintaining a list of those SDPs that have been installed, and, if necessary, uninstalling an SDP by uninstalling all of its parts from the places they were previously installed.","In accordance with an embodiment, the SDP manager can interface with other system components by installing an SME plugin to the CPAS, which can then take responsibility for replicating the SME plugin to other CPAS instances in the cluster, installing the VAB assembly ,  into the VAB deployer, interfacing with other tools such as Enterprise Manager to provide a customized console interface for the service if the service provides one, and installing configuration data for the service into the CPAS. Subsequently, during realization  of a service, the service  can be realized as an instance of those service types defined by the SDP and installed as assemblies in the VAB repository.","Service Management Engine (SME)",{"@attributes":{"id":"p-0058","num":"0081"},"figref":"FIG. 8"},"In accordance with an embodiment, each service type supported in the PaaS platform domain maps to a specific service SME. A service SME handles all service-related activities, such as creation, monitoring, management, patching, upgrade, and deletion for that service. In accordance with an embodiment, the contract that is implemented by an SME is referred to as a Service Management Interface (SMI).","Referring to the example shown in , when OVAB is used as a virtualization provider, interaction with the OVAB Deployer can be handled by a virtualization API (e.g., an OVAB client API). In accordance with an embodiment, the orchestration process can then proceed as follows: a Cloud Account Administrator can discover, e.g., SOA service types ,  that are available in the PaaS platform domain, and initiate creation of an, e.g., SOA service. The orchestration engine iterates through the available service SMEs in the system, and determines which service SMEs can handle this service type . In this example, the orchestration engine can discover an appropriate SOA SME to handle creation of the SOA service. The orchestration engine can then call into the SME to get all provider dependencies for that SME . For example, the SME may return database and load-balancer provider dependencies. The orchestration engine can then call a get-user or similar configurable properties function for the SME, and expose those properties in a user interface, so that the Cloud Account Administrator can edit the properties if desired. User-provided inputs can be supplied to the SME, for example to update an OVAB deployment plan. The orchestration engine then performs any pre-provisioning association between the SME and the provider SMEs upon which it depends. For example, the orchestration engine can perform pre-provisioning association between the SOA SME and a database provider SME, which results in the creation of schema and tables required by the SOA service, in addition to populating the deployment plan with the database provider configuration. When any pre-provisioning association is complete, the orchestration engine can then call into the SME  to provision the service.","At this point, the deployment plan is generally complete except for network configurations. In accordance with an embodiment, the deployment plan together with an assembly ID can be pushed, e.g., to the OVAB API, which takes care of filling the deployment plan with the remaining network configurations. Then, the orchestration engine can call, e.g., a Web service API of the OVAB Deployer, to provision the OVAB assembly. Once the assembly is provisioned, the virtual machine information can be retrieved and passed back to the SME, which in turn passes the information back to the orchestration engine. The orchestration engine can then perform any post-provisioning association between the SME and the provider SMEs on which it depends. For example, post-provisioning association between the SOA SME and a load-balancer provider SME may result in the creation of a virtual server to handle and route requests for this SOA service.","Orchestration Engine (OE)",{"@attributes":{"id":"p-0062","num":"0085"},"figref":"FIG. 9"},"In accordance with an embodiment, the orchestration engine, as part of creating a service, ensures that dependencies of the service, such as its provider dependencies, are satisfied, by selecting appropriate providers, and coordinating association between the providers and service. The act of association can be performed during pre-provisioning and\/or post provisioning-phases. The act of installing and configuring an SME can be performed by the SDP manager as part of registering a pre-packaged service type or a customized service type. The orchestration engine helps expose the deployment plan configuration, which can be configured by the Cloud Account Administrator, including recognizing phases and tasks that match the requirements of the platform for its service creation action, and other life-cycle related activities.","In accordance with an embodiment, the orchestration engine also acts as a gateway for service management, monitoring, scaling actions that could be initiated by other containers in the PaaS platform domain, or by an administrator. For example, the elasticity engine, described in further detail below, can communicate with the orchestration engine to manage, monitor, and scale services based on a service's QoS configuration. The orchestration engine can also play a role in service maintenance actions, such as patching and upgrade, which may require disassociating or re-associating services in a phased manner.","In accordance with an embodiment, services created by a cloud account administrator are visible and accessible only to that particular cloud account (tenant), and are isolated from other cloud accounts in the PaaS platform domain. Such isolation can be provided by the orchestration engine with the help of a cloud account management module.","In accordance with an embodiment, SMEs can be registered with the orchestration engine such that multiple SMEs for a given \u201cfamily\u201d of service (e.g., \u201cdatabase\u201d) can be present in the system. A default SME can also be configured for a particular service family on a per-cloud account basis.","As shown in , in accordance with an embodiment, the orchestration and service management components can interface with the virtualization layer through a virtualization service , plugin , and virtualization API  that abstracts supported virtualization operations. In accordance with an embodiment that uses OVAB, this API can be an OVAB Deployer interface, which enables OVAB Deployer to perform the tasks of assembly creation. In accordance with an embodiment, the orchestration engine\/SME can upload and deploys assemblies through the OVAB virtualization API, in addition to managing their lifecycle.","To support developer or demonstration scenarios, in accordance with an embodiment, the system can also implement solutions that run on native OS processes (i.e., with no virtualization). This capability can be implemented by providing a \u201cphysical plugin\u201d, which implements a portion of the virtualization API.","Elasticity Manager (EM)",{"@attributes":{"id":"p-0069","num":"0092"},"figref":["FIG. 10","FIG. 10"],"b":["260","262","264","265","270","272"]},"In accordance with an embodiment, a metric gatherer is an object that collects and maintains metric data about a service periodically. For example, a metric gatherer may periodically collect heap statistics such as used or committed memory; or metrics regarding CPU usage. Generally, the metric gatherers provide information about the state of some resource usage. Metrics can also be provided by external monitoring tools, for example by a Java bean component.","In accordance with an embodiment, an alert object periodically checks the health of a service in an environment, by analyzing metric data gathered by one or more metric gatherers over a period of time. For example, an alert may examine CPU usage for a previous several minutes to determine if the environment is under stress. After the alert determines the state of the service or environment, it can execute an action, such as sending an email, logging a message, sending an event, or scaling-up or scaling-down a service. In accordance with an embodiment, an alert can take multiple actions.","In accordance with an embodiment, the elasticity manager can include a unified Expression Language (EL) engine , which allows alerts and metric gatherers to be specified as EL expressions. In accordance with an embodiment, the elasticity manager allows external EL Resolver objects  to be registered, which enables other types of objects, such as MBeans or POJOs, to be used in an expression.","Update and Patching of SDPs","In accordance with an embodiment, services can be periodically maintained to ensure that they are up-to-date with, e.g., bug fixes, security updates and configuration changes. To help ensure homogeneous environments, services should be updated in a timely manner, with the same set of patches and configuration updates. In accordance with an embodiment, an update is defined to be a change which has to be made to the system; examples of which include application of a security patch, upgrade of a component, or changing of a configuration value. Depending on the type of update, some updates may require a service or system downtime, while other updates may not require a downtime; and each of these scenarios can be taken into account.","User Messaging Service","In accordance with an embodiment, the system can include a user messaging service for use with a cloud environment. The user messaging service allows a cloud account user to indicate a preference that, while operations are being performed within the cloud environment, such as the provisioning of a particular service, status notifications that are intended for that user, such as completion of an operation or operational alerts, should be communicated to that user via one or more preferred channels, for example by email, instant messaging, social media, or another communication medium.","For example, in accordance with an embodiment, the system can utilize a user messaging service such as, for example, Oracle User Messaging Service (UMS), which is provided as a component of Oracle Java Runtime Files (JRF), and which in turn includes a set of libraries and applications that can be used by environments such as Fusion Middleware or other software products. In accordance with other embodiments, other types of user messaging services can be used.","In accordance with an embodiment, the user messaging service integrates a plurality of messaging capabilities that can be used to send notifications to users. For example, the pluggable architecture of UMS allows different drivers to be integrated into UMS, to provide email, XMPP, SMS, and\/or instant messaging capabilities.","In accordance with an embodiment, the user messaging service is associated with","A user messaging server, which orchestrates message flow between applications and users, including routing outbound messages from client applications to appropriate drivers, and routing inbound messages to the correct client applications;","User messaging drivers, which connect the user messaging service to various messaging gateways, adapting content to protocols as necessary; and","User messaging clients, which implement the business logic of sending and receiving messages.","In accordance with an embodiment, a user communication preferences component such as, for example, Oracle User Communication Preferences (UCP), allows a user who has access to multiple channels to control how, when, and where they should receive messages, including defining filters or delivery preferences that specify which channel a particular message should be delivered to, and under which circumstances.","In accordance with an embodiment, the user communication preferences component can provide a user interface and an API, to provide access by a user to manage that user's channels and delivery preferences, so that the user messaging service can then acquire the user's delivery preferences and send messages accordingly.","For example, as described above, in accordance with an embodiment, the user messaging service and user communications preference can be provided by UMS and UCP respectively.","By sending messages through, e.g., UMS, an application will indirectly use the UCP service. In accordance with other embodiments, other types of user messaging services and user communication preferences components can be used.","In accordance with an embodiment, a PaaS platform component, such as a CloudLogic platform or other cloud environment as described above, can integrate with a user messaging service, such as UMS, to provide messaging capabilities within the cloud environment.","For example, in an environment such as Cloud Logic, where operations can be long-running and complex, platform administrators (padmins) and cloud account administrators (cadmins) may wish to be notified when important events occur.","For example, when a service is being provisioned within the cloud environment, if it is likely to take a long time for the provisioning to complete, then, rather than poll to see when the service is provisioned, a cloud account or other user can choose to be notified that the provisioning has completed.","In accordance with an embodiment, the notification of, e.g., the completion of an action, can be provided by the preferred channel for that account or user. Similarly, if a platform-related alert reaches a critical state, a cloud account user can choose to be notified of the alert by their preferred channel.","Notifications from a PaaS or CloudLogic platform, or other cloud environment, can be similarly sent to various users of the platform or environment, using the user messaging service.","In accordance with an embodiment, as referred to herein, a notification can be any mechanism that informs of a particular event. A notifiable is an event that must be conveyed to interested parties, e.g., users. A filter is a message delivery preference rule that controls how, when, and where a user receives messages. A channel generally refers to one of the addresses with which that channel can communicate.","In accordance with an embodiment, as further referred to herein, a business term is a named attribute for a message, such as a subject. Business terms can be extracted from messages or supplied by applications, and can be used to compare with a specified value in a filter condition, to select the filter. A condition is a combination of a business term, an operator and a specified value. A fact about a message can be used to compare against the value to evaluate the truth of the condition. An action is the action to be taken if the specified conditions in a filter are true, for example to not send a message, or to send a message to a first available channel, or to send a message to all selected channels.",{"@attributes":{"id":"p-0092","num":"0115"},"figref":"FIG. 11"},"In accordance with an embodiment, the system can include a UMS driver-agnostic way of sending notifications, and a UMS driver-specific configuration details as to who will configure this and where it will be stored. Command framework integration, and integration with, e.g., the elasticity manager, is also important to be able to send notifications for commands, and for UMS and hence UCP for alerts and actions to be able to send notifications.","As shown in , in accordance with an embodiment, a user messaging (e.g., a UMS) server  hosts a user messaging service . In accordance with an embodiment, the user messaging service recognizes user communication preferences (UCP) , which determine how communications should be communicated to different users.","In accordance with an embodiment, a plurality of communication filters  can be used to filter which, and how, messages should be communicated.","For example, in accordance with an embodiment, the filters can use a combination of business terms , conditions , and actions , as described above, to control the filtering and communication of messages.","In accordance with an embodiment, users can be associated with user channel settings . The user messaging service can also support a plurality of plugins , , , that can be used to communicate with different communication channels , for example email , XMPP , or SMS channels respectively.","Within the PaaS platform, or other cloud environment, such as a CloudLogic environment, a notifier , for example a UMS client library, can be used to communicate notifications to the user messaging service.",{"@attributes":{"id":"p-0099","num":"0122"},"figref":"FIG. 12"},"As shown in , in accordance with an embodiment, a user can specify user communication preferences , which will be associated with that user. This user-specified information can then be provided to configure  the notifier at the PaaS platform or cloud environment.",{"@attributes":{"id":"p-0101","num":"0124"},"figref":"FIG. 13"},"As shown in , as notifiable events  occur within the cloud environment, the notifiable events are communicated , via the notifier, to the user messaging service.","In accordance with an embodiment, the user messaging service can then, depending on the user channel settings, utilize an appropriate plugin and communication channel , , to provide user notifications  to users, according to the user-specified communication preferences.","Notifiers","In accordance with an embodiment, the notifier is responsible for loading the notification preferences from a User Communication Preferences (UCP) API for a user, abstracting the notification process, sending notifications, and checking on the status of a notification.","CPAS Configuration","In accordance with an embodiment, the cloud platform administration service (CPAS) must be configured for the communication technologies that are desired to be supported.","For example, in accordance with an embodiment the user messaging service can have an SMTP server available for sending email, and a Twitter account available for sending tweets. Such configuration can be specified, and modified as necessary, for example for SMS, XMPP, and Twitter:",{"@attributes":{"id":"p-0107","num":"0130"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"driverProperties = SmppDriverProperties( )"},{"entry":"driverProperties.SenderAddresses = \u201cSMS:1234\u201d"},{"entry":"driverProperties.SmsAccountId = \u201c1234\u201d"},{"entry":"driverProperties.RangeSetNull = \u201ctrue\u201d"},{"entry":"driverProperties.SmsServerHost = \u201c127.0.0.1\u201d"},{"entry":"driverProperties.TransmitterSystemId = \u201csmppclient1\u201d"},{"entry":"driverProperties.ReceiverSystemId = \u201csmppclient1\u201d"},{"entry":"driverProperties.TransmitterSystemType = \u201cLogica\u201d"},{"entry":"driverProperties.ReceiverSystemType = \u201cLogica\u201d"},{"entry":"driverProperties.TransmitterSystemPassword = \u201cpassword\u201d"},{"entry":"driverProperties.ReceiverSystemPassword = \u201cpassword\u201d"},{"entry":"driverProperties.ServerTransmitterPort = \u201c2775\u201d"},{"entry":"driverProperties.ServerReceiverPort = \u201c2775\u201d"},{"entry":"driverProperties.ExtraErrorCode = \u201c\u201d"},{"entry":"driverProperties.LocalAddress = \u201c\u201d"},{"entry":"configUserMessagingDriver(baseDriver=\u201csmpp\u201d, appName= \u201csmpp\u201d,"},{"entry":"driverProperties=driverProperties)"},{"entry":"*XMPP"},{"entry":"driverProperties = XmppDriverProperties( )"},{"entry":"driverProperties.IMServerHost = driverConfigXmppServer"},{"entry":"driverProperties.IMServerUsername = hostName"},{"entry":"driverProperties.IMServerPassword = \u201cwelcome1\u201d"},{"entry":"configUserMessagingDriver(baseDriver=\u201cxmpp\u201d, appName=\u201cxmpp\u201d,"},{"entry":"driverProperties=driverProperties, clusterName)"},{"entry":"*Twitter"},{"entry":"wls:\/base_domain\/serverConfig> dprops = TwitterDriverProperties( )"},{"entry":"wls:\/base_domain\/serverConfig> dprops.ConsumerKey =\u2018hej\u2019"},{"entry":"wls:\/base_domain\/serverConfig> dprops.ConsumerSecret=\u2018hejigen\u2019"},{"entry":"wls:\/base_domain\/serverConfig> dprops.AccessToken=\u2018blaha\u2019"},{"entry":"wls:\/base_domain\/serverConfig>"},{"entry":"dprops.AccessTokenSecret=\u2018blahahahahaha\u2019"},{"entry":"wls:\/base_domain\/serverConfig> dprops.AuthenticationMode=\u2018OAuth\u2019"},{"entry":"wls:\/base_domain\/serverConfig> configUserMessagingDriver"},{"entry":"(baseDriver=\u2018twitter\u2019, appName=\u2018twitter\u2019,driverProperties=dprops)"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, User Communication Preferences (UCP) allows a user who has access to multiple channels to control how, when, and where they receive messages. For example, users can define filters, or delivery preferences, that specify which channel a message should be delivered to, and under what circumstances.","In accordance with an embodiment, information about a user's channels and filters can be stored in a database supported for use with, e.g., Oracle Fusion Middleware. In accordance with an embodiment, since preferences are stored in a database, this information can be shared across all instances of User Communication Preferences within a domain. Generally, UCP does not provide services for message delivery, rather it provides a user interface and APIs to access and manage a user's channels and delivery preferences.","In accordance with an embodiment, when a message is addressed to a user, the user messaging service (UMS) acquires the user's delivery preferences from a UCP service, and sends the message according to the user's preferences.","For an application developer, User Communication Preferences provides increased flexibility. By sending messages through UMS, an application is indirectly using UCP service. Applications can also directly access UCP services by calling UCP APIs, to access and manage a user's preferences, and by integrating with UCP using a task flow library.","Command Line Interface (CLI) and Per-User Configuration","In accordance with an embodiment, a per-user configuration can be specified, which can indicate the preferences for the notification. A user can specify the default channel for communication. Additionally a user can specify filters and business rules for different channels.","In accordance with an embodiment, all preferences are based per user. For example, in the examples illustrated below the \u201c--channel\u201d parameters provided for the user must match the group of allowed values chosen from: EMAIL; TWITTER; SMS; XMPP. In accordance with an embodiment, this will create a new preference if it does not exist, or else will update the original one using the User Communication Preferences API:",{"@attributes":{"id":"p-0114","num":"0137"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"padmin\/cadmin set-notification-preference --user <user> --channel"]},{"entry":[{},"<channel>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"--setdefault[=<setdefault(default:true)>] <default:true>"]},{"entry":[{},"-- value <value> nameOfPreference"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":{}},{"@attributes":{"id":"p-0115","num":"0138"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"padmin\/cadmin set-notification-preference --user johndoe --channel"]},{"entry":[{},"EMAIL"]},{"entry":[{},"\u2003\u2003--value johndoe@oracle.com WorkEmail"]},{"entry":[{},"padmin\/cadmin set-notification-preference --user johndoe --channel"]},{"entry":[{},"TWITTER"]},{"entry":[{},"\u2003\u2003--value johndoe MyTwitter"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{},"ul":{"@attributes":{"id":"ul0002","list-style":"none"},"li":["padmin\/cadmin delete-notification-preference --user <user> nameofPreference\n\nFor example:\n","padmin\/cadmin delete-notifcation-preference --user johndoe WorkEmail\n\nThis command will list the preferences specified by user:\n","padmin\/cadmin list-notification-preferences --user <user>"]}},"For example:\n\n",{"@attributes":{"id":"p-0117","num":"0144"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"Name","Channel","Value","Default"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"WorkEmail","EMAIL","john.doe@oracle.com","true"]},{"entry":[{},"WorkPhone","SMS","408-888-9999","false"]},{"entry":[{},"MyTwitter","TWITTER","johndoe","false"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, a messaging filter defines rules on how to handle incoming messages addressed to a user. For example, messaging filters enable users to build filters that specify the type of messages they want to receive, and also the channel through which to receive these messages. In accordance with an embodiment, a filter is composed of two primary sections, a condition (If) section, and an action (Then) section.","For each incoming message, the filters are evaluated to determine the appropriate filter that must be selected for handling the message. The condition section determines the circumstances under which a filter is selected; while the action section specifies how the message is handled if the filter is selected.","An example of how a user can create filters and add multiple conditions to the filter is illustrated below. For example, to create a filter that will be selected for both conditions \u201cSubject contains create-service\u201d and \u201cStatus contains Success\u201d, the filter can be selected to MATCH_ALL so that both the conditions are matched:",{"@attributes":{"id":"p-0121","num":"0148"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"padmin\/cadmin create-notification-filter"]},{"entry":[{},"--match=<MATCH_ANY|MATCH_ALL>"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"--action= <PARALLEL|SERIAL|NO_ACTION>"]},{"entry":[{},"--description <desc> filtername"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":{}},{"@attributes":{"id":"p-0122","num":"0149"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"padmin\/cadmin create-notification-filter --match=MATCH_ANY"]},{"entry":[{},"\u2003\u2003--action= PARALLEL --description \u201csuccess filter\u201d myfilter"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In accordance with an embodiment, the following parameters can be used to specify what action needs to be taken for a filter: PARALLEL: Send to all selected channels simultaneously from the notification preferences; SERIAL: Send to first available channel in the notification preference; NO_ACTION: Do not send message.","In accordance with an embodiment, a command line interface (CLI) can be used to list notification filters, for example:\n\n",{"@attributes":{"id":"p-0125","num":"0156"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"padmin\/cadmin create-notification-condition -business-term <business"},{"entry":"term>"},{"entry":"\u2003\u2003--operand <operand> --operation <operation> --filter <filtername>"},{"entry":"condition_name"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0126","num":"0157"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"padmin\/cadmin create-notification-condition --business-term=Status"},{"entry":"\u2003\u2003--operand = Contains --operation=Sucess --filter myfilter"},{"entry":"statusCondition"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{},"ul":{"@attributes":{"id":"ul0005","list-style":"none"},"li":"padmin\/cadmin list-notification-conditions\n\nFor example:\n"}},{"@attributes":{"id":"p-0127","num":"0159"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"padmin\/cadmin list-notification-conditions \\--filtername=myfilter"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"42pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},"OPER-",{}]},{"entry":["CONDITION","FILTER","BUSINESS_TERM","ATION","OPERAND"]},{"entry":["statusCondition","myfilter","Status","Contains","Success"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}},"br":{},"ul":{"@attributes":{"id":"ul0006","list-style":"none"},"li":["padmin\/cadmin delete-notification-condition <condition name>\n\nFor example:\n","padmin\/cadmin delete-notification-condition statusCondition"]}},"In accordance with an embodiment, commands which need notifications to be turned on, can be referred to as notifiable jobs. Any command which needs to send a notification can be annotated with a @Notifiable annotation. An administrative command context (AdminCommandContext) can then return a notifier (Notifier) which can be used to notify the events. In accordance with an embodiment, this is what the annotation looks like:\n\n","In accordance with an embodiment, by annotating a command with @Notifiable, the command framework will take care of creating a notification event (NotificationEvent) from the action report (ActionReport) of the command; getting the user preferences for this user; and sending the notification based on the user preferences.",{"@attributes":{"id":"p-0130","num":"0165"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"@Notifiable"]},{"entry":[{},"public class FakeCommand implements AdminCommand"]},{"entry":[{},"{"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In accordance with an embodiment, a command which is annotated with @Notifiable can invoke a notifyEvent( ) method of the Notifier, to send any events to the user:",{"@attributes":{"id":"p-0132","num":"0167"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"@Inject Notifier notifier;"]},{"entry":[{},"@Override"]},{"entry":[{},"public void execute(AdminCommandContext context) {"]},{"entry":[{},"..."]},{"entry":[{},"notifier.notifyEvent(new NotifiableEvent.Builder<String>( ).name-"]},{"entry":[{},"(\u201cNotification for create-service"]},{"entry":[{},"command\u201d).data(\u201cFinished creating the service\u201d).build( ));"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In accordance with an embodiment, notifications require the JRF and UMS API to be available, and will not work in the case of a standalone CPAS. An example NotifiableEvent class and API is provided below:",{"@attributes":{"id":"p-0134","num":"0169"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\/**"},{"entry":"* This is a event class for all notifications."},{"entry":"* A <code>NotifiableEvent<\/code> can be triggered during the following"},{"entry":"cases"},{"entry":"* 1. Commands which are annotated with <code>@Notifiable<\/code> can"},{"entry":"* automatically send notification once the command is completed*"},{"entry":"* 2. When an alert are triggered"},{"entry":"* 3. Changes to service lifecycle"},{"entry":"* The <code>NotifiableEvent<\/code> can be sent via the UMS API"},{"entry":"* to the channel registered by the user. Additionally there can be"},{"entry":"* listeners which can subscribe to the events"},{"entry":"*\/"},{"entry":"public class NotifiableEvent<T> {"},{"entry":"\/**"},{"entry":"* The name of the event"},{"entry":"*\/"},{"entry":"private String eventName;"},{"entry":"\/**"},{"entry":"* The account associated with the event"},{"entry":"*\/"},{"entry":"private String accountName;"},{"entry":"\/**"},{"entry":"* The serviceName associated with the event"},{"entry":"*\/"},{"entry":"private String serviceName;"},{"entry":"\/**"},{"entry":"* The environment associated with the event"},{"entry":"*\/"},{"entry":"private String environmentName;"},{"entry":"\/**"},{"entry":"* The user associated with the event"},{"entry":"*\/"},{"entry":"private String subject;"},{"entry":"\/**"},{"entry":"* The timestamp for the event"},{"entry":"*\/"},{"entry":"private long timestamp;"},{"entry":"\/**"},{"entry":"* Additional information about the event."},{"entry":"* This can be an ActionReport which can be added to the event"},{"entry":"* or a Metric Gatherer which contains data about the alerts"},{"entry":"* See <code>MessageFormatter<\/code>to provide implementations"},{"entry":"* of serializing this data"},{"entry":"*\/"},{"entry":"private T data;"},{"entry":"public static class Builder<T> {"},{"entry":"private String eventName;"},{"entry":"private String tenantName;"},{"entry":"private String serviceName;"},{"entry":"private String environmentName;"},{"entry":"private String subject;"},{"entry":"private T data;"},{"entry":"private long timestamp;"},{"entry":"..."},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"In accordance with an embodiment, notifiable events (Notifiable Events) can be of various types, for example resource\/provider lifecycle events; sensor events; user defined events; and service lifecycle events. Exemplary events included service created, service deleted, service started, service stopped, service modified, service scale up started, service scaled up service scale up failed, service scaled down, service scale down stated, service scale down failed, service maintenance started, service maintenance ended service locked, and service unlocked.","In accordance with an embodiment, a --notify qualifier can be used to enable the notification for commands which are not annotated with @Notifiable. This will add the notification feature for some command which has not been annotated with @Notifiable by default.\n\n","For example, the above CLI will add notification support to the command, and send notifications based on user \u201cjohndoe's\u201d preference.","Media Format Definitions","In accordance with an embodiment, the system can provide a way for a command implementor to define different message formats for different requirements, e.g., email vs Twitter (which has a 140 character limitation), for example:",{"@attributes":{"id":"p-0139","num":"0175"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"@Contract"]},{"entry":[{},"public interface MessageFormatter {"]},{"entry":[{},"\/**"]},{"entry":[{},"* This method identifies if NotifiableEvent can be handled"]},{"entry":[{},"* by this MessageFormatter"]},{"entry":[{},"*"]},{"entry":[{},"*\/"]},{"entry":[{},"public boolean handles( NotifiableEvent c);"]},{"entry":[{},"\/**"]},{"entry":[{},"* This method will customize a long message for a particular"]},{"entry":[{},"* event in the format required for the Notification Type."]},{"entry":[{},"* @param e The type of event this formatter can handle"]},{"entry":[{},"* @return an Object which can be used by the MessageProvider to"]},{"entry":[{},"* send the message using UMS"]},{"entry":[{},"*\/"]},{"entry":[{},"public Object formatLongMessage(NotifiableEvent e);"]},{"entry":[{},"\/**"]},{"entry":[{},"* This method will customize a short message for a particular"]},{"entry":[{},"* event in the format required for the Notification Type."]},{"entry":[{},"* @param e The type of event this formatter can handle"]},{"entry":[{},"* @return an Object which can be used by the MessageProvider to"]},{"entry":[{},"* send the message using UMS"]},{"entry":[{},"*\/"]},{"entry":[{},"public Object formatShortMessage(NotifiableEvent e);"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In accordance with an embodiment, if the implementation of a message formatter (MessageFormatter) can handle the NotifiableEvent based on the data, it will be asked to compose a specific long and short message for that type of data and event. For example, the long messages can be used for, e.g., Email and IM; while the short messages can be used for, e.g., Twitter and SMS channels. There can be different implementations for this class, for example:","ActionReportMessageFormatter: In accordance with an embodiment, this is a MessageFormatter that will handle NotifiableEvents which have an ActionReport associated with it, and can format a long message regarding the status of a command, and a short message which will contain only the significant details from the ActionReport.","MetricGatherlMessageFormatter: In accordance with an embodiment, this is a specialized MetricGatherFormatter, which will handle NotifiableEvents which have a MetricGatherer and a MetricConfiguration associated with it, and can be used to format an email message regarding the state of a Metric and a short message containing some relevant information for a metric. Users can plug in their implementation for a MessageFormatter, which will implement the handles method to identify the type of notification, and then provide an implementation for the best way to format the event.","Interaction with Elasticity Manager","In accordance with an embodiment that provides information to an elasticity manager, a user can create sensors and add actions to sensors, for example:",{"@attributes":{"id":"p-0144","num":"0180"},"tables":{"@attributes":{"id":"TABLE-US-00014","num":"00014"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"cadmin create-sensor --tenant acme --service my-java-service"},{"entry":"\u2003\u2003--alert-type ServiceMonitorAlert"},{"entry":"\u2003\u2003-- properties ServiceMonitorName=jvm_heap_service_monitor"},{"entry":"\u2003\u2003HeapServiceMonitorAlert"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0145","num":"0181"},"tables":{"@attributes":{"id":"TABLE-US-00015","num":"00015"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"cadmin create-sensor-action --account acme --service my-java-service"},{"entry":"--action-name=notify HeapSMCriticalNotifyAction"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0146","num":"0182"},"tables":{"@attributes":{"id":"TABLE-US-00016","num":"00016"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"cadmin add-action-to-sensor-state --account acme --service my-java-"},{"entry":"service"},{"entry":"\u2003\u2003--state CRITICAL --alert-name HeapServiceMonitorAlert"},{"entry":"HeapSMCriticalNotifyAction"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"In accordance with an embodiment, when an alarm state is reached and the Notifier action is executed, a NotifiableEvent containing the ActionContext will be generated. The ActionContext should have details of the subject, from which the Notifier can get the user's preferences. From the ActionContext of the NotifierAction, it is also possible to get the ServiceMonitor associated with the action based on EL expressions, and get details from the ServiceMonitor on what triggered the alert.","In accordance with an embodiment, an example NotifierAction can be:",{"@attributes":{"id":"p-0149","num":"0185"},"tables":{"@attributes":{"id":"TABLE-US-00017","num":"00017"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"@Service(name=\u201cnotify\u201d)"},{"entry":"public class NotifierAction extends AbstractAction {"},{"entry":"@Inject"},{"entry":"Notifier notifier;"},{"entry":"@Override"},{"entry":"public void execute(ActionContext context) {"},{"entry":"String account = (String) context.getContextData( ).get(\u201caccount\u201d);"},{"entry":"String envName = (String) context.getContextData( ).get(\u201cenvName\u201d);"},{"entry":"String serviceName = (String) context.getContextData( ).get-"},{"entry":"(\u201cserviceName\u201d);"},{"entry":"notifier.notifyEvent(new"},{"entry":"NotifiableEvent.Builder<String>( ).name(context.getActionName( ))"},{"entry":".accountName(account)"},{"entry":".serviceName(serviceName)"},{"entry":".environmentName(envName)"},{"entry":".data(context).build( ));"},{"entry":"}}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, emails can be customized by specifying templates to control the content. Templates can be provided per account, for example by using a folder relative to the tenants folder which can specify the directory of the templates. The template can be an HTML file with CSS for images and headers. Templates can be added per tenant by the administrator.","Below is an example of how the CLI can be used to add template files. The template can control the images and headers, and the data can be presented by the message formatters. Just as tenant admins can support adding templates, there can similarly be support to add templates for padmin related commands. Before the messages are composed for email, the Notifier service can check if there is any template file provided, and if so use that:\n\n","In accordance with an embodiment, if a user is a padmin and cadmin then the cadmin's template will be used. Only one type of template will be allowed per tenant, which the load-notification-template CLI can validate. In accordance with an embodiment, if any other template exists for the tenant, then it will overwrite it with the latest one specified. This command will list the notification templates for the user:\n\n",{"@attributes":{"id":"p-0153","num":"0191"},"tables":{"@attributes":{"id":"TABLE-US-00018","num":"00018"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"105pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"TEMPLATE_NAME","DATE_CREATED"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"acme","20013-07-20-12:12:30"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, Notification Listeners can be added to listen for specific events. For example, an EM Cloud Control team may like to be notified by a REST Endpoint when a Service Lifecycle event occurs or alerts happen. In accordance with an embodiment, to provide support for this use case, NotificationListeners can be registered for specific events, and then the events can be published to the subscribers. Example implementations of the subscriber can be a REST endpoint, or a JMS queue. For example, in the case of EM Cloud Control, a REST endpoint can be deployed on the server where the EM Cloud Control resides. The Notifier will then send event-related information to the REST endpoint:","In accordance with an embodiment, this will configure an event listener specified by the name which will listen for events at the url specified by URL.\n\n","In accordance with an embodiment, this will delete the event listener specified by the name:\n\n",{"@attributes":{"id":"p-0157","num":"0197"},"figref":"FIG. 14"},"As shown in , at step , a cloud environment that supports provisioning of enterprise applications as services is provided at one or more computers.","At step , information is received, at a notifier component, describing notifiable events that occur within the cloud environment during the provisioning or management of the services.","At step , the notifiable event information is communicated to a user messaging service at a user messaging server.","At step , the user messaging service is configured, according to one or more user communication preferences, to communicate to users, user notifications describing the notifiable events, via one or more channels, according to the preferences associated with the users.","Job Manager","In accordance with an embodiment, the system can include a job manager (Job Manager) for use with a cloud environment. For example, a cloud account user may use commands to perform operations within the cloud environment, such as the provisioning of a particular service. In accordance with an embodiment, commands can be associated with jobs. A job manager can then perform housekeeping tasks, such as purging jobs according to a retention policy, and performing any necessary cleanup. In accordance with an embodiment, command line and other interfaces can be provided that enable a user to list jobs started by users, and to perform security checks to ensure tasks are authorized.","In accordance with an embodiment, a job can be considered an entity that refers to an administration command. For example, any administration command (administrative command) annotated with @ManagedJob or @Progress annotation, or started by the client using --detach option, can be associated with a job, which is then managed by the job manager.","In accordance with an embodiment, the job manager's responsibilities include generating ids for the jobs; cleaning up for jobs which are done; serving as a registry for jobs; providing security validation for which users are authorized to access already running commands; storing the results for a specific configurable period of time; providing APIs for persisting jobs; triggering who will take over orphan jobs in case the cluster shape changes; and providing a thread pool for executing commands.",{"@attributes":{"id":"p-0165","num":"0205"},"figref":"FIG. 15"},"As shown in , in accordance with an embodiment, a job manager  can include a job registry . A job manager service , together with a job manager service API , provides access to the job manager.","In accordance with an embodiment, the job manager can be used to provision or manage services ,  to a plurality of clusters within the cloud environment, including a first cluster A , and a second cluster B .","In accordance with an embodiment, administrative command or job status can be stored in a command\/job status database , for use during processing of the jobs. For commands that take longer to execute, the system must store information related to progress status, and results. Additionally, a retention policy can be employed to save the results after the command is executed so that they can be retrieved later. For example, a housekeeping task can purge the jobs according to the retention policy, for example using a policy that is time based so in specified intervals the purging tasks will operate in to take care of the cleanup.","CLIs can also be provide to list the jobs started by a user, and perform security checks to ensure who is authorized for the various tasks.",{"@attributes":{"id":"p-0170","num":"0210"},"figref":"FIG. 16"},"As shown in , in accordance with an embodiment, when an administrative command  is received at the job manager service, the service can assign  job ids  to those administrative commands or related tasks.",{"@attributes":{"id":"p-0172","num":"0212"},"figref":"FIG. 17"},"As shown in , in accordance with an embodiment, the job manager can control, in combination with the cloud platform administration service, the processing of, e.g., administrative commands, as jobs ,  to provision the services at the clusters, or to otherwise perform actions on the platform or cloud environment.","In accordance with an embodiment, a job status information  can be stored in the command\/job status database, for use during processing of the jobs, and to support additional functions, such as administrative command progress status, and detachable administrative commands.","Job Registry","In accordance with an embodiment, a job manager service (Job Manager Service) is responsible for generating unique, atomic, human readable ids for jobs which are executed. The job ids can be similar to unix process ids, for example ranging from 1 to a max value. When an id is requested, the Job Manager will check if the id is not in use, or else allocate the next one. When the max ids are reached, the Job Manager will start from 1 and find the next non-allocated id to issue.","In accordance with an embodiment, a housekeeping task can clear the jobs from the Job Manager when the retention limits time has elapsed, and free the allocated ids.","Job States","In accordance with an embodiment, a command can be in one of the states EXECUTING\u2014the job is currently executing; or COMPLETED\u2014the job has completed execution.","A completed job can also have an exit code, which will identify if the administrative or other command has succeeded, failed or succeeded with warnings, for example SUCCESS\u2014the command is successfully completed; FAILURE\u2014the command is completed and execution failed; or WARNING\u2014the command is completed and there was a warning","When a command is first started by the client, it is in an EXECUTING state. If the command has finished execution of the command then its state is changed to COMPLETED state, and the exit code is set to SUCCESS, FAILURE or WARNING. The time the command finished execution is stored for later housekeeping.","In accordance with an embodiment, a command action report can be persisted to a file. The Job Manager will purge the jobs, job ids, action reports after a defined period (retention_period) has elapsed from the time the command completed.","Job Manager Configuration","In accordance with an embodiment, CLIs can be defined for use with the job manager. The job manager can be configured as a configuration element at the domain level, for example using:",{"@attributes":{"id":"p-0182","num":"0222"},"tables":{"@attributes":{"id":"TABLE-US-00019","num":"00019"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"configuremanagedjobs"]},{"entry":[{},"\u2003\u2003--jobretentionperiod"]},{"entry":[{},"\u2003\u2003--cleanupinitialdelay"]},{"entry":[{},"\u2003\u2003--cleanuppollinterval"]},{"entry":[{},"\u2003\u2003--persist"]},{"entry":[{},"\u2003\u2003--inmemoryretentionperiod"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, the time periods can be specified in Hh|Mm|Ss for hours, minutes, or seconds, for example:",{"@attributes":{"id":"p-0184","num":"0224"},"tables":{"@attributes":{"id":"TABLE-US-00020","num":"00020"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin configuremanagedjobs"]},{"entry":[{},"\u2003\u2003--jobretentionperiod=36h"]},{"entry":[{},"\u2003\u2003--cleanupinitialdelay=2m"]},{"entry":[{},"\u2003\u2003--cleanuppollinterval=10m"]},{"entry":[{},"\u2003\u2003--inmemoryretentionperiod=1h"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, the Job Manager is configured to retain results once the command is finished for a specific duration of time. After the duration of time has elapsed for the job and associated results, the progress statuses should be removed by the Job Manager Service.","Security","In accordance with an embodiment, security can be configured that allows the administrator to control whether jobs are accessible by just the owner, or by other members of the owner's account, as well as the sys-admin. The default is to allow cloud account admins for the same account to view each others' jobs, and to allow system admins to view system admin jobs and account jobs.","Persistence","In accordance with an embodiment, the Job Manager can provide APIs to persist its contents to a file based storage, so that if the server restarts the jobs related information is not lost. Additionally if there are other jobs which were executed successfully before the server crashes, the system can retrieve information about those jobs.","CPAS Commands","In accordance with an embodiment, for every job for an account in a \/cloud scope there can be an entry in a CAM store jobs.xml file. All the jobs for all users in that account are stored in the same file. All CPAS commands can take a \u2018user\u2019 parameter that represents the user executing the command. All of the commands operating on account specific data can also take a parameter that specifies which \u2018account\u2019 to target.","Most of the time, the \u2018user\u2019 will be the account admin for the target account, and may be only associated with one account. If the \u2018user\u2019 is associated with more than one account and \u2018account\u2019 is not explicitly specified, then the command will terminate with an error and can be executed explicitly specifying an \u2018account\u2019 parameter. Thus, for a given cadmin long running command, the system can find the account the user is associated with, and persist the job in that corresponding jobs.xml.","Asadmin Commands","In accordance with an embodiment, there can be one jobs.xml for the asadmin commands (in default scope) for all users in admin realm, with a location in path relative to domain1\/config, and including information such as, for example, a Job Id Command name; time of start execution; time of end of execution; results (Messages from Action report); exit code (Success or failure); User; and Account.","In accordance with an embodiment, information can be removed from memory for old jobs after a certain period once it is persisted.","It is likely that users will look for status update on recent jobs. For example, the system can choose to purge from memory, and to persist, if a job is old (default: more than 1 hour has passed since completion), and no one has requested for progress status in a while (default: more than 1 hour). This can be configured by in-memory-retention-period. When the server restarts, the Job Manager can populate this information from the account.xml files and jobs.xml file for cadmin and asadmin commands respectively.",{"@attributes":{"id":"p-0193","num":"0233"},"tables":{"@attributes":{"id":"TABLE-US-00021","num":"00021"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"<xsd:schema attributeFormDefault=\u201cunqualified\u201d elementFormDefault=\u201cqualified\u201d"},{"entry":"\u2003version=\u201c1.0\u201d xmlns:xsd=\u201chttp:\/\/www.w3.org\/2001\/XMLSchema\u201d>"},{"entry":"\u2003<xsd:element name=\u201cjobs\u201d type=\u201cjobsType\u201d \/>"},{"entry":"\u2003<xsd:complexType name=\u201cjobsType\u201d>"},{"entry":"\u2003\u2003<xsd:sequence>"},{"entry":"\u2003\u2003\u2003<xsd:element maxOccurs=\u201cunbounded\u201d name=\u201cjob\u201d type=\u201cjobType\u201d"},{"entry":"\u2003\u2003\/>"},{"entry":"\u2003\u2003<\/xsd:sequence>"},{"entry":"\u2003<\/xsd:complexType>"},{"entry":"\u2003<xsd:complexType name=\u201cjobType\u201d>"},{"entry":"\u2003\u2003<xsd:sequence>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201cid\u201d type=\u201cxsd:string\u201d \/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201cname\u201d type=\u201cxsd:string\u201d\/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201ctimestartexecution\u201d"},{"entry":"\u2003\u2003\u2003type=\u201cxsd:dateTime\u201d\/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201ctimeendexecution\u201d"},{"entry":"\u2003\u2003\u2003type=\u201cxsd:dateTime\u201d\/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201cexitcode\u201d"},{"entry":"\u2003\u2003\u2003type=\u201cexitcodetype\u201d\/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201csubject\u201d type=\u201cxsd:string\u201d\/>"},{"entry":"\u2003\u2003\u2003<xsd:element name=\u201cresults\u201d type=\u201cxsd:string\u201d\/>"},{"entry":"\u2003\u2003<\/xsd:sequence>"},{"entry":"\u2003<\/xsd:complexType>"},{"entry":"\u2003<xsd:simpleType name=\u201cexitcodetype\u201d>"},{"entry":"\u2003\u2003<xsd:enumeration value=\u201cSUCCESS\u201d\/>"},{"entry":"\u2003\u2003<xsd:enumeration value=\u201cFAILURE\u201d\/>"},{"entry":"\u2003\u2003<xsd:enumeration value=\u201cWARNING\u201d\/>"},{"entry":"\u2003<\/xsd:simpleType>"},{"entry":"<\/xsd:schema>"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, the Job Manager can load the information from the jobs.xml files on demand at server restart.","Additional CLIs","In accordance with an embodiment, a list-jobs command can be an asadmin or cadmin command. In accordance with an embodiment, the following snippets below shows how the sample output will look like for cadmin command list-jobs:",{"@attributes":{"id":"p-0196","num":"0236"},"tables":{"@attributes":{"id":"TABLE-US-00022","num":"00022"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"cadmin listjobs -account john"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"84pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","TIME OF COMPLETION"]},{"entry":["1","createservice","COMPLETED","SUCCESS","20120815 16:16:16 PDT"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Command listjobs executed successfully."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0197","num":"0237"},"tables":{"@attributes":{"id":"TABLE-US-00023","num":"00023"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"asdmin listjobs"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"91pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","TIME OF COMPLETION"]},{"entry":["1","loadsdp","COMPLETED","SUCCESS","20120815 16:16:16 PDT"]},{"entry":["2","samplecommand","COMPLETED","FAILURE","20120815 18:26:30 PDT"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"266pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Command listjobs executed successfully."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0198","num":"0238"},"tables":{"@attributes":{"id":"TABLE-US-00024","num":"00024"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"asadmin listjobs -terse 1"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},{},"TIME OF"]},{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","COMPLETION"]},{"entry":["1","loadsdp","COMPLETED","SUCCESS","20120815"]},{"entry":[{},{},{},{},"16:16:16 PDT"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"In accordance with an embodiment, if both --terse and --long is specified together, then the system will use the long output which is the default for list-jobs. The following snippet shows how the sample output will look like for list-jobs with job id:",{"@attributes":{"id":"p-0200","num":"0240"},"tables":{"@attributes":{"id":"TABLE-US-00025","num":"00025"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"asadmin listjobs 1"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},{},"TIME OF"]},{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","COMPLETION"]},{"entry":["1","loadsdp","COMPLETED","SUCCESS","20120815"]},{"entry":[{},{},{},{},"16:16:16 PDT"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Command listjobs executed successfully."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0201","num":"0241"},"tables":{"@attributes":{"id":"TABLE-US-00026","num":"00026"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"asadmin listjobs -terse 1"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},{},"TIME OF"]},{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","COMPLETION"]},{"entry":["1","loadsdp","COMPLETED","SUCCESS","20120815"]},{"entry":[{},{},{},{},"16:16:16 PDT"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}},"br":{}},{"@attributes":{"id":"p-0202","num":"0242"},"tables":{"@attributes":{"id":"TABLE-US-00027","num":"00027"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"asadmin -echo listjobs"},{"entry":"asadmin -host --localhost port 4848 --user admin --interactive=true"},{"entry":"\u2003\u2003\u2003--echo=true --terse=false listjobs"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"56pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},{},{},"TIME OF"]},{"entry":["JOB ID","COMMAND","STATE","EXIT CODE","COMPLETION"]},{"entry":["123","loadsdp","COMPLETED","SUCCESS","20120815"]},{"entry":[{},{},{},{},"16:16:16 PDT"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Command listjobs executed successfully."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}},"br":{}},"In accordance with an embodiment, the Job Manager enables management of long running executed commands on a JVM instance.","For example, when a long running command is executed, an AdminCommandInstance context identifier can be registered, along with the job id, in the Job Manager. This id can be used in future to fetch command instance information, such as actual progress status or resulting payload, in the case that the command was finished and is still in a retention period.","Job Manager Process",{"@attributes":{"id":"p-0205","num":"0245"},"figref":"FIG. 18"},"As shown in , at step , a cloud environment that supports provisioning of enterprise applications as services is provided at one or more computers.","At step , a job manager is provided that manages the execution of jobs within the cloud environment, including their job states.","At step , administrative commands are received, at a job manager service application program interface, to be processed within the cloud environment as jobs, wherein each instance of the administrative commands is associated with a unique job identifier.","At step , information associated with the jobs is stored in a job registry.","At step , the job manager updates the job registry, including registering instances of the administrative commands together with unique job identifiers, and returns the job identifiers so that a user can retrieve command process status, and the result of the jobs can be stored in the job registry.","Fault Tolerant Job Management","In accordance with an embodiment, the job manager can support fault tolerant job processing including associating the jobs with checkpoints, recognizing a failover command for the jobs, and associating the jobs with work units of the administrative commands, and storing a state for each job upon processing each work unit of the command.","For example, in accordance with an embodiment, commands can be associated with jobs. A job manager can support fault tolerant execution of jobs in a clustered manner, including transaction support, and support for checkpoints. In accordance with an embodiment, a mechanism can be provided especially for long-running commands, to deal with several kind of failures.","Failover support can be divided into three layers, wherein each layer provides some level of support or automation for failover process:","Checkpoints\u2014which provides an API for store and retrieve command instance as a state;","FailoverAdminCommand\u2014which provides an abstract command implementation which covers state store and load process and separates execute and revert business logic; and","WorkUnitsAdminCommand\u2014which provides an infrastructure for defining list of work units where each unit is represented by separated object and hold implementation of discrete part of command's logic. The infrastructure provides state storing after each work unit. In this case, the business logic of each command is fully separated from state store and load process.",{"@attributes":{"id":"p-0217","num":"0257"},"figref":"FIG. 19"},"As shown in , in accordance with an embodiment, the job manager can include a job fault tolerance logic , which maintains job information , including information as jobs are being processed to provision services , at one or more clusters , , or to otherwise interact with the platform or cloud environment.",{"@attributes":{"id":"p-0219","num":"0259"},"figref":"FIG. 20"},"As shown in , in accordance with an embodiment, the information associated with the jobs  can include checkpoints  and work units . The job manager can write information, including job status, to the command\/job status information database, for use in the event of a job failure.",{"@attributes":{"id":"p-0221","num":"0261"},"figref":"FIG. 21"},"As shown in , in the event of a failure or failover of a particular job , the job manager can create a new job , using the previously-stored job information, including the checkpoints and work units.","In accordance with an embodiment, commands from all of the fault tolerance layers can use a variety of functionalities or services, such as:","User message\u2014which sends message to the user through server sent events (SSE). This message will be immediately printed to the CLI user on the new line. If there is progress status support, it will continue on the next line. This message will be stored in a job record (JobRecord) and can be fetched using an attach command for detached commands;","Continue on startup service\u2014which will try to execute all jobs with a stored checkpoint which were terminated by domain process termination. It covers issue with crashed process instance. Each command execution can switch on\/off this functionality for each command instance; and","Continue and revert commands\u2014which provides a CLI user interface for not-running commands with stored checkpoint. Functionalities can be defined on a domain instance, rather than server instances, which makes it suitable in platforms and cloud environments such as CloudLogic environments which may not have server instances.","Checkpoint Layer (1st Layer)","In accordance with an embodiment, each checkpoint describes a saved Job with several attributes such a command instance or admin command context (AdminCommandContext). In accordance with an embodiment, the JobManagerService can be used for this functionality. A checkpoint file can be used for checkpoint data, to avoid read\/write conflicts (lock waiting) on jobs file, including one file for each instance.","In accordance with an embodiment, to support clustered usage, checkpoint information can also be supported as an \u201cobject\u201d or \u201crecord\u201d in any suitable information system or shared data in cluster solution, including, e.g., a distributed cache or database. The Job Record must be stored when the first version of checkpoint is stored. This record is connected with necessary lifecycle functions, like cleaning after retention period.","In accordance with an embodiment, use of the Job and JobRecord can include a variety of job states, as required by a particular implementation. For example, in accordance with an embodiment, one state can represent the case where the command actually running, but has a stored checkpoint. Another state can represent the case where the command is finished, or actually failed, but can continue after some user activity. If a Job is in such a state, then its CHECKPOINT will not be deleted by admin framework at the end of activity; otherwise it will be deleted. Another state can represent the case where the command is actually reverting (asked for revert).","In accordance with an embodiment, a checkpoint is supported only for @PerLookup commands\u2014otherwise the command will be considered as failed.","In accordance with an embodiment, the checkpoint can also store payload data, which can be large\u2014it can take care to store only once per change of this data. The payload can be stored separately (in separated file) from other checkpoint data.","Workflow Example",{"@attributes":{"id":"p-0232","num":"0000"},"ul":{"@attributes":{"id":"ul0013","list-style":"none"},"li":["1. User executes command on cli: asadmin some-command.","2. CLI knows from CommandModel that the command is @ManagedJob\u2014Use SSE to execute.","3. CLI executes remote command on domain using SSE.","4. Command is @ManagedJob, so Job instance is created: Job.state==PREPARED.","5. CommandRunner executes command: Job.state==RUNNING.","6. Command periodically store checkpoint: Job.state==RUNNING-RETRYABLE.","7. Command finish\u2014OK (or common FAIL): Job.state==COMPLETED.","8. Checkpoint data file is removed.","9. CLI receive state change message and prints ActionReport.\n\nCommand Detects Fixable Infrastructure Issue Example\n","1. User executes command on cli: asadmin some.","2. CLI knows from CommandModel that the command is @ManagedJob\u2014Use SSE to execute.","3. CLI executes remote command on domain using SSE.","4. Command is @ManagedJob, so Job instance is created: Job.state==PREPARED.","5. CommandRunner executes command: Job.state==RUNNING.","6. Command periodically store checkpoint: Job.state==RUNNING-RETRYABLE.","7. Command discover fixable infrastructural issue.","8. Command insert description of the issue into ActionReport.","9. Command updates Job.state==FAILED-RETRYABLE.","10. CLI receive state change message and prints ActionReport followed by instruction how to continue or revert (drop checkpoint) this job: use \u201casadmin continue 123\u201d to continue this job or \u201casadmin revert 123\u201d to drop this job.\n\nAPI Usage Example\n"]}},{"@attributes":{"id":"p-0233","num":"0291"},"tables":{"@attributes":{"id":"TABLE-US-00028","num":"00028"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"@Service(name = \u201csome\u201d)"},{"entry":"@PerLookup"},{"entry":"@ManagedJob"},{"entry":"public class SomeCommand implements AdminCommand, Serializable {"},{"entry":"\u2003\u2003\u2003private boolean continueTag = false;"},{"entry":"\u2003\u2003\u2003private String somedata;"},{"entry":"\u2003\u2003\u2003@Inject"},{"entry":"\u2003\u2003\u2003private transient JobManager jobManager;"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003public void execute(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003if (continueTag) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003if (jobManager.get(context.getJobId( ))."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003getState( ) =="},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003AdminCommandState.State.REVERTING) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003revert(context);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003return;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/It is continue do some skip"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003} else {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003continueTag = true;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003try {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003somedata = \u201cSOMETHING\u201d;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003jobManager.storeCheckpoint(this);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003} catch (ConnectDBException ex) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003context.getActionReport( ).setMessage("},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u201cCan not use mandatory DB connection. Try to restart DB"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003and continue this command.\u201d);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003context.getActionReport( )."},{"entry":"\u2003\u2003\u2003setActionExitCode(ActionReport.ExitCode.FAILURE"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/ This state will not be removed after job finish as"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003FAILURE"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003jobManager.storeFinalCheckpoint(this);"},{"entry":"\u2003\u2003\u2003}}"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003private void revert(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, a 2nd fault tolerance layer can be provided by an abstract class which implements the AdminCommand interface:",{"@attributes":{"id":"p-0235","num":"0293"},"tables":{"@attributes":{"id":"TABLE-US-00029","num":"00029"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"abstract execute(AdminCommandContext, boolean continueExecution)"},{"entry":"\u2003\u2003\u2003throws NeedRevertException, CanBeFixedException,"},{"entry":"\u2003\u2003\u2003RetryException - Where continueExecution is true for re-executing."},{"entry":"abstract revert(AdminCommandContext)"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"In accordance with an embodiment, the class provides implemented methods protected final void storeCheckpoint( ); provides support for command from command invocation; and provides support for \u201cinstance isolation\u201d. An implementation can choose if there must not be any saved checkpoint for other instances of the same command.","API Usage Example",{"@attributes":{"id":"p-0237","num":"0295"},"tables":{"@attributes":{"id":"TABLE-US-00030","num":"00030"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"@Service(name = \u201csomeother\u201d)"},{"entry":"@PerLookup"},{"entry":"public class SomeOtherCommand extends FailoverAdminCommand"},{"entry":"implements Serializable {"},{"entry":"\u2003\u2003\u2003enum Step {"},{"entry":"\u2003\u2003\u2003FIRST, SECOND, THIRD;"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003private Step lastStep;"},{"entry":"\u2003\u2003\u2003private String firstData;"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003public void execute(AdminCommandContext context, boolean"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003continueExec) throws NeedRevertException,"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003CanBeFixedException, RetryException {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003if (continueExec) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/ It is continue do some skip"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003try {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/ Command is responsible to store enough data"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/ in own fields to be able to determine how"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003to continue"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003firstData = \u201cSOMETHING\u201d;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003lastStep = Step.FIRST;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003storeCheckpoint( );"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003} catch (ConnectDBException ex) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003context.getActionReport( ).setMessage("},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u201cCan not use mandatory DB connection. Try to restart DB"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003and continue"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003this command.\u201d);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003throw new CanBeFixedException(ex);"},{"entry":"\u2003\u2003\u2003}}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003public void revert(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/Revert logic"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"In accordance with an embodiment, while the 3rd layer will support for chain of work units, if automated checkpointing and other features are found too restrictive, the 2nd layer can be used for custom work unit chain implementation, which helps organize the business logic of the command, but the developer can still choose variety of chain driving details:",{"@attributes":{"id":"p-0239","num":"0297"},"tables":{"@attributes":{"id":"TABLE-US-00031","num":"00031"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"public class WUAdminCommand extends FailoverAdminCommand {"},{"entry":"\u2003\u2003\u2003public interface WorkUnit {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003public void execute( ) throws WorkUnitException;"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003public void revert( );"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003Deque<WorkUnit> revertStack = new ArrayDeque<WorkUnit>( );"},{"entry":"\u2003\u2003\u2003protected <T extends WorkUnit> T exec(T aWorkUnit) throws"},{"entry":"WorkUnitException {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003revertStack.add(aWorkUnit);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003aWorkUnit.execute( );"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003return aWorkUnit;"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003public void execute(AdminCommandContext context,"},{"entry":"\u2003\u2003\u2003boolean continueExec) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/Choose sequence of command here base on dynamic"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003algorithm"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003public void revert(AdminCommandContext context,"},{"entry":"\u2003\u2003\u2003boolean continueExec) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/Rewert can be done as simple as is in this example or"},{"entry":"\u2003\u2003\u2003reflecting some"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/ inner logic of the command. Skipping of unrevertable"},{"entry":"\u2003\u2003\u2003work units."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/ Retry some groups of work units. ..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003for (WorkUnit workUnit : revertStack) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003workUnit.revert( );"},{"entry":"\u2003\u2003\u2003}}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, a 3rd fault tolerance layer provides a list of classes implementing work units (WorkUnit), each of which executes one-by-one and stores checkpoint after each execution. This can be changed using an extension list which is also used to define command model (parameters) for CLI, a combination of all params in WorkUnits.","In accordance with an embodiment, WorkUnits can contains @Param annotated parameters, which can be injected. If any WorkUnit in list implements @ProgressStatus, then it will be supported by the whole command, and will be automatically implemented based on WorkUnit count and its progress. Both continue and revert execution will start from the last failed work unit.","API Usage Example\u2014Simple Example",{"@attributes":{"id":"p-0242","num":"0300"},"tables":{"@attributes":{"id":"TABLE-US-00032","num":"00032"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"public class OneWorkUnit implements"},{"entry":"WorkUnit<ComplexCommand> {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"}"},{"entry":"\u2003\u2003\u2003public class TwoWorkUnit implements"},{"entry":"\u2003\u2003\u2003WorkUnit<ComplexCommand> {"},{"entry":"\u2003\u2003\u2003@Param(optional = true, defaultValue = \u201cvalue\u201d)"},{"entry":"\u2003\u2003\u2003private String some;"},{"entry":"\u2003\u2003\u2003public void execute(ComplexCommand sharedData,"},{"entry":"\u2003\u2003\u2003AdminCommandContext context, boolean reexecuted) {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003sharedData.setSomethingUsable(usable);"},{"entry":"}"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"}"},{"entry":"@Service(name = \u201cthree\u201d)"},{"entry":"@PerLookup"},{"entry":"public class ThreeCommand extends FailoverAdminCommand implements"},{"entry":"WorkUnit<ComplexCommand> {"},{"entry":"\/\/..."},{"entry":"}"},{"entry":"@Service(name = \u201ccomplex\u201d)"},{"entry":"@PerLookup"},{"entry":"public class ComplexCommand extends WorkUnitsAdminCommand {"},{"entry":"\u2003\u2003\u2003private static final List<Class<? extends"},{"entry":"\u2003\u2003\u2003WorkUnit>> WORK_UNITS;"},{"entry":"\u2003\u2003\u2003static {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003List<Class<? extends WorkUnit>> wus ="},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003new ArrayList<Class<?"},{"entry":"\u2003\u2003\u2003Extends"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003WorkUnit>>(3);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003wus.add(OneWorkUnit.class);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003wus.add(TwoWorkUnit.class);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003wus.add(ThreeCommand.class);"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003WORK_UNITS = Collections.unmodifiableList(wus);"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003protected List<Class<? extends WorkUnit>> getWorkUnits( ) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003return WORK_UNITS;"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0243","num":"0301"},"tables":{"@attributes":{"id":"TABLE-US-00033","num":"00033"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"public class OneWorkUnit implements WorkUnit<ComplexCommand> {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003public void execute(ComplexCommand sharedData,"},{"entry":"AdminCommandContext context,"},{"entry":"\u2003\u2003\u2003boolean reexecuted) {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003sharedData.setNext(TwoWorkUnit.class);"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":"public class TwoWorkUnit implements WorkUnit<ComplexCommand> {"},{"entry":"\u2003\u2003\u2003@Param(optional = true, defaultValue = \u201cvalue\u201d)"},{"entry":"\u2003\u2003\u2003private String some;"},{"entry":"\u2003\u2003\u2003public void execute(ComplexCommand sharedData,"},{"entry":"AdminCommandContext context,"},{"entry":"\u2003\u2003\u2003boolean reexecuted) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003if (something) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003sharedData.setNext(ThreeCommand.class);"},{"entry":"\u2003\u2003\u2003} else {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003sharedData.setNext(null); \/\/End of job"},{"entry":"\u2003\u2003\u2003}}"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"}"},{"entry":"public class ThreeCommand implements"},{"entry":"WorkUnit<ComplexCommand> {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"}"},{"entry":"@Service(name = \u201ccomplex\u201d)"},{"entry":"@PerLookup"},{"entry":"public class ComplexCommand extends"},{"entry":"WorkUnitsAdminCommand {"},{"entry":"\u2003\u2003\u2003\/\/We will provide dynamic order of work units but list off all"},{"entry":"\u2003\u2003\u2003\/\/ alternatives is still provided to be used for command parameter"},{"entry":"\u2003\u2003\u2003\/\/ model generation for CLI work units can define parameters"},{"entry":"\u2003\u2003\u2003private static final List<Class<? extends"},{"entry":"FailoverAdminCommand>> WORK_UNITS;"},{"entry":"\u2003\u2003\u2003static {"},{"entry":"\u2003\u2003\u2003List<Class<? extends WorkUnit>> wus ="},{"entry":"\u2003\u2003\u2003new ArrayList<Class<? extends FailoverAdminCommand>>(3);"},{"entry":"\u2003\u2003\u2003wus.add(OneWorkUnit.class);"},{"entry":"\u2003\u2003\u2003wus.add(TwoWorkUnit.class);"},{"entry":"\u2003\u2003\u2003wus.add(ThreeCommand.class);"},{"entry":"\u2003\u2003\u2003WORK_UNITS = Collections.unmodifiableList(wus);"},{"entry":"}"},{"entry":"private Class<? extends WorkUnit> next = OneWorkUnit.class;"},{"entry":"\u2003\u2003\u2003void setNext(Class<? extends WorkUnit> next) {"},{"entry":"\u2003\u2003\u2003this.next = next;"},{"entry":"}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003protected List<Class<? extends WorkUnit>> getWorkUnits( ) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003return WORK_UNITS;"},{"entry":"\u2003\u2003\u2003}"},{"entry":"\u2003\u2003\u2003@Override"},{"entry":"\u2003\u2003\u2003protected Class<? extends WorkUnit>"},{"entry":"\u2003\u2003\u2003getNextWorkUnitClass(List<WorkUnit>"},{"entry":"\u2003\u2003\u2003finishedWorkUnits) {"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003return next;"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, a job-related user message can be a simple string which is printed to the CLI user terminal during command execution. A @ManagedJob can be stored in JobRecord and printed before Action Report message when attach is used.","Usage Example",{"@attributes":{"id":"p-0245","num":"0303"},"tables":{"@attributes":{"id":"TABLE-US-00034","num":"00034"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"class SomeOtherCommand extends FailoverAdminCommand {"},{"entry":"\u2003\u2003\u2003public void revert(AdminCommandContext context, State state) {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003sendMessage(strings.getString(\u201csomeother."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003reverting\u201d);"},{"entry":"\u2003\u2003\u2003}}"},{"entry":"class SomeCommand implement AdminCommand {"},{"entry":"\u2003\u2003\u2003public void execute(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003\/\/..."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003context.getEventBroker( ).getUtils( ).sendMessage(strings."},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003getString(\u201csome.reverting\u201d);"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, recovery of long running commands after server crashes can be supported, making it possible to switch on\/off for server startup. This feature restarts only those commands which actually are running when a domain crashes. The feature can also respect job hierarchy, so that no commands executed from commands will be automatically re-executed. Execution will start after the server is up and running.","Workflow Example",{"@attributes":{"id":"p-0247","num":"0000"},"ul":{"@attributes":{"id":"ul0014","list-style":"none"},"li":["1. User executes command on cli: asadmin some.","2. CLI knows from CommandModel that the command is @ManagedJob\u2014Use SSE to execute.","3. CLI executes remote command on domain using SSE.","4. Command is @ManagedJob, so Job instance is created: Job.state==PREPARED.","5. CommandRunner executes command: Job.state==RUNNING.","6. Command periodically store checkpoint: Job.state==RUNNING-RETRYABLE.","7. Domain freeze and user decide to kill it.","8. CLI discovers that http connection drops before final state change message comes","9. CLI knows from previews state change message that job was in RUNNING-RETRYABLE state and inform user: _Server connection is lost. If it is network issue then command probably continues in execution and you can check it using \u201casadmin attach 123\u201d command. If domain is because domain is down your command will continue after domain will be back in operational state.","10. User first try \u201casadmin attach 123\u201d but it shows that server is probably down.","11. User starts the server.","12. Server automatically continue in running command from the last checkpoint.","13. It freeze again\u2014user must kill it.","14. User starts the server using switch to NOT continue in running jobs.","15. User lists jobs (asadmin list-jobs) and decide which one was source of the crash (if any).","16. User call rever on this job \u201casadmin rever 123\u201d. Or fix the reason (external system) and continue in that job \u201casadmin continue 123\u201d.\n\nContinue and Revert Commands\n"]}},"In accordance with an embodiment, the system can support the use of continue and revert commands which \u201cexecutes\u201d job (command) from a last checkpoint.","In accordance with an embodiment, a revert command can be used just once. If it fails, then all checkpoint data of the command are removed.","Commands must implement a revert method to revert all changed entities into their original state. A return code on CLI and message can be similar to the attach command pattern. If a command is connected, then its return code is used as CLI return code. Messages from connected commands are printed first, while any message from continue\/revert command is printed next.","Workflow Example",{"@attributes":{"id":"p-0251","num":"0000"},"ul":{"@attributes":{"id":"ul0015","list-style":"none"},"li":["1. User decide to revert: asadmin revert 123.","2. Revert command is executed.","3. It loads data from checkpoint using JobManager.","4. Change Job state from CHECKPOINT-FAILD to CHECKPOINT-REVERT (revert is only for ONE try. If fail then fail).","5. Execute command.","6. Remove checkpoint data (file).","7. Return Action Report to the user continue is similar but can ends again in CHECKPOINT-FAILD state.\n\nAdminCommandContext\n"]}},"In accordance with an embodiment, a string getJobld( ) can be added to AdminCommandContext. The value will be null for non-managed commands.","Job and JobManager","In accordance with an embodiment, job related entities and interfaces can include a New Job. State enumeration valuescan include RUNNING-RETRYABLE\u2014command has saved checkpoint and running; FAILED-RETRYABLE\u2014command failed but it is possible to re-execute it (or revert); and REVERTING\u2014command is running in revert mode. Any checkpoint will be removed after any result.","In accordance with an embodiment, a command can change Job.state to CHECKPOINT-FAILED value before exits, which can cause a checkpoint to be left persisted. A Job.state can also be transferred to client using SSE, and the client can provide information how to re-execute or revert.","Job Hierarchy","In accordance with an embodiment, a Job hierarchy supports command to command invocation cases.","For example, when a command invokes other commands, it is possible to provide a parent jobld to CommandInvocation. The ChildJob lifecycle (retention period, . . . ) is fully driven by parent job; will not be on any list (attach command result, . . . ); and its checkpoint will not be directly re-executed by a server startup job or by a continue or revert command.","Checkpoint","In accordance with an embodiment, a checkpoint contains all mandatory data for command resurrection.","Payload","In accordance with an embodiment, a payload covers large data (files) in AdminCommandFramework. There can be two payload instances, for incoming and outgoing data, both of which have a few special behaviors, including containing data as a streams, or containing data as a file. The incoming payload is never changed by command logic, and the outgoing is changed only sporadically. Payloads can be stored separately from the checkpoint and updated only when is changed. In accordance with an embodiment, a zip format can be used for storing.","File Format","In accordance with an embodiment, each Job can store its payload in a separated file in the same directory with its job.xml file. For example, filename: <jobid>.checkpoint; filenames for payloads: <jobid>.inpayload and <jobid>.outpayload. The files can be removed as soon as Job record will be removed from the job.xml file.","Resurrection","In accordance with an embodiment, when a command is loaded from a stored state, it will be represented as a deserialized command instance.","FailoverAdminCommand","In accordance with an embodiment, a failoveradmincommand can be based on job hierarchy support. A getCommandInvocation( ) method provides a CommandInvocation which is ready for \u201csub-Job\u201d execution, and will be executed as @ManagedJob. Continue(jobld) and revert(jobld) methods can execute a child job in relevant state with last checkpoint.","Command Instance Isolation","In accordance with an embodiment, a saved command instance can be executed when exist checkpoint for other \u201csame\u201d command. Command implementation can choose its isolation level, for example:","COMMAND_NAME: Do not execute current command instance if exists checkpoint for command of the same name","COMMAND_PARAMETERS\u2014Do not execute current command instance if exists checkpoint for command of the same name and with equals parameters (ParameterMap)","NONE\u2014Command will execute.","In case of a command isolation conflict, information can be written to an Action Report as a FAILED Action Report message, and\/or the user can be asked to continue or revert the conflicted job (jobld).","Workunits Support","In accordance with an embodiment, the command must be implemented as WorkUnitAdminCommand and provide list of WorkUnits, which can be used to create command logic.","In accordance with an embodiment, by default, this list is accepted as a chain and executed one by one. In accordance with an embodiment, before and after each execution a checkpoint is taken. The default revert is provided as a backward revert of each already executed work unit. If a command is re-executed, it starts from the last unfinished (or failed) work unit.","In accordance with an embodiment, a List of WorkUnits can be provided as a list of class. Instantiation is done by framework and @Params are injected. If WorkUnit is @Service, then HK is used to instantiate it.","In accordance with an embodiment, the List of WorkUnits is also used to define overall command model. A set of params are based on @Param declaration in WorkUnits.","In accordance with an embodiment, ProgressStatus is also driven by list of WorkUnits. If any work unit is annotated @ProgressStatus then whole command supports @ProgressStatus.","In accordance with an embodiment, by default each WorkUnit has weight  and can be also changed. If some of WorkUnits does not support progress status it is also compute with weight . Name of actual WorkUnit will be printed only if this name is part of @ProgressStatus annotation.","In accordance with an embodiment, an execute and revert WorkUnit method contains WorkUnitAdminCommand as a parameter. It can be used to get\/set shared data based on a current command logic. Selecting of execution order can be customized using nextWorkUnitClass( ) method and its instantiation using nextWorkUnit( ) method. This also works for revert, and can be used for very complex workflow definition. Easy workflow customization can be done directly from WorkUnits.","In accordance with an embodiment, WorkUnits can be also implemented as specialized AdminCommands. This pattern can be used to provide fine grain tool for solving special situations for the CLI user.","CommandModelProvider","In accordance with an embodiment, a provider can be used to compile all models of work units. Parameters with same name are consider to be same; if it has a different type then a RuntimeException is thrown.","@ManagedJob","In accordance with an embodiment, this annotation will be applied to command also when command implements or extends @ManagedJob interface or class. FailoverAdminCommands will also be annotated @ManagedJob. A Job instance with ID will be created and SSE will be used for its remote execution.","Utility Class for AdminCommandEventBroker","In accordance with an embodiment, this class can be used to cover common events used in AdminCommandEventBroker, for example user messages.","Continue and Revert Commands","In accordance with an embodiment, commands for continue and revert job with checkpoint can be provided.","Continue on Startup Service","In accordance with an embodiment, the job service re-executes commands with checkpoint which was running when server crashed. This will not block server startup state while server is probably operational during such period. Messages and Action Report result will be logged into the server.log file.","Public Interfaces","In accordance with an embodiment, different public interfaces can be provided, for example FailoverAdminCommand: Basic support class for potential failing commands;WorkUnitsAdminCommand: More complex support for potential failing commands; and Utility class in admin event broker for user messages.","Fault Tolerant Job Management Process",{"@attributes":{"id":"p-0281","num":"0360"},"figref":"FIG. 22"},"As shown in , at step , a cloud environment that supports provisioning of enterprise applications as services is provided at one or more computers.","At step , a job manager is provided that manages the execution of jobs within the cloud environment, including their job states.","At step , administrative commands are received, at a job manager service application program interface, to be processed within the cloud environment as jobs, wherein each instance of the administrative commands is associated with a unique job identifier.","At step , a fault tolerant job processing logic is provided at the job manager, including associating the jobs with checkpoints, recognizing failover commands for the jobs, associating the jobs with units of a work command, and storing a state for each job upon processing each unit of a work command.","Administrative Command Progress Status","In accordance with an embodiment, the system can include a means for providing administration command progress status in a cloud environment. In accordance with an embodiment, a command line interface allows a user to issue a command to be processed within the cloud environment as a job. During progress of a job associated with an annotated command, a status associated with the progress of the job is determined and provided to the command line interface. For example, the system can provide job progress status during these operations, to reassure the user that the operation is proceeding normally.","For example, in accordance with an embodiment, if the user has defined a large cluster it may take a significant amount of time to process admin task over the entire cluster, including, for example, starting the instances which are associated with the cluster.","Similarly, deploying a large application can take a significant amount of time. Providing on-going progress updates during these operations reassures the user that the operation is proceeding normally.",{"@attributes":{"id":"p-0289","num":"0368"},"figref":"FIG. 23"},"As shown in , in accordance with an embodiment, an administration interface is provided , which supports the use of a command line interface . The administrative interface allows administrative commands to be processed as jobs  within the cloud environment.","In accordance with an embodiment, the progress status of an Admin Command is considered as its state, and its change (progress) is considered an event. This means that the progress API has an analogy with walking, wherein making progress is equivalent to doing steps.","Calculated percentage of the trip is possible when the system can determine or otherwise knows the amount of finished steps, and the amount of remaining steps. Any trip can be finished before reaching a planned destination, for example due to unforeseen incident. The usual trip is simple but there are also more complicated cases. Progress must be calculated for whole trip of, e.g., all \u201cwalkers\u201d, but the provided API for each walker must be simple to use.","In accordance with an embodiment, progress status is composite, providing simple event support for Admin Framework developers as well as for Admin Command developers.","In accordance with an embodiment, the progress status can use Server Send Events (SSE) technology, to transfer relevant events to a remote client.",{"@attributes":{"id":"p-0295","num":"0374"},"figref":"FIG. 24"},"As shown in , a user can issue commands , including administrative commands , which are communicate by the administration interface  to the job manager service, to be executed as jobs , .","Information about the job status can be stored as command\/job progress information  in the command\/job status information database.",{"@attributes":{"id":"p-0298","num":"0377"},"figref":"FIG. 25"},"As shown in , as the commands are processed, the job manager can provide job status information , to the command line interface where it can be displayed as command progress information , or otherwise provided  to the user.","CLI User Perspective","In accordance with an embodiment, the user can use a CLI (asadmin or cadmin) in usual way. If the user does not use a --terse option, and if the executed command is designed for providing progress status, then progress status messages will be printed to the stdout until command will be finished. Then the system will display the last progress status message replaced by the command result.","In accordance with an embodiment, progress status messaged include a description of the percentage of finished work (if possible to calculate) or by increasing number of steps. This output can be followed by progress message if provided, for example: {{PORTION [[message_context_chain:] message]}}, wherein PORTION includes the number of steps or percentage (xxx %) of finished progress or number of steps of finished logic; a message_context_chain: a colon separated list of ProgressStatus components names defines source\/context of the message; a message: and\/or a last progress message.",{"@attributes":{"id":"p-0302","num":"0381"},"tables":{"@attributes":{"id":"TABLE-US-00035","num":"00035"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"% cadmin deploy foo.war"]},{"entry":[{},"13% extracting war file contents."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"In accordance with an embodiment, messages will replace each other using a carriage return (CR) on beginning, and spaces at the end of message if shorter then previous one. When a command is finished, the last message will be replaced with white spaces and then again replaced by the command result.","Admin Command Developer Perspective","In accordance with an embodiment, progress status API has two parts: @Progress annotation and instance of ProgressStatus class.","@Progress Annotation","In accordance with an embodiment, each AdminCommand instance which supports progress status must be annotated with @Progress annotation, which has two optional parameters:","totalStepCount: in which case progress is represented by amount of steps. As soon as the system knows an expected total steps count it can print progress in percentage format. The value can be also provided (or updated) using an API, but it is recommended to provide it in annotation if possible to ensure best user experience.","name: in which the default value is null. Name can be used when a progress message is printed to identify from where was message send. For example, a progress message can help a user to be oriented in what kind of command logic is currently done (parsing, loading, copying, . . . ). Messages are an optional part when progress status API is used.","ProgressStatus","In accordance with an embodiment, an instance of ProgressStatus API can be accessed from the CommandContext. If the AdminCommand is not annotated with @Progress annotation then a ProgressStatus API will throw exception when is used.",{"@attributes":{"id":"p-0309","num":"0388"},"tables":{"@attributes":{"id":"TABLE-US-00036","num":"00036"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"\/\/ The expected number of steps for this command is 8."},{"entry":"@Progress(totalStepCount=8)"},{"entry":"public class ExampleCommand implements AdminCommand {"},{"entry":"\u2003\u2003\u2003public void execute(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003ProgressStatus ps = context.getProgressStatus( );"},{"entry":"\u2003\u2003\u2003ActionReport report = context.getActionReport( );"},{"entry":"\u2003\u2003\u2003\/\/ Generate an initial progress messages but don't"},{"entry":"\u2003\u2003\u2003\/\/ advance the progress (e.g. stay at 0%)"},{"entry":"\u2003\u2003\u2003ps.progress(\u201cverifying war file.\u201d);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003\/\/ Generate a new progress message and advance one step."},{"entry":"\u2003\u2003\u2003ps.progress(\u201cextracting war file contents.\u201d, 1);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003ps.progress(\u201cdeploying application.\u201d, 1);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003\/\/ Reuse the last progress message and advance the progress"},{"entry":"\u2003\u2003\u2003one step."},{"entry":"\u2003\u2003\u2003ps.progress(1);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003\/\/ Generate a new progress message and advance two steps."},{"entry":"\u2003\u2003\u2003ps.progress(\u201cverifying application.\u201d, 2);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003ps.progress(\u201cupdating domain configuration.\u201d, 2);"},{"entry":"\u2003\u2003\u2003\/\/ Do command work"},{"entry":"\u2003\u2003\u2003\/\/ Generate the final progress message. Advance the progress to"},{"entry":"\u2003\u2003\u2003\/\/ the totalStepCount (8) == 100%"},{"entry":"\u2003\u2003\u2003ps.complete(\u201cApplication has been deployed.\u201d);"},{"entry":"\u2003\u2003\u2003report.setActionExitCode(ActionReport.ExitCode.SUCCESS);"},{"entry":"\u2003\u2003\u2003}"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},{"@attributes":{"id":"p-0310","num":"0389"},"tables":{"@attributes":{"id":"TABLE-US-00037","num":"00037"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"259pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"public void execute(AdminCommandContext context) {"},{"entry":"\u2003\u2003\u2003ProgressStatus ps = context.getProgressStatus( );"},{"entry":"\u2003\u2003\u2003\/\/ First somehow compute, how many \u201csteps\u201d take this command to its end."},{"entry":"\u2003\u2003\u2003\/\/ For example based on file count or just some fixed count."},{"entry":"\u2003\u2003\u2003\/\/ If we can not guess expected count of steps, we will not call this"},{"entry":"method"},{"entry":"\u2003\u2003\u2003\/\/ and progress portion (percentage) will be computed as unknown"},{"entry":"\u2003\u2003\u2003\/\/ until finished or set the value."},{"entry":"\u2003\u2003\u2003\/\/ When progress reach totalStepCount this progressStatus isCompleted."},{"entry":"\u2003\u2003\u2003ps.setTotalStepCount(42);"},{"entry":"\u2003\u2003\u2003..."},{"entry":"\u2003\u2003\u2003ps.progress(1); \/\/One step"},{"entry":"\u2003\u2003\u2003..."},{"entry":"\u2003\u2003\u2003for (File f : files) {"},{"entry":"\u2003\u2003\u2003ps.progress(\u201cCopy: \u201d + f.getName( ), 1); \/\/Step with status message."},{"entry":"}"},{"entry":"\u2003\u2003\u2003..."},{"entry":"\u2003\u2003\u2003ps.progress(\u201cInput verified\u201d, 3); \/\/Go faster"},{"entry":"\u2003\u2003\u2003..."},{"entry":"\u2003\u2003\u2003ps.progress(\u201cAbout to do some staff\u201d); \/\/Just new message no exact progress"},{"entry":"\u2003\u2003\u2003ProgressStatus subStatus = ps.createChild("},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\u201cSome complex staff\u201d, \/\/ optional named child can be shown on user info"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u20035 \/\/ covering progress how many our progress steps will be \u201cwalked\u201d"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003\/\/ when substatus will be completed"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003);"},{"entry":"\u2003\u2003\u2003\/\/ it is usual status."},{"entry":"\u2003\u2003\u2003\/\/ Called implementation can set its totalStepsCount and do progress"},{"entry":"\u2003\u2003\u2003doSomeComplexStaff(subStatus);"},{"entry":"\u2003\u2003\u2003\/\/ Now, we realize that our expected totalStepCount was to small and we"},{"entry":"\u2003\u2003\u2003\/\/ have to add some more. If we do it directly, it can be shown to"},{"entry":"\u2003\u2003\u2003\/\/ user as a antiprogress. For example from 82% to 78% it is strange."},{"entry":"\u2003\u2003\u2003\/\/ But we have other possibility. We can use child progress as follows"},{"entry":"\u2003\u2003\u2003ps = ps.createChild(null \/* anonymous child no"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003visible name for user*\/,"},{"entry":"\u2003\u2003\u2003\u2003\u2003\u2003ps.getRemainingStepCount \/* unfinished steps *\/);"},{"entry":"\u2003\u2003\u2003\/\/ And here it is new"},{"entry":"\u2003\u2003\u2003count of steps without antiprogress"},{"entry":"\u2003\u2003\u2003ps.setTotalStepCount(100);"},{"entry":"}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, progress status can be provided on a ReST interface only if AdminCommand implementation supports it, and the ReST client will open SSE connection. The client has to execute command on public ReST management API with header Accept: text\/event-stream. A similar approach is used also on management private\/command ReST interface.","SSE Events","In accordance with an embodiment, progress status can be provided in the form of SSE Events, as well as result (ActionReport), and other possible custom events. Data of events are in JSON format. In accordance with an embodiment, important events can include: ProgressStatus\/state\u2014Current state of ProgressStatus instance. ProgressStatus\/change\u2014Event in progress status. Some value was changed. AdminCommandInstance\/stateChanged\u2014Admin framework change state of executed command. In last change to state \u201cCOMPLETED\u201d it will contain a result in the form of ActionReport.","SSE Example",{"@attributes":{"id":"p-0313","num":"0392"},"tables":{"@attributes":{"id":"TABLE-US-00038","num":"00038"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"event: ProgressStatus\/state"},{"entry":"data: {\u201cprogress-status\u201d:{\u201cname\u201d:\u201cprogress-simple\u201d,\u201cid\u201d:\u201c1\u201d,"},{"entry":"\u201ctotal-step-count\u201d:10,\u201ccurrent-step-count\u201d:0,\u201ccomplete\u201d:false}}"},{"entry":"event: ProgressStatus\/change"},{"entry":"data: {\u201cprogress-statusevent\u201d:{\u201cchanged\u201d:[\u201cTOTAL_STEPS\u201d],\u201cprogress-"},{"entry":"status\u201d: {\u201cname\u201d:\u201cprogress-simple\u201d,\u201cid\u201d:\u201c1\u201d,\u201ctotalstepcount\u201d:0,"},{"entry":"\u201ccurrent-step-count\u201d:0,\u201ccomplete\u201d:false}}}"},{"entry":"event: ProgressStatus\/change"},{"entry":"data: {\u201cprogress-statusevent\u201d:{\u201cchanged\u201d:[\u201cSTEPS\u201d],\u201cmessage\u201d:"},{"entry":"\u201cWorking on main part...\u201d,\u201cprogress-status\u201d:{\u201cname\u201d:\u201cprogress-"},{"entry":"simple,\u201cid\u201d:\u201c1\u201d,\u201ctotal-step-count\u201d:"},{"entry":"10,\u201ccurrent-step-count\u201d:1,\u201ccomplete\u201d:false}}}"},{"entry":"event: AdminCommandInstance\/stateChanged"},{"entry":"data: {\u201cstate\u201d:\u201cCOMPLETED\u201d,\u201cid\u201d:\u201c1\u201d,\u201cempty-payload\u201d:true,\u201caction-"},{"entry":"report\u201d:{\u201ccommand\u201d:\u201cprogress-simple AdminCommand\u201d,"},{"entry":"\u201cexit_code\u201d:\u201cSUCCESS\u201d}}"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In accordance with an embodiment, if a JAX-RS 2.0 client is used than it is recommended to use Providers from Nucleus admin-util module for converting events into object representation. Other Java clients can use these providers directly from own code. A ProgressStatusClient located in a same module can be used to reconstruct ProgressStatus from these events.","ActionReport (Result of Command) in SSE Communication","In accordance with an embodiment, because SSE provides data in form of Events, an action report (result from the command) is provided also in event. It is part of AdminCommandInstance\/stateChanged event. This event generally inform about change of command state in perspective of admin framework. In accordance with an embodiment, attributes can include:","state\u2014if the state is COMPLETED then ActionReport is provided.","id\u2014ID of the command instance in JobManager. Can be used in combination with some commands to retrieve related data from job manager.","empty-payload\u2014if the command result contains outbound payload (there are files to download) this attribute is set to false. Because it is not effective to transfer large data using SSE this attribute is provided. If there are some payload then client can retrieve it using _get-payload command in combination with ID. (Note that _get_payload command is ready for be used just ones per command execution.","action-report\u2014the ActionReport Server will close SSE connection after COMPLETED event is send.","Java Client Developer Perspective","In accordance with an embodiment, Java clients can use RemoteRestAdminCommand to execute any command. This implementation automatically recognizes commands which supports event sending (including ProgressStatus), and uses SSE for the execution. A user of RemoteRestAdminCommand can register a listener in it before execution to listen on any SSE event.","Event-Based Integration with Admin Commands","In accordance with an embodiment, an API can be provided for local event based integration with command instance. It can be used for several use cases like Realize call back from admin command to admin command framework or to admin command invoker (any business logic which starts admin command); or to realize communication between concurrently running command instances on a same, for example: SSE Connection from remote client was closed\/New observer (listener) attached\/Another instance of same command executed.","Class Role","In accordance with an embodiment, an AdminCommandEventBroker provides a Central point of basic event integration, including providing an API for registering AdminCommandEventListers and for event firing. Each command instance has its own instance of AdminCommandEventBroker. An AdminCommandEventListener can be registered in AdminCommandEventBroker to listen for particular events. All events which names are valid within given regular expression are forwarded to the listener instance.","Events","In accordance with an embodiment, an event is a pair of name and data. Name can be a not-null String value which is used primary for event identification and listeners are connected to events by regular expression of this names. Data can be any Object or null.","In accordance with an embodiment, event names can be constructed hierarchically based on its semantics from most general to most specific sub-name. It can help to connect listener to as specific events as needed. More exactly it can help to create proper and shorter regular expression, for example something\/start or something\/end. Special event names with name prefixed by local\/are not transferred to the client using SSE (see Server Sent Events (SSE) on remote command execution).","@ManagedJob","In accordance with an embodiment, any admin command annotated with @ManagedJob OR with annotation which is annotated with @ManagedJob OR started by the client using --detach option is a command which is managed by the Job Manager. Such commands are processed with several added features: the commands will have job ids generated; the commands will be registered with the JobManager and their lifecycle managed by the Job Manager; the results, payload for these commands can be persisted to disk; and the CLI will use SSE for remote execution.","Server Sent Events (SSE) on Remote Command Execution","In accordance with an embodiment, remote execution can support SSE events when the client uses a standard Accept: text\/event-stream header. The command will be executed in thread from dedicated pool (managed by JobManager), as a managed command. The response will not be closed, but will be connected to AdminCommandEventBroker and all events with data will be possible to marshal. The response is closed by server side when command is finished and ActionReport is transferred. A Client can close it in any time without any effect to the running command instance.","Payload.Outbound and _Get-Payload Remote Command","In accordance with an embodiment, a command's result can contain files (Payload.Outbound). These files are not transferred using SSE but info of existing payload is part of AdminCommandState together with ActionReport and id. Client can ask for payload with follow-up request using _get-payload command. Hidden _get-payload command is based on Job Manager Service. The Payload.Outbound will not be saved on disk and will be removed after first download, which helps to keep memory footprint and performance impact as light as possible.","RemoteRestAdminCommand with Listeners","In accordance with an embodiment, a RemoteRestAdminCommand represents an API for remote command execution. A User can tag command to be executed using SSE (automatic for commands annotated with @ManagedJob). All events from SSE connection fires event here with original name and SseInboundEvent instance as data.","CLI and Managed Commands","In accordance with an embodiment, user executes command (example: asadmin deploy foo.ear)","The CLI checks CommandModel to determine if it is managed command\u2014If not, nothing is changed and the command is executed as it does today.","The CLI calls ReST interface on the server with the Accept: text\/event-stream header to execute command.","The CLI listen for command state events: this will contain id of command instance as soon as command is executed and ActionReport together with attribute if there is any Payload.Outbound (files) in result when ends.","The CLI forwards particular events to registered listeners.","On the server, the command is executed in a separate thread and SSE response is connected as a listener to the AdminCommandEventBroker instance.","The CLI will close connection after ActionReport is received. State event containing Action Report also contains attribute to determine if there is any Payload.Outbound (files to transfer) in result. If there is Payload.Outbound in result, CLI will try to download it using hidden _get-payload command.","Progress Status","In accordance with an embodiment, progress status can be represented by a state composite object. The components of this composite will represent branches of command replication, command sub-logic (any business logic with separate life cycle), commands executed from command and complementary commands.","A current progress represents portion of finished work, not necessarily a portion of time. Current progress is represented primarily by steps: if the total number of steps to complete the command is not declared by the command implementation then the progress status will be represented as an increasing number (of steps). If\/when the command establishes the total step count the progress status can be represented to the user as a percentage.","Progress also hold message with current state. This message is an optional parameter within each progress change. Each progress status component can be also named. A source\/context of each message can be identified to the user by a chain of these names. If admin command is finished but progress status is not completed it will be completed by admin framework. Command progress state changes are events in AdminCommandEventBroker and are transferred using SSE to client.","Local Commands","In accordance with an embodiment, local commands (CLICommand) execution is not affected by progress status solution. However CLICommands can use client ProgressStatus API to print own progress status in same format.","Compute Percentage",{"@attributes":{"id":"p-0340","num":"0419"},"tables":{"@attributes":{"id":"TABLE-US-00039","num":"00039"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"196pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"float computeCompletePortion( ) {"]},{"entry":[{},"\u2003\u2003if (isComplete( )) {"]},{"entry":[{},"\u2003\u2003return 1;"]},{"entry":[{},"}"]},{"entry":[{},"float realSteps = computeCompleteSteps( );"]},{"entry":[{},"\u2003\u2003if (realSteps < 0) {"]},{"entry":[{},"\u2003\u2003return 1;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003if (realSteps == 0) {"]},{"entry":[{},"\u2003\u2003return 0;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003if (totalStepCount < 0) {"]},{"entry":[{},"\u2003\u2003return 1;"]},{"entry":[{},"\u2003\u2003\u2003\u2003} else if (totalStepCount > 0) {"]},{"entry":[{},"\u2003\u2003\u2003\u2003return realSteps \/ ((float) totalStepCount);"]},{"entry":[{},"\u2003\u2003\u2003\u2003} else {"]},{"entry":[{},"\u2003\u2003\u2003\u2003return 1;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"}"]},{"entry":[{},"float computeCompleteSteps( ) {"]},{"entry":[{},"\u2003\u2003if (isComplete( )) {"]},{"entry":[{},"\u2003\u2003return totalStepCount;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003\u2003\u2003float realStepCount = currentStepCount;"]},{"entry":[{},"\u2003\u2003\u2003\u2003for (ChildProgressStatus child : children) {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003float\u2003\u2003\u2003\u2003\u2003\u2003childPortion\u2003\u2003\u2003\u2003\u2003\u2003="]},{"entry":[{},"\u2003\u2003\u2003\u2003child.progressStatus.computeCompletePortion( );"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003if (childPortion < 0) {"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003\u2003return 1;"]},{"entry":[{},"\u2003\u2003\u2003\u2003}"]},{"entry":[{},"\u2003\u2003\u2003\u2003realStepCount +="]},{"entry":[{},"\u2003\u2003\u2003\u2003((float) child.getAllocatedSteps( )) * childPortion;"]},{"entry":[{},"\u2003\u2003}"]},{"entry":[{},"\u2003\u2003return realStepCount;"]},{"entry":[{},"}"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, AdminCommands executed on DAS can be replicated to the cluster('s) servers. The source of replication can be either CommandRunner or AdminCommand implementation. In both cases the progress on remote servers will be replicated back to CommandProgress as child objects of the composite. Remote AdminCommands are executed from DAS to servers using RemoteAdminCommand which is also used from CLI to DAS. Client logic can be shared.",{"@attributes":{"id":"p-0342","num":"0421"},"tables":{"@attributes":{"id":"TABLE-US-00040","num":"00040"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"10%: deploy: Some message"]},{"entry":[{},"40%: deploy: instance1: Some message"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"In accordance with an embodiment, the platform or cloud environments admin framework has the feature to define Supplementary Commands. It is possible to define AdminCommand which will be executed before or after or after replication of another standard command. Any command logic can be enhanced by this method. Semantics of this enhanced method is that added logic is part of original command. Progress status will reflect it by using the following rules:","If supplementary command supports ProgressStatus but original command not then ProgressStatus NOT supported.","If original command supports ProgressStatus but supplementary command not then ProgressStatus is supported and portion of steps \u201cdedicated\u201d to supplementary command is 0.","If ProgressStatus is supported in original command and in some supplementary command, then its percentage form can be printed after all commands in the chain will define totalStepCount. However, it is recommended to define it directly in annotation of supplementary command.","All commands in chain (original and supplementary) will have their own standard ProgressStatus instance. Admin framework will connect them to correct composite.","CLI Output Example",{"@attributes":{"id":"p-0348","num":"0427"},"tables":{"@attributes":{"id":"TABLE-US-00041","num":"00041"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"10%: prepareSomething:\u2003Some message"]},{"entry":[{},"20%: something:\u2003Other message"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},{"@attributes":{"id":"p-0349","num":"0428"},"figref":"FIG. 26"},"As shown in , at step , a cloud environment that supports provisioning of enterprise applications as services is provided at one or more computers.","At step , a job manager is provided that manages the execution of jobs within the cloud environment, including their job states.","At step , administrative commands are received, at a job manager service application program interface, to be processed within the cloud environment as jobs, wherein each instance of the administrative commands is associated with a unique job identifier.","At step , a command line interface is provided that allows a user to issue a command to be processed within the cloud environment as a job.","At step , during progress of a job associated with an annotated command, the system can determine a status associated with the progress of the job, and provide the command progress status to the command line interface.","Detachable Administration Commands","In accordance with an embodiment, the system can include a means for supporting detachable administration commands in a cloud environment. A user can issue commands and perform operations to manage the environment, which can be executed by a job manager. The system allows administration commands to be detachable, so that several independent parallel commands can be executed together from one console or one script, and so users can check result or wait for result of some task.","In accordance with an embodiment, CLI functionality can be provided for executing AdminCommands in detached mode. It means that CLI will exit immediately after command is executed on DAS and also provides mechanism how check status of executed command or its result.","For example, in accordance with an embodiment, some commands can take significant time to complete especially on large clusters. To address this, a detachable command feature can be used by users to execute several independent parallel commands together from one console or one script. Then users can check result or wait for result of some task. This provides a better user experience, and reduces overall time for a user's complicated tasks.",{"@attributes":{"id":"p-0358","num":"0437"},"figref":"FIG. 27"},"As shown in , in accordance with an embodiment, a user can use the administration interface and command line interface to issue  one or more administrative commands , , which are communicated  via the job manager service API to the job manager service to be processed as jobs .","In accordance with an embodiment, each administrative command can be associated with a job id , for example job id A  and job id B .",{"@attributes":{"id":"p-0361","num":"0440"},"figref":"FIG. 28"},"As shown in , in accordance with an embodiment, the user can then detach their command line interface from the administrative command, which continue to run as jobs within the platform or cloud environment.",{"@attributes":{"id":"p-0363","num":"0442"},"figref":"FIG. 29"},"As shown in , in accordance with an embodiment, at a later point in time, a user can attach  their command line interface an existing command instance, and issue administrative command  by including a particular job id .","In accordance with an embodiment, the information is communicated  to the job manager, which locates the corresponding job, and attaches it  to the user's command line interface, for viewing or other use by the user.","In accordance with an embodiment, functionality is based on event integration support including Server Sent Events (SSE) support:","Any AdminCommand can be executed remotely using SSE.","Any AdminCommand which is executed using SSE is on server side processed as managed command.","Managed commands are registered in JobManager and can be identified by id.ID is part of state event which is transferred using SSE (as well as other events).","JobManager covers security\u2014for example, only a user who executed a command can retrieve its AdminCommand Instance.","JobManager covers livecycle of AdminCommandInstance including ActionReport and result Payload, and defines its retention period.","Detach Mode Workflow from CLI","In accordance with an embodiment, the CLI allows a user to execute command in the background (example: .\/asadmin.sh --detach deploy foo.ear).","CLI register event listener for state events in RemoteAdminCommand.","CLI tags command as managed in RemoteAdminCommand to trigger SSE and execute command.","RemoteAdminCommand calls ReST interface on DAS with Accept: text\/event-stream header.","In accordance with an embodiment, command is executed in a separate thread, and the response SSE listens to events. Execution of managed command also registers AdminCommandInstance in JobManagerService (id is created) and change state to executed. (fires state event).","CLI's listener receives state event containing id and close connection.","CLI prints ID and exits (example: Command is executed with id 1234, use (asadmin attach 1234) to watch progress status or result)","Attach Command",{"@attributes":{"id":"p-0379","num":"0000"},"ul":{"@attributes":{"id":"ul0016","list-style":"none"},"li":"asadmin attach XXX\n\nIn accordance with an embodiment, the command to attach is a local CLICommand which calls remote hidden _attach _attach; the command is defined as managed and will forward all events from AdminCommandInstance retrieved from JobManager.\n\nAttach Command and Commands which Retrieve File Payloads\n"}},"In accordance with an embodiment, the deploy command has a retrieve option to get client stubs. Generally the system does not support obtaining file payloads when a user tries to attach to the deploy command with --retrieve or when a user tries to attach to get-client-stubs. If someone attaches to a long running deploy command with --retrieve, the attach command can show progress status, but attach will not get the payload. In accordance with an embodiment, other commands called get-client-stubs can be used to retrieve the payload which the user can run.","Local Commands","In accordance with an embodiment, the described detach functionality will have no effect on existing CLI Commands. But any existing CLI Command can check for presence of a --detach asadmin switch and provide some support for it. If --detach is used with a CLICommand, and the CLICommand does not declare the detach @Param, it will generate an error.","CLICommand: Attach","In accordance with an embodiment, the attach command provides information about current status of particular command in progress. If the command is finished and its result is still registered, it returns a result payload.","In accordance with an embodiment, switches can include:","Exit code: If attach works, the exit code will be same as finished command. If not possible to attach or command does not finish exit code will be between 250-255","--detach switch: executes any remote command in background mode. It means use SSE connection and quits immediately after command instance id is received in status event.","--terse and progress status: Progress status will not be printed in case of --terse execution.","The attach command can be asadmin or cadmin command. The following snippet shows how the sample output will look for a running command which supports progress status:",{"@attributes":{"id":"p-0388","num":"0467"},"tables":{"@attributes":{"id":"TABLE-US-00042","num":"00042"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin sample-command"]},{"entry":[{},"64%: Uploading bits..."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0389","num":"0468"},"tables":{"@attributes":{"id":"TABLE-US-00043","num":"00043"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin sample-command"]},{"entry":[{},"Finished execution of sample-command"]},{"entry":[{},"Command sample-command executed successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0390","num":"0469"},"tables":{"@attributes":{"id":"TABLE-US-00044","num":"00044"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin --detach sample-command"]},{"entry":[{},"Job Id: 20"]},{"entry":[{},"Command sample-command detached successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0391","num":"0470"},"tables":{"@attributes":{"id":"TABLE-US-00045","num":"00045"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"asadmin --detach --echo sample-command"},{"entry":"asadmin --host localhost --port 4848 --user admin interactive=true --echo="},{"entry":"true"},{"entry":"\u2003\u2003--terse=false sample-command"},{"entry":"Job Id: 21"},{"entry":"Command sample-command detached successfully."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}},"br":{}},{"@attributes":{"id":"p-0392","num":"0471"},"tables":{"@attributes":{"id":"TABLE-US-00046","num":"00046"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach 20"]},{"entry":[{},"Finished execution of sample-command"]},{"entry":[{},"Command attach executed successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0393","num":"0472"},"tables":{"@attributes":{"id":"TABLE-US-00047","num":"00047"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach 123"]},{"entry":[{},"64%: Uploading bits..."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0394","num":"0473"},"tables":{"@attributes":{"id":"TABLE-US-00048","num":"00048"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"35pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach --long 20"]},{"entry":[{},"Job:sample-command"]},{"entry":[{},"State: COMPLETED"]},{"entry":[{},"ExitCode: SUCCESS"]},{"entry":[{},"Message: Finished execution of sample-command"]},{"entry":[{},"Command attach executed successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0395","num":"0474"},"tables":{"@attributes":{"id":"TABLE-US-00049","num":"00049"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach --long 21"]},{"entry":[{},"Job: sample-command"]},{"entry":[{},"State: COMPLETED"]},{"entry":[{},"ExitCode: WARNING"]},{"entry":[{},"Message: Finished execution of sample-command"]},{"entry":[{},"Command attach executed successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0396","num":"0475"},"tables":{"@attributes":{"id":"TABLE-US-00050","num":"00050"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach --terse 20"]},{"entry":[{},"Finished execution of sample-command."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0397","num":"0476"},"tables":{"@attributes":{"id":"TABLE-US-00051","num":"00051"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin attach --echo 123"]},{"entry":[{},"asadmin --host localhost --port 4848 --user admin --interactive="]},{"entry":[{},"true --echo=true"]},{"entry":[{},"\u2003\u2003--terse=false attach 123"]},{"entry":[{},"Job:sample-command"]},{"entry":[{},"State: COMPLETED"]},{"entry":[{},"ExitCode: SUCCESS"]},{"entry":[{},"Command attach executed successfully."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0398","num":"0477"},"tables":{"@attributes":{"id":"TABLE-US-00052","num":"00052"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"203pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin --echo attach 123"]},{"entry":[{},"asadmin --host localhost --port 4848 --user admin --interactive="]},{"entry":[{},"true --echo=true"]},{"entry":[{},"\u2003\u2003--terse=false attach 123"]},{"entry":[{},"64%: Starting"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0399","num":"0478"},"tables":{"@attributes":{"id":"TABLE-US-00053","num":"00053"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"asadmin --interactive attach"]},{"entry":[{},"Enter the value for the jobID operand> 16"]},{"entry":[{},"96%: Completing.."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}},"br":{}},{"@attributes":{"id":"p-0400","num":"0479"},"figref":"FIG. 30"},"As shown in , at step , a cloud environment that supports provisioning of enterprise applications as services is provided at one or more computers.","At step , administrative commands are received, at a job manager service application program interface, to be processed within the cloud environment as jobs, wherein each instance of the administrative commands is associated with a unique job identifier.","At step , a command line interface is provided that allows a user to issue a command to be processed within the cloud environment as a job.","At step , a command is received to detach the command line interface from the job being processed.","At step , during progress of the job being processes, the system can subsequently receive a command to reattach the command line interface to the job being processed, including an indication the job's unique job identifier, and provide access to the job at the command line interface.","The present invention may be conveniently implemented using one or more conventional general purpose or specialized digital computer, computing device, machine, or microprocessor, including one or more processors, memory and\/or computer readable storage media programmed according to the teachings of the present disclosure. Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure, as will be apparent to those skilled in the software art.","In some embodiments, the present invention includes a computer program product which is a non-transitory storage medium or computer readable medium (media) having instructions stored thereon\/in which can be used to program a computer to perform any of the processes of the present invention. The storage medium can include, but is not limited to, any type of disk including floppy disks, optical discs, DVD, CD-ROMs, microdrive, and magneto-optical disks, ROMs, RAMs, EPROMs, EEPROMs, DRAMs, VRAMs, flash memory devices, magnetic or optical cards, nanosystems (including molecular memory ICs), or any type of media or device suitable for storing instructions and\/or data.","The foregoing description of the present invention has been provided for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations will be apparent to the practitioner skilled in the art. The embodiments were chosen and described in order to best explain the principles of the invention and its practical application, thereby enabling others skilled in the art to understand the invention for various embodiments and with various modifications that are suited to the particular use contemplated. It is intended that the scope of the invention be defined by the following claims and their equivalents."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE FIGURES","p":[{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 25"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 26"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 30"}]},"DETDESC":[{},{}]}
