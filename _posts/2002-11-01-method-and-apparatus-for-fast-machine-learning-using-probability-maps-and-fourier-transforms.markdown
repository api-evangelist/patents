---
title: Method and apparatus for fast machine learning using probability maps and fourier transforms
abstract: The present invention provides a method of constructing recognition models. Under the method, a set of probabilities is estimated for values of a hidden variable. A Fourier transform is determined for the set of probabilities and is used to determine a Fourier transform of an estimated prototype pattern. The inverse Fourier transform is then determined for the Fourier transform of the estimated prototype pattern to form an estimated prototype pattern.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07702489&OS=07702489&RS=07702489
owner: Microsoft Corporation
number: 07702489
owner_city: Redmond
owner_country: US
publication_date: 20021101
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"p":["The present invention relates to machine learning. In particular, the present invention relates to reducing computation times associated with probabilistic functions used in machine learning.","When performing automated recognition tasks, such as speech recognition or image recognition, it is common to compare an input signal to a probabilistic model to identify a most likely phone or image given the input. One factor that can complicate this comparison is that the data in the input signal may represent a phone or an image that has gone through some type of transformation such as a translation in which the data is shifted either temporally or spatially. For example, for speech signals, the pitch of the phone may be different than the pitch of the phones used in the models. For image signals, the image of interest may be shifted relative to the images used to train the models.","To overcome this problem, the art has developed transformation invariant models that treat the transformation as a hidden variable during construction of the models. Under such systems, a model must be built for both the transformations and the phone or image at the same time. This is typically done using an Expectation-Maximization algorithm in which the parameters of the transformation model are estimated during the Expectation step and then are used to estimate the phone or image model during the Maximization step. The phone or image model is then used to re-estimate the transformation model. This iteration continues until the two models reach some stable point.","While this technique can be used to build small transformation invariant models, it cannot be used for larger models because the calculations become intractable. For example, to estimate an image model for a display having 10,000 pixels, 10scalar calculations must be performed for each training image that will be used to create the image model.","Thus, a technique is needed for training transformation invariant models without requiring as many calculations as found in the current state of the art.","The present invention provides a method of constructing recognition models. Under the method, a set of probabilities is estimated for values of a hidden variable. A Fourier transform is determined for the set of probabilities and is used to determine a Fourier transform of an estimated prototype pattern. The inverse Fourier transform is then determined for the Fourier transform of the estimated prototype pattern to form an estimated prototype pattern.",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general-purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer .","Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, FR, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during startup, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in FIG. , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.","The present invention provides a method for reducing the number of computations associated with using inference and learning to build a transformation-invariant model. For example the invention can be used to form transformation-invariant speech models or image models.  and  provide block diagrams of respective speech and image recognition systems in which embodiments of the present invention may be practiced.","In , a speaker , either a trainer or a user, speaks into a microphone . Microphone  also receives additive noise from one or more noise sources . The audio signals detected by microphone  are converted into electrical signals that are provided to analog-to-digital converter .","A-to-D converter  converts the analog signal from microphone  into a series of digital values. In several embodiments, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second. These digital values are provided to a frame constructor , which, in one embodiment, groups the values into 25 millisecond frames that start 10 milliseconds apart.","The frames of data created by frame constructor  are provided to feature extractor , which extracts a feature from each frame. Examples of feature extractors are well known in the art.","The feature extraction module produces a stream of feature vectors that are each associated with a frame of the speech signal. This stream of feature vectors is provided to noise reduction module , which reduces the noise in the input speech signal. Those skilled in the art will recognize that noise reduction module  is not needed to practice the present invention.","The output of noise reduction module  is a series of \u201cclean\u201d feature vectors. If the input signal is a training signal, this series of \u201cclean\u201d feature vectors is provided to a trainer , which uses the \u201cclean\u201d feature vectors and a training text  to train an acoustic model  and a transformation model  using techniques of the present invention described further below. Acoustic model  models the feature vectors that will be produced for the various phonetic units found in a language. Acoustic model  can include models for classes of each phone such that each phone is modeled as a mixture of Guassian models. Transformation model  models the likelihood of possible transformations of a speech signal such as changes in the pitch of the speech signal.","If the input signal is a test signal, the \u201cclean\u201d feature vectors are provided to a decoder , which identifies a most likely sequence of words based on the stream of feature vectors, a lexicon , a language model , acoustic model , and transformation model .","The most probable sequence of hypothesis words is provided to a confidence measure module . Confidence measure module  identifies which words are most likely to have been improperly identified by the speech recognizer, based in part on a secondary acoustic model (not shown). Confidence measure module  then provides the sequence of hypothesis words to an output module  along with identifiers indicating which words may have been improperly identified.",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 4","FIG. 4"],"b":["402","404","402"]},"The image frames are provided to noise reduction module , which removes noise present in the image data. Those skilled in the art will recognize that noise reduction module  is not necessary for practicing the invention. During training, the resulting image frames from noise reduction module  are provided to a trainer , which uses the image frames and a corresponding image list  to construct an image model  and a transformation model  for images found in the image list. Image model  provides a mean or prototype of a model image and, in some cases, a probability distribution that describes the likelihood of an image frame containing the prototype image. Transformation model  provides probabilities that an image frame includes a particular translation.","During recognition, the image frames from noise reduction module  are provided to a decoder , which uses image model  and transformation model  to identify a most likely image represented by the image data. This image or its index (image class) is then provided to an output module .","The challenge of forming a transformation-invariant model can be seen in , , , and .  represents a prototype or model of a particular image (in this case a face). This prototype is not known when training begins. During training, the image frames of , , and  are received. Each image frame includes an instance of the image but the instance in each frame is typically different than the instance in the other frames. For example, in , the smile on the face is slightly different and in , the left eyebrow is different. In addition, the image can be translated in each frame such that it appears in a different location within the frame. Thus, in , the image is in the upper right corner of the image, in  it is in the lower left corner, and in  it is in the lower right corner. Thus, in each instance of the image, the image is shifted by some amount due to an unknown translation.","The goal of using inference and learning to form a transformation-invariant model is to create a model for the prototype and for the translations without knowing the prototype, the variability in the prototype, or translations in training images before training begins. Under the present invention, this is done using an Expectation-Maximization (EM) algorithm, which iteratively estimates a model for the translations and then uses the translation model to estimate the prototype model.","Under one embodiment, the possible translations are represented by a variable T, and forming a model for each possible value of the translation involves determining a probability of each value of T given a frame of image data. In terms of an equation:",{"@attributes":{"id":"p-0048","num":"0047"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"p","mo":"(","mrow":{"mrow":{"mi":"T","mo":"\u2062","mrow":{"mo":["\uf603",")"],"mi":"f"}},"mo":"\u221d","mfrac":{"mrow":[{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mfrac":{"msup":{"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}}],"mo":"-"}},"mn":"2"},"mrow":{"mn":"2","mo":"\u2062","msup":{"mrow":{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"}}}}}},{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mi":"exp","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mfrac":{"msup":{"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}}],"mo":"-"}},"mn":"2"},"mrow":{"mn":"2","mo":"\u2062","msup":{"mrow":{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"}}}}}}}]}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"1"}}]}}}},"br":{},"b":["600","700","800","7","8","602","802"],"figref":"FIGS. 6"},"In Equation 1, the numerator provides a probability of a value of a translation given the frame. The denominator provides a normalization value that is equal to the sum of the probabilities for all of the possible translation values for the frame. This ensures that the sum of all of the normalized probabilities is equal to one.","The summations over x calculated in Equation 1, which represent correlations between the translated prototype image and the observed image, must be calculated for each possible translation value T. Since a translation shifts a pixel from on location to another, there are as many possible translation values as there are pixels on the display. Thus, if there are 76,800 pixels in an image, the calculation within the summation must be performed 76,800 times for a single summation and 76,800 summations must be performed to produce a probability for each translation value. Thus, 5.9 billion (76,800 times 76,800) scalar calculations must be performed in order to identify a probability for each translation value given an image frame.","Under the present invention, the number of calculations that must be performed is reduced by relying on a Fast Fourier Transform (FFT). In particular, the squared difference in the correlation is expanded and the result is divided into three summations such that:",{"@attributes":{"id":"p-0052","num":"0051"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mfrac":{"msup":{"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}}],"mo":"-"}},"mn":"2"},"mrow":{"mn":"2","mo":"\u2062","msup":{"mrow":{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"}}}},{"mrow":{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]}],"mo":"\u2062"}}},"mo":"-"}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"mrow":{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062"],"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}}],"msup":{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]}}}},"mo":"+"}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]}],"mo":"\u2062"}}}}}}]}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"2"}}]}}}}},"The Fast Fourier Transform of each summation is then taken such that:",{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"K","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}}],"mo":["\u2062","\u2062"]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"3"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"L","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}],"mi":"g","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":[{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}}]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"4"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}}],"mo":["\u2062","\u2062"]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"5"}}]}]}}}},"Because all possible translation values are being tested, the summation over T is the same as a summation over x+T. As such, the summation can be changed to x+T and the value e, which is equal to one and is added to introduce x in the exponent term, can be placed in each summation without changing the values of the summation. This produces:",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"K","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":["x","T"],"mo":"+"},"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}},{"mi":"\u2147","mrow":{"mi":"\u2148","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03b1\u03c9","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","x"],"mo":"-"}}}}}],"mo":["\u2062","\u2062","\u2062"]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"6"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"L","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":["x","T"],"mo":"+"},"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mn":"2","mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}],"mi":"g","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":[{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}},{"mi":"\u2147","mrow":{"mi":"\u2148","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03b1\u03c9","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","x"],"mo":"-"}}}}}]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"7"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":["x","T"],"mo":"+"},"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"+"}}},{"mo":"-","mn":"2"}]},{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}},{"mi":"\u2147","mrow":{"mi":"\u2148","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"\u03b1\u03c9","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","x"],"mo":"-"}}}}}],"mo":["\u2062","\u2062","\u2062"]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"8"}}]}]}}}},"Substituting u for x+T, where u now represents all possible translations, and separating the summation into the product of two sums produces:",{"@attributes":{"id":"p-0058","num":"0057"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"K","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"u","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"mo":"-","mn":"2"}]},"mo":"\u2062","mrow":{"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","u"]}},"mo":"\u00b7","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mn":"2"},{"mi":"\u2147","mrow":{"mi":["\u2148","\u03b1\u03c9","x"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}],"mo":"\u2062"}}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"9"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"L","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"u","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mrow":[{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","u"]}},"mo":"\u00b7","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mn":"2","mo":["\u2062","\u2062"],"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"msup":{"mi":"\u2147","mrow":{"mi":["\u2148","\u03b1\u03c9","x"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}}}}],"mo":["\u2062","\u2062"],"msup":{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"mo":"-","mn":"2"}]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"10"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"M","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"mfrac":{"mn":["1","2"]},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"u","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"msup":[{"mrow":{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},"mn":"2"},{"mrow":[{"mi":"\u03c3","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"mo":"-","mn":"2"}]}],"mo":["\u2062","\u2062"],"mrow":{"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","u"]}},"mo":"\u00b7","mrow":{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","msup":{"mi":"\u2147","mrow":{"mi":["\u2148","\u03b1\u03c9","x"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"11"}}]}]}}}},"Thus, each FFT is formed by determining one FFT in terms of u and multiplying that by the conjugate of an FFT in terms of x. After the FFT's are calculated using Equations 9, 10, and 11, they are summed together and the inverse FFT of the sum is determined. The inverse FFT is then used as the exponent in Equation 1.","Note that Equations 9, 10, and 11 require many fewer calculations than Equation 1. In particular, for an image grid of N-by-N pixels, Equation 1 in its original form would require Ncalculations. However, the number of calculations for Equations 9, 10 and 11 is on the order of Nlog N. For example, Equation 9 is evaluated by first computing Fourier transforms of image-size matrices \u03c3(u)and f(x), which takes Nlog N time using the FFT algorithm, and then performing the point-wise multiply of the first transform and the conjugate of the second. The computation cost of the multiplications is of the order N.","The calculations of Equations 1, 9, 10 and 11 are repeated for each frame of training images to produce a probability for each translation value given each frame. These probabilities are then used in a Maximization step to re-estimate the prototype image, g(x). By maximizing a goodness function, the following update equation is found for the prototype image:",{"@attributes":{"id":"p-0062","num":"0061"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"g","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mfrac":{"mn":"1","mi":"J"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"j","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mi":"p","mo":"(","mrow":{"mi":"T","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["f","j"]}},{"msub":{"mi":["f","j"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"-"}}}]}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"12"}}]}}}}},"where J is the total number of image frames in the training data, p(T|f) is a weighting value that indicates the probability of translation value T given a frame f, and f(x\u2212T) is the estimate of a prototype image pixel provided by frame fusing translation value T.","Thus, the prototype image is a weighted average of the images in training frames passed through each possible translation value. In some embodiments, the prototype image is considered the mean of the image model. Note that in Equation 12, T is a hidden variable in that it is not directly observable from the training data.","Before the present invention, the calculation of Equation 12 was intractable for large image sizes. As discussed above, for an image having 320\u00d7240 pixels, the calculation of equation 12 would require 5.9 billion calculations for each frame of training data.","The present invention overcomes this problem by treating p(T|f) as a probability map and utilizing an FFT to perform the calculation of Equation 12. In particular, the inner summation of Equation 12 can be viewed as a partial update to the prototype image and can be defined as:",{"@attributes":{"id":"p-0067","num":"0066"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mover":{"mi":"g","mo":"^"},"mi":"j"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mi":"p","mo":"(","mrow":{"mi":"T","mo":["\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["f","j"]}},{"msub":{"mi":["f","j"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"-"}}}]}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"13"}}]}}}},"br":{},"sub":"j"},"The present invention recognizes that p(T|f) is simply a function of T and not x. Based on this recognition, the present inventors have further recognized that a Fast Fourier Transform could be used to reduce the number of calculations associated with Equation 13. Thus, taking the Fast Fourier Transform, Equation 13 becomes:",{"@attributes":{"id":"p-0069","num":"0068"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mover":{"mi":"G","mo":"^"},"mi":"j"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mi":"p","mo":"(","mrow":{"mi":"T","mo":["\u2062","\u2062","\u2062"],"mrow":[{"mo":["\uf603",")"],"msub":{"mi":["f","j"]}},{"msub":{"mi":["f","j"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["x","T"],"mo":"-"}}}],"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","x"]}}}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"14"}}]}}}}},"Using the same techniques shown above, Equation 14 can then be divided into the product of two sums, producing:",{"@attributes":{"id":"p-0071","num":"0070"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mover":{"mi":"G","mo":"^"},"mi":"j"},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c9"}},{"munderover":{"mo":"\u2211","mi":"x","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["f","j"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"u"}},{"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","u"]}},"mo":"\u00b7","mrow":{"munderover":{"mo":"\u2211","mi":"T","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2062","mrow":{"mi":"p","mo":"(","mrow":{"mi":"T","mo":["\u2062","\u2062"],"mrow":{"mo":["\uf603",")"],"msub":{"mi":["f","j"]}},"msup":{"mi":"\u2147","mrow":{"mrow":{"mo":"-","mi":"\u2148"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03b1\u03c9","T"]}}}}}}],"mo":"\u2062"}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}},"mn":"15"}}]}}}},"br":{},"sub":["j","j"]},"After the calculations of Equation 15 have been performed, the inverse Fast Fourier Transform of the result is calculated and can be applied to either incrementally update the prototype image as in g=(1\u2212\u03b2)g+\u03b2g, or all partial updates can be accumulated and Equation 12 can be used to determine the outer sum over each training frame, j. Note that the summation can be done in the Fourier domain, thus avoiding applying the inverse Fourier transformations on each partial update.","By utilizing Equation 15 to perform the partial updates, the number of calculations needed to re-estimate the prototype image drops significantly. Specifically, without the use of the Fast Fourier Transform, an N-by-N image would require Ncalculations for each frame of training data. However, using the Fast Fourier Transform, the number of required calculations drops to an order of Nlog N. This represents a significant drop in the number of calculations needed to train the prototype model.","While the above describes the simplest embodiment of the present invention, those skilled in the art will recognize that the described efficient method for dealing with all integer image shifts can be applied in more complex models, such as the ones with multiple image prototypes, or where noise variances are also learned. While in these cases the inference and update equations may involve other hidden variables, the translation variable will still be inferred through correlations computed in the FFT domain, while the parameters, such as the image prototype and variances, would be optimized efficiently using convolution of the translation posterior with appropriate terms in the FFT domain. Following the recipe in this document, those skilled in art can speed-up learning in any model that involves translations modeled as discrete hidden variables.","Thus, a method of using inference to identify a transformation-invariant model can be summarized as found in the flow diagram of .","In step , an initial estimate of the probabilities of the translations is determined. This estimate can be as simple as making all translation values equally likely, or it can be based on a random or some other initialization of model parameters, such as image prototypes. In step , the Fourier transform of the probabilities is determined across all pixels on an image. The Fourier transform is then used in equation 15 to determine the Fourier transform of a prototype update at step .","At step , the inverse Fourier transform of the prototype update is determined. Each of a collection of prototype updates are then averaged together at step  to use as the image model. Depending on the probability model, it is possible to defer taking the inverse Fourier transform by performing summations directly in the Fourier domain whenever possible. At step , this image model is used to re-estimate the probabilities using equations 1, 9, 10, and 11 above.","At step , the probabilities are examined to determine if the translation model and the image model have converged on stable values. If they have not converged, the process returns to step  to determine the Fourier transforms for the new probability estimates. If the models have converged, the training process ends at step .","Although the invention has been described above with reference to using Fast Fourier Transform to reduce the number of computations associated with pattern recognition, those skilled in the art will recognize that the present invention is not limited to pattern recognition and may be used in any context in which a probability of a hidden variable is multiplied by a function that is a function of the hidden variable shifted by some amount.","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 9"}]},"DETDESC":[{},{}]}
