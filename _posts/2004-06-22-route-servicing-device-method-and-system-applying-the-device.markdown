---
title: Route servicing device, method and system applying the device
abstract: The present invention discloses a route service device and a method and a system for realizing call route by the device, in which, route service device and soft switch control device are networked in a layered way, the soft switch control device is the node of the lowest layer, when the user route changes, the soft switch control device reports route information including user node to the father node; the route service device performs registration, and broadcasts the changed route information to the father node, each related route service device performs registration and broadcast by the same way; when calling across domains, the soft switch control device where the calling locates initiates inquiry toward the father node, and receives the returned inquiring result, therefore routing the call to the soft switch control device where the called locates. The present invention employs route service device to replace soft switch control device for performing call route function, therefore enabling the soft switch control device absorbed in providing services, and also providing a scheme of large scale networking at telecommunication level for soft switch control device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07899043&OS=07899043&RS=07899043
owner: ZTE Corporation
number: 07899043
owner_city: Guangdong Province
owner_country: CN
publication_date: 20040622
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","TECHNICAL BACKGROUND","SUMMARY OF THE PRESENT INVENTION","PREFERRED EMBODIMENTS OF THE PRESENT INVENTION","The First Embodiment","Second Embodiment","INDUSTRIAL APPLICABILITY"],"p":["The present invention relates to a route service device, particularly relates to a route service device which is employed under the next generation network system architecture, and a method and a system for realizing call route.","With the development of computer technology and the increasing need for computer inter-networking, the packet switch data network based on IP or ATM is becoming ever strong. In contrast, the conventional PSTN voice network based on TDM doesn't have its service and control separated, so the providing of new services need a longer period, the conventional PSTN voice network seems incapable to meet the requirements of the increasing competitive market. In such condition, the next generation network system architecture with soft switch as its core control equipment emerges. In this architecture, the service and the call control as well as the call and carrying are absolutely separated.","As the core equipment of the next generation network system architecture, the soft switch control device is based on the packet switch data network, and performs functions of controlling call process, adapting access protocol, providing service interface, networking other networks (including PSTN, GSM, other soft switch control devices, etc.), and applying supporting system, etc., it employs standard protocol and open system architecture of application programming interface, which is convenient for a third party to participate in the employment and development, and makes the deployment of new services more quickly.","When a user U on a soft switch control device S calls a user U on another soft switch control device S, S first has to be able to locate U on S so as to perform the service through S, therefore, there must be a route relationship (U, S) on the S. With the prevalence of the next generation network system architecture with soft switch as the core control equipment, there will be more and more soft switch control devices. If each soft switch control device is configured with the user route relationships on all of the other soft switch control devices, the route relationship data on each soft switch control device will certainly be huge and complex.","Furthermore, due to the inter-connection of network, the user on one soft switch control device can shake off the limitation of the conventional network to shift from one soft switch control device to another, while the soft switch control device still carries the original user character information. In order to connect with users on other soft switch control devices, the route relationship of other soft switch control devices must also be updated in time. Obviously, the complexity of networking makes the route relationship data of the soft switch control devices becomes difficult to maintain.","The technical problem to be solved by the present invention is to provide a method for realizing call route by employing route service device and a system for realizing this method, which are employed in next generation network with soft switch as core control equipment, and can maintain user route information and realize the call route function by employing the route service device.","In order to solve the above technical problem, the present invention provides a method for realizing call route by employing a route service device, which is employed in next generation network with soft switch as core control equipment, comprising the following steps of:","(a) when a user route changes, a soft switch control device reporting changed route information to a route service device of father node, the information including user character information, user node information and route operation type;","(b) after receiving the report, the route service device looking up a record of a user to be registered in a route information database, and registering the route record of the user in the route information database according to the reported information and the user record;","(c) after finished registering, the route service device broadcasting a changed route information to the father node when the route information of the user changes from the node to the father node;","(d) after receiving the broadcast, the route service device registering and broadcasting the received route information according to the same method of the route service device which received the report;","(e) when calling across domains, a soft switch control device which the calling belongs to initiating inquiry to the route service device of father node;","(f) the route service device which has received the inquiry request looking up route information of a user to be inquired in the route information database, if obtaining a result of the route of the user or the user not existing, performing step (h), otherwise, performing step (g);","(g) said route service device continuing to inquire the node in said route records, if no route record, continuing to inquire the father node, and returning to step (f); and","(h) returning inquired result to the node initiating the inquiry, and the node receiving the result continuing to return result to the node inquiring it, until returning to the soft switch control device which initiates the inquiry first.","The above method is characterized in that when performing registration in step (b), if the operation type of the report information corresponds to user moving in, when there is no route record of the user in the route information database, establishing a new record, when the record information of the user is different from the report information, updating the record in conformity with preset condition, otherwise, not performing the operation; if the operation type of the report information corresponds to user moving out, deleting or updating the route record of the user which has the same node information.","The above method is also characterized in that said operation types have two kinds, which are addition and deletion; or have three kinds, which are addition, move-out and account-cancel, and said user character information includes information of specific domain.","In the above method: the user node in said step (a) is the type of soft switch control device, or route service device.","The above method is also characterized in that in said step (c), the route service device finishing the registration also broadcasts the route information to the designated brother node when the route information of the user from the node to the designated brother node changes.","The above method also characterized in that said operation types have two kinds, which are addition and deletion, in said step (f), the route service device executing inquiry performs judgment according to the looking up result in the route information database by following logic:","if the looking up result is that there is no record of user to be inquired, for the node which is at the highest layer, obtaining the looking up result that there is no user, for the node which is not at the highest layer, it is necessary to continue inquiry;","if there is record of user to be inquired in the looking up result, obtaining the inquiring result of the user route when the user node in the route record is the soft switch control device, while continuing inquiry when it is not soft switch control device.","The above method is also characterized in that said operation types have three kinds: addition, move-out, and account-cancel, in said step (f), the route service device inquiring makes the judgment according to the looking up result in the route information database by the following logic:","If the looking up result is that there is no record of user to be inquired, for the node which is at the highest layer, obtaining the looking up result that there is no user, for the node which is not at the highest layer, it is necessary to continue inquiry;","If the looking up result is that there is record of user to be inquired, identifying the operation type in the record:","if the operation type is addition, for that the user node in the record is the type of soft switch control device, obtaining the looking up result of the user route, for that the user node is the type of route service device, it is necessary to continue inquiry;","if the operation type is move-out, for that the node is at the highest layer, obtaining the looking up result that there is no user, for that the node is not at the highest layer, it is necessary to continue inquiry; and","if the operation type is account-cancel, obtaining the looking up result that there is no user.","In order to realize the above objects better, the present invention further provides a system for realizing the above method, including several soft switch control devices with users and several route service devices, each of said route service devices and each of said soft switch control device form a node of the system, and the nodes are networked in a layered form, each sub-node has at least a father node, and each father node has at least a sub-node, said soft switch control device is a node at the lowest layer, and said route service device should have a sub-node, in which:","said soft switch device reports the changed route information to the route service device of father node when its user adding or moving out, and initiates route inquiry to the route service device of father node when its user calls across domains;","said route service device is for registering the reported information, and performing the adding, deleting and updating of the route record in the route information database, broadcasting the changed route information to the related node, performing inquiry after receiving the inquiry request, and returning inquiring result to the node initiating the inquiry.","Another technical problem to be solved in the present invention is to provide a route service device employed in the next generation network, which can replace the soft switch device to maintain the user route information, and realizes the call route function.","In order to solve the above technical problem, the present invention further provides a route service device employed in the next generation network, including a route information database module, a route registration module, a route broadcast module and a route inquiry module, wherein:","the route information database module is for storing the route record of user, inputting the user route record, and providing a interface for accessing the user record;","the route registration module is for receiving the route information reported or forwarded by the route broadcast module, looking up the record of user to be registered in the route information database, and registering the route record of the user in the database according to the reported information and the content of user record;","the route broadcast module is for receiving the broadcasted route information, and broadcasting the route information of the user to its father node when the route information of the user from its node to the father node changes;","the route inquiry module is for receiving or sending inquiry request, looking up the record of the user to be inquired in the route information database, returning the inquiring result to the node requesting the inquiry after finding the route of the user, and determining that there is no user or receiving the inquiring result from other nodes, otherwise, continuing inquiring the node in the route record, and if there is no route record, continuing inquiring its father node.","The above device can be used in the system provided by the present invention, but the above device does not limit to the application in the above system.","The above device is further characterized in that said route registration module includes: a report information receiving unit, for receiving route information reported by the soft switch control device, or forwarded by the route broadcast module; a registration access unit, for looking up the route record of the user in the route information database according to the information of the user to be registered in the reported information; a register judgment unit, for establishing a new record if there is no route record of the user when the operation type corresponds to the user moving in, updating the record in the database in conformity with preset condition if the route record information of the user is different from the reported information, otherwise, not performing operation; deleting or updating the route record of the user if the operation type of the report information corresponds to user moving out and the user node in the user record is same to the node in the reported information.","The above device is also characterized in that said route broadcast module includes: a broadcast information receiving unit, for receiving the route information broadcasted by other nodes, forwarding the information to the route registration module; a broadcast judgment unit, for judging whether the route information of the user to be registered from its node to its father node changes, if yes, handing over the route information of the user to the route information broadcast unit; a route information broadcast unit, for broadcasting the changed route information to the father node.","The above device is also characterized in that said route inquiry module includes: an inquiry interface unit, for receiving inquiring request from other nodes or sending inquiry request to other nodes, and returning the inquiring result of the module to the node requesting the inquiry or forwarding the inquiring result receiving from other nodes; an inquiry access unit, for looking up in the route information database according to the character information of the user to be looked up in the inquiry request, and reporting the inquiring result to the inquiry judgment unit; an inquiry judgment unit, for judging whether the inquiring result is that the user route does not exist or the user does not exist according to the looking up result, or it is necessary to send inquiring request to related node, and to indicate the inquiry interface unit to perform corresponding operation.","The above device is also characterized in that when a node A sends route inquiry to a node B, and when node B finds that this route does not exist in its route information database, the node B can return an information of jumping to the next inquiry node C to node A, so that the node A continues to initiate route inquiry to the node C.","The above device is also characterized in that said route broadcast module broadcasts the route information to designated brother node when the route information of the user from the node to the designated brother node changes.","The above device is also characterized in that the operation types of said route record have two kinds: addition and deletion, said inquiry judgment unit makes judgment according to the looking up result in the route information database by the following logic:","if the looking up result is that there is no record of the user to be looked up, for the node that is at the highest layer, determining that the user does not exist, if the node is not at the highest layer, continuing inquiry;","if the looking up result is that there is record of user to be looked up, when the user node in the route record is soft switch control device, obtaining the user route, when the user node is not soft switch device, continuing inquiring the user node in the record.","The above device is also characterized in that the operation types of the route record have three kinds: addition, move-out and account-cancel, said inquiry judgment unit performs judgment according to the looking up result in the route information database by the following logic:","if the looking up result is that there is no record of user to be looked up, for the node that is at the highest layer, determining that the user does not exist; if the node is not at the highest layer, continuing inquiry, or returning father node to the inquiry node as the next jump inquiry node, so as to instruct the inquiry node to perform route inquiry with the next jump inquiry node;","if the looking up result is that there is record of user to be looked up in the looking up result, discerning the operation type in the record again:","when the operation type is addition, for the user node in record being the soft switch control device, obtaining the user route; for the user node being the route service device, continuing inquiring the user node, or returning the user node to the inquiry node as the next jump inquiry node, so as to instruct the inquiry node to perform route inquiry with the next jump inquiry node;","when the operation type is moving out, for the node that is at the highest layer, determining that the user does not exist, for the node that is not at the highest layer, continuing inquiring its father node, or returning the father node to the inquiry node as the next jump inquiring node, so as to instruct the inquiry node to perform the route inquiry with the next jump inquiry node; and","when the operation type is account-cancel, determining that the user does not exist.","From above we can see that, by employing the present invention, the changes of the user route information of one soft switch control device are reflected on the route service device, so that when other soft switch control devices call the user, they can obtain the soft switch control device which the user belongs to by inquiring the route service device. Furthermore, the route service device will make the networking form of soft switch control devices more flexible. Any soft switch control device can make their user route shared in the whole network as long as they are connected into the network by the route service device, without manually configuring the route information from one soft switch control device to another. Therefore, the present invention frees the soft switch control device from the complicated route information maintenance, so that the soft switch control device can be wholly absorbed in providing service while doesn't need to manage the route, and also provides a scheme of large scale networking at telecommunication level for soft switch device.","The route in the present invention refers to the user character information and landing node information. The user character information refers to the unique information in the whole network for identifying and locating the user, such as telephone number, uniform resource location identification URI; the landing node information is the information of the soft switch device for user landing, such as IP address.","The related information of user route is reported to the route service device by the soft switch device, and the route service device registers the information in the database, and stores the user route record, and broadcasts it to other route service devices when necessary. The information database on the soft switch control device has the information of local user, the call in domain can be connected by the local device, when calling across domains, the soft switch control device where the call locates has to inquire the route service device for the route of the user being called, and finish the connection process according to the landing node in the route.","Next, the technical content and effect of the present invention will be described in detail according to the specific embodiments in connection with the drawings. Each embodiment will be described in four aspects: system, method, route service device being used and the specific route maintenance and call route.",{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 1","b":["1","2","3","1","2","3","2","1","2","3","3","1","2","3"]},"In the present invention, each soft switch device and each route service device make up of a node, and it is a layered relationship between nodes, each sub-node has one or more father nodes, while each father node also has one or more sub-nodes, the soft switch control devices are always located at the lowest layer, equivalent to leaf nodes, while the father nodes must be route service devices, the route service devices should have sub-nodes, whose type may have two kinds, that is, soft switch control device and route service device, for example, R is the father nodes of R and R, correspondingly, R and R are the sub-nodes of R, R and R are brother nodes. In the system, the node at the highest layer needs to store the route record of all the users in the network, the route service device R at the highest layer should be comprehended as the logic device, a route device same to the R in  can be realized by employing multiple actual route service devices.","The method of the present invention for realizing call route is composed of operations of report, registration and inquiry. In this embodiment, the soft switch control devices report the user route information to the route service devices by employing LDAP (Lightweight Directory Access Protocol), the route service devices report to each other by employing TRIP (Telephony Routing over IP) protocol, and the route inquiry between nodes is accomplished by employing LDAP protocol. LDAP is a light index access protocol, providing information access service. TRIP (Telephony Routing over IP) is a telephony route protocol on the IP network. These two kinds of protocols can be referred to the description of related document in RFC. In this article, in order to distinguish the above reports, the report from the soft switch control device to the route service device is called up-report, the report between route service devices is called broadcast.","In this invention, route information and route record both include user character information, user node information and route operation type, wherein, the user node information can be defined as the information of the user landing node, or includes the information of the sub-node of the user (R or S), the operation type can be generally divided into two kinds: soft switch control device corresponding to the join-in of user, soft switch control device corresponding to the move-out of user (such as move and account-cancel, or delete), but the specific categories may be different, for example, the operation type can be set as addition when user joining, the operation type can be set as deletion when user moving out, they can also be further divided into move-out and account-cancel, the operation type in the record may be connotative.","The method of this embodiment includes the following steps of:","Step , when the user route changes, the soft switch control device reporting the changed route information to the route service device of father node, including the user character information, the report node information and the route operation type, in which, the report node information refers to the node reporting route information, and may be S or R; the route operation type has two kinds, which are addition and deletion, when a user joining the soft switch device, the operation type of the reported route information is addition, when a user moving out of a soft switch device due to the move or account-cancel, the operation type of the reported route information is deletion;","Step , the route service device receiving the report looking up the record of user to be registered in the route information database, and comparing the record with the reported information, when the operation type is addition, if there is no route record of the user in the route information database, establishing a new route record; if the route record is different from the information in the record, performing corresponding operations according to the setting: if update is allowed, updating the record, otherwise, returning error directly without any operation on route information database, for example, U in  is connected to S first, at this time, there is a route record (U,S) in route information database of R, then shifting to S, supposing that S reports the route information (U, S, addition type) to R prior to S, at this time, R has to decide whether to permit the update of this route information according to policy, if permit, updating the record (U,S) to (U,S), otherwise, returning error information to S directly without any operation on the route information database; when the operation type of the reported information is deletion, only deleting the record of the user with the same reported node information, otherwise, not performing any operation, in which, this route record, same as the route information, includes the user character information, the reported node information and the operation type information, in this embodiment, because only the operation type of new added record is stored, the information of operation type can be omitted in the record;","Step , when the route information of the user from the node to its father node changes, the route service device accomplishing the registration broadcasting the route information to the father node, normally, this operation is performed after the registration, in which, because the node in the route service information is report node which is to change the node in the route record into the local node, and then compare the local node with the original record of the user so as to judge whether there is a change, so the information has to be broadcasted to the father node only when newly establishing or deleting the route record, for example, U in  moves to S, supposing that S reports information (U, S, addition type) to R prior to S, the original record (U, S) in R is updated to (U, S), but for R, the route information of the user is still (U, R, addition type), so it is not necessary to report to R, whereby reducing the quantity of broadcast;","Step , the route service device receiving the broadcast registering and broadcasting the received route information according to the same method of route service device receiving the report, wherein, the sub-node only broadcasts to the father node, while the node at the highest layer does not need to broadcast;","Step , when user calling, connecting the call in domain in local equipment; when calling across domains, the soft switch control device where the calling locates initiating inquiry to the route service device of father node.","Step , the route service device receiving the inquiry request looking up the record of the user to be looked up in the route information database; if the node in the user record is soft switch control device, obtaining the inquiring result of user route; if there is no record of the user and the local node is at the highest layer, obtaining the inquiring result that there is no user, when obtaining the inquiring result, performing step , otherwise, performing step ;","Step , if the node in the user record is route service device, continuing inquiring the node in the record, and returning to step , if there is no record of the user and the local node is not at the highest layer, continuing inquiring the father node, and returning to step ;","Step , returning the inquiring result to the inquiring node, and the node receiving the result continuing to return result to the node which inquires it, until returning to the soft switch control device which first initiates the inquiry, and ending.","In order to realize the above functions, as shown in , the route service device of the present invention includes the following modules:","route information database module, comprising a route record storage unit, for storing the route record of the user; a route record write-in unit, for writing in the user route record; a record access interface unit, for providing the interface to access the user record; and it can also including units for performing other operations on the route database, in this embodiment, the route service device stores the user route information of all the soft switch devices at the low layer of the device;","route registration module, comprising a report information receiving unit, for receiving route information reported by soft switch control device or forwarded by the route broadcast module; a registration access unit, for looking up the route record of the user in the route information database according to the information of the user to be registered in the reported information; a registration judgment unit, for establishing a new record if the route record of the user does not exist when the operation type is addition, or for updating the record in the database in conformity with preset conditions if the information in the user record is different from the reported information, otherwise, not performing operation; when the operation type of reported information is deletion and the report node in the user record is same as the node in the reported information, deleting the record of the user in database, with the special operation performed by the route record write-in unit;","route broadcast module, comprising a broadcast information receiving unit, for receiving route information broadcasted from other nodes, and handing it over to the route registration module for processing; a broadcast judgment unit, for judging whether the route information of registration user from local node to its father node changes, in this embodiment, if the route record is newly established or deleted, there will be changes, if yes, handing over the user route information to the route information broadcast unit; a route information broadcast unit, for broadcasting the changed route information to the father node (if there is a father node);","route inquiring module, comprising inquiry interface unit, for receiving inquiry request from other nodes or sending inquiry request to other nodes, and returning the inquiring result of the module to the inquiry node or forwarding the received inquiring result from other nodes; an inquiry access unit, for looking up in the route information database according to the user character information to be looked up in the inquiry request, and reporting the result to the inquiry judgment unit; an inquire judgment unit, for judging whether to obtain the user route according to the inquiring result, and determining whether the user does not exist, or it has to send inquiry request to father node or the node in the route record, and handing it to the inquiry interface unit for corresponding operation.","In this embodiment, the inquiry judgment unit makes judgment according to the following logic:","if there is record of user to be looked up in the inquiring result, judging whether the report node in the record is soft switch device, if yes, returning to the user route, otherwise, continuing inquiring the report node (R);","if there is no record of user to be looked up in the inquiring result, and if the local node is at the highest layer, returning the result that the user does not exist, otherwise, continuing inquiring the father node.","When networking this embodiment, S, S should register the user route information in domain with R, and S should register with R, R and R broadcast the user route information in database to R. Take the example of U joining S, the process for route registration is as follows:","S reporting a route information (U, S, addition type) to R through LDAP protocol;","if the route registration module of R can not find the record of U in route information database, establishing a record (U, S) in the route information database;","the route broadcast module of R finds that the node having to be broadcasted is R, judging that the route information of the user changes relative to R, then broadcasting the information (U, U, addition type) to R through TRIP protocol;","after receiving the message, the route broadcast module of R establishing the record of (U, R) in the route information database through the route registration module.","By the same token, the route information of U is reported to R and R, while the route information of U is reported to R and R. If the soft switch control device to be networked has been used, at the beginning of system start-up, the route service device should actively request all of the soft switch device for the route information.","When U is cancelled from S, S reports to R, and deletes the record of (U, S) from R, R broadcasts to R, and deletes the record of (U, R) from R.","When U moves from S to S, if S first reports to R to delete the route information of U, after R broadcasting to R, the records of U in R and R are deleted, S reports the route information of newly added U to R, R establishes record of (U, U), after R broadcasting to R, R newly establishes record of (U, R). If S first reports the route information of newly added U, R updates the record of (U, S) to (U, S), for R, the route information of U has no change, still being (U, R, addition type), therefore R does not need to broadcast to R, and when S broadcasts to R to delete the route information of U again, the report node of U record in R is S, which is different from node S in reported information, thereby not operating any operation.","After finishing the report and registration, each soft switch control device is able to find users of other soft switch control devices in network by the route service device, and establish service relationship with them. In , when U calling U, the calling route is as follows:","U dials U, S receives the calling request;","S can not get the route of U number, then it initiates inquiry for (U) route to R;","R inquires its route information database, obtaining such result as (U, S), and returning the result to S;","after S receiving the route result (U, S), it initiates a call to S, and S and S establish call channel for U and U by call signaling.","This call can be achieved only by one route service device.","When U dials U, the route of this call is more complex, with the whole process as follows:","U dials U, S receives the call request;","S can not get the route of U number, then it initiates inquiry for (U) route to R;","R can not find the route of (U) by route inquiry service, continuing initiating inquiry for (U) route to R;","after R receiving the inquiry request from R, it finds (U, R) by route inquiry service, because R is route service device, R continues initiating inquiry request for (U) route to R;","after R receiving the inquiry request from R, it finds (U, S) through route inquiry service, because S is soft switch control device, R returns inquiring result (U, S) to R;","after R receiving the result from R, it returns result (U, S) to R;","R returns the result (U, S) to S;","after S receiving the route result (U, S), it initiates call to S, S and S establish call channel for U and U by signaling.","Other call processes are similar.","Further, in the system of the present invention, the security of the telecommunication between each devices can be ensured by identify authentication and encryption.","The networking method () and the protocol employed in reporting inquiry of this embodiment are same as that of the first embodiment. But in the route information, the landing node information replaces the report node information, the route operation type is divided into three types: addition, move-out, and account-cancel; when performing route broadcast, the route service device broadcasts the changed route information not only to the father node, but also to the designated brother node; and the method for route report, registration and inquiry operation also has some corresponding changes.","The method in this embodiment for realizing route includes the following steps of:","Step , when the route of the user changes, the soft switch control device reporting the changed route information to the route service device of father node, the route information including user character information, landing node information and route operation type, in which, the route operation type is divided into addition, move-out and account-cancel, when a user joining the soft switch device, the operation type of the reported route information is addition; when a user moves from one soft switch device to another soft switch device, the operation type of the reported route information is move-out, which indicates that the user still exists, only with its location changed; when a user is cancelled from a soft switch device, the operation type of the reported route information is account-cancel, which indicates that the user does not exist;","Step , the route service device receiving report looking up the record of user to be registered in the route information database, and comparing the record with the reported information; when the operation type is addition, if there is no route record of the user in the route information database, establishing a new record; if the information in record is different from the reported information, updating the record when meeting the preset condition, otherwise, not performing any operation; if the operation type is move-out or account-cancel, only updating the record of user with the same landing-node information, otherwise, not performing any operation; the operation of this embodiment is related with the inquiry and judgment, therefore, the information of operation type can not be omitted in the record;","Step , the route service device accomplishing registration broadcasting the route information of the user to the father node and the designated brother node when the route information of the user in local node changes relative to its father node and designated brother node, in this embodiment, because the node in the route information is landing node, it is identical for sub-node, designated brother node or father node that whether the route information changes or not.","The route service device R can design whether to broadcast the changes of route information to the route service device R of the brother node, so that the networking becomes more flexible, and the network can have a better backup system. Supposing R, R in this embodiment are mutual designated brother nodes, when R accessing the user route of R, R only needs to inquire the route information database module of its own, without through the help of father node; it is same for R accessing the user route of R, therefore speeding up the access.","Step , the route service device receiving the broadcast registering and broadcasting the received route information by the same method of route service device receiving report;","Step , when user calling, connecting the call within domain in local device, when calling across domains, the soft switch control device where the calling locates initiating inquiry to the route service device of father node;","Step , the route service device receiving inquiry request looking up record of user to be looked up in the route information database, if finding the record that the user is addition type, obtaining the inquiring result of the user route; if finding the record that the user is account-cancel type, or that the local node is at the highest layer, and not finding the record of the user or finding the record of move-out type, obtaining the inquiring result that the user does not exist, when obtaining the inquiring result, performing step , otherwise, performing step ;","Step , when the local node is not at the highest layer, and not finding the user record or finding the record of move-out type, continuing inquiring its father node, and returning to step ;","Step , returning the inquiring result to the inquiry node, and the node receiving the result continuing to return result to the node which inquires it, until returning to the soft switch control device first initiating inquiry, and ending.","In this embodiment, the user character information should include the information of special domain, so as to prevent from the condition that the user joining from another domain employs the same character information with the account-cancel user. Furthermore, the actual inquiry process during calling is different due to different broadcasting forms.","The route service device of this embodiment includes the following modules:","route information database module, which has the same units and functions as the first embodiment, with differences due to the different broadcasting form that the route service device stores the user route information of all the soft switch devices below the layer of local node and designated brother node;","route registration module, wherein the units and the function of the report information receiving unit and registration access unit are same as the first embodiment, while the registration judgment unit is for establishing record newly if there is no route record of the user when the operation type is addition, and for updating the record in database when meeting the preset condition if the information in user record is different from the reported information, otherwise, not performing any operation; if the operation type of reported information is move-out or account-cancel, and the landing-node in user record and node in report information is same, updating the operation type of the record in database;","route broadcast module, wherein the units and the function of the broadcast information receiving unit are same as the first embodiment, while the broadcast unit is for judging whether the route information of the registered user in local changes relative to its father node and designated brother node, if changes, handing the user route information to the route information broadcast unit; the route information broadcast unit is for broadcasting the changed route information to father node (if existing) and designated brother node;","route inquiry module, wherein the units and the function of inquiry interface unit and inquiry access unit are same as the first embodiment, the inquiry judgment unit judges whether to return inquiring result or to continue initiating inquiry request to other nodes according to inquiring result by the following logic:","if there is no record of user to be looked up in the result, and if the node is at the highest layer, returning the result of no user existing, otherwise, continuing inquiring the father node;","if there is record of user to be looked up in the result, performing the following operations according to different operation types:","when the operation type is addition, because there is information of user landing-node in the record, returning the user route;","when the operation type is move-out, if the node is at the highest layer, returning the result that there is no user, otherwise, continuing inquiring the father node; and","when the operation type is account-cancel, returning the result that the user does not exist.","In this embodiment, when U joining in S, S reports the route information of (U, S, addition type) to R, R establishes the record of (U, S, addition type) in the route information database, and broadcasts to R and R, thereby newly adding the record of (U, S, addition type) to R and R;","When U is cancelled from S, S reports to S, and updates the record of (U, S, addition) to (U, S, account-cancel type) in R, and broadcasts to R and R, and updates the record of (U, S, addition type) in R and R to (U, S, account-cancel type).","When U moves from S to S, S first reports move-out information to R, R updates the record of (U, S, addition type) to (U, S, move-out type), and broadcast to R and R, and also update the record of (U, S, addition type) in R and R to (U, S, move-out type), then S reports new addition information to R, because the record information of U in R is different from the reported information, R updates the record of (U, S, move-out type) to (U, S, addition type), and broadcasts to R and R, in the same way, R and R will update the record (U, S, move-out type) into (U, S, addition type) again; if S first reports the new addition information to R, R newly establishes record (U, S, addition type) and broadcasts to R and R, R and R update the record (U, S, addition type) to (U, S, addition type), when S reports move-out information to R again, because in R the node S in move-out information is different from the node in record (U, S, addition type), no operation will be performed, and because the route information of U in R has no change, R does not broadcast to R.","After networking according to , U dials U according to the following processes:","U dialing U, S receiving the call request;","when R can not find the route of U number, initiating (U) route inquiry to R;","after R receiving the inquiry request from S, it finding the record of (U, S, addition type) through the route inquiry service, because S is soft switch device, returning inquiry result (U, S) to S;","after S receiving the route result (U, S), it initiating a call to S, S and S establishing a call channel for U and U by signaling.","It can be seen from above that, by employing the broadcast form of the present invention and employing the landing node information in the route information, the process of call route is simplified, but the broadcast quantity and the load of route service device are somewhat increased.","After U is cancelled from R, when U dials U, S inquires R, R finds the record of (U, S, account-cancel type), and returns the result that the user does not exist to S directly, thus the times of inquiry is reduce, and the inquiry process is simplified.","Based on the above embodiments, various combinations and changes can be performed, for example, as for whether the user node information uses the landing node information or the report node information, whether the route service device to be broadcasted to designated brother node, and whether the operation type is divided into addition and deletion or divided into addition, move-out and account-cancel, these selections can be combined into many forms freely; correspondingly, the logic for judging whether the user route or the user exists or not, and which node to be inquired will also be different, but this can be definitely realized according to the disclosure of the present invention.","For more example, when user moves out, the above embodiments do not limit the report sequence for moving out and moving into soft switch control device, but this can also be preset, for example, presetting first reporting the soft switch device moving out, then the report information corresponding to move-out type can be registered by the same rule of addition information, that is, if the record in database and the report information is different, updating the record. This preset is related with the rule of route registration.","For more example, when the operation type of the user record of the route service device at the highest layer is move-out or account-cancel, the result returned is that the user does not exist just as when there is no user record, therefore, it is possible to only maintain the record of addition type When using three kinds of operation types;","Furthermore, the route service device of the present invention is not limited to be employed in one certain networking form.","The present invention is employed in the route service device under the next generation network system architecture, in which the soft switch control device is the core equipment in the next generation network system architecture, by employing the present invention, when the user route information of one soft switch control device changes, this change will be reflected onto the route service device, when other soft switch control devices call the user, they can obtain the soft switch control device which the user belongs to by inquiring the route service device. Furthermore, the route service device will make the networking form of the soft switch control device more flexible. Any soft switch control device can make their user routes shared in the whole network as long as they are connected to the network by the route service device, without necessity to manually configure the route information from one soft switch device to another. Therefore, the present invention frees the soft switch control device from the complex route information maintenance, enables the soft switch control device be absorbed in provision of service while without the management of route, and also provides a scheme of large scale networking at telecommunication level for the soft switch control device."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":[{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
