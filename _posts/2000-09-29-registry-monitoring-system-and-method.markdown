---
title: Registry monitoring system and method
abstract: A registry monitoring method particularly applicable to a system () in which protected data is transmitted to a recipient computer. The method comprises requesting a handle for a registry key to a calling process, requesting a registry key value for the handle, modifying and deleting keys and values of protected data locations, and obtaining security clearance to complete the requests by checking secured process lists and rejection lists. Also included are a registry monitoring system, a secured data transmission system including registry monitorings, a machine-readable medium comprising a program to monitor a registry (), and a computer configured to monitor a registry ().
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07096326&OS=07096326&RS=07096326
owner: Pinion Software, Inc.
number: 07096326
owner_city: Austin
owner_country: US
publication_date: 20000929
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["The invention relates to the protection of data stored in a computer, and more particularly to data which has been imported from an outside source.","A registry is a hierarchical repository for configuration data. The terms \u201cinformation\u201d and \u201cdata\u201d as used herein are each intended to include the broadest definition of the other, and each include text, audio and video data. By way of further example, the term \u201cinformation\u201d can mean raw data, processed data, or a combination of raw and processed data. The registry may keep track of all software stored on the computer, and the relationship between programs. The registry may keep track of a plurality of users and hardware configurations. Preferences may vary among the plurality of users.","Each piece of data in the registry has a key-value associated with it. Together the name and value is referred to as a value entry. A key is analogous to a folder and may itself contain one or more folders, which may be referred to as subkeys, and one or more name-value pairs. The key may also be referred to as a name or a handle. To access the data and retrieve the stored value the correct key is needed.","Because the registry is a database, and thus, is a data storage location, it may be exploited for leaking data. \u201cLeaking data\u201d as used herein means transferring data out of a system in which it is desired to have the data secured. A process may write information to the registry, for example, for temporary storage. Another process may then access the information from the registry and write the data to a registry key. Another process may then read the data from the registry key and write it to a disk or other storage device, thereby leaking data. Accordingly, for applications wherein data security is important, there is a need to limit data leakage from the registry.","The invention discloses a registry monitoring method particularly applicable to a system in which protected data is transmitted to a recipient computer. An illustrative embodiment of the invention comprises requesting a handle for a registry key to a calling process, requesting a registry key value for the handle, modifying and deleting keys and values of protected data locations, and obtaining security clearance to complete the requests by checking secured process lists and rejection lists.","Further disclosed are a registry monitoring system, a secured data transmission system including registry monitoring, a machine-readable medium comprising a program to monitor a registry, and a computer configured to monitor a registry.","Embodiments of the invention disclosed comprise a method and system for monitoring a registry and may reduce or eliminate data leakage from the registry. The invention secures processes to deny data transfer to non-visual aspects of the system. This includes, for example, restricting writing to a file system, transferring data over communication ports, sharing memory with other processes and writing data to the registry.","An exemplary embodiment of the registry monitoring method comprises requesting a handle for a registry key to a calling process, requesting a registry key value for the handle, and obtaining security clearance to complete the requests by checking secured process lists and rejection lists. Because the ability to add to the registry is blocked, the ability to delete from the registry is also blocked. Therefore, the system includes a method for modifying and deleting keys and values with a security check incorporated therein.","The registry monitoring method of the present invention is best described as it may be carried out on a computer implemented secured data transmission system. An illustrative example of such a system comprises two main components, a data packager and a receiver. The packager is used to create packages that carry file content to target recipients. The receiver runs on a recipient computer to allow access to packaged file content.",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1","b":["100","120","140","0","130","160","140","160","110","120","140"]},"A package carries data and provides associated information to a command center which is a component of an application programming interface, such as a Win32 process. A communication driver handles communication between the application programming interface and a plurality of device drivers. It provides a single set of device driver I\/O control functions that are called from the application programming interface to send information to or retrieve information from the device drivers. The communication driver is called by a hook driver to notify the command center that a process is trying to open a packaged file. The device drivers, together with the application programming interface, marshal the packaged content into a vault and support access to the content, subject to an originator's permission selection. The command center may watch for packages to be executed and prompt users for file names to save a package payload. It may notify the file system hook driver that a package payload should be absorbed into the vault. It may present users with dialog indicating that an application is attempting to open a packaged file. It may also notify device drivers  when applications exit. The command center may block clipboard access and terminate applications at the request of a permissions device driver when permissions expire. Permission information is contained in a database and may include, for example, file names, package ID, file system ID and file permissions. File permissions may include, but are not limited to, length of time or number of times a file may be open, date after which a file may no longer be opened, and printing and clipboard permissions.","File system hook driver  obtains a data request initiated from a user who is looking to access a packaged or absorbed file. When hook driver  receives the requests it performs a security check on the process and then queries the user. The process is then added to a secured process list. The registry monitor is notified that the process is secured so it may block access in the future.",{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIGS. 2","FIG. 2A"],"b":["302","304","306","308","310","312","314","312"]},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 2B","b":["316","318","320","322","324","326","328","326","330","332","328","326","324","326"]},"Handles and values may then be deleted or modified. An exemplary flow chart for a deletion or modification sequence is depicted in . A delete or set-value call is made in step . The process ID is then determined in step . In step  it is then determined whether the process is secured by checking whether the process is on the secured process list. If the process is not on the secured process list, the request is completed in step  and the call is successfully filtered in step . If the process is on the secured process list, the request is not allowed to be completed in step  and the call is successfully filtered in step .","Further disclosed is a registry monitoring system wherein the registry is monitored according to methods described herein. Additionally, an embodiment of the invention includes a computer configured to monitor a registry according such methods. The terms \u201ccomputer\u201d or \u201ccomputer system\u201d as used herein include any device capable of receiving, transmitting, and\/or using information, including, without limitation, a processor, a microprocessor, a personal computer, such as a laptop, palm PC, desktop or workstation, a network server, a mainframe, an electronic wired or wireless device, such as for example, a telephone, an interactive television or electronic box attached to a television, such as for example, a television adapted to be connected to the Internet, a cellular telephone, a personal digital assistant, an electronic pager, and a digital watch In an illustrative example information is transmitted in the form of e-mail. Embodiments of the invention still further include a machine-readable medium comprising a program to monitor a registry according to methods described herein.","While the invention has been described by illustrative embodiments, additional advantages and modifications will occur to those skilled in the art. Therefore, the invention in its broader aspects is not limited to specific details shown and described herein. Modifications, for example, to steps for obtaining security clearance to complete requests, may be made without departing from the spirit and scope of the invention. Accordingly, it is intended that the invention not be limited to the specific illustrative embodiments but be interpreted within the full spirit and scope of the appended claims and their equivalents."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DESCRIPTION OF THE DRAWINGS","p":["The invention is best understood from the following detailed description when read with the accompanying figures.",{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIGS. 2"}]},"DETDESC":[{},{}]}
