---
title: Method and system for securely computing a base point in direct anonymous attestation
abstract: A method and system computes a basepoint for use in a signing operation of a direct anonymous attestation scheme. The method and system includes computing a basepoint at a host computing device and verifying the base point at a trusted platform module (TPM) device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09219602&OS=09219602&RS=09219602
owner: Intel Corporation
number: 09219602
owner_city: Santa Clara
owner_country: US
publication_date: 20111227
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION OF THE DRAWINGS"],"p":["As computing devices and electronic communication networks continue to proliferate in a variety of forms, information security remains an important concern. Cryptographic techniques are often used to ensure that electronic information is safely delivered to its intended recipient, and to determine whether devices and\/or processes requesting access to information or other devices should be granted such access. Public key cryptography is a technique that typically uses two keys: a private key, which remains secret; and a public key, which may be freely disclosed, to define membership in a group of trusted computing devices. While the public key and the private key are related, the private key cannot feasibly be determined from the public key.","Public key cryptography can be used to implement digital signature schemes. In general, a digital signature scheme is a mathematical framework for authenticating an electronic message or document. If a digital signature is determined to be valid, it can be inferred that the message encoded with the signature originated from a trusted source and has not been modified during transit. In public key digital signature schemes, a private key is used to create a digital signature of a message, while a corresponding public key is used to check the validity of the digital signature.","A direct anonymous attestation (DAA) scheme is a digital signature scheme for anonymous attestation and authentication of a computing device using the public key approach. Direct anonymous attestation schemes permit a computing device's membership in a trusted group to be verified by a remote entity (e.g., a software process, hardware device, or server) without the computing device revealing information about its identity. An elliptic curve-based DAA scheme is a type of DAA scheme in which an elliptic curve is defined and parameters of the elliptic curve are used to generate signature keys for members of the group of trusted computing devices.","The Trusted Platform Module (TPM) specification is a published specification, authored by the Trusted Computing Group, which describes a hardware-based implementation of a DAA scheme for verifying the integrity of computing devices. The term, \u201cTPM\u201d may be used to refer to implementations of that scheme.","Some DAA schemes, including the TPM version 1.2 specification published by the Trusted Computing Group, divide the process of signing a message with a digital signature between two devices. This allows resource-intensive computations to be performed by a device that has the computational power to handle them.","While the concepts of the present disclosure are susceptible to various modifications and alternative forms, specific exemplary embodiments thereof have been shown by way of example in the drawings and will herein be described in detail. It should be understood, however, that there is no intent to limit the concepts of the present disclosure to the particular forms disclosed, but on the contrary, the intention is to cover all modifications, equivalents, and alternatives falling within the spirit and scope of the invention as defined by the appended claims.","In the following description, numerous specific details such as logic implementations, opcodes, means to specify operands, resource partitioning\/sharing\/duplication implementations, types and interrelationships of system components, and logic partitioning\/integration choices are set forth in order to provide a more thorough understanding of the present disclosure. It will be appreciated, however, by one skilled in the art that embodiments of the disclosure may be practiced without such specific details. In other instances, control structures, gate level circuits and full software instruction sequences have not been shown in detail in order not to obscure the invention. Those of ordinary skill in the art, with the included descriptions, will be able to implement appropriate functionality without undue experimentation.","References in the specification to \u201cone embodiment,\u201d \u201can embodiment.\u201d \u201can example embodiment,\u201d etc., indicate that the embodiment described may include a particular feature, structure, or characteristic, but every embodiment may not necessarily include the particular feature, structure, or characteristic. Moreover, such phrases are not necessarily referring to the same embodiment. Further, when a particular feature, structure, or characteristic is described in connection with an embodiment, it is submitted that it is within the knowledge of one skilled in the art to effect such feature, structure, or characteristic in connection with other embodiments whether or not explicitly described.","Embodiments of the invention may be implemented in hardware, firmware, software, or any combination thereof. Embodiments of the invention implemented in a computer system may include one or more bus-based interconnects between components and\/or one or more point-to-point interconnects between components. Embodiments of the invention may also be implemented as instructions carried by or stored on a transitory or non-transitory machine-readable medium, which may be read and executed by one or more processors. A machine-readable medium may be embodied as any device, mechanism or physical structure for storing or transmitting information in a form readable by a machine (e.g., a computing device). For example, a machine-readable medium may be embodied as read only memory (ROM); random access memory (RAM); magnetic disk storage media; optical storage media; flash memory devices; mini- or micro-SD cards, memory sticks, electrical signals, and others.","In the drawings, specific arrangements or orderings of schematic elements, such as those representing devices, modules, instruction blocks and data elements, may be shown for ease of description. However, it should be understood by those skilled in the art that the specific ordering or arrangement of the schematic elements in the drawings is not meant to imply that a particular order or sequence of processing, or separation of processes, is required. Further, the inclusion of a schematic element in a drawing is not meant to imply that such element is required in all embodiments or that the features represented by such element may not be included in or combined with other elements in some embodiments.","In general, schematic elements used to represent instruction blocks may be implemented using any suitable form of machine-readable instruction, such as software or firmware applications, programs, functions, modules, routines, processes, procedures, plug-ins, applets, widgets, code fragments and\/or others, and that each such instruction may be implemented using any suitable programming language, library, application programming interface (API), and\/or other software development tools. For example, some embodiments may be implemented using Java, C++, and\/or other programming languages.","Similarly, schematic elements used to represent data or information may be implemented using any suitable electronic arrangement or structure, such as a register, data store, table, record, array, index, hash, map, tree, list, graph, file (of any file type), folder, directory, database, and\/or others.","Further, in the drawings, where connecting elements, such as solid or dashed lines or arrows, are used to illustrate a connection, relationship or association between or among two or more other schematic elements, the absence of any such connecting elements is not meant to imply that no connection, relationship or association can exist. In other words, some connections, relationships or associations between elements may not be shown in the drawings so as not to obscure the disclosure. Also, for ease of illustration, a single connecting element may be used to represent multiple connections, relationships or associations between elements. For example, where a connecting element represents a communication of signals, data or instructions, it should be understood by those skilled in the art that such element may represent one or multiple signal paths (e.g., a bus), as may be needed, to effect the communication.","Herein, alphanumeric characters and\/or mathematical symbols, or a combination thereof, may be used to represent data values, variables, coefficients, functions, equations or portions thereof. It should be understood that once defined, a character or symbol may be repeated throughout the disclosure, and that, unless otherwise stated, such repeated instances of a character or symbol refer to the same character or symbol as initially defined.","Referring now to , an illustrative information security system  includes a Trusted Platform Module (TPM) platform , which is communicatively coupled to an issuer computing device  and a verifier computing device  in an elliptic curve-based direct anonymous attestation (DAA) security scheme. In operation, the issuer  generates a group public key that can be used to define a group of trusted computing devices, which, in the illustrative embodiment, includes the TPM platform .","As described in more detail below, the TPM platform  interfaces with the issuer  to create a signature key. The signature key is used by the TPM platform  to generate a digital signature. When the TPM platform  desires access to information or to send information to another computing device that is secured using the elliptic curve-based DAA scheme, the TPM platform  attempts to prove its membership in the trusted group by sending a message encrypted with the digital signature to the verifier . If the digital signature is valid and has not been revoked, the TPM platform 's attempt to prove membership in the trusted group should be successful.","In the Trusted Computing Group (TCG) context, the TPM platform  may be embodied as a combination of a Trusted Platform Module and a host machine to which the TPM can be communicatively coupled. The illustrative TPM platform  divides the task of generating the digital signature between a TPM device  and a host . In accordance with the elliptic curve-based DAA scheme, the host  computes a basepoint, which is a point on an elliptic curve, and the TPM device  verifies that the basepoint is valid, before the digital signature is created. To reduce the risk of static Diffie-Hellman attacks and\/or other security issues that could compromise the authenticity of the digital signature, the host  is required to compute the basepoint using a hash function that is specially designed to hash a string of arbitrary length to a point on the elliptic curve. In this way, the host  is prevented from selecting the basepoint without the involvement of the TPM device , but is still able to bear a large portion of the computational burden of the signing process.","To verify the basepoint, the TPM device  computes the \u201cx\u201d coordinate of the basepoint using a regular hash function that outputs a fixed-length string. Since the TPM device  is only required to compute a regular hash function to output a single value rather than coordinates of a point on the elliptic curve, the computational overhead at the TPM device  is minimized.","Referring further to , the illustrative TPM device  includes at least one processor , a memory , an input\/output (I\/O) subsystem , a storage device , one or more peripheral devices , and a flash memory . Cryptographic information , such as a group member private key, is stored in memory of the TPM device , and DAA logic  is installed on the TPM device . In the illustrative embodiment, the cryptographic information  is stored in the flash memory , which is non-volatile, and the DAA logic  resides in the I\/O subsystem . In other embodiments, all or other portions of the DAA logic  and\/or cryptographic information  may reside in other locations accessible to the processor . For example, portions of the DAA logic  and\/or the cryptographic information  may be loaded into the memory  during operation of the TPM device , for faster processing or other reasons.","The TPM device  may be embodied in or as any type of computing device, such as, for example, a desktop computer system, a laptop or tablet computer system, a server, an enterprise computer system, a network of computers, a handheld computing device, or other electronic device depending on the particular application.","The illustrative processor  may be embodied as one or more processor cores or logical sections of a single core. In addition to cache memory, the processor  and\/or its core(s) include, or are otherwise communicatively coupled to, the memory . Portions of the memory  may be embodied as any type of suitable memory device, such as a dynamic random access memory device (DRAM), synchronous dynamic random access memory device (SDRAM), double-data rate dynamic random access memory device (DDR SDRAM) and\/or other volatile memory devices.","The processor  is also communicatively coupled to the I\/O subsystem . Although not specifically shown, the I\/O subsystem  typically includes a memory controller (e.g., a memory controller hub (MCH) or northbridge), an input\/output controller (e.g., an input\/output controller hub (ICH) or southbridge), and a firmware device (e.g., BIOS or UEFI). Of course, in other embodiments, I\/O subsystems having other configurations may be used. For example, in some embodiments, the I\/O subsystem  may form a portion of a system-on-a-chip (SoC) and be incorporated, along with the processor  and other components of the TPM device , on a single integrated circuit chip. As such, it will be appreciated that each component of the UO subsystem  may be located on a common integrated circuit chip in some embodiments.","The I\/O subsystem  is communicatively coupled to the storage . Portions of the storage  may be embodied as any suitable device for storing data and\/or instructions, such as disk storage (e.g. hard disks), memory cards, memory sticks, and\/or others. In some embodiments, an operating system, application code and\/or data structure may be embodied in the storage .","The I\/O subsystem  may be communicatively coupled to one or more peripheral devices . The peripheral device(s)  may include one or more network interfaces, graphics and\/or video adaptors, keyboard, touchscreens, displays, printers, data storage devices, and\/or other peripheral devices, depending upon, for example, the intended use of the TPM device . Further, it should be appreciated that the TPM device  may include other components, sub-components, and devices not illustrated in  for clarity of the description.","The host , issuer  and verifier  are, in the illustrative embodiment, computing devices. While details of the specific structure of the host , issuer , and verifier  have been omitted so as not to obscure the disclosure, it should be understood that each of these devices generally includes one or more processors, memory, and an I\/O subsystem similar or analogous to those shown and described above in connection with the TPM device . For example, in some embodiments, the issuer  may be embodied as a computing device associated with a computing device provider (e.g. a hardware or software manufacturer). In some embodiments, the TPM platform  may be embodied as a hardware device (e.g., a platform controller hub (PCH), central processing unit (CPU), or graphics processor (e.g., LRB)), in which the TPM device  and the host  are embodied in the hardware device. In other embodiments, the TPM device  and the host  may be embodied as separate computing devices communicatively coupled by a network. In some embodiments, the verifier  may be embodied as software residing on the host  or another computing device, such as a server on the Internet or another hardware device. In some embodiments, the TPM device  is a device that has significantly less computational resources (e.g., processing power, memory, etc.) than the host .","DAA logic , ,  and cryptographic information , ,  configured to implement the elliptic curve-based DAA scheme are embodied in each of the host , issuer , and verifier , respectively (e.g. in memory or storage). Details relating to the DAA logic , ,  and cryptographic information , ,  are described below in connection with .","In general, the components of the TPM device , the host , the issuer , the verifier , and the information security system  are communicatively coupled as shown in , by one or more signal paths, which are represented schematically as double-headed arrows. Such signal paths may be embodied as any type of wired or wireless signal paths capable of facilitating communication between the respective devices. For example, the signal paths may be embodied as any number of wires, printed circuit board traces, via, bus, point-to-point interconnects, intervening devices, and\/or the like. Double-headed arrows with dashed lines are used in  to indicate that a signal path may be embodied as a wired or wireless communication network, which may include a public or private LAN, Ethernet network, the Internet, and\/or others.","Referring now to , an illustrative DAA scheme  is shown. The DAA scheme  includes computer instructions, modules, routines, processes or the like , , , and , portions of which are executed by the TPM platform , TPM device , host , issuer , and verifier . At block , the issuer  generates domain parameters of the DAA scheme, which include the elliptic curve parameters. The issuer  uses the domain parameters to generate a group issuing key or \u201cmaster\u201d key. The issuer  also uses the domain parameters to generate a group public key, which can be used to define a group of trusted computing devices.","At block , the issuer  uses the master key to issue a unique signature key to each member of the trusted group (e.g., the TPM platform ). The signature key is generated without revealing any information about the master key. In other words, the issuer  keeps the master key secret. The signature key includes a unique group private key and a membership credential. As shown in the illustrative embodiment and described below in connection with , the process of creating a signature key for the TPM platform  involves interaction between the issuer  and the TPM platform .","At block , the TPM platform ) uses its signature key, the group public key, and a basename supplied by the verifier , among other parameters, to generate a digital signature and sign a message with the digital signature without revealing any information about the group member private key. In other words, the group member private key is used to create the digital signature, but the digital signature does not include any information about the group member private key. In accordance with the illustrative embodiment, the digital signature may be referred to as a \u201cDAA signature.\u201d","In some embodiments, the basename may be randomly generated (e.g., it is a special symbol, such as \u201c\u22a5\u201d). In cases where the basename is randomly generated, the resulting digital signature will be truly anonymous (i.e., each digital signature will be unique because a different basename is generated each time a signature is created) and therefore unlinkable. In other embodiments, the basename may be supplied by the verifier . If the basename is supplied by the verifier , it may be used in multiple digital signatures, and those digital signatures are considered linkable. As shown in the illustrative embodiment and described below in connection with , the process of creating a digital signature for a message to be sent by the TPM platform  involves interaction between the TPM device  and the host .","At block , the verifier  uses the group public key to validate a digital signature received from a computing device (e.g. the TPM platform ). More specifically, the verifier  determines, without knowing the group member private key, whether the digital signature has been created by a computing device that has been issued a valid group member private key. Optionally, the verifier  may also determine whether the digital signature is on a revocation list, i.e., whether the digital signature, even if valid, has been revoked by the issuer .","Referring now to , an illustrative method  for implementing the DAA scheme  is shown. Among other things, execution of the method  involves data transmissions , , , , , , , , ,  by and among the issuer , TPM device , host  and verifier  as shown and described below. It should be understood that the illustrative method  is just one example of an elliptic curve-based DAA scheme, and that aspects of this disclosure are applicable more generally to any elliptic curve-based DAA scheme. Moreover, it should be understood that sequence numbers (e.g., (1), (2), . . . ) used to identify steps or processes of the method  are provided only for readability and are not meant to imply that all of the enumerated steps or processes are required to be performed in any certain order.","At event , the issuer  outputs a group public key, gpk=(Q, Q, W, T, T, T, T) and makes the group public key accessible to the verifier  (e.g. by digital transmission over a signal path or network). Prior to event , the issuer  executes a series of mathematical processes (e.g., at block ) to determine the parameters that make up the group public key, as follows:","(1) The issuer  chooses an asymmetric bilinear group pair (G, G) of large prime order p and an associated pairing function e: G\u00d7G\u2192G, where Gand Gare elliptic curves, Gis the elliptic curve on which a basepoint B is located, p is a prime number, and e is a mathematical pairing function configured to map a point in Gand a point in Ginto an element in G. In general, p is a large prime number. The size of p is determined by the security strength of the DAA scheme as designed for a particular application. In some embodiments, the security strength may be set to 256-bit, while in other embodiments, an 80-bit, 112-bit, or 128-bit security strength, or higher or lower security strength, may be used.","(2) The issuer  then randomly selects a point Pof Gusing a random number generator, where Pcomprises x and y coordinates of a point on G.","(3) The issuer  then randomly selects a point Pof Gusing a random number generator, where Pcomprises x and y coordinates of a point on G.","(4) The issuer  chooses two hash functions H: {0, 1}*\u2192Zand H: {0, 1}*\u2192G, where His a special hash function that hashes a string into an element in G, His a regular hash function that hashes a string into a fixed length string, and Zis the set of non-negative integers less than p. More specifically, His a special hash function that takes the basename string bsn, which is an arbitrary length message, as input, and outputs B, which is an element of G, i.e., B=H(bsn). The steps for computing B using Hare as follows:\n\n","(5) The issuer  chooses random elements Q, Qfrom Gusing a random number generator, where each of Qand Qcomprises x and y coordinates of a point on G.","(6) The issuer  chooses a random integer y from Z, where Zdp is the set of non-negative integers less than p, e.g., {0, 1, 2, . . . , p\u22121}. The issuer  computes W=[y]P, where [y]Pdenotes point multiplication on the elliptic curve G.","(7) The issuer computes T=e(P, P), T=e(Q, P), T=e(Q, P), and T=e(Q, W), where e is the pairing function described above.","(8) The issuer  outputs the following: domain parameters=(G, G, G, p, e, P, P, H, H), which define the DAA scheme; and also outputs the group public key=(Q, Q, W, T, T, T, T) and the group issuing key=y.","The events , , and  relate to the process of granting the TPM platform  membership in the trusted group associated with the group public key gpk (e.g., block  of ). At event , the issuer allows the TPM platform  access to Z so that the TPM platform  can select a group member private key. Prior to event , the issuer  performs the following:","(1) The issuer chooses a nonce n\u03b5{0, 1}. In general, a nonce is an arbitrary number that is used only once to sign a cryptographic communication. For example, the nonce may be a random or pseudo random number.","(2) The issuer sends nto the TPM platform  (or otherwise allows access to nby the TPM platform ).","At event , the TPM platform :","(3) chooses at random the group member private key f from Z. Following the event , the TPM platform  does the following:","(4) The TPM platform  chooses at random integer r from Z.","(5) The TPM platform  computes F=[f]Qand R=[r]Q, using point multiplication on the elliptic curve G.","(6) The TPM platform  computes c=H(p, P, P, Q, Q, W, F, R, n).","(7) The TPM platform  computes s=(r+c\u00b7f) mod p, where mod is a modular arithmetic operation.","At event , the TPM platform :","(8) sends the commitment parameters of the group member private key (F, c, s) to the issuer  (or otherwise allows access to (F, c, s) by the issuer ). Following the event , the following operations are performed by the issuer :","(9) The issuer  computes R=[s]Q\u2212[c]F using point multiplication on the elliptic curve G.","(10) The issuer  verifies that c=H(p, P, P, Q, Q, W, F, R, n). This can be done by computing the hash value of the right hand side of the equation and comparing the result to c as computed by the TPM platform  above.","(11) The issuer  chooses a random integer x from Z.","(12) The issuer  computes A=[1\/(x+y)](P+F).","At event , the issuer :","(13) sets (A, x) as the membership credential for the TPM platform  and sends it to the TPM platform  (or otherwise allows access to (A, x) by the TPM platform ). Following the event :","(14) The TPM platform  verifies (A, x) by checking that e(A, W+[x]P)=e(P+F, P). If the TPM platform  successfully verifies the membership credential (A, x), then:","(15) The signature key for the platform is (f, A, x), where f is the group member private key and (A, x) is the membership credential.","Once the TPM platform  has obtained a signature key, the TPM platform  can create a DAA signature and use the DAA signature to sign a message. The events , , , , , , and  relate to the DAA signature creation and signing process. The illustrative DAA signing process is jointly performed by the TPM device  and the host  as shown in . Using the group public key (Q, Q, W, T, T, T, T), the group member signature key (f, A, x), a linking basename bsn, a nonce n\u03b5{0, 1}, and a message m\u03b5{0, 1}* to be signed, the illustrative signature process is as follows:","(1) The TPM device  accesses the group member private key f while the host  is given access to the membership credential (A, x).","(2) A basepoint B, which is a point on the elliptic curve Ghaving x and y coordinates B.x and B.y, is determined according to a method , an illustrative embodiment of which is shown in  and described below. The events , , and  are related to the determination of B. Once B has been determined and verified:","(3) The TPM device  computes K=[f]B using point multiplication on the elliptic curve G.","(4) The TPM device  chooses a random integer rfrom Zusing a random number generator.","(5) The TPM device  computes R=[r]B and R=[r]Qusing point multiplication on the elliptic curve G.","At event , the TPM device :","(6) sends the host pre-computation result, (B, K, R, R) to the host  (or otherwise allows access to (B, K, R, R) by the host ).","Following the event :","(7) The host  chooses a random integer a from Zand computes b=(a\u00b7x) mod p.","(8) The host  computes T=A+[a]Qusing point multiplication on the elliptic curve G.","(9) The host  randomly picks three integers r, r, r, from Zusing a random number generator.","(10) The host  computes R=e(R\u2212[r]T+[r]Q, P)\u00b7Tusing the pairing function e and point multiplication on the elliptic curve G.","(11) The host  computes the host digest, c=H(p, P, P, Q, Q, W, B, K, T, R, R, n).","At event , the host :","(12) sends the host digest, cto the TPM device  (or otherwise allows access to c, by the TPM device ).","Following the event :","(13) The TPM device  chooses a nonce n\u03b5{0, 1}.","(14) The TPM device  computes c=H(c, n, m).","(15) The TPM device  computes s=(r+c\u00b7f) mod p, where mod is a modular arithmetic operation.","At event , the TPM device :","(16) sends the TPM portion of the DAA signature, (c, n, s), to the host  (or otherwise allows access to (c, n, s) by the host ).","Following the event :","(17) The host  computes s=(r+c\u00b7x) mod p, s=(r+c\u00b7a) mod p, s=(r+c\u00b7b) mod p, where mod is a modular arithmetic operation.","At event , the host :","(18) outputs the anonymous digital signature \u03c3=(B, K, T, c, n, s, s, s).","When the verifier  receives the digital signature, it verifies the signature using the following inputs: a message m, a linking base bsn, which is a string of arbitrary length, a nonce n\u03b5{0, 1}, a digital signature (B, K, T, c, n, s, s, s, s), and a group public key (Q, Q, W, T, T, T, T). In the illustrative embodiment, the verifier  may:","(1) Verify that B, K, T are elements in the elliptic curve G. This can be done by checking whether y=x+ax+b, for the x and y coordinates of each of the points B, K, and T.","(2) Verify that s, s, s, sare integers in Z. This can be done by determining whether the integers s, s, s, and sare non-negative integers having a value less than p.","(3) If bsn\u2260\u22a5 (i.e., bsn is not random), verify that B=H(bsn).","(4) Compute R=[s]B\u2212[c]K.","(5) Compute R=e(T, [\u2212s]P2\u2212[c]W)\u00b7[c]W)\u00b7T\u00b7T\u00b7T\u00b7T.","(6) Verify that c=H(H(p, P, P, Q, Q, W, B, K, T, R, R, n), n, m). This can be done by computing the hash value of the right hand side of the equation and comparing the result to c as computed by the TPM platform  above.","(7) Optionally, call a revocation checking process.","(8) If any of the above verification steps fails, the verifier  outputs 0 (indicating an invalid signature), otherwise, the verifier  outputs 1 (indicating a valid signature).","Referring now to , an illustrative method  for performing step (2) of the above signing process is shown. At block , the host  determines whether the basename string of arbitrary length bsn is random (e.g., bsn=\u22a5), or is a linking basename supplied by the verifier . If bsn=\u22a5, the host  chooses a random bsn string. Some examples of a basename supplied by the verifier  include a unique name, IP address, or web address associated with the verifier , or the verifier 's public key. The event  of  illustrates the determination of bsn by the host , with the dashed-line arrow indicating that the bsn may be obtained from the verifier .","At block , the host  computes B=H(bsn) using the above-described special-purpose hash function, which is configured to hash a string to a point on an elliptic curve. The intermediate result, the counter i value, which is the value of the counter i of the hash iteration that succeeded in finding a point on the elliptic curve, is also output. In the illustrative embodiment, i is a 32-bit unsigned integer. As mentioned above, B is a point on the elliptic curve G, and therefore comprises an \u201cx\u201d coordinate and a \u201cy\u201d coordinate, e.g., B.x and B.y.","At block , the host  sends the basepoint, counter, and basename string (B, i, bsn) to the TPM device , or otherwise allows access to (B, i, bsn) by the TPM device , as shown by the event  of . At block , the TPM device  verifies that B is a valid point in G. This can be done by calculating B.x+a*B.x+b and comparing the result to B.y. If B is a valid point in G, then B.y=B.x+a*B.x+b.","At block , the TPM device  verifies that the x coordinate of B, B.x=Hash(i\u2225bsn) mod q, where: Hash( ) is a regular hash function, such as the standard hash function SHA-256 or any other suitable collision resistant hash function configured to hash a string of arbitrary length to a fixed length string; the input to the Hash( ) function is the counter value i padded or concatenated with the basename string bsn; and mod is a modular arithmetic operation (\u201cmodulo\u201d). If either or both of the verification checks performed by the TPM device  at blocks  and  fails, the TPM device  rejects B as invalid and no digital signature is generated. If both of the verification checks performed by the TPM device  at blocks  and  are successful, then the signing process continues as described above.","The method  is described in the context of a particular elliptic curve-based DAA scheme; however, it should be understood that aspects of the method  can apply to any elliptic curve-based DAA scheme. Also, while steps of particular processes or methods disclosed herein may be enumerated in a particular order, it should be understood that such order is merely illustrative, and that any of the steps of a particular process or method, or individual methods or processes themselves, may be executed contemporaneously with other steps, methods and\/or processes and\/or executed in different sequential orders in other embodiments.","While the disclosure has been illustrated and described in detail in the drawings and foregoing description, such an illustration and description is to be considered as exemplary and not restrictive in character, it being understood that only illustrative embodiments have been shown and described and that all changes and modifications that come within the spirit of the disclosure are desired to be protected. Further, while aspects of the present disclosure have been described in the context of a hardware-based transactional memory system, it will be understood that the various aspects have other applications, for example, in contexts other than the TPM, and in any elliptic curve-based DAA application in which the signing operation is split between two devices, one of which has access to greater computational resources than the other."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The invention described herein is illustrated by way of example and not by way of limitation in the accompanying figures. For simplicity and clarity of illustration, elements illustrated in the figures are not necessarily drawn to scale. For example, the dimensions of some elements may be exaggerated relative to other elements for clarity. Further, where considered appropriate, reference labels have been repeated among the figures to indicate corresponding or analogous elements.",{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
