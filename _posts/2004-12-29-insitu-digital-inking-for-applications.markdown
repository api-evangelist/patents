---
title: In-situ digital inking for applications
abstract: A digital ink environment is provided for non-native ink application programs to create independent ink services for sharing between different application programs and transmission. The digital ink environment is provided for interacting with embedded or linked ink words or other ink data in a compound ink document. The user is provided with the freedom to input digital ink so they can write anywhere in the ink environment, in any orientation, and using any desired stroke size provided by the ink environment. The ink environment is provided in an activated state for in-situ user interaction and manipulation in a computing environment, for example a pen-based environment.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06965384&OS=06965384&RS=06965384
owner: Microsoft Corporation
number: 06965384
owner_city: Redmond
owner_country: US
publication_date: 20041229
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATION","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application is a continuation of U.S. patent application Ser. No. 10\/206,597, filed Jul. 29, 2002 now U.S. Pat. No. 6,867,786 which is expressly incorporated by reference.","Aspects of the present invention are directed generally to apparatus and methods for controlling a graphical user interface (GUI). Specifically, aspects of the present invention relate to systems and methods to allow users to manipulate electronic or digital ink for applications.","The use of graphical user interfaces has created a revolution in the field of computers. Instead of having to memorize arcane commands, the user can now manipulate software applications by controlling graphical objects representing their various functions and components. Conventional computer systems, especially computer systems using graphical user interface (GUI) systems accept user input from one or more discrete input devices, such as a keyboard for entering text, and a pointing device, such as a mouse with one or more buttons, for operating the user interface. The keyboard and mouse interface provides for fast creation and modification of documents, spreadsheets, database fields, drawings, photos and the like.","One common use of conventional computers and GUIs is to generate and edit electronic documents. These electronic documents can contain text (e.g., electronic word processors), which are displayed on the user's screen for editing. Typical mobile workers spend a significant amount of time gathering and distributing information on paper. A significant disparity, however, exists between the flexibility provided by the keyboard and mouse interface compared with non-computer pen and paper. Whether it's a phone number, a tentative date for the next meeting, or notes on a presentation, workers may spend many hours manually transcribing and merging handwritten information in traditional programs, such as word processing programs.","Introduction of pen-based computing devices has significantly changed the traditional view of the GUI, and the manner in which users can interact with their computers. One type of pen-based computing devices includes a personal computer in a Tablet form factor. While there are a number of designs, a pen-based computing device is generally interacted by user by way of a physical writable surface and a writing implement. The writable surface may be a display surface or a writing pad. Rather than a standard keyboard or mouse interface, the navigation and control of the GUI occurs via the writing implement. While pen-based computing devices have been helpful, the transition to a computer-based note taking or other applications for these mobile workers may prove difficult indeed. Conventional application programs, such as word processors, spreadsheet programs, database programs, electronic mail programs, and the like for the traditional GUIs may not effectively provide a user with the flexible of a pen-based computing environment.","Conventional applications programs are typically text centric. For example, traditional word processing and electronic mail programs typically requires a user to type into a keyboard and the programs typically arrange the typed text in uniform rows of across the user's screen. There is no convenient or flexible way to naturally take notes in an electronic form for a mobile user, but at the same ease the transition to a pen-based environment and provide the ability to preserve the investment in text centric applications.","Accordingly, there is a need for a flexible writing environment for a user to work with different applications.","Aspects of the present invention pertain to a digital ink environment for application programs that solves one or more problems mentioned above. In one aspect, an ink environment is provided by interacting with embedded or linked ink words or other ink data of a container ink object.","The ink environment is made accessible to the user through menus and a window of an application program that operates with the container ink object. Accordingly, a user is provided with the flexibility and freedom to input digital ink so they can write anywhere in the ink environment, in any orientation, and using any desired stroke size provided by the ink environment. In one aspect, the ink environment is provided in an activated state for in-situ user interaction and manipulation in a computing environment, for example a pen-based environment. In one aspect, the ink environment is enabled with the ink menu items that are assimilated with the menus of the application that implements the compound ink document. In various aspects, a system provides an ink environment in an Object Linking and Embedding environment, including component object model services that an application can use to capture, manipulate, and store ink. Advantageously, the ink environment can be provided to non-native ink applications to create independent ink services for sharing between different applications and transmission over networks to remote users. In some aspects of the present invention, a metafile is provided with antialiasing support to improve the visual appearance of ink.","The above and other aspects, features and advantages of the present invention will be readily apparent and fully understood from the following detailed description in conjunction with the accompanying drawings, which are included by way of example, and not by way of limitation with regard to the claimed invention.","The following description is divided into sub-sections to assist the reader. The sub-sections include: Terms; Overview; General Computing Environment; Illustrative Ink Environment; Illustrative System Environment; Ink Environment Behaviors; Rendering Ink; Ink Environment Insertion; and Example Use of Ink Environment.","Terms","As used herein the term \u201cstroke\u201d refers to a sequence or set of captured points. For example, when rendered, the sequence of points may be connected with lines. Alternatively, a stroke may be represented as a point and a vector in the direction of the next point. In short, a stroke is intended to encompass any representation of points or segments relating to ink, irrespective of the underlying representation of points and\/or what connects the points.","As used herein the term \u201cink\u201d refers to a sequence or a set of handwritten strokes. For example, the handwritten stokes might represents characters including written language or symbols, such as drawings made by a user and may be combined with properties.","As used herein the term \u201cpoint\u201d refers to information defining a location in predefined space. For example, a point may be defined relative to a capturing space (for example, points on a digitizer) and\/or a display space (the points or pixels of a display device). Points may be represented using a variety of known techniques including two dimensional Cartesian coordinates, polar coordinates, three dimensional coordinates, four dimensional coordinates, and other techniques as known in the art.","As used herein the terms \u201cink word\u201d refers to one or more handwritten strokes captured by systems according to the teaching of the invention. Each stroke in an ink word has a location associated with the stroke.","As used herein the terms \u201ctext word\u201d refers to machine-generated text. Text words may be introduced into the systems of the invention in any suitable manner, such as by an input device (e.g., a keyboard), by downloading (e.g., from memory or a network connection), by selecting from a menu, or from input ink words converted to machine-generated text via handwriting recognition software.","Overview","As will be discussed in detail below, the present invention in one aspect provides a digital ink environment for interacting with embedded or linked ink words or other ink data in a compound ink document. The ink environment is made accessible to the user through the window environment (menus and windows) of an application that operates with the compound ink document. The user is provided with the freedom to input digital ink so they can write anywhere in the ink environment, in any orientation, and using any desired stroke size provided by the ink environment. In one aspect, the ink environment is provided in an activated state for in-situ user interaction and manipulation in a computing environment, for example a pen-based environment. In one aspect, the ink environment is enabled with the ink menu items that are assimilated with the menus of the application that implements the compound ink document. In various embodiments, a system provides an ink environment in an OLE (Object Linking and Embedding) environment, including component object model (COM) services that an application can use to capture, manipulate, and store ink. Advantageously, the ink environment can be provided to non-native ink applications to create independent ink services for sharing between different applications and transmission over networks to remote users. In other embodiments, the ink environment may be provided by an ACTIVEX\u00ae control. In one aspect of the present invention, a metafile is provided with antialiasing support to improve the visual appearance of ink.","General Computing Environment","The ink environment of the present invention may be described in the general context of computer-executable instructions, such as program modules, executed by one or more computers or other devices.  is a schematic diagram of an illustrative general-purpose digital computing environment that may be used to implement various aspects of the present invention. In , a computer  includes a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. The system memory  includes read only memory (ROM)  and random access memory (RAM) .","A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within the computer , such as during start-up, is stored in the ROM . The computer  also includes a hard disk drive  for reading from and writing to a hard disk (not shown), a magnetic disk drive  for reading from or writing to a removable magnetic disk , and an optical disk drive  for reading from or writing to a removable optical disk , such as a CD ROM or other optical media. The hard disk drive , magnetic disk drive , and optical disk drive  are connected to the system bus  by a hard disk drive interface , a magnetic disk drive interface , and an optical disk drive interface , respectively. The drives and their associated computer-readable media provide nonvolatile storage of computer readable instructions, data structures, program modules, and other data for the personal computer . It will be appreciated by those skilled in the art that other types of computer readable media that may store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, Bernoulli cartridges, random access memories (RAMs), read only memories (ROMs), and the like, may also be used in the example operating environment.","A number of program modules may be stored on the hard disk drive , magnetic disk , optical disk , ROM , or RAM , including an operating system , one or more application programs , other program modules , and program data . A user may enter commands and information into the computer  through input devices, such as a keyboard  and a pointing device . Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices often are connected to the processing unit  through a serial port interface  that is coupled to the system bus , but may be connected by other interfaces, such as a parallel port, game port, or a universal serial bus (USB). Further still, these devices may be coupled directly to the system bus  via an appropriate interface (not shown). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video adapter . In addition to the monitor , personal computers typically include other peripheral output devices (not shown), such as speakers and printers. As one example, a pen digitizer  and accompanying pen or user input device  are provided in order to digitally capture freehand input. The pen digitizer  may be coupled to the processing unit  via the serial port interface  and the system bus , as shown in , or through any other suitable connection. Furthermore, although the digitizer  is shown apart from the monitor , the usable input area of the digitizer  may be co-extensive with the display area of the monitor . Further still, the digitizer  may be integrated in the monitor , or may exist as a separate device overlaying or otherwise appended to the monitor .","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a server, a router, a network PC, a peer device, or other common network node, and typically includes many or all of the elements described above relative to the computer , although only a memory storage device  with related applications programs  have been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) . Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet.","When used in a LAN networking environment, the computer  is connected to the local network  through a network interface or adapter . When used in a WAN networking environment, the personal computer  typically includes a modem  or other means for establishing a communications link over the wide area network , e.g., to the Internet. The modem , which may be internal or external, is connected to the system bus  via the serial port interface . In a networked environment, program modules depicted relative to the personal computer , or portions thereof, may be stored in a remote memory storage device.","It will be appreciated that the network connections shown are exemplary and other techniques for establishing a communications link between the computers may be used. The existence of any of various well-known protocols such as TCP\/IP, Ethernet, FTP, HTTP and the like is presumed, and the system may be operated in a client-server configuration to permit a user to retrieve web pages from a web-based server. Any of various conventional web browsers may be used to display and manipulate data on web pages.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIG. 2","FIG. 1","FIG. 2"],"b":["201","201","202","203","204","202","202","201","204"]},"The stylus  may be equipped with one or more buttons or other features to augment its selection capabilities. In one example, the stylus  may be implemented as a \u201cpencil\u201d or \u201cpen,\u201d in which one end constitutes a writing element and the other end constitutes an \u201ceraser\u201d end, and which, when moved across the display, indicates portions of the display to be erased. Other types of input devices, such as a mouse, trackball, or the like may be used. Additionally, a user's own finger may be the stylus  and used for selecting or indicating portions of the displayed image on a touch-sensitive or proximity-sensitive display. Consequently, the term \u201cuser input device,\u201d as used herein, is intended to have a broad definition and encompasses many variations on well-known input devices, such as the stylus .","Illustrative Ink Environment","As described above, aspects of the present invention relate to systems and processes for selecting and manipulating electronic or digital ink, e.g., in pen-based computing system. As noted above, aspects of the ink environment of the present invention can be implemented within an application program. For example,  is a schematic diagram of one ink environment within a non-native ink application program  that can be used with pen-based computing system  or general purpose computing environment . A non-native ink application program, such as an electronic mail program, may have an electronic mail message body  which includes text words  and an ink environment  therein. In the illustration shown in , within the ink environment, a user is free to make strokes of ink on a pen down action which may be stylus  contacting the display surface , the click of a mouse button, the operation of a button on a trackball or joystick, or the like. The user controls an input device (such as stylus ) and the resulting strokes continue until a pen-up action. The pen up action may be the lifting of the stylus  off the display surface , releasing or another operation of a mouse button, or the operation of the button (or other buttons) on the trackball or joystick or the like.","In one aspect, the ink environment  can be provided in an Object Linking and Embedding (OLE) environment developed by Microsoft Corporation\u00ae. In one embodiment, an ink server component (as an OLE server) can provide the ink environment to the application program. Object Linking and Embedding technology provides techniques which allow different application programs to cooperate together. In one aspect of the invention, within the OLE environment, the ink environment is created as an OLE object. This ink environment can be either linked or embedded into an application so as to be \u201ccontained\u201d within the application.","In an aspect of the invention, the container ink environment can be transmitted or otherwise accessed via a metafile between applications on a single computer, or between computers on different networks, such as the Internet. In the illustration shown in , the electronic mail message body  with the ink environment  and text words  form a compound ink document or a container ink object. Nevertheless, while an electronic mail message body is shown, a compound ink document can be created with the ink environment including text words, spreadsheet data, non-ink graphical objects, charts, graphs, audio data, video data and\/or the like. Consequently, the terms \u201ccompound ink document\u201d or \u201ccontainer ink object\u201d as used herein, is intended to have a broad definition and encompasses ink with other machine data. Accordingly, the ink environment with ink words therein creates a contained ink object. In the example shown in , the electronic mail application program can be referred to as a \u201ccontainer ink application\u201d. Nevertheless, a container ink application may include a word processing program, a presentation graphics program, an electronic spreadsheet program, a messaging and collaboration program, and the like.","Illustrative System Environment",{"@attributes":{"id":"p-0043","num":"0042"},"figref":["FIG. 4","FIG. 1","FIG. 2"],"b":["400","402","404","404","406","404","408","400","100","201"]},"With continued reference to , Ink Module  provides interfaces which are functionally associated with methods for the storage and manipulation of ink. Ink Server  communicates with a container ink application  to provide interfaces for user interaction with ink words or other ink data in the contained ink object. In one aspect, the interfaces are used through which container ink applications can communicate with their contained ink objects. In general as used herein, an interface is a set of methods, which abide by certain input, output, and behavior rules. The container ink application, such as the electronic mail application, does not directly access the methods, but communicates via the interfaces. It will be appreciated that the interfaces are also part of the OLE technology. In one aspect, Ink Module  exposes interfaces such as an Ink interface , and an Ink Event interface . The interfaces of Ink Module  can be used by the Ink Server .","As shown in , ink interface  of Ink Module  may have methods which include retrieving and setting ink attributes  such as bold, italics, color, and ink line thickness and the like. In addition, Ink Interface  may provide methods to retrieve and set input modes  for the ink environment. One input mode may include an inking mode associated with pen down action and pen up action. Another input mode may include a selection mode associated with the selection of ink words or the ink data in the ink environment. The selection mode may include data for dragging a box around ink strokes for a selection. The selection mode may also include whether a lasso selection is occurring with a lasso select tool that allows a user to flexibly select a plurality of ink words that are not arranged in a straight line. Yet another input mode may include a highlighting mode for highlighting of ink words or other ink data in the ink environment. In the highlighting mode, highlighting ink is laid down in the ink environment. Ink Interface  may also provide methods for inking mode settings  such as pressure sensitivity of the pen-computing environment  and pen tip style or stylus tips. To provide functionality for clipboard operations, Ink Interface  may include a methods \u2013 of a selection of ink words or other ink data to be copied into memory, such as a clipboard , retrieved from the clipboard , and pasted from the clipboard . These methods \u2013 allow a user to cut and paste ink words or other ink data between application programs in a graphical environment on general purpose computer  and pen-based computer . Optionally, Ink interface  may include method  for converting the ink words into text words based on handwriting recognition for use by non-native ink applications.","With continued reference to , other methods of Ink Interface  may include visual feedback operations , such as zoom in and out control of the ink environment  (see ). In addition, Ink interface  may include a method for world language  interrogation so that the menus and other items of the graphic environment matches the local language of a user of system  or . Ink interface  may include a method for classification of a contained ink object into a hierarchical structure  reflecting a semantic relationship of the ink written in the ink environment. For example, this semantic relationship of ink strokes within ink environment may include a parsing system operable with the operating system as shown the  to determine ink words, lines, or paragraphs.","To provide control of resizing and repurposing the ink environment, Ink Module  provides a bounding function  to return the size of the ink collected. The bounding function can prevent a user from making the ink environment (when in a rectangular display region) smaller than the ink it contains so that the visual display is appropriate. In addition, the bounding function translates and scales the existing ink words to be rendered visually within the rectangular display region. In one aspect, the ink is moved so the top-left corner of the ink's bounding box corresponds to the top-left corner of display region and then the ink can be resized so that the bottom-right corner corresponds to the bottom-right corner of display region. Further Ink Interface  may include a method  for gesture recognition in a pen-based computing environment , for example a \u201cpress and hold\u201d gesture. With continued reference to , Ink Event Interface  can send various system events and other system notifications to the Ink Server .","Referring to , Ink Server  may expose interfaces, such as an InkDoc interface , and an InkDoc Event interface  to a container ink application or user interface module . Interface  may send events associated with context menus related to user interface module  that have been invoked or otherwise selected by the user. InkDoc interface  of Ink Server  hosts the functions of Ink Module  for communication with the container ink application as an OLE server. As an OLE server, Ink Sever  may include standard OLE interfaces which provides methods through which container ink applications can access Ink Server . Accordingly, Ink Server  may support an IUnknown interface . Container ink application may use the IUnknown interface  to determine which other interfaces the object supports. The implementation of IUnknown interface  knows what other interfaces the Ink Server  supports and returns to the invoking application pointers to those interfaces for the OLE environment. Interfaces  through  are examples of typical interfaces that can be supported by an object. These interfaces follow from the IUnknown interface. For example, the IDataObject interface  provides methods for storing data in and retrieving data from the object. The IPersistStorage interface  provides methods for storing the contained ink object to and retrieving the container ink object from persistent storage. The IOLEObject interface  provides methods through which a container ink application invokes the functionality that corresponds to a user-selected action. It will be appreciated that ink module  may include the standard OLE interfaces as well for an OLE implementation.","Turning to , user interface module  can provide additional user integration into application programs for the ink environment. In one aspect, user interface module  may provide menu items and toolbar buttons into the application program for the ink environment. User interface module  may includes a component object model (COM) addin . The COM addin  provides negotiation for the user interface module  to insert visual command buttons, menu items, and toolbars for interacting with the user to insert the ink environment into the application . In another aspect, user interface module  may include interfaces which are exposed to provide enhanced functionality of the ink environment  in a container ink application program . For example, an Application Wrapper Interface  (AppWrapper) may used to negotiate with via Ink Server  via Addin  for inserting an inking environment directly into a host application at an insertion location on the display surface . Each host application may have individual AppWrapper interfaces. AppWrapper interface  may provide for specific event notification from the host application for the user interface module  and the notifications can be then communicated to Ink Server  via Addin . For menu item selection by a user, a button handler interface  may be provided by the user interface module . Events from Button handler  are provided to Addin . For example, the buttons on the menu of the ink environment when clicked or selected, create events that can be mapped for launching various command associated with services for the manipulation and collection on ink. The commands relate to the previously described methods provided by the Ink Server  and\/or Ink Module . The host applications programs  (see ) can include, but are not limited to a word processing program, a presentation graphics program, a spreadsheet program, or an electronic mail program, a gaming program, and the like.","In the example system , Ink Module , Ink Server , and\/or User Interface Module  can be stored in the general purpose computing environment  () or pen-based computing environment  as executable program files (with a \u201c.exe\u201d file name extension) or as a dynamic link library file (with a \u201c.dll\u201d file name extension). Dynamic link library files are loaded, dynamically linked, and executed by the WINDOWS\u00ae operating system. Executable program files are loaded by the operating system as a separate executing process. The example ink environment, Ink Server  and Ink Module  provide ink services as an extension of a standard set of OLE services. Accordingly, the container ink application realizes events using services provided by the ink environment via Ink Server  and\/or Ink Module  for ink services of the present invention; and OLE services for standard OLE services and a set of standard object interfaces defined by COM. In a one implementation, the standard OLE services and COM are available to container ink application as application programming interface (API) functions provided in a COM\/OLE library, a component of the WINDOWS\u00ae operating system.","Ink Environment Behaviors","The ink environment with ink words or other ink data (contained ink object) can have at least three independent states\u2014a non-selected state or inactive, a selected state, and an activated state for receiving and manipulation of ink. In keeping with the functions provided by the Ink Module , and\/or Ink Server , shown in , the contained ink object among other operations, can be resized, deleted, moved around, formatted, and copied and pasted among container ink applications of the present invention. The user has control as to the three states of the ink environment by using various actions with an input device. For example, the user may click or tap within a region of the ink environment when in-active so that environment becomes active to receive ink. Nevertheless, there are numerous user interactions can place for ink environment in three states.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 7","FIG. 7"],"b":["400","406","300","308","310","308","312","314","310","312","310"]},"In a selected state (not-shown), the container ink object is inactive for receiving and manipulating ink. In the working region , the ink environment is graphically indicated with a rectangular region on the boundary and resizing handles. Of course, the ink environment could be represented in other ways, such as a freeform area. The menu bar  for the container ink application  remain unchanged.",{"@attributes":{"id":"p-0054","num":"0053"},"figref":["FIG. 8","FIGS. 4\u20136"],"b":["304","400","300","308","310","304","300","404","312","404","304","304","301","304"]},"In one arrangement of in-situ operation, the ink environment  may provide and display graphical lines (not-shown) as guides for inking. The lines may be drawn with a predetermined color & width. The lines may be drawn at predetermined intervals between the lines. Of course, the user is not restricted to writing ink within the displayed lines and can still applied ink in any desired orientation. It will be appreciated that a border, such as a selection highlight, surrounds these lines indicating the rectangular region is active for inking. While the lines and border can appear when the ink environment is in the active state, a user has selective control not display the lines and border. It will be appreciated that the line direction can be vertical or horizontal in the ink environment and may be selectively toggled by the user.","In one arrangement of the invention, when the user edits the native text words of the compound ink document, the menu bar  includes the commands to interact with text words within the container ink application. Likewise, when the user edits the ink words or interacts within the ink environment  of the compound ink document, the menu bar  is provided with an ink toolbar , for example, shown in . The user interface module  (see ) can provide the features of ink tool bar.","In one aspect, ink menu items are seamlessly synthesized with the container ink application menu to form a synthesized ink menu. , B and  illustrate example menu presentations associated with the ink environment  (see ). Purely by way of example without limitation of the invention, in , a menu command \u201cEdit\u201d  can have ink specific functions such as Select Ink , Cancel Ink Selection , Delete Ink . Likewise in , the menu command \u201cFormat\u201d  can have yet other ink specific functions, such as Format Ink . Turning to , the \u201cTools\u201d  menu command may include a Convert Handwriting to Text  function and Ink Details  function. It will be appreciated that the specific locations of the menu items can be changed for usability and context of the functions. With reference to the Illustrative System Environment shown in , the ink menu items relate to the specific interfaces provided by Ink Module  and Ink Server  with the respective member functions.","Rendering Ink",{"@attributes":{"id":"p-0058","num":"0057"},"figref":"FIG. 12","b":["406","404","400","500","502","504","506"]},"Ink Environment Insertion",{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 13","FIG. 4","FIG. 3"],"b":["600","602","408","602","408","604","310"]},"During the insertion in step , a rectangular region visually appears within the work region  of the launched application for indicating the ink environment. As previously noted, the ink environment  can have selection handles and a selection highlight bounding the rectangular region, thus indicating that it is activated. An ink toolbar may appear along with the ink environment. The cursor may change its context from a text word implementation to an ink environment implementation. For example, the cursor can change into a graphical ink dot similar to a pen tip for inking mode when hovering over the ink environment. Nevertheless, the cursor can graphically change context depending of the input mode, such as an eraser point for eraser mode. In step , once the ink environment is in-situ, the user can freely apply handwriting in ink and compose within the ink environment with the services provided by Ink Module  and\/or Ink Server  shown in . Once the user has finished composing and\/or handwriting, in step , the user may then deactivate the ink environment from ink collection and manipulation. At this point, as previously noted, the ink environment will be visually displayed as the ink at the location on the screen and a metafile is created. Advantageously, the compound ink document can be shared or can be sent to other computing devices and\/or application programs.","Example Use of Ink Environment","By way of example, an electronic mail application can be implemented with an ink environment therein. As previously mentioned, the electronic mail message body may have a contained ink object. The compound ink document, namely the message body with the contained ink object, can be sent to other users that have an email client. In one aspect, the compound ink document having the contained ink object can be sent in HyperText Markup Language (HTML). HTML is useful as an interoperability format because of its generalized acceptance as an industry standard and its ability to represent heterogeneous content. HTML is widely understood, well documented, and familiar to many skilled in the art. There are many tools for HTML production. Alternatively, the compound ink document can be transmitted in Rich Text Format (RTF), XML, generalize mark up languages, or plain text. Other formats are possible such as files saved in .doc format, .ppt format, and\/or .xls, dealing with Microsoft WORD\u00ae, Microsoft POWERPOINT\u00ae, and Microsoft EXCEL\u00ae, respectively. The compound ink document may be converted to a PDF format for static viewing. In HTML format, the contained ink object can be generated an inline GIF representation of the ink from the ink environment. The GIF format provides good compression on various types of images and has wide acceptance. Nevertheless, the representation may be any image format such as, PNG, JPG, TIF, BMP, DIB, EMF, WMF and the like. In RTF, the ink environment can generate a metafile of the contained ink object that is viewable by conventional RTF readers or email client. While in plain text mode the ink is stripped and not transmitted, the ink words may be automatically converted to text words for display of on receiving email client.","Summarization of the In-Situ Ink Environment","An ink environment provides features for a user to interact with embedded or linked ink words or other ink data within a compound ink document. The ink environment can be made accessible to the user through the window environment of an application that operates with the compound ink document. Advantageously, the user is provided with the freedom to input digital ink so they can write anywhere in the ink environment, in any orientation, and using any desired stroke size provided by the ink environment. In one aspect, the ink environment can have a state for in-situ user interaction and manipulation in a computing environment, for example a pen-based environment. In one aspect, the ink environment can be enabled with the ink menu items that are seamless synthesized with the menus of the application that implements the compound ink document. Advantageously, the ink environment can be provided to non-native ink applications to create independent ink services for sharing between different applications and transmission over networks to remote users. In other embodiments, the ink environment may be provided by an ACTIVEX\u00ae control by MICROSOFT\u00ae Corporation. In some aspects of the present invention, a metafile is provided with antialiasing support to improve the visual appearance of ink.","Accordingly, there are any number of alternative combinations for defining the invention, which incorporate one or more elements from the specification, including the description, claims, and drawings, in various combinations or sub combinations. It will be apparent to those skilled in the relevant technology, in light of the present specification, that alternate combinations of aspects of the invention, either alone or in combination with one or more elements or steps defined herein, may be utilized as modifications or alterations of the invention or as part of the invention. It may be intended that the written description of the invention contained herein covers all such modifications and alterations."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":["FIG. 6","FIG. 4"]},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIGS. 10A and 10B"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 13"}]},"DETDESC":[{},{}]}
