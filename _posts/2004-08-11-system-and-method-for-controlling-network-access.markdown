---
title: System and method for controlling network access
abstract: A system for controlling network access to products. The system includes a security appliance connected to a product under operational control of a first entity, a product connection platform and a user terminal under operational control of a second entity, the product connection platform being accessed by the user terminal, and a trust relationship established between the first entity and the second entity based on predetermined criteria between the first entity and the second entity, the trust relationship being represented by a certificate or public/private key exchange. Authentication of access by a user of the user terminal of the second entity to the product of the first entity is deferred to the product connection platform of the second entity based on the predetermined criteria of the trust relationship, whereupon if authentication is granted, the user is provided access to the product.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07587588&OS=07587588&RS=07587588
owner: Avaya Inc.
number: 07587588
owner_city: Basking Ridge
owner_country: US
publication_date: 20040811
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["1. Field of the Invention","The present invention relates to a System and Method for Controlling Network Access.","2. Description of the Relevant Art","In recent years, public and private enterprises of all sizes have installed an increasingly large array of telecommunications systems, information systems, and other products which serve as the operational infrastructure for day-to-day business activities.","However, providers of these products, systems, and services have long had issues concerning integrating with the access and authentication schemes of their customers' systems and equipment for providing testing, upgrades, and maintenance. In particular, these providers and servicing companies find it difficult to comply with a multitude of remote access requirements and differing remote access and authorization packages used by their customers. Moreover, managing all of the third party technicians, business partners and outsourcers that need remote access to products and systems used by an extended user base of customers is an issue terms of cost and resources.","Enterprise customers typically have Authentication\/Authorization\/Administration (AAA) servers located at their site to identify, control, log users.","AAA servers provide:\n\n",{"@attributes":{"id":"p-0009","num":"0011"},"figref":["FIG. 1","FIG. 1"],"b":["50","51","52","53"]},"Access by the Service Provider technician is accomplished by access device  via the Internet. Conventionally, customers requiring user authentication ask the Service Provider's technicians to use their Virtual Private Network (VPN) client (not shown) and their hard token, such as Secure ID. For a Service Provider having only a few service technicians, this may be a viable option. However, for a provider with hundreds or thousands of technicians, this becomes almost impossible.\n\n","There are numerous companies such as RSA Security, Inc. and Ion Networks, Inc. that provide hard and soft token-based remote access control solutions. The solution works well for associates of a single company accessing their own devices. In an outsourced or third-party maintenance scenario it requires that the entire extended technician force, including all third-party technicians, be set up in the customer's access control system and assigned an individual hard or soft token. For the external maintenance company the requirement to keep up with a hard token device for each technician for each customer is a significant problem of cost and maintenance.","Companies such as Permeo Technologies, Inc. offer turnkey desktop to device authorization and remote access control solutions. This solution works well for associates of a single company accessing their own devices. It requires that all remote users purchase and use the exact same set of software and that the entire extended technician force, including all third-party technicians, be set up in the customer's access control system. This is a cost burden and for a third-party management company since it is not feasible to provide all the various configurations and software required for every customer's chosen turnkey solution to every technician.","The Liberty Alliance and Security Assertion Markup (no dash) Language (SAML) organizations are developing a trust based identity and authorization exchange standard for web-based business-to-business operations. This standard effort is focusing entirely upon web-based business-to-business transactions and applications. The protocols and access requirements for remote maintenance, monitoring and support extend far beyond web based access to applications.","The SOCKS Internet Request for Comments (RFC 1928, 3089 and 1929) provides a protocol for establishing access to network devices using a proxy service. The proxy service can implement access and authorization controls to devices behind the proxy. The current standards cover the use of user ID and password based authorization control as well as support for the Generic Security Services Application Programming Interface (GSSAPI) to allow additional authorization models to be established based upon the agreement of the client application and the proxy.","More information on these is described in:\n\n","Given the problems described above, what is needed going forward is a means to separate the three AAA functions so Authentication is performed at the Service Provider's site and the user's identity and associated roles is passed to the customer's site when access is requested. Authorization and Administration is then performed at the customer's site.","The present invention has as a primary object to improve on the systems and approaches of the background art and to solve of the drawbacks associated with the systems of the background art.","The solution proposed here is to extend the concept of SOCKS tunneling to include an authorization model based on an external trust relationship between two enterprises. The trust relationship is implemented using certificates.","SOCKS tunneling is when a SOCKS server, instead of a SOCKS client application, contacts another SOCKS server to establish a proxy connection to a device. There is no current Internet standard for SOCKS tunneling.","The authorization model is based upon a previously established trust relationship between two companies such that company A trusts company B to authenticate their own employees. Company A will not attempt to authenticate remote users from Company B. Instead Company A will authorize any remote access request made by an employee of company B. This authorization will be based on a set of identifying information sent through a secure channel as a part of the remote access request.","In operation, two companies will initially exchange certificates or public-key\/private key pairs that represent the company's identity. The certificates will be used to establish the identity of each company when a remote access request is made. It is also used to establish a secure communication mechanism for exchanging the identity of the remote user making the request.","Other objects and further scope of applicability of the present invention will become apparent from the detailed description given hereinafter. However, it should be understood that the detailed description and specific examples, while indicating preferred embodiments of the invention, are given by way of illustration only, since various changes and modifications within the spirit and scope of the invention will become apparent to those skilled in the art from this detailed description.","The present invention provides an authorization model quite different from conventional systems and approaches.","The authorization model is based upon a previously established trust relationship between two companies such that Company A (for example, the customer) allows Company B (for example, the Service Provider) to authorize access to one of Company A's devices, only after Company B's system sends all the relevant employee identification to Company A.","Customer A initially establishes the trust relationship between the two companies by implementing the steps shown in . Once the trust relationship between the two companies has been established, remote access by Company B can take place.","As shown in ), Company A's environment includes a local gateway SSG  made up of a SOCKS server , policy server , and product access audit trail device . Product  (for example a PBX) is connected to local gateway SSG .","Company B's system includes product connect system , which is provided with SOCKS server , AAA system , and trouble ticketing system .","In operation, two companies will initially exchange certificates or public-key\/private key pairs that represent the each company's identity. The certificates will be used to validate that any incoming requests originated from a trusted system. This exchange is illustrated with reference to the Company A and B environments shown in ) and the sequence of messages shown in ). Again, Company A is the user of some remotely serviceable product, such as a voice PBX switch, and Company B is the service provider for this system. Instead of checking the individual remote user's identity against a local authentication database the local gateway SSG  will check the companies certificate or credentials to validate that the incoming connection originated from a known and trusted system. The individual user's information will be passed as part of an encrypted packet that can be examined by the local gateway SSG  and the individual user's identity and other relevant information is logged by the SSG .","Referring now to ), when Company B's technician (user) attempts to connect to product  on Company A's network the following steps will occur:","Step 1: Company B.'s technician will login to the trouble ticketing system  via terminal .","Step 2: The technician will be authenticated by Company B's AAA service .","Step 3: The technician will select a ticket for service form trouble ticketing system .","Step 4: Company B's technician will request a connection to product  referenced in the ticket.","Step 5: The ticketing system  will call the product connect system  and request a connection.","Step 6: The product connect system  will contact Company B's AAA system () to determine if the technician has the appropriate authorizations to be granted the connection.","Step 7: Assuming authorization is granted the product connect system  will contact Company B's socks server  and request a connection to Company A's remote product . The technician's identity and trouble ticket information will be passed to the SOCKS server  along with the identifying information for product .","Step 8: Company B's SOCKS server  will create a secure connection with Company A's SOCKS server , running in the local gateway SSG , and send an authorization request document  containing all of the relevant information, including Company B's credentials, the technician's identity, product being accessed and the trouble ticket being worked.","Step 9: Company A's SOCKS server  will validate the credentials supplied to validate any identity of Company B.","Step 10: Company A's SOCKS server  will pass the access request document to the policy server , also running in the local gateway SSG  for processing.","Step 11: The policy server  will apply any customer defined access rules to the information supplied in name? access request document . The policy server  may specify that access to specific devices require on-site, real-time authorization by specific customer employees. The local gateway SSG  would then access the customer's Instant Messaging server  to notify those specific customer employees for authorization approval to access that product. The SSG  presents specific access attributes (trouble ticket number, product description, company and employee accessing product) to the customer employees for real-time authorization. One or more customer employees can \u201callow\u201d or \u201cdeny\u201d access. If any one customer employee says \u201cdeny\u201d, over a customer-specified time, access is denied. The reason can be supplied using the customer's Instant Messaging client. If all customer personnel say \u201callow\u201d, access is permitted. Other security parameters may be programmed providing the desired access policy.","The present invention is not limited to Instant Messaging types of real-time alerting as described above. An alternative solution to real-time authorization is using an SIP (Session Initiated Protocol) server  (shown in )) to communicate to customers using display phones  with a standard number pad. Here, the SSG's policy server  would call then send the access information to the customer's display phone  showing the name of the Service Provider's technician, the trouble ticket information, and\/or the device requesting access, for example. The customer would then press either \u201c1\u201d for accept or \u201c2\u201d for deny. The SSG  would store the customer programmed access policy for each device managed. The device used by the customer to grant vendor access is not limited to phones or Instant Messaging service. Wireless devices like telephones, Personal Digital Assistants, Blackberry (http:\/\/www.blackberry.com\/) devices, any local or remote communication client is included in this invention.","Step 12: The SOCKS server  will log all of the information in Company A's audit log , located on the SSG .","Step 13: Assuming authorization is granted, the SOCKS server  will open a connection to product . Control will then be returned to the technician. SOCKS server  would perform the necessary network address translation to address local devices.","Authentication Function and Process","The authentication function is provided by the interaction of two separate platforms, the service provider's service delivery platform located remotely from the customer site, and the local gateway\/security appliance SSG located on or near the customer's premises. The SSG is controlled and monitored by the customer and not by the Service Provider.","The Service Provider must ensure that the service technician is authenticated before any access is permitted to the customer's site. This authentication process also assigns servicing \u201croles\u201d to each individual technician. A role can be thought of as an individual service technician's \u201clicense\u201d to provide service for a particular piece of customer equipment or system.","When access is needed, say as the result of a trouble ticket being created, an access request is first negotiated with the security appliance (SSG) local to the customer.","The access request contains attributes such as:\n\n","The SSG is configured by the customer to allow technicians having specific roles to access their equipment and network. The access request by the service technician is securely sent to the SSG and compared to the access policy stored in the SSG. If the roles match, the user's identity and all other information in the access request is stored in the SSG's audit log. The access request can also be sent by the SSG to the customers Network Management System or Syslog Server giving them a real-time-access notification. As described here, access is allowed by role not by the user's identity, however the user's identity is also recorded for accountability purposes.","The authentication function and process may also permit the customer to build rules on other information in the identity packet. For example a \u201cDeny By Name\u201d rule could be built allowing a customer to deny specific service technicians (or any other user) from accessing their network. This may be the result of the customer's prior experience with a specific service technician or user. To provide this function, service company B would not have to send down to the SSG all of their technician's names. Rather, the SSG would store the names passed in the identity packet in the normal process of accessing products. This automatically populating name list would serve the basis for the exclude list. Using the SSG audit logs in forensic analysis, the customer would determine the person to exclude. The customer would then copy that name to the exclude list. When that person next tries to access any product, the SSG would then deny access by that person to any product. The SSG would also send a deny message in the SOCKS connection request back to the Company B SOCKS server stating the reason for denial.","Thus, the Authentication Function permits customer defined authorization checks.","Further, the Authentication Function could enable an \u201cOn-Site Approval Required\u201d authorization model. For example, some customers may require the Service Provider to get real-time access permission in advance prior to connecting to their site. This entry would be passed to the SSG at the customer's site. The SSG security policy would send a message via an external notification service (described earlier) such as Instant Messaging, beeper, or email asking for customer authorization prior to allowing the technician (by name) to access that product. The SSG would provide the supporting access information so the customer can decide whether or not to allow access. Once that customer agent gives approval to the SSG, access by the service technician is allowed. The SSG would log all allow and deny access requests for future customer audits. This is important in the event an access is made by a vendor resulting in a service outage or security attacks on other customer servers. This log would help identify the vendor, the technician or vendor's automated tools causing the event.","Authorization Function and Process","Authorization is the process of making sure the user accesses only assigned resources. It usually occurs after the Authentication phase.","First, a brief description about a VPN client is provided. In the VPN connection process, a VPN client is remotely configured by the customer's VPN server to only access certain networks or IP addresses. The remote PCs IP parameters are changed to use and access resources on the remote network. For all practical purposes, the remote PC cannot access resources on the PC's local LAN. The PC is logically on the customer's network.","This is important, because, if a LAN-to-LAN connection is used instead of a VPN client to LAN connection, network address translation (NAT) is required to bridge the two different IP networks. It the customer's AAA server contains the allowed real IP addresses, the SSG would need to retrieve them from the AAA server and then map them to the Service Provider's internal address before access could be made.","To simplify this process, the SSG performs both the network address translation (NAT), Authorization and Administration functions.","Administration Function and Process","Administration is performed in the SSG after all Authentication and Authorization steps are complete.","If the customer has an external AAA server used for Administration (for example, a Remote Authentication Dial-In User Server (RADIUS) system using port ), the SSG could record the access request\/result in the customer's server. This allows the customer to audit all access requests in one server.","Automated System Remote Access","The process described heretofore was initiated by a service technician. Alternatively, the system may be used to provide Automated Remote Access typically initiated by diagnostic computers.","The message flow during Automated System Remote Access is similar to the access by a remote technician, with the following exceptions. Each of Company B's automated system has its own unique identity and this identity will be validated by the Service Provider's systems, and then is provided to the customer's system. This is very important since the identity passed to the SSG is that of a diagnostic computer and not a technician. Instead of accessing the trouble ticketing system , the Automated System Remote Access application accesses the product connect system  directly supplying the appropriate ticketing information.","Access by a Local Technician","The message flow among the system components during Local Technician Access is shown by the arrows in ). ) provides a flow chart of the steps during Remote Technician Access.","A pre-requisite for local access by Company B's technician is that technician's PC must be SOCKSified. The SOCKS software must be configured to re-direct all traffic to the products being managed by the Company A's SSG  to the SOCKS server . Protocol between the SOCKSified client(s) and the SOCKS server is encrypted using SSL to maintain secure local access to the SSG.","The steps involved include the following:","Step 1: The local technician connects to the SOCKS server  running on the local SSG .","Step 2: The SOCKS server  authenticates the technician information against the customer's AAA server .","Step 3: The technician attempt to create a connection to product  using a local network address.","Step 4: The SOCKS server  checks the customer's AAA server  for authorization to access the product .","Step 5: The SOCKS server  logs of the connection request in the local audit log  of the SSG .","Step 6: The SOCKS server  opens a connection to product  and returns control back to Company A's local technician.","The invention described above provides a secure, integrated solution to the problems of conventional approaches. Advantages of this solution include:","It is no longer necessary for a Service Provider to maintain all third-party technician identities in a customer's access control system.","It is not necessary for every technician of each-third party maintenance, monitoring or support vendor to have the software or hard token that each and every customers may require in order to access their equipment.","The necessary information to comply with security and auditing procedures and legislation is maintained in secure fashion by both the Servicing Company and the customer using the equipment.","It is possible to build extremely granular access control rules without requiring extensive work by either the Service Provider or the customer. The identity information exchanged is sufficient to allow a customer of remote maintenance, monitoring or support to build granular and detailed access control records for access to their own devices without placing a burden upon Service Provider.","Other specific advantages include:\n\n","The invention being thus described, it will be obvious that the same may be varied in many ways. Such variations are not to be regarded as a departure from the spirit and scope of the invention, and all such modifications as would be obvious to one skilled in the art are intended to be included within the scope of the following claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention will become more fully understood from the detailed description given herein below and the accompanying drawings which are given by way of illustration only, and thus, are not limitative of the present invention, and wherein:",{"@attributes":{"id":"p-0024","num":"0032"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0033"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0026","num":"0034"},"figref":["FIG. 3(","FIG. 3("],"i":["a","b"]},{"@attributes":{"id":"p-0027","num":"0035"},"figref":["FIG. 4(","FIG. 4("],"i":["a","b"]}]},"DETDESC":[{},{}]}
