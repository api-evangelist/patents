---
title: PC-based open metering system and method
abstract: A transaction evidencing system includes a personal computer (PC) comprising a processor, memory and hard drive, with a plurality of non-metering application programs that selectively run on the PC. An unsecured printer is operatively coupled to the PC for printing in accordance with the non-metering application programs. A portable vault card that is removably coupled to the PC is programmed to generate tokens generation and perform transaction accounting. An application interface module in the PC, which interfaces with the non-metering application programs, issues a request for digital tokens in response to requests for indicia from a non-metering application program. A secure communications module in the PC, which securely communicates with the vault card when the vault card is coupled to the PC, sends the request for digital token to the vault card and receives a digital token generated by the vault card. An indicia bitmap generation module generates an indicia bitmap in the PC from the digital token and stores it in memory. The indicia bitmap is accessed by the non-metering application program when a print indicia operation is selected. A transaction capture module in the PC stores on the hard drive a transaction record corresponding to each issued digital token and associated postal data. The application interface module, the secure communications module, the indicia bitmap generation module and the transaction capture module are part of a dynamic link library module in the PC.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07080044&OS=07080044&RS=07080044
owner: 
number: 07080044
owner_city: 
owner_country: 
publication_date: 20001017
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a Continuation Application of U.S. patent application Ser. No. 08\/575,112, filing date Dec. 19, 1995, now U.S. Pat. No. 6,157,919.","The present application is related to the following U.S. patent applications Ser. No. 08\/1575,106 now U.S. Pat. No. 5,625,694, U.S. patent aplication Ser. No. 08\/575,107 now U.S. Pat. No. 5,781,438; U.S. patent application Ser. No. 08\/574,746 now U.S. Pat. No. 5,835,604; U.S. patent application Ser. No. 08\/574,745 now U.S. Pat. No. 5,742,683; U.S. patent application Ser. No. 08\/574,743 now U.S. Pat. No. 5,793,867; U.S. patent application Ser. No. 08\/575,110 now U.S. Pat. No. 6,285,990; U.S. patent application Ser. No. 08\/575,109 now U.S. Pat. No. 6,151,590; U.S. patent application Ser. No. 08\/575,104 now U.S. Pat. No. 5,835,689; U.S. patent application Ser. No. 08\/574,749 now U.S. Pat. No. 5,590,198, and U.S. patent application Ser. No. 08\/575\/111 now abandoned, each filed concurrently herewith, and assigned the assignee of the present invention.","The present invention relates generally to value printing systems and, more particularly, to value printing systems wherein a printer is not dedicated to a metering module.","Since the issuance of U.S. Pat. No. 1,530,852 to Arthur H. Pitney, the postage meter has evolved from completely mechanical postage meters to meters that incorporate extensive use of electronic components. Although postage meters have performed satisfactorily in the past, and continue to perform satisfactorily, with the advancement in computer controlled digital printing technology, the United States Postal Service (USPS) and other Posts are considering requirements for new technology metering devices.","The USPS is presently considering requirements for two metering device types: closed systems and open systems. In a closed system, the system functionality is solely dedicated to metering activity. Examples of closed system metering devices, also referred to as postage evidencing devices (PEDs), include conventional digital and analog postage meters wherein a dedicated printer is securely coupled to a metering or accounting function. In a closed system, since the printer is securely coupled and dedicated to the meter, printing cannot take place without accounting. Recently, Pitney Bowes Inc. has introduced the Post Perfect\u2122 meter which is a new closed system metering device that includes a dedicated digital printer securely coupled to a secure accounting module.","In an open system, the printer is not dedicated to the metering activity, freeing system functionality for multiple and diverse uses in addition to the metering activity. Examples of open system metering devices include personal computer (PC) based devices with single\/multi-tasking operating systems, multi-user applications and digital printers. An open system metering device is a PED with a non-dedicated printer that is not securely coupled to a secure accounting module.","When a PED prints postage indicia on a mailpiece, the accounting register within the PED must always reflect that the printing has occurred. Postal authorities generally require the accounting information to be stored within the postage meter in a secure manner with security features that prevent unauthorized and unaccounted for postage printing or changes in the amounts of postal funds stored in the meter. In a closed system, the meter and printer are integral units, i.e., interlocked in such a manner as to ensure that the printing of postage indicia cannot occur without accounting.","Since an open system PED utilizes a printer that is not used exclusively for printing proof of postage payment, additional security measures are required to prevent unauthorized printing evidence of postage payment. Such security measures include cryptographic evidencing of postage payment by PEDs in the open and closed metering systems. The postage value for a mail piece may be encrypted together with other data to generate a digital token. A digital token is encrypted information that authenticates the information imprinted on a mail piece including postage values.","Examples of systems for generating and using digital tokens are described in U.S. Pat. Nos. 4,757,537, 4,831,555, 4,775,246, 4,873,645, and 4,725,718, the entire disclosures of which are hereby incorporated by reference. These systems employ an encryption algorithm to encrypt selected information to generate at least one digital token for each mailpiece. The encryption of the information provides security to prevent altering of the printed information in a manner such that any misuse of the tokens is detectable by appropriate verification procedures.","Typical information which may be encrypted as part of a digital token includes origination postal code, vendor identification, data identifying the PED, piece count, postage amount, date, and, for an open system, destination postal code. These items of information, collectively referred to as postal data, when encrypted with a secret key and printed on a mail piece provide a very high level of security which enables the detection of any attempted modification of a postal revenue block or a destination postal code. A postal revenue block is an image printed on a mail piece that includes the digital token used to provide evidence of postage payment. The postal data may be printed both in encrypted and unencrypted form in the postal revenue block. Postal data serves as an input to a Digital Token Transformation which is a cryptographic transformation computation that utilizes a secret key to produce digital tokens. Results of the Digital Token Transformation, i.e., digital tokens, are available only after completion of the Accounting Process. As used herein \u201cdigital token\u201d may be an encryption of all postal data or a subset thereof.","Digital tokens are utilized in both open and closed metering systems. However, for open metering systems, the non-dedicated printer may be used to print other information in addition to the postal revenue block and may be used in activity other than postage evidencing. In an open system PED, addressee information is included in the postal data which is used in the generation of the digital tokens. Such use of the addressee information creates a secure link between the mailpiece and the postal revenue block and allows unambiguous authentication of the mail piece.","Preferably, two digital tokens are used to authenticate postal data and postage payment The first is produced by a Digital Token Transformation using a secret key held by the Postal Service and the mailer's PED. The second is produced by a Digital Token Transformation using a secret key held by the PED vendor and the mailer's PED. The fact that two independent entities hold separate verification secrets greatly enhances the security of the system because it provides the Postal Service and the vendor with independent means to authenticate the postal revenue block, and thus, verify postage payment. The use of the second Digital Token Transformation using the vendor's secret key is an optional part of the security which authenticates postage payment by a particular vendor's device. The use of two digital tokens (postal and vendor) is described in pending U.S. patent applications Ser. No. 08133,427 filed Oct. 8, 1993 now U.S. Pat. No. 5,390,251 and Ser. No. 08\/242,564, filed May. 13, 1994 now U.S. Pat. 5,655,023, both assigned to the assignee of the present invention, the entire disclosures of which are hereby incorporated by reference.","In accordance with the present invention some of the functionality typically performed in the vault of a conventional postage meter has been removed from the vault of a PC-based open metering system and is performed in the PC. It has been discovered that this transfer of functionality from the vault to the PC does not effect the security of the meter because the security of the PC-based open metering system is in the information being processed not in the meter itself.","Thus, the present invention provides a PC-based open metering system that comprises a PC, special Windows-based software, a printer and a plug-in peripheral as a vault to store postage funds. The PC meter uses a personal computer and its non-secure and non-dedicated printer to print postage on envelopes and labels at the same time it prints a recipient address.","The present invention provides a PC based open meter system, which consists of a personal computer (PC), a digital printer, a removable electronic vault, an optional modem for funds recharge (debit or credit), a PC software module in the form of a Dynamic Link Library (DLL) and a user interface module. The vault is a secure encryption device for digital token generation, funds management and traditional accounting functions. The DLL module performs all communications with the vault, and provides an open interface to Windows-based applications. Secure communication between the DLL and the vault is desired but is not necessary for system security. The DLL module obtains from the vault transaction records comprising digital tokens issued by the vault and associated postal data and generates an electronic indicia image. The usage of postal funds and the transaction record are stored in the vault. Another copy of the usage of postal funds and the transaction record may be stored on the PC's hard drive as backup. The user interface module obtains the electronic indicia image from the DLL module for printing the postal revenue block on a document, such as an envelope. The user interface also communicates with the vault via the DLL for remote refills and for performing administrative functions.","The present invention provides open system metering that includes security to prevent tampering and false evidence of postage payment as well as the ability to do batch processing of envelopes, review of indicia and addressing on envelope before printing.","In accordance with the present invention a transaction evidencing system includes a personal computer (PC) comprising a conventional processor, memory and hard drive, with a plurality of non-metering application programs that selectively run on the PC. An unsecured printer is operatively coupled to the PC for printing in accordance with the non-metering application programs. A portable vault card that is removably coupled to the PC is programmed to generate tokens and perform transaction accounting. An application interface module in the PC, which interfaces with the non-metering application programs, issues a request for digital tokens in response to requests for indicia from a non-metering application program. A secure communications module in the PC, which securely communicates with the vault card when the vault card is coupled to the PC, sends the request for digital token to the vault card and receives a digital token generated by the vault card. An indicia bitmap generation module generates an indicia bitmap in the PC from the digital token and stores it in memory. The indicia bitmap is accessed by the non-metering application program when a print indicia operation is selected. A transaction capture module in the PC stores on the hard drive a transaction record corresponding to each issued digital token and associated postal data. The application interface module, the secure communications module, the indicia bitmap generation module and the transaction capture module are part of a dynamic link library module in the PC.","In describing the present invention, reference is made to the drawings, wherein there is seen in  an open system PC-based postage meter, also referred to herein as a PC meter system, generally referred to as , comprising a conventional personal computer configured to operate as a host to a removable metering device or electronic vault, generally referred to as , in which postage funds are stored. PC meter system  uses the personal computer and its printer to print postage on envelopes at the same time it prints a recipient's address or to print labels for pre-addressed return envelopes or large mailpieces. It will be understood that although the preferred embodiment of the present invention is described as a postage metering system, the present invention is applicable to any value metering system that includes transaction evidencing.","As used herein, the term personal computer is used generically and refers to present and future microprocessing systems with at least one processor operatively coupled to user interface means, such as a display and keyboard, and storage media. The personal computer may be a workstation that is accessible by more than one user.","The PC-based postage meter  includes a personal computer (PC) , a display , a keyboard , and an unsecured digital printer , preferably a laser or inkjet printer. PC  includes a conventional processor , such as the 80486 and Pentium processors manufactured by Intel, and conventional hard drive , floppy drive(s) , and memory . Electronic vault , which is housed in a removable card, such as a PCMCIA card, is a secure encryption device for postage funds management, digital token generation and traditional accounting functions. PC meter system  may also include an optional modem  which is located preferably in PC . Modem  may be used for communicating with a Postal Service or a postal authenticating vendor for recharging funds (debit or credit). A description of such communication by modem is described in U.S. Pat. No. 4,831,555, incorporated herein by reference. In an alternate embodiment the modem may be located in a PCMCIA card.","PC meter system  further includes a Windows-based PC software module  () that is accessible from conventional Windows-based word processing, database and spreadsheet application programs . PC software module  includes a vault dynamic link library (DLL) , a user interface module , () and a plurality of sub-modules that control the metering functions. The DLL is an application programming interface (API) that is used by in Windows-based programs. It will be understood that the present invention is suitable for use with an API corresponding to other than Windows-based programs.","DLL module  securely communicates with vault  and provides an open interface to Microsoft Windows-based application programs  through user interface module . DLL module  also securely stores an indicia image and a copy of the usage of postal funds of the vault. User interface module  provides application programs  access to an electronic indicia image from DLL module  for printing the postal revenue block on a document, such as an envelope or label. User interface module  also provides application programs the capability to initiate remote refills and to perform administrative functions.","Thus, PC-based meter system  operates as a conventional personal computer with attached printer that becomes a postage meter upon user request. Printer  prints all documents normally printed by a personal computer, including printing letters and addressing envelopes, and in accordance with the present invention, prints postage indicia.","A description of the key components of PC-based meter system  are described below followed by a description of the preferred operation of PC-based meter system . A description of the digital token generation process is disclosed in co-pending U.S. patent. applications Ser. Nos. 08\/575,106 now U.S. Pat. No. 5,625,694, U.S. patent application Ser. No. 08\/575,107 now U.S. Pat. No. 5,781,438 and U.S. patent application Ser No. 08\/574,743 now U.S. Pat. No. 5,793,867, which are incorporated herein in their entirety by reference.","In the preferred embodiment of the present invention, the vault is housed in a PCMCIA I\/O device, or card, which is accessed through a PCMCIA controller  in PC . A PCMCIA card is a credit card size peripheral or adapter that conforms to the standard specification of the Personal Computer Memory Card International Association.","Referring now to , the electronic vault  includes a microprocessor , RAM , non-volatile memory (NVM) , clock , an encryption module  and an accounting module . The encryption module  may implement the NBS Data Encryption Standard (DES) or another suitable encryption scheme. In the preferred embodiment, encryption module  is a software module. It will be understood that encryption module  could also be a separator device, such as a separate chip connected to microprocessor . Accounting module  may be EEPROM that incorporates ascending and descending registers as well as postal data, such as origination ZIP Code, vendor identification, data identifying the PC-based postage meter , sequential piece count of the postal revenue block generated by the PC-based postage meter , postage amount and the date of submission to the Postal Service. As is known, an ascending register in a metering unit records the amount of postage that has been dispensed, i.e., issued by the vault, in all transactions and the descending register records the value, i.e., amount of postage, remaining in the metering unit, which value decreases as postage is issued.","The hardware design of the vault includes an interface  that communicates with the host processor  through PCMCIA controller . Preferably, for added physical security, the components of vault  that perform the encryption and store the encryption keys (microprocessor , ROM  and NVM ) are packaged in the same integrated circuit device\/chip that is manufactured to be tamper proof. Such packaging ensures that the contents of NVM  may be read only by the encryption processor and are not accessible outside of the integrated circuit device. Alternatively, the entire card could be manufactured to be tamper proof.","In accordance with the present invention, the open system vault  is strictly a slave device to PC . Host processor  generates a command and vault  replies with a response. The vault  does not generate unsolicited messages. Thus, PC  requests vault status whenever any transaction is initiated.","Referring now to , vault  has four security access levels: normal mode , service mode , privileged mode  and manufacturing mode . In normal mode , commands available to users are processed. In service mode , normal mode commands and service related commands are processed. In privilege mode , all command except direct access to NVM are processed. In manufacturing mode , all commands are processed. An access level is assigned to every command that is processed by the vault. Passwords are assigned to the various access levels. For example, to enter service mode  from the normal mode , a service password is required. Another password is required to enter privileged mode . Thus, two passwords, service and previliged must be entered to acces privileged mode . Privileged mode  cannot be accessed from normal mode  or manufacturing mode .","When a \u2018blank\u2019 vault is manufactured, a manufacturing vendor puts vault  in manufacturing mode  to program the NVM  of the PCMCIA card. NVM  is programnmed with encryption, accounting, funds management and other vault software modules. Then the vendor locks a serial number in NVM , prohibiting any unauthorized access to NVM , before delivering the PCMCIA card to a user. The vendor programs vault  to default to normal mode  whenever power is applied. A manufacturing mode password is required, i.e. vault  must be in manufacturing mode, to unlock the serial number in vault .","PCMCIA card does not include a self contained power source. Power to PCMCIA card is controlled by PC  in a conventional manner. When a user inserts vault  into PCMCIA controller  of PC , PC  software is in full control of electric power to vault . Microprocessor  in PCMCIA card is always in one of the four states: power removed , execution , idle , or power-down . Microprocessor  enters the execution state  each time it performs a task specified in a command from PC . Microprocessor  enters the idle state  after performing such task. Microprocessor  enters the power-down  if the system remains idle longer than the user specified idle time. To exit power-down state , an external signal from PC  wakes up microprocessor . Microprocessor  is in the power removed state  whenever PCMCIA card is removed from PCMCIA controller  or whenever PCMCIA controller  disables power to PCMCIA card .  shows the state transitions for power controls.","Status messages communicate the status of vault  to PC . The status messages also serve as acknowledgment or failure to acknowledge a given command by PC .","In accordance with the present invention, the functionality of DLL  is a key component of PC-base meter . DLL  includes both executable code and data storage area  that is resident in hard drive  of PC . In a Windows environment, a vast majority of applications programs , such as word processing and spreadsheet programs, communicate with one another using one or more dynamic link libraries. The present invention encapsulates all the processes involved in metering, and provides an open interface to vault  from all Windows-based applications capable of using a dynamic link library. In accordance with the present invention, any application program  can communicate with vault microprocessor  in PCMCIA card , through DLL .","In accordance with the present invention, DLL  includes the following software sub-modules: secure communications , transaction capture , secure indicia image creation and storage , and application interface module .","Since vault  is not physically secured to PC , it would be possible for a user to replace one vault  attached to PC  with another vault  while a vault transaction is in process. The Secure Communications sub-module  prevents this from happening by maintaining secure communication between DLL  and vault . Referring now to , the Secure Communications sub-module  identifies a specific vault  when it opens a communication session through PCMCIA controller , and maintains communication data integrity with the specific vault during the entire communication session. When a communication session is initiated DLL  and vault  negotiate a session key at step . All the messages thereafter are encoded\/decoded using the session key which is used for only the one particular communication session. If the session key is correct at step , the session continues at step , Whenever the session key changes during the communication session, the communication session terminates and an error message is sent to the user at step . The use of session keys is described in Applied Cryptography by Bruce Schneier, published by John Wiley and Sons, Inc., 1994. Thus, the session key not only provides secure encrypted communication between DLL  and vault , but also prevents another vault (PCMCIA card) from replacing the vault  that began a communication session, because the other vault does not have the session key negotiated at the beginning of the communication session. Secure Communications sub-module  also controls secure communications with the postal data center, for example, during refills of the accounting registers in vault .","Conventional postage meters store transactions in the meter. In accordance with the present invention, Transaction Capture sub-module  captures each transaction record received from vault  and records the transaction record in DLL  and in DLL storage area  on hard drive . If there is ample room on hard drive , such transaction captures can be stored for a plurality of different vaults. Referring now to , from the moment that a communication session is established, Transaction Capture sub-module  monitors message traffic at step . Transaction Capture sub-module  continues to check for a transaction is taking place at step  until a transaction is detected. When a transaction is detected, Transaction Capture sub-module  selectively captures each transaction record for token generations and refills, and stores such transaction records in DLL  at step  and in an invisible and write-protected file  in DLL storage area  at step . The information stored for each transaction record includes, for example, vault serial number, date, piece count, postage, postal funds available (descending register), tokens, destination postal code and the block check character. A predetermined number of the most recent records initiated by PC  are stored in file  which is an indexed historical file. In the preferred embodiment file  is indexed according to piece count but may searched according to addressee information. File  represents the mirror image of vault  at the time of the transaction except for the encryption keys and configuration parameters. Storing transaction records on hard drive  provides backup capability which is described below.","In a closed metering system, such as conventional postage meters, the indicia is secure because the indicia printer is dedicated to the meter activity and is physically secured to the accounting portion of the meter, typically in a tamper-proof manner. In an open metering system, such as the present invention, such physical security is not present.","In accordance with the present invention, the entire fixed graphics image  of the indicia , shown in  is stored as compressed data in DLL storage area . Postal data information, including piece count , vendor ID , postage amount , serial number , date and origination ZIP and tokens are combined with the fixed graphics image  by Indicia Image Creation Module .","Referring now to , a process for Indicia image Creation Module  is shown beginning at step . Indicia Image Creation Module  continues to check at step  for a request for indicia from an application program in PC  until one is received. When a request is received, Indicia Image Creation Module  checks for a digital token from vault  at step . Indicia Image Creation Module  continues to check for a digital token until one is received. When a token is received, then at step  generates a bit-mapped indicia image  by expanding the compressed fixed graphics image data at step  and combining at step  the indicia's fixed graphics image  with some or all of the postal data information and tokens received from vault . At step , the indicia image is stored in DLL  for printing. Sub-module  sends to the requesting application program  in PC  the created bit-mapped indicia image that is ready for printing, and then stores a transaction record comprising the digital tokens and associated postal data in DLL storage area .","Thus, the bit-mapped indicia image is stored in DLL  which can only be accessed by executable code in DLL . Furthermore, only the executable code of DLL  can access the fixed graphics image  of the indicia to generate bit-mapped indicia image. This prevents accidental modification of the indicia because it would be very difficult for a normal user to access, intentionally or otherwise, the fixed graphics image  of the indicia and the bit-mapped indicia image.","The Application Interface sub-module  provides the following services when requested by an application program  in PC . Application program  accepts user data through user interface module  and prints indicia on an envelope or on a label. In the preferred embodiment of the present invention, such application program  would be an off-the-shelf software module, such as a word processor or spreadsheet, that can access DLL . In an alternate embodiment application program  could be a software module dedicated solely to accept user data and print indicia on an envelope or on a label. Application Interface sub-module  provides the destination ZIP data and associated postal data needed to create the indicia. Application Interface sub-module  requests available postage from vault  and reports the available postage to the requesting application program .","When vault  is refilled with postage funds from the data center, Application Interface sub-module  requests from vault  the access code required for refills and reports the access code received to the Secure Communications sub-module  which initiates communications with the data center. Application Interface sub-module  initiates the refill and provides the amount and combination to vault . DLL  reports the result to the requesting application program  which acknowledges the refill to the user.","Application Interface sub-module  processes a request for an indicia received from application program  and forwards the request to Indicia Image Creation and Storage sub-module . Application Interface sub-module  provides postal data, including date, postage, and a destination postal code, such as an  digit ZIP code, to Indicia Image Creation and Storage submodule  which then generates a bit-mapped indicia image. Application Interface sub-module  reports to application program  that the bit-mapped indicia image is ready for printing.","Vault  must be a secure device because it contains the accounting information of the amount of postage remaining in the vault and the postage printed. However, the very nature of the security makes it hard to recover postal funds in the event a malfunction occurs and the vault cannot be accessed by normal operation. The present invention enhances the reliability of a PC meter system by using the hard disk of the user PC to backup the accounting information of the vault. As previously described, the transaction capture sub-module  stores transaction files as backup files on hard drive . This provides a benefit that certain functions, such as account reconciliation, can be performed even when vault  malfunctions. Such backup is unavailable in conventional postage meters.","For further security, the backup transaction files can be encrypted before being stored on hard drive  to prevent tampering. The number of transactions that are maintained on hard drive  is limited only by the available storage space on hard drive . Preferably, at least all transactions since the last refill would be maintained as backup.","A detailed description of recovery from vault malfunction is disclosed in co-pending U.S. patent application Ser. No. 08\/574,743 now U.S. Pat. No. 5,793,867, which is incorporated herein in its entirety by reference.","Generally, the first action by a user after powering up a conventional meter is setting the time and date of the meter. Setting the date is necessary to generate derived keys which are used to generate the digital tokens. (Some recent meters have a real time clock internal to the meter in which case the time and date need only be set once.) The present invention spares the user from having to set the vault date.","As previously described, vault  does not have an independent power source and therefore cannot have a continuous running real-time clock. The date must be set every time the vault is powered-up. Power is applied to vault  only when it is plugged into PC . Thus, the date would normally be entered by the user through PC  each time vault  is plugged into PCMCIA controller . Since the PC to which the vault is connected has a real-time clock, the date setting process may be automated and made transparent to the user. In accordance with the present invention, the time and date set in PC  is sent to vault  each time power is initially applied to vault . The vault date is used by DLL  to generate the indicia. The vault date may be changed at any time by the user to facilitate post-dating of mail.","Upon application of power to vault  by PCMCIA controller , the date of PC  is obtained through user interface . The date is then translated into the correct format and sent to vault  which then sets its date, calculates its date dependent token keys and returns its status and the token keys to PC . Additionally, a default postage amount (e.g. First Class Postage) may be set in a similar manner. This method enables PC meter system  immediately when vault  is plugged into PC  without the user having to manually set parameters. The user may change the vault date (in order to post date mail) or the default postage amount at any time.","In an alternate embodiment, PCMCIA card has its own internal clock that is automatically set with the time and date in PC  each time PCMCIA card is inserted into PCMCIA controller .","In the preferred operation, a user of an application program , such as a word processor, highlights a recipient address from a letter or mailing list displayed on display . The user requests the printing of an envelope with indicia. A dialog box appears on display  indicating the default postage amount which the user may accept or modify. When the postage amount is accepted, the entire envelope is previewed with all addressing, bar-coding and indicia shown on the envelope. At this point the user can print the envelope as shown or correct any errors that are seen in the preview.","From the display  and keyboard , the user can change postage amount, date and address information. The user can also select and customize a return address, slogan, logo and greeting that may be printed with the indicia. The present invention also provides from the application program  the ability for a user to check funds available in vault  and to initiate  the automatic refilling of the PC meter through modem . PC meter system  also includes the capability of interfacing with optional software, such as postal rate calculation and address hygiene, that improves the performance of PC meter system .","PC meter system  provides capabilities that are not available with conventional postage meters. For example, a user can scan in addressee information; generate indicia for a batch of envelopes before printing any of the envelopes; observe an image of the envelope to be printed, including addressee information and indicia, before printing the envelope; and customize slogans, logos and greetings to be printed with the indicia on the envelope.","Most personal bills received in the home today come with self-addressed, reply envelopes. A user may desire to use PC meter system  to apply open system indicia to the self-addressed, reply envelopes. Since the open system indicia includes addressee information, the user can type such addressee information into PC  before requesting indicia. This task can be simplified by using a conventional optical scanner connected to PC  for scanning in the unique addressee information printed on the reply envelope. PC meter system  uses such unique addressee information to generate tokens for the indicia. PC meter system  then prints the indicia to a label printer or label printed on a conventional printer, or prints a completely new envelope with the scanned address. The label with indicia printed on it, could then be applied to the self-addressed, reply envelope. Using a scanner in this manner eliminates the need for a user to manually enter information from the self addressed envelope which is a slower method that has a higher potential for error. Such error.in entering addressee information could result in indicia that fails open system verification by the Post Office. It will be understood that the scanner can also be used for scanning in addresses from a printed mailing list. Finally, if the envelope was prepared previously or at another PC, the addressee information can be scanned as described above.","As previously described, in PC meter system  the printer is not dedicated to the metering function and the indicia are stored in PC  before printing. Thus, indicia can be generated individually or for a batch of addressees and then printed at a later time at the user's discretion. Such delayed printing and batch processing described in more detail in co-pending U.S. patent application Ser. No. 08\/575,104 previous noted, which is incorporated herein in its entirety by reference.","As with any document prepared in a Windows-based PC system, a user may observe, through the application program  in which an envelope was created, an image of a fully prepared envelope or batch of envelopes to be printed, including addressee information and indicia, before printing any of the envelopes. In addition, PC meter system  provides a user with the ability to customize return addresses, slogans, logos and greetings that are to be printed with the indicia on the envelope.","In an alternate embodiment of PC meter , the electronic vault is in an IC token, such as manufactured by CDSM of Phoenix, Ariz., that is inserted into a token receptacle of a PCMCIA card and programmed to operate as the vault in a similar manner go as described for the PCMCIA card. In another alternate embodiment, the electronic vault is in a smart diskette, such as manufactured by SmartDisc Security Corp. of Naples, Fla., that is programmed to operate in a similar manner as described for PCMCIA card.","In another alternate embodiment of PC meter , the electronic vault is a tamper proof, hardware peripheral, such as a dongle, that is attached to a serial, parallel or SCSI port of the PC. In yet another alternate embodiment, not shown, the vault is internal to PC , for example a separate chip within PC- that functions in a manner similar to vault .","In yet another alternate embodiment of a PC-based metering system, PC  is a host computer in a network serving a plurality of users in which the vault is active within the host computer and requests for indicia originate from and printing of indicia occur at a local PC. Such alternate embodiment is disclosed in co-pending U.S. patent application Ser. No. 08\/575,109 previously note, which is incorporated herein in its entirety by reference.","Finally, the present invention provides an alternate method of postage evidencing which eliminates the need to print anything on an envelope. PC meter system  can print an open system indicia on a letter itself as shown in FIG. . The format of such a letter  includes a return address  in the upper left corner, an open system indicia  in the upper right corner, a destination address  below the return address, and the body of the letter  below the destination address. Using a windowed envelope  with three windows, as shown in , the return address is visible through an upper left corner window , the destination address is visible through a lower left window , and the indicia is visible through an upper right window . It will be understood that the present invention can be used to print indicia anywhere on the letter or document being printed to accommodate alternately configured windowed envelopes, such as a single, large windowed envelope. The present invention is also suitable for printing indicia on a one piece mailer. The foregoing method of mailing a letter with indicia printed directly on the letter and visible through a window of the envelope eliminates a finishing step in production mail relating to matching a separately printed envelope with its corresponding letter. It has been a challenge to insert a letter to the corresponding envelope when the letters and envelopes are printed separately. Thus the present invention simplifies and eliminates errors in the mail preparation process.","While the present invention has been disclosed and described with reference to a single embodiment thereof, it will be apparent, as noted above that variations and modifications may be made therein. It is, thus, intended in the following claims to cover each variation and modification that falls within the true spirit and scope of the present invention."],"heading":["RELATED APPLICATION","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PRESENT INVENTION","Commands From The PC To Control The Vault Power","Dynamic Link Library Control of the Vault","Secure Communications","Transaction Captures","Indicia Image Creation and Storage","Application Interface","Backup On Hard Drive","Operation of the PC Meter"],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DESCRIPTION OF THE DRAWINGS","p":["The above and other objects and advantages of the present invention will be apparent upon consideration of the following detailed description, taken in conjunction with accompanying drawings, in which like reference characters refer to like parts throughout, and in which:",{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 3","FIG. 1"]},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 4","FIG. 1"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIG. 5","FIG. 1"]},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 6","FIG. 1"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 7","FIG. 1"]},{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIG. 8","FIG. 1"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 9","FIG. 1"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 10","FIG. 1"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 11","FIG. 1"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 12","FIG. 11"]}]},"DETDESC":[{},{}]}
