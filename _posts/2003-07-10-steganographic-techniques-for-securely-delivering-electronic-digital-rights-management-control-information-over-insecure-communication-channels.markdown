---
title: Steganographic techniques for securely delivering electronic digital rights management control information over insecure communication channels
abstract: Electronic steganographic techniques can be used to encode a rights management control signal onto an information signal carried over an insecure communications channel. Steganographic techniques ensure that the digital control information is substantially invisibly and substantially indelibly carried by the information signal. These techniques can provide end-to-end rights management protection of an information signal irrespective of transformations between analog and digital. An electronic appliance can recover the control information and use it for electronic rights management to provide compatibility with a Virtual Distribution Environment. In one example, the system encodes low data rate pointers within high bandwidth time periods of the content signal to improve overall control information read/seek times.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08307212&OS=08307212&RS=08307212
owner: Intertrust Technologies Corp.
number: 08307212
owner_city: Sunnyvale
owner_country: US
publication_date: 20030710
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATION","FIELD OF THE INVENTION","BACKGROUND AND SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PRESENTLY PREFERRED EXAMPLE EMBODIMENTS","Example Rights Management Component","Example Electronic Appliances","Example Rights Management Enforcement Techniques","End to End Protection","Example Control Information","Example Steganographic Encoding and Decoding Processes","Example Control Information Arrangements","Detailed Example Electronic Appliance Architecture","Example Control Steps","Example Refresh Capability","EXAMPLES"],"p":["This application is a continuation of U.S. application Ser. No. 10\/189,231, filed Jul. 5, 2002 now U.S. Pat. No. 6,618,484, which is a continuation of U.S. application Ser. No. 09\/790,566, filed Feb. 23, 2001, now U.S. Pat. No. 6,449,367, which is a continuation of U.S. application Ser. No. 09\/247,328, filed Feb. 10, 1999, now U.S. Pat. No. 6,240,185, which is a continuation of U.S. application Ser. No. 08\/689,606, filed Aug. 12, 1996, now U.S. Pat. No. 5,943,422.","This application is related to commonly assigned application Ser. No. 08\/388,107 of Ginter et al., filed 13 Feb. 1995, entitled \u201cSYSTEMS AND METHODS FOR SECURE TRANSACTION MANAGEMENT AND ELECTRONIC RIGHTS PROTECTION, now abandoned. A file wrapper continuation of application Ser. No. 08\/388,107 issued as U.S. Pat. No. 5,982,891. We incorporate by reference, into this application, the entire disclosure of this prior-filed Ginter et al. patent application just as if its entire written specification and drawings were expressly set forth in this application.","The present inventions relate generally to computer security, and more particularly to steganographic techniques for hiding or encoding electronic control information within an information signal carried by an insecure communications channel. Still more particularly, the present inventions relate to systems, methods and techniques that substantially invisibly and\/or indelibly convey, over analog or other insecure communications channels, digital rights management control information for use within a virtual distribution environment electronic rights management system.","The world is becoming digital. Digital signals are everywhere\u2014in our computers, television sets, VCRs, home stereos, and CD players. Digital processing\u2014which operates on information \u201cbits\u201d (numerical \u201con\u201d or \u201coff\u201d values)\u2014provides a degree of precision and protection from noise that cannot be matched by the older, \u201canalog\u201d formats we have used since the beginning of the electronic age.","Despite the clear advantage of digital communications, the older \u201canalog\u201d domain remains significant. Many of our most important information delivery mechanisms continue to be based on analog\u2014not digital\u2014signaling. In fact, most of our electronic entertainment, news, sports and music program material comes to us in the form of analog signals. For example:\n\n","Moreover, the \u201creal world\u201d is analog. Everything digital must ultimately be turned into something analog if we are to experience it; and conversely, everything analog must be turned into something digital if the power of modern digital technology will be used to handle it. Modern digital technology also allows people to get better quality for less money.","Despite the pervasiveness of analog signals, existing methods for managing rights and protecting copyright in the analog realm are primitive or non-existent. For example:\n\n","A related problem relates to the conversion of information between the analog and digital domains. Even if information is effectively protected and controlled initially using strong digital rights management techniques, an analog copy of the same information may no longer be securely protected.","For example, it is generally possible for someone to make an analog recording of program material initially delivered in digital form. Some analog recordings based on digital originals are of quite good quality. For example, a Digital Versatile Disk (\u201cDVD\u201d) player may convert a movie from digital to analog format and provide the analog signal to a high quality analog home VCR. The home VCR records the analog signal. A consumer now has a high quality analog copy of the original digital property. A person could re-record the analog signal on a DVD-R (a Digital Versatile Disk appliance and media supporting both read and write operations). This recording will in many circumstances have substantial quality\u2014and would no longer be subject to \u201cpay per view\u201d or other digital rights management controls associated with the digital form of the same content.","Since analog formats will be with us for a long time to come, rightsholders such as film studios, video rental and distribution companies, music studios and distributors, and other value chain participants would very much like to have significantly better rights management capabilities for analog film, video, sound recordings and other content. Solving this problem generally requires a way to securely associate rights management information with the content being protected.","People have for many years been-using various techniques allowing digital information to, in effect, ride \u201cpiggyback\u201d on analog information signals. For example, since the 1960s, it has been common to digitally encode text information such as subtitles into otherwise unused portions of analog television signals (e.g., within the so-called \u201cVertical Blanking Interval\u201d).","Unfortunately, sending digital information using such known digital encoding techniques is problematic because the digital information is not persistent. It is relatively easy to strip out or eliminate digital information encoded using prior techniques commonly employed for superimposing digital signals onto an analog information signal. Analog communications channels may commonly be subjected to various signal processing that may (intentionally or unintentionally) strip out digital information added to the analog signal\u2014defeating any downstream system, process or technique that depends on the presence and readability of the digital information. For example, the television vertical blanking signal\u2014along with any signal components disposed within the vertical blanking interval\u2014is typically routinely eliminated whenever a video signal is processed by a computer.","Attempting to use insecure techniques for providing rights management is at best ineffective, and can be worse than no rights management at all. Unscrupulous people can strip out insecure control information altogether so that the corresponding information signal is subject to no controls at all\u2014for example, defeating copy protection mechanisms and allowing users to avoid paying for rights usage. More nefariously, an unscrupulous person could alter an insecure system by substituting false control information in place of the proper information. Such substitutions could, for example, divert payments to someone other than legitimate rights holders\u2014facilitating electronic fraud and theft.","Prior, insecure techniques fail to solve the overall problem of how to provide and securely manage advanced automatic electronic rights management for analog and other information signals conveyed over an insecure communications channel. The lack of strong rights management for analog signals creates a huge gap in any comprehensive electronic rights management strategy, and makes it possible for consumers and others to circumvent\u2014to at least some extent\u2014even the strongest digital rights management technologies. Consequently, there is a real need to seamlessly integrate analog delivery models with modern electronic digital rights management techniques.","The present inventions solve these and other problems by providing \u201cend to end\u201d secure rights management protection allowing content providers and rights holders to be sure their content will be adequately protected\u2014irrespective of the types of devices, signaling formats and nature of signal processing within the content distribution chain. This \u201cend to end\u201d protection also allows authorized analog appliances to be easily, seamlessly and cost-effectively integrated into a modern digital rights management architecture.","The present inventions may provide a Virtual Distribution Environment (\u201cVDE\u201d) in which electronic rights management control information may be delivered over insecure (e.g., analog) communications channels. This Virtual Distribution Environment is highly flexible and convenient, accommodating existing and new business models while also providing an unprecedented degree of flexibility in facilitating ad hoc creation of new arrangements and relationships between electronic commerce and value chain participants\u2014regardless of whether content is distributed in digital and\/or analog formats.","The present inventions additionally provide the following important and advantageous features:\n\n","Briefly, the present inventions use \u201csteganography\u201d to substantially indelibly and substantially invisibly encode rights management and\/or electronic commerce rules and controls within an information signal such as, for example, an analog signal or a digitized (for example, sampled) version of an analog signal.","The Greek term \u201csteganography\u201d refers to various \u201chidden writing\u201d secret communication techniques that allow important messages to be securely carried over insecure communications channels. Here are some examples of steganography:\n\n","The present inventions use steganography to ensure that encoded control information is both substantially invisible and substantially indelible as it passes over an insecure communications channel. At the receiving end, a secure, trusted component (such as a protected processing environment described in Ginter et al.) recovers the steganographically-encoded control information, and uses the recovered information to perform electronic rights management (for example, on analog or other information signals carried over the same channel).","One specific aspect provided by the present inventions involve steganographically encoding digital rights management control information onto an information signal such as, for example, an analog or digitized television, video or radio signal. The steganographic encoding process substantially inextricably intertwines the digital control information with images, sounds and\/or other content the information signal carries\u2014but preferably without noticeably degrading or otherwise affecting those images, sounds and\/or other content. It may be difficult to detect (even with educated signal processing techniques) that the analog signal has been steganographically encoded with a rights management control signal, and it may be difficult to eliminate the steganographically encoded control signal without destroying or degrading the other information or content the signal carries.","The present inventions also provide a secure, trusted protected processing environment to recover the steganographically-encoded control signal from the information signal, and to enforce rights management processes based on the recovered steganographically encoded control signal. This allows the information signal delivery mechanism to be fully integrated (and made compatible) with a digital virtual distribution environment and\/or other electronic rights management system.","In accordance with yet another aspect provided by this invention, steganographically encoded, digital rights management control information may be used in conjunction with a scrambled and\/or encrypted information signal. The scrambling and\/or encryption can be used to enforce the rights management provided in accordance with the steganographically encoded rights management control information. For example, the control signal can be steganographically decoded and used to control, at least in part, under what circumstances and\/or how the information signal is to be descrambled and\/or decrypted.","In accordance with yet another feature provided by the invention, digital certificates can be used to securely enforce steganographically encoded rights management control information.","In accordance with still another feature provided by the invention, steganography is used to encode an information signal with rights management control information in the form of one or more protected organizational structures having association with electronic controls. The electronic controls may, for example, define permitted and\/or required operation(s) on content, and consequences of performing and\/or failing to perform such operations. The organizational structure(s) may identify, implicitly or explicitly, the content the electronic controls apply to. The organizational structure(s) may also define the extent of the content, and semantics of the content.","The type, amount and characteristics of the steganographically encoded rights management control information are flexible and programmable\u2014providing a rich, diverse mechanism for accommodating a wide variety of rights management schemes. The control information can be used to securely enforce straightforward secure rights management consequences such as \u201ccopy\/no copy\/one copy\u201d type controls\u2014but are by no means limited to such models. To the contrary, the present invention can be used to enable and enforce much richer, more complex rights management models\u2014including for example those involving usage auditing, automatic electronic payment, and the use of additional electronic network connections. Moreover, the rights management control arrangements provided by the present invention are infinitely extensible and scaleable\u2014fully accommodating future models as they are commercially deployed while preserving full compatibility with different (and possibly more limited) rights management models deployed during earlier stages.","The organizational structure(s) may be steganographically encoded in such a way that they are protected for purposes of secrecy and\/or integrity. The employed steganographic techniques may provide some degree of secrecy protection\u2014or other security techniques (e.g., digital encryption, digital seals, etc.) may be used to provide a desired or requisite degree of security and\/or integrity protection for the steganographically encoded information.","In one example, the organizational structure(s) may comprise digital electronic containers that securely contain corresponding digital electronic control information. Such containers may, for example, use cryptographic techniques. In other examples, the organizational structure(s) may define associations with other electronic control information. The other electronic control information may be delivered independently over the same or different communications path used to deliver the organizational structure(s).","In one example, the steganographic techniques employed may involve applying the organizational structure information in the form of high frequency \u201cnoise\u201d to an analog information signal. Spectral transforms may be used to apply and recover such steganographically-encoded high frequency \u201cnoise.\u201d Since the high frequency noise components of the information signal may be essentially random, adding a pseudo-random steganographically encoded control signal component may introduce substantially no discernible information signal degradation, and may be difficult to strip out once introduced (at least without additional knowledge of how the signal was incorporated, which may include a shared secret).","In accordance with another aspect provided by the invention, a steganographic encoding process analyzes an information signal to determine how much excess bandwidth is available for steganographic encoding. The steganographic encoding process may use variable data rate encoding to apply more control information to parts of an information signal that use much less than all of the available communications channel bandwidth, and to apply less control information to parts of an information signal that use nearly all of the available communications channel bandwidth.","In accordance with still another aspect provided by the invention, multiple organizational structures may be steganographically encoded within a given information signal. The multiple organizational structures may apply to different corresponding portions of the information signal, and\/or the multiple organizational structures may be repetitions or copies of one another to ensure that an electronic appliance has \u201clate entry\u201d and\/or error correcting capability and\/or can rapidly locate a pertinent organizational structure(s) starting from any arbitrary portion of the information signal stream.","In accordance with yet another aspect provided by this invention, an organizational structure may be steganographically encoded within a particular portion of a content-carrying information signal to which the organizational structure applies\u2014thereby establishing an implicit correspondence between the organizational structure and the identification and\/or extent and\/or semantics of the information content to which the organizational structure applies. The correspondence may, for example, include explicit components (e.g., internally stated start\/end points), with the storage or other physical association determined by convenience (i.e., it may make sense to put the organizational structure close to where it is used, in order to avoid seeking around storage media to find it).","In accordance with yet another aspect provided by this invention, pointers can be steganographically encoded into parts of an information signal stream that has little excess available bandwidth. Such pointers may be used, for example, to direct an electronic appliance to portions of the information signal stream having more available bandwidth for steganographic encoding. Such pointers may provide improved steganographic decode access time\u2014especially, for example, in applications in which the information signal stream is stored or otherwise available on a random access basis.",{"@attributes":{"id":"p-0054","num":"0073"},"figref":"FIG. 1","b":"50"},"In this example, a provider  delivers an information signal  to multiple electronic appliances (), . . . , (N). In this particular example, provider  is shown as being a television broadcaster that delivers an analog television information signal  over a wireless or cable communications path, and appliances (), . . . , (N) are shown as being home color television sets . As made clear by , the present inventions may be used by a variety of different types of electronic appliances  receiving a variety of different types of information signals via a variety of different types of communications channels.","In the  example, provider  steganographically encodes electronic rights management control information  into the information signal . This control information  is represented in this diagram as a traffic light because it may define permitted and\/or required operation(s), and consequences of performing or failing to perform such operations. For example, control information  could specify that a viewer or class of viewers has permission to watch a particular program, is forbidden to watch a program, or may watch a program only under certain conditions (for example, based on paying a certain amount, being over a certain age, etc.). In this example the control information  is shown as being packaged within an electronic \u201ccontainer\u201d . Container  (which in at least one example is provided by steganographic encoding techniques) is used to protect the integrity of the control information .","The provider  encodes the electronic rights management control information  onto information signal  using steganographic techniques that make the control information both:\n\n","The control information  is substantially indelibly encoded because, in this example, it is substantially inextricably intertwined with the television images and\/or sound\u2014and can't easily be eliminated from information signal  without destroying the images, sound or other information carried by the information signal. For example, steganographically encoding rights management control information will generally survive compression and decompression of a digitized analog signal, and will also survive repeated analog\/digital\/analog conversion sequences.","Even though the steganographically encoded control information  is substantially indelible, the television viewer is not bothered by the steganographically encoded information because the steganographically encoded rights management control information is, in this example, also encoded substantially invisibly. In fact, the viewer may not be able to see the steganographic control information at all\u2014and it may have no effect whatsoever on his or her viewing experience (other than in terms of the effect is has on associated rights management processes). The control information  is shown in dotted lines on the  screens of television sets  to emphasize that the control information is substantially inextricably intertwined with the television images and\/or sounds\u2014and yet can't really be seen or noticed by the television viewer.",{"@attributes":{"id":"p-0060","num":"0081"},"figref":"FIG. 2","b":["126","128","128","70"]},{"@attributes":{"id":"p-0061","num":"0082"},"figref":"FIG. 2","b":["128","70"]},"Since indelibility of the steganographic encoding provides persistence, indelibility may be more important than invisibility in at least some applications. For example, it may be desirable in some applications to use a shared secret to decode and then remove the steganographically-encoded control information  before presenting the information signal (or its content) to the user. The steganographically encoded information need not be particularly invisible in this scenario. Even though someone with knowledge of the shared secret can remove the steganographically encoded information, it may nevertheless remain substantially indelible to anyone who doesn't know the shared secret required to remove it.","Organization Structures",{"@attributes":{"id":"p-0063","num":"0084"},"figref":["FIG. 1","FIGS. 17-26B"],"b":["126","136","136"]},"The organizational structure(s) may be encoded in such a way that they are protected for purposes of secrecy, authenticity and\/or integrity. The employed steganographic technique may provide such protection, or another security technique may be used in conjunction with steganography to provide a desired or requisite degree of protection depending on the application. Containers  may, for example, use mathematical techniques called \u201cencryption\u201d that help guarantee the integrity and\/or secrecy of the control information  they contain.","Each of the  example appliances  may include a electronic digital rights management component . Rights management component  may, for example, comprise one or more tamper-resistant integrated circuit \u201cchips\u201d. Components  may, for example, be of the general type described in detail at  and following of the Ginter et al. patent specification. Briefly, Ginter et al. describes a Virtual Distribution Environment (\u201cVDE\u201d) including multiple electronic appliances coupled together through a communications capability. Each electronic appliance has such a secure, tamper-resistant \u201cprotected processing environment\u201d in which rights management processes may securely take place. The Virtual Distribution Environment delivers digital control information to the protected processing environments by packaging the control information within secure electronic digital containers. This delivered control information provides at least part of the basis for performing electronic rights management functions within the protected processing environments.","The ability to securely deliver digital control information to such protected processing environments as embodied with components  is important at least because it increases flexibility and enhances functionality. For example, different digital control information can be delivered for the same or different electronic content. As one specific example, one set of rules may apply to a particular television program, another set of rules might apply to a particular film, and a still different set of rules could apply to a particular musical work. As yet another example, different classes of users of the same electronic content can receive different control information depending upon their respective needs.","Rights management components  are able to steganographically decode the control information  carried by the information signal . Components  use the decoded control information  to electronically manage rights. For example, components  may use the decoded control information  to control how the images and\/or sound carried by information signal  may be used.","In one example, digital rights management component  may comprise or include one or more integrated circuit chips as shown in . The  example rights management component  includes an analog-to-digital converter , a steganographic decoder , and a rights management processor . Rights management processor  may include or comprise a protected processing environment  as described in Ginter et al. , for example, providing a tamper-resistant execution environment for effecting the operations provided by electronic controls . Rights management component  may also include a steganographic encoder and a digital-to-analog converter (not shown).","The analog-to-digital converter (ADC)  shown in  takes the incoming information signal  and\u2014if it is in analog form\u2014converts it to a digital signal (see , step \u201cA\u201d). Steganographic decoder  obtains the digital control information  from the resulting digital signal (, step \u201cB\u201d). As mentioned above, digital control information  may define permitted and\/or required operation(s) on the content carried by signal , and may further define consequences of performing and\/or failing to perform such operations. Rights management processor  may manage these rights and\/or permissions and associated consequences (, step \u201cC\u201d).","The present inventions may be used with all sorts of different kinds of electronic appliances  each of which may include a rights management component .  show various example electronic appliances  embodying aspects of the present invention. For example:\n\n","Different rights holders want different types of rights management and control. For example, some rights holders may be completely satisfied with a relatively simple \u201ccopy\/no copy\/one copy\u201d rights management control model, whereas other rights holders may desire a richer, more complex rights management scheme. The present inventions flexibly accommodate a wide variety of electronic rights management techniques\u2014giving rightsholders extreme flexibility and programmability in defining, for example, commerce and rights management models that far exceed the simple \u201ccopy\/no copy, one copy.\u201d Assuming a closed appliance, that is, one lacking at least an occasional connection to a payment method (e.g., Visa, MasterCard, American Express, electronic cash, Automated Clearinghouses (ACHs) and\/or a Financial Clearinghouse that serves as the interface for at least one payment method), the following are non-limiting examples of steganographically encoded rights controls and associated consequences that can be accommodated by the present invention:\n\n","An even more flexible and diverse array of rights controls and associated consequences are enabled by the present inventions if at least one appliance is connected to some form of communications \u201cbackchannel\u201d between the appliance and some form of payment method. This backchannel may be a telephone call, the use of a modem, a computer data network, such as the Internet, a communications channel from a settop box to the head end or some other point on a cable TV distribution system, or a hybrid arrangement involving high bandwidth distribution of analog properties with a slower return channel, a phone line and modem\u2014just to name a few examples. Non-limiting examples of such more rights controls and associated consequences enabled by the present invention include the following:\n\n",{"@attributes":{"id":"p-0073","num":"0111"},"figref":"FIGS. 5A-5D","b":"124"},"In the  example, rights management component  controls an on\/off switch  based on steganographically encoded electronic controls . Component  turns switch  on (for example, to allow the analog television signal to pass to television set ) when electronic controls  permit, and otherwise opens (turns off) switch  to prevent the analog signal from reaching the output.","In a more secure example, the incoming analog signal is scrambled, and the  on\/off switch  is replaced by a  descrambler  of conventional design. The descrambler  descrambles the analog input signal to provide a descrambled output under control of rights management component . Rights management component  allows descrambler  to descramble the analog signal only under conditions specified by electronic controls  that the component  obtains from the analog input signal. Scrambling the analog signal gives the rights management component  a relatively secure way of enforcing electronic controls \u2014since the rights management component can prevent the descrambler from operating unless conditions set by the controls are satisfied. The rights management function and the descrambling function may be integrated into a single component in which the descramble and decrypt functions of the rights management component are essentially serving the same function, but may still be distinct to account for specialized approaches to descrambling that may not be sufficiently strong or interoperable with other environments to use generally. If they are separate components, the data path between them should be protected (for example, by ensuring that both components are in a tamper resistant enclosure, or using secure authentication and key exchange to send the descrambling sequence to the descrambler).",{"@attributes":{"id":"p-0076","num":"0114"},"figref":"FIG. 5C","b":["126","100","110","100","124","126","100","100","126","100","124","100","124","199","100","124","126","110","199"],"i":"Applied Cryptography "},{"@attributes":{"id":"p-0077","num":"0115"},"figref":["FIG. 5D","FIGS. 58A-58C"],"b":["124","126","124"]},{"@attributes":{"id":"p-0078","num":"0116"},"figref":"FIGS. 5E-5F","b":"126"},{"@attributes":{"id":"p-0079","num":"0117"},"figref":["FIG. 5E","FIG. 5F"]},"In the  example, an analog signal transmission site (e.g., a radio or television broadcaster) transmits an analog signal A steganographically encoded with an organizational structure  including electronic controls . This analog signal A may be received by an electronic appliance A having a rights management component A as described above. Appliance A may, for example, convert the signal into digital and\/or digitized format, and store the digitized version of the signal onto a digital storage medium . Electronic appliance A may play back the recorded digitized signal, convert the signal back to analog form, and deliver the analog signal A to a further electronic appliance B. In this example, electronic appliance B also has a rights management component B.","The steganographic techniques provided by the present invention ensure that the electronic controls  persist in the signal A delivered from appliance A to appliance B\u2014and from appliance B to still other appliances. Because of the substantial indelibility characteristics of the steganographically encoded control information , this information persists in the signal as stored on recording medium , in copies of the recorded signal produced by replaying the medium, and in further downstream versions of the signal.","This persistence will, for example, survive conversion from analog to digital format (e.g., sampling or \u201cdigitizing\u201d), storage, and subsequent conversion from digital to analog format. For example, because the steganographically encoded control information  is substantially indelibly, substantially inextricably intertwined and integrated with the information signal A, the digitized version of the information signal that appliance A records on medium  will also contain the steganographically encoded control information . Similarly, when appliance A plays back the recording from medium , it will reproduce information signal A along with the steganographically encoded control information . The steganographically encoded control information  thus persists irrespective of digitization (or other processing) of signal A. In some cases, lossy compression techniques used on the data may remove high frequency noise\u2014thereby potentially damaging the steganographic channel. When these lossy compression techniques are used or may be encountered, the steganographic encoding function should be matched to the compression algorithm(s) using conventional signal analysis techniques to avoid this consequence.","Similarly, appliance B may output further copies or versions of signal A in analog form and\/or digital form. Because of its inherently persistent characteristics, the steganographically encoded control information  will be present in all subsequent versions of the signal outputted by appliance B\u2014be they in analog format, digital format, or any other useful format.","Degrading a digital signal carrying control information is fatal\u2014the rights management system typically may no longer function properly if even a single bit is altered. To avoid this, the preferred embodiment provides redundancy (repeating pointers and the organizational structures and\/or any control information incorporated into the organizational structures), and also uses conventional error correction coding such as, for example, Reed-Solomon (or similar) error correcting codes. Additionally, because the steganographically encoded control information  is substantially inextricably intertwined with the desired content carried by information signal A, any process that degrades the steganographically encoded control information  will also tend to degrade the information signal's desired content. Although the steganographically encoded information may degrade (along with the content) in multi-generation \u201ccopies\u201d of the signal, degraded copies may not be commercially significant since the information content of the signal will be similarly degraded due to the substantially inextricable intertwining between the steganographically encoded control information  and the content carried by signal A. The refresh circuit shown in  with appropriate error correcting capabilities is one way to prevent the steganographically encoded information from being degraded even if the rest of the information the signal carries becomes degraded.","The  example shows content being initially distributed in digital form over a network to an electronic appliance J such as a personal computer. Personal computer J may convert the digitally delivered content to an analog signal A for distribution to other appliances B, A. Personal computer appliance J may include a rights management component J that ensures, based on controls , that appliance J does not release a version of the content associated with controls  that is not protected by the controls. In this example, rights management component J is capable of steganographically encoding the analog signal A with the control information  (e.g., it may perform the processes shown in  below). Rights management component J enforces controls , at least in part, by ensuring that any analog version of the content associated with controls  is steganographically encoded with those controls. Further \u201cdownstream\u201d. appliances B, A may each include their own rights management component  for use in interacting with steganographically encoded controls .",{"@attributes":{"id":"p-0086","num":"0124"},"figref":"FIG. 6","b":["70","136","126","70","126","270"],"ul":{"@attributes":{"id":"ul0017","list-style":"none"},"li":{"@attributes":{"id":"ul0017-0001","num":"0000"},"ul":{"@attributes":{"id":"ul0018","list-style":"none"},"li":["a first \u201ctrailer\u201d  may be associated with control information (),","a second trailer  may be associated with control information (),","a title section  may be associated with control information (),","the first five minutes of the movie may be associated with control information (), and","the rest of the movie may be associated with control information ()."]}}}},"Control information portions (), (), (), () and () may all be different. For example, control information () may permit the user to copy trailer , whereas control information () may prohibit the user from copying the first five minutes  of the film.","As shown in , multiple, identical copies of control information () may be steganographically encoded onto the information signal . For example, control information () could be encoded once per minute onto the rest of movie . This redundancy allows a media player  or other electronic appliance  to rapidly obtain a copy of the control information () no matter where the user begins watching or playing the movie , and also helps ensure that transmission errors will not prevent the rights management component  from recovering at least one \u201cgood\u201d copy of the organizational structure.",{"@attributes":{"id":"p-0089","num":"0132"},"figref":["FIGS. 7A and 7B","FIG. 7A","FIG. 7B","FIG. 7A","FIG. 7B","FIG. 7A","FIG. 7B"],"b":"100"},"Referring to , the analog information signal  inputted to the steganographic encoding process may be any sort of information signal such as, for example, the analog signal shown in Graph A. A conventional analog-to-digital conversion block  may be used, if necessary, to convert this analog input signal to a digitized signal (see Graph A). A spectral transform block  may then be used to transform the digitized information from the time domain to the frequency domain. Spectral transform block  may be any conventional transformation such as, for example, a Fast Fourier Transform (FFT) or a Walsh Transform. An example of the resulting spectral information is shown in the A graph.","A steganographic encode block  may be used to steganographically encode digital control information , in clear text form and\/or after encryption by a conventional digital encryption block  based on an encryption key Key, Steganographic information can be combined with a pseudo-random data stream (e.g. exclusive-or'd into the output of a DES engine)\u2014in effect shuffling around the noise in the signal rather than replacing noise with the signal, per se. When protection is desired, the values in the pseudo-random stream can be protected by encryption (e.g. the key that initializes the DES engine should be protected). When the steganographic channel is \u201cpublic\u201d (e.g., unencrypted), the stream should be readily reproducible (e.g. by using one of a preset collection of values shared by every device). A small portion (a \u201cpublic header\u201d\u2014see Ginter et al.) is always detectable using a shared preset value (that does not need to be protected, distinguishing it from the private header keys), may be provided to ensure that the rights management technology can be activated properly. Since the rights management component  at the receiving side needs to know how to descramble the signal, there normally will be an indication in the \u201cpublic header\u201d that names a key that will be used to unlock the private header (and so on, as described, for example, in Ginter et al.). Some publicly available, agreed upon preset values may be used to extract the \u201cpublic header\u201d information from the steganographically encoded channel.","Steganographic encode block  may be any conventional steganographic encoding arrangement capable of steganographically encoding a digital signal onto information signal . Steganographic encode step  may be based on a key K\u2014allowing the same basic steganographic encoding and decoding transformations to be used by a wide variety of different appliances while still maintaining individuality and secrecy through the use of different steganographic keys.","In one example, the steganographic encoding step  may introduce the (encrypted) digital control information into the high frequency spectrum portion of the spectrally transformed information signal . The spectrally transformed signal with steganographic encoding is shown in the  Graph A, and is shown in more detail in . As  shows, the steganographic encoding may affect the higher order frequency components of the spectrally transformed signal (see dotted perturbations in the fourth, fifth, sixth, seventh and eighth order components in ). The steganographic encoding may add to and\/or subtract from the amplitudes of these higher order components. The effect of introducing high frequency steganographically encoded signal components may be to mask the steganographic encoding within the random high frequency noise inherently provided within information signal \u2014thereby providing substantial invisibility and substantial indelibility.","The amount of amplitude modification performed by steganographic encode step  may be limited in this example to ensure that the resulting steganographically encoded signal does not exceed the available channel bandwidth. See, for example,\n\n","The following equations show the relationship between total bandwidth, bandwidth available for steganographic encoding, and the data rate of the steganographically encoded signal:",{"@attributes":{"id":"p-0096","num":"0143"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"S","mo":"=","mrow":{"msubsup":{"mo":"\u222b","mi":["ta","tb"]},"mo":"\u2062","mrow":{"mrow":[{"mi":"B","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}}}}}},{"mrow":{"mo":["(",")"],"mn":"1"}}]},{"mtd":[{"mrow":{"mo":"\u2245","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":["i","a"],"mo":"="},"mi":"b"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":"B","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},"mo":["\u2062","\u2062","\u2062"],"mi":["\u0394","t"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"mrow":{"mo":["(",")"],"mrow":{"mn":"1","mo":"\u2062","mi":"A"}}}]}]}}},"br":{},"sub":["n+1","n"],"ul":{"@attributes":{"id":"ul0021","list-style":"none"},"li":"B is a function of time in bits\/second."}},"In the above expressions, the function S corresponds to an area under a curve resulting from the product of B (bandwidth) and t (time). The parameter delta t refers to the \u201cgranularity\u201d of the analog-to-digital conversion (i.e., 1\/sampling rate).",{"@attributes":{"id":"p-0098","num":"0146"},"figref":["FIG. 9","FIG. 9"],"b":["70","70"]},"Steganographic encode block  can use an encoding rate and characteristic that ensures the steganographically encoded signal bandwidth doesn't exceed the total bandwidth available in the communication channel. Typically, the amount of bandwidth available for steganographic encoding may be on the order of on the average of 0.1% of the total transmission channel bandwidth\u2014but as mentioned above, this bandwidth available for steganographic encoding may be unequally distributed with respect to time within the information signal stream  and may depend on the content of the information signal.","In this example, steganographic encode block  analyzes the content (e.g., by performing statistical weighted averaging), and provides a responsive variable steganographic encoding rate. For example, steganographic encoding block  can use a high data rate during example time periods \u201cII\u201d and \u201cIV\u201d in which the information signal  has characteristics that allow high steganographic rate encoding without the resulting signal exceeding the available overall channel bandwidth. Encoding block  can use a low data rate during time periods \u201cI\u201d and \u201cIII\u201d in which the information signal  has characteristics that do not allow high data rate steganographic encoding without exceeding available overall channel bandwidth. Steganographic encoding block  may use any number of different variable rates to accommodate different relationships between information signal  characteristics and available channel bandwidth.","Referring again to , the steganographically encoded spectral information outputted by steganographic encode block  may be subjected to an inverse spectral transform . Inverse spectral transform  in this example may perform the inverse of the transform performed by step \u2014outputting a version of the digitized time domain signal shown in Graph A but now bearing the steganographically encoded information (Graph A). The digital control information steganographically encoded by block  may be substantially indelible and substantially invisible with respect to the Graph A signal\u2014that is, it may be very difficult to eliminate the steganographically encoded information and it may also be very difficult to discern it.","This signal may be further scrambled and\/or encrypted (e.g., based on a scrambling and\/or encryption key Key) before being converted to analog form (shown in Graph A) by a conventional digital-to-analog conversion block  (if necessary). Signal scrambling may be independent of steganographically encoded control information. For example, a good way to support existing devices is to not scramble the signal, and to use legislative means to ensure that each new device manufactured is equipped with rights management technology. Scrambling\/encrypting of content, can be used to enforce use of rights management. If legislative means can enforce the use of rights management technology, encryption or scrambling of content may not be necessary (although a decision to provide cryptographic protection for the control information is independent of this factor and must be evaluated in light of protecting the rights management system). Rights holders can choose an enticement technique(s) based on their business model(s). The benefit of scrambling is that it provides technical means for enforcing rights management. The benefit of unscrambled content is support of hundreds of millions of devices in the installed base\u2014with the promise that new devices (potentially including computers) will enforce the control information even though they don't \u201chave to\u201d from a technical perspective.","The resulting steganographically encoded information signal  may then be transmitted over an insecure communications channel. Digital-to-analog conversion step  may be omitted if a digital communications channel (e.g., an optical disk, a digital satellite link, etc.) is available to deliver the signal.",{"@attributes":{"id":"p-0104","num":"0152"},"figref":["FIG. 7B","FIG. 7A","FIG. 7B","FIG. 7A","FIG. 7A"],"b":["126","70","402","422","408","402","412","422","410"]},"The resulting digitized signal provided by  block \u2032 is spectrally transformed by step \u2032 (this may be the same spectral transform used in , block ) to yield a steganographically encoded spectral signal A. Steganographic decode block  may perform the inverse operation of the  steganographic encode block  based on the same steganographic key Key, (if a key-based steganographic encoding\/decoding transformation is used). The output of steganographic decode block  may be decrypted by block  (the inverse of  encrypt block  based on key Key) to provide recovered digital control information . The resulting control information  may be used for performing electronic rights management functions Required keys may be delivered in containers and\/or using the key distribution techniques and device initialization approaches disclosed in Ginter et al., for example.","In a further example shown in , steganographic encode block  may encode control information organizational structures such as secure containers (see Ginter et al.,  and associated text) during times when the content bandwidth is low relative to the total available bandwidth (see  regions II and IV), and may not attempt to encode such organizational structures during times when the content bandwidth is high relative to the total available bandwidth (see , regions I, III). In this way, steganographic encode block  may maximize the total bandwidth use without causing the steganographically encoded signal to exceed available bandwidth. As an optimization for certain applications, steganographic encode block  may encode \u201cpointers\u201d or other directional information into the information signal  during times when the content is such that it doesn't allow high data rate steganographic encoding of organizational structures . Multiple pointers and multiple \u201cpointed to\u201d locations can also help provide redundancy.","This particular  example involving steganographic encoding of pointers  may be especially suited for content delivery or presentation on random access storage media such as optical disks. Using such random access media, a content handling device may be able to rapidly \u201cseek\u201d to the place where an organizational structure is stored at a higher recorded bandwidth and then read the organizational structure at this higher bandwidth (See ). For these example arrangements, steganographic encode block  in this example encodes, during periods when the content is such that it is not possible to steganographically encode organizational structures, pointers  that direct the content handling device to one or more places where the organizational structure appears in the content stream. In one example, pointers  might encode the location(s) on a storage medium (e.g., an optical disk \u2014see ) at which the closest organizational structure is stored.","An optical disk player  with random access capability may \u201cseek\u201d to the place at which the closest organizational structure  is stored on the disk , and rapidly read the organizational structure off of the disk in less time than might be required to read an organizational structure that steganographic encode block  encodes at a lower data rate during times when the content bandwidth occupies most of the available channel bandwidth. In such arrangements, the process of reading a pointer , \u201cseeking\u201d to a position on the medium specified by the pointer, and then reading an organization structure  steganographically encoded at a high data rate may provide overall faster access times than if the organizational structure was itself encoded at a lower data rate within the parts of the information signal stream used in this example to encode only pointers.",{"@attributes":{"id":"p-0109","num":"0157"},"figref":["FIG. 11","FIG. 17"],"b":["136","136","136","136","136","136","136","136","136","136","136","136","136","136"],"i":["d ","e ","d ","f ","g ","x ","x ","x "]},{"@attributes":{"id":"p-0110","num":"0158"},"figref":["FIG. 12","FIGS. 9-15B"],"b":["100","102","124","200","202","204","124","138"]},"A main system bus  may couple rights management component  to a main system microprocessor  and various system components such as, for example, a CD-ROM decoder , a control and audio block , a video decoder , a digital output protection block , and a communications system . In this example, main microprocessor  controls the overall operations of appliance , with rights management component  performing security-related functions such as-rights management and steganographic decoding.","In the  example appliance , an optical pickup  reads information from optical disk  and provides it to RF amplifier . RF amplifier  provides its output to digital signal processor (DSP) , which processes the output in a conventional manner and also controls the orientation of the optical disk  relative to optical pickup  via a driver . DSP  coordinates with a conventional CD-ROM decoder  to provide decoded digitized video and audio information. Decoder  operates in conjunction with a buffer memory , and may also cooperate with cryptographic engine  to ensure that any encrypted video information is decrypted appropriately.","The video output of CD-ROM decoder  may be decompressed by MPEG-2 video decoder  and applied via an NTSC and\/or PAL encoder  to television . (In another example, the output could be in a non-interlaced format such as RGB rather than in interlaced formats such as NTSC and PAL.) Meanwhile, control and audio block  (which may operate in conjunction with its own buffer memory ) may receive digitized audio information recorded on optical disk  via DSP  and CD-ROM decoder . Control and audio block  may provide this audio output to audio processing block  for output to loudspeakers . Control and audio block  may also provide an interface to the user via an infrared sensor  (for a remote control, for example), front-panel user controls  and\/or an LED display .","In this example, security microprocessor  within rights management component  receives the digitized video and\/or audio that DSP  reads from optical disk  via pickup  and RF amp . Security microprocessor  steganographically decodes this digitized analog information signal to recover the digital control information  encoded onto the information signal. Security microprocessor  also performs rights management functions based on the digital control information  it recovers. In addition, if desired security microprocessor may remove the steganographic encoding from a received digitized analog signal (since it shares a secret such as the steganographic encoding key Key with the steganographic encoding point, it can remove the steganographic encoding) and\/or steganographically encode a signal with received, augmented and\/or new rights management control information.","In this example, microprocessor  may selectively control cryptography engine  to decrypt encrypted content provided by optical disk \u2014thus enforcing the rights management activities provided in accordance with electronic controls . Security component  may also control digital output protection block  in accordance with rights management control information \u2014thus, selectively permitting digital appliance  to output content in digital form. Rights management component  may take other steps (e.g., watermarking and\/or fingerprinting information before releasing it) to provide a degree of copy protection and\/or quality degradation to prevent or discourage someone from creating an unlimited number of high quality copies of the content of optical disk . Rules contained in the control information can also govern how other parts of the system behave. For example, the control information could specify that no sound can be played unless the content is paid for. Another property may specify that certain copy protection schemes should be turned on in the NTSC encoder. Still another might disable the digital outputs of the device altogether, or unless an additional fee is paid.","Rights management component  (protected processing environment ) may, in this particular example, communicate over a network  (such as, for example, the Internet or other data communications path) with other rights management related entities, such as, for example, clearinghouses and repositories. This \u201cback channel\u201d allows rights management component  to, for example, report usage and payment information and\/or to retrieve additional rights management control information  to augment or supplement the control information it steganographically decodes.",{"@attributes":{"id":"p-0117","num":"0165"},"figref":["FIG. 13","FIG. 13","FIG. 13","FIG. 13","FIG. 13","FIG. 13","FIG. 13","FIG. 13","FIG. 13"],"b":["138","200","300","138","126","302","138","310","304","306","138","308","310","126","302","302","138","312","314","13","302"]},"If protected processing environment  encounters a pointer (\u201cyes\u201d exit to decision block ), then the protected processing environment determines whether it already has received the corresponding organizational structure pointed to by the received pointer (, decision block ). The protected processing environment  retrieves the organizational structure if it does not already have it (, block )\u2014for example, by controlling DSP  to seek to the corresponding location on optical disk  indicated by the pointer, and by reading the organizational structure from the disk beginning at that disk location (, block ).","If protected processing environment  has received no organizational structures or pointers (\u201cno\u201d exits to each of decision blocks , , ), then the protected processing environment may determine whether there is any bandwidth available to carry control information. For example, some types of content stored on optical disk  may take up substantially all available channel bandwidths so that no bandwidth remains for steganographic encoding. If there is no available bandwidth for steganographic encoding (\u201cno\u201d exit to decision block ), then the protected processing environment  may return to the \u201capply rules\u201d block  and repeat steps - to wait until bandwidth is available for steganographic encoding. On the other hand, if there is bandwidth available and still no steganographically encoded information has appeared (\u201cyes\u201d exit to decision block , ), protected processing environment  performs an error handling routine that processes the exception (, block ) and determines whether the exception is critical (decision block ). In some cases, protected processing environment  will continue to allow the appliance  to process the content, finding the error to be non-critical (\u201cno\u201d exit to decision block ). An example of this would be a timer that permits playing for a period of time. In other cases (e.g., if the error conditions indicate that optical disk  has been tampered with), protected processing environment  may halt processing and return an error condition (\u201cyes\u201d exit to decision block , bubble ).",{"@attributes":{"id":"p-0120","num":"0168"},"figref":["FIG. 13A","FIG. 13","FIG. 13A","FIG. 13A","FIG. 13A","FIG. 13A"],"b":["302","138","104","330","138","330","332","138","330","334","334","138","336","138","334","338","138","338","340","138","338","342"]},"As mentioned above, protected processing environment  may also perform any or all of the  steganographic encoding steps, and may also or alternatively remove the steganographic encoding from a signal by using a shared secret to generate a steganographic encoding stream and then subtracting that stream from the signal. Such techniques may be useful, for example, to allow protected processing environment  to encode new control information or to change the encoded control information. For example, the steganographically encoded control information might provide a chain of handling and control that authorizes certain protected processing environments to change some elements and add new elements to the control information . Protected processing environment  could:\n\n",{"@attributes":{"id":"p-0122","num":"0174"},"figref":"FIG. 14","b":["100","424","406","100","900","406"]},"The  refresh operation could, for example, be performed on a selective basis based on the encoded digital control information itself For example, the control information might authorize appliance  to redistribute the content signal only under certain conditions\u2014one of which is to ensure that a refreshed steganographic encoding of the same (or modified) digital control information is provided within the redistributed content signal.",{"@attributes":{"id":"p-0124","num":"0176"},"figref":"FIG. 15A","b":["500","500","400","126","136","100","60","502","504","504","504","504","100","126"],"i":["b","c "]},"In this example, an example set top box user appliance  may receive the distributed steganographically encoded analog signal A\u2032. Set top box  may include a rights management component  as described above, and may perform rights management operations and\/or processes in response to and based on steganographically encoded control information .","Set top box  in this example may output the steganographically encoded analog signal (or a facsimile of it) to additional user electronic appliances such as, for example, a television set , a digital optical recording device (e.g., DVD-R) , and\/or a video tape recorder . Each of these additional appliances , ,  may include a rights management component  that performs electronic rights management based on the steganographically encoded control information . Any recordings made by recording devices ,  may also be steganographically encoded.",{"@attributes":{"id":"p-0127","num":"0179"},"figref":"FIG. 15B","b":["510","60","126","136","512","60","512","100","114","114","124","126","114","126","102","514","100","100","124","126","126","102","514","126"]},{"@attributes":{"id":"p-0128","num":"0180"},"figref":["FIG. 15C","FIG. 15A"],"b":["520","100","100","124","126","100","106","102","118","126","100","126","100","136","100","136","100","100","126","124","106","102","118"],"i":"a"},{"@attributes":{"id":"p-0129","num":"0181"},"figref":"FIG. 15D","b":["530","100","102","514","100","102","514","124","126","100","126"]},{"@attributes":{"id":"p-0130","num":"0182"},"figref":"FIG. 15E","b":["540","102","100","106","102","106","104","102","126","136","106","106","124","126","100","126","144","126","106"]},"In this example, digital television B includes an analog output that may provide analog television signals to additional devices, such as, for example, an analog video cassette recorder . In this example, the rights management component C within digital television B may steganographically encode the analog television signal A with controls  and associated organizational structure(s)  before releasing the analog signal to the outside world.",{"@attributes":{"id":"p-0132","num":"0184"},"figref":"FIG. 15F","b":["550","100","118","108","106","124","100","126","118","106","108"]},"While the invention has been described in connection with what is presently considered to be the most practical and preferred embodiment, it is to be understood that the invention is not to be limited to the disclosed embodiment, but on the contrary, is intended to cover various modifications and equivalent arrangements included within the spirit and scope of the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and other features and advantages provided by this invention may be better and more completely understood by referring to the following detailed description of presently preferred example embodiments in conjunction with the drawings, of which:",{"@attributes":{"id":"p-0036","num":"0055"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0037","num":"0056"},"figref":"FIGS. 1A-1E"},{"@attributes":{"id":"p-0038","num":"0057"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0039","num":"0058"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0040","num":"0059"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0041","num":"0060"},"figref":"FIGS. 5A-5D"},{"@attributes":{"id":"p-0042","num":"0061"},"figref":"FIGS. 5E-5F"},{"@attributes":{"id":"p-0043","num":"0062"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0044","num":"0063"},"figref":"FIG. 7A"},{"@attributes":{"id":"p-0045","num":"0064"},"figref":"FIG. 7B"},{"@attributes":{"id":"p-0046","num":"0065"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0047","num":"0066"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0048","num":"0067"},"figref":"FIGS. 10 and 10A"},{"@attributes":{"id":"p-0049","num":"0068"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0050","num":"0069"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0051","num":"0070"},"figref":["FIGS. 13 and 13A","FIG. 12"]},{"@attributes":{"id":"p-0052","num":"0071"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0053","num":"0072"},"figref":"FIGS. 15A-15F"}]},"DETDESC":[{},{}]}
