---
title: Apparatus for controlling image formation, computer readable device having stored thereon computer-executable instructions for forming images, and method of generating image formation setting information
abstract: A computer readable device has stored thereon computer-executable instructions that, when executed, cause a computer to function as a generation module, a setting module and a production module. The generation module is configured to generate a data structure including a first region storing a first image formation condition and a second region for storing location information representing a location of the second region and in which a second image formation condition is written by an application program based on the location information. The setting module is configured to set the first image formation condition in the first region based on the second image formation condition written in the second region by the application program. The production module is configured to produce image formation data based on the first image formation condition stored in the first region.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08625117&OS=08625117&RS=08625117
owner: Brother Kogyo Kabushiki Kaisha
number: 08625117
owner_city: Nagoya-shi, Aichi-ken
owner_country: JP
publication_date: 20110328
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATION","TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["The present application claims priority from Japanese Patent Application No. 2010-113466 filed on May 17, 2010. The entire content of this priority application is incorporated herein by reference.","The present disclosure relates to an apparatus for controlling image formation, a computer readable device having computer program product for forming images and a method of forming image formation setting information.","The Microsoft Windows (registered trademark) operating system provides an image formation system in which the printing condition determined according to an application program or a printer driver is stored as binary-type print setting information that is a DEVMODE data structure.",{"@attributes":{"id":"p-0005","num":"0004"},"figref":"FIG. 10"},"The Private region stores print conditions related to print functions that are unique to each printer. The specification for the Private region is unique to each developer of the printer drivers. Since the specification for the Private region is not open, the print conditions stored in the Private region cannot be changed by the user through the application program.","However, the user may wish to change the print conditions stored in the Private region through the application program. In such a case, an expanding API (Application Programming Interface) is implemented in the printer driver to change the print condition stored in the Private region through the application program, and the application program calls the expanding API to change the print condition.","However, when the application program calls the expanding API to change the print condition, following problems occur.","The OS includes a 32-bit OS that handles 32-bit data and a 64-bit OS that handles 64-bit data. Similarly, the printer driver includes a 32-bit driver that handles 32-bit data and a 64-bit driver that handles 64-bit data. Only the 32-bit driver can be used on the 32-bit OS and only the 64-bit driver can used on the 64-bit OS.","Similarly, the application program includes a 32-bit application that handles 32-bit data and a 64-bit application that handles 64-bit data. Only the 32-bit application can be operated on the 32-bit OS. However, both of the 32-bit application and the 64-bit application can be operated on the 64-bit OS.","The 32-bit application cannot call the expanding API that is implemented in the 64-bit driver. Therefore, the 32-bit application that is operated on the 64-bit OS cannot change the print condition stored in the Private region.","According to an aspect of the present invention, a computer readable device has stored thereon computer-executable instructions that, when executed, cause a computer to function as a generation module, a setting module and a production module. The generation module is configured to generate a data structure including a first region storing a first image formation condition and a second region for storing location information representing a location of the second region and in which a second image formation condition is written by an application program based on the location information. The setting module is configured to set the first image formation condition in the first region based on the second image formation condition written in the second region by the application program. The production module is configured to produce image formation data based on the first image formation condition stored in the first region.","<Illustrative Aspect>","An illustrative aspect of the present invention will be hereinafter explained with reference to .","(1) Structure of Computer","An electrical configuration of a computer  (hereinafter referred to as a PC) will be explained with reference to . The PC  includes a CPU , a ROM , a RAM , a storing section , a display drive circuit , and a USB interface (USB I\/F) .","The CPU  executes various programs stored in the ROM  and the storing section  and controls each component in the PC . The ROM  stores various programs that are executed by the CPU  and data. The RAM  is a main memory that is used when the CPU  executes various processes.","The storing section  is an external memory for storing various programs and data using a non-volatile storing medium such as a hard drive or a flash memory. The storing section  stores an operating system (OS), print programs such as an image forming program. The Microsoft Windows (registered trademark) operating system is used in the illustrative aspect as an example.","The display drive circuit  is a circuit that drives a display device  such as a CRT and a liquid crystal display and connected to the display device  via a cable.","The USB interface  is provided as a USB (Universal Serial Bus) host interface and connected to devices via a USB cable. The devices include the printer  and an input device  such as a mouse and a keyboard.","The printer  forms images on a recording medium such as a paper by an electrophotographic method or an ink jet method. The printer  may be connected to the PC  via the communication network such as LAN.","Logical Structure of Print Program","A logical structure of a print program will be explained with reference to . The print program  includes a printer driver  and an application program  (hereinafter referred to as an application). Data representing a print condition is passed between the printer driver  and the application  with using a DEVMODE data structure .","Various commands output from the application  to the printer driver  is transmitted to the printer driver  via an API that is provided by the OS. The various commands include a print command such as a GDI command or a command for setting a setting value in the Private region or the Public region based on the print condition that is written in a passing region  (see ).","(2-1) DEVMODE Data Structure","A structure of a DEVMODE data structure will be explained with reference to . The DEVMODE data structure  is configured by a Public region  and a Private region .","The Public region  stores information relating to the DEVMODE data structure itself such as a size of the DEVMODE data structure and also stores setting values for print setting items relating to basic print functions that are common to a plurality of printer types such as a paper size, the number of copies, print quality, color printing and two-sided printing. A specification of the Public region  is determined by Microsoft and therefore the developer of a printer driver cannot set a new item in the Public region .","The Private region  stores setting values for print setting items relating to print functions unique to the printer  such as borderless printing, plural pages on one side and a margin size. A specification of the Private region  is unique to a developer of the printer driver, and the specification of the Private region  is not usually open. Therefore, the print condition stored in the Private region  cannot be changed through the application .","The DEVMODE data structure  of the illustrative aspect is different from the conventional DEVMODE data structure in  in that the passing region  is provided in the Private region .","The passing region  is used to change the setting value of a part of the print setting items stored in the Private region  from the application . In the illustrative aspect, the setting value of \u201cborderless printing\u201d is changed.","The passing region  is used to notify the application  if the printer has a specific print function. In the illustrative aspect, the application  is notified if the printer has a two-sided printing function.","The passing region  is also used when the setting value that is stored in the Public region  is not wanted to be changed directly from the application . In such a case, the setting value stored in the Public region  is written in the passing region  from the application  and then, a setting value is set in the Public region  based on the setting value written in the passing region  by the printer driver . That is, the setting value in the Public region  is determined with reference to the setting value in the passing region .","When the setting value of \u201ctwo-sided printing\u201d stored in the Public region  is wanted to be changed in relation to the setting value of \u201cmargin size\u201d stored in the Private region , the following process is executed. Specifically, when the two-sided printing is executed for a postcard-size paper, the margin size is set to 0 mm.","In such a case, the application  writes the setting value of \u201ctwo-sided printing\u201d in the passing region  so that the printer driver  can change the setting values of \u201ctwo-sided printing\u201d and \u201cmargin size\u201d in relation to each other.","Location information of the passing region is stored at the end of the DEVMODE data structure . The application  acquires the end address of the DEVMODE data structure  from the size of the DEVMODE data structure stored in the Public region . The application  reads the location information of the passing region from the end address of the DEVMODE data structure  to access the passing region .","The passing region  stores values of four items including an input value , an input value , an output value  and an output value .","The values stored in each input value and output value will be explained with reference to .","The input value  is an item in which the application  writes the setting value of \u201ctwo-sided printing\u201d. One of the setting values of \u201cno change\u201d, \u201cexecution of two-sided printing\u201d and \u201cno-execution of two-sided printing\u201d is written in the input value .","The input value  is an item in which the application  writes the setting value of \u201cborderless printing\u201d. One of the setting values of \u201cno change\u201d, \u201cexecution of borderless printing\u201d and \u201cno-execution of borderless printing\u201d is written in the input value .","The input values are not limited to the setting values of \u201ctwo-sided printing\u201d and \u201cborderless printing\u201d but may be the setting values of other print functions if the print functions are allowed to be changed from the application. The number of items stored in the passing region  is not limited to two but may be arbitrarily determined.","The output value  is an item in which the printer driver  writes the print function information representing if the printer  is provided with a specific print function. In the illustrative aspect, the print function information represents if the printer  is provided with the two-sided printing function. If the printer  is provided with the two-sided printing function, \u201cyes\u201d is written in the output value  and if the printer  is not provided with the two-sided printing function, \u201cno\u201d is written therein. The specific print function is not limited to the two-sided printing function but may be other function if the function is provided in the printer. The number of specific print function stored in the passing region  is not limited to one.","The output value  is an item in which a determination result is written. The determination result is obtained when the printer driver  determines if the setting value in the input value  or the input value  is effective based on the setting values in the input value  or  and the print function of the printer. Details will be described later. The determination result is not always successful but may be false. If the determination result is successful, \u201ceffective\u201d is written in the output value . If the determination result is false, \u201cineffective\u201d is written therein.","(2-2) Logical Configuration of Printer Driver","The printer driver  includes a generation module , a storing module , a setting module , a producing module and a print function information writing module , as illustrated in .","The generation module is executed to generate the DEVMODE data structure . Specifically, the generation module obtains an instance of the DEVMODE data structure (hereinafter simply referred to as a DEMVODE data structure) in the RAM  according to a definition code of the DEVMODE data structure.","The storing module stores setting values of each print setting item in the Public region  and the Private region  of the DEVMODE data structure . Specifically, when the generation module generates the DEVMODE data structure , the storing module stores a predetermined default value in each print setting item of the generated DEVMODE data structure .","The application  can call the storing module of the printer driver  from an application print setting screen  (see ). The storing module that is called by the application  displays a driver print setting screen for setting a print condition. On the driver print setting screen, the setting values stored in the Private region  can be changed.","The setting module sets the setting values of the print condition stored in the Public region  and the Private region  based on the setting values of each print setting item that are written in the passing region  by the application .","The producing module produces image formation data based on a print command output by the application , the print condition stored in the Public region  and the print condition stored in the Private region  and outputs the produced image formation data to the printer .","The print function information writing module writes print function information that represents if the printer  is provided with a specific print function in the output value  of the passing region . In this illustrative aspect, the print function information writing module writes in the output value  the print function information that represents if the printer  is provided with a two-sided printing function.","(2-3) Logical Configuration of Application Program","As described above, the setting values stored in the Private region  can be changed on the driver print setting screen. However, in such a case, a user is required to call the driver print setting screen from the application print setting screen . This increases the number of operations and this may be inconvenient to some users.","According to the illustrative aspect, the application  can change the setting values of the print setting items stored in the Public region  and also the setting values of some of the print setting items stored in the Private region  without calling the driver print setting screen. Specifically, the application  can change the setting value of \u201cborderless printing\u201d stored in the Private region  without calling the driver print setting screen.","The application  includes an application module and an access module ","The application module includes a word processing software, a spreadsheet software, an image editing software and the like.","The access module reads the values from the output value  and the output value  of the passing region  and writes the setting values in the input value  \u201ctwo-sided printing\u201d and in the input value  \u201cborderless printing\u201d. Specifically, the access module displays the application print setting screen  on the display device  and writes in the input value  and the input value  of the passing region  the values that are set by a user from the application print setting screen . In this displaying process, the access module reads the values from the output value  and the output value  to control the display.","(3) Display Process of Application Print Setting Screen","The display process of the application print setting screen  will be explained with reference to . For easy understanding, three print setting items of \u201cpaper size\u201d, \u201ctwo-sided printing\u201d and \u201cborderless printing\u201d will be explained.","A print paper size is selected in a paper size field . If a user selects a paper size in the paper size filed , the selected paper size is stored in the \u201cpaper size\u201d of the Public region  by the application .","A two-sided printing field is used for selecting the two-sided printing. If a user selects executing the two-sided printing, a checkbox for the two-sided printing is checked. If a user selects not executing the two-sided printing, the checkbox is cleared.","The borderless printing is selected in a borderless printing field . If a user selects executing the borderless printing, a checkbox for the borderless printing is checked. If a user selects not executing the borderless printing, the checkbox is cleared.","A property button is used to call the driver print setting screen.","An OK button is used when a user orders execution of printing. If a user clicks the OK button , the application  outputs a print command for printing a print object page to the printer driver  via an API provided by the OS. When receiving the print command, the printer driver  produces print data based on the print command, the print condition stored in the Public region  and the print condition stored in the Private region , and transmits the produced print data to the printer .","The two-sided printing field is displayed on the application print setting screen  in . When displaying the application print setting screen , the application  confirms if the printer  is provided with the two-sided printing function. If the application  determines that the printer  does not have capability of the two-sided printing function, the two-sided printing field is not displayed. The borderless printing field may always be displayed. Hereinafter, the display process of the application print setting screen  will be explained.","A flow of the display process of the application print setting screen  will be explained with reference to .","If a user selects \u201cprint\u201d from a menu displayed by the application , the application  requests the printer driver  via the OS to acquire a pointer of the DEVMODE data structure . The pointer represents an address on a memory.","The printer driver  that is requested to provide the pointer generates the DEVMODE data structure  and stores predetermined default values therein. The printer driver  returns the pointer of the DEVMODE data structure  to the application  as a return value. \u201cNo change\u201d is set in the input value  and the input value  as default values and no value is set in the output value  and the output value .","If the pointer of the DEVMODE data structure  is returned to the application  from the printer driver , the following display process starts.","Hereinafter, the CPU  that executes the application  will be referred to as the application . The CPU  that executes the printer driver  will be referred to as the printer driver . At step S, the application  reads the location information of the passing region from the end of the DEVMODE data structure . Thus, the application  reads the location information of the passing region to specify the location of the passing region . Therefore, even if the passing region  is provided in the Private region , the application  can read and write data from\/in the passing region . The end address of the DEVMODE data structure  can be specified by the size of the DEVMODE data structure stored in the Public region () and a beginning address of the DEVMODE data structure.","At step S, the application  calls Document Properties Function that is an API provided by the OS. Then, the OS calls Dry Document Properties Function that is provided by the printer driver . When the Dry Document Properties Function is called, the printer driver  executes a setting process. Details will be described later. In the setting process, the printer driver  writes in the output value  of the DEVMODE data structure  the data representing if the printer  is capable of the two-sided printing function.","At step S, the application  reads from the passing region  the value of the output value  that represents if the printer  is capable of the two-sided printing function.","At step S, the application  determines if the printer  is capable of the two-sided printing function based on the value of the output value . If the determination is affirmative, the process proceeds to step S. If the determination is negative, the process proceeds to step S.","At step S, the application  displays the application print setting screen  and also displays the two-sided printing field thereon.","At step S, the application  displays the application print setting screen  and does not display the two-sided printing field thereon.","(4) Change of Print Condition from Application Program","A process flow for changing the print condition from the application  will be explained with reference to . In the illustrative aspect, the printer  is capable of the two-sided printing function and a user changes the setting value of the \u201ctwo-sided printing\u201d on the application print setting screen . The similar process is executed when a user changes the setting value of the \u201cborderless printing\u201d. This process is started when a user checks the checkbox for the two-sided printing field on the application print setting screen  or when a user clears the checkbox for the two-sided printing field ","At step S, the application  reads the location information of the passing region from the end of the DEVMODE data structure .","At step S, according to the operation by the user, the application  writes the setting value in the input value  of the passing region  that represents if the two-sided printing is executed.","Specifically, for example, if a user clicks the empty checkbox, the checkbox is now checked and the application  writes \u201cexecution of two-sided printing\u201d in the input value . On the other hand, if a user clicks the checked checkbox, the checkbox is now cleared and the application  writes \u201cno-execution of two-sided printing\u201d in the input value .","At step S, the application  calls the Document Properties Function. When the Document Properties Function is called, the printer driver  executes the setting process. Details will be described later. In the setting process, the printer driver  determines if the value written in the input value  is effective and writes the determination result in the output value  of the passing region . The printer driver  sets the setting values in the Public region  and the Private region  based on the determination result.","At step , the application  reads the value of the output value  from the passing region  that represents if the determination result is successful or false.","If the determination result is successful at step S, the process proceeds to step S and if the determination result is false, the process proceeds to step S.","At step S, the application  updates the display of the application print setting screen . Specifically, if the check mark is not displayed in the checkbox of the two-sided printing field , the application  displays the check mark therein. If the check mark is displayed in the checkbox of the two-sided printing field , the checkbox is cleared.","At step S, the application  informs a user that the setting value input by a user is ineffective. For example, an error message of \u201cselected setting is unavailable\u201d is displayed on the display device . If the setting value input by a user is ineffective, the check mark is not displayed in the checkbox of the two-sided printing field even if the user checks the checkbox at the beginning of this process.","(5) Setting Process","A flow of the setting process executed in step S and step S will be explained with reference to .","At step S, the printer driver  reads the location information of the passing region from the end of the DEVMODE data structure .","In the processes of the steps S to S, the setting value representing if the printer  is capable of the two-sided printing function is written in the output value  of the DEVMODE data structure .","At step S, the printer driver  determines if the printer  is capable of with the two-sided printing function. If the determination is affirmative, the process proceeds to step S. If the determination is negative, the process proceeds to step S.","The printer driver  is programmed for each type of printers  and has information of printing functions of the printer  acceptable for the printer driver .","At step S, the printer driver  writes \u201cYes\u201d in the output value  of the passing region .","At step S, the printer driver  writes \u201cNo\u201d in the output value  of the passing region .","In the steps S to S, based on the setting value written in the input value  and the setting value written in the input value , it is determined if the setting values are \u201ceffective\u201d, and the determination result is written in the output value  of the passing region .","At step S, the printer driver  writes in the output value  of the passing region  \u201ceffective\u201d as an initial value of the determination result.","At step S, the printer driver  reads from the passing region  the setting value of the input value  that represents if the two-sided printing is executed.","At step S, if the setting value of the input value  is \u201cno-execution of two-sided printing\u201d, the process proceeds to step S. If the setting value of the input value  is \u201cexecution of two-sided printing\u201d, the process proceeds to step S. If the setting value of the input value  is \u201cno change\u201d, nothing is executed and the process proceeds to step S.","In the following case, \u201cno change\u201d is set in the input value . The setting process is called every time when an operation is executed for the two-sided printing field and for the borderless printing field . Therefore, if an operation is executed for the borderless printing field first, \u201cno change\u201d that is a default value is set in the input value . If \u201cno change\u201d is set in the input value , the processes of steps S to S are not necessary. Therefore, the printer driver  skips the processes of steps S to S and proceeds to step S.","At step S, the printer driver  writes \u201cno-execution of two-sided printing\u201d in the \u201ctwo-sided printing\u201d of the Public region .","At step S, the printer driver  determines if the printer  is capable of the two-sided printing function. If the determination is affirmative, the process proceeds to step S. If the determination is negative, the process proceeds to step S.","It is determined if the printer  is capable of the two-sided printing function at step S due to the following reasons.","If the printer  is not capable of the two-sided printing function, the two-sided printing field is not displayed at step S in the display process. Therefore, a user cannot check or clear the checkbox of the two-sided printing field , and the value of the input value  is supposed to be \u201cno change\u201d. Therefore, if the printer  is not capable of the two-sided printing function, the process does not proceed to step S. However, some application may display the two-sided printing filed on the application print setting screen  without confirming if the printer is capable of the two-sided printing function. Such application may display the two-sided printing field on the application print setting screen  although the printer  is not capable of the two-sided printing function, and a user may select execution of the two-sided printing. Accordingly, \u201cexecution of two-sided printing\u201d is set in the input value . Therefore, the printer driver  reconfirms if the printer is capable of the two-sided printing function at step S.","At step , it is determined if the printer  is capable of the two-sided printing function and also determined if the set paper size is acceptable for the two-sided printing. Some of paper sizes may not be acceptable for the two-sided printing. For example, \u201cpostcard\u201d or \u201cA4\u201d may be acceptable and \u201cA3\u201d may not be acceptable for the two-sided printing. In such a case, if the printer  is capable of the two-sided printing function and the paper size stored in the \u201cpaper size\u201d of the Public region  is \u201cpostcard\u201d or \u201cA4\u201d, it may be determined that the printer  is capable of the two-sided printing function.","At step S, the printer driver  determines that the setting value of the input value  is an effective print condition and writes \u201cexecution of two-sided printing\u201d in the \u201ctwo-sided printing\u201d of the public region . \u201cEffective\u201d is set in the output value  as a default value of the determination result at step S.","Then, the printer driver  determines if the paper size stored in the \u201cpaper size\u201d of the Public region  is \u201cpostcard\u201d. If determined that the paper size is \u201cpostcard\u201d, the printer driver  writes \u201c0 mm\u201d in the \u201cmargin size\u201d of the Private region .","At step S, the printer driver  determines that the setting value of the input value is not an effective print condition and writes \u201cineffective\u201d in the output value  of the passing region  as a determination result.","Since the setting value relating to the input value  is set in the Public region  or the Private region  based on the setting values of the input value , the output value  and the output value , the printer driver  returns the setting value in the input value  to \u201cno change\u201d at step S.","At step S, the printer driver  reads the setting value in the input value  of the passing region .","At step S, if the setting value in the input value  is \u201cno-execution of borderless printing\u201d, the process proceeds to step S. If the setting value in the input value  is \u201cexecution of borderless printing\u201d, the process proceeds to step S. If the setting value in the input value  is \u201cno change\u201d, nothing is executed and the process proceeds to step S.","At step S, the printer driver  writes in the \u201cborderless printing\u201d of the Private region  \u201cno-execution of borderless printing\u201d.","At step S, the printer driver  determines if the printer  is capable of the borderless printing function. If the determination is affirmative, the process proceeds to step S. If the determination is negative, the process proceeds to step S.","At step S, it is determined if the printer  is capable of the borderless printing function and also determined if the set paper size is acceptable for the borderless printing. Some print sizes may not be acceptable for the borderless printing. For example, \u201cA4\u201d may be acceptable for the borderless printing and \u201cA3\u201d may not be acceptable. Therefore, if the printer  is capable the borderless printing function and the paper size stored in the \u201cpaper size\u201d of the Public region  is \u201cA4\u201d, it may be determined that the printer  is capable of the borderless printing function.","At step S, the printer driver  determines that the setting value in the input value  is an effective print condition and writes \u201cexecution of borderless printing\u201d in the \u201cborderless printing\u201d of the Private region . \u201cEffective\u201d is set in the output value  as the default value at step S.","At step S, the printer driver  determines that the setting value in the input value  is not an effective print condition and writes \u201cineffective\u201d in the output value  of the passing region  as a reflected result.","Since the setting value relating to the input value  is set in the Public region  or the Private region  based on the setting values of the input value  and the output value , the printer driver  returns the setting value in the input value  of the passing region  to \u201cno change\u201d at step S.","At step S, the printer driver  determines if the value in the output value  of the passing region  that represents a determination result is successful or false. If the determination result is false, the process proceeds to step S. If the determination result is successful, the process is terminated.","At step S, the printer driver  returns the setting values set in the regions other than the passing region  in this process to original values.","In the illustrative aspect, it is determined if the setting value written in the input value  or the input value  by the application  is effective or not. If it is available, the setting value is written in the Private region . If it is unavailable, the setting value is not written in the Private region . However, the setting value written in the input value  or the input value  by the application may be set in the Private region  without determining if the setting value is effective or not.","For example, if the setting value is validated by the application  so that only an effective setting value is written in the Private region , the printer driver  may write the setting value in the Private region  without determining if the setting value is effective or not.","(6) Effects of Illustrative Aspect","The specification for the private region  is not open to public and therefore the print condition stored in the Private region  may not be changed through the application . According to the printer driver  of the illustrative aspect, the application  writes the print condition in the input value  and the input value  of the passing region , and the application  can change the print condition stored in the Private region .","Specifically, after the application  writes the input value in the passing region , the application  calls the Document Properties Function, that is an API provided by the OS, at step S. This makes the printer driver  execute the setting process for the input value written in the passing region .","Therefore, according to the printer driver , the printer driver  is not required to implement the API to change the print condition stored in the Private region  through the application , and the print condition can be changed through the application . Accordingly, even if the 32-bit application is operated on the 64-bit OS, the print condition stored in the Private region  can be changed.","Further, according to the printer driver , since the passing region  is provided in the Private region , the region in which the application writes a print condition is provided in the DEVMODE data structure .","Further, according to the printer driver , if the print condition written in the passing region  is related to both of the print condition stored in the Public region  and the print condition stored in the Private region , the setting values of the print condition stored in the Private region  and the Public region  are set based on the print condition written in the passing region . Therefore, this reduces inconsistency or mismatch between the print condition stored in the Private region  and the print condition stored in the Public region .","Further, according to the printer driver , it is determined if the print condition written in the passing region  by the application  is an effective print condition. If it is determined that the print condition is an effective print condition, the setting values are set in the Private region  and the Public region  based on the effective print condition, and the determination result representing that the determination result is successful is written in the passing region . If it is determined that the print condition is not an effective print condition, the determination result representing that the determination result is false is written in the passing region . Therefore, application  can be informed if the print condition written in the passing region  is effective or ineffective.","Further, according to the printer driver , the print function information representing if the printer  is capable of the two-sided printing function is written in the output value  of the passing region . Therefore, the application  can be informed if the printer  is capable of the two-sided printing function.","Further, according to the printer driver , the location information representing the location of the passing region  in the DEVMODE data structure  is described at the end of the DEVMODE data structure . Therefore, the application  reads the location information from the end of the DEVMODE data structure  so as to be able to know the location of the passing region .","Further, according to the print program , the application  reads the value in the output value  of the passing region. If the printer  is capable of the two-sided printing function, the application print setting screen  is displayed. A user sets the print condition related to the two-sided printing function from the application print setting screen .","<Other Illustrative Aspects>","The scope of the present invention is not limited to the aspects explained in the above description made with reference to the drawings. The following aspects may be included in the technical scope of the present invention.","(1) The setting value only in the Public region  may be set based on the setting value written in the passing region .","Although the setting value for the print quality is stored in the Public region , the setting value for the print quality may not be desired to be changed through the application  due to the relation to the setting value in other print setting item. In such a case, the input value in which a setting value for the print quality is written by the application  may be provided in the passing region , and the setting value in the \u201cprint quality\u201d in the Public region  may be set based on the setting value written in the input value by the printer driver .","In case of setting the setting value only in the Public region  based on the setting value written in the passing region , the Public region  corresponds to an example of the first region. In such a case, the passing region  that corresponds to the second region is not provided in the first region.","(2) In the above illustrative aspect, a printing operation is explained as an example of the image formation. Display of a print preview on the display device  may be an example of the image formation.","(3) In the above illustrative aspects, the print conditions stored in the Public region  and the Private region  are changed from the application . However, if the default value is not set in the DEVMODE data structure, the setting value is not changed but may be newly stored in the Public region  and the Private region ","(4) In the above illustrative aspects, the print program  including the printer driver  and the application program  is executed by the CPU . However, each of the printer driver  and the application program  may be executed by an independent CPU. Further, each of the modules of the printer driver  and the application program  may be executed by an independent CPU."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Illustrative aspects in accordance with the present invention will be described in detail with reference to the following drawings wherein:",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 10"}]},"DETDESC":[{},{}]}
