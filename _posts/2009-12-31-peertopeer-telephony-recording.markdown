---
title: Peer-to-peer telephony recording
abstract: System and method for recording communication sessions in a peer-to-peer communication networks. End-devices of the peer to peer communication network may register with a selected super-node that may fork media to a recording system for recording. Communication sessions arriving at a call center may be transferred between the external end-device and the target agent end-device via a recorder and the communication session media may be recorded. Alternatively, a conference call may be established between an external end-device, a target agent end-device of a call center and a recorder over a peer-to-peer communication network. After the conference call is established, the recorder may receive media transferred between the external end-device and the target agent end-device and record that media.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08380872&OS=08380872&RS=08380872
owner: Nice Systems Ltd.
number: 08380872
owner_city: Raanana
owner_country: IL
publication_date: 20091231
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","DETAILED DESCRIPTION OF THE PRESENT INVENTION"],"p":["Recording has become a key feature of modern interaction-related environments and\/or systems. For example, systems used for operating call centers, banks, academic institutions, government agencies, health care facilities and\/or web based shopping may all comprise some form of recording capacities and\/or systems. Interactions involving customers, clients, constituents or any other users associated with various respective industries, organizations and companies may all be recorded or may be selectively recorded according to various criteria. Recording of calls or communication sessions may be mandatory for some organizations, used as voice receipt or used for tracking, logging or other purposes.","Recording of calls may be performed at the end-devices. For example, in a peer-to-peer network, a computer application may record communication sessions using a recording agent for capturing communication sessions signaling and communication sessions media. However, such solutions may not be available or feasible for various scenarios as they may require installation of additional hardware or software on each endpoint that needs to be recorded. Additionally, recording at the endpoints may be highly distributed, which may cause central management of recording to be difficult or cumbersome. Recording at the endpoint may not be applicable for compliance requirements. For example, recording at the endpoint may not comply with the law or may be objected due to privacy issues.","It will be appreciated that for simplicity and clarity of illustration, elements shown in the figures have not necessarily been drawn to scale. For example, the dimensions of some of the elements may be exaggerated relative to other elements for clarity. Further, where considered appropriate, reference numerals may be repeated among the figures to indicate corresponding or analogous elements.","In the following detailed description, numerous specific details are set forth in order to provide a thorough understanding of the invention. However, it will be understood by those skilled in the art that the present invention may be practiced without these specific details. In other instances, well-known methods, procedures, and components have not been described in detail so as not to obscure the present invention.","Although embodiments of the invention are not limited in this regard, discussions utilizing terms such as, for example, \u201cprocessing,\u201d \u201ccomputing,\u201d \u201ccalculating,\u201d \u201cdetermining,\u201d \u201cestablishing\u201d, \u201canalyzing\u201d, \u201cchecking\u201d, or the like, may refer to operation(s) and\/or process(es) of a computer, a computing platform, a computing system, or other electronic computing device, that manipulate and\/or transform data represented as physical (e.g., electronic) quantities within the computer's registers and\/or memories into other data similarly represented as physical quantities within the computer's registers and\/or memories or other information storage medium that may store instructions to perform operations and\/or processes.","Although embodiments of the invention are not limited in this regard, the terms \u201cplurality\u201d and \u201ca plurality\u201d as used herein may include, for example, \u201cmultiple\u201d or \u201ctwo or more\u201d. The terms \u201cplurality\u201d or \u201ca plurality\u201d may be used throughout the specification to describe two or more components, devices, elements, units, parameters, or the like. Unless explicitly stated, the method embodiments described herein are not constrained to a particular order or sequence. Additionally, some of the described method embodiments or elements thereof can occur or be performed at the same point in time.","Reference is made to  depicting a high-level diagram of an exemplary peer-to-peer communication network  according to embodiments of the invention. According to embodiments of the invention, system  may comprise a plurality of end-devices  and super-nodes , an authentication server  and a recording system .","Peer-to-peer communication network  may be any distributed network architecture composed of participants such as end-devices  and super-nodes  that make a portion of their resources such as processing power, disk storage or network bandwidth directly available to other network participants, without the need for central coordination instances such as servers or stable hosts. Network  may be, for example, a packet based peer-to-peer communication network. Peer-to-peer communication network  may utilize Voice over Internet Protocol (VoIP) technology to establish telephone sessions or calls between end-devices . Peer-to-peer communication network  may comprise infrastructure nodes such as super-nodes  to perform infrastructure related tasks. Typically, end-devices  may be connected to a super-node  and each such end-device  may register itself with authentication server . For example, super-nodes  may function as proxy servers and subgroups of end-devices  may connect to a single super-node  in a star-like fashion. End devices  may communicate by passing media and signaling related to a communication sessions through super-nodes .","End-device  may be any device that can originate or receive a communication session in the peer-to peer communication network . For example, end-devices may be dedicated VoIP phones which are phones that allow VoIP calls without the use of a computer, VoIP-capable computers, routers, and gateways within the peer-to-peer communication network  or plain old telephone service (POTS) dial peers such as phone sets, cell phones, and fax machines, connected to peer-to-peer communication network  through an adaptor such as an Analog Telephone Adapter (ATA). Additionally, end-device  may be coupled to an automatic call distributor (ACD) of a call center and\/or to an interactive voice response (IVR) sub-system.","An IVR sub-system may perform an initial interaction with incoming communication sessions. For example, an IVR sub-system may gather information pertaining to an incoming communication session. Such information may be, for example, a caller identification (CID). An IVR sub-system may further provide a voice-menu in order to prompt a caller to provide further information pertaining to the communication session and\/or the caller. An ACD sub-system may select one of agents  to handle an incoming communication session and may further forward a communication session to the selected agent.","It will be noted that although a communication session enabling two or more humans or other entities (e.g., a human caller and an IVR application) to communicate will typically be referred to hereinafter as a communication session, the term \u201ccommunication session\u201d should be expansively and broadly construed to include any applicable session or interaction. A communication session may be a telephony session, an instant massaging session, a video session, a chat session, a web co-browsing session or any other applicable type of multi-media interaction. Web co-browsing session, also referred to as collaborative browsing may refer to several people accessing the same web pages at the same time. For example, web co-browsing may be used by call center agents to assist clients navigate the company web site. A communication session may be, for example, a telephone call carried over a packet based network, such as voice or voice, video and other data over Internet Protocol (VoIP) session. A communication session data may be divided to the communication session signaling which is the traffic used to establish the connection, and to the media which is voice, video or any other type of information that is transferred between end-devices  in the communication session.","Accordingly, recording a communication session media may comprise recording any applicable information, e.g., audio, video, text etc it will further be noted that a caller or end user may be any applicable entity, e.g., a user, a customer or client, or an organization such as academic institution, a government agency, a service provider or a call center providing services to, or acting as a front end for a business, a company, an institution or any other applicable organization.","According to embodiments of the invention, system  may additionally comprise recording super-nodes . Recording super-nodes  may have super-nodes capabilities and, in addition, function as dedicated recording servers. Once a communication session is established, recording super-nodes  may fork media associated with the communication session to recording system , which may record the communication session. The term \u201cfork\u201d may be used throughout the specification to describe the process of creating duplicate of media of a communication session to be sent to a destination other than the destination of the respective communication session. For example, recording super-nodes  may transfer media between the communication session endpoints , create duplicate of this media and send the duplicate to recording system .","According to embodiments of the invention, recording super-node  may be assigned to end-devices  that need to be recorded, and end-devices  that need to be recorded may register with recording super-node . For example, end-devices  that need to be recorded may receive an instruction to register with a recording super-node  from authentication server  on end-device  login. Additionally, end-devices  that need to be recorded may receive a list of recording super-nodes  to register with from authentication server  on end-device  login.","According to embodiments of the invention, associating end-devices  to a recording super-node  may be based on static entries in authentication server  recording database. Upon an end-device  login, authentication server  may retrieve the address of recording super-node  from the recording database, in case end-device  needs to be recorded, and return the address of recording super-node  to end-device ","Alternatively, authentication server  may be in communication with recording system . Upon an end-device  login, authentication server  may provide the identity of end-device  to recording system  together with a query whether end-device  should be recorded. Recording system  may decide whether end-device  should be recorded. If end-device  should be recorded, recording system  may choose the recording super-node  and may provide the address of the chosen recording super-node  to authentication server , which may provide that address to end-device . End-device  may then send a request to register with the selected recording super-node . Alternatively, other suitable protocols may be used to assign end-devices  to recording super-nodes . Authentication server  may communicate with recording system  utilizing Web Services (WS) standard for inter-system communication. Alternatively, other suitable communication protocols may be used.","According to embodiments of the invention, multiple recording super-nodes  may be deployed in a network together with load balancing application that may distribute communication traffic among recording super-nodes . Redundancy may be implemented by coupling two recording super-nodes  in an active\/standby mode.","According to embodiments of the invention, any super-node  may be used as a recording super-node. Super-nodes  may have the address of recording system . For example, super-nodes  may learn the address of recording system  from authentication server . The address of recording system  may be either statically configured in authentication server  database, or can be learned by authentication server  from an external source such as a load balancing service, another server, some global public directory, the Active Directory by Microsoft, etc. End-devices  may register with any one of super-nodes . Super-node  may establish an auxiliary session with recording system  for reporting communication session or call events. For example, super-node  may communicate with recording system  using NICE\u00ae Distributed Interaction Metadata Messages (IMM) protocol over Session Initiation Protocol (SIP) transport, as described in US patent application publication No 2007\\0019634 which is hereby incorporated by reference in its entirety. Alternatively, other communication protocols suitable for metadata delivery such as Hypertext Transfer Protocol (HTTP) or WS may be used.","After a communication session is established with end-device  through super-node , super-node  reports the communication session event to recording system  over the auxiliary session. Recording system  may determine whether the communication session should be recorded. If the communication session should be recorded, recording system  may issue a recording request to super-node . For example, recording system  may establish SIP session with super-node  instructing it to fork communication session media associated with the communication session to recording system . Super-node  may then start forking the communication session traffic to recording system . When the communication session ends, super-node  may report a communication session end event to recording system  and recording system  may than terminate the recording. According to embodiments of the invention, the SIP session between recording system  and super-node  may comply with the SIP session for recording purposes as described in US publication No. 2007-0019634 which is herby incorporated by reference in its entirety.","According to embodiments of the invention, when any super-node  is used as a recording super-node, redundancy and load balancing may be implemented by the peer-to-peer communication network  itself. Load balancing may be implemented by distributing endpoints  between network super-nodes , as in typical peer-to-peer networks. Redundancy may also be inherent to the peer-to-peer network. In case of super-node  failure, end-devices  that were connected to the defected super-node , may be assigned to a different super-node  which may connect with recording system  as explained above to continue the recording.","Typically, the media that is forked by super-node  to recording System  may be not encrypted. However standard encryption mechanisms like Transport Layer Security (ILS) for call meta-data and signaling and Secure Real-time Transport Protocol (SRIP) or Datagram Transport Layer Security for Secure Real-time Transport Protocol (DTLS-SRIP) for encrypted media may be utilized by the network. If TLS and SRTP or DILS-SRIP security method is utilized, a Public Key Infrastructure (PKI) may exist. The PKI may be responsible for issuing digital certificates for both super-node  and recording system . Alternatively, super-node  may already have digital certificate, issued by authentication server  during registration. The same authentication server may, for example, issue digital certificate for recording system  as well. Typically, end-devices  are issued a digital certificate by authentication server  on end-device  login.","Reference is now made to  which is a flowchart illustration of a method for registering an end-device with a recording super-node upon login to a peer-to-peer communication network according to embodiments of the invention. According to embodiments of the invention, when a login request arrives from an end-device (block ) to a peer-to-peer communication network it is decided whether the end-device should be recorded (block ). For example, when a login request from an end-device arrives at an authentication server of a peer-to-peer communication network, the authentication server may decide that the end-device need to be recorded based on static entries in the authentication server recording database. Alternatively, the authentication server may be in communication with a recording system and may provide the identity of the end-device to the recording system together with a query whether the end-device should be recorded. The recording system may decide whether the end-device should be recorded. If the end-device should be recorded, the recording system may choose a recording super-node and may provide the address of the chosen recording super-node to the authentication server. If the end-device should be recorded, an address of a recording super-node may be provided to the end-device (block ). The end-device may then register with the recording super-node (block ). If the end-point should not be recorded, address of a standard, i.e. not-recording super-node may be provided to the end-device (block ). The end-device may then register with the standard super-node (block ).","Reference is now made to  which is a flowchart illustration of a method for recording peer-to-peer communication sessions according to embodiments of the invention. As seen in block  end-devices of the peer-to-peer communication network may register with a selected super-node. The selected super-node may be a dedicated recording super-node, such as, but not limited to, recording super-node . For example, end-devices may send a request to an authentication server to register to the peer-to-peer network. The authentication server may receive the registration request from the end-device. End-devices that need to be recorded may receive an instruction to register to a selected super-node and a list of selected super-nodes to register with from the authentication server on end-device login. Alternatively, any selected super-node may be capable of forking media to the recording system. For example, the selected super-node may learn the address of the recording system from the authentication server. After a communication session is established between two or more endpoints (block ), the media associated with the communication session may be forked to the recording system (block ), which may record the communication session (block ).","Reference is now made to  which is a flowchart illustration of a method for using any super-node for recording in a peer-to-peer communication network according to embodiments of the invention. According to embodiments of the invention, super-nodes of a peer-to-peer communication network may get an address of a recording system (block ). For example, the super-nodes may learn the address of the recording system from an authentication server. End-devices may register with any one of the super-nodes of the peer-to-peer communication network (block ). Once a communication session is established in the peer-to-peer communication network via a super-node (block ), a notification of the beginning of the session may be issued (block ) and it may be decided whether the communication session should be recorded (block ). For example, a communication session start event may be reported to the recording system. The recording system may determine whether the communication session should be recorded. If the communication session should be recorded, the recording system may issue a recording request. Alternatively, decision whether the communication session should be recorded may be accepted at the super-node. If it is decided that the communication session should not be recorded, the communication session may not be recorded (block ). If the communication session should be recorded, the media of the communication session may be forked (block ), and the communication session may be recorded ().","Reference is made to  depicting a high-level diagram of an exemplary peer-to-peer communication network  according to embodiments of the invention. According to embodiments of the invention, network  may comprise a plurality of external end-devices , at least one super-node  and a call center  comprising a plurality of agent end-devices , an IVR\/ACD  and a recorder . According to embodiments of the invention, network  may be coupled through super-node  to a communication network . Communication network  may comprise a peer-to-peer communication network, such as network . Additionally, communication network  may be coupled to a public switched telephone network PSTN network. It should be noted that while in the embodiments of the invention shown in  IVR\/ACD  system are depicted as a single integrated system, IVR\/ACD  system may be separated into two separate systems, IVR and ACD. Alternatively, call center  may not comprise IVR system. Additionally, while in the embodiments of the invention depicted in  agent end-devices , IVR  and ACD  are depicted coupled to a single super-node , according to embodiments of the invention, agent end-devices , and IVR\/ACD  may be registered to different super-nodes as well.","According to embodiments of the invention, recorder  may be placed after the IVR\/ACD , if only the media transferred between agent end-devices  and external end-device  needs to be recorded as depict in , or before IVR\/ACD , if recording the IVR session is required as well (not shown).","According to embodiments of the invention, recorder  may comprise two nodes, external node  and internal node . Each of external node  and internal node  may have a different and unique identity or address and both may be connected to communication network .","According to embodiments of the invention, after a communication session from an external end-device  arrives at call center , it is first directed to IVR\/ACD system . IVR\/ACD system  may collect caller information and choose a target agent end-device . IVR\/ACD system  may than call external node  of recorder  and send a call request to recorder  to call target agent end-device  and establish a communication session between recorder  and agent end-device . For example, sending such a call request can be done by external application programming interface (API) between recorder  and IVR\/ACD system , or by using peer-to-peer communication such as instant message. The request may comprise the number or address of target agent end-device , the number or address of external end-device  and any other information gathered by IVR\/ACD system , as may be required.","Upon receiving the call request, recorder  may initiate an outgoing communication session on internal node  to target agent end-device . After the outgoing communication session between internal node  and target agent end-device  is established, IVR\/ACD system  may transfer the communication session from an external end-device  to external node  of recorder  and drop from the communication session.","Outgoing communication sessions may pass through the recorder in a similar manner. For example, target agent end-device  may initiate a session by calling internal node  of recorder  and send a call request to recorder  to call external end-device  and establish a communication session between recorder  and external end-device . For example, sending such a call request can be done by external application programming interface (API) between recorder  target agent end-device , or by using peer-to-peer communication such as instant massage. The request may comprise the number or address of target agent end-device , the number or address of external end-device  and any other information, as may be required. Upon receiving the call request, recorder  may initiate an outgoing communication session on external node  to external end-device .","During the communication session, recorder  may act as a proxy, receiving external end-device  media on external node  and sending it to target agent end-device  on internal node , and receiving agent end-device  media on internal node  and transferring it to external end-device  on external node . Recorder  also saves and records copy of the media.","Once the communication session is terminated at one node, recorder  may terminate the communication session on the other end stop the recording. For example if external end-device  terminates the communication session, recorder  may terminate the communication session on internal node  and if agent end-device  terminates the communication session, recorder  may terminate the communication session on external node .","According to embodiments of the invention, recorder  may have a single node which may perform the functionality of external node  and internal node .","According to embodiments of the invention, recording communication sessions at peer-to-peer communication network  may be achieved by implementing the communication session as a conference call such that target agent end-device , external end-device  and recorder  are participants in the conference call. While connected to the conference call, recorder  may receive media transferred between target agent end-device  and external end-device  and record that media.","For example, after a call from an external end-device  arrives at call center , and after IVR\/ACD system  had chosen a target agent end-device , IVR\/ACD system  may create a communication session with target agent end-device  and recorder , transfer them into a conference call and drop from the communication session. Alternatively, IVR\/ACD system  may create a communication session with target agent end-device  and drop from the communication session. Agent end-device  may then create a conference call and add recorder  to the conference call. Similarly, outgoing communication sessions initiated by agent end-device  may be implemented as a conference call, such that agent end-device , external end-device  and recorder  are participants in the conference call. For example, agent end-device  may create a conference call and add recorder  and external end-device  to the conference call.","Reference is now made to  which is a flowchart illustration of a method for recording communication sessions between an external end-device and an agent end-device over a peer-to-peer communication network according to embodiments of the invention. Although embodiments of the invention are not limited in this respect, the method may be performed by embodiments of the invention, for example, an embodiment as shown in .","According to embodiments of the invention, a communication session is established between an external end-device and a recorder (block ). The communication session may be established over a selected super-node of the peer-to-peer network. As seen in block  another communication session is then established between the recorder and a target end-device. The recorder may pertain to a call center. For example, when the external end-device initiates a communication session, the external end-device may be connected to an IVR\/ACD system that may collect caller information and choose a target agent end-device from a plurality of agent end-devices coupled to the IVR\/ACD. The IVR\/ACD system may than call the recorder and send a call request to the recorder to establish a communication session between the recorder and the target agent end-device. For example, sending such a call request can be done by external application programming interface (API) between the recorder and the IVR\/ACD system, or by using peer-to-peer communication such as instant massage. The request may comprise the number or address of the target agent end-device, the number or address of the external end-device and any other information as may be required. The recorder may then initiate a communication session to the target agent end-device and the external end-device may be transferred to the recording system from the IVR\/ACD system. Alternatively, in case of outgoing communication session a session is first established between the target agent end-device and the recorder and than a session is established between the recorder and the external end-device via a selected super-node over the peer-to-peer network.","After these sessions are established, communication session media may be transferred between the external end-device and target agent end-device via the recorder (block ) and the communication session media may be recorded (block ).","Reference is now made to  which is a flowchart illustration of a method for recording communication sessions implemented as conference call between an external end-device, an agent end-device and a recorder over a peer-to-peer communication network according to embodiments of the invention. Although embodiments of the invention are not limited in this respect, the method may be performed by embodiments of the invention, for example, an embodiment as shown in .","According to embodiments of the invention, a conference call may be established between an external end-device, a target agent end-device and a recorder (block ) over a peer-to-peer communication network. For example, if an IVR\/ACD system of a call center receives a communication session from an external end-device, the IVR\/ACD system may create a communication session with the target agent end-device and the recorder, transfer them into a conference call and drop from the communication session. Alternatively, the IVR\/ACD system may create a communication session with the target agent end-device and drop from the communication session and the agent end-device may then create a conference call and add the recorder to the conference call. Similarly, for outgoing communication sessions the agent end-device may create a conference call and add recorder and the external end-device to the conference call. After a conference call is established, the recorder may receive media transferred between the external end-device and the target agent end-device and record that media (block ).","It will be recognized that according to embodiments of the invention, the actual recording of a communication session may be performed in any applicable way as known in the art. For example, any suitable recording server, platform or system, e.g., NICE Perform\u00ae from NICE Ltd. of Ra'anana, Israel may be used to record a communication session once a decision to record the communication session has been made. Embodiments of the invention are not limited by the type, nature or other aspects of the recording system used for recording communication sessions as described herein.","Some embodiments of the present invention may be implemented in software for execution by a processor-based system, for example, recording super-nodes . For example, embodiments of the invention may be implemented in code and may be stored on a storage medium having stored thereon instructions which can be used to program a system to perform the instructions. The storage medium may include, but is not limited to, any type of disk including floppy disks, optical disks, compact disk read-only memories (CD-ROMs), rewritable compact disk (CD-RW), and magneto-optical disks, semiconductor devices such as read-only memories (ROMs), random access memories (RAMs), such as a dynamic RAM (DRAM), erasable programmable read-only memories (EPROMs), flash memories, electrically erasable programmable read-only memories (EEPROMs), magnetic or optical cards, or any type of media suitable for storing electronic instructions, including programmable storage devices. Other implementations of embodiments of the invention may comprise dedicated, custom, custom made or off the shelf hardware, firmware or a combination thereof.","Embodiments of the present invention may be realized by a system that may include components such as, but not limited to, a plurality of central processing units (CPU) or any other suitable multi-purpose or specific processors or controllers, a plurality of input units, a plurality of output units, a plurality of memory units, and a plurality of storage units. Such system may additionally include other suitable hardware components and\/or software components.","While certain features of the invention have been illustrated and described herein, many modifications, substitutions, changes, and equivalents will now occur to those of ordinary skill in the art. It is, therefore, to be understood that the appended claims are intended to cover all such modifications and changes as fall within the true spirit of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The subject matter regarded as the invention is particularly pointed out and distinctly claimed in the concluding portion of the specification. The invention, however, both as to organization and method of operation, together with objects, features, and advantages thereof, may best be understood by reference to the following detailed description when read with the accompanying drawings in which:",{"@attributes":{"id":"p-0005","num":"0004"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
