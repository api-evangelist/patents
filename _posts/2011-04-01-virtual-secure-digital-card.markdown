---
title: Virtual secure digital card
abstract: A system (and a method) are disclosed for generating a virtual secure digital (SD) card. One embodiment detects an SD card and reads a media key block and media identification for the SD card. The system stores the media key block and the media identification. The system creates a file system for secure data on a storage device for storage of secure data corresponding to a secure data area of the SD card and creates a file system for user data on the storage device for storage of user data corresponding to a user data area of the SD card. In addition, the system uses the virtual secure digital (SD) card. The system determines if the virtual SD card is provisioned and provisions it if not. The system accesses the data stored in the secure area of the provisioned virtual SD card. The system extracts the data from the secured area of the provisioned virtual SD card.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08745749&OS=08745749&RS=08745749
owner: Media IP, LLC
number: 08745749
owner_city: Seattle
owner_country: US
publication_date: 20110401
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","BACKGROUND","DETAILED DESCRIPTION"],"p":["This application claims the benefit of U.S. Provisional Application No. 61\/413,926, filed Nov. 15, 2010, which is incorporated by reference in its entirety.","1. Field of Art","The disclosure generally relates to the field of memory devices, and more particularly, generation of virtual memory devices.","2. Description of the Related Art","Secure Digital (SD) cards are in wide use for many storage applications. They are most commonly used to store audio (MP3 players), pictures (digital cameras), and full motion video (camcorders and HD camcorders). The SD card provides an acceptable portable storage medium to transfer unprotected content between different devices, especially for the video capture devices mentioned above. The content stored on SD cards can be transferred or archived to devices with larger storage capacities and additional processing capabilities. One such additional processing capability allows consumers to create and manage a digital archive of consumer generated content.","Consumers are familiar with the SD card's basic storage capabilities, but they are mostly unaware of its security features (the S in Secure Digital). This is because there are very few applications that use this advanced functionality. Applications that use the security features primarily enable digital rights management (DRM) to protect commercial content from copying or other forms of piracy. Examples of DRM applications include still images (Gallery Player) and full-motion video (1-seg and GreenPlay). The DRM protection must remain intact during content loading, transfer, and archival. Maintaining protection through transfers from SD card to other memories cannot be archived easily. While an SD card is suited for content loading and transfer, it is not as well suited for the archival aspect.","SD cards are suited to content loading, purchasing and transporting content, but not for creating a digital library. The main reasons correspond to the primary use of SD cards as a portable storage medium. Accordingly, the size, cost, and the lack of labeling on the SD card result in an undesirable format for a digital library. Although SD cards are available currently in up to 64 gigabyte (GB) capacity, a typical digital rights management (DRM)-protected commercial video is approximately 2 GB. Therefore, only 32 DRM-protected commercial videos can be stored on any single SD card. Multiple SD cards are required in order to create a digital library of any significant capacity. In contrast, hard disk drives are in abundant supply in sizes ranging from several hundred gigabytes to few tens of terabytes. These allow for storing upwards of 5000 DRM-protected commercial videos at roughly the same price as a 32 GB SD card.","The DRM used by SD cards, content protection for recordable media (CPRM), allow for content to be moved and\/or copied to other CPRM-compliant devices because the anti-piracy mechanism is maintained, but technical challenges have prevented this. First, the CPRM license agreement specifies the process requirements for moving content to\/from the SD card, but does not specify the file formats for the non-SD card device. In addition, file structures and data to implement the DRM are complex and have many entities. A typical secure exchange to move or copy content may require a minimum of 150 secure operations for the DRM portion alone. Maintaining the complex relationships within a new file structure presents a substantial processing and memory resource challenge in addition to the effort of developing software code to maintain and manage the process.","Second, security software is only defined for personal computer (PC) architectures. It is not defined for other software or hardware architectures, including many devices which utilize SD cards that must maintain DRM protection through the transfer and viewing processes such as mobile phones, TV, set top boxes, and Blu-ray disc players and the like.","Third, many devices may not implement an internal SD card for a variety of reasons including cost, space considerations for connectors, and the aforementioned lack of security software drivers. Alternatively, these devices include dedicated flash for storage applications, but lack the security feature included within the SD card. Thus, these devices are unsuitable for storage according to the DRM requirements.","Conventional external storage does not support securely storing data. A few proprietary solutions exist, but no standardized solution is available apart from SD cards because there has not been a consumer requirement for secure external storage.","The Figures (FIGS.) and the following description relate to preferred embodiments by way of illustration only. It should be noted that from the following discussion, alternative embodiments of the structures and methods disclosed herein will be readily recognized as viable alternatives that may be employed without departing from the principles of what is claimed.","Reference will now be made in detail to several embodiments, examples of which are illustrated in the accompanying figures. It is noted that wherever practicable similar or like reference numbers may be used in the figures and may indicate similar or like functionality. The figures depict embodiments of the disclosed system (or method) for purposes of illustration only. One skilled in the art will readily recognize from the following description that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein.","Configuration Overview","One embodiment of a disclosed system (or method and computer readable storage medium) that provisions a virtual secure digital (SD) card is described. In one example configuration the system detects an SD card and reads a media key block and media identification for the SD card. The system stores the media key block and the media identification. On the storage device, the system creates a file system for secure data storage corresponding to the SD card's secure data area and creates a file system for user data for storage of user data corresponding to the SD card's user data area. The system accesses the data stored in the secure area of the provisioned virtual SD card. In addition, the system uses the virtual secure digital (SD) card.","Computing Machine Architecture",{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 1","FIG. 1"],"b":["100","124"]},"The machine may be a server computer, a client computer, a personal computer (PC), a tablet PC, a set-top box (STB), a personal digital assistant (PDA), a cellular telephone, a smart phone, a web appliance, a network router, switch or bridge, a gaming console, a Blu-ray Disc player, or any machine capable of executing instructions  (sequential or otherwise) that specify actions to be taken by that machine. In addition, the machine may be configured to include instructions stored as firmware. Further, while only a single machine is illustrated, the term \u201cmachine\u201d shall also be taken to include any collection of machines that individually or jointly execute instructions  to perform any one or more of the methodologies discussed herein.","The example computer system  includes a processor  (e.g., a central processing unit (CPU), a graphics processing unit (GPU), a digital signal processor (DSP), one or more application specific integrated circuits (ASICs), one or more radio-frequency integrated circuits (RFICs), or any combination of these), a main memory , and a static memory , which are configured to communicate with each other via a bus . The computer system  may further include graphics display unit  (e.g., a plasma display panel (PDP), a liquid crystal display (LCD), a projector, or a cathode ray tube (CRT)). The computer system  may also include alphanumeric input device  (e.g., a keyboard), a cursor control device  (e.g., a mouse, a trackball, a joystick, a motion sensor, or other pointing instrument), a persistent storage unit , a signal generation device  (e.g., a speaker), and a network interface device , which also are configured to communicate via the bus . The computer system  also may include a random number generator (RNG) . The random number generator  can be implemented in either hardware or software.","The storage unit  includes a machine-readable medium  on which is stored instructions  (e.g., software) embodying any one or more of the methodologies or functions described herein. The instructions  (e.g., software) may also reside, completely or at least partially, within the main memory  or within the processor  (e.g., within a processor's cache memory) during execution thereof by the computer system , the main memory  and the processor  also constituting machine-readable media. The instructions  (e.g., software) may be transmitted or received over a network  via the network interface device .","Also included in the computing system  is a secure digital (SD) card reader\/writer . The SD card reader\/writer in one embodiment may be a physical device that accepts SD card in various physical formats (SD card, mini SD, or micro SD) and interfaces the electrical characteristics such that the storage on the SD card can be accessed by the computing device. The card reader may be internal to the computing device or external using adapters such as a USB-SD card reader, PC card-card reader, express card reader, or any other electrical interface such that the computing device can communicate with an SD card.","While machine-readable medium  is shown in an example embodiment to be a single medium, the term \u201cmachine-readable medium\u201d should be taken to include a single medium or multiple media (e.g., a centralized or distributed database, or associated caches and servers) able to store instructions (e.g., instructions ). The term \u201cmachine-readable medium\u201d shall also be taken to include any medium that is capable of storing instructions (e.g., instructions ) for execution by the machine and that cause the machine to perform any one or more of the methodologies disclosed herein. The term \u201cmachine-readable medium\u201d includes, but not be limited to, data repositories in the form of solid-state memories, optical media, and magnetic media.","In one example embodiment, the instructions  correspond to an application program . The application program  include a set of machine readable instructions to carry out key exchange and data transfer specifications as further described herein. In one example, the application program  may work with a digital rights management (DRM) key and tamper resistant software.","In addition, the example computer system  may include a SD secure application programming interface (API) . The SD Secure API is a software component that facilitates access to the SD card's secure area.","Typical SD Card Architecture and Functions","The SD card , may be a full size, mini SD, or micro SD physical format. The SD card  must conform to the specifications developed and enforced by the SD ASSOCIATION. The SD card  is illustrated to provide a general idea of how an SD card may be internally constructed so that the functionality assigned to the virtual SD card can be better understood. The decomposition is not intended to reveal any specific trade secrets or patents of the many SD card vendors.",{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 2","b":["200","205","210","215","220","225","230","225","260","265","260","260","260","265","260","265"]},"The computer system  sends request for User Data  through a card reader . The mass storage driver  provides the software interface for the computer system  to the card reader  for User Data . In turn the card reader sends requests to the SD card through the microcontroller  and firmware . The firmware  comprises software machine instructions by the microcontroller  to interpret card reader commands and return data to the card reader. Data access is not restricted and authentication is not required to read or write the data within the User Area.","Access to the secure area is restricted and can be used for DRM applications. The application program  and the SD secure API  of the computer system  are further broken out for illustration purposes. Specifically, the application program  includes a DRM key  and tamper resistant software (TRS) .","Next, referring to the SD secure API , it comprises a software component that facilitates access to the secure area  on the SD card . The software architecture of the computer system  assumes that the SD card is capable of responding to the commands from the application program  using the SD secure API  architecture for the purpose of secure area access. The SD secure API  includes the device manager (DM)  and the device driver (DD) . The device manager (DM)  identifies SD card readers attached to the computer system . Once card readers are identified, the device manager  matches the corresponding device driver  with the specific physical card reader, or readers, attached to the computer system . The device driver  provides a device independent interface to card readers. It formats secure commands specifically for card readers and returns data to the application program . The device driver  provides a conduit for communicating with card readers, which in turn communicate directly with the secure area  of the SD card .","Turning now to the application program , the DRM key  stored in the computer system  and used to complete an authenticated key exchange with the SD card . Specifically, the authenticated key exchange is used to gain access the SD card secure area  in accordance with the Authenticated Key Exchange (AKE) used by Content Protection for Recordable Media (CPRM) specifications for use with SD cards. The application is provisioned with the DRM key either at initial installation or contained within the program itself. The random number generator  in the computer system  provides random numbers for replay protection required by the AKE specification. The firmware  includes the necessary algorithms (cryptograph and hash) in accordance with specifications.","The key exchange process and resultant data transfer process are subject to hackers (unauthorized or rogue applications) attempting to obtain the data stored on the secure area  of the SD card  that is transferred into the application program . The tamper resistant software  protects against the attacks. The tamper resistant software  comprises software code that may include techniques which remain proprietary to their respective vendors but may include such items as code obfuscation, anti-debugging, code duplication and\/or other anti-tamper techniques.","The random number generator  can be implemented in either hardware or software. It is noted that the random number generator  in the computer system  and the random number generator  in the SD card  are both used during AKE. The media key block (MKB)  is structured in accordance with the CPRM specification for SD Cards.","Virtual SD Card Architecture","The virtual SD card  implements in software the functionality previously implemented by SD card  in hardware. The functional components of the computer system  are used by the virtual SD card  implementation. The virtual SD card  provides not only the interface to device manager , but also the processing that would normally take place in the microcontroller  on the SD card  while executing the firmware  of the SD card . In addition, rather than send data protocol commands to the SD card , the virtual device driver  interfaces directly with the virtual secured area file system  and the virtual user area file system .",{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 3","b":["100","300","300","116","100","100","100","100","300","116","100"]},"In , the virtual SD card  includes a virtual device driver (DD) , tamper resistant software , a virtual secure area filed system , a virtual media key block , virtual user area file system , a virtual media identification (ID) . The virtual device driver  is configured to interface the device manager , using the same interface as the device driver  providing similar functions as well. The device manager  and device driver  interfaces remain unchanged from the specification for SD cards. The virtual DD  is secured using the tamper resistant software . In another embodiment, the DM is not required since only one card reader may be used in the system. For example, the application may use the DD as the direct interface to the SD card.","The virtual secured area file system  and the virtual user area file system  can be implemented as file systems within an encrypted file. This provides the same level of protection as a physical SD card  implementation. They can also be implemented as physical or logical partitions on the same or separate devices, with or without encryption depending on the overall system security requirements. However, unlike physical SD cards, the virtual SD card  allows for storage of larger volumes of DRM media typically stored on physical SD cards. Moreover, this configuration allows for additional media management such as layering media management system to organize and interface with one or more stored virtual SD cards using a user interface accessible through the computer system .","The secured area file system  is configured as a storage area for secure data. This may be implemented as a physical or logical storage area within external storage . Because the file system can be accessed by the computer system  without using the virtual SD card , the data within the secure area is protected using an encryption key. The encryption key is derived from the computing device's unique information (e.g., processor serial number, bios serial number, device serial number), and hidden information effectively binding the file systems to the computer system . This prevents data access if storage is transferred to another computer system. In one example embodiment, the encryption key is not stored but rather derived. In another embodiment, the encryption key may be stored in a trusted host further enhancing security protection against data access if storage is transferred. Authentication is also provided using AKE methods. It is preferable that the secured area file system  is stored within a non-removable storage device to further assist in replay-attack prevention. These methods bind the file systems to a specific computer that cannot be transferred to another computer. If an attempt is made to transfer the bound file systems, the derived encryption key is different and the data access is denied by AKE authentication and data cannot be decrypted. The virtual media key block (MKB)  is equivalent to media key block . The virtual media key block  is read by the computer system  utilizing the media key block  from the SD card . The media key block  is stored using the process described previously, e.g., with respect to the virtual secured area file system .","The user area file system file system  is a storage area for unsecured data. The virtual user area file system  is maintained on the storage device  in a physical or logical partition. Unlike the secure area, encryption and non-removable storage are not required. The virtual media ID  is functionally similar to the media ID . The virtual media ID  is stored using the process described previously, e.g., with respect to the virtual secured area file system .","By leveraging storage  of the computer system  to create the virtual SD card, the file storage layouts and data implementations can replicate a physical SD card implementation. This simplifies the software implementation to a unified storage algorithm for data on SD cards and on virtual SD archives. It is noted that in the virtual SD card  configuration, the card reader interface  is no longer necessary because there is no communication with a physical SD card. Rather, the virtual device driver  is configured to include the firmware  of the original SD card.","Virtual SD Card Provisioning and Initialization","Turning now to , it illustrates one example embodiment of a process for provisioning a virtual SD card . The provisioning process for creating the virtual SD card  following by defining\/assembling the components for the virtual SD card . The process detects the SD card  in the SD card reader\/writer  of the computer system . The SD card reader\/writer  reads the media key block  and media ID  from the SD card  and stores  them in the storage unit  as the Virtual Media Key Block  and the Virtual Media ID  for access by the virtual SD card . The virtual media ID  is provisioned prior to first use, such as device manufacture, software load time, or when a first SD card is read by the computer system  utilizing the media ID  from the SD card .","The process determines  the physical or logical devices to use, size for a virtual user area  on the virtual SD card  and creates a file or partition on the storage  that is accordingly formatted for the virtual user area . A size of the secured area file system  is determined at provisioning time according to the SD card specifications. The size of the virtual secured area file system  is a table lookup from SD ASSOCIATION specifications based on the size of the virtual user area file system . The process creates a file or partition on the storage  that is accordingly formatted for the virtual secured area . Once completed the process is returned as successful . With the virtual SD card  provisioned, it is now ready for use.","Using a Virtual SD Card",{"@attributes":{"id":"p-0047","num":"0046"},"figref":["FIG. 5","FIG. 4"],"b":["300","200","107","100","515","300","520"]},"The process determines  if the request is for the secure area  of the virtual SD card. If the request is not for the secure area, the process only fetches and returns  data from the user area .","If the request is for the secured area, the process performs  AKE. If the process determines  AKE is not successful, the process denies  access to the secure area and may return an error on a display of the computer system . If the key exchange is successful, the process determines  whether a read or a write operation will be performed. If a write operation, the process decrypts  data with the key derived during AKE, reads from storage, decrypts the with encryption key, updates data, encrypts with the encryption key, and writes data to the virtual secure area file system  of the virtual SD card . It is noted that there are two encryption keys. One encryption key is for physical storage. The second key is the key calculated during AKE. This key protects data during transport between the virtual SD card and the application program. If successful, an indication  of success is returned. If a read operation, the process fetches and decrypts  data from the virtual secure area file system  using the key derived from the computing device unique information. The process encrypts  the data with the AKE key for transport to the application program . The process returns (or retrieves or extracts) data from the virtual secure area  to the application program .","Additional Configuration Considerations","Throughout this specification, plural instances may implement components, operations, or structures described as a single instance. Although individual operations of one or more methods are illustrated and described as separate operations, one or more of the individual operations may be performed concurrently, and nothing requires that the operations be performed in the order illustrated. Structures and functionality presented as separate components in example configurations may be implemented as a combined structure or component. Similarly, structures and functionality presented as a single component may be implemented as separate components. These and other variations, modifications, additions, and improvements fall within the scope of the subject matter herein.","Certain embodiments are described herein as including logic or a number of components, modules, or mechanisms. Modules may constitute either software modules (e.g., code embodied on a machine-readable medium or in a transmission signal) or hardware modules. A hardware module is tangible unit capable of performing certain operations and may be configured or arranged in a certain manner. In example embodiments, one or more computer systems (e.g., a standalone, client or server computer system) or one or more hardware modules of a computer system (e.g., a processor or a group of processors) may be configured by software (e.g., an application or application portion) as a hardware module that operates to perform certain operations as described herein.","In various embodiments, a hardware module may be implemented mechanically or electronically. For example, a hardware module may comprise dedicated circuitry or logic that is permanently configured (e.g., as a special-purpose processor, such as a field programmable gate array (FPGA) or an application-specific integrated circuit (ASIC)) to perform certain operations. A hardware module may also comprise programmable logic or circuitry (e.g., as encompassed within a general-purpose processor or other programmable processor) that is temporarily configured by software to perform certain operations. It will be appreciated that the decision to implement a hardware module mechanically, in dedicated and permanently configured circuitry, or in temporarily configured circuitry (e.g., configured by software) may be driven by cost and time considerations.","The various operations of example processes described herein, e.g., as described with ,  and , may be performed, at least partially, by one or more processors that are temporarily configured (e.g., by software) or permanently configured to perform the relevant operations. Whether temporarily or permanently configured, such processors may constitute processor-implemented modules that operate to perform one or more operations or functions. The modules referred to herein may, in some example embodiments, comprise processor-implemented modules.","The one or more processors may also operate to support performance of the relevant operations in a \u201ccloud computing\u201d environment or as a \u201csoftware as a service\u201d (SaaS). For example, at least some of the operations may be performed by a group of computers (as examples of machines including processors), these operations being accessible via a network (e.g., the Internet) and via one or more appropriate interfaces (e.g., application program interfaces (APIs).)","The performance of certain of the operations may be distributed among the one or more processors, not only residing within a single machine, but deployed across a number of machines. In some example embodiments, the one or more processors or processor-implemented modules may be located in a single geographic location (e.g., within a home environment, an office environment, or a server farm). In other example embodiments, the one or more processors or processor-implemented modules may be distributed across a number of geographic locations.","Some portions of this specification are presented in terms of algorithms or symbolic representations of operations on data stored as bits or binary digital signals within a machine memory (e.g., a computer memory). These algorithms or symbolic representations are examples of techniques used by those of ordinary skill in the data processing arts to convey the substance of their work to others skilled in the art. As used herein, an \u201calgorithm\u201d is a self-consistent sequence of operations or similar processing leading to a desired result. In this context, algorithms and operations involve physical manipulation of physical quantities. Typically, but not necessarily, such quantities may take the form of electrical, magnetic, or optical signals capable of being stored, accessed, transferred, combined, compared, or otherwise manipulated by a machine. It is convenient at times, principally for reasons of common usage, to refer to such signals using words such as \u201cdata,\u201d \u201ccontent,\u201d \u201cbits,\u201d \u201cvalues,\u201d \u201celements,\u201d \u201csymbols,\u201d \u201ccharacters,\u201d \u201cterms,\u201d \u201cnumbers,\u201d \u201cnumerals,\u201d or the like. These words, however, are merely convenient labels and are to be associated with appropriate physical quantities.","Unless specifically stated otherwise, discussions herein using words such as \u201cprocessing,\u201d \u201ccomputing,\u201d \u201ccalculating,\u201d \u201cdetermining,\u201d \u201cpresenting,\u201d \u201cdisplaying,\u201d or the like may refer to actions or processes of a machine (e.g., a computer) that manipulates or transforms data represented as physical (e.g., electronic, magnetic, or optical) quantities within one or more memories (e.g., volatile memory, non-volatile memory, or a combination thereof), registers, or other machine components that receive, store, transmit, or display information.","As used herein any reference to \u201cone embodiment\u201d or \u201can embodiment\u201d means that a particular element, feature, structure, or characteristic described in connection with the embodiment is included in at least one embodiment. The appearances of the phrase \u201cin one embodiment\u201d in various places in the specification are not necessarily all referring to the same embodiment.","Some embodiments may be described using the expression \u201ccoupled\u201d and \u201cconnected\u201d along with their derivatives. For example, some embodiments may be described using the term \u201ccoupled\u201d to indicate that two or more elements are in direct physical or electrical contact. The term \u201ccoupled,\u201d however, may also mean that two or more elements are not in direct contact with each other, but yet still co-operate or interact with each other. The embodiments are not limited in this context.","As used herein, the terms \u201ccomprises,\u201d \u201ccomprising,\u201d \u201cincludes,\u201d \u201cincluding,\u201d \u201chas,\u201d \u201chaving\u201d or any other variation thereof, are intended to cover a non-exclusive inclusion. For example, a process, method, article, or apparatus that comprises a list of elements is not necessarily limited to only those elements but may include other elements not expressly listed or inherent to such process, method, article, or apparatus. Further, unless expressly stated to the contrary, \u201cor\u201d refers to an inclusive or and not to an exclusive or. For example, a condition A or B is satisfied by any one of the following: A is true (or present) and B is false (or not present), A is false (or not present) and B is true (or present), and both A and B are true (or present).","In addition, use of the \u201ca\u201d or \u201can\u201d are employed to describe elements and components of the embodiments herein. This is done merely for convenience and to give a general sense of the invention. This description should be read to include one or at least one and the singular also includes the plural unless it is obvious that it is meant otherwise.","Upon reading this disclosure, those of skill in the art will appreciate still additional alternative structural and functional designs for a system and a process for provisioning and using a virtual Secure Digital card through the disclosed principles herein. Thus, while particular embodiments and applications have been illustrated and described, it is to be understood that the disclosed embodiments are not limited to the precise construction and components disclosed herein. Various modifications, changes and variations, which will be apparent to those skilled in the art, may be made in the arrangement, operation and details of the method and apparatus disclosed herein without departing from the spirit and scope defined in the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF DRAWINGS","p":["The disclosed embodiments have other advantages and features that will be more readily apparent from the detailed description, the appended claims, and the accompanying figures (or drawings). A brief introduction of the figures is below.",{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
