---
title: System and method for automatic label placement on charts
abstract: An algorithm is provided for optimizing the layout of labels associated with a visual data object such as a chart. The labels are first placed into a chart definition file that defines the labels as a shape. An initial layout of the labels is created and scored. The shapes are then manipulated iteratively until an optimal layout of the labels is obtained that corresponds to the layout having the score closest to an optimal score. The optimal layout is then used in rendering the visual data object on a screen.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07292244&OS=07292244&RS=07292244
owner: Microsoft Corporation
number: 07292244
owner_city: Redmond
owner_country: US
publication_date: 20041018
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["The present invention is related to a patent application having Ser. No. 10\/941,566, entitled \u201cCommon Charting Using Shapes\u201d, filed on Sep. 15, 2004. The related application is assigned to the assignee of the present patent application and is hereby incorporated by reference.","A chart is a graphical representation of numerical data. Charts are particularly useful for presenting complicated data in a concise and easily-understandable form. In today's desktop publishing environment, users can create impressive presentations using charts. Charts are based on underlying data that is entered into an application program such as \u201cEXCEL\u201d from MICROSOFT CORPORATION of Redmond, Wash. The underlying data can then be used to create a chart of the data in a number of different formats, such as pie-chart, bar-chart, histogram, line chart, etc. In addition, each part of the chart can have associated colors, textures, and other effects to improve the appearance of the chart, which is very important for conveying information.","The labels included in a chart contribute to the visual function and presentation of a chart. A chart with more than a few data points may become hard to read if the user activates an automated data label function. Generally, previously provided automated chart labeling algorithms result in overlapping text and positioning of labels that is not optimized to use the chart area. Accordingly, alternate methods are needed.","Embodiments of the present invention are related to a system and method that solves for the above-mentioned limitations by optimizing the placement of labels on charts and graphs. The optimization of the label is provided according to an algorithm that scores a specified positioning of the labels based on a set of constraints. The better the current positioning of the labels conforms with the stated constraints, the better the score for the chart. The algorithm attempts to minimize the score by calling a function multiple times, wherein the function repositions a single label each time it is called. In one implementation of the present invention, labels that were manually positioned are exempt from consideration during the optimization process.","In one aspect of the present invention, the functions of the optimization process are defined according to an objective function, or score function, and perturbation function that operate on the labels and anchors of the chart or graph. An anchor refers to a display element of the chart that has an associated label, such as a specific slice of a pie chart, a bubble of a bubble chart, or other elements depending on the chart used. The objective function refers to a function that defines the goal of the optimization by which a chart may be scored. For example, an objective function may correspond to minimizing overlap of labels, minimizing distance from the edge of an anchor, other goals for optimizing the position of the labels, and possible combinations of these goals. The perturbation function refers to a function that defines the limitations for the adjustment of the labels on the chart. For example, the perturbation function may define range limitations for relocating a label, a limited subset of the types of changes that may be made with regard to a label, and other limitations.","The present invention now will be described more fully hereinafter with reference to the accompanying drawings, which form a part hereof, and which show, by way of illustration, specific exemplary embodiments for practicing the invention. This invention may, however, be embodied in many different forms and should not be construed as limited to the embodiments set forth herein; rather, these embodiments are provided so that this disclosure will be thorough and complete, and will fully convey the scope of the invention to those skilled in the art. Among other things, the present invention may be embodied as methods or devices. Accordingly, the present invention may take the form of an entirely hardware embodiment, an entirely software embodiment or an embodiment combining software and hardware aspects. The following detailed description is, therefore, not to be taken in a limiting sense.","Illustrative Operating Environment","With reference to , one exemplary system for implementing the invention includes a computing device, such as computing device . Computing device  may be configured as a client, a server, mobile device, or any other computing device. In a very basic configuration, computing device  typically includes at least one processing unit  and system memory . Depending on the exact configuration and type of computing device, system memory  may be volatile (such as RAM), non-volatile (such as ROM, flash memory, etc.) or some combination of the two. System memory  typically includes an operating system , one or more applications , and may include program data . In one embodiment, application  includes a chart label optimization application  for implementing the functionality of the present invention. This basic configuration is illustrated in  by those components within dashed line .","Computing device  may have additional features or functionality. For example, computing device  may also include additional data storage devices (removable and\/or non-removable) such as, for example, magnetic disks, optical disks, or tape. Such additional storage is illustrated in  by removable storage  and non-removable storage . Computer storage media may include volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information, such as computer readable instructions, data structures, program modules, or other data. System memory , removable storage  and non-removable storage  are all examples of computer storage media. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computing device . Any such computer storage media may be part of device . Computing device  may also have input device(s)  such as keyboard, mouse, pen, voice input device, touch input device, etc. Output device(s)  such as a display, speakers, printer, etc. may also be included.","Computing device  also contains communication connections  that allow the device to communicate with other computing devices , such as over a network. Communication connection  is one example of communication media. Communication media may typically be embodied by computer readable instructions, data structures, program modules, or other data in a modulated data signal, such as a carrier wave or other transport mechanism, and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. The term computer readable media as used herein includes both storage media and communication media.","Illustrative Embodiment for Optimizing Automatic Label Placement","As used herein, the terms \u201cchart\u201d and \u201cvisual data object\u201d are used interchangeably to describe various visual objects such as pie charts, bubble charts, line charts, timelines, line graphs, bar graphs, photographs, digital images, and other objects that may have associated labels.","Embodiments of the present invention are related to using an algorithm for optimizing the positions of labels on a chart. The present invention uses functions to search for an optimal layout of the labels from a set of possible layouts. To frame the layout problem as a search the present invention defines an initial layout and two functions: an objective function that assesses the quality of a layout based on evaluation criteria, and a perturb function that manipulates a given layout to produce a new layout within the search space. Both the score and the perturb functions are defined by the set of constraints on the layout. Given these two functions the search can be performed to determine the optimal layout. In one embodiment, a simulated annealing method is used as a randomized search algorithm for determining the optimal layout.","The constraints may be divided into two sets: hard constraints and soft constraints. Hard constraints consist of characteristics required of any acceptable layout and therefore hard constraints bound the space of possible layouts. In contrast, soft constraints consist of characteristics desired in the final layout but not required. The hard constraints are typically imposed through the perturb function which is designed to only generate layouts that meet the hard constraints. The score function checks how well a given layout achieves the soft constraints.","Using the algorithm, a set of data may be used to automatically populate a chart with labels while optimizing the position of the labels in the chart area.",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 2","b":"200"},"View  illustrates that the labels on the pie chart are overlapping due to the number of data points included in the pie chart. The overlapping text makes it difficult to visually discern the labels and their association with the elements of the pie chart.","View  results in a pie chart with improved labeling by running the optimization algorithm of the present invention. The readability of the pie chart is greatly improved by optimizing the position of the labels within the chart space. The algorithm has moved certain labels away from the anchors (slices) to which they are related, while others have been moved closer or even centered, or partially centered, within their anchors. Other labels have had lead line added to visually link the label with their associated anchor. View  illustrates that the algorithm uses various methods for providing the optimal layout for the labels of the chart.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 3","b":"300"},"View  illustrates that the labels on the bubble chart may be positioned such that determining their related anchors may not be possible. Furthermore, the text of the labels may not be positioned for optimal viewing of the bubbles within the chart, with text that overlaps the bubble edges.","View  is a bubble chart with improved labeling by running the optimization algorithm of the present invention. The readability of the bubble chart is greatly improved by optimizing the position of the labels within the chart space. The algorithm has moved certain labels away from the anchors (bubbles) to which they are related, while others have been moved closer or even centered, or partially centered, within their anchors. Other labels have had lead line added to visually link the label with their associated anchor while moving the label a distance away from its associated anchor. View  illustrates that the algorithm uses various methods for providing the optimal layout for the labels of a bubble chart similar to the various method employed for the pie chart.",{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4","b":"400"},"View  illustrates that the labels on the timeline chart are overlapping due to the number of data points included in the space provided. Furthermore, the automated labeling algorithm without the benefit of the present invention is not intelligent enough to vary the spacing of the text from the data points on the timeline.","View  is a timeline chart with improved labeling by running the optimization algorithm of the present invention. The readability of the timeline is greatly improved by optimizing the position of the labels within the chart space. The algorithm has changed the text format and moved the labels throughout the chart space to optimize the use of the chart space. View  illustrates that the algorithm uses various methods for providing the optimal layout for the labels of a runeline chart similar to the various method employed for the pie chart and bubble chart examples provided above.","Embodiments other than the embodiments shown in  may be provided in accordance with the present invention. For example, the present invention may be used optimize the position of labels on a line graph, within a photograph, or in conjunction with other visual data objects.",{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 5","b":["500","500","502","504","506","504","508"]},"As used herein, document  is a computer-readable file that includes user-readable information, such as text and graphics. Document  may be viewed and edited by a user through a user interface of the application program . Exemplary types of documents include, but are not limited to, a spreadsheet, a presentation, or a conventional text document. Thus, depending on the type of document, application program  may be, for example, but not limited to, MICROSOFT \u201cWORD\u201d, \u201cPOWERPOINT\u201d, \u201cEXCEL\u201d, or other application program. By way of example, as shown on screen , document  is a \u2018Presentation,\u2019 which is often, but not always, associated with \u201cPOWERPOINT\u201d.","Particularly relevant to the present description is chart  in the presentation. Chart  shown in the particular implementation of  is a column chart. In accordance with other implementations, chart  is not limited to a column chart, but can be any other type of chart, such as, but not limited to, a pie chart, a line chart, a scatter plot, a photograph, or other visual data objects. The various data in chart  is originally specified by document . Document  specifies chart  with a chart definition called chart object .","Chart object  defines the chart  in terms of chart elements. Generally, a chart element is a data unit representing an aspect of a chart. Typically a chart element represents an aspect of the chart in relation to the information that the chart conveys or the type of chart. Exemplary chart elements include bars (e.g., for a bar chart), chart axis, chart legends, chart titles, chart labels, element colors, text fonts, element locations, data sources and so on. Chart elements may be referred to as anchors with relation to a label. One implementation of chart object  is a set of extensible markup language (XML). To illustrate, an example XML from chart object  is shown below:",{"@attributes":{"id":"p-0035","num":"0034"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"- <c:Chart xmlns:c=\u201cchart\u201d xmlns:s=\u201cshape\u201d>"]},{"entry":[{},"\u2003- <c:Scaling>"]},{"entry":[{},"\u2003\u2003\u2003<c:ScaleID>0<\/c:ScaleID>"]},{"entry":[{},"\u2003\u2003\u2003<c:Orientation>MinMax<\/c:Orientation>"]},{"entry":[{},"\u2003\u2003<\/c:Scaling>"]},{"entry":[{},"\u2003- <c:Scaling>"]},{"entry":[{},"\u2003\u2003\u2003<c:ScaleID>1<\/c:ScaleID>"]},{"entry":[{},"\u2003\u2003\u2003<c:Orientation>MinMax<\/c:Orientation>"]},{"entry":[{},"\u2003\u2003<\/c:Scaling>"]},{"entry":[{},"\u2003\u2003<c:Name>Chart 1<\/c:Name>"]},{"entry":[{},"\u2003- <c:PlotArea>"]},{"entry":[{},"\u2003\u2003<c:Shape \/>"]},{"entry":[{},"- <c:Graph>"]},{"entry":[{},"\u2003\u2003<c:Type>Column<\/c:Type>"]},{"entry":[{},"\u2003\u2003<c:SubType>Clustered<\/c:SubType>"]},{"entry":[{},"\u2003\u2003<c:Overlap>0<\/c:Overlap>"]},{"entry":[{},"\u2003\u2003<c:ScaleID>0<\/c:ScaleID>"]},{"entry":[{},"\u2003\u2003<c:ScaleID>1<\/c:ScaleID>"]},{"entry":[{},"\u2003- <c:Series>"]},{"entry":[{},"\u2003\u2003<c:Index>0<\/c:Index>"]},{"entry":[{},"\u2003\u2003<c:Name>Series 1<\/c:Name>"]},{"entry":[{},"\u2003- <c:Shape>"]},{"entry":[{},"\u2003\u2003- <s:Fill>"]},{"entry":[{},"\u2003\u2003\u2003- <s:Pattern>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Title>Wide upward diagonal<\/s:Title>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Color>black<\/s:Color>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Color2>white<\/s:Color2>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/s:Pattern>"]},{"entry":[{},"\u2003\u2003\u2003<\/s:Fill>"]},{"entry":[{},"\u2003\u2003- <s:Border>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<s:Weight>0<\/s:Weight>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<s:Solid>black<\/s:Solid>"]},{"entry":[{},"\u2003\u2003\u2002<\/s:Border>"]},{"entry":[{},"\u2003\u2003<\/c:Shape>"]},{"entry":[{},"\u2003- <c:DataLabels>"]},{"entry":[{},"\u2003\u2003- <c:Shape>"]},{"entry":[{},"\u2003\u2003\u2003- <s:Font>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:FontName>Arial<\/s:FontName>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Size>18<\/s:Size>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:AutoScale \/>"]},{"entry":[{},"\u2003\u2003\u2003<\/s:Font>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Shape>"]},{"entry":[{},"\u2003\u2003- <c:Number>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:FormatString>0.0<\/c:FormatString>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Number>"]},{"entry":[{},"\u2003\u2003\u2003<c:ShowValue \/>"]},{"entry":[{},"\u2003\u2003<\/c:DataLabels>"]},{"entry":[{},"\u2003- <c:Category>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:DataSource>0<\/c:DataSource>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:Data>Sheet1!$A$1:$A$3<\/c:Data>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Category>"]},{"entry":[{},"\u2003\u2003- <c:Value>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:DataSource>0<\/c:DataSource>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:Data>Sheet1!$B$1:$B$3<\/c:Data>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Value>"]},{"entry":[{},"\u2003\u2003\u2002<\/c:Series>"]},{"entry":[{},"\u2003\u2003\u2002<c:PlotVisible \/>"]},{"entry":[{},"\u2003\u2003<\/c:Graph>"]},{"entry":[{},"\u2003- <c:Axis>"]},{"entry":[{},"\u2003\u2003\u2003<c:Placement>Bottom<\/c:Placement>"]},{"entry":[{},"\u2003\u2003\u2003<c:AxisID>0<\/c:AxisID>"]},{"entry":[{},"\u2003\u2003\u2003<c:ScaleID>0<\/c:ScaleID>"]},{"entry":[{},"\u2003\u2003\u2003<c:CrossingAxis>1<\/c:CrossingAxis>"]},{"entry":[{},"\u2003\u2003- <c:Shape>"]},{"entry":[{},"\u2003\u2003\u2003- <s:Font>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:FontName>Arial<\/s:FontName>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Size>18<\/s:Size>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:AutoScale \/>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/s:Font>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Shape>"]},{"entry":[{},"\u2003\u2003- <c:Number>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:SourceLinked \/>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:BuiltInFormat>0<\/c:BuiltInFormat>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/c:Number>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:MajorTick>None<\/c:MajorTick>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:TickMarkSkip>1<\/c:TickMarkSkip>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:Type>Automatic<\/c:Type>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Axis>"]},{"entry":[{},"\u2003\u2003- <c:Axis>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:Placement>Left<\/c:Placement>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:AxisID>1<\/c:AxisID>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:ScaleID>1<\/c:ScaleID>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:CrossingAxis>0<\/c:CrossingAxis>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:CrossesAt>Minimum<\/c:CrossesAt>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:CrossBetween>Between<\/c:CrossBetween>"]},{"entry":[{},"\u2003\u2003- <c:Shape>"]},{"entry":[{},"\u2003\u2003\u2003- <s:Font>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:FontName>Arial<\/s:FontName>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:Size>18<\/s:Size>"]},{"entry":[{},"\u2003\u2003\u2003\u2003\u2003<s:AutoScale \/>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<\/s:Font>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Shape>"]},{"entry":[{},"\u2003\u2003- <c:Number>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:SourceLinked \/>"]},{"entry":[{},"\u2003\u2003\u2003\u2003<c:BuiltInFormat>0<\/c:BuiltInFormat>"]},{"entry":[{},"\u2003\u2003\u2003<\/c:Number>"]},{"entry":[{},"\u2003\u2003\u2003<c:MajorTick>Cross<\/c:MajorTick>"]},{"entry":[{},"\u2003\u2003\u2003<c:MinorTick>Cross<\/c:MinorTick>"]},{"entry":[{},"\u2003\u2003\u2003<c:Type>Value<\/c:Type>"]},{"entry":[{},"\u2003\u2003\u2003<c:MajorUnit>5<\/c:MajorUnit>"]},{"entry":[{},"\u2003\u2003<\/c:Axis>"]},{"entry":[{},"\u2003<\/c:PlotArea>"]},{"entry":[{},"<\/c:Chart>"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}}}},"Document  typically also has other document data , which includes, but is not limited to, text and formatting information. In accordance with one implementation, when application program  is launched and document  is opened, chart object  is passed to graphics interface  of graphics module  for rendering.","Graphics interface  determines what type of graphic is represented by the chart object . Types of graphics that may be handled by the graphics interface  include, but are not limited to, diagrams, charts, or arbitrary shapes. Chart object  includes an identifier that indicates that it defines a chart. Based on the chart identifier, graphics interface  determines that chart object  defines a chart and sends it to charting module .","Charting module  includes translation engine  that translates Chart object  into a form that graphics module  uses for rendering chart  to screen . Specifically, translation engine  translates chart object  into shape-based chart definition . As its name suggests, shape-based chart definition  defines the chart in terms of shapes, rather than chart elements. Use of shapes can improve the chart rendering process, chart appearance, and chart manipulation, by allowing for a mechanism for interacting with graphics.","In the translation process, translation engine  performs a number of operations. For example, translation engine  retrieves data (e.g., numerical data) that makes up chart  from data source(s) referenced in chart object . The data source(s) may be document  itself, or some other source, such as, but not limited to, another document, a database, a file, the Internet, or a queue. In addition to the data, translation engine  may retrieve numerical formatting information that describes how the data is formatted. Numerical formatting information includes, but is not limited to a currency symbol, number of decimal points, percentage or fraction format, or date and time format.","Translation engine  also translates the chart elements into shapes, such as lines, rectangles, circles, triangles, and so on. A shape is a data unit that simply represents the visual appearance of a chart element and is not tied to, or reliant upon, the underlying numerical chart data. Thus, for example, a bar in chart object  will be translated into a rectangle in shape-based chart definition ; a chart axis will be translated into a line, and so on.","In addition, translation engine  groups selected related shapes to facilitate manipulation of related shapes by the user. Graphics interface  provides functions that allow a user to interact with groups of related shapes. Translation engine  takes advantage of those functions by grouping related chart elements such as, but not limited to, related data labels and related data series. After retrieving the data, translating chart elements into shapes, and grouping related shapes, translation engine  generates shape-based chart definition .","An implementation of the shape-based chart definition  is composed of XML code. To illustrate, XML code from an exemplary shape-based chart definition  is shown below:",{"@attributes":{"id":"p-0043","num":"0042"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"- <group>"},{"entry":"\u2003<id>Chart<\/id>"},{"entry":"- <shapes>"},{"entry":"- <rect>"},{"entry":"\u2003<id>ChartArea<\/id>"},{"entry":"\u2003<style>margin-left:0;margin-top:9.75pt;width:501pt;height:319.5pt;z-"},{"entry":"index:1<\/style>"},{"entry":"- <border>"},{"entry":"\u2003<Solid>black<\/Solid>"},{"entry":"\u2003<Weight>0<\/Weight>"},{"entry":"\u2003<\/border>"},{"entry":"\u2003<\/rect>"},{"entry":"- <group>"},{"entry":"\u2003<id>Series 1<\/id>"},{"entry":"\u2003<style>margin-left:88.5pt;margin-"},{"entry":"top:60pt;width:359.25pt;height:220.5pt;z-index:3<\/style>"},{"entry":"\u2003<coordorigin>438,743<\/coordorigin>"},{"entry":"\u2003<coordsize>479,294<\/coordsize>"},{"entry":"- <Fill>"},{"entry":"- <Pattern>"},{"entry":"\u2003<Title>Wide upward diagonal<\/Title>"},{"entry":"\u2003<Color>black<\/Color>"},{"entry":"\u2003<Color2>white<\/Color2>"},{"entry":"\u2003<\/Pattern>"},{"entry":"\u2003<\/Fill>"},{"entry":"- <border>"},{"entry":"\u2003<Solid>black<\/Solid>"},{"entry":"\u2003<Weight>0<\/Weight>"},{"entry":"\u2003<\/border>"},{"entry":"- <shapes>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Point 1<\/id>"},{"entry":"\u2003<style>left:438;top:839;width:80;height:198<\/style>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Point 2<\/id>"},{"entry":"\u2003<style>left:638;top:743;width:80;height:294<\/style>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Point 3<\/id>"},{"entry":"\u2003<style>left:837;top:931;width:80; height:106<\/style>"},{"entry":"\u2003<\/rect>"},{"entry":"\u2003<\/shapes>"},{"entry":"\u2003<\/group>"},{"entry":"- <group>"},{"entry":"\u2003<id>Y Axis<\/id>"},{"entry":"- <border>"},{"entry":"\u2003<Solid>black<\/Solid>"},{"entry":"\u2003<Weight>0<\/Weight>"},{"entry":"\u2003<\/border>"},{"entry":"- <shapes>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Line<\/id>"},{"entry":"\u2003<style>z-index:4<\/style>"},{"entry":"\u2003<from>45pt,32.25pt<\/from>"},{"entry":"\u2003<to>45pt,280.5pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 1<\/id>"},{"entry":"\u2003<style>z-index:5<\/style>"},{"entry":"\u2003<from>40pt,281pt<\/from>"},{"entry":"\u2003<to>48pt,281pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 2<\/id>"},{"entry":"\u2003<style>z-index:6<\/style>"},{"entry":"\u2003<from>40pt,256pt<\/from>"},{"entry":"\u2003<to>48pt,256pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 3<\/id>"},{"entry":"\u2003<style>z-index:7<\/style>"},{"entry":"\u2003<from>40pt,231pt<\/from>"},{"entry":"\u2003<to>48pt,231pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 4<\/id>"},{"entry":"\u2003<style>z-index:8<\/style>"},{"entry":"\u2003<from>40pt,207pt<\/from>"},{"entry":"\u2003<to>48pt,207pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 5<\/id>"},{"entry":"\u2003<style>z-index:9<\/style>"},{"entry":"\u2003<from>40pt,182pt<\/from>"},{"entry":"\u2003<to>48pt,182pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 6<\/id>"},{"entry":"\u2003<style>z-index:10<\/style>"},{"entry":"\u2003<from>40pt,157pt<\/from>"},{"entry":"\u2003<to>48pt,157pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 7<\/id>"},{"entry":"\u2003<style>z-index:11<\/style>"},{"entry":"\u2003<from>40pt,132pt<\/from>"},{"entry":"\u2003<to>48pt,132pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 8<\/id>"},{"entry":"\u2003<style>z-index:12<\/style>"},{"entry":"\u2003<from>40pt,108pt<\/from>"},{"entry":"\u2003<to>48pt,108pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 9<\/id>"},{"entry":"\u2003<style>z-index:13<\/style>"},{"entry":"\u2003<from>40pt,83pt<\/from>"},{"entry":"\u2003<to>48pt,83pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 10<\/id>"},{"entry":"\u2003<style>z-index:14<\/style>"},{"entry":"\u2003<from>40pt,57pt<\/from>"},{"entry":"\u2003<to>48pt,57pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 11<\/id>"},{"entry":"\u2003<style>z-index:15<\/style>"},{"entry":"\u2003<from>40pt,33pt<\/from>"},{"entry":"\u2003<to>48pt,33pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 12<\/id>"},{"entry":"\u2003<style>z-index:16<\/style>"},{"entry":"\u2003<from>38.25pt,281pt<\/from>"},{"entry":"\u2003<to>49.5pt,281pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 13<\/id>"},{"entry":"\u2003<style>z-index:17<\/style>"},{"entry":"\u2003<from>38.25pt,157pt<\/from>"},{"entry":"\u2003<to>49.5pt,157pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"- <line>"},{"entry":"\u2003<id>Y Axis Tick Mark 14<\/id>"},{"entry":"\u2003<style>z-index:18<\/style>"},{"entry":"\u2003<from>38.25pt,33pt<\/from>"},{"entry":"\u2003<to>49.5pt,33pt<\/to>"},{"entry":"\u2003<\/line>"},{"entry":"\u2003<\/shapes>"},{"entry":"\u2003<\/group>"},{"entry":"- <line>"},{"entry":"\u2003<id>X Axis<\/id>"},{"entry":"\u2003<style>z-index:19<\/style>"},{"entry":"\u2003<from>44.25pt,281pt<\/from>"},{"entry":"\u2003<to>492.75pt,281pt<\/to>"},{"entry":"- <border>"},{"entry":"\u2003<Solid>black<\/Solid>"},{"entry":"\u2003<Weight>0<\/Weight>"},{"entry":"\u2003<\/border>"},{"entry":"\u2003<\/line>"},{"entry":"- <group>"},{"entry":"\u2003<id>Series 1 DataLabels<\/id>"},{"entry":"\u2003<style>margin-left:106.5pt;margin-"},{"entry":"top:33pt;width:324pt;height:164.25pt;z-index:20<\/style>"},{"entry":"\u2003<coordorigin>462,707><\/coordorigin>"},{"entry":"\u2003<coordsize>432,219<\/coordsize>"},{"entry":"- <Font>"},{"entry":"\u2003<FontName>Arial<\/FontName>"},{"entry":"\u2003<Size>18<\/Size>"},{"entry":"\u2003<AutoScale \/>"},{"entry":"\u2003<\/Font>"},{"entry":"- <shapes>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Series 1 DataLabel 1<\/id>"},{"entry":"\u2003<style>left:462; top:803;width:33; height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>6.0<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Series 1 DataLabel 2<\/id>"},{"entry":"\u2003<style>left:661;top:707; width:33;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>8.9<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Series 1 DataLabel 3<\/id>"},{"entry":"\u2003<style>left:861;top:895; width:33;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>3.2<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"\u2003<\/shapes>"},{"entry":"\u2003<\/group>"},{"entry":"- <group>"},{"entry":"\u2003<id>Y Axis Labels<\/id>"},{"entry":"\u2003<style>margin-left:10.5pt;margin-"},{"entry":"top:22.5pt;width:19.5pt;height:271.5pt;z-index:21<\/style>"},{"entry":"\u2003<coordorigin>334,693<\/coordorigin>"},{"entry":"\u2003<coordsize>26,362<\/coordsize>"},{"entry":"- <Font>"},{"entry":"\u2003<FontName>Arial<\/FontName>"},{"entry":"\u2003<Size>18<\/Size>"},{"entry":"\u2003<AutoScale \/>"},{"entry":"\u2003<\/Font>"},{"entry":"- <shapes>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Y Axis Labels 0<\/id>"},{"entry":"\u2003<style>left:347;top:1024; width:13;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>0<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Y Axis Labels 5<\/id>"},{"entry":"\u2003<style>left:347;top:858; width:13;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>5<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>Y Axis Labels 10<\/id>"},{"entry":"\u2003<style>left:334;top:693; width:26;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"\u2003stroked=\u201cf\u201d>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>10<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"\u2003<\/shapes>"},{"entry":"\u2003<\/group>"},{"entry":"- <group>"},{"entry":"\u2003<id>X Axis Labels<\/id>"},{"entry":"\u2003<style>margin-left:112.5pt;margin-"},{"entry":"top:296.25pt;width:312pt;height:23.25pt; z-index:22<\/style>"},{"entry":"\u2003<coordorigin>470,1058<\/coordorigin>"},{"entry":"\u2003<coordsize>416,31<\/coordsize>"},{"entry":"- <shapes>"},{"entry":"- <rect>"},{"entry":"\u2003<id>X Axis Labels Category 1<\/id>"},{"entry":"\u2003<style>left:470;top:1058; width:15;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>A<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>X Axis Labels Category 2<\/id>"},{"entry":"\u2003<style>left:670;top:1058; width:16;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>B<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"\u2003<\/rect>"},{"entry":"- <rect>"},{"entry":"\u2003<id>X Axis Labels Category 3<\/id>"},{"entry":"\u2003<style>left:869;top:1058; width:17;height:31;wrap-style:none;text-"},{"entry":"anchor:top<\/style>"},{"entry":"- <textbox style=\u201cfit-shape-to-text:t\u201d inset=\u201c0,0,0,0\u201d>"},{"entry":"\u2003<div style=\u201ctext-align:left\u201d>C<\/div>"},{"entry":"\u2003<\/textbox>"},{"entry":"<\/rect>"},{"entry":"<\/shapes>"},{"entry":"<\/group>"},{"entry":"<\/shapes>"},{"entry":"<\/group>"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}}}},"Graphics interface  receives shape-based chart definition  and renders chart  on screen  as a set of shapes specified by the shape-based chart definition. Graphics interface  typically performs the rendering by making calls to operating system or display controller functions. For example, in the WINDOWS operating system, graphics interface  may make calls to the graphics display interface (GDI+).","As shown, graphics module  includes a set of graphics services . Graphics services  include services accessible by the application program for manipulating chart . Graphics services  provide one or more application programming interface(s) (API) to access the services.","Because graphics module  renders shapes, graphics services  are able to offer high-level functions for manipulating chart . Graphics services  can, for example, perform vector-graphics functions on shapes within the chart. To illustrate, a rectangle can be moved easily by calling a single function of graphics services  that moves a shape, rather than calling numerous low-level functions to redraw the rectangle in a new location. In addition, graphics module  is common to multiple application programs, so that shape manipulation\/editing and appearance will be consistent among the application programs. Thus, graphics module  can present a graphics user interface for editing shapes in chart , regardless of the type of application program .","Label Optimization  is the code directed to the present invention within system . Label Optimization  receives shape-based chart definition  and optimizes the position of the labels according to the optimization algorithm. As previously stated, shape-based chart definition  allows the labels to be easily moved since they are defined by their shape rather than by other low-level functions that would require the labels to be redrawn. Label Optimization  may be utilized before or after chart  is rendered on screen  to optimize the positioning of the labels. For example, positioning of the labels according to the optimization algorithm may be automatic for every chart rendered. In contrast, optimization of the labels may be provided according to a user selection, where the user affirmatively selects to have the labels optimized. In one embodiment, labels that are manually positioned by the user are ignored during the optimization process.","The term module is used in a general sense to describe a component that is operable to perform one or more designated functions. A module may be implemented in various ways and forms. For example, a module may be implemented in or as hardware, software, firmware, or in various combinations of hardware, software, and\/or firmware, depending on such factors as speed, cost, size, etc. For example, and without limitation, in one implementation each of the modules in the system  comprises software, such as a dynamic link library (DLL), that is stored on a computer-readable medium and executed on a computing system, such as the computing system described above with respect to .",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 6"},"Implementing exemplary algorithm  requires the specification of different functions. The InitializeLayout( ) function defines the initial placement for each of the visual elements and thereby provides a starting point for the search. The PerturbLayout( ) function corresponds to the perturb function previously described and provides a method for changing a given layout into a new layout. The RevertLayout( ) function inverts the actions of PerturbLayout( ) to go from the new layout back to the previous layout. The Random( ) function returns a number between 0.0 and 1.0. Finally, the ScoreLayout( ) function, which corresponds to the objective function previously described, computes how close the current layout is to optimal. In one embodiment, the termination condition may vary according to time limits for achieving a usable layout, the proximity of the layout to optimal, and other factors. In another embodiment, scores are defined to be positive and the lower the score the better the layout. Therefore, the goal is to minimize the score according to the constraints used. The score that is acceptable for a layout to be used, depends on the termination condition of the algorithm.","As shown in the pseudo-code, the algorithm accepts all good moves within the search space and, with a probability that is an exponential function of a temperature T, accepts some bad moves as well. As the algorithm progresses, T is annealed (or decreased), resulting in a decreasing probability of accepting bad moves. Accepting bad moves in this manner allows the algorithm to escape local minima in the score function.","The constraints defined for providing the optimal layout of the labels may include constraints such as minimizing the distance from the anchor, minimizing the overlap of the labels, minimizing the overlap with elements, font restrictions, orientation restrictions, and other limitations that affect how a label may be manipulated. Any number of constraints may be fed into the algorithm for manipulating the labels to optimize their position with the viewable space.","The above specification, examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention, the invention resides in the claims hereinafter appended."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
