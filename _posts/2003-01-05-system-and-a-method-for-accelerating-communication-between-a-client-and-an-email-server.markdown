---
title: System and a method for accelerating communication between a client and an email server
abstract: The communication between a remote email or application program and the server to which it interfaces, such as a mailbox exchange server, is improved. The present invention operates by tricking or controlling the application program in such away that the application program operates as thought it is on-line although in actuality it is off-line. This is accomplished by spoofing the application program and as a result, the application program operates off-line but the user has on-line type experience. More specifically, the present invention replaces the MAPI/RPC as the transport provider while the user is operating the application program in an off-line mode. The data transfer between the email application program and the email server is handled by the present invention in the background. On the server end of the connection, the present invention operates to spoof the server and thus causes the server to operate as though the remote customer is an interactive user presently connected to the domain.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07447745&OS=07447745&RS=07447745
owner: Flash Networks, Ltd
number: 07447745
owner_city: Herzliya
owner_country: IL
publication_date: 20030105
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATION","TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application claims the priority of U.S. Provisional Patent Application No. 60\/346,683 filed Jan. 7, 2002, entitled \u201cA SYSTEM AND A METHOD FOR ACCELERATING COMMUNICATION BETWEEN CLIENT AND MS EXCHANGE SERVER\u201d and International Application Number PCT\/IL03\/00014 fled on Jan. 5, 2003 and entitled \u201cA SYSTEM AND A METHOD FOR ACCELERATING COMMUNICATION BETWEEN CLIENT AND AN EMAIL SERVER\u201d the subject matter of which are hereby incorporated by reference.","The present invention relates to the field of data communications and, more specifically, to the enhancement of transferring data throughput in communication system between an Email Server and a client utilizing Email software.","Historically, in server based networks serving one or more clients, the servers have utilized powerful computers while the client computers have utilized computers possessing limited computing power and limited storage capacity. Generally, communication between the clients and the servers has been enabled through the use of a LAN (Local Area Network) using a high capacity communication link and generating a domain.","A domain is a group of computers and devices on a network that are administered as a unit with common rules and procedures. Within the Internet, domains are defined by the IP address that is assigned. All devices sharing a common part of the IP address are said to be in the same domain.","Therefore, in client\/server architectures, the storage and the processing is primarily performed on the server side while the client computer operates as a terminal and an interface unit between the user and the server. Obviously, this type of an architecture results in heavy transportation of information between the client and the server. It should be noted that the terms \u201cclient\u201d and \u201cuser\u201d are used interchangeably herein.","In recent years, the portable computer has experienced explosive growth in utilization, as well as in the performance capabilities, features, processing power, memory availability and capabilities. There has also been a great deal of expansion in use and availability of the global data communication network known as the Internet, and the use of portable communication systems like, but not limited to, cellular or satellite systems.","It is desirable for an enterprise that is using a client\/server architecture, for example MICROSOFT OUTLOOK and the MS exchange server, to provide users with the ability to access their MS Office documents and E-mail messages while being out of the office and connected through the Internet via telephone lines or a wireless network, like but not limited to Cellular or Satellite networks. Outlook is Microsoft's mail client and personal information manager. The full version includes a PIM (Personal Information Manager) calendaring, to-do list and groupware functions. OUTLOOK also provides a journaling capability for keeping track of hourly billing. OUTLOOK can be used as the client end to MICROSOFT'S Exchange Server or as the e-mail client with any ISP (Internet Service Provider) account. The paragraphs that follow refer to an MS exchange server as an example of an Email Server of the present invention, and to OUTLOOK as an example of an Email application.","One technical hurdle, in meeting this desire, is that the wireless communication systems or networks have a limited bandwidth. Using such limited bandwidth networks to replace a LAN results in increasing the communication time between the remote users and reduces the quality of the connection.","Therefore there is a need in the art for a system and a method that can reduce the transportation between a remote user and a server in an on-line operation. Such a system can increase the speed of the communication. Further, there is a need in the art for a system and method to reduce the transportation between a remote user and a server over a wireless communication channel.","A specific example of this need can be seen in the setting of a user mailbox within an exchange server. In this setting, the user mailbox is part of the exchange server information store. The information store consists of three implementations of MAPI message stores: the public information store, the private information store, and the personal folder store (PST). MAPI is an abbreviation of Messaging Application Programming Interface, a system built into Microsoft Windows that enables different e-mail applications to work together to distribute mail. As long as both applications are MAPI-enabled, they can share mail messages with each other. The paragraphs that follow refer to MAPI as an example of an application programming interface of the present invention.","The information store organization of public folders, private folders, and messages is referred to as the organization hierarchy. Another implementation of a MAPI message store is configured when a user works offline or not connected to the exchange server. This message store is called the offline folder store (OST) and the content and structure of the OST mirrors the mailbox while offline.","A mailbox is the delivery location for all incoming mail messages addressed to a designated owner. Information in a user's mailbox is stored in the private information store on a Microsoft Exchange Server computer. A mailbox can contain received messages, message attachments, folders, folder hierarchy, and more.","OUTLOOK uses MAPI over Remote Procedure Calls (RPC) as it's transport provider to connect the user to its mailbox that resides physically at the exchange server as part of the information store. RPC is a call that is based on a client server model. Procedures that are called within the client application are actually performed within the server side over a communication channels. The MAPI transport provider and the MAPI message store, called the exchange server service, are tightly coupled in such a way, that it is impossible to use only the MAPI message store and a different transport provider and still maintain the provision of all the services the Exchange server service offers.","Using RPC as the communication between a remote user and its mailbox at the exchange server over low bandwidth is very slow and has a lot of communication overhead. When the user uses OUTLOOK in the offline mode, outgoing messages are kept in the user outbox in its offline folders, and incoming messages are kept for him at the exchange server. When the user is going back online, the exchange server and outlook synchronize those messages. This process results in a significant amount of data transfer to occur, depending on the amount of traffic received and the time that the user has been off line. In a wireless configuration, this process can absorb a significant percentage of the available bandwidth. Thus, there is a need in the art for a method to reduce the transportation between a remote user and a server in an on-line operation when large amounts of data, such as during a synchronization function, is necessary.","The present invention provides a system and a method that improves the on-line operation between a remote email or application program and the exchange server to which it interfaces, such as a mailbox exchange server. The present invention operates by tricking or controlling the email application program in such away that the email application program operates as it is on-line although it is off-line. In an embodiment of the present invention, this is accomplished by spoofing the OUTLOOK application program and as a result, the OUTLOOK system operates off-line but the user has on-line type experience.","More specifically, the present invention replaces the MAPI\/RPC as the transport provider while the user is operating the email application program in an off-line mode. The data transfer between the email application program and the email server is handled by the present invention in the background. On the server end of the connection, the present invention operates to spoof the server and thus causes the server to operate as though the remote customer is an interactive user presently connected to the domain.","Another aspect of the present invention is using the multi-tasking feature of an NT machine to overcome the MAPI session limitation of an Exchange Server. The Exchange Server operates to enable only a limited number of MAPI sessions per interactive user's computer. The present invention overcomes this limitation by generating a separate task for each active remote user (a User Agent (UA)). This method of spoofing the Exchange Server enables the Exchange server to support a plurality of remote users via a single NT\/Win2000 machine or equivalents.","An exemplary embodiment of present invention may include, but is not limited to, two logical modules that work within the client\/server architecture:","(1) A Domain Logical Module (DM), which is installed on an NT machine or similar machine and has a computer account in the domain; and","(2) A Client Logical Module (CM), which is installed in the client's computer as an extension of the mail program.","The present invention may be a DLL OUTLOOK extension\/add-in, and replaces the MAPI\/CDO as the transport provider. CDO, or Collaboration Data Objects is a technology for building messaging or collaboration applications. DLL is short for Dynamic Link Library, a library of executable functions or data that can be used by a Windows application. Typically, a DLL provides one or more particular functions and a program accesses the functions by creating either a static or dynamic link to the DLL. A static link remains constant during program execution while a dynamic link is created by the program as needed. DLLs can also contain just data. DLL files usually end with the extension \u201c.dll\u201d. A DLL can be used by several applications at the same time. Some DLLs are provided with the Windows operating system and available for any Windows application. Other DLLs are written for a particular application and are loaded with the application as in the exemplary embodiment of the present invention.","CDO is the bridge from Visual Basic and scripting languages to MAPI. CDO exposes COM objects, but these COM objects are of the right nature to be accessible through both languages.","The present invention may be used in conjunction with an additional system, which operates to accelerate the communication over a problematic network channel such as, but not limited to cellular, satellite or other wireless channels. This additional system may operate to compress or otherwise modify the communication protocol to create a more efficient protocol or make other changes and adjustments. Examples of such additional systems include NettGain 1100 of Flash Networks. If the accelerating system is used, two additional modules may be needed\u2014one in each end of the problematic line. However, it should be noted that these additional modules are not required elements of the present invention but rather, can be incorporated into the present invention. These additional modules include:","Client Booster (C. BST).","Gateway Booster (G. BST).","The present invention supports substantially all OUTLOOK built-in forms, such as the E-mail messages, appointments, contacts, calendar, tasks etc.","Other objects, features, and advantages of the present invention will become apparent upon reading the following detailed description of the embodiments with the accompanying drawings and appended claims.","Referring now to the drawings, in which like numerals refer to like parts throughout the several views, exemplary embodiments of the present invention are described.",{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 1","b":"100"},"A plurality of laptop computers to are connected via cellular connections  to a gateway (GW) , which can be located in a particular cell or in an operator station. The laptop computers  may represent any portable devices that use MAPI messages services for communicate with an exchange server, like but not limited to palm computers, cellular phones etc., and will collectively be referred to as client .","The communication over connection channels  can be based on TCP\/IP or, it can be based on a proprietary accelerating protocol. In case of using a proprietary accelerating protocol, two additional modules are needed (one for each end of the line ).","GW  may be connected via a VWB (Very Wide Bandwidth) connection  to the Internet  and from there, via the appropriate Domain Modules (DM), to to the domain of each of the cooperates, to which comprises the appropriate Exchange Server, to ","More than one client  may be connected to the same domain  via the same DM  and be engaged in an interactive connection with the same Exchange Server  simultaneously.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 2","i":"a ","b":["205","205"]},"The CM  comprises several modules including: Event Manager ; format converter ; Messaging System (Mes. Sys.) ; priority queue (Q)  and TCP\/IP module .","The User, operating an email application program in an off-line mode and desiring to send an outgoing message, presses the send button, or its equivalent, and the message is submitted to the outbox. The email application program then indicates to its extensions that a new message is waiting in the outbox. Upon receiving this indication, the Event Manager  calls the Format Converter , which reads the new message in MAPI format and translates it into the Mes. FT. The Mes. FT is a chain of properties, which, among other things, includes the message. The format converter  which translates the MAPI message into the Mes. FT and vice versa, may select part of the properties that are sufficient to reconstruct the right message in the other side of the communication channel.","Mes. Sys.  receives the chain of objects of the new converted message, organizes it into a complete message and sends the complete message to the queue . By using a proprietary messaging format, the present invention has the flexibility to be connected to a mail client and personal information manager system, other than OUTLOOK, by simply modifying the Event Manager  and the Format Converter , to fit the API of the other mail system.","Queue  organizes the messages according to the priority that has been chosen or selected by the user. Queue  is the buffer between OUTLOOK and the network. Transmitting and receiving of the messages are transparent to the user, thus giving the user off-line operation with an on-line experience.","The output of the queue  is transferred to the TCP\/IP module  that handles the communication over TCP\/IP from or to OUTLOOK. The TCP\/IP module  picks a complete message from the queue  and transfers it over TCP\/IP via the configured socket. The TCP\/IP module  also maintains the connection and tries to reconnect to its defined socket in case the connection has been broken.","In the exemplary embodiment of the message is then sent out over TCP\/IP.","Alternatively, in the exemplary embodiment of the message from OUTLOOK is sent via TCP\/IP to a booster unit  that translates the TCP\/IP buffers into a more efficient protocol, manipulates the message to accelerate the communication and sends the transformed message via a proprietary tunnel (BST connection)  to the GW .","In the other direction, when a message is received from the Exchange Server  (), the TCP\/IP module  handles the data on a packet basis and transfers it to the input section of queue . The data from queue  is transferred to Mess. Sys. . The Mess. Sys.  gathers the information from the relevant packets into the whole message and transfers it to the format converter . The format converter  translates the proprietary format back to the MAPI format, and the message is then transferred to its destination (e.g. the inbox, the calendar etc.). In parallel, the Event Manger  sends an indication to the user that the message has arrived at client .","Incoming messages can occur in one of two methods. In one method, a new message notification has been sent to the user's mailbox within the Exchange Server  and wakes up the user agent to start downloading the message. In another method, the user presses the Send\/Receive button on the OUTLOOK menu when the OUTLOOK application is not connected. The Event Manager  that waits for this event, sends a refresh message to the user agent to instruct the user agent to start download new messages.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 3","b":["160","170","170","175","160"]},"The DM  may be an NT machine, a Window 2000 machine etc., and comprises several logical modules including: a TCP\/IP module , a DM priority queue (Q) , Dispatcher  with its Messaging System , and a plurality of User Agents (UA) .","On the upper side, the DM  is connected to an Exchange Server  and on the other side is connected to a plurality of clients  via TCP\/IP connection  over the Internet (not shown in ). Because OUTLOOK in the client computer  is operating in off-line mode, the transportation between the CM  and the DM  is carried by a proprietary Transport Provider over the TCP\/IP connection .","The TCP\/IP logical module  handles the incoming data from the remote user, via the configured socket, on a packet basis, processes them according to the protocol and transfers the data to the input section of queue . The TCP\/IP module  also maintains the connection and tries to reconnect to its defined socket in case the connection has been broken.","The data from the input section of queue  is grabbed by the Dispatcher Mess. Sys. . The Dis. Mess. Sys.  pulls the information, organizes it into a message and transfers the message to the Dispatcher .","Dispatcher  reads the envelop of the message and, based on its current dispatching list, determines whether the source of the message is a new remote user . If the source of the message is a new user, the Dispatcher  assigns a free User Agent  to the new user, adds this assignment to its dispatching list and submits the message to the selected UA . If the source of the message is not a new user, the Dispatcher , based on the dispatching list, transfers the message to the appropriate UA .","UA  represents its assigned user in front of the Exchange Server . The UA  performs login and logout in the name of current user of the remote client , spoofing the Exchange Server  into operating as though the remote user is connected locally to the domain and operating as an interactive user, who receives and transmits OUTLOOK messages and mail.","A UA  comprises of priority queue logical module , Mes. Sys. logical module , format converter logical module  and Event Manager logical module .","Uploaded messages from the remote user are submitted by the Dispatcher  to the input section of priority Queue  of the UA . Messaging System  pulls the information from the input section based on its priority, organizes the information into a message in the proprietary messaging format and transfers it to the Format Converter . Format Converter  translates the proprietary messaging format into MAPI\/CDO format and transfers the message in MAPI format to the Event Manager .","Upon receiving a new message from the remote user, the Event Manager  determines whether the message is a Login-request or an Inter Personal Messaging (IPM) message. If the message is a Login-request, the Event Manager  impersonates as the remote user and performs a logon sequence to the Exchange Server  on behalf of this user. The Event Manager  uses the credentials of the remote user that have been collected by the Event Manager  of the CM  and initiates a MAPI session in the Exchange Server . The operation of the UA Event Manager  is described in more detail below.","Moreover, in some embodiments the: UA Event Manager , the Format Converter  and the Mes. Sys.  may be combined into a single logical module or into two logical modules instead of the three modules of the current exemplary embodiment.","Messages from the Exchange Server  to the remote users, which are currently connected to the DM , are processed by the appropriate UA  and submitted to the output section of Priority Queue . The output section of the Priority Queue  of the DM , collects the outgoing messages from each UA . The outgoing messages, from Priority Queue , preferably based at least in part on their priority, are pulled and processed by TCP\/IP logical module  and are sent as packets over TCP\/IP to the appropriate user of remote client .","Alternatively, in another exemplary embodiment (not shown in the drawings) a booster unit may be used between the TCP\/IP logical module  and the network. This booster unit manipulates the transportation into a more efficient protocol, manipulates the message to accelerate the communication and sends the transformed message via a proprietary tunnel (BST connection) to the GW . This unit may perform the complementary operations of the booster unit  in ","As part of the installation process of the CM in its computer, the user is required to select one of its on-line OUTLOOK profiles. The user may generate this profile by using the Windows Mail Configuration within the control panel.",{"@attributes":{"id":"p-0067","num":"0066"},"figref":["FIG. 4","FIGS. 2"],"i":["a ","a","b"],"b":["205","2","410","420","205","422"]},"If at step  the selected profile is a profile that invokes the present invention, the CM , at step , starts the Login process with the user. This step includes prompting the user with a login dialog box, in which the user is required to enter his credentials (user name, password domain name and the Exchange Server name). In one embodiment, the CM  may be configured to take these credentials from the user profile without prompting the user for the dialog box.","The user credentials with additional configuration parameters (for example: compression attributes, the last synchronization time etc.) are sent over the network to the DM  () at step , using the TCP connection  (&) or via a booster system  in case that such a system exists. Then the CM  is waiting  for receiving a response from DM .",{"@attributes":{"id":"p-0070","num":"0069"},"figref":["FIG. 4","FIG. 3","FIG. 3"],"i":"b ","b":["160","350","360","360","350","360","430","350","432","350","430","360","434","350","360","360"]},"Upon receiving the Login-request, at step  the Event Manager  of the selected UA  determines whether it is the first Login-request of this user . If this is not the first Login-request, at step  the Event Manager  () updates the connection parameters and processing continues at step  and retrieves new mail.","However, if it is the first Login-request of a new user  (), processing continues at step  where the selected UA  gets the current client's parameters and starts the impersonation process at step . During the impersonation process, the UA  performs an NT login to the domain , and impersonates the remote user  by using the client credentials. The UA  then creates an OUTLOOK profile for this new client, on the machine on which the DM  runs, pretending that it is the remote client and at step , starts a MAPI session to the Exchange Server.","At step , if the credentials of the user are valid and the login succeeds, at step  the UA  sends a Login-success message to the CM  and the CM  processing continues at point B in In parallel, the UA  processing continues at step  to synchronizes the mailbox.","At step , if the credentials of the user are not valid and the login fails, the UA  enters the login fail process at step  which sends a Login-fail message to the CM  and causes the CM  to continue processing at point B in Then, the UA  provides notice to the Dispatcher  about the disconnection and enters into a free position. The Dispatcher  updates its assignment table by removing this assignment.","At step  the UA  retrieves all new messages, which have arrived to the user's mailbox (within the exchange server) between the last login and the current login, and sends these messages to the remote client  via the CM . Then at step , the UA  registers itself for new message notification within the user's mailbox.","From this point forward, as long as there is a valid connection between the client  and the DM , the new messages will be automatically downloaded to the user's off-line mailbox through the DM  and CM  (&).","Returning now to the operation of the CM , point B, upon receiving the response for the Login-request, at step  the CM  determines whether the login has been successful. If the login has been successful, at step  the CM  waits for the next event, which may be incoming mails from the Exchange Server or outgoing messages from the user . If the login fails, the CM  sends  a Login-fail indication to the user  and processing continues at step  where the CM  prompt the user to login again.",{"@attributes":{"id":"p-0078","num":"0077"},"figref":"FIG. 5","b":["205","205","510","205","520","540"]},"If the event arrives from the OUTLOOK outbox, which means that the user has sent a new message, processing continues at step . The new message may be mail, calendar, task etc. At step , the CM  grabs the message from the outbox and pushes it via the chain comprising the Format Converter , the Mes. Sys. , the output section of priority queue  and the TCP\/IP module  and at step  sends the message over the network as described above in conjunction with The CM  then returns to step  to wait for the next event.","If the event arrives from the TCP\/IP connection indicating that new message arrives from DM  (), processing continues at step . The message may be a mail, calendar, task etc. message. At step , the CM  grabs the message via the chain as described above, and at step  determines the type of the message. If the type of the message  is mail or calendar, at step  the CM  pushes the message into the inbox of the remote client  and at step , sends an indication to the user. Then the CM  returns to step  and waits for the next event.","If the type of the message is an error message , at step  the CM tries to reconnect again by returning to step  in and continues from there. If the type of the message is login feedback  from the DM , at step  the CM  performs the part of the process, which is described above in conjunction to from point B.",{"@attributes":{"id":"p-0082","num":"0081"},"figref":["FIG. 6","FIG. 3","FIG. 1","FIG. 3"],"b":["360","360","610","360","175","620","350","640"]},"If the event  arrives from the Exchange Server , it means that the client  has received a new message. The new message may be mail, calendar etc. At step , the UA  grabs the message from the inbox of the relevant client  in the Exchange Server , and pushes it via the chain comprising the Format Converter  (), the Mes. Sys.  (), the output section of priority queue  and the TCP\/IP module  (), and at step  sends the message over the network as described above in conjunction with . Then, the UA  returns to step  and waits for the next event.","If the event  arrives from the Dispatcher , it means that the client has sent this new message. The message may be a mail, calendar, login request etc. At step , the UA  grabs the message via the chain as described above and at step  determines the type of the message. If the type of the message is mail or calendar or etc. , then at step  the UA  submits it into the outbox in the Exchange Server  associated with the user . The Exchange Server  () takes responsibility to deliver the message to its destination.","If the type of the message is a disconnection message , then the UA  closes the MAPI session with the Exchange Server  and clears up the allocated resources. Then the UA  provides notice to the Dispatcher  that the connection is broken and waits for new assignment.","If the type of the message is Login-request  from the CM , then at step  the UA  performs  the part of the login process, which is described above, in conjunction to At the end of the login process, the UA  returns to step  and waits for the next event.",{"@attributes":{"id":"p-0087","num":"0086"},"figref":["FIG. 7","FIG. 6"],"b":["360","720","340","360","720","360","725","360","175","730","360","175","175","750","360","350","760"]},"In the description and claims of the present application, each of the verbs, \u201ccomprise\u201d \u201cinclude\u201d and \u201chave\u201d, and conjugates thereof, are used to indicate that the object or objects of the verb are not necessarily a complete listing of members, components, elements or parts of the subject or subjects of the verb.","The present invention has been described using detailed descriptions of embodiments thereof that are provided by way of example and are not intended to limit the scope of the invention. The described embodiments comprise different features, not all of which are required in all embodiments of the invention. Some embodiments of the present invention utilize only some of the features or possible combinations of the features. Variations of embodiments of the present invention that are described and embodiments of the present invention comprising different combinations of features noted in the described embodiments will occur to persons of the art. The scope of the invention is limited only by the following claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 2","i":"a "},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 2","i":"b "},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 4","FIG. 4","FIG. 4","FIG. 4"],"i":["a ","b ","a ","b "]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 6","b":"360"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 7","b":"360"}]},"DETDESC":[{},{}]}
