---
title: Method for measuring structural thickness from low-resolution digital images
abstract: Provided are fuzzy distance transform-based methods, and an algorithm therefor, for analyzing digital images defining a volumetric region of an object from a digital image comprising finding a set of points in the image to generate a fuzzy subset, and calculating the fuzzy distance transform (FDT) of the fuzzy subset. The methods deal with the extraction of object features from digital images acquired at low resolution, specifically, the measurement of structural thickness distribution along an object. Targeted applications comprise, but are not limited to, the measurement of trabecular bone thickness in magnetic resonance or computed tomography images. Also provided are systems and device for utilizing the disclosed methods and algorithm to extract the object features from the digital images.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07769214&OS=07769214&RS=07769214
owner: The Trustees of the University of Pennsylvania
number: 07769214
owner_city: Philadelphia
owner_country: US
publication_date: 20031205
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS REFERENCE TO RELATED APPLICATIONS","GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION","EXAMPLES","Example 1","Application of FDT on a Fuzzy Image","Example 2","Computation of Thickness","Example 3","BVF Imaging","Experiment 1","Performance of the Invention in Various Resolution Regimes.","Experiment 2","Rotation Dependence","Experiment 3","Noise Dependence.","Experiment 4","Reproducibility.","Example 4","Reproducibility of Method In Vivo"],"p":["This application claims priority to U.S. Provisional Application No. 60\/431,129 on Dec. 5, 2002, the content of which is herein incorporated in its entirety.","This invention was supported in part by Grant Nos. RO1 41443 and R21 47112 from the National Institutes of Health. Accordingly, the Government may have certain rights in this invention.","The invention deals with the extraction of object features from digital images acquired at low resolution, specifically, the measurement of structural thickness distribution along an object. Targeted applications comprise, but are not limited to, the measurement of trabecular bone thickness in magnetic resonance or computed tomography images.","Effective tools for object shape analysis are important and useful in many imaging applications including medical ones. One such popular and widely used tool is the distance transform (DT) (Rosenfeld et al., 1:33-61 (1968); Danielsson, 14:227-248 (1980); Borgefors, 27:321-345 (1984); Borgefors, 64:368-376 (1996)) of an object. For a hard (binary) object, DT is a process that assigns a value at each location within the object that is simply the shortest distance between that location and the complement of the object.","However, until very recently this notion of hard DT have not been applicable on fuzzy objects in a meaningful way (Kaufmann, , Vol. 1, Academic Press, New York, 1975; Rosenfeld, 40:76-87 (1979); Bezdek and S. K. Pal, , IEEE Press, New York, 1992). The notion of DT for fuzzy objects, called fuzzy distance transform (FDT), becomes more important in many imaging applications because it is often necessary to deal with situations with data inaccuracies, graded object compositions, or limited image resolution (on the order of an object's structure size).","The notion of fuzzy distance is formulated by first defining the length of a path on a fuzzy subset and then finding the infimum of the lengths of all paths between two points. For the fuzzy distance between two points x and y, the space n is defined as the \u201cinfimum\u201d (Weisstein, , Chapman & Hall\/CRC, Boca Raton, Fla., 1999) of the lengths of all paths between them. The length of a path n in a fuzzy subset of the n-dimensional continuous space is defined as the integral of fuzzy membership values along \u03c0. Generally, there are an infinite number of paths between any two points in a fuzzy subset and it is often not possible to find the shortest path, if it exists. Thus, the fuzzy distance between two points is defined as the infimum of the lengths of all paths between them. It is demonstrated that, unlike in hard convex sets, the shortest path (when it exists) between two points in a fuzzy convex subset is not necessarily a straight-line segment. For any positive number \u03b8\u22661, the \u03b8-support of a fuzzy subset is the set of all points in with membership values greater than or equal to \u03b8. It is shown that, for any fuzzy subset, for any nonzero \u03b8\u22661, fuzzy distance is a metric for the interior of its \u03b8-support.","The FDT is thus defined as a process on a fuzzy subset that assigns to a point its fuzzy distance from the complement of the support. The theoretical framework of FDT in continuous space is extended to digital cubic spaces and it is shown that for any fuzzy digital object, fuzzy distance is a metric for the support of the object. In general, FDT is useful, for example, in feature extraction (Fu et al., 25:1336-1346 (1976)), local thickness or scale computation (Pizer et al., 69:55-71 (1998); Saha et al., 77:145-174 (2000)), skeletonization (Srihari et al., in , Denver, Colo., pp. 44-49 (1979); Tsao et al., 17:315-331 (1981); Saha et al., 30:1939-1955 (1997)), and morphological (Serra, , Academic Press, San Diego, 1982) and shape-based object analyses (Borgefors, \u201cApplications of distance transformations,\u201d in (Arcelli et al., eds.), pp. 83-108, World Scientific, Singapore, 1994). In particular, FDT may be useful in fault detection in integrated circuit chips or in computer motherboard circuits, analysis of the dynamics of a hurricane, etc. FDT will be useful in many medical imaging applications, such as computation of local thickness of trabecular bone or vessels, or morphology-based separation of anatomic structures having similar intensities, e.g., artery-vein separation.","Trabecular or cancellous bone\u2014the type of bone that dominates in the vertebrae and at locations near the joints of long bones (metaphysis and epiphysis)\u2014consists of a network of plates and struts. Bone atrophy as it occurs in osteoporosis, leads to either homogeneous or heterogeneous thinning of the trabecular elements. Besides changes in network connectivity (and thus of the topology of the network) the thickness of the trabeculae most critically determines the mechanical competence and thus resistance to fracture of trabecular bone. Accurate measurement of trabecular thickness is, therefore, of significant interest, for example, to assess the effectiveness of anabolic (bone forming) agents of patients with osteoporosis.","The classical approach toward measuring trabecular thickness has been based on histomorphometry of transiliac bone biopsies (Chavassieux et al., in 2 (Marcus et al., eds.) New York: Academic Press, pp. 501-509 (2001)). Typically, the perimeter of the trabeculae is measured in stained sections, and thickness is approximated as the bone area divided by one half of the perimeter (Parfitt et al., 72:1396-409 (1983)). The emergence of imaging technologies, such as micro computed tomography (\u03bc-CT) (Ruegsegger et al., 58:24-29 (1996)) enables reconstruction of three-dimensional images calling for more elaborate techniques for measuring structural thickness.","One model-independent approach involves inscribing spheres into the structure (Hildebrand et al., 185:67-75 (1997)) in such a manner that trabecular thickness at any location is computed as the diameter of the largest inscribed sphere containing that location. The implementation issues are solved using distance transform and the distance ridge, which provides the set of the center points of largest inscribed spheres. This approach is well suited for high-resolution images that can easily be segmented, but it is bound to fail when significant partial volume blurring is present. The latter is the case in images acquired in the limited spatial resolution regime of in vivo \u03bc-MRI and \u03bc-CT that are beginning to supplant bone biopsy-based methods for structural analysis of trabecular bone (see, e.g., Wehrli et al., 13:335-356 (2002).","However, the fuzzy nature of these images, caused by partial volume blurring, virtually precludes binarization. Accordingly, until the present invention a long felt need has remained in this art for a method that obviates segmentation and that can effectively deal with images acquired at a voxel size comparable to the typical trabecular bone thickness. It is a goal therefore, to better understand the fuzzy distance transform (in both continuous and digital spaces), to study its properties, to present a dynamic programming-based algorithm to compute FDT for fuzzy digital objects, and to demonstrate practical applications of the FDT methods.","The present invention first provides the theory underlying the algorithm in the digital cubic space and the algorithm itself, and then further provides utilitarian demonstrations of the method for extracting structural thickness from fuzzy distance transform images. The robustness underlying the present FDT-based methods is shown in terms of CT images of human trabecular bone in low-resolution regimes, re-sampled at progressively coarser resolution, and after application of rotation and addition of noise (to simulate the in vivo situation). Reproducibility of embodiments of present methods is demonstrated on the basis of images from \u03bc-CT volume data by comparing thickness histograms from individual sections from the same and from different subjects, as well as with MRI volume data sets from human volunteers imaged consecutively in different sessions. Using in vivo \u03bc-MR images from prior animal studies, it is shown that short-term exposure to a bone atrophy-inducing agent results in trabecular thinning that can be quantified with a method of the present invention.","The theoretical framework of FDT is developed in the n-dimensional continuous space n. Consider a path \u03c0 over a fuzzy subset of n. Unlike the case of hard sets, the membership values of the points through which \u03c0 passes need to be considered to determine its length. Thus, in an embodiment it is illustrated that, unlike the case of hard convex sets, the shortest path (when it exists) between two points in a fuzzy convex subset is not necessarily a straight-line. For any positive number \u03b8\u22661, the \u03b8-support of a fuzzy subset is the set of all points in with membership values greater than or equal to \u03b8.","In a further embodiment, it is shown that for any fuzzy subset, for any nonzero \u03b8\u22661, fuzzy distance is a metric for the interior of its \u03b8-support.","It is also shown that, for any smooth fuzzy subset, fuzzy distance is a metric for the interior of its \u03b8-support (referred to as \u201csupport\u201d). FDT is defined as a process on a fuzzy subset that assigns to a point its fuzzy distance from the complement of the support. The theoretical framework of FDT in the continuous space is extended to cubic digital spaces, and in a further embodiment it is shown that for any fuzzy digital object, fuzzy distance is a metric for the support of the object.","In another embodiment of the invention, a dynamic programming-based algorithm is presented for computing FDT of a fuzzy digital object. It is shown that the algorithm terminates in a finite number of steps and when it does so, it correctly produces the FDT image.","Further, exemplary applications for fuzzy distance transforms in medical imaging are presented, including the quantification of the thickness of vascular structures and of trabecular bone over a wide range of resolution regimes from \u03bc-CT to in vivo \u03bc-MRI data, performance of the method under object rotation, sensitivity to noise, reproducibility of thickness values, and efficacy. A resolution-dependent correction of average thickness has been shown to be effective in largely eliminating the systematic error resulting from failure to sample FDT values at the true skeleton locations. Further, FDT-derived thickness was found to be remarkably robust to noise, and the values were stable for SNR>5.","In addition, in an embodiment of the method has been shown to be reproducible in repeat MRI scans conducted in vivo demonstrating its applicability for longitudinal studies for the assessment of drug efficacy. Presented are several potential, exemplary applications of fuzzy distance transform in medical imaging, including quantification of blood vessels and trabecular bone thickness in the regime of limited special resolution where these objects become fuzzy.","Additional objects, advantages and novel features of the invention will be set forth in part in the description, examples and figures which follow, all of which are intended to be for illustrative purposes only, and not intended in any way to limit the invention, and in part will become apparent to those skilled in the art on examination of the following, or may be learned by practice of the invention.","The present invention provides theory and algorithms for fuzzy distance transforms (FDT), representing an extension of the concept of distance transforms for hard objects to the more common fuzzy objects present in imaging. The section entitled Theory describes the theory and properties of FDT in both continuous and digital cubic spaces, and further describes the metric property of fuzzy distance. The section entitled Algorithm describes a dynamic programming-based algorithm for computing FDT of digital objects. The termination of the algorithm in a finite number of steps, as well as its correctness are thus established. The results of applications of the FDT method are presented in the Examples.","It has been shown that fuzzy distance is a metric for the interior of the support of a fuzzy object. A salient feature of fuzzy objects is the property that the shortest path between two points is no longer a straight-line. It has also been shown that the raster scan algorithm commonly used for distance transforms of hard objects fails in the case of fuzzy objects. A dynamic programming-based algorithm is presented in the invention for computing FDT of fuzzy digital objects. It has been shown that the algorithm terminates in a finite number of steps and when it does so, it correctly computes FDT. Finally, several potential applications for fuzzy distance transforms in medical imaging are presented, including the quantification of the thickness of vascular structures and of trabecular bone to voxel size, object rotations, and signal-to-noise ratios (SNR). In addition, reproducibility of the methods was assessed in specimen and in vivo studies in humans, and changes in trabecular thickness were evaluated in response to specific drug treatment.","Theory","In this section, the theory is presented and the properties of fuzzy distance transform of fuzzy subsets are defined either in the continuous space or in a digital space. First described is the case for the continuous space, which will then guide the formulation in a digital space.","1. FDT in Continuous Space","Let denote the n-dimensional continuous space. A \u201cfuzzy subset\u201d (see, e.g., Kaufmann, 1975) S of is defined as a set of pairs {(x, \u03bc(x))|x \u03b5 } where \u03bc:\u2192[0, 1] is the \u201cmembership function\u201d of S in . For any value \u03b8\u03b5 [0, 1], \u201c\u03b8-support\u201d of S, denoted by \u0398(S), is the hard subset {x|x \u03b5 } and \u03bc(x)\u2267\u03b8} of . In other words, the \u03b8-support of S is the set of all points in with membership values greater than or equal to \u03b8. 0-support will often be referred to as \u201csupport\u201d and be denoted by \u0398(S). A fuzzy subset with a bounded support is called \u201cbounded.\u201d","The following notions on fuzzy subsets are used herein, (see, Rosenfeld, 13:241-246 (1984); Bogomolny, 23:257-269 (1987) for details). A fuzzy subset S is a \u201cring\u201d if \u03bc={tilde over (\u03bc)}(r), where r=\u2225x\u2212x\u2225 for some x\u03b5 and {tilde over (\u03bc)}:\u2192[0, 1] is a membership function. S is said to be \u201cconvex\u201d if, for every three collinear points x, y, and z in such that y lies between x and z, \u03bc(y)\u2267min[\u03bc(x), \u03bc(z)]. A convex ring is called a \u201cfuzzy disk.\u201d A fuzzy subset is called \u201csmooth\u201d if it is differentiable at every location x \u03b5 .","Let S be a (hard) subset of .  is used to denote its complement, while \u201cInterior (S)\u201d denotes its interior, which is the largest open set contained in S. The distance transform (DT) of S may be represented as an image {(x, D(x))|x \u03b5 } on where Dis the DT value at x that is defined as follows.\n\n()=inf{\u2225\u2003\u2003(Equation 1)\n\nwhere, inf gives the infimum of a set of positive numbers and \u2225\u2022\u2225 is the Euclidean norm.\n","In the above equation, S should be a proper subset of . In digital images, bounded objects are always used so that  is always nonempty. In the subsequent discussions, the fuzzy distance transform is considered of only bounded subsets.","Here, FDT of a fuzzy subset S is defined in . Similar to ordinary DT, FDT is an image on . The FDT image is denoted by a set of pairs {(x, \u03a9(x))|x \u03b5 }, where \u03a9(x) is the FDT value at x which is defined in the following way.","A \u201cpath\u201d \u03c0 in from a point x \u03b5 to another point (not necessarily distinct) y \u03b5 is a continuous function \u03c0: [0, 1]\u2192, such that \u03c0(0)=x and \u03c0(1)=y. The \u201clength\u201d of a path \u03c0 in S, denoted by \u03a0(\u03c0), is the value of the following integration",{"@attributes":{"id":"p-0050","num":"0049"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03a0","S"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c0"}},{"msubsup":{"mo":"\u222b","mn":["0","1"]},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["\u03bc","S"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03c0","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}},{"mo":["\uf603","\uf604"],"mfrac":{"mrow":[{"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mo":"\u2062","mrow":{"mo":"\u2146","mrow":{"mi":"\u03c0","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}},{"mo":"\u2146","mi":"t"}]}},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062"]}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"2"}}}]}}}}},"Following the above equation, \u03a0(\u03c0) is the integral of membership values (in S) along \u03c0. Note that, if the inverse path is defined as \u03c0\u2032(t)=\u03c0(1\u2212t) of \u03c0, it can be shown that \u03a0(\u03c0)=\u03a0(\u03c0\u2032). A question arises at this point on weighting the path length using membership values. Although other membership-based weights, e.g., absolute derivatives, may be useful in some applications, membership values themselves are used herein as weights as it is intended that the distance between two points is defined as the minimum material that has to be traversed to proceed from one point to the other. Thus, when a path passes through a low density (low membership) region, its length increases slowly and the portion of the path in the complement of the support of S contributes no length. This approach is useful to measure regional object depth, object thickness distribution, etc.","In some applications, it may be useful to consider lengths of connected paths (paths entirely contained in \u0398(S)) only. This can be conceived by incorporating a little change in the definition of path length as follows:",{"@attributes":{"id":"p-0053","num":"0052"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"msubsup":{"mi":["\u03a0","S","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c0"}},{"msubsup":{"mo":"\u222b","mn":["0","1"]},"mo":"\u2062","mrow":{"mrow":[{"msubsup":{"mi":["\u03bc","S","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03c0","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}},{"mo":["\uf603","\uf604"],"mfrac":{"mrow":[{"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mo":"\u2062","mrow":{"mo":"\u2146","mrow":{"mi":"\u03c0","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}},{"mo":"\u2146","mi":"t"}]}},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062"]}}],"mo":"="},"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"3"}}}]},{"mtd":[{"mrow":{"mrow":[{"msubsup":{"mi":["\u03bc","S","\u2032"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"msub":{"mi":["\u03bc","S"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},"mo":","}},{"mrow":{"mrow":{"mrow":{"mi":"if","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"msub":{"mi":["\u03bc","S"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}}},"mo":">","mn":"0"},"mo":","}}]},{"mtd":[{"mrow":{"mi":"\u221e","mo":","}},{"mrow":{"mi":"otherwise","mo":"."}}]}]}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"4"}}}]}]}}}},"It can be shown that both \u03a0and \u03a0\u2032lead to identical FDT images and Theorems 1 and 2 (see below), which originally proved \u03a0, are also true for \u03a0\u2032. \u03a0is used herein to define fuzzy distance.","The set of all paths from a point x \u03b5 to another point y \u03b5 is denoted by (x, y). It may be noted that (x, y) contains infinitely many paths. The shortest path from x \u03b5 to y \u03b5 in S is a path \u03c0\u03b5 (x, y) such that \u03a0.(\u03c0)\u2266\u03a0(\u03c0), \u2200\u03c0\u03b5 (x, y). It is worth mentioning that there may or may not be only one shortest path between two points in a fuzzy subset, and when it does exist, it may not be unique.","The following is a 2D example where no shortest path exists between two points. Consider a fuzzy subset of with its support as a disk and let us pick any two points x and y near its center. Within the support of the fuzzy subset, there are only two membership values\u2014a high membership value for the points on the straight-line segment joining x and y, and a low membership value elsewhere. It is not difficult to see that the straight-line segment  is not the shortest path between x and y and for any other path \u03c0 between the two points it is possible to find a shorter path by further straightening the path. Although the existence of one shortest path between two points in a fuzzy subset is not guaranteed, the infimum of path lengths always exists and is unique.","Let \u03be(x, y) denote a subset of positive real numbers defined as \u03be(x, y)={\u03a0(\u03c0)|\u03c0 \u03b5 (x, y)}; i.e., \u03be(x, y) is the set of all possible path lengths in S between x and y. The \u201cfuzzy distance\u201d from x \u03b5 to y \u03b5 in S, denoted as \u03c9(x, y), is the infimum of \u03be(x, y); i.e.,\n\n\u03c9()=inf\u03be()\u2003\u2003(Equation 5)\n","Fuzzy distance satisfies metric properties as stated in the following theorems (see proofs, Saha et al., 86:171-190 (2002)).","THEOREM 1. For any fuzzy subset S of for any nonzero positive number \u03b8<1 fuzzy distance \u03c9is a metric for Interior(\u0398(S)).","THEOREM 2. For any smooth fuzzy subset S of , fuzzy distance \u03c9is a metric for Interior(\u0398(S)).","Interestingly, the shortest paths (when they exist) in a fuzzy subset S between two points x, y \u03b5 \u2003are not necessarily a straight-line segment, even when S is convex. For example, consider the fuzzy disk S illustrated in . In the figure, the support \u0398S of the fuzzy disk is the shaded region. In this example, within the support \u0398S, there are two possible membership values\u2014points with high membership value are shown as dark gray and those with low membership value (within the outer annular region) are shown as light gray. Consider the two points x and y as illustrated in the figure. Assuming the high membership value is sufficiently close to one and the low one close to zero, the shortest path between x, y should be contained within the light gray region, and therefore is not a straight-line segment.","Maintaining the same spirit as in the distance transform of hard sets, the FDT value \u03a9(x) at a point x \u03b5 is equal to the fuzzy distance between x and the closest (with respect to \u03c9) point in . In other words, the value of value \u03a9(x) is defined as follows\n\n\u03a9()=inf{\u03c9()|\u03b5 }.\u2003\u2003(Equation 6)\n\n2. FDT in Digital Cubic Spaces\n","Fuzzy distance transformation are next described in digital cubic spaces guided by the formulation of the same in the continuous space as discussed in the previous section. To make the description more precise, the concepts are redefined in digital spaces corresponding to the previous definitions in the continuous space. In order to avoid unnecessary heaping of notations, the same notations are used in this section as were used in Section 1, although their exact meaning in a digital space may be different from that of the continuous space.","A \u201cdigital space\u201d D is an ordered pair (G, \u03b1), where G is the underlying digital grid and \u03b1 is a binary relation on G that indicates the adjacency relationship between every two points in G. In general, a \u201cdigital grid\u201d is a set of points in , such that the interpoint distances are bounded below, and within a bounded distance of any point in there is at least one point in the grid. However, most imaging systems acquire images in cubic grids, and these grids are simple to describe as well as to understand. Therefore, the following description is made in terms of cubic grids. An n-dimensional cubic grid may be constructed by dividing into hypercuboids with n orthogonal families, each of equally spaced parallel hyperplanes. The set of the centers of these hypercuboids generates a cubic grid, and it is not difficult to see that, under a proper coordinate system, these points represent the points in Zwhere Z is the set of all integers. Zis used to represent an n-dimensional cubic grid. The notion of adjacency is useful to define a path in a digital space and the boundary of a digital object.","Although researchers have used fuzzy adjacencies (Rosenfeld, 2:311-317 (1991); Udupa et al., 58:246-261 (1996)), the interpretation of fuzziness of adjacencies in the context of a path is not clear. Therefore, the description is confined to hard adjacencies only. In other words, \u03b1:Z\u00d7Z\u2192{0 1}. Two points p, q \u03b5 Zare called \u201cadjacent\u201d if, and only if \u03b1(p, q)=1. In the rest of this paper, a can be standard 4- or 8-adjacency in 2D, 6-, 18-, or 26-adjacency in 3D, and their higher dimensional analogs.","Two adjacent points are often referred to as \u201cneighboring\u201d points to each other.","A \u201cdigital object\u201d \u201cO\u201d is a fuzzy subset {(p, \u03bc(p))|p \u03b5 Z}, where \u03bc:Z\u2192[0, 1] specifies the membership value at each point in the object. It should be noted that, in general, an imaging system (Cho et al., , Wiley, New York, 1993) acquires images containing information of a target object, often along with other co-objects. However, following the spirit of the problem addressed here, digital objects are defined instead of digital images (Rosenfeld et al., in 2nd ed., Vol. 2, Academic Press, New York, 1982). In other words, the proposed framework assumes that the target object is already (fuzzily) segmented from an acquired digital image using an appropriate segmentation method (Rosenfeld et al., 1982, Pal et al., 26:1277-1294 (1993); Udupa et al., (eds.), 3, CRC Press, Boca Raton, Fla., 1991; Sonka et al., 2nd ed., PWS Publishing, Brooks\/Cole, Pacific Grove, Calif., 1999; Kong et al., 46:219-262 (1992)). This process of extracting an object from an image, commonly referred to as image segmentation, has been studied extensively for decades. Since the subject itself is an open area of research, rather than becoming involved with that issue, the present invention is described assuming the above definition of a digital object.","The support \u0398(O) of a digital object O is the set of all points in Zeach having a nonzero object membership value, i.e., \u0398(O)={p|p \u03b5 Zand \u03bc(p)\u22600}. A \u201cpath\u201d \u03c0 in a set S of points from a point p \u03b5 S to another (not necessarily distinct) point q \u03b5 S is a sequence of points p=p, p, . . . , p=q, such that p\u03b5 S for all 1\u2266i\u2266m and pis adjacent to pfor all 1\u2266j\u2266m. The length of the path is m.","Although only hard adjacency relations are considered to define a path, the Euclidean distance between two adjacent points should be used in a meaningful way in defining its length. A set of points S will be called \u201cpath connected\u201d if, and only if, for every two points, p, q \u03b5 S, there is a path in S from p to q. (p, q) will denote the set of all paths in Zfrom a point p \u03b5 Zto another point q \u03b5 Z. For the purpose of defining the length of a path, the notion of a link and its length is used. A \u201clink\u201d is a path consisting of two points. The length of a link p, q in O maybe defined in different ways, e.g., (1) max{\u03bc(p)\u03bc(q)}\u00d7\u2225p\u2212q\u2225, (2) \u00bd(\u03bc)+\u03bc(q))\u00d7\u2225p\u2212q\u2225, etc. Notably, in both examples, the length of a link has two components\u2014one coming from the membership values at p and at q, and the other from the distance between the two points. In the disclosed embodiment of the invention, the second choice is followed for the length of a link. Theoretical requirements for a valid length function for links are (1) the length of a link p, p is \u201c0,\u201d (2) the length of the links p, q and q, p|p, q \u03b5 Zare equal, and (3) the length of a link p, q, where p \u03b5 \u0398(O) and p\u2260q, is greater than zero. The \u201clength\u201d \u03a0(\u03c0) of a path \u03c0=p=p, p, . . . , p=q is the sum of the lengths of all links on the path, i.e.,",{"@attributes":{"id":"p-0070","num":"0069"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03a0","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c0"}},{"munderover":{"mo":"\u2211","mrow":[{"mi":"i","mo":"=","mn":"1"},{"mi":"m","mo":"=","mn":"1"}]},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mfrac":{"mn":["1","2"]},"mo":["\u2062","\u00d7"],"mrow":[{"mo":["(",")"],"mrow":{"mrow":[{"mi":"\u03bco","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["p","i"]}}},{"mi":"\u03bco","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"p","mrow":{"mi":"i","mo":"+","mn":"1"}}}}],"mo":"+"}},{"mrow":{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mi":["p","i"]},{"mi":"p","mrow":{"mi":"i","mo":"+","mn":"1"}}],"mo":"-"}},"mo":"."}]}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"7"}}}]}}}},"br":{},"sub":["p,q ","O","p,q","O"],"img":[{"@attributes":{"id":"CUSTOM-CHARACTER-00060","he":"3.13mm","wi":"2.46mm","file":"US07769214-20100803-P00024.TIF","alt":"custom character","img-content":"character","img-format":"tif"}},{"@attributes":{"id":"CUSTOM-CHARACTER-00061","he":"3.13mm","wi":"2.46mm","file":"US07769214-20100803-P00024.TIF","alt":"custom character","img-content":"character","img-format":"tif"}}],"sup":["n ","n "]},"PROPOSITION 1. For any digital space D=(Z, \u03b1) for any fuzzy object O on D with a bounded support, for any two points p, q \u03b5 Z, there exists one shortest path from p to q.","Proof. Consider a path \u03c0=(p, p, . . . , p, p, p, . . . , p, p, p, . . . , p with a repetition at p, forming a loop (a path with the common starting and finishing point). Obviously, the length of the path p, p, . . . , p, p, . . . , p obtained by removing the repetition, is less than or equal to that of \u03c0. Therefore, to prove this proposition it is shown that among the paths without any repetition, there is one with the smallest length. Since the support of O is bounded, there are only finitely many links with nonzero values, and therefore, there are finitely many length values for the paths without any repetition. Hence, there is the minimum length for the paths between p and q and a path with the minimum length is one shortest path.","Although, the existence of one shortest path is guaranteed in fuzzy digital objects, as in the continuous space, there may be multiple shortest paths between two points in a fuzzy digital object between two points. In the rest of this disclosure, fuzzy digital objects with bounded supports are considered. The fuzzy distance, from p \u03b5 Zto q \u03b5 Zin O, denoted as \u03c9(p, q), is the length of any shortest path in O from p to q. Therefore,",{"@attributes":{"id":"p-0074","num":"0073"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03c9","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["p","q"],"mo":","}}},{"munder":{"mi":"min","mrow":{"mi":"\u03c0","mo":"\u2208","mrow":{"mi":"P","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["p","q"],"mo":","}}}}},"mo":"\u2062","mrow":{"msub":{"mi":["\u03a0","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c0"}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"8"}}}]}}}}},"Moreover, it is shown that, similar to the case of fuzzy subsets in the continuous space, fuzzy distance in a digital object defined over a digital cubic space is a metric.","THEOREM 3. For any digital cubic space D=(Z, \u03b1) for any digital object O, fuzzy distance \u03c9is a metric for \u0398(O).","For proof of Theorem 3, see Saha et al., 2002.","Following the framework of FDT for fuzzy subsets in the continuous space, the FDT value at a point p \u03b5 Zin a fuzzy object O over a digital space, denoted by \u03a9(p), is equal to the fuzzy distance between p and the nearest point in . In other words, the value of \u03a9(p), is defined as follows:",{"@attributes":{"id":"p-0079","num":"0078"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03a9","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}},{"munder":{"mi":"min","mrow":{"mi":"q","mo":"\u2208","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2062","mrow":{"msub":{"mi":["\u03c9","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["p","q"],"mo":","}}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"9"}}}]}}}},"br":{}},"In this section, an algorithm embodiment is presented for computing the FDT of digital objects. Also, a proof will be provided that the algorithm terminates in a finite number of steps, and when it does so it outputs the FDT of the digital object. Assuming a uniform neighborhood, we can think that, with respect to a point p \u03b5 Z, all its adjacent neighbors are ranked. A vector \u03b4, called a \u201cresolution vector,\u201d is used whose ith element gives the continuous distance between a point and its ith adjacent neighbor. This uses the (3\u22121)-adjacency relation (i.e., 8-adjacency in 2D and 26-adjacency in 3D). Therefore, \u03b4 is a (3\u22121)-dimensional vector. The information about the resolution vector may be directly obtained from the application imaging system. Let N*(p) denote the set of adjacent neighbors of a point p \u03b5 Zexcluding p itself.","As demonstrated by Borgefors in 1996, a raster scan approach effectively computes regular DT for binary images using only two scans. A basic reason behind this is the fact that in a binary image the shortest path from a point to the background (the complement of the binary object) is always a straight-line segment (in a digital sense). However, this is not true for fuzzy digital objects (see ). This makes a raster scan based approach inappropriate in computing FDT, as illustrated by example in . Similar to the example shown in , in , dark gray indicates high membership in the object O and light gray indicates low membership. Consider two points pand pas shown in the figure. Let \u03c0be a shortest path from pto , and let \u03c0be the same, but from p. It is not difficult to see that three raster scans are needed to compute the length of \u03c0in O (i.e., the FDT value at p), while it takes five scans to do so for \u03c0(i.e., the FDT value at p). Therefore, the number of raster scans needed to compute the FDT of a fuzzy object is dependent on the shape of the object as demonstrated in . The iterative algorithm (Rosenfeld et al., 1982) for computing the distance transform of a hard digital object can be used to compute FDT of fuzzy objects. However, such approaches will be inefficient in this application as the shortest path from a point to the background may be quite complicated, and for each iteration the method needs to scan the entire image.","In the following section, a dynamic programming-based algorithm is presented to compute FDT of a fuzzy digital object.",{"@attributes":{"id":"p-0083","num":"0082"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"245pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"ALGORITHM. Compute_FDT."]},{"entry":[{},"Input: O = (Z, \u03bc), \u03b1, and \u03b4, as defined above."]},{"entry":[{},"Auxiliary Data Structures: modified fuzzy object O = (Z, \u03bc), an image (Z, \u03a9)"]},{"entry":[{},"representing FDT of O, and a queue Q of points."]},{"entry":[{},"Output: an image (Z, \u03a9) representing FDT of O."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"1. input O = (Z, \u03bc);"]},{"entry":[{},"2. for all p \u03b5 , set \u03a9(p) =0;"]},{"entry":[{},"3. for all p \u03b5 \u0398(O), set \u03a9(p) =MAX;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/* MAX is a large value *\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"4. for all p \u03b5 \u0398(O), such that N*(p) \u2229  is non-empty"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"5.","push p into Q;"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"6. while Q is not empty do"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"7.","remove a point p from Q;"]},{"entry":[{},"8.","find dist= min[\u03a9(q) + \u03b4\u00d7 \u00bd(\u03bc(p) + \u03bc(q))];"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\/* rank(p, q) gives the rank of q in the neighborhood of p*\/"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"210pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"9.","find dist< \u03a9(p) then"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"189pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"10.","set \u03a9(p) = dist;"]},{"entry":[{},"11.","push all points q \u03b5 N*(p) \u2229 \u0398(O) into Q;"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"231pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"12. output the FDT image O"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}}},"In the following two propositions, it is proven that the embodied algorithm compute_FDT terminates in a finite number of steps, and when it does so, it produces the FDT image.","PROPOSITION 3.1. For any fuzzy object O=(Z, \u03bc) over any digital cubic space (Z, \u03b1), the algorithm compute_FDT terminates in a finite number of steps.","Proof. The algorithm is iterative, and at each iteration in the while-do loop, it removes exactly one point from queue Q. Also, only the points of \u0398(O) visit Q. Since the number of elements in \u0398(O) is always finite, the algorithm compute_FDT fails to terminate in a finite number of steps only when some point p \u03b5 \u0398(O) is modified infinitely many times. Following Steps 9 and 10, the value at p strictly decreases after every modification. Moreover, following Steps 8, 9, and 10, during every modification, p is assigned the value of the length of some path in O from p to a point in . First, it is shown that p is always set to \u03a0(\u03c0) for some 7 without any repetition or loop. If this is not true, without loss of generality, let p be the first point to break the rule. Therefore, the path \u03c0 is of the form q, q, . . . , p, . . . , p. But, this is possible only when p has previously been assigned the length of the path \u03c0\u2032=q, q, . . . , p. Following Equation 7, it is obvious that \u03a0(\u03c0\u2032)\u2266\u03a0(\u03c0). But this contradicts Step 9. Now, since \u0398(O) is finite, there are only finitely many length values for repetition-free paths from to p. Hence, any point p \u03b5 Zcould be modified only finitely many times. Hence compute_FDT terminates in a finite number of steps.","To prove the correctness of the algorithm the following notation is needed. Let",{"@attributes":{"id":"p-0088","num":"0087"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"l"}}}},"br":{},"o":"\u0398(O)"},"PROPOSITION 2. For any fuzzy object O=(Z, \u03bc) over any digital cubic space (Z, \u03b1), when the algorithm compute_FDT terminates, its output equals the FDT image (Z, \u03a9).","Proof. Initially, the algorithm starts with the points of  (see Steps 2-4). Thus, Steps 8-10 guarantee that whenever a point p is set to dist(in Step 10), there is always a path from some q \u03b5  to p with length dist. Therefore, for any p \u03b5 Z, \u03a9(p)\u2267\u03a9(p).","It may be observed from the algorithm that it never increases the value of any p\u03b5Z. It is now proven that, for any p \u03b5 Z, \u03a9(p)\u2267\u03a9(p) by using the method of induction. Obviously, for any p\u03b5Z,",{"@attributes":{"id":"p-0092","num":"0091"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mn":"1"}}}},"br":{},"o":"\u0398(O)"},{"@attributes":{"id":"p-0093","num":"0092"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mn":"1"}}}},"br":{},"sup":"n "},{"@attributes":{"id":"p-0094","num":"0093"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mn":"1"}}}},"br":{}},{"@attributes":{"id":"p-0095","num":"0094"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"-","mn":"1"}}},"mo":","}}},"br":{},"sup":"n "},{"@attributes":{"id":"p-0096","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"o"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}},"br":{},"sub":["p","1","2","i"],"img":[{"@attributes":{"id":"CUSTOM-CHARACTER-00066","he":"3.56mm","wi":"1.44mm","file":"US07769214-20100803-P00036.TIF","alt":"custom character","img-content":"character","img-format":"tif"}},{"@attributes":{"id":"CUSTOM-CHARACTER-00067","he":"3.56mm","wi":"1.44mm","file":"US07769214-20100803-P00037.TIF","alt":"custom character","img-content":"character","img-format":"tif"}}]},{"@attributes":{"id":"p-0097","num":"0096"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mi":"T","mrow":{"mi":"p","mo":",","mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"o"}},"mi":"_"}}},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}}}},"br":{},"o":"\u0398(O)"},{"@attributes":{"id":"p-0098","num":"0097"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"mrow":[{"msub":{"mi":"p","mrow":{"mi":"i","mo":"-","mn":"1"}},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}],"mi":"to","mrow":{"mi":"\u03a9","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"p","mrow":{"mi":"i","mo":"-","mn":"1"}}}}},{"mrow":[{"munder":{"mi":"min","mrow":{"mrow":{"mi":"\u03c0","mo":"\u2208","msub":{"mi":"T","mrow":{"mi":"Pi","mo":"-","mn":"1"}}},"mo":",","msup":{"mover":{"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mi":"_"},"mrow":{"mo":["(",")"],"mrow":{"mi":"i","mo":"-","mn":"1"}}}}},"mo":"\u2062","mrow":{"msub":{"mi":["\u03a0","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"\u03c0"}}},{"msub":{"mi":["\u03a0","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mo":["\u2329","\u232a"],"mrow":{"msub":[{"mi":"p","mn":"1"},{"mi":"p","mn":"2"},{"mi":"p","mrow":{"mi":"i","mo":"-","mn":"1"}}],"mo":[",",",","\u2062",","],"mi":"\u2026","mstyle":{"mspace":{"@attributes":{"width":"0.6em","height":"0.6ex"}}}}}}}],"mo":"\u2264"}],"mo":"="}}},"br":[{},{}],"sub":["i\u22121","rank(p",{"sub2":"i"},",p",{"sub2":"i\u22121"},")","O","i","O","i\u22121","O","p","rank(p",{"sub2":"i"},",p",{"sub2":"i\u22121"},")","i","i\u22121","O","O","O","O"],"sup":["n","n"]},"Thickness is a useful parameter in analyzing object shape and morphology, and as shown above, FDT provides the depth mapping at each point within the support of a fuzzy object O. The principle of FDT-based thickness computation is to sample these depth values along the medial axis (or medial surface) of target O; thus, providing the regional thickness distribution over the object. \u201cSkeletonization\u201d is a widely used technique to generate the medial surface representation of a digital object (Srihari et al., 1979; Tsao et al., 1981; Saha et al., 1997). This is accomplished by reducing a 3D object into a union of surfaces and curves (some investigators have further reduced it to a union of curves only (Pothuaud et al., 199:149-161 (2000))), thereby preserving the topology and shape of the original object.","Although, topology preservation of digital objects has a generally accepted definition, the same is not true for shape, and different researchers often use different definitions. The inventors' previously described method (Saha et al., 30:1939-1955 (1997)) has been used in the present work for skeletonization. The method iteratively erodes an object along its border while preserving its topology and retaining the surfaces and curves necessary to describe the shape of the object. Each iteration consists of three complete scans of the entire image space, and in each scan there are different types of border points (referred to as \u201cs-open,\u201d \u201ce-open,\u201d and \u201cv-open\u201d points). The simple point characterization, (see also, Saha et al., 16:1028-1032 (1994)) was used for topology preservation, i.e., only simple points were deleted during erosion. Thus, efficient computational approaches were implemented.","To preserve object shape, edge points of surfaces and end points of curves were saved during erosion. Thus, both types of points are referred to as \u201cshape points.\u201d The skeletonization process takes 45-60 seconds for a 3D trabecular bone image set of 256\u00d7256\u00d760 image size on a 450 MHz Pentium III PC running under Linux OS. The robustness of the skeletonization method under rotation and noise was previously demonstrated (Saha et al., 1997). After calculating the skeleton of the support of trabecular bone, the distribution of regional thickness over O was computed in accordance with the present invention by sampling the FDT values along the skeleton. Following the same theory, thickness is computed along the skeleton of an object.","While it may be desirable to generate the skeleton of an object directly from its fuzzy representation by taking into account the bone volume fraction value at each location, the significant research and developmental demands needed are beyond the scope of the present invention. Therefore, instead, the standard skeleton on the support E)(O) of object O is used to obtain its medial axis representation and compute its thickness. It should be noted that no explicit threshold is required to define the support \u0398(O), and therefore, the resulting skeleton is not threshold sensitive.","Let denote the skeleton Sk(\u0398(O) of \u0398(O). The mean thickness of an object denoted by \u03c4(O), is computed as the average of twice (2\u00d7) the FDT values along the skeleton of Sk(\u0398(O), i.e.,",{"@attributes":{"id":"p-0104","num":"0103"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"\u03c4","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mrow":{"mi":"p","mo":"\u2208","mrow":{"mi":"S","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"k","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}}}}}}},"mo":"\u2062","mrow":{"mn":"2","mo":"\u2062","mrow":{"msub":{"mi":["\u03a9","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}}}},{"mo":["\uf603","\uf604"],"mrow":{"mi":"S","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"k","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}}}}}}]}}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"10"}}}]}}}},"br":{}},"As demonstrated above, the FDT approach deals effectively with partial volume effects. However, digitization introduces a resolution-dependent, systematic error in the FDT-based thickness computation, as illustrated in . Consequently, the present invention further provides an approximate solution that corrects for these digitization errors. As described in the previous paragraph, the true thickness can be obtained by sampling the FDT values along the ideal medial axis of a structure. Obviously, any deviation from this ideal medial axis can only reduce the estimated value of thickness. See, , wherein the ideal skeleton of the shaded object region is shown by the dotted lines, and the true thickness would be obtained if FDT values could be sampled along these dotted lines. However, in most digital image processing approaches, object representations, as well as related computations, are confined to grid points. Following this basic limitation, a digital skeleton is a set of grid points close to the ideal skeleton. Thus, FDT values are sampled only at grid points close to the ideal skeleton, thereby introducing a random negative error in computed thickness as illustrated in the figure.","For a given voxel size, these errors have an upper bound, which is the maximum of the shortest distance between the ideal skeleton and a grid point. Obviously, this upper bound equals half of the voxel's diagonal. For an isotropic structure, assuming that the true skeleton can pass through any point within the voxel with a uniform probability, the expected average error should be the value of the following integral:",{"@attributes":{"id":"p-0107","num":"0106"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"error","mo":"=","mrow":{"mfrac":{"mn":"1","msup":{"mi":"\u03c1","mn":"3"}},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mfrac":[{"mi":"\u03c1","mn":"2"},{"mi":"\u03c1","mn":"2"}]},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mfrac":[{"mi":"\u03c1","mn":"2"},{"mi":"\u03c1","mn":"2"}]},"mo":"\u2062","mrow":{"msubsup":{"mo":"\u222b","mfrac":[{"mi":"\u03c1","mn":"2"},{"mi":"\u03c1","mn":"2"}]},"mo":"\u2062","mrow":{"msqrt":{"mrow":{"msup":[{"mi":"x","mn":"2"},{"mi":"y","mn":"2"},{"mi":"z","mn":"2"}],"mo":["+","+"]}},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.2em","height":"0.2ex"}}},"mrow":[{"mo":"\u2146","mi":"x"},{"mo":"\u2146","mi":"y"},{"mo":"\u2146","mi":"z"}]}}}}}}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"11"}}}]}}}},"br":[{},{},{}],"i":"Numerical Recipies: The Art of Scientific Computing","in-line-formulae":[{},{}]},{"@attributes":{"id":"p-0108","num":"0107"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03c4","c"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}},{"mfrac":{"mrow":[{"munder":{"mo":"\u2211","mrow":{"mi":"p","mo":"\u2208","mrow":{"mi":"S","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"k","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}}}}}}},"mo":"\u2062","mrow":{"mn":"2","mo":"\u2062","mrow":{"msub":{"mi":["\u03a9","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}}}},{"mo":["\uf603","\uf604"],"mrow":{"mi":"S","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"k","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u0398","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"O"}}}}}}]},"mo":"+","mrow":{"mn":"0.38","mo":"\u2062","mi":"\u03c1"}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"12"}}}]}}}},"br":{}},"To validate the results of the present FDT-based method, its performance at different resolutions was compared with a previously reported 3D thickness computation method (the algorithm of Hildebrand et al., 185:67-75 (1997)). The method estimates regional thickness of trabecular bone using binary distance transform and local maxima (\u201ccenter points of all nonredundant spheres\u201d) in thresholded images. For all resolutions, a threshold of 50% BVF was used. In addition, at the highest resolution (22 \u03bcm) thresholds were varied between 25 and 75% BVF.","To evaluate methods of the invention and to demonstrate the potential in longitudinal in vivo studies, experiments were conducted to evaluate, e.g., the sensitivity of the thickness computation method to voxel size, object rotations, and signal-to-noise ratios (SNR), respectively, as well as reproducibility, as assessed in specimen and in vivo studies in humans, including specific studies to confirm the value of the method for assessing the changes in trabecular thickness in response to corticosteroid drug treatment. The following illustrate a few examples of applications of FDT methods of the present invention, and describe a method of computing local thickness using FDT. However, these examples are not meant to limit the scope of the invention, and alternatives may be utilized.","The following experiments were all conducted in 3D, except the reproducibility study based on \u03bc-CT data. For all experiments, the following steps were applied: (1) generation of a BVF map from the raw images, (2) FDT computation, (3) skeletonization, and (4) thickness computation. These steps for each experiment are described in the order in which they were executed.","The fuzzy object was constructed from a 2D slice of a 3D computed tomographic angiography (CTA) image of a patient's head. The original slice is shown in ). The in-plane resolution of the image is 0.25\u00d70.25 mm. A fuzzy object was generated as follows. The bone regions were segmented from the slice image through interactive thresholding. The fuzzy object representing the bone region was constructed by (1) blurring (to simulate partial volume effects) the thresholded image over a Gaussian kernel of radius 5 pixels, and (2) subsequently adding a correlated, zero-mean Gaussian noise with standard deviation equal to 10% of the pixel bone fraction value. The final fuzzy object is shown in ).","The motivation behind the construction of the fuzzy object in this way is simply to demonstrate the results on a relatively realistic image. shows the FDT image as derived from the fuzzy object of (). In ), the intensity values are shown to be proportional to its FDT value. As visually apparent in this figure, the ridges of FDT values follow the medial axis of the fuzzy object suggesting that there is potential for applications of FDT in computing skeletons of fuzzy objects.","To compute thickness in this experiment, the skeletonization method described in Saha et al., 1997, was used. Let Sk(\u0398(O)) denote the skeleton of \u0398(O). At any point p\u03b5Sk(\u0398(O)), the thickness value was computed as twice the largest FDT value in the neighborhood of p.","A first example of FDT-based thickness computation is illustrated in . ) shows a maximum intensity projection (MIP) rendition of a portion of an arterial tree in a 3D CTA image of a subject's brain vasculature. The size of the image domain is 74\u00d7217\u00d740 mmand the voxel size is 0.32\u00d70.32\u00d71.25 mm. The image has been rendered after removing bone using a recently developed method (Saha et al., in ., San Diego, Calif., Vol. 4322, pp. 1264-1272 (2001)) from the inventors' laboratory. The mask for the arterial tree was segmented from the rest of the tissue using scale-based fuzzy connectedness (Saha et al., 2000). A membership value \u03bc(p) at each location within the segmented artery mask was computed as: A.",{"@attributes":{"id":"p-0116","num":"0115"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03bc","O"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"msub":{"mi":"G","mrow":{"msub":[{"mi":["m","A"]},{"mi":["\u03c3","A"]}],"mo":"\u2062"}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}}}},"mo":","}},{"mrow":{"mrow":{"mi":"if","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}}},"mo":"\u2264","msub":{"mi":["m","A"]}}}]},{"mtd":[{"mrow":{"mn":"1","mo":","}},{"mrow":{"mrow":{"mi":"otherwise","mo":","},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"1.4em","height":"1.4ex"}}}}}]}]}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"13"}}}]}}}},"br":{},"sub":["A ","A ","m",{"sub2":"A"},",\u03c3",{"sub2":"A "},"A ","A "],"figref":["FIG. 4(","FIG. 4("],"i":["b","c"]},"A second example of thickness computation, illustrated in , is a high-resolution in vivo 3D magnetic resonance (MR) image of the human distal radius showing the trabecular bone network. The in vivo images were acquired on a 1.5 T GE clinical scanner. The image size was 512\u00d7256\u00d732 \u03bcmand the voxel size was 137\u00d7137\u00d7350 \u03bcm. A slice from the raw image is shown in ). A cylindrical region of interest (ROI) was chosen for analysis. The central highlighted disk in ) is the cross section of the ROI with that slice.","The image within the ROI was preprocessed by deshading and noise reduction using a histogram deconvolution method (Hwang et al., 10:186-198 (1999)) to produce a bone volume fraction (BVF) map. The spatial resolution was enhanced to 68\u00d768\u00d788 \u03bcmusing subvoxel classification (Wu et al., 31:302-308 (1994)). A 3D projection of the final BVF image is presented in ). The FDT image was computed from the resolution-enhanced BVF image. Thickness values were computed using a surface skeleton (Saha et al., 2000) of the bone mask. The mean and the standard deviation of thickness values along the skeleton were 102 \u03bcm and 42 \u03bcm, respectively, in good agreement with the known thickness of human bone trabecular, which is on the order 100-150 \u03bcm (Aaron et al., 215:260-271 (1987)).","A further demonstration of the effectiveness of the proposed FDT-based thickness computation method involving high-resolution micro-computed tomography (\u03bc-CT) images is presented in . The basic idea was to evaluate the FDT-based thickness distributions over four regions, two each from the same trabecular bone sample. Two \u03bc-CT images of different metaphyseal samples of human distal radius were acquired on a SANCO Medical \u03bc-CT 20 scanner at 22 \u03bcm isotropic resolution (although other devices and at an appropriate level of resolution could be used).","Each of the two \u03bc-CT images was processed as follows. The raw gray-scale image was binarized to yield bone masks. A BVF map at each location within the bone mask was computed using an equation similar to Equation 13. The BVF images of the two samples are illustrated in ) and () using fuzzy shell rendering (Udupa et al., 13(6):58-67 (1993)), supported by the 3DVIEWNIX system (Udupa et al., 2164:58-73 (1994)). Two representative slices of the raw \u03bc-CT images, one from each sample, are shown in ) and (). A pair of slices, separated by 330 \u03bcm (i.e., 15 slices apart), was selected from each of the two samples and 2D FDT-based thickness was computed separately for each BVF slice image. ) shows two distributions of the thickness values, one for each of the two different slices chosen from the sample shown in ). The mean and standard deviations of thickness values in one slice were 119 \u03bcm and 59 \u03bcm, respectively, and the corresponding values for the other slice in the same sample were 116 \u03bcm and 62 \u03bcm, respectively. ) presents thickness distributions for the two slices chosen from the other sample shown in ). The mean and standard deviations of thickness values in one slice are 103 \u03bcm and 57 \u03bcm, respectively, versus values for the other slice in the same sample of 101 \u03bcm and 54 \u03bcm, respectively. As demonstrated in ) and (), the thickness distributions for the slices from the same sample are quite similar while they are significantly different for the pair of slices from the other sample.","For this and the experiments that follow, BVF object generation utilized CT images that had been acquired previously on a Scanco Medical \u03bc-CT 20 scanner at 22 \u03bcm isotropic resolution from samples cored from cadaveric bone of the distal radial metaphysis of two donors. As above, shell rendering was by 3DVIEWNIX (Udupa et al, 1994). The samples represent cylindrical cores of 9 mm height and 9 mm diameter with the cylinder axis parallel to the direction of the radius. Because of their high spatial resolution exceeding trabecular thickness by a factor of 5, the data represent the \u201cgold standard.\u201d","Two cross-sectional images, one from each of the two \u03bc-CT data sets, are shown in ) and (). The two CT image sets were processed to generate BVF maps. Because of the small voxel size, the images have bimodal intensity distributions and could thus be segmented by selecting a threshold (\u03bc) at the midpoint of the two modes representing the mean bone and the mean marrow intensities. Subsequently, the largest 26-connected component (Saha et al., 63:418-429 (1996)) within the region thresholded for bone was computed. The intensities at the two modes were selected as the mean intensities for bone and marrow (denoted by \u03bcand \u03bcrespectively). At each point p, the BVF value was computed through the following equation:",{"@attributes":{"id":"p-0123","num":"0122"},"maths":{"@attributes":{"id":"MATH-US-00018","num":"00018"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03bc","BVF"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mn":"0","mo":","},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"6.4em","height":"6.4ex"}}}}},{"mrow":{"mrow":{"mrow":{"mrow":{"mi":"if","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"P"}}},"mo":"<","msub":{"mi":["\u03bc","TH"]}},"mo":","},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"1.9em","height":"1.9ex"}}}}}]},{"mtd":[{"mfrac":{"mrow":[{"mrow":{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}},"mo":"-","msub":{"mi":["\u03bc","TH"]}},{"msub":[{"mi":["\u03bc","B"]},{"mi":["\u03bc","TH"]}],"mo":"-"}]}},{"mrow":{"mrow":{"mrow":[{"mi":"if","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"msub":{"mi":["\u03bc","TH"]}},{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"p"}}],"mo":["\u2264","<"],"msub":{"mi":["\u03bc","B"]}},"mo":","}}]},{"mtd":[{"mrow":{"mrow":{"mn":"1","mo":","},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"7.2em","height":"7.2ex"}}}}},{"mrow":{"mrow":{"mi":"otherwise","mo":","},"mo":"\u2062","mstyle":{"mspace":{"@attributes":{"width":"5.6em","height":"5.6ex"}}}}}]}]}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mrow":{"mi":"Equation","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},"mn":"14"}}}]}}}},"br":{},"figref":"FIGS. 8(","i":["c","d"],"b":"8"},"For this and the following experiments, the bone sample displayed in ) as sample A, and the cross section in ) as slice A, are referred to herein as \u201csample A;\u201d and those displayed in ) and (), as sample B and slice B, respectively are referred to herein as \u201csample B.\u201d","For BVF Object Generation Experiment 1, the BVF images of the two bone specimens were resampled at voxel sizes corresponding to integral multiples of the parent resolution, i.e., 44 \u03bcm, 66 \u03bcm, . . . 176 \u03bcm isotropic voxel size. This strategy was chosen for generating trabecular bone images at lower resolutions, as opposed to re-sampling the raw \u03bc-CT data sets followed by computing the BVF images as the latter strategy would cause a significant loss in structural detail in the segmented images using the simple threshold-based method as used here. Segmentation may be improved by using more sophisticated methods Udupa et al., 1996; Saha et al., 2000); however, segmentation is not a focus of the present invention. However, for Experiments 2 and 3 of this Example, the respective operations were performed on the raw \u03bc-CT images first, and then the BVF computation method was applied.","This first experiment was designed to assess the performance of the FDT method in various resolution regimes ranging from ex vivo \u03bc-CT to in vivo \u03bc-MRI data. Resolution was varied isotropically from 22 \u03bcm to 176 \u03bcm, in steps of 22 \u03bcm, yielding eight different resolution values. ) and () display slices A and B from the BVF images of samples A and B at 22 \u03bcm isotropic voxel size. Matching slices from the BVF images at 88 \u03bcm and 176 \u03bcm isotropic voxel size are displayed in )-().","Thickness values computed for the two different \u03bc-CT image sets at different resolutions were plotted in  before and after the resolution dependent corrections (Equations 10-12). In spite of the wide range of resolutions examined, the corrected thickness values were shown to be stable as shown, with a maximum variation of 7.6% for sample A, and 6.7% for sample B.","A significant error was noted, however, in the computed thickness without correction (up to 45.3% for sample A and 49.8% for sample B). The error is negative, i.e., without the correction the algorithm underestimates true thickness values as predicted. However, there is a small positive error in the corrected thickness values, which increases approximately linearly with voxel size. This overestimation may result from the artifactual filling of small lacunae (for example, see the apparent cavity shown by an arrow in ) and (), which is filled in for ). Likewise, merging of closely spaced trabeculae (for example, the region highlighted by an arrow in ), () and ()) increased in apparent thickness at such locations. Equation 11 assumes structural anisotropy in the transverse plane. However, in reality there may be small deviations from transverse isotropy, meaning that the correction factor of Equation 11 is only approximately valid.","It should be noted from the data plotted in  that the present method is remarkably reliable at voxel sizes (e.g., 176 \u03bcm), exceeding trabecular thickness (approximately 124 \u03bcm and 110 \u03bcm).  also shows the computed thickness values using the HR method (Hildebrand et al., 1997). Although at 22 \u03bcm, the estimated thickness values derived from the two methods are close, the disparity increases at lower resolution. It is noted that the HR method completely fails at voxel sizes greater than mean trabecular bone thickness. Moreover, the smallest thickness value at any location in any image computed by HR method is the voxel size itself. Such behavior appears to be true for any threshold-based method.","Further, even at 22 \u03bcm resolution, the change in computed thickness was 24% and 32% for samples A and B, respectively, as the BVF threshold was varied from 25% to 75%.","This experiment demonstrates the performance of the present method under object rotation. Thickness values were computed for the trabecular bone networks after the images were rotated in-plane, anticlockwise in steps of 5\u00b0 over a range of 0\u00b0 to 360\u00b0 around the z-axis (axis perpendicular to image plane). \u03b8\u03b5 {15, 10, . . . 355} degrees were applied to each raw \u03bc-CT image, and the rotated images were digitized in the original cubic grid using linear interpolation. Images of a slice from sample B for three different rotation angles are illustrated in , and the results of this experiment are plotted in .","BVF images were computed using Equation 14. Notably, the variations in measured thickness do not exceed 3.3% and 4.5%, for samples A and B, respectively. Both rotation-thickness plots show a periodicity at integral multiples of 45\u00b0. This observation is consistent with the behavior of digital cubic grids in which effects of rotation are largest around 45\u00b0 and its integral multiples.","This experiment was designed to examine the sensitivity of the present method to noise.  displays slice A for three different SNR values, while plots of apparent thickness versus SNR are illustrated in . Zero mean, multiplicative random noise corresponding to SNR\u03b5{1, 2, . . . 20} was added to the \u03bc-CT images of samples A and B. The SNR value was calculated as the ratio between the mean and standard deviation of intensities over a sufficiently large marrow region. As in the previous Example, BVF images were computed using Equation 14.","Notably, at very low SNR values (<5), computed thickness values were substantially underestimated (almost 50%). However, above SNR\u22485 the values stabilized, asymptotically approaching their noise-free values. For SNR>5, variations in estimated thickness value for the two samples were less than 3.5% and 2.7%, respectively. The likely cause for the method to break down at very low SNR is the creation of tiny cavities and lacunae in the support of trabeculae caused by noise, thus increasing apparent bone skeletal area, resulting in an artifactual reduction in computed thickness.","This experiment was designed to examine to what extent spatially close slice locations in the same specimen return similar thickness values. The hypothesis to test was that two similar locations within a volume of trabecular bone volume would yield similar thickness distributions (since, the trabecular architecture varies continuously along the slice direction). In contrast to the preceding examples, images were used only from individual slices. Specifically, images from two slice locations separated by 330 \u03bcm (15 slices) were selected from each of the BVF images of samples A and B. The rationale underlying this experiment is the notion that the structural characteristics found within the bone of a particular donor had to be more similar than those in bone from different donors.","As shown in , two pairs of FDT-based trabecular bone thickness distributions are displayed without resolution dependent corrections, each for the pair of slices from one of the two samples.","Notably, from these plots that thickness distributions for the slices from the same sample are quite similar while differing substantially for the slices originating from different samples.","A first experiment was aimed at evaluating the reproducibility of the proposed trabecular bone thickness computation method in human subjects using in vivo \u03bc-MRI data. Therefore, high-resolution images of the distal radius in four human volunteers were examined. Each individual had been previously scanned three times with repositioning and reset apparatus-setup as part of a project designed to evaluate the serial reproducibility of trabecular bone structural parameters. Image data sets consisted of 28 slices of 137\u00d7137 \u03bcmpixel size having 350 \u03bcm thickness, obtained with the 3D FLASE partial flip-angle spin-echo sequence (Ma et al., 35:903-910 (1996); Song et al., 41:947-953 (1999)). For each image, an actual volume of interest (VOI) for which thickness was computed was generated by manually tracing boundaries on each slice using an IDL-based graphical interface running on a Pentium III PC under MS Window OS. The data encompassed by the VOI were preprocessed by deshading and noise reduction using a histogram deconvolution method (Hwang et al., 1999) to produce a set of BVF images. SNR values ranged between 12 to 14.","An unprocessed \u03bc-MR image is shown in ), and a zoomed region of interest from the same slice is displayed in ). The boundary of the VOI, used for thickness computation, for the particular slice is also shown ). A matching slice image from the BVF data is shown in ), along with the computed FDT map ()).","The results of these experiments are important because they determine the power of the method in longitudinal studies, designed, for example, to evaluate the efficiency of treatment. The reproducibility data yielded trabecular bone thickness means ranging from 93 to 124 \u03bcm. This analysis resulted an average coefficient of variation of 3.0% and an intra-class correlation coefficient of 0.96. Such precision allows monitoring of progression or regression of disease in serial drug intervention studies as discussed below.","A second experiment was directed toward to evaluating the performance of a method of the present invention in a longitudinal study designed to evaluate the effect of supra-physiological levels of corticosteroids on trabecular bone. Detecting the effect of steroid treatment was selected because it is a well known cause of thinning of trabecular bone.","For this purpose, data from a study conducted on rabbits which had received dexamethasone (a synthetic analog of cortisol) as a means to induce bone atrophy (Takahashi et al., 19:19 (2002)), were re-examined. In brief, the protocol involved eleven New Zealand white rabbits that either received dexamethasone (0.4 mg\/kg\/day, N=6), or were sham operated (N=5). Images were obtained at three time points, first at baseline and subsequently at four (4) and eight (8) weeks after the beginning of the corticosteroid-treatment. MR images of the distal femur epiphysis were acquired with the FLASE pulse sequence used in the previously described human subject study, affording 28 contiguous slices of 97\u00d797\u00d7300 mvoxel size. The visually matched images of \u03bc-MRI data sets (SNR values between 9 and 11), as illustrated at , were subsequently processed to yield BVF maps using a method analogous to the one used for human radius images.","The hypothesis tested was that the corticosteroid-treated rabbit group would lose bone due to thinning of trabeculae relative to the sham-operated (control) animals. The results of FDT-derived thickness analysis of image data collected previously (Takahashi et al., 2002) are plotted in . The plots show the mean average thickness values (after resolution-dependent correction) for each group at each of the three time points\u2014baseline, 4-weeks, and 8-weeks from onset of treatment. The data confirm the short-term effect of corticosteroid treatment on trabecular bone, indicating relative decreases in trabecular bone thickness of 2.8% at 4-weeks and 8.4% at 8-weeks. By contrast, however, trabecular thickness increased in the sham-operated group by 0.55% at 4-weeks and 5.3% at 8-weeks. The differences between treated and controlled groups were statistically significant (p 0.05 at 4 weeks and p=0.02 at 8 weeks).","Although bone loss in humans may be slower than in animal models, trabecular thinning subsequent to glucocorticoid treatment can be quite fast. As the data above show, bone loss and the concomitant reduction in trabecular thickness can be extraordinarily rapid. Studies on the basis of histomorphometry on iliac bone biopsies in patients on short-term glucocorticoid treatment exhibited a reduction in trabecular thickness of about 20% relative to age-matched women with postmenopausal osteoporosis (Carbonare et al., 16:97-103 (2001)). Similarly, short-term administration of parathyroid hormone was found to substantially increase trabecular thickness (Bradbeer et al., . () 37:282-289 (1992)). Thus, the effects detected in the present studies are of the same order as those presented above in a rabbit model of steroid-induced osteopenia, supporting the conclusion that the present methods provide an improved capability to follow patients during treatment.","These observations were confirmed by the mean thickness values. Thus, as shown by the disclosed experiments, the thickness value computed using the methods of the present invention is an intrinsic property of trabecular bone at a particular skeletal location in a subject, although these particular values may be differ for corresponding locations in different subjects.","The disclosures of each patent, patent application and publication cited or described in this document are hereby incorporated herein by reference, in their entirety.","While the foregoing specification has been described with regard to certain preferred embodiments, and many details have been set forth for the purpose of illustration, it will be apparent to those skilled in the art without departing from the spirit and scope of the invention, that the invention may be subject to various modifications and additional embodiments, and that certain of the details described herein can be varied considerably without departing from the basic principles of the invention. Such modifications and additional embodiments are also intended to fall within the scope of the appended claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing summary, as well as the following detailed description of the invention, will be better understood when read in conjunction with the appended drawings. It should be understood, however, that the invention is not limited to the precise arrangements and instrumentalities shown.",{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2","sub":["1 ","2","1 ","2","1 ","2","1 ","2"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":["FIGS. 3(","FIG. 3(","FIG. 3(","FIG. 3(","FIG. 3(","FIG. 3(","FIG. 3("],"i":["a","c","a","b","a","a","c","b"],"b":"3"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIGS. 4(","FIG. 4(","FIG. 4(","FIG. 4(","FIG. 4("],"i":["a","c","a","b","c","b"],"b":"4"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIGS. 5","FIG. 5","FIG. 5("],"i":["a ","b ","a ","b"],"b":"5"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIGS. 6(","FIGS. 6(","FIGS. 6(","FIGS. 6(","FIG. 6(","FIG. 6(","FIG. 6(","FIG. 6(","FIG. 6("],"i":["a","f","a","b","c","d","a","b","e","a","f","e","b"],"b":["6","6","6","6"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIGS. 8(","FIGS. 8(","FIGS. 8(","FIG. 8(","FIG. 8(","FIGS. 8("],"i":["a","d","a","b","c","d","c","a","b","d"],"b":["8","8","8","8"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIGS. 9(","FIGS. 9(","FIGS. 9(","FIGS. 9(","FIGS. 9("],"i":["a","f","a","b","c","d","e","f","c","d"],"b":["9","9","9","9","9"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":["FIGS. 11(","FIG. 11(","FIG. 11(","FIG. 11("],"i":["a","c","a","b","c"],"b":"11"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIGS. 13(","FIG. 13(","FIG. 13(","FIG. 13("],"i":["a","c","a","b","c"],"b":"13"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 14"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":["FIGS. 16(","FIG. 16(","FIG. 16(","FIG. 16(","FIG. 16(","FIG. 9(","FIG. 16(","FIG. 16("],"i":["a","d","a","b","a","c","a","d","c"],"b":"16","sup":"3 "},{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIGS. 17(","FIG. 17(","FIG. 17(","FIG. 17(","FIGS. 17(","FIGS. 17("],"i":["a","f","a","b","c","d","e","a","c"],"b":["17","17","17"]},{"@attributes":{"id":"p-0039","num":"0038"},"figref":["FIG. 18","FIG. 17"]},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 19","b":["10","20","30","40"]}]},"DETDESC":[{},{}]}
