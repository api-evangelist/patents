---
title: Method and system for loading a secure firmware update on an adapter device of a computer system
abstract: One embodiment of the present invention sets forth a method for loading a secure firmware update onto an adapter device in a computer system. The method includes the steps of sending a duplet of encrypted data conveying a same portion of an encrypted update image along a transfer path to the adapter device, restoring two portions of source data from the duplet, and determining whether to accept the source data based on the result of a comparison of the two portions of source data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08214654&OS=08214654&RS=08214654
owner: NVIDIA Corporation
number: 08214654
owner_city: Santa Clara
owner_country: US
publication_date: 20081007
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["1. Field of the Invention","Embodiments of the present invention generally relate to adapter devices incorporated in computer devices, and more specifically, to methods and systems for loading a secure firmware update on an adapter device of a computer system.","2. Description of the Related Art","Because the use of high-definition (\u201cHD\u201d) digital content becomes more popular, an increasing number of commercialized computer devices incorporate graphics processing systems that are compatible with the High-Definition Multimedia Interface (\u201cHDMI\u201d) for transmitting HD digital content to a HDMI-compatible display device. Conventionally, in order to be compatible with the HDMI, the graphics processing system is coupled to a specific adapter device, i.e. an encoder chip, via an Inter-Integrated Circuit (\u201cIC\u201d) serial interface. The encoder chip is configured to convert the pixel data from the graphics processing system into the Transition Minimized Differential Signaling (\u201cTMDS\u201d) format for transmission over the HDMI. The tasks performed by this encoder chip are usually programmed in a firmware stored in a memory embedded on the encoder chip.","As the HDMI standard evolves, updates of the encoder firmware may be released from the encoder manufacturer to enable the encoder to support upgraded versions of the HDMI standard. However, because the firmware update includes proprietary contents, it is important that the firmware update does not become exposed when it is loaded via the IC interface onto the encoder. Such exposure of the firmware update during its loading may not only facilitate unauthorized replications or misuses of the firmware update, but also render content protection implemented on the encoder vulnerable to attacks by a hacker.","As the foregoing illustrates, what is needed in the art is thus a system and method that are able to load a firmware update on an adapter device of a computer system in a confidential and secure manner, and address at least the foregoing issues.","One embodiment of the present invention sets forth a method for loading a secure firmware update onto an adapter device in a computer system. The method includes the steps of sending a duplet of encrypted data conveying a same portion of an encrypted update image along a transfer path to the adapter device, restoring two portions of source data from the duplet, and determining whether to accept the source data based on the result of a comparison of the two portions of source data.","By using encrypted duplets to load the firmware update on the adapter device, one advantage of the disclosed method and system is that unwanted accesses to the sensitive content of the firmware on the encoder can be prevented in an efficient manner.","The present application describes methods and systems for loading a secure firmware update on an adapter device of a target computer system. The firmware update for the adapter device is released as a software update package that includes an encrypted update image and an upload utility. The encrypted update image contains duplets of encrypted data obtained by encrypting twice each source data of the source firmware update. During execution, the upload tool extracts the encrypted update image, and sends each duplet through a secure transfer path to the adapter device. Because the encryption of each duplet used confidential keys and information specific to only approved computer systems, the encrypted duplet cannot be successfully decrypted on unauthorized computer systems. Impermissible misuses of the firmware update on unauthorized computer systems are thus prevented.",{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 1A","b":["102","102","104","105","105","104","106","108","106","108","110","104","106","122","122","124","102"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 1B","b":["102","152","110","122","108","122","106","108","154","104","122","124","122","156","122","124","102","108","158","102","108"]},"During execution on a target computer system, the upload utility  extracts the encrypted update image  and the identifier information SVID and SID, and loads the encrypted update image  byte-by-byte through a secure transfer path to the adapter device to update. At a point on the secure transfer path, the two source bytes of each duplet are restored and compared to verify that the currently transferred byte comes from a trustable source and has not been tampered. As a result, the duplet encryption scheme allows to maintain confidentiality of the update source program , and prevents impermissible replications or reuses in replay attacks.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 2","b":["200","200","200","202","204","206","210","202","204","210","206","206","202","210"]},"In response to instructions transmitted by the CPU , the graphics adapter  is configured to process graphics and\/or audio data. In one embodiment, the graphics adapter  comprises a graphics processing unit (\u201cGPU\u201d)  that is coupled to a local memory  and an adapter device, such as encoder . The local memory  store program instructions and graphics data processed by the GPU  to render images for presentation on a display device . The encoder  is coupled to the GPU  via a serial bus, such as an Inter-Integrated Circuit (\u201cIC\u201d) interface . The encoder  is a microcontroller chip that includes its own local memory . The memory  stores a firmware  that is executable on the encoder  to perform encoding on pixel data provided by the GPU . In one embodiment, the encoder  may be configured to convert pixel data provided by the GPU  into a Transition Minimized Differential Signaling (\u201cTMDS\u201d) format for transmission over a High-Definition Multimedia Interface (\u201cHDMI\u201d)  to the display device . In other embodiments, the encoder  may also be configured to implement the High-Bandwidth Digital Content Protection (\u201cHDCP\u201d) protocol to transmit secure premium content through the HDMI  to the display device . Because the firmware  contains sensitive content, it is desirable that updates of the firmware  are loaded on the encoder  in a confidential and secure manner.","Referring to  again, the system memory  contains an operating system (\u201cOS\u201d) , a graphics driver , and a firmware update package . In one embodiment, the firmware update package  is used to update the firmware  of the encoder . The firmware update package  includes an upload utility program  and an encrypted update image . The upload utility program  is configured to extract the encrypted update image , apply verification tests on the encrypted update image  and the computer system , and call functions of an application programming interface (\u201cAPI\u201d) in the OS  to have the graphics driver  load the encrypted update image  along a secure transfer path to the encoder . The encrypted update image  includes duplets of encrypted bytes generated by encrypting twice each byte of the firmware update source program, such as previously described in conjunction with . As the encrypted update image  is being loaded onto the encoder , the two source data bytes of each duplet are decrypted and compared to verify the integrity of the encrypted update image .",{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 3","b":["300","301","300","302","304","306","308","310","312","302","301","301","302","304","306","301","300","312","304","312","308","306","306","310","312"],"sup":"2"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 4","b":["302","301","300","402","302","301","301","404","302","301","302","406","302","408","406","302","410","301","306","301","412","302","301","312","414","302","312","312"],"sup":"2"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 5","b":["306","301","300","502","306","302","308","504","306","302","301","506","308","508","306","510","512","306","300","312","504","512","312","514","306","301","312","302","302","312"]},"By loading the firmware update in the form of encrypted duplets, the secure transfer path  can prevent direct access to the sensitive content of the firmware on the encoder . It is worth noting that while the foregoing embodiments have the duplet decryption step performed by the graphics driver , alternate embodiments described below may also have the decryption step performed on the encoder.",{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 6","b":["600","601","600","602","604","606","608","610","602","601","601","602","604","606","601","600","610","612","614","610","610","602","610","610","601","602"]},"In this embodiment, the method steps performed by the upload utility  are substantially the same as those of the previously described upload utility . Furthermore, the graphics driver  is configured to simply pass the duplets sent out by the upload utility  to the encoder  without performing any decryption steps. The decryption and verification of the duplets are performed on the encoder  provided with the adequate decryption cipher .",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 7","b":["610","601","702","610","602","612","704","610","601","602","706","612","708","610","710","610","712","704","712","610","714","601","610","602","601","602","610"]},"By using encrypted duplets to load the firmware update on the encoder, the transfer path can be secured against direct access to the sensitive content of the firmware on the encoder. Furthermore, because the encryption scheme applied on the duplets uses identification information specific to authorized target computers, impermissible uses of the firmware update on unauthorized systems can thus be prevented.","While the forgoing is directed to embodiments of the present invention, other and further embodiments of the invention may be devised without departing from the basic scope thereof. For example, aspects of the present invention may be implemented in hardware or software or in a combination of hardware and software. One embodiment of the invention may be implemented as a program product for use with a computer system. The program(s) of the program product define functions of the embodiments (including the methods described herein) and can be contained on a variety of computer-readable storage media. Illustrative computer-readable storage media include, but are not limited to: (i) non-writable storage media (e.g., read-only memory devices within a computer such as CD-ROM disks readable by a CD-ROM drive, flash memory, ROM chips or any type of solid-state non-volatile semiconductor memory) on which information is permanently stored; and (ii) writable storage media (e.g., floppy disks within a diskette drive or hard-disk drive or any type of solid-state random-access semiconductor memory) on which alterable information is stored. Such computer-readable storage media, when carrying computer-readable instructions that direct the functions of the present invention, are embodiments of the present invention.","Therefore, the scope of the present invention is determined by the claims that follow."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["So that the manner in which the above recited features of the present invention can be understood in detail, a more particular description of the invention, briefly summarized above, may be had by reference to embodiments, some of which are illustrated in the drawings. It is to be noted, however, that the drawings illustrate only typical embodiments of this invention and are therefore not to be considered limiting of its scope, for the invention may admit to other equally effective embodiments.",{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 1A"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1B"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 3"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 7","FIG. 6"]}]},"DETDESC":[{},{}]}
