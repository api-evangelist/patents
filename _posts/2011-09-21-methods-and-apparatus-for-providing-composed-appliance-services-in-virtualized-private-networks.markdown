---
title: Methods and apparatus for providing composed appliance services in virtualized private networks
abstract: Methods and apparatus that enable appliance service instances to be provisioned in a subnet of a customer's private network on a service provider network without provisioning the backend nodes in the customer's subnet. At least one front-end node instance is provisioned in the customer's subnet. Instead of provisioning the backend nodes in the customer's subnet, the appliance service provider provisions the backend node instances in the appliance service provider's subnet. In addition, at least the front-end node instance may be provided with multiple interfaces. At least two of the interfaces face different subnets, with one facing the customer subnet and the other facing the backend subnet operated by the appliance service provider in which the backend node instances are implemented. In some implementations, a third interface may face a management subnet so that the owner of the front-end node instance may manage the instance.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09319272&OS=09319272&RS=09319272
owner: Amazon Technologies, Inc.
number: 09319272
owner_city: Reno
owner_country: US
publication_date: 20110921
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION OF EMBODIMENTS","CONCLUSION"],"p":["Many companies and other organizations operate computer networks that interconnect numerous computing systems to support their operations, such as with the computing systems being co-located (e.g., as part of a local network) or instead located in multiple distinct geographical locations (e.g., connected via one or more private or public intermediate networks). For example, data centers housing significant numbers of interconnected computing systems have become commonplace, such as private data centers that are operated by and on behalf of a single organization, and public data centers that are operated by entities as businesses to provide computing resources to customers. Some public data center operators provide network access, power, and secure installation facilities for hardware owned by various customers, while other public data center operators provide \u201cfull service\u201d facilities that also include hardware resources made available for use by their customers. However, as the scale and scope of typical data centers has increased, the tasks of provisioning, administering, and managing the physical computing resources have become increasingly complicated.","The advent of virtualization technologies for commodity hardware has provided benefits with respect to managing large-scale computing resources for many customers with diverse needs, allowing various computing resources to be efficiently and securely shared by multiple customers. For example, virtualization technologies may allow a single physical computing machine to be shared among multiple users by providing each user with one or more virtual machines hosted by the single physical computing machine, with each such virtual machine being a software simulation acting as a distinct logical computing system that provides users with the illusion that they are the sole operators and administrators of a given hardware computing resource, while also providing application isolation and security among the various virtual machines. Furthermore, some virtualization technologies are capable of providing virtual resources that span two or more physical resources, such as a single virtual machine with multiple virtual processors that spans multiple distinct physical computing systems.","As another example, virtualization technologies may allow data storage hardware to be shared among multiple users by providing each user with a virtualized data store which may be distributed across multiple data storage devices, with each such virtualized data store acting as a distinct logical data store that provides users with the illusion that they are the sole operators and administrators of the data storage resource.","Web Services","The conventional Web model allows clients to access Web resources (e.g., applications, services, and data) via an HTTP client program, such as a Web browser. A technology referred to as Web services has been developed to provide programmatic access to Web resources. Web services may be used to provide programmatic access to Web resources including technology platforms (e.g., applications and services) and data (e.g., product catalogs and other databases) hosted on Web-connected computers such as Web server systems via a Web service interface. Generally speaking, a Web service interface may be configured to provide a standard, cross-platform API (Application Programming Interface) for communication between a client requesting some service to be performed and the service provider. In some implementations, a Web service interface may be configured to support the exchange of documents or messages including information describing the service request and response to that request. Such documents, or messages, may be exchanged using standardized Web protocols, such as the Hypertext Transfer Protocol (HTTP), for example, and may be formatted in a platform-independent data format, such as eXtensible Markup Language (XML), for example.","While embodiments are described herein by way of example for several embodiments and illustrative drawings, those skilled in the art will recognize that embodiments are not limited to the embodiments or drawings described. It should be understood, that the drawings and detailed description thereto are not intended to limit embodiments to the particular form disclosed, but on the contrary, the intention is to cover all modifications, equivalents and alternatives falling within the spirit and scope as defined by the appended claims. The headings used herein are for organizational purposes only and are not meant to be used to limit the scope of the description or the claims. As used throughout this application, the word \u201cmay\u201d is used in a permissive sense (i.e., meaning having the potential to), rather than the mandatory sense (i.e., meaning must). Similarly, the words \u201cinclude,\u201d \u201cincluding,\u201d and \u201cincludes\u201d mean including, but not limited to.","Various embodiments of methods and apparatus for providing composed appliance services in virtualized private networks are described. Embodiments may, for example, be implemented in the context of a service provider that provides virtualized computing resources to multiple customers. A service provider may provide resource virtualization to the customers via one or more virtualization services that allow the customers to purchase, rent, or otherwise obtain instances of virtualized resources, including but not limited to computation and storage resources, implemented on devices within a service provider network or networks in one or more service provider data centers. The section titled Example service provider networking environments describes example service provider network environments as illustrated in  in which embodiments of the methods and apparatus for composed appliance services as described herein may be implemented to provide appliance service instances in customers' private networks.","A service provider network may include subnetworks, or subnets, that each include a set of logically isolated network components. The subnets may, for example, be used to logically separate the components of virtualization services, load balancer services, appliance services, and so on from the open network. A service provider may also enable customers, including but not limited to third-party operators of various services provided on the service provider network, to create virtual private networks on the service provider network using subnets. A private network is a set of logically separated resource instances on the service provider network that are allocated to a given customer. The resource instances may be implemented on multi-tenant hardware that is shared with other customers and\/or on hardware dedicated to the particular customer. A private network may include one or more subnetworks, or subnets. A private network may be, but is not necessarily, subdivided into two or more subnets, for example a public-facing subnet and a private-facing subnet. The customer may have control over network functionality of the subnet(s) in the private network, for example controlling incoming and outgoing network traffic. A private network may, for example, enable a customer to connect existing infrastructure on the customer's network to the logically isolated resource instances in the subnet(s) of the private network, and to extend management capabilities such as security services, firewalls, and intrusion detection systems to include the customer's resource instances in the subnet(s) of the private network. As another example, private networks may be used by third parties or by the service provider to provide appliance services on the service provider network. For further illustration and discussion of private networks and subnets, see  and the discussion thereof in the section titled Example service provider networking environments.","In at least some embodiments, a service provider may also provide, or may allow a third party to provide, load balancers on the service provider network via a load balancer service. For example, a client may launch some number of resource instances (e.g., computation resources or storage resources) in the service provider network, and instruct the load balancer service to place a load balancer in front of the resource instances. The load balancer may then distribute incoming traffic across the resource instances behind the load balancer.","A service provider may also provide and\/or may allow third parties to provide appliance services to clients on the service provider network.  broadly illustrates an example appliance service, according to at least some embodiments. A client  may access or obtain an instance  of an appliance service from the service provider or from a third party. An appliance service instance  may be composed of one or more virtualized resources on the service provider network that the appliance service provider provisions on behalf of the client  that requests the instance  of the appliance service. In at least some implementations, one or more of the virtualized resources in an appliance service instance may serve as front-end or interactive node instance(s)  to which the client  communicates, and one or more others of the virtualized resources in the appliance service instance may serve as backend node instance(s)  to which the front-end node instance(s)  distribute or provide incoming traffic received from the client . The front-end node instance(s)  may, for example, be load balancers provided via a load balancer service as described above. More generally, a front-end node instance  of an appliance service instance  may be defined as a resource instance that is provisioned with at least the hardware and software necessary to support front-end or interactive operations of the respective appliance service. Similarly, a backend node instance  of an appliance service instance  may be defined as a resource instance that is provisioned with at least the hardware and software necessary to support operations of a backend node of the respective appliance service. The client  may not be aware that a front-end node instance  of the appliance service is a load balancer or other front-end component, or of the backend node instance(s)  behind the front-end node instance(s) ; the client  may simply see an appliance service endpoint or address to which the client communicates.","Examples of appliance services that may be implemented with one or more front-end nodes and one or more backend nodes as described above may include, but are not limited to, search index virtualization services, distributed databases with query nodes, and high-performance (HPC) clusters or grids with one or more front-end nodes that distribute workload among a plurality of compute nodes. More generally, such an appliance service may be any service that uses a traffic director or similar component at the front-end, or any service that has some number of client-interactive front-end nodes and some number of backend nodes that are hidden from the customer.","An appliance service may generally be implemented in a subnet of the service provider network. For example, the service provider or a third-party provider may provide a search index service on a subnet of the service provider network. Note that a subnet of a third-party provider may generally be in a private network allocated to and operated by the third-party provider. A client may request a search domain via the search index service, and an appliance service instance composed of a load balancer as a front-end node and some number of resource instances as backend nodes may then be provisioned by the search index service on the client's behalf.","A service provider may allow an appliance service provider to implement an appliance service instance within a subnet of a customer's private network on the service provider network.  illustrates an appliance service instance  implemented in a subnet  on a customer's private network , according to at least some embodiments. The appliance service provider may desire or require access to the resource instances in the appliance service instance  to manage the resource instances  and  in the appliance service instance , for example to receive operational or usage metrics for billing purposes, for health\/performance monitoring, and\/or to access the resource instances  and  in response to customer complaints about performance. However, as noted above, the customer may have complete control over the customer subnet(s) (e.g., subnet ) on the customer's private network , for example to control incoming and outgoing network traffic to the subnet(s). Thus, it is possible that a customer may purposefully or inadvertently block or interfere with at least some desired or required access of the appliance service instance  by the appliance service provider. For example, a customer might disallow outgoing usage metrics traffic from the appliance service instance  in an attempt to avoid usage fees.","To avoid this problem, resource instances in an appliance service instance  may be provisioned with two separate interfaces\u2014one interface in the customer subnet  for customer-side interactive access to the appliance service instance  (which may be referred to as a customer subnet interface), and the other interface in a subnet  operated by the appliance service provider that allows the provider access to the resource instances for monitoring and management purposes (which may be referred to as a management subnet interface). The application service provider effectively controls the management subnet interface, and thus the customer cannot purposefully or inadvertently interfere with the incoming and outgoing management traffic. While  shows these two interfaces only for the front-end node instance , note that each backend node instance  may also be configured with at least two interfaces, one on the customer subnet  for communicating with the front-end node instance , and one on the management subnet  or on a different subnet for monitoring and managing operations of the backend node instance  from the management subnet  or from the different subnet. Also note that, while  shows management subnet  outside of the customer's private network , in some implementations management subnet  may be another subnet of the customer's private network .","Providing two separate interfaces on resource instances as illustrated in  works well when the customer controls and operates the back-end nodes served by a front-end node. The load balancer service previously described is an example. A customer may launch some number of resource instances in a subnet of the customer's private network, and instruct the load balancer service to place a load balancer in front of the resource instances in the subnet. The customer may then access the load balancer instance via the customer subnet interface, and the load balancer service provider may access the load balancer instance via the management subnet interface. Note that, in this example, the customer expects to see all of the resource instances (both the load balancer and the resource instances being load-balanced) in the customer's subnet.","However, as previously noted, an appliance service instance may be composed of one or more front-end or interactive node(s) to which the customer communicates, and one or more backend node(s) to which the front-end node(s) distribute or provide incoming traffic received from the customer; the nodes may all be provisioned by the appliance service on behalf of the customer. Furthermore, the front-end node(s) may be provided by one entity, and the backend node(s) may be provided by another entity. For example, referring to , the front-end node instance(s)  may be load balancers provided via a load balancer service, while the backend node instance(s)  may be provided by the appliance service itself. The customer does not directly launch the resource instances  for the backend nodes; instead, the customer requests the appliance service provider to implement an appliance service instance  on a subnet  in the customer's private network , for example via an applications programming interface (API) to the appliance service provider. The appliance service provider launches the resource instance(s)  for the front-end node(s) in the customer's subnet, for example via an API to a load balancer service provided by the service provider or some other entity, and also launches the resource instance(s)  for the backend node(s) in the customer's subnet . For example, if the appliance service is a search index service, the customer may request a search domain, and a load balancer and some number of search backend nodes may be provisioned by the search index service in the customer's subnet  on the customer's behalf. To provision the load balancer, the search index service may communicate with a separate load balancer service, for example via an API to the load balancer service, which may be but is not necessarily provided by the service provider.","While the above works, the customer may not be aware, and generally may not care, how the appliance service is implemented. Specifically, the customer may not be aware that the appliance service instance  is implemented as multiple backend node instances(s)  and one or more front-end node instance(s)  such as load balancers that front the backend node instances(s) . The customer may simply expect to see an \u201cappliance service\u201d instance appear on the customer's subnet  with which the customer communicates. However, using this technique, the customer would instead see the front-end node instance(s)  as well as multiple backend node instances  appear on the customer's subnet . Furthermore, the appliance service instance  may be scalable\u2014that is, the appliance service instance  may add or remove node instances based on demand. However, the appearance and coming and going of all of these node instances on the customer's subnet  might be confusing to the customer.","In addition, the multiple node instances may use up IP addresses allocated to the customer for use on the customer's private network. In addition, both management and data traffic for all of the node instances in the appliance service instance  would traverse at least part of the customer's private network.","Methods and apparatus are described that enable appliance service instances to be provisioned in a subnet of a customer's private network on the service provider network without provisioning the backend nodes in the customer's subnet. In embodiments, instead of provisioning the backend nodes in the customer's subnet, the appliance service provider provisions the backend nodes in the appliance service provider's subnet, as shown in . In addition, resource instances in an appliance service instance may be provided with two, three, or more network interfaces that may each logically reside in different subnets, as illustrated in  and described below.",{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 3","FIG. 3","FIG. 3"],"b":["312","300","364","364","312","300","350","312","300","312","360","364","360","360","312","364"]},"Using embodiments as illustrated in , the customer only sees the front-end node instance(s)  on the customer subnet . In addition, IP addresses are consumed on the backend subnet  instead of the customer subnet . Furthermore, monitoring and management of the backend node instances  may be performed on the backend subnet , for example via multiple interfaces on the backend node instance(s) , thus avoiding at least some management traffic on the customer network .","Referring to , in some implementations, the customer subnet , management subnet , and backend subnet  may each be implemented as subnets of different private networks on the service provider network. This may be the case, for example, if different entities provide the front-end node instances and backend node instances of the appliance service. However, in other implementations, any two or all three of the subnets may be subnets of the same private network on the service provider network. For example, a customer may want to implement an internal appliance service on the customer's private network, while partitioning the front-end, backend, and monitoring and management components of an instance of the appliance service into different subnets of the customer's private network.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":["FIG. 4","FIG. 4"],"b":["400","450","412","412","460","460","460","464","460","464","460","460"]},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 5","b":["564","512","500","564","560","512","512","550","512"]},"An instance of a second appliance service may be instantiated in the backend subnet A of the first appliance service. Using implementations of resource instances that include three or more interfaces as described above, the front-end node instance(s) B of the second appliance service may be provisioned in the backend subnet B of the first appliance service, while the backend node instances B of the second appliance service may be provisioned in the backend subnet B of the second appliance service. The backend node instances A of the first appliance service communicate with the second appliance service via the customer subnet interface of the second appliance service's front-end node instance B, and the second appliance service's front-end node instance B may be monitored and managed by another front-end provider that operates management subnet B via the management subnet interface of front-end node instance B. The second appliance service's front-end node instance B communicates with the second appliance service's backend node instances B via the backend subnet interface of the front-end node instance B. Note that, while  shows that front-end node instances A and B are monitored and managed from different management subnets A and B, in some implementations front-end node instances A and B may be monitored and managed from the same management subnet . For example, a load balancer service may provide and manage load balancer front-end node instances for both customer subnet  and backend subnet A, and may control both from one management subnet .","Note that backend node instances B of the second appliance service instances may themselves use yet another appliance service, and thus backend subnet B may include an instance of the other appliance service front-end node similar to the backend subnet A. In addition, note that in the appliance service implementation as shown in , one or more of the appliance services that operate backend subnets  may be implemented similarly to the second appliance service shown in ; in other words, the backed instances  may use yet another appliance service.",{"@attributes":{"id":"p-0040","num":"0039"},"figref":["FIG. 6","FIG. 2"],"b":["614","650","612","600","612","600","650","612","600","612","614","650"]},"Note that, in some applicant service implementations, the backend node instances  as shown in  may use another appliance service. Thus, at least some embodiments may allow appliance service instances as illustrated in  to be \u201cchained\u201d similar to how the appliance service instances are illustrated in .",{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIGS. 3 through 6","FIG. 3","FIG. 4","FIG. 6","FIG. 5","FIG. 7","FIG. 6","FIG. 3"],"b":["764","760","712","700","764","712","712","774","770","712","760","712","750","712","774","712"]},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 8","b":["800","802","804","806","808","810"]},"In at least some embodiments, the backend node instance(s) may also be provisioned with at least two interfaces. In at least some embodiments, at least two of the interfaces of each backend node instance may face different subnets, with one of the interfaces facing the backend subnet for communicating with a front-end node instance on the customer's subnet and the other interface facing a management subnet operated by an entity that provides the backend node instances for use in managing and monitoring the backend node instance.","Interfaces","The interfaces that are provisioned on resource instances as shown in  may be any of various types of interface that are capable of receiving and\/or transmitting packets via a network or networks. One of ordinary skill in the art will recognize that any of various hardware and\/or software may be used in implementing such interfaces.","Provisioning Resource Instances and Interfaces","As previously described, a customer may request an instance of an appliance service instance, for example via an API provided by an appliance service provider. The appliance service provider may provision the resource instances for the appliance service instances, and\/or may request a third party (e.g., a third party that provides the front-end node instances used in the appliance service instance) to provision one or more resource instances. The third party may be the entity that provides the service provider network, or may be some other entity with a presence on the service provider network.","In at least some embodiments, the actual request for the allocation and provisioning of a resource instance to implement a front-end or backend node in a subnet may be made to a service provided by the entity that owns the service provider network, for example by a call to an API of a virtualization service provided by the service provider network (see, e.g., ). The request to the service may specify the number of interfaces (e.g., two, three, or more) with which the resource instance is to be provisioned, and may also specify which subnet(s) on the service provider network the interfaces are to face. The request to the service for a resource instance may also specify other configuration requirements for the resource instance.","Service and Usage Charges","In at least some implementations, the various entities that are involved in providing appliance resource instances may charge for their services, and\/or for usage of their products. For example, the operator of the service provider network may charge usage or other fees for resource instances. As another example, an appliance service provider may charge usage or other fees to customers that implement instances of the appliance service. One of ordinary skill in the art will recognize that there are many different models via which these charges may be applied. A few examples are given below.","In one example model, the appliance service provider may collect usage fees from a customer for usage of an appliance service instance. For example, the monitoring and metering methods described herein may be applied to the application service instance, and used to calculate per-time-period charges that are billed to the customer. In turn, the operator of the service provider network may charge the appliance service provider usage fees for the resource instances in the appliance service instance. If a third party is involved, for example a third party that provides the front-end node instances, the third party may charge the appliance service provider usage fees for the third party's component(s). In turn, the operator of the service provider network may charge the third party usage fees for resource instance(s) used to implement the third party's component(s).","In another example model, the operator of the service provider network may bill the customer usage fees for the customer's resources in the customer's private network. Fees for usage of the appliance service instance may be included in these charges. The operator may then pay the appliance service provider some amount on behalf of the customer. Note that the operator may also bill the appliance service provider for its own usage fees, e.g. usage fees for resource instances in the appliance service provider's private network.","Note that the above models are given as examples, and are not intended to be limiting.","Example Service Provider Networking Environments","This section describes example service provider network environments in which the above-described embodiments of the methods and apparatus for composed appliance services may be implemented to provide appliance service instances in customers' private networks. However, these example service provider network environments are not intended to be limiting.",{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 9","b":["900","910","950","912","916","912","912","900","900","914","950","900"]},"Conventionally, the service provider , via the virtualization services , may allow a customer (e.g., customer A) to dynamically associate at least some public IP addresses  assigned or allocated to the customer with particular resource instances  assigned to the customer. The service provider  may also allow the customer to remap a public IP address , previously mapped to one virtualized computing resource instance  allocated to the customer, to another virtualized computing resource instance  that is also allocated to the customer. Using the virtualized computing resource instances  and public IP addresses  provided by the service provider , a customer A may, for example, implement customer-specific applications and present the customer's applications on an intermediate network , such as the Internet. A client  on the intermediate network  may then generate traffic to a destination public IP address  published by the customer A; the traffic is routed to the service provider data center, and at the data center is routed, via a network substrate, to the private IP address  of the virtualized computing resource instance  currently mapped to the destination public IP address . Similarly, response traffic from the virtualized computing resource instance  may be routed via the network substrate back onto the intermediate network  to the source client .","Private IP addresses, as used herein, refer to the internal network addresses of resource instances in a service provider network. Private IP addresses are only routable within the service provider network. Network traffic originating outside the service provider network is not directly routed to private IP addresses; instead, the traffic uses public IP addresses that are mapped to the resource instances. The service provider network may include network devices or appliances that provide network address translation (NAT) or similar functionality to perform the mapping from public IP addresses to private IP addresses and vice versa.","Public IP addresses, as used herein, are Internet routable network addresses that are assigned to resource instances, either by the service provider or by the customer. Traffic routed to a public IP address is translated, for example via : network address translation (NAT), and forwarded to the respective private IP address of a resource instance.","Some public IP addresses may be assigned by the service provider network infrastructure to particular resource instances; these public IP addresses may be referred to as standard public IP addresses, or simply standard IP addresses. In at least some embodiments, the mapping of a standard IP address to a private IP address of a resource instance is the default launch configuration for all a resource instance types.","At least some public IP addresses may be allocated to or obtained by customers of the service provider; a customer may then assign their allocated public IP addresses to particular resource instances allocated to the customer. These public IP addresses may be referred to as customer public IP addresses, or simply customer IP addresses. Instead of being assigned by the service provider network to resource instances as in the case of standard IP addresses, customer IP addresses may be assigned to resource instances by the customers, for example via an API provided by the service provider. Unlike standard IP addresses, customer IP Addresses are allocated to customer accounts and can be remapped to other resource instances by the respective customers as necessary or desired. A customer IP address is associated with a customer's account, not a particular resource instance, and the customer controls that IP address until the customer chooses to release it. Unlike conventional static IP addresses, customer IP addresses allow the customer to mask resource instance or availability zone failures by remapping the customer's public IP addresses to any resource instance associated with the customer's account. The customer IP addresses, for example, enable a customer to engineer around problems with the customer's resource instances or software by remapping customer IP addresses to replacement resource instances.",{"@attributes":{"id":"p-0059","num":"0058"},"figref":["FIG. 10","FIG. 10"],"b":["1000","1012","1010","1000","1010","1030","1030"]},"In at least some embodiments, the IP tunneling technology may map IP overlay addresses (public IP addresses) to substrate IP addresses (private IP addresses), encapsulate the packets in a tunnel between the two namespaces, and deliver the packet to the correct endpoint via the tunnel, where the encapsulation is stripped from the packet. In , an example overlay network tunnel A from a virtual machine (VM) A on host A to a device on the intermediate network  and an example overlay network tunnel B between a VM B on host B and a VM C on host C are shown. In some embodiments, a packet may be encapsulated in an overlay network packet format before sending, and the overlay network packet may be stripped after receiving. In other embodiments, instead of encapsulating packets in overlay network packets, an overlay network address (public IP address) may be embedded in a substrate address (private IP address) of a packet before sending, and stripped from the packet address upon receiving. As an example, the overlay network may be implemented using 32-bit IPv4 (Internet Protocol version 4) addresses as the public IP addresses, and the IPv4 addresses may be embedded as part of 128-bit IPv6 (Internet Protocol version 6) addresses used on the substrate network as the private IP addresses.","Referring to , at least some networks in which embodiments may be implemented may include hardware virtualization technology that enables multiple operating systems to run concurrently on a host computer (e.g., hosts A and B of ), i.e. as virtual machines (VMs)  on the hosts . The VMs  may, for example, be rented or leased to customers of a network provider. A hypervisor, or virtual machine monitor (VMM) , on a host  presents the VMs  on the host with a virtual platform and monitors the execution of the VMs . Each VM  may be provided with one or more private IP addresses; the VMM  on a host  may be aware of the private IP addresses of the VMs  on the host. A mapping service  may be aware of all network IP prefixes and the IP addresses of routers or other devices serving IP addresses on the local network. This includes the IP addresses of the VMMs  serving multiple VMs . The mapping service  may be centralized, for example on a server system, or alternatively may be distributed among two or more server systems or other devices on the network. A network may, for example, use the mapping service technology and IP tunneling technology to, for example, route data packets between VMs  on different hosts  within the data center  network; note that an interior gateway protocol (IGP) may be used to exchange routing information within such a local network.","In addition, a network such as the service provider data center  network (which is sometimes referred to as an autonomous system (AS)) may use the mapping service technology, IP tunneling technology, and routing service technology to route packets from the VMs  to Internet destinations, and from Internet sources to the VMs . Note that an external gateway protocol (EGP) or border gateway protocol (BGP) is typically used for Internet routing between sources and destinations on the Internet.  shows an example service provider data center  implementing a network that provides resource virtualization technology and that provides full Internet access via edge router(s)  that connect to Internet transit providers, according to at least some embodiments. The service provider data center  may, for example, provide customers the ability to implement virtual computing systems (VMs ) via a hardware virtualization service and the ability to implement virtualized data stores  on storage resources  via a storage virtualization service.","The data center  network may implement IP tunneling technology, mapping service technology, and a routing service technology to route traffic to and from virtualized resources, for example to route packets from the VMs  on hosts  in data center  to Internet destinations, and from Internet sources to the VMs . Internet sources and destinations may, for example, include computing systems  connected to the intermediate network  and computing systems  connected to local networks  that connect to the intermediate network  (e.g., via edge router(s)  that connect the network  to Internet transit providers). The service provider data center  network may also route packets between resources in data center , for example from a VM  on a host  in data center  to other VMs  on the same host or on other hosts  in data center .","A service provider that provides data center  may also provide additional data center(s)  that include hardware virtualization technology similar to data center  and that may also be connected to intermediate network . Packets may be forwarded from data center  to other data centers , for example from a VM  on a host  in data center  to another VM on another host in another, similar data center , and vice versa.","While the above describes hardware virtualization technology that enables multiple operating systems to run concurrently on host computers as virtual machines (VMs) on the hosts, where the VMs may be rented or leased to customers of the network provider, the hardware virtualization technology may also be used to provide other computing resources, for example storage resources , as virtualized resources to customers of a network provider in a similar manner.",{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIG. 11","b":["1120","1124","1124","1100","1150","1124","1100","1124","1124"]},"Service provider  may provide a service customer , for example coupled to intermediate network  via local network , the ability to implement virtual computing systems  via hardware virtualization service  coupled to intermediate network  and to the local network of service provider . In some embodiments, hardware virtualization service  may provide one or more APIs , for example a web services interface, via which a service customer  may access functionality provided by the hardware virtualization service , for example via a console . In at least some embodiments, at the service provider , each virtual computing system  at customer  may correspond to a computation resource  that is leased, rented, or otherwise provided to service customer .","From an instance of a virtual computing system  and\/or another customer device  or console , the customer may access the functionality of storage virtualization service , for example via one or more APIs , to access data from and store data to a virtual data store  provided by the service provider . In some embodiments, a virtualized data store gateway (not shown) may be provided at the service customer  that may locally cache at least some data, for example frequently accessed or critical data, and that may communicate with virtualized data store service  via one or more communications channels to upload new or modified data from a local cache so that the primary store of data (virtualized data store ) is maintained. In at least some embodiments, a user, via a virtual computing system  and\/or on another customer device , may mount and access virtual data store  volumes, which appear to the user as local virtualized storage .","While not shown in , the virtualization service(s) may also be accessed from resource instances within the service provider  network via API(s) . For example, a customer, appliance service provider, or other entity may access a virtualization service from within a respective private network on the service provider  network via an API  to request allocation of one or more resource instances within the private network or within another private network.",{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 12","b":["1260","1200","1252","1250","1224","1224","1218","1218"]},"A customer's virtualized private network  may be connected to a customer network  via a private communications channel . A private communications channel  may, for example, be a tunnel implemented according to a network tunneling technology or some other peering connection over an intermediate network . The intermediate network may, for example, be a shared network or a public network such as the Internet. Alternatively, a private communications channel  may be implemented over a direct, dedicated connection between virtualized private network  and customer network .","A public network may be broadly defined as a network that provides open access to and interconnectivity among a plurality of entities. The Internet, or World Wide Web (WWW) is an example of a public network. A shared network may be broadly defined as a network to which access is limited to two or more entities, in contrast to a public network to which access is not generally limited. A shared network may, for example, include one or more local area networks (LANs) and\/or data center networks, or two or more LANs or data center networks that are interconnected to form a wide area network (WAN). Examples of shared networks may include, but are not limited to, corporate networks and other enterprise networks. A shared network may be anywhere in scope from a network that covers a local area to a global network. Note that a shared network may share at least some network infrastructure with a public network, and that a shared network may be coupled to one or more other networks, which may include a public network, with controlled access between the other network(s) and the shared network. A shared network may also be viewed as a private network, in contrast to a public network such as the Internet. In embodiments, either a shared network or a public network may serve as an intermediate network between a provider network and a customer network.","To establish a virtualized private network  for a customer on service provider  network, one or more resource instances (e.g., VMs A and B and storage A and B) may be allocated to the virtualized private network . Note that other resource instances (e.g., storage C and VMs C) may remain available on the service provider  network for other customer usage. A range of public IP addresses may also be allocated to the virtualized private network . In addition, one or more networking devices (routers, switches, etc.) of the service provider  network may be allocated to the virtualized private network . A private communications channel  may be established between a private gateway  at virtualized private network  and a gateway  at customer network .","In at least some embodiments, in addition to, or instead of, a private gateway , virtualized private network  may include a public gateway  that enables resources within virtualized private network  to communicate directly with entities (e.g., client ) via intermediate network , and vice versa, instead of or in addition to via private communications channel .","Virtualized private network  may be, but is not necessarily, subdivided into two or more subnets . For example, in implementations that include both a private gateway  and a public gateway , the private network may be subdivided into a subnet A that includes resources (VMs A and storage A, in this example) reachable through private gateway , and a subnet B that includes resources (VMs B and storage B, in this example) reachable through public gateway .","The customer may assign particular customer public IP addresses to particular resource instances in virtualized private network . A client  on intermediate network  may then send traffic to a public IP address published by the customer; the traffic is routed, by the service provider , to the associated resource instance. Return traffic from the resource instance is routed, by the service provider , back to the client  over intermediate network . Note that routing traffic between a resource instance and a client  may require network address translation to translate between the public IP address and the private IP address of the resource instance.","At least some embodiments may allow a customer to remap public IP addresses in a customer's virtualized private network  as illustrated in  to devices on the customer's external network . When a packet is received from a client (e.g., client ), the network  may determine that the destination IP address indicated by the packet has been remapped to an endpoint on external network  and handle routing of the packet to the respective endpoint, either via private communications channel  or via the intermediate network . Response traffic may be routed from the endpoint to the client through the provider network , or alternatively may be directly routed to the client by the customer network . From the perspective of the client, it appears as if the client is communicating with the public IP address of the customer on the provider network . However, the client has actually communicated with the endpoint on customer network .","While  shows client  as a client on intermediate network  and external to service provider  network, a client may be an entity on service provider  network. For example, one of the resource instances provided by the service provider  may be a client that sends traffic to a public IP address published by the customer.","Service Private Instances","In service provider network environments such as those illustrated in , the customers' virtualized resources provided through the virtualization services may generally be implemented on multi-tenant devices. For example, in a hardware virtualization service, a single physical computing machine may be shared among multiple customers by providing each customer with one or more virtual machines hosted by the single physical computing machine. As another example, in a storage virtualization service, each customer's virtualized data store may be distributed across multiple data storage devices, with a given storage device storing portions of data for two or more customers. However, at least some customers of a service provider may desire or require some degree of isolation of the customers' data and\/or processes on a service provider network. Thus, in at least some embodiments, the service provider may allow a customer to request the establishment of a private implementation of a service (e.g., a hardware virtualization service or a storage virtualization service). In response to the request, a service private instance may be automatically and\/or manually established for the customer to the service and that is at least in part implemented on single-tenant hardware that is not shared with other customers. In addition, a private API endpoint may be provided for the service private instance. While the service private instance may conform to the same service API as the service public instance, the service private instance may at least initially be implemented differently than the multi-tenant service public instance, for example as a relatively small scale and possibly limited implementation of the service when compared to the multi-tenant service public instance. As the needs of the customer grow, the service private instance may be automatically and\/or manually scaled up from the initial implementation. The service private instance may also be scaled down if the needs of the customer decrease. The scaling up or down of the service private instance may be performed transparently from the customer's perspective.","Illustrative System","In at least some embodiments, a server that implements a portion or all of one or more of the technologies, including but not limited to the various service provider methods and apparatus and the methods and apparatus for providing composed appliance services in service provider networking environments as described herein, may include a general-purpose computer system that includes or is configured to access one or more computer-accessible media, such as computer system  illustrated in . In the illustrated embodiment, computer system  includes one or more processors  coupled to a system memory  via an input\/output (I\/O) interface . Computer system  further includes a network interface  coupled to I\/O interface .","In various embodiments, computer system  may be a uniprocessor system including one processor , or a multiprocessor system including several processors  (e.g., two, four, eight, or another suitable number). Processors  may be any suitable processors capable of executing instructions. For example, in various embodiments, processors  may be general-purpose or embedded processors implementing any of a variety of instruction set architectures (ISAs), such as the x86, PowerPC, SPARC, or MIPS ISAs, or any other suitable ISA. In multiprocessor systems, each of processors  may commonly, but not necessarily, implement the same ISA.","System memory  may be configured to store instructions and data accessible by processor(s) . In various embodiments, system memory  may be implemented using any suitable memory technology, such as static random access memory (SRAM), synchronous dynamic RAM (SDRAM), nonvolatile\/Flash-type memory, or any other type of memory. In the illustrated embodiment, program instructions and data implementing one or more desired functions, such as those methods, techniques, and data described above for service provider methods and apparatus and the methods and apparatus for providing composed appliance services in service provider networking environments, are shown stored within system memory  as code  and data .","In one embodiment, I\/O interface  may be configured to coordinate I\/O traffic between processor , system memory , and any peripheral devices in the device, including network interface  or other peripheral interfaces. In some embodiments, I\/O interface  may perform any necessary protocol, timing or other data transformations to convert data signals from one component (e.g., system memory ) into a format suitable for use by another component (e.g., processor ). In some embodiments, I\/O interface  may include support for devices attached through various types of peripheral buses, such as a variant of the Peripheral Component Interconnect (PCI) bus standard or the Universal Serial Bus (USB) standard, for example. In some embodiments, the function of I\/O interface  may be split into two or more separate components, such as a north bridge and a south bridge, for example. Also, in some embodiments some or all of the functionality of I\/O interface , such as an interface to system memory , may be incorporated directly into processor .","Network interface  may be configured to allow data to be exchanged between computer system  and other devices  attached to a network or networks , such as other computer systems or devices as illustrated in , for example. In various embodiments, network interface  may support communication via any suitable wired or wireless general data networks, such as types of Ethernet network, for example. Additionally, network interface  may support communication via telecommunications\/telephony networks such as analog voice networks or digital fiber communications networks, via storage area networks such as Fibre Channel SANs, or via any other suitable type of network and\/or protocol.","In some embodiments, system memory  may be one embodiment of a computer-accessible medium configured to store program instructions and data as described above for  for implementing embodiments of service provider methods and apparatus and the methods and apparatus for providing composed appliance services in service provider networking environments. However, in other embodiments, program instructions and\/or data may be received, sent or stored upon different types of computer-accessible media. Generally speaking, a computer-accessible medium may include non-transitory storage media or memory media such as magnetic or optical media, e.g., disk or DVD\/CD coupled to computer system  via I\/O interface . A non-transitory computer-accessible storage medium may also include any volatile or non-volatile media such as RAM (e.g. SDRAM, DDR SDRAM, RDRAM, SRAM, etc.), ROM, etc, that may be included in some embodiments of computer system  as system memory  or another type of memory. Further, a computer-accessible medium may include transmission media or signals such as electrical, electromagnetic, or digital signals, conveyed via a communication medium such as a network and\/or a wireless link, such as may be implemented via network interface .","Various embodiments may further include receiving, sending or storing instructions and\/or data implemented in accordance with the foregoing description upon a computer-accessible medium. Generally speaking, a computer-accessible medium may include storage media or memory media such as magnetic or optical media, e.g., disk or DVD\/CD-ROM, volatile or non-volatile media such as RAM (e.g. SDRAM, DDR, RDRAM, SRAM, etc.), ROM, etc, as well as transmission media or signals such as electrical, electromagnetic, or digital signals, conveyed via a communication medium such as network and\/or a wireless link.","The various methods as illustrated in the Figures and described herein represent exemplary embodiments of methods. The methods may be implemented in software, hardware, or a combination thereof. The order of method may be changed, and various elements may be added, reordered, combined, omitted, modified, etc.","Various modifications and changes may be made as would be obvious to a person skilled in the art having the benefit of this disclosure. It is intended to embrace all such modifications and changes and, accordingly, the above description to be regarded in an illustrative rather than a restrictive sense."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":["FIG. 7","FIG. 6","FIG. 3"]},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 13"}]},"DETDESC":[{},{}]}
