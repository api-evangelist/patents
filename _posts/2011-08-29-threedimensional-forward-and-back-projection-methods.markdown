---
title: Three-dimensional forward and back projection methods
abstract: Methods provided for forward and back-projection, which are referred to as separable footprint (SF) projectors: exemplified by the SF-TR and SF-TT projectors. These methods approximate the voxel footprint functions as 2D separable functions. Because of the separability of these footprint functions, calculating their integrals over a detector cell is greatly simplified and can be implemented efficiently. In some embodiments, the SF-TR projector uses trapezoid functions in the transaxial direction and rectangular functions in the axial direction. In some embodiments, the SF-TT projector uses trapezoid functions in both the axial and transaxial directions. Simulations and experiments showed that both SF projector methods are more accurate than conventional distance-driven (DD) projectors. Moreover, the SF-TT projector is more accurate than the SF-TR projector for rays associated with large cone angles. In some embodiments, the SF-TR projector has similar computation speed with the DD projector and the SF-TT projector is about two times slower.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08913805&OS=08913805&RS=08913805
owner: The Regents of The University of Michigan
number: 08913805
owner_city: Ann Arbor
owner_country: US
publication_date: 20110829
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","GOVERNMENT INTEREST","FIELD","BACKGROUND AND SUMMARY","DETAILED DESCRIPTION","I INTRODUCTION","II CONE-BEAM PROJECTION","III SEPARABLE FOOTPRINT (SF) PROJECTOR","IV RESULTS","V CONCLUSION"],"p":["This application claims the benefit of U.S. Provisional Application No. 61\/378,041, filed on Aug. 30, 2010. The entire disclosure of the above application is incorporated herein by reference.","This invention was made with government support under CA059827 awarded by the National Institutes of Health. The Government has certain rights in the invention.","The present disclosure relates to X-ray computed tomography (CT) and, more particularly, relates to three-dimensional (3D) forward and backward projection methods. The invention also is applicable to other tomographic imaging modalities, such as position emission tomography (PET), and tomosynthesis imaging, and to image-guided therapy applications.","This section provides background information related to the present disclosure that is not necessarily prior art. This section also provides a general summary of the disclosure, and is not a comprehensive disclosure of its full scope or all of its features.","According to the principles of the present teachings, methods are provided for forward and back-projection, which are referred to as separable footprint (SF) projectors: the SF-TR and SF-TT projectors being exemplary embodiments. These methods approximate the voxel footprint functions as 2D separable functions. Because of the separability of these footprint functions, calculating their integrals over a detector cell is greatly simplified and can be implemented efficiently. In some embodiments, the SF-TR projector uses trapezoid functions in the transaxial direction and rectangular functions in the axial direction. In some embodiments, the SF-TT projector uses trapezoid functions in both the axial and transaxial directions. Simulations and experiments showed that both SF projector methods are more accurate than conventional distance-driven (DD) projectors. Moreover, the SF-TT projector is more accurate than the SF-TR projector for rays associated with large cone angles. In some embodiments, the SF-TR projector has similar computation speed with the DD projector and the SF-TT projector is about two times slower.","Further areas of applicability will become apparent from the description provided herein. The description and specific examples in this summary are intended for purposes of illustration only and are not intended to limit the scope of the present disclosure.","Corresponding reference numerals indicate corresponding parts throughout the several views of the drawings.","Example embodiments will now be described more fully with reference to the accompanying drawings. Example embodiments are provided so that this disclosure will be thorough, and will fully convey the scope to those who are skilled in the art. Numerous specific details are set forth such as examples of specific components, devices, and methods, to provide a thorough understanding of embodiments of the present disclosure. It will be apparent to those skilled in the art that specific details need not be employed, that example embodiments may be embodied in many different forms and that neither should be construed to limit the scope of the disclosure. In some example embodiments, well-known processes, well-known device structures, and well-known technologies are not described in detail.","The terminology used herein is for the purpose of describing particular example embodiments only and is not intended to be limiting. As used herein, the singular forms \u201ca\u201d, \u201can\u201d and \u201cthe\u201d may be intended to include the plural forms as well, unless the context clearly indicates otherwise. The terms \u201ccomprises,\u201d \u201ccomprising,\u201d \u201cincluding,\u201d and \u201chaving,\u201d are inclusive and therefore specify the presence of stated features, integers, steps, operations, elements, and\/or components, but do not preclude the presence or addition of one or more other features, integers, steps, operations, elements, components, and\/or groups thereof. The method steps, processes, and operations described herein are not to be construed as necessarily requiring their performance in the particular order discussed or illustrated, unless specifically identified as an order of performance. It is also to be understood that additional or alternative steps may be employed.","Spatially relative terms, such as \u201cinner,\u201d \u201couter,\u201d \u201cbeneath\u201d, \u201cbelow\u201d, \u201clower\u201d, \u201cabove\u201d, \u201cupper\u201d and the like, may be used herein for ease of description to describe one element or feature's relationship to another element(s) or feature(s) as illustrated in the figures. Spatially relative terms may be intended to encompass different orientations of the device in use or operation in addition to the orientation depicted in the figures. For example, if the device in the figures is turned over, elements described as \u201cbelow\u201d or \u201cbeneath\u201d other elements or features would then be oriented \u201cabove\u201d the other elements or features. Thus, the example term \u201cbelow\u201d can encompass both an orientation of above and below. The device may be otherwise oriented (rotated 90 degrees or at other orientations) and the spatially relative descriptors used herein interpreted accordingly.","Iterative statistical methods for 3D tomographic image reconstruction offer numerous advantages such as the potential for improved image quality and reduced dose, as compared to the conventional methods such as filtered back-projection (FBP). They are based on models for measurement statistics and physics, and can easily incorporate prior information, the system geometry and the detector response.","The main disadvantage of statistical reconstruction methods is the longer computation time of iterative algorithms that are usually required to minimize certain cost functions. For most iterative reconstruction methods, each iteration requires one forward projection and one back-projection, where the forward projection is roughly a discretized evaluation of the Radon transform, and the back-projector is the adjoint of the forward projector. These operations are the primary computational bottleneck in iterative reconstruction methods, particularly in 3D image reconstruction. Forward projector methods are also useful for making digitally rendered radiographs (DRR).","Traditional forward and back-projectors compute the intersection lengths between each tomographic ray and each image basis function. Many methods for accelerating this process have been proposed. Due to the finite size of detector cells, averaging the intersection lengths over each detector cell is considered to be a more precise modeling. Mathematically, it is akin to computing the convolution of the footprint of each basis function and some detector blur, such as a 2D rectangular function.","Any projector method must account for the geometry of the imaging system. Cone-beam geometries are needed for axial and helical cone-beam X-ray computed tomography (CT). In 3D parallel-beam geometry projection space, there are four independent indices (\u03bc, \u03bd, \u03c6, \u03b8). The ray direction is specified by (\u03c6, \u03b8) where \u03c6 and \u03b8 denote the azimuthal and polar angle of the ray respectively and (\u03bc, \u03bd) denote the local coordinates on a 2D area detector. In contrast, axial cone-beam projection space is characterized by three independent indices (s, t, \u03b2) and two distance parameters (D, D), where \u03b2 denotes the angle of the source point counter-clockwise from the y axis, (s, t) denote the detector coordinates, Ddenotes the source to rotation center distance and Ddenotes the isocenter to detector distance. (See ). The axial cone-beam geometry is a special case of helical cone-beam geometry with zero helical pitch.","The divergence of tomographic rays in the cone-beam geometry causes depth-dependent magnification of image basis functions, i.e., voxels close to the X-ray source cast larger shadows on the detector than voxels close to the detector. This complication does not appear in the parallel-beam geometry (e.g., in certain PET systems). Therefore, many existing projection and back-projection methods designed for 3D parallel-beam geometry are not directly suitable for cone-beam geometry.","A variety of projection methods for 3D cone-beam geometries have been proposed. All methods provide some compromise between computational complexity and accuracy. Among these, spherically symmetric basis functions (blobs) have many advantages over simple cubic voxels or other basis functions for the image representation, e.g., their appearance is independent of the viewing angle. However, evaluating integrals of their footprint functions is computationally intensive. Ziegler et al. (a) stored these integrals in a lookup-table. If optimized blobs are used and high accuracy is desired, the computation of forward and back-projection is still expensive due to loading a large table and the fact that blobs intersect many more tomographic rays than voxels.","Rectification techniques were introduced to accelerate the computation of cone-beam forward and backward projections. Riddell et al. resampled the original data to planes that are aligned with two of the reconstructed volume main axes, so that the original cone-beam geometry can be replaced by a simpler geometry that involves only a succession of plane magnifications. In iterative methods, resampled measurements can simplify forward and back-projection each iteration. However, resampling involves interpolation that may slightly decrease spatial resolution. Another drawback of this method is that the usual assumption of statistical independence of the original projection data samples no longer holds after rectification, since interpolation introduces statistical correlations.","The distance-driven (DD) projector is a current state-of-the-art method. It maps the horizontal and vertical boundaries of the image voxels and detector cells onto a common plane such as xz or yz plane, approximating their shapes by rectangles. (This step is akin to rectification). It calculates the lengths of overlap along the x (or y) direction and along the z direction, and then multiplies them to get the area of overlap. The DD projector has the largest errors for azimuthal angles of the X-ray source that are around odd multiples of \u03c0\/4, because the transaxial footprint is approximately triangular rather than rectangular at those angles.","This disclosure describes new approaches for 3D forward and back-projection that we call the separable footprint (SF) projectors, exemplified by the SF-TR and SF-TT projectors. They approximate the voxel footprint functions as 2D separable functions. This approximation is reasonable for typical axial or helical cone-beam CT geometries and for typical PET geometries. The separability of these footprint functions greatly simplifies the calculation of their integrals over a detector cell and allows efficient implementation of the SF projectors. The SF-TR projector uses trapezoid functions in the transaxial direction and rectangular functions in the axial direction, whereas the SF-TT projector uses trapezoid functions in both directions. It is accurate to use rectangle approximation in the axial direction for cone-beam geometries with small cone angles (<2\u00b0) such as the multi-slice detector geometries, and to use trapezoid approximation for CT systems with larger cone angles (>10\u00b0) such as flat-panel detector geometries. Other functions besides rectangles and trapezoids may also be suitable.","Our studies showed that both SF projector methods are more accurate than the distance-driven (DD) projector. In particular, the SF methods reduce the errors around odd multiples of \u03c0\/4 seen with DD. The SF-TT projector is more accurate than the SF-TR projector for voxels associated with large cone angles. The SF-TR projector has similar computation speed with the DD projector and the SF-TT projector is about 2 times slower.","To balance computation and accuracy, one may combine the SF-TR and SF-TT projector, that is, to use the SF-TR projector for voxels associated with small cone angles such as voxels near the plane of the X-ray source where the rectangle approximation is adequate, and use the SF-TT projector for voxels associated with larger cone angles. Other combinations of approximations may also be suitable, where the combination may depend on any of the voxel location or the detector cell location or combinations thereof.","The organization of this disclosure is as follows. Section II reviews the cone-beam geometry and projection, describes the cone-beam 3D system model. and presents the analytical formula of cone-beam projections of voxel basis functions. Section III introduces the SF projectors and contrasts the SF projectors with DD projector. Section IV gives simulation results, including accuracy and speed comparison between the SF-TR, SF-TT and DD projector as standalone modules and within iterative reconstruction. Finally, conclusions are presented in Section V.","II.1 Cone-Beam Geometry","For simplicity of presentation, we focus on the flat-detector axial cone-beam geometry (see ). The methods generalize easily to arc detectors and helical geometries among others.","The X-ray source lies on points on a circle of radius Dcentered at the rotation center on the z=0 plane. The source position {right arrow over (p)}can be parameterized as follows:",{"@attributes":{"id":"p-0033","num":"0032"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"},"mo":"=","mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":{"mo":"-","msub":{"mi":"D","mrow":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mo":"\u2062","mrow":{"mi":"s","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"}}}},"mo":["\u2062","\u2062","\u2062"],"mi":["sin","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}},{"mtd":{"mrow":{"msub":{"mi":"D","mrow":{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mo":"\u2062","mrow":{"mi":"s","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"}}},"mo":["\u2062","\u2062","\u2062"],"mi":["cos","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}]}}},{"mtd":{"mn":"0"}}]}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"1"}}]}}}},"br":{},"sub":"s0 "},"Let (s, t) denote the local coordinates on the 2D detector plane, where the s-axis is perpendicular to the z-axis, and the t-axis is parallel to the z-axis. A point on the 2D detector can be expressed as",{"@attributes":{"id":"p-0035","num":"0034"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"p","mo":"\u2192"},"mn":"1"},"mo":"=","mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":["s","cos","\u03b2"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"msub":{"mi":"D","mrow":{"mn":"0","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"d"}},"mo":["\u2062","\u2062","\u2062"],"mi":["sin","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"+"}}},{"mtd":{"mrow":{"mrow":[{"mi":["s","sin","\u03b2"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"msub":{"mi":"D","mrow":{"mn":"0","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mi":"d"}},"mo":["\u2062","\u2062","\u2062"],"mi":["cos","\u03b2"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}],"mo":"-"}}},{"mtd":{"mi":"t"}}]}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"2"}}]}}}},"br":{},"sub":["0d","sd","s0 ","0 ","1 "]},{"@attributes":{"id":"p-0036","num":"0035"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mover":{"mi":"e","mo":"\u2192"},"mo":"=","mrow":{"mfrac":{"mrow":[{"msub":[{"mover":{"mi":"p","mo":"\u2192"},"mn":"1"},{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"}],"mo":"-"},{"mo":["\uf605","\uf606"],"mrow":{"msub":[{"mover":{"mi":"p","mo":"\u2192"},"mn":"1"},{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"}],"mo":"-"}}]},"mo":"=","mrow":{"mo":["(",")"],"mtable":{"mtr":[{"mtd":{"mrow":{"mi":["sin","\u03c6","cos","\u03b8"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}}},{"mtd":{"mrow":{"mrow":{"mo":"-","mi":"cos"},"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["\u03c6","cos","\u03b8"]}}},{"mtd":{"mrow":{"mi":["sin","\u03b8"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}]}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"3"}}]},{"mtd":[{"mi":"where"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"mrow":{"mi":"\u03b3","mo":"=","mrow":{"mrow":[{"mi":"\u03b3","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"s"}},{"mi":"arctan","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":"s","msub":{"mi":["D","sd"]}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]},{"mtd":[{"mrow":{"mi":"\u03c6","mo":"=","mrow":{"mrow":[{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","\u03b2"],"mo":","}}},{"mrow":{"mi":"\u03b3","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"s"}},"mo":"+","mi":"\u03b2"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}}}},{"mrow":{"mo":["(",")"],"mn":"5"}}]},{"mtd":[{"mrow":{"mrow":{"mi":"\u03b8","mo":"=","mrow":{"mrow":[{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mo":"-","mrow":{"mi":"arctan","mo":["(",")"],"mfrac":{"mi":"t","msqrt":{"mrow":{"msup":{"mi":"s","mn":"2"},"mo":"+","msubsup":{"mi":["D","sd"],"mn":"2"}}}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"6"}}]}]}}},"br":{},"sub":["0 ","1 "]},"The cone-beam projections of a 3D object \u0192({right arrow over (x)}) where {right arrow over (x)}=(x, y, z), are given by\n\n(;\u03b2)=\u222b\u0192()\u2003\u2003(7)\n\nwhere the integral is along the line segment:\n",{"@attributes":{"id":"p-0038","num":"0037"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"mi":"\u2112","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t","\u03b2"],"mo":[",",","]}}},{"mo":["{","}"],"mrow":{"mrow":[{"msub":{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"},"mo":"+","mrow":{"mi":["l","l"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mover":{"mi":"e","mo":"\u2192"},"mstyle":[{"mtext":"\u2237"},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]}},{"mo":["[","]"],"mrow":{"mn":"0","mo":",","msub":{"mi":["L","p"]}}}],"mo":"\u2208"}}],"mo":"="},{"msub":{"mi":["L","p"]},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"},"mrow":{"msqrt":{"mrow":{"msubsup":{"mi":["D","sd"],"mn":"2"},"mo":["+","+"],"msup":[{"mi":"s","mn":"2"},{"mi":"t","mn":"2"}]}},"mo":"."}}],"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}}}},{"mrow":{"mo":["(",")"],"mn":"8"}}]}}}}},"For a point {right arrow over (x)}=(x, y, z) between the source and detector, the projected s coordinate of it is",{"@attributes":{"id":"p-0040","num":"0039"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"\u03c4","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"msub":{"mi":["D","sd"]},"mo":"\u2062","mfrac":{"mrow":[{"msub":{"mi":["\u03c4","p"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"msub":{"mi":["d","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}}]}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"9"}}]},{"mtd":[{"mi":"where"},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["\u03c4","p"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"mrow":[{"mi":["x","cos","\u03b2"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]},{"mi":["y","sin","\u03b2"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}]}],"mo":"+"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"10"}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["d","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"msub":{"mi":"D","mrow":{"mi":"s","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"}},"mo":"-","mrow":{"msub":{"mi":"\u03c4","mo":"\u22a5"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}},"mo":","}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"\u03c4","mo":"\u22a5"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"mrow":[{"mrow":{"mo":"-","mi":"x"},"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mi":["sin","\u03b2"]},{"mi":["y","cos"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"mrow":{"mi":"\u03b2","mo":"."}}],"mo":"+"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}}},{"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}]}]}}},"br":{}},{"@attributes":{"id":"p-0041","num":"0040"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"t","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":[",",","],"mi":["y","z"]}}},{"mi":"z","mo":"\u2062","mrow":{"mfrac":{"msub":{"mi":["D","sd"]},"mrow":{"msub":{"mi":["d","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}}},"mo":"."}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"11"}}]}}}},"br":{}},{"@attributes":{"id":"p-0042","num":"0041"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"mi":"\u03b2","mo":"+","mrow":{"mi":"arctan","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":[{"msub":{"mi":["\u03c4","p"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}},{"msub":{"mi":["d","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":",","mi":"y"}}}]}}}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"12"}}]},{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":["\u03b2","x"],"mo":";"},"mo":[",",","],"mi":["y","z"]}}},{"mo":"-","mrow":{"mrow":{"mi":"arctan","mo":["(",")"],"mfrac":{"mi":"z","msqrt":{"mrow":{"msubsup":[{"mi":["\u03c4","p"],"mn":"2"},{"mi":["d","s"],"mn":"2"}],"mo":"+"}}}},"mo":"."}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"13"}}]}]}}},"br":{}},"In the practice of iterative image reconstruction, rather than operating on a continuous object \u0192({right arrow over (x)}), we forward project a discretized object represented by a common basis function \u03b2({right arrow over (x)}) superimposed on a N\u00d7N\u00d7NCartesian grid as follows:",{"@attributes":{"id":"p-0044","num":"0043"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"x","mo":"\u2192"}}},{"munder":{"mo":"\u2211","mover":{"mi":"n","mo":"\u2192"}},"mo":"\u2062","mrow":{"mrow":[{"mi":"f","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"\u2192"}}},{"msub":{"mi":"\u03b2","mn":"0"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mo":["(",")"],"mrow":{"mover":{"mi":"x","mo":"\u2192"},"mo":"-","mrow":{"mover":{"mi":"c","mo":"\u2192"},"mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"\u2192"}}}}},"mo":["\u2062","\u2062"],"mi":"\u2205","mover":{"mi":"\u0394","mo":"\u2192"}}}}],"mo":"\u2062"}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"14"}}]}}}},"br":{},"sub":["1","2","3 ","1","2","3","1","2","3","1","2","3","1","2 ","1","3"],"sup":"3"},"Most projection\/back-projection methods use a linear model that ignores the \u201cexponential edge gradient effect\u201d caused by the nonlinearity of Beer's law. We adopt the same type of approximation here. Assume that the detector blur h(s, t) is shift invariant, independent of \u03b2 and acts only along the s and t coordinates. Then the ideal noiseless projections satisfy\n\n()(;\u03b2)\u2003\u2003(15)\n\nwhere p(s, t; \u03b2) is the 3D projection of \u0192({right arrow over (x)}) given by (7), and (s, t) denotes the center of detector cell specified by indices (k, l). The methods we present are applicable to arbitrary samples (s, t), but for simplicity of presentation and implementation we focus on the case of uniformly spaced samples:\n\n()\u03940, . . . ,\u22121,\n\n=()\u03940, . . . ,\u22121\n\n=(\u22121)\/2\n\n=(\u22121)\/2,\u2003\u2003(16)\n\nwhere \u0394and \u0394denote the sample spacing in s and t respectively. The user-selectable parameters cand cdenote offsets for the detector, e.g., c=\u00bc corresponds to a quarter detector offset.\n","Substituting the basis expansion model (14) for the object into (15) and using (7) leads to the linear model",{"@attributes":{"id":"p-0047","num":"0046"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mover":{"mi":["y","_"]},"mi":"\u03b2"},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msub":[{"mi":["s","k"]},{"mi":["t","l"]}],"mo":","}}},{"munder":{"mo":"\u2211","mover":{"mi":"n","mo":"\u2192"}},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["a","\u03b2"]},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":";","mover":{"mi":"n","mo":"\u2192"}}}}},{"mi":"f","mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"\u2192"}}}],"mo":"\u2062"}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"17"}}]}}}},"br":[{},{},{}],"in-line-formulae":[{},{}],"sub":["\u03b2","k","l","k","l"],"i":["[s",",t",";{right arrow over (n)}]=F","s",",t",";\u03b2;{right arrow over (n)}"]},{"@attributes":{"id":"p-0048","num":"0047"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}},{"mo":"\u222b","mrow":{"mo":"\u222b","mrow":{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":["s","k"]},"mo":"-","mi":"s"},{"msub":{"mi":["t","l"]},"mo":"-","mi":"t"}],"mo":","}}},{"mi":"q","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"mo":"\u2146","mi":"s"},{"mo":"\u2146","mi":"t"}],"mo":["\u2062","\u2062","\u2062"]}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"19"}}]}}}},"br":[{},{},{}],"sub":["0","L(s,t,\u03b2)","0"],"in-line-formulae":[{},{}],"i":["q","s,t;\u03b2;{right arrow over (n)}","{right arrow over (x)}\u2212{right arrow over (c)}[{right arrow over (n)}]","dl."]},"The goal of forward projectors is to compute (17) rapidly but accurately. Although the system matrix A is sparse, it is impractical to precompute and store even the nonzero system matrix values for the problem sizes of interest in cone-beam CT, so practical methods (including our proposed approach) essentially compute those values on the fly.","We focus on a simple separable model for the detector blur",{"@attributes":{"id":"p-0051","num":"0050"},"maths":{"@attributes":{"id":"MATH-US-00011","num":"00011"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mfrac":{"mn":"1","mrow":{"msub":[{"mi":["r","s"]},{"mi":["r","t"]}],"mo":"\u2062"}},"mo":["\u2062","\u2062"],"mrow":[{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":"s","msub":{"mi":["r","s"]}}}},{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mi":"t","msub":{"mi":["r","t"]}}}}]}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"21"}}]}}}},"br":[{},{}],"sub":["s ","t ","s ","t ","k","k-1 ","l","l-1 "]},"We focus on cubic voxel basis functions hereafter, but one could derive analytical formulas for footprints of other basis functions. The cubic voxel basis function is given by,",{"@attributes":{"id":"p-0053","num":"0052"},"maths":{"@attributes":{"id":"MATH-US-00012","num":"00012"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"msub":{"mi":"\u03b2","mn":"0"},"mo":"\u2061","mrow":{"mo":["(",")"],"mover":{"mi":"x","mo":"\u2192"}}},{"mrow":[{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"x"}},{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"y"}},{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"z"}}],"mo":["\u2062","\u2062"]}],"mo":"="}}},{"mtd":{"mrow":{"mrow":{"mo":"=","mrow":{"msub":[{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mi":"x"},{"mn":["1","2"],"mo":"\/"}],"mo":"\u2264"}}},{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mi":"y"},{"mn":["1","2"],"mo":"\/"}],"mo":"\u2264"}}},{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mi":"z"},{"mn":["1","2"],"mo":"\/"}],"mo":"\u2264"}}}],"mo":["\u2062","\u2062"]}},"mo":","}}}]}},{"mrow":{"mo":["(",")"],"mn":"22"}}]}}}},"br":{},"sub":"{\u00b7} "},"Substituting (22) into (20), the analytical formula for the cone-beam projection footprint of the {right arrow over (n)}th basis function is:",{"@attributes":{"id":"p-0055","num":"0054"},"maths":{"@attributes":{"id":"MATH-US-00013","num":"00013"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"q","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msubsup":{"mo":"\u222b","mn":"0","msub":{"mi":["L","p"]}},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":"\u03b2","mn":"0"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mo":["(",")"],"mrow":{"msub":{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"},"mo":["+","-"],"mrow":[{"mi":"l","mo":"\u2062","mover":{"mi":"e","mo":"\u2192"}},{"mover":{"mi":"c","mo":"\u2192"},"mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"\u2192"}}}]}},"mo":["\u2062","\u2062"],"mi":"\u2205","mover":{"mi":"\u0394","mo":"\u2192"}}}},{"mo":"\u2146","mi":"l"}],"mo":"\u2062"}}],"mo":["=","\u2062"],"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"msubsup":{"mo":"\u222b","mn":"0","msub":{"mi":["L","p"]}},"mo":"\u2062","mrow":{"msub":[{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mi":"d","mn":"1"},"mo":"+","mrow":{"mi":"l","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":"e","mn":"1"}}}},{"msub":{"mi":"\u0394","mn":"1"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}},{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"msub":{"mi":"d","mn":"2"},"mo":"+","mrow":{"mi":"l","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":"e","mn":"2"}}}},{"msub":{"mi":"\u0394","mn":"2"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}}],"mo":["\u2062","\u2062"],"mi":{}}}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"msub":{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"msub":[{"mi":"d","mn":"3"},{"mi":"le","mn":"3"}],"mo":"+"}},{"msub":{"mi":"\u0394","mn":"3"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}},"mo":"\u2062","mrow":{"mo":"\u2146","mi":"l"}}}}},{"mtd":{"mrow":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"msub":[{"mi":"a","mn":"1"},{"mi":"a","mn":"2"},{"mi":"a","mn":"3"},{"mrow":{"mo":["[","]"],"mrow":{"msub":[{"mi":["l","max"]},{"mi":["l","min"]}],"mo":"-"}},"mo":"+"}],"mo":["\u00b7","\u00b7","\u00b7"]}},"mo":","}}}]}},{"mrow":{"mo":["(",")"],"mn":"23"}}]}}}},"br":{},"sub":["1","2","3"]},{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00014","num":"00014"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msub":{"mrow":{"mo":["[","]"],"mi":"x"},"mo":"+"},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"},"mrow":{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"x","mo":",","mn":"0"}}}}}},"br":{}},{"@attributes":{"id":"p-0057","num":"0056"},"maths":{"@attributes":{"id":"MATH-US-00015","num":"00015"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mrow":[{"mover":[{"mi":"d","mo":"\u2192"},{"mo":"=","mi":"\u25b3"}],"mo":["\u2062","\u2062"],"mrow":{"mrow":[{"msub":{"mover":{"mi":"p","mo":"\u2192"},"mn":"0"},"mo":"-","mrow":{"mover":{"mi":"c","mo":"\u2192"},"mo":"\u2061","mrow":{"mo":["[","]"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mo":["(",")"],"mrow":{"msub":[{"mi":"d","mn":"1"},{"mi":"d","mn":"2"},{"mi":"d","mn":"3"}],"mo":[",",","]}}],"mo":"="}},{"msub":{"mi":"a","mn":"1"},"mo":"=","mrow":{"mo":["{","\u2003"],"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"msub":{"mi":"d","mn":"1"}},{"msub":{"mi":"\u0394","mn":"1"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}},"mo":","}},{"mrow":{"mrow":{"mi":["sin","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"=","mn":"0"}}]},{"mtd":[{"mrow":{"mn":"1","mo":","}},{"mrow":{"mrow":{"mrow":{"mi":["sin","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2260","mn":"0"},"mo":","}}]}]}}}],"mo":[",","\u2062"],"mstyle":{"mtext":{}}},{"msub":{"mi":"a","mn":"2"},"mo":"=","mrow":{"mo":["{","\u2003"],"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"msub":{"mi":"d","mn":"2"}},{"msub":{"mi":"\u0394","mn":"2"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}},"mo":","}},{"mrow":{"mrow":{"mi":["cos","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"=","mn":"0"}}]},{"mtd":[{"mrow":{"mn":"1","mo":","}},{"mrow":{"mrow":{"mrow":{"mi":["cos","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2260","mn":"0"},"mo":","}}]}]}}},{"msub":{"mi":"a","mn":"3"},"mo":"=","mrow":{"mo":["{","\u2003"],"mtable":{"mtr":[{"mtd":[{"mrow":{"msub":{"mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"msub":{"mi":"d","mn":"3"}},{"msub":{"mi":"\u0394","mn":"3"},"mo":"\/","mn":"2"}],"mo":"\u2264"}}},"mo":","}},{"mrow":{"mrow":{"mi":["sin","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"=","mn":"0"}}]},{"mtd":[{"mrow":{"mn":"1","mo":","}},{"mrow":{"mrow":{"mrow":{"mi":["sin","\u03c6"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},"mo":"\u2260","mn":"0"},"mo":","}}]}]}}},{"mrow":[{"msub":{"mi":["l","max"]},"mo":"=","mrow":{"mi":"min","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"msub":{"mi":["L","p"]},"mo":[",",",",","],"msubsup":[{"mi":"l","mo":"+","mn":"1"},{"mi":"l","mo":"+","mn":"2"},{"mi":"l","mo":"+","mn":"3"}]}}}},{"msub":{"mi":["l","min"]},"mo":"=","mrow":{"mi":"max","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"mn":"0","mo":[",",",",","],"msubsup":[{"mi":"l","mo":"-","mn":"1"},{"mi":"l","mo":"-","mn":"2"},{"mi":"l","mo":"-","mn":"3"}]}}}},{"msubsup":{"mi":["l","i"],"mo":"+"},"mo":"=","mrow":{"mo":["{","\u2003"],"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mi":"max","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"mfrac":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"\u0394","mo":"\u2192"},"mi":"i"},"mo":"\/","mn":"2"},"mo":"-","msub":{"mi":["d","i"]}},"msub":{"mi":["e","i"]}},{"mrow":{"mrow":{"mrow":{"mo":"-","msub":{"mover":{"mi":"\u0394","mo":"\u2192"},"mi":"i"}},"mo":"\/","mn":"2"},"mo":"-","msub":{"mi":["d","i"]}},"msub":{"mi":["e","i"]}}],"mo":","}}},"mo":","}},{"mrow":{"msub":{"mi":["e","i"]},"mo":"\u2260","mn":"0"}}]},{"mtd":[{"mrow":{"mi":"\u221e","mo":","}},{"mrow":{"mrow":{"msub":{"mi":["e","i"]},"mo":"=","mn":"0"},"mo":","}}]}]}}}],"mo":[",","\u2062",",","\u2062"],"mstyle":[{"mtext":{}},{"mtext":{}}]},{"msubsup":{"mi":["l","i"],"mo":"-"},"mo":"=","mrow":{"mo":["{","\u2003"],"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mi":"min","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"mfrac":[{"mrow":{"mrow":{"msub":{"mover":{"mi":"\u0394","mo":"\u2192"},"mi":"i"},"mo":"\/","mn":"2"},"mo":"-","msub":{"mi":["d","i"]}},"msub":{"mi":["e","i"]}},{"mrow":{"mrow":{"mrow":{"mo":"-","msub":{"mover":{"mi":"\u0394","mo":"\u2192"},"mi":"i"}},"mo":"\/","mn":"2"},"mo":"-","msub":{"mi":["d","i"]}},"msub":{"mi":["e","i"]}}],"mo":","}}},"mo":","}},{"mrow":{"msub":{"mi":["e","i"]},"mo":"\u2260","mn":"0"}}]},{"mtd":[{"mrow":{"mrow":{"mo":"-","mi":"\u221e"},"mo":","}},{"mrow":{"msub":{"mi":["e","i"]},"mo":"=","mn":"0."}}]}]}}}],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mtext":{}},{"mtext":{}},{"mtext":{}},{"mtext":{}}]}},{"mrow":{"mo":["(",")"],"mn":"24"}}]}}}},"br":{}},"It would be expensive to exactly compute the true footprint (23) and the \u201cblurred footprint\u201d (19) for the voxel basis function on the fly, so appropriate approximations of the \u201cblurred footprint\u201d (19) are needed to simplify the double integral calculation.","To explore alternatives, we simulated a flat-detector cone-beam geometry with D=541 mm and D=949 mm. We computed cone-beam projections of voxels analytically using (23) at sample locations (n\u0394, m\u0394) where \u0394=\u0394=0.001 mm and n, m\u03b5Z. The left column of  shows the exact footprint function and its profiles for a voxel with \u0394=\u0394=\u0394=1 mm centered at the origin when \u03b2=30\u00b0. The center column of  shows those of a voxel centered at (100, 150, 15) mm when \u03b2=0\u00b0. The azimuthal and polar angle of the ray connecting the source and this voxel center are 14.3\u00b0 and 2.1\u00b0 respectively. The cone angle of a typical 64-slice cone-beam CT geometry is about 2\u00b0. The right column of  shows those of a voxel centered at (93, 93, 93) mm when \u03b2=0\u00b0. The azimuthal and polar angle of the ray connecting the source and this voxel center are 11.7\u00b0 and 11.5\u00b0 respectively. The cone angle of a typical cone-beam CT geometry with 40\u00d740 cmflat-panel detector is about 12\u00b0. The first two true footprints look like 2D separable functions. The third footprint is approximately separable except for small areas at the upper left and lower right corner.","Inspired by shapes of the true footprints (see ), we approximate them as follows,",{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00016","num":"00016"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mrow":[{"mi":"q","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":["q","ap"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"\u2248"},{"mrow":[{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":["q","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"\u2062"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u25b3"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"25"}}]}}}},"br":{},"sub":"sf"},{"@attributes":{"id":"p-0062","num":"0061"},"maths":{"@attributes":{"id":"MATH-US-00017","num":"00017"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["q","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"mrow":[{"msub":{"mi":"q","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"msub":{"mi":"q","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}],"mo":"\u2062"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"26"}}]}}}},"br":{},"sub":["1","2","sf"]},"For small basis functions and narrow blurs h(s, t), the angles of rays within each detector cell that intersect each basis function are very similar, so l(s, t; \u03b2; {right arrow over (n)}) is much smoother than h(s, t) and q(s, t; \u03b2; {right arrow over (n)}). Substituting (25) into (19) leads to",{"@attributes":{"id":"p-0064","num":"0063"},"maths":{"@attributes":{"id":"MATH-US-00018","num":"00018"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":["F","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"\u2248"},{"mrow":[{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"mo":["[","]"],"mrow":{"mrow":[{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":["q","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"\u2062"}}],"mo":"**"},{"mrow":[{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"mo":["[","]"],"mrow":{"mrow":[{"mi":"h","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","t"],"mo":","}}},{"msub":{"mi":["q","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"**"}}],"mo":"\u2061"}],"mo":"\u2248"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"27"}}]}}}},"br":{},"sub":["k","l","k","l"]},"If the detector blur is also modeled as separable, i.e.,\n\n()=()(),\u2003\u2003(28)\n\nthen the blurred footprint functions (27) have the following separable approximation:\n",{"@attributes":{"id":"p-0066","num":"0065"},"maths":{"@attributes":{"id":"MATH-US-00019","num":"00019"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":["F","sf"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}},{"mrow":[{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":"F","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},{"msub":{"mi":"F","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}],"mo":["\u2062","\u2062"]}],"mo":"="},"mo":[",","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mo":["(",")"],"mn":"29"}}]},{"mtd":[{"mrow":{"mrow":[{"mrow":[{"msub":{"mi":"F","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},{"mo":"\u222b","mrow":{"mrow":[{"msub":{"mi":"h","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":"-","mi":"s"}}},{"msub":{"mi":"q","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mo":"\u2146","mi":"s"}],"mo":["\u2062","\u2062"]}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},{"mrow":[{"msub":{"mi":"F","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},{"mo":"\u222b","mrow":{"mrow":[{"msub":{"mi":"h","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["t","l"]},"mo":"-","mi":"t"}}},{"msub":{"mi":"q","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mrow":{"mo":"\u2146","mi":"t"},"mo":"."}],"mo":["\u2062","\u2062"]}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}],"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}}}},{"mrow":{"mo":["(",")"],"mn":"30"}}]}]}}},"br":{}},"One natural choice for the amplitude function l(\u00b7) is the following voxel-dependent factor that we call the A3 method:",{"@attributes":{"id":"p-0068","num":"0067"},"maths":{"@attributes":{"id":"MATH-US-00020","num":"00020"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"l","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}},{"mrow":[{"msub":{"mi":"l","mn":"3"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03b2","mo":";","mover":{"mi":"n","mo":"\u2192"}}}},{"msub":[{"mi":"l","msub":{"mi":"\u03c6","mn":"0"}},{"mi":"l","msub":{"mi":"\u03b8","mn":"0"}}],"mo":"\u00b7"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}],"mo":"="},"mo":["\u2062","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mo":["(",")"],"mn":"31"}}]},{"mtd":[{"mrow":{"msub":{"mi":"l","msub":{"mi":"\u03c6","mn":"0"}},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mfrac":{"msub":{"mi":"\u0394","mn":"1"},"mrow":{"mi":"max","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03c6","mn":"0"}}}},{"mo":["\uf603","\uf604"],"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03c6","mn":"0"}}}}],"mo":","}}}}}},{"mrow":{"mo":["(",")"],"mn":"32"}}]},{"mtd":[{"mrow":{"mrow":{"msub":{"mi":"l","msub":{"mi":"\u03b8","mn":"0"}},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mfrac":{"mn":"1","mrow":{"mo":["\uf603","\uf604"],"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":"\u03b8","mn":"0"}}}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"33"}}]}]}}},"br":{},"sub":["0","0","0","0","0","0","ap","1","2","3","\u03b2 ","\u03b8",{"sub2":"0 "},"1","2","\u03b2 ","\u03c6",{"sub2":"0 "},"\u03b2 ","\u03b8",{"sub2":"0 "},"\u03c6",{"sub2":"0 "}],"sup":"\u22121"},"To accelerate computation of the SF projector, we propose a voxel-ray-dependent amplitude named the A2 method:",{"@attributes":{"id":"p-0070","num":"0069"},"maths":{"@attributes":{"id":"MATH-US-00021","num":"00021"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"l","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":[{"mi":"l","msub":{"mi":"\u03c6","mn":"0"}},{"mi":"l","mrow":{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["s","k"]},{"mi":["t","l"]}],"mo":","}}}}],"mo":"\u00b7"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}},{"mrow":{"mo":["(",")"],"mn":"34"}}]},{"mtd":[{"mrow":{"mrow":{"msub":{"mi":"l","mrow":{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["s","k"]},{"mi":["t","l"]}],"mo":","}}}},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mfrac":{"mn":"1","mrow":{"mo":["\uf603","\uf604"],"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["s","k"]},{"mi":["t","l"]}],"mo":","}}}}}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"35"}}]}]}}},"br":{},"sub":["k","l","k","l","s","t","1","2","\u03b2","k","l"]},"We also investigated a ray-dependent amplitude named the A1 method:",{"@attributes":{"id":"p-0072","num":"0071"},"maths":{"@attributes":{"id":"MATH-US-00022","num":"00022"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"l","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":",","mrow":{"msub":{"mi":["t","l"]},"mo":";","mi":"\u03b2"}}}},{"msub":[{"mi":"l","mrow":{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":";","mi":"\u03b2"}}}},{"mi":"l","mrow":{"mi":"\u03b8","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["s","k"]},{"mi":["t","l"]}],"mo":","}}}}],"mo":"\u00b7"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}},{"mrow":{"mo":["(",")"],"mn":"36"}}]},{"mtd":[{"mrow":{"mrow":{"msub":{"mi":"l","mrow":{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":";","mi":"\u03b2"}}}},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mfrac":{"msub":{"mi":"\u0394","mn":"1"},"mrow":{"mi":"max","mo":"\u2062","mrow":{"mo":["{","}"],"mrow":{"mrow":[{"mo":["\uf603","\uf604"],"mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":";","mi":"\u03b2"}}}}}},{"mo":["\uf603","\uf604"],"mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03c6","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":";","mi":"\u03b2"}}}}}}],"mo":","}}}}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"37"}}]}]}}},"br":{},"sub":["k","k","l","s ","\u03c6(s",{"sub2":"k"},"; \u03b2) for the A","1","2 ","\u03c6",{"sub2":"0 "}]},"These amplitude methods are similar to Joseph's method where the triangular footprint function is scaled by 1\/max(|cos \u03c6|, |sin \u03c6|) for 2D fan-beam geometry. All three methods have similar accuracies, but the A3 method is much slower than the other two (see Section IV.1). Thus we do not recommend using the A3 amplitude in the SF projector method. Hereafter, we refer to (29) with either (34) or (36) as \u201cthe SF method\u201d.","III.2 SF Projector with Trapezoid\/Rectangle Function (SF-TR)","Inspired by the shapes of the true footprints associated with small cone angles (see the first two columns of ), we approximate them as 2D separable functions with trapezoid functions in the transaxial direction and rectangular functions in the axial direction. This approximation is reasonable for typical multi-slice cone-beam geometries, where the azimuthal angles \u03c6 of rays cover the entire 360\u00b0 range since the X-ray source rotates around the z axis, whereas the polar angles \u03b8 of rays are small (less than 2\u00b0) since the cone angle is small.","The approximating function in the s direction is",{"@attributes":{"id":"p-0076","num":"0075"},"maths":{"@attributes":{"id":"MATH-US-00023","num":"00023"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"q","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mrow":[{"mi":"trap","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"s","mo":";","msub":{"mi":"\u03c4","mn":"0"}},"mo":[",",",",","],"msub":[{"mi":"\u03c4","mn":"1"},{"mi":"\u03c4","mn":"2"},{"mi":"\u03c4","mn":"3"}]}}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mrow":{"mfrac":{"mrow":[{"mi":"s","mo":"-","msub":{"mi":"\u03c4","mn":"0"}},{"msub":[{"mi":"\u03c4","mn":"1"},{"mi":"\u03c4","mn":"0"}],"mo":"-"}]},"mo":","}},{"mrow":{"msub":[{"mi":"\u03c4","mn":"0"},{"mi":"\u03c4","mn":"1"}],"mo":["<","<"],"mi":"s"}}]},{"mtd":[{"mrow":{"mn":"1","mo":","}},{"mrow":{"msub":[{"mi":"\u03c4","mn":"1"},{"mi":"\u03c4","mn":"2"}],"mo":["\u2264","\u2264"],"mi":"s"}}]},{"mtd":[{"mrow":{"mfrac":{"mrow":[{"msub":{"mi":"\u03c4","mn":"3"},"mo":"-","mi":"s"},{"msub":[{"mi":"\u03c4","mn":"3"},{"mi":"\u03c4","mn":"2"}],"mo":"-"}]},"mo":","}},{"mrow":{"msub":[{"mi":"\u03c4","mn":"2"},{"mi":"\u03c4","mn":"3"}],"mo":["<","<"],"mi":"s"}}]},{"mtd":[{"mrow":{"mn":"0","mo":","}},{"mrow":{"mi":"otherwise","mo":","}}]}]}}],"mo":["\u2062","\u2062","="],"mstyle":[{"mtext":{}},{"mspace":{"@attributes":{"width":"6.1em","height":"6.1ex"}}}]}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}},{"mrow":{"mo":["(",")"],"mn":"38"}}]}}}},"br":{},"sub":["0","1","2 ","3 ","1","1","2","2"]},"The approximating function in the t direction is",{"@attributes":{"id":"p-0078","num":"0077"},"maths":{"@attributes":{"id":"MATH-US-00024","num":"00024"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":"q","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mi":"rect","mo":"\u2061","mrow":{"mo":["(",")"],"mfrac":{"mrow":{"mi":"t","mo":"-","msub":{"mi":"t","mn":"0"}},"msub":{"mi":"w","mrow":{"mi":"t","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"}}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},"mo":[",","\u2062"],"mstyle":{"mtext":{}},"mi":"where"}},{"mrow":{"mo":["(",")"],"mn":"39"}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"t","mn":"0"},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mfrac":{"mrow":{"msub":[{"mi":"t","mo":"+"},{"mi":"t","mo":"-"}],"mo":"+"},"mn":"2"}},{"msub":{"mi":"w","mrow":{"mi":"t","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"}},"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mrow":{"msub":[{"mi":"t","mo":"+"},{"mi":"t","mo":"-"}],"mo":"-"}}],"mo":[",","\u2062",","],"mstyle":{"mtext":{}}}},{"mrow":{"mo":["(",")"],"mn":"40"}}]}]}}},"br":{},"sub":["+","\u2212","3"]},"The blurred footprint functions (30) of this SF-TR projector are",{"@attributes":{"id":"p-0080","num":"0079"},"maths":{"@attributes":{"id":"MATH-US-00025","num":"00025"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":"F","mn":"1"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["s","k"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},{"mfrac":{"mn":"1","msub":{"mi":["r","s"]}},"mo":"\u2062","mrow":{"mi":"\u03b3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":["s","k"]},"mo":"-","mfrac":{"msub":{"mi":["r","s"]},"mn":"2"}},{"msub":{"mi":["s","k"]},"mo":"+","mfrac":{"msub":{"mi":["r","s"]},"mn":"2"}}],"mo":","}}}}],"mo":"="},"mo":[",","\u2062"],"mstyle":{"mtext":{}},"mi":"and"}},{"mrow":{"mo":["(",")"],"mn":"41"}}]},{"mtd":[{"mrow":{"mrow":[{"mrow":{"mrow":{"msub":{"mi":"F","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},"mo":"=","msub":{"mrow":{"mfrac":{"mn":"1","msub":{"mi":["r","t"]}},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"mrow":[{"mi":"min","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"msub":{"mi":["t","l"]},"mo":"+","mfrac":{"msub":{"mi":["r","t"]},"mn":"2"}},"mo":",","msub":{"mi":"t","mo":"+"}}}},{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"msub":{"mi":["t","l"]},"mo":"-","mfrac":{"msub":{"mi":["r","t"]},"mn":"2"}},"mo":",","msub":{"mi":"t","mo":"-"}}}}],"mo":"-"}}},"mo":"+"}},"mo":[",","\u2062"],"mstyle":{"mtext":{}},"mi":"where"},{"mrow":[{"mrow":[{"msub":{"mi":"\u03b3","mn":"1"},"mo":["(","\u2062",")"],"mrow":{"msub":[{"mi":"b","mn":"1"},{"mi":"b","mn":"2"}],"mo":","},"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}},{"mrow":{"mfrac":{"mn":"1","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"\u03c4","mn":"1"},{"mi":"\u03c4","mn":"0"}],"mo":"-"}}}},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"\u03c4","mn":"0"}],"mo":"-"}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"1"},{"mi":"\u03c4","mn":"0"}],"mo":"-"}},"mn":"2"}],"mo":"-"}}},"mo":"\u2062","msub":{"mn":"1","mrow":{"mo":["{","}"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"b","mn":"1"}],"mo":">"}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},{"mrow":[{"msub":{"mi":"\u03b3","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"1"},{"mi":"b","mn":"2"}],"mo":","}}},{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"b","mn":"1"}],"mo":"-"}},"mo":"\u2062","msub":{"mn":"1","mrow":{"mo":["{","}"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"b","mn":"1"}],"mo":">"}}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}],"mo":[",","\u2062",","],"mstyle":{"mtext":{}}}],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mtext":{}},{"mtext":{}}],"mtable":{"mtr":[{"mtd":{"mrow":{"mrow":[{"mi":"\u03b3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"1"},{"mi":"s","mn":"2"}],"mo":","}}},{"msubsup":{"mo":"\u222b","msub":[{"mi":"s","mn":"1"},{"mi":"s","mn":"2"}]},"mo":"\u2062","mrow":{"mrow":[{"mi":"traps","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"s","mo":";","msub":{"mi":"\u03c4","mn":"0"}},"mo":[",",",",","],"msub":[{"mi":"\u03c4","mn":"1"},{"mi":"\u03c4","mn":"2"},{"mi":"\u03c4","mn":"3"}]}}},{"mo":"\u2146","mi":"s"}],"mo":"\u2062"}}],"mo":["\u2062","\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"},"mi":{}}}},{"mtd":{"mrow":{"mo":["=","\u2062"],"mi":{},"mrow":{"mrow":{"msub":{"mi":"\u03b3","mn":"1"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"1"},{"mi":"\u03c4","mn":"0"}],"mo":","}}},{"mi":"min","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"2"},{"mi":"\u03c4","mn":"1"}],"mo":","}}}],"mo":","}}},"mo":"+"}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"mrow":{"msub":{"mi":"\u03b3","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"1"},{"mi":"\u03c4","mn":"1"}],"mo":","}}},{"mi":"min","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"2"},{"mi":"\u03c4","mn":"2"}],"mo":","}}}],"mo":","}}},"mo":"+"}}}},{"mtd":{"mrow":{"mi":{},"mo":"\u2062","mrow":{"mrow":{"msub":{"mi":"\u03b3","mn":"3"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"1"},{"mi":"\u03c4","mn":"2"}],"mo":","}}},{"mi":"min","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"s","mn":"2"},{"mi":"\u03c4","mn":"3"}],"mo":","}}}],"mo":","}}},"mo":","}}}}]}}},{"mrow":{"mo":["(",")"],"mn":"42"}}]},{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":"\u03b3","mn":"3"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"1"},{"mi":"b","mn":"2"}],"mo":","}}},{"mrow":[{"mfrac":{"mn":"1","mrow":{"mn":"2","mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"\u03c4","mn":"3"},{"mi":"\u03c4","mn":"2"}],"mo":"-"}}}},"mo":"\u2061","mrow":{"mo":["[","]"],"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"1"},{"mi":"\u03c4","mn":"3"}],"mo":"-"}},"mn":"2"},{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"\u03c4","mn":"3"}],"mo":"-"}},"mn":"2"}],"mo":"-"}}},{"msub":{"mn":"1","mrow":{"mo":["{","}"],"mrow":{"msub":[{"mi":"b","mn":"2"},{"mi":"b","mn":"1"}],"mo":">"}}},"mo":"."}],"mo":"\u2062"}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}}},{"mrow":{"mo":["(",")"],"mn":"43"}}]}]}}},"br":{}},"Inspired by the shape of true footprint of a voxel associated with large cone angles (see the last column of ), we approximate it as a 2D separable function with trapezoid functions in both the transaxial and axial direction. This trapezoid approximation in axial direction is reasonable for cone-beam geometries with large cone angles (>10\u00b0) such as flat-panel detector geometries.","Along s, the SF-TT projector uses the same trapezoid approximation as the SF-TR projector. The trapezoid footprint and the blurred footprint are given in (38) and (41).","The approximated footprint function in t is",{"@attributes":{"id":"p-0084","num":"0083"},"maths":{"@attributes":{"id":"MATH-US-00026","num":"00026"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":"q","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}},{"mi":"trap","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mi":"t","mo":";","msub":{"mi":"\u03be","mn":"0"}},"mo":[",",",",","],"msub":[{"mi":"\u03be","mn":"1"},{"mi":"\u03be","mn":"2"},{"mi":"\u03be","mn":"3"}]}}}],"mo":["\u2062","\u2062"],"mover":{"mo":"=","mi":"\u0394"}},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"44"}}]}}}},"br":{},"sub":["0","1","2 ","3 ","0 ","1 ","1","1","2","2","3","3","2 ","3 ","1","1","2","2","3","3"]},{"@attributes":{"id":"p-0085","num":"0084"},"maths":{"@attributes":{"id":"MATH-US-00027","num":"00027"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"msub":{"mi":"F","mn":"2"},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["t","l"]},"mo":[";",";"],"mi":"\u03b2","mover":{"mi":"n","mo":"\u2192"}}}},{"mfrac":{"mn":"1","msub":{"mi":["r","t"]}},"mo":"\u2062","mrow":{"mi":"\u03b3","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":[{"msub":{"mi":["t","l"]},"mo":"-","mfrac":{"msub":{"mi":["r","t"]},"mn":"2"}},{"msub":{"mi":["t","l"]},"mo":"+","mfrac":{"msub":{"mi":["r","t"]},"mn":"2"}}],"mo":","}}}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"45"}}]}}}},"br":{}},"By choosing the vertices of the approximating footprints to match the projections of the voxel boundaries, the approximation adapts to the relative positions of the source, voxels and detector, as true footprints do. Take a voxel centered at the origin as an example. Its axial footprint is approximately a rectangular function (see the left figure in the third row of ), instead of a trapezoid function. For this voxel trap(t; \u03be, \u03be, \u03be, \u03be) is almost a rectangle because \u03be\u2248\u03beand \u03be\u2248\u03bebecause \u03be, \u03be, \u03be, and \u03beare the projected t coordinates of four axial boundaries of this voxel.","III.4 Implementation of SF Projector","We use the system matrix model (18) with the separable footprint approach (29) for both forward and back projection, which ensures that the SF forward and back projector are exact adjoint operators of each other.",{"@attributes":{"id":"p-0088","num":"0087"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"294pt","align":"center"}},"thead":{"row":[{"entry":"TABLE 1"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Pseudo-code for the SF-TR forward projector with the A1"},{"entry":"amplitude method (SF-TR-A1) and the A2 method (SF-TR-A2)."},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"280pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["\u2022","Initialize projection view array to zero, i.e., [s, t] = 0 for k = 0, . . . , N\u2212 1 and"]},{"entry":[{},"l = 0, . . . , N\u2212 1"]},{"entry":["\u2022","For each row n= 0, 1, . . . , N\u2212 1 of f[{right arrow over (n)}]:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"266pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"1. For each column n= 0, 1, . . . , N\u2212 1:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(a)","Compute trapezoid vertices \u03c4, \u03c4, \u03c4, \u03c4in (38) using (9)."]},{"entry":[{},"(b)","Determine indices (svalues) of detector cells that intersect [\u03c4, \u03c4], i.e."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"{k : [s\u2212 r\/2, s+ r\/2] \u2229 [\u03c4, \u03c4] \u2260 \u2205}."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"(c)","Compute transaxial footprint F(s; \u03b2; {right arrow over (n)}) using (41) and (43) for all these"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"svalues and store them."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"238pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"(d)","Compute lusing (32) (SF-TR-A2 only)"]},{"entry":[{},"(e)","For each slice n= 0, 1, . . . , N\u2212 1:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"\u2009i.","Determine indices (tvalues) of detector cells that intersect [t, t],"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"i.e., {l : [t\u2212 r\/2, t+ r\/2] \u2229 [t, t] \u2260 \u2205}."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"196pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"ii.","For each tvalue:"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"182pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"A.","Compute F(t; \u03b2; {right arrow over (n)}) using (42)."]},{"entry":[{},"B.","For each svalue:"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"-","Compute projection p(s, t; \u03b2; {right arrow over (n)}) where"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"p = f[{right arrow over (n)}] F(s; \u03b2; {right arrow over (n)}) F(t; \u03b2; {right arrow over (n)}) for SF-TR-A1 ,"]},{"entry":[{},"p = f[{right arrow over (n)}]lF(sk; \u03b2; {right arrow over (n)}) F(t; \u03b2; {right arrow over (n)}) for SF-TR-A2."]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"-","Update projection view [s, t] + = p."]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"280pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["\u2022","Scale all the projection view by l(s, t; \u03b2) using (36) for SF-TR-A1 or by l"]},{"entry":[{},"using (35) for SF-TR-A2 ."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}]}}},"Table 1 summaries the SF-TR projector with the A1 amplitude method (SF-TR-A1) and with the A2 method (SF-TR-A2) for a given projection view angle \u03b2. Implementing the SF-TT projector with these two amplitude methods is similar. Implementation of the back-projector is similar, except for scaling the projections at the beginning instead of the end. The key to efficient implementation of this method is to make the inner loop over z (or equivalently over t), because the values of F(s; \u03b2; {right arrow over (n)}) are independent of z and tso they are precomputed prior to that loop. Because (11) is linear in z, the first value of t for a given (x, y) position can be computed prior to the inner loop over z, and subsequent values can be computed by simple incremental updates. Thus only simple arithmetic operations and conditionals are needed for evaluating F(t; \u03b2; {right arrow over (n)}) in that inner loop; all trigonometric computations occur outside that loop. Note that this separable footprint approach does not appear to be particularly advantageous for 2D fan-beam forward and backprojection because computing the transaxial footprint F(s; \u03b2; {right arrow over (n)}) requires trigonometric operations. The compute efficiency here comes from the simple rectangular footprint approximation in the axial direction. More computation is needed for the SF-TT method because it uses trapezoids in the axial direction instead rectangles.","The implementation of amplitude l(s, t; \u03b2; {right arrow over (n)}) in (29) for the A1 and A2 methods are different. For the A1 method, for each \u03b2 the amplitude l(s, t; \u03b2) is implemented by scaling projections outside the loop over voxels since it depends on detector cells only. For the A2 method, we implemented the two terms (land lof l(s, t; \u03b2; {right arrow over (n)}) separately. We scaled the projections by loutside of the loop over voxels and computed loutside the inner loop over z since it does not depend on z.","The SF methods require O(N) operations for forward\/back projection of a Nvolume to\/from Nsamples of the cone-beam projections. There exist O(Nlog N) methods for back-projection. However, those algorithms may not capture the distance-dependent effect of detector blur incorporated in the model (18). In 2D one can use the Fourier Slice Theorem to develop O(Nlog N) methods, but it is unclear how to generalize those to 3D axial and helical CT efficiently.","III.5 SF Compared with DD","The DD method essentially approximates the voxel footprints using rectangles in both directions on a common plane such as xz or yz plane. It also uses the separable and shift-invariant detector blur (21) on the detector plane. However, the approximated separable detector blurs on the common plane based on the mapped boundaries of original detector blurs are no longer shift invariant. This appears to prevent using the inner loop over sthat aids efficiency of the SF methods.","To evaluate our proposed SF-TR and ST-TT projectors, we compared them with the DD projector, a current start-of-the-art method. We compared their accuracy and speed as single modules and within iterative reconstruction methods.","IV.1 Forward and Back-Projector as Single Modules","We simulated an axial cone-beam flat-detector X-ray CT system with a detector size of N\u00d7N=512\u00d7512 cells spaced by \u0394=\u0394=1 mm with N=984 angles over 360\u00b0. The source to detector distance Dis 949 mm, and the source to rotation center distance Dis 541 mm. We included a rectangular detector response (21) with r=\u0394and r=\u0394.","We implemented the SF-TR and SF-TT projector in an ANSI C routine. The DD projector was provided by De Man et al., also implemented as ANSI C too. All used single precision. For both the SF methods and the DD method we used POSIX threads to parallelize the operations. For the forward projector each thread works on different projection views, whereas for the back projector each thread works on different image rows (n).","IV.1.1 Maximum Errors of Forward Projectors","We define the maximum error as",{"@attributes":{"id":"p-0097","num":"0096"},"maths":{"@attributes":{"id":"MATH-US-00028","num":"00028"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"e","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"\u03b2","mo":";","mover":{"mi":"n","mo":"\u2192"}}}},{"munder":{"mi":"max","mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u211d"],"mo":"\u2208"}}},"mo":"\u2062","mrow":{"mo":["\uf603","\uf604"],"mrow":{"mrow":[{"mi":"F","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}},{"msub":{"mi":["F","ap"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":",","mrow":{"mi":["t","\u03b2"],"mo":[";",";"],"mover":{"mi":"n","mo":"\u2192"}}}}}],"mo":"-"}}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"46"}}]}}}},"br":{},"sub":"ap "},"We compared the maximum errors of these forward projectors for a voxel with \u0394=\u0394=\u0394=1 mm centered at the origin. Since the voxel is centered at the origins of all axes, we choose N=180 angles over only 90\u00b0 rotation.  shows the errors on a logarithmic scale. We compared the proposed three amplitude methods by combining them with the SF-TR projector. The errors of the A1 method are slightly larger than those of the A2 and A3 method; the biggest difference, at \u03b2=45\u00b0, is only 3.4\u00d710. The error curves of the A2 and A3 methods overlap with each other. For the SF-TT projector, we plotted only the A1 and A2 methods because the combination of the SF-TT projector and A3 method is computationally much slower but only slightly improves accuracy. For the same amplitude method, the error curves of the SF-TR and SF-TT method overlap. The reason is that the rectangular and trapezoid approximation are very similar for a voxel centered at the origin of z axis. All the SF methods have smaller errors than the DD method, i.e., the maximum error of the DD projector is about 652 times larger than the proposed SF methods with the A1 amplitude, and 2.6\u00d710times larger than the SF methods with the A2 amplitude when \u03b2=45\u00b0.",{"@attributes":{"id":"p-0099","num":"0098"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 2"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Speed comparison of DD, SF-TR and"},{"entry":"SF-TT forward and back projectors."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"7"},"colspec":[{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"28pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},{},"SF-TR-","SF-TR-","SF-TR-","SF-TT-","SF-TT-"]},{"entry":["Projectors","DD","A1","A2","A3","A1","A2"]},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}},{"entry":["Forward","46","35","35","59","91","91"]},{"entry":["time",{},{},{},{},{},{}]},{"entry":["Backward","49","44","45","63","92","93"]},{"entry":"time"},{"entry":{"@attributes":{"namest":"1","nameend":"7","align":"center","rowsep":"1"}}},{"entry":"The units are seconds."}]}}]}}},{"@attributes":{"id":"p-0100","num":"0099"},"figref":"FIG. 3","sub":"\u03b2"},"IV.1.2 Speed of Forward and Back-Projectors","We compared computation times of the DD, SF-TR and SF-TT forward and backward projectors using an image with a size of N=512, N=512, N=128 and a spacing of \u0394=\u0394=\u0394=0.5 mm in the x, y, z direction respectively. We evaluated the elapsed time using the average of 5 projector runs on a 8-core Sun Fire X2270 server with 2.66 GHz Xeon X5500 processors. Because of the \u201chyperthreading\u201d of these Nehalem cores, we used 16 POSIX threads. (We found that using 16 threads reduced computation time by only about 10% compared to using 8 threads.)","Table 2 summarizes the computation times. For the SF-TR projector, the A1 and A2 amplitude methods have similar speed, but the A3 method is about 50% slower. The computation times of the SF-TR and DD projector are about the same, whereas the SF-TT projector is about 2 times slower. Although execution times depend on code implementation, we expect SF-TR and DD to have fairly similar compute times because the inner loop over z involves similar simple arithmetic operations for both methods.","IV.2 Forward and Back-projectors within Iterative ROI Reconstruction","We compared the DD and SF projectors (SF-TR and SF-TT) with the A1 and A2 amplitude methods within iterative image reconstructions. The results of A1 and A2 methods were visually the same. For simplicity, we present the results of SF projectors with the A1 method.","IV.2.1 SF-TR vs. DD","In many cases, the region of interest (ROI) needed for diagnosis is much smaller than the scanner field of view (FOV). ROI reconstruction can save computation time and memory. Ziegler et al. (b) proposed the following approach for iterative reconstruction of a ROI.\n\n","This method requires accurate forward and back projectors. Errors in step 2, where re-projection of the masked image is computed, can greatly affect the results of subsequent iterative ROI reconstruction. Moreover, for general iterative image reconstruction, even small approximation errors might accumulate after many iterations. We evaluated the accuracy of our proposed SF-TR projector and the DD projector in this iterative ROI reconstruction method.","We simulated the geometry of a GE LightSpeed X-ray CT system with an arc detector of 888 detector channels for 64 slices (N=888, N=64) by N=984 views over 360\u00b0. The size of each detector cell was \u0394\u00d7\u0394=1.0239\u00d71.0964 mm. The source to detector distance was D=949.075 mm, and the source to rotation center distance was D=541 mm. We included a quarter detector offset in the s direction to reduce aliasing.","We used a modified 3D Shepp-Logan digital phantom that has ellipsoids centered at the z=0 plane to evaluate the projectors. The brain-size field of view (FOV) was 250\u00d7250\u00d740 mm, sampled into 256\u00d7256\u00d764 voxels with a coarse resolution of 0.9766\u00d70.9766\u00d70.6250 mm.","We simulated noiseless cone-beam projection measurements from the Shepp-Logan phantom by linearly averaging 8\u00d78 analytical rays sampled across each detector cell. Noiseless data is used because we want to focus on projector accuracy. We scaled the line integrals by a chosen factor to set their maximum value to about 5.","We chose a ROI centered at the rotation center that covered about 48.8\u00d748.8\u00d712.5 mm(50\u00d750\u00d720 voxels with the coarse resolution). The transition zone surrounds the ROI, and covers about 13.7\u00d713.7\u00d75 mm(14\u00d714\u00d78 voxels with the coarse resolution). To construct masked images {circumflex over (x)}, we removed the ROI and smoothly weighted the voxels corresponding to the transition zone by a 3D separable Gaussian function.  shows different views of xwith the transition zone superimposed on it in the first row.","We implemented iterative image reconstruction of the entire FOV with these two projector\/backprojector methods. We ran 300 iterations of the conjugate gradient algorithm, initialized with reconstruction by the FDK method, for the following penalized weighted least-squares cost function with an edge-preserving penalty function (PWLS-CG):",{"@attributes":{"id":"p-0111","num":"0115"},"maths":{"@attributes":{"id":"MATH-US-00029","num":"00029"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"mi":"\u03a6","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["x","FOV"]}}},{"mrow":[{"munder":{"mo":"\u2211","mi":"i"},"mo":"\u2062","mrow":{"msub":{"mi":["w","i"]},"mo":["\u2062","\u2062"],"mfrac":{"mn":["1","2"]},"msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["y","i"]},{"mrow":{"mo":["[","]"],"msub":{"mi":["Ax","FOV"]}},"mi":"i"}],"mo":"-"}},"mn":"2"}}},{"mi":"\u03b2","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mi":"R","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["x","FOV"]}}}}],"mo":"+"}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"47"}}]},{"mtd":[{"mrow":{"mrow":{"mrow":[{"mi":"R","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mi":["x","FOV"]}}},{"munder":{"mo":"\u2211","mi":"k"},"mo":"\u2062","mrow":{"mi":"\u03c8","mo":"\u2061","mrow":{"mo":["(",")"],"msub":{"mrow":{"mo":["[","]"],"msub":{"mi":["Cx","FOV"]}},"mi":"k"}}}}],"mo":"="},"mo":","}},{"mrow":{"mo":["(",")"],"mn":"48"}}]}]}}},"br":{},"sub":"i "},{"@attributes":{"id":"p-0112","num":"0116"},"maths":{"@attributes":{"id":"MATH-US-00030","num":"00030"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"\u03c8","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mfrac":{"msup":{"mi":"\u03b4","mn":"2"},"mn":"3"},"mo":"\u2062","mrow":{"mrow":{"mo":["(",")"],"mrow":{"msqrt":{"mrow":{"mn":"1","mo":"+","mrow":{"mn":"3","mo":"\u2062","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mi":["t","\u03b4"]}},"mn":"2"}}}},"mo":"-","mn":"1"}},"mo":"."}}],"mo":"="}},{"mrow":{"mo":["(",")"],"mn":"49"}}]}}}},"br":{},"sub":["i","i"]},{"@attributes":{"id":"p-0113","num":"0117"},"figref":"FIG. 5","sub":["FOV","FOV","j","j","j"],"sup":["SF-TR ","DD "]},{"@attributes":{"id":"p-0114","num":"0118"},"maths":{"@attributes":{"id":"MATH-US-00031","num":"00031"},"math":{"@attributes":{"overflow":"scroll"},"mrow":{"msqrt":{"mrow":{"mfrac":{"mn":"1","mi":"N"},"mo":"\u2062","mrow":{"munderover":{"mo":"\u2211","mrow":{"mi":"j","mo":"=","mn":"1"},"mi":"N"},"mo":"\u2062","mrow":{"mo":["(",")"],"mrow":{"msub":[{"mover":{"mi":"x","mo":"^"},"mi":"j"},{"mi":["x","j"]}],"mo":"-"}}}}},"mo":"."}}},"br":{},"sub":["FOV","FOV"],"sup":["SF-TR ","DD "]},"We applied the PWLS-CG iterative method mentioned above with \u03b2=1 and \u03b4=1 HU to reconstruct estimated ROI images {circumflex over (x)}and {circumflex over (x)}of 256\u00d7256\u00d764 voxels with a fine resolution of 0.2441\u00d70.2441\u00d70.3125 mm. The domains of {circumflex over (x)}and {circumflex over (x)}covered the ROI and transition zone (see ). For this image geometry, we also generated a Shepp-Logan reference image xfrom the same ellipsoid parameters used to generate x.  shows different views of xin the second row. The fine sampling of xis \u00bc and \u00bd of the coarse sampling of xin the transaxial and axial direction respectively, and has a size of 200\u00d7200\u00d740.",{"@attributes":{"id":"p-0116","num":"0120"},"figref":"FIG. 6","sub":["ROI","ROI"],"sup":["SF-TR ","DD "]},"We also reconstructed full FOV images (not shown) at a fine resolution, i.e., 1024\u00d71024\u00d7128 voxels with a spacing of 0.2441\u00d70.2442\u00d70.3125 mm. There were no apparent artifacts in both reconstructed images using the SF-TR and DD method and the maximum and RMS errors were similar. It seems that the aliasing artifacts in the reconstruction by the DD method were removed by fine sampling. For smaller transaxial voxel sizes, the difference between the rectangular (DD method) and trapezoid (SF-TR) approximation becomes less visible.","IV.2.2 SF-TR Vs. SF-TT","We compared the SF-TR and SF-TT projectors by reconstructing an image under an axial cone-beam CT system with largest cone angle of 15\u00b0 or so using these two methods. We expected to see differences in some off-axis slices of the reconstructed images because the trapezoid approximation of the SF-TT method is more realistic than the rectangle approximation of the SF-TR method especially for voxels far away from the origin. Nevertheless, we did not see obvious visual difference, and the maximum and RMS errors were similar. It appears that the axial cone-beam artifacts due to poor sampling (not truncation) at the off-axis slices dominate other effects in the reconstructed images, such as the errors caused by rectangle approximation. Further research will evaluate these two projectors within iterative reconstruction methods under other CT geometries where the off-axis sampling is better, such as helical scans, yet where the cone angle is large enough to differentiate the SF-TR and SF-TT method.","We presented two new 3D forward and back projector for X-ray CT: SF-TR and SF-TT. Simulation results have shown that the SF-TR projector is more accurate with similar computation speed than the DD projector, and the SF-TT projector is more accurate but computationally slower than the SF-TR projector. The DD projector is particularly favorable relative to other previously published projectors in terms of the balance between speed and accuracy. The SF-TR method uses trapezoid functions in the transaxial direction and rectangular functions in the axial direction, while the SF-TT method uses trapezoid functions in both directions. The rectangular approximation in the axial direction is adequate for CT systems with small cone angles, such as the multi-slice geometries. The trapezoid approximation is more realistic for geometries with large cone angles, such as the flat-panel detector geometries. To balance accuracy and computation, we recommend to combine the SF-TR and SF-TT method, which is to use the SF-TR projector for voxels corresponding to small cone angles and to use the SF-TT projector for voxels corresponding to larger cone angles.","The model and simulations here considered an ideal point source. For a finite sized X-ray source there would be more blur and it is possible that the differences between the SF and DD methods would be smaller.","Approximating the footprint functions as 2D separable functions is the key innovation of this approach. Since the separability greatly simplifies the calculation of integrals of the footprint functions, using more accurate functions in the transaxial and axial direction is possible without complicating significantly the calculations.","The computational efficiency of the SF methods rely on the assumption that the vertical (t) axis of the detector plane is parallel to the rotation axis. If the detector plane is slightly rotated then slight interpolation would be needed to resample onto coordinates that are parallel to the rotation axis.","Although we focused on voxel basis functions in this disclosure, the idea of 2D separable footprint approximation could also be applied to other basis functions with separability in the axial and transaxial directions, with appropriate choices of functions.","The foregoing description of the embodiments has been provided for purposes of illustration and description. It is not intended to be exhaustive or to limit the disclosure. Individual elements or features of a particular embodiment are generally not limited to that particular embodiment, but, where applicable, are interchangeable and can be used in a selected embodiment, even if not specifically shown or described. The same may also be varied in many ways. Such variations are not to be regarded as a departure from the disclosure, and all such modifications are intended to be included within the scope of the disclosure."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DRAWINGS","p":["The drawings described herein are for illustrative purposes only of selected embodiments and not all possible implementations, and are not intended to limit the scope of the present disclosure.",{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIGS. 2A-2C","sup":"3 "},{"@attributes":{"id":"p-0011","num":"0010"},"figref":["FIGS. 3A-3B","FIG. 3A","FIG. 3B"]},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIGS. 4A-4B"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":["FIGS. 5A-5B","FIG. 5A","FIG. 5B"]},{"@attributes":{"id":"p-0014","num":"0013"},"figref":["FIGS. 6A-6D","FIGS. 6A","FIGS. 6C","FIGS. 6A","FIGS. 6B"],"b":["6","6","6","6"]}]},"DETDESC":[{},{}]}
