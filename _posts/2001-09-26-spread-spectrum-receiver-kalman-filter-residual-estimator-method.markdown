---
title: Spread spectrum receiver kalman filter residual estimator method
abstract: A GPS receiver receives GPS spread spectrum communication signals subject to carrier demodulation and code phase autocorrelation using tightly coupled Kalman filter residual estimation based on Ricatti matrix computation for generating code phase errors and carrier phase errors for improved code phase tracking and carrier phase tracking in feedback loops for use in navigation systems.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06914931&OS=06914931&RS=06914931
owner: The Aerospace Corporation
number: 06914931
owner_city: El Segundo
owner_country: US
publication_date: 20010926
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["REFERENCE TO THE RELATED APPLICATION","STATEMENT OF GOVERNMENT INTEREST","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT"],"p":["The present application is related to applicant's co-owned U.S. Pat. No. 6,516,021 entitled Global Positioning System and Inertial Measuring Unit Ultratight Coupling Method, now on the military critical technology list, for official use only.","The invention was made with Government support under contract No. F04701-00-C-0009 by the Department of the Air Force. The Government has certain rights in the invention.","The invention relates to the field of communications and navigation systems. More particularly, the present invention relates to communication systems coupled to inertial navigation systems having robust Kalman prefiltering generating residual estimates used for improved signal tracking.","Two fundamental components of a GPS signal are a pseudorandom noise code and a carrier. Navigation data are derived from this signal by correlating it with code and carrier replicas generated by the GPS receiver. A code tracking loop attempts to drive the code correlation error, the difference between the receiver generated replica and the received signal, to zero by advancing or retarding the replica code rate. Receiver to satellite range, or pseudorange, is computed from the code phase because the code phase is determined by the time required for the signal to travel from the satellite to the receiver. When the code correlation error is small the receiver is said to be in code lock.","The carrier loop tracks either the carrier frequency or phase by beating a replicated carrier against the received signal to generate an error harmonic. The measured frequency of the error is fed through a filter to form a correction to the carrier replica oscillator. The receiver is said to be in carrier lock when the error harmonic frequency is small, typically less than ten Hertz. Receiver to satellite range rate, or pseudorange rate, is computed from the replicated carrier frequency offset, or Doppler shift, from the nominal carrier frequency. A 50.0 Hertz navigation message superimposed on all GPS signals admits a 180\u00b0 degree phase ambiguity in the carrier. A frequency locked loop or a phase locked loop implemented as a Costas loop allows tracking with no loss of lock across data bit changes. Both code and carrier tracking loops adjust the phase and frequency of the generated replicas to account for many factors, which include receiver and satellite motion, receiver clock drift, and ionospheric and tropospheric signal delays.","Nonzero tracking errors appear as unmodeled range and range rate errors that corrupt the navigation solution. With navigation updates computed nominally once per second, only the most recent data taken prior to the measurement time are included in measurements provided to the navigation filter. Most of the correlation data taken over the one-second interval are used to keep the tracking loop in lock. This is determined by the tracking loop bandwidth, which, if set too low, will not track the signal through receiver acceleration or turns.","In traditional tracking loops, there is the possibility that the errors in the loops are time correlated because there is a delay in the loops as the loops drive the error signal to zero. Depending on the order of the tracking loop, there may actually be a steady state tracking error when the order of the dynamic motion exceeds the order of the tracking loop. This is commonly called the dynamic stress error. Even with inertial aiding to the tracking loop, the tracking error can be time correlated because of time correlated errors in the aiding data. This possibility has limited tracking performance because the tracking loop measurement errors can manifest themselves as errors in the state vector after processing, which in turn can affect future aiding data and possibly cause the IMU navigation and GPS tracking system to generate a wrong but consistent navigation solution. With normal tracking loops, the GPS measurements used by the navigation filter are deliberately spaced out in time to avoid the unwanted temporal correlations of the tracking loops.","In conventional tracking loops, the measurement noise variance used by the navigation filter is usually estimated from the tracking state and the carrier to noise ratio. There is no guarantee that these values are consistent with the actually realized measurement errors. Hence, a large integration navigation filter may process measurements with an erroneous uncertainty variance of the measurement noise. The navigation filter can be implemented as a Kalman filter.","In conventional tracking loops, the measurement of pseudorange acceleration is not considered because there is no apparent way to obtain a low noise estimate of the pseudorange acceleration from the tracking loops. Conventional tracking loops do not have an ability to determine the pseudorange acceleration. The use of a pseudorange acceleration measurement has many potential benefits in the observability of user clock and IMU error instability. With a pseudorange acceleration measurement, there is a more direct measurement of higher order errors with increased observability. Normally, these errors are observed through dynamic coupling into pseudorange and pseudorange rate measurements. Hence, without the pseudorange acceleration measurements, the observability of clock and IMU instabilities is limited. This limitation can be reduced using highly accurate user clocks and inertial measuring units.","Advanced tracking loop designs have been proposed to alleviate some of the loss of lock and reacquisition problems by tightly coupling IMU data with the carrier and code tracking loops and centralizing the navigation and correlation functions. With the navigation filter essentially forming part of the tracking loop, the computational burden becomes very high because the navigation filter that now has many states must also be updated at tens of Hertz rather than the conventional one Hertz.","With unlimited navigation filter processor throughput, the navigation filter could be operated at extremely high rates with no loss of optimality due to time correlated tracking loop errors. This high rate operation is similar to what has been called a vector delay lock loop. A vector delay lock loop is a method to track all satellites in view simultaneously with one common algorithm. The vector delay lock loop broadens the normal aided and unaided tracking loop design approach to both code and carrier tracking on all in view satellites. The entire algorithm must run at very high processing rates because there is no provision for federated processing. Unfortunately, current processor throughput cannot support Kalman filter rates of several tens of Hertz with the large state vectors required for GPS inertial navigation. Large Kalman filters may be decomposed into one or more federated Kalman filters within a Kalman filter processing architecture. For example, a large Kalman filter can be decomposed into two partitions including a large integration Kalman filter and a high rate optimal prefilter that are more compatible with modern processing speed requirements. The fundamental principle is to decompose the complete formulation into suitable partitions such that the important bandwidths and models are appropriate for each partition. In IMU aided GPS sets designed to date, large navigation filters have not been decomposed into suitable partitions to allow optimal processing of the raw GPS samples with the IMU samples.","Another approach to aiding the code and carrier correlation process is to design a tracking filter that provides estimates of carrier phase tracking error, rate and acceleration, satellite to user range error, and signal amplitude. The filtered estimates, which are processed at a high rate, are provided to the navigation filter where they are processed at a much lower rate to form the navigation solution. An extended Kalman filter of this design has fifth order or higher order dynamics and an associated matrix Riccati equation that must be integrated with each correlator datum. The computational burden is extraordinarily high.","Tightly coupled navigation solutions require estimation of the residual error in real time for computation of carrier phase error and code phase error during carrier demodulation and autocorrelation. Computational requirements of Kalman filter residual estimation suffer from computation complexity. These and other disadvantages are solved or reduced using the invention.","An object of the invention is to provide a method for improved code phase tracking in spread spectrum communication systems.","Another object of the invention is to provide a method for improved code phase tracking and carrier phase tracking in spread spectrum communication systems.","Yet another object of the invention is to provide a method for improved code phase tracking and carrier phase tracking in spread spectrum communication systems using a tightly coupled residual estimating Kalman filter.","Still another object of the invention is to provide a method for improved code phase tracking and carrier phase tracking in GPS spread spectrum communications using a tightly coupled residual estimating Kalman filter in a GPS navigation system.","A further object of the invention is to provide a method for generating code phase tracking errors and carrier phase tracking errors respectively for code phase tracking and carrier phase tracking of GPS spread spectrum communication signals using a residual estimating Kalman prefilter operating on Ricatti matrices for improved autocorrelation locking in a GPS navigation system.","The present invention is a communication method directed to carrier phase and code phase tracking using Kalman filter residual estimation well suited for spread spectrum communication systems such as GPS navigation systems. Inphase and quadrature correlation data are processed to provide estimates of carrier phase tracking error and rate and acceleration, as well as code phase tracking error, and signal amplitude. The filter state is a tracking residual applicable to navigation solution correction in ultratight GPS coupling with inertial measurements. The tracking residual estimation drives the code and carrier replica oscillators in tightly coupled correlation loops providing adjusted early and late code replicas and adjusted demodulation carriers for closed-loop code and carrier tracking. The close-loop code and carrier tracking can also be applied to a weak lock navigation systems also using the tracking residual estimation to the code and carrier replica oscillators.","The method improves interference robustness and navigation accuracy. Improved interference robustness is realized first, through the use of a code tracking and carrier tracking Kalman filter with a Riccati matrix computation process wherein tracking is achieved without the need for consistent signal lock in the usual sense. Second, all correlator early and late inphase and quadrature input to the Kalman filter contribute to form the measurement residual. Third, since correlator early and late inphase and quadrature do not need to be processed in real time to keep tracking loops in lock, application of more advanced algorithms in low signal to noise conditions becomes feasible.","Navigation accuracy is improved by real time computation of a residual variance using the Ricatti matrix. The real time computation allows a navigation processor to rapidly compute navigation solutions in the presence of noisy signals. Range acceleration availability enables rapid navigation solution convergence with improved observability of signal instabilities. Using correlation data taken over a computational time interval provides accurate tracking error estimates.","A tracking filter for the code and carrier correlation process of a GPS receiver provides estimates of carrier phase tracking error, rate and acceleration, range error, and signal amplitude. Both inphase and quadrature measurements are processed by the Kalman filter residual estimator. The filter dynamics and associated Riccati equations that are independent of the phase error enable implementation of steady state point designs. The Kalman filter state is a tracking residual applicable as a navigation solution correction well suited for ultratight GPS and IMU coupling. The tracking residual is used to drive the code and carrier oscillators for adjusting early and late code replicas and demodulation carrier signals for improved interference robustness and navigation accuracy. The filter state is an observation measurement residual that can be directly used by the navigation filter as a navigation solution correction. The error dynamics are independent of carrier phase tracking error. Harmonic terms in the phase error are not present in the filter Riccati equation nor in the error dynamics for enabling implementation of a steady state design. The real time Kalman filter processing uses filter state estimates to directly command both code and carrier correlation processes. These and other advantages will become more apparent from the following detailed description of the preferred embodiment.","An embodiment of the invention is described with reference to the figures using reference designations as shown in the figures. Referring to , a global positioning system (GPS) inertial navigation system includes a navigation system  receiving GPS signals and inertial measurement unit samples from a sensor assembly  and provides position and velocity data to a control and display unit . The navigation system  functions as a GPS inertial navigation system tracking GPS signals from a plurality of in view satellites, not shown. The sensor assembly  includes an antenna  for receiving and providing received GPS signals and includes an inertial measurement unit (IMU)  providing the IMU sample signals, both of which are communicated to the navigation system . The navigation system  includes a downconverter  for frequency downconversion of the received GPS signals using a reference oscillator  providing an finternal frequency reference, and includes an analog to digital (A\/D) converter  communicating digitized GPS samples to a navigation processor . The navigation processor  also receives the IMU samples and provides the position and velocity data to the control and display unit .","Referring to , A and B, and more particularly to , the navigation system  may be a weak lock navigation system that includes a navigation processor  receiving the digitized GPS samples  that are communicated to mixers  and  for providing inphase (I) and quadrature (Q) signals respectively using cos and sin demodulation signals from a carrier numerically controlled oscillator (NCO)  using the reference oscillator f. The cos and sin demodulation signals are replica carrier signals for carrier demodulating the received GPS samples . The I and Q sample signals are received by a correlator  receiving early (E) and late (L) code replica signals from a chipping code generator  receiving a chipping code clocking signal from a code clock NCO . The code generator  may further include a prompt replica, not shown, for improved sampling. The chipping code may be a direct sequence spread spectrum code. The correlator  may operate, for example, at 50 Hz. The correlator  provides inphase and quadrature, early and late, GPS correlated sample signals I, Q, I, and Q, communicated, for example, at 1K Hertz into a measurement residual Kalman prefilter  having, for example, a one Hertz output. The prefilter  can receive I and Q sampled outputs from one or more correlators  to accommodate dual fand ffrequency integration using, for example, two respective NCOs  and  and two respective code generators , for providing an integrated error vector to the single integration filter . The Kalman prefilter  computes the residual carrier phase errors \u03c6, carrier frequency error {dot over (\u03c6)}, carrier frequency rate error {umlaut over (\u03c6)}, residual code phase error rand a matrix P. The carrier phase errors \u03c6, {dot over (\u03c6)}, and {umlaut over (\u03c6)}may, in the context of inertial navigation, respectively correspond to a pseudorange, pseudorange rate and pseudorange acceleration. The carrier frequency error {dot over (\u03c6)}is the first time rate of change derivative of the carrier phase error \u03c6. The carrier frequency rate error {umlaut over (\u03c6)}is the second time rate of change derivative of the carrier phase error \u03c6. The Kalman prefilter  also computes the amplitude a, code phase error r, and a measurement covariance matrix P as part of a measurement vector. The Kalman prefilter  computes the measurement state covariance matrix P indicating the uncertainties in the measurement vector of errors for a number of samples m over a major cycle epoch time. The Kalman prefilter  can be used as part of a weak lock method using local carrier and code tracking loops for improved code and carrier tracking. The Kalman prefilter  can further be used in an ultratight method for GPS pseudorange computation tightly coupled with the correlation process to improve the ability to maintain tracking lock upon the received GPS signals.","In the exemplar weak lock GPS navigation processor, the correlator outputs I, Q, I, and Qare also sampled by a GPS navigation calculator . The Kalman prefilter  and GPS navigation calculator  provide system outputs  including the receiver position and velocity output P\/V. The code phase error ris communicated to the code generator  in a local code phase tracking loop. Concurrently, the carrier frequency error {dot over (\u03c6)}is fed to the carrier NCO in a carrier tracking loop. The navigation calculator  computes the best estimate of the navigation state vector solution defined by the position and velocity data P\/V. The GPS navigation calculator  computes user clock error estimates (CEE) communicated to a pseudorange and rate calculator .","In the exemplar ultratight GPS navigation processor, IMU samples  are communicated to a 100 Hz inertial navigation calculator  providing the receiver position and velocity outputs P\/V. The Kalman prefilter measurement vector of errors and the state covariance matrix P are communicated to the one Hertz integration Kalman filter  having a one second major cycle time period between Kalman filter epochs. The integration Kalman filter  in turn repetitively provides estimates of the position and velocity errors in an error state vector (ESV) that are used to compute the position and velocity output data  communicated to the control unit . The IMU samples  are communicated to a 100 Hz inertial navigation calculator  that computes the best estimate of the navigation state vector solution defined by GPS receiver position and velocity data P\/V. The term P\/V indicates the calculated position and velocity data. The position and velocity data P\/V is calculated from the IMU samples  and the error state vector ESV. At the end of each of the one second major cycles, the Kalman filter  updates the ESV and then communicates the ESV to the navigation calculator . The IMU samples  are repetitively generated, for example, one hundred times a second, and include differential velocity samples \u0394V and differential attitude samples \u0394\u03b8 that are communicated to the 100 Hz inertial navigation calculator  also receiving the error state vector (ESV) every second from the integration Kalman filter . The integration Kalman filter  computes the user clock error estimates (CEE) that are communicated to the pseudorange and rate calculator . The 100 Hz inertial navigation calculator  is used for strapdown inertial navigation processing.","In the exemplar weak lock navigation processor of , the navigation calculator  provides the best estimate of the navigation state vector solution indicated by the position and velocity data (P\/V) communicated to the 100 Hz delta pseudorange and delta pseudorange rate calculator  that in turn provides delta pseudorange rate data to the carrier NCO  and provides delta pseudorange data to the code NCO . The delta pseudorange and delta pseudorange rate calculator  receives calculated GPS satellite position and velocity (P-V) data from a 100 Hz GPS satellite position and velocity calculator  and receives the user clock error estimates (CEE). The term P-V references the GPS satellite calculated position and velocity data. The clock error estimates (CEE) include a clock phase error and clock frequency error that is the time derivative of the clock phase error. The calculated delta pseudorange is equal to the change in the geometric line of sight range to a satellite adjusted by the clock phase error estimates CEE and certain signal propagation compensation terms, such as the nominal ionospheric and tropospheric delays that are not shown. The delta pseudorange is a change in the geometric range taken within respect to the one Hertz prefilter  updates applied to the carrier NCO  and the code generator . The geometric range is computed from the GPS calculated position and velocity data P-V, and from the navigation calculated position and velocity data P\/V. The delta pseudorange rate is equal to the change in the relative geometric velocity to the satellite from the user antenna  plus the clock frequency error estimate. The GPS satellite position and velocity calculator  receives timing signals from a timer  using the reference f and receives demodulated ephemeris data from an ephemeris demodulator  using the GPS samples  to compute the GPS satellite position and velocity data P-V. The weak lock formulation accommodates larger errors between the replica signal and the received signal by observing the errors over many data samples and correcting the replica signal at a much lower rate than the sampling rate of the correlation process inputs.","In the exemplar ultratight navigation processor of , the navigation calculator  provides the best estimate of the navigation state vector solution indicated by the position and velocity data (P\/V) communicated to the 100 Hz pseudorange and pseudorange rate calculator  that in turn provides pseudorange rate data to the carrier code NCO  and provides pseudorange data to the code NCO . The pseudorange and pseudorange rate calculator  receives calculated GPS satellite position and velocity (P-V) data from a 100 Hz GPS satellite position and velocity calculator  and receives the user clock error estimates (CEE). The term P-V references the GPS satellite calculated position and velocity data. The clock error estimates (CEE) include a clock phase error and clock frequency error that is the time derivative of the clock phase error. The calculated pseudorange is equal to the geometric line of sight range to a satellite adjusted by the clock phase error estimates CEE and certain signal propagation compensation terms, such as the nominal ionospheric and tropospheric delays that are not shown. The geometric range is computed from the GPS calculated position and velocity data P-V, and from the IMU calculated position and velocity data P\/V. The pseudorange rate is equal to the relative geometric velocity to the satellite from the user antenna  plus the clock frequency error estimate. The GPS satellite position and velocity calculator  receives timing signals from a timer  using the reference f and receives demodulated ephemeris data from an ephemeris demodulator  using the GPS samples  to compute the GPS satellite position and velocity data P-V.","The GPS satellite position and velocity calculator  is used for satellite GPS position and velocity calculation. The pseudorange and pseudorange rate calculator  is used for line of sight pseudorange and pseudorange rate predictions. The delta pseudorange and delta pseudorange rate calculator  is used for indicating changes in line of sight pseudorange and pseudorange rate predictions. The carrier NCO  is used for generating carrier replica signals for quadrature demodulation of the received GPS samples . The code generator  is used for early and late code replica signal generation. The correlator  is used for integrate and dump correlation of the I and Q carrier demodulated signals correlated with the early and late code replica signals.","The correlation process is based upon the early and late replica code signal generation by the code generator  and upon the replica carrier generation by the carrier NCO . As the pseudorange and pseudorange rate data from the calculator  are refreshed during each cycle, the replica carrier cos and sin signals from the carrier NCO  and the early and late replica codes signals from the code generator  are adjusted under close loop processing. The correlator  may operate at  Hz enabling conventional early and late correlation by providing the early and late I and Q samples to the Kalman prefilter . The Q and I samples contain amplitudinal informational that can be used with signal correlation functions to estimate the code and carrier errors. The carrier and code phase offsets of the replica signals as compared to the received GPS sample signal can be determined as offsets knowledge of the signal correlation function. The carrier and code phase offsets are used to estimate the residual errors.","Referring to all of the Figures, and more particularly to , the measurement residual Kalman prefilter  is based on a GPS signal residual estimation process that receives the process inputs I, Q, I, and Qthat are taken as the correlator early (E) and late (L), and, inphase (I) and quadrature (Q) samples from the correlator . The process inputs I, Q, I, and Qmay be processed at a rate of 1 KHz. The process inputs are represented collectively by the symbol set Y=[I,Q,I,Q]. The GPS signal residual prefilter  has four process components or algorithms, including a 1 KHz measurement residual generator , a 1 KHz state estimate calculator , a state propagator , and a 5 Hz state error covariance estimator . The GPS signal residual estimator process receives the process input y and generates the residual measurements \u03c6, {dot over (\u03c6)}, {umlaut over (\u03c6)}e, r, and a.","The measurement residual generator  computes a measurement residual r at 1 KHz from the process input y and the propagated state {overscore (x)}. The propagated state {overscore (x)} has five components where {overscore (x)}=[{overscore (\u03c6)}, {overscore({dot over (\u03c6)})}, {umlaut over({overscore (\u03c6)})}, r, a]. The propagated state {overscore (x)} includes the carrier phase error state {overscore (\u03c6)}, the carrier frequency error state {dot over({overscore (\u03c6)})}, the carrier frequency rate error state {overscore({umlaut over (\u03c6)})}, code phase error state {overscore (r)}that is related to the range from the receiver to the satellite, and the signal amplitude state \u0101.","Each component of the measurement residual r depends on the carrier phase error state {overscore (\u03c6)}, code phase error state {overscore (r)}, the early to late replicated code offset \u03b4, the broadcast data d, and the signal amplitude state \u0101 of the received spread spectrum signal . There is a nonlinear relationship between the residual components and the measurement residual r defined by an r matrix. \n\n","In the residual matrix, the code correlation function c(\u2022) depends on the pseudorandom noise code chip width \u03bbas defined by a c(\u03c1) pseudorandom noise code equation. \n\n","In the c(\u03c1) pseudorandom noise code equation for a coarse acquisition (CA) receiver, the nominal code rate \u03c9is known as the chipping rate where \u03c9=1.023\u00d710chips\/sec. Because the speed of light is C=2.99792458\u00d710m\/sec, the CA code chip width is \u03bb=293.1 m. The true code rate differs slightly from \u03c9due to user to satellite relative motion and atmospheric transmission effects. For the case where the early and late codes are offset from the correlation peak by \u00bc chip, \u03b4=\u03bb\u224573.26 m. The broadcast message data is d=\u00b11 and has a nominal 20.0 millisecond period.","A state update calculator  computes the state estimate x at a rate of 1 KHz. From the measurement residual r, from the propagated state {overscore (x)}, and from a state error covariance estimate P, the state estimate x is equal to {overscore (x)}+K({overscore (x)},P)r, where K is the gain. The gain K depends on components of the propagated state {overscore (x)} and depends on the Riccati matrix P. The gain K is computed to minimize the error variance as a linear Kalman filter gain K({overscore (x)}, P)=Ph({overscore (x)})V\u03b4, where his a transposed linearized observation matrix and Vis an inverse observation covariance. The term \u03b4is a time step and may be, for example, 0.001 second. The term h({overscore (x)}) is a linearized observation matrix. The term V is the measurement noise variance as used in an observation equation of the y process input.","The filter measurement y\u2208R, where y is the process input including observations I, Q, I, Q, is modeled as a nonlinear function of the true state x, which is not known, with additive noise \u03bd as y=G(x)+\u03bd with G(x) given by a G(x) observation matrix of the true state x. \n\n","In the G(x) observation matrix, the amplitude a, the code phase error r, and the carrier phase error \u03c6components can be a true state xhaving a, r, and \u03c6components. The process input y is the sum of the observation matrix G(x) and the additive noise \u03bd, as in an observation equation of the y process input. \n\n","The additive disturbance \u03bd\u2208Ris taken to be a random process with a zero-mean Gaussian distribution and the observation covariance V. The observation covariance V reflects correlation with respect to the early and late, inphase and quadrature correlator output signals but with the additive disturbance \u03bd where \u03bd=[\u03bd, \u03bd, \u03bd, \u03bd], where \u03bd is uncorrelated both in time and with respect to the I and Q correlator output signals. With \u03b4=\u00bd being the offset, normalized to the code wavelength, between the early and late correlation signals, then the observation noise covariance V is given by an observation expectation covariance equation. \n\n","The observation expectation covariance equation includes a measurement noise structure matrix including the terms 0, 1 and \u03b3 that define a measurement noise structure. In the covariance expectation equation, E is a statistical expectation of the additive disturbance \u03bd, \u03b3=1\u2212\u03b4, the scalar a is the signal amplitude is a component of the state x, and 1\/\u03b7 is the signal-to-noise ratio. The observation covariance matrix V can be shown as an exemplar observation matrix V. \n\n","The state estimation error e is defined as e=x\u2212{overscore (x)} as in a state estimation error equation.\n\n()]\n","In the state estimation error equation, \u0117 is the time derivative of the state error estimate. The process input measurement y is expressed as a function of the state estimation e in a y expansion equation. \n\n","The the expansion equation, y expanded about the propagated state state {overscore (x)}. In the expansion equation, y is the process input from the correlator  and the first partial derivative of the observation matrix G(x) is the linearized observation matrix h({overscore (x)}) and is defined by an h({overscore (x)}) partial derivative equation. \n\n","The h({overscore (x)}) partial derivative equation can be written in matrix form as an h({overscore (x)}) linearized observation matrix equation. \n\n","In the h({overscore (x)}) linearized observation matrix equation, c\u2032({overscore (r)}+\u03b4)and c\u2032({overscore (r)}\u2212\u03b4) are the code correlation sensitivities to range error, and can be expressed by range partial differential equations. \n\n\n","The state propagator  computes at 1 KHz the propagated state {overscore (x)} where the propagated state components are {overscore (\u03c6)}, {overscore({dot over (\u03c6)})}, {overscore({umlaut over (\u03c6)})}, {overscore (r)}, \u0101. The state propagation dynamics are linear, such that, {overscore (\u03c6)}=\u03c6+{dot over (\u03c6)}\u03b4+{umlaut over (\u03c6)}\u03b4, {overscore({dot over (\u03c6)})}={dot over (\u03c6)}+{umlaut over (\u03c6)}\u03b4, {overscore({dot over (\u03c6)})}={umlaut over (\u03c6)}, {overscore (r)}=r+(\u03bb\/2\u03c0)\u03b4{dot over (\u03c6)}, and \u0101=a, wherein \u03b4=0.001 sec and \u03b4is the propagation period, and \u03bb\u22450.1903 m, that is, \u03bbis the carrier wavelength. The L band carrier frequency is \u03c9and \u03c9=2.99792458\u00d710Hz, so that \u03bb=C\/\u03c9\u22450.1903 m, where C is the speed of light.","The state error covariance estimator  provides a state covariance estimate P at 5 Hz preferably only using the {overscore (x)} propagated state components {overscore (r)}and \u0101. The state covariance estimator  may be implemented as a look-up table. Elements of a P scheduling look-up table, that could be a trivial look-up table of only one element, are computed using a state dynamic matrix A. A continuous time representation of the state dynamics is linear with {dot over (x)}=Ax+\u03c9, with {dot over (x)} being the time derivative of the state x, and with A being the state dynamics matrix. \n\n","In the state dynamics matrix A, \u03bb\u22450.1903 m and is the carrier wavelength. The additive disturbance \u03c9\u2208Ris taken to be a random process with a zero-mean Gaussian distribution and state covariance W. The state error covariance matrix P is provided by a continuous time Riccati equation.\n\n\n","In the continuous time Riccati equation, {dot over (P)} is the time derivative of the Riccati state error covariance matrix P, A is the state dynamics matrix, Vin an inverse observation covariance, h is the linearized observation matrix, his a transposed linearized observation matrix, W is the state covariance, and P is the Riccati matrix. The measurement noise structure, as in the covariance expectation equation, leads to a product h(x)Vh(x) that does not depend on carrier phase error \u03c6nor the carrier frequency error {dot over (\u03c6)}. The inverse observation covariance Vis given by an inverse covariance expectation equation. \n\n","In the covariance expectation equation, \u03b3=(1\u2212\u03b4) and \u03b4=\u00bd is the normalized early to late code offset \u03b4.","The product hVh is then defined by a scalar covariance equation. \n\n","In the scalar covariance equation, the scalar covariance terms q, q, q, and qare defined by scalar covariance equations.\n\n(+2\u03b3)\n\n(+2\u03b3)\n\n+2\u03b3\n\n+\u03b3()+]\n","In the scalar equations c=c(r+\u03b4), c\u2032=c\u2032(r+\u03b4), c=c(r\u2212\u03b4), c\u2032=c(r+\u03b4). The term hVh does not depend on message data d=\u00b11 because the message data d is a multiplication factor of each term in h(x) and d=1. The product hVh depends only on range error rand signal amplitude a. Because hVh does not depend on the harmonics sin \u03c6or cos \u03c6, the continuous time Riccati equation has steady-state solutions with respect to constant values for rand a. Point design and gain trajectories can be determined with respect to the range error rand the amplitude a. A constant error dynamics solution is determined by setting the range error and the signal amplitude to nominal values r=0 and a=1.","Because the product hVh depends only on the range error, that is, the code phase rand the signal amplitude a, a steady-state solution of the continuous time Riccati equation can be expressed as an algebraic Riccati equation.\n\n0\n","Nominal closed-loop filter dynamics are found by setting the state covariance matrix W in the observation covariance matrix V to place the closed-loop filter poles at \u03c3(A\u2212Kh)={\u2212335, \u2212152, \u2212106, \u22128.7\u00b14.9i). \n\n\u2003V=10I","In the state covariance matrix W, the cross terms are found to improve the damping in the carrier frequency error rate {umlaut over (\u03c6)}response. The process outputs are the state estimate x and state error covariance estimate P with the state estimate x including the \u03c6, {dot over (\u03c6)}, {umlaut over (\u03c6)}, r, and a components.","The use of the algebraic Riccati equation enables state error covariance estimation in real time in the Kalman prefilter . The Kalman prefilter  provides code phase error and carrier phase error signals for adjusting the code phase and carrier phase for improved code phase tracking and carrier phase tracking. Those skilled in the art can make enhancements, improvements, and modifications to the invention, and these enhancements, improvements, and modifications may nonetheless fall within the spirit and scope of the following claims."],"GOVINT":[{},{}],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 3"}]},"DETDESC":[{},{}]}
