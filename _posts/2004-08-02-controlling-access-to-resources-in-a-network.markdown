---
title: Controlling access to resources in a network
abstract: A computerized device transmits an access request to a data communications device of a network in an attempt to access network resources within the network. The data communications device, in response and in real-time, transmits a challenge request to the computerized device that directs the computerized device to retrieve configuration, or posture, credentials associated with the computerized device. A policy server receives the challenge response and, based upon a real-time analysis of the posture credentials of the computerized device, determines a security state of the computerized device and either provides some level or denies the computerized device access to the network resources based upon the analysis of posture. The data communications device detects the real-time security state of the computerized device prior to providing the computerized device with controlled access to the network resources, thereby limiting vulnerable computerized devices from accessing the network resources and minimizing the risk that the network resources receive or transmit malware.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09436820&OS=09436820&RS=09436820
owner: CISCO TECHNOLOGY, INC.
number: 09436820
owner_city: San Jose
owner_country: US
publication_date: 20040802
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["Conventional computerized devices, such as personal computers or laptop computers, connect to computer networks such as the Internet to transmit and receive content or data with other computerized devices in communication with the network. While connected to the network, the conventional computerized devices can be subject to receive malware, such as computer viruses, worms, spy-ware, spam, or other types of unauthorized applications or content (hereafter referred to as \u201cmalware\u201d). unauthorized connections. For example, computerized devices typically include anti-virus applications that prevent execution of malicious programs that can harm the computer system. During operation, an anti-virus application associated with the computerized device can detect, note the presence, and\/or remove viruses, thereby helping minimize the effect or proliferation of the virus. In another example, computerized devices such as routers or switches typically include firewall applications that limit certain data communications traffic from entry into a portion of a network. During operation, the firewall applications detect and prevent attempted connections to the associated computerized devices for which the traffic is destined.","A computer resource can become infected via any number of different interface \u201cvectors.\u201d One of the most common is infection from a public network connection. For example, laptop computers are often configured to move between locations and connect to different networks. In addition to connecting their laptop computer to the corporate Local Area Network (LAN), users frequently, connect that same laptop computer to other networks that provide a direct connection to the Internet. It is while connected to these other networks that the laptop computer may become infected with malware (e.g., such as viruses or worms). When the laptop reattaches to the corporate LAN, the malware can then infiltrate the corporate network and impair the operation of that network and its associated resources.","To minimize the risk of a network and its resources becoming infected by malware, network-based vulnerability scanners can be used to assess the security \u201cposture\u201d of devices connected to that network. These scans are typically performed on the basis of a predefined scanning schedule. For example, in the case where the operator disconnects the laptop from the second network and reconnects the laptop to the conventional LAN, a vulnerability scanner application scans the reconnected computer (e.g., the applications on the laptop) based upon a predefined scanning schedule to assess the vulnerability \u201cposture\u201d of that laptop. If it is determined that the computer is vulnerable to one or more virus or worm exploits, other applications such as Antivirus Signature or Patch Management update programs may be invoked to mitigate those vulnerabilities and\/or remove exploits that have managed to gain a foothold.","For example, assume a user connects a laptop computer to a Local Area Network (LAN) operated by a business and, at a later time, disconnects the laptop computer from the LAN and connects the laptop to a second network, such as the Internet. Further assume that while connected to the second network, prior to reconnecting with the corporate LAN, the laptop becomes infected with an unauthorized application, such as a virus or worm. Also assume that a scanning application periodically scans computerized devices connected to LAN (e.g., once a day) for the presence of known vulnerabilities in the device operating system, resident applications, associated security programs, and their respective configurations. In the case where a computer connects to the LAN between scheduled scans, that computer can transmit malware onto the network, its resources, and any other device connected to that network. In addition to infecting and impairing the operation of these other devices this malware could impair the operation of the network itself","Another problem with conventional network-based security scanning systems is that the systems cannot always reliably collect the necessary information or detect that there is a problem, either because the systems are unable to access the appropriate information, did not have proper administrative authority, or the time required exceeds predefined resource schedules. These systems also are typically signature-based and only scan for vulnerabilities and exploits that are known a priori. This is why most vulnerability scanners and antivirus applications require periodic signature updates, which creates its own form of race condition relative to the latest class of exploits. This race condition is frequently referred to as a \u201cDay Zero\u201d problem; in that signature based systems frequently are unable to detect the latest exploits on \u201cday zero.\u201d It is only after they are updated with the latest signatures that this new class of exploit or vulnerability can be detected.","For example, conventional remote antivirus and vulnerability scanning systems are limited to determining if a computer system operating on a network is configured with up to date virus definitions. Such systems do not provide a mechanism to inquire as to other configuration settings of the computer system operating on the network. By way of a specific example, it may be determined that a certain type and\/or version of certain software application contains a known security threat to a network. Virus scanning software may be unable to deal with determining if the application is installed on the computer system. To generalize, conventional security mechanisms do not provide the ability to query the computer system for specific configuration information related to applications, the operating system, virus software, or other security information that may be used to determine the overall \u201csafeness\u201d or security threat that a particular computer poses when operating on a network.","Conventional techniques for admitting computerized devices onto a network suffer from a variety of deficiencies that involve network security issues. For example, while conventional networks (e.g. wired and wireless LANs, remote VPN access, dial-up access) may authenticate a user or machine prior to admitting a device to the network, these same networks may admit devices without checking whether those devices are capable of introducing malware onto the network. As indicated above, conventional networks may be configured to scan for the presence of vulnerabilities or exploits on devices connected to the network according to a scanning schedule. The drawback with this approach is that many devices may be connected to the network for a significant period of time before they are scanned. It is during periods between these scans that a virus or worm may gain a foothold on these devices. This race condition is compounded by the fact that: a) the latest generation of viruses and worms can propagate across a network much more quickly then their predecessors, and b) more and more devices can roam across networks via technologies such as 802.11-based wireless networking. Accordingly, packet based networks are much more vulnerable to the spread of malware and conventional network admission and scanning techniques do not provide sufficient security to satisfy minimal security, reliability, or availability requirements.","By contrast, embodiments of the present invention significantly overcome such deficiencies and provide mechanisms that include a robust network security architecture and system for controlling access to a network depending on the configuration state or \u201csecurity posture\u201d of a device when it attempts to connect to that network. According to some embodiments of the invention, computer systems such as personal computers can be configured with security agent software referred to herein as a security, or \u201cposture\u201d agent that can be remotely activated, and one or more software plug-ins, hereafter referred to \u201cposture plug-ins\u201d, that the posture agent uses to collect information associated with the security posture of the computer device. The posture agent may be remotely activated in the form of a sequence of challenge requests transmitted by a router or other data communications device in response to a connection request from the computer device to access restricted resources in the network. A computer device, in one arrangement, is a device with a single network interface (\u201csingle-homed\u201d) that terminates a network connection, such as a laptop computer or a network enabled Personal Data Assistant (PDA), or a device with multiple network interfaces (\u201cmulti-homed\u201d) such as another router, switch, bridge, or a laptop or data server computer configured to allow the forwarding, routing, and\/or bridging of packets. The challenge request sequence happens in real time and causes the posture agent within the computerized device to collect information associated with the security posture of the computer device, hereafter referred to as \u201cposture credentials\u201d, from one or more posture plug-ins, and to transmit these posture credentials securely to a policy server operating within the network to determine what type of admission policy and level of network access should be assigned to that device. Posture credentials collected in real time from the posture plug-ins by the posture agent can identify critical security information such as what particular virus software and virus definition versions are installed within the computer system, when was the last time a local antivirus scan was executed, what operating system patches are installed within the computer system, what particular types and versions of software applications are configured and active within the computer system, and so forth. By providing a security posture based challenge-response mechanism for network admission control, embodiments of this invention are able to dramatically reduce the opportunities for injection of malware into a network.","During an example operation of one embodiment, the computerized device, such as a personal computer attempting to communicate with restricted resources in the network, transmits an access request to the data communications device (e.g., a router configured with embodiments of the invention) in an attempt to access the network resources within the network. The access request may be as simple as transmitting network packets (data, voice, and\/or video) to other devices or resources on the network, or involve an explicit signaling request to cause the network admission control challenge-response sequence to take place. The data communications device that detects the presence of the new device initiates a challenge-response sequence to the device that directs a posture agent running on the computerized device to retrieve posture credentials describing the security posture of the computerized device. On detecting a new device the data communication device sends a challenge request to the computer device. The posture agent running on that computer device then transmits an initial challenge response back to the data communications device which forwards the challenge response onto the policy server. The policy server in the network continues the challenge-request sequence, which includes setting up a secure channel to the posture agent via the data communications device so that the posture credentials can be communicated securely. Once the secure channel has been established, the policy server submits a request to the posture agent via the data communications device for all or a selected set of posture credentials. The posture agent requests the specified posture credentials from the associated posture plug-ins installed on the device and transmits the requested posture credentials back to the policy server via the data communications device. Based upon an analysis of the posture credentials returned by the computerized device, the policy server determines what type of admission policy and level of network access and privileges should be extended to the computer device. Devices that are compliant with network admission policy would typically be given full network access. Devices that are only mildly out of compliance may be simply issued a warning that they are in danger of falling out of compliance with corporate policy. Devices that are more significantly out of compliance may be placed on an isolated, or \u201cquarantine\u201d network segment where they can be brought into compliance. Devices that violate core admission requirement may be denied network access entirely. In all cases, the response to device posture is a policy decision deduced by the policy server in response to posture credentials retrieved from a device when it attempts to enter a network.","The data communications system, therefore, detects the presence of a new host attempting to access restricted resources in the network, and initiates an exchange that allows a policy server to gather real-time security state, or \u201cposture\u201d, of the computerized device prior to providing the computerized device with access to the network resources, thereby limiting at-risk or vulnerable computerized devices from accessing the network resources and minimizing the risk that the network resources receive malware. It is also possible that this invention is used only for monitoring and auditing compliance of computer devices to a security policy, rather than enforcing compliance to security policy as the above-mentioned examples suggest. In other words, it is possible to allow computer devices to access resources in the network regardless of the posture of the device, while still performing the challenge-response sequence for the purpose only of monitoring and auditing compliance to a security policy.","In one arrangement, the data communications device assigns devices that are out of compliance with admission requirements to a quarantine, or remediation network. This remediation admission policy is issued by the policy server based on comparison of the posture credentials of the device relative to predefined network admission requirements, or security policy. At the same time the policy server determines access, the policy server can transmit one or more notification messages to the posture agent and\/or posture plug-ins running on the computer device attempting the gain access to the network. The notifications may include the results of the posture check, remediation actions (if any) and an informational message to be displayed to the user, or written to a local log file. Displaying an informational message would be appropriate on a computer that includes a user console, whereas simply logging the message would be more appropriate for a device such as a printer that may not possess a human readable display. In addition, when directed by the policy server, the posture agent may forward the notification to one or more posture plug-ins for processing.","In response to a notification, an additional posture agent or posture plug-in response might be to automatically connect the computer device, or prompt a user to manually connect the computer device, to a remediation server that resides on the quarantine network, where the remediation server is configured to upgrade or provide up-to-date patches to the operating system or applications, such as anti-virus applications, associated with the computerized device. The device should be admitted into the original network if the remediation process was successful. Otherwise the device will be again identified as being at some level of non-compliance and the appropriate response will be invoked by the policy server.","The remediation server acts to minimize the susceptibility of the computerized device to an unauthorized application, such as a virus, thereby minimizing the potential for the computerized device to carry an unauthorized application onto the network at a later time. In this manner, embodiments of the invention can perform the real-time analysis of posture credentials that describe the configuration of the computer system attempting to gain access a network. This analysis can result in a posture agent and\/or posture plug-ins receiving a quarantine message causing the computer system to be reconfigured to more fully comply with required security policy prior to being able to communicate within the network.","Once the computer device has completed the remediation process, the computer device, can attempt to re-enter the original network. This may be achieved by the computer device transmitting a message to the data communications device to request that the posture of the device be re-validated, and\/or the data communications device may periodically query the computer device for a posture update, hereinafter called \u201cposture update query\u201d. When the posture agent responds to a posture update query in a way that indicates that the posture has been updated, the data communications initiates a fresh challenge-response sequence to enable the policy server to re-assess the posture credentials and apply new admission to the data communications device. The posture update query mechanism is used to detect any change in posture of the computer device. Changes may be to due to the remediation process, other software update processes, user action, or infection by some type of malware. In particular, in one embodiment, between each periodic full challenge-response sequence to check posture credential as described above, the data communications device may periodically transmit the posture update query message to the posture agent.","The status query mechanism is an optimized, secure version of the full challenge-response mechanism that operates only between the posture agent and the data communications device and does not involve the policy server. The status query mechanism is a simple authenticated challenge-response mechanism used to determine whether the posture on the computer device has changed, and also to make sure that the computer device that responds to the request is the same one that was previously authorized to access the network. If the status query fails, e.g. because the posture agent responds with an error, the posture agent does not respond at all or the posture agent indicates that the posture agent has changed, the data communications device attempts the full challenge-response sequence to enable the policy server to re-assess the posture credentials and apply a new access policy on the data communications device.","In another arrangement, even after a computer system has been authorized to communicate in the network using the aforementioned examples and even if the computerized device does not indicate that the posture has changed, the network can nevertheless periodically re-run the full posture check of authorized computer systems to ensure that their posture is still compliant with the network admission policy. This is useful in addition to the posture update query mechanism above because the rules in the policy server may change. In particular, in one embodiment, the data communications device periodically re-initiates the full challenge-response sequence after expiration of a time period to enable the policy server to request the posture agent to re-transmit the posture credentials for evaluation against the latest admission policy rules configured in the policy server.","In another arrangement, the invention also allows posture credentials to be checked at the same time as a user of a computerized device or the computerized device itself is authenticated. The invention allows the policy server to request user identity information, machine identity information as well as posture credentials in the same secure tunnel, and apply network access policies based on some combination of who the user is (e.g. joe smith.companyX.com) whether the computerized device is a corporate asset (e.g. machine1. engineering. companyX.com) as well as the value of posture credentials as described above. By allowing user identity, machine identity and posture credentials to be checked together at one time, more powerful admission policies can be enforced on the policy server. For example, different types of posture information may be checked for different users, e.g. computer systems belonging to employees of an organization may be expected to have the posture agent with specific posture plug-ins installed on the computer devices, whereas consultants or business partners of an organization may not. Different categories of user may be provided different types of access based on who they are and the type of posture information that can be gleaned from the device being used to access the network. The invention thus allows the network to be protected not only from computer devices that may be vulnerable to infection based on their security posture, but also makes sure that networks are used only by legitimate, known users and known machines.","According to other embodiments of the invention, computer systems such as personal computers may not be configured with a posture agent that can be remotely activated. This may be because the posture agent software is not yet available or may never be implemented devices with less common operating systems (e.g. printers) or it is not feasible to deploy in certain customer environments where the computerized devices used are not owned or managed by a single organization, (e.g. universities). In this case, embodiments of the invention allow for exception lists to be created in the data communications device to exempt specified computerized devices from the posture admission control check and to have pre-configured access policies applied.","In another arrangement, the data communications device, on detecting a new computer device attempting to access restricted resources in the network, and on detecting that it does not have a posture agent installed, may nevertheless ask a policy server for a network admission policy for the computer device. The policy server may consult a local exception list based on the identity of the computer device, or it may trigger real-time network-based vulnerability scanning of the computer device, fingerprinting of the computer device, Web page script download to computer device and possibly other mechanisms to determine as much information about the computer device in the absence of a posture agent being installed on the device.","Based on posture information gleaning from these other mechanisms, the policy server may determine the appropriate admission rules to be downloaded to the data communications device including allowing access to restricted resources, quarantining the computer device or denying access completely. In this manner, the invention allows network admission control to be applied even in the absence of a posture agent on all computerized devices attempting to use the network.","It is to be understood that the system of the invention may be embodied strictly as a software program, as software and hardware, or as hardware alone. The features of the invention, as explained herein, may be employed in data communications devices and other computerized devices and software systems for such devices such as those manufactured by Cisco Systems, Inc. of San Jose, Calif.","Embodiments of the present invention provide a comprehensive network security architecture that includes mechanisms for controlling access to resources in a network based on some combination of the security posture of the computer system as well as the identity of the computer system and the user of the computer system. In one configuration, an operating environment includes a computerized device and a network having network resources, a data communications device, and a policy server. The operating environment may also include audit servers that are able to do on-line scanning or fingerprinting of computerized devices in the absence of a posture agent being installed.","During operation, the computerized device such as a personal computer transmits packets or a signaling request to the data communications device in an attempt to access the network resources within the network. The data communications device, in response, initiates a sequence of challenge requests to the computerized device that ultimately directs the computerized device to retrieve configuration credentials associated with the computerized device in a secure manner. Generally, the configuration credentials indicate a security \u201cposture\u201d of the computerized device. After the data communications has sent the initial challenge request to the posture agent and the posture agent responds, the data communications device forwards the response to the policy server. The policy server continues with the challenge-response sequence to the computer device via the data communications device. The policy server receives the challenge responses and, based upon an analysis of the posture credentials of the computerized device, determines a security state of the computerized device and either provides some level of or denies the computerized device access to the network resources based upon the analysis. The data communications system, therefore, detects the real-time security state of the computerized device prior to providing the computerized device with access to the network resources, thereby limiting at-risk or vulnerable computerized devices from accessing the network resources and minimizing the risk that the network resources receive malware. In effect, this invention helps \u201cdampen\u201d the propagation of worms and viruses, and related side effects, by preventing systems capable of participating in such an outbreak from gaining access to the network.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 1","b":["20","20","22","24","25","26","28"]},"The user device or computerized device  is configured to attempt to access the network resources  within the network . Example user devices  include, but are not limited to, personal computers (e.g., laptop computers), data servers, IP-enabled and cellular telephones, personal digital assistants (PDA's), etc. Other user devices include multi-homed network devices such as routers, switches, and wireless access points, for example. The user device  includes sets of configuration credentials , also referred to hereinafter as \u201cposture plug-ins\u201d. Each posture plug-in  indicates a security posture with respect to a particular manufacturer's application (e.g., security status, setting, value, active applications, or other configuration data) of the user device  with respect to one or more security vulnerabilities of the device. The security posture of the user device  relates, for example, to the user device's  ability to resist reception or transmission of malware (e.g., viruses), content (spam and\/or data theft), or access by unauthorized users. For example, in one arrangement, the user device  includes a posture plug-in  that indicates the status of an anti-virus applications installed on the user device  (e.g., the association of an anti-virus application with the user device  or a version of the anti-virus application or its virus definition files associated with the user device ). In another arrangement, the user device  includes a posture plug-in  that indicates the status of intrusion prevention (e.g., firewall) applications associated with the user device . In another arrangement, the user device  includes a posture plug-in  that indicates the version of operating systems used by the user device  or the presence of updated \u201cpatches\u201d associated with the operating systems. It is to be understood that the posture plug-in  represents any type of configuration information that a computerized device  can maintain and that the posture agent  is able to access, as will be explained herein.","The posture plug-ins , in one arrangement, is configured in an extensible messaging format, such as Type-Length-Value (TLV) format or an extensible markup language (XML) format. The TLV or XML format is a well-defined, application-independent form for representing information or data. As indicated above, the user device  may have one or more posture plug-ins  as provided by the manufacturer of an application, or third parties. With the posture plug-ins  provided in the extensible messaging format, as devices external to the user device  (e.g., the policy server) access the posture credentials, such devices can, in turn, recognize the information contained within the configuration regardless of the source (e.g., manufacturer) of the posture credentials . Separate independent applications may operate within the computerized device  to maintain the different posture plug-ins . As an example, some posture plug-ins  can be maintained by virus software while other posture plug-ins  are maintained by the operating system of the computerized device . There is a well-defined application-programming interface (API) hereinafter named \u201cposture plug-in API\u201d that each posture plug-in manufacturer must implement to allow the posture agent to access posture information.","The user device  also includes a posture agent  configured to receive a sequence of challenge requests , and in response, collects posture credentials from the installed posture plug-ins  and transmits posture credentials , associated with the user device , to the policy server . The posture agent , embodied as a software or hardware application, works in conjunction with the data communications device and policy server  to verify a security status of the user device  prior to the user device  accessing the network  (e.g., the network resources  within the network ). Such verification minimizes the ability for the user device  to transmit an unauthorized application or content (e.g., such as a virus or a worm) into the network , thereby potentially \u201cinfecting\u201d the network resources  within the network . The posture agent  may also receive notifications from the policy server  based on the results of the posture check that may include informational messages or remediation actions to be performed. These notifications may be processed by the posture agent  itself or these notifications may be passed to the responsible posture plug-in  for processing using the posture plug-in API. The posture agent  is also responsible for determining whether the posture of the computer device  has changed by learning of any changes from the posture plug-ins  through the posture plug-in API. The posture agent  is responsible for answering the periodic posture update query from the data communications device between the full posture challenge-response sequences.","The network  is a computer network, such as an enterprise network or the Internet, which includes the network resources , the data communications device , and the policy server . The network  may include network access from user devices  through different types of network transport including a wired local area network (LAN), a wireless LAN, a VPN connection, or a dial-up connection, for example.","The network resources -, -, -N, in one arrangement, are configured as servers that contain content accessible by the user device  via the network . In another arrangement, the network resources -, -, -N are configured as peripheral devices, such as printers, or network attached storage, for example, that may be accessible (i.e., if allowed according to the system of the invention) by the user device  via the network .","The data communications device or network access device , which may be a router, switch, gateway or other such device deployed one or more Layer 2 or Layer 3 network hops from the user device  is configured to detect attempted connections to the network  by the user device . As an example, the data communications device  can maintain a table of those computerized devices  that have already been authorized for access to various resources within the network . When an access attempt (e.g., a new TCP SYN connection from a new source IP address or a special access request e.g. 802.1x EAP Start message) is made from a new computerized device  into the network , the data communications device  can detect such access and trigger operation of the system of the invention. The data communications device  generally works in conjunction with the policy sever  to limit the ability for the user device  to transmit an unauthorized application into the network . The data communications device  is also responsible for helping detect when the posture of authorized computer devices  has changed so that the full challenge-response posture sequence can be triggered again. The data communications  is also further responsible for periodically triggering the full posture challenge-response sequence even if a posture change has not been detected.","The policy server  is a computerized device configured to determine the particular posture credentials to request from the posture agent, and validate the posture credentials  associated with the user device . Based upon the review of the posture credentials , the policy server  either allows some level of network access or denies the user device  access to the resources (e.g., the network resources ) within the network . The policy server  is responsible for downloading the appropriate access instructions to the data communications device . The policy server  also determines what notifications e.g. remediation actions, informational messages to be displayed to user, to send back to the computerized device once the posture has been reviewed and the level of access determined. In addition to checking posture credentials, the policy server  may also be responsible for authenticating the computerized device  and\/or authenticating the user of the computerized device , and determining an access policy based on both posture information and identity information.","During operation of the system , the user device  transmits packets or a signaling request  to the network  in an attempt to access the network resources  within the network . The data communications device  intercepts the packets or access request  and, in response, transmits an initial challenge request  to the computerized device . The posture agent  of the computerized device  transmits, to the data communications device , a response  to the challenge . The data communications device  forwards the response  to the policy server . The policy server  then transmits one or more challenge requests  to the posture agent  on computerized device  via the data communications device  to set up secure communications between the posture agent  and the policy server . Once secure communications have been established, the policy server  makes one or more further challenge requests (e.g., posture requests)  for posture credentials from specified posture plug-ins  on the user device  via the data communications device . The policy server  may also make one or more requests  to authenticate the computerized device  or the user of the computerized device  via the data communications device. The data communications device , policy server , and posture agent  may securely transmit posture and\/or identity using protocols such as the Extensible Authentication Protocol (EAP), Protected Extensible Authentication Protocol (PEAP) and Flexible EAP Authentication using Secure Tunnel Protocol (EAP-FAST) over various network transports, including a Layer 2 transport such as wired LAN (Ethernet) and wireless LANs, and a Layer 3-based transport such as User Datagram Protocol (UDP).","When a policy server  makes the posture request  to the computerized device , the policy server  directs the posture agent  (i.e., operating as a daemon) of the user device  to retrieve the specified posture credentials from associated posture plug-ins  installed on the user device . The posture credentials  indicate a security posture of the resident operating system and associated applications of the user device  (e.g., the presence of anti-virus or firewall software associated with the user device  or an indication of the versions or patch updates of these applications of the user device ). The posture agent , for example, can utilize the posture plug-in API described above to request the specified posture credentials from the associated posture plug-ins  installed on the computerized device . The posture agent  packages the posture credentials  from the requested posture plug-ins within a posture response message , for example. The user device  transmits the posture response  to the network  where the posture response  includes the posture credentials  of the user device . The data communications device  receives the posture response  and transmits or forwards the challenge response containing the posture credentials  to the policy server  for processing.","After receiving the posture credentials using the above message flow (e.g., initial challenge request , challenge response , challenge request , posture request , and posture response ), the policy server  compares the posture credential information from posture plug-ins , with an accepted credential set . For example, assume the posture credential information  indicates that the user device  is configured with an anti-virus application from a particular manufacturer and has a particular virus definitions update. The policy server  reviews the accepted credential set  to detect the presence (e.g., a listing) of the identity of the anti-virus application and definition version from the particular manufacturer within the accepted credential set . Assume, for example, that based upon the comparison the policy server  detects the presence of, or a listing of, the same anti-virus application and definition version from the particular manufacturer within the accepted credential set . In such an example, in one arrangement, the policy server  transmits an access instruction  to the data communications device  that directs the data communications device  to allow communications between the user device  and the resources  within the network . Assume in another example, however, that based upon the comparison the policy server  fails to detect the presence of, or a listing of, the anti-virus definition version from the particular manufacturer within the accepted credential set . In such an example, in one arrangement, the policy server  transmits an access instruction  to the data communications device  that directs the data communications device  to restrict or completely reject communications from the user device  to the resources  within the network . This may include providing limited network access, such as only providing a path out of a corporate network to the Internet, but fully restricting access to any internal sub-networks.","In the above-described arrangement, the system  detects the real-time security posture of a user device  prior to providing the user device  with access to the network resources . By detecting the real-time security state of the user device , the system  limits \u201cvulnerable\u201d user devices  (e.g., user devices  that are not configured with anti-virus or up-to-date anti-virus applications) from accessing the network . As such, the system minimizes the risk that the network  or network resources  become \u201cinfected\u201d with malware. For example, the policy server  detects the presence or absence of particular anti-virus applications associated with the user device  and either allows or denies the user device  access to the network resources based upon the results of the detection. The policy server , therefore, minimizes the potential that the user device  carries a virus to infect the network resources  of the network . In addition, since the posture agent  uses a well-defined and extensible posture plug-in API to identify, collect and gather configuration credential information from posture plug-ins  developed for various manufacturer-specific applications, as new security features are implemented within computer systems such as personal computers, the policy server  can request the posture agent  to request additional types of posture credentials from an existing posture plug-in  or from an additional posture plug-in produced by a new security application or third-party. This allows the system of the invention to limit the processing burden of the posture agent by using a posture plug-in to query each vendor specific application and ensure that a new version of the posture agent  does not need to be installed on a computer device  whenever new posture credentials or posture plug-ins  are available and need to be checked.","In effect, the posture agent  serves as an extensible policy \u201cbroker\u201d that fields posture requests from a policy server  and returns posture credentials to the policy server  based on responses from one or more posture plug-ins . The posture agent  also acts as a broker for delivering notifications back to the posture plug-ins  from the posture server  in response to the comparison of the posture credentials to accepted credential set .","While  and the above description outlines operation of the system  as a whole, the following Figures, and associated descriptions, provide details regarding the operation of each of the computerized device , the data communications device , and the policy server  within the system .",{"@attributes":{"id":"h-0005","num":"0000"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 2","b":["100","26","20","22","25","24"]},"In step , the data communications device  detects an attempted access from a computerized device , through the data communications device , to a network resource  in the network . For example, the data communications device  receives packets or an access request  from the user device , such as a TCP SYN packet transmitted from the user device  during a connection initiation handshaking procedure initiated by the user device , or a special signaling request from user device  to the data communications device  to initiate the authentication and\/or posture validation process.","In step , in response to detecting the attempted access or in response to the signaling request, the data communications device  provides a request to the computerized device  to retrieve posture credentials  from the computerized device . In one arrangement, the data communications device  transmits and receives a series of messages to retrieve the posture credentials from the computerized device . Steps , , and  outline an arrangement of such a process.","In step , the data communications device  provides an initial challenge request  to the computerized device . For example, when the computerized device  receives the challenge request  from the data communications device , the computerized device (e.g., the posture agent  of the computerized device ) transmits a response  to the challenge  to the data communications device .","In step , the data communications device receives the challenge response  from the computerized device  and forwards the challenge response  to a policy server . The policy server , in one arrangement, then transmits a sequence of challenge requests to the posture agent  on computerized device  via the data communications device  to set up a secure communications between the posture agent  and the policy server .","Once secure communications have been established, in step , the data communications device  receives from the policy server  a posture request  requesting posture credentials  from the user device  and transmits the posture request  to the computerized device . Such a request  allows the policy server  to authenticate the device or user of the device . When a policy server  makes a posture request  to the computer device , the policy server  directs the posture agent  of the user device  to retrieve the specified posture credentials from associated posture plug-ins  installed on the user device  and transmit the requested posture credentials back to the data communications device .","In step , the data communications device  receives and forwards posture credentials  to a policy server  for analysis of the posture credentials  relative to an accepted credential set . As indicated above, the configuration credentials  indicate a security posture or security status of the user device .","In step , the data communications device  receives an access instruction  from the policy server  based upon analysis of the posture credentials  of the computerized device  relative to the accepted credential set . The access instruction  directs the data communications device  to either allow some level of network access or deny the computerized device  access to the network resources  of the network .","In step , the data communications device  applies the access instruction  to communications traffic originating from the computerized device  and destined for resources  within the network . By applying the access instructions  to communications from the user device , the data communications device  allows or denies computerized device  access to the network  based upon the probability or risk of the user device  carrying malware, content, or viruses (e.g., the \u201cvulnerability\u201d of the user device ). Such application of the access instructions  minimizes the ability for a computerized device  to introduce an unauthorized application or content into the network , thereby infecting or causing malfunction of the network resources .","For example, assume that during the analysis of the posture credentials  of the computerized device , the policy server  detects the presence of an anti-virus application (e.g., or an up-to-date anti-virus application) associated with the user device . The access instructions  generated by the policy server  and then transmitted to the data communications device  direct the data communications device , in turn, to allow communications traffic between the user device  and the network resources . In such an example, because the user device  includes an associated anti-virus application, the user device  has a relatively low risk for receiving, and therefore transmitting, a virus to the network resources  of the network . As such, the data communications device  allows the user device  to access the network resources , based upon the access instruction  because the user device has a low probability or risk of passing a virus into the network .","In another example, assume that during the analysis of the posture credentials  of the computerized device , the policy server  fails to detect the presence of an anti-virus application (e.g., or an up-to-date anti-virus application or virus definition file) associated with the user device . The access instructions  generated by the policy server  and then transmitted to the data communications device  directs the data communications device , in turn, to restrict (e.g., prevent) communications traffic between the user device  and the network resources . In such an example, because the user device  fails to include an associated anti-virus application, the user device  has a relatively high risk for transmitting a virus to the network resources  of the network . As such, the data communications device , in one arrangement, denies the user device  access to the network resources , based upon the access instruction  because the user device has a relatively high probability or risk of passing a virus into the network .","For example, assume that the policy server  compares the posture credentials  of a user device  with an accepted credential set . Further assume that based upon the comparison, the policy server  finds a discrepancy between the posture credentials  of the user device  and the accepted credential set . The policy server , as a result, transmits an access instruction  to the data communications device  that directs the data communications device  to prevent the user device  from accessing the network resources . In this example, when the data communications device  applies the access instruction  to communications from the user device , the data communications device  substantially completely restricts (e.g., denies) the user device  from communicating with or accessing the network resources  at all. Such application of the access instructions  minimizes the probability for the user device  (e.g., a \u201cvulnerable\u201d device or a device susceptible to a virus) to introduce an unauthorized application or content into the network , thereby infecting or causing malfunction of the network resources .","In another example, when the data communications device  applies the access instruction  to restrict a user device's  access to the network resources , the data communications device  limits the user device's  access to only a portion of the network resources  (i.e., for example, of the network resources -, -, and -N, the data communications device  allows the user device  to communicate only with resources -, and -). The access instruction  may permit traffic from user device  only to certain destination addresses, e.g. IP address of remediation server, and only to certain protocols or ports, e.g. HTTP traffic. Therefore, as the data communications device  applies the access instruction  to communications traffic originating from the computerized device , the data communications device  limits or restricts user device access to a subset of the network resources  based upon the results of the examination.","In one arrangement, application of the access instruction is based on both an address associated with the computerized device , such as a source address (i.e., the network address of the user device ), and a destination address (e.g., a network address of a resource  in the network  such as a remediation server). The data communications device  uses the source address and the destination address associated with the data traffic (e.g., access request , challenge response , and posture response ) from the user device , to restrict user device  access to particular resources  within the network  (e.g., the data communications device  provides a layer 3 restriction). This can result, for example, in providing a limited path to certain network resources -, while disallowing access to other resources - through -N.","In another arrangement, the application of the access instruction is a specific protocol associated with the data traffic from the user device . Data traffic includes a communications protocol identifier (e.g., HTTP, SMTP) that indicates the communications protocol used by the user device  in communicating with the network resources . During operation, the data communications device  examines the communications protocol identifier to restrict user device  access to particular resources  within the network  by limiting the kinds of applications that can be used (e.g., only Web access). Thus, the data communications device  allows the user device  to access the network resources  that are configured to communicate only according to the communications protocol identified by the user device  (e.g., the data communications device  provides a layer 2 or layer 3 or application layer restriction).","As described, the data communications device  restricts the computerized device's  access to resources  within the network  based upon instructions  provided by the policy server . The data communications device  also works in conjunction with the policy server  to upgrade or \u201cfix\u201d applications associated with the user device  when the policy server  detects that the user device  is vulnerable or susceptible to a virus or has other configuration problems.",{"@attributes":{"id":"h-0006","num":"0000"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0064","num":"0063"},"figref":["FIG. 3","FIG. 1","FIG. 2"],"b":["120","26","109","110"]},"In step , when (e.g., in addition to or instead of) receiving an access instruction , the data communications device  receives a redirect access instruction  generated by the policy server  in the analysis of the posture response  relative to the accepted credential set .","For example, assume that when comparing the posture credentials  of the user device  with the accepted credential set, the policy server  detects the presence of an anti-virus application associated with the user device  and further detects that the anti-virus application is out-of date (e.g., the user device does not have the most recent version of the anti-virus application). Based on such detection, the policy server  determines that a redirect access instruction  should be applied to HTTP traffic from the user device . When the data communications device  receives communications traffic from the computerized device , the data communications device  applies the redirect access instruction .","In step , when applying the redirect access instruction , the data communications device  transmits a redirection message  to the computerized device  to direct the computerized device  (e.g., HTTP traffic from the computerized device ) to a remediation server  to reconfigure the computerized device .","For example, during operation, when the data communications device  applies the redirect access instruction  the data communications device  transmits, to the user device , a remediation server address as part of the redirection message . Rather than establishing communications with the network resources , the user device  establishes a connection with the remediation server . The remediation server , in one arrangement, is configured to upgrade or provide up-to-date patches to applications, such as anti-virus applications, associated with the user device . The remediation server  acts, for example, to minimize the susceptibility of the user device  to an unauthorized application, such as a virus, thereby minimizing the potential for the user device  to carry an unauthorized application or content onto the network  at a later time.","During operation, after the data communications device  validates the posture of the user device  and applies the appropriate access instruction  and\/or redirect access instruction , the user device  establishes a connection with one or more network resources  during a communications session. The duration of such a connection can last for a relatively long period of time. During this time period, an operator or the remediation process can upgrade certain security applications associated with the device so that a non-compliant device now becomes compliant to security policy (e.g. updates the anti-virus signature file to the most current version). In addition, it is also possible that an operator can reconfigure certain applications associated with the user device (e.g., removes an anti-virus application) or replace the user device with a second user device (e.g., where the configuration credentials of second user device have not been tested by the policy server  with respect to the accepted credential set) so that the device is no longer compliant with security policy. In the former case, with respect to the system , the user device  is no longer a risk to the network and should be given access to network resources  in network . In the latter cases, with respect to the system , the user device  may be susceptible to receiving and introducing a virus into the network .","In order to detect a posture change on a user device  and to make sure that the user device is still the same device  as was previously authorized, the data communications device  periodically polls the user device  using the posture update query. In the case where the data communications device  detects a change in the state of the user device , the data communications device  attempts to re-authorize the posture of user device  as explained in  (i.e. triggers the re-start of the full system process as described in ). If this attempt is unsuccessful, the data communications device  may remove all access permissions for user device  to minimize the risk of virus or malicious content introduction by the user device  to the network .",{"@attributes":{"id":"h-0007","num":"0000"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 4","b":["130","26","22"]},"In step , after the full challenge-response sequence has completed and the computerized device  has been authorized, for example, the data communications device  transmits a posture update query to the computerized device  after expiration of a time period. For example, in one arrangement, the data communications device  includes a timer . During operation, when the data communications device  applies an access instruction  for the user device , provision of such access initiates operation of the timer  such that a timer counts from a start time to a preset end time. After expiration of a preset time period (e.g., the time period between the end time and the start time), the timer  causes the data communications device  to transmit an posture update query to the computerized device  to ensure that its configuration has not changed since the last full challenge response sequence and that the user device is the same device that was last checked. In one arrangement, the posture update query challenges the user access device to demonstrate knowledge of a shared secret that was derived and shared during the full challenge-response sequence described in system operation shown in . Demonstration of the secret information can be produced by the posture agent  only, for example, by responding appropriately to a random challenge from the data communications device by hashing the random number in the challenge with the shared secret.","In step , the data communications device  detects a change in posture associated with the computerized device  based upon a response to the posture update query. The data communications device  interprets either an actual response or a lack of a response from the computerized device  to determine the state of the computerized device .","For example, assume that a first user device  establishes a connection with a network resource  in the network , via the data communications device . Further assume that prior to the data communications device  transmitting a posture update query to the first user device  (e.g., prior to expiration of a preset time period as measured by the timer ) an operator replaces the first user device  with a second user device (e.g., where the configuration credentials  of second user device have not been tested or verified by the policy server  with respect to the accepted credential set ). In such an arrangement, after the data communications device  transmits the posture update query to the second user device, the second user device is unable to interpret and respond to the posture update query because the state information (e.g., a hash of the original acceptable credentials ) that is expected by the data communications device  will not be present on the substituted computerized device . The device  would most probably not respond. As such, a non-response to the posture update query as well as a subsequent attempted full posture check indicates to the data communications device  the connection of a potentially unverified user device  to the network . Based on the non-response, the data communications device  reduces network access privileges or terminates the connection between the user device  and the network resource  to reduce the risk of reception or transmission, by the network resources  of an unauthorized application from a \u201cvulnerable\u201d user device or a device susceptible to a virus. In this manner, periodic posture checking can be performed.","In another example, assume that a user device  establishes a connection with a network resource  in the network , via the data communications device . Further assume that, prior to the data communications device  transmitting a posture update query to the first user device  (e.g., prior to expiration of a preset time period as measured by the timer ), an operator disables or reconfigures an anti-virus application associated with the user device . In such an arrangement, when the data communications device  transmits the posture update query to the user device , the user device  indicates the change in configuration of the operating system and anti-virus application to the data communications device  in a query response. When the data communications device reviews the query response and detects the change in posture, the data communications device  triggers a full posture credential challenge-response sequence as explained in system operation described in . Based on the results of the new posture check, the policy server  may apply new access instructions  and\/or redirect access instructions  to the user device  that reduces network access privileges or terminates the connection between the user device and the network resource  to reduce the risk of reception, by the network resources  of an unauthorized application from a \u201cvulnerable\u201d user device or a device susceptible to a virus.","In another example, assume that a user device  establishes a connection with a network resource  in the network , via the data communications device . Further assume that the user device  is not deemed by the policy server  to be compliant with security policy and is given restricted access to network resources  sufficient only to remediate itself. Before the remediation is complete, the user device  will respond to posture update queries from the data communications device  in a way that indicates no posture change. However, once remediation has completed successfully, the posture agent  will indicate that the posture has changed on the next posture update query from the data communications device . In such an arrangement, when the data communications device  transmits the posture update query to the user device , the user device  indicates the change in configuration of the operating system and anti-virus application to the data communications device  in a query response. When the data communications device reviews the query response and detects the change in posture, the data communications device  triggers a full posture credential challenge-response sequence as explained in system operation described in . Based on the results of the posture check, the policy server  may apply new access instructions  to the user device  that increases network access privileges between the user device and the network resource  to enable normal network access.","Rather than relying only on the posture update query, the invention also allows the posture agent  to asynchronously request the data communications device  to re-initiate the challenge-response sequence for posture credentials from posture plug-ins , as described in , as soon as the posture agent is notified by any posture plug-in  that the posture has changed. The posture agent  determines from a posture plug-in  that the posture has changed using the posture plug-in API. The posture agent  determines that the posture has changed in one of two ways: the posture agent  periodically polls the installed posture plug-ins for a posture change, or the posture plug-in  asynchronously notifies the posture agent  as soon as it determines that the posture has changed. When the posture agent  learns of a posture change from one or more posture plug-ins , it sends a signaling request to the data communications device  to re-start the challenge-response sequence described in . When the data communications device  receives a request from the posture agent  to re-initiate the challenge-response sequence, it does so as explained in system operation described in . Based on the results of the posture check, the policy server  may apply new access instructions  to the user device  that increases or decreases network access privileges between the user device and the network resource .","Additionally, in one arrangement, the data communications device  periodically re-executes the sequence described with respect to  based on expiration of a preset time period. A timer associated with the data communication device , for example, initiates measurement of a time period after the data communication device  receives the access request  from the computerized device . In one arrangement, after a timer reaches the preset time period, the data communications device transmits to the computerized device  a challenge request , as part of the re-executed challenge response sequence of .",{"@attributes":{"id":"h-0008","num":"0000"},"figref":"FIG. 5"},"As indicated above, the data communications device  plays a role in controlling a user device's  access to resources  in the network . The user device  works in conjunction with both the data communications device  and the policy server  in accessing the network resources .",{"@attributes":{"id":"p-0080","num":"0079"},"figref":"FIG. 5","b":["140","22","25","24"]},"In step , the computerized device  transmits an access request  to a network . For example, the user device  transmits packets or an access request  into the network , such as a SYN packet or an 802.1x EAP Start message. The data communications device  intercepts the packets or access request  and, in response, transmits a request for posture credentials (e.g., an initial challenge request  as part of the challenge response sequence described in ) to the computerized device .","In step , the computerized device  receives, from a data communications device  associated with the network, in response to transmitting the access request , a request for posture credentials associated with the computerized device . Steps  and  describe an example of procedures executed by the computerized device  when receives a response to the access request .","For example, the data communications device  transmits a challenge request  to a computerized device . In step , in response to receiving the challenge request , the computerized device  (e.g., posture agent ) transmits a challenge response  to the data communications device . The data communications device  forwards the challenge response to the policy server . The policy server  then transmits one or more challenge requests to the posture agent  on computerized device  via the data communications device  to set up secure communications between the posture agent  and the policy server . Once secure communications have been established, the computerized device  receives one or more posture request , from the policy server  for posture credentials from specified posture plug-ins .","In step , the request (e.g., the sequence of challenge response requests) causes a posture agent  operating with the computerized device , to collect posture credentials  of applications and the operating system associated with the computerized device . As indicated above, the posture credentials collected from the posture plug-ins  of the user device  relate to a security posture (e.g., security status) of the user device . The security posture of the user device  indicates the user device's  ability to resist reception or transmission of malware (e.g., viruses), content (e.g., spam or data theft), or access by unauthorized users.","In step , the computerized device transmits posture credentials to the policy server . As indicated above, by providing posture credentials , such as via a posture response , to the data communications device  and, in turn, to the policy server , the user device  allows the system  to verify the security (e.g., security posture) of the user device  prior to connecting to the network . As such, the user device  operates in conjunction with the data communications device  and the policy server  to minimize the probability for the user device  to introduce an unauthorized application into the network , thereby infecting or causing malfunction of the network resources , or to receive malicious content from other sources.",{"@attributes":{"id":"p-0086","num":"0085"},"figref":"FIG. 5","b":["22","25","24"]},"In step , the computerized device  receives a redirection access instruction  from the data communications device  based upon the result of the posture validation, the redirection access instruction redirecting traffic from the computerized device  to a remediation server . For example, as indicated above, the data communications device  redirects HTTP requests from the user device  to the remediation server  after the data communications device  receives access instructions  from the policy server . Based on the redirection, rather than establishing communications with the network resources , the user device  establishes a connection with the remediation server . The remediation server , in one arrangement, is configured to upgrade or provide up-to-date patches to applications, such as anti-virus applications, associated with the user device . The remediation server  acts, for example, to minimize the susceptibility of the user device  to an unauthorized application, such as a virus, thereby minimizing the potential for the user device  to receive malicious content or introduce an unauthorized application onto the network  at a later time.","In another example, the computerized device  displays the redirection access instruction. In such an example, the redirection access instruction informs a user as to the results of the posture validation, resulting network access, and any actions that may need to be performed for remediation purposes, thereby providing the user with access to the redirection access instruction.  also illustrates additional steps performed by the computerized device  based on the results of verifying the posture of the device  by the policy server .","In step , the computerized device  receives a posture notification message from the policy server . For example, in addition to determining the access instruction  that is downloaded to the data communications device , the policy server  may also send one or more notification messages to the user device  via the data communications device . Similar to the format of the posture credentials, the notification messages are also configured in an extensible messaging format, such as a Type-Length-Value (TLV) or an extensible markup language (XML) format on the policy server. The TLV and XML formats are well-defined, application-independent form for representing information or data. With the posture notification message formatted in the extensible messaging format, third-party manufacturers of posture plug-ins  can recognize the information contained in the notification messages and act on these notifications accordingly.","There are several forms of notification. A posture notification may indicate the result of the posture validation check (i.e. that the posture is compliant with security policy or non-compliant). The notification message may contain a text message for display to a user or for logging to a log file (e.g., messages to display to the user or a log or URL's of the remediation server  and any remediation actions to be performed). For example, in the case that a user device  is non-compliant, the message may be displayed to the user or written to a log file indicating that the device has been quarantined and needs to be remediated. The notification message may also include a link to a remediation server or the IP address of the remediation server  that a user may click on or an application on the user device  may process to remediate the user device  automatically. Notifications may be processed by the posture agent  or the posture agent may forward the notifications to the posture plug-ins  via the posture plug-in API.","In step , the computerized device  responds to the notification message received from the policy server . For example, in one arrangement, the computerized device  displays the notification message, in the form of a text message, to the user. In another arrangement, the computerized device  activates a link, associated with the notification message, to direct the computerized device  to the remediation server .","As indicated above, the data communications device  and user device  plays a role in controlling a user device's  access to resources  in the network . As described below, the policy server  works in conjunction with the data communications device  and the user device  in allowing user device  access to the network resources .",{"@attributes":{"id":"p-0093","num":"0092"},"figref":"FIG. 6","b":["160","28","25","24"]},"In step , the policy server  receives posture credentials from a data communications device, the posture credentials provided by a computerized device in response to an attempted access by the computerized device, through the data communications device, to a network resource in the network. In one arrangement, the policy server  receives the posture credentials as part of a challenge response sequence outlined in steps  and .","In step , the policy server  receives a challenge response  from a data communications device , the challenge response  provided by a computerized device  in response to an initial request from the data communications device , which is in turn in response to an attempted access by the computerized device , through the data communications device , to a network resource  in the network . In one arrangement, the policy server  then transmits one or more challenge requests  to the posture agent  on computerized device  via the data communications device  to set up secure communications between the posture agent  and the policy server .","In step , the policy server  transmits, to the computerized device , a posture request  for posture credentials from specified posture plug-ins  on the computerized device . The policy server  may also make one or more requests  to authenticate the computerized device  or the user of the computerized device  via the data communications device.","In step , the policy server  analyzing the posture credentials from the computerized device  relative to an accepted credential set  to generate an access instruction . For example, assume the posture credential information from posture plug-ins  indicates that the user device  is configured with an anti-virus application from a particular manufacturer. The policy server  reviews the accepted credential set  to detect the presence (e.g., a listing) of the anti-virus application from the particular manufacturer within the accepted credential set .","In one arrangement, the policy server  authenticates an identity of the computerized device  to generate an authentication result, as indicated above. The policy server  then compares the posture credentials from the computerized device  with an accepted credential set to generate a posture validation. The policy server  then maps the results of posture validation with the authentication result to generate an access instruction .","In one arrangement, the accepted credential set  is configured in an extensible messaging format, such as a Type-Length-Value (TLV) or an extensible markup language (XML) format. The TLV and XML formats are well-defined, application-independent form for representing information or data. With the accepted credential set  formatted in the extensible messaging format, as third-party manufacturers include information (e.g., updated software patch information, updated virus information) for inclusion within the accepted credential set , the policy server  can, in turn, recognize the information contained within the information regardless of the source (e.g., manufacturer) of the information.","In step , the policy server  transmits the network admission or access instruction  to the data communications device . The network admission instruction  directs the data communications device to either allow some level of network access or deny the computerized device  access (e.g., restrict access of the computerized device ) to the resources  within the network . Assume, for example, that based upon the analysis the policy server  detects the presence of, or a listing of, the anti-virus application from the particular manufacturer within the accepted credential set . In such an example, the policy server  transmits an access instruction  to the data communications device  that directs the data communications device  to allow communications between the user device  and the resources  within the network . Assume, however, that based upon the analysis, the policy server  fails to detect the presence of, proper configuration, or timely execution of the anti-virus application from the particular manufacturer within the accepted credential set . In such an example, in one arrangement, the policy server  transmits a network admission instruction  to the data communications device  that directs the data communications device  to restrict or reject communications from the user device  to the resources  within the network .","In the above-described arrangement, the policy server  detects the real-time security posture or security state of a user device  (e.g., as indicated by the posture credentials ) prior to providing the user device  with access to the network resources . By detecting the real-time security state of the user device , the policy server  aids in minimizing \u201cvulnerable\u201d user devices  (e.g., user devices  that are not configured with anti-virus or up-to-date anti-virus applications) from accessing the network . As such, the policy server  aids in minimizing the risk that the network  or network resources  become \u201cinfected\u201d with malware carried by the \u201cvulnerable\u201d user device .",{"@attributes":{"id":"p-0102","num":"0101"},"figref":"FIG. 6","b":["28","48","25","24"]},"In step , the policy server  establishes a communications session with the computerized device . The policy server  establishes the communications session with the computerized device  based upon the results of the analysis step , described above.","As indicated above, the policy server  analyzes the posture credentials  of the computerized device  relative to the accepted credential set  to generate the access instruction  that indicates, to the data communications device , whether to allow or prevent communications between the computerized device  and the network resources . In one arrangement, in addition to asking for posture credentials , the policy server may also request the posture agent  for the identity of the user of the computer device  or the identity of the device itself and authenticate those identities through another sequence of challenge-responses using well-defined authentication methods e.g. EAP-MS-CHAPv2, EAP-GTC.","For example, assume the posture credentials  indicate, in part, an identity of the computerized device  (e.g., identifies the computerized device  as a user device or network administrator device, for example). When the policy server  analyzes the posture credentials  of the computerized device , the policy server  also determines the identity of the computerized device . Assuming the posture credentials  identify the computerized device  as a user (e.g., as opposed to a network administrator device), the policy server  restricts the computerized device's access, via the access instructions , to certain resources  within the network  (e.g., to public or \u201cnon-administrator\u201d resources  within the network. In such an arrangement, the policy server  provides additional security to the network  based not only on the posture of the user device , but also depending on who the user of the device is and\/or the device itself, e.g. whether the device is recognized as an organization's asset.",{"@attributes":{"id":"p-0106","num":"0105"},"figref":"FIG. 6","b":["28","22","22"]},"In step , the policy server  transmits a posture notification message to the computerized device . For example, in addition to determining the access instruction  that is downloaded to the data communications device , the policy server  may also send one or more notification messages to the user device  via the data communications device . In one arrangement, the notifications (e.g., notification messages) provide. information regarding success of a network access attempt by the computerized device. Similar to the format of the posture credentials, the notification messages are also configured in an extensible messaging format, such as a Type-Length-Value (TLV) or an extensible markup language (XML) format on the policy server. The TLV and XML formats are well-defined, application-independent form for representing information or data. With the posture notification message formatted in the extensible messaging format, third-party manufacturers of posture plug-ins  can recognize the information contained in the notification messages and act on these notifications accordingly.","There are several forms of notification. A posture notification from the policy server  may indicate the result of the posture validation check (i.e. that the posture is compliant with security policy or non-compliant). The notification message may contain a text message for display to a user or for logging to a log file. For example, in the case that a user device  is non-compliant, the message, transmitted by the policy server  may be displayed to the user or written to a log file indicating that the device has been quarantined and needs to be remediated. The notification message may also include a link to a remediation server or the IP address of the remediation server  that a user may click on or an application on the user device  may process to remediate the user device  automatically. Notifications may be processed by the posture agent  or the posture agent may forward the notifications to the posture plug-ins  via the posture plug-in API.","As indicated above, the data communications device  plays a role in controlling a user device's  access to resources  in the network . Where a posture agent  is installed on the user device , the user device  works in conjunction with both the data communications device  and the policy server  in accessing the network resources . There are cases, however, where a posture agent  may not be installed on the user device . This may be because the posture agent  does not exist for the operating system on the user device . The system  allows access instructions to be downloaded from the policy server  to a data communications device  even if the user device  does not have a posture agent .",{"@attributes":{"id":"p-0110","num":"0109"},"figref":"FIG. 7","b":["190","20","22","25","24"]},"In step , the computerized device  transmits a data packet  to network resources  in the network  behind the data communications device . For example, the user device  transmits packets , such as a SYN packet to a network resource  during a handshaking procedure initiated by the user device .","In step , the data communications device  intercepts the packets and, in response, transmits an initial challenge request  to the computerized device . In the case where no posture agent  is present on the device, the computerized device  does not respond to the challenge request .","After attempting several times, in step  the data communications device  detects a non-responsive state of the computerized device  and sends a status message to the policy server . In one arrangement, the status message indicates the IP address and\/or MAC address of the non-responsive host (e.g., computerized device ). The policy server  may maintain a table of computerized devices  that do not have a posture agent  installed, (e.g. an exception list) along with the allowed access for each device.","In step , the policy server  receives the status message from the data communications device , indicating that a user device  on the exception list is attempting to gain access to network resources , and transmits an access instruction  to the data communications device . In one arrangement, the access instruction is based on the IP address of MAC address of the computerized device .","In step , the data communications device  receives and applies the access instruction  to the computerized device . The access instruction  may permit the user device  to access all or a restricted set of network resources  in the network . Alternately, the access instruction can deny the computerized device access to the network resources .","If the computerized device  is not in the exception list, the policy server  may be configured to use other mechanisms available in the network  to find out more information about the device. In one arrangement, the policy server  may request an audit server that scans for vulnerabilities on computerized devices  using mechanisms that do not require a posture agent  on the computerized device . Such mechanisms may be slower and less accurate than if a posture agent  is installed on the user device , but still provides some information that a policy server  can use, (e.g. operating system type, operating system version) to determine the level of access to apply to the computerized device.","Based on the information returned by the audit server, the policy server  applies the appropriate access instruction to the data communications device  depending on the level of compliance to security policy. If the user device  complies with security policy, in such an example, the policy server  transmits an access instruction  to the data communications device  that directs the data communications device  to allow communications between the user device  and the resources  within the network . Assume in another example, however, that based upon the comparison of the information returned by the audit server with security policy configured on the policy server , the policy server  determines that the user device  is not compliant. In such an example, in one arrangement, the policy server  transmits an access instruction  to the data communications device  that directs the data communications device  to restrict or completely reject communications from the user device  to the resources  within the network .","In the above-described arrangement, the policy server  continues to detect the real-time security posture or security state of a user device prior to providing the user device  with access to the network resources  even if the user device  does not have a posture agent  installed. Alternatively, the policy server has a pre-configured list of user devices  that are known not to have the posture agent installed and are deemed to present a low risk to the network. By detecting the real-time security state of the user device  using alternative mechanisms or through the use of an exception list, the policy server  aids in minimizing \u201cvulnerable\u201d user devices  from accessing the network . As such, the policy server  aids in minimizing the risk that the network  or network resources  become \u201cinfected\u201d with malware carried by the \u201cvulnerable\u201d user device .",{"@attributes":{"id":"p-0119","num":"0118"},"figref":"FIG. 8","b":["22","26","28","20"]},"The computerized device  includes a controller  formed of a memory  and a processor . The data communications device  includes a controller  formed of a memory  and a processor . The policy server  includes a controller  formed of a memory  and a processor . A computer program product  includes an application or logic instructions that are loaded into the computerized device , data communications device , and policy server  to configure the devices , ,  to operate as part of the data communications system , described above.","The computerized device , in this example, includes an interconnection mechanism  such as a data bus and\/or other circuitry that interconnects the memory  and the processor , and one or more communications interfaces . The communication interface  connects with the data communications device  via connections .","The memory  may be any type of volatile or non-volatile memory or storage system such as computer memory (e.g., random access memory (RAM), read-only memory (ROM), or other electronic memory), disk memory (e.g., hard disk, floppy disk, optical disk and so forth). The memory  is encoded with logic instructions (e.g., software code) and\/or data that form a posture agent application  configured according to embodiments of the invention. In other words, the posture agent application  represents software code, instructions and\/or data that represent or convey the processing logic steps and operations as explained herein and that reside within memory or storage or within any computer readable medium accessible to the computerized device .","The processor  represents any type of circuitry or processing device such as a central processing unit, microprocessor or application-specific integrated circuit that can access the posture agent application  encoded within the memory  over the interconnection mechanism  in order to execute, run, interpret, operate or otherwise perform the posture agent application  logic instructions. Doing so forms the posture agent process . In other words, the posture agent process  represents one or more portions of the logic instructions of posture agent application  while being executed or otherwise performed on, by, or in the processor  within the computerized device . The computerized device  in  collectively represents either one or both of the posture agent application  and the posture agent process .","The data communications device , in this example, includes an interconnection mechanism  such as a data bus and\/or other circuitry that interconnects the memory  and the processor , and one or more communications interfaces . The communication interface  connects with the computerized device  via connection  and with the policy server  via connection .","The memory  may be any type of volatile or non-volatile memory or storage system such as computer memory (e.g., random access memory (RAM), read-only memory (ROM), or other electronic memory), disk memory (e.g., hard disk, floppy disk, optical disk and so forth). The memory  is encoded with logic instructions (e.g., software code) and\/or data that form a network access application  configured according to embodiments of the invention. In other words, the network access application  represents software code, instructions and\/or data that represent or convey the processing logic steps and operations as explained herein and that reside within memory or storage or within any computer readable medium accessible to the data communications device .","The processor  represents any type of circuitry or processing device such as a central processing unit, microprocessor or application-specific integrated circuit that can access the network access application  encoded within the memory  over the interconnection mechanism  in order to execute, run, interpret, operate or otherwise perform the network access application . Doing so forms the network access process . In other words, the network access process  represents one or more portions of the logic instructions of the network access application  while being executed or otherwise performed on, by, or in the processor  within the data communications device . The data communications device  in  collectively represents either one or both of the network access application  and the network access process .","The policy server , in this example, includes an interconnection mechanism  such as a data bus and\/or other circuitry that interconnects the memory  and the processor , and one or more communications interfaces . The communication interface  connects with the data communications device  via connection .","The memory  may be any type of volatile or non-volatile memory or storage system such as computer memory (e.g., random access memory (RAM), read-only memory (ROM), or other electronic memory), disk memory (e.g., hard disk, floppy disk, optical disk and so forth). The memory  is encoded with logic instructions (e.g., software code) and\/or data that form a credential analysis application  configured according to embodiments of the invention. In other words, the credential analysis application  represents software code, instructions and\/or data that represent or convey the processing logic steps and operations as explained herein and that reside within memory or storage or within any computer readable medium accessible to the policy server .","The processor  represents any type of circuitry or processing device such as a central processing unit, microprocessor or application-specific integrated circuit that can access the credential analysis application  encoded within the memory  over the interconnection mechanism  in order to execute, run, interpret, operate or otherwise perform the credential analysis application . Doing so forms the credential analysis process . In other words, the credential analysis process  represents one or more portions of the logic instructions of the credential analysis application  while being executed or otherwise performed on, by, or in the processor  within the policy server . The policy server  in  collectively represents either one or both of the credential analysis application  and the credential analysis process .","While this invention has been particularly shown and described with references to preferred embodiments thereof, it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention as defined by the appended claims. As an example, in one embodiment as described above, the user device  transmits the challenge response to the data communications device where the challenge response includes configuration credentials used by the policy server. Such description is given by way of example only. In another arrangement, the challenge response causes the policy server  to establish direct communications with the user device , for example via a tunnel over which an EAP session is established to further query the device . The policy server  then presents a query to the posture agent  of the user device requesting the posture credentials. The posture agent  obtains the posture credentials associated with the user device  and transmits the posture credential information to the policy server over the communication session. In this manner, the initial challenge request  can request limited posture information , and if the policy server  deems it necessary, further posture information can be obtained later.","For example, as described above, the user device  includes sets of configuration credentials , also referred to hereinafter as \u201cposture plug-ins\u201d. Each posture plug-in  indicates a security posture with respect to a particular manufacturer's application (e.g., security status, setting, value, active applications, or other configuration data) of the user device  with respect to one or more security vulnerabilities of the device. Such description is by way of example only. In one arrangement plug-ins represent an embodiment for the transmission of configuration information from the operating system and local applications associated with a user device  to a posture agent."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing and other objects, features and advantages of the invention will be apparent from the following description of particular embodiments of the invention, as illustrated in the accompanying drawings in which like reference characters refer to the same parts throughout the different views. The drawings are not necessarily to scale, emphasis instead being placed upon illustrating the principles of the invention.",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 3","FIG. 1"]},{"@attributes":{"id":"p-0027","num":"0026"},"figref":["FIG. 4","FIG. 1"]},{"@attributes":{"id":"p-0028","num":"0027"},"figref":["FIG. 5","FIG. 1"]},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 6","FIG. 1"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":["FIG. 7","FIG. 1"]},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 8","FIG. 1"]}]},"DETDESC":[{},{}]}
