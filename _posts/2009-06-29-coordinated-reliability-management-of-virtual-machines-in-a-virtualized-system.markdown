---
title: Coordinated reliability management of virtual machines in a virtualized system
abstract: A system and methods for reliability management of virtual machines in a host system. The reliability of the host system is monitored and compared with a reliability threshold level for a virtual machine. If the reliability of the host system drops below the reliability threshold level, the virtual machine is migrated to another host system having an appropriate level of reliability.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09069730&OS=09069730&RS=09069730
owner: Hewlett-Packard Development Company, L. P.
number: 09069730
owner_city: Houston
owner_country: US
publication_date: 20090629
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","DETAILED DESCRIPTION"],"p":["A Virtual Machine (VM) is an environment, usually a program or operating system, that does not physically exist but is created within another environment. In this context, the VM is called a \u201cguest\u201d while the environment it runs within is called a \u201chost\u201d. Virtual machines can be created to execute an instruction set different than that of the host environment. One host environment (e.g., computer system) can run multiple virtual machines simultaneously. Since virtual machines are separated from the physical resources they use (i.e., memory, CPU cycles), the host environment is often able to dynamically assign those resources among them.","In the following detailed description of the present embodiments, reference is made to the accompanying drawings that form a part hereof, and in which is shown by way of illustration specific embodiments of the disclosure which may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the subject matter of the disclosure. It is to be understood that other embodiments may be utilized and that process or mechanical changes may be made without departing from the scope of the present disclosure. The following detailed description is, therefore, not to be taken in a limiting sense, and the scope of the present disclosure is defined by the appended claims and equivalents thereof.",{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 1"},"In one example embodiment, the monitored system parameters that can affect host reliability include disk error data, processor machine check event data, bus error data, as well as other system information. The monitored system parameters are used to model the reliability of the host system in terms of different reliability levels. For example, one set of reliability levels might go from extremely reliable to extremely unreliable. This information is then used to determine whether to preemptively migrate the VMs to more reliable host systems. These monitored parameters may be defined in a service level agreement.",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1","b":["101","103","110","111","120","121","101","103","100","130","100"]},"In some example embodiments, the virtualization manager  utilizes a spanning tree algorithm to identify and map the nodes - that are operatively connected to the cluster management node . The results of the execution of this spanning tree algorithm are stored into a data structure that includes the identities of each of the nodes -. Operatively connected includes a logical or physical connection.","Coordination is achieved using two basic design elements that jointly provide the needed information exchange and policy execution. The first element is a registry & proxy service  that provides discovery, meta-data registration and proxying of calls to the appropriate sensors\/actuators across hardware and software. The second element is a coordinator agent  that interfaces to the registry & proxy service  through well-defined Application Programming Interfaces (APIs), and implements data\/control policies for coordination in a platform independent manner. Coordinators ,  implement policies for platform-aware virtualization management and for virtualization-aware platform management and they are depicted in  as plug-ins to existing managers (a coordinator can also be hosted as a separate service without loss of functionality). In addition, a special coordinator agent  (i.e., stabilizer) interfaces to the respective plug-ins. The stabilizer  ensures system stability and prevents coordinators ,  from taking redundant and unnecessary actions.","The registry & proxy service  performs two functions\u2014(i) discovery and meta-data registration for sensors\/actuators, and (ii) dynamic redirection of calls (proxying) to appropriate sensor\/actuators. Well-known protocols are used for discovery and meta-data registration including the use of leases. However, for scalability purposes, the registry & proxy service  is designed in a distributed manner with per-node registries linked via an overlay.","The registry & proxy service  leverages existing industry standards based protocols so as to communicate with a single \u201clanguage\u201d to the diverse sensor\/actuator interfaces. While the registry service performs discovery and metadata registration continuously in the background, the coordination agent is active only during the dynamic phase of policy execution. During this phase, it queries the registry service and becomes aware of the meta-data of available sensors\/actuators. It then requests specific data from the diverse sensors across hardware-software to be fetched (unified monitoring). The registry & proxy service  obtains this data by communicating using the underlying protocols to the appropriate sensors.","The separation of registry & proxy services  and coordination agents ,  allows policy development to occur without having to deal with low-level implementation issues. These issues include how to communicate, how to discover the diverse sensors across the virtualization and platforms domains, and how to access diverse software vs. hardware sensors. The resulting loose coupling allows the controllers, sensors, and actuators to (i) be not aware of each other directly, (ii) enter and leave the system dynamically without breaking dependencies (especially important in a virtualized environment where virtual machines can be migrated), (iii) be provided by multiple vendors and\/or use different data models. Furthermore, as shown in , coordinator agents ,  can be merged with existing controllers as loosely-coupled plug-ins, which preserves prior investments and leverages existing industry trends.","The coordinator  at the cluster level enhances traditional virtualization management solutions that consider virtual machine metrics such as CPU, memory, network bandwidth, and virtual machine priority. In one example embodiment, the traditional virtualization management solutions do not take into account platform requirements such as power budget or attributes like platform reliability or trust. As an example, virtual machine placement is the task of selecting the most suitable host for a virtual machine for initial provisioning and subsequent migrations. By not considering platform attributes during virtual machine placement, management must rely on runtime techniques like workload balancing so as to meet power budget violations or host failures. However, workload balancing can be expensive and can at times result in system downtime. It would be desirable, therefore, to have a solution that can minimize power budget violations or virtual machine downtime and thus reduce costly runtime actions.","The coordinator  addresses this problem by employing a multi-pass algorithm that considers both the virtual machine and platform metrics when making placement decisions, thus avoiding bad decisions that lead to early power budget violations or system downtimes. Toward this end, it uses the registry & proxy service  to obtain access to system reliability data. Being a plug-in to the virtualization manager , it has internal access to the system utilization information as well.","In operation, the coordinator  first obtains a list of nodes (provided by the virtualization manager ) that satisfies the new (or migrating) virtual machine's various resource requirements (CPU, memory etc.) Thereafter, it queries the registry and proxy service to obtain information on the available reliability state repositories in the cluster. When found, the reliability state repository is queried to obtain the current reliability states for all nodes satisfying the VM's requirements. Reliability filtering is then applied on these nodes checking that the node will not violate the availability requirement of the VM when deployed on it. From these filtered nodes, a final node is selected for VM placement using a predetermined policy. For example, the coordinator can select the first \u201cmatching\u201d node that satisfies VM resource and reliability requirements, or perform a best match (e.g., the most idle host for a VM). Alternatively, the coordinator chooses a node that ensures system stability, i.e., would satisfy both the VM and platform requirements for a sufficient period of time into the future with the stability checks provided through the stabilizer . Once the final node is selected by the coordinator , the virtualization manger  deploys the VM on that chosen node based on the selection.","At the per-node level, the coordination agent , traditional platform management solutions typically make decisions based on lower level metrics obtained through hardware sensors and performance counters. They have no direct feedback from higher layers. On the other hand, virtualization runtime management solutions (e.g., virtual machine migrations to meet performance goals) make their decisions based on higher level metrics only obtained through virtualization and application sensors.","The coordinator agent plug-in  interfaces with the reliability manager  to address these problems. Periodically, the reliability manager  scans the hardware sensor logs such as Intelligent Platform Management Interface (IPMI) sensor data for any errors (e.g., bus error, fan failure etc.) and uses a reliability model to determine the current reliability state of the system (e.g., the node ). The model is known a priori or learned dynamically using techniques like machine learning algorithms. Accurate predictions of the reliability state, i.e., of impending failures, are then matched to higher layer VM availability SLA requirements (access to SLA sensors are obtained through the registry and proxy services), and on a mismatch, the coordination architecture leverages the richness of actuators and preemptively migrates VMs to more reliable hosts, thus improving overall availability of VMs. The coordinator agent  maps hardware reliability states to virtual machine requirements and initiates virtual machine migration to mitigate the effects of hardware failures. For example, a VM residing on the node  is migrated to the node .",{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 2"},"This domain hosts the registry & proxy services , as well as the reliability coordinator . Since most of the per-host management code (including various management models, policies, and device drivers) run inside an isolated virtual machine, this reduces the Trusted Computing Base (TCB) of the VMM and, in turn, improves its security and reliability.","Also, although the coordinator  requires certain privileges for management, this is a subset of the privileges required by other distinguished virtual machines, ensuring improved robustness to failures compared to solutions in which such functions are integrated into the VMM. One other benefit is the virtual appliances . Having a separate virtual machine for management simplifies its deployment and its upgrades, by casting it into the form of a virtual machine appliance . In this form, the management virtual machine  can be deployed independently from the VMM, and it can be dynamically added or removed from a system.","The registry & proxy service  relies on an infrastructure to connect with the diversity of reliability sensors and actuators . Dynamism is handled through leases. When a request is made for monitoring or actuation, the registry & proxy service  leverages the discovery and namespace registration table to redirect the call to the appropriate location.","The coordinators are implemented at application level, as multithreaded processes where one or more threads perform the monitoring, protocol exchange, coordination, and actuation tasks. They interface with the registry service  and bind to the API libraries.",{"@attributes":{"id":"p-0026","num":"0025"},"figref":["FIG. 3","FIG. 1"],"b":["100","103","101","103","100"]},"An operation  is executed in which the host system (e.g., one or more computer systems each including controller, memory, and I\/O) is monitored for events that might affect the reliability of the host. The monitoring can include scanning system logs that track such reliability altering events. For example, if the processor of the host system experiences an error, this event is stored in Machine Check Event (MCE) log for later access. An event can be defined in a service level agreement and can include such errors as bus errors, disk errors, or other errors that affect the host system reliability. This operation  may be executed by at least one of the nodes -, and the reliability manager  residing thereon.","An operation  is executed to estimate the current reliability of the host system using the reliability altering events and a reliability model. The reliability model can be one that is stored in the system memory or changed dynamically using a learning algorithm such as a Bayesian algorithm. This operation  may be executed by at least one of the nodes -, and the reliability manager  residing thereon.","In some example embodiments, the learning algorithm includes one or more of the following algorithms\u2014Case-Based Reasoning, Bayesian networks that include Hidden Markov Models, Neural Networks, or Fuzzy Systems. The Bayesian networks may include\u2014Machine Learning Algorithms including\u2014Supervised Learning, Unsupervised Learning, Semi-Supervised Learning, Reinforcement Learning, Transduction, Learning to Learn Algorithms, or some other suitable Bayesian network. The Neural Networks may include: Kohonen Self-Organizing Network, Recurrent Networks, Simple Recurrent Networks, Hopfield Networks, Stochastic Neural Networks, Boltzmann Machines, Modular Neural Networks, Committee of Machines, Associative Neural Network (ASNN), Holographic Associative Memory, Instantaneously Trained Networks, Spiking Neural Networks, Dynamic Neural Networks, Cascading Neural Networks, Neuro-Fuzzy Networks, or some other suitable Neural Network.","In some example embodiments, some type of advanced statistical method or algorithm may be employed via the operation . These methods may include the use of Statistical Clusters, K-Means, Random Forests, Markov Processes, or some other suitable statistical method, or algorithm. One or more of these advanced statistical methods may be used to create the reliability model.","An operation  is executed to match the VMs to the host systems based on the desired reliability for the VM and the predicted reliability of each host system. For example, if a particular VM requires an extremely high level of reliability, it would be matched with a host system that is predicted to have that level of reliability or greater. This operation  may be executed by the cluster management node , and the coordinator agent  residing thereon. In the alternative, this operation  may be executed by at least one of the nodes -, and the coordinator agent  residing thereon. In some example embodiments, these coordinator agents  and  work in combination.","An operation  is executed to preemptively migrate the VMs from the memory of its current host system to the memory of another host system that exhibits the desired reliability level for that particular VM. For example, if a particular VM requires a high reliability level and its current host system is predicted to have a relatively low reliability level, the VM can be migrated to another host having the high reliability level. This operation  may be executed by the cluster management node  and the virtualization manager  residing thereon.","Typically, solutions for VM placement in a host system take into account VM metrics such as CPU, memory, network bandwidth, and VM priority. However, service level agreement data for a particular VM may call for a certain level of reliability for that VM. As a result, if the host fails, the availability requirements of the VM might not be met, leading to undesirable down time.","By moving a VM after an indication that the current host does not meet the desired reliability levels or proactively moving the VM when a failure probability for the host is greater than a predetermined threshold, the virtualized system and method for coordinated reliability management can reduce the down time of virtual machines and improve availability. The VM migration is seamless to any applications running on the VM. The host reliability, reliability thresholds, and failure probabilities can be defined in the service level agreement.","Similar to compute node reliability, storage node reliability can be monitored (e.g., monitoring Self-Monitoring and Reporting Technology (SMART) data) and used to predict impending disk failures. When the host system is a storage node comprising means for storage (e.g., magnetic disk, optical disk, semiconductor storage), the coordinator can then perform proactive backup or use techniques (e.g., VMWARE's STORAGE VMOTION\u2122) to improve VM's and its data availability.",{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 4","b":["400","401","201","401","400","401","402","404","403","405","404","407","404","406","404","404","411","409","409","411","411","408","412","410","413","414","415","411","416","416","417","418"]},"The SATA port  may interface with a persistent storage medium (e.g., an optical storage devices, or magnetic storage device) that includes a machine-readable medium on which is stored one or more sets of instructions and data structures (e.g., software) embodying or utilized by any one or more of the methodologies or functions illustrated herein. The software may also reside, completely or at least partially, within the SRAM  and\/or within the CPU  during execution thereof by the computer system . The instructions may further be transmitted or received over the 10\/100\/1000 Ethernet port , USB port  or some other suitable port illustrated herein.","In some example embodiments, a removable physical storage medium is shown to be a single medium, and the term \u201cmachine-readable medium\u201d should be taken to include a single medium or multiple medium (e.g., a centralized or distributed database, and\/or associated caches and servers) that store the one or more sets of instructions. The term \u201cmachine-readable medium\u201d shall also be taken to include any medium that is capable of storing, encoding or carrying a set of instructions for execution by the machine and that cause the machine to perform any of the one or more of the methodologies illustrated herein. The term \u201cmachine-readable medium\u201d shall accordingly be taken to include, but not be limited to, solid-state memories, optical and magnetic medium, and carrier wave signals.","Data and instructions (of the software) are stored in respective storage devices, which are implemented as one or more computer-readable or computer-usable storage media or mediums. The storage media include different forms of memory including semiconductor memory devices such as DRAM, or SRAM, Erasable and Programmable Read-Only Memories (EPROMs), Electrically Erasable and Programmable Read-Only Memories (EEPROMs) and flash memories; magnetic disks such as fixed, floppy and removable disks; other magnetic media including tape; and optical media such as Compact Disks (CDs) or Digital Versatile Disks (DVDs). Note that the instructions of the software discussed above can be provided on one computer-readable or computer-usable storage medium, or alternatively, can be provided on multiple computer-readable or computer-usable storage media distributed in a large system having possibly plural nodes. Such computer-readable or computer-usable storage medium or media is (are) considered to be part of an article (or article of manufacture). An article or article of manufacture can refer to any manufactured single component or multiple components."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0003","num":"0002"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0004","num":"0003"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0005","num":"0004"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0006","num":"0005"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
