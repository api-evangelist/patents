---
title: System, apparatus for content delivery for internet traffic and methods thereof
abstract: In one embodiment, a method of serving media includes receiving a delivery log of traffic use after every first time interval for an user equipment. The user equipment is part of a hot billing class of users. The traffic use comprises data usage by the user equipment during communication with a media server in a layer2 access network. A user traffic information computed from the delivery log is transmitted to a billing center. A account status information is received from the billing center. The account status information is received if the user equipment exceeds a user account metric. A session termination information based on the account status information is transmitted.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09628579&OS=09628579&RS=09628579
owner: Futurewei Technologies, Inc.
number: 09628579
owner_city: Plano
owner_country: US
publication_date: 20110511
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims the benefit of U.S. Provisional Application No. 61\/334,548, filed on May 13, 2010, which application is hereby incorporated herein by reference.","This application relates to the following co-pending and commonly assigned patent application: Ser. No. 13\/105,439, filed May 11, 2011, which application is hereby incorporated herein by reference.","The present invention relates generally to content delivery, and more particularly to system, apparatus for content delivery for internet traffic and methods thereof.","In recent years, media consumption using mobile devices has dramatically increased. Consequently, telecommunication networks are bursting at the seams because of this explosive growth in traffic. This phenomenon is even more evident in the Mobile Broad Band (MBB) networks where the cost of infrastructure is much more (e.g., about 20-30 times) than that of the Fixed Broad Band (FBB) networks. The recent proliferation of mobile devices, such as smart-phones, tablets, netbooks, laptops, has kicked off a new era of wireless access to full web on the go. Consequently, the growth of multimedia traffic is expected to be much faster than the growth of traffic in FBB networks in its first 5 years of growth (e.g., from year 2000 to year 2005).","However, MBB and FBB network operators do not benefit from this increased traffic. Most of this fast growing traffic does not contribute to the revenue for the MBB and FBB network operators because this traffic is classified to be direct to consumer traffic, which is often referred to as Over-The-Top (OTT) traffic. Therefore, mitigating the impact of the rapidly growing OTT traffic becomes an urgent priority for the MBB and the FBB network operators.","OTT traffic differs from other traffic such as Business-To-Business (B2B) or Business-To-Consumer (B2C) traffic in that the OTT content and traffic characteristics are unknown to the operators. These unknown characteristics include media origin, media type, delivery protocol\/schemes used, protected vs. clear content, dynamic vs. static content, etc. Therefore, handling and mitigating the impact of OTT traffic is difficult because of the technical complexity, network costs, and uncertain nature of the OTT handling.","These and other problems are generally solved or circumvented, and technical advantages are generally achieved, by illustrative embodiments of the present invention.","In accordance with an embodiment of the invention, a method of serving media comprises receiving a delivery log of traffic use after every first time interval for an user equipment. The user equipment is part of a hot billing class of users. The traffic use comprises data usage by the user equipment during communication with a media server in a layer2 access network. A user traffic information computed from the delivery log is transmitted to a billing center. A account status information is received from the billing center. The account status information is received if the user equipment exceeds a user account metric. A session termination information based on the account status information is transmitted.","In another embodiment of the present invention, a method of serving media comprises periodically generating a delivery log comprising traffic use for an on-going session with an user equipment for every first time interval. The delivery log is transmitted periodically every second time interval. A session termination information is received if the user equipment exceeds a user account metric. The on-going session with the user equipment is terminated.","In another embodiment of the present invention, a method of serving media comprises receiving a request to serve media content to a user equipment and receiving a subset of packet data protocol (PDP) information. The PDP comprises a flag indicating charging type of the user equipment. The method further includes determining the charging type of the user equipment based on the flag and determining the media content to be served is not cacheable if the charging type of the user equipment is a real time charging type. The request to serve the media content is forwarded without caching if the charging type of the user equipment is the real time charging type.","In another embodiment of the present invention, a method of media streaming comprises maintaining a list of local media servers deployed in a first layer2 access network and maintaining a IP address of a media controller in a content delivery network. The media controller is configured to assign a media server to serve a user equipment. The method further comprises determining if a local media server from the list of local media servers has failed. A request from the user equipment to serve media content is received. The request from the user equipment to the media controller is forwarded if the local media server has failed.","In another embodiment of the present invention, a method of media streaming comprises assigning a first media server to serve a user equipment in response to a request to serve a cacheable media content to a user equipment. A status of the first media server is monitored to determine if the first media server fails. If the first media server fails, a second media server is assigned to serve the user equipment, a redirect message having a source message of the first media server is generated, and the redirect message is sent. The redirect message redirects the user equipment to the second media server.","The foregoing has outlined rather broadly the features of an embodiment of the present invention in order that the detailed description of the invention that follows may be better understood. Additional features and advantages of embodiments of the invention will be described hereinafter, which form the subject of the claims of the invention. It should be appreciated by those skilled in the art that the conception and specific embodiments disclosed may be readily utilized as a basis for modifying or designing other structures or processes for carrying out the same purposes of the present invention. It should also be realized by those skilled in the art that such equivalent constructions do not depart from the spirit and scope of the invention as set forth in the appended claims.","Corresponding numerals and symbols in the different figures generally refer to corresponding parts unless otherwise indicated. The figures are drawn to clearly illustrate the relevant aspects of the embodiments and are not necessarily drawn to scale.","The making and using of various embodiments are discussed in detail below. It should be appreciated, however, that the present invention provides many applicable inventive concepts that can be embodied in a wide variety of specific contexts. The specific embodiments discussed are merely illustrative of specific ways to make and use the invention, and do not limit the scope of the invention.","Definition and acronyms of basic functional entities, interfaces between them, used in the following description is described below.","Acronyms:","AAA\u2014Authentication, Authorization, and Accounting","ADMF\u2014Administration Function for lawful interception","B2B\u2014Business to Business (a model where the operator provides services to another business)","B2C\u2014Business to Consumer (a model where the operator provides services to its end users)","BC\u2014billing and charging policy server","BG\u2014Border Gateway (peering point to the internet)","CC\u2014CDN Control (control function that decides which MS to handle a given request)","CDN\u2014Content Delivery Network (open CDN that supports OTT, B2B, and B2C)","CG\u2014Charging Gateway (responsible for charging aspect of services)","DF\u2014Delivery Function (a LI infrastructure term)","DPI\u2014Deep Packet Inspection (a function that inspects packets)","DPI-C\u2014Content Request Level DPI (involving deep HTTP header, URL analysis)","DSL\u2014Digital Subscriber Line","FBB\u2014Fixed Broad Band (XDSL, cable networks, etc.)","GGSN\u2014Gateway GPRS Support Node","GPRS\u2014General Packet Radio Services","GSN\u2014GPRS Support Node (either an SGSN or GGSN)","IWF\u2014Inter-Working Function (a special function for connecting L2 node and media server)","L2 Node\u2014Layer 2 Node (such as RNC and Node-B in MBB, DSLAM in FBB networks etc.)","L3 Node\u2014Layer 3 Node (such as GGSN in MBB or BRAS in FBB etc.)","LEMF\u2014Law Enforcement Monitoring Function","LI\u2014Lawful Interception (provides interface for LI such as MBB's LIG)","LIG\u2014Lawful Interception Gateway","LIMS\u2014LI Management System","MBB\u2014Mobile Broad Band (2.xG, 3G, 4G, or WiMax networks)","MC\u2014Media Control (same as CDN Control Function)","MD\u2014Media Data (Data Analytics, Logs and Reports)","MS\u2014Media Server (provides media streaming, caching, and adaptation functions)","MX\u2014Media Switch (same function as MS)","NB\u2014Node-B (a 3GPP RAN function, i.e., Radio Base Station also called BS, eNB)","OCS\u2014Online Charging System","OTT\u2014Over The Top (type of content and traffic that are unknown to the network operator)","PCC\u2014Policy Charging and Control","PCRF\u2014Policy, Charging Rules Function","PS\u2014Policy Server (such as PCRF in MBB)","QoE\u2014Quality of Experience (Quality of End User Experiences)","QoS\u2014Quality of Service","RNC\u2014Radio Network Controller (a RAN control function in the 3GPP standard)","SGSN\u2014Serving GPRS Support Node","SUR\u2014Subscriber Usage Report","UE\u2014User Entity (end user device\/client)","XDSL\u2014All variants of DSL technologies such as ADSL and HDSL.","Different prior art methods of handling OTT traffic will be described with respect to . However, the inventors have identified that these prior art methods have different advantages and disadvantages which are discussed in further detail below.","The application described below uses the abbreviation GGSN and SGSN only as an illustration. The terms could also be servers performing these operations in the network. For example, the server performing the operations of GGSN in a 3GPP LTE\/4G network is referred as system architecture evolution gateway (SAE-GW) and the server performing the operations of SGSN in a 3GPP LTE\/4G network is referred as Mobility Management Entity (MME). Therefore, the class of servers performing the operations of the GGSN, the SAE-GW, and similar equivalent servers may be referred as gateway server node and the class of servers performing the operations of the SGSN, the MME, and similar equivalent servers may be referred as serving\/management node. GGSN and SGSN are used in the descriptions only as an illustration and any corresponding server may be used in various embodiments described herein.",{"@attributes":{"id":"p-0106","num":"0105"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0107","num":"0106"},"figref":"FIG. 1","b":["10","70","20","21","21","20","70","30","30","31","32","33"]},"The Gi Offload method is widely used in Mobile Broad Band (MBB) networks. In the Gi Offload method, a caching media server MS  is introduced through the IP traffic network . The functionality of the MS  may be implemented as a standalone cache function or as a media server as part of a CDN network. The deep packet inspection DPI  function may be standalone or as a part of the L3 Node  (such as a gateway GPRS support node (GGSN)). However, the Gi Offload method does not help alleviate traffic pressure below the DPI function because content is cached very high up in the network path. To solve this problem, a second method has been introduced as illustrated in .",{"@attributes":{"id":"p-0109","num":"0108"},"figref":"FIG. 2"},"In the MEAG method, the offload position is moved from the L3 Node  (such as Gi at GGSN) to the L2 Node (e.g., RNC). Gi is the IP based interface between the GGSN and a public data network (PDN). As illustrated in , the TOF  is introduced into the L2 network . Therefore, this method is able to provide bandwidth savings above the TOF  (i.e. saving realized in all of the L3 Nodes  above the TOF ). However, in order to support all of the other supporting services associated with the MBB access network such as Lawful Interception (LI), real time charging services, and policy based QoS services (PCRF), TOF  has to support direct interfaces with the CG , LI , and PS  functions as illustrated in .","An optional MS function, the MS  (dotted line box) may be included as a standalone caching server or a media server as part of a CDN network. The offload function and caching functions are inherently decoupled, but can be combined to offer additional benefits.","However, this method has many drawbacks. First, all traffic is analyzed at the TOF  using Deep Packet Inspection (DPI) type of approach. This significantly degrades performance of the L2 network . Second, in order to support the MBB related services such as CG , LI , and PS , direct interfaces from TOF  to these functions must be maintained, complicating the interactions for CG , LI , and PS . Third, to achieve the first and the second above, the TOF  is likely to become a complex function having many of the common functions of the MBB's SGSN and GGSN functions.","In spite of these drawbacks, this method has been adopted into TR23.829 standard as Alternative 4. This next method attempts to improve on some of these drawbacks in this second method.",{"@attributes":{"id":"p-0114","num":"0113"},"figref":"FIG. 3"},"This method (again in the MBB domain) attempts to use a standard GSN handling called direct tunnels, which allows a L2 node , such as a RNC, in the L2 network  to establish a direct tunnel to a local L3 node  such as a local GGSN. Therefore, a local GGSN is positioned beside the RNC (L2 node ), thereby allowing the RNC to offload certain types of traffic (such as web traffic) to the internet via the Local GGSN (local L3 node ). Existing SGSN and GGSN function are in the non-offload path under this method.","Two slightly different configurations have been proposed for this method: static offload and dynamic offload. First, in the static offload configuration, once setup, the offload traffic will statically go through the local L3 node  (Local GGSN) and non-offload traffic will continue through L3 Node  (GGSN). As shown in , at the time of the packet data protocol (PDP) setup, a SGSN (another L2\/L3 Node) may determine the static configuration. This requires modification to the SGSN for offload policy handling and identification of Local GGSN.","Alternatively, the dynamic offload configuration is shown with the dotted line between the local L3 node  and the L3 node . In this case, all data traffic go through local L3 node  (Local GGSN), which makes offload decision, including applying different offload policy on different flows within a single PDP. SGSN will always choose a L3 node  (macro GGSN), and the local L3 node  (Local GGSN) serves as the proxy for the macro GGSN.","This method has similar benefit as the second method in terms of saving the core L3 Nodes (SGSN, GGSN in the MBB context). However, since GGSN is a standard MBB function and its interface with CG , LI , and PS , etc. are already defined and standardized, introducing local GGSN at the L2 node  (such as a RNC) appears to solve many of the problems. Unfortunately, there are additional drawbacks of this method as outlined below.","First, a L3 Node , such as a GGSN, is a complex function and its implementation is relatively expensive and difficult to manage. Therefore, having multiple GGSN nodes is not cost effective. Second, with multiple GGSNs in the network, the interaction between CG , LI , and PS  etc. becomes more complicated. For example, the real time charging function will need to receive inputs from both GGSN (local L3 node  and L3 node ) in order to determine if an active session has reached a rating limit. Third, this scheme may present a challenge in a single access point name (APN) setup where all services use a single APN. In particular, the static offload configuration described above, once the packet data protocol (PDP) is setup, the statically determined offload from L2 node  (RNC) to the local L3 node  (Local GGSN) cannot be changed.","In various embodiments of the present invention, various innovative methods of deploying layer3 based content delivery network (CDN) Media Servers (MS) into any layer2 access networks (such as RAN networks or XDSL access networks, or even cable networks) will be described. Such deployments of the CDN media servers may be used to cache and process media content closer to the user devices, while maintaining a unified, common, and open CDN network capable of handling OTT, B2B, and B2C services for both MBB and FBB networks.","The cost savings potential for the existing network infrastructure is greater if the CDN media server is located closer to the end user device when caching the OTT content delivered through an access network (MBB or FBB) to the end user. This is because the infrastructure cost of Radio Access Network (RAN) nodes is progressively more than those of the Packet Switching (PS) network. Consequently, it is advantageous to move the media server further down the access path towards end user devices.","However, last mile access network may be a layer2 network or may be a non-IP closed networks such as RAN (in 3G wireless networks) or XDSL. Deployment of a media server in to these networks has at least two challenges. First, the media server, which is typically a layer 3 node, requires special interfaces to interact with the layer2 network. Second, regular offload (TOF) schemes require a DPI process so as to determine if an OTT flow is cacheable and to offload or cache locally. This DPI process may be very CPU intensive and may degrade the capacity of the access nodes.","Embodiments of this invention overcome these and other problems by deploying a layer3 media server into a layer2 access network with functionality decoupling. In particular, some functionality, such as OTT traffic detection, caching decision and the OTT traffic request routing decision, is retained within the layer3 CDN networks. Embodiments of the invention also include unique handling for features in the MBB network domain such as Lawful Interception (LI), Online Charging System (OCS) related handlings, QoS handling and support, as well as many other capability supports for both MBB and FBB networks.","Embodiments of the invention will be first described using the system architectural framework of . Detailed structural embodiments of various units will be described using . Embodiments of the invention as applicable to mobile broadband network, XDSL network, cable broadband network will be described using  respectively. Embodiments for flow operations for MBB network will be described using . Embodiments of the invention relating to handling of roaming\/relocation will be described using . Embodiments of the invention for lawful interception will be described using . Embodiments of the invention for handling of charging, reports, and analytics as well as quality of experience provisions will be described with respect to . Embodiments of the invention for handling of failure of media servers will be described with respect to .",{"@attributes":{"id":"p-0125","num":"0124"},"figref":"FIG. 4"},"In , the UE  represents an end user device such as a mobile or device with a wireless card. Referring to , a L2 network  having multiple L2 nodes  and a L3 network  having multiple L3 nodes  form an access network towards the internet . Various embodiments include an inter-working function IWF  and a L3 based media server MS-A  within the L2 network  beside the L2 node . The IWF  serves as the interface and routing function between the layer2 nodes in the L2 network  and the MS-A .","Media servers located in L2 networks are labeled as MS-A, while media servers located in L3 networks are labeled as MS-B so as to distinguish the different type of media servers. Within the L3 network , a deep packet inspection (DPI)  function examines UE requests for signature match to determine if a request needs to be diverted to the content delivery network (CDN)  for further processing. Therefore, the DPI  diverts certain UE requests to the CDN  for further processing.","DPI  may be configured to inspect the packet passing through it, for example, searching for protocol non-compliance, viruses, spam, intrusions or predefined criteria to decide what actions to take on the packet, including collecting statistical information. DPI  may add the ability to look through Layers 2-7 of the OSI model, which may includes headers and data protocol structures as well as the actual payload of the message. DPI  may identify and classify traffic based on a signature database that includes information extracted from the data part of a packet, allowing finer control than classification based only on header information. In one more embodiments, the DPI  may identify if the traffic comprises an OTT class. A classified packet may be redirected, marked\/tagged, blocked, rate limited, and\/or reported to a reporting agent in the network.","The CDN  is typically a set of servers strategically deployed over an all IP network and may or may not be hierarchical. The CDN  may have a plurality of different units, which may be geographically distributed. Examples of units within the CDN  include servers placed at various points in CDN . For example, a UE  may access a copy of the data that is in the nearest server, as opposed to accessing from a central server. Alternatively, multiple users located at similar locations may access same files from different servers preventing overloading of a single repository server. Content types stored in CDN  may include web objects, downloadable objects (media files, software, documents), applications, real time media streams, and other components of internet delivery (DNS, routes, and database queries).","In various embodiments, an off-path content level deep packet inspection unit (DPI-C)  in the content delivery network (CDN)  understands the OTT requests and decides the appropriate media server to serve the UE making the media request. By using an external DPI-C , the impact to the existing network components is minimized. This is because DPI  is typically already integrated into the L3 nodes . Therefore, the additional functionality is separated from the already existing DPI .","In various embodiments, the MS-A  is introduced into the L2 network , which is much closer to the UE , while decoupling functionality of the CDN  with the L2 network  and the L3 network  as much as possible. In various embodiments, the intensive operations, such as DPI-C  functionality, are maintained at the CDN , which is better equipped for performing complex tasks than the L2 nodes . This avoids the need for adding expensive resources to the L2 nodes for performing intensive operations. Advantageously, by combining the above, the access networks (MBB or FBB) and CDN  can maintain their relative independence in functionality while cooperating to maximize the effectiveness of handling OTT traffic, and the B2B and B2C services if they are also present in a common unified approach.","The inserted functions in the L2 networks  and the L3 networks  may take on several different configuration forms as illustrated in .",{"@attributes":{"id":"p-0133","num":"0132"},"figref":["FIG. 5","FIGS. 5A-5D"]},{"@attributes":{"id":"p-0134","num":"0133"},"figref":["FIG. 5A","FIG. 5B","FIG. 5C","FIG. 5D"],"b":["21","23","24","21","23","24","23","24","21"]},"In , configurations illustrated in  offer the benefit of transparent introduction of MS-A  into the L2 network  without any impact to the L2 Nodes . This requires the IWF  to offer complete transparency for L2 nodes  when MS-A  is introduced into L2 network . One of the benefits of this is that L2 node  may be offered from a different provider than the provider offering IWF  and MS-A .","In contrast, the configuration in  allows significant simplification of the IWF  because many of the messaging and data flow information for a L2 communication is already present in the L2 node .",{"@attributes":{"id":"p-0137","num":"0136"},"figref":["FIG. 6","FIGS. 6A-6D"]},{"@attributes":{"id":"p-0138","num":"0137"},"figref":["FIG. 6A","FIG. 6B","FIG. 6C","FIG. 6D"],"b":["36","37","81","36","37","81","37","81","36"]},"Referring to , the configurations of  offer the benefit of minimal delay for the non-OTT traffic, and the decoupling between the access network  (L3 node  and DPI ) and the CDN network  (DPI-C ). Decoupling the content level DPI and the basic DPI for OTT traffic recognition is advantageous because content level DPI for handling OTT requires on-going tuning of the DPI signature and provisioning for the DPI algorithms to handle changes in the OTT content and traffic profiles.","Therefore, configurations illustrated in  are unable to offer these benefits. Since many L3 nodes  currently deployed also include the ability to perform DPI , configuration of  has the added advantage of reusing the function of the DPI  embedded in the L3 nodes . However, the configurations illustrated in  may be deployed in new architecture scenarios where backward compatibility and pre-existing equipment issues do not exist.","The associated functions at the top of the L3 network  (CG , LI , and PS ) serve as the charging, lawful interception and policy server function to complete the access network services. There are several other innovative features surrounding the interaction with these functions which will be discussed later in the document. For clarity, functions not closely related to the description and understanding of this invention has been omitted.",{"@attributes":{"id":"p-0142","num":"0141"},"figref":["FIG. 7","FIG. 4"]},{"@attributes":{"id":"p-0143","num":"0142"},"figref":["FIG. 7","FIG. 4","FIG. 7","FIG. 4","FIG. 4","FIG. 4","FIG. 7","FIG. 4","FIG. 7"],"b":["121","122","21","136","36","124","120","124","123","124","122","82","182","182","110"]},"The connection between IWF  and MX-A  is an L2\/L3 connection so that traffic to and from MX-A  can be routed properly into and out of the L2 network via the IWF . Practically, all of the MX-As'  IP addresses may be provisioned to be the same for the RNCs  and IWFs  (as in the case of wireless application protocol gateways WAP GW's), but MX-As  have separate uniquely routable IP address towards the CDN\/internet side of the network. As described further below, in other embodiments, alternative IP address allocation using an IP address pool for MX-As may also be used as described later.","The dotted line between MX-A  and CDN  represents an all IP transport network which is likely available in most MBB deployments. In an alternative embodiment, a tunnel\/path through RNC \/IWF -SGSN -GGSN -DPI  may be used to communicate with components in the CDN . This alternative requires IWF  to provide needed routing translation between MX-A  and CDN  from within confines of the tunneling protocols (e.g., GPRS tunneling protocol for carrying user data GTP-U). Therefore, this is more efficient if the IWF  is integrated with the RNC  so that the packaging of GTP message and context are in place when routing messages from MX-A .","In various embodiments, the communication between GGSN  and MC  may take on at least two forms.","In a first embodiment, as illustrated in , the GGSN  and MC  may have a direct private interface Gmc (a simple RESTful API, i.e., an application programming interface conforming to the representational state transfer constraints) for GGSN  to provide relevant PDP context information to MC  for request handling. There are two additional modes of operations of this private interface. In various embodiments, a direct interface between the GGSN  and the MC  is provided, which may use other type of protocol for request handling as known to one skilled in the art.","First, GGSN  may push any new creation, update, and deletion of active PDP contexts to the MC . Each GGSN  may only need to push the information to the MC  it is connected with assuming each GGSN directly connects with at most one MC .","Second, the MC  may always query GGSN  for the PDP context info using the current IP address of the UE  as the query key. The MC  only queries the GGSN(s) , with whom the MC  is directly connected. If multiple GGSNs are connected to a single MC, then the query may be sent to all of the multiple GGSNs unless the DPI  includes information of the GGSN  in the forwarded requests and MC  is designed to parse for it.","In a second embodiment, as illustrated in , the UE HTTP message parameter augmentation may be relied upon to pass on PDP information from GGSN  to the MC  through the DPI , the DPI-C . In this case, the GGSN  includes those relevant PDP context parameters (see Table 1) in the augmented HTTP header. This option may impact performance of the GGSN  because the augmentation of HTTP messages at GGSN  requires additional processing.",{"@attributes":{"id":"p-0151","num":"0150"},"figref":["FIG. 8","FIGS. 8A-8D"]},"In various embodiments, the DPI-C , the MC , and the MX-B  may be implemented in separate units (e.g., physically different computers) or integrated.  illustrates an embodiment in which the DPI-C , the MC , and the MX-B  are implemented as separate units in the CDN  while  illustrates an embodiment in which they are integrated into a single unit. In , the DPI-C  and the MX-B  are implemented together in a single unit, while in  the DPI-C  and the MC  are integrated together.",{"@attributes":{"id":"p-0153","num":"0152"},"figref":["FIG. 9","FIG. 7"],"b":["124","120","184","180","194","182","180"]},"The hierarchy of media servers provides the CDN  the ability to handle the unique characteristics of MBB networks. For example, hot, warm and colder content (hot being most requested) may be cached at different levels of the cache hierarchy. In one or more embodiments, MX-A, MA-B, and MC may be assigned to keep local, regional, and overall content hotness respectively to optimize cache efficiency at various levels and balance request handling over the CDN network.",{"@attributes":{"id":"p-0155","num":"0154"},"figref":"FIG. 10"},"Referring to the table in , the MC  may keep a subset of PDP context data in a table, for example, indexed by the UE IP address in order to sync up with PDP status from GGSN  for those users handled by MC . In the first embodiment and the first mode of operation discussed above, the GGSN  may only push updates to MC  when there is any change in the PDP context. The MC  may maintain its PDP context table using current UE's IP address.","The embodiments of  may also be described or illustrated in terms of methods comprising functional steps and\/or non-functional acts. The following (and aforementioned) description and related flow diagrams illustrate steps and\/or acts used in practicing example embodiments of the present invention. Usually, functional steps describe the invention in terms of results that are accomplished, whereas non-functional acts describe more specific actions for achieving a particular result or step. Although the functional steps and\/or non-functional acts may be described or claimed in a particular order, the present invention is not necessarily limited to any particular ordering or combination of steps and\/or acts. Further, the use (or non use) of \u201csteps for\u201d and\/or \u201cacts of\u201d in the recitation of the claims\u2014and in the following description of the flow diagrams(s) for  is used to indicate the desired specific use (or non-use) of such terms.",{"@attributes":{"id":"p-0158","num":"0157"},"figref":"FIG. 11"},"When a UE, such as UE  in  or UE  in , requests to view a video from a video portal, such as youtube, hulu, amazon video etc, an HTTP message will be sent to the video portal. This requires that a DNS query and a corresponding TCP connection be established first between UE and video streaming server.","In various embodiments, a PDP context between the UE and the GGSN is established and\/or activated (step ). A PDP context stores the PDP context data for the requesting UE including. In one or more embodiments, the PDP context includes the RAN side MX IP address, e.g., IP address of the MX-A from the side of the RAN  in . The PDP context may also include the standard parameters as described in .","Next, the UE transmits a HTTP GET REQUEST to the GGSN\/DPI through the RNC\/IWF (messages  and ). The GGSN\/DPI node processes the received HTTP GET request. The DPI may look for certain signature of the HTTP request such as destination IP address and port#, and compare them with a pre-stored list of the OTT signatures to determine if this request is to fetch a OTT content. For some OTT sites, the signature analysis may involve more than a 5-tuple analysis and real DPI of HTTP header parameters analysis may be required, which requires a different type of signature.","In the flow diagram, it is assumed that this request matches the signature stored at the DPI (DPI determines that the request is OTT content). The DPI forwards this HTTP GET request to DPI-C (deep content URL DPI) via an IP connection between the DPI and the DPI-C function (message ). DPI will not change anything on this HTTP GET request message. In some embodiments, this forwarding may be implemented via Generic Routing Encapsulation (GRE) tunnel or Web Cache Communication Protocol (WCCP).","Next, DPI-C decides whether the content is cacheable content. The DPI-C function receives the forwarded HTTP GET request from the DPI. DPI-C performs a deep URL and HTTP header analysis to try to match the stored signatures at DPI-C function with the forwarded message. The required DPI-C signatures and algorithms may vary depending on the specific video portal sites to be handled (for videos such as Youtube, BBC, Hulu, etc.) and\/or software download sites (for large files such as windows updates, etc.). In one or more embodiments, the DPI-C focuses on HTTP message type, UserAgent while other parameters may be included in various embodiments.","In the illustration of , it is assumed for this flow the initial video portal media request (as with most other video sites) does not match the signature described above (i.e. DPI-C determines the content is not cacheable). For example, this request may lead to an HTML page on which a media player will be initialized and the media player will initiate a separate request to GET the video file. The DPI-C forwards this request unchanged towards the BG (or on-path routers) in the MBB Packet Data Network (PDN) and the HTTP request continues on its journey towards the Youtube server (message ).","After several additional HTTP message exchanges, the DPI receives another HTTP Get Request from the UE, determines it is OTT content, and forwards it to DPI-C (messages , , ). This time, the GET request comes from a media player (e.g., a shockwave player). The GET request may contain a signature that matches the stored signatures at DPI-C. Therefore, the DPI-C decides that the content is cacheable content.","Next, the DPI-C informs the MC regarding its evaluation that the content is cacheable. In various embodiments, as illustrated in , the DPI-C may run on either MX-B, or MC, or as a stand-alone DPI-C box, depending on the traffic dimensioning profile of the operator. For this discussion, we assume that the DPI-C, MX-B and MC are interconnected and routable at IP level so that the internal connections and forwarding among DPI-C, MX-B and MC are not detailed here. If the DPI-C runs on MX-B and for those requests that need to be served by the CDN, the request messages are forwarded from the MX-B\/DPI-C to the MC because the MC selects the media server (MX) to serve any given request.","The CDN has to be involved in serving this request after the DPI-C determines that the request is cacheable content and the MC has received the HTTP request from the DPI-C. In one or more embodiments, the MC, which is located in the CDN, performs the following set of MBB network specific tasks for selecting the appropriate caching media server (MX) for serving this HTTP request.","As discussed above, the MC stores a subset of the PDP information it gets via Gmc (a RESTful control info API to GGSN, see ). In various embodiments, the MC may use different alternate methods to determine which MX-A is in the PDP path serving the current UE.","In one embodiment, location information such as router area identity or service area identity (RAI\/SAI) may be used to select the media server. For example, a RNC is selected based on the RAI\/SAI, for example, using a table that has a mapping between RNC and RAI\/SAI. The location of the media server is decided from the RNC. The MC may store a MC table comprising all RNC-RAI\/SAI mapping.","In an alternative embodiment, UE IP range and mapping to RNC may be used if there is such a deterministic relationship. In a further alternative embodiment, RAN Side MX-A IP Address, which is an optional parameter to be added in the PDP context at GGSN is forwarded to MC during initial PDP setup or any subsequent changes of parameters. In a further alternative embodiment, RNC IP address or ID is obtained via communication between GGSN and SGSN, and MC keeps a mapping table between RNC IP\/ID and its local MX-A IP.","The MC selects a media server from a hierarchical set of media servers as described in . The method for this selection will be further described below. As part of the CDN MX cloud, the MX's keep status and heart beat with the MC's (in the MC cloud) so that the loading condition and availability of the MXs is instantly known at the MC.","In one embodiments, the MC may decide to redirect the current request to one of the many MX-As (RAN side MX-A's, as UE relocates\/roams across RNC's. In an alternative embodiment, the MC selects one of several MX-B at the GGSN level, or one of MX-C's at the one of the packet data network (PDN) peering points or BGs level (as illustrated in ).","In various embodiments, the policy and\/or heuristics for determining the best serving MX can be done in several ways.","In one embodiment, the MC may have a policy of always rounding to the current serving MX-A for a given UE (i.e. IWF\/MX-A on the UE's PDP path), unless the MX-A is overloaded. As the UE travels across RNC's RAIs\/SAIs, the serving MX-A may change depending on scenarios of the relocation. This is further discussed below under roaming\/relocation. Under this policy, the MC always picks the current serving MX-A. This is further discussed under handling of policies.","In an alternative embodiment, the operator's may have many CDN request serving policies (as part of the B2B and B2C services under traditional CDN implementation). Likewise, they can introduce OTT specific request routing policies via the same scheme. These schemes may take the form of either a set of policies provisioned (statically or dynamically) to the MC's via CDN's Network Operation's Center (NOC) or via configuration tables downloaded to the MX's, or both. When there is a cache miss at a serving MX-A, the local configuration table may be configured to go up the cache hierarchy to try to obtain the requested content or to consult the MC for advice as one of the entry in the configuration table.","In various embodiments, after selecting the MX for serving the UE, the HTTP GET request is redirected to the serving MX-A for this UE (messages , , , , ). In one or more embodiments, the redirection to MX-A is performed as described below.","The MC or DPI-C constructs and sends a redirect message to the UE. The MC or DPI-C constructs an HTTP 302 (or HTTP 303 redirect) message with destination IP as UE, and source IP as video portal server IP address (i.e., destination of current HTTP get request that is being processed). The URL will be augmented with the original service URL which is useful for MX-A to retrieve content in cache miss scenarios. Since the MC\/DPI-C and the GGSN\/DPI has existing TCP connection, the MC can simply forward this fake HTTP 302 message to GGSN\/DPI (as message ) which will naturally route the request to the destination UE under that UE's existing TCP connection with the media portal server (message  and ). This assumes that the TCP sequence # matches with the media portal side by analyzing it at the DPI function.","If the above redirection is not possible or not easily done, in an alternative embodiment, the TCP connection between the UE and media portal server is broken (forcibly disconnected) and a TCP proxy is set up at DPI-C with two separate of TCP connections. A first connection is set up between UE and DPI-C via GGSN\/DPI and a second connection is set up between DPI-C and the media portal server via BG.","Using above method, the UE receives a HTTP 302 (or 303) redirection message from the DPI-C\/MC. The UE will attempt to contact the new URI\/IP address which points to the serving MX (MX-A) connected to the RNC and IWF. The UE transmits a HTTP GET to the RNC\/IWF (message ).","The RNC\/IWF receives the UE HTTP GET and forwards it to the media server MX-A. In various embodiments, this may be performed using one of the following embodiments.","In one or more embodiments, if an IWF is embedded inside the RNC, then the IWF function will attempt to open GTP-U messages' user data to look for the destination IP address of the UE communication. The message is assumed to be destined for the serving MX-A connected to the RNC\/IWF if the destination IP address maps to a pre-stored IP table at the RNC\/IWF. This pre-stored IP table needs to be provisioned into all of the RNC\/IWF's as the MX-As are deployed into the RAN network and the RNC\/IWF has to repackage the GTP-U message into an HTTP\/TCP\/IP message to forwarding to the MX-A.","Alternatively, in another embodiment, IWF may be a separate box outside of the RNC on the IuPS interface path. The IWF transparently passes through all of the RANAP or GTP-C messages between RNC and SGSN. In contrast, IWF will intercept the GTP-U messages and open the user data to screen for destination IP addresses. If there is a match with the IP address pre-stored in the IP table, then IWF function shall repackage the message and forward it to MX-A connected to it.","MX-A receives the HTTP GET, which is the UE's HTTP request (as redirected by the MC) (message ). Now that MX-A has received the UE's HTTP request (as redirected by the MC), MX-A perform the following HTTP request processing in various embodiments.","MX-A generates an index to represent content being served. MX-A parses the HTTP request for the URL and other pertinent information to derive an index key for the content. The URL construction for video portals does not follow any standard and changes frequently. In various embodiments, any common identification scheme may be used as long as it produces a unique ID for each given content file. For example, URLs may be different but the content identification portion may still be the same. Therefore, in various embodiments, the content identification portion may be extracted and used as an index key for the cached content file (hashing may be required). Further adjustments may be required for adaptive HTTP delivery because MX-A sees a large number of small video segment files.","A unique file name is generated at MX-A. The MX-A derives a unique content\/file ID from the URL of the HTTP get request. This unique URL portion will be used to create a unique hash key, which may be used to locate the content\/file in MX-A cache system. This may not be 100% reliable and may change over time because the content of the media is OTT. Therefore, two requests for the same content\/file may be mapped to different file ID, which may create multiple copies of the same content\/file. Two requests for different content\/files may, in some instances, be mapped to the same content.","The data is retrieved from the cache and transmitted to the UE if MX-A finds it in the MX-A cache (messages  and ). If there is a cache hit, then MX-A will attempt to serve this file to the UE according to the UE request. In various embodiments, CDN media adaption (transcoding, transrating, file format adaptation, etc.), PCRF QoS oriented treatments (QoS guarantees and limiting\/capping of bandwidth based on user or rating group, etc.) may be applied. This is further discussed with respect to handling of policies. After applying media adaption as necessary the MX-A sends the first HTTP response to the UE with media data. This is done via the GTP-U routing capability of the RNC\/IWF node through the existing GTP-U tunnel between UE and the GSN, using the correct GTP-U sequence # kept at RNC\/IWF. IWF function needs to keep the sequence # by itself if IWF function is a standalone node separated from the RNC on the IuPS interface, while the combined RNC\/IWF function does not require duplication of this GTP handling function in order to route the MX-A to UE messages into the UE's existing GTP tunnel.","In various embodiments, after the session with UE terminates, a log is computed and transmitted to CDN for various operations such as accounting, charging, analysis, etc. Media delivery from the MX-A to UE continues until the session ends, after which case, MX-A generates delivery log(s). These delivery logs are sent to the Media Data (MD) Cloud of CDN network for processing as described below regarding Charging, Report and Analytics.","However, if the requesting data is not in the cache of MX-A, i.e., there is a cache miss, MX-A follows its stored policy rule (existing CDN\/MX function) to try to find the content from the next cache server in the cache hierarchy or the origin server (media portal server, whose URL is in the 303\/302 redirect message). GGSN\/DPI receives the message  from MX-A. DPI and DPI-C recognizes that routing for this HTTP request (message ) from MX-A is not a UE request and forwards it to the media portal server (message ). This avoids the possibility for an infinite loop to MC again. The media portal server sends the data requested, which is received as an HTTP response (message ) at the GGSN\/DPI. The GGSN\/DPI forwards the data through the GTP tunnel to the MX-A (messages  and ). MX-A may cache the content in its caching system and serve the data to the UE (message ).","However, in some embodiments, the MX-A may also contact MC to find out the location of the content in the CDN network. For this fetch from the upper cache server(s), the MX-A may use the original user HTTP request URL (embedded in the redirect message from the MC), but over a new TCP connection to the upper cache server or origin server via the IP transport network as illustrated in .","Embodiments of the invention have several unique advantages. Using embodiments of the invention allows effective decoupling of Access Network and CDN network for OTT traffic caching. Embodiments of the invention enable deployment of layer3 based media server (media caching and adaptation) in a layer2 network, which is advantageously much closer to the end users without the usual complexity of layer2 DPI and decision making. Embodiments of the invention support a more centralized content level DPI (DPI-C) and decision making in a single CDN, which can serve both MBB and FBB, thereby avoiding including a DPI-C (content level) inside the access network. Embodiments of the invention may leverage a layered cache network to increase cache hit rate and reduce cache miss retrieval time. Embodiments of the invention also provide a hierarchy of cache (MS) backup among distributed MS servers in case of failure of any MS server. Embodiments of the invention support OTT, B2B and B2C services over MBB and FBB networks with a common, unified CDN with identical network configurations which greatly simplifies network deployment, management, and operations.",{"@attributes":{"id":"p-0191","num":"0190"},"figref":"FIGS. 12 and 13"},"In particular, the UE may roam across multiple networks during a session. Embodiments of the invention describe methods to enable caching during\/after roaming. Depending on the movement of the UE, different scenarios are possible. These are listed in  and illustrated in .",{"@attributes":{"id":"p-0193","num":"0192"},"figref":["FIG. 12","FIG. 13"],"b":["1","1211","2","1212","1","1221","2","1222","1","1351","2","1352","1","1361","2","1362"]},"Referring to , in the first scenario (I), the UE moves from a first base station (NB ) to another base station (NB ) within the same RAN . However, NB  and NB  are controlled by the same RNC . Therefore, this relocation is transparent to IWF  and the MX-A  because MX-A  and IWF  are shared through the common RNC  (not shown in , see, e.g., A). Consequently, no modification is necessary.","Referring to , in the second scenario, UE moves from a first RNC (RNC ) to a second RNC (RNC ). This scenario has several handling options.",{"@attributes":{"id":"p-0196","num":"0195"},"figref":["FIG. 14","FIG. 14A","FIG. 12","FIG. 14B","FIG. 13"]},"In a first embodiment, the session may be broken and MC  redirects the request to a new MX-A (MX-A ), which is local to RNC . Therefore, in this embodiment, standard 3GPP procedures are followed for relocation and the session between MX-A  and UE  may break. The UE auto-retry scheme (present in most media player) will retry the HTTP GET request through the new RNC , which forwards the request to the MC . The MC  redirects the request to the new MX-A  (local to the RNC ). The new MX-A  continues content delivery from there as described above. However, the media may restart from the beginning as opposed to where the UE was cut off.","In a second embodiment, the old MX-A  associated with RNC  continues to be used. A modified standard 3GPP procedures is followed, which suppresses the relocation procedure at SGSN . Therefore, old MX-A  continues to deliver to the UE  through old RNC \/IWF \u2192IuR\u2192new RNC \u2192new NB \u2192UE  until the session naturally ends. However, any new request from UE will be redirected to the new MX-A  serving via new RNC\/IWF. As mentioned above, the SGSN  is modified to implement this option such that it recognizes that there is ongoing delivery session between MX-A  and UE , and therefore, SGSN  does not issue a relocation request. Reconfiguration of RNC  and RNC  is required in order for them to forward the UE requests back to the old MX-A  in the old RAN  network.","In a third embodiment, the session is broken as in the first embodiment but due to smart buffer management, the UE  receives a smooth video without any breaking. As in the first embodiment, a standard 3GPP procedure is followed breaking the session. A special media player performs error concealment so that the user sees a smooth playback although redirection processes are implemented in the background. In one embodiment, the media player includes a smart buffer management with sufficient buffer size. In various embodiments, the media player also includes the ability to retry a non-responding HTTP request with a modified Byte Range parameter so that the media player at the UE will retry starting from where it left off. Since the UE is now in the new RAN  under the new RNC , the retry message will be captured by the DPI \/DPI-C \/MC , and the MC  redirects the request to the new MX-A . The rest of the delivery will continue starting with the Byte Range request from UE. Thereby, the UE avoids restarting the media from the beginning of the session.","In a fourth embodiment, the MC  is informed of the impending relocation and MC  and\/or MX-A  perform a mid-stream redirect using a smart session. Therefore, the MC  and\/or MX-A  are notified of an impending relocation (via SGSN  or RNC ). The MC  and\/or MX-A  perform a mid-stream redirect request to relocate the UE . This communication may be transmitted over the existing IWF \/RNC \u2192NB \u2192UE  or existing IWF \/RNC \u2192IuR\u2192RNC \u2192NB \u2192UE . The UE  media player is configured to support this mid-stream redirect request. The media player is configured to launch a request (with Byte Range starting from the current playback time code offset) to new MX-A  in response to the redirection instruction from the MC  and\/or the MX-A . In the mean time, the UE is receiving the playback from the media player's buffer and does not experience any interruption. The delivery from the new MX-A  starts before the player buffer is depleted, thereby offering a smooth playback experience to the user.","Referring to , in the third scenario, UE moves from a first SGSN (SGSN ) to a second SGSN (SGSN ). The handling for this scenario is similar to the handling of the previous scenario with some differences in the standard 3GPP messaging flow. Therefore, in various embodiments, the third scenario may be implemented by (a) breaking the session and redirecting to a new MX-A , (b) using the current (old) MX-A  until the session terminates, (c) using a smart session management procedure while breaking the session and redirecting to a new MX-A , or (d) using a smart session management procedure in combination with a mid-stream redirecting procedure.",{"@attributes":{"id":"p-0202","num":"0201"},"figref":"FIG. 15"},"Although described with respect to the third scenario III, the procedure described below may also be implemented in the second embodiment of the second scenario II.","The MX-A is only related to the packet data. Therefore, all the other signaling messages of the MBB network caching relocation procedure remain the same as the relocation procedure of 3GPP. The difference in packet data forwarding illustrated as dashed lines in the messaging flow diagram above. During SRNS Relocation procedure, packet data between old MX-A  and UE  are forwarded by source RNC  and target RNC  through LuR, which is the interface between the RNCs. This is illustrated in  as step \u2032 in which the packet data from the old MX-A  is transmitted to the source RNC . In step \u2032, the packet data from the source RNC  is transmitted to the target RNC  through IuR. In step \u2032, the packet data from the target RNC  is transmitted to the UE .","The above relocation scenarios (steps \u2032, \u2032 and \u2032 in ) may be implemented in different way in various embodiments.","In a first embodiment, the source RNC  and target RNC  are modified. In particular, the source RNC  is configured to forwarded packet data, whose destination is MX-A  address, to MX-A  in relocation state. The new RNC is configured to forwarded packet data, whose destination is MX-A address, to source RNC  in relocation state.","In a second embodiment, the target RNC  may use IP address of the serving MX-A  (old one) to route through the VPN\/IP transport network that connects all of the RNCs and PS core. In this case, each MX-A has a unique IP address in order for the routing to work.","Embodiments of the invention for implementing lawful interception will be described using .",{"@attributes":{"id":"p-0209","num":"0208"},"figref":"FIG. 16"},"In , the reference configuration is only a logical representation of the entities involved in lawful interception and does not mandate separate physical entities. This allows for higher levels of integration.","A Law Enforcement Monitoring Facility (LEMF) is connected to an Administration Function ADMF and two Delivery Functions DF and DF each having mediation functions. There is one Administration Function (ADMF) in the network. The ADMF interfaces with all the LEAs that may require interception in the intercepting network. The ADMF keeps the intercept activities of individual LEAs separate and interfaces to the intercepting network.","Together with the delivery functions, multiple activations by different Law Enforcement Agencies (LEAs) on the same target are hidden from the 3G intercepting control elements (ICEs). ICEs may be 3G MSC Server, 3G GMSC Server, P-CSCF, S-CSCF, SGSN, GGSN, HLR, AAA Server, PDG, MME, S-GW, PDN-GW, HSS.","The Administration Function and the Delivery Functions are each one connected to the LEMF via standardized handover interfaces HI, HI, HI, and connected to a telecommunication system (GSN, which may be a SGSN or a GGSN) via the interfaces X, X, and X. The ADMF is connected via the interfaces HI and X while DF is connected via HI and X and DF is connected via HI and X.","The messages sent from LEMF to ADMF via HI and from the ADMF to the GSN via the X interface comprise identities of a target that is to be monitored. The DF receives Intercept Related Information (IRI) from the network via the X interface and delivers the IRI to relevant Law Enforcement Agencies through the HI interface. The Delivery Function DF receives Content of Communication CC, i.e., speech and data via the X interface and delivers the CC to the LEAs through the HI interface.",{"@attributes":{"id":"p-0215","num":"0214"},"figref":"FIGS. 17-19"},{"@attributes":{"id":"p-0216","num":"0215"},"figref":"FIG. 17","b":["124","136","135"]},"To implement this embodiment, DPI  may include additional functionality to determine if a UE  is to be intercepted. The DPI  checks the UE request and determines if the UE request belongs to a PDP context with LI flag set (e.g., UE is a LI target). If the UE is a target, then DPI  will not forward the UE request to the CDN  for content deep packet inspection and assignment to a caching media server. Instead, the UE request is forwarded to the BG  or an on-path router so that this request is processed without caching using the GGSN .","To determine if the UE is targeted, the DPI  checks with the GGSN  for the PDP context using the source IP address as the index. As described above, GGSN  may interface with the LEMFs and may have the up to date information regarding the UEs being targeted. In some embodiments, only if the UE request matches the provisioned signatures, the DPI  checks with GGSN  for the LI information. This is because the DPI  forwards only those UE requests that match the provisioned signatures (see ).","DPI  and GGSN  may be a single unit or may be in separate units, for example, as described in . As described below, the location of the LI interception checking functionality may have architectural ramifications.","This information exchange is simpler if the GGSN  and DPI  are integrated in a single unit because the PDP context data is readily available and the mapping between UE's IP address and international mobile subscriber identity (IMSI) is easy as that data is also available from the GGSN . This option is shown in  as option A.","Alternatively, at least two embodiments are possible if the DPI  is a standalone function independent of GGSN .","In a first embodiment, a proprietary API may be constructed to fetch the PDP data using UE IP as index from the GGSN . This may be structured similar to the Gmc interface, which may either be a pull or a push model. If the DPI  is integrated with DPI-C , then the existing Gmc interface may be used.","In a second embodiment, DPI  may simply defer the checking to the DPI-C  and\/or MC . The DPI-C  and\/or MC  fetches the mandatory updated LI information from the GGSN , for example, through the Gmc interface. This scenario is illustrated with the reference label Option B in .","However, the embodiment described in  has some limitations because of the location of the interception point which is the location of the GGSN . Therefore, once a UE session is established through a MX-A , any updates to the LI flag has no impact on the ability to intercept the communication during that session. However, any new UE session request can be monitored after the UE has been targeted. In other words, UE's on-going session can not be monitored and only new sessions from this point on can be monitored. However, this limitation may be acceptable under most LI regulations; for example, it is acceptable for North America.",{"@attributes":{"id":"p-0225","num":"0224"},"figref":"FIGS. 18 and 19"},{"@attributes":{"id":"p-0226","num":"0225"},"figref":["FIG. 18","FIGS. 18A and 18B","FIG. 18A","FIG. 18B"]},"Referring to , two additional interfaces X\u2032 and X\u2032 are required for implementing this embodiment.","In this embodiment, the GGSN  is configured to notify the serving MX-A  of any updates to the LI requests from the LEAs. The MX-A IP address is regularly maintained in the PDP context as the requirement of Gmc interface. Therefore, the GGSN  notifies the serving MX-A  of any new activation of LI for any UE, which is identified by UE IP. GGSN  also notifies any deactivation of the LI target UE. Therefore, the MX-As store a table of list of all LI target UE's. In various embodiments, the MX-A  is configured to have the ability to perform interrogation, which is described below. In particular, the MX-A  is configured to perform a mirrored delivery of any packet data to and from the UE's flagged as a target.","In various embodiments, the interfaces X\u2032 and X\u2032 may be implemented in different ways. In various embodiments, the interface X\u2032 may be used to communicate control messages from the GGSN, for example, after ADMF makes a control decision. The interface X\u2032 may be used to communicate media data with the GGSN, for example, data during interception.","In one embodiment, GTP-U\/GTP-C message tunnel between RNC  and GGSN  may be implemented, for example, using the IWF .","In an alternative embodiment, the IP transmission that connects the MX-A  and CDN  may be used. However, using the IP transmission, a VPN or IPSec has to be used for security reasons. Further, GGSN has to be configured to correctly identify that the packet data flow over the IP connection from MX-A  is a valid UE traffic and forward to DF.","The LI Message Flow for the LI framework described above with respect to  will now be described using . The messages , , , , and  refer to messages that are compliant with 3GPP standards (TS 3GPP 33.107). Messages , , and  are added herein in accordance with embodiments of the invention.","First, the target activation procedure will be described. The ADMF sends Target Activation  (target ID, report type, etc.) to GGSN. The GGSN sets a flag for intercepted target in the PDP context. GGSN responds the result to ADMF.","GGSN checks if the intercepted target has an activate PDP context. If the target has an active PDP context, the GGSN notifies MX-A (target ID, GGSN IP, etc.) to monitor this target (message ). If this target does not have an active PDP, the GGSN will wait until the next time this target establishes an active PDP context.","Next, the target deactivation procedure will be described. ADMF sends Target deactivation (target ID, etc.) to GGSN (message ). GGSN clears the flag for the intercepted target. GGSN responds to ADMF acknowledging the deactivation (message ). GGSN notifies MX-A (target ID, etc.) to clear its monitoring flag for this target (message ). MX-A clears the flag for the UE being deactivated.","Target interrogation procedure will next be described. ADMF sends Target Interrogation (target ID, etc.) to GGSN (message ). The GGSN responds the result to the ADMF.","Intercepted communication content report procedure will next be described. UE receives requested packet data from MX-A (message ). MX-A will also report a packet data (comprising target id, content of the data packet sent to the UE, GGSN IP, etc.) to the GGSN if this UE is flagged to be intercepted (message ). In various embodiments, the MX-A outputs a mirrored delivery stream towards the GGSN that matches the data being sent to the UE. The GGSN reports the intercepted packet data (e.g., comprising target id, content, GGSN IP, etc.) from MX-A to DF.","In an alternative embodiment, MX-A transmits interrogation (X) directly to the DF instead of using GGSN to relay the interrogated packet data stream. To implement this procedure, MX-A has to be configured to transmit interrogation with the following X message header information. The X message header comprises target identity; correlation number; an optional time stamp; optionally a direction (indicating whether T-PDU is mobile originated (MO) or mobile terminated (MT)); and the target location (if available).","However, these parameters are typically in the GGSN and therefore a direct connection to DF from MX-A may be less practical.",{"@attributes":{"id":"p-0240","num":"0239"},"figref":["FIG. 19","FIGS. 19A and 19B","FIG. 19A","FIG. 19B"]},"Unlike the previous embodiment, in this embodiment, a media controller MC interfaces between the MX-A and the GGSN. Referring to , three additional interfaces X\u2033, X\u2032, and X\u2033 are required for implementing this embodiment.","Referring to , the MC  is the interface for the GGSN  instead of the MX-A . The Gmc interface between the GGSN  and the MC  is utilized. Therefore, the MX-A  is notified from the MC  not directly by the GGSN . This embodiment further simplifies the interaction between the access networks and the CDN network. This is because the Gmc interface already provides the MC  with updated LI notifications (LI activation, deactivation etc. via the PDP context update). Consequently, the X\u2032 interface for passing control information regarding the LI activation, deactivation etc. is not needed. The X\u2032 interface is the interrogation packet data flow between MC  and GGSN  and is provided for the target LI UE. The X\u2033 interface between the MC  and the MX-A  may be used for transferring control information regarding LI activation, deactivation etc.","The LI Message Flow for the LI framework described above with respect to  will now be described using .","As described above, the ADMF may communicate to the GGSN regarding activating a UE as a target (step ). The target activation is communicated to the MC (step ) through the Gmc interface, and to the MX-A through the X\u2033 interface (step ). Similarly, a target deactivation may be communicated to the GGSN (step ), which is then communicated to the MC (step ), and forwarded to the MX-A (step ). Next, a target interrogation may be requested by the ADMF (step ). The MX-A may initiate a packet data transmission with a UE that is being targeted (step ). The MX-A generates a mirrored stream that matches the packet data communication with the UE. The MX-A transmits the mirrored packet data to the MC through the interface X\u2033 (step ). The MC forwards the mirrored packet data to the GGSN (step ). The GGSN forwards the intercepted packet data received from the MC to the DF (step ). In an alternative, the MX-A has a direct interface with DF avoiding going through the MC and GGSN (step ).","This embodiment advantageously allows lawful interception even during roaming if the serving MX-A is changed to another MX-A (e.g., relocates under same SGSN). This is because MC is aware of this change and therefore redirects the new serving MX-A to continue with the lawful interception. However, this embodiment may fail if the UE relocates under a new GGSN or if the MX-A fails.","In this embodiment, unlike the prior embodiment, the interface X\u2032 between MC and GGSN is a media path and not a control path and may have some limitations. Therefore, in some embodiments, the intercepted packet data from MX-A may be directly sent to the GGSN as described in the prior embodiment.","In another alternative embodiment, the serving MX-A performs a mid-stream redirect to the MX-B, which is deployed at the GGSN level, so that all traffic will be monitored and sent to DF from GGSN. In various embodiments, the UE does not detect any noticeable changes to the current session although the serving media server is being moved up to a media server situated at a higher level in the network. This may in turn depend on how the mid-stream redirection is done by the MX-A and the types of media and delivery protocol (assuming HTTP delivery of video content, the availability of the exact same content at MX-B, and the UE client's support for mid-stream redirect), and the ability to start at MX-B at the point of redirect in the video.","It is important to note that these interrogation processes are very resource intensive and security sensitive operations. Therefore, in some embodiments, it may be advantageous to combine the embodiments described in . For example, the embodiment of  may be used for normal handling while the embodiment of  and\/or  may be used in extreme situations. For example, LEAs may request that all sessions with a few selected target UE have to be intercepted. In such rare situations, the embodiments described in  may be deployed. This will ensure optimizing the resource consumption without compromising the ability to lawfully intercept communications.",{"@attributes":{"id":"p-0249","num":"0248"},"figref":"FIG. 20"},"In various embodiments, charging and billing may include both post-paid and prepaid charging\/billing support. The following diagram illustrates the context for billing and some additional back office functions.","Embodiments of the invention include offline billing and real time charging, which are described further below.","An embodiment of the invention relating to offline billing will be first described. A media data (MD)  in the CDN  collects usage information and reports to the Billing Center (BC)  after a certain number of pre-determined minutes (such as 10 minutes and it is configurable).","In accordance with an embodiment of the invention, a filtering algorithm may be used. No control may be needed for subscribers on a flat rate plan (i.e. unlimited data plan). In contrast, for other subscribers, whose bills depend on the amount of data used, actual monitoring may be dependent on the type of subscriber plan.","Some subscribers may be allowed to use traffic even if they exceed their contracted limits. However, such traffic called overage traffic is billed differently. Embodiments of the invention enable hot billing for subscribers with tiered traffic subscription packages. In accordance with one or more embodiments, the MD  collects usage information from all MX-A nodes and reports to BC  in every pre-defined number of minutes. Thus, session for any user equipment that exceeds the pre-allocated limit or other limits may be terminated using hot billing. Hot billing requires continuous communication of user activity to the BC . The overage of subscriber traffic usage is considered bearable for this type of billing.","Alternatively, for subscribers without any contract (prepaid) or when an operator may like to avoid the overage of traffic from these subscribers, real time charging may be required.","Therefore, embodiments of the invention relating to real time billing will be described.","The GGSN  notifies the MC  via the Gmc interface that a new UE's PDP includes an online charging gateway (OCG) flag indicating that real time charging is needed for this particular UE. The MC  checks its local PDP info for OCG flag before redirecting this UE's request to a MX-A . In accordance with an embodiment of the invention, if the OCG flag indicates the need for real time charging, the MC  does not redirect the request to the MX-A . Instead, the MC  forwards the request to the BG  or an on-path router so that this request will be charged in real time using the GGSN . Hence, under real time charging no caching is performed.","Embodiments of the invention relating to reporting and analytics will next be described.","The report generation for non-billing purposes such as NOC\/operational usage, network optimization, and tuning of DPI signature\/algorithms can be served from the MD . In various embodiments, the MD  may be a cloud based Online Analytics Process (OLAP) that processes logs and operational data from the CDN network.","In accordance with an embodiment of the invention additional data (MBB data) may be collected because of the interaction between MBB network and the CDN . Such additional data may include users' PDP context data, e.g., stored at MC , additional PCRF data (some of which is already available from the Gmc interface), direct interface from PCRF  to get additional QoS policy rules and parameters, and data from the AAA  and SUR  functions. Interfaces with AAA , SUR , PCRF  may be added and supported at MD  to access these additional data. Embodiments of the invention also include interfaces between AAA , SUR , PCRF  and MD . Using these additional data, and further processing, the network operation may be able to better understand the OTT traffic (or B2B, B2C traffic etc.)","Embodiments of the invention relating to QoS approaches will be described using the following methods and using .","QoS policy is an important consideration for communication networks. This is particularly so for mobile broadband networks than fixed broadband networks. This is because the resources in the mobile infrastructure is generally more limited and expensive compared with FBB network infrastructure, for example the air interface and remote backhaul. Also the revenue differentials from a VIP subscriber vs. a low end subscriber can be 100\u00d7 or more in MBB networks requiring differential treatment for these higher paying subscribers.","Referring to , in a first method, the MC  receives QoS\/PCC parameters and uses it to provide differential treatment to users. At the MC , many QoS\/PCC parameters may be passed on and routinely updated through the Gmc interface. For example, QoS\/PCC parameters such as charging based on user profile, charging based on service type, charging base on location, charging based on congestion, charging based on time range, charging based on user's accumulate usage, charging based on terminal type may be available at the MC .","The MC  may use the above information and allocate or select the appropriate media server (MX-A, MX-B, or MX-C) according to these QoS\/PCC parameters and the conditions of the MBB and CDN networks.","In one embodiment, the Quality of Experience (QoE) for the UE may be improved by combining the request routing policy\/heuristics with UE profile and\/or QoS parameters from PCRF  or the GGSN . For example, for VIP users, the PDP context data subset at the MC  may indicate that the UE making the UE request has VIP status, and deserves special request routing treatment. For example, such VIP users may be always routed to the serving MX-A with priority, for example, with further (implict\/explicit) instructions to serve UE with the highest bit rate (when multiple available) that matches the guaranteed throughput in the PS\/RAN link. Similarly, if a UE is not a VIP user, these requests may be forwarded to other media servers, e.g., MX-B  or MX-C (at peering point\/BG) or at service provider (SP) site to retrieve content and with lower throughput in the PS network to reserve resource for the VIP users.","In a second embodiment, the MC  directly retrieves information from PCRF and uses this for serving UE over both MBB and FBB networks. In this embodiment, the MC , using a direct interface to the PCRF  over Diameter (a AAA\/Radius like interface) over IP, obtains policy rules from PCRF . This allows MC to obtain additional policy rules that may not be available from the private GGSN Gmc interface. For example, PCRF  may control both the MBB and FBB QoS policy rules, and therefore, MC  may be able to obtain a common policy rules for a particular user. Thus, in this embodiment, CDN  works directly between MBB and FBB with a common set of PCRF nodes.","In a third embodiment, the MC  forwards a subset of QoS data to the serving media server (e.g., MX-A ), which then uses that information to differentially serve the UE.","QoS policy parameters and rules may also be forwarded from the MC  to other functional components such as MX-A , MX-B , MX-C, MD  (for analytics), and\/or media storage cloud for B2B and B2C services. These components may react differently based on the forwarded QoS parameters and rules, the current conditions of the function\/node, and other related environmental parameters to offer the appropriate QoS per UE type, etc.","One of the purposes of forwarding the QoS rules and parameters to the media servers is that these media servers have the ability to adapt to the changing requirements of any delivery at any time. For example, methods such as bitrate adaptation (with cached multi-rates files\/segments), on demand transrating at MX, or changing of media file format or characteristics (such as resolution, bitrates, mobile screen dimension, media profile, etc.) may be performed on the fly to serve the UE with the most appropriate QoS demanded by policy entities such as PCRF .","Embodiments of the invention also include configuration of the media player and\/or media server MX-A or MX-B etc so that the user may be served more effective offering advanced features such as fast start, intelligent buffer control for smooth playback, HTTP rate capping, mid-stream redirect to another media server, recovery from a media server failure, and\/or collection and delivery of QoS data from the media player to the CDN  for improving operation and accumulating business intelligence.",{"@attributes":{"id":"p-0271","num":"0270"},"figref":"FIG. 21"},"As described in various embodiments above, each MX-A serves a large number of live subscribers. Therefore, failure of a MX-A can have a critical impact for many users unless mitigating procedures are in place.","A first embodiment of failure recovery will be first described. As illustrated in , IWF  is configured to immediately detect if a MX-A  fails or stops serving the UE  (see line  in ).","The IWF  either keeps a heart beat with MX-A  or sets a timer every time IWF  forwards a message from UE  to MX-A . If MX-A  does not respond after the heart beat timer or the message response timer expires, the IWF  is configured to forward this UE request (or a UE retry message) to the serving MC  on the PS path going through DPI  and DPI-C  (line  in ). DPI  and DPI-C  are configured to forward this message to the MC , which also may have a broken heartbeat with the failed MX-A . The MC  selects a different media server such as MX-B , for example, which may likely be the one connected to the GGSN \/DPI \/DPI-C , and redirect the UE request to the new media server MX-B . The UE  now continues getting media delivered from the MX-B  (line  in ).","The above described method requires enhancement at the IWF  and\/or RNC  to detect failure of the MX-A  and to correctly route the request to MC .","A second embodiment of the failure recovery method will be next described. This embodiment illustrates a simplification of the above embodiment in that the RNC  and\/or IWF  are not modified. In this embodiment, the MC  detects the failure of the MX-A , for example, because of a broken heart beat with MX-A . The MC  selects a new media server as described above, for example, MX-B  may be selected. The MC  constructs an HTTP direct message (HTTP 302) destined to each of the currently impacted UEs while faking the source address as the IP address of MX-A . This is possible because the MC  conveniently has a list of the active PDP with IP addresses of UE's. The MC  transmits these messages to the respective UEs. When each of these message from MC  is received at the IWF \/RNC , the IWF \/RNC  simply forwards them to the designated UE because the message comes in via the correct GTP-U tunnel and with the correct tunnel end point identifier (TEID). The UE's receiving such a message will contact the new media server, e.g., MX-B , for delivery.","The first and the second embodiments described above may have some limitations. For example, the user's media session may be abruptly terminated and a new session may start from the beginning of the media clip when the new media server MX-B  starts streaming. In embodiments using HTTP adaptive streaming the media player may request the new feed from the point of failure of the previous session and therefore avoid the user having to see the media clip from the beginning. However, this issue may be difficult to avoid in the first and the second embodiments of the invention using regular HTTP progressive download.","The following third embodiment is proposed to at least overcome the above described limitations of the first and the second embodiments for failure recovery. The third embodiment described below is an enhancement to the first and the second embodiments.","In accordance with this embodiment, the media player may be enhanced to handle the transfer of the session from the first media server (MX-A ) to another media server (MX-B ). When the media player at UE  detects that it is being redirected to another media server in the middle of a playback session (which means interruption of service), the media player includes additional information regarding the session. For example, the media player may modify the HTTP Get request to the new media server (e.g. MX-B ) with a BYTE RANGE request starting from the current time code (TC) or byte range. For HTTP adaptive streaming, simply fetching the current segment (a few second worth of content) is sufficient, and the rest will continue coming from the MX-B .","Embodiments of the invention also include methods for minimizing degradation of user experience if even the backup media server (MX-B ) fails. For example, in accordance with an embodiment of the invention, in case the backup media server MX-B  also fails, the first, second, and\/or third embodiments described above may be implemented. For example, the IWF  or the MC  may detect the failure of the MX-B  and reallocate the UE request to a new media server, for example, a MX-C connected to the BG  or core routers at peering points of the operators' PDN. Alternatively, the MC  may redirect to other MX-B's in the CDN .","Some of the network functions and components described above that require re-configuration and provisioning are described below. The following discussion may not include all changes in configuration that may be required in implementing embodiments of the invention.","In one or more embodiments, interworking function and radio network controller may need to be configured to recognize a local MX-A that the IWF may connect to, for example, based (such as an IP range). The IWF\/RNC may need to be configured to recognize failure of the local media server, for example, by the use of timers etc as described above. The IWF\/RNC may need to be configured to recognize the IP address of the media controller so as to be able to forward UE request when the local media server fails. The IWF\/RNC may need to be configured with a mapping of IP address and Tunnel Endpoint Identifier (TEID) for the UE's being served. The IWF\/RNC may need to be configured forward new RNC data packet coming from IuR to IWF\/MX-A, e.g., to enable continued streaming roaming\/relocation or media failure.","In one or more embodiments, the GGSN may need to be configured to recognize IP addresses of the media controller. The GGSN may need to be configured to recognize MX-A IP addresses within the GGSN scope. The GGSN may need to be configured to recognize DPI if the DPI queries the GGSN for PDP context information for decision making. The GGSN may need to be configured to send PDP context updates (creation, modification, and deletion) to the serving MC. The GGSN may need to be configured to maintain the current serving MX-A for any given PDP context (UE).","In one or more embodiments, the SGSN may need to be configured to suppress termination during\/after relocation so that the old MX-A may continue to delivery the media stream to the UE. In some embodiments, SGSN is not changed unless we use it to pass on RNC IP or ID via GTP extension to pass that info to GGSN and placed in the PDP context field as a custom parameter.","In one or more embodiments, the local media server (MX-A) in the layer2 access network may need to be configured with the GGSN IP address to which it needs to connect for LI related features. MX-A may need to be configured with CDN default content retrieval algorithms and any dynamically provisioned updates to the MX-A from the CDN's network operations center. This configuration file may be used when there is a cache miss in serving a UE request. MX-A may need to be configured to send MX-A local logs to CDN's MD server(s), for example, for billing, charging, analytics. For lawful interception, MX-A may need to be configured to recognize the DF in case the method with direct connection to DF is used. In one or more embodiments, MX-A may need to be configured to receive PDP related info to support X interface towards DF such as target identity, correlation number, an optional time stamp, optionally a direction indicating whether transfer protocol data unit (T-PDU) is mobile originated or mobile terminated, and the target location (if available).","In one or more embodiments, the media controller may need to be configured with the GGSNs IP addresses it is serving, each media controller may serve multiple GGSNs. The media controller may need to be configured to recognize higher level media servers (MX-B) and DPI-C functions and their IP addresses for forwarding messages. The media controller may need to be configured with a table of the static mapping between RNC IP\/ID and its local MX-A IP address. The media controller may need to be configured to with PCRF's IP addresses.","In one or more embodiments, the media data function may need to be configured to recognize the Billing Server (BS) IP addresses and to be able to communicate with BS over a RESTful interface over IP. The media data function may need to be configured to recognize PCRF IP addresses, AAA server IP addresses, and SUR server IP addresses.","In one or more embodiments BS, PCRF, AAA, and SUR may need to be configured to recognize CDN components such as MD, and MC. In one or more embodiments, DF used in lawful interception may need to be configured to recognize the MX-A IP addresses if the method of direct MX-A to DF option is used.","Embodiments of the invention described above may be applied to other types of networks besides MBB networks.","In various embodiments, the MBB network may be 2G, 2.5G, 3G, 4G or higher cellular wireless network. Embodiments of the invention may be applied to other wireless networks such as WiMAX (or higher) networks. Similarly, embodiments of the invention may be applied to FBB networks including digital subscriber line (XDSL) networks, cable broadband networks, fiber to the homes\/premises (FTTX) networks, power line communication (PLC) networks, as examples. Wireless networks such as WiMAX and other fixed broadband networks or limited mobility networks may have similar pressures resulting from the OTT traffic, which may be reduced using embodiments of the invention described above.",{"@attributes":{"id":"p-0291","num":"0290"},"figref":["FIG. 22","FIG. 22"],"b":["2310","1","2","3","2320","2350","2330","2320","2321","2310","2321","2322","2370","2322","2336","2337","2337","2330","2337","2361","2350","2381","2380"]},"In accordance with embodiments of the invention, a CDN  having a DPI-C  decides if a UE request involves a cacheable content and then a MC  in the CDN  assigns a media server to serve the UE . The MC  may assign a local media server such as MX-A  in the access network . In one embodiment, the MX-A  is coupled through an IWF  as described in various embodiments so that MX-A  becomes the serving media server, and performs the caching functions described above in various embodiments. As described in various embodiments above, the DPI-C  may be integrated with the DPI , MX-B , and\/or MC .",{"@attributes":{"id":"p-0293","num":"0292"},"figref":["FIG. 23","FIG. 23"],"b":["2410","1","2","3","2420","2450","2430","2420","2421","2410","2421","2422","2470","2422","2436","2437","2437","2430","2437","2461","2450","2481","2480"]},"In accordance with embodiments of the invention, a CDN  having a DPI-C  decides if a UE request involves a cacheable content. Then a MC  in the CDN  assigns a media server to serve the UE . The MC  may assign a local media server such as MX-A  in the head-end . In cable broadband networks (e.g., used over CATV networks) the cable head-end may be a good location for MX-A . In one embodiment, the MX-A  is coupled through an IWF  as described in various embodiments so that MX-A  becomes the serving media server, and performs the caching functions described above in various embodiments. As described in various embodiments above, the DPI-C  may be integrated with the DPI , MX-B , and\/or MC .","As described above, embodiments of the invention include PLC networks. In PLC networks, a local media server (MX-A) may be deployed in the low voltage or medium voltage head-end units for PLC network.",{"@attributes":{"id":"p-0296","num":"0295"},"figref":"FIG. 24"},"The media device  includes a receiver , which may include a wireless antenna receiver and\/or a wired network connection port for receiving the media content, for example, if it is stored at a remote location. The media device  also includes a memory , which may include both a non-volatile memory and a volatile memory. In one embodiment, instructions for performing the operations described with respect to  may be stored in a non-transitory storage medium such as a magnetic storage medium or a solid state storage medium in the memory .","The media device  may include further I\/O devices  for inputting and outputting data. For example, the I\/O devices  may include an optical disc such as a laser readable medium, for example, a compact disc reader, a blue ray disk reader, and\/or digital video reader etc. In one or more embodiments, the instructions for performing the operations as described in  may be stored in an optical disc, which is a non-transitory storage medium.","The media device  may also include a display  and a transmitter  for transmitting the compressed data. The transmitter  may include plurality of wireless antennas and\/or a wired port. The transmitter  and the receiver  can be combined together in some embodiments.","The media device  includes a processor  configured to execute the instructions for performing the operations described with respect to . The processor  may comprise a single processor or a plurality of processors.","In various embodiments, the media device  may be a L2 node such as radio network controller and\/or eNB, IWF, L3 node such as a gateway server such as GGSN, SGSN, media server including MX-A, media controller, media data function, DPI, DPI-C, PCRF, CG, DSLAM, BRAS, SRC, QAM, as well as other units described above in various embodiments (see, e.g., ).",{"@attributes":{"id":"p-0302","num":"0301"},"figref":["FIG. 25","FIG. 24","FIG. 25","FIG. 24"],"b":["2420","2510","2520","2500","2530"]},"In one embodiment, the processor of the media controller comprises a plurality of separate chips performing one or more of the functions as the receiver , the caching information receiver , and the assignor . In an alternative embodiment, the functions of the receiver , the caching information receiver , and the assignor  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the caching information receiver , and the assignor  at various stages of the media processing.",{"@attributes":{"id":"p-0304","num":"0303"},"figref":["FIG. 26","FIG. 24","FIG. 26","FIG. 24"],"b":["2600","2600","2600","2420","2610","2620","2600","2630"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the server . In an alternative embodiment, the functions of the receiver , the determinator , and the server  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the server  at various stages of the media processing.",{"@attributes":{"id":"p-0306","num":"0305"},"figref":["FIG. 27","FIG. 24","FIG. 27","FIG. 24"],"b":["2700","2700","2700","2420","2710","2720","2730"]},"In one embodiment, the processor of the content processing unit  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the redirector . In an alternative embodiment, the functions of the receiver , the determinator , and the redirector  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the redirector  at various stages of the media processing.",{"@attributes":{"id":"p-0308","num":"0307"},"figref":["FIG. 28","FIG. 24","FIG. 28"],"b":["2800","2800","2800","2810","2820","2830","2840","2830"]},"In one embodiment, the processor of the interworking function unit  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , the forwarder , and the repackager . In an alternative embodiment, the functions of the receiver , the determinator , the forwarder , and the repackager  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , the forwarder , and the repackager  at various stages of the media processing.",{"@attributes":{"id":"p-0310","num":"0309"},"figref":["FIG. 29","FIG. 24"],"b":["2900","2900","2910","2900","2920","2930","2900"]},"In one embodiment, the processor of the second media server  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the server . In an alternative embodiment, the functions of the receiver , the determinator , and the server  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the server  at various stages of the media processing.",{"@attributes":{"id":"p-0312","num":"0311"},"figref":["FIG. 30","FIG. 24"],"b":["3000","3000","3000","3010","3020"]},"In one embodiment, the processor of the media controller  comprises a plurality of separate chips performing one or more of the functions as the receiver , and the assignor . In an alternative embodiment, the functions of the receiver , and the assignor  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , and the assignor  at various stages of the media processing.",{"@attributes":{"id":"p-0314","num":"0313"},"figref":["FIG. 31","FIG. 24"],"b":["3100","3100","3100","3110","3100","3120","3100","3100"]},"In one embodiment, the processor of the layer2 node  comprises a plurality of separate chips performing one or more of the functions as the monitor , and the identifier . In an alternative embodiment, the functions of the monitor , and the identifier  may be performed within the same processor at different times. In other words, the processor behaves as the monitor , and the identifier  at various stages of the media processing.",{"@attributes":{"id":"p-0316","num":"0315"},"figref":["FIG. 32","FIG. 24"],"b":["3200","3200","3200","3210","3210"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the server . In an alternative embodiment, the functions of the server  may be performed within the same processor at different times. In other words, the processor behaves as the server  at various stages of the media processing.",{"@attributes":{"id":"p-0318","num":"0317"},"figref":["FIG. 33","FIG. 24"],"b":["3300","3300","3300","3310","3320","3320","3330"]},"In one embodiment, the processor of the deep packet inspection node  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the forwarder . In an alternative embodiment, the functions of the receiver , the determinator , and the forwarder  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the forwarder  at various stages of the media processing.",{"@attributes":{"id":"p-0320","num":"0319"},"figref":["FIG. 34","FIG. 24"],"b":["3400","3400","3400","3410","3410","3420","3430","3440"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , the server , and the generator . In an alternative embodiment, the functions of the receiver , the determinator , the server , and the generator  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , the server , and the generator  at various stages of the media processing.",{"@attributes":{"id":"p-0322","num":"0321"},"figref":["FIG. 35","FIG. 24"],"b":["3500","3500","3500","3510","3510","3520","3530","3510","3530"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the receiver , the assignor , and the transmitter . In an alternative embodiment, the functions of the receiver , the assignor , and the transmitter  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the assignor , and the transmitter  at various stages of the media processing.",{"@attributes":{"id":"p-0324","num":"0323"},"figref":["FIG. 36","FIG. 24"],"b":["3600","3600","3600","3610","3610","3620","3620"]},"In one embodiment, the processor of the media controller  comprises a plurality of separate chips performing one or more of the functions as the receiver , and the assignor . In an alternative embodiment, the functions of the receiver , and the assignor  may be performed within the same processor at different times. In other words, the processor behaves as the receiver  and the assignor  at various stages of the media processing.",{"@attributes":{"id":"p-0326","num":"0325"},"figref":["FIG. 37","FIG. 24"],"b":["3700","3700","3700","3710","3710","3720","3730"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the server . In an alternative embodiment, the functions of the receiver , the determinator , and the server  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the server  at various stages of the media processing.",{"@attributes":{"id":"p-0328","num":"0327"},"figref":["FIG. 38","FIG. 24"],"b":["3800","3800","3800","3810","3820","3810","3820"]},"In one embodiment, the processor of the media data function  comprises a plurality of separate chips performing one or more of the functions as the receiver , and the transmitter . In an alternative embodiment, the functions of the receiver , and the transmitter  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , and the transmitter  at various stages of the media processing.",{"@attributes":{"id":"p-0330","num":"0329"},"figref":["FIG. 39","FIG. 24"],"b":["3900","3900","3900","3910","3910","3920","3930","3940"]},"In one embodiment, the processor of the media server  comprises a plurality of separate chips performing one or more of the functions as the generator , the transmitter , the receiver , and the terminator . In an alternative embodiment, the functions of the generator , the transmitter , the receiver , and the terminator  may be performed within the same processor at different times. In other words, the processor behaves as the generator , the transmitter , the receiver , and the terminator  at various stages of the media processing.",{"@attributes":{"id":"p-0332","num":"0331"},"figref":["FIG. 40","FIG. 24"],"b":["4000","4000","4000","4010","4010","4020","4020","4030"]},"In one embodiment, the processor of the media controller  comprises a plurality of separate chips performing one or more of the functions as the receiver , the determinator , and the forwarder . In an alternative embodiment, the functions of the receiver , the determinator , and the forwarder  may be performed within the same processor at different times. In other words, the processor behaves as the receiver , the determinator , and the forwarder  at various stages of the media processing.",{"@attributes":{"id":"p-0334","num":"0333"},"figref":["FIG. 41","FIG. 24"],"b":["4100","4100","4100","4110","4120","4100","4130","4140","4150","4140","4150","4100"]},"In one embodiment, the processor of the inter working function unit  comprises a plurality of separate chips performing one or more of the functions as the first database , the second database , the failure monitor , the receiver , and the forwarder . In an alternative embodiment, the functions of the first database , the second database , the failure monitor , the receiver , and the forwarder  may be performed within the same processor at different times. In other words, the processor behaves as the first database , the second database , the failure monitor , the receiver , and the forwarder  at various stages of the media processing. Further, the first and the second databases  and  may be stored in the memory  of .",{"@attributes":{"id":"p-0336","num":"0335"},"figref":["FIG. 42","FIG. 24"],"b":["4200","4200","4200","4210","4220","4200","4230","4240","4230","4240","4210","4220","4230","4220","4240","4220"]},"In one embodiment, the processor of the media controller  comprises a plurality of separate chips performing one or more of the functions as the assignor , the failure monitor , the generator , and the transmitter . In an alternative embodiment, the functions of the assignor , the failure monitor , the generator , and the transmitter  may be performed within the same processor at different times. In other words, the processor behaves as the assignor , the failure monitor , the generator , and the transmitter  at various stages of the media processing.","As described in detail above, various embodiments of the present invention have many advantages. First, embodiments of the invention allow effective decoupling of the access network with the CDN network for OTT traffic caching. Second, embodiments of the invention enable deployment of layer3 based media servers (media caching and adaptation) in a layer2 network, which is much closer to the end users without the usual complexity of layer2 DPI and decision making. Third, embodiments of the invention support a more centralized content level DPI (DPI-C) and decision making in a single CDN, which may be able to serve both MBB and FBB networks. Consequently, DPI-C (content level deep packet inspection) functionality is not required within the access network. Fourth, embodiments of the invention may leverage a layered cache network to increase cache hit rate and reduce cache miss retrieval time. Embodiments of the invention provide a hierarchy of caching media server backup among distributed media servers in case of failure of any particular media server. Fifth, embodiments of the invention, support OTT, B2B and B2C services over MBB and FBB with a common, unified CDN with identical network configurations, which greatly simplifies network deployment, management, and operations.","Although the present invention and its advantages have been described in detail, it should be understood that various changes, substitutions and alterations can be made herein without departing from the spirit and scope of the invention as defined by the appended claims. For example, many of the features and functions discussed above can be implemented in software, hardware, or firmware, or a combination thereof.","Moreover, the scope of the present application is not intended to be limited to the particular embodiments of the process, machine, manufacture, composition of matter, means, methods and steps described in the specification. As one of ordinary skill in the art will readily appreciate from the disclosure of the present invention, processes, machines, manufacture, compositions of matter, means, methods, or steps, presently existing or later to be developed, that perform substantially the same function or achieve substantially the same result as the corresponding embodiments described herein may be utilized according to the present invention. Accordingly, the appended claims are intended to include within their scope such processes, machines, manufacture, compositions of matter, means, methods, or steps."],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","TECHNICAL FIELD","BACKGROUND","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS"],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["For a more complete understanding of the present invention, and the advantages thereof, reference is now made to the following descriptions taken in conjunction with the accompanying drawing, in which:",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":["FIG. 5","FIGS. 5A-5D"]},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 6","FIGS. 6A-6D"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":["FIG. 8","FIGS. 8A-8D"]},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":["FIG. 14","FIG. 14A","FIG. 12","FIG. 14B","FIG. 13"]},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":["FIG. 18","FIGS. 18A and 18B","FIG. 18A","FIG. 18B"]},{"@attributes":{"id":"p-0034","num":"0033"},"figref":["FIG. 19","FIGS. 19A and 19B","FIG. 19A","FIG. 19B"]},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 20"},{"@attributes":{"id":"p-0036","num":"0035"},"figref":"FIG. 21"},{"@attributes":{"id":"p-0037","num":"0036"},"figref":"FIG. 22"},{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 23"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 24"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 25"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 26"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 27"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 28"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 29"},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 30"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 31","b":"3100"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 32"},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 33"},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 34"},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 35"},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 36"},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 37"},{"@attributes":{"id":"p-0053","num":"0052"},"figref":"FIG. 38"},{"@attributes":{"id":"p-0054","num":"0053"},"figref":"FIG. 39"},{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 40"},{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 41"},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 42"}]},"DETDESC":[{},{}]}
