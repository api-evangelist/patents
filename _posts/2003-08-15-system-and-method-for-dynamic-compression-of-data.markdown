---
title: System and method for dynamic compression of data
abstract: A method of transferring a compressed web page over a computer network without affecting the existing web server applications and processes. The compressor intercepts a request from a workstation for the web page. A second request is transmitted to the server from the compressor for the original, uncompressed web page. The web page is selectively compressed in the compressor. Then the compressed web page is transmitted to the workstation. Optionally, some of the files associated web page, such as image files, are also compressed and the references to the compressed associated files is changed to reflect any change in the name of the compressed associated files.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07844740&OS=07844740&RS=07844740
owner: CloudShield Technologies, Inc.
number: 07844740
owner_city: Sunnyvale
owner_country: US
publication_date: 20030815
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application is a continuation of application Ser. No. 09\/602,128, filed Jun. 23, 2000, now U.S. Pat. No. 6,728,785, which is hereby incorporated by reference herein.","The present invention relates to a method of compressing data for transmission.","The Internet is a publicly accessible worldwide network which primarily uses the Transport Control Protocol and Internet Protocol (\u201cTCP\/IP\u201d) to permit the exchange of information. The Internet supports several applications protocols including the Hypertext Transfer Protocol (\u201cHTTP\u201d) for facilitating the exchange of HTML\/World Wide Web (\u201cWWW\u201d) content, File Transfer Protocol (\u201cFTP\u201d) for the exchange of data files, electronic mail exchange protocols, Telnet for remote computer access and Usenet for the collaborative sharing and distribution of information.","Several compression techniques have been used to reduce the time required to transfer files. Compression can occur at the file or the bit stream level. Applications, such as PKZP\u2122, compress files on a computer. Modems use bit stream level compression techniques to optimize throughput. Microsoft's Windows NT\u2122 servers include IIS that can provide static web files in the deflate format. Some web browsers (\u201cbrowsers\u201d) support the \u201cdeflate\u201d format.","Traditionally, a workstation accesses a web page across the Internet by transmitting a request for the web page to a web server. The web server then processes the request and transmits the web page to the workstation. The web page is a file having hypertext markup language (\u201cHTML\u201d) codes. Once the workstation receives the web page, the workstation analyzes the HTML codes for references to associated files, such as graphic files, video files, audio files and other files. The workstation then sends a second request to the web server for the associated files. The web server then sends the associated files to the workstation. This network congestion management mechanism is called \u201cHTTP slow start.\u201d","Since the associated files are requested only after the initial web page file has been received and analyzed at the workstation, the speed of receiving the initial web page file is a controlling factor in the over all speed of viewing a web page. In order to utilize compression techniques as a speed enhancement, conventional systems require the web server to store separate pre-compressed web pages. Others also require the web server to send additional code to decode the web page.","A method of transferring a compressed web page over a computer network without affecting the existing web server applications and processes. The compressor intercepts a request from a workstation for the web page. A second request is transmitted to the server from the compressor for the original, uncompressed web page. The web page is selectively compressed in the compressor. Then the compressed web page is transmitted to the workstation.","A proxy server with cache is a server that is located between a client application, such as a web browser, and a real server where the proxy is at the client's side of the network. The proxy server intercepts content requests to the real server to see if it can fulfill the requests itself out of its cache storage. If not, or if the proxy server does not have a cache, it substitutes its own IP address for that of the originating client, makes a notation to associate the returned response to the client, and forwards the request onto the real server.","A reverse proxy server is a server that is located between a client application, such as a web browser, and a real server at the server's side of the network. Optionally, the reverse proxy server has a cache.","A forward proxy server sits between a workstation and the Internet to ensure security, administrative control and optionally provide caching services. A forward proxy server can be associated with a gateway server which separates the workstation's local network from the Internet or other network. The forward proxy server can also be associated with a firewall server which protects the local network from outside intrusion. The forward proxy server receives content requests from workstations requesting web pages and web page content from the web server. The forward proxy server then transmits a request for the web page or content to the web server on the behalf of the workstation. The forward proxy server modifies the identity of the requestor to be that of the forward proxy server. This is typically achieved by altering the internet protocol address of the requester. A forward proxy server can also be a cache server.","Portable Network Graphics (PNG) format is a new bit-mapped graphics format similar to the GIF format. A graphics file stored in the PNG format is more compressed than the same file stored in the GIF format. The conversion from GIF to PNG format is a lossless conversion. Web browsers such as Netscape Navigator\u2122 and Microsoft Internet Explorer\u2122 support PNG.","Internet Information Server (\u201cIIS\u201d) is Microsoft's Web server that runs on Windows NT\u2122 platforms. IIS supports the open-source compression algorithm called deflate.","Huffman encoding is a prefix coding prepared by a special algorithm. Each code is a series of bits, either 0 or 1 that represents an element in a specific \u201calphabet\u201d, such as the set of ASCII characters. This is the primary but not the only use of Huffman coding in the deflate compression technique.","A Huffman algorithm starts by assembling the elements of the alphabet, each one being assigned a weight, i.e., a number that represents its relative frequency within the data to be compressed. These weights may be guessed at beforehand, or they may be measured exactly by examining the data to be compressed, or some combination thereof. The elements are selected two at a time, the elements with the lowest weights being chosen first. The two chosen elements are made to be leaf nodes of a node with two branches. For example, a set of elements and weights can looked like this:",{"@attributes":{"id":"p-0022","num":"0021"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"char"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"A","16"]},{"entry":[{},"B","32"]},{"entry":[{},"C","32"]},{"entry":[{},"D","8"]},{"entry":[{},"E","8"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}}},"Lempel-Ziv (LZ) encoding including LZ77, LZ78, LZW and others are dictionary based substitution compression techniques. LZ77 compression works by finding sequences of data that are repeated. LZ77 compression uses a \u201csliding window\u201d that is, at any given point in the data, there is a record of what characters went before.","Deflate compression can be accomplished with a variety of techniques as defined in the deflate specification, RFC 1951, herein incorporated by reference. The three modes of compression available to the compressor include:","First, no compression. This mode is selected when the data analyzed has already been compressed.","Second, compression with LZ77 and then with standard Huffman coding. The trees that are used to compress in this mode are defined by the Deflate specification itself and preloaded in any deflate decoding capable software, and so no extra space needs to be taken to store those trees or send them to the receiver of the compressed file.","Third, compression with LZ77 and then with Huffman coding with trees that the compressor creates by examination of the file and stores along with the data.","The data is broken up in \u201cblocks,\u201d and each block uses a single mode of compression. If the compressor wants to switch from non-compressed storage to compression with the trees defined by the specification, or to compression with specified Huffman trees, or to compression with a different pair of Huffman trees, the current block is ended and a new one begun.","HyperText Markup Language (\u201cHTML\u201d) is the authoring language used to create documents on the World Wide Web (Web). HTML defines the structure and layout of a Web document by using a variety of tags and attributes. The correct structure for an HTML document starts with <HTML><HEAD> \u201ctext describing the document\u201d<\/HEAD><BODY> and ends with <\/BODY><\/HTML>. The information included in the Web page is located between the <BODY> and <\/BODY> tags.","An example of an HTML reference to a image file called \u201ccpu.gif\u201d is:\n\n","There are numerous other HTML tags used to format and layout the information in a Web page. For example <P> is used to begin paragraphs and <I> and <\/I> are used to italicize text. Tags are also used to specify hypertext links.","Internet Server API (\u201cISAPI\u201d) is an application programming interface (\u201cAPI\u201d) for Microsoft's Internet Information Server (\u201cIIS\u201d) web server. ISAPI enables programmers to develop Web-based applications that run much faster than conventional CGI programs. ISAPI can support requests from multiple workstations with only a single instance running on the server. CGI requires a separate instance for each request.","ZLIB is lossless data compression technique that uses the deflate technique to compress only the body of web pages and not the headers.","Transfer speed of files over the Internet is a critical factor in the usability of the Internet. Many techniques currently exist to increase the speed of file transfers. The present invention intercepts web page requests then compresses the web page, which is usually an HTML file, and sends it to the requesting workstation in the compressed format. The requesting workstation then decompresses the web page before processing the web page. Optionally, the tags in the web page that point to image files, for example GIF files, are modified to point to modified image files of a different name, for example PNG files. This process can occur at an ISP or other form of point of presence to the Internet, at a forward proxy server, at a reverse proxy server, at a transparent proxy server or at the web server.",{"@attributes":{"id":"p-0035","num":"0035"},"figref":"FIG. 1","b":["100","102","104","106","108","102","104","106","108","106","108","106","106"]},"In an embodiment illustrated in , a user at the workstation  sends a request to the web server  over the network  for a web page. The user may be running a web browser such as Internet Explorer\u2122 or Netscape Navigator\u2122. When the request reaches the web server , the compressor  intercepts the request and determines if the workstation  can process compressed web pages. Various mechanisms can be used by the compressor  to make this determination. In one embodiment, the compressor  analyzes the request to determine if the request's header contains a indication that the workstation can handle compressed files. For example, the header can contain a \u201crequest encoding=deflate\u201d indication.","If the workstation can handle compressed files, then the compressor  compresses the web page returned by the web server  before the web page is transmitted to the workstation .","It is preferred that the web server  operations not be affected by the compressor . That is, the web server applications are not affected and the compressor  performs the compression transparently to the web server , e.g., neither data throughput nor data processing power is impacted.","Another embodiment of the compressor  utilizes a novel mode of deflate compression using LZ77 in combination with Huffman coding. The Huffman coding utilizes trees that are predefined based on an analysis of HTML codes. Since some HTML code must exist in every HTML page and others occur at frequencies that can be predicted, the Huffman tree can be generated before the compression to save time compressing the data. For example:",{"@attributes":{"id":"p-0040","num":"0040"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"center"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"HTML Code","Huffman Code"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"<html>","0"]},{"entry":[{},"<\/html>","1"]},{"entry":[{},"<head>","00"]},{"entry":[{},"<\/head>","01"]},{"entry":[{},"<title>","000"]},{"entry":[{},"<\/title>","001"]},{"entry":[{},"<b>","10"]},{"entry":[{},"<\/b>","11"]},{"entry":[{},"www.","110"]},{"entry":[{},"<img src=","1110"]},{"entry":[{},"<a href=","1111"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}]}}},"While the above is a simplified example, it illustrates how the most commonly occurring characters strings can be replaced by a predetermined Huffman tree that is optimized for HTML code.","In the embodiment shown in , when the compressor  is integrated with the web server , the compressor  can be a software application, a hardware implementation, or a combination of hardware and software. In an embodiment with a hardware compressor , the compressor  can be an adapter card in the web server  or a blade in a router, i.e. a rack mount printed circuit board or other type of adapter inserted in the backplane or motherboard or otherwise coupled with the router (not shown). In another embodiment, the compressor  is a box connected with the web server  via a SCSI bus, universal serial bus, parallel port, serial port, fiber channel, fast Ethernet, or other communication channel. In this embodiment, the web server  receives a request for a web page and an indication that the workstation  can handle web pages in the deflate format. The web server  processes the request similar to traditional web page requests, which can include using Microsoft's IIS and ISAPI. However, before the web page is transmitted over the network , it is sent to the compressor  for processing. The compressor  compresses the web page and optionally converts references to associated files such as image files in the web page to match a second naming convention. The web page is then transmitted over the network .","It is preferred that when the compressor  is called by the web server's API, two pointer addresses are provided. The first is the address of the data for the client and the second is the address to place the compressed data. Further it is preferred that the compressor  perform the encoding at a rate of at least 200 Mbps. The hash tables used for encoding are stored on the compressor  in a fast media such as flash memory or other integrated storage device. It is preferred that the hash tables be software programmable.","The ISAPI filter receives the data from the client, passes it to the compressor , and then sends the encoded data to the client.","It is preferred that the compressor  is a PCI interface adapter that supports Windows NT, Linux, OpenBSD, and Sun Solaris operating systems and supports Microsoft's IIS versions 4.0 and 5.0, Apache, Iplanet, and Lotus' Domino web server software. It is further preferred that the compressor  be a server co-processor to reduce the load on the web server's processing capacity and can process wire speeds compression of up to 45 Mbps and compresses web pages by a ratio of 40 to 1.","The workstation  can indicate that it wishes to receive web pages in a compressed format in a variety of ways. First, the workstation  can include in the web page request an indication flag that indicates that web page compression is acceptable. The same flag or an additional flag can be used to indicate that the associated files, for example GIF files, can be compressed. Second, the workstation  can send a request to the compressor  or data center  () indicating that compression is acceptable for that workstation . Other means of indicating that the workstation  can accept compressed files can also be used. While the terms compressor and data center have been used to describe devices that are located near the web server and between the web server and the workstation, those terms are not limited to the embodiments used to illustrate their functionality.",{"@attributes":{"id":"p-0047","num":"0047"},"figref":"FIG. 2","b":["208","206","200","202","204","208","206","208","204","202","208","206","208","206","208"]},{"@attributes":{"id":"p-0048","num":"0048"},"figref":"FIG. 3","b":["308","302","300","302","308","304","306","308","204","302","302","308"]},"In this embodiment, the data center  can be located at an Internet service provider (ISP) site to compress the web pages and associated files that are sent over the dial-up link to the workstation . Alternatively, the data center  could be located on a company's intranet network to compress all web pages routed from the Internet to workstations on the intranet.","In one embodiment, the data center  compresses all web pages for a particular workstation or set of workstations. The data center  builds a list of workstations  that wish to accept compressed web pages, then all web pages sent to those workstations  are compressed.",{"@attributes":{"id":"p-0051","num":"0051"},"figref":"FIG. 4"},"In , a request for a web page is received at a data center or compressor. This request can be received at the ISP or other point-of-presence, across a network, or at the web server. A data center  () or a compressor  () can receive the web pages. Alternatively, another computer can intercept the web pages and transmit them to the data center  of compressor .","In , a second request is transmitted to a web server having the web page. The web page is received in response to the second request.","In , the request is analyzed to determine if the desired web page can be compressed. Other methods of determining if the web page can be compressed can also be used. For example, a default setting can be established for a workstation that is known to be capable of receiving compressed data or the workstation can send a separate message to the compressor indicating that the web pages should be compressed. The request can be analyzed any time after the request is received and before the web page is selectively compressed. Optionally, the request can be analyzed to determine if the web page's associated files can also be compressed.","In , the web page is selectively compressed. Only web pages that are to be sent to workstations that are known to be able to handle compressed files are compressed.","Optionally, references in the web page to associated files that will be compressed are altered to reflect any change such as the associated file's name, extension, or other code. Alternatively, the request for the associated files can be analyzed to determine if the associated files can be compressed. The determination can be based on the workstation's ability to handle compressed files. Since the web page was compressed, the associated files sent to the same workstation usually can also be compressed. Thus, the determination can be based on the request for the associated files, for example a flag can be set in the request, or the compressor can keep track of the workstation that received the web page and automatically compress the associated files.","In , the selectively compressed web page is transmitted toward the workstation. Depending on where the compression occurs, the compressed web page is transmitted toward the workstation over the Internet, over a dial-up line, over a dedicated line, over an intranet, or over some other connection.","In , a third request is received that requests the web page's associated files.","In , a fourth request is transmitted to the web server for the associated files.","In , the associated files are selectively compressed. For example, graphic files in the GIF format can be converted to the PNG format using a lossless transformation.","In , the associated files are transmitted toward the workstation.",{"@attributes":{"id":"p-0062","num":"0062"},"figref":"FIG. 5","b":"500"},"In , a request is received at a data center or compressor from a remote web browser requesting a web page from a web server. For example, the request can be received at an ISP, across the network, or at the web server.","In , the request is analyzed to determine if the web page can be compressed and optionally if the web page's associated files can be compressed.","In , the data center sends a request to the web server for the web page. Alternatively, the data center can retrieve the web page directly.","In , the web page is received, selectively compressed, and references in the web page to associated files are selectively changed at the data center.","In , the selectively compressed and selectively modified web page is transmitted toward the workstation.","In , a request for the files associated with the web page is received at the data center from the web browser.","In , the associated files are requested from the web server. The associated files can be a single file or a plurality of files.","In , the data center receives the associated files and selectively compresses and selectively renames the file. For example, the graphics file \u201ctest.gif\u201d in the GIF format can be deflated and renamed \u201ctest.png\u201d in the PNG format.","In , the associated files are transmitted to the workstation.","While preferred embodiments have been shown and described, it will be understood that they are not intended to limit the disclosure, but rather they are intended to cover all modifications and alternative methods and apparatuses falling within the spirit and scope of the invention as defined in the appended claims or their equivalents."],"BRFSUM":[{},{}],"heading":["BACKGROUND","BRIEF SUMMARY","DEFINITIONS","DETAILED DESCRIPTION"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The present invention is described with reference to the accompanying figures. In the figures, like reference numbers indicate identical or functionally similar elements. Additionally, the left-most digit(s) of a reference number identifies the figure in which the reference number first appears.",{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
