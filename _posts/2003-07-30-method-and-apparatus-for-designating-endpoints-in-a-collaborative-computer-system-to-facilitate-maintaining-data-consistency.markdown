---
title: Method and apparatus for designating endpoints in a collaborative computer system to facilitate maintaining data consistency
abstract: In a peer-to-peer collaborative system in which collaborators communicate via a shared telespace and exchange data change requests, a unique number is assigned to each endpoint (a unique pairing of a device and a person) of each of the telespace members. Each endpoint number indicates the order in which the member joined the telespace, and, for each member invited to join (or otherwise sponsored) by another telespace member (the “inviting member”), it also indicates the inviting member. As more and more members are invited to join by those new members, the designations add additional orders of digits to indicate the family tree or chain of inviting members. The designations are used to resolve collisions between two data change requests that are both dependent on the same data change request.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08024404&OS=08024404&RS=08024404
owner: Microsoft Corporation
number: 08024404
owner_city: Redmond
owner_country: US
publication_date: 20030730
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATIONS","FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application is a division of U.S. patent application Ser. No. 09\/356,148 filed Jul. 19, 1999. The following commonly-assigned U.S. patent applications are related to the present application, and incorporated by reference herein in their entirety:\n\n","The invention relates generally to peer-to-peer collaboration systems, and more particularly, to a method and apparatus for assigning designations to combinations of collaborating computers and user operating those computers in order to facilitate establishing and maintaining data consistency among collaborators in such systems.","The Internet has established a dynamic, public environment for communication and interaction among its millions of users. In business, the Internet has redefined vendor-manufacturer, manufacturer-distributor, distributor-customer, and other relationships. With extension of the Internet technology into internal, secured networks of individual companies, the \u201cintranet\u201d or \u201cprivate Internet\u201d, as it is called, has enabled new forms of document and information sharing between individual employees and work groups using company directory and network infrastructure. On-line services, such as electronic bulletin boards and chat rooms, electronic commerce, and technical support for products, are available on the World Wide Web (\u201cWWW\u201d or \u201cWeb\u201d) operating over the Internet.","The Internet has, at its core, a server-client architecture, in which individual clients (i.e., Internet-content users) interface via computer-executable applications such as browsers with servers (i.e., Internet-content providers) to obtain documents from Web sites. Browsers are software programs that enable personal computers to request, receive (e.g., download), interpret, and present Internet documents, and generally navigate the Internet. Web servers typically have standard interfaces for running external programs, the most common is the Common Gateway Interface (CGI). Web sites are collections of documents, usually consisting of a home page and related, linked documents, located on servers remote from the client. The documents can be compound documents, containing data, graphics, video, sound, and\/or other types of media, as well as links to other documents. Essentially, the WWW is a web of interconnected documents, or, more precisely, document objects that are located at various sites on the Internet.","Among the types of document objects on the WWW are documents and scripts. A script is an executable program, or a set of commands stored in a file, that can be run by a Web server to produce a document that is then returned to the Web browser. Typical script actions include running library routines or other applications to get information from a file or database, or initiating a request to get information from another computer, or retrieving a document corresponding to a selected hypertext link. A script is run on the Web server when, for example, a user selects a particular hypertext link in the Web browser.","Underlying the Internet technology are advances in standardization, including personal computer hardware, software, network protocols, and infrastructural conventions (such as the \u201cUniform Resource Locator\u201d or \u201cURL\u201d). URLs provide location addresses for all document objects on the WWW. A URL uniquely references a document object and often defines an access algorithm using Internet protocols.","\u201cInternet protocols\u201d, as that expression is used herein, are defined as current or future language conventions and present or future communication protocols that are generally-accepted and used for generating messages including documents for transmission over the Internet, or for transmitting such messages over the Internet, respectively. Such language conventions include, for example, at present, Hypertext Markup Language (\u201cHTML\u201d) and eXtensible Markup Language (\u201cXML\u201d). Such communication protocols include, for example, at present, Hypertext Transfer Protocol (\u201cHTTP\u201d), TCP\/IP, FTP and GOPHER. Those skilled in the art will be familiar with these language conventions and protocols.","HTML is a language used for writing hypertext documents, containing multimedia content and links to other documents. An HTML document includes a hierarchical set of markup elements, where most elements have a start tag, followed by content, followed by an end tag. Tags are enclosed in angle brackets (\u201c<\u201d and \u201c>\u201d) and indicate how the document is structured and how to display the document, as well as destinations and labels for hypertext links. There are tags for markup elements such as titles, headers, text attributes such as bold and italic, lists, paragraph boundaries, external links to other documents, and internal links to other parts of the same document, graphic images, and many other document features. Many books are in wide circulation regarding programming using HTML.","XML is another of the language conventions included in the Internet protocols. XML is compatible with and complementary to HTML, at least in its current version. It is a standard way of describing a class of data objects as stored in computers, called XML documents, and behavior of programs that process these objects. XML documents are made up of storage units called entities, which contain either text or binary data. Text is made up of characters, some of which form the character content of the documents, and some of which form markup. Markup encodes a description of the document, such as its storage layout and logical structure. A software module called an XML processor is used to read XML documents and provide access to their content and structure. Further information regarding XML can be had with reference to Version 1.0 of the XML specification, available at <HTTP:\/\/www.w3.org\/XML>, and incorporated herein by reference.","A Web server and a Web browser communicate typically using the HTTP message protocol and the underlying TCP\/IP data transport protocol of the Internet. In HTTP, the Web browser establishes a connection to a Web server and sends an HTTP request message to the server. In response to the request message, the Web server checks authorization, performs any requested action such as downloading a document identified by its URL, and returns an HTTP response message containing either the HTML document resulting from the requested action or an error message. The returned document may simply be a static file stored on the Web server, or it may be generated dynamically using a script called in response to the request message.","To take advantage of the Internet, tools and resources have been developed in compliance with the Internet protocols, including company-critical applications such as e-mail. E-mail is electronic mail, by means of which documents are sent and received electronically at selected addresses. It has been estimated that a vast majority of Internet-based interaction is through the use of e-mail and other browser-based media that follow a \u201cdocument send and receive\u201d model. Perhaps due to that model, users often view the Internet as inherently \u201cpeer-to-peer\u201d, with individuals accessing documents provided by other individuals, without intervention by a higher authority.","The Internet is dynamic and flexible in providing users with entertaining and useful ways of communicating, though it does not meet all the needs of users. While users interact increasingly through the Internet, they continue to interact \u201coff\u201d of the Internet in more conventional ways, such as through multi-medium (phone, fax, whiteboard), multi-temporal (real-time, overnight mail) and other informal means of communication.","It would be desirable to extend the Internet paradigm to personal and private communications and other shared and mutual activities between individuals and small groups in shared private spaces. Such interactions should preferably occur instantly, directly, and confidentially between participants' personal computers, or other network-capable devices, without exposing such interactions to server bottlenecks through which Internet traffic is typically funneled to third-party Web sites where communications can be intercepted and confidences violated.","It would also be desirable to provide a technique that allows users at various remote sites to share and edit documents on a peer-to-peer basis, while maintaining consistent copies of the documents at local sites. Such a technique should permit any of the users to issue change requests regarding the documents, which changes can then be made asynchronously to the copies at all the local sites in a coordinated fashion even if the sites are disconnected from the network when the change requests are issued. The technique should provide a high level of data consistency across all the sites so that each site presents essentially the same document for viewing and\/or editing by the various, geographically dispersed users.","In accordance with the principles of the invention, a data change request priority scheme uses request sequence number information and dependency information to make data changes. In case of a dependency collision between data change requests, the ordering of execution of deltas in the event of a collision depends on the endpoint (a unique pairing of a device and a person) that originated the delta. In particular, each endpoint that is a member of a telespace is assigned a unique endpoint number, corresponding, for example, to the order in which the endpoint originally joined the telespace.","In one embodiment, a unique number is assigned to each endpoint of each of the telespace members. Each endpoint number indicates the order in which the member joined the telespace, and, for each member invited to join (or otherwise sponsored) by another telespace member (the \u201cinviting member\u201d), it also indicates the inviting member. As more and more members are invited to join by those new members, the designations add additional orders of digits to indicate the family tree or chain of inviting members. Accordingly, the designations can be thought of as indicating the ancestry of each member added to a telespace after the founding members of a telespace. Thus, where the designations comprise a number of orders, the first order designates a founding member of the telespace, and each successive order after the first order (e.g., second, third, etc, order) designates a member invited to join the telespace by an inviting member specified by the preceding order digit. The inviting member may be a founding member or another member of the telespace of intermediate seniority and with telespace membership sponsoring privileges. In one embodiment, each inviting member is responsible for assigning telespace numbers to members it sponsors.","In another embodiment, the endpoint numbers are used to resolve dependency collisions between data change requests.","A. Terminology","It may prove useful to introduce at the outset certain terminology and abbreviations used in this specification, including: activity, client, communications manager, component, controller, delta, device, dynamics manager, engine, framework, identity, member, navigation, person, server, telespace, tool, URL, and XML.\n\n","B. Conventional Computer System",{"@attributes":{"id":"p-0035","num":"0057"},"figref":["FIG. 1","FIG. 1","FIG. 1"],"b":"100"},"The computer system  includes a central processing unit (CPU) , which may include a conventional microprocessor, random access memory (RAM)  for temporary storage of information, and read only memory (ROM)  for permanent storage of information. A memory controller  is provided for controlling system RAM . A bus controller  is provided for controlling bus , and an interrupt controller  is used for receiving and processing various interrupt signals from the other system components.","Mass storage may be provided by diskette , CD-ROM , or hard disk . Data and software may be exchanged with client computer  via removable media, such as diskette  and CD-ROM . Diskette  is insertable into diskette drive , which is connected to bus  by controller . Similarly, CD-ROM  is insertable into CD-ROM drive , which is connected to bus  by controller . Finally, the hard disk  is part of a fixed disk drive , which is connected to bus  by controller .","User input to the computer system  may be provided by a number of devices. For example, a keyboard  and a mouse  may be connected to bus  by keyboard and mouse controller . An audio transducer , which may act as both a microphone and a speaker, is connected to bus  by audio controller . It should be obvious to those reasonably skilled in the art that other input devices, such as a pen and\/or tablet and a microphone for voice input, may be connected to client computer  through bus  and an appropriate controller. DMA controller  is provided for performing direct memory access to system RAM . A visual display is generated by a video controller , which controls video display .","Computer system  also includes a network adapter  that allows the client computer  to be interconnected to a network  via a bus . The network , which may be a local area network (LAN), a wide area network (WAN), or the Internet, may utilize general-purpose communication lines that interconnect multiple network devices.","Computer system  generally is controlled and coordinated by operating system software. Among other computer system control functions, the operating system controls allocation of system resources and performs tasks such as process scheduling, memory management, networking and I\/O services.","C. Conventional Approach to Controlling a Data Model",{"@attributes":{"id":"p-0042","num":"0064"},"figref":"FIG. 2","b":["200","200","202","204","206","208","202","204","206","206","202","204","204","200","200"]},"The conventional approach for controlling a data model as exemplified in the system  was appropriate in an age in which computer systems, whether mainframes or personal computers, operated in relative isolation. With the advent of the Internet, computer users demand improved ways of collaborating, and the invention provides what can be called \u201cmodel mediated control\u201d, in which a dynamics manager mediates changes effected by the data-change engine to the data model.","D. Internet Paradigm for Intercomputer Operation",{"@attributes":{"id":"p-0045","num":"0067"},"figref":["FIG. 3","FIG. 1","FIG. 1"],"b":["300","302","306","308","309","310","306","308","309","310","309","310","306","308","311","312","314","314","306","308","314"]},"As will be explained in more detail below, such peer-to-peer communications can be made directly or via a relay device . The relay device  is preferably a \u201cstore and forward\u201d, which can store messages destined to a peer unit  which is temporarily disconnected from the Internet, and later, on reconnection, can forward the messages to that peer unit.","E. ABC system Architecture and Operation",{"@attributes":{"id":"p-0048","num":"0070"},"figref":"FIG. 4","b":["400","314","314","314","402","404","406","402","404","402"]},"The framework  includes a user interface manager , identity manager , telespace manager , activity manager , storage manager , controller services manager , dynamics manager , and communications manager .","The user interface (UI) manager  is responsible for managing shared services for a number of user interface controllers (not separately shown). The UI manager  manages layout of activities within panes of a display window, and otherwise provides a desired \u201clook and feel\u201d for the user interface. The UI manager  also manages activity navigation (for example, go to, next, previous, etc.) and maintains a navigation history.","The identity manager  is responsible for maintaining identities of a telespace's member. As noted above, an identity is the name, and corresponding URL, by which each user is known by others. Individual users may have one or many identities. The identity manager  maintains a record or table, preferably in XML, of the identities. The identity manager  can also maintain a record or table, preferable in XML, of the URL's of telespace members and their corresponding device URL's. Alternatively, a separate member manager can be implemented.","The telespace manager  is responsible for managing each of the telespaces  that may be opened on the peer unit A. Each telespace  is an instantiation of one or more activities. Each telespace  has a corresponding activity manager .","The activity manager  is responsible for (a) adding new activities to a telespace, (b) opening existing activities in a telespace, and (c) updating telespace activities from new activity template versions. To add a new activity, the activity manager  is provided with the URL of an activity template, opens the template, and extracts and propagates the template information (such as component URLs) into the telespace. The template defines the initial activity configuration for a telespace. A user may add additional activities to the telespace  later as needed. After being added, an activity is \u201cpart of\u201d the telespace and visible to all telespace members. A telespace has a tag to identify its activity manager and bind the activity manager and data. Preferably, each document has a local registry linked to it, with XML tag names maintained in the registry to express mapping (reference pointers or associations) in an extensible, platform-independent way, between the document and its corresponding telespace. Each telespace member has a framework and an activity template for the telespace available on his or her peer unit A-D.","Each activity includes a tool, such as tool  and an engine, such as engine . The tool  provides the user interface (UI) capability for the activity, interacting via UI  with a member. UI interaction may include UI events initiated, for example, via the keyboard  () or mouse  (). In response to such UI events, the tool  may request its corresponding engine  to effect data model changes, subscribing to the engine  for asynchronous data change notifications for updating UIs asynchronously when data changes occur. A tool  also implements application program interfaces (APIs) for interacting with background services provided under the direction of the controller manager . The engine  is responsible for maintaining and changing the data that supports the telespace  and\/or results from user interaction obtained through the tool. The engine  can modify persistent model data, and emit asynchronous data change notifications to the tool , both under the direction and control of the dynamics manager , as will be explained below. The storage manager  controls access to the stored data.","For creation of an activity template, a software developer may write or adapt a tool and engine for use within the framework. An activity template is a persistent representation of the tool and engine components comprising an activity. An activity template can be distributed, for example, as shrink wrapped software or downloaded, for example, over the Internet to peer unit A from a remote server. Activity components can be regarded as Web documents and are represented persistently via URLs. The activity template itself preferably has a URL, which allows for tracking activity design changes. The activity template can be a single activity template or an activity collection template. A single activity template pertains to only one activity, such as \u201cchat\u201d. An activity collection template pertains to a collection of activities, such as \u201cchat and outline\u201d.","For use, the ABC system  gets a member's identity via the identity manager , opens a telespace manager, requests the telespace manager to open a telespace via a URL, requests the telespace manager for an activity manager, and, then, the activity manager opens an activity, typically by using the activity's URL. Then, the ABC system  is ready for members to use the telespace to perform the shared, focused tasks offered by the particular activity.",{"@attributes":{"id":"p-0057","num":"0079"},"figref":"FIG. 5","b":["500","314","500","314","314"]},"As shown for peer unit A, the ABC system  includes a number of illustrative telespaces in which peer unit A is subscribed as a member, including a car designing telespace , a chat telespace , and a chess playing telespace . As also shown, peer unit  has a number of components used during operation of the telespaces , , . Peer unit A has a memory  that maintains a telespace record , which lists and describes each of the telespaces , ,  in which it is member, and a member record , which lists and describes each of the identities of telespace members that may participate in those telespaces. A UI  can receive user-initiated changes to the telespace and member records , .","Each of the telespaces , ,  instantiates a different one of the illustrated activities , , . (Alternatively, the illustrated activites , ,  could reside in a single telespace, in which case all members of the single telespace would have access to each of the activities.) Each activity , ,  includes a respective tool , ,  specific to the activity, and under control of a respective engine , ,  for carrying out changes to a corresponding data model , ,  contained in memory , and which is persisted in each of the telespaces , , . For example, the car design telespace  is an instance of an activity  that can include a tool  in the form of CAD (computer-aided design) software, and the chess-playing telespace  is an instance of an activity  that can include a tool  in the form of a software chess game.","Users pursue the activities , ,  of the telespaces , , , via the user interface , which interfaces with the tools , ,  for providing the tools with user requests. Responsive to the requests, the engines , ,  change the persistent state of a corresponding data model , ,  in memory , under the control of the dynamics manager  to reflect a current state. For example, the persistent state of the data for the chess-playing telespace  might include a chess board and locations of the chess pieces on the board; a user request may specify a chess piece move, which constitutes a change in the data, i.e., a delta; and the current state would reflect the execution of the delta and the consummation of the move.",{"@attributes":{"id":"p-0061","num":"0083"},"figref":["FIG. 6","FIG. 5"],"b":["500","314","546","536","526","536","506","512","514","514","536","536","546","546","536"]},"More specifically, as indicated by line \u201ca\u2032\u201d, the tool  initiates creation of a delta by requesting its generation by the dynamics manager . The dynamics manager  creates the delta and returns it over line a\u2032 to the tool , and may record the created delta in case fault recovery is required.","As indicated at line \u201ca\u201d of , the tool  passes control of the delta through a tool interface  to a tool-end  of the engine , thereby invoking the engine. (This description shall from time to time state that deltas are passed or that control to deltas shall pass from one component to another. Preferably, the deltas are objects allocated in memory whose pointer is passed as XML elements.) The engine's tool interface  exposes a set of application programming interfaces for creating commands that can effectuate the requested change encoded in the delta, or, in other words, for filling a delta with appropriate, typically engine-specific commands in serial form to fulfill the user's intent. The engine  then passes control of the delta, now filled with the commands, back to the tool .","As indicated at line \u201cb\u201d of , the tool  passes control of (i.e., submits) the filled delta to the dynamics manager  for execution. The dynamics manager  may also receive inbound deltas over line \u201cb\u2032\u201d from other peer units B-D. The dynamics manager , along with the dynamics managers in peer units B-D, are responsible for maintaining consistency of executed changes to the data model  from one end of the ABC system to the other for all members who participate in the chess game telespace.","The dynamics manager  includes queue structures  and a dynamo process , preferably a computer-executable program containing the main logic of the dynamics manager. The dynamics manager , and its dynamo process , are in bi-directional communication with the communications manager . The dynamics manager  enqueues the received deltas in the queue structures  for ordering purposes, then the dynamo process  services the queue structure in processing the enqueued deltas, and directing the engine  to execute them in an appropriate order. More specifically, the dynamo process  of dynamics manager  sends a control signal in the form of a \u201cdelta command execution\u201d message through the interface  to the dynamics manager end  of the engine  over line \u201cc\u201d of . The delta command execution message directs the engine  to proceed with execution of the delta received from the tool  by making the requested change to the data model  contained in the memory , and which is persisted in the telespace.","The dynamo process  of dynamics manager  also disseminates all locally-initiated deltas to other endpoints via the communications manager , which transmits them over the network, e.g.,  to the peer units B-D. At each peer unit B-D, the respective dynamics manager enqueues received deltas in its local queue structures, and then passes them in a specified order to its respective engine for execution.","A single dynamics manager can support a single telespace or multiple telespaces, depending on the application, and thus can be responsible for directing a number of engines to execute deltas for the various telespaces. In systems having multiple telespaces, as illustrated in , the dynamics manager  determines which engine should execute a delta by examining the delta's information. The delta contains commands that are identified to a specific one of the engines, and tagged with an engine identifier or code carried in the delta's payload. When the enqueued delta is processed by the dynamics manager, the dynamics manager associates the engine code with the referenced delta, and directs the delta's execution by the appropriate engine.","Finally, as indicated at line \u201cd\u201d of , the engine  sends a \u201cdata change notification\u201d message to notify the tool  of the execution of the delta, and of a new current state of the data in the data model . The data change notification can be made by value or reference. That is, the notification can include the new data values themselves or can include a pointer to the new data in memory. In response to the notification, the tool  causes the user interface  to make the change available to the user, e.g., by displaying the move on a chess board graphic. If a user is viewing the display  (), the user will be able to see the change to the chess game caused by execution of the delta; otherwise, the change is effected to the data in memory  without the user \u201cseeing\u201d the change at the time it is made.","Preferably, at substantially the same time that the change is being made by engine  to the data model  stored in memory  of peer unit A, the other peer units B-D are making the analogous change to their locally stored data so as to effect the intent of the delta in a consistent manner. Situations may arise where one or another of the peer units A-D is not connected to the network, e.g., the Internet. Where the peer unit A may be disconnected, the communications manager  employs a device presence detector  to ascertain whether the peer unit A is connected and, if not, stores outbound deltas in an outbound delta store  until such time as connection is restored, and then transmits the stored deltas. Where one or more destination peer units B-D are disconnected from the network, the communications manager  of peer unit A can proceed to transmit the outbound delta to relay  () without regard to whether the other peer units are disconnected. The relay  () receives such outbound deltas, stores them as necessary in an outbound delta store  (), and forward them upon the destination peer unit B-D being reconnected. In operation, the communications manager  can send all outbound deltas to the URL of the relay , and the relay can utilize an on-board look-up table  to ascertain the endpoint URL of the destination peer unit B-D to be used for relaying the delta. The relay service can be provided, in practice, by an Internet Service Provider (ISP) or other Internet organizations.","It can be seen that, as between the tool  and the engine , user interface activities are effected directly only via the tool  and data model changes are effected directly only via the engine . In the vernacular, the tool  \u201cowns\u201d the UI and the engine  \u201cowns\u201d the data model. This can be contrasted with current, typical applications as illustrated in . For example, spreadsheet programs today typically combine the functions of the tool and the engine rather than separating them as in the foregoing embodiment of the invention. By separating the tool from the engine, and thus the UI from the data model, the dynamics manager can intervene and mediate between deltas originating from the various peer units, e.g., for purposes of maintaining data consistency. Moreover, separation of the tool from the engine permits the process of execution of deltas to be carried out asynchronously. This is useful because it takes time for the dynamics manager  and engine  to carry out their responsibilities in a manner, e.g., that will maintain data consistency for all telespace members. It is also useful because inbound deltas from other peer units B-D can affect timing of execution of locally-initiated deltas.",{"@attributes":{"id":"p-0071","num":"0093"},"figref":"FIG. 7","b":["700","700","702","704","706","706","700","706","702","704","700"]},"F. Communications manager, Presence Server, and Relay",{"@attributes":{"id":"p-0073","num":"0095"},"figref":["FIG. 8","FIG. 8"],"b":["800","802","803","802","314","802","804","805","807","806","802","806","803","802","808","830"]},"As noted, each communications manager A-D is responsible for managing all communications between its peer unit and the other peer units. For example, communications manager  manages bi-directional communications between peer unit A and peer units B-D. The communications can include messages sent either from the peer unit A to one or more of peer units B-D, or from one of the peer units B-D to peer unit A. The transmissions can be made directly and without intermediaries, provided the destination peer unit(s) B-D (in the former case) or peer unit A (in the latter case) are connected to the network, e.g., the Internet (\u201con-line\u201d). As noted above, a device presence server  can be employed to ascertain whether the intended destination is on-line, or temporarily disconnected (\u201coff-line\u201d). If the destination is off-line, the communications can be made via a relay  (as noted above), which then forwards the message on to its destination when it returns on-line.","Thus, if peer unit A seeks to send a message to peer unit C, and the presence server  has informed the communications manager A that peer unit C is on-line, then the communications manager A sends the message via the network, e.g., the Internet , directly to the URL of peer unit C. At peer unit C, the message is received by communications manager C, which passes the message to dynamics manager C.","On the other hand, if peer unit A seeks to send a message to peer unit C, and the device presence server  has informed the communications manager A that peer unit C is off-line, then the communications manager A sends the message via the network, e.g., Internet , to the URL of the relay . The relay  can be implemented as a high-performance file server, which stores the en route message until peer unit C returns on-line, and then forwards the message to the URL of peer unit C. At peer unit C, the message is received as noted before, and passed through communications manager C to dynamics manager C.","Accordingly, the presence server  can serve the purpose within the ABC system  of monitoring whether the peer units A-D are on-line, and notifying each of the peer units of the connection status of the other peer units. To fulfill this purpose, the presence server  can be configured, for example, as shown for computer system  of .","During operation, each of the peer units A-D can be responsible for notifying the presence server  of its connection status, i.e., whether it is on-line or about to go off-line. Alternatively, the presence server  can poll the peer units A-D from time to time to obtain their connection status. This information is stored in the presence server  in a preferably volatile memory  in a connection directory . The connection directory  is initially empty, and remains so until the peer units A D provide the presence server  with their connection status, e.g., provide connection status notifications. Then, upon receipt of the status information, the connection directory  stores the notifying peer unit's URL and its connection status.","The presence server  can also provide a connection-status subscription service for the peer units A-D. The presence server  will notify each subscribing peer unit A-D of the connection status of each other peer unit A-D, and of a change in that connection status. The presence server  can send the connection status notifications to the subscribing peer units A-D either (a) upon request of status change notifications from the peer unit A-D \u201cwishing\u201d to send a message; (b) upon connection of the peer unit to the network, e.g., the Internet ; (c) from time to time, e.g., upon a change in status of any of the peer units; or (d) a combination of the foregoing. Preferably, all communications are made pursuant to Internet protocols. These protocols can include, among others, those mentioned above.","Each peer unit A-D can also subscribe to a membership-status service, and, by so doing, thereafter learn on an on-going basis of the membership of each telespace in which it is a member. To enable this service, the presence server  has a member directory  maintained in memory  for storing records for each member supported by the presence server. Each peer unit provides the presence server with its current membership status from time to time or, alternatively, upon any change it its membership status.","To illustrate, if peer unit A wishes to send a message, such as a delta, to peer unit B, peer unit A accesses the presence server  and obtains the URL of peer unit B to obtain its connection status. Assuming peer unit A subscribes to the subscription service, it will have received notification of the status of peer unit B. Thus the dynamics manager A will have passed the message to the communications manager A without knowledge of whether the destination peer unit B is connected to the network.","G. Distributed Data Consistency Model and Delta Processing","As noted above, the dynamics managers A-D in the peer units A-D are responsible for receiving locally-generated and remotely-generated deltas and maintaining a proper order for their execution by their respective engines A-D so as to maintain a high level of consistency of the data models across all the peer units A-D of the ABC system  participating in a telespace. This is made all the more difficult because deltas originating from one or another of the peer units may be received and\/or executed out of order, or even after significant delays due to peer units being temporarily disconnected from the network. Moreover, the deltas may be generated based on different and inconsistent local data states.","Theoretically, data consistency can be described in terms of three properties, each achievable to some degree in collaboration systems, namely causality preservation, intention preservation, and convergence. More specifically, these properties of consistency can be described as follows:","Causality preservation (i.e., sequential consistency) requires that, if delta","A causes delta B, then delta A must be executed first so that the sequence that gave rise to the creation of the deltas is preserved in their execution. In other words, satisfaction of this property requires that the execution order of dependent operations be the same as their natural cause\/effect order.","Intention preservation (i.e., semantic consistency) requires that the meaning of the deltas and the intention behind their creation be preserved. In other words, satisfaction of this property requires that, for any pair of deltas, e.g., delta A and delta B, the execution of each must preserve the intention of the other. To achieve this, the system records the data state at the time a user requested a change to that data state. For example, in a shared document, when change \u201cx\u201d was requested, the next word was \u201cy\u201d and the same is true when \u201cx\u201d is executed. Put another way, the effects of executing a delta on the data stored at each peer unit must be the same as the effects of executing the same delta on the data stored at the originating peer unit.","Convergence requires that the copies of data maintained by each and every peer unit A-D must be identical after executing the same deltas. This is known as \u201ctotal ordering.\u201d","The ABC system  records the necessary information to maintain a high level of data consistency and imposes delta execution order constraints on deltas whose execution is dependent on the prior execution of other deltas. For example, where deltas are designated with capital letters A, B, C, D, assigned in the order of delta receipt by the dynamics manager A of peer unit A, it is possible that the deltas A, B, C, D may be properly executed in that order of receipt to preserve causality. This may even be the case if, e.g., deltas A and C originated locally from peer unit A and deltas B and D came from remote peer unit D. In some cases, however, execution of those deltas in the order of receipt will result in the changes being made out of order giving rise to a causality violation. This may arise, for example, because of differential latencies in the communication paths traversed by locally-generated and remotely-generated deltas, which can result in the deltas being received in an interleaved fashion. Moreover, even if causality preservation is achieved, the result may violate the intention preservation property, and the changes may even be nonsensical. For example, delta B may seek to insert \u201cfour\u201d before \u201clegs\u201d in the sentence \u201cA cow has legs.\u201d If delta A sought, without knowledge of delta B's change, to change \u201clegs\u201d to \u201ca head\u201d in that sentence, and is executed before delta B so as to change the context for delta B, the result is \u201cA cow has four a head.\u201d Indeed, this result makes no sense, and nor would the result if delta A were processed after delta B. As for convergence, a number of conditions may compromise the \u201csameness\u201d (i.e., replication) of the copies of the data at the peer units A-D. For example, communication faults in the network may prevent deltas from being received by some peer units A-D, causing different delta execution results. It is difficult, if not impossible, to achieve total convergence, causality preservation, and intention preservation in a practical system, but a high level of data consistency is desirable for collaboration between the peer units.","In order to achieve a high level of data consistency, each dynamics manager A-D preferably creates deltas of a predetermined format, and records in the deltas and in their respective memories certain information used to maintain data consistency. Specifically, each dynamics manager A-D assigns to each delta it creates a sequence number (\u201cSeq.No.\u201d) to indicate the sequencial position of the delta among all deltas created by that dynamics manager at the particular peer unit A-D. The dynamics manager A-D then records the assigned sequence number in the delta along with the endpoint identifier (\u201cEP\u201d) specifying the endpoint (peer unit and person) that originated the delta. The dynamics manager A-D also records in the delta at the time of its creation information specifying a single dependency. The dependency information recorded in the delta is, e.g., in the form of the sequence number and EP of the endpoint originating one other delta, for example, usually, the delta last executed immediately prior to the creation of the subject delta by the engine A-D for the same activity as the subject delta and at the originating peer unit for that delta.","Some deltas do not depend on prior deltas, for example, because the state of the telespace data is unimportant to their execution. They are called \u201cindependent deltas\u201d. For independent deltas, no such dependent sequence number need be provided. Each dynamics manager A-D extracts consistency information from the headers of received deltas, and maintains the information along with the rest of the delta information in memory.",{"@attributes":{"id":"p-0092","num":"0114"},"figref":"FIG. 9","b":["900","900","902","904","902","902","908","807"]},"The header  specifies consistency information, for example, as follows:\n\n",{"@attributes":{"id":"p-0094","num":"0117"},"figref":"FIG. 10","b":["1000","804","804","1002","1","2","804","1004","1002","1006","804","802","802","804","1008","314","1010","1012","1014","1016"]},"The vector  is important in this regard for storing information used in maintaining a high level of data consistency, and thus deserves further discussion. The vector  stores, for example, the following consistency information regarding each received delta: (a) an originating endpoint identifier (\u201cUID\u201d), which is an identification of that endpoint that is unique across the telespace; (b) an endpoint-relative sequence number, which is a running count of deltas in the telespace received from each end-point, and corresponds essentially to a per-endpoint time stamp for ordering purposes of the received deltas; (c) a dependent sequence number for the deltas, which indicates, as of the time an endpoint created a delta, it did so based on a certain prior delta in the sequence that had been executed by that peer unit (i.e., the \u201cuser seen\u201d current state). In the preferred embodiment, all of this information can be extracted from the received deltas.","During operation, when a delta is received, for example, by the dynamics manager A, the dynamics manager places the received delta in either one of the local delta queue  or the inbound delta queue , depending on whether the received delta was locally initiated or remotely initiated. Some implementations can store only a pointer to each such delta in the appropriate queue. The queues ,  are implemented, for example, as FIFO (first-in-first-out) workload buffers. (Alternatively, a single queue can be utilized in some implementations for holding both inbound and local deltas.) The dynamics manager A processes the deltas from the queues ,  on a first in, first out basis. Some implementations can use an appropriate priority algorithm for processing deltas from one or the other of the local or inbound delta queues , , for example, for load balancing and\/or latency control. It may be desirable to process all inbound deltas in the inbound queue prior to local deltas in the local queue to constrain average latency in delta processing. Alternatively, the opposite order in which local deltas are processed with priority may avoid long latency in the event of a long inbound delta queue upon reconnection of the peer unit to the network.",{"@attributes":{"id":"p-0097","num":"0120"},"figref":["FIG. 11A","FIG. 11B","FIG. 11A"],"b":["1100","1102","804","1012","1014","1106","804","1006","1108","1110","1112","1110","804","1114","1116","1006","804","1006","1128","1106","1118","804","1006","1006","1122","1016"]},"In step , the dynamics manager A determines the order of delta processing, and then involves the subroutine  of , as described above. If the current delta is dependent on a previously executed delta and if no other received delta depends on the same prior delta, as indicated by the delta sequence numbers in the delta log , the current delta is immediately executed without further consistency concerns. On the other hand, if the current delta has the same dependent sequence number, i.e., Seq. No. @ EP as another pending delta registered in the delta log , then a collision condition occurs between those deltas.","In this embodiment, the ordering of execution of deltas in the event of a collision depends on the endpoint that originated the delta, although other implementations can alternatively use other priority schemes or default ordering to resolve collisions. As implemented, each endpoint that is a member of a telespace is assigned (e.g., by the first endpoint member of the telespace) a unique endpoint number, corresponding, for example, to the order in which the endpoint originally joined the telespace. Thus, if peer unit A was the first in the telespace, it may be numbered EP, and successive new members receive numbers according to a hierarchical numbering scheme, for example, reflecting the sponsoring endpoint that invited the new member into the telespace. Thus, if endpoint EP invited two new members into the telespace, they may be numbered EP. and EP.. Then, if endpoint EP. invited three new members to join, the new members may be numbered EP.., EP.., and EP... The digits from left to right in the endpoint numbers can be referred to as first order, second order, etc. Thus, in EP.., the number \u201cone\u201d on the left is the first order, the \u201cone\u201d in the middle digit position is the second order and the \u201cthree\u201d is the third order.","The foregoing numbering scheme has special qualities, particularly suited for assigning unique designations to endpoints for use in a peer-to-peer, fully distributed collaboration system, where members can join or discontinue membership at any time or connect or disconnect temporarily from the telespace at any time. As noted, this scheme assigns a unique designation to each endpoint of each of the telespace members. Each designation of a member indicates the order in which the member joined the telespace, and, for each member invited to join (or otherwise sponsored) by another telespace member (the \u201cinviting member\u201d), it also indicates the inviting member. As more and more members are invited to join by those new members, the designations add additional orders of digits to indicate the family tree or chain of inviting members. Accordingly, the designations can be thought of as indicating the ancestry of each member added to a telespace after the founding members of a telespace. Thus, where the designations comprise a number of orders, the first order designates a founding member of the telespace, and each successive order after the first order (e.g., second, third, etc, order) designates a member invited to join the telespace by an inviting member specified by the preceding order digit. The inviting member may be a founding member or another member of the telespace of intermediate seniority and with telespace membership sponsoring privileges. In one embodiment, each inviting member is responsible for assigning telespace numbers to members it sponsors.","With this numbering scheme, in step  of , the dynamics manager A resolves dependency collisions, maintaining total ordering. As shown in , dependency collision resolution can be performed by step  comparing EP numbers on an order by order basis, and step  determining a processing order based on that comparison so that deltas with the lowest numbers in the lowest orders are scheduled for processing first. Then, step  tests whether any of the deltas have already been processed out of order and ahead of other delta(s) that should have been processed first. If no deltas have been processed out of order, then step  processes the next delta. On the other hand, if any have been processed out of order, step  rolls-back such processing to the data state immediately prior to that delta execution, and then step  \u201credoes\u201d the processing of the deltas in the proper order.","Thus, this scheme of dependency conflict resolution assures that any endpoint number having, for example, a \u201cone\u201d in the first order will be processed ahead of an endpoint number with a \u201ctwo\u201d, \u201cthree\u201d or other higher value in the first order. Where deltas have the same number value in the first order, then the second order digits are compared, etc., until an order is specified, and then that order of delta execution is realized by performing a \u201cdo\u201d, and, where necessary, \u201cundo\u201d and \u201credo\u201d, operations on the deltas.","For example, the delta log  may for illustrative purposes contain deltas and related information in the form\n\n","In this example, delta A has a sequence number 1 from endpoint ., which is dependent on sequence number 0 from endpoint . Both deltas B and C are dependent on the same delta from the same endpoint, and that delta is delta A. Delta B was generated at endpoint ., and delta C was generated at endpoint . According to the present embodiment, all three deltas are dependent deltas, and are processed in the following order: First delta A is processed because it was the first of these deltas to be received, and accordingly, the dynamics manager causes the appropriate engine to perform the data change specified by delta A. Then, delta B (as the next received delta) is processed by causing the appropriate engine to perform the data change specified by delta B. Then the dynamics manager processes delta C and notes that there is a dependency collision with delta B and that delta C has a lower endpoint number (i.e., EP) than delta B (i.e, EP.). Consequently, delta B is \u201cundone\u201d, or more specifically, the data change that was made to the stored data is unmade so as to restore or roll-back the data to its state prior to executing that data change. Then, delta C is processed and the data change specified by delta C effected. Finally, delta B is reprocessed and its data change remade. Accordingly, the order of execution of the requested data changes in this example, after roll-back and remaking, is delta A, then delta C, then delta B.","The foregoing example relates to endpoint numbers having first and second order numbers only, though the principles illustrated apply equally well to other endpoint numbers having additional, higher orders, where collision resolution requires comparison of these higher orders, as described above. Accordingly, priority upon dependency collision is assigned in the order of membership sponsorship and then chronology based on membership date as described above.","Alternatively, priority upon dependency collision can be based on endpoint numbering assigned according to characteristics of the endpoint (e.g., job title, work group or department), nature of change requested (e.g., delete paragraph or add chapter), location of change in data (e.g., change document title or change document summary), or other considerations. To illustrate the principle behind each of these bases for awarding priority, deltas from endpoints having, for example, certain characteristics can be processed in cases of collision ahead of those having other characteristics, such as the deltas from a product design team prior to the deltas from a marketing team or vice versa.","Moreover, since roll-back and remaking of data changes (sometimes called UNDOs and REDOs) are expensive in terms of overhead, it may be desirable to provide in some implementations still other forms of prioritization of delta processing. Implementations may provide alternative priority strategies, for example, depending on activity. Some activities can have one type of conflict resolution or basis for awarding priority, while others can have other types, depending, for example, on the significance of data consistency for the particular activity. Real-time activities like chat rooms may avoid roll-back and remaking of changes in order to lower response time, particularly since order of execution may be less important.","Other implementations may execute deltas in delta clusters where they are related in some way, e.g., to changes to a certain part of a document being edited or to a certain type of change, so that they all may be made at about the same time. Furthermore, excessively-delayed deltas that have sequence numbers earlier by a predetermined value than the highest sequence number for the endpoint stored in the vector  can be discarded in some implementations to avoid thrashing due to excessive redo's.","Returning to , in step , the dynamics manager A determines if the hold queue  has any deltas that were not processed previously because they depended on the prior processing of the current delta. If so, the method returns to step  to process such deltas. After all such deltas have been processed by the loop of steps ,  and , the method  returns to step .","The foregoing method of processing deltas so as to optimize data consistency is particularly advantageous in implementations, such as that discussed herein, wherein A) peer units may be temporarily disconnected from the network and thus may not receive deltas until after a long delay during which local deltas may be processed out of order; B) endpoints may dynamically join or fall off membership lists; and C) overhead associated with data consistency is minimized and distributed among the peer units.","Yet other endpoint numbering schemes can be employed advantageously in particular embodiments of the invention. For example, a scheme could be implemented that uses a pseudo-random number generator to assign unique telespace member identifiers. Uniqueness can be guaranteed if the random number generator generates adequately random numbers and the seed is fairly unique. For example, using a network adapter's MAC address as a seed for the generator and creating a 32 byte value can guarantee uniqueness not only within the telespace but also within the ABC system.","The ABC system can be multitasking and multithreading in that each tool-engine combination forming an activity can correspond to a separate dynamics manager, and multiple dynamics managers can be provided to accommodate multiple simultaneously operating activities. While a one-to-one relationship between telespaces and dynamics managers may introduce the least latency in handling deltas, thread starvation could give rise to an error or fault condition. On the other hand, single dynamics managers supporting many telespaces could give rise to congestion problems. The optimal numbers of each component will depend on the hardware application, number of participating peer units, and traffic conditions.","The ABC system can comprise plural computer systems (CS), each with one or more telespaces (TS), each instantiating one or more activity components, each activity component having one or more tool (T), engine (E) pairs, each of whose operation is coordinated by a dynamics manager (DM). Thus, the ABC system can have multiple telespaces with one or more dynamics managers. Accordingly, the ABC system can be formed, for example, as follows:\n\nABC system=\n\n, where \n\n, where \n\n. . . .\n\n. . . .\n\n, where \n","where all the activities A, Aand Areside in one or more telespaces, and \u201cn\u201d is a positive integer. Thus, by way of illustration, the following are examples of various telespace instantiations:\n\n, or\n\nor\n\n.\n\nor\n\n\n\n.\n\nand\n\n\n","where the symbol \u201c\u2282\u201d means \u201ca set comprising\u201d, and \u201cm\u201d is a positive integer. Accordingly, each telespace can instantiate of one or more activities, and the framework can have a single telespace; alternatively, each telespace can instantiate of one or more activities, and the framework can have multiple telespaces.","A software implementation of components of the above-described embodiment may comprise computer instructions and routines either fixed on a tangible medium, such as a computer-readable media, e.g. the diskette , CD-ROM , ROM , or fixed disk  of , or transmittable via a modem or other interface device, such as communications adapter  connected to the network  over a medium . Medium  can be either a tangible medium, including but not limited to optical or hard-wire communications lines, or may be implemented with wireless techniques, including but not limited to microwave, infrared or other transmission techniques. It may also be the Internet. A series of computer instructions embodies all or part of the functionality previously described herein with respect to the invention. Those skilled in the art will appreciate that such computer instructions can be written in a number of programming languages for use with many computer architectures or operating systems. Further, such instructions may be stored using any memory technology, present or future, including, but not limited to, semiconductor, magnetic, optical or other memory devices, or transmitted using any communications technology, present or future, including but not limited to optical, infrared, microwave, or other transmission technologies. It is contemplated that such a computer program product may be distributed as a removable media with accompanying printed or electronic documentation, e.g., shrink wrapped software, pre-loaded with a computer system, e.g., on system ROM or fixed disk, or distributed from a server or electronic bulletin board over a network, e.g., the Internet or World Wide Web.","Although an exemplary embodiment of the invention has been disclosed, it will be apparent to those skilled in the art that various changes and modifications can be made which will achieve some of the advantages of the invention without departing from the spirit and scope of the invention. It will be obvious to those skilled in the art that other components performing the same functions may be suitably substituted. Further, the methods of the invention may be achieved in either all software implementations, using the appropriate processor instructions, or in hybrid implementations that utilize a combination of hardware logic and software logic to achieve the same results. Further, aspects such as the size of memory, the specific configuration of logic and\/or instructions utilized to achieve a particular function, as well as other modifications to the inventive concept are intended to be covered by the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The above and further advantages of the invention may be better understood by referring to the following description in conjunction with the accompanying drawings in which:",{"@attributes":{"id":"p-0020","num":"0021"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0021","num":"0022"},"figref":["FIG. 2","FIG. 1"]},{"@attributes":{"id":"p-0022","num":"0023"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0023","num":"0024"},"figref":["FIG. 4","FIG. 1"]},{"@attributes":{"id":"p-0024","num":"0025"},"figref":["FIG. 5","FIG. 1"]},{"@attributes":{"id":"p-0025","num":"0026"},"figref":["FIG. 6","FIG. 5"]},{"@attributes":{"id":"p-0026","num":"0027"},"figref":["FIG. 7","FIG. 4"],"b":"700"},{"@attributes":{"id":"p-0027","num":"0028"},"figref":["FIG. 8","FIG. 4"]},{"@attributes":{"id":"p-0028","num":"0029"},"figref":["FIG. 9","FIG. 4"]},{"@attributes":{"id":"p-0029","num":"0030"},"figref":["FIG. 10","FIG. 4"]},{"@attributes":{"id":"p-0030","num":"0031"},"figref":["FIGS. 11A and 11B","FIG. 4"]},{"@attributes":{"id":"p-0031","num":"0032"},"figref":["FIG. 12","FIG. 11"]}]},"DETDESC":[{},{}]}
