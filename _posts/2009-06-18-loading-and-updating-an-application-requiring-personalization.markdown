---
title: Loading and updating an application requiring personalization
abstract: The invention provides a method for loading an application requiring personalization into a portable storage medium which is set up to be operated in a terminal. Personalization data for personalizing the application and possibly application data are additionally loaded into a restore module which is independent of applications stored in an application memory, is configured as a non-volatile memory, and is disposed within the portable storage medium or within the terminal. For updating an application, the personalization data and possibly application data are loaded from the restore module into the updated application. A portable storage medium has a non-volatile, application-independent restore module. System with storage medium and terminal and non-volatile, application-independent restore module.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09092775&OS=09092775&RS=09092775
owner: GIESECKE & DEVRIENT GMBH
number: 09092775
owner_city: Munich
owner_country: DE
publication_date: 20090618
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND","SUMMARY OF THE DISCLOSURE","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION"],"p":["1. Field","The invention relates to a method for loading an application requiring personalization into a portable storage medium, a method for updating an application stored in a portable storage medium, as well as a portable storage medium and a system.","2. Related Art","Portable storage media are used for keeping available applications for different areas of use. The portable storage medium has an application memory and a memory management unit, e.g. a memory controller, by which the application memory is managed. Selectively, the storage medium has a microprocessor, the task of the memory management being selectively carried out by the microprocessor. Examples of such portable storage media are smart cards equipped with a microprocessor and memory cards equipped with a memory controller. When using the portable storage medium in the mobile phone sector, the portable storage medium can be configured for example as a smart card having a security module for using a terminal (e.g. mobile phone) in a mobile phone network or be integrated in such a smart card. The smart card is for example a SIM card for the GSM system or a USIM card for the UMTS system or a similar smart card. Selectively, the portable storage medium is configured as a pay TV card for using pay TV or integrated in such a pay TV card. Selectively, the portable storage medium is a smart card integrated in a secure flash card, the secure flash card having a flash controller higher ranking than the smart card.","The portable storage medium can be read-out and written into by means of a terminal. As a terminal there is provided for example a mobile terminal for a mobile phone network, e.g. a mobile phone, PDA, smart phone, etc, or a set top box for pay TV (Pay TV) is provided. In the case of a portable storage medium, which is configured as a smart card integrated in a secure flash card, as a terminal there can be provided a flash controller, or alternatively a mobile terminal such as e.g. mobile phone, etc, PDA or smart phone.","An application for a portable storage medium normally must be personalized to the user of the application. The application first is unpersonalized, e.g. anonymous, and therefore identical and usable for each potential user. Not until upon the personalization, the initially anonymous application is made unique with personalization data for the user. The personalization data comprise for example personal identity data relating to the user and device data of a device for using the storage medium and are at least partly required so that the application can be used on the storage medium. For the personalization, first, the application is made available in an unpersonalized form. Subsequently, the personalization data are loaded into the application and the application is thus personalized.","Changes of the application at the application's manufacturer or provider require that from time to time an updated application is loaded into the portable storage medium. An updated application is made available, for example, in order to correct errors of the application, or to provide the user with additional or modified services of the application.","Conventionally, for updating an application, the updated application, which too is unpersonalized first, and the personalization data for personalizing the application are loaded from a server of the manufacturer or provider via a server-side connection into the portable storage medium. With the conventional method for updating the application it is necessary that upon each loading of an updated application the personalization data must be available at the manufacturer or provider of the application, so that they can be loaded again into the storage medium. Because of this, conventional application updates mean a high administration effort for the manufacturer or provider of the application. In addition, upon each application update the personalization data have to be loaded via the server-side connection. As the costs of the server-side connection often rise with transmitted data amount and\/or duration of the connection, the personalization data, which have to be transmitted again upon each update, might cause additional costs for the manufacturer or provider of the application and for the user of the storage medium. The costs of the server-side connection, especially in the case of application updates over the air (OTA), i.e., if there is used a (mobile) radio connection as a server-side connection, can even be of a significant amount. Another risk upon the transmission of personalization data via a server-side connection is that personalization data are strictly confidential and can be intercepted upon any server-side transmission. Upon a personalization of an application loaded for the first time in the secure environment of the manufacturer of the storage medium (\u201cpre-issuance\u201d), the risk of the personalization data being intercepted upon the server-side connection may still be acceptable. Upon the loading of updated applications after the issuance of the storage medium by the manufacturer (\u201cpost-issuance\u201d), however, the risk of personalization data being intercepted upon the server-side connection is great.","EP 1 936 574 A1 describes a loading of a Java card application requiring personalization into a Java card. An application and personalization data for personalizing the application are jointly loaded in one packet into the Java card here. The application is installed in the Java card and then the installed application is personalized with the personalization data from the packet.","It is the object of the invention to provide an efficient, cost effective and at the same time secure method for loading an application requiring personalization into a portable storage medium as well as a method for updating an application stored in a portable storage medium. A corresponding portable storage medium and system having storage medium and terminal are also to be stated.","The object is achieved by a loading method according to the independent claim . Further, there are stated an update method, a portable storage medium and a system having a portable storage medium and a terminal. Advantageous embodiments of the invention are stated in the dependent claims.","In accordance with a preferred embodiment of the invention, a method for loading an application requiring personalization into a portable storage medium which is set up to be operated in a terminal, includes:\n\n","the personalization data are loaded into the application in such a way that the application is personalized with the personalization data, and","the personalization data are loaded into a restore module which is independent of applications stored in the application memory, is configured as a non-volatile memory, and is disposed within the portable storage medium or within the terminal.","The personalization data, additionally to its loading into the application, is at least partly loaded into a restore module independent of the application and possibly further applications, and stored there in a non-volatile manner. By the personalization data being kept available in the restore module in the storage medium or terminal itself, an updated application to be loaded later into the storage medium can be personalized with the personalization data from the restore module. Keeping available the personalization data at the manufacturer or provider of the application, outside the storage medium and outside the terminal, is not required. In addition, the personalization of the updated application can be effected without a server-side connection being established. As a result, the administrative effort for the manufacturer or provider of the application is decreased. In addition, the costs for the later loading of the updated application are reduced, since only the application has to be transmitted via the server-side connection, but not the personalization data. The cost savings will be of benefit to both the manufacturer or provider of the application and the user of the storage medium. In addition, later updates of applications are particularly secure, because there are not transmitted any personalization data via the server-side connection.","Thus, with the invention, an efficient, cost effective and secure method for loading an application requiring personalization into a portable storage medium is created.","In a method according to the invention for operating a portable storage medium in a terminal, the portable storage medium contains an application which has been loaded into the portable storage medium according to the invention as described above. The application stored in the application memory and personalized generates application data during the operation of the storage medium, by which data the stored and personalized application is changed, or the application receives such application data from outside the storage medium. The application data are loaded, according to the invention, completely or at least partly into the restore module. Upon a later application update, changes which were made to the application originally stored in the application memory can be transmitted into the updated application by the application data, which were loaded from the original application into the restore module, being loaded from the restore module into the updated application.","As application data which are generated by the application there are provided for example the contents or counter readings of log files or counters, which are changed upon the execution of the application. As application data which are loaded from outside the storage medium into the application and received by the application, there are provided, for example in the case of a pay TV card, reception authorizations for receiving data contents (e.g. TV programs). Such reception authorizations change at regular or irregular time intervals, at the instigation of the card holder or of the data provider. Alternatively, as application data there are provided other data generated or received in the application during the operation of the storage medium, which effect that the application is changed.","The application is loaded selectively completely via the server-side connection from the server directly into the application memory within the storage medium. Selectively, when the application is loaded only partly via the server-side connection, the application for example is loaded via the server-side connection into the terminal and then is loaded via an external connection between the terminal and the storage medium (hereinbelow referred to as external connection, in contrast to an internal connection within the storage medium) from the terminal into the storage medium.","The application is personalized with the personalization data selectively outside the application memory or within the application memory. For a personalization outside the application memory, which is illustrated in , selectively first the personalization data are loaded into the application and the application is thus personalized with the personalization data, and then the personalized application is loaded into the application memory. For a personalization within the application memory, which is illustrated in  and , the unpersonalized application, i.e. requiring personalization, first is loaded into the application memory. Then the personalization data are loaded into the application already present in the application memory, so that the application is personalized with the personalization data within the application memory. The personalization data are stored here selectively first in the application memory and then stored from the application memory into the restore module () or are first stored in the restore module and then stored from the restore module into the application memory ().","In the event that the application is personalized outside the application memory, the application is personalized selectively already in the server at the manufacturer or provider of the application. Therefore, via the server-side connection there is transmitted the personalized application. Alternatively, the application is personalized within the terminal, but outside the storage medium, and the personalized application is loaded via the external connection from the terminal into the storage medium, more precise into the application memory. In this variant, the personalization data and the unpersonalized application are transmitted via the server-side connection.","The application loaded into the application memory, in case of need, is installed in the application memory. In case of need, the personalization data are loaded into the installed application.","Selectively, the application is a Java card application or a Java card apple according to the specification of the Java card virtual machine (JCVM Spec e.g. version 2.0, 2.2, 2.2.1, 2.2.2, 3.0). In this case the application and the personalization data are selectively loaded in a common packet into the terminal or into the storage medium. The packet is for example a Java card CAP file, selectively stored in a Java card JAR file. The personalization data are contained selectively in a \u201ccustom component\u201d (JCVM Spec 3.0, chapter 6.1.2) of a CAP file or JAR file. The custom component, completely or at least partly, is stored according to the invention in the restore module. An updated application loaded later can be personalized with the custom component of the restore module.","The invention further provides a method for updating a personalized application stored in a portable storage medium which is set up to be operated in a terminal, by loading an updated application, by which the stored application is to be replaced, and by loading personalization data for personalizing the updated application, wherein\n\n","The personalization of the updated application is effected with the personalization data stored in the restore module, and without a server-side connection being established. Therefore, there is neither required that the personalization data are kept available at the manufacturer or provider of the updated application nor required a server-side connection. Transmissions of the personalization data for personalizing the updated application are effected exclusively within the closed system of the portable storage medium and the terminal, but not via server-side connections. Therefore, the method according to the invention for updating an application is particularly cost effective and particularly secure.","The application, which is to be replaced by the updated application, has been loaded for example according to the method according to the invention for loading an application into the storage medium, the personalization data also having been loaded into the restore module.","Selectively, upon the method for updating an application, the application stored in the application memory (and possibly installed) and personalized, which is to be replaced, has generated application data during a preceding operation of the storage medium, by which data the stored and personalized application has been changed. The application data have been loaded completely or at least partly into the restore module. Upon the updating of the application by loading the updated application, the application data, which have been loaded from the original application into the restore module, are loaded from the restore module into the updated application, in such a way that the updated application is changed with the application data. In this way, changes which have been made to the application originally stored in the application memory are transmitted to the updated application.","Selectively, the application is deleted from the application memory. Selectively, the application is deleted after the updated application has been loaded into the application memory. Selectively, the application is overwritten with the updated application.","The variant of the invention in which application data, too, are stored in the restore module and are loaded into the updated application has the additional advantage that application data, which could get lost in particular upon a deletion of the original application, are retained for the updated application.","The updated application is loaded selectively completely via the server-side connection from the server directly into the application memory within the storage medium. Selectively, when the updated application is loaded only partly via the server-side connection, the updated application for example is loaded via the server-side connection into the terminal and then is loaded via an external connection between the terminal and the storage medium into the storage medium.","The updated application is personalized with the personalization data selectively within the application memory (shown by way of example in ) or outside the application memory, e.g. within the terminal (shown by way of example in ). The updated application, however, is always personalized here with personalization data from the restore module, and without a server-side connection being established.","Selectively, the server-side connection is configured as a radio connection (OTA, \u201cover the air \u201d), in particular as a mobile phone connection.","Selectively, the restore module is disposed within the storage medium. This variant has the additional advantage that the restore module is provided independently of the terminal used and organizationally closely adjacent to the application memory. In this way, the restore module can be easier protected against unauthorized access to its memory contents than outside the storage medium.","The restore module is selectively access-protected. The access protection is achieved selectively by an authentication requirement and\/or an encrypted storage of the data in the restore module. Selectively, an access to personalization data stored in the restore module is made possible only on the occasion of an authorized loading of an application or updated application into the storage medium. For example, for loading an application or updated application there is required an authentication. The authentication for the loading of the application comprises selectively an authentication for accessing the personalization data in the restore module. Selectively, the personalization data are stored in the restore module in such a way that they are stored in encrypted form in the restore module.","A portable storage medium according to the invention is set up to carry out a method according to the invention and has an application memory which is set up to store applications, as well as a restore module which is configured as a non-volatile memory and which is independent of the applications stored in the application memory. The restore module is set up to keep available personalization data in the application memory for the personalization of applications or updated applications, so that a personalization of (updated) applications is possible without keeping available the personalization data at the manufacturer or provider of the application and without a server-side connection.","The portable storage medium is selectively provided with a microprocessor. Selectively, the storage medium is a Java card. The application is selectively configured as a Java card application or Java card applet. Selectively, the storage medium is configured as a pay TV card for using pay TV or is integrated in such a pay TV card. Selectively, the storage medium is configured as a smart card having a security module for using a terminal in a mobile phone network, e.g. (U)SIM card, or is integrated in such a smart card (e.g. (U)SIM card). Selectively, the storage medium is configured as a secure flash card having a controller and a flash memory, or is integrated in such a secure flash card.","As a terminal there is provided for example a mobile terminal such as e.g. mobile phone, PDA, smart phone or the like, a set top box for pay TV or a controller of a secure flash card.","The restore module and the application memory can be brought in a data exchange connection with each other preferably via an internal connection. The storage medium, in particular the restore module and the application memory, [sic] can be brought in a data exchange connection with each other preferably via one or more external connections. The one or more external connections can in particular be connections according to ISO\/IEC 7816-3&4.","A system according to the invention with a portable storage medium and a terminal for operating the storage medium is set up to carry out a method according to the invention. The system has in the storage medium an application memory which is set up to store applications. The system further has in the storage medium or in the terminal a restore module which is configured as a non-volatile memory, and which is independent of applications stored in the application memory. The portable storage medium further is selectively configured as described above.","The restore module is selectively configured as an application, for example as a Java card application or as a Java card applet, selectively as a group of several cooperating applications, selectively as a library, e.g. as a Java card library, or as a group of cooperating libraries.","A personalization in the context of the invention can selectively be a personalization prior to the issuance of the storage medium by the manufacturer(\u201cpre-issuance\u201d), or a personalization after the issuance of the storage medium by the manufacturer of the storage medium (\u201cpost-issuance\u201d). A post-issuance personalization is carried out for example by a provider of applications different than the manufacturer of the storage medium.","The loading of personalization data from the restore module and into the restore module is carried out selectively at the instigation of an application personalized or to be personalized, or at the instigation of the restore module, or at the instigation of a third instance different than the application to be personalized and the restore module. This third instance is selectively configured as a further application.","An application or updated application loaded into the application memory, in case of need, is installed in the application memory. In case of need, the personalization data are loaded into the installed application or updated application.",{"@attributes":{"id":"p-0058","num":"0064"},"figref":["FIGS. 1 to 4","FIG. 9"]},"In a first embodiment according to , there are stored personalization data PD for personalizing the application AP from a server SER outside the smart card SC and outside the terminal EG, via a server-side connection LS, into the application AP stored in the application memory AS, on the one hand, so that the application AP is personalized, and into a restore module (backup module) BM, on the other hand, and thus kept available for later personalizations of updated applications loaded later.","In a second embodiment according to , there are stored personalization data PD for personalizing the application AP from a server SER outside the smart card SC and outside the terminal EG via a server-side connection LS into the application AP stored in the application memory AS, so that the application AP is personalized. The personalization data PD are stored from the application memory AS via an internal connection L into the restore module (backup module) BM.","In a third embodiment according to , in contrast to the one of , there are first stored the personalization data PD from a server SER outside the smart card SC and outside the terminal EG via a server-side connection LS into the restore module BM and then from the restore module BM via an internal connection L into the application AP stored in the application memory AS, so that the application AP is personalized.","In a fourth embodiment according to , the application AP is personalized at the server SER outside the smart card SC and outside the terminal EG. Via a server-side connection LS there are loaded the personalization data into the restore module BM and the personalized application into the application memory AS.","In the embodiments of , the server-side connection LS, deviating from the representations in , may lead from the server SER selectively only to the terminal EG, and the further connection to the smart card SC be formed by an external connection L or L, as the one shown in .",{"@attributes":{"id":"p-0064","num":"0070"},"figref":["FIGS. 5 to 8","FIG. 9"]},"In a first embodiment of loading an updated application A-AP, represented in , the updated application A-AP is loaded via a server-side connection LS in an unpersonalized form into the application memory AS of the smart card SC (). Then, personalization data PD\u2014and possibly application data AD\u2014, which have been loaded for example according to any of  into the restore module (backup module) BM, are loaded via an internal connection L from the restore module BM into the updated application A-AP, so that the updated application A-AP is personalized ().","In a second embodiment of loading an updated application A-AP, represented in , the updated application A-AP in an unpersonalized form is loaded from the server SER via a server-side connection LS into the terminal EG. The personalization data PD, and possibly application data AD, are loaded via an external link L from the restore module BM into the updated application A-AP kept available in the terminal EG, so that the updated application A-AP is personalized outside the smart card SC and at the same time within the terminal EG (). Then the personalized updated application A-AP+PD (+AD) is loaded via an external connection L into the application memory AS of the smart card SC ().",{"@attributes":{"id":"p-0067","num":"0073"},"figref":"FIG. 9","b":["3","3","2","1","3","1","2"]},{"@attributes":{"id":"p-0068","num":"0074"},"figref":["FIGS. 10 to 12","FIGS. 1 to 9"]},{"@attributes":{"id":"p-0069","num":"0075"},"figref":["FIG. 10","FIG. 10","FIG. 6","FIG. 10"],"b":"7"},{"@attributes":{"id":"p-0070","num":"0076"},"figref":["FIG. 11","FIG. 11","FIG. 6"],"b":"7"},{"@attributes":{"id":"p-0071","num":"0077"},"figref":["FIG. 12","FIG. 11"]}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DESCRIPTION OF THE DRAWINGS","p":["In the following, the invention is explained in more detail on the basis of exemplary embodiments and with reference to the Figure.",{"@attributes":{"id":"p-0046","num":"0052"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0047","num":"0053"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0048","num":"0054"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0049","num":"0055"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0050","num":"0056"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0051","num":"0057"},"figref":["FIG. 6","FIG. 5"]},{"@attributes":{"id":"p-0052","num":"0058"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0053","num":"0059"},"figref":["FIG. 8","FIG. 7"]},{"@attributes":{"id":"p-0054","num":"0060"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0055","num":"0061"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0056","num":"0062"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0057","num":"0063"},"figref":"FIG. 12"}]},"DETDESC":[{},{}]}
