---
title: Method and apparatus to report resource values in a mobile network
abstract: In current systems, a typical way to collect application statistics includes sending requests to a resource manager that can access the resource hardware via a device driver. Current systems require multiple synchronous transactions between the processes, which results in the systems consuming large amounts of central processing unit resources that lead to sub-optimal rates of information retrieval. A method and apparatus configured to use asynchronous messaging across all modules and to return hardware statistics directly from the hardware to an application process, thereby bypassing transactions between the application and the resource manager, and bypassing similar transactions between the resource manager and a device driver. Embodiments of the invention are provided for minimizing the power consumed by the memory and minimizing the amount of dedicated memory necessary to perform.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08533360&OS=08533360&RS=08533360
owner: WiChorus, Inc.
number: 08533360
owner_city: Santa Clara
owner_country: US
publication_date: 20101007
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["This application claims the benefit of U.S. Provisional Application No. 61\/278,520, filed on Oct. 7, 2009, the entire teachings of which are incorporated herein by reference.","In subscriber aware networks, such as Worldwide Interoperability for Microwave Access (WiMax) networks, High Speed Packet Access (HSPA) networks, 3Generation Partnership Project Long Term Evolution (3GPP LTE) networks etc. Billing servers or accounting servers may be used to track activities on a per-subscriber basis, such as for billing subscribers for their respective wireless calling minutes.","Embodiments of the present invention include methods, apparatuses, and computer program products for reporting resource values in a mobile network. An example embodiment of the present invention includes, for example, an apparatus, sometimes referred to herein as a functional element, in a mobile network node that employs modules configured to report resources as may be necessary. Specifically, a first module, a notification module, is configured to notify a resource manager of a buffer that contains subscriber information. A second module, a buffer fill module, is configured to fill a buffer with a pointer to resources in the network and is further configured to be interconnected operably to a replacement module, which replaces the resource pointer with a corresponding resource value. A reporting module reports the filled buffer.","According to another example embodiment, there can be a second apparatus for reporting resource values in a data plane of a mobile network. The apparatus can include a module configured to fill a buffer with information pertaining to subscribers in a mobile network, including the services corresponding to each of the subscribers and the resource values corresponding to each of the services. The second apparatus further includes a module configured to report the buffer.","A description of example embodiments of the invention follows.","A typical approach to collect application statistics is to send requests to a resource manager in a control plane that can access resource hardware via a device driver, where the resource hardware, such as a counter, keeps track of activity occurring in a data plane. The resource manager and device driver may both be located in a central processing unit (CPU). In the typical approach, an application sends a synchronous read message to the resource manager. Following receipt of the synchronous read message, the resource manager sends a synchronous message to the driver, causing the device driver to read statistics from the hardware. Throughout the process, multiple synchronous transactions or messages are exchanged, meaning the resource manager waits for requested information from the driver or intermediate modules, and the device driver waits for its response from the hardware, and, while waiting, the resource manager, intermediate modules (if any), and device driver perform no other activities. Synchronous operations are fine for small volumes of subscribers, but as subscribers increase in number, such as with the advent of 4G wireless networks, the synchronous approach will be inefficient and result in consuming large amounts of CPU resources, which can produce a sub-optimal rate of information retrieval.","In the case of maintaining counters in line cards in a network gateway, for example, and having internal retrieval activities in the same line card, current methods begin with an application's sending a synchronous message to a resource manager, the resource manager's responsively sending a synchronous message to the device driver, the device driver sending a synchronous message to the hardware resource, the hardware resource responding in kind to the driver, the driver's responding in kind to the resource manager, and the resource manager responding in kind to the application. Similarly, current methods for processes across line cards include two additional synchronous messages: one synchronous message sent from the application on a first card to the application on a second card in order to begin the process, and a second synchronous message sent from the application on the second card to the application on the first card in order to end the process.","Embodiments of the present invention can allow for the use of asynchronous messaging across all modules and returning hardware statistics, such as statistics from counters, directly from the hardware to an application process. Therefore, an embodiment of the present invention has an ability to bypass transactions between the application and the resource manager, and to bypass similar transactions between the resource manager and device driver. Alternatively, example embodiments of the present invention can be applied to bypassing transactions between cards, thereby removing cross-card synchronous communication. It should be understood that at least two levels of efficiency are achieved first, asynchronous activities enable requesting modules, such as the resource manager, to conduct other activities or release its resources back to its host CPU, and second, bypassing transactions can use fewer control plane resources, and possibly no control plane resources in cases when return of the information from the hardware device is reported back to the requesting application via the data plane absent any control plane interaction.","A further optimization of alternative example embodiments of the present invention includes sending a command to return a \u201cbulk of operations to hardware\u201d and retrieve them in a single pass of messaging across these processes. This example embodiment may lower inter-process communications (IPCs) significantly, eliminate synchronous calls, and significantly increase speed of retrieval.","Additional alternative example embodiments of the invention include any or all of the modules being configured to operate in an asynchronous manner relative to the activities of the resource manager, and further can include any of the modules configured to operate at a data plane of a network functional element or multiple combinations of the modules configured to operate at both the data plane and the control plane of the network functional element.","Alternatively, example embodiments of the present invention can include a buffer being filled with information regarding subscribers in the mobile network, where information can include representations and indications of the subscribers, subscribers' corresponding provisioned services, resource values corresponding to the provisioned services, or other representative subscriber information as may commonly employed or hereafter developed. In example embodiments with modules included on the network functional element, as well as external functional elements or devices, the modules may receive the buffer via transmission of the buffer in the form of a traffic-packet, or, alternatively, the modules may receive a pointer to the buffer. Any of the modules being interconnected operably to one another or other network elements and configured to perform operations such that statistics relevant to a subscriber or set of subscribers in the mobile network may be available to applications external to the functional element.","Embodiments of the present invention provide various technical advantages of conventional methods and apparatuses for reporting resources in a network node. Some of these technical advantages are shown and described in the description of the present invention. Certain embodiments of the present invention may enjoy some, all, or none of these advantages. Other technical advantages may be readily apparent to those skilled in the art from the following figures, description, and claims.",{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 1","b":["100","100","100","101","150"],"sup":["rd ","th"],"i":["a","g. "]},"The access network  can connect basic network elements such as a mobility management entity (MME) (not shown), home location register (HLR) (not shown), home agent , gateways -, or other known network elements. The access network  connects to at least one base transceiver station -, either directly or through additional networks, such as an edge network (not shown), which connects mobile devices -via a telecommunications interface  or wireless medium, e.g., an air interface. The home agent  further connects the wireless network  to external networks, e.g., the Internet  or a mobile switching center  containing service portals -. The service portals -can provide support for multiple service types through use of, for example, an authentication, authorization, and accounting (AAA) server , dynamic host configuration protocol (DHCP) server , billing server , home policy function (PF) server , or other type of portal that may be used at the mobile switching center . The AAA server may provide authentication services to validate a subscriber, authorization to determine the subscriber's rights, and accounting to determine subscriber's usage. The DHCP server may provide for address allocation services in a manual, automatic, or dynamic manner, or as otherwise provided by a network administrator. The home PF server may provide general policy rules or application dependent policy rules. The home PF server may also evaluate network requests against the policies and may be associated with a home policy database, which may be associated with a network service processor (NSP) .","Continuing to refer to , traffic , originating at a mobile device such as a portable computer mobile device , may travel toward its respective base station via a wireless medium . The base stations may, in turn, forward the traffic  to a corresponding gateway via a wired or wireless medium . The gateway can be any of a multitude of wireless gateways, such as an Access Signaling Node Gateway (ASN-GN), Gateway GPRS Support Node (GGSN), Serving General Packet Radio Service Support Node (SGSN), System Architecture Evolution (SAE) gateway, or other currently known or hereafter-developed gateway. In the example network , the gateway contains at least one functional element , such as a line card, that supports traffic packets, or other traffic signals, at traffic rates; multiple line cards in a chassis -can also be present.","An example embodiment of the present invention includes a subscriber-aware switch, such as switch  in , directs traffic from a subscriber to the specific line card where the subscriber's profile is maintained; for example, the switch can be configured to determine a subscriber profile associated with the communications traffic . Details of a subscriber-aware switch are described further in Applicants' pending U.S. patent application Ser. No. 12\/900,354 being filed concurrently herewith, entitled \u201cMethod and Apparatus for Switching Communications Traffic in a Communications Network\u201d by Santosh Chandrachood and Pawan Uberoy, which claims priority to Applicants' U.S. Provisional Patent Application No. 61\/278,496, filed Oct. 7, 2009, entitled \u201cA Method and Apparatus for Subscriber Distribution and Load Balancing Using Mid-Plane Design in a Subscriber Aware Platform Such as ASN Gateway, GGSN, SGSN etc.\u201d by Chandrachood et al., the entire teachings of both applications being incorporated herein by reference in their entirety. The switch  is a subscriber-aware switch and has knowledge of the subscriber's profile location, whereas previous switches are non-subscriber-aware switches, for example, such as a multiplexer switch , which merely switch traffic without being aware of the traffic's destination.","In an example of a prior art access portal , the portion of the network includes similar elements and components as the network , including, for example, subscriber devices -connected to base stations -via a wireless medium . The base stations -are similarly connected to a gateway node via mediums . The gateway may include a multiplexer switch , which simply forwards traffic signals from an input to an output based on header information, and may include a line card (or multiple line cards -) for processing functions. However, the prior art example embodiments rely on synchronous resource reporting, where the messages execute sequentially; while one entity is waiting for a response from a second entity, the execution process is suspended. The synchronous messaging system of the prior art example requires more wait time as the number of messages sent increase, thereby increasing run time and resources.","For example, in reference to the blown-out prior art synchronous messaging , referencing a line card , a synchronous-messaging example is illustrated. In order to provide resource statistics to application , elements of the line card must perform a series of synchronous messages. The synchronous messaging series occurs in a control plane (i.e., a slow path) and includes communications between a sub-application , resource manager , driver , hardware , and application . Synchronous messaging here is communication between these processes, which is un-buffered and requires each process to wait until the data or message between the two processes has been transferred or completed. Throughout the entire process of reporting statistics to the application , multiple synchronous messages or transactions are sent between each pair of processes cause inefficient results, consume large amounts of CPU resources, and produce sub-optimal rate of retrieval.","In the example embodiment of the prior art synchronous messaging, the sub-application sends a synchronous message to the resource manager requesting hardware statistics; before the resources manager can send a message to the driver , the resource manager must give a response to the sub-application first. This pattern, of request message\/response message pertains to all processes. In other words, the resource manager sends a synchronous message to the driver , which responds and then sends a synchronous message to the hardware , which responds. In order for the statistics to be reported to the application , the processes must reverse order and send the information upwards. In other words, the hardware sends a synchronous message to the driver , which responds and sends a synchronous message to the resource manager . The resource manager responds to the driver and sends a synchronous message to the sub-application , which responds. After all of these synchronous processes complete, the sub-application can send a synchronous message to the application , which can include the statistical reports.","Example embodiments of the present invention can include asynchronous messaging and fast-path forwarding using a data plane. Resource management employing asynchronous messaging systems do not require response return, and, therefore, allow for scalable resource allocation and messaging without information loss. In an example embodiment of the present invention, large numbers of subscribers can be assigned to one or more hardware counters on the network  per subscriber. Details of a method for assigning resources are described further in Applicants' pending U.S. patent application Ser. No. 12\/900,243 being filed concurrently herewith, entitled \u201cMethod and Apparatus for Assigning Resources in a Network Node\u201d by Santosh Chandrachood, which claims priority to Applicants' U.S. Provisional Patent Application No. 61\/278,486, filed Oct. 7, 2009, entitled \u201cA Method and Apparatus to Allocate Network Processing Unit Resources Dynamically in Fast Path Without Host CPU Involvement and Without Statically Holding Up Resources\u201d by Chandrachood, the entire teachings of both applications being incorporated herein by reference in their entirety.","In order to report statistics about the counters, the hardware counters can be polled periodically and report the subscriber-hardware statistics using asynchronous messaging in a data plane , or in the data plane and a control plane . An example embodiment of a function element is illustrated in the blown out example embodiment of asynchronous messaging .","The functional element , which can be a line card or a line card designated as an anchor line card (e.g., ) that includes a subscriber's profile. The functional element includes a control plane , which is a slow path and a data plane , which is a fast path. The control plane can contain a sub-application , resource manager , and driver . The data plane can contain hardware . In an example embodiment of the present invention, the sub-application can send an asynchronous message to the driver , which can immediately send an asynchronous message to the hardware . The hardware can immediately, from the data plane, send an asynchronous message to the application in a fast-path , from the data plane to the application without going through the control plane . Additional example embodiments are explained in reference to .",{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 2A","b":["200","260","297","298","260","260","263","297","260","263","297","226","264","298","227","221","222","223","227"],"i":["a ","a","b "]},"The NPU  is interconnected operably to the functional element  via a fabric . The fabric  further can interconnect operably multiple functional elements (not shown) in a chassis. The NPU  can be interconnected operably to the CPU  via a peripheral component interconnect (PCI) bus , or other method of interconnecting or integrating circuitry, for example, a traffic rate bus that can be operating at traffic rates or multiples thereof. The CPU  can communicate with other nodes at the control plane  level via a control channel. The CPU  can control states of traffic modules, such as the NPU , operating at the data plane level via a CPU-to-NPU control channel. One or both of the NPU  and CPU  may be coupled to a memory , where the memory can be a ternary content addressable memory (TCAM) or other finite memory as may be known or hereafter developed.","The functional element  can include egress output ports  from which traffic can be sent to sub-elements within a same node  as the functional element  or to an external node . Both or either of the same node  and external node  can be a type of element in a network, such as the network  of , for example, the node can be a client, a server, a peer, or other network element commonly employed or hereafter developed. The same node  and the external node  may include, for example, a billing application -(e.g., billing server in ), an accounting server -, and an element management system (EMS) -. Alternatively, another example embodiment may include additional applications, management entities, servers, or other services commonly known or hereafter developed applicable to hardware resources.","In one example embodiment, a traffic packet  can enter the NPU  via the fabric  or via an ingress input port , the ingress input port  being decided based on packet header information, such as protocol information. The traffic packet  enters the hardware  of the NPU  located in the data plane . The control plane  receives the packet  from the data plane  via bus . The traffic packet  being associated with a subscriber (not shown), where the subscriber can be assigned to multiple hardware counters.","In one example embodiment of the present invention, a series of asynchronous messages  can be performed to report statistics to an application. The billing application may require statistics or a network operator may program or decide hardware counter statistics to be reported to other network entities. The billing sub-application  can send an asynchronous message to the resource manager  in the control plane . Without waiting for a response, the resource manager  can send an asynchronous message to the driver , which can send an asynchronous message to the hardware , located in the data plane. The hardware  can return hardware resource statistics to the driver , which can report the hardware resource statistics to the billing application using an asynchronous return message.","In an alternative example embodiment, a series of asynchronous messages  can be perform to report statistics to an application. The billing sub-application  can transmit an asynchronous message to the driver , which can, in turn, transmit an asynchronous message to the hardware  located at the data plane . The hardware , in the NPU  can directly report the hardware statistics from the data plane  to the billing application , without return response to the control plane .","In yet another alternative example embodiment of the present invention, a series of asynchronous messages  can be performed to report statistics to an application. The billing sub-application  can send an asynchronous message to the hardware  directly, bypassing all processes in the control plane, thereby saving the CPU  resources and improving production of near-optimal or optimal rate of information retrieval. The hardware  reports the statistical results directly from the data plane to the billing application ","In alternative example embodiments, an application on one card can acquire statistical results or information from hardware on another card, bypassing any inter-process communication or synchronous messaging. In yet another alternative example embodiment, an application can specify specific statistics relevant to a subscriber or set of subscribers, such that the relevant statistics can be acquired for all such subscribers with a single transaction and flow of process invocation without synchronous messaging. Further alternative example embodiments can include an application requesting a direct return delivery of statistical results from a device driver, without mediation of a resource manager process.","Alternatively, another example embodiment may include resource processes occurring between two line cards or across multiple line cards. In this example embodiment, the same series of asynchronous messages , , and  can occur between two line cards or across multiple line cards on the same or different network elements.",{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 2B","FIG. 1"],"b":["200","160","200","281","282","383","200","284"],"i":["b ","a ","b ","b "]},"In alternative example embodiments, a buffer, such as the buffer of , can be reported to an external node, such as the external node  of , by transmitting the buffer or a portion of the buffer. Alternatively, another example embodiment can transmit the buffer to an element of the same node, such as the node  of , by coping the buffer into a traffic packet without any modifications. The buffer can be reported to any node or network sub-element in the network by other methods commonly employed or hereafter developed.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":["FIG. 2C","FIG. 1"],"b":["200","120","200","285","286","287","288","285","245","251","285","286","286","245","248","287","286","248","251","245","287","248","249","248","288","245","288","245","248","287"],"i":["c ","a ","c "]},"Alternatively, another example embodiment can include the reporting module  receiving a copy of the buffer  directly from a memory, such as the memory  of . Another alternative example embodiment of the present invention can include, for example, the modules being in any configuration in system of any physical or logical configuration.",{"@attributes":{"id":"p-0045","num":"0044"},"figref":["FIG. 3A","FIG. 1","FIG. 4","FIG. 1"],"b":["300","380","160","300","445","100","391","392"],"i":["a ","a ","a ","a "]},"In alternative example embodiments, the buffer can be reported to an external node, such as the external node  of , by transmitting the buffer or a portion of the buffer. Alternatively, another example embodiment can transmit the buffer to an element of the same node, such as the node  of , by coping the buffer into a traffic packet without any modifications to the buffer. The buffer can be reported to any node or network sub-element in the mobile network by other methods commonly employed or hereafter developed.",{"@attributes":{"id":"p-0047","num":"0046"},"figref":["FIG. 3B","FIG. 1"],"b":["300","380","160","380","393","394","393","345"],"i":["b ","a "]},{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 4","FIG. 1","FIG. 2B","FIG. 2A","FIG. 2A"],"b":["400","435","445","445","120","445","445","445","445","281","445","442","457","453","1","453","3","453","1","453","3","448","443","445","442","202","457","263"],"i":["a","b","a","b ","b ","a","b ","a","b ","a ","b ","a ","a","c","a","a","b","b","a","f","a ","a","c "]},"In alternative example embodiments, the subscriber identifiers -can include, for example, a unique serial number of a subscriber device, a temporary identification number in a roaming network, an international mobile subscriber identity (IMSI) associated with a global system for mobile communications (GSM) or universal mobile telecommunications system (UMTS).","The buffer can include information relating to the subscriber -, such as classifiers --- and ---, which may be subscriber-specific classifiers or a group of classifiers shared among subscribers. Classifiers --- and --- can include a multitude of information about the subscriber, for example, a rate limitation, type of service, rules or actions associated with the type of service, or other commonly known or hereafter developed subscriber information for use in a mobile communications network. In one example embodiment, the subscriber identifiers -may be associated with the same, similar, or different types of classifiers or number of classifiers --- and ---. For example, a subscriber in a mobile communications network with subscriber identifier S , can have a first classifier - that includes the type of service as being a premium level service, such as all voice calls receiving high-priority classification. Subscriber identifier S may have a second classifier - that includes the counter values corresponding to a type of service.","In alternative example embodiments of the present invention, subscriber identifiers -and classifiers --- and --- can be combined to determine resources that can be used or needed by a certain subscriber or certain group of subscribers. The buffer stores pointers to resources -, such that the hardware resources -can include pointers to counters located in a different network element being accessible to the buffer . Additional information  may be stored in the buffer as determined by a network operator or other subscriber information as may be useful for determining or storing for use in application statistics.","The buffer can be the same buffer as the buffer during a different stage of the buffer fill procedure. In an alternative example embodiment, the buffer can be an exact replica of the buffer , also located in a memory, such as the memory  in . The buffer can include the same information as stored in the buffer , such as the recipient address , the subscriber identifiers -, the classifiers --- and ---, and the additional information . In an example embodiment, the additional information  may include, for example, representations of subscribers or a subset of subscribers handled by a node in the mobile network. Continuing to refer to the present example embodiment, during a stage of the buffer fill procedure (as described in reference to ), the buffer can replace the hardware resource pointers -with resource values -. The resource values -can include, for example, accounting information or billing information for a subscriber or service; alternatively, the resource values -can be hardware counter values. In replacing the resource pointers -with resource values -, the example embodiment optimizes the procedure and saves network resources without having to copy the buffer or stack multiple times. Alternatively, another example embodiment can include certain portions or entire buffers to be copied or relocated to other network elements.","Further example embodiments of the present invention may include a non-transitory computer readable medium containing instruction that may be executed by a processor, and, when executed, cause the processor to monitor the information, such as components or status, of at least a first and second network element. It should be understood that elements of the block and flow diagrams described herein may be implemented in software, hardware, firmware, or other similar medium determined in the future. In addition, the elements of the block and flow diagrams described herein may be combined or divided in any manner in software, hardware, or firmware. If implemented in software, the software may be written in any language that can support the example embodiments disclosed herein. The software may be stored in any form of computer readable medium, such as random access memory (RAM), read only memory (ROM), compact disk read only memory (CD-ROM), and so forth. In operation, a general purpose or application specific processor loads and executes software in a manner well understood in the art. It should be understood further that the block and flow diagrams may include more or fewer elements, be arranged or oriented differently, or be represented differently. It should be understood that implementation may dictate the block, flow, and\/or network diagrams and the number of block and flow diagrams illustrating the execution of embodiments of the invention.","The teachings of all patents, published applications and references cited herein are incorporated by reference in their entirety.","While this invention has been particularly shown and described with references to example embodiments thereof, it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the scope of the invention encompassed by the appended claims."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The foregoing will be apparent from the following more particular description of example embodiments of the invention, as illustrated in the accompanying drawings in which like reference characters refer to the same parts throughout the different views. The drawings are not necessarily to scale, emphasis instead being placed upon illustrating embodiments of the present invention.",{"@attributes":{"id":"p-0007","num":"0006"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0008","num":"0007"},"figref":"FIG. 2A"},{"@attributes":{"id":"p-0009","num":"0008"},"figref":"FIG. 2B"},{"@attributes":{"id":"p-0010","num":"0009"},"figref":"FIG. 2C"},{"@attributes":{"id":"p-0011","num":"0010"},"figref":"FIG. 3A"},{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 3B"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
