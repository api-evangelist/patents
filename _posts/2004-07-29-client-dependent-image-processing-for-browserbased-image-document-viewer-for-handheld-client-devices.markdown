---
title: Client dependent image processing for browser-based image document viewer for handheld client devices
abstract: Methods and systems that dynamically control and/or direct document image processing based on one or more of client device display capabilites, image formats supported by the client device, network bandwidth, document file format, document content and user hints.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07721204&OS=07721204&RS=07721204
owner: Xerox Corporation
number: 07721204
owner_city: Norwalk
owner_country: US
publication_date: 20040729
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS"],"p":["1. Field of Invention","This invention relates to image processing as a function of the image viewing client device.","2. Description of Related Art","A user typically likes to view a document on a handheld wireless device before deciding to print, facsimile or e-mail the document. A handheld wireless device, such as, for example, a personal digital assistant (PDA), a cellular phone or a miniaturized computing device, has relatively little screen surface area for viewing documents, as well as little memory for storing the document or the applications for all the document formats a user can conceivably access and view.","Current solutions either restrict the document types that can be viewed on handheld client devices, e.g., web pages with graphics interchange format (GIEF) files, show only the ASCII text of the document, provide viewers for a small set of document types, or do not provide viewers at all. In these current solutions, the documents can exist on the handheld client device, a server, e.g., mail server, or any document file\/management system in their environment. Generally, documents that do not reside on the handheld client device are typically too large to quickly and\/or efficiently transmit over today's wireless networks.","A large portion of the information present in typical documents may be \u201cbest\u201d retrieved by using the document image, i.e.: the visual representation, rather than the ASCII representation of the information. This approach is obvious for scanned data, where no ASCII representation is available unless OCR has been additionally performed. However, using the document image to retrieve information in the document may also extend to spreadsheets, where the spatial organization is important; letterheads for telephone numbers, dates, and other contact data; and PowerPoint presentation slides, where almost all information is spatially organized; and the like. Any graphic, table, picture or drawing has an important spatial organization, which can be seen from the two pages  and  of an example patent document  in .","Generally, the document has to be represented on a small screen of the handheld client device, such as, for example, 96\u00d740, 160\u00d7160 or 240\u00d7320 pixels. Here, the exact number of pixels is of lower importance, what is important that the physical and pixel-wise dimensions of the display are smaller than the dimensions commonly used on workstations and the like. One approach is to scale the document page image to the client device screen, and, on zooming, scale the appropriate document image regions to the screen. When displaying images on a small screen of a handheld wireless device, an obvious trade-off has to be made between image quality and transmission speed.","This invention provides methods and systems that replace the image scaling approach above with client dependent image processing that is a function of at least one or more of a client device parameter, data transmission capability, document type and\/or format, and user input.","This invention provides methods and systems that create image views of documents that can be used for document identification and data retrieval on handheld client devices.","In various exemplary embodiments, this invention provides methods and systems that actively modify processing parameters of an image as a function of the image viewing client.","In various exemplary embodiments, this invention provides methods and systems that dynamically control and\/or direct document image processing based on client device display capabilities, image formats supported by the client device, network bandwidth, document file format, document content, user hints and the like.","These and other features and advantages of this invention are described in, or are apparent from, the following detailed description of various exemplary embodiments of the systems and methods according to this invention.","Various exemplary embodiments of systems and methods according to this invention relate to client dependent image processing for browser-based image document viewer for handheld client devices.",{"@attributes":{"id":"p-0022","num":"0021"},"figref":["FIG. 2","FIG. 2"],"b":["100","100","110","120","130"]},"The server  processes image data of a document based on one or more of client-based parameters, transmission network capability, document type and user input requests. The server  then compresses the processed data, and transmits the compressed data to the client  by way of the network .","In various exemplary embodiments, the server  receives requests from the client  for processing image data and transmitting processed image data back to the client . In various exemplary embodiments, the server  processes the image data based on a selection of parameters prestored at the server  regarding the capabilities or requirements of the client  and the network . In various other exemplary embodiments, the server  processes the image data based on the selection of parameters detected from the client , the network , or a combination thereof.","In various exemplary embodiments, the server  processes the image data based on client device\/handset display capabilities, image formats supported by the client device\/handset, network bandwidth, document file format, document content, user hints and the like. In various other exemplary embodiments, the server  receives the selection of parameters sent from the client , based on various user inputs.","As part of the client-dependent image processing operations, the server  also compresses the processed image data before transmitting the image data to client . In various exemplary embodiments, the server  compresses the processed image data using custom color maps, as described in detail in U.S. patent application Ser. No. 10\/901,333, now U.S. Pat. No. 7,539,341, entitled \u201cSystem and Methods for Processing Image Data Prior to Compression\u201d, which is incorporated herein by reference in its entirety.","The server  is generally associated with a computer, as described in greater detail below in connection with . The client  is a device that can display a form of the processed and compressed image data. The client  receives the processed and compressed image data from the server  via the network . In various exemplary embodiments, the client  sends a request for the image data to the server  before receiving the processed and compressed data. In various exemplary embodiments, the client  selects and sends one or more parameters to the server  as a condition for the server  to process the data before processing the data.","In various exemplary embodiments, the client  is a mobile device, such as a laptop computer, a personal data assistant (PDA), a cellular phone, an electronic computing graphics tablet-like device or other handheld computing device and the like.","The network  transmits data, requests or other information between the server  and the client . In various exemplary embodiments, the network  is a wired network. In various other exemplary embodiments, the network  is a wireless network. In various other exemplary embodiments, the network  includes both wired and wireless networks. In various exemplary embodiments, the network  includes the Internet. A user may view processed data on a web page displayed on the client . In various other exemplary embodiments, the network  includes a wireless cellular phone network or any other existing or yet to be invented communication network. A user may view the processed data displayed on a cellular phone at the client .","It will be noted that the following discussion does not discuss in detail all the client-dependent image processing operations that may be performed, or that are possible, according to various exemplary embodiments of systems and methods of this invention. The image processing operations\/effects that are discussed below are well known in the art and are relatively straight forward. For example, if the client only supports GIF image formats, only those files will be created. Other image processing operations\/effects, such as, for example, crop windows, image orientation, and the like, may also be practiced according to various exemplary embodiments of the systems and methods of this invention.",{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 3","FIG. 3"]},"As shown in , beginning in step S, operation of the method continues to step S, where a server receives a request for a document from a client via a network. In various exemplary embodiments, the request is a signal generated when a user clicks an icon\/link displayed at the client. The icon\/link represents document data to be processed.","Next, in step S, the server processes the document data. The document data may be processed based on one or more of client device\/handset display capabilities, image formats supported by the client device\/handset, network bandwidth, document file format, document content, user hints and the like.","Following the processing of the document data, at step S, the client-dependent processed data is transmitted to the client device for display on the client device. Then, operation of the method continues to step S where the operation stops. It should be noted that all standard methods of anticipating user requests can be performed on the server, based on configuration, load, etc., thereby reducing the latency for subsequent requests without altering the spirit of the invention.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":["FIG. 4","FIG. 3"],"b":"130"},"As shown in , the client dependent image processing operations begin at step S and continue to step S where the requested document is converted to a raster image on the server using well known raster image processing (RIP) techniques. This raster image generally uses some client capabilities, such as, for example, black and white rendering for a black and white device, and some document attributes, for example, lower initial resolution for PowerPoint documents compared to Word documents. The use of document attributes can be understood when considering the likelihood that certain document types will have certain properties. Presentation slides, for example, will have larger fonts and thus generally require a lower initial RIP resolution than legal documents.","Next, at step S, the \u2018RIPed\u2019 data is subsequently scaled to the desired zoom settings. For example, in various exemplary embodiments, the data may be scaled to one of the current prototype mDoc version 4 zoom settings, e.g., 2, 4, 8 and 16 reduction, using a density preserving reduction (filter & down sampling) leading to 5 raw images at the 5 different resolutions. The raw images may not yet adhere to the client color and bit-depth requirements.","Following data scaling, operation of the method continues to step S where client-dependent image filtering is performed. At high reduction levels, the page content can only be \u201cguessed\u201d by the user. Twelve point text, for example, would be rendered at single pixel height for most letters. In various exemplary embodiments of the methods and systems according to this invention, the image sharpness is strongly increased for higher reduction factors, well above any limit that would be used for normal image viewing. However, increasing the sharpness at high reduction factors gives the user the perception of \u201ctext\u201d without making the text readable. For the exemplary prototype mDoc application, speed is an important consideration as it directly influences user latency. As a speed\/quality compromise, in one exemplary embodiment, a 5 element filter was chosen where four ring values are constant (\u201c\u22121\u201d) and the center value is varied. Smaller center values yield stronger enhancement. Other techniques known in the art or later developed may also be used to perform client dependent filtering operations.","After image sharpening, at step S, enhancement TRCs are used to further increase the contrast of the data. The TRCs are a function of reduction factors (stronger enhancement for higher reductions) and of document applications. In this case, presentation slides and scanned data undergoes an essential symmetric contrast enhancement. Text documents and spreadsheets undergo a non-symmetric enhancement leading to a strong visual darkening. This is based on the likelihood that different color and foreground\/background schemes are used in the different document types.","At step S, a data compression operation is performed. As part of the data compression operation, data compression parameters may be varied based on transmission bandwidth and client storage capabilities, as well as other factors. In the binary case, no variation can be obtained at this step directly, but rather a different enhancement can be performed. For color clients, a choice exists between JPEG and GIF compressions, since both are normally supported in the browser. In JPEG compression, the Q-table\/Q-Factor can be used to change compression ratios. For the \u201cGIF compression\u201d (better in the GIF format encapsulated compression method), the compression efficiency may be modified by the initial color mapping. For the discussion presented below, a dynamic color mapping between \u201c222\u201d (8 colors) and \u201c794\u201d (252 colors) is assumed, as described in detail in U.S. patent application Ser. No. 10\/901,333, entitled \u201cSystems and Methods For Processing Image Data Prior To Compression\u201d, which is incorporated herein by reference in its entirety.","Following data compression, the method continues to step S where a client dependent data formatting operation is performed. Following formatting of the data, the client dependent processed document\/image is transmitted to the client device, step S.","Table 1 is an exemplary embodiment of an image processing table showing the different image processing aspects as a function of reduction (zoom setting) and application. In Table 1, TRC name 64 L indicates a TRC that is non-symmetric (\u201cL\u201deft) and that maps all pixel values below 64 to \u201cblack\u201d. A TRC name 32 indicates a symmetric TRC that maps all values below 32 to black and all values above 223 to white. The rest of the range is a linear mapping between black and white. The term \u201creduce\u201d refers to a filtered subsampling, preferably maintaining image density attributes.",{"@attributes":{"id":"p-0043","num":"0042"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"center"}}],"thead":{"row":[{"entry":[{},"TABLE 1"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"Word",{},{},{}]},{"entry":[{},"processor","Spreadsheet","Presentation","Scan"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":{}}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["RIP","150","150","75","\u2014"]},{"entry":"Resolution"},{"entry":["Scale Method","Reduce","Reduce","Reduce","Reduce"]},{"entry":["Zoom level","1, 2, 3, 4","1, 2, 3, 4","1, 2, 3","1, 2, 3, 4"]},{"entry":["Enhance","TRC","TRC","TRC","TRC"]},{"entry":["Method","stretching","stretching","stretching","stretching"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"9"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"8","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"9","colwidth":"21pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Enhance TRC","1","NO","1","NO","1","NO","1","32"]},{"entry":["For different","2","32L","2","32L","2","32","2","50"]},{"entry":["scale factors","3","64L","3","64L","3","50","3","64"]},{"entry":["Linear","4","100L\u2002","4","100L\u2002",{},{},"4","64"]},{"entry":"between:"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"42pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"35pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Filter method","5 Element","5 Element","5 Element","5 Element"]},{"entry":[{},"sharpen","sharpen","sharpen","sharpen"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"9"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"4","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"center"}},{"@attributes":{"colname":"6","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"7","colwidth":"21pt","align":"center"}},{"@attributes":{"colname":"8","colwidth":"14pt","align":"center"}},{"@attributes":{"colname":"9","colwidth":"21pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Center Value","1","NO","1","NO","1","NO","1","NO"]},{"entry":[{},"2","8","2","8","2","8","2","8"]},{"entry":[{},"3","8","3","8","3","8","3","8"]},{"entry":[{},"4","6","4","6",{},{},"4","6"]},{"entry":{"@attributes":{"namest":"1","nameend":"9","align":"center","rowsep":"1"}}}]}}]}}},"As can be observed from Table 1, different image processing settings are used for different document types and zoom levels. The exemplary values given in Table 1 are currently used in an exemplary mDoc viewer demo produced by the inventors. For binary clients, such as for example, WAP phoned, processing stops at the level of Table 1, with only the file format conversion to WBMP being done after the image processing. For color capable clients, some additional steps, which are well known in the art, may be added.",{"@attributes":{"id":"p-0045","num":"0044"},"figref":["FIG. 5","FIG. 5"],"b":"55"},"The reference image shown on the right of , e.g., reference image , has been client-dependent processed using the various exemplary methods according to this invention. It will be noted that the image has not been cropped to the screen size. That is,  shows a different zoom level without cropping to the client window.","The client dependent image processing controls discussed above show a clear image quality improvement compared to standard, fixed processing. The processing overhead on a standard personal computer is small compared to the standard transmission times over the wireless network, and generally can be ignored. One possible exception to this may be the speed of the sharpness filter, leading to its omission for the largest images (full zoom).",{"@attributes":{"id":"p-0048","num":"0047"},"figref":["FIG. 6","FIG. 6"],"b":"800"},"As shown in , the data processing system  may include an input\/output (I\/O) interface , a controller , a memory , a parameter selecting circuit, routine or application , an application library , a raster image processing circuit, routine or application , a document data scaling circuit, routine or application , a client dependent image filtering circuit, routine or application , a client-dependent image enhancement circuit, routine or application , a data compression circuit, routine or application , and a client dependent data formatting circuit, routine or application , each interconnected by one or more control and\/or data buses and\/or application programming interfaces .","In various exemplary embodiments, the data processing system  is implemented on a programmable general purpose computer. However, the data processing system  can also be implemented on a special purpose computer, a programmed microprocessor or microcontroller and peripheral integrated circuit elements, an ASIC or other integrated circuits, a digital signal processor (DSP), a hard wired electronic or logic circuit, such as a discrete element circuit, a programmable logic device such as a PLD, PLA, FPGA or PAL, or the like. In general, any device capable of implementing a finite state machine that is in turn capable of implementing the flowchart shown in  can be used to implement the data processing system .","The input\/output interface  interacts with the outside of the data processing system . In various exemplary embodiments, the input\/output interface  may receive input from the outside, such as a network, via one or more links . The input\/output interface  may output data for subsequent delivery or transmission via the one or more links  to a client device (shown in ).","The one or more links  may be direct connections, or may be implemented using a connection device such as a modem, a local area network, a wide area network, an intranet, the Internet, and any other distributed processing network, or any other known or later-developed connection device.","As shown in , the memory  includes a parameter default selection portion  and one or more client dependent image processing table(s) . The parameter default selection portion  stores default selections of parameters for client devices (\u201cclients\u201d). The parameter default selection portion  can also store parameters of various networks and display devices. The one or more client dependent image processing table(s)  stores different image processing settings that are used for different document types, zoom levels, and the like.","The memory  may also store any data and\/or program necessary for implementing the functions of the data processing system . The memory  can be implemented using any appropriate combination of alterable, volatile, or non-volatile memory or non-alterable or fixed memory. The alterable memory, whether volatile or non-volatile, can be implemented using any one or more of static or dynamic RAM, a floppy disk and a disk drive, a writable or rewritable optical disk and disk drive, a hard drive, flash memory or the like. Similarly, the non-alterable or fixed memory can be implemented using any one or more of ROM, PROM, EPROM, EEPROM, an optical ROM disk, such as a CD-ROM or a DVD-ROM disk and disk drive or the like.","In the exemplary embodiments of the data processing system  shown in , the parameter selecting circuit, routine or application , under the control of controller , determines a selection of parameters. In various exemplary embodiments, the parameter selecting circuit, routine or application  determines the selection of parameters based on the specific characteristics of the client device, a user's instructions, a default selection stored in the memory , and\/or detected features of the network, the client and\/or the document type. In various exemplary embodiments, a detection may be made by detecting a network and\/or device type, coupled with parameters stored for that network\/device type. In various exemplary embodiments, different documents are processed differently. For example, a Word\u2122 document is processed differently from a PowerPoint\u2122 document, with the corresponding application files being rendered using appropriate application software from library . In various exemplary embodiments, different client devices process the same document differently.","The raster image processing circuit, routine or application , under the control of controller , converts a document requested by the client to a raster image on the server using well known raster image processing (RIP) techniques.","The document data scaling circuit, routine or application , under the control of controller , scales the \u2018RIPed\u2019 data to the desired zoom settings. For example, in various exemplary embodiments, the data may be scaled to one of the current prototype mDoc version 4 zoom settings, e.g., 2, 4, 8 and 16 reduction, using a density preserving reduction (filter & down sampling) leading to 5 raw images at the 5 different resolutions.","The client dependent image filtering circuit, routine or application , under the control of controller , performs client-dependent image filtering of the scaled data. In various exemplary embodiments of the methods and systems according to this invention, the image sharpness is strongly increased for higher reduction factors, well above any limit that would be used for normal image viewing.","The client-dependent image enhancement circuit, routine or application , under the control of controller , uses enhancement TRCs to further increase the contrast of the data.","Following image enhancement, the data compression circuit, routine or application , under the control of the controller , compresses the processed data. In various exemplary embodiments, the data compression circuit, routine or application  compresses the processed image data using tonal reproduction curves (TRC) to suppress backgrounds and to further enhance the perception of detail and optionally and\/or custom color maps, as described in detail in U.S. patent application Ser. No. 10\/901,333, now U.S. Pat. No. 7,539,341 entitled \u201cSystem and Methods For Processing Image Data Prior to Compression\u201d, which is incorporated herein by reference in its entirety.","The client dependent data formatting circuit, routine or application , under the control of controller , finally formats the data prior to transmitting the data over the network to the client device. In various exemplary embodiments, the client dependent data formatting circuit, routine or application  formats the data based on one or more client dependent image processing table(s) . As discussed above, tables  store different image processing settings that are used for different document types, zoom levels, and the like.","While particular embodiments have been described, alternatives, modifications, variations and improvements may be implemented within the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Various exemplary embodiments of the systems and methods of this invention will be described in detail, with reference to the following figures, wherein:",{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 4","FIG. 3"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
