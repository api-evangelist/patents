---
title: Method for handover between heterogeneous communications networks
abstract: A method, computer program, and computer readable medium are disclosed for maintaining communication between first and second mobile units communicating via first and second communications networks, respectively. The first and second units include, respectively, first and second protocol stacks and first and second session layers, which interface between the first and second protocol stacks and first and second software components acting within the first and second units, respectively. The first unit includes first communications hardware with associated drive routines for different communications networks. When the first unit switches from a first to a third communications network, the first session layer maintains communication by selecting the first communications hardware and drive routine required for the third communications network. The identities of the first and second units are maintained by the first and second session layers and retained during the first unit's switching of communications networks.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07797437&OS=07797437&RS=07797437
owner: Columbitech AB
number: 07797437
owner_city: Stockholm
owner_country: SE
publication_date: 20011126
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"p":["This application is the US national phase of international application PCT\/SE01\/02612 filed 26 Nov. 2001, which designated the US.","The present invention relates to a method, computer program products, and to a computer readable medium, for handover or roaming between heterogeneous communications networks.","Techniques for handover and roaming between homogeneous networks, such as between GSM base-stations have long been in use. Techniques, such as Mobile-IP in combination with IPSec, have also been devised for roaming between networks based on the IP protocol. This technique functions well in IP networks that have homogenous network characteristics, such as in wireless-LAN. It is also known that solutions of this type can become problematic in conjunction with handover between heterogeneous networks having drastically different network characteristics with respect to bandwidth, loss rate or round-trip times.","A number of acronyms and abbreviations are used in this description and in the accompanying Claims for the sake of simplicity. Although these acronyms are conventional to one skilled in this field, an explanation as to their meaning is, nevertheless, given below.","IP\u2014Internet Protocol. TCP\u2014Transmission Control Protocol. UDP\u2014User Datagram Protocol. API\u2014Application Programming Interface. SPI\u2014Service Provider Interface. LAN\u2014Local Area Network. DNS\u2014Domain Name System. ROM\u2014Read Only Memory. WTLS\u2014Wireless Transport Layer Security. SIP\u2014Session Initiation Protocol. NAT\u2014Network Address Translation.","The description and the accompanying Claims also include certain technical terms, a definition of which also given below.","End-to-end security: An encrypted and authenticated tunnel between two software processes where encryption and authentication are such that anyone who is able to listen to traffic and to alter traffic will be unable to read the encrypted information or to change the encrypted information without being detected by the receiver, and where the communication is intended for and is interpreted by said two software processes.","Sessionlayer: Protocol layer acting directly on the transport-protocol layer.","Socket: A terminal point for communication represented by a socket handle in the socket-API.","Handover: Exchange between two different communications links on the same or different networks.","Roaming: Exchange between two different geographically separated communications networks.","Technical problems","A number of problems arise in connection with data communications between a first and a second unit of which at least the first unit is geographically mobile. Normally, it is necessary to cause the communications network to conceal from the second unit the fact that the first unit is mobile. An adaptation of a communications network locks to the use of the communications technology afforded by the communications network, and may also lock to the use of the network operator.","Neither is the software in the first unit always adapted to take into account the fact that the first unit is mobile. This means that the communications hardware in the first unit must be adapted to take into consideration the fact that the first unit is mobile. This creates locking effects to the communications technology supported by the hardware in the first unit.","When communication between the first and the second unit utilises the IP protocol, the second unit uses the IP address of the first unit to address messages from the second unit to the first unit. When the first unit is able to communicate with the second unit via a plurality of different communications links, the first unit will have at least one separate IP address for each communications link. If the first unit now moves in a manner which renders a first used communications link unavailable, the second unit is forced to use a new second communications link to the first unit. This is done by addressing the messages to the IP address of the first unit belonging to the second communications link. However, it is then problematic for the second unit to be aware that the first unit has switched communications links and to know the new IP address that shall now be used.","When the TCP protocol is used on top of the IP protocol and the second communications link has a network characteristic that is different to the first communications link, e.g. a different bandwidth or different round-trip times, it may take a long time for the TCP protocol to adapt to the characteristic of the second network. Subsequent to this switch, the so-called Karns algorithm makes it difficult for the TCP to update its estimate of the mean round-trip time and the standard deviation thereof. Many unnecessary retransmissions or unnecessarily prolonged time-outs are liable to occur during the time taken for the TCP protocol to self-adapt.","Security problems can occur when the second unit is a company server and the first unit switches from one communications link to another. Normally, authentication of the first unit is coupled to the communications link used. When the first unit switches from the first communications link to the second communications link, it is then necessary for the first unit to establish a further authentication over said second communications link.","In conjunction with using a security protocol, data is normally encrypted prior to reaching the link layer This means that the compression functionality acting on the link layer will have no effect, therewith requiring more data to be transported over the communications link.","Methods of creating systems for handover and roaming between communications links in homogenous networks have long been known to the art. In the GSM system, handover and roaming are effected on a special link layer adapted precisely for GSM communication. Data communication over GSM can take place either via circuit switched GSM connections or via GPRS technology. Other mobile telephony systems function in a similar way.","A handover adapted link layer enables handover to be made between base stations and therewith enable communications links to be switched within a network operated by a given operator GSM also provides the possibility of roaming between networks belonging to different operators, although this requires telephone connections to be released and then re-established. Due to the fact that handover in a network that belongs to a individual operator takes place on the link layer, the handover will be concealed from any possible IP layer. This solves certain of the IP-related problems mentioned above. However, the nature of the solution is such as to prevent it from being transferred on heterogeneous networks that have different types of link layers.","Special telephones that include hardwares and software for several different telephony systems enable roaming between different types of mobile telephony networks to take place, although solely between calls even in this case.","Security in solutions based on mobile telephony systems is normally based on encryption of traffic over the mobile link. This encryption could, in principle, be made arbitrarily strong, although it is often weak in present-day systems. For instance, encryption in GSM is based on the algorithm A, which can, essentially, be broken in real time. The principle problem with link-based encryption, however, is that it is not used the whole way between the first unit and the second unit, so-called end-to-end encryption. This allows another computer unit to listen to traffic, make changes in the messages, or to use the IP address of the first unit, so-called IP spoofing.","It is also known to use a protocol of the type Mobile-IP for mobility between different IP-based communications links. Mobile-IP is based on special software in the first unit and a first server, called home agent. In some cases, a second server, called foreign agent, is also required in the network. When a foreign agent is used, one foreign agent is normally required for each communications link. Mobile-IP solves the IP address-related problem, by concealing the actual IP address of the first unit and assigning to said unit a second IP address belonging to the first server. The first server forwards all communication received on the second IP address to the IP address used by the first unit at that moment in time. This solves the aforementioned IP address-related problem. However, the problem relating to the TCP protocol is not solved. Moreover, Mobile-IP results in poorer performance, in that it adds further data to each IP packet. Mobile-IP introduces further delays in communication, as a result of so-called triangular routing. These delays are of greater duration when both the first unit and the second unit are mobile. In certain applications, such as in two-way voice communication, these delays are liable to seriously impair the quality of the application.","The protocol IPSec is often used together with Mobile-IP in an attempt to solve security related problems. IPSec is normally used on a level above Mobile-IP. This enable encrypted information to pass through the first server without being decoded, and also obviates the need to establish a new IPSec connection when the first unit switches communications links. The first unit and the second unit are also able to authenticate each other in a secure manner, with the aid of a certificate. However, the IPSec layer works above the link layer, meaning that link layer based compression will not function. Although compression in the IPSec layer is possible, it is difficult or impossible to use state dependent compression algorithms owing to the packet switching nature of IP. This greatly reduces the effect of the compression. Moreover, IPSec necessitates the transmission of extra data with each IP packet. In total, this results in considerably impaired performances.","A new version of the IP protocol, IP version 6 that contains a variant of both IPSec and Mobile-IP has been proposed. One problem with IP version 6 in connection with mobile communication is that the header size on individual messages is larger than in earlier versions of the IP protocol. This results in lower effective bandwidth and longer delays. Furthermore, IP version 6 requires all existing routes to be replaced or upgraded.","In an endeavour to solve the TCP-related problem, various changes to the TCP protocol have been put forward. A proposed alternative involves replacing the existing TCP protocol with a completely new protocol. However, in order to be able to utilise these techniques, it is generally necessary to make changes in both the first unit and the second unit. A general characteristic of these proposals is that they all require changes to the TCP standard, something that would take a very long time to put into effect and to implement in existing computer systems.","The exchange of certain software components in certain types of units, such as Pocket PC-based computer units, is highly complicated owing to the fact that said components are placed in ROM. This makes installation of Mobile-IP software, which shall be executed in or under the TCP\/IP stack difficult to carry out.","Also proposed are solutions that exploit an Internet-placed proxy that establishes a TCP connection for the first unit. A proxy-based solution, however, cannot function without terminating the IPSec protocol, as the IPSec protocol encrypts data related to TCP protocol signaling.","Solution","With the intention of solving the aforesaid problems, there is proposed in accordance with the invention a method in which a first unit includes a first session layer, a first protocol stack, one or more hardware. The first session layer includes a first security layer A second unit first communications hardware, and one or more drive routines belonging to said first communications includes a second session layer, a second protocol stack, and one or more second communications hardware. The second session layer includes a second security layer. Each of a plurality of communications networks enables the first unit to send messages to and receive messages from one of the communications hardware belonging to the second unit within a geographical area belonging to said each communications network, by means of one of the first communications hardware.","The first session layer is provided with a first interface that can be used by a plurality of pre-existing first software components based on socket-API. If the first unit is Windows-based, the first interface may be based on WinSock SPI, such as with a Layered Service Provider or a Base Transport Service Provider. If the first unit is PalmOS-based, the first interface may be the same as on the netlib component in PalmOS. The first interface may also be a proxy interface. The proxy interface is assigned the function of listening on certain preselected TCP ports and to receive data on certain pre-selected UDP ports on the IP addresses local for the first unit.","If the first interface is a proxy interface, the first unit may include a DNS server which in response to DNS queries from the first software components concerning the IP address belonging to certain pre-selected host names returns a local IP address instead of the correct IP address. Consequently, selected communication will pass through the first session layer. The first session layer can use the port through which it has received data belonging to said communication, the local IP address used, and\/or the host name for which a DNS look-up was last made, to decide the destination of said communication.","The second session layer is provided with a second interface that can be used by a plurality of preexisting second software components based on socket API. When the second unit is Windows-based, the second interface may be based on WinSock SPI, such as with a Layered Service Provider or a Base Transport Provider. The second interface may also be based on the TCP protocol and on the UDP protocol.","The first and the second session layer are assigned the task of ensuring that traffic belonging to respective sockets in each of the first software components is corresponded by traffic intended for the second software components and belonging to a unique socket in one of the second software components, and vice versa.","The first unit is connected via a first communications network and the second unit is connected via a second communications network. The first session layer has the function of switching from the first communications network to a third communications network when necessary.","The first session layer is also assigned the task of determining when a switch between communications networks shall take place. This network switch can take place when used communications networks are no longer available, and also for other reasons\u2014such as when a communications network other than that used is considered more suitable for communication, or when criteria based on the cost of using the various communications networks are fulfilled. For instance, a switch can be made when present communication takes place over a circuit switched connection with time-based billing and no information has been sent over the circuit switched connection within a given specified time period. It may then be more advantageous to switch to a packet switched connection with billing based on the amount of transmitted data.","In order to be able to determine which communications networks are available, the first session layer can communicate with the drive routines belonging to the first communications hardwares so as to read-out information that may be of interest in determining the capacity and characteristics of the communications networks, such as signal strength, network availability, and the availability of necessary hardware.","The first and the second session layers are also assigned the task of synchronising the data flows between the first unit and the second unit in conjunction with a switch between two communications networks. This can take place in two different ways, depending on how the switch takes place between said two communications networks. If the first communications network used is still available when the switch to the new, third communications network is made, the first session layer can inform the second session layer, via the first communications network, that the first unit is about to switch networks. The second session layer then ceases to send data over the first communications network and informs the first session layer that it awaits further communication over the third communications network. The first unit may, meanwhile, begin communication via the third communications network. When the second session layer receives communication from the first unit over the third communications network, it can resume communication with the first session layer via the third communications network. This switching between communications networks is referred to as soft handover in the following.","Another way of switching communications networks is required if the first communications network is no longer available when switching to the third communications network takes place or if the first communications network becomes unavailable during a soft handover. The first session layer is then able to inform the second session layer, via the third communications network, of the data received by the first session layer from the second session layer. The second session layer then informs the first session layer of the data received by the second session layer from the first session layer. The first and the second session layers then commence to send data that has not been received by the receiver. Such switching of communications networks is referred to as hard handover in the following text. The above-described message sequences regarding soft handover and hard handover respectively are referred to as handover procedures in the following text.","The first session layer is also assigned the task of stating a first identity for the second unit in respect of overlying protocol layers or applications. The second session layer is assigned the task of stating a second identity for the first unit in respect of overlying protocol layers or applications. These identities shall not be changed when switching between communications networks. When the first and the second security layers are based on WTLS, the identities may be WTLS session identities.","The first session layer is assigned the task of establishing new transport sessions over the third communications network in conjunction with switching to the third communications network. The session layers can maintain one transport session per socket or solely one or a few transport sessions. It is possible to have a first transport session for all sockets that use stream-based communication and a second transport session for all sockets that use datagram-based communication. The first transport session may be based on TCP and the second transport session may be based on UDP.","The first and the second session layers are also assigned the task of compressing traffic from the software components either before or in conjunction with sending said traffic through the first and the second security layers, and to decompress traffic received via the first and second security layers.","If so required, the security layers may be assigned the task of providing an encrypted and authenticated connection between the first and the second unit. The first session layer associates the first identity with each secure connection between the first security layer and the second security layer. The second session layer associates the second identity with each secure connection between the first security layer and the second security layer. The first session layer and the second session layer also associates a unique session with each secure connection between the first security layer and the second security layer.","The first security layer is also assigned the task of re-establishing secure connections over the other communications network after a switch has been made from the first communications network to the third communications network This switch can be made with a complete handshake or with a so-called session resume when the security layers are based on WTLS. In the case of a session resume, the shared secrecy exchanged in an earlier complete handshake is reused. A session resume gives rise to a so-called WTLS connection that has the same session identity as the WTLS connection created with said complete handshake.","The transport sessions can be established between the first unit and the second unit. However, it is also possible to establish the transport sessions between the first unit and an intermediate unit, and between the intermediate unit and the second unit. A plurality of intermediate units may even be chain-connected between the first and the second unit, such that the first unit establishes transport sessions to the first of the intermediate units in the chain, and such that each unit in said chain establishes transport sessions to the next following unit in the chain. The last unit in the chain and the second unit then establish transport sessions between themselves.","When transport sessions are established to the intermediate unit or to a chain of intermediate units, said intermediate unit or some unit in the chain of units can be used to one-time authenticate the first unit. Such authentication can be effected by embedding a one-time password in the handshake procedure between the first security layer and the second security layer. When the first and the second security layers are based on WTLS, the one-time password can be embedded in the client_random field in the client_hello message. Authentication can also be based on the intermediate unit or some unit in the chain verifying a handshake message that includes a signature made with a private key associated with a certificate belonging to the first unit.","The second unit may also be geographically mobile. This second unit may then function in the same way as the first unit.","Should both the first unit and the second unit change communications networks essentially at one and the same time, it may be that the first and the second units both initiate a handover procedure before receiving a handover request from the other party. Two ongoing handover procedures will then exist. The first and the second unit then comply with a rule that determines which of the ongoing handover procedures shall be finalised.","This rule may require the first and the second unit to select the handover procedure that was initiated from the unit that initially created the session.","Should the first unit and the second unit change communication networks essentially at one and the same time and both commence a hard handover it may be that neither the first unit nor the second unit is aware of the new address to the other party involved in the communication. This problem can be solved by communicating via the intermediate unit or via the intermediate chain of units respectively. However, each unit that is a party in said communication will constitute a risk of the messages being delayed. This is unacceptable in certain contexts, for instance in the case of two-way voice communication.","So that the first unit can be located after it has switched communications networks without needing to communicate via the intermediate unit or the chain of units, the first unit sends a message to a third unit in conjunction with initiating a handover procedure. This message contains information relating to the address of the first unit after it has switched networks. If the second unit is mobile or can be thought to be mobile, the first unit also sends to the third unit a request concerning the relevant address of the second unit. The third unit responds with a message that contains the relevant address of the second unit. The message containing own address information and a query concerning the address of the other party may also be combined into a common message. Corresponding procedure is taken by the second unit when it switches communications network via hard handover.","The third unit may be an SIP registrar server or a Mobile-IP Home Agent.","The second unit may be a company internal server, and a firewall may be placed between the first unit and the second unit, such that all communication between the first unit and the second unit must pass through the firewall. When an intermediate unit or a chain of intermediate units is used, one of the intermediate units may be placed in a so-called demilitarised zone belonging to the firewall. The unit in the demilitarised zone may then also be used for authentication of the first computer unit in the aforedescribed way.","A unit used in this way for authentication may conveniently be allocated the function of a pre-coupled means according to Swedish Patent Application No. 00 04338-0 with the title \u201cData Network Based-System\u201d. Such a pre-coupled means operates in a demilitarised zone outside a firewall and has the special function of initiating an authentication procedure such as to establish that a first unit is the unit that it maintains to be, whereafter the authentication procedure between the first unit and the second unit is finalised and a so-called secure session is established between the first and the second unit.","Alternatively, the intermediate unit or one of the units in the chain of intermediate units may consist of the firewall.","It will also be understood that the first unit is able to communicate with several second units and that, similarly, the second unit is able to communicate with several first units.","Advantages","The invention enables a first software in the first unit to retain communication sessions with a second software in the second unit when switching communications networks, despite the first software, the second software, the communications networks and the communications hardware not being designed to retain communication sessions when switching networks.","The invention enables switches to be made between communications networks that have different network characteristics on the basis of different technologies, without needing to rely on the TCP protocol to handle the rapid changes in network characteristics.","The invention also enables switching between communications networks to take place in a secure manner, while retaining end-to-end security.","The invention also enables more effective compression algorithms to be used than what would be the case if compression took place in the IP layer in the protocol stack.","The invention also enables switching of communications networks to take place in the absence of triangular routing.","The invention requires no changes in routers or NAT servers.","The invention requires no changes in the TCP\/IP stack of either the first unit or the second unit.","When the second unit is a company internal server, the invention enables communication to take place through a firewall with retained end-to-end security and with authentication outside or in the firewall.",{"@attributes":{"id":"p-0073","num":"0072"},"figref":"FIG. 1","b":["1","11","12","13","13","13","13","14","14","14","14","13","13","13","13","11","11"],"i":["a","b","c","d ","a","b","c","d ","a","b","c","d","a. "]},"A second unit  includes a second session layer , a second protocol stack , and one or more second communications hardware , , , . The second session layer  includes a second security layer ","Each of a plurality of communications networks A, A, A, A enables the first unit  to send messages to and receive messages from one of the hardwares , , , belonging to the second unit , within a geographical area belonging to each network and with the aid of one of said first communications hardwares , , , ","In one preferred embodiment, the security layers , may be WTLS protocol layers.","The first session layer  has a first interface against overlying first software components . In one preferred embodiment, the first unit  is a windows-based computer unit and the first interface is based on WinSock SPI for a Layered Service Provider.","In an alternative embodiment, the first unit  is PalmOS-based, and the first interface is the same as on the netlib component in PalmOS.","In another alternative embodiment, the first unit  is Pocket PC-based and the first interface is a proxy interface where the first session layer  listens on certain selected TCP ports and binds to certain selected UDP ports and answers with a local IP address to DNS queries from the first software components .","The second session layer  has a second interface against overlying second software components . In one preferred embodiment, the second unit  is a Windows-based computer unit and the second interface is based on WinSock SPI for a Layered Service Provider.","The first and the second session layer ,  use a common session protocol to ensure that for each of the first sockets , ,  created by the first software components  in the first interface there are created corresponding second sockets , ,  in the second interface , and that subsequent traffic belonging to each of the said first sockets , ,  is corresponded by the traffic intended for the second software components  and belonging to intended unique second sockets , , , and vice versa. When a socket is stream-based, the session protocol ensures that all traffic will arrive in the correct order and that no traffic will be excluded.","The first unit  is connected via a first communications network A, and the second unit  is connected via a second communications network A. The first session layer  is assigned the task of switching A- from the first communications network A to a third communications network A when necessary, and to decide when this network switch shall take place.","According to one preferred embodiment, the A- switch shall be made when the first network A is no longer available. The switch may also be made when the third network A becomes available and is considered more suitable for communication than the first communications network A in accordance with a pre-decided order. The switch shall also be made to a packet switched communications network with billing based on the amount of transferred data when such a network is available and when the first communications network A is circuit switched and has time-based billing and no information has been sent over the circuit switched first communications network A within a given specified time period.","According to a preferred embodiment, the first session layer  shall communicate with the drive routines , , , so as to be able to decide which communications networks A, A, A, A are\/is available. When the drive routines are able to determine on each occasion those communication networks that are available, this information is used. When the drive routines are unable to determine which communications networks are available but, on the other hand, are able to measure the strength of signals arriving at a base station belonging to the communications networks, the first session layer  assumes that a communications network is available when the signal strength lies above a preselected selected threshold. When the drive routine , , , is able to determine whether the communications hardware , , , is available or not, it is assumed that a network is not available when the hardware belonging to said network is unavailable.","In the switch A- illustrated in , the switch from the network A to the network A also causes a switch of communications hardware and associated drive routine . It will be understood, however, that this need not be the case and that a network switch can be effected without requiring a change of hardware and drive routine to be made.","The first and the second session layers ,  are also assigned the task of synchronising the data streams between the first unit  and the second unit  with the aid of the session protocol, in conjunction with a switch A- between two networks A, A. This can be effected in two different ways, depending on how the switch between said two communications networks shall take place.","If the first communications network A used is still available when the switch is made to the new third communications network A, the first session layer  may inform the second session layer  over the first communications network A that the first unit  is in the process of switching networks. The second session layer  then breaks off further transmission of data over the first communications network A and informs the first session layer  that it awaits further communication over the third communications network A. Meanwhile, the first unit  can commence communication over the third communications network A. When the second session layer  receives communication from the first session layer  over the third network A, it can resume communication with the first session layer  over the third network A. Such switching of communications networks is referred to hereinafter as soft handover.","An alternative method of switching communications networks is used if the first communications network A is no longer available when handover to the third communications network A takes place. The first session layer  can then inform the second session layer , via the third network A, of the data received by the first session layer  from the second session layer . The second session layer  then informs the first session layer  of the data received by the second session layer  from the first session layer . The first and the second session layers ,  then begin to send data that has not been received by the receiver. Such switching between communications networks is referred to hereinafter as hard handover.","The aforesaid message sequences for soft handover and hard handover respectively are referred to hereinafter as a handover procedure.","According to a preferred embodiment, soft handover shall be employed when the first communications network A is still available when initiating a C communications network switching process. A hard handover shall be employed in other cases. If a soft handover has been initiated, but not finalised, and the first session layer  detects that the first communications network A is no longer available, the first session layer  shall initiate a hard handover.","The first session layer  is also assigned the task of stating a first identity for the second unit  for overlying protocol layers and programs . The second session layer  is assigned the task of stating a second identity for the first unit  in respect of overlying protocol layers and programs .","According to a preferred embodiment, these identities may be WTLS session identities. An abbreviated WTLS handshake is made in connection with a communications network switch, between the first security layer and the second security layer , a so-called WTLS session resume. WTLS session identities will therewith remain unchanged in connection with the network switch and can therefore be used by the first and the second session layers ,  instead of IP addresses as a unique and unchanged machine identity.",{"@attributes":{"id":"p-0093","num":"0092"},"figref":"FIG. 2","b":["11","1","2","3","3"]},"In one preferred embodiment, the session layers ,  shall establish two transport sessions B, B between themselves. A first transport session B shall be based on the TCP protocol and used to transfer data for all first sockets ,  that have been created for stream-based communication. A second transport session B shall be based on the UDP protocol and used to transfer for all other sockets  that have been created for datagram-based communication.","In an alternative embodiment, the first transport session B may be based on different protocols depending on the characteristics of the first and the third communications networks A and A respectively.","The first and the second session layers ,  compress traffic from the software components ,  either before or in conjunction with forwarding the traffic through the security layers , . The first and the second session layers ,  also decompress traffic that has been received through the security layers , ","In one preferred embodiment, there is used a state-dependent compression algorithm that has one state for each stream-based socket and traffic direction. According to one alternative embodiment, there is used a state-dependent compression algorithm that has one state for each traffic direction and receiver.","The security layers , are assigned the task of providing an encrypted and authenticated connection between the first and the second unit , . The first session layer  associates the first identity with each secure connection between the first security layer and the second security layer . The second session layer  associates the second identity with each secure connection between the first, security layer and the second security layer . The first session layer  and the second session layer  also associate a unique session with each secure connection between the first security layer and the second security layer ","According to one embodiment, the transport sessions B, B are established directly between the first and the second units , .",{"@attributes":{"id":"p-0100","num":"0099"},"figref":"FIG. 3","b":["1","2","1","2"]},{"@attributes":{"id":"p-0101","num":"0100"},"figref":"FIG. 4","b":["1","2","3","1","1","3","2","3","1","2","1","2","2","1"]},"When transport sessions B are established to the intermediate unit C, the intermediate unit C or some other unit in the chain of intermediate units C, C, C can be used to authenticate the first unit .","In one preferred embodiment authentication is effected by checking the certificate_verify message in the complete WTLS handshake. In an alternative embodiment authentication is effected by checking a one-time password embedded in the client_random field in the client_hello message in the complete WTLS handshake or in all WTLS handshakes.","In one embodiment the second unit  may be allowed to be geographically mobile. This mobile unit functions in the same way as the first unit . Should both the first unit  and the second unit  switch communications networks essentially simultaneously, it may be that the first and the second unit ,  both initiate a handover procedure before they receive a message to the effect that a handover procedure has been initiated from the other party. Two handover procedures will then be ongoing. The first and the second units ,  will then apply a rule that decides which of the ongoing handover procedures shall be finalised.","In a preferred embodiment, the first and the second units ,  choose the handover procedure that has been initiated by the unit that initiated the communications session.",{"@attributes":{"id":"p-0106","num":"0105"},"figref":"FIG. 5","b":["1","3","1","3","1","3","1","2","3","1","2","2","2","2","4","2","4"]},"This enables the first and second units ,  to find each other should they lose each other's address as a result of both units initiating a handover procedure with a hard handover at one and the same time.","According to one embodiment, the third unit  shall be a unit which is dedicated to keep an account of the relevant addresses of geographically mobile units. In an alternative embodiment, the third unit  may be an SIP registrar server. According to another alternative embodiment, the third unit  may be a Mobile-IP Home Agent.",{"@attributes":{"id":"p-0109","num":"0108"},"figref":"FIG. 6","b":["2","4","1","2","1","2","4"]},"According to this embodiment, an intermediate unit C may be placed in a so-called demilitarised zone  belonging to the firewall . Moreover, the transport sessions B\u2032 between the second unit  and the intermediate unit C shall be established on the initiative of the second unit . Furthermore, the intermediate unit C shall be used to authenticate the first unit  in the aforedescribed manner.","According to an alternative embodiment, the firewall  may consist of the intermediate unit C. According to yet another alternative embodiment, shown in , a chain of intermediate units C, C, C can be used, wherewith one of the units in said chain (exemplified as the intermediate unit C in the Figure) is placed in a demilitarised zone  belonging to the firewall , where said unit C may also constitute the firewall .","The unit acting in the demilitarised zone  may also be given the function of a pre-coupled means 5 according to Swedish Patent Application 00 04338-0 for handling authentication of a unit located outside the firewall and desiring to communicate with a unit inside the firewall.","The pre-coupled means 5 will not be described in any detail in this document, and the reader is referred to the aforesaid Swedish Patent Application for a more detailed description of said means.",{"@attributes":{"id":"p-0114","num":"0113"},"figref":"FIG. 8","b":["1","2","2","2","2","2","2","1","1","1","1","1","1","2","2","2"]},"It will be understood that the invention is not restricted to the aforedescribed and illustrated exemplifying embodiments thereof and that modifications can be made within the concept of the invention as illustrated in the accompanying Claims."],"heading":["FIELD OF INVENTION","DESCRIPTION OF THE PRIOR ART","SUMMARY OF THE PRESENT INVENTION","DESCRIPTION OF EMBODIMENTS AT PRESENT PREFERRED"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["A method, computer program products, and a computer readable medium having features associated with the present invention will now be described in more detail by way of example and with reference to the accompanying drawings, in which",{"@attributes":{"id":"p-0065","num":"0064"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0066","num":"0065"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0067","num":"0066"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0068","num":"0067"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0069","num":"0068"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0070","num":"0069"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0072","num":"0071"},"figref":"FIG. 8"}]},"DETDESC":[{},{}]}
