---
title: Spool file modifying device
abstract: A spool file modifying device for a printing system which generates a spool file including intermediate files independent of a type of printer, and converts the spool file into print data suitable to a target printer. The spool file modifying device includes a spool file retrieving system that retrieves the spool file stored in a storage, a halftone mode designating system that designates an halftone mode as a processing mode to be used when the spool file including a bitmap is reduced in size. With this mode, a gradation of the original bitmap is retained after reduced. The device further includes a modifying system that modifies the retrieved spool file if the spool file retrieved by the spool file retrieving system includes modification information designating the spool file to be modified. The spool file before modified is replaced with the modified spool file, in the storage.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08098385&OS=08098385&RS=08098385
owner: Brother Kogyo Kabushiki Kaisha
number: 08098385
owner_city: Nagoya-Shi, Aichi-Ken
owner_country: JP
publication_date: 20030227
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE EMBODIMENT"],"p":["The present invention relates to a spool file modifying device which is used to modify a spool file for a print job to create a new spool file.","Conventionally, a printing system is employed in a computer system such as a personal computer (hereinafter occasionally referred to as PC). The printing system typically functions to generate a spool file for each print job in response to a printing instruction through application software. The spool file is temporarily stored in a storage device such as a hard disk drive (HDD). The printing system manages the print job such that, depending on an operational status of the printer, the spool file is transmitted to the printer. Generally, such a printing system is realized as a part of function of an OS (Operation System) of the computer.",{"@attributes":{"id":"p-0004","num":"0003"},"figref":["FIG. 7","FIG. 7","FIG. 7"],"b":["41","41"]},"That is, when the user operates the application program  to print, a print instruction is transmitted to a GDI (Graphics Device Interface) , which is a program module provided by the \u201cWidows XP\u201d.","The GDI  generates a DC (Device Context) which is a virtual display area or a virtual device. The DC is provided for the use of the application program . When the DC is provided, the application program  performs an imaging procedure to write an image in the DC with reference to coordinates thereof, thereby an EMF (Enhanced Meta File), which is an intermediate file independent of a kind of a printer, is created for each printing page.","A plurality of intermediate files for respective pages are combined into a spool file which corresponds to one print job by a spooler system . Then a print processor  transmits the thus created spool file to another GDI (i.e., the printer driver) . The GDI  converts the received spool file into data having printer control codes suitable to a target printer.","The conversion described above by the GDI  is executed as a printer driver provided by a manufacturer of the printer and the OS interact. Specifically, the printer driver receives the spool file from the print processor , and then the printer driver calls the OS. The OS executes rasterizing of the spool file (i.e., developing of the spool file into a bitmap). The raster image (i.e., the bitmap image) is then converted by the printer driver into printer control codes.","In the meantime, recently, there is a need for performing modified print jobs. The modified print jobs include, for example, a so-called N-in-1 (e.g., 4-in-1, 2-in-1, etc.) which is a printing in a multi-page format, with which a document is printed such that a plurality of pages are reduced and incorporated within one page of printed document. Another requirement is that two different images are printed overlaid (e.g., printing of watermark). The present applicant has suggested, in Japanese Patent Provisional Publication No. HEI 11-219265, a technique for realizing such a modified printing by modifying the spool file.","According to the technique disclosed in the publication, a spool file stored by the spooler system  is retrieved using the print processor . Next, the retrieved spool file is divided into intermediate files for respective printing pages. Then, the page-divided intermediate files are processed (modified) to create a new spool file, or a modified spool file, which is returned to the spooler system . Then, the GDI  converts the modified spool file into print control codes suitable to the printer to be used for printing. Thereby, the above modified print jobs are executed.","In the conventional printing system described above, when a bitmap is included in a print job created by the application , a problem as follows arises. That is, if the above-described technique of modifying the spool file is applied to the spool file for the print job including the bitmap to perform the modified printing including reduction of a page, such as a multi-page format printing, depending on the application program  used, the gradation of the original bitmap (i.e., the bitmap before reduced) is not maintained in the reduced bitmap, and a desired printing result is not obtained.","Hereinafter, this problem will be described in detail with reference to .","In the \u201cWindows\u201d (trademark) system, the process of gradation upon reduction of the bitmap included in the intermediate files (i.e., EMFs) of a print job created by an application program can be previously specified in the application program.","That is, when the intermediate file for a print job including the bitmap is generated by the application program, the intermediate file (which consists of a plurality of records: see ) includes a record indicative of a gradation processing mode when the reduction of the bitmap is executed by a program such as the printer driver other than the application program is included in","In the case of \u201cWindows\u201d, as the gradation processing mode (in \u201cWindows\u201d, it is called as a bitmap extension\/reduction mode), various modes such as black priority binarization mode (in \u201cWindows\u201d, referred as \u201cBLACKONWHITE\u201d mode), white priority binarization mode (in \u201cWindows\u201d, referred to as \u201cWHITEONBLACK\u201d mode), halftone mode are previously prepared. When a record indicating one of such prepared modes is added in the intermediate file, the gradation mode to be used is designated.","Specifically, when the application program designates a black priority binarizing mode for a certain bitmap, and if the spool file including the bitmap is to be reduced in accordance with the above-described spool file modifying method and then the modified spool file is to be rasterized by the OS, then the OS rasterizes the spool file in accordance with the record indicating the black priority binarizing mode.","The black priority binarizing is a method, as indicated in , to combine two adjoining dots into one black dot for reduction, if at least one of the two dots is black.","Similarly, the white priority binarizing is a method to combine two adjoining dots, if at least one of which is white, into one white dot. These binarizing methods can be used, for example, in the 4-in-1 modification (i.e., modification to incorporate four pages in one page by reduction).  shows an example of the 4-in-1 modification employing the black priority binarizing method.","The halftone mode is a mode where the gradation of the original image is retained after the image is reduced. Various method to produce a reduced image retaining the gradation of the original image have been conventionally suggested. For example, the arrangement and the color of each dot are determined based on the arrangement and colors of the dots in the vicinity of each dot. Due to a relatively complicated computation, a processing speed of the halftone mode is generally slower than the black or white priority binarizing mode.","In the most applications, the halftone mode is selected as the gradation processing mode. Therefore, when the spool file (including a bitmap) created by such applications is to be modified to reduce an image, the OS rasterizes the spool file with retaining the gradation of the original bitmap in accordance with a halftone mode designating record included in the intermediate file. Thus, the reduced image retaining the gradation of the original bitmap can be output.","There are applications which designate the black\/white priority mode as the gradation processing mode, or which does not designate any mode for processing the gradation.","In the former case, when the OS rasterized a spool file, the designated gradation processing mode is used. If, for example, the black priority mode is designated, then the processing as exemplified in  is performed. Therefore, as shown in the example of 4-in-1 modification shown in , the reduced image does not reflect the gradation of the bitmap (i.e., the gradation of the bitmap is collapsed). It should be noted that if the halftone mode was selected, the gradation of the original image would have been retained.","In the latter case (i.e., if the processing mode is not designated), typically the Windows OS uses the black priority mode as a default mode. Therefore, when the image is processed in the latter case, the resultant image is as shown in , in which the gradation of the original image is not reflected (i.e., the gradation of the bitmap is collapsed).","There are applications having a page layout function, in which the reduced image (e.g., 4-in-1 image) can be designated. In such a case, an intermediate file according to the designated page layout is created by such applications. Therefore, in such a case, the printer driver does not reduce the image created by the application and the above-described problem would not occur.","It should be stressed that the problem to be dealt with occurs when the printer driver modifies the spool file created by the applications.","The present invention is advantageous in that, when the print data including a bitmap is created by an application, and then the image represented by the print data is to be reduced with the function of a printer driver, the resultant image reflects the gradation of the original bitmap.","According to an aspect of the invention, there is provided a spool file modifying device employed in a printing system which generates a spool file for a print job and converts the spool file into print data suitable to the printer to be used, the spool file being stored in a storage, the spool file including intermediate files independent of a type of printer, the spool file modifying device converting. The spool file modifying device includes a spool file retrieving system that retrieves the spool file stored in the storage, an halftone mode designating system that designates an halftone mode as a processing mode to be used when the spool file is converted into the print data with a bitmap contained in the spool file being reduced in size, a gradation of the bitmap before reduced being retained in a bitmap as reduced when the halftone mode is designated, and a modifying system that modifies the spool file if the spool file retrieved by the spool file retrieving system includes modification information designating the spool file to be modified, the modifying system modifying the retrieved spool file and replacing the spool file before modified with the modified spool file, in the storage.","Optionally, the spool file modifying device may further include a dividing system that divides the spool file into intermediate files corresponding to print pages.","Then, the halftone mode designating system may designate the halftone mode for each of the intermediate files by adding designating data which designates the halftone mode to be used to a top of each of the intermediate files divided by the dividing system.","Alternatively or optionally, the halftone mode designating system may judge whether designating data that designates the processing mode to be used for corresponding intermediate file is included in each of the intermediate files, the halftone mode designating system replaces the designating data with predetermined designating data which designates the halftone mode as the processing mode to be used.","Optionally, the spool file modifying device may be configured to modify either a spool file for a monochromatic image or a spool file for a multi-color image, the halftone mode designating system operates only when the spool file includes data indicating that a reduced image is to be printed as the modification information and when the spool file is for printing the monochromatic image.","According to another aspect of the invention, there is provided a spool file modifying method employed in a printing system which generates a spool file for a print job and converts the spool file into print data suitable to the printer to be used, the spool file being stored in a storage, the spool file including intermediate files independent of a type of printer, the spool file modifying device. The spool file modifying method may be configured to realize the spool file modifying device described above. That is, the method may include steps of retrieving the spool file from the storage, designating an halftone mode as a processing mode to be used when the spool file is converted into the print data with a bitmap contained in the spool file being reduced in size, a gradation of the bitmap before reduced being retained in a bitmap as reduced when the halftone mode is designated, and modifying the retrieved spool file if the retrieved spool file includes modification information designating the spool file to be modified, the spool file before modified being replaced with the modified spool file, in the storage.","Optionally, the spool file modifying method may modify either a spool file for a monochromatic image or a spool file for a multi-color image.","In this case, the step of designating may designate the halftone mode for each of the intermediate files by adding designating data which designates the halftone mode to be used to a top of each of the intermediate files.","Alternatively or optionally, the step of designating may be configured to judge whether designating data that designates the processing mode to be used for corresponding intermediate file is included in each of the intermediate files, the step of designating replacing the designating data with predetermined designating data which designates the halftone mode as the processing mode to be used.","Optionally, the method may modify either a spool file for a monochromatic image or a spool file for a multi-color image, and the step of designating may operate only when the spool file includes data indicating that a reduced image is to be printed as the modification information and when the spool file is for printing the monochromatic image.","According to a further aspect of the invention, there is provided a computer accessible medium that stores programs to be executed by a computer, the programs representing a spool file modifying method or realizing the device as described above. That is, the device and method described above may be realized when appropriate programs are provided and executed by a personal computer or the like. Such programs may be stored in recording medium such as a floppy disk, CD-ROM, memory cards and the like and distributed. Alternatively or optionally, such programs can be distributed through networks such as the Internet.","Hereinafter, a printing system according to an embodiment of the invention will be described with reference to the accompanying drawings.",{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 1","b":"1"},"When a print job is created, intermediate files, which are created by an intermediate file generating unit , are combined and stored temporarily as a spool file in a spool area  by a print spooler . If the stored spool file includes modification information, a spool file modifying module  modifies the spool file, and stores the modified spool file in the spool area  again (i.e., overwrites the spool file). Depending on an operating status of a printer , the spool file is converted into printer control codes using a GDI (Graphics Device Interface) , and the printer control codes are transmitted to the printer .","It should be noted that, the PC  generally includes hardware such as CPU, ROM, RAM, I\/O unit and the like, which operate under control of the OS. Applications such as application programs and device drivers run under control of the OS. In particular, according to the embodiment, the printer driver  and the GDI  included in the intermediate file generating module , and the print spooler  are provided as program modules which are functions of the OS. Further, the GDI , a page dividing module , an expansion\/reduction mode setting module  and an EMF modifying module  are device drivers (i.e., programs) installed in the PC  for controlling the printer  in association with the OS.","A print processor  is a program module which is installed in the PC  corresponding to the printer , aside from a print processor (not shown) originally implemented in the OS (i.e., Windows XP). The print processor  functions, in association with the spool file modifying module , to constitute a spool file processing device.","According to the embodiment, all the programs realizing various functions of the printing system are stored in a hard disk drive (HDD) .","Next, operation of the printing system will be described in detail.","As shown in , print data created by an application  running on the PC  is transmitted to a GDI , which is a program module supplied by \u201cWindows XP\u201d via the printer driver  of \u201cWindows XP\u201d. The GDI  generates a DC (device context) which is a virtual display area or a virtual device. At designated coordinates of the DC, print data which is independent of types of devices (printer) is stored for each print job (i.e., images are drawn in the virtual device). The application  represents application programs such as a word processor, a spreadsheet which run on the OS.","Generally, there are two types of GDIs: one for managing the DC and\/or creating EMFs (Enhanced Meta Files); and the other for converting the data stored in the DC to commands depending on a certain device (i.e., a target device) such as a printer or a display. The former is provided by the OS, and corresponds to the GDI  and a GDI  (which will be described later). The latter is supplied from a manufacturer of a device as a device driver, and corresponds to a GDI  (which will be described later). It should be noted that, in , the GDI  and the GDI  are shown as separate modules. However, they are provided as a single combined module having the both functions.","As described above, by drawing images on the DC, or the virtual device, EMFs (enhanced meta files, which are intermediate files) which are independent of the type of the device are generated for each page. The EMFs are combined by the print spooler system  into a spool file as one print job. The spool file is stored in the spool area  provided in the HDD . The spool file includes information for the modified printing such as multi-page printing, overlaid printing (watermark), replacement of pages and the like.","When a user operates the application  to print data which is created by the application , if the user designates the modified printing, data representing the modified printing (modification information for modifying the spool file) is added to the spool file.","It should be noted that the spool area  needs not be defined in the HDD  of the PC . As far as the spool area  can be managed from the PC , the spool area  may be provided at any place. For example, an external storage may be provided outside the PC , and the spool area  is defined in the external storage.","When the modified printing such as the multi-page printing and\/or overlaid printing is performed, the spool file modifying module  is executed, thereby spool files for respective print jobs, which are stored in the spool area , are modified for the modified printing. Specifically, the print processor  retrieves a spool file stored in the spool area , and judges wither the retrieved spool file includes the modification information. If the retrieved spool file includes the modification information, it is transferred to the spool file modifying module .","The printer  according to the embodiment is a color page printer, which is capable of printing not only a black and white image (or a monochromatic image) but also a multi-color image. Accordingly, the spool file modifying module  is configured such as to modify not only the spool files for black and white images but also the spool files for color images based on the modifying data.","The modification performed by the spool file modifying module  will be described schematically.","Firstly, the page dividing module  divides the spool file transferred from the print processor  into the EMFs (intermediate files) provided for respective pages. Then, a copy of each EMF is stored as a temporary file in the HDD . The temporary file will be deleted when it becomes unnecessary. It should be noted that, before the spool file is divided into EMFs, the spool file modifying module  obtains the modification information from the spool file and identifies the modification to be performed.",{"@attributes":{"id":"p-0064","num":"0063"},"figref":["FIG. 2","FIG. 2"]},"In the embodiment, the modification information is included in the spool file. It is only an exemplary embodiment, and the invention is not limited to this configuration. It should be noted that, such modification information is generally obtained using a sub-routine (i.e., API: Application Programming Interface) provided as a function of the OS.","Next, the EMF modifying module  applies modifications to the EMF of each page in accordance with the modification information and generates a new spool file including the new EMF.","The spool file modified by the spool file modifying module  and stored at the spool area  is transmitted to the GDI  by the print processor . Then, by the GDI , the new EMFs are converted into printer control codes suitable to the printer , and transmitted to the printer  as the print data.","It should be noted that different manufactures generally have different specifications of the printer control commands. That is, known various command sets are defined by PDL (Page-Description Language) such as \u201cPCL (Printer Control Language)\u201d of Hewlett Packard, and \u201cPostScript\u201d (registered trademark) of Adobe System Incorporated. The GDI  converts the spool file consisting of EMFs for respective pages into the printer control codes in accordance with the PDL employed in the printer .","As described above, the EMF for each page includes a plurality of records (see ). The plurality of records include a bitmap expansion\/reduction designation record indicative of an expansion\/reduction mode of a bitmap to be used for expanding and\/or reducing a bitmap.","The conversion of the spool file to the printer control codes by the GDI  is performed in association with the OS (which is \u201cWindows XP\u201d in the embodiment). As the GDI , which receives the spool file from the print processor , calls the OS, and rasterizing of the spool file is executed by the OS. A raster image, which is an image rasterized by the OS, is converted into the printer control codes by the GDI .","The rasterizing operation is performed such that the EMFs for respective pages are analyzed in order (e.g., in order from records #1, #2, . . . in the example of ). When the expansion\/reduction of a bitmap is performed during the rasterizing, if an expansion\/reduction mode is designated in the bitmap expansion\/reduction record, the expansion\/reduction of the bitmap is executed in accordance with the designated expansion\/reduction mode.","According to the present embodiment, as the expansion\/reduction mode, the black priority mode, the white priority mode and the halftone mode are available. Designation of the mode (i.e., setting of the bitmap expansion\/reduction designation record) is executed when the application  creates the EMFs. Thus, designation of the mode depends on the application .","In each EMF generated by the application , if, for example, a record #1 () is a bitmap expansion\/reduction designation record in which the halftone mode is designated, and record #2 or subsequent records include a bitmap and modifying information including reduction of the bitmap (e.g., multi-page printing), the reduction of the bitmap is performed so that the gradation of the original bitmap is retained.","If record #3 is the bitmap expansion\/reduction designation record for which the black priority mode is designated, then a bitmap included in record #3 or later is reduced in accordance with the black priority mode. Therefore, in such a case, the gradation of the original bitmap image is not retained (the gradation of the printout is collapsed).","The expansion\/reduction mode to be designated depends on the application . Generally, the halftone mode is designated. However, there are applications which designate the black priority mode, or do not designate an expansion\/reduction mode (i.e., no bitmap expansion\/reduction designation record is added). In such a case, if the bitmap reduction procedure is performed, as described above, the gradation of the original bitmap image cannot be retained in the reduced bitmap image.","According to the embodiment, during the modifying procedure executed by the spool file modifying module , an expansion\/reduction mode setting module  designates the expansion\/reduction mode as the halftone mode, which will be described in detail later. It should be noted that when the spool file before modified represents a non-halftone image (i.e., a black-and-white image), the modified spool file does not represent the image having gradation. Even in such a case, however, it is considered that the expansion\/reduction is executed with the halftone mode.","According to the printing system configured as described above, when the print processor  of the PC  judges that the spool file includes the modification information, and the spool file is transferred to the spool file modifying module , a spool file modifying procedure is executed by the spool file modifying module .  is a flowchart of a SPOOL FILE MODIFYING PROCEDURE, which is provided as a program module and executed by the PC .","When the SPOOL FILE MODIFYING PROCEDURE is initiated, in S, the modification information included in the spool file is checked, and how to modify the spool file is determined. In S, the spool file is divided into EMFs for respective pages. In S, an original print job (i.e., the spool file) stored in the spool area  is deleted, and control proceeds to S, where a MODYFICATION PROCEDURE is executed.","In S, in accordance with the modification information checked in S, the page-divided EMFs are processed (modified) and then saved as a new print job. After the spool file is modified, control pauses until all the pages are printed (S).","When the printing is finished, the SPOOL FILE MODIFICATION PROCEDURE is terminated.","Next, the MODIFICATION PROCEDURE executed in S will be described in detail. In S, as aforementioned, a procedure in accordance with the modification information included in the spool file is performed. The modification information may include execution of multi-page printing (i.e., printing with a plurality of successive pages incorporated in one page), overlaid printing (i.e., printing with semitransparent characters overlaid on another image, which is also known as watermark printing), page-exchange printing (i.e., printing with pages exchanged), and the like.","Taking the multi-page printing (e.g., 2-in-1 printing) as an example, the MODIFICATION PROCEDURE will be described.",{"@attributes":{"id":"p-0083","num":"0082"},"figref":"FIG. 4A"},"When the procedure shown in  starts, in S, a variable n indicating the number of EMF page to be processed is set to one. Then, in S, an EMF for page n (initially, page one) is extracted. In S, a printing area #1 as shown in FIG. B is defined. That is, data corresponding to one entire page if the modification is not done is assigned to be formed in a left-hand side half of a page as the 2-in-1 modification is applied. Then, in S, a ONE PAGE PROCEDURE is performed. The ONE PAGE PROCEDURE generates a new, modified spool file (EMF for each page) for 2-in-1 printing as the page-divided EMF is assigned to a predetermined DC.","After the ONE PAGE PROCEDURE in S is performed, in S, the variable n is incremented by one (i.e., n is set to two when this step is executed firstly), and control proceeds to S, where it is judged whether an EMF for page n (i.e., second page) exists. If the EMF for the n-th page does not exist, the MODIFICATION PROCEDURE is terminated. If the EMF for the n-th page exists, steps S through S, which are similar to S through S, are executed.","That is, the EMF for the n-th page is extracted (S), and a printing area #2 is defined (S) as shown in . Thus, the data of the n-th page is assigned to be printed on the right-hand side of a page by the 2-in-1 modification. Then, the ONE PAGE PROCEDURE is performed as to the EMF for the n-th page (S), and the variable n is further incremented by one (n is set to three) in S.","In S, as in S, it is judged whether the EMF for the n-th page (i.e., the third page when this step is executed first time) exists. If the EMF does not exist, the MODIFICATION PROCEDURE is terminated. If the EMF exists, the steps S and thereafter are performed for the EMF for the n-th page.","As above, the procedures in S through S modify the printing data such that the EMFs for odd number pages are printed on the left-hand side (area #1) of the pages, and the procedures in S through S modify the printing data such that the EMFs for even number pages are printed on the right-hand side (area #2) of the pages. As a result of the above procedures, two pages of printing data can be printed on a single page.","Next, the ONE PAGE PROCEDURE called in S and S of the MODIFICATION PROCEDURE shown in  will be described in detail with reference to . It should be noted that the ONE PAGE PROCEDURE shown in  is not only performed in the modification for the multi-page printing such as the 2-in-1 printing, but also called for other modification procedure when necessary.","When the ONE PAGE PROCEDURE is initiated, in S, the DC is generated by calling the GDI , which is a function of the OS. Coordinates of the DC are defined such that the printing area #1 (odd page) or the printing area #2 (even page) is an image forming area thereof. Then, in S, it is judged whether the currently processed spool file includes the modification information indicative of the reducing modification such as the multi-page printing, and whether the spool file is for the black-and-white printing. If the spool file does not include the modification information indicative of the reducing modification and it is not for the black-and-white printing, control skips S and proceeds to S. If the spool file includes the modification information indicative of the reducing modification and the spool file is for the black-and-white printing, control proceeds to S, where the expansion\/reduction mode for the EMF is set to the halftone (intermediate tone) mode.","Specifically, at the top of the EMF for the currently processed page, the bitmap expansion\/reduction designation record designating the halftone mode as the expansion\/reduction mode for the bitmap is added. In the example shown in , the bitmap expansion\/reduction designation record is newly added before record #1. Thus, if a bitmap is included in record #1 or later, the reducing operation is performed with retaining the gradation of the original bitmap.","However, as aforementioned, even if the halftone mode is designated at the top of the EMF, if the EMF includes another bitmap expansion\/reduction designation record indicative of the mode other than the halftone mode in the middle, the bitmap of the record or the later is reduced in accordance with the mode designated by the later expansion\/reduction mode.","Therefore, according to the present embodiment, as shown in , after the halftone mode is designated in S, the EMF is divided for each record in S, and the divided records are extracted in order (from record #1 in ) in S.","In S, it is judged whether the extracted record is the bitmap expansion\/reduction designation record. If the record is not the bitmap expansion\/reduction designation record, control proceeds to S, and image formation on the DC is executed in accordance with the contents of the record. If the extracted record is the bitmap expansion\/reduction designation record, control proceeds to S. In S, as in S, it is judged whether the currently processed spool file includes the modification information indicative of the reducing modification such as the multi-page printing, and whether the spool file is for the black-and-white printing.","If the spool file does not include the modification information indicative of the reducing modification or it is not for the black-and-white printing, control proceeds to S. If the spool file includes the modification information indicative of the reducing modification and the spool file is for the black-and-white printing, control proceeds to S, where the expansion\/reduction mode for the EMF is changed to the halftone (intermediate tone) mode.","In S, it is judged whether the procedure (S though S) has been executed for all the records. If the procedure has been executed for all the records, control proceeds to S and a post-processing of DC is executed. That is, the DC is closed and completion of modification for one page is informed to the spooler system . With this procedure, the non-modified EMF is replaced with the EMF which has been modified. Then the modified EMF is transmitted to the printer  depending on the operation status of the printer . As understood from the above, even if the modification has not been performed for the EMFs of all the pages, printing can be performed in order in which the EMFs have been modified.","If the decision in S is negative (there are non-processed records remained), control returns to S, and the procedure as described above is performed. With this operation, all the records constituting the EMF are finally processed (S through S are performed). As a result, at the top of the EMF, the bitmap expansion\/reduction designation record designating the halftone mode is added, and all the bitmap expansion\/reduction designation records originally included in the EMF are modified to designate the halftone mode.","As described above, according to the printing system, when the spool files generated by the application  are modified by the spool file modifying module , if the spool files include modification information designating the reduction modification and the spool files are for black-and-white printing, the expansion\/reduction mode for the spool files are changed to the halftone mode. That is, at the top of each EMF, the bitmap expansion\/reduction designation record designating the halftone mode is added, and further the bitmap expansion\/reduction designation records originally included in the EMF are changed to records designating the halftone mode.","With this modification, when the spool files are converted into printer control codes by the GDI , and the reduction of the bitmap is performed, the gradation in the original bitmap is retained in the reduced bitmap.","Further, according to the embodiment, the modification to designate the halftone mode is not applied to all the spool files. Only when the reduction results in collapse of the gradation of the bitmap (i.e., the reduction of the bitmap is designated and the spool file is for the black-and-white printing), the halftone mode is designated. Therefore, conversion from the spool file to the printer control codes can be performed efficiently and at a high speed.","The above-described embodiment is an exemplary embodiment, and various modifications can be realized without departing from the gist of the invention.","For example, in the embodiment, the procedure for executing the 2-in-1 printing is described. However, the invention can be applied to the multi-page printing other than the 2-in-1 printing.","Further, the invention can be applied in a case other than the multi-page printing. For example, when a print job, generated by the application , is modified such that an image corresponding to a certain size of a sheet is reduced so as to be printed on a smaller size sheet, the bitmap expansion\/reduction designation records designating the halftone printing can be added\/substituted.",{"@attributes":{"id":"p-0104","num":"0103"},"figref":"FIG. 6"},"In this procedure, in S, the size of the sheet is designated. The designation of the size of the sheet is performed based on sheet size information (which is information indicating the size of sheet to be used when printed) included in the modification information.","Once the sheet size is designated, in S, the ONE PAGE PROCEDURE corresponding to the designated sheet size is executed. The ONE PAGE PROCEDURE is similar to that shown in . After the ONE PAGE PROCEDURE is executed for all the pages of the EMFs (S: YES), the procedure is terminated.","As described above, the spool file modifying system can be applied to all the modification including the page reduction, and when applied, the gradation of the original images can be retained in the reduced images.","In the above-described embodiment, the programs that realize the functions of the spool file modifying device (e.g., the functions of the spool file modifying module , the print processor  and the like) are stored in the HDD . However, the programs may be stored in any other medium such as a floppy disk, magneto-optical disk, CD-ROM, ROM, non-volatile memory and the like which are accessible by a computer. By loading the necessary programs from such a medium into the computer system, the spool file modifying device can be realized on the computer. It should be noted that such programs can be distributed through networks such as the Internet, and installed in a computer to realize the printing system.","The present disclosure relates to the subject matter contained in Japanese Patent Application No. 2002-051648, filed on Feb. 27, 2002, which is expressly incorporated herein by reference in its entirety."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE ACCOMPANYING DRAWINGS","p":[{"@attributes":{"id":"p-0038","num":"0037"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0039","num":"0038"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0041","num":"0040"},"figref":["FIG. 4A","FIG. 3"],"b":"140"},{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 4B"},{"@attributes":{"id":"p-0043","num":"0042"},"figref":["FIG. 5","FIG. 4A"]},{"@attributes":{"id":"p-0044","num":"0043"},"figref":["FIG. 6","FIG. 3"]},{"@attributes":{"id":"p-0045","num":"0044"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 8A"},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 8B"}]},"DETDESC":[{},{}]}
