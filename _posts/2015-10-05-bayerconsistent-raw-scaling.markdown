---
title: Bayer-consistent raw scaling
abstract: A system and method for scaling an image includes receiving raw image data comprising input pixel values which correspond to pixels of an image sensor; and filtering pixels according to a Bayer-consistent ruleset by a first scaling factor in a first direction and a second scaling factor in a second direction perpendicular to the first direction, wherein the first scaling factor is different from the second scaling factor. The system and method may also include outputting scaled image data as output pixel values, which correspond to subgroups of the input pixel values. The Bayer-consistent ruleset includes a set of filter weights and a series of scaling rules. The Bayer-consistent ruleset results in a scaled image having a high degree of Bayer-consistency.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09514514&OS=09514514&RS=09514514
owner: Sony Corporation
number: 09514514
owner_city: Tokyo
owner_country: JP
publication_date: 20151005
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["CROSS-REFERENCE TO RELATED APPLICATIONS","BACKGROUND OF THE INVENTION","BRIEF SUMMARY OF THE INVENTION","DETAILED DESCRIPTION"],"p":["This application is a continuation-in-part of U.S. patent application Ser. No. 14\/496,865, filed with the United States Patent & Trademark Office on Sep. 25, 2014. The entirety of the previous application is herein incorporated by reference.","1. Field of the Invention","This application relates generally to digital image scaling. More specifically, this application relates to a raw domain image scaling system and method that maintains Bayer consistency.","2. Description of Related Art","In a digital image capturing system, it is common that the resolution requirement for still image capture is higher than that of video output. In such a case, a high-resolution camera capable of supporting the resolution requirement of still image capture is often used. When the camera is used in video mode to produce a video output stream, the data is scaled down to suit the resolution of the video output. For example, a particular image sensor with 18 million pixels (megapixels or MP) can give 18 MP still images. For the same image sensor in video mode, a resolution of 1080\u00d71920 pixels, or approximately 2 MP, may suffice to produce 1080p high-definition (HD) video. Therefore, in 1080p video mode, the image data is scaled down 3\u00d7 both vertically and horizontally to provide the desired output resolution.","In addition to scale changes with the same horizontal and vertical scaling factor, there exist applications where scaling by different scaling factors in the horizontal and vertical directions is required. For example, if an image sensor uses rectangular pixels and there is a need to send out images from the sensor targeted to be displayed on devices with square pixels, then it is necessary to re-sample the image. Such a re-sampling requires scaling the image using different scaling factors in the horizontal and vertical directions. Generally, when the aspect ratio of the image capture device is different from the aspect ratio of the display device, or when the pixel geometry of the image capture device is different form the pixel geometry of the display device, it is necessarily to scale the image in this manner.","This scaling may be performed either in the raw domain or the RGB domain. An advantage of scaling the image data in the raw domain to the desired video resolution is that it reduces the number of pixels that must be processed through the system. As a result, a majority of processing blocks in an image pipeline or post-processing section can be operated at a lower clock rate than the clock rate required to support full-resolution processing. Operating the processing section at a lower clock rate has significant advantages in reducing electromagnetic interference and reducing power consumption of the system. These advantages are especially valuable in such applications as mobile imaging.","However, existing methods of scaling in the raw domain suffer from several disadvantages, including difficulty in maintaining a Bayer output pattern without resorting to increasingly complex, expensive, and resource-intensive logic circuitry. Additionally, such existing scaling methods suffer from inferior image quality when compared to scaling in the RGB domain.","Accordingly, there is a need for raw image scaling with different scaling factors in the horizontal and vertical directions that can efficiently produce output images of high image quality (that is, with good resolution) which are free of the image artifacts produced by existing raw image scaling.","Various aspects of the present disclosure relate to a system and method for scaling an image. The scaling includes receiving raw image data comprising a plurality of input pixel values, respective ones of the input pixel values corresponding to a respective pixel of an image sensor; filtering respective ones of the plurality of pixels according to a Bayer-consistent ruleset; and outputting scaled image data comprising a plurality of output pixel values, respective ones of the output pixel values corresponding to a subgroup of the plurality of input pixel values.","In one example, Bayer-consistent ruleset includes: a plurality of filter weights; a first rule that a respective output pixel value corresponds to a first color, and the corresponding subgroup of the plurality of input pixel values also corresponds to the first color; a second rule that the plurality of input pixel values corresponds to a plurality of input sub-tiles and the filter weights for the first color are concentrated within an input sub-tile of the same color; and a third rule that a center of gravity of the filter weights for the first color coincides with the geometric pixel center of the output pixel of the first color. The Bayer-consistent ruleset results in a scaled image having a high degree of Bayer-consistency.","In this manner, various aspects of the present disclosure provide for improvements in at least the underlying technical processes of image capturing and image processing.","This disclosure can be embodied in various forms, including business processes, computer-implemented methods, computer program products, computer systems and networks, user interfaces, application programming interfaces, hardware-implemented methods, signal processing circuits, image sensor circuits, application specific integrated circuits, field programmable gate arrays, and the like. The foregoing summary is intended solely to give a general idea of various aspects of the present disclosure, and does not limit the scope of the disclosure in any way.","In the following description, numerous details are set forth, such as flowcharts, data tables, and system configurations. It will be readily apparent to one skilled in the art that these specific details are merely exemplary and not intended to limit the scope of this application.","[Imaging System]",{"@attributes":{"id":"p-0038","num":"0037"},"figref":["FIGS. 1A-C","FIG. 1A","FIG. 1B","FIG. 1C"],"b":["1","1","100","200","1","200","1","200","1","100"],"i":["a","c ","a","c ","a","c ","a","c","a ","a","b ","b","c ","c"]},"In all three of , image pipeline -includes a raw domain processing section (for example, a raw domain processing circuit) -which comprises a series of raw domain processing blocks P, . . . , Pn. These raw domain processing blocks process raw image data (also called raw pixel data) in the same format as they are captured from the image sensor. Additionally, image pipeline -includes a demosaic section (for example, a demosaic circuit) -which converts raw image data into full color image data; that is, data wherein each pixel includes all RGB values. Furthermore, image pipeline -includes an RGB domain processing section (for example, an RGB domain processing circuit) -which comprises a series of RGB domain processing blocks Q, . . . , Qk. Examples of processing blocks or circuits in image pipeline -include lens artifact correction, bad pixel correction, color correction, noise filtering, sharpening, and the like.","In , RGB domain processing section includes an RGB scaling section (for example, a scaling circuit) . In , raw domain processing section includes a raw scaling section . In , image sensor includes scaling section . While the three exemplary views show only a single RGB or raw scaling section, exemplary image capturing systems may have the capability of supporting both raw domain image scaling and RGB domain image scaling. In such case, both a raw scaling section and an RGB scaling section would be present in the same image capturing system. Such an arrangement would provide the user or system designer with the capability of selecting either raw scaling, RGB scaling, or both, to suit specific operating conditions as desired.","The raw scaling techniques described herein improve the functioning of the image sensor and\/or the image pipeline by allowing it to produce output images of high quality with fewer artifacts.","Image pipeline -may be implemented either in hardware, software, or a mixture of both. Examples of hardware implementations include application specific integrated circuit (ASIC), field programming logic array (FPGA), other programmable logic circuits, discrete circuit elements, and the like. Examples of software implementations include firmware in an embedded chip, software in digital signal processors (DSP), software in a simulator, software in a graphics processing unit (GPU), software in a general purpose central processing unit (CPU), and the like. A mixture of hardware and software may also be used wherein some blocks in image pipeline -are implemented in hardware, with the remaining blocks implemented in software. In one example, one or more of image sensor -and image pipeline -, or subunits thereof, are implemented as a processing unit and a memory.",{"@attributes":{"id":"p-0043","num":"0042"},"figref":["FIGS. 2A-B","FIG. 2A","FIG. 1A","FIG. 2B"],"b":["100","100","100","100"],"i":["a","c","a ","a ","c "]},"In , image sensor includes a pixel array , including a plurality of pixels  arranged in rows and columns. Individual pixels  include pixel elements such as a photosensitive element (for example, a photodiode) and associated control circuits (for example, transistors). The pixel array  is connected to a readout circuit  so that analog data values from pixels  may be sent to a bank of analog-to-digital converters (ADCs) , which convert the pixel data values into digital form. Pixel array , readout circuit , and ADCs  are controlled by a sequencer and timing control circuit  which controls the ordering of pixel reading operations and the timing of the circuit elements in pixel array . ADCs  may include single slope ADCs, cyclic ADCs, successive approximation ADCs, sigma-delta ADCs (also known as delta-sigma ADCs), and the like.","In , ADCs  are sigma-delta ADCs. A sigma-delta ADC requires oversampling and gives out a sequence of D bit samples, where D is typically a low number such as 1. In order to generate multi-bit output digital values (for example, V-bit samples where V>D), a decimation filter is required which removes high frequency content in the D-bit sample sequence. Specifically, as illustrated in , sigma-delta ADC  is operatively connected to an ADC filter block (ADCF)  to operate as a decimation filter. As will be discussed in more detail below, the raw domain image scaling calculations can be implemented with ADCF  as a single digital filter, which leads to a very efficient implementation that has several advantages.","In , ADCF  is illustrated as being downstream from the ADC . In this manner, raw scaling in the digital domain may be performed. Alternatively or additionally, filters may be placed upstream from ADC  so as to perform raw scaling in the analog domain. In implementations where filters are placed both upstream and downstream from ADC , greater scaling flexibility may be achieved. For example, one can choose to filter either in the analog or digital domain, or may filter particular pixels (for example, filtering in the horizontal direction) in the analog domain and other pixels (for example, filtering in the vertical direction) in the digital domain.","To provide for color images, a color filter array (CFA) is provided with image sensor , so that each pixel gives a data value corresponding to a single primary color.  illustrates a so-called \u201cBayer\u201d CFA  for use with image sensor . In this example, R represents the pixels coated or provided with optical red filters, which therefore give only red pixel values. Similarly, B represents the pixels coated or provided with optical blue filters, which therefore give only blue pixel values. Both G and G represent pixels coated or provided with green optical filters, which therefore give only green pixel values. Because the green pixels sharing a row with red pixels and the green pixels sharing a row with blue pixels may have different pixel characteristics due to cross-talk and other reasons, they are labeled with the different notations G and G, respectively. While the Bayer CFA illustrated in  uses an RGB layout, the CFA is not particularly limited in this regard. For example, other color arrangements are possible such as red\/green\/blue\/white (RGBW); cyan\/magenta\/yellow (CMY); cyan\/magenta\/yellow\/green (CMYG); and the like.","In , RGB Bayer CFA  comprises a tiled or repeating arrangement of 2\u00d72 blocks  of pixels , comprising an R pixel in the upper left corner thereof, a G pixel in the upper right corner thereof, a G pixel in the lower left corner thereof, and a B pixel in the lower right corner thereof. One of ordinary skill in the art will readily recognize that other orderings are possible, such as B\/G\/G\/R, G\/R\/B\/G, G\/B\/R\/G, and the like, as well as other primary or complementary color combinations such as C\/M\/Y\/Y, or combinations of color and white such as R\/G\/B\/W.","[General Scaling]","In practical imaging system implementations, the raw domain scaling method can be implemented either in hardware or software, or a mixture of both. For software implementations, the calculations in the scaling method can be implemented using embedded processors, digital signal processors, general purpose processors, software simulation units, and the like. For hardware implementations, the calculations in the scaling method can be implemented using digital means or analog means. Digital implementation in hardware uses digital logic elements such as gates, latches, arithmetic units, and the like. The logic elements can be included into an ASIC, an FPGA, discrete elements, or other programmable circuits. Analog implementation in hardware can include capacitive or resistive circuit elements such as summing junctions, voltage or current dividers, operational amplifiers, and the like.","The raw scaling method can be considered a filtering process followed by decimation. Scaling occurs according to a scaling factor (1\/N)\u00d7, where a Bayer input region of 2N\u00d72N is processed to produce a 2\u00d72 Bayer output region.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":["FIG. 4","FIG. 4","FIG. 5"],"b":["401","402","403"]},"In , raw input pixels in each tile of size 4\u00d74 are processed by four filters to give a 2\u00d72 block in the output raw image. In the particularly illustrated filtering procedure, the pixel values of each red pixel are considered to be in a red pixel array R defined as {r, r, r, r}. Red pixel array R is operated on by a red filter coefficient array H defined as {h, h, h, h} to provide an output red pixel R\u2032. Specifically, each element of red pixel array R is multiplied by the corresponding element of red filter coefficient array H. That is, the coefficients in the red filter array are weights to be applied to the corresponding pixel values in the red pixel array. The products are then added together and divided by the sum of all elements of red filter coefficient array H to produce the output red pixel R\u2032. Mathematically, this is represented by the following expression (1):",{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msup":{"mi":["R","\u2032"]},"mo":"=","mfrac":{"mrow":[{"mrow":[{"msub":{"mi":"r","mrow":{"mn":["1","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"msub":{"mi":"r","mrow":{"mn":["1","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"msub":{"mi":"r","mrow":{"mn":["2","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"msub":{"mi":"r","mrow":{"mn":["2","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]},{"mrow":[{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"mn":"1"}}]}}}}},"Similarly, the pixel values of each green pixel in red rows are considered to be in a first green pixel array G defined as {g, g, g, g} and are operated on by a first green filter coefficient array I defined as {i, i, i, i} to output first green pixel G\u2032; the pixel values of each green pixel in blue rows are considered to be in a second green pixel array G defined as {g, g, g, g} and are operated on by a second green filter coefficient array J defined as {j, j, j, j} to output second green pixel G\u2032; and the pixel values of each blue pixel are considered to be in a blue pixel array B defined as {b, b, b, b} and are operated on by a blue filter coefficient array K defined as {k, k, k, k} to output blue pixel B\u2032. These operations are represented by the following expressions (2)-(4):",{"@attributes":{"id":"p-0056","num":"0055"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mi":"G","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"1","mi":"\u2032"}},"mo":"=","mfrac":{"mrow":[{"mrow":[{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["1","1"],"mo":","}},"mn":"0"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["1","2"],"mo":","}},"mn":"1"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["2","1"],"mo":","}},"mn":"2"},{"mi":["g","h"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["2","2"],"mo":","}},"mn":"3"}],"mo":["+","+","+"]},{"mrow":[{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"mn":"2"}}]},{"mtd":[{"mrow":{"mrow":{"mi":"G","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"2","mi":"\u2032"}},"mo":"=","mfrac":{"mrow":[{"mrow":[{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["1","1"],"mo":","}},"mn":"0"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["1","2"],"mo":","}},"mn":"1"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["2","1"],"mo":","}},"mn":"2"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["2","2"],"mo":","}},"mn":"3"}],"mo":["+","+","+"]},{"mrow":[{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"mn":"3"}}]},{"mtd":[{"mrow":{"msup":{"mi":["B","\u2032"]},"mo":"=","mfrac":{"mrow":[{"mrow":[{"msub":{"mi":"b","mrow":{"mn":["1","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"msub":{"mi":"b","mrow":{"mn":["1","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"msub":{"mi":"b","mrow":{"mn":["2","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"msub":{"mi":"b","mrow":{"mn":["2","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]},{"mrow":[{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"}],"mo":["+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"mn":"4"}}]}]}}}},"The above filtering representation is not limited to scaling by the same scaling factor in both the horizontal and vertical directions, and may be extended to scaling by (1\/M)\u00d7 in the vertical direction and (1\/N)\u00d7 in the horizontal direction. For example,  illustrates a general example of a scaling method with a vertical scaling factor of (\u00bd)\u00d7 and a horizontal scaling factor of (\u2153)\u00d7.","In , a block of 4\u00d76 (that is, 4 rows by 6 columns) of raw pixels is processed by four filters to give a 2\u00d72 block of output raw pixels. In this illustration, the pixel values of each red pixel are considered to be in a red pixel array R defined as {r, r, r, r, r, r} where rrepresents the pixel in row i, column j of the block. Red pixel array R is operated on by a red filter coefficient array H defined as {h, h, h, h, h, h} to provide an output red pixel R\u2032. Specifically, each element of red pixel array R is multiplied by the corresponding element of red filter coefficient array H. Thus, the coefficients in the red filter array are weights to be applied to the corresponding pixel values in the red pixel array. The products are then added together and divided by the sum of all elements of red filter coefficient array H to produce the output red pixel R\u2032. Mathematically, this is represented by the following expression (1\u2032):",{"@attributes":{"id":"p-0059","num":"0058"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msup":{"mi":["R","\u2032"]},"mo":"=","mfrac":{"mrow":[{"mrow":[{"msub":{"mi":"r","mrow":{"mn":["1","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"msub":{"mi":"r","mrow":{"mn":["1","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"msub":{"mi":"r","mrow":{"mn":["1","3"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"msub":{"mi":"r","mrow":{"mn":["2","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"msub":{"mi":"r","mrow":{"mn":["2","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"msub":{"mi":"r","mrow":{"mn":["2","3"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"h","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]},{"mrow":[{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"mi":"h","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"1","mi":"\u2032"}}}]}}}}},"Similarly, the pixel values of each green pixel in red rows are considered to be in a first green pixel array G defined as {g, g, g, g, g, g} and are operated on by a first green filter coefficient array I defined as {i, i, i, i, i, i} to output first green pixel G\u2032; the pixel values of each green pixel in blue rows are considered to be in a second green pixel array G defined as {g, g, g, g, g, g} and are operated on by a second green filter coefficient array J defined as {j, j, j, j, j, j} to output second green pixel G\u2032; and the pixel values of each blue pixel are considered to be in a blue pixel array B defined as {b, b, b, b, b, b} and are operated on by a blue filter coefficient array K defined as {k, k, k, k, k, k} to output blue pixel B\u2032. These operations are represented by the following expressions (2\u2032)-(4\u2032):",{"@attributes":{"id":"p-0061","num":"0060"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":{"mi":"G","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"1","mi":"\u2032"}},"mo":"=","mfrac":{"mrow":[{"mrow":[{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["1","1"],"mo":","}},"mn":"0"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["1","2"],"mo":","}},"mn":"1"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["1","3"],"mo":","}},"mn":"2"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["2","1"],"mo":","}},"mn":"3"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["2","2"],"mo":","}},"mn":"4"},{"mi":["g","i"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"1","mrow":{"mn":["2","3"],"mo":","}},"mn":"5"}],"mo":["+","+","+","+","+"]},{"mrow":[{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"mi":"i","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"2","mi":"\u2032"}}}]},{"mtd":[{"mrow":{"mrow":{"mi":"G","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mn":"2","mi":"\u2032"}},"mo":"=","mfrac":{"mrow":[{"mrow":[{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["1","1"],"mo":","}},"mn":"0"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["1","2"],"mo":","}},"mn":"1"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["1","3"],"mo":","}},"mn":"2"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["2","1"],"mo":","}},"mn":"3"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["2","2"],"mo":","}},"mn":"4"},{"mi":["g","j"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}],"msub":{"mn":"2","mrow":{"mn":["2","3"],"mo":","}},"mn":"5"}],"mo":["+","+","+","+","+"]},{"mrow":[{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"mi":"j","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]}]}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"3","mi":"\u2032"}}}]},{"mtd":[{"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"4.4em","height":"4.4ex"}}},"mo":"\u2062","mrow":{"msup":{"mi":["B","\u2032"]},"mo":"=","mfrac":{"mrow":[{"mrow":[{"msub":{"mi":"b","mrow":{"mn":["1","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"msub":{"mi":"b","mrow":{"mn":["1","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"msub":{"mi":"b","mrow":{"mn":["1","3"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"msub":{"mi":"b","mrow":{"mn":["2","1"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"msub":{"mi":"b","mrow":{"mn":["2","2"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"msub":{"mi":"b","mrow":{"mn":["2","3"],"mo":","}},"mo":["\u2062","\u2062","\u2062"],"mi":"k","mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]},{"mrow":[{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"0"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"1"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"2"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"3"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"4"},{"mi":"k","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mn":"5"}],"mo":["+","+","+","+","+"]}]}}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"4","mi":"\u2032"}}}]}]}}}},"The filtering representation described above can be generalized to other scaling factors (1\/N)\u00d7 for any integer N, and may be generalized even further to any combination of vertical scaling factor (1\/M)\u00d7 and horizontal scaling factor (1\/N)\u00d7, for integer M and N. For a scaling factor (1\/N)\u00d7 in both directions, an input region of size 2N\u00d72N is used. In this manner, to produce an output pixel of a particular color, only input pixels of the same color are considered as an input to the filter. As a result, each filter array includes only Ncoefficients. Alternatively, it is possible to calculate a particular color output pixel value using the pixels of other colors. In that case, the number of filter coefficients used for a scaling factor (1\/N)\u00d7 will have more than Nterms. Additionally, the regions of support of the filters for a scaling factor (1\/N)\u00d7 can be expanded beyond the 2N\u00d72N region, and in such a case the number of filter coefficients used for a scaling factor (1\/N)\u00d7 will also have more than Nterms.","For the case of a scaling factor (1\/M)\u00d7 and horizontal scaling factor (1\/N)\u00d7, an input region of size 2M\u00d72N is used. Thus, similar to above, to produce an output pixel of a particular color, only input pixels of the same color are considered as an input to the filter. As a result, each filter array here includes only M\u00d7N coefficients. As above, it is possible to calculate a particular color output pixel value using the pixels of other colors. In such a case, the number of filter coefficients will have more than M\u00d7N terms. Additionally, the regions of support of the filters for a scaling factor (1\/N)\u00d7 can be expanded beyond the 2M\u00d72N region, and in such a case the number of filter coefficients will again have more than M\u00d7N terms.","[Pixel Skipping and Binning]","Conceptually, a pixel skipping method at a scaling factor (1\/N)\u00d7 is one that tiles an original image with 2N\u00d72N cells, and for each cell retains only the four pixels in a 2\u00d72 configuration in the upper left corner of each cell. All other pixels in the cell are discarded or skipped.","Using the above filtering representation, raw pixel scaling at (\u00bd)\u00d7 in both directions using the pixel skipping method may be represented by the filters H={1, 0, 0, 0}; I={1, 0, 0, 0}; J={1, 0, 0, 0}; and K={1, 0, 0, 0}. Similarly, for raw pixel scaling at (\u00bd)\u00d7 in the vertical direction and (\u2153)\u00d7 in the horizontal direction, the scaling operation may be represented by the filters H={1, 0, 0, 0, 0, 0}; I={1, 0, 0, 0, 0, 0}; J={1, 0, 0, 0, 0, 0}; and K={1, 0, 0, 0, 0, 0}. For convenience of notation in the filter coefficient arrays, only the coefficients corresponding to pixels of the same color are written.","The pixel skipping method may lead to a loss of information because many pixels are simply ignored. That is, for a scaling factor of (1\/N)\u00d7 in both directions, only one out of every Npixels are retained and the rest are discarded; similarly, for a scaling factor of (1\/M)\u00d7 in the vertical direction and (1\/N)\u00d7 in the horizontal direction, only one out of every M\u00d7N pixels are retained and the rest are discarded.","Conceptually, a binning method at a scaling factor (1\/N)\u00d7 is one that tiles an input raw image with 2N\u00d72N cells, and for each cell calculates the arithmetic averages of each color as the respective pixel values in a 2\u00d72 cell of the output raw image. For purposes of this calculation, G and G are treated as different colors, even though they both correspond to the color green, and the averages for G and G are calculated independently.","Again using the above filtering representation, raw pixel scaling at (\u00bd)\u00d7 in both directions using the binning method may be represented by the filters H={\u00bc, \u00bc, \u00bc, \u00bc}; I ={\u00bc, \u00bc, \u00bc, \u00bc}; J={\u00bc, \u00bc, \u00bc, \u00bc}; and K={\u00bc, \u00bc, \u00bc, \u00bc}. Similarly, for raw pixel scaling at (\u00bd)\u00d7 in the vertical direction and (\u2153)\u00d7 in the horizontal direction, the scaling operation may be represented by the filters H={\u2159, \u2159, \u2159, \u2159, \u2159, \u2159}; I={\u2159, \u2159, \u2159, \u2159, \u2159, \u2159}; J={\u2159, \u2159, \u2159, \u2159, \u2159, \u2159}; and K={\u2159, \u2159, \u2159, \u2159, \u2159, \u2159}. Again, for convenience of notation, only the coefficients corresponding to pixels of the same color are written.","In contrast to pixel skipping, binning represents an opposite approach where all the N(or M\u00d7N) pixels are retained with equal weights in the output image. This may lead to a loss of resolution, create aliasing artifacts, result in uneven phase in pixels of different colors, and the like.","[Bayer-Consistent Scaling]","Pixel skipping and binning methods typically produce output images of sub-optimal quality; for example, having image artifacts, requiring expensive correction circuits, and the like. As a result, there is a need for a raw domain image scaling method which maintains Bayer consistency.","A raw domain image scaling method that maintains Bayer consistency is called \u201cBayer-consistent raw scaling\u201d (BCRS). An example of BCRS with a scaling factor of (\u2153)\u00d7 (that is, N=3) is illustrated in . In this case, the input raw image is divided into tiles of size 6\u00d76, and from each 6\u00d76 input tile the scaling method calculates a 2\u00d72 block of the output image. As illustrated, each 6\u00d76 input tile  is divided into four 3\u00d73 sub-tiles - that respectively represent the physical area of virtual pixel - in a block  of a virtual image sensor having a lower resolution equal to the scaled resolution. That is, the virtual image sensor would have \u2153 the resolution both vertically and horizontally compared to the actual image sensor used for capturing the raw image data.","Sub-tiles - are identified by the color of the corresponding virtual pixel -, under the assumption that the virtual image sensor uses the same Bayer CFA as the actual image sensor. For example, sub-tile  is identified as an R sub-tile because it corresponds to virtual pixel , which is positioned where the R filter would be in a Bayer CFA on the virtual image sensor. Similarly, sub-tile  is identified as a G sub-tile, sub-tile  as a G sub-tile, and  as a B sub-tile.","A similar example of BCRS with a scaling factor of (\u00bc)\u00d7 is illustrated in . That is, the input raw image is divided into tiles of 8\u00d78, and from each 8\u00d78 input tile the scaling method calculates a 2\u00d72 output block. Here, each 8\u00d78 tile  is divided into four 4\u00d74 sub-tiles - that respectively represent the physical area of a virtual pixel - in a block  of a virtual image sensor having a resolution equal to \u00bc the resolution both vertically and horizontally compared to the actual image sensor.","An extension of BCRS to scaling by different scaling factors in different directions is illustrated in . Specifically,  illustrates a scaling by (\u2153)\u00d7 in the vertical direction and (\u00bc)\u00d7 in the horizontal direction. Here, the input raw image is divided into tiles of 6\u00d78, and from each 6\u00d78 input tile the scaling method calculates a 2\u00d72 output block. In this method, each 6\u00d78 tile  is divided into four 3\u00d74 sub-tiles - that respectively represent the physical area of a virtual pixel - in a block  of a virtual image sensor having a resolution equal to \u2153 the resolution vertically and \u00bc the resolution horizontally compared to the actual image sensor.","In each of , the geometric pixel centers of the virtual pixels -, -, and - are indicated by dashed lines. The corresponding physical locations are indicated by arrows in input tiles , , and ; these are collocated with the centers of the sub-tiles -, -, and -.","In light of the above requirements, BCRS is performed so as to satisfy the following conditions: (1) only input pixels of the same color as the output are used in the calculation of the output pixel value; (2) the filter weights are concentrated within the sub-tile of the same color; and (3) the center of gravity of the filter weights for each color coincides with the geometric pixel center of the output pixel of the same color. Taken together, these Bayer-consistency conditions form a Bayer-consistency ruleset, which provide for improved scaling quality.","To measure the degree of Bayer consistency, a criterion called a Bayer-consistency coefficient C may be defined which includes two components corresponding to conditions (2) and (3) above. The first component \u03b3 measures the concentration of filter weights within the sub-tile of the same color, and is defined according to the following expressions (5) and (6):",{"@attributes":{"id":"p-0080","num":"0079"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"\u03b3","mo":"=","mrow":{"mfrac":{"mn":["1","4"]},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"c"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["\u03b3","c"]}}}}},{"mrow":{"mo":["(",")"],"mn":"5"}}]},{"mtd":[{"mrow":{"msub":{"mi":["\u03b3","c"]},"mo":"=","mfrac":{"msup":[{"mrow":{"msub":{"mi":"\u03a3","mrow":{"mi":["c","sub","tile"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mtext":"-"}]}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["filter","coefficients","for","c","colored","pixels"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]}}},"mn":"2"},{"mrow":{"msub":{"mi":"\u03a3","mrow":{"mi":["all","sub","tiles"],"mo":["\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mtext":"-"}]}},"mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["filter","coefficients","for","c","colored","pixels"],"mo":["\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062","\u2062"],"mstyle":[{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}},{"mspace":{"@attributes":{"width":"0.8em","height":"0.8ex"}}}]}}},"mn":"2"}]}}},{"mrow":{"mo":["(",")"],"mn":"6"}}]}]}}}},"For a filter of color c where the weights are completely concentrated within the c sub-tile (that is, with non-zero weights only inside the c sub-tile), \u03b3achieves a maximum value of 1. Accordingly, each \u03b3has a possible range of values between 0 and 1, and hence \u03b3 is also between 0 and 1.","The second component \u03b2 measures the deviation of the center of gravities of the filter weights from the geometric pixel centers of the output image; that is, geometric pixel centers of a lower resolution virtual grid. It is defined for scaling by (1\/N)\u00d7 in both directions according to the following expressions (7) and (8):",{"@attributes":{"id":"p-0083","num":"0082"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"\u03b2","mo":"=","mrow":{"mi":"max","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mrow":{"mn":"1","mo":"-","mrow":{"mfrac":{"mn":["1","4"]},"mo":"\u2062","mrow":{"munder":{"mo":"\u2211","mi":"c"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["D","c"]}}}},"mo":",","mn":"0"}}}}},{"mrow":{"mo":["(",")"],"mn":"7"}}]},{"mtd":[{"mrow":{"msub":{"mi":["D","c"]},"mo":"=","mfrac":{"msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"msubsup":{"mi":["d","c","h"]}},"mn":"2"},{"mrow":{"mo":["(",")"],"msubsup":{"mi":["d","c","v"]}},"mn":"2"}],"mo":"+"}},"mrow":{"mi":["N","\u0394"],"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}}}}}},{"mrow":{"mo":["(",")"],"mn":"8"}}]}]}}}},"Above, \u0394 is the length of the input pixel, dand dare the horizontal and vertical distances, respectively, between the center of gravity of the filter coefficients for the color c and the geometric pixel center of the c color pixel in the corresponding virtual grid, and N is the integer in the scaling factor (1\/N)\u00d7. For a filter where the center of gravities of the filter coefficient in all four colors coincide with the geometric pixel center of the output pixel of respective colors, D=0 for all c and \u03b2 achieves a maximum value of 1. Hence, \u03b2 is between 0 and 1.","The calculations of Din expression (8) above assume that the pixels have a square shape; that is, both the width and height of the pixels are equal to \u0394. In the case of rectangular pixels, the calculations can be performed by first normalizing dand dby the width and height, respectively, of the pixel, and then calculating Das the root mean square of the normalized values. In other words, for scaling by (1\/M)\u00d7 in the vertical direction and (1\/N)\u00d7 in the horizontal direction, expression (8) becomes the following expression (8\u2032):",{"@attributes":{"id":"p-0086","num":"0085"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["D","c"]},"mo":"=","msqrt":{"mrow":{"msup":[{"mrow":{"mo":["(",")"],"mfrac":{"msubsup":{"mi":["d","c","h"]},"mrow":{"mi":"N","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["\u0394","h"]}}}},"mn":"2"},{"mrow":{"mo":["(",")"],"mfrac":{"msubsup":{"mi":["d","c","v"]},"mrow":{"mi":"M","mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":["\u0394","v"]}}}},"mn":"2"}],"mo":"+"}}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"8","mi":"\u2032"}}}]}}}}},"Above, \u0394is the horizontal length of the input pixel, and \u0394is the vertical length of the input pixel.","To consider the overall effect of both \u03b3 and \u03b2, Bayer-consistency coefficient C is defined according to the following expression (9):\n\n=\u03bc\u03b3+(1\u2212\u03bc)\u03b2\u2003\u2003(9)\n","The parameter \u03bc has a value between 0 and 1, and is used as a weight for the two components \u03b3 and \u03b2. Therefore, as is readily apparent, C has a possible range of values between 0 and 1. For performance evaluation, \u03bc=0.5 may be used. The performance evaluation parameter \u03bc has a value between 0 and 1, and is used as a weight for the two components \u03b3 and \u03b2. In the above expression, a high \u03b3 indicates a high degree of image sharpness, whereas a high \u03b2 indicates an image free from jagged edges. A value of \u03bc=0.5 is chosen for a balance between image sharpness and an image free of jagged edges. Using this definition, raw scaling filters with higher values of C are preferred. In other words, filters which exhibit a higher degree of Bayer-consistency lead to higher image quality; for example, having C\u22670.65. More preferably, C\u22670.8. Most preferably, C>0.9.","For comparison, consider the pixel skipping and binning scaling methods described above. For pixel skipping at a scaling factor of (\u00bd)\u00d7 in both directions, the values of \u03b3are 1, 0, 0, 0 for the colors R, G, G, and B, respectively. Therefore, \u03b3=0.25. Additionally, it can be calculated that the horizontal distance dequals 0.5\u0394, 1.5\u0394, 0.5\u0394, and 1.5\u0394 for R, G, G, and B, respectively; whereas the vertical distance dequals 0.5\u0394, 0.5\u0394, 1.5\u0394, and 1.5\u0394 for R, G, G, and B, respectively. Accordingly, \u03b2=0.2512. Using \u03bc=0.5 for evaluation, the Bayer consistency coefficient C for pixel skipping is 0.2506 for a scaling factor of (\u00bd)\u00d7 in both directions. By similar calculations, the Bayer consistency coefficient C for pixel skipping equals 0.1258 for (\u2153)\u00d7 in both directions and 0.1250 for (\u00bc)\u00d7 in both directions.","For binning at a scaling factor of (\u00bd)\u00d7 in both directions, \u03b3is (\u00bc)\/(\u00bc+\u00bc+\u00bc+\u00bc)\u2014that is, 0.25\u2014for each color c, and therefore \u03b3=0.25. Both the horizontal distance dand the vertical distance dequal 0.54 for any color c, and therefore \u03b2=0.6464. Again using \u03bc=0.5 for evaluation, the Bayer consistency coefficient C for binning is 0.4482 for a scaling factor of (\u00bd)\u00d7 in both directions. By similar calculations, the Bayer consistency coefficient C for binning equals 0.4865 for (\u2153)\u00d7 in both directions and 0.3598 for (\u00bc)\u00d7 in both directions.","On the other hand, a BCRS filter configured to satisfy the three Bayer consistency conditions defined above provides a high Bayer consistency coefficient value and good image quality.  provides an example of such a filter for a scaling factor of (\u2153)\u00d7 in both directions. For the particular filter illustrated in , \u03b3is (\u00bc+\u00bc+\u00bc+\u00bc)\/(\u00bc+\u00bc+\u00bc+\u00bc) for any c.  provides an example of such a filter for a scaling factor of (\u2153)\u00d7 in the vertical direction and (\u00bd)\u00d7 in the horizontal direction, such that \u03b3is (\u215b+\u215b+(\u215c)+(\u215c))\/(\u215b+\u215b+(\u215c)+(\u215c)) for any c. Therefore, in both illustrations, \u03b3is 1 for any color c. Additionally, D=0 for any color c. As a result, C achieves its highest possible value of 1. An extension to general scaling factors (1\/N)\u00d7 in both directions for any integer N which achieves the maximum value of C=1 is straightforward, as is an extension to scaling by (1\/M)\u00d7 in the vertical direction and (1\/N)\u00d7 in the horizontal direction for any integers M and N.","[Optimized Bayer-Consistent Scaling]","Pure BCRS can potentially produce some false colors in the high frequency areas of the output images, which can be observed from processing images of resolution charts. This is due to the maintenance of very high resolution in the scaled output images. To make further improvements, the filter coefficients may be optimized. The optimization procedure for each color c involves allowing some coefficients outside of the c sub-tile to take on a non-zero value which is substantially smaller than the coefficient values inside the c sub-tile, and in the process evaluating the resulting Bayer consistency coefficient C and false coloring in the output image. While this optimization procedure implies that condition (2) described above no longer holds in a strict sense, the overall Bayer consistency coefficient C is still evaluated in the optimization to ensure a high C value so that a majority of the weights of the filter remains inside the sub-tile of the same color.",{"@attributes":{"id":"p-0095","num":"0094"},"figref":["FIG. 12","FIG. 12"],"sub":["c","c"],"sup":["h","v "]},{"@attributes":{"id":"p-0096","num":"0095"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mstyle":{"mspace":{"@attributes":{"width":"4.4em","height":"4.4ex"}}},"mo":"\u2062","mrow":{"mi":"\u03b3","mo":"=","mrow":{"msub":{"mi":["\u03b3","c"]},"mo":"=","mrow":{"mfrac":{"mrow":[{"mn":"4","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["13","64"]}},"mn":"2"}},{"mrow":[{"mn":"4","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["13","64"]}},"mn":"2"}},{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["3","64"]}},"mn":"2"}},{"mn":"3","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["2","64"]}},"mn":"2"}}],"mo":["+","+"]}]},"mo":"=","mn":"0.9575"}}}}},{"mrow":{"mo":["(",")"],"mn":"10"}}]},{"mtd":[{"mrow":{"msubsup":{"mi":["d","c","h"]},"mo":"=","mrow":{"msubsup":{"mi":["d","c","v"]},"mo":"=","mrow":{"mfrac":{"mrow":{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mo":"-","mn":"1"}},{"mo":["(",")"],"mrow":{"mrow":{"mn":["2","13"],"mo":"\u00d7"},"mo":"+","mn":"3"}}],"mo":"\u2062"},{"mo":["(",")"],"mrow":{"mrow":{"mn":["2","13"],"mo":"\u00d7"},"mo":"+","mn":"2"}},{"mrow":[{"mo":["(",")"],"mn":"3"},{"mo":["(",")"],"mrow":{"mn":"3","mo":"+","mrow":{"mn":["2","2"],"mo":"\u00d7"}}}],"mo":"\u2062"}],"mo":["+","+"]},"mn":"64"},"mo":"=","mn":"0.3125"}}}},{"mrow":{"mo":["(",")"],"mn":"11"}}]}]}}}},"The above values hold for any color c, and therefore \u03b2=0.8527. Evaluating at \u03bc=0.5, these components lead to a Bayer consistency coefficient of 0.9051, which is both close to the maximum possible value of 1 and much higher than the corresponding values for pixel skipping (0.1258) and binning (0.4865) for a scaling factor (\u2153)\u00d7 in both directions.",{"@attributes":{"id":"p-0098","num":"0097"},"figref":["FIG. 13","FIG. 13"],"sub":["c","c"],"sup":["h","v "]},{"@attributes":{"id":"p-0099","num":"0098"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mi":"\u03b3","mo":"=","mrow":{"msub":{"mi":["\u03b3","c"]},"mo":"=","mrow":{"mfrac":{"mrow":[{"mrow":[{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["7","64"]}},"mn":"2"}},{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["18","64"]}},"mn":"2"}}],"mo":"+"},{"mrow":[{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["7","64"]}},"mn":"2"}},{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["18","64"]}},"mn":"2"}},{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["3","64"]}},"mn":"2"}},{"mn":"2","mo":"\u00d7","msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["2","64"]}},"mn":"2"}}],"mo":["+","+","+","+"],"msup":{"mrow":{"mo":["(",")"],"mfrac":{"mn":["4","64"]}},"mn":"2"}}]},"mo":"=","mn":"0.9467"}}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"10","mi":"\u2032"}}}]},{"mtd":[{"mrow":{"msubsup":{"mi":["d","c","v"]},"mo":"=","mrow":{"mfrac":{"mrow":{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mo":"-","mn":"1"}},{"mo":["(",")"],"mrow":{"mn":["7","18","3"],"mo":["+","+"]}}],"mo":"\u2062"},{"mo":["(",")"],"mrow":{"mn":["7","18","3"],"mo":["+","+"]}},{"mrow":[{"mo":["(",")"],"mn":"3"},{"mo":["(",")"],"mrow":{"mn":["2","4","2"],"mo":["+","+"]}}],"mo":"\u2062"}],"mo":["+","+"]},"mn":"64"},"mo":"=","mn":"0.375"}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"11","mi":"\u2032"}}}]},{"mtd":[{"mrow":{"msubsup":{"mi":["d","c","h"]},"mo":"=","mrow":{"mfrac":{"mrow":{"mrow":[{"mrow":[{"mo":["(",")"],"mrow":{"mo":"-","mn":"15"}},{"mo":["(",")"],"mrow":{"mn":["7","7","2"],"mo":["+","+"]}}],"mo":"\u2062"},{"mrow":[{"mo":["(",")"],"mn":"0.5"},{"mo":["(",")"],"mrow":{"mn":["18","18","4"],"mo":["+","+"]}}],"mo":"\u2062"},{"mrow":[{"mo":["(",")"],"mn":"2.5"},{"mo":["(",")"],"mrow":{"mn":["3","3","2"],"mo":["+","+"]}}],"mo":"\u2062"}],"mo":["+","+"]},"mn":"64"},"mo":"=","mn":"0.25"}}},{"mrow":{"mo":["(",")"],"msup":{"mn":"11","mi":"\u2033"}}}]}]}}}},"The above values hold for any color c, and therefore \u03b2=0.8602. Evaluating at \u03bc=0.5, these components lead to a Bayer consistency coefficient of 0.9035. It can be readily shown using a similar calculation that this Bayer consistency coefficient is much higher than corresponding values for the methods of pixel skipping and binning for the same horizontal and vertical scaling factors discussed above.",{"@attributes":{"id":"p-0101","num":"0100"},"figref":["FIGS. 14A-C","FIG. 14A","FIG. 10","FIG. 12"]},{"@attributes":{"id":"p-0102","num":"0101"},"figref":["FIGS. 14B and 14C","FIG. 12","FIGS. 14B and 14C","FIG. 13"],"b":["1","2"]},"BCRS is especially effective because the Bayer consistency conditions require that the structural information (for example, edges) of the captured images be localized and kept at the correct locations in the scaled image. This is illustrated by  for scaling by (\u2153)\u00d7 in both directions, and by  for scaling by (\u2153)\u00d7 in the vertical direction and (\u00bc)\u00d7 in the horizontal direction. Specifically,  respectively show an edge  or  in the scene appearing in the lower right portion of the pixel area. If an image including edge  or  were to be scaled down by the binning method, the effect of the edge would affect all four output pixels because pixels within the edge area are used in calculating the output raw pixels of all colors. In this case the output R, G, and G pixels, even though located outside of the area containing edge  or , are affected by the presence of edge  or . This means that the edge  or  is spread out into the entire 2\u00d72 output area, which corresponds to the entire 6\u00d76 or 6\u00d78 input area. On the other hand, by using BCRS (for example, using the filters of , respectively), only the R pixels in the R sub-tile are used in the calculation of the output R pixel value. Therefore, the output R value is not affected by the presence of edge  or . Similarly, the output G and G values are not affected by edge  or . That is, because edge  or  is confined to the B sub-tile, only the output B value is affected by edge  or . In this manner, BCRS preserves the structure of the image more accurately and produces output images of high resolution and quality.","Although, in optimized BCRS (for example, using the filters of ), pixels outside of the c sub-tile are used in the calculation of the output c-colored pixel, the structural limitation is similarly preserved because the filter weights of the pixels outside of the same color sub-tile are comparatively low.","Optimized BCRS filters may also be used to scale at scaling factors other than (\u2153)\u00d7; for example, any (1\/N)\u00d7 for integer N. For example,  illustrates an exemplary optimized BCRS red filter coefficient array for scaling factor (\u00bd)\u00d7; whereas  illustrates an exemplary optimized BCRS red filter coefficient array for scaling factor (\u00bc)\u00d7. Using the above expressions at \u03bc=0.5, the BCRS filter arrays of  give a Bayer consistency coefficient C of 0.8279 and 0.8166, respectively. These are much higher than the Bayer consistency coefficients C for both pixel skipping and binning as described above.",{"@attributes":{"id":"p-0106","num":"0105"},"figref":["FIGS. 19 and 20","FIGS. 19 and 20"]},"[Conclusion]","With regard to the processes, systems, methods, heuristics, etc. described herein, it should be understood that, although the steps of such processes, etc. have been described as occurring according to a certain ordered sequence, such processes could be practiced with the described steps performed in an order other than the order described herein. It further should be understood that certain steps could be performed simultaneously, that other steps could be added, or that certain steps described herein could be omitted. In other words, the descriptions of processes herein are provided for the purpose of illustrating certain embodiments, and should in no way be construed so as to limit the claims.","Accordingly, it is to be understood that the above description is intended to be illustrative and not restrictive. Many embodiments and applications other than the examples provided would be apparent upon reading the above description. The scope should be determined, not with reference to the above description, but should instead be determined with reference to the appended claims, along with the full scope of equivalents to which such claims are entitled. It is anticipated and intended that future developments will occur in the technologies discussed herein, and that the disclosed systems and methods will be incorporated into such future embodiments. In sum, it should be understood that the application is capable of modification and variation.","All terms used in the claims are intended to be given their broadest reasonable constructions and their ordinary meanings as understood by those knowledgeable in the technologies described herein unless an explicit indication to the contrary in made herein. In particular, use of the singular articles such as \u201ca,\u201d \u201cthe,\u201d \u201csaid,\u201d etc. should be read to recite one or more of the indicated elements unless a claim recites an explicit limitation to the contrary.","The Abstract of the Disclosure is provided to allow the reader to quickly ascertain the nature of the technical disclosure. It is submitted with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. In addition, in the foregoing Detailed Description, it can be seen that various features are grouped together in various embodiments for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the claimed embodiments require more features than are expressly recited in each claim. Rather, as the following claims reflect, inventive subject matter lies in less than all features of a single disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description, with each claim standing on its own as a separately claimed subject matter."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"DESCRIPTION OF THE DRAWINGS","p":["These and other more detailed and specific features of various embodiments are more fully disclosed in the following description, reference being had to the accompanying drawings, in which:",{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIGS. 1A, 1B, and 1C"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIGS. 2A and 2B"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 11"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 12"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 13"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIGS. 14A, 14B, and 14C"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 15"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 16"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 17"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 18"},{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 19"},{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 20"}]},"DETDESC":[{},{}]}
