---
title: Method and apparatus for multi-sensory speech enhancement
abstract: A method and system use an alternative sensor signal received from a sensor other than an air conduction microphone to estimate a clean speech value. The estimation uses either the alternative sensor signal alone, or in conjunction with the air conduction microphone signal. The clean speech value is estimated without using a model trained from noisy training data collected from an air conduction microphone. Under one embodiment, correction vectors are added to a vector formed from the alternative sensor signal in order to form a filter, which is applied to the air conductive microphone signal to produce the clean speech estimate. In other embodiments, the pitch of a speech signal is determined from the alternative sensor signal and is used to decompose an air conduction microphone signal. The decomposed signal is then used to determine a clean signal estimate.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07447630&OS=07447630&RS=07447630
owner: Microsoft Corporation
number: 07447630
owner_city: Redmond
owner_country: US
publication_date: 20031126
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS","Training Stereo Correction Vectors","Noise Reduction using Correction Vector and Noise Estimate","Noise Reduction using Correction Vector without Noise Estimate","Noise Reduction Using Pitch Tracking"],"p":["The present invention relates to noise reduction. In particular, the present invention relates to removing noise from speech signals.","A common problem in speech recognition and speech transmission is the corruption of the speech signal by additive noise. In particular, corruption due to the speech of another speaker has proven to be difficult to detect and\/or correct.","One technique for removing noise attempts to model the noise using a set of noisy training signals collected under various conditions. These training signals are received before a test signal that is to be decoded or transmitted and are used for training purposes only. Although such systems attempt to build models that take noise into consideration, they are only effective if the noise conditions of the training signals match the noise conditions of the test signals. Because of the large number of possible noises and the seemingly infinite combinations of noises, it is very difficult to build noise models from training signals that can handle every test condition.","Another technique for removing noise is to estimate the noise in the test signal and then subtract it from the noisy speech signal. Typically, such systems estimate the noise from previous frames of the test signal. As such, if the noise is changing over time, the estimate of the noise for the current frame will be inaccurate.","One system of the prior art for estimating the noise in a speech signal uses the harmonics of human speech. The harmonics of human speech produce peaks in the frequency spectrum. By identifying nulls between these peaks, these systems identify the spectrum of the noise. This spectrum is then subtracted from the spectrum of the noisy speech signal to provide a clean speech signal.","The harmonics of speech have also been used in speech coding to reduce the amount of data that must be sent when encoding speech for transmission across a digital communication path. Such systems attempt to separate the speech signal into a harmonic component and a random component. Each component is then encoded separately for transmission. One system in particular used a harmonic+noise model in which a sum-of-sinusoids model is fit to the speech signal to perform the decomposition.","In speech coding, the decomposition is done to find a parameterization of the speech signal that accurately represents the input noisy speech signal. The decomposition has no noise-reduction capability.","Recently, a system has been developed that attempts to remove noise by using a combination of an alternative sensor, such as a bone conduction microphone, and an air conduction microphone. This system is trained using three training channels: a noisy alternative sensor training signal, a noisy air conduction microphone training signal, and a clean air conduction microphone training signal. Each of the signals is converted into a feature domain. The features for the noisy alternative sensor signal and the noisy air conduction microphone signal are combined into a single vector representing a noisy signal. The features for the clean air conduction microphone signal form a single clean vector. These vectors are then used to train a mapping between the noisy vectors and the clean vectors. Once trained, the mappings are applied to a noisy vector formed from a combination of a noisy alternative sensor test signal and a noisy air conduction microphone test signal. This mapping produces a clean signal vector.","This system is less than optimum when the noise conditions of the test signals do not match the noise conditions of the training signals because the mappings are designed for the noise conditions of the training signals.","A method and system use an alternative sensor signal received from a sensor other than an air conduction microphone to estimate a clean speech value. The clean speech value is estimated without using a model trained from noisy training data collected from an air conduction microphone. Under one embodiment, correction vectors are added to a vector formed from the alternative sensor signal in order to form a filter, which is applied to the air conductive microphone signal to produce the clean speech estimate. In other embodiments, the pitch of a speech signal is determined from the alternative sensor signal and is used to decompose an air conduction microphone signal. The decomposed signal is then used to identify a clean signal estimate.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well-known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, telephony systems, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. The invention is designed to be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules are located in both local and remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general-purpose computing device in the form of a computer . Components of computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","Computer  typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer  and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into the computer  through input devices such as a keyboard , a microphone , and a pointing device , such as a mouse, trackball or touch pad. Other input devices (not shown) may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . In addition to the monitor, computers may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface .","The computer  is operated in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a hand-held device, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.",{"@attributes":{"id":"p-0034","num":"0033"},"figref":"FIG. 2","b":["200","200","202","204","206","208","210"]},"Memory  is implemented as non-volatile electronic memory such as random access memory (RAM) with a battery back-up module (not shown) such that information stored in memory  is not lost when the general power to mobile device  is shut down. A portion of memory  is preferably allocated as addressable memory for program execution, while another portion of memory  is preferably used for storage, such as to simulate storage on a disk drive.","Memory  includes an operating system , application programs  as well as an object store . During operation, operating system  is preferably executed by processor  from memory . Operating system , in one preferred embodiment, is a WINDOWS\u00ae CE brand operating system commercially available from Microsoft Corporation. Operating system  is preferably designed for mobile devices, and implements database features that can be utilized by applications  through a set of exposed application programming interfaces and methods. The objects in object store  are maintained by applications  and operating system , at least partially in response to calls to the exposed application programming interfaces and methods.","Communication interface  represents numerous devices and technologies that allow mobile device  to send and receive information. The devices include wired and wireless modems, satellite receivers and broadcast tuners to name a few. Mobile device  can also be directly connected to a computer to exchange data therewith. In such cases, communication interface  can be an infrared transceiver or a serial or parallel communication connection, all of which are capable of transmitting streaming information.","Input\/output components  include a variety of input devices such as a touch-sensitive screen, buttons, rollers, and a microphone as well as a variety of output devices including an audio generator, a vibrating device, and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition, other input\/output devices may be attached to or found with mobile device  within the scope of the present invention.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":["FIG. 3","FIG. 3"],"b":["300","302","304","306","304"]},"Air conduction microphone  also receives noise  generated by one or more noise sources . Depending on the type of alternative sensor and the level of the noise, noise  may also be detected by alternative sensor . However, under embodiments of the present invention, alternative sensor  is typically less sensitive to ambient noise than air conduction microphone . Thus, the alternative sensor signal  generated by alternative sensor  generally includes less noise than air conduction microphone signal  generated by air conduction microphone .","Alternative sensor signal  and air conduction microphone signal  are provided to a clean signal estimator , which estimates a clean signal . Clean signal estimate  is provided to a speech process . Clean signal estimate  may either be a filtered time-domain signal or a feature domain vector. If clean signal estimate  is a time-domain signal, speech process  may take the form of a listener, a speech coding system, or a speech recognition system. If clean signal estimate  is a feature domain vector, speech process  will typically be a speech recognition system.","The present invention provides several methods and systems for estimating clean speech using air conduction microphone signal  and alternative sensor signal . One system uses stereo training data to train correction vectors for the alternative sensor signal. When these correction vectors are later added to a test alternative sensor vector, they provide an estimate of a clean signal vector. One further extension of this system is to first track time-varying distortion and then to incorporate this information into the computation of the correction vectors and into the estimation of clean speech.","A second system provides an interpolation between the clean signal estimate generated by the correction vectors and an estimate formed by subtracting an estimate of the current noise in the air conduction test signal from the air conduction signal. A third system uses the alternative sensor signal to estimate the pitch of the speech signal and then uses the estimated pitch to identify an estimate for the clean signal. Each of these systems is discussed separately below.",{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIGS. 4 and 5"},"The method of identifying correction vectors begins in step  of , where a \u201cclean\u201d air conduction microphone signal is converted into a sequence of feature vectors. To do this, a speaker  of , speaks into an air conduction microphone , which converts the audio waves into electrical signals. The electrical signals are then sampled by an analog-to-digital converter  to generate a sequence of digital values, which are grouped into frames of values by a frame constructor . In one embodiment, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second and frame constructor  creates a new frame every 10 milliseconds that includes 25 milliseconds worth of data.","Each frame of data provided by frame constructor  is converted into a feature vector by a feature extractor . Under one embodiment, feature extractor  forms cepstral features. Examples of such features include LPC derived cepstrum, and Mel-Frequency Cepstrum Coefficients. Examples of other possible feature extraction modules that may be used with the present invention include modules for performing Linear Predictive Coding (LPC), Perceptive Linear Prediction (PLP), and Auditory model feature extraction. Note that the invention is not limited to these feature extraction modules and that other modules may be used within the context of the present invention.","In step  of , an alternative sensor signal is converted into feature vectors. Although the conversion of step  is shown as occurring after the conversion of step , any part of the conversion may be performed before, during or after step  under the present invention. The conversion of step  is performed through a process similar to that described above for step .","In the embodiment of , this process begins when alternative sensor  detects a physical event associated with the production of speech by speaker  such as bone vibration or facial movement. As shown in , in one embodiment of a bone conduction sensor , a soft elastomer bridge  is adhered to the diaphragm  of a normal air conduction microphone . This soft bridge  conducts vibrations from skin contact  of the user directly to the diaphragm  of microphone . The movement of diaphragm  is converted into an electrical signal by a transducer  in microphone . Alternative sensor  converts the physical event into analog electrical signal, which is sampled by an analog-to-digital converter . The sampling characteristics for A\/D converter  are the same as those described above for A\/D converter . The samples provided by A\/D converter  are collected into frames by a frame constructor , which acts in a manner similar to frame constructor . These frames of samples are then converted into feature vectors by a feature extractor , which uses the same feature extraction method as feature extractor .","The feature vectors for the alternative sensor signal and the air conductive signal are provided to a noise reduction trainer  in . At step  of , noise reduction trainer  groups the feature vectors for the alternative sensor signal into mixture components. This grouping can be done by grouping similar feature vectors together using a maximum likelihood training technique or by grouping feature vectors that represent a temporal section of the speech signal together. Those skilled in the art will recognize that other techniques for grouping the feature vectors may be used and that the two techniques listed above are only provided as examples.","Noise reduction trainer  then determines a correction vector, r, for each mixture component, s, at step  of . Under one embodiment, the correction vector for each mixture component is determined using maximum likelihood criterion. Under this technique, the correction vector is calculated as:",{"@attributes":{"id":"p-0051","num":"0050"},"maths":{"@attributes":{"id":"MATH-US-00001","num":"00001"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["r","s"]},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":"\u2758","msub":{"mi":["b","t"]}}}},{"mo":["(",")"],"mrow":{"msub":[{"mi":["x","t"]},{"mi":["b","t"]}],"mo":"-"}}],"mo":"\u2062"}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":"\u2758","msub":{"mi":["b","t"]}}}}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"1"}}]}}}}},"Where xis the value of the air conduction vector for frame t and bis the value of the alternative sensor vector for frame t. In Equation 1:",{"@attributes":{"id":"p-0053","num":"0052"},"maths":{"@attributes":{"id":"MATH-US-00002","num":"00002"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":"\u2758","msub":{"mi":["b","t"]}}}},"mo":"=","mfrac":{"mrow":[{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["b","t"]},"mo":"\u2758","mi":"s"}}},{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"s"}}],"mo":"\u2062"},{"munder":{"mo":"\u2211","mi":"s"},"mo":"\u2062","mrow":{"mrow":[{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"msub":{"mi":["b","t"]},"mo":"\u2758","mi":"s"}}},{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"s"}}],"mo":"\u2062"}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"2"}}]}}}},"br":[{},{},{}],"sub":["t","t","t","b","b","b ","b "],"in-line-formulae":[{},{}],"i":["p","b","|s","N","b"]},{"@attributes":{"id":"p-0054","num":"0053"},"maths":{"@attributes":{"id":"MATH-US-00003","num":"00003"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":[{"mtd":[{"mrow":{"mrow":[{"msub":{"mi":["\u03b3","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":"s","mo":"\u2758","msub":{"mi":["b","t"]}}}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"4"}}]},{"mtd":[{"mrow":{"msub":{"mi":["\u03bc","s"]},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"mrow":{"msub":{"mi":["\u03b3","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},"mo":"\u2062","msub":{"mi":["b","t"]}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"msub":{"mi":["\u03b3","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"5"}}]},{"mtd":[{"mrow":{"msub":{"mi":["\u0393","s"]},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"mrow":[{"msub":{"mi":["\u03b3","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}},{"mo":["(",")"],"mrow":{"msub":[{"mi":["b","t"]},{"mi":["\u03bc","s"]}],"mo":"-"}}],"mo":["\u2062","\u2062"],"msup":{"mrow":{"mo":["(",")"],"mrow":{"msub":[{"mi":["b","t"]},{"mi":["\u03bc","s"]}],"mo":"-"}},"mi":"T"}}},{"munder":{"mo":"\u2211","mi":"t"},"mo":"\u2062","mrow":{"msub":{"mi":["\u03b3","s"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"t"}}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"6"}}]}]}}},"br":{}},"The E- and M-steps of the algorithm iterate until stable values for the model parameters are determined. These parameters are then used to evaluate equation 1 to form the correction vectors. The correction vectors and the model parameters are then stored in a noise reduction parameter storage .","After a correction vector has been determined for each mixture component at step , the process of training the noise reduction system of the present invention is complete. Once a correction vector has been determined for each mixture, the vectors may be used in a noise reduction technique of the present invention. Two separate noise reduction techniques that use the correction vectors are discussed below.","A system and method that reduces noise in a noisy speech signal based on correction vectors and a noise estimate is shown in the block diagram of  and the flow diagram of , respectively.","At step , an audio test signal detected by an air conduction microphone  is converted into feature vectors. The audio test signal received by microphone  includes speech from a speaker  and additive noise from one or more noise sources . The audio test signal detected by microphone  is converted into an electrical signal that is provided to analog-to-digital converter .","A-to-D converter  converts the analog signal from microphone  into a series of digital values. In several embodiments, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second. These digital values are provided to a frame constructor , which, in one embodiment, groups the values into 25 millisecond frames that start 10 milliseconds apart.","The frames of data created by frame constructor  are provided to feature extractor , which extracts a feature from each frame. Under one embodiment, this feature extractor is different from feature extractors  and  that were used to train the correction vectors. In particular, under this embodiment, feature extractor  produces power spectrum values instead of cepstral values. The extracted features are provided to a clean signal estimator , a speech detection unit  and a noise model trainer .","At step , a physical event, such as bone vibration or facial movement, associated with the production of speech by speaker  is converted into a feature vector. Although shown as a separate step in , those skilled in the art will recognize that portions of this step may be done at the same time as step . During step , the physical event is detected by alternative sensor . Alternative sensor  generates an analog electrical signal based on the physical events. This analog signal is converted into a digital signal by analog-to-digital converter  and the resulting digital samples are grouped into frames by frame constructor . Under one embodiment, analog-to-digital converter  and frame constructor  operate in a manner similar to analog-to-digital converter  and frame constructor .","The frames of digital values are provided to a feature extractor , which uses the same feature extraction technique that was used to train the correction vectors. As mentioned above, examples of such feature extraction modules include modules for performing Linear Predictive Coding (LPC), LPC derived cepstrum, Perceptive Linear Prediction (PLP), Auditory model feature extraction, and Mel-Frequency Cepstrum Coefficients (MFCC) feature extraction. In many embodiments, however, feature extraction techniques that produce cepstral features are used.","The feature extraction module produces a stream of feature vectors that are each associated with a separate frame of the speech signal. This stream of feature vectors is provided to clean signal estimator .","The frames of values from frame constructor  are also provided to a feature extractor , which in one embodiment extracts the energy of each frame. The energy value for each frame is provided to a speech detection unit .","At step , speech detection unit  uses the energy feature of the alternative sensor signal to determine when speech is likely present. This information is passed to noise model trainer , which attempts to model the noise during periods when there is no speech at step .","Under one embodiment, speech detection unit  first searches the sequence of frame energy values to find a peak in the energy. It then searches for a valley after the peak. The energy of this valley is referred to as an energy separator, d. To determine if a frame contains speech, the ratio, k, of the energy of the frame, e, over the energy separator, d, is then determined as: k=e\/d. A speech confidence, q, for the frame is then determined as:",{"@attributes":{"id":"p-0067","num":"0066"},"maths":{"@attributes":{"id":"MATH-US-00004","num":"00004"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"q","mo":"=","mrow":{"mo":"{","mtable":{"mtr":[{"mtd":[{"mn":"0"},{"mo":":"},{"mrow":{"mi":"k","mo":"<","mn":"1"}}]},{"mtd":[{"mfrac":{"mrow":[{"mi":"k","mo":"-","mn":"1"},{"mi":"\u03b1","mo":"-","mn":"1"}]}},{"mo":":"},{"mrow":{"mn":"1","mo":["\u2264","\u2264"],"mi":["k","\u03b1"]}}]},{"mtd":[{"mn":"1"},{"mo":":"},{"mrow":{"mi":["k","\u03b1"],"mo":">"}}]}]}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"7"}}]}}}},"br":{}},"Under one embodiment, a fixed threshold value is used to determine if speech is present such that if the confidence value exceeds the threshold, the frame is considered to contain speech and if the confidence value does not exceed the threshold, the frame is considered to contain non-speech. Under one embodiment, a threshold value of 0.1 is used.","For each non-speech frame detected by speech detection unit , noise model trainer  updates a noise model  at step . Under one embodiment, noise model  is a Gaussian model that has a mean \u03bcand a variance \u03a3. This model is based on a moving window of the most recent frames of non-speech. Techniques for determining the mean and variance from the non-speech frames in the window are well known in the art.","Correction vectors and model parameters in parameter storage  and noise model  are provided to clean signal estimator  with the feature vectors, b, for the alternative sensor and the feature vectors, S, for the noisy air conduction microphone signal. At step , clean signal estimator  estimates an initial value for the clean speech signal based on the alternative sensor feature vector, the correction vectors, and the model parameters for the alternative sensor. In particular, the alternative sensor estimate of the clean signal is calculated as:",{"@attributes":{"id":"p-0071","num":"0070"},"maths":{"@attributes":{"id":"MATH-US-00005","num":"00005"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mover":{"mi":"x","mo":"^"},"mo":"=","mrow":{"mi":"b","mo":"+","mrow":{"munder":{"mo":"\u2211","mi":"s"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"mrow":{"mi":"p","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["s","b"],"mo":"|"}}},"mo":"\u2062","msub":{"mi":["r","s"]}}}}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"8"}}]}}}},"br":{},"sub":"s "},"At step , the initial alternative sensor clean speech estimate is refined by combining it with a clean speech estimate that is formed from the noisy air conduction microphone vector and the noise model. This results in a refined clean speech estimate . In order to combine the cepstral value of the initial clean signal estimate with the power spectrum feature vector of the noisy air conduction microphone, the cepstral value is converted to the power spectrum domain using:\n\n\u2003\u2003EQ. 9\n\nwhere C is an inverse discrete cosine transform and \u015cis the power spectrum estimate of the clean signal based on the alternative sensor.\n","Once the initial clean signal estimate from the alternative sensor has been placed in the power spectrum domain, it can be combined with the noisy air conduction microphone vector and the noise model as:\n\n=(\u03a3+\u03a3)[\u03a3(\u2212\u03bc)+\u03a3]\u2003\u2003EQ. 10\n\nwhere \u015cis the refined clean signal estimate in the power spectrum domain, Sis the noisy air conduction microphone feature vector, (\u03bc,\u03a3) are the mean and covariance of the prior noise model (see ), \u015cis the initial clean signal estimate based on the alternative sensor, and \u03a3is the covariance matrix of the conditional probability distribution for the clean speech given the alternative sensor's measurement. \u03a3can be computed as follows. Let J denote the Jacobian of the function on the right hand side of equation 9. Let \u03a3 be the covariance matrix of {circumflex over (x)}. Then the covariance of \u015cis\n\n\u03a3\u2003\u2003EQ. 11\n","In a simplified embodiment, we rewrite EQ. 10 as the following equation:\n\n=\u03b1()(\u2212\u03bc)+(1\u2212\u03b1())\u2003\u2003EQ. 12\n\nwhere \u03b1(f) is a function of both the time and the frequency band. Since the alternative sensor that we are currently using has the bandwidth up to 3 KHz, we choose \u03b1(f) to be 0 for the frequency band below 3 KHz. Basically, we trust the initial clean signal estimate from the alternative sensor for low frequency bands. For high frequency bands, the initial clean signal estimate from the alterative sensor is not so reliable. Intuitively, when the noise is small for a frequency band at the current frame, we would like to choose a large \u03b1(f) so that we use more information from the air conduction microphone for this frequency band. Otherwise, we would like to use more information from the alternative sensor by choosing a small \u03b1(f). In one embodiment, we use the energy of the initial clean signal estimate from the alternative sensor to determine the noise level for each frequency band. Let E(f) denote the energy for frequency band f. Let M=MaxE(f). \u03b1(f), as a function of f, is defined as follows:\n",{"@attributes":{"id":"p-0075","num":"0074"},"maths":{"@attributes":{"id":"MATH-US-00006","num":"00006"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mrow":[{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}},{"mo":"{","mtable":{"mtr":[{"mtd":[{"mfrac":{"mrow":{"mi":"E","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"f"}},"mi":"M"}},{"mo":":"},{"mrow":{"mi":"f","mo":"\u2265","mrow":{"mn":"4","mo":"\u2062","mi":"K"}}}]},{"mtd":[{"mrow":{"mfrac":{"mrow":[{"mi":"f","mo":"-","mrow":{"mn":"3","mo":"\u2062","mi":"K"}},{"mn":"1","mo":"\u2062","mi":"K"}]},"mo":"\u2062","mrow":{"mi":"\u03b1","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mn":"4","mo":"\u2062","mi":"K"}}}}},{"mo":":"},{"mrow":{"mrow":[{"mn":"3","mo":"\u2062","mi":"K"},{"mn":"4","mo":"\u2062","mi":"K"}],"mo":["<","<"],"mi":"f"}}]},{"mtd":[{"mn":"0"},{"mo":":"},{"mrow":{"mi":"f","mo":"\u2264","mrow":{"mn":"3","mo":"\u2062","mi":"K"}}}]}]}}],"mo":"="}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"13"}}]}}}},"br":{}},"The refined clean signal estimate in the power spectrum domain may be used to construct a Wiener filter to filter the noisy air conduction microphone signal. In particular, the Wiener filter, H, is set such that:",{"@attributes":{"id":"p-0077","num":"0076"},"maths":{"@attributes":{"id":"MATH-US-00007","num":"00007"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"H","mo":"=","mfrac":{"msub":[{"mover":{"mi":"S","mo":"^"},"mi":"x"},{"mi":["S","y"]}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"14"}}]}}}}},"This filter can then be applied against the time domain noisy air conduction microphone signal to produce a noise-reduced or clean time-domain signal. The noise-reduced signal can be provided to a listener or applied to a speech recognizer.","Note that Equation 12 provides a refined clean signal estimate that is the weighted sum of two factors, one of which is a clean signal estimate from an alternative sensor. This weighted sum can be extended to include additional factors for additional alternative sensors. Thus, more than one alternate sensor may be used to generate independent estimates of the clean signal. These multiple estimates can then be combined using equation 12.",{"@attributes":{"id":"p-0080","num":"0079"},"figref":["FIG. 8","FIG. 8","FIG. 6"]},"In , a physical event associated with a speaker  producing speech is converted into a feature vector by alternative sensor , analog-to-digital converter , frame constructor  and feature extractor , in a manner similar to that discussed above for alternative sensor , analog-to-digital converter , frame constructor  and feature extractor  of . The feature vectors from feature extractor  and the noise reduction parameters  are provided to a clean signal estimator , which determines an estimate of a clean signal value , \u015c, using equations 8 and 9 above.","The clean signal estimate, \u015c, in the power spectrum domain may be used to construct a Wiener filter to filter a noisy air conduction microphone signal. In particular, the Wiener filter, H, is set such that:",{"@attributes":{"id":"p-0083","num":"0082"},"maths":{"@attributes":{"id":"MATH-US-00008","num":"00008"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"mi":"H","mo":"=","mfrac":{"msub":[{"mover":{"mi":"S","mo":"^"},"mrow":{"mi":["x","b"],"mo":"\u2758"}},{"mi":["S","y"]}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"15"}}]}}}}},"This filter can then be applied against the time domain noisy air conduction microphone signal to produce a noise-reduced or clean signal. The noise-reduced signal can be provided to a listener or applied to a speech recognizer.","Alternatively, the clean signal estimate in the cepstral domain, {circumflex over (x)}, which is calculated in Equation 8, may be applied directly to a speech recognition system.","An alternative technique for generating estimates of a clean speech signal is shown in the block diagram of  and the flow diagram of . In particular, the embodiment of  determine a clean speech estimate by identifying a pitch for the speech signal using an alternative sensor and then using the pitch to decompose a noisy air conduction microphone signal into a harmonic component and a random component. Thus, the noisy signal is represented as:\n\n\u2003\u2003EQ. 16\n\nwhere y is the noisy signal, yis the harmonic component, and yis the random component. A weighted sum of the harmonic component and the random component are used to form a noise-reduced feature vector representing a noise-reduced speech signal.\n","Under one embodiment, the harmonic component is modeled as a sum of harmonically-related sinusoids such that:",{"@attributes":{"id":"p-0088","num":"0087"},"maths":{"@attributes":{"id":"MATH-US-00009","num":"00009"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["y","h"]},"mo":"=","mrow":{"mrow":[{"munderover":{"mo":"\u2211","mrow":{"mi":"k","mo":"=","mn":"1"},"mi":"K"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"mrow":{"msub":{"mi":["a","k"]},"mo":"\u2062","mrow":{"mi":"cos","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["k","t"],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":"\u03c9","mn":"0"}}}}}},{"msub":{"mi":["b","k"]},"mo":"\u2062","mrow":{"mi":"sin","mo":"\u2061","mrow":{"mo":["(",")"],"mrow":{"mi":["k","t"],"mo":["\u2062","\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msub":{"mi":"\u03c9","mn":"0"}}}}}],"mo":"+"}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"17"}}]}}}},"br":{},"sub":"0 "},"Thus, to identify the harmonic component, an estimate of the pitch frequency and the amplitude parameters {aa. . . abb. . . b} must be determined.","At step , a noisy speech signal is collected and converted into digital samples. To do this, an air conduction microphone  converts audio waves from a speaker  and one or more additive noise sources  into electrical signals. The electrical signals are then sampled by an analog-to-digital converter  to generate a sequence of digital values. In one embodiment, A-to-D converter  samples the analog signal at 16 kHz and 16 bits per sample, thereby creating 32 kilobytes of speech data per second. At step , the digital samples are grouped into frames by a frame constructor . Under one embodiment, frame constructor  creates a new frame every 10 milliseconds that includes 25 milliseconds worth of data.","At step , a physical event associated with the production of speech is detected by alternative sensor . In this embodiment, an alternative sensor that is able to detect harmonic components, such as a bone conduction sensor, is best suited to be used as alternative sensor . Note that although step  is shown as being separate from step , those skilled in the art will recognize that these steps may be performed at the same time. The analog signal generated by alternative sensor  is converted into digital samples by an analog-to-digital converter . The digital samples are then grouped into frames by a frame constructer  at step .","At step , the frames of the alternative sensor signal are used by a pitch tracker  to identify the pitch or fundamental frequency of the speech.","An estimate for the pitch frequency can be determined using any number of available pitch tracking systems. Under many of these systems, candidate pitches are used to identify possible spacing between the centers of segments of the alternative sensor signal. For each candidate pitch, a correlation is determined between successive segments of speech. In general, the candidate pitch that provides the best correlation will be the pitch frequency of the frame. In some systems, additional information is used to refine the pitch selection such as the energy of the signal and\/or an expected pitch track.","Given an estimate of the pitch from pitch tracker , the air conduction signal vector can be decomposed into a harmonic component and a random component at step . To do so, equation 17 is rewritten as:\n\n\u2003\u2003EQ. 18\n\nwhere y is a vector of N samples of the noisy speech signal, A is an N\u00d72K matrix given by:\n\n]\u2003\u2003EQ. 19\n\nwith elements\n\n()=cos() ()=sin()\u2003\u2003EQ. 20\n\nand b is a 2K\u00d71 vector given by:\n\n]\u2003\u2003EQ. 21\n\nThen, the least-squares solution for the amplitude coefficients is:\n\n()\u2003\u2003EQ. 22\n\nUsing {circumflex over (b)}, an estimate for the harmonic component of the noisy speech signal can be determined as:\n\n\u2003\u2003EQ. 23\n","An estimate of the random component is then calculated as:\n\n\u2003\u2003EQ. 24\n","Thus, using equations 18-24 above, harmonic decompose unit  is able to produce a vector of harmonic component samples , y, and a vector of random component samples , y.","After the samples of the frame have been decomposed into harmonic and random samples, a scaling parameter or weight is determined for the harmonic component at step . This scaling parameter is used as part of a calculation of a noise-reduced speech signal as discussed further below. Under one embodiment, the scaling parameter is calculated as:",{"@attributes":{"id":"p-0098","num":"0097"},"maths":{"@attributes":{"id":"MATH-US-00010","num":"00010"},"math":{"@attributes":{"overflow":"scroll"},"mtable":{"mtr":{"mtd":[{"mrow":{"msub":{"mi":["\u03b1","h"]},"mo":"=","mfrac":{"mrow":[{"munder":{"mo":"\u2211","mi":"i"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":{"msub":{"mi":["y","h"]},"mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},"mn":"2"}},{"munder":{"mo":"\u2211","mi":"i"},"mo":["\u2062","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"0.3em","height":"0.3ex"}}},"msup":{"mrow":{"mi":"y","mo":"\u2061","mrow":{"mo":["(",")"],"mi":"i"}},"mn":"2"}}]}}},{"mrow":{"mi":"EQ","mo":[".","\u2062"],"mstyle":{"mspace":{"@attributes":{"width":"1.1em","height":"1.1ex"}}},"mn":"25"}}]}}}},"br":{},"sub":["h ","h","h "]},"In alternative embodiments, the scaling parameter is set using a probabilistic voiced-unvoiced detection unit. Such units provide the probability that a particular frame of speech is voiced, meaning that the vocal cords resonate during the frame, rather than unvoiced. The probability that the frame is from a voiced region of speech can be used directly as the scaling parameter.","After the scaling parameter has been determined or while it is being determined, the Mel spectra for the vector of harmonic component samples and the vector of random component samples are determined at step . This involves passing each vector of samples through a Discrete Fourier Transform (DFT)  to produce a vector of harmonic component frequency values  and a vector of random component frequency values . The power spectra represented by the vectors of frequency values are then smoothed by a Mel weighting unit  using a series of triangular weighting functions applied along the Mel scale. This results in a harmonic component Mel spectral vector , Y, and a random component Mel spectral vector , Y.","At step , the Mel spectra for the harmonic component and the random component are combined as a weighted sum to form an estimate of a noise-reduced Mel spectrum. This step is performed by weighted sum calculator  using the scaling factor determined above in the following equation:\n\n()=\u03b1()()+\u03b1()\u2003\u2003EQ. 26\n\nwhere {circumflex over (X)}(t) is the estimate of the noise-reduced Mel spectrum, Y(t) is the harmonic component Mel spectrum, Y(t) is the random component Mel spectrum, \u03b1(t) is the scaling factor determined above, \u03b1is a fixed scaling factor for the random component that in one embodiment is set equal to 0.1, and the time index t is used to emphasize that the scaling factor for the harmonic component is determined for each frame while the scaling factor for the random component remains fixed. Note that in other embodiments, the scaling factor for the random component may be determined for each frame.\n","After the noise-reduced Mel spectrum has been calculated at step , the log  of the Mel spectrum is determined and then is applied to a Discrete Cosine Transform  at step . This produces a Mel Frequency Cepstral Coefficient (MFCC) feature vector  that represents a noise-reduced speech signal.","A separate noise-reduced MFCC feature vector is produced for each frame of the noisy signal. These feature vectors may be used for any desired purpose including speech enhancement and speech recognition. For speech enhancement, the MFCC feature vectors can be converted into the power spectrum domain and can be used with the noisy air conduction signal to form a Weiner filter.","Although the present invention has been described with reference to particular embodiments, workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0012","num":"0011"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":["FIG. 5","FIG. 4"]},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":["FIG. 7","FIG. 6"]},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":["FIG. 10","FIG. 9"]},{"@attributes":{"id":"p-0022","num":"0021"},"figref":"FIG. 11"}]},"DETDESC":[{},{}]}
