---
title: Bandwidth sharing in advanced streaming format
abstract: Modulated data signal having data fields encoded in a data structure defining a bandwidth sharing object for transmission over communications channels. A first data field contains a first stream of first information having a first bandwidth. A second data field contains a second stream of second information having a second bandwidth. The first stream is transmitted simultaneously with the second stream. One or more additional data fields each contain an additional stream of information having an additional bandwidth. The additional streams are transmitted simultaneously with the first and second stream. A bandwidth number indicated in the object is a function of the bandwidth of the first stream, the second stream, and the one or more additional streams. A bandwidth value indicated in the object is less than the total of the first bandwidth, the second bandwidth, and the total bandwidths of the one or more additional streams.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07457312&OS=07457312&RS=07457312
owner: Microsoft Corporation
number: 07457312
owner_city: Redmond
owner_country: US
publication_date: 20020619
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION","Bandwidth-Sharing Quantities","Appendix A"],"p":["The present invention relates to the field of multimedia streaming. In particular, this invention relates to a system and method for determining allocations of bandwidth to streamable content comprising multiple streams of varying bandwidth.","An advanced streaming format (ASF) file (also referred to as an active stream format file or advanced system format) contains one or more multimedia streams, as disclosed in U.S. Pat. No. 6,041,345. A multimedia stream contains the data for one particular part of the overall ASF file. For instance, a typical ASF file might contain two multimedia streams, one containing the audio data for the file, and the other containing the video data for the file. Playback of an ASF file (either over a network or via the local hard drive) is done by playing the data from one or more of the multimedia streams. It is valid behavior (and desired practice in many cases) to only play a subset of the multimedia streams in the overall ASF file. Each stream has its own maximum bit rate and maximum buffer window which together describe the amount of network resources required in order to send that multimedia stream from a server over the network such that it can be played in real-time by a client. Since each multimedia stream's network resource requirements are independent of those for other streams, the bit rate and buffer numbers for each stream numbers in an ASF file are in general summed to determine the requirements for sending the ASF file including all its streams, simultaneously, a particular subset of the multimedia streams available in an ASF file.","One problem posed by this method of calculating network resource requirements is that it can be an overestimate because the total requirements needed are not always additive across streams. Bitrate and the fullness of the buffer window can vary with time for a particular stream. An example of this variation might be a non-audio, non-video stream whose bandwidth utilization is bursty. Overestimating the network resource requirements of a subset of multimedia streams in an ASF file is suboptimal; it will cause the server to select a suboptimal subset of multimedia streams, or even refuse to stream any multimedia streams at all even though in fact the resources may be sufficient.","Some streaming media formats cannot carry streams other than audio or video streams. Thus, it appears that these formats handle non-audio, non-video data in files separate from the main file and presumably stream such extra data separately. Streaming media formats with this limitation make it difficult or impossible to coordinate the total bandwidth consumption of multiple multimedia streams, causing suboptimal or incorrect behavior in limited network resource conditions. In addition, it sometimes enhances the presentation to have file transfer streams, text\/caption streams, or script command streams which do at times exhibit the bursty behavior mentioned above. The ASF addresses this by having file transfer streams, text\/caption streams, script command streams, and all other multimedia streams stored as part of the ASF file along with traditional audio and video multimedia streams.","For these reasons, a system and method for designating bandwidth sharing among streams is desired to address one or more of these and other disadvantages.","The invention includes software data structures, and file format specifications for bandwidth sharing. In particular, an embodiment of the invention allows the content author to specify any known relationships between two or more streams in an ASF streaming file format that limit their total declared resource usage to allow for greater accuracy in determining the bandwidth and buffer size to allocate when streaming the content.","The invention for sharing bandwidth enhances ASF and other streaming formats by eliminating one of the major drawbacks of such formats. Namely, by adding streams that each claim network resource requirements, the total network resource requirements declared for a subset of multimedia streams may rise to an unnecessarily high level that cannot be accommodated in more constrained network scenarios. Bandwidth sharing allows the content author to take full advantage of the extensibility of ASF by providing a way to specify the combined network resource requirements for all the streams various subsets of multimedia streams.","In accordance with one aspect of the invention, a modulated data signal has data fields encoded thereon which define a bandwidth of the modulated data signal. The signal is transmitted over a communications channel. The signal comprises at least three data fields. A first data field contains descriptive information of a first stream having a first bandwidth. A second data field contains descriptive information of a second stream having a second bandwidth. The first bandwidth is greater than or equal to the second bandwidth and at least at certain times the first stream is transmitted simultaneously with the second stream. A third data field includes an object having a bandwidth value indicating a designated bandwidth for simultaneously streaming the first and second streams","In accordance with another aspect of the invention, a modulated data signal has data fields encoded thereon transmitted over a communications channel having an assigned bandwidth. The modulated data signal comprises a combined stream including a first stream having a first bandwidth and including a second stream having a second bandwidth. The first bandwidth is greater than the second bandwidth; the first stream is transmitted simultaneously with the second stream. During certain periods of time, the combined stream consists primarily of either the first stream or the second stream but not both so that during the certain periods the combined stream has a bandwidth which is less than or equal to the first bandwidth. The assigned bandwidth of the communications channel allocated to the combined stream is less than or equal to the first bandwidth.","In accordance with another aspect of the invention, a modulated data signal has data fields encoded thereon transmitted over a communications channel having an assigned bandwidth. The modulated data signal comprises a combined stream including a first stream having a first bandwidth and including a second stream having a second bandwidth. The first bandwidth is greater than the second bandwidth. The first stream is transmitted simultaneously with the second stream. During certain periods of time, the combined stream consists primarily (1) of a portion of the first stream having a first partial bandwidth which is less than the first bandwidth and the second stream, or (2) of a portion of the second stream having a second partial bandwidth which is less than the second bandwidth and the first stream, so that during the certain periods the combined stream has a bandwidth which is less than or equal to the first partial bandwidth plus the second bandwidth or the second partial bandwidth plus the first bandwidth, respectively. The assigned bandwidth of the communications channel allocated to the combined stream is less than or equal to the total of the first partial bandwidth and the second partial bandwidth.","In accordance with another aspect of the invention, a modulated data signal has data fields encoded thereon transmitted over a communications channel having an assigned bandwidth. The modulated data signal comprises a combined stream including: an audio stream having an audio bandwidth;","a video stream having a video bandwidth;","a file transfer stream having a file transfer bandwidth; and","a text stream having a text bandwidth.","The file transfer bandwidth is greater than the text bandwidth. The streams are transmitted simultaneously with each other. During certain periods of time, the combined stream includes primarily either the file transfer stream or the text stream but not both so that during the certain periods the combined stream has a combined bandwidth which is less than or equal to the audio bandwidth plus the video bandwidth plus the file transfer bandwidth.","In accordance with another aspect of the invention, a modulated data signal has data fields encoded thereon transmitted over a communications channel having an assigned bandwidth. The modulated data signal comprises a combined stream including: an audio stream having an audio bandwidth;","a video stream having a video bandwidth;","a file transfer stream having a file transfer bandwidth; and","a text stream having a text bandwidth.","The file transfer bandwidth is greater than the text bandwidth. The streams are transmitted simultaneously with each other. During certain periods of time, the combined stream includes primarily (1) a portion of the file transfer stream having a file transfer partial bandwidth which is less than the file transfer bandwidth and (2) a portion of the text stream having a text partial bandwidth which is less than the text bandwidth so that during the certain periods the combined stream has a combined bandwidth which is less than or equal to the audio bandwidth plus the video bandwidth plus the partial file transfer bandwidth plus the partial text bandwidth.","In accordance with another aspect of the invention, a computer readable medium has stored thereon a data structure comprising an advanced streaming format including a header including a bandwidth sharing object specifying the bandwidth for simultaneously streaming N streams as a combined stream (where N is an integer greater than 1). The bandwidth sharing object is a function of the bandwidth of each of the streams and includes a bandwidth value specified in the objects which is less than the total of the bandwidth of the N streams.","In accordance with another aspect of the invention, a modulated data signal has data fields encoded thereon which define a bandwidth of the modulated data signal. The signal is transmitted over a communications channel. The signal comprises a first data field containing descriptive information of a first stream having a first bandwidth and a second data field containing descriptive information of a second stream having a second bandwidth. The first bandwidth is greater than or equal to the second bandwidth. At least at certain times the first stream is transmitted simultaneously with the second stream. One or more additional data fields, each containing descriptive information of an additional stream having an additional bandwidth. At least at certain times the additional streams are transmitted simultaneously with the first and second stream. A bandwidth data field includes a bandwidth value indicating a designated bandwidth for simultaneously streaming the modulated data signal.","In accordance with another aspect of the invention, a method transmits an advanced streaming format video stream. The method comprises:","sending a composite stream having a plurality of component streams; and","sending an object indicating the bandwidth of the composite stream which object is less than the total bandwidth of the component streams.","In accordance with another aspect of the invention, in a computer system, a method comprises:","receiving a data structure that holds multiple streams of data, the streams of data comprising samples that are stored in packets in the data structure and wherein the data structure includes bandwidth-sharing data that was stored prior to a request being transmitted by the computer system that caused the data structure to be received, wherein the bandwidth-sharing data indicates a combined bandwidth of the streams of data, wherein the combined bandwidth is a function of a bandwidth of each of the streams of data, and wherein the combined bandwidth is less than a sum of the bandwidths of the streams of data; and","extracting the bandwidth-sharing data to adjust network resource requirements according to the combined bandwidth.","In accordance with another aspect of the invention, a data processing system having a source computer with a storage, a data structure and a bandwidth-sharing object. The data structure is stored in the storage for encapsulating multiple data streams into an aggregated data stream defined by the data structure. The data from the data streams are incorporated in packets prior to a request being received by the source computer to transmit the aggregated data stream to a destination computer. The bandwidth-sharing data is encapsulated in a header associated with the packets. The bandwidth-sharing data indicates a combined bandwidth of the aggregated data stream. The combined bandwidth is a function of a bandwidth of each of the data streams. The combined bandwidth is less than a sum of the bandwidths of the data streams.","In accordance with another aspect of the invention, in a computer system operable for connecting to a communications channel, a method encapsulates multiple streams of data into an aggregated data stream to be transmitted on the communications channel. The method comprises:","determining a packet size for the communications channel;","storing, on a storage device, at least one packet containing information about the aggregated data stream to form a header section in a data structure that defines the aggregated data stream;","storing, on the storage device, packets containing samples of data from the multiple data streams to form a data section in the data structure;","designating a portion of at least one packet in the data section for holding bandwidth-sharing data; and","storing, on the storage device, bandwidth-sharing data in a header associated with the packets.","The bandwidth-sharing data indicates a combined bandwidth of the aggregated data stream. The combined bandwidth is a function of a bandwidth of each of the streams of data. The combined bandwidth is less than a sum of the bandwidths of the streams of data. The aggregated data stream is stored on the storage device prior to receiving a request for transmission of the aggregated data stream on the communications channel from a destination computer.","Alternatively, the invention may comprise various other methods and apparatuses.","Other features will be in part apparent and in part pointed out hereinafter.","Corresponding reference characters indicate corresponding parts throughout the drawings.","The invention comprises a data signal including an up-front description of the following data (a\/k\/a header), followed by the actual streaming data. The description section contains at least one subsection, each of which in turn contains at least four data fields. The first data field describes the bandwidth sharing type (i.e., indicates whether it's exclusive or partial bandwidth sharing, as noted below). From the second field through the second-to-last field, a stream number and the required bandwidth for that individual stream is indicated. The final field describes the bandwidth required for streaming the previously mentioned multimedia streams simultaneously. (Note that other fields throughout the description (header) will typically contain much more information about the multimedia streams, but for the purposes of this invention, only the three fields are needed). The third field will be less than the sum of the previous bandwidth fields (in order for this information to be useful). Following the description is the actual streaming data for this streaming presentation, consisting of the data for multimedia stream one and multimedia stream two. The streaming data generally comprises data for the two multimedia streams interleaved together. This is particularly true in the case of a signal having an advanced streaming format (ASF). An ASF file is defined by a bit rate Rfor stream A and a buffer window Bfor stream B. Together these quantities generally describe the network resources required for streaming all of the streams in that ASF file. Generally, one of the bandwidths of one of the streams is greater than the other and both streams and any additional streams are transmitted simultaneously. Also in the ASF header, a third (or additional) ASF object is transmitted. The third data field includes an object (e.g., a bandwidth-sharing object) indicating the designated or needed bandwidth of the combined streams (e.g., a bandwidth). The object is a function of the bandwidth of each of the streams. However, the bandwidth of the combined streams as defined by the third data field is less than the total of the bandwidth of each of the streams. This is in contrast to the prior art wherein the total bandwidth of a plurality of streams was determined by summing the bandwidth of each of the streams. In order to accomplish a combined stream bandwidth which is less than the total bandwidth of the individual streams, a bandwidth sharing object is required. The amount of bandwidth that can be shared depends on the interrelationship between the various streams, as noted above.","An ASF file holds multiple data (e.g., media) streams. ASF is well suited for storage of multimedia streams as well as transmission of multiple media streams over a communications channel. ASF is constructed to encapsulate diverse multimedia streams and facilitates optimal interleaving of respective media streams. ASF specifies the packetization of data and provides flexibility in choosing packet sizes.","In general, two different types of interrelationships of the streams are possible for bandwidth sharing interrelationships. The first type of relationship is called exclusive bandwidth sharing and is illustrated in .  illustrates the bandwidth of four different streams of information: a video stream S, an audio stream S, a file transfer stream S, and a text stream S.  illustrates that the video bitrate (e.g. bandwidth) of the video stream Sis consistently and essentially 100 kilobits per second (kbps) after time t. It is assumed that the bandwidth needed for the video stream Sactually will vary between 0 and 100 kbps, 100 kbps being an exemplary indication of the maximum bandwidth. For the most part, the amount of bandwidth needed to transmit the video stream would be about the same and would consistently be about a bandwidth of 100 kbps. (Similarly, the audio bandwidth Swould consistently require a bandwidth of 50 kbps after time t.)","However, it is possible that the bandwidth needed for the file transfer stream Sand the text stream Smay be intermittent and in fact could be configured so that these bandwidths are mutually exclusive. In other words, the two streams of information would be configured so that only one stream would require any significant bandwidth at any particular instant in time. In one embodiment, the configuration is encapsulated in a bandwidth-sharing object associated with the two streams, where the object specifies that only one stream or the other may be sent at any one time. In general, for our example, the file transfer stream Swould require a maximum bandwidth of 50 kbps and the text stream would require a maximum bandwidth of 25 kbps. However, between times tand tonly the file transfer stream is transmitting so that the text stream requires little or no bandwidth. Similarly, between times tand tthe file transfer stream is not transmitting whereas the text stream is transmitting so that only bandwidth for the text stream is required. The periods between tand t, tand t, and after tare also periods of time when only the file transfer stream is being transmitted and the text transfer stream is not. On the other hand, the times between tand t, tand t, and tand tare periods of time when the text transfer stream is being transmitted and the file transfer stream is not. The period of time between tand tis an illustration of a period of time when neither the file transfer stream nor the text stream is being transmitted. With respect to the file transfer and text streams, it can be seen according to the illustration in  that during certain periods of time of transmission, the composite modulated data ASF signal consists primarily of either the file transfer stream or the text stream but not both.","In the past, the bandwidth of a composite data stream such as illustrated in  would be calculated by summing the total bandwidth needed for each of the streams. Thus, the video stream Srequires a bandwidth of 100 kbps, the audio stream Srequires 50 kbps, the file transfer stream Srequires 50 kbps and the text stream Srequires 25 kbps for a total bandwidth of 225 kbps. However, because the file transfer stream Sand the text stream Sare mutually exclusive and only one stream is transmitting at a particular period in time, the actual bandwidth needed to transmit the composite signal illustrated in  does not exceed 200 kbps and between tand tis only 150 kbps. This actual bandwidth needed can be determined by summing the bandwidth needed for each of the streams at any instant in time. For example, between tand t, the actual bandwidth needed for Sis 100 kbps, for Sis 50 kbps, for Sis 50 kbps and for Sis 0 for a composite bandwidth of 200 kbps. Between tand t, the actual bandwidth needed for Sis 100 kbps, for Sis 50 kbps, for Sis 0 and for Sis 25 kbps for a composite bandwidth of 175 kbps. Between tand t, the actual bandwidth needed for Sis 100 kbps, for Sis 50 kbps, for Sis 0 and for Sis 0 for a composite bandwidth of 150 kbps.","In general, with regard to the streams that are mutually exclusive, one stream will have a bandwidth which is greater than or equal to the bandwidth of the other stream. In the illustration of , the file transfer stream Shas greater bandwidth requirements than the text transfer stream S. However, it is contemplated that the streams may require the same bandwidth. As a result, the actual bandwidth needed for the composite signal with respect to the file transfer stream and the text stream is less than the bandwidth of the greater of the two which, in this case, is the bandwidth of 50 kbps for the file transfer stream.",{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 2","sub":["V ","A ","F ","T ","10 ","11 ","1 ","14 ","15 ","13 ","14 ","17 ","18","11 ","19","11 ","19"]},"It is also contemplated that the actual bandwidth assigned or allocated to a particular combined stream or communications channel could be less than needed to cover any and every instant in time. For example, with particular regard to , it is noted that the maximum bandwidth needed is 212.5 kbps except for the period of time between tand t. Thus, a decision could be made to specify that the bandwidth sharing object be equal to the substantial maximum of the actual bandwidth needed of 212.5 kbps as opposed to the absolute maximum of 250 kbps. Thus, for the period between tand t, the allocated bandwidth would be slightly less than required resulting in a degraded presentation to the user. This compromise is considered by the user to be acceptable. A similar compromise could be made with respect to the exclusive bandwidth sharing scenario illustrated in .","In general, in one form of the invention, a modulated data signal having data fields encoded which define a bandwidth of the modulated data signal is indicated. The signal is transmitted over a communications channel which is preferably assigned or allocated a bandwidth equal to the bandwidth indicated by the modulated data signal. The modulated data signal will include an initial description, containing data fields specifying the bandwidths of multimedia streams. Following the initial description, the modulated data signal will include the actual data for the two or more multimedia streams.","In general, the first bandwidth would be greater than or equal to the second bandwidth and the streams would be transmitted simultaneously along with one or more additional streams defined in additional data fields. Each additional stream carries additional information and each of the additional streams has an additional bandwidth requirement. The initial description, contained in the data signal, includes a bandwidth data field including an object indicating the bandwidth of the modulated data signal. This object is a function of the bandwidth of the streams and, in accordance with the invention, is less than the total of the bandwidth requirements of the streams.",{"@attributes":{"id":"p-0056","num":"0055"},"figref":["FIG. 3","FIG. 1","FIG. 2"],"b":["302","304","306","308","310","310"]},"The following is a description of how a content-authoring application (referred to below as the \u201cauthor\u201d) would use the SDK to add bandwidth-sharing to an ASF file.","Conceptually, bandwidth-sharing is a part of an ASF profile used for encoding. The author specifies many different characteristics for the content such as a listing of streams and their desired characteristics (stream type, bit rate, etc) and a listing of the various relationships among those streams. Bandwidth sharing belongs in the ASF profile because bandwidth-sharing is an inter-stream relationship.","As part of its application programming interface (API), the SDK provides an interface such as IWMProfile (as well as IWMProfile2 and IWMProfile3) as an abstraction with which the author can manipulate the profile. Content authors can develop a profile for encoding in one of three ways: (1) by building one from scratch using the IWMProfile interface; or (2) by opening an ASF file with an SDK reader and obtaining the profile from a profile reader (e.g., IWMReader); or (3) by loading a previously-created profile that was stored as XML on the local disk via a profile manager interface (e.g., IWMProfileManager). A content author can also obtain a profile in either of the last two ways mentioned and subsequently manipulate it using the API. Bandwidth-sharing relationships can be expressed by the content author in the encoding profile in any of the above ways.","In order to add a bandwidth-sharing relationship to an existing profile via the IWMProfile interface, the author follows a procedure such as the exemplary procedure next described. The author calls IWMProfile3::CreateNewBandwidthSharing( ) to get an instance of IWMBandwidthSharing. The author calls IWMBandwidthSharing::SetType( ) to set the type to exclusive bandwidth sharing (it can also be set to partial bandwidth sharing). In this example, this would be the GUID (Globally Unique IDentifier) for exclusive bandwidth sharing. The author also calls IWMBandwidthSharing::SetBandwidth( ) to set the network resources (Rand B) needed for the streams in the bandwidth-sharing relationship according to the author's knowledge of the characteristics of this stream. For each stream in the relationship, the author calls IWMBandwidthSharing::AddStream( ). The author calls IWMProfile3::AddBandwidthSharing( ) with the IWMBandwidthSharing interface pointer. The author calls IWMWriter::SetProfile with the IWMProfile interface pointer.","Those skilled in the art will appreciate that the invention is not limited to the procedure or the routines specified in the above exemplary procedure. It is contemplated by the inventors that other procedures and routines for adding bandwidth-sharing to a profile not specifically described herein are within the scope of the invention. For example, and as described herein, the bandwidth-sharing object may be created and inserted into an ASF file when the ASF file is created. Alternatively, the bandwidth-sharing object may be created and inserted into an ASF file as a post-processing step after the ASF file has been created. In an another example, the bandwidth-sharing object is created and inserted in a streaming ASF file dynamically. In such an embodiment, the audio and video compressors-decompressors communicate their changing bandwidth needs dynamically.","At this point, the author proceeds with encoding as usual. The author may persist this profile to disk as XML using IWMProfileManager. If accessed later, the IWMProfile will already specify this bandwidth-sharing relationship.","While encoding, the SDK writer stores this information in the ASF file it is writing as a bandwidth-sharing object (BSO). The BSO is an object in the ASF header that precedes the data in ASF files. The generation of the ASF header occurs at the beginning of encoding in a component of the writer called the multiplexer, and this is where BSOs get added to the header as well. An exemplary format of the BSO is shown and explained in Table A below.","Upon opening this file for streaming, a media server can parse this ASF header object and get information about the bandwidth-sharing relationship for use in the stream selection process. The stream selection process usually involves considering various subsets of the set of streams in a particular ASF file and comparing the total bandwidth needed for that subset against what resources are currently available for streaming. When determining what bandwidth is needed for a particular subset of the streams, if all streams for a particular BSO are present, then the server should use Ras the bandwidth required for those streams rather than simply adding up the values of R across those streams. Thus, the BSO is used to obtain a more optimal subset of the multimedia streams in the streaming file.","As noted above, there are two quantities associated with a bandwidth-sharing relationship in an ASF file: the bit rate Rand the buffer window B. Together, these quantities should accurately describe the network resources required for streaming all of the streams in that relationship. Of course, specifying the bandwidth-sharing relationship is useful when Ris less than the sum of R over all of those streams.","As described herein, bit rate and buffer window describe the streaming properties of a stream as a pair. Depending on the burstiness of a particular stream, the bit rate can be reduced if the buffer window is increased sufficiently. A given stream can be streamed with various bit rate and buffer window combinations, so these values are not uniquely determined for a certain stream.","For exclusive bandwidth sharing relationships, such as the one illustrated in , Rwould be the \u201cactual\u201d bandwidth needed over all streams in the relationship, as noted above. Since exclusive bandwidth sharing means that only one stream is active at any instant in time, the \u201cactual\u201d bandwidth needed at a particular time is equal to the bandwidth of the stream that is active at that particular time. Over a period of time when multiple streams are active, one at a time, the \u201cactual\u201d bandwidth needed during the period of time is equal to the maximum of the bandwidths of each stream. (See ). Depending on the qualities of the particular set of streams, sensible values for Bcan range from the max B over all the streams to the sum of B over all the streams. More than Bmay be required to handle cases when the various streams' different buffers are all relatively full at a given point in time.","For partial bandwidth sharing, Rwould be less than the sum of R over the streams in the relationship, as noted above with regard to . The same holds for B.",{"@attributes":{"id":"p-0069","num":"0068"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE A"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Exemplary Format of the ASF Bandwidth-Sharing object"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"center"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field Name","Field Type","Size (bits)"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"91pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"center"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"char","char":"."}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Object ID","GUID","128"]},{"entry":[{},"Object Size","QWORD","64"]},{"entry":[{},"Sharing Type","GUID","128"]},{"entry":[{},"Data Bit Rate","DWORD","32"]},{"entry":[{},"Buffer Size","DWORD","32"]},{"entry":[{},"Stream Numbers Count","WORD","16"]},{"entry":[{},"Stream Numbers","WORD","?"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"3","align":"center","rowsep":"1"}}]}]}}]}}},"The object ID field specifies a globally unique identifier (GUID) for the bandwidth sharing object. In one embodiment, the value of this field is set to ASF_Bandwidth_Sharing_Object. The object size field specifies the size in bytes of the bandwidth sharing object. In one embodiment, valid values are larger than 50 bytes. The sharing type field specifies the type of sharing relationship for this object. Two types are predefined: PARTIAL, in which any number of the streams in the relationship may be streaming data at any given time (see ), and EXCLUSIVE, in which only one of the streams in the relationship may be streaming data at any given time (see ). The data bit rate field specifies the leak rate in bits per second of a leaky bucket that contains data without overflowing the data portion of any of the streams, excluding all ASF data packet overhead. This is the nominal bit rate used by the encoder's rate control algorithm. If this field is 0, then the data bit rate is equal to the largest maximum data bit rate among all the streams in this relationship. The buffer size field specifies the size in bits of the leaky bucket used in the data bit rate field. This is the size of the buffer used by the encoder's rate control algorithm. If the data bit rate field is 0, then the buffer size value to be used is the value of the stream with a data bit rate equal to the largest maximum data bit rate among all the streams in the relationship. The stream numbers count field specifies the number of entries in the stream numbers field. The stream numbers field specifies the list of media streams in a bandwidth sharing relationship with the others. In one embodiment, valid values are between 1 and 127.",{"@attributes":{"id":"p-0071","num":"0070"},"figref":"FIG. 4","b":["400","402","404","406","408","412","408","410","412","414","416"]},{"@attributes":{"id":"p-0072","num":"0071"},"figref":"FIG. 5","b":["130","130","130","132","134","136","134","132","136"]},"The computer  typically has at least some form of computer readable media. Computer readable media, which include both volatile and nonvolatile media, removable and non-removable media, may be any available medium that can be accessed by computer . By way of example and not limitation, computer readable media comprise computer storage media and communication media. Computer storage media include volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. For example, computer storage media include RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium that can be used to store the desired information and that can be accessed by computer . Communication media typically embody computer readable instructions, data structures, program modules, or other data in a modulated data signal such as a carrier wave or other transport mechanism and include any information delivery media. Those skilled in the art are familiar with the modulated data signal, which has one or more of its characteristics set or changed in such a manner as to encode information in the signal. Wired media, such as a wired network or direct-wired connection, and wireless media, such as acoustic, RF, infrared, and other wireless media, are examples of communication media. Combinations of the any of the above are also included within the scope of computer readable media.","The system memory  includes computer storage media in the form of removable and\/or non-removable, volatile and\/or nonvolatile memory. In the illustrated embodiment, system memory  includes read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules , and program data .","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. For example,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media.  also shows a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD-ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a non-volatile memory interface, such as interface .","The drives or other mass storage devices and their associated computer storage media discussed above and illustrated in , provide storage of computer readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules , and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers here to illustrate that, at a minimum, they are different copies.","A user may enter commands and information into computer  through input devices or user interface selection devices such as a keyboard  and a pointing device  (e.g., a mouse, trackball, pen, or touch pad). Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are connected to processing unit  through a user input interface  that is coupled to system bus , but may be connected by other interface and bus structures, such as a parallel port, game port, or a Universal Serial Bus (USB). A monitor  or other type of display device is also connected to system bus  via an interface, such as a video interface . In addition to the monitor , computers often include other peripheral output devices (not shown) such as a printer and speakers, which may be connected through an output peripheral interface (not shown).","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to computer . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and global computer networks (e.g., the Internet).","When used in a local area networking environment, computer  is connected to the LAN  through a network interface or adapter . When used in a wide area networking environment, computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, is connected to system bus  via the user input interface , or other appropriate mechanism. In a networked environment, program modules depicted relative to computer , or portions thereof, may be stored in a remote memory storage device (not shown). By way of example, and not limitation,  illustrates remote application programs  as residing on the memory device. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","Generally, the data processors of computer  are programmed by means of instructions stored at different times in the various computer-readable storage media of the computer. Programs and operating systems are typically distributed, for example, on floppy disks or CD-ROMs. From there, they are installed or loaded into the secondary memory of a computer. At execution, they are loaded at least partially into the computer's primary electronic memory. The invention described herein includes these and other various types of computer-readable storage media when such media contain instructions or programs for implementing the steps described below in conjunction with a microprocessor or other data processor. The invention also includes the computer itself when programmed according to the methods and techniques described herein.","For purposes of illustration, programs and other executable program components, such as the operating system, are illustrated herein as discrete blocks. It is recognized, however, that such programs and components reside at various times in different storage components of the computer, and are executed by the data processor(s) of the computer.","Although described in connection with an exemplary computing system environment, including computer , the invention is operational with numerous other general purpose or special purpose computing system environments or configurations. The computing system environment is not intended to suggest any limitation as to the scope of use or functionality of the invention. Moreover, the computing system environment should not be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary operating environment. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, executed by one or more computers or other devices. Generally, program modules include, but are not limited to, routines, programs, objects, components, and data structures that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote computer storage media including memory storage devices.","The following is an example of an ASF file that can make use of bandwidth sharing. This example will be referred to in the following section for the purpose of illustration.","Consider an ASF file containing an audio-video presentation that is accompanied by a file transfer stream and a text stream. The four streams are referred to as S, S, S, and Sto indicate the audio, video, file-transfer, and text streams, respectively. The respective stream numbers are 1, 2, 3, and 4. Each stream has its own streaming requirements of bit rate R and buffer window B, which we will refer to as R, B, etc. Suppose that (R, B) for the four streams are, respectively (R, B)=(10168, 3000), (R, B)=(16000, 3000), (R, B)=(5000, 6000), (R, B)=(1000, 3000), where values for R are given in bits per second (bps), and values for B are given in milliseconds.","Once this content has been created, assuming that there are no bandwidth-sharing relationships specified by the author, a server can safely assume that the amount of bandwidth needed to stream all four streams is 10168+16000+5000+1000=32168 bps.","The author knows that Sand Sare never actively streaming data at the same time (i.e., the streams take turns). This relationship between the two streams is exclusive bandwidth sharing as discussed above. Partial bandwidth sharing, also discussed above, refers to a situation in which two or more streams do not necessarily take turns streaming, but nevertheless together require bandwidth less than the sum of the streams' bandwidths.  is a visual representation of the streaming behavior of exclusive bandwidth sharing and  of partial bandwidth sharing.","When introducing elements of the present invention or the embodiment(s) thereof, the articles \u201ca,\u201d \u201can,\u201d \u201cthe,\u201d and \u201csaid\u201d are intended to mean that there are one or more of the elements. The terms \u201ccomprising,\u201d \u201cincluding,\u201d and \u201chaving\u201d are intended to be inclusive and mean that there may be additional elements other than the listed elements.","In view of the above, it will be seen that the several objects of the invention are achieved and other advantageous results attained.","As various changes could be made in the above constructions, products, and methods without departing from the scope of the invention, it is intended that all matter contained in the above description and shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.","The following routines exemplify a software development kit according to the invention.","IWMBandwidthSharing Interface","A IWMBandwidthSharing interface contains methods to manage the properties of combined streams. The list of streams that will share bandwidth is stored in the bandwidth sharing object. They can be manipulated using the methods of the IWMStreamList interface. IWMBandwidthSharing inherits from IWMStreamList, so the stream list manipulation methods are always exposed through this interface. The information in a bandwidth sharing object is purely informational. There is no logic in the SDK that seeks to enforce or check the accuracy of the bandwidth specified. You might want to use bandwidth sharing so that a reading application can make adjustments based on the information contained in the bandwidth sharing object. An IWMBandwidthSharing interface is exposed for each bandwidth sharing object upon creation. Bandwidth sharing objects are created using the IWMProfile3::CreateNewBandwidthSharing method. In addition to the methods inherited from IWMStreamList, the IWMBandwidthSharing interface exposes the following methods.",{"@attributes":{"id":"p-0093","num":"0092"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"168pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["GetBandwidth","Retrieves the bandwidth and maximum buffer size of"]},{"entry":[{},"the streams in the bandwidth sharing object."]},{"entry":["GetType","Retrieves the type of sharing (exclusive or partial) for"]},{"entry":[{},"the bandwidth sharing object."]},{"entry":["SetBandwidth","Sets the bandwidth and maximum buffer size for"]},{"entry":[{},"streams in the bandwidth sharing object."]},{"entry":["SetType","Sets the type of sharing (exclusive or partial) for the"]},{"entry":[{},"bandwidth sharing object."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The GetBandwidth method retrieves the bandwidth and maximum buffer size of a combined stream.",{"@attributes":{"id":"p-0095","num":"0094"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT GetBandwidth("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DWORD* pdwBitrate,"]},{"entry":[{},"DWORD* pmsBufferWindow"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[out] Pointer to a DWORD containing the bit rate in bits per second. The combined bandwidths of the streams cannot exceed this value.","pmsBufferWindow","[out] Pointer to DWORD containing the buffer window in milliseconds. The combined buffer sizes of the streams cannot exceed this value.","Return Values","If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0099","num":"0098"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"Return code","Description"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"E_INVALIDARG","One or both of the parameters are NULL."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"The settings of a bandwidth sharing object are purely informational. The SDK does not check them for accuracy.","IWMBandwidthSharing::GetType","The GetType method retrieves the type of sharing for the bandwidth sharing object.",{"@attributes":{"id":"p-0102","num":"0101"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT GetType("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"GUID* pguidType"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[out] Pointer to a globally unique identifier specifying the type of combined stream to be used. This will be one of the following values.",{"@attributes":{"id":"p-0104","num":"0103"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Bandwidth sharing type","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CLSID_WMBandwidthSharing_Exclusive","Only one of the constituent"]},{"entry":[{},"streams can be active at any"]},{"entry":[{},"given time."]},{"entry":["CLSID_WMBandwidthSharing_Partial","The constituent streams can"]},{"entry":[{},"be active simultaneously."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0106","num":"0105"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"21pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}}],"thead":{"row":[{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]},{"entry":[{},"Return code","Description"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"E_INVALIDARG","The pointer passed is NULL."]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"2","align":"center","rowsep":"1"}}]}]}}}},"br":{}},"The settings of a bandwidth sharing object are purely informational. The SDK does not check them for accuracy.","IWMBandwidthSharing::SetBandwidth","The SetBandwidth method sets the bandwidth and maximum buffer size for a combined stream.",{"@attributes":{"id":"p-0109","num":"0108"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT SetBandwidth("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DWORD dwBitrate,"]},{"entry":[{},"DWORD msBufferWindow"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[in] DWORD containing the bit rate in bits per second. The combined bandwidths of the streams cannot exceed this value.","msBufferWindow","[in] Specifies the buffer window in milliseconds. The combined buffer sizes of the streams cannot exceed this value.","Return Values","This method always returns S_OK.","Remarks","The settings of a bandwidth sharing object are purely informational. The SDK does not check them for accuracy.","IWMBandwidthSharing::SetType","The SetType method sets the type of sharing (exclusive or partial) for the bandwidth sharing object.",{"@attributes":{"id":"p-0115","num":"0114"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT SetType("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"140pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"REFGUID guidType"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[in] A globally unique identifier specifying the type of combined stream to be used. The only valid GUIDs that can be passed are those in the following table.",{"@attributes":{"id":"p-0117","num":"0116"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Bandwidth sharing type","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CLSID_WMBandwidthSharing_Exclusive","Only one of the constituent"]},{"entry":[{},"streams can be active at any"]},{"entry":[{},"given time."]},{"entry":["CLSID_WMBandwidthSharing_Partial","The constituent streams can"]},{"entry":[{},"be active simultaneously."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0119","num":"0118"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Return code","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["E_INVALIDARG","The GUID passed in guidType is any value"]},{"entry":[{},"other than CLSID_BandwidthSharingExclusive"]},{"entry":[{},"or CLSID_BandwidthSharingPartial."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The settings of a bandwidth sharing object are purely informational. The SDK does not check them for accuracy.","IWMProfile3::AddBandwidthSharing","The AddBandwidthSharing method adds an existing bandwidth sharing object to the profile. Bandwidth sharing objects are created with a call to IWMProfile3::CreateNewBandwidthSharing. You must configure the bandwidth sharing object before adding it to the profile.",{"@attributes":{"id":"p-0122","num":"0121"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT AddBandwidthSharing("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"147pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"IWMBandwidthSharing* pBS"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[in] Pointer to the IWMBandwidthSharing interface of a bandwidth sharing object.","Return Values","If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0125","num":"0124"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Return code","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["E_INVALIDARG","pBS is NULL."]},{"entry":[{},"OR"]},{"entry":[{},"The bandwidth sharing object has a bandwidth"]},{"entry":[{},"sharing type value that is not valid."]},{"entry":["E_UNEXPECTED","An unknown error occurred while adding the"]},{"entry":[{},"bandwidth sharing object to the internal"]},{"entry":[{},"collection in the profile."]},{"entry":["E_OUTOFMEMORY","The method was unable to allocate memory."]},{"entry":["NS_E_NO_STREAM","The bandwidth sharing object contains no"]},{"entry":[{},"streams."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"Making a call to AddBandwidthSharing without first using the methods of IWMBandwidthSharing to configure the bandwidth sharing object will result in an error.","IWMProfile3::CreateNewBandwidthSharing","The CreateNewBandwidthSharing method creates a new bandwidth sharing object.",{"@attributes":{"id":"p-0128","num":"0127"},"tables":{"@attributes":{"id":"TABLE-US-00014","num":"00014"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT CreateNewBandwidthSharing("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"161pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"IWMBandwidthSharing** ppBS"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[out] Pointer to receive the address of the IWMBandwidthSharing interface of the new object.","Return Values","If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0131","num":"0130"},"tables":{"@attributes":{"id":"TABLE-US-00015","num":"00015"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Return code","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["E_INVALIDARG","ppBS is NULL."]},{"entry":["E_OUTOFMEMORY","The method is unable to allocate memory for the"]},{"entry":[{},"new object."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"In order to make use of the bandwidth sharing object, you must add it to the profile with a call to IWMProfile3::AddBandwidthSharing. A bandwidth sharing object cannot exist on its own. If you release the profile object without adding the bandwidth sharing object to the profile, you will lose the bandwidth sharing object.","You must configure the bandwidth sharing object before you use IWMProfile3::AddBandwdithSharing to include the bandwidth sharing object in the profile. For more information about configuring bandwidth sharing objects, see the IWMBandwidthSharing interface section.","Bandwidth Sharing Objects","Bandwidth sharing objects are used to indicate that two or more streams, regardless of their individual bit rates, will never use more than a specified amount of bandwidth between them. This is a purely informational object, and is not enforced programmatically by any feature of this SDK.","Bandwidth sharing information is an optional part of a profile. Bandwidth sharing objects may be created for existing bandwidth sharing information in a profile or may be created empty, ready to receive new data. Bandwidth sharing objects cannot exist independently of a profile object. To save the contents of a bandwidth sharing object, you must call IWMProfile3::AddBandwidthSharing.","To create a bandwidth sharing object, call one of the following methods.",{"@attributes":{"id":"p-0137","num":"0136"},"tables":{"@attributes":{"id":"TABLE-US-00016","num":"00016"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["IWMProfile3::CreateNewBandwidthSharing","Creates a bandwidth"]},{"entry":[{},"sharing object without any"]},{"entry":[{},"data."]},{"entry":["IWMProfile3::GetBandwidthSharing","Creates a bandwidth"]},{"entry":[{},"sharing object populated"]},{"entry":[{},"with data from a profile."]},{"entry":[{},"Uses the bandwidth sharing"]},{"entry":[{},"index to identify the desired"]},{"entry":[{},"bandwidth sharing"]},{"entry":[{},"information."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Both methods in the preceding table set a pointer to an IWMBandwidthSharing interface. The IWMStreamList interface is inherited by IWMBandwidthSharing, so there is no need to call QueryInterface with this object.","The following interfaces are supported by every bandwidth sharing object.",{"@attributes":{"id":"p-0140","num":"0139"},"tables":{"@attributes":{"id":"TABLE-US-00017","num":"00017"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"84pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"133pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Interface","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["IWMBandwidthSharing","Manages the properties of a group of streams"]},{"entry":[{},"that will share bandwidth."]},{"entry":["IWMStreamList","Manages the list of streams that will share"]},{"entry":[{},"bandwidth."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The reader object and the synchronous reader object both support IWMProfile, IWMProfile2, and IWMProfile3. You can also access bandwidth sharing objects that are part of a file loaded into the reader.","Bandwidth Sharing Types","You can use bandwidth sharing types to identify the nature of a bandwidth sharing object in a profile. Bandwidth sharing types are used as parameters for IWMBandwidthSharing::GetType and IWMBandwidthSharing::SetType.","The following table lists the identifiers for bandwidth sharing types.",{"@attributes":{"id":"p-0144","num":"0143"},"tables":{"@attributes":{"id":"TABLE-US-00018","num":"00018"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Bandwidth sharing type constant","GUID"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["CLSID_WMBandwidthSharing_Exclusive","AF6060AA-5197-11D2-"]},{"entry":[{},"B6AF-00C04FD908E9"]},{"entry":["CLSID_WMBandwidthSharing_Partial","AF6060AB-5197-11D2-"]},{"entry":[{},"B6AF-00C04FD908E9"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The GetBandwidthSharing method retrieves a bandwidth sharing object from a profile.",{"@attributes":{"id":"p-0146","num":"0145"},"tables":{"@attributes":{"id":"TABLE-US-00019","num":"00019"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT GetBandwidthSharing("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"DWORD dwBSIndex,"]},{"entry":[{},"IWMBandwidthSharing** ppBS"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[in] DWORD containing the index number of the bandwidth sharing object you wish to retrieve.","ppBS","[out] Pointer to receive the address of the IWMBandwidthSharing interface of the object requested.","Return Values","If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0150","num":"0149"},"tables":{"@attributes":{"id":"TABLE-US-00020","num":"00020"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"147pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Return code","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["E_INVALIDARG","ppBS is NULL."]},{"entry":[{},"OR"]},{"entry":[{},"dwBSIndex refers to an invalid index number."]},{"entry":["E_OUTOFMEMORY","The method is unable to allocate memory for the"]},{"entry":[{},"bandwidth sharing object."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"Bandwidth sharing objects in a profile are assigned sequential index numbers in the order in which they were added to the profile. When you create multiple bandwidth sharing objects for a profile, you should keep track of the contents of each one. Otherwise you will have to examine each one to ascertain its settings.","IWMProfile3 Interface","The IWMProfile3 interface provides enhanced features for profiles. This includes the ability to create two new types of objects: bandwidth sharing objects and stream prioritization objects.","An IWMProfile3 interface is created for each profile object created. You can retrieve a pointer to an IWMProfile3 interface by calling the QueryInterface method of any other interface of the profile. You can also access IWMProfile3 from a reader or synchronous reader object by calling the QueryInterface method of an existing interface in the object. Another way to obtain an IWMProfile is via the IWMProfileManager.","In addition to the methods inherited from IWMProfile2, the IWMProfile3 interface exposes the following methods.",{"@attributes":{"id":"p-0155","num":"0154"},"tables":{"@attributes":{"id":"TABLE-US-00021","num":"00021"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["AddBandwidthSharing","Adds an existing bandwidth sharing"]},{"entry":[{},"object to the profile."]},{"entry":["CreateNewBandwidthSharing","Creates a new bandwidth sharing object."]},{"entry":["CreateNewStreamPrioritization","Creates a new stream prioritization"]},{"entry":[{},"object."]},{"entry":["GetBandwidthSharing","Obtains a pointer to the"]},{"entry":[{},"IWMBandwidthSharing interface of an"]},{"entry":[{},"existing bandwidth sharing object."]},{"entry":["GetBandwidthSharingCount","Retrieves the number of bandwidth"]},{"entry":[{},"sharing objects that exist in the profile."]},{"entry":["GetExpectedPacketCount","Retrieves the expected number of"]},{"entry":[{},"packets for a specified duration."]},{"entry":["GetStorageFormat","Retrieves the file format for which the"]},{"entry":[{},"profile is configured."]},{"entry":["GetStreamPrioritization","Retrieves the stream prioritization"]},{"entry":[{},"object associated with the profile."]},{"entry":["RemoveBandwidthSharing","Removes a bandwidth sharing object"]},{"entry":[{},"from the profile."]},{"entry":["RemoveStreamPrioritization","Removes a stream prioritization object"]},{"entry":[{},"from the profile."]},{"entry":["SetStorageFormat","Sets the file format to be used with the"]},{"entry":[{},"profile."]},{"entry":["SetStreamPrioritization","Assigns a stream prioritization object to"]},{"entry":[{},"the profile."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The RemoveBandwidthSharing method removes a bandwidth sharing object from the profile. If you do not already have a pointer to the IWMBandwidthSharing interface of the object you want to remove, you must obtain one with a call to IWMProfile3::GetBandwidthSharing.",{"@attributes":{"id":"p-0157","num":"0156"},"tables":{"@attributes":{"id":"TABLE-US-00022","num":"00022"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"thead":{"row":{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Syntax"]},{"entry":[{},"HRESULT RemoveBandwidthSharing("]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":[{},"IWMBandwidthSharing* pBS"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"168pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},");"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"1","align":"center","rowsep":"1"}}]}]}}]}},"br":[{},{}]},"[in] Pointer to a bandwidth sharing object.","Return Values","If the method succeeds, it returns S_OK. If it fails, possible return codes include, but are not limited to, the values shown in the following table.",{"@attributes":{"id":"p-0160","num":"0159"},"tables":{"@attributes":{"id":"TABLE-US-00023","num":"00023"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"154pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Return code","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["E_INVALIDARG","pBS is NULL."]},{"entry":[{},"OR"]},{"entry":[{},"The bandwidth sharing object pointed to by pBS is"]},{"entry":[{},"not part of the profile."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"This method does not release the bandwidth sharing object from memory. You must make a call to the Release method.","IWMStreamList Interface","The IWMStreamList interface is used by mutual exclusion objects and bandwidth sharing objects to maintain lists of streams. The IWMMutualExclusion and IWMBandwidthSharing interfaces each inherit from IWMStreamList. These are the only uses of this interface in the SDK. You will never need to deal with interface pointers for IWMStreamList directly.","In addition to the methods inherited from IUnknown, the IWMStreamList interface exposes the following methods.",{"@attributes":{"id":"p-0164","num":"0163"},"tables":{"@attributes":{"id":"TABLE-US-00024","num":"00024"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["AddStream","Adds a stream to the list."]},{"entry":["GetStreams","Retrieves an array of stream numbers that make up the"]},{"entry":[{},"list."]},{"entry":["RemoveStream","Removes a stream from the list."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"For any file requirement not covered by one of the system profiles, you must create a custom profile because bandwidth sharing is not covered by any presently available profiles. You can create a custom profile by loading an existing profile and manipulating it, or you can create an empty profile and add all of the required information yourself.","Use the following steps to create an entirely new profile.\n\n","The following sections describe the objects that make up a custom profile and the issues involved in configuring them.",{"@attributes":{"id":"p-0168","num":"0185"},"tables":{"@attributes":{"id":"TABLE-US-00025","num":"00025"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"161pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Section","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Configuring","Discusses the issues with configuring streams as well"]},{"entry":["Streams","as the settings you should use for encoding."]},{"entry":["Using Mutual","Describes how to use mutual exclusion objects in your"]},{"entry":["Exclusion","profiles for multiple bit rate streams and other uses."]},{"entry":["Using","Describes how to configure bandwidth sharing objects"]},{"entry":["Bandwidth","to inform reader applications about the combined"]},{"entry":["Sharing","bandwidth requirements of streams."]},{"entry":["Using Stream","Describes how to configure stream prioritization to"]},{"entry":["Prioritization","inform reader applications about which streams can"]},{"entry":[{},"have samples dropped if needed."]},{"entry":["Calculating","Discusses the factors for determining target bandwidth."]},{"entry":"Target"},{"entry":"Bandwidth"},{"entry":["Managing Packet","Discusses the manual configuration of packet size."]},{"entry":"Size"},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"You must use an interface identifier (IID) when making calls to the QueryInterface method. An IID is a globally unique identifier (GUID) value. In the WINDOWS\u00ae Media Format SDK, the constant assigned to the IID for a given interface is the interface name preceded by \u2018IID_\u2019.","The following table lists the interface identifiers and associated constants for the interfaces in this SDK.",{"@attributes":{"id":"p-0171","num":"0188"},"tables":{"@attributes":{"id":"TABLE-US-00026","num":"00026"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0","pgwide":"1"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"112pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"147pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}},{"entry":["Interface","IID constant","GUID"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["IWMBackupRestoreProps","IID_IWMBackupRestoreProps","3C8E0DA6-996F-4FF3-A1AF-4838F9377E2E"]},{"entry":["IWMBandwidthSharing","IID_IWMBandwidthSharing","AD694AF1-F8D9-42F8-BC47-70311B0C4F9E"]},{"entry":["IWMClientConnections","IID_IWMClientConnections","73C66010-A299-41DF-B1F0-CCF03B09C1C6"]},{"entry":["IWMCodecInfo","IID_IWMCodecInfo","A970F41E-34DE-4A98-B3BA-E4B3CA7528F0"]},{"entry":["IWMCodecInfo2","IID_IWMCodecInfo2","AA65E273-B686-4056-91EC-DD768D4DF710"]},{"entry":["IWMCodecInfo3","IID_IWMCodecInfo3","7E51F487-4D93-4F98-8AB4-27D0565ADC51"]},{"entry":["IWMCredentialCallback","IID_IWMCredentialCallback","342E0EB7-E651-450C-975B-2ACE2C90C48E"]},{"entry":["IWMDRMReader","IID_IWMDRMReader","D2827540-3EE7-432C-B14C-DC17F085D3B3"]},{"entry":["IWMHeaderInfo","IID_IWMHeaderInfo","96406BDA-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMHeaderInfo2","IID_IWMHeaderInfo2","15CF9781-454E-482E-B393-85FAE487A810"]},{"entry":["IWMIndexer","IID_IWMIndexer","6D7CDC71-9888-11D3-8EDC-00C04F6109CF"]},{"entry":["IWMIndexer2","IID_IWMIndexer2","B70F1E42-6255-4DF0-A6B9-02B212D9E2BB"]},{"entry":["IWMInputMediaProps","IID_IWMInputMediaProps","96406BD5-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMIStreamProps","IID_IWMIStreamProps","6816DAD3-2B4B-4C8E-8149-874C3483A753"]},{"entry":["IWMLicenseBackup","IID_IWMLicenseBackup","05E5AC9F-3FB6-4508-BB43-A4067BA1EBE8"]},{"entry":["IWMLicenseRestore","IID_IWMLicenseRestore","C70B6334-A22E-4EFB-A245-15E65A004A13"]},{"entry":["IWMMediaProps","IID_IWMMediaProps","96406BCE-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMMetadataEditor","IID_IWMMetadataEditor","96406BD9-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMMetadataEditor2","IID_IWMMetadataEditor2","203CFFE3-2E18-4FDF-B59D-6E71530534CF"]},{"entry":["IWMMutualExclusion","IID_IWMMutualExclusion","96406BDE-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMMutualExclusion2","IID_IWMMutualExclusion2","302B57D?-89D1-4BA2-85C9-166F2C53EB91"]},{"entry":["IWMOutputMediaProps","IID_IWMOutputMediaProps","96406BD7-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMPacketSize","IID_IWMPacketSize","CDFB97AB-188F-40B3-B643-5B7903975C59"]},{"entry":["IWMPacketSize2","IID_IWMPacketSize2","8BFC2B9E-B646-4233-A877-1C6A7?9669DC"]},{"entry":["IWMProfile","IID_IWMProfile","96406BDB-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMProfile2","IID_IWMProfile2","07E72D33-D94E-4BE7-8843-60AE5FF7E5F5"]},{"entry":["IWMProfile3","IID_IWMProfile3","00EF96CC-A461-4546-8BCD-C9A28F0E06F5"]},{"entry":["IWMProfileManager","IID_IWMProfileManager","D16679F2-6CA0-472D-8D31-2F5D55AEE155"]},{"entry":["IWMProfileManager2","IID_IWMProfileManager2","7A924E51-73C1-494D-8019-23D37ED9B89A"]},{"entry":["IWMPropertyVault","IID_IWMPropertyVault","72995A79-5090-42A4-9C8C-D9D0B6D34BE5"]},{"entry":["IWMReader","IID_IWMReader","96406BD6-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderAdvanced","IID_IWMReaderAdvanced","96406BEA-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderAdvanced2","IID_IWMReaderAdvanced2","AE14A945-B90C-4D0D-9127-80D665F7D73E"]},{"entry":["IWMReaderAdvanced3","IID_IWMReaderAdvanced3","5DC0674B-F04B-4A4E-9F2A-B1AFDE2C8100"]},{"entry":["IWMReaderAllocatorEx","IID_IWMReaderAllocatorEx","9F762FA7-A22E-428D-93C9-AC82F3AAFE5A"]},{"entry":["IWMReaderCallback","IID_IWMReaderCallback","96406BD8-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderCallbackAdvanced","IID_IWMReaderCallbackAdvanced","96406BEB-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderNetworkConfig","IID_IWMReaderNetworkConfig","96406BEC-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderStreamClock","IID_IWMReaderStreamClock","96406BED-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMReaderTypeNegotiation","IID_IWMReaderTypeNegotiation","FDBE5592-81A1-41EA-93BD-735CAD1ADC5?"]},{"entry":["IWMRegisterCallback","IID_IWMRegisterCallback","CF4B1F99-4DE2-4E49-A363-252740D99BC1"]},{"entry":["IWMStatusCallback","IID_IWMStatusCallback","6D7CDC70-9888-11D3-8EDC-00C04F6109CF"]},{"entry":["IWMStreamConfig","IID_IWMStreamConfig","96406BDC-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMStreamConfig2","IID_IWMStreamConfig2","7688D8CB-FC0D-43BD-9459-5A8DEC200CFA"]},{"entry":["IWMStreamList","IID_IWMStreamList","96406BDD-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMStreamPrioritization","IID_IWMStreamPrioritization","8C1C6090-F9A8-4748-8EC3-DD1108BA1E77"]},{"entry":["IWMSyncReader","IID_IWMSyncReader","9397F121-7705-4DC9-B049-98B698188414"]},{"entry":["IWMVideoMediaProps","IID_IWMVideoMediaProps","96406BCF-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMWriter","IID_IWMWriter","96406BD4-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMWriterAdvanced","IID_IWMWriterAdvanced","96406BE3-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMWriterAdvanced2","IID_IWMWriterAdvanced2","962DC1EC-C046-4DB8-9CC7-26CEAE500817"]},{"entry":["IWMWriterAdvanced3","IID_IWMWriterAdvanced3","2CD6492D-7C37-4E76-9D3B-59261183A22E"]},{"entry":["IWMWriterFileSink","IID_IWMWriterFileSink","96406BE5-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMWriterFileSink2","IID_IWMWriterFileSink2","14282BA7-4AEF-4205-8CE5-C229035A05BC"]},{"entry":["IWMWriterFileSink3","IID_IWMWriterFileSink3","3FEA4FEB-2945-47A7-A1DD-C53A8FC4C45C"]},{"entry":["IWMWriterFileSinkDataUnit","IID_IWMWriterFileSinkDataUnit","633392F0-BE5C-486B-A09C-10669C7A6C27"]},{"entry":["IWMWriterNetworkSink","IID_IWMWriterNetworkSink","96406BE7-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":["IWMWriterPostView","IID_IWMWriterPostView","81E20CE4-75EF-491A-8004-FC53C45BDC3E"]},{"entry":["IWMWriterPostViewCallback","IID_IWMWriterPostViewCallback","D9D6549D-A193-4F24-B308-03123D9B7F8D"]},{"entry":["IWMWriterPreprocess","IID_IWMWriterPreprocess","FC54A285-38C4-45B5-AA23-85B9F7CB424B"]},{"entry":["IWMWriterSink","IID_IWMWriterSink","96406BE4-2B2B-11D3-B36B-00C04F6108FF"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}}},"br":{}},"This SDK supports the following interfaces. For more information about which object each interface applies to, see Objects.",{"@attributes":{"id":"p-0173","num":"0190"},"tables":{"@attributes":{"id":"TABLE-US-00027","num":"00027"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"119pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Interface","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["INSSBuffer","Controls a buffer stored in a buffer"]},{"entry":[{},"object. This interface is used for passing"]},{"entry":[{},"samples to and from methods in this"]},{"entry":[{},"SDK."]},{"entry":["INSSBuffer3","Manages buffer properties. Buffer"]},{"entry":[{},"properties are used to convey"]},{"entry":[{},"information with a buffer when passed"]},{"entry":[{},"to or from methods of this SDK."]},{"entry":["IReferenceClock","Provides access to a standard reference"]},{"entry":[{},"clock."]},{"entry":["IWMBackupRestoreProps","Manages the properties required by the"]},{"entry":[{},"IWMLicenseBackup and"]},{"entry":[{},"IWMLicenseRestore interfaces."]},{"entry":["IWMBandwidthSharing","Manages the configuration of bandwidth"]},{"entry":[{},"sharing objects. Bandwidth sharing"]},{"entry":[{},"objects are created by profile objects to"]},{"entry":[{},"specify streams that, regardless of"]},{"entry":[{},"their individual bit rates, will never use"]},{"entry":[{},"more than a certain amount of"]},{"entry":[{},"bandwidth between them."]},{"entry":["IWMClientConnections","Manages the collecting of information"]},{"entry":[{},"about clients connected to a writer"]},{"entry":[{},"network sink object."]},{"entry":["IWMClientConnections2","Retrieves advanced client information."]},{"entry":["IWMCodecInfo","Manages information about the"]},{"entry":[{},"available codecs. This interface is used"]},{"entry":[{},"to retrieve the media formats"]},{"entry":[{},"supported by the codecs."]},{"entry":["IWMCodecInfo2","Provides access to the names of codecs"]},{"entry":[{},"and descriptions of their supported"]},{"entry":[{},"formats."]},{"entry":["IWMCodecInfo3","Reads the properties of codecs."]},{"entry":["IWMCredentialCallback","Provides a single method to acquire the"]},{"entry":[{},"credentials of users and check that they"]},{"entry":[{},"have permission to access a remote site."]},{"entry":["IWMDRMReader","Manages the acquisition of licenses,"]},{"entry":[{},"digital rights management (DRM)"]},{"entry":[{},"properties, and individualization of"]},{"entry":[{},"clients."]},{"entry":["IWMDRMReader2","Provides advanced DRM property"]},{"entry":[{},"access."]},{"entry":["IWMDRMWriter","Provides license creation capabilities"]},{"entry":[{},"from the writer object."]},{"entry":["IWMHeaderInfo","Manages header information, such as"]},{"entry":[{},"metadata, markers, and so on."]},{"entry":["IWMHeaderInfo2","Provides access to information about the"]},{"entry":[{},"codecs used to create the file."]},{"entry":["IWMHeaderInfo3","Provides attribute language support and"]},{"entry":[{},"other advanced metadata features."]},{"entry":["IWMIndexer","Manages indexing."]},{"entry":["IWMIndexer2","Provides frame-based indexing"]},{"entry":[{},"capabilities and adds configuration"]},{"entry":[{},"options to the indexing process."]},{"entry":["IWMInputMediaProps","Manages the properties of an input"]},{"entry":[{},"media stream."]},{"entry":["IWMIStreamProps","Reads the properties of an IStream"]},{"entry":[{},"object."]},{"entry":["IWMLanguageList","Manages the language list."]},{"entry":["IWMLicenseBackup","Manages the backing up of licenses,"]},{"entry":[{},"typically so that they can be restored"]},{"entry":[{},"onto another computer."]},{"entry":["IWMLicenseRestore","Manages the restoring of licenses."]},{"entry":["IWMMediaProps","Used as the base interface for the other"]},{"entry":[{},"media-properties interfaces (input,"]},{"entry":[{},"output, and video)."]},{"entry":["IWMMetadataEditor","Provides file management for metadata"]},{"entry":[{},"editing."]},{"entry":["IWMMetadataEditor2","Provides an improved method for"]},{"entry":[{},"opening files for use by the metadata"]},{"entry":[{},"editor."]},{"entry":["IWMMutualExclusion","Manages the configuration of mutual"]},{"entry":[{},"exclusion objects. Mutual exclusion"]},{"entry":[{},"objects are created by profile objects to"]},{"entry":[{},"specify a group of mutually exclusive"]},{"entry":[{},"streams."]},{"entry":["IWMMutualExclusion2","Extends the functionality of"]},{"entry":[{},"IWMMutualExclusion."]},{"entry":["IWMOutputMediaProps","Manages the properties of an output"]},{"entry":[{},"stream."]},{"entry":["IWMPacketSize","Manages the maximum size of packets"]},{"entry":[{},"in a WINDOWS\u2009\u00ae Media file."]},{"entry":["IWMPacketSize2","Manages the minimum size of packets"]},{"entry":[{},"in a WINDOWS\u2009\u00ae Media file."]},{"entry":["IWMProfile","Manages the creation and editing of"]},{"entry":[{},"profiles. Profiles describe the format of"]},{"entry":[{},"a file, such as stream type, bit rates, and"]},{"entry":[{},"so on. Most applications use existing"]},{"entry":[{},"profiles and do not need to implement"]},{"entry":[{},"this interface."]},{"entry":["IWMProfile2","Provides access to profile IDs."]},{"entry":["IWMProfile3","Provides methods for dealing with"]},{"entry":[{},"bandwidth sharing, stream"]},{"entry":[{},"prioritization, and other advanced"]},{"entry":[{},"features supported by profiles."]},{"entry":["IWMProfileManager","Manages the loading and saving of"]},{"entry":[{},"profiles."]},{"entry":["IWMProfileManager2","Manages the version numbers of system"]},{"entry":[{},"profiles used by the profile manager"]},{"entry":[{},"object."]},{"entry":["IWMProfileManagerLanguage","Manages the language of the"]},{"entry":[{},"enumerated system profiles."]},{"entry":["IWMPropertyVault","Provides a standardized interface for"]},{"entry":[{},"managing properties."]},{"entry":["IWMReader","Manages the asynchronous reading of"]},{"entry":[{},"WINDOWS\u2009\u00ae Media files."]},{"entry":["IWMReaderAccelerator","Provides support for DirectX\u2009\u00ae Video"]},{"entry":[{},"Acceleration."]},{"entry":["IWMReaderAdvanced","Provides advanced features of the"]},{"entry":[{},"reader, such as a user-provided clock,"]},{"entry":[{},"buffer allocation, return statistics, and"]},{"entry":[{},"receiving stream selection notifications."]},{"entry":["IWMReaderAdvanced2","Provides an additional range of"]},{"entry":[{},"advanced methods for an existing reader"]},{"entry":[{},"object."]},{"entry":["IWMReaderAdvanced3","Provides additional advanced methods"]},{"entry":[{},"for the reader object."]},{"entry":["IWMReaderAdvanced4","Provides support for language selection"]},{"entry":[{},"and other advanced reading features."]},{"entry":["IWMReaderAllocatorEx","Provides expanded alternatives to the"]},{"entry":[{},"AllocateForOutput and"]},{"entry":[{},"AllocateForStream methods of the"]},{"entry":[{},"IWMReaderCallbackAdvanced"]},{"entry":[{},"interface."]},{"entry":["IWMReaderCallback","Implemented by the application to"]},{"entry":[{},"provide sample and status information"]},{"entry":[{},"about a current reading operation."]},{"entry":["IWMReaderCallbackAdvanced","Optionally implemented by the"]},{"entry":[{},"application to provide advanced"]},{"entry":[{},"functionality to an existing reader"]},{"entry":[{},"callback object."]},{"entry":["IWMReaderNetworkConfig","Manages network configuration"]},{"entry":[{},"settings."]},{"entry":["IWMReaderNetworkConfig2","Provides additional network"]},{"entry":[{},"configuration features."]},{"entry":["IWMReaderStreamClock","Used to set and cancel timers on stream"]},{"entry":[{},"clocks, as well as to retrieve the current"]},{"entry":[{},"value of the stream clock."]},{"entry":["IWMReaderTimecode","Provides information about SMPTE"]},{"entry":[{},"time codes in a file."]},{"entry":["IWMReaderTypeNegotiation","Provides a single method that can be"]},{"entry":[{},"used to test whether certain changes to"]},{"entry":[{},"the output properties of a stream are"]},{"entry":[{},"working properly."]},{"entry":["IWMRegisterCallback","Manages the registration of callback"]},{"entry":[{},"functions."]},{"entry":["IWMStatusCallback","Implemented by the application to"]},{"entry":[{},"respond to the status of several objects"]},{"entry":[{},"of this SDK."]},{"entry":["IWMStreamConfig","Manages the configuration of streams"]},{"entry":[{},"for use in profiles."]},{"entry":["IWMStreamConfig2","Provides additional stream-manipulation"]},{"entry":[{},"methods."]},{"entry":["IWMStreamConfig3","Manages language information for"]},{"entry":[{},"streams."]},{"entry":["IWMStreamList","Manages the various objects that define"]},{"entry":[{},"relationships between streams."]},{"entry":["IWMStreamPrioritization","Provides methods to configure the"]},{"entry":[{},"stream prioritization object."]},{"entry":["IWMSyncReader","Provides the ability to read files with"]},{"entry":[{},"synchronous calls."]},{"entry":["IWMSyncReader2","Adds SMPTE time code support to the"]},{"entry":[{},"synchronous reader."]},{"entry":["IWMVideoMediaProps","Manages the properties of a video"]},{"entry":[{},"stream."]},{"entry":["IWMWatermarkInfo","Provides access to the available"]},{"entry":[{},"watermarks."]},{"entry":["IWMWriter","Used as the main interface for writing"]},{"entry":[{},"WINDOWS\u2009\u00ae Media files."]},{"entry":["IWMWriterAdvanced","Provides advanced functionality for an"]},{"entry":[{},"existing writer object."]},{"entry":["IWMWriterAdvanced2","Provides some advanced functionality,"]},{"entry":[{},"particularly for handling deinterlaced"]},{"entry":[{},"video."]},{"entry":["IWMWriterAdvanced3","Provides methods for detailed writer"]},{"entry":[{},"statistics."]},{"entry":["IWMWriterFileSink","Manages a file sink object."]},{"entry":["IWMWriterFileSink2","Provides extended management of a file"]},{"entry":[{},"sink object."]},{"entry":["IWMWriterFileSink3","Further extends the functionality of the"]},{"entry":[{},"file sink object."]},{"entry":["IWMWriterFileSinkDataUnit","Provides access to packet and payload"]},{"entry":[{},"information while writing a file."]},{"entry":["IWMWriterNetworkSink","Manages a network sink object."]},{"entry":["IWMWriterPostView","Manages the output of samples from the"]},{"entry":[{},"writer. Used to verify encoded content"]},{"entry":[{},"for a file during the encoding process."]},{"entry":["IWMWriterPostViewCallback","Implemented by the application to"]},{"entry":[{},"receive postview samples from the"]},{"entry":[{},"writer."]},{"entry":["IWMWriterPreprocess","Manages settings for multi-pass"]},{"entry":[{},"encoding."]},{"entry":["IWMWriterPushSink","Manages a push sink object."]},{"entry":["IWMWriterSink","Manages raw WINDOWS\u2009\u00ae Media"]},{"entry":[{},"Format input from the writer interfaces."]},{"entry":[{},"Used as a base interface for the other"]},{"entry":[{},"writer sink interfaces."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The interface identifier for each of the interfaces in this SDK is the name of the interface preceded by \u201cIID_\u201d. For example, the identifier for the IWMReaderAdvanced interface is IID_IWMReaderAdvanced. So to obtain a pointer to the IWMReaderAdvanced interface of a reader object, you would use the following code:","hr = pReader\u2212>QueryInterface(IID_IWMReaderAdvanced, &pReaderAdvanced);","Mutual Exclusion Objects","A mutual exclusion object is used to specify a number of streams, of which only one can be played at a time. This can be used in several ways, such as providing an audio stream in several languages as the soundtrack for one video stream.","Mutual exclusion is an optional part of a profile. Mutual exclusion objects may be created for existing mutual exclusion information in a profile or may be created empty, ready to receive new data. Mutual exclusion objects cannot exist independently of a profile object. In order to save the contents of a mutual exclusion object, you must call IWMProfile::AddMutualExclusion.","To create a mutual exclusion object, use one of the following methods.",{"@attributes":{"id":"p-0179","num":"0196"},"tables":{"@attributes":{"id":"TABLE-US-00028","num":"00028"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"133pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"84pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Method","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["IWMProfile::CreateNewMutualExclusion","Creates a mutual exclusion"]},{"entry":[{},"object without any data."]},{"entry":["IWMProfile::GetMutualExclusion","Creates a mutual exclusion"]},{"entry":[{},"object populated with data"]},{"entry":[{},"from a profile. Uses the"]},{"entry":[{},"mutual exclusion index to"]},{"entry":[{},"identify the desired mutual"]},{"entry":[{},"exclusion information."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}}},"Both methods in the preceding table set a pointer to an IWMMutualExclusion interface. The IWMStreamList interface is inherited by IWMBandwidthSharing and never needs to be accessed directly. The other interface of the mutual exclusion object can be obtained by calling the QueryInterface method.","The following interfaces are supported by every mutual exclusion object.",{"@attributes":{"id":"p-0182","num":"0199"},"tables":{"@attributes":{"id":"TABLE-US-00029","num":"00029"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"140pt","align":"left"}}],"thead":{"row":[{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}},{"entry":["Interface","Description"]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["IWMMutualExclusion","Provides methods to set and retrieve the type of"]},{"entry":[{},"mutual exclusion to be used."]},{"entry":["IWMMutualExclusion2","Provides additional configuration options for"]},{"entry":[{},"mutual exclusion."]},{"entry":["IWMStreamList","Manages the objects that define relationships"]},{"entry":[{},"between streams."]},{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}]}}}},"br":{}},"The reader object and the synchronous reader object both support IWMProfile, IWMProfile2, and IWMProfile3. You can also access mutual exclusion objects that are part of a file loaded into the reader."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0040","num":"0039"},"figref":"FIG. 1","sub":["V","A","F ","T ","F ","T "]},{"@attributes":{"id":"p-0041","num":"0040"},"figref":"FIG. 2","sub":["V","A","F ","T ","F ","T "]},{"@attributes":{"id":"p-0042","num":"0041"},"figref":["FIG. 3","FIG. 3"]},{"@attributes":{"id":"p-0043","num":"0042"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0044","num":"0043"},"figref":"FIG. 5"}]},"DETDESC":[{},{}]}
