---
title: Container format for multimedia presentations
abstract: In a method for transmitting a multimedia presentation comprising a number of media objects: the media objects are organized in a multimedia container or container format; identifiers referring to the media objects are organized in the same container; and an identifiable file coordinating the media objects is also provided in the container.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07979886&OS=07979886&RS=07979886
owner: Telefonaktiebolaget LM Ericsson (publ)
number: 07979886
owner_city: Stockholm
owner_country: SE
publication_date: 20041014
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"p":["This application claims priority to and benefit of U.S. Provisional Application No. 60\/511,694, filed 17 Oct. 2003. The entire content of this application is incorporated herein by reference in its entirety.","The present invention relates to media objects in general, specifically to multimedia presentations including coordinated media objects.","Multimedia can be of many different types, e.g. video, audio, still images, vector graphics. Typically, each kind of media has a native file format, depending on the format of the media, for storage in computer systems.","For multimedia, there also exist a large number of compression formats that utilize spatial and\/or temporal redundancies in order to obtain a compressed format of the media. A video file may, for instance, be compressed according to the H.263 compression standard [1], an audio clip as AMR [2] or AAC [3], and an image as JPEG [4].","There exist today a number of different methods for storing and\/or transmitting files in general, and more specifically media files. One known such method is to include the files in a so-called file container. Examples of such containers include TAR (Tape Archive) for UNIX systems and Zip-files. Although these can contain media files they lack control functions for presentations, synchronization with timed media, and the possibility to interleave media. Another known method is to include files as e-mail attachments, so-called multi-part MIME. Here it is possible to point at start location for a presentation, but otherwise the above limitations apply. There is also another kind of multimedia formats that don't store media files per se, but frame media content of certain media types. These formats lack the transparency and integrity of a container format that can store and recover media files. Examples of such multimedia formats include ASF (Advanced Streaming Format) and Flash.","The Third-Generation Partnership Project (3GPP) has standardized the 3GPP file format (3GP) [5] for carriage of timed multimedia (audio and video), based on the ISO base media file format [6]. It is used by the so called Multimedia Messaging Service (MMS) and the transparent end-to-end packet switched streaming service (PSS) for distribution of multimedia [9]. Moreover, streaming servers for serving streamed media can use 3GP files.","An object of the present invention is to enable improved transmission of multimedia presentations.","In particular, it is desirable to enable improved transmission of multimedia presentations including different file formats.","It is a specific object of the present invention to provide a solution for container formats for full media presentations including e.g. start point, discrete media objects and continuous media tracks, storing MIME types and having the possibility of compression of individual media objects.","It is another specific object of the present invention to provide a container that can store media objects interleaved by splitting media objects into multiple fragments that are interleaved.","It is yet another specific object of the present invention to provide a solution enabling progressive download of mixed media objects including both continuous media tracks (e.g. audio and video) and\/or discrete files (individual images).","It is yet another specific object of the present invention to provide a solution for encryption using the new container format and a Protection information box.","It is yet another specific object of the present invention to provide a solution including information for decryption of individual files, media tracks, the full data box (\u201cmdat\u201d) or parts thereof.","Embodiment(s) of the present invention enables combining all kinds of media types in one kind of file, such as 3GP. The embodiment(s) enable(s) doing this in a transparent way preserving the addressing, filename, and MIME types of individual media objects after they have been contained in the 3GP file.","The embodiment(s) also enable(s) interleaving all media in a container file such that it can be progressively downloaded to a user, i.e. downloaded in a format so that it can be rendered, with some delay, during the download. This is extended by information about initial delays depending on transport bit rate, represented as pairs. For bit rates in between the specified values, an upper estimate for the initial download delay can be obtained by linear interpolation. Another feature is the possibility of compressing individual files using e.g. gzip.","Some of the advantages include:","a container format that is simple and convenient (only one file to transport and play);","a container format that is optimized for short delay\/progressive download (all media can be interleaved);","a container format that re-uses present technology (ISO based media file format and 3GP file format, SMIL, media types);","a container format which can be used with different media types.","The present invention will be described in the context of extending the prior art 3GPP file format (3GP) to a general container format for multimedia presentations. The invention may, however, be embodied in many different forms and should not be construed as limited to the examples and embodiments set forth herein. Rather, these examples and embodiments are provided so that this disclosure will be thorough, and will convey the invention to those skilled in the art.","It should be understood that the file format(s) may be represented in a storage medium such as a computer memory, or in a physical signal such as an electrical signal or a radio signal, e.g. for transfer within a local system or for transmission over a local or global network. In the following, the term file or media object will be used throughout the disclosure with a meaning including both data files for storage in a storage medium and signals for transfer or distribution.","Conventionally, the scope of the 3GP file format has been to carry timed multimedia (video, audio and timed text) and streaming hints of such media. 3GP files are used for","interchange of video clips with associated audio (MMS)","download of timed text (PSS)","delivery of audio-visual presentations via progressive download (PSS)","serving audio-visual RTP streaming sessions (PSS)","delivery from content creators to streaming servers of streaming sessions (PSS).","The common denominator in the conventional art is that the content of a 3GP file is timed\u2014a 3GP file contains one or more parallel tracks of timed multimedia or hints. Each track is divided into individually accessible time units that make synchronization and random access feasible. Of all the media types that can constitute a presentation in MSS or a session in PSS, 3GP files can only early audio, video and timed text.","The problem of handling several files or media objects for e.g. a presentation or progressive download of such a presentation includes:\n\n","In addition to multimedia that is carried by 3GP files there are a number of media types in PSS that are stored in their native file formats: still images (JPEG), bitmap graphics (GIF and PNG), vector graphics (SVG), synthetic audio (SP-MIDI) and text (XHTML and SMIL). As only audio and video are streamed in a PSS session, these media types must be delivered file-by-file via HTTP to a PSS client in conventional art.","If a progressively downloadable file is a part of the presentation, e.g. a progressively downloadable SVG file, such a file can be split and interleaved with other tracks or files of long duration.","An encryption mechanism is also needed that can reveal the content types \u201cin the clear\u201d for encoded content.","In an aspect, the embodiment(s) present invention defines a container format for multimedia presentations, whereby an entire multimedia presentation including media objects such as static media files and\/or dynamic media streams and an identifiable scene description file can be transmitted and stored as one unit.","According to a specific embodiment of the present invention, the container format is an interleaved unit, which is optimized for progressive download. Thereby, an entire multimedia presentation can be transmitted and downloaded by so-called progressive download or streaming.","The embodiment(s)enable(s) an extension of the currently existing 3GPP file format (3GP) to a general container format for multimedia presentations, see FIG. I and . An extended 3GP file or container according to an embodiment of the present invention is not limited to contain only continuous or timed multimedia, but can also include a scene description file (e.g. SMIL) and static media (images, graphics). Any kind of multimedia used in MMS and PSS can in principal be stored as a binary file within an extended 3GP file.","The invention will be described in the context of the general communication system illustrated in , but is not limited to this specific illustration. The unit MMP MANAGER referred to as the MultiMediaPresentation manager, provides the functionalities according to the invention, such as organizing media object constituting a multimedia presentation as one unit for e.g. transmission, storage or display of the entire multimedia presentation.","Referring to , an example method for transmitting a multimedia presentation comprising a number of media objects comprises packaging or organizing, in a first step S, the media objects in a multimedia container or container format. In order to enable locating the media objects, a number of corresponding identifiers or locators are organized, in step S, in the same container. Subsequently, in order to define the framework of the multimedia presentation, a so-called scene description file coordinating the media objects is provided, in step S, in the same multimedia container. Finally, the entire container with the incorporated or included multimedia presentation is transmitted, in step S, to some receiving unit.","The scene description should be clearly identifiable such that a receiving unit will be able to locate the scene description file as a starting position or starting file.","By the method, it is possible to package an entire multimedia presentation into one container, which then can be transmitted and\/or downloaded as one unit or file from a transmitting unit Tx.","It is possible to apply progressive download, i.e. a receiving unit Rx can initialize rendering of received parts of the presentation while remaining parts are still being transmitted, so called Progressive Download.","The media objects can comprise media files, e.g. JPEG, GIF, SVG, PNG, SP-MIDI, XHTML, SMIL, and 3GP.","The media files can comprise dynamic media objects contained in tracks, e.g. video, audio and timed text.","The scene description file can be formatted according to any suitable standard e.g. any one of SMIL, XHTML, and SVG.","Yet another embodiment includes organizing both static media files and\/or dynamic media streams in the same container.","According to a further specific embodiment, the media objects are organized as interleaved continuous fragments of data in the multimedia container. Other terms for fragments comprise parts, extents, and chunks.","Throughout the description the terms static, binary and discrete media files will be used interchangeably without limiting the scope of the media files to be of a certain kind.","In order to enable a receiving unit Rx to utilize progressive download, an embodiment of a method comprises the step S of providing control information enabling the rendering. The control information can include parameters such as initial or buffer delay based on a predetermined download rate.","In order to enable the inclusion of encrypted media files in the new container, an embodiment comprises the step S of providing key information for decryption or recognition of the manner of encryption of the encrypted media files.","Similarly, also with reference to , the steps S-S represent an embodiment of a method for managing multimedia presentations. The method is closely related to the method for transmission, but without the step of transmission. The term managing is used in order to represent actions such as transmitting, storing, encrypting etc., but can also be regarded as a preparation of the media objects and associated information for such actions.","Since an entire multimedia presentation is contained in one file or container, it is very easy to store the presentation at some for storage facility. Similarly, it is easy to move the container e.g. from one part of a system to another or to distribute the container to a plurality of users.","The extension, according to an embodiment of the invention, of the 3GP file format typically comprises including a top-level file tree within the 3GP file. In this way a PSS presentation composed of several files, e.g. a SMIL file, an audio track and some images, can be packaged within a single 3GP file. The whole multimedia presentation can then be delivered, for example to a client via (progressive) download as one entity and played locally. Moreover, the extended 3GP format can be used to contain and deliver a complete PSS session as one entity to a PSS server. The server can then read the extended 3GP file and deliver the SMIL file and the images over HTTP and stream the audio track over RTP to the client.","The packaging or organizing of binary files, according to the invention, into a 3GP file can be designed to preserve the directory structure of the binary files, such that the relationships between the files are the same for separate files and the extended 3GP file. However, once binary files have been included in a 3GP file there is no need to unpack them in order to play or serve the content. All contained files are referenced in the same fashion from within or from the outside of the 3GP file.","The binary files or static media files are normally not contained in usual tracks, which are designed for timed multimedia, but referred to by identifiers in a file tree at the top level of a 3GP file. However, the included files themselves can be interleaved with the usual tracks such that the entire 3GP file can be used for progressive download.","An arrangement  for transmitting multimedia presentations according to an embodiment of the invention will be described with reference to .","The arrangement  comprises a unit  for organizing a number of media objects of a multimedia presentation in a multimedia container. Further, the arrangement  typically includes some a unit  for organizing identifiers that refer to the organized media objects in the same multimedia container. Also, the arrangement comprises a unit  for providing the container with an identifiable scene description file that coordinates the media objects based on the identifiers Finally, the arrangement  includes a unit  for transmitting the container with the incorporated multimedia presentation. In this particular embodiment, the transmitting unit  is represented by an I\/O-unit.","The media objects can include both binary media files (e.g. MPEG, SVG, PNG, SP-MIDI, XHTML, SMIL, 3GP, JPEG, GIF) and\/or dynamic media objects or streams (e.g. audio, video, timed text) contained in tracks.","In a specific embodiment of the invention, the media organizer  is configured or adapted to organize the media objects as interleaved continuous fragments of data. Other names for fragments comprise parts, extents and chunks.","According to another specific embodiment, the arrangement comprises means for providing control information that enables a receiving unit Rx to use progressive download when receiving the container, i.e. the receiving unit Rx can render or display or execute parts of the content of the multimedia presentation while still downloading remaining parts. Some of the control information can include, but is not limited to, initial or buffer delay based on some predetermined download rate.","Extending the 3GP file format, according to an embodiment, allows self-contained multimedia presentations comprising of a scene description, audio, video and other media types to be stored in one file. An extended 3GP file can thus contain a complete presentation, which makes it much easier to transport and store than several files with dependencies. Moreover, since all media in such a file can be interleaved, it will be particularly useful for progressive download. An extended 3GP file containing a mixed multimedia presentation can be","progressively downloaded (and simultaneously played) on a client (PSS),","locally played after delivery (PSS and MMS), and","serve as a general distribution format of multimedia presentations (MBMS).","Moreover, a complete PSS session with hint tracks for RTP streaming as well as media files for RI FP download can be contained in an extended GP file. It will be conceptually simpler to distribute one file per session and use one file as source for both streaming and download during a session. Extended server files can be","delivered to operators from content creators,","used by PSS servers for streaming (tracks) and HTIP-delivery (media files).","Note that, also 3GP files can be included as binary files within extended 3GP files. For instance, a 3GP file containing a PSS session for serving audio and Timed text [] includes an RTP hint track for audio and a separate 3GP file for Timed text. The reason is that Timed text is not streamed but delivered via HTTP in PSS Release 5.","An embodiment of a multimedia container will be described with reference to .","The multimedia container  includes a number of media objects, identifiers or locators referring to the media objects, and a scene description file coordinating the media objects based on the identifiers.","According to a specific embodiment, both static media files and\/or dynamic media objects contained in tracks can be included the multimedia container . The media objects can be included as one or more interleaved continuous fragments of data or included in their native format.","According to another specific embodiment, referring to , the identifiers referring to dynamic media objects are located in a first section  of the container and the identifiers referring to static media files are located in a second section  of the container. The interleaved media objects (both static and dynamic) are located in a third section of the container. The actual order of the sections is not limited to this embodiment. In addition, the scene description file is preferably treated as a static or binary media file and as such included in the second section  of the container . However, the individual order of the sections in the multimedia container is not reflected by this embodiment.","Another specific embodiment of a multimedia container will be described with reference to  and .","In this embodiment, the first section  is represented by the movie box moov, the second section  is represented by the file tree box ftre, and the third section  is represented by the media data box mdat. In addition, the container , according to an embodiment, comprises a file type box ftyp including information regarding the container format type.","The extensions to 3GP, according to an embodiment, include a new profile brand for file trees, a file directory structure and rules on addressing files within an extended 3GP file.","The File-directory profile (branded \u20183gd6\u2019) is defined for 3GP files that include a file directory. Files conforming to the File-directory profile shall include a File tree with one or more file entries. One of these may be a start file, i.e. contain a scene description for the presentation or streaming session.","According to an embodiment of the container both static media files and dynamic media objects contained in tracks are included in the container. The File-directory profile can be used in combination with other 3GP profiles, as long as the file conforms to those profiles. In particular,\n\n","Among the binary files included in a server file, one may include a scene description (SMIL, HTML) for the PSS session. Additional files may be part of the session, i.e. images, SP-MIDI, Timed text, etc.","The embodiment(s) be described in more detail with reference to a specific and illustrative example.","According to another embodiment of a container, the container only includes static media files. In addition to adding a file directory to a 3GP file with tracks, the File-directory profile can be used for files that only contain a file directory and no tracks (no movie box), in other words, static or binary media files. Such 3GP files would be very useful for making self-contained presentations that don't necessarily include continuous media carried by tracks. Examples include slide shows for local play out or PSS sessions based on images, synthetic audio or text.","The File-directory profile is a 3GP profile and should be used with the file extension \u20180.3gp\u2019.","File Tree","A file directory for storage of binary files is normally included at the top level of an extended 3GP file. The tree looks like a normal directory and can include any type of binary file and\/or sub directories. The file directory is stored as meta-data in the File-tree box, whereas the binary content of the included files is stored as chunks in the Media-data box \u2018mdat\u2019 of the containing file.","An example of a file tree is shown in , corresponding to the file entries in . The following sections explain the function of each box in .","The File-tree box \u2018ftre\u2019 is a container box. It is a top-level box and shall be located after the File-type box \u2018ftyp\u2019 in a 3GP file and preferably before the Movie box \u2018moov\u2019. (See ) In order to allow for future revisions, the File-tree box is based on a so-called Full box with version number, as shown in Table 1.",{"@attributes":{"id":"p-0095","num":"0103"},"tables":{"@attributes":{"id":"TABLE-US-00001","num":"00001"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 1"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"FileTreeBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018ftre\u2019"]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)",{},{}]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},{},{},"Contained boxes"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"The File-tree box defines the root level of the 3GP file tree. A hierarchy of Directory boxes \u2018diry\u2019 defines lower levels of the file tree. Directory boxes according to Table 2 below are contained in the File-tree box or other Directory boxes.",{"@attributes":{"id":"p-0097","num":"0105"},"tables":{"@attributes":{"id":"TABLE-US-00002","num":"00002"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 2"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"DirectoryBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018diry\u2019"]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)",{},{}]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},{},{},"Contained boxes"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"Each directory box can be required to contain one Directory-name box \u2018dirn\u2019 according to Table 3:",{"@attributes":{"id":"p-0099","num":"0107"},"tables":{"@attributes":{"id":"TABLE-US-00003","num":"00003"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 3"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"DirectoryNameBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018dirn\u2019"]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)",{},{}]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},"DirectoryName","String","Directory name"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"Directory name is a null-terminated string in UTF-8 characters with the name of the directory.","File entry","A file in the file tree is defined by a File-entry box \u2018fent\u2019, that can be stored at any level in the file tree, including the root level. The File entry box is a container box and is defined below in Table 4.",{"@attributes":{"id":"p-0102","num":"0110"},"tables":{"@attributes":{"id":"TABLE-US-00004","num":"00004"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 4"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"FileEntryBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018fent\u2019"]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)",{},{}]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["FileInfoBox",{},"File name and MIME",{}]},{"entry":[{},{},"type",{}]},{"entry":["ChunkInfoBox",{},"Location of file as a",{}]},{"entry":[{},{},"chunk",{}]},{"entry":[{},{},"Optional boxes"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"Each File entry box is preferred to include a File-info box \u2018finf\u2019 and a Chunk-info box \u2018chin\u2019, as defined below in Table 5 and Table 6.",{"@attributes":{"id":"p-0104","num":"0112"},"tables":{"@attributes":{"id":"TABLE-US-00005","num":"00005"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 5"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"FileInfoBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018finf\u2019"]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)",{},{}]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["FileName","String","File name including",{}]},{"entry":[{},{},"extension",{}]},{"entry":["ContentType","String","MIME type",{}]},{"entry":["ContentEncoding","String","Optional, indicates if",{}]},{"entry":[{},{},"the stored file is",{}]},{"entry":[{},{},"encoded"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"File name and Content type can be null-terminated strings in UTF-8 characters. Content type should be the MIME type for the file. Content encoding is an optional null-terminated string used to indicate that the file stored within the 3GP file is encoded, and needs to be decoded before interpreted, similar to Content-Encoding for HTTP 1.1. Some possible values are \u201cgzip\u201d, \u201ccompress\u201d, \u201cdeflate\u201d, but for interoperability reasons, the only entry to be used is referred by \u201cgzip\u201d.",{"@attributes":{"id":"p-0106","num":"0114"},"tables":{"@attributes":{"id":"TABLE-US-00006","num":"00006"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 6"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"ChunkInfoBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"98pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018chin\u2019"]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)",{},{}]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["[ChunkOffset, ChunkSize]\u00d7N","Unsigned","Position and",{}]},{"entry":[{},"int(64)[2\u00d7N]","length of",{}]},{"entry":[{},{},"file chunk"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"The actual content of an included file can be stored as one or more continuous fragments (i.e. chunks, extents) of data in the media-data box \u2018mdat\u2019. ChunkOffset is a 64 bit integer that gives the offset of the start of the chunk into the containing 3GP file and ChunkSize is a 64 bit integer that gives the size of the chunk, i.e. the length of the file defined by the File-entry box. Note that the chunk offset always refers to the containing file, i.e. the 3GP file. We have refrained from using a Data-reference box to indicate possible external locations of the data, as the point of including binary files in a 3GP file is to have a self-contained file.","In principle any type of file can be contained in the file tree. For PSS, the following media files are likely to be used: still images (JPEG), bitmap graphics (GIF and PNG), vector graphics (SVG), and synthetic audio (SP-MIDI), text (XHTML and SMIL), and 3GP files carrying Timed text. Any new kind of media file adopted for PSS, would also be possible to store in the file tree. This would for instance include DLS (down-loadable sound).","Start Location","An extended 3GP file may contain a scene description located anywhere in the file tree. If it is present, the File-tree box is preferred to contain a StartLocationBox according to Table 7.",{"@attributes":{"id":"p-0110","num":"0118"},"tables":{"@attributes":{"id":"TABLE-US-00007","num":"00007"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 7"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"StartLocationBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"5","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018sloc\u2019"]},{"entry":[{},{},"int(32)",{},{}]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)",{},{}]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},"StartFileLocation","String","File path relative",{}]},{"entry":[{},{},{},"root level"]},{"entry":{"@attributes":{"namest":"1","nameend":"5","align":"center","rowsep":"1"}}}]}}]}}},"StartFileLocation can be a null-terminated string in UTF-8 characters containing the path to the start file in the file directory, relative to the top level. As an example, to indicate that a file stored at the top level (in the file tree box) is a scene description, StartFileLocation would just contain the file name, e.g. start.smil.","Information on Progressive Download","An extended 3GP file may contain one Progressive-download information box \u2018pdin\u2019 located in the File-tree box, as defined below in Table 8:",{"@attributes":{"id":"p-0113","num":"0121"},"tables":{"@attributes":{"id":"TABLE-US-00008","num":"00008"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 8"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"ProgressiveDownloadInfoBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018pdin\u2019"]},{"entry":[{},"int(32)",{},{}]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)",{},{}]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["[Rate, InitialDelay]\u00d7N","Unsigned","Pairs of bit rate and",{}]},{"entry":[{},"int(32)[2\u00d7N]","initial delay"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"This box can contain N pairs of numbers (to the end of the box) specifying combinations of transport bandwidth in units of 100 bits\/sec and initial download delay in units of ms. By using this information, the receiving party can obtain an upper estimate for the initial delay by linear interpolation between pairs.","Addressing","Files and tracks within a 3GP file can be addressed consistently within the 3GP file as well as from the outside. The file directory and all tracks of a 3GP file reside at the top level, e.g. example.3gp\/toplevelfile.smil and example.3gp\/trackID=2.","As an example of addressing within a 3GP file, consider the multimedia container show.3gp outlined in . It contains\n\n","The scene description in the SMIL file, located at the top level of the 3GP file, would refer to the media files in  as follows:\n\n","From outside the content of the 3GP file, according to an embodiment, is addressed as follows:\n\n","Now consider moving the SMIL file in the previous example to the directory img containing the images. Relative to the SMIL file, the media is now referred as follows:\n\n","From outside the content of the 3GP file would now be addressed as follows:\n\n","Files contained in the file tree may be delivered over HTTP before or during a PSS session. An HTTP server delivering a binary file stored inside a 3GP file shall\n\n","As an example, the 3GP file in  with hint tracks included may contain a PSS session. When the client accesses the SMIL file over HTTP, it also receives the Content-Location of the SMIL file, e.g. \u201chttp:\/\/mediaportal\/show.3gp\/\u201d. All HTTP references within the SMIL file will then be based upon the Content-Location, enabling HTTP GET to refer to binary files within the 3GP file.","A client can in the same manner resolve the URIs for RTSP based on the Content-Location of the SMIL file, enabling RTSP DESCRIBE to refer to the 3GP file and, RTSP SETUP to refer to tracks.","Example: Retrieval of SMIL File and Resolving URI to Resources Pointed Out within the SMIL File",{"@attributes":{"id":"p-0124","num":"0156"},"tables":{"@attributes":{"id":"TABLE-US-00009","num":"00009"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"175pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"right"}}],"thead":{"row":{"entry":{"@attributes":{"namest":"1","nameend":"2","align":"center","rowsep":"1"}}}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["GET \u2003\u2003\u2003\u2003\/exampledir\/show.3gp\/img\/start.smil","HTTP\/1.1"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"Host: www.example.com"}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"189pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"28pt","align":"right"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["HTTP\/1.1 \u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003200","OK"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"Content-Location:"},{"entry":"http:\/\/www.example.com\/exampledir\/show.3gp\/img\/start.smil"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"182pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"35pt","align":"right"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["Content-Size:","xxxxxx"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"2"},"colspec":[{"@attributes":{"colname":"1","colwidth":"154pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"63pt","align":"right"}}],"tbody":{"@attributes":{"valign":"top"},"row":{"entry":["Content-Type:","application\/smil"]}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"<smil>"},{"entry":"\u2003<body>"},{"entry":"\u2003\u2003<seq>"},{"entry":"\u2003\u2003\u2003<image src=\u201ccat.jpg\u201d dur=\u201c3s\u201d\/>"},{"entry":"\u2003\u2003\u2003<image src=\u201cdog.jpg\u201d dur=\u201c5s\u201d\/>"},{"entry":"\u2003\u2003<\/seq>"},{"entry":"\u2003<\/body>"},{"entry":"<\/smil>"},{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}}]}}]}}},"The above fetched SMIL presentation will thus be given the base URI:\n\n","Conventionally, it is possible to extend the 3GP file format with a mechanism for storage of encrypted media. In addition 3GPP-specific extensions that apply to encryption of text tracks and a 3GP profile brand for encrypted 3GP files are defined. Details on the encryption scheme are stored in a protection information box. For the usage of encrypted GP files with OMA DRM ver 2, the exact details of the scheme will be defined by OMA.","The general idea behind the extensions is to replace code points (codec identifiers) of encrypted media with generic code points for encrypted media. This prevents legacy players and other encryption-unaware players from accessing bit streams that need to be decrypted before they can be decoded. For encryption-aware players, however, the new code points contain information on key management and requirements for decrypting encrypted media. In addition they replicate the original codec identifier and other decoding parameters needed to decode the bit streams once they have been decrypted.","Encrypted 3GP files can also be used for streaming servers to serve encrypted media over RTP. Hint tracks of such 3GP files are not encrypted per se, i.e. a PSS server does not have to decrypt anything in order to serve the encrypted content. Information on key management and decryption is conveyed to the client in the SDP description, with the relevant parts stored in the hint track of the 3GP file. However, as the content provider may want to force the server to take certain actions, such as providing integrity protection before data is streamed; there is still a need to redefine the code point for hint tracks as well. The new code points replicate the original code point information while providing information on required integrity protection. This way encryption-unaware servers will be prevented to serve encrypted data that were supposed to be integrity prevented.","Profile for Encrypted 3GP Files","One way to signal encrypted media in a 3GP file is to define and use an Encryption profile (branded \u20183ge6\u2019) Further details on the kind of file that is encrypted is given by other brands, such as a Basic profile brand for download of audio\/video presentations or Streaming-server profile for serving of encrypted content.","Files conforming to Encryption profile shall use the encrypted-sample description entries (code points) for media tracks containing encrypted media. A file conforming to Encryption profile may contain both encrypted and unencrypted tracks, but not if they are of the same media type.","The Encryption profile should be used as a major brand. It can also be used in combination with other 3GP profiles, as long as the file conforms to those profiles.","In particular,\n\n","Note that the General profile is defined as a superset of all profiles including Encryption profile. A 3GP file conforming to General profile (only) may contain any number of encrypted tracks not yet combined into 3GP files suitable for download or streaming or without necessary information on key management.","The Encrypted-basic profile is a 3GP profile and should be used with the file extension \u20180.3gp\u2019.","Code Points for Encrypted Media","The sample description entries of a media track in a 3GP file identify the format of the encoded media, i.e. codec and other coding parameters. Hence, by simply parsing the sample descriptions, a player can decide which tracks it is able to play.","All sample entries for audio and video derived from the ISO base media file format contain a set of mandatory fields. In addition, they may contain boxes specific to the codec in question. MPEG-4 codecs (Visual and AAC) use the ESDBox, whereas AMR and H.263 use the AMRSpecificBox and the H263SpecificBox, respectively.","The principle behind storing encrypted media in a track is to \u201cdisguise\u201d the original sample description entry with a generic code point for encrypted media. We define three code points (four-character codes of the sample description entries) for signalling encrypted video, audio and text as follows in Table 9:",{"@attributes":{"id":"p-0138","num":"0176"},"tables":{"@attributes":{"id":"TABLE-US-00010","num":"00010"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 9"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"Code points"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"105pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"format","original",{}]},{"entry":[{},"identifier","format","media content"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":[{},"encv","s263, mp4v","encrypted video: H.263 or"]},{"entry":[{},{},{},"MPEG-4 visual"]},{"entry":[{},"enca","samr, sawb,","encrypted audio: AMR, AMR-"]},{"entry":[{},{},"mp4a","WB or AAC"]},{"entry":[{},"enct","3gtt","encrypted text: timed text"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"The \u201cencrypted\u201d versions of the sample descriptions replicate the original sample descriptions and include a protection information box with details on the original format as well as all requirements for decrypting the encoded media. The EncryptedVideoSampleEntry and the EncryptedAudioSampleEntry are defined in Table 10 and Table 11, where TheProtectionInfo box is simply added to the list of boxes contained in a sample entry.",{"@attributes":{"id":"p-0140","num":"0178"},"tables":{"@attributes":{"id":"TABLE-US-00011","num":"00011"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 10"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EncryptedVideoSampleEntry"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned int(32)",{},"\u2018encv\u2019"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"All fields and boxes of a visual sample entry, e.g. MP4VisualSampleEntry"},{"entry":"or H.263SampleEntry."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ProtectionInfoBox",{},"Box with information",{}]},{"entry":[{},{},"on the original format",{}]},{"entry":[{},{},"and encryption"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0141","num":"0179"},"tables":{"@attributes":{"id":"TABLE-US-00012","num":"00012"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 11"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EncryptedAudioSampleEntry"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned int(32)",{},"\u2018enca\u2019"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":"All fields and boxes in an audio sample entry, e.g. MP4AudioSampleEntry"},{"entry":"or AMRSampleEntry."}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ProtectionInfoBox",{},"Box with information"]},{"entry":[{},{},"on the original format"]},{"entry":[{},{},"and encryption"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}}},"The EncryptedTextSampleEntry is defined in Table . Text tracks are specific to 3GP files and defined by the Timed text format in 26.245. In analogy with the cases for audio and video, we add a ProtectionInfoBox at the end.",{"@attributes":{"id":"p-0143","num":"0181"},"tables":{"@attributes":{"id":"TABLE-US-00013","num":"00013"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 12"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"EncryptedTextSampleEntry"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned int(32)",{},{}]},{"entry":["BoxHeader.Type","Unsigned int(32)",{},"\u2018enct\u2019"]}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"left"}},"tbody":{"@attributes":{"valign":"top"},"row":{"entry":"All fields and boxes of TextSampleEntry."}}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"3"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"98pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["ProtectionInfoBox",{},"Box with information"]},{"entry":[{},{},"on the original format"]},{"entry":[{},{},"and encryption"]},{"entry":{"@attributes":{"namest":"1","nameend":"3","align":"center","rowsep":"1"}}}]}}]}},"br":{}},"The necessary requirements for decrypting media are stored in the Protection information box. It contains the Original format box, which identifies the codec of the decrypted media, the Scheme type box, which identifies the protection scheme used to protect the media, and the Scheme information box, which contains scheme-specific data (defined for each scheme). The protection information box and its contained boxes are defined in Table 13-Table 16.",{"@attributes":{"id":"p-0145","num":"0183"},"tables":{"@attributes":{"id":"TABLE-US-00014","num":"00014"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 13"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"ProtectionInfoBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"77pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018sinf\u2019"]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)"]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["OriginalFormatBox",{},"Box containing"]},{"entry":[{},{},"identifying the original"]},{"entry":[{},{},"format"]},{"entry":["SchemeTypeBox",{},"Box containing the"]},{"entry":[{},{},"protection scheme."]},{"entry":["SchemeInformationBox",{},"Box containing the"]},{"entry":[{},{},"scheme information."]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},{"@attributes":{"id":"p-0146","num":"0184"},"tables":{"@attributes":{"id":"TABLE-US-00015","num":"00015"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 14"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"OriginalFormatBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)"]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018frma\u2019"]},{"entry":[{},{},"int(32)"]},{"entry":[{},"DataFormat","Unsigned","orginal format"]},{"entry":[{},{},"int(32)"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},"DataFormat identifies the format (codec) of the decrypted, encoded data. The currently defined formats in 3GP files include \u2018mp4v\u2019, \u2018h263\u2019, \u2018mp4a\u2019, \u2018samr\u2019, sawb\u2019 and \u20183gtt\u2019.",{"@attributes":{"id":"p-0148","num":"0186"},"tables":{"@attributes":{"id":"TABLE-US-00016","num":"00016"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 15"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"SchemeTypeBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018schm\u2019"]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)"]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0 or 1"]},{"entry":["SchemeType","Unsigned","4cc identifying the"]},{"entry":[{},"int(32)","scheme"]},{"entry":["SchemeVersion","Unsigned","Version number"]},{"entry":[{},"int(16)"]},{"entry":["SchemeURI","Unsigned","Browser URI (null-"]},{"entry":[{},"int(8)[ ]","terminated UTF-8"]},{"entry":[{},{},"string). Present if"]},{"entry":[{},{},"(Flags & 1) true"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}}},"SchemeType and SchemeVersion identify the encryption scheme and its version. An example that can be used for OMA DRM is given in the following section. As an option, it is possible to include an URI pointing to a web page for users that don't have the encryption scheme installed.",{"@attributes":{"id":"p-0150","num":"0188"},"tables":{"@attributes":{"id":"TABLE-US-00017","num":"00017"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 16"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"SchemeInformationBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"28pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)"]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018schi\u2019"]},{"entry":[{},{},"int(32)"]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)"]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},{},{},"Box(es) specific to"]},{"entry":[{},{},{},"scheme identified by"]},{"entry":[{},{},{},"SchemeType"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},"The boxes contained the SchemeInformationBox are defined by the scheme type.","Example of Encryption Scheme","The encryption scheme to be used by OMA is currently developed by OMA DLDRM. As the scheme will be defined by OMA, OMA should also define the file format boxes expressing the scheme in 3GP files. Below is an example of how such a definition may look like:\n\n","Scheme-specific boxes: OMADRMSampleFormatBox and OMADRMHeadersBox, see Table 17 and Table 18,",{"@attributes":{"id":"p-0154","num":"0194"},"tables":{"@attributes":{"id":"TABLE-US-00018","num":"00018"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 17"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"OMADRMSampleFormatBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"5"},"colspec":[{"@attributes":{"colname":"offset","colwidth":"14pt","align":"left"}},{"@attributes":{"colname":"1","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"42pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"56pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":[{},"Field","Type","Details","Value"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]},{"entry":[{},"BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},{},"int(32)"]},{"entry":[{},"BoxHeader.Type","Unsigned",{},"\u2018osfm\u2019"]},{"entry":[{},{},"int(32)"]},{"entry":[{},"BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},{},"int(8)"]},{"entry":[{},"BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":[{},"SelectiveEncryption","Bit(1)",{},"0 or 1"]},{"entry":[{},"Reserved","Bit(7)",{},"0"]},{"entry":[{},"KeyIndicatorLength","Unsigned","Length of key"]},{"entry":[{},{},"int(8)","indicator"]},{"entry":[{},"IVLength","Unsigned","Length of IV"]},{"entry":[{},{},"int(8)"]},{"entry":[{},{"@attributes":{"namest":"offset","nameend":"4","align":"center","rowsep":"1"}}]}]}}]}}},{"@attributes":{"id":"p-0155","num":"0195"},"tables":{"@attributes":{"id":"TABLE-US-00019","num":"00019"},"table":{"@attributes":{"frame":"none","colsep":"0","rowsep":"0"},"tgroup":[{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"1"},"colspec":{"@attributes":{"colname":"1","colwidth":"217pt","align":"center"}},"thead":{"row":{"entry":"TABLE 18"}},"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":{"@attributes":{"namest":"1","nameend":"1","align":"center","rowsep":"1"}}},{"entry":"OMADRMHeadersBox"}]}},{"@attributes":{"align":"left","colsep":"0","rowsep":"0","cols":"4"},"colspec":[{"@attributes":{"colname":"1","colwidth":"63pt","align":"left"}},{"@attributes":{"colname":"2","colwidth":"49pt","align":"left"}},{"@attributes":{"colname":"3","colwidth":"70pt","align":"left"}},{"@attributes":{"colname":"4","colwidth":"35pt","align":"left"}}],"tbody":{"@attributes":{"valign":"top"},"row":[{"entry":["Field","Type","Details","Value"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}},{"entry":["BoxHeader.Size","Unsigned",{},{}]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Type","Unsigned",{},"\u2018ohdr\u2019"]},{"entry":[{},"int(32)"]},{"entry":["BoxHeader.Version","Unsigned",{},"0"]},{"entry":[{},"int(8)"]},{"entry":["BoxHeader.Flags","Bit(24)",{},"0"]},{"entry":["CTLen","Unsigned","Length of fixed"]},{"entry":[{},"int(8)","headers (for"]},{"entry":[{},{},"performance reasons)"]},{"entry":["CIDLen","Unsigned","Length of Content ID"]},{"entry":[{},"int(8)"]},{"entry":["ContentType","Unsigned","Content Type header"]},{"entry":[{},"int(8)[CTLen]"]},{"entry":["ContentID","Unsigned","Content ID header"]},{"entry":[{},"int(8)[CIDLen]"]},{"entry":["Headers","Unsigned","Rest of headers,"]},{"entry":[{},"int(8) [ ]","including issuer URL,"]},{"entry":[{},{},"to end of box"]},{"entry":{"@attributes":{"namest":"1","nameend":"4","align":"center","rowsep":"1"}}}]}}]}},"br":{}},"PSS servers can also use 3GP files for streaming of encrypted media. The principle here is to packetize-then-encrypt. Conceptually, there is no difference between serving encrypted media and unencrypted media from a 3GP server file. In both cases, the PSS server can simply follow the hint instructions of the file. All the necessary information for using the streamed media is conveyed to the client via the SDP description. For encrypted media this also includes the requirements for decrypting the media streams.","Encryption","According to a specific embodiment of the present invention, it is possible to include encrypted media files in an extended 3GP file. Consequently, a solution for encryption and decryption using the container file format and the Protection information box will be described below.","By default, binary files are stored \u201cin the clear\u201d. However, it is also possible to include encrypted binary files in the file directory of a 3GP file. The presence of a Protection information box in a file entry box indicates that the content of the binary file (media data) is encrypted. Moreover, the Protection information box identifies the encryption scheme and all information required to decrypt the corresponding media data.","The Protection information box here is the same as the protection information box proposed for encrypted tracks in Table 13-Table 18. The definition is the same, although the Original-format box shall be ignored (should not be included) for binary files. Note that the purpose of the protection information box for binary files is two-fold: it indicates that media is encrypted and it gives the requirements for decrypting it.","The Protection information box \u2018sint\u2019 contains the Scheme type box \u2018schm\u2019, which identifies the protection scheme used to protect the media, and the Scheme information box \u2018schi\u2019, which contains scheme-specific data (defined for each scheme.","The boxes contained by the SchemeInformationBox are defined by the scheme type. Similarly, it is possible to define boxes that apply to the full \u2018mdat\u2019 or a byte range inside \u2018mdat\u2019. This could be good for a presentation with many small files.","According to the invention, the 3GP file format is extended to a general container format by inclusion of a file tree for binary files, comprising information such as their MIME types Any kind of multimedia used in MMS and PSS can thus be stored in a 3GP file together with a scene description The container format is constructed in such a way as to allow for progressive download of a whole multimedia presentation or session. Thereby, extended 3GP files can be delivered by download or progressive download, and played by 3GP players. Such extended 3GP files with hint tracks can contain entire PSS sessions and be served by PSS servers, where continues media is streamed via RTP and media files are delivered via HTTP.","3GP files that are extended according to the invention and contain a file tree may define a 3GP profile (brand). Files in the file tree can be stored \u201cin the clear\u201d or encrypted together with requirements on how to decrypt them.","For fragmented files, the full presentation is made into more than one fragment. The presentation will then be (progressively) downloadable fragment by fragment, where later fragments will enhance the previous ones with more files or media tracks or continuation of files or media tracks. It is also possible to have live download by sending the presentation fragment by fragment. For the overall presentation organization, having SMIL-files in several fragments, and a scheme for how to update, enhance or replace a SMIL file can do this.","Moreover, the invention relates to how the presentation can be combined with a scene description and how it can be used as a container format for mixed sessions where some media is streamed and other is downloaded.","It will be understood by those skilled in the art that various modifications and changes may be made to the present invention without departure from the scope thereof, which is defined by the appended claims.",{"@attributes":{"id":"p-0167","num":"0000"},"ul":{"@attributes":{"id":"ul0023","list-style":"none"},"li":["[1] ITU-T Recommendation H.263 (2001), ","[2] 3GPP TS 26.071","[3] ISO\/IEC 14496-2:2001-3(MPEG-4 part 3).","[4] ITU-T Recommendation T.81 (1992).","[5] 3GPP TS 26.244--(); 3(3).","[6] ISO\/IEC 14496-12:2003 | 15444-12:2003-122000 12","[7] U.S. Pat. No. 2003\/0053416 A1, Ribas-Corbera et al., Microsoft.","[9] 3GPP TS 26.234--(); "]}}],"BRFSUM":[{},{}],"heading":["TECHNICAL FIELD","BACKGROUND","SUMMARY","DETAILED DESCRIPTION","REFERENCES"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["The invention, together with further objects and advantages thereof, may best be understood by making reference to the following description taken together with the accompanying drawings, in which:",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":["FIG. 9","FIG. 8"]}]},"DETDESC":[{},{}]}
