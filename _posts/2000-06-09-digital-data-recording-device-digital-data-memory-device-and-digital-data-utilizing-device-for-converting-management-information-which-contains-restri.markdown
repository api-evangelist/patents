---
title: DIGITAL DATA RECORDING DEVICE, DIGITAL DATA MEMORY DEVICE, AND DIGITAL DATA UTILIZING DEVICE FOR CONVERTING MANAGEMENT INFORMATION WHICH CONTAINS RESTRICTIVE INFORMATION USING A DIFFERENT KEY IN EACH MANAGEMENT INFORMATION SEND/RECEIVE SESSION
abstract: In each digital content utilize session, a memory card generates conversion key information for specifying a data conversion, while a player generates inverse conversion key information for specifying an inverse data conversion. The memory card then performs the data conversion specified by the conversion key information on management information stored therein, and sends the converted management information and digital content stored therein to the player. The player performs the inverse data conversion specified by the inverse conversion key information on the converted management information to restore the management information, and utilizes the digital content in accordance with restrictions set in the restored management information to limit the use of the digital content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=06868404&OS=06868404&RS=06868404
owner: Matsushita Electric Industrial Co., Ltd.
number: 06868404
owner_city: Osaka-fu
owner_country: JP
publication_date: 20000609
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"p":["This application is based on applications Nos. H11-167897 and 2000-148962 filed in Japan, the contents of which are hereby incorporated by reference.","1. Field of the Invention","The present invention relates to devices for recording and utilizing digital data, and in particular relates to a technique for preventing unauthorized use of digital data.","2. Description of the Related Art","The digitization of information is increasing in recent years. Since digitized information (hereinafter, \u201cdigital content\u201d) is not only relatively easy to handle but also will not deteriorate with time, information such as audio and image data is becoming more and more digitized.","However, if digital content is copied, the copy will end up being precisely identical to the original. This provokes unauthorized acts such as illegal duplication or tampering of copyrighted information.","To discourage such unauthorized acts, a method is devised whereby storage mediums such as memory cards are respectively given unique numbers (hereinafter, \u201ccard IDs\u201d) so that each storage medium stores only digital content encrypted using its own card ID.","According to this method, even when digital content which has been encrypted with a card ID of some memory card and stored on the memory card is copied onto another memory card, the copy of the encrypted digital content cannot be decrypted with a card ID of the latter memory card. Hence the digital content can be protected against such unauthorized copying.","Here, the digital content may be accompanied with restrictive information that restricts the use of the digital content to a limited number of times or to limited usage conditions.","By encrypting this restrictive information using the card ID and storing it onto the memory card in the same way as the digital content, the restrictive information can be protected from unauthorized copying as with the digital content.","Nevertheless, when the restrictive information contains information whose value changes over time, such as a limitation on the number of times the digital content can be used, then even if the restrictive information is encrypted with the unique card ID, it cannot be fully protected against falsification. That is to say, the user who receives the restrictive information of high value can make a backup copy of it and in later use replace the restrictive information of decreasing value with the backup copy.","In view of the above problem, the present invention aims to provide a digital data recording device, digital data memory device, and digital data utilizing device that prevent unauthorized acts such as backup copying restrictive information and later replacing the restrictive information with the backup copy, digital data recording and utilizing methods for delivering the above effect, and computer-readable storage mediums storing programs for implementing the above methods.","To achieve the stated object, the invention provides a digital data intelligent memory device for sending digital data and management information that contains information for restricting the use of the digital data, to a digital data utilizing device, including: a management information storing unit for storing the management information; a digital data storing unit for storing the digital data; a key information acquiring unit for acquiring key information which differs in each send session; a data converting unit for performing a data conversion specified by the acquired key information, on the management information stored in the management information storing unit, to generate converted management information; and a sending unit for sending the digital data stored in the digital data storing unit and the converted management information generated by the data converting unit, to the digital data utilizing device.","With this construction, the digital data intelligent memory device converts the management information based on the key information which differs in each send session, before sending it to the digital data utilizing device. Accordingly, even when the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy is useless, as it cannot be inverse converted properly with key information of the later session.","Here, the key information acquiring unit may acquire the key information as a common key in a common key cipher, the key information being also acquired by the digital data utilizing device, wherein the data converting unit encrypts the management information using the key information according to the common key cipher, to generate the converted management information.","With this construction, the digital data intelligent memory device and the digital data utilizing device establish the common key information, which enables the two devices to carry out encrypted communication by the common key cipher.","Here, without the key information being transferred between the digital data intelligent memory device and the digital data utilizing device, the key information acquiring unit may acquire the key information by subjecting base data, which is commonly established in the key information acquiring unit and the digital data utilizing device through an exchange of data other than the key information, to a secret data conversion that is also provided in the digital data utilizing device.","With this construction, the digital data intelligent memory device and the digital data utilizing device establish the common key information without transferring the key information itself. Accordingly, the key information can be protected from tapping.","Here, without the key information being transferred between the digital data intelligent memory device and the digital data utilizing device, the key information acquiring unit may acquire the key information by subjecting time-of-day data, which is common in the digital data intelligent memory device and the digital data utilizing device, to a secret data conversion that is also provided in the digital data utilizing device.","With this construction, the common key information is generated from the time-of-day data, which ensures the generation of different key information in each send session.","Here, the digital data intelligent memory device may further include a key information storing unit for storing the key information, wherein in each send session the key information acquiring unit renews the key information stored in the key information storing unit by applying a predetermined conversion to the key information.","With this construction, new key information is generated from preceding key information, which further strengthens the confidentiality of the converted management information in communication.","Here, the predetermined conversion applied to the key information by the key information acquiring unit may be any of: an incrementing; a decrementing; one or a combination of the four arithmetic operations using a predetermined value; and a predetermined secret one-way conversion.","With this construction, the new key information is generated just by performing increment, decrement, one or a combination of the four rules of arithmetic using a predetermined value, or a predetermined secret one-way conversion, on the preceding key information. As a result, the key information generation process becomes easier.","Here, the data converting unit may perform an exclusive-OR operation on the management information and the key information, to generate the converted management information.","With this construction, the XOR operation is employed to convert the management information. Since the inverse of the XOR operation is also the XOR operation, the conversion and inverse conversion process for the management information becomes easier.","Here, the key information acquiring unit may acquire the key information as a public key in a public key cipher, with a private key corresponding to the public key being acquired by the digital data utilizing device, wherein the data converting unit encrypts the management information using the key information according to the public key cipher, to generate the converted management information.","With this construction, the digital data intelligent memory device and the digital data utilizing device respectively acquire the public and private keys, which enables the two devices to carry out encrypted communication by the public key cipher.","Here, the key information acquiring unit may acquire the key information as a private key in a recovery-type signature scheme, with a public key corresponding to the private key being acquired by the digital data utilizing device, wherein the data converting unit encrypts the management information using the key information according to the recovery-type signature scheme, to generate the converted management information.","With this construction, the digital data intelligent memory device and the digital data utilizing device respectively acquire the private and public keys, which enables the two devices to carry out encrypted communication by the recovery-type signature scheme.","Here, the data converting unit may generate a random number in each send session, and, having added the generated random number to a predetermined position in the management information, perform the data conversion on the management information.","With this construction, the random number is added to the predetermined position in the management information prior to the data conversion, so that the confidentiality of the converted management information in communication is more strengthened.","To achieve the stated object, the invention also provides a digital data intelligent memory device for receiving from a digital data recording device digital data and management information that contains information for restricting the use of the digital data, and storing the digital data and the management information, including: a key information acquiring unit for acquiring key information which differs in each receive session; a receiving unit for receiving, from the digital data recording device, the digital data and the management information which has been converted in such a manner as to enable the digital data intelligent memory device to restore the management information from the converted management information by an inverse data conversion specified by the acquired key information; an inverse data converting unit for performing the inverse data conversion on the converted management information received by the receiving unit, to restore the management information; a management information storing unit for storing the management information restored by the inverse data converting unit; and a digital data storing unit for storing the digital data received by the receiving unit.","With this construction, the digital data intelligent memory device receives the converted management information from the digital data recording device, inverse converts the converted management information based on the key information which differs in each receive session, and stores the generated management information. Accordingly, even when the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy is useless, as it cannot be inverse converted properly with key information of the later session.","Here, the key information acquiring unit may acquire the key information as a common key in a common key cipher, the key information being also acquired by the digital data recording device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the common key cipher, to restore the management information.","With this construction, the digital data intelligent memory device and the digital data recording device establish the common key information, which enables the two devices to carry out encrypted communication by the common key cipher.","Here, without the key information being transferred between the digital data intelligent memory device and the digital data recording device, the key information acquiring unit may acquire the key information by subjecting base data, which is commonly established in the key information acquiring unit and the digital data recording device through an exchange of data other than the key information, to a secret data conversion that is also provided in the digital data recording device.","With this construction, the digital data intelligent memory device and the digital data recording device establish the common key information without transferring the key information itself, so that the key information is protected from tapping.","Here, without the key information being transferred between the digital data intelligent memory device and the digital data recording device, the key information acquiring unit may acquire the key information by subjecting time-of-day data, which is common in the digital data intelligent memory device and the digital data recording device, to a secret data conversion that is also provided in the digital data recording device.","With this construction, the common key information is generated from the time-of-day data, which ensures the generation of different key information in each receive session.","Here, the digital data intelligent memory device may further include a key information storing unit for storing the key information, wherein in each receive session the key information acquiring unit renews the key information stored in the key information storing unit by applying a predetermined conversion to the key information.","With this construction, new key information is generated from preceding key information, which further strengthens the confidentiality of the converted management information in communication.","Here, the predetermined conversion applied to the key information by the key information acquiring unit may be any of: an incrementing; a decrementing; one or a combination of the four arithmetic operations using a predetermined value; and a predetermined secret one-way conversion.","With this construction, the new key information is generated merely by performing increment, decrement, one or a combination of the four rules of arithmetic using a predetermined value, or a predetermined secret one-way conversion, on the preceding key information. As a result, the key information generation process becomes easier.","Here, the inverse data converting unit may perform an exclusive-OR operation on the converted management information and the key information, to restore the management information.","With this construction, the XOR operation is employed to convert the management information. Since the inverse of the XOR operation is the XOR operation, the conversion and inverse conversion process for the management information becomes easier.","Here, the key information acquiring unit may acquire the key information as a private key in a public key cipher, with a public key corresponding to the private key being acquired by the digital data recording device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the public key cipher, to restore the management information.","With this construction, the digital data intelligent memory device and the digital data recording device respectively acquire the private and public keys, which enables the two devices to carry out encrypted communication by the public key cipher.","Here, the key information acquiring unit may acquire the key information as a public key in a recovery-type signature scheme, with a private key corresponding to the public key being acquired by the digital data recording device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the recovery-type signature scheme, to restore the management information.","With this construction, the digital data intelligent memory device and the digital data recording device respectively acquire the public and private keys, which enables the two devices to carry out encrypted communication by the recovery-type signature scheme.","Here, the receiving unit may receive the converted management information in which a random number has been added to a predetermined position prior to the conversion, wherein the inverse data converting unit performs the inverse data conversion on the converted management information and then removes the random number from the predetermined position in the inverse converted management information, to restore the management information.","With this construction, the random number is added to the predetermined position in the management information prior to the data conversion, so that the confidentiality of the converted management information in communication is more strengthened.","To achieve the stated object, the invention also provides a digital data utilizing device for receiving from a digital data intelligent memory device digital data and management information that contains restrictive information for restricting the use of the digital data, and utilizing the digital data and the management information, including: a key information acquiring unit for acquiring key information which differs in each receive session; a receiving unit for receiving, from the digital data intelligent memory device, the digital data and the management information which has been converted in such a manner as to enable the digital data utilizing device to restore the management information from the converted management information by an inverse data conversion specified by the acquired key information; an inverse data converting unit for performing the inverse data conversion on the converted management information received by the receiving unit, to restore the management information; and a utilizing unit for utilizing the digital data received by the receiving unit, in accordance with the restrictive information contained in the restored management information.","With this construction, the digital data utilizing device receives the converted management information from the digital data intelligent memory device, inverse converts the converted management information based on the key information which differs in each receive session, and utilizes the generated management information. Accordingly, even when the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy is useless, as it cannot be inverse converted properly with key information of the later session.","Here, the key information acquiring unit may acquire the key information as a common key in a common key cipher, the key information being also acquired by the digital data intelligent memory device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the common key cipher, to restore the management information.","With this construction, the digital data utilizing device and the digital data intelligent memory device establish the common key information, which enables the two devices to carry out encrypted communication by the common key cipher.","Here, without the key information being transferred between the digital data utilizing device and the digital data intelligent memory device, the key information acquiring unit may acquire the key information by subjecting base data, which is commonly established in the key information acquiring unit and the digital data intelligent memory device through an exchange of data other than the key information, to a secret data conversion that is also provided in the digital data intelligent memory device.","With this construction, the digital data utilizing device and the digital data intelligent memory device establish the common key information without transferring the key information itself, so that the key information is protected from tapping.","Here, without the key information being transferred between the digital data utilizing device and the digital data intelligent memory device, the key information acquiring unit may acquire the key information by subjecting time-of-day data, which is common in the digital data utilizing device and the digital data intelligent memory device, to a secret data conversion that is also provided in the digital data intelligent memory device.","With this construction, the common key information is generated from the time-of-day data, which ensures the generation of different key information in each receive session.","Here, the digital data utilizing device may further include a key information storing unit for storing the key information, wherein in each receive session the key information acquiring unit renews the key information stored in the key information storing unit by applying a predetermined conversion to the key information.","With this construction, new key information is generated from preceding key information, with it being possible to further strengthen the confidentiality of the converted management information in communication.","Here, the predetermined conversion applied to the key information by the key information acquiring unit may be any of: an incrementing; a decrementing; one or a combination of the four arithmetic operations using a predetermined value; and a predetermined secret one-way conversion.","With this construction, the new key information is generated merely by performing increment, decrement, one or a combination of the four rules of arithmetic using a predetermined value, or a predetermined secret one-way conversion, on the preceding key information. As a result, the key information generation process becomes easier.","Here, the inverse data converting unit may perform an exclusive-OR operation on the converted management information and the key information, to restore the management information.","With this construction, the XOR operation is employed to convert the management information. Since the inverse of the XOR operation is the XOR operation, the conversion and inverse conversion process for the management information becomes easier.","Here, the key information acquiring unit may acquire the key information as a private key in a public key cipher, with a public key corresponding to the private key being acquired by the digital data intelligent memory device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the public key cipher, to restore the management information.","With this construction, the digital data utilizing device and the digital data intelligent memory device respectively acquire the private and public keys, which enables the two devices to carry out encrypted communication by the public key cipher.","Here, the key information acquiring unit may acquire the key information as a public key in a recovery-type signature scheme, with a private key corresponding to the public key being acquired by the digital data intelligent memory device, wherein the inverse data converting unit decrypts the converted management information using the key information according to the recovery-type signature scheme, to restore the management information.","With this construction, the digital data utilizing device and the digital data intelligent memory device respectively acquire the public and private keys, which enables the two devices to carry out encrypted communication by the recovery-type signature scheme.","Here, the receiving unit may receive the converted management information in which a random number has been added to a predetermined position prior to the conversion, wherein the inverse data converting unit performs the inverse data conversion on the converted management information and then removes the random number from the predetermined position in the inverse converted management information, to restore the management information.","With this construction, the random number is added to the predetermined position in the management information prior to the data conversion, so that the confidentiality of the converted management information in communication is more strengthened.","To achieve the stated object, the invention also provides a digital data recording device for sending digital data and management information that contains information for restricting the use of the digital data, to a digital data intelligent memory device, including: a management information acquiring unit for acquiring the management information; a digital data acquiring unit for acquiring the digital data; a key information acquiring unit for acquiring key information which differs in each send session; a data converting unit for performing a data conversion specified by the acquired key information, on the management information acquired by the management information acquiring unit, to generate converted management information; and a sending unit for sending the digital data acquired by the digital data acquiring unit and the converted management information generated by the data converting unit, to the digital data intelligent memory device.","With this construction, the digital data recording device converts the acquired management information based on the key information which differs in each send session, before sending it to the digital data intelligent memory device. Accordingly, even when the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy is useless, as it cannot be inverse converted properly with key information of the later session.","Here, the key information acquiring unit may acquire the key information as a common key in a common key cipher, the key information being also acquired by the digital data intelligent memory device, wherein the data converting unit encrypts the management information using the key information according to the common key cipher, to generate the converted management information.","With this construction, the digital data recording device and the digital data intelligent memory device establish the common key information, which enables the two devices to carry out encrypted communication by the common key cipher.","Here, without the key information being transferred between the digital data recording device and the digital data intelligent memory device, the key information acquiring unit may acquire the key information by subjecting base data, which is commonly established in the key information acquiring unit and the digital data intelligent memory device through an exchange of data other than the key information, to a secret data conversion that is also provided in the digital data intelligent memory device.","With this construction, the digital data recording device and the digital data intelligent memory device establish the common key information without transferring the key information itself, so that the key information is protected from tapping.","Here, without the key information being transferred between the digital data recording device and the digital data intelligent memory device, the key information acquiring unit may acquire the key information by subjecting time-of-day data, which is common in the digital data recording device and the digital data intelligent memory device, to a secret data conversion that is also provided in the digital data intelligent memory device.","With this construction, the key information is generated from the time-of-day data, which ensures the generation of different key information in each send session.","Here, the digital data recording device may further include a key information storing unit for storing the key information, wherein in each send session the key information acquiring unit renews the key information stored in the key information storing unit by applying a predetermined conversion to the key information.","With this construction, new key information is generated from preceding key information, with it being possible to further strengthen the confidentiality of the converted management information in communication.","Here, the predetermined conversion applied to the key information by the key information acquiring unit may be any of: an incrementing; a decrementing; one or a combination of the four arithmetic operations using a predetermined value; and a predetermined secret one-way conversion.","With this construction, the new key information is generated merely by performing increment, decrement, one or a combination of the four rules of arithmetic using a predetermined value, or a predetermined secret one-way conversion, on the preceding key information. As a result, the key information generation process becomes easier.","Here, the data converting unit may perform an exclusive-OR operation on the management information and the key information, to generate the converted management information.","With this construction, the XOR operation is used to convert the management information. Since the inverse of the XOR operation is the XOR operation, the conversion and inverse conversion process for the management information becomes easier.","Here, the key information acquiring unit may acquire the key information as a public key in a public key cipher, with a private key corresponding to the public key being acquired by the digital data intelligent memory device, wherein the data converting unit encrypts the management information using the key information according to the public key cipher, to generate the converted management information.","With this construction, the digital data recording device and the digital data intelligent memory device respectively acquire the public and private keys, which enables the two devices to carry out encrypted communication by the public key cipher.","Here, the key information acquiring unit may acquire the key information as a private key in a recovery-type signature scheme, with a public key corresponding to the private key being acquired by the digital data intelligent memory device, wherein the data converting unit encrypts the management information using the key information according to the recovery-type signature scheme, to generate the converted management information.","With this construction, the digital data recording device and the digital data intelligent memory device respectively acquire the private and public keys, which enables the two devices to carry out encrypted communication by the recovery-type signature scheme.","Here, the data converting unit may generate a random number in each send session, and, having added the generated random number to a predetermined position in the management information, perform the data conversion on the management information.","With this construction, the random number is added to the predetermined position in the management information prior to the data conversion, so that the confidentiality of the converted management information in communication is more strengthened.","To achieve the stated object, the invention also provides an encrypted digital data intelligent memory device for sending encrypted digital data and encrypted management information to an encrypted digital data utilizing device, the encrypted management information having been generated by encrypting management information in such a manner that the encrypted management information can be decrypted based on a device ID uniquely given to the encrypted digital data intelligent memory device, the management information containing information for decrypting the encrypted digital data into digital data and information for restricting the use of the digital data,, the encrypted digital data intelligent memory device including: a device ID holding unit for holding the device ID; a device ID providing unit for providing the encrypted digital data utilizing device with the device ID held in the device ID holding unit; an encrypted management information storing unit for storing the encrypted management information; an encrypted digital data storing unit for storing the encrypted digital data; a key information acquiring unit for acquiring key information which differs in each send session; a data converting unit for performing a data conversion specified by the acquired key information, on the encrypted management information stored in the encrypted management information storing unit, to generate converted management information; and a sending unit for sending the encrypted digital data stored in the encrypted digital data storing unit and the converted management information generated by the data converting unit, to the encrypted digital data utilizing device.","With this construction, the encrypted digital data intelligent memory device converts, based on the key information which differs in each send session, such encrypted management information that can be decrypted based on the device ID of the encrypted digital data intelligent memory device, before sending it to the encrypted digital data utilizing device. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session. Also, even if the converted management information and encrypted digital data which are being sent from the encrypted digital data intelligent memory device to the encrypted digital data utilizing device are unauthorizedly copied to another encrypted digital data intelligent memory device, the copied information and data cannot be decrypted because a device ID of the latter intelligent memory device is different from that of the former intelligent memory device.","To achieve the stated object, the invention also provides an encrypted digital data intelligent memory device for receiving encrypted digital data and encrypted management information from an encrypted digital data recording device and storing the encrypted digital data and the encrypted management information, the encrypted management information having been generated by encrypting management information in such a manner that the encrypted management information can be decrypted based on a device ID uniquely given to the encrypted digital data intelligent memory device, the management information containing information for decrypting the encrypted digital data into digital data and information for restricting the use of the digital data, the encrypted digital data intelligent memory device including: a device ID holding unit for holding the device ID; a device ID providing unit for providing the encrypted digital data recording device with the device ID held in the device ID holding unit; a key information acquiring unit for acquiring key information which differs in each receive session; a receiving unit for receiving, from the encrypted digital data recording device, the encrypted digital data and the encrypted management information which has been converted in such a manner as to enable the encrypted digital data intelligent memory device to restore the encrypted management information from the converted management information by an inverse data conversion specified by the acquired key information; an inverse data converting unit for performing the inverse data conversion on the converted management information received by the receiving unit, to restore the encrypted management information; an encrypted management information storing unit for storing the encrypted management information restored by the inverse data converting unit; and an encrypted digital data storing unit for storing the encrypted digital data received by the receiving unit.","With this construction, the encrypted digital data intelligent memory device receives the converted management information from the encrypted digital data recording device, inverse converts the converted management information based on the key information which differs in each receive session, and as a result obtains and stores such encrypted management information that can be decrypted based on the device ID of the encrypted digital data intelligent memory device. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session. Also, even if the converted management information and encrypted digital data which are being sent from the encrypted digital data recording device to the encrypted digital data intelligent memory device are unauthorizedly copied to another encrypted digital data intelligent memory device, the copied information and data cannot be decrypted because a device ID of the latter intelligent memory device is different from that of the former intelligent memory device.","To achieve the stated object, the invention also provides an encrypted digital data utilizing device for receiving encrypted digital data and encrypted management information from an encrypted digital data intelligent memory device and utilizing the encrypted digital data and the encrypted management information, the encrypted management information having been generated by encrypting management information in such a manner that the encrypted management information can be decrypted based on a device ID uniquely given to the encrypted digital data intelligent memory device, the management information containing decryption information for decrypting the encrypted digital data into digital data and restrictive information for restricting the use of the digital data, the encrypted digital data utilizing device including: a device ID acquiring unit for acquiring the device ID from the encrypted digital data intelligent memory device; a key information acquiring unit for acquiring key information which differs in each receive session; a receiving unit for receiving, from the encrypted digital data intelligent memory device, the encrypted digital data and the encrypted management information which has been converted in such a manner as to enable the encrypted digital data utilizing device to restore the encrypted management information from the converted management information by an inverse data conversion specified by the acquired key information; an inverse data converting unit for performing the inverse data conversion on the converted management information received by the receiving unit, to restore the encrypted management information; a management information decrypting unit for performing decryption specified by the acquired device ID, on the encrypted management information restored by the inverse data converting unit, to obtain the management information; a digital data decrypting unit for performing decryption specified by the decryption information contained in the management information obtained by the management information decrypting unit, on the encrypted digital data received by the receiving unit, to obtain the digital data; and a utilizing unit for utilizing the digital data in accordance with the restrictive information contained in the management information.","With this construction, the encrypted digital data utilizing device receives the converted management information from the encrypted digital data intelligent memory device, inverse converts the converted management information based on the key information which differs in each receive session, and further decrypts the encrypted management information generated by the inverse data conversion based on the device ID of the encrypted digital data intelligent memory device, as a result of which the management information is obtained and put to use. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session. Also, even if the converted management information and encrypted digital data which are being sent from the encrypted digital data intelligent memory device to the encrypted digital data utilizing device are unauthorizedly copied to another encrypted digital data intelligent memory device, the copied information and data cannot be decrypted because a device ID of the latter intelligent memory device is different from that of the former intelligent memory device.","To achieve the stated object, the invention also provides an encrypted digital data recording device for encrypting digital data and management information that contains decryption information for decrypting the encrypted digital data into the digital data and restrictive information for restricting the use of the digital data, in such a manner that the encrypted management information can be decrypted based on a device ID uniquely given to an encrypted digital data intelligent memory device and the encrypted digital data can be decrypted based on the decryption information, and sending the encrypted digital data and the encrypted management information to the encrypted digital data intelligent memory device, the encrypted digital data recording device including: a device ID receiving unit for receiving the device ID from the encrypted digital data intelligent memory device; a management information acquiring unit for acquiring the management information; a digital data acquiring unit for acquiring the digital data; a key information acquiring unit for acquiring key information which differs in each send session; a management information encrypting unit for encrypting the acquired management information in such a manner that the encrypted management information can be decrypted based on the device ID; a data converting unit for performing a data conversion specified by the acquired key information, on the encrypted management information generated by the management information encrypting unit, to generate converted management information; a digital data encrypting unit for encrypting the acquired digital data in such a manner that the encrypted digital data can be decrypted based on the decryption information; and a sending unit for sending the encrypted digital data generated by the digital data encrypting unit and the converted management information generated by the data converting unit, to the encrypted digital data intelligent memory device.","With this construction, the encrypted digital data recording device encrypts the acquired management information such that the encrypted management information can be decrypted based on the device ID of the encrypted digital data intelligent memory device, and further converts the encrypted management information based on the key information which differs in each send session, before sending it to the encrypted digital data intelligent memory device. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session. Also, even if the converted management information and encrypted digital data which are being sent from the encrypted digital data recording device to the encrypted digital data intelligent memory device are copied to another encrypted digital data intelligent memory device, the copied information and data cannot be decrypted because a device ID of the latter intelligent memory device is different from that of the former intelligent memory device.","To achieve the stated object, the invention also provides a digital data utilizing method for receiving from a digital data intelligent memory device digital data and management information that contains restrictive information for restricting the use of the digital data, and utilizing the digital data and the management information in a digital data utilizing device, the digital data utilizing method including: a key information generating step for generating, in each utilize session, conversion key information for specifying a data conversion in the digital data intelligent memory device, and concurrently generating inverse conversion key information for specifying an inverse of the data conversion in the digital data utilizing device; a data converting step for performing the data conversion specified by the conversion key information, on the management information stored in the digital data intelligent memory device, to generate converted management information; a converted management information sending step for sending the converted management information from the digital data intelligent memory device to the digital data utilizing device; a receiving step for receiving the converted management information in the digital data utilizing device from the digital data intelligent memory device; an inverse data converting step for performing the inverse data conversion specified by the inverse conversion key information, on the converted management information received in the digital data utilizing device, to restore the management information; a digital data sending step for sending the digital data stored in the digital data intelligent memory device, to the digital data utilizing device; a digital data receiving step for receiving the digital data in the digital data utilizing device from the digital data intelligent memory device; and a digital data utilizing step for utilizing the digital data received in the digital data utilizing device, in accordance with the restrictive information contained in the restored management information.","With this construction, the digital data intelligent memory device converts the management information based on the conversion key information which differs in each utilize session, and sends the converted management information to the digital data utilizing device. The digital data utilizing device inverse converts the converted management information based on the inverse conversion key information which differs in each utilize session, to thereby obtain and utilize the management information. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session.","To achieve the stated object, the invention also provides a digital data recording method for sending, from a digital data recording device to a digital data intelligent memory device, digital data and management information that contains information for restricting the use of the digital data, and recording the digital data and the management information into the digital data intelligent memory device, the digital data recording method including: a key information generating step for generating, in each record session, conversion key information for specifying a data conversion in the digital data recording device, and concurrently generating inverse conversion key information for specifying an inverse of the data conversion in the digital data intelligent memory device; a management information acquiring step for acquiring the management information in the digital data recording device; a data converting step for performing the data conversion specified by the conversion key information, on the management information acquired in the digital data recording device, to generate converted management information; a converted management information sending step for sending the converted management information from the digital data recording device to the digital data intelligent memory device; a converted management information receiving step for receiving the converted management information in the digital data intelligent memory device from the digital data recording device; an inverse data converting step for performing the inverse data conversion specified by the inverse conversion key information, on the converted management information received in the digital data intelligent memory device, to restore the management information; a management information storing step for storing the restored management information in the digital data intelligent memory device; a digital data acquiring step for acquiring the digital data in the digital data recording device; a digital data sending step for sending the digital data from the digital data recording device to the digital data intelligent memory device; a digital data receiving step for receiving the digital data in the digital data intelligent memory device from the digital data recording device; and a digital data storing step for storing the received digital data in the digital data intelligent memory device.","With this construction, the digital data recording device converts the management information based on the conversion key information which differs in each record session, and sends the converted management information to the digital data intelligent memory device. The digital data intelligent memory device inverse converts the converted management information based on the inverse conversion key information which differs in each record session, to thereby obtain and store the management information. Accordingly, even when the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session.","To achieve the stated object, the invention also provides a computer-readable storage medium storing a digital data utilizing program for receiving from a digital data intelligent memory device digital data and management information that contains information for restricting the use of the digital data, and utilizing the digital data and the management information, the digital data utilizing program including: a key information acquiring step for acquiring key information which differs in each receive session; a receiving step for receiving, from the digital data intelligent memory device, the digital data and the management information which has been converted so that the management information can be restored from the converted management information by an inverse data conversion specified by the acquired key information; an inverse data converting step for performing the inverse data conversion on the converted management information received in the receiving step, to restore the management information; and a utilizing step for utilizing the digital data received in the receiving step, in accordance with the restrictive information contained in the restored management information.","With this construction, the converted management information received from the digital data intelligent memory device is inverse converted based on the key information which differs in each receive session, as a result of which the management information is obtained and put to use. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session.","To achieve the stated object, the invention also provides a computer-readable storage medium storing a digital data recording program for sending to a digital data intelligent memory device digital data and management information that contains information for restricting the use of the digital data, and recording the digital data and the management information into the digital data intelligent memory device, the digital data recording program including: a management information acquiring step for acquiring the management information; a digital data acquiring step for acquiring the digital data; a key information acquiring step for acquiring key information which differs in each send session; a data converting step for performing a data conversion specified by the acquired key information, on the management information acquired in the management information acquiring step, to generate converted management information; and a sending step for sending the digital data acquired in the digital data acquiring step and the converted management information generated in the data converting step, to the digital data intelligent memory device.","With this construction, the acquired management information is converted based on the key information which differs in each send session, before being sent to the digital data intelligent memory device. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session without authorization, the backup copy cannot be inverse converted properly with key information of the later session.","(Overview)","The present invention is embodied as follows. To write digital content from a recorder onto a memory card, first the memory card sends its card ID to the recorder, and then a common key is established between the recorder and the memory card. Next, the recorder encrypts management information containing restrictive information and a content key using the received card ID as an encryption key, and further performs a data conversion on the encrypted management information using the common key to generate converted management information. The recorder also encrypts the digital content using the content key contained in the management information, and outputs the converted management information and the encrypted digital content to the memory card. The memory card performs the inverse of the data conversion on the converted management information using the common key to restore the encrypted management information, and stores the encrypted management information and the encrypted digital content therein.","On the other hand, to read the digital content from the memory card into a player, first the memory card sends its card ID to the player, and a common key is established between the memory card and the player. Next, the memory card performs a data conversion on the encrypted management information stored therein using the common key, and sends the converted management information and the encrypted digital content stored therein to the player. The player performs the inverse of the data conversion on the converted management information using the common key to restore the encrypted management information, and decrypts the encrypted management information using the received card ID as a decryption key. Lastly, in accordance with digital content usage restrictions set by the restrictive information in the decrypted management information, the player decrypts the encrypted digital content using the content key contained in the management information, as a result of which the digital content is obtained.","By such converting the management information containing the restrictive information through the use of a different key in each send\/receive session, an unauthorized act of backup copying the management information and replacing the management information with the backup copy in subsequent use can be prevented.","(Constructions)",{"@attributes":{"id":"P-00123","num":"00123"},"figref":"FIG. 1","b":["100","120","140","100","140","120"]},"The recorder  acquires digital content, such as music information, and management information for the digital content from an external source, processes the digital content and the management information by encryption and the like for protection against unauthorized acts, and sends them to the memory card . The recorder  is roughly made up of a card ID receiving unit , a session key establishing unit , a management information acquiring unit , a management information processing unit , a content acquiring unit , a content encrypting unit , and an encrypted content sending unit .","The card ID receiving unit  receives a card ID, such as an 8-byte card ID \u201c0123456789ABCDEFH\u201d, from the memory card . In this paragraph and others, the character \u201cH\u201d or alternatively \u201ch\u201d in a data string indicates the associated characters are a hexadecimal, or base-16, representation of a numerical value.","The session key establishing unit  exchanges data such as random numbers with the memory card , to generate a session key which differs in each session of recording encrypted digital content onto the memory card . In this embodiment, the session key establishing unit  in the recorder  and a session key establishing unit  in the memory card  generate the same session key in the same manner. To be more specific, in each of the session key establishing units  and , an 8-byte random number is generated and sent to the other device. Then, each of the session key establishing units  and  performs a predetermined secret one-way conversion on each of the generated random number and the received random number, takes exclusive-OR (XOR) of the two converted values, and further performs the one-way conversion on the outcome to generate a session key. In so doing, the session key establishing units  and  can establish the common session key without the session key itself being sent\/received. In addition, each of the session key establishing units  and  sends the one-way conversion result of the received random number back to the other device, and compares the one-way conversion result of the generated random number with a value sent back from the other device. If and only if the two values match, each of the session key establishing units  and  verifies the other device as authorized, and proceeds to establish the common session key. Suppose the session key establishing unit  generates and sends 8-byte random number X to the session key establishing unit , and receives 8-byte random number Y from the session key establishing unit . Then the session key establishing unit  applies the one-way conversion to random number Y and sends the outcome \u201c0011337788CCEEFFH\u201d back to the session key establishing unit . The session key establishing unit  also applies the one-way conversion to random number X, and compares the outcome \u201c0F0F0F0F0F0F0F0FH\u201d with a value sent back from the session key establishing unit . When the two values match, the session key establishing unit  verifies the memory card  as authorized. Following this, the session key establishing unit  XORs the two values \u201c0F0F0F0F0F0F0F0FH\u201d and \u201c0011337788CCEEFFH\u201d, and further one-way converts the outcome \u201c0F1E3C7887C3E1F0H\u201d, to thereby obtain the session key.","The management information acquiring unit  acquires the management information that contains restrictive information and a content key. The restrictive information here is information for restricting the use of the digital content. For instance, the restriction information includes information on the number of times the digital content can be used, which is decremented every time the digital content is used, and information on areas and time periods within which the use of the digital content is allowed. The content key is an encryption key used to encrypt the digital content. For example, 16-byte management information \u201c3333333333333333000000000000000AH\u201d made up of an 8-byte content key \u201c3333333333333333H\u201d and 8-byte restrictive information \u201c000000000000000AH\u201d is acquired by the management information acquiring unit .","The management information processing unit  uses the card ID received by the card ID receiving unit  and the session key generated by the session key establishing unit , to encrypt and convert the management information acquired by the management information acquiring unit . The management information processing unit  then sends the result to the memory card .",{"@attributes":{"id":"P-00129","num":"00129"},"figref":"FIG. 2","b":"104"},"In the figure, the management information processing unit  includes an encrypting unit , a data converting unit , and a sending unit .","The encrypting unit  encrypts the management information using the card ID as an encryption key, according to a predetermined algorithm. The predetermined algorithm referred to here is a cipher, such as DES (Data Encryption Standard), that is specified by the encryption key.","The data converting unit  performs a predetermined data conversion on the encrypted management information using the session key. The predetermined data conversion here is a cipher specified by the session key. In this embodiment, the XOR operation is employed as the predetermined data conversion, though a cipher such as DES is also applicable.","The sending unit  sends the converted management information to the memory card .","The content acquiring unit  acquires the digital content.","The content encrypting unit  encrypts the acquired digital content using the content key included in the management information acquired by the management information acquiring unit , according to a predetermined block cipher. In this embodiment, after the digital content is divided into 8-byte blocks, each of the blocks is encrypted using the content key \u201c3333333333333333H\u201d, and the encrypted blocks are concatenated to form encrypted digital content.","The encrypted content sending unit  sends the encrypted digital content generated by the content encrypting unit , to the memory card .","The memory card  is an intelligent memory device equipped with a large-capacity semiconductor memory for storing encrypted digital content and encrypted management information, and a control circuit for the semiconductor memory. The memory card  is roughly made up of a card ID holding unit , a card ID sending unit , the session key establishing unit , a first management information processing unit , an encrypted management information storing unit , a second management information processing unit , an encrypted content receiving unit , an encrypted content storing unit , and an encrypted content sending unit .","The card ID holding unit  holds the card ID, such as the 8-byte card ID \u201c0123456789ABCDEFH\u201d, which has been uniquely given to the memory card .","The card ID sending unit  sends the card ID held in the card ID holding unit , to the recorder  and the player .","The session key establishing unit  exchanges data such as random numbers with the recorder  to generate a session key which differs in each session of recording encrypted digital content onto the memory card , and also exchanges data such as random numbers with the player  to generate a session key which differs in each session of reading encrypted digital content from the memory card . In this embodiment, the session key establishing unit  in the memory card  generates the same session key as the session key establishing unit  in the recorder  in the same manner, and generates the same session key as a session key establishing unit  in the player  in the same manner. This generation of the same session key has already been explained above, so that its detail is omitted here.","The first management information processing unit  receives the converted management information from the recorder . On this converted management information the first management information processing unit  performs the inverse of the predetermined data conversion performed by the data converting unit  in the management information processing unit  in the recorder , using the session key generated by the session key establishing unit  through the data exchange with the session key establishing unit  in the recorder . As a result, the encrypted management information is obtained.",{"@attributes":{"id":"P-00142","num":"00142"},"figref":"FIG. 3","b":"124"},"In the figure, the first management information processing unit  includes a receiving unit  and an inverse data converting unit .","The receiving unit  receives the converted management information from the sending unit  in the management information processing unit  in the recorder .","The inverse data converting unit  performs the inverse of the predetermined data conversion by the data converting unit  on the converted management information using the session key shared with the recorder , as a result of which the encrypted management information is generated. For example, if the predetermined data conversion by the data converting unit  is addition of the session key, the inverse data conversion by the inverse data converting unit  is subtraction of the session key. Since this embodiment employs the XOR operation as the predetermined data conversion by the data converting unit , the inverse data converting unit  performs the XOR operation as the inverse data conversion. Notice that the inverse of XOR is XOR, because XORing a given value twice using the same value yields the original value.","The encrypted management information storing unit  stores the encrypted management information generated by the first management information processing unit , in its inside nonvolatile memory.","The second management information processing unit  performs a predetermined data conversion on the encrypted management information stored in the encrypted management information storing unit , using the session key generated by the session key establishing unit  through the data exchange with the session key establishing unit  in the player . The second management information processing unit  then sends the converted management information to the player .",{"@attributes":{"id":"P-00148","num":"00148"},"figref":"FIG. 4","b":"126"},"In the figure, the second management information processing unit  includes a data converting unit  and a sending unit .","The data converting unit  performs a predetermined data conversion on the encrypted management information using the session key shared with the player , to obtain the converted management information. The predetermined data conversion referred to here is a cipher specified by the session key. Like the data converting unit , the XOR operation is employed as the predetermined data conversion here, though a cipher such as DES is also applicable.","The sending unit  sends the converted management information generated by the data converting unit , to the player .","The encrypted content receiving unit  receives the encrypted digital content from the encrypted content sending unit  in the recorder .","The encrypted content storing unit  stores the encrypted digital content received by the encrypted content receiving unit , in its inside nonvolatile memory.","The encrypted content sending unit  sends the encrypted digital content stored in the encrypted content storing unit , to the player .","The player  reads digital content such as music information and management information from the memory card  in their encrypted state, and utilizes these data by means of reproduction or the like. The player  is mainly made up of a card ID receiving unit , the session key establishing unit , a management information processing unit , a management information analyzing unit , an encrypted content receiving unit , a content decrypting unit , and a content utilizing unit .","The card ID receiving unit  receives the card ID, such as the 8-byte card ID \u201c0123456789ABCDEFH\u201d, from the memory card .","The session key establishing unit  exchanges data such as random numbers with the memory card , and so generates a session key which differs in each session of reading encrypted digital content from the memory card . As noted above, the session key establishing unit  in the player  and the session key establishing unit  in the memory card  generate the same session key in the same manner.","The management information processing unit  receives the converted management information from the memory card . On this converted management information the management information processing unit  first performs the inverse of the predetermined data conversion by the data converting unit  in the second management information processing unit  in the memory card  and then performs decryption, through the use of the session key generated by the session key establishing unit  and the card ID received by the card ID receiving unit .",{"@attributes":{"id":"P-00159","num":"00159"},"figref":"FIG. 5","b":"143"},"In the figure, the management information processing unit  includes a receiving unit , an inverse data converting unit , and a decrypting unit .","The receiving unit  receives the converted management information from the sending unit  in the second management information processing unit  in the memory card .","The inverse data converting unit  performs the inverse of the predetermined data conversion by the data converting unit  on the converted management information using the session key, to obtain the encrypted management information. In this embodiment, the predetermined data conversion by the data conversion unit  is the XOR operation, so that the inverse data conversion by the inverse data converting unit  is also the XOR operation.","The decrypting unit  decrypts the encrypted management information according to a predetermined algorithm, using the card ID as a decryption key. The predetermined algorithm here is a cipher specified by the decryption key such as DES, and is the inverse of the encryption performed by the encrypting unit  in the management information processing unit  in the recorder .","The management information analyzing unit  analyzes the management information generated by the management information processing unit , passes the content key included in the management information to the content decrypting unit , and controls the use of the digital content in accordance with the restrictive information in the management information. More specifically, if the number of times the digital content can be used is limited to ten, the management information analyzing unit  prohibits further use once the digital content has been used ten times. Also, if the time limit for the use of the digital content is set to three weeks, the management information analyzing unit  prohibits further use once the three weeks have passed.","The encrypted content receiving unit  receives the encrypted digital content from the encrypted content sending unit  in the memory card .","The content decrypting unit  decrypts the encrypted digital content using the content key given from the management information analyzing unit , according to the predetermined block cipher. In this embodiment, after the encrypted digital content is divided into 8-byte blocks, each of the blocks is decrypted using the content key \u201c3333333333333333H\u201d, and the decrypted blocks are concatenated to form the digital content.","The content utilizing unit  utilizes the digital content (e.g. reproduces music) generated by the content decrypting unit .","(Operations)","The following is an explanation on how the recorder  and the memory card  operate to record encrypted digital content.",{"@attributes":{"id":"P-00170","num":"00170"},"figref":"FIG. 6","b":["100","120"]},"(1) First, the card ID sending unit  in the memory card  sends a card ID \u201cCID\u201d held in the card ID holding unit , to the recorder  (S). In the present example, the 8-byte card ID \u201c0123456789ABCDEFH\u201d is sent to the recorder .","(2) The card ID receiving unit  in the recorder  receives the card ID \u201cCID\u201d from the memory card  (S).","(3) The session key establishing unit  in the recorder  and the session key establishing unit  in the memory card  exchange data such as random numbers, to establish a common session key \u201cSK1\u201d which differs in each session of recording encrypted digital content onto the memory card  (S, S). In the present example, the session key establishing unit  generates and sends 8-byte random number X to the session key establishing unit , and receives 8-byte random number Y from the session key establishing unit . The session key establishing unit  then one-way converts random number Y and sends the outcome \u201c0011337788CCEEFFH\u201d back to the session key establishing unit . The session key establishing unit  also one-way converts random number X, and compares the outcome \u201c0F0F0F0F0F0F0F0FH\u201d with a value sent back from the session key establishing unit . If they match, the session key establishing unit  verifies the memory card  as authorized. Accordingly, the session key establishing unit  XORs the two values \u201c0F0F0F0F0F0F0F0FH\u201d and \u201c0011337788CCEEFFH\u201d and further one-way converts the outcome \u201c0F1E3C7887C3E1F0H\u201d to generate a common session key. Meanwhile, the session key establishing unit  generates and sends 8-byte random number Y to the session key establishing unit , and receives 8-byte random number X from the session key establishing unit . The session key establishing unit  then one-way converts random number X and sends the outcome \u201c0F0F0F0F0F0F0F0FH\u201d back to the session key establishing unit . The session key establishing unit  also one-way converts random number Y and compares the outcome \u201c0011337788CCEEFFH\u201d with a value sent back from the session key establishing unit . If they match, the session key establishing unit  verifies the recorder  as authorized. Accordingly, the session key establishing unit  XORs the two values \u201c0011337788CCEEFFH\u201d and \u201c0F0F0F0F0F0F0F0FH\u201d and further one-way converts the outcome \u201c0F1E3C7887C3E1F0H\u201d, to generate the common session key.","(4) The management information acquiring unit  in the recorder  acquires management information \u201cLic\u201d containing restrictive information and a content key \u201cCK\u201d (S). Here, the management information acquiring unit  acquires the 16-byte management information \u201c3333333333333333000000000000000AH\u201d made up of the 8-byte content key \u201c3333333333333333H\u201d and the 8-byte restrictive information \u201c000000000000000AH\u201d.","(5) The encrypting unit  in the management information processing unit  in the recorder  encrypts the management information \u201cLic\u201d by a predetermined algorithm \u201cE\u201d, using the card ID \u201cCID\u201d received by the card ID receiving unit  as an encryption key. As a result, encrypted management information \u201cE(CID,Lic)\u201d is generated (S). In the present example, the management information \u201c3333333333333333000000000000000AH\u201d is encrypted using the card ID \u201c0123456789ABCDEFH\u201d into 16-byte encrypted management information.","(6) The data converting unit  in the management information processing unit  in the recorder  performs a predetermined data conversion (e.g. the XOR operation \u201cXOR\u201d) on the encrypted management information \u201cE(CID,Lic)\u201d, using the session key \u201cSK1\u201d generated by the session key establishing unit . Hence converted management information \u201cXOR(SK1,E(CID,Lic))\u201d is obtained (S). In the present example, the 16-byte encrypted management information is XORed with 16-byte data generated by concatenating the same two 8-byte session keys, thereby yielding 16-byte converted management information.","(7) The sending unit  in the management information processing unit  in the recorder  sends the converted management information \u201cXOR(SK1,E(CID,Lic))\u201d to the memory card  (S)\n\n","(9) The inverse data converting unit  in the first management information processing unit  in the memory card  performs the inverse of the predetermined data conversion by the data converting unit  in the recorder , on the converted management information \u201cXOR(SK1,E(CID,Lic))\u201d using the session key \u201cSK1\u201d generated by the session key establishing unit . As a result, the encrypted management information \u201cE(CID,Lic)\u201d is obtained (S). In the present example, the 16-byte converted management information is XORed with the 16-byte data generated by concatenating the same two 8-byte session keys, to thereby generate the 16-byte encrypted management information.","(10) The encrypted management information storing unit  in the memory card  stores the encrypted management information \u201cE(CID,Lic)\u201d into its inside nonvolatile memory (S).","(11) The content acquiring unit  in the recorder  acquires digital content \u201cCon\u201d (S). In the present example, the content acquiring unit  acquires 1-Mbyte digital content.","(12) The content encrypting unit  in the recorder  encrypts the acquired digital content \u201cCon\u201d according to a predetermined block cipher \u201cE\u201d, using the content key \u201cCK\u201d in the management information \u201cLic\u201d acquired by the management information acquiring unit . As a result, encrypted digital content \u201cE(CK,Con)\u201d is generated (S). In the present example, after the 1-Mbyte digital content is divided into blocks of 8 bytes, each of the blocks is encrypted using the content key \u201c3333333333333333H\u201d, and the encrypted blocks are concatenated to form 1-Mbyte encrypted digital content.","(13) The encrypted content sending unit  in the recorder  sends the encrypted digital content \u201cE(CK,Con)\u201d to the memory card  (S).","(14) The encrypted content receiving unit  in the memory card  receives the encrypted digital content \u201cE(CK,Con)\u201d from the recorder  (S).","(15) The encrypted content storing unit  in the memory card  stores the received encrypted digital content \u201cE(CK,Con)\u201d into its inside nonvolatile memory (S).","The following is an explanation on how the memory card  and the player  operate to read and utilize encrypted digital content.",{"@attributes":{"id":"P-00187","num":"00187"},"figref":"FIG. 7","b":["120","140"]},"(1) The card ID sending unit  in the memory card  sends the card ID \u201cCID\u201d held in the card ID holding unit , to the player  (S). In the present example, the 8-byte card ID \u201c0123456789ABCDEFH\u201d is sent to the player .","(2) The card ID receiving unit  in the player  receives the card ID \u201cCID\u201d from the memory card  (S).","(3) The session key establishing unit  in the memory card  and the session key establishing unit  in the player  exchange data such as random numbers, to establish a common session key \u201cSK2\u201d that differs in each session of reading encrypted digital content from the memory card  (S, S). In the present example, the session key establishing unit  generates and sends 8-byte random number N to the session key establishing unit , and receives 8-byte random number M from the session key establishing unit . The session key establishing unit  then one-way converts random number M and sends the outcome \u201c1122448877BBDDEEH\u201d back to the session key establishing unit . The session key establishing unit  also one-way converts random number N, and compares the outcome \u201cF0F0F0F0F0F0F0F0H\u201d with a value sent back from the session key establishing unit . If they match, the session key establishing unit  verifies the player  as authorized.","Following this, the session key establishing unit  XORs the two values \u201cF0F0F0F0F0F0F0F0H\u201d and \u201c1122448877BBDDEEH\u201d and further one-way converts the outcome \u201cE1D2B478874B2D1EH\u201d, to generate a common session key. In the meantime, the session key establishing unit  generates and sends 8-byte random number M to the session key establishing unit , and receives 8-byte random number N from the session key establishing unit . The session key establishing unit  then one-way converts random number N and sends the outcome \u201cF0F0F0F0F0F0F0F0H\u201d back to the session key establishing unit . The session key establishing unit  also one-way converts random number M and compares the outcome \u201c1122448877BBDDEEH\u201d with a value sent back from the session key establishing unit . If they match, the session key establishing unit  verifies the memory card  as authorized. The session key establishing unit  accordingly XORs the two values \u201c1122448877BBDDEEH\u201d and \u201cF0F0F0F0F0F0F0F0H\u201d and further one-way converts the outcome \u201cE1D2B478874B2D1EH\u201d, to generate the common session key.","(4) The data converting unit  in the second management information processing unit  in the memory card  performs a predetermined data conversion (e.g. the XOR operation \u201cXOR\u201d) on the encrypted management information \u201cE(CID,Lic)\u201d stored in the encrypted management information storing unit , using the session key \u201cSK2\u201d generated by the session key establishing unit . Hence converted management information \u201cXOR(SK2,E(CID,Lic))\u201d is obtained (S). In the present example, the 16-byte encrypted management information is XORed with 16-byte data generated by concatenating the same two 8-byte session keys, to thereby generate 16-byte converted management information.","(5) The sending unit  in the second management information processing unit  in the memory card  sends the converted management information \u201cXOR(SK2,E(CID,Lic))\u201d to the player  (S).","(6) The receiving unit  in the management information processing unit  in the player  receives the converted management information \u201cXOR(SK2,E(CID,Lic))\u201d from the memory card  (S).","(7) The inverse data converting unit  in the management information processing unit  in the player  performs the inverse of the predetermined data conversion by the data converting unit  in the memory card , on the converted management information \u201cXOR(SK2,E(CID,Lic))\u201d using the session key \u201cSK2\u201d generated by the session key establishing unit . As a result, the encrypted management information \u201cE(CID,Lic)\u201d is obtained (S). In the present example, the 16-byte converted management information is XORed with the 16-byte data generated by concatenating the same two 8-byte session keys, to obtain the 16-byte encrypted management information.","(8) The decrypting unit  in the management information processing unit  in the player  decrypts the encrypted management information \u201cE(CID,Lic)\u201d according to the predetermined algorithm using the card ID \u201cCID\u201d as a decryption key, and so generates the management information \u201cLic\u201d (S). In this example, the 16-byte encrypted management information is decrypted with the card ID \u201c0123456789ABCDEFH\u201d, so that the 16 byte management information \u201c3333333333333333000000000000000AH\u201d is generated.","(9) The management information analyzing unit  in the 110 player  analyzes the management information \u201cLic\u201d generated by the management information processing unit , passes the content key \u201cCK\u201d contained in the management information \u201cLic\u201d to the content decrypting unit , and controls the use of the digital content in accordance with the restrictive information contained in the management information \u201cLic\u201d (S). In this example, the 8-byte content key \u201c3333333333333333H\u201d in the 16 byte management information \u201c3333333333333333000000000000000AH\u201d is given to the content decrypting unit , and the 8-byte restrictive information \u201c000000000000000AH\u201d in the 16-byte management information is referenced to control the use of the digital content.","(10) The encrypted content sending unit  in the memory card  sends the encrypted digital content \u201cE(CK,Con)\u201d stored in the encrypted content storing unit , to the player  (S)","(11) The encrypted content receiving unit  in the player  receives the encrypted digital content \u201cE(CK,Con)\u201d from the memory card  (S).","(12) The content decrypting unit  in the player  decrypts the encrypted digital content \u201cE(CK,Con)\u201d according to the predetermined block cipher, using the content key \u201cCK\u201d given from the management information analyzing unit . Hence the digital content \u201cCon\u201d is obtained (S). In the present example, after the 1-Mbyte encrypted digital content is divided into 8 byte blocks, the blocks are each decrypted using the content key \u201c3333333333333333H\u201d, and the decrypted blocks are concatenated to form the 1-Mbyte digital content.","(13) The content utilizing unit  in the player  utilizes the digital content \u201cCon\u201d for musical reproduction and the like (S).","With the above embodiment, encrypted management information including restrictive information is XOR-converted with a session key which differs in each send\/receive session. Accordingly, even if the converted management information is backup copied in an earlier session and replaced with the backup copy in a later session, the backup copy is useless because it cannot be reconverted with a session key in the later session which differs with that used in the earlier session.","Though in the above embodiment the XOR operation for corresponding bits has been employed to convert encrypted management information due to its simple and fast processing, any cipher specified by a session key may instead be employed. Here, a random number may be added to a specific position (e.g. the beginning) in the encrypted management information prior to the data conversion. In so doing, the randomness of the converted management information increases, with it being possible to further strengthen the confidentiality of the information in communication.","Also, for generation of a session key, a chained cipher may be used whereby a new session key is generated based on a session key used and stored in an immediately preceding session. To generate the new session key from the stored session key, an operation such as increment, decrement, one or a combination of the four rules of arithmetic using a predetermined value, or a predetermined secret one-way conversion may be applied to the stored session key.","Though a common session key has been used according to a common key cipher in the above embodiment, a public key cipher may instead be employed whereby the sender's session key is a public key and the recipient's session key is a private key corresponding to the public key. Alternatively, a recovery-type signature scheme may be employed whereby the sender's session key is a private key and the recipient's session key is a public key corresponding to the private key.","Also, though random numbers have been exchanged to establish a common session key in the above embodiment, two devices may each generate the common session key independently, based on a value common to the entire system such as time-of-day data.","Also, a memory card equipped with a large-capacity semiconductor memory and a control circuit therefor has been used as a medium for storing encrypted digital content and encrypted management information in the above embodiment, such a medium may instead be any accessible storage medium, such as a hard disk, a floppy disk, a DVD-RAM (Digital Versatile Disk-Read Only Memory), or a CD-R (Compact Disk-Recordable), combined with a control device. Here, if a storage medium other than the memory card is used, a value uniquely given to the storage medium substitutes for the card ID.","Also, computer-readable storage mediums storing programs for executing the above embodied operations may be distributed for transactions.","The computer-readable storage mediums mentioned here may be removable storage mediums such as floppy disks, CDs, MOs (Magneto-Optical disks), DVDs, and memory cards, or fixed storage mediums such as hard disks and semiconductor memories.","Although the present invention has been fully described by way of examples with reference to the accompanying drawings, it is to be noted that various changes and modifications will be apparent to those skilled in the art. Therefore, unless such changes and modifications depart from the scope of the present invention, they should be construed as being included therein."],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENT(S)"],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["These and other objects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings that illustrate a specific embodiment of the invention. In the drawings:",{"@attributes":{"id":"P-00111","num":"00111"},"figref":"FIG. 1"},{"@attributes":{"id":"P-00112","num":"00112"},"figref":["FIG. 2","FIG. 1"],"b":"104"},{"@attributes":{"id":"P-00113","num":"00113"},"figref":["FIG. 3","FIG. 1"],"b":"124"},{"@attributes":{"id":"P-00114","num":"00114"},"figref":["FIG. 4","FIG. 1"],"b":"126"},{"@attributes":{"id":"P-00115","num":"00115"},"figref":["FIG. 5","FIG. 1"],"b":"143"},{"@attributes":{"id":"P-00116","num":"00116"},"figref":"FIG. 6"},{"@attributes":{"id":"P-00117","num":"00117"},"figref":"FIG. 7"}]},"DETDESC":[{},{}]}
