---
title: In-context security advisor in a computing environment
abstract: Provided is an in-context security advisor that unifies computer system security, and generally improves computer system security by proactively and reactively monitoring for changes to security settings made by users and programs. By operating in real time, advice comprising meaningful feedback is given for any intrusion, thus giving a user the proper context about the consequences of changes to security settings that negatively affect the level of protection on computer systems, and allowing automated correction. Files can also be monitored, e.g., to prevent certain files from being remotely accessed or transmitted. The security advisor may adjust its operation based on user preferences, policy information, and via a connection to a remote source such as a backend server. The security advisor can also output security-related information, such as to a log and/or to components that evaluate the overall health of the machine.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07437763&OS=07437763&RS=07437763
owner: Microsoft Corporation
number: 07437763
owner_city: Redmond
owner_country: US
publication_date: 20030605
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["FIELD OF THE INVENTION","BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION","Exemplary Operating Environment"],"p":["The invention relates generally to computer systems, and more particularly to computer security.","With the growth of computing in general, and the fact that much of today's computing revolves around connectivity to other computer systems to exchange information, security has become an important part of computing. Even though there are various ways users can protect their computer systems against external attacks, hackers are able exploit weaknesses in users' computer configurations, as well as weaknesses in human nature, to attack computers. In part, this is because contemporary security models are complex to users, and some security settings are difficult for users to understand, yet rely on the user to manage and make decisions on security.","For example, contemporary computer users have a number of security settings on their computers that are critical to providing protection from hackers, viruses and rogue programs. The critical nature of these settings dictates that they should not be altered by third parties without user permission, however this is often not the situation with users' computer systems as many malicious computer programs can easily change security settings on a computer without the computer user's explicit knowledge of the change or changes. Furthermore, users may intentionally attempt to change certain settings themselves without completely realizing the security impact of their actions, e.g., a user may lower the security level to temporarily allow some unusual behavior (such as to load a control from a trusted site), but then forget to restore the level to its higher setting.","In sum, users need some level of connectivity to other users' computers, yet have to balance this need for connectivity against some level of vulnerability. Security bulletins and the like are only effective to the extent that users read them and act accordingly. Antivirus programs, firewalls, security patches and other downloads can only prevent certain types of security issues from being exploited, and even then may be too late for many users. In sum, what is needed is a method and system that reduces the complexity of dealing with various security issues and can notify the user of various potential security vulnerabilities, at times when it matters, not after it is too late.","Briefly, the present invention provides a system and method that monitors and advises computer users in real-time as to security related events. This typically includes real-time monitoring for changes to security settings that are initiated by users or any third parties such as application programs that can affect (e.g., diminish) the level of protection on the computer systems, and informing users about the consequences of such changes. In one implementation, a user receives a warning from a security advisor service when a setting is changed or is about to be changed, along with an explanation as to why and\/or how the change will diminish the user's protection level. In this way, the user retains control of the machine's settings, but the security advisor can ensure that the user understands the consequences of any security-related action. Further, because the warning is in real-time, the warning appears in the current context of what the user is doing, helping the user recognize and understand the security issue.","In general a security service is provided in software to monitor a user's security settings in real-time. When any of the monitored security settings are changed or are to be changed, by the user or by some application, and the change is related to security (e.g., increases vulnerability), the security service acts in some way, such as to alert the user of the change, provide an explanation about the potential consequences of the change, and offer the user options and recommended solutions. The actions taken may be automatic or may involve the user, and may be based on user configurable action preferences, hardcoded data, downloaded data, performed by default data, or some combination of the above for the many possible security settings on a given machine. Per-user preferences allow the security advisor to operate differently for different users, e.g., default preferences and other settings may vary for a consumer home user versus a business user, an adult versus a child, a sophisticated user versus a novice user, an administrator versus a guest user, and\/or virtually any other distinctions that make sense. There may be any number of levels, e.g., a power user level may be somewhere between an administrator level and a guest level.","To monitor and advise, the security service, comprising an in-context security advisor (or simply a security advisor), monitors security-related events such as actual or proposed changes to security settings, and takes actions in response, such as outputting prompts to the user, writing to a log, and\/or possibly performing automated actions to prevent (e.g., block or undo) the change from potentially causing damage. The monitoring may be proactive, e.g., by hooking messages, APIs and so forth to monitor for changes to settings before the settings are actually changed, or reactive, e.g., by watching logs, the registry and other such data structures to note when changes have been made. Files can also be monitored by the present invention, e.g., to prevent certain files from leaving the machine.","Based on defaults and\/or user preference data, the in-context security advisor can educate users about potential security vulnerabilities and possible solutions, and make a recommendation at the time the security vulnerability is introduced, whether by explicit user action or implicit actions performed by other applications or users. This feature improves users' security awareness, exposes potential security attacks, and prepares users to make educated decisions, thereby increasing security and building trust with the computer user.","The security advisor is a dynamic service that can adjust its operation based on user preferences, policy information, and\/or via a connection to a backend server or the like. Automatic updates are performed from the backend server to give the security advisor updated information, such as information about new security attacks and what to do to prevent or correct them, to change default security settings to protect against certain known dangers, revise prompts and explanations, and so forth. The security advisor can also output security information to the backend server, as well as to logs and\/or to components that determine the overall health of the machine.","In one implementation, the in-context security advisor operates in an \u201calways on\u201d state to watch security settings in real-time, whereby advice may be given at the time of intrusion, thus giving a user (or a log) the proper context. Automatic correction may be provided to give the user the option to automatically correct and\/or block potential security threats.","Other advantages will become apparent from the following detailed description when taken in conjunction with the drawings, in which:",{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 1","b":["100","100","100","100"]},"The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems, environments, and\/or configurations that may be suitable for use with the invention include, but are not limited to: personal computers, server computers, hand-held or laptop devices, tablet devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.","The invention may be described in the general context of computer-executable instructions, such as program modules, being executed by a computer. Generally, program modules include routines, programs, objects, components, data structures, and so forth, which perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in local and\/or remote computer storage media including memory storage devices.","With reference to , an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of the computer  may include, but are not limited to, a processing unit , a system memory , and a system bus  that couples various system components including the system memory to the processing unit . The system bus  may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.","The computer  typically includes a variety of computer-readable media. Computer-readable media can be any available media that can be accessed by the computer  and includes both volatile and nonvolatile media, and removable and non-removable media. By way of example, and not limitation, computer-readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer-readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by the computer . Communication media typically embodies computer-readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer-readable media.","The system memory  includes computer storage media in the form of volatile and\/or nonvolatile memory such as read only memory (ROM)  and random access memory (RAM) . A basic input\/output system  (BIOS), containing the basic routines that help to transfer information between elements within computer , such as during start-up, is typically stored in ROM . RAM  typically contains data and\/or program modules that are immediately accessible to and\/or presently being operated on by processing unit . By way of example, and not limitation,  illustrates operating system , application programs , other program modules  and program data .","The computer  may also include other removable\/non-removable, volatile\/nonvolatile computer storage media. By way of example only,  illustrates a hard disk drive  that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive  that reads from or writes to a removable, nonvolatile magnetic disk , and an optical disk drive  that reads from or writes to a removable, nonvolatile optical disk  such as a CD ROM or other optical media. Other removable\/non-removable, volatile\/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive  is typically connected to the system bus  through a non-removable memory interface such as interface , and magnetic disk drive  and optical disk drive  are typically connected to the system bus  by a removable memory interface, such as interface .","The drives and their associated computer storage media, discussed above and illustrated in , provide storage of computer-readable instructions, data structures, program modules and other data for the computer . In , for example, hard disk drive  is illustrated as storing operating system , application programs , other program modules  and program data . Note that these components can either be the same as or different from operating system , application programs , other program modules , and program data . Operating system , application programs , other program modules , and program data  are given different numbers herein to illustrate that, at a minimum, they are different copies. A user may enter commands and information into the computer  through input devices such as a tablet, or electronic digitizer, , a microphone , a keyboard  and pointing device , commonly referred to as mouse, trackball or touch pad. Other input devices not shown in  may include a joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit  through a user input interface  that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor  or other type of display device is also connected to the system bus  via an interface, such as a video interface . The monitor  may also be integrated with a touch-screen panel or the like. Note that the monitor and\/or touch screen panel can be physically coupled to a housing in which the computing device  is incorporated, such as in a tablet-type personal computer. In addition, computers such as the computing device  may also include other peripheral output devices such as speakers  and printer , which may be connected through an output peripheral interface  or the like.","The computer  may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer . The remote computer  may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer , although only a memory storage device  has been illustrated in . The logical connections depicted in  include a local area network (LAN)  and a wide area network (WAN) , but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet. For example, in the present invention, the computer system  may comprise source machine from which data is being migrated, and the remote computer  may comprise the destination machine. Note however that source and destination machines need not be connected by a network or any other means, but instead, data may be migrated via any media capable of being written by the source platform and read by the destination platform or platforms.","When used in a LAN networking environment, the computer  is connected to the LAN  through a network interface or adapter . When used in a WAN networking environment, the computer  typically includes a modem  or other means for establishing communications over the WAN , such as the Internet. The modem , which may be internal or external, may be connected to the system bus  via the user input interface  or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer , or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation,  illustrates remote application programs  as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.","In-Context Security Advisor","The present invention is, in part, directed towards a service that may be within an overall computer security system, and includes an in-context security advisor component that performs real-time monitoring of security-related events. Among other characteristics, the service unifies various existing security mechanisms, such as antivirus, firewall and intrusion detection mechanisms, so that the user views security from a single, common source, rather than from multiple independent sources. Further, as will be understood, other security-related events are monitored by the service, such as those that the user performs, e.g., changing a registry setting, adding a guest account without a password, running a script that changes an internet security zone or changing one manually, running a macro, loading a control (e.g., an ActiveX\u00ae control) and so on. Applications can also change security settings and otherwise alter a system's security, e.g., by changing settings in the registry, by running script, accessing cookies, and so on, and the in-context security advisor monitors those events, also in real time.","Advice may be provided by the in-context security advisor, to educate users about potential security vulnerabilities and possible solutions, and to make a recommendation at the time the security vulnerability is introduced. This real-time advice can occur whether the security is being compromised by explicit user action or implicit actions performed by other applications or users. This feature improves users' security awareness, exposes potential security attacks, and prepares users to make educated decisions, thereby increases security and building trust with the computer user.","In general, the in-context security advisor comprises one or more software components that monitor a user's security settings in real-time. When any of these monitored security settings may be changed (either by the user or by some applications) in a manner that results in a security vulnerability, the in-context security advisor software may take an action, such as an automated action to prevent the change, and\/or to alert the user of the change, provide an explanation about potential consequences of the change, and offer the user options and recommended solutions. As will be understood, however, the present invention is not limited to any particular security events or actions, but rather has many applications in computer system security.","Turning to  of the drawings, there is provided an example representation of a security advisor  having an arbitrary number of coupled components that provide security-related information, directly or indirectly. In general, the security advisor  monitors security-related events and takes action based on those security-related events. Typical actions include outputting prompts to the user, writing to a log, outputting a value indicative of the state of security of the computer system, advising the user and further operating based on a user decision, automatically blocking a change to a setting, performing an automatic restoration of a changed setting, and receiving updates.","In one implementation, the security advisor  may monitor for security-related events in two general ways, namely proactively and reactively. Proactive monitoring is represented in  by the proactive event processor , connected via a unified interface , and generally refers to monitoring for changes to settings before the settings are actually changed. For example, messaging (such as messaging between windows) may be watched, subscribed events may be registered for notifications, and system or application settings and the like may be monitored. In general, anything that the security advisor  has enough knowledge about to hook, such as known application programming interface calls, may be proactively monitored, as represented in  by components numbered - (which also represent operating system settings, internet settings such as security zone-based settings, and so forth). The proactive event processor can ignore or discard anything irrelevant to security or which the security advisor  has decided not to take actions on.","In general, in one implementation, the user decides on how the communication with the security advisor is to occur, (e.g., what level of details to provide, such as based on how technical the user is), and what options the user should be provided with (e.g., whether the security advisor should let the user make every decision, or provide a recommended decision, or take automatic actions for the user). Note that in alternative implementations, the user may be allowed to control, at least to an extent, what information is being monitored, e.g., user preferences can maintain such information.","Files can also be monitored by the present invention. For example, a private file filter  may watch for files, as identified by signature, parent directory, filename, file identifier, file attributes or the like, represented in  by the block labeled . Actions involving those files can be detected, e.g., by a filter driver in the driver stack in a Windows\u00ae XP-based system, (or by the file system or in other ways) and a security-related action taken with respect thereto. For example, certain files could be prevented from being emailed to anyone, or accessed by a macro, regardless of access rights. A private file rules engine  may also be used to determine filtering criteria, e.g., do not allow a file to be accessed on weekends or emailed to someone other than a specific email address.","For other security-related components that cannot be hooked, such as third party antivirus products  and firewall\/intrusion detection (that evaluates network packets for known attacks) mechanisms , the respective log files  and  are watched to determine what happened with respect to security. A log file provider\/filter  reports relevant security-related log entries to the reactive event processor , which then calls the security advisor . As described below, the security advisor  can then take an appropriate action, such as based on a local known security attacks database , which contains knowledge of security attacks and what to do with them, which may include informing the user of what occurred via a user interface .","Similarly, application programs  can write to the system (or other) registry  or the like, which can impact security. The registry  can be monitored and filtered by a component , which likewise can report the event to the reactive event processor . Web applications can attempt to change defaults, e.g., to take over a default applications handler to change one default application to its own application program, which can be monitored.","As is understood, such components may be external to the security advisor , or may be incorporated into the security advisor . For example, the security advisor  may be implemented in a COM object having defined interfaces, whereby the proactive and reactive event processors  and  could plug into the security advisor . Alternatively, the proactive and reactive event processors  and  (and possibly the filters ,  and ) could be incorporated into the security advisor .","In this manner, the security advisor  acts as a centralized monitor for security-related events, particularly for changes to anything that involves a security setting. Typically these will be events that diminish security, but it is also possible to inform the user when security is increased, or even simply evaluated. For example, a user may want to know whether a website has attempted to run a script that accesses some security settings, even when no change is made.","It should be noted that the security advisor  is not a static program, but rather comprises a dynamic service. Thus, another aspect of the security advisor  represented in  is directed to policy information, in which the security advisor  can vary its operation based on policy and obtain the latest knowledge of new security attacks and what preventative or reactive actions to take against those attacks. For example, knowledge of and\/or actual attacks  detected on computer systems can be used to generate actions  that change the security advisor's behavior, e.g., to change security settings, block certain actions, perform automatic correction and\/or vary the warning given or the criteria for giving a warning. Time-based policies  may also apply, (e.g., more secure during hours when the office is closed), and\/or geography-based policies  (e.g., more secure when traveling). Other policies not shown, such as policy based on connecting to a different network, are also feasible. In general, anything that varies can be used as a criterion that alters the operation of the security advisor .","By way of an example explanation, in one implementation, the Local Known Security Attacks database  contains knowledge of security attacks and what to do with them (actions to take), while the event triggered policies  contain policy about what to do when a certain event occurs. For example, consider a virus attack that when run cleans out a user's main documents directory. The security advisor  obtains this knowledge from the backend  through its regular updates, which is written to the local database  by the security advisor . The data may include the signature of the virus, an explanation of the virus, any possible cure for the virus, or if there is no cure, what options user might have. The event triggered policies  has a policy that essentially states that in case a virus is found and a file is corrupted, the system should try to restore the original uninfected file from backups.","Another way in which the security advisor  operates as a dynamic service is via a connection  (e.g., internet-based) to a backend server . Automatic (or possibly manual) updates are performed to give the security advisor  whatever information it needs to better advise and protect users. External data sources  such as provided by a trusted program producer, can, for example, change default security settings to protect against certain known dangers, such as a malicious web site. Firewall-related data , internet-related data , antivirus-related data  and so forth can be downloaded to the security advisor  to influence its operation. Further, the security advisor  can report security issues to the backend server , whereby information about security is published, e.g., trends and the like among many security advisors on other users' machines can be detected and acted upon. In general, the backend server  continues to learn about new security risks and can regularly update the security advisor  based on the knowledge learned.","Another aspect of the security advisor  is directed to the output of security-related data to other programs and the like, represented in  by block . In general, the security advisor  can log security-related information and\/or output a score (or scores) based on the various security-related settings and security-related measures a user has active. For example, whether a user has an antivirus program with the latest signature can be reported (e.g., as a risk score), as well as the internet security zones, which can be used in a factor to report the overall health of a system to a user. The overall health can also feed back to the security advisor , e.g., to raise security so as to meet some minimal security level. Similarly, logged data can be intelligently processed, for example to see whether a lot of attacks have been attempted, and the security level altered (and\/or prompts changed) based on the security output log. This log  may be uploaded to the backend server .",{"@attributes":{"id":"p-0042","num":"0041"},"figref":"FIG. 3","b":["202","202","300"]},"In addition to (or instead of) outputting data, other actions are feasible, including proactively blocking a change to a security setting, or reactively undoing a change, which is possible if the prior setting is preserved, cleaning up a virus, and so forth. The actions may be automatic or set to be automatic, or proceeded by a prompt, and the prompt may be bypassed (e.g., a checkbox that can be set so as to not show a particular warning again).","The security advisor need not operate in the same way for each user, and indeed, a consumer home user may have very different preferences from a business user. Parents may have different preferences from children, and\/or preferences may vary based on a sophisticated user versus a novice user, or some level of sophistication. For example, a sophisticated user may want a lot of information about what occurred, whereas a novice user may want the machine set to automatically do what is correct from a security perspective. Default (and possibly some fixed) preferences may be obtained by subscription, by manually selecting a level, by defaulting relative to a group (e.g., administrator versus power user) or virtually any other selection and distribution criteria.","Turning to an explanation of the event handling logic ,  represents a general, logical flow of operations when a security setting has been modified (or is about to be modified). Step  represents determining whether the particular security setting is one that is monitored. As described above, user preference data and\/or policy data may factor in this decision. If not, the security monitor does nothing.","If the setting is one that is monitored, step  branches to step  which tests whether the user has previously indicated not to be alerted for this setting. User preference data is accessed for this information, although it should be noted that policy, time, and so forth may change or override this preference data, e.g., the user may be notified despite having requested not be alerted if policy changes the setting because a particularly bad attack is prevalent on the user's network. Typically, however, the user preference data may be left intact and honored.","Steps  and  are executed when the user is not to be alerted, and essentially represent extracting the event details, and logging the change event, whether actually performed or proposed and pending. Step  represents taking some automated corrective action, if any is set according to the user preference settings, such as undoing a change if made, blocking a pending change from being made, and so forth. Such an action would ordinarily likewise be logged.","If the user is instead to be alerted as determined at step , steps  and  are executed, and essentially represent extracting the event details, and logging the change event, whether actually performed or proposed and pending. Step  represents alerting the user to the change. The prompts may vary based on policy, and\/or downloading of new prompts. Step  represents taking some action, which may include making the change or blocking the change if not made, ignoring the change if made, resetting the setting at some later time (e.g., to allow a one-time exception), sending an email, and virtually any other action. Such an action, if resulting in something different from what is logged, would ordinarily likewise be logged. Note that it is possible to automatically perform an action and also notify a user as to what was done.","As can be seen from the foregoing detailed description, there is provided a method and system for handling the real-time monitoring of computer security-related events. The method and system are flexible and extensible, and provide users with a unified, comprehensive and meaningful in-context way to interact with security at an appropriate level. The method and system thus provide significant advantages and benefits needed in contemporary computing.","While the invention is susceptible to various modifications and alternative constructions, certain illustrated embodiments thereof are shown in the drawings and have been described above in detail. It should be understood, however, that there is no intention to limit the invention to the specific forms disclosed, but on the contrary, the intention is to cover all modifications, alternative constructions, and equivalents falling within the spirit and scope of the invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":["FIG. 3","FIG. 2"]},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 4"}]},"DETDESC":[{},{}]}
