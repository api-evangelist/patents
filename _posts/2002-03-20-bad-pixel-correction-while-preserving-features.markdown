---
title: Bad pixel correction while preserving features
abstract: A pixel correction system is provided. The pixel correction system includes a dynamic range detection system that receives test pixel data and adjacent pixel data and determines whether the test pixel data is within minimum pixel characteristic data and maximum pixel characteristic data of the adjacent pixel data. For example, if the pixel characteristic data is intensity, the dynamic range detection system detects bad pixels by identifying those pixels having an intensity value that is greater than the maximum intensity value of an adjacent pixel, or less than the minimum intensity value of an adjacent pixel. A dynamic range correction system coupled to the dynamic range detection system adjusts the test pixel data if the test pixel data is not within the maximum pixel characteristic data and the minimum pixel characteristic data, such as by setting the test pixel data equal to the maximum pixel characteristic data if the test pixel data is greater than the maximum pixel characteristic data, and by setting the test pixel data equal to the minimum pixel characteristic data if the test pixel data is less than the minimum pixel characteristic data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07064768&OS=07064768&RS=07064768
owner: ESS Technology, Inc.
number: 07064768
owner_city: Fremont
owner_country: US
publication_date: 20020320
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DETAILED DESCRIPTION OF THE INVENTION"],"p":["1. Field of the Invention","The invention relates to image processing and, more particularly, to bad pixel detection and correction within digital image processing that preserves features within the image.","2. Related Art","Conventional bad pixel detection and correction systems often employ multi-stage median filtering. The multi-stage median filtering is performed as shown below. For the 3\u00d73 pixel array:","a0, a1, a2","a3, A, a4","a5, a6, a7","where a0, a1, a2, a3, a4, a5, a6, and a7 are the neighboring pixels, the multi-stage median filtering process is performed as follows:","H=median (a3, A, a4)","V=median (a1, A, a6)","O=median (H, A, V)","SE=median (a0, A, a7)","NE=median (a5, A, a2)","D=median (SE, A, NE)","A\u2032=median (O, A, D)","One of the deficiencies of this conventional method of bad pixel correction is that three operations are needed to determine each median, and a total of twenty-one operations are performed for each pixel. The multi-stage median filtering process also must be performed on every pixel, instead of just those that are actually bad. Another conventional method for correcting bad pixels is normal median filtering, but this method must also be performed on every pixel, and can undesirably smooth detail features on the image.","In accordance with the present invention, a system and method for bad pixel detection and correction are provided that overcome known problems with systems and methods for bad pixel detection and correction.","In particular, a system and method for bad pixel detection and correction are provided that use dynamic range thresholds to determine whether a pixel is bad and to determine the correction factor.","In accordance with an exemplary embodiment of the present invention, a pixel correction system is provided. The pixel correction system includes a dynamic range detection system that receives test pixel data and adjacent pixel data and determines whether the test pixel data is within minimum pixel characteristic data and maximum pixel characteristic data of the adjacent pixel data. For example, if the pixel characteristic data is intensity, the dynamic range detection system detects bad pixels by identifying those pixels having an intensity value that is greater than the maximum intensity value of an adjacent pixel plus a threshold value, or less than the minimum intensity value of an adjacent pixel minus a threshold value. A dynamic range correction system coupled to the dynamic range detection system adjusts the test pixel data if the test pixel data is not within the maximum pixel characteristic data and the minimum pixel characteristic data, such as by setting the test pixel data equal to the maximum pixel characteristic data if the test pixel data is greater than the maximum pixel characteristic data, and by setting the test pixel data equal to the minimum pixel characteristic data if the test pixel data is less than the minimum pixel characteristic data.","The present invention provides many important technical advantages. One important technical advantage of the present invention is a system and method for bad pixel detection and correction that use dynamic range thresholds to determine whether a pixel is bad. If the pixel is bad, then the pixel characteristic data is replaced with characteristic data for one of the adjacent pixels. The thresholds for the present invention can be adjusted to accommodate detail levels so as to provide bad pixel detection and correction that does not impair detail resolution.","Other systems, methods, features and advantages of the invention will be apparent to one with skill in the art upon examination of the following figures and detailed description. It is intended that all such additional systems, methods, features and advantages be included within this description, be within the scope of the invention, and be protected by the accompanying claims.","A better understanding of the present invention can be obtained when the following detailed description of various exemplary embodiments is considered in conjunction with the following drawings.",{"@attributes":{"id":"p-0035","num":"0034"},"figref":"FIG. 1","b":["100","100"]},"System  includes pixel analysis system , which can be implemented in hardware, software, or a suitable combination of hardware and software, and which can be one or more hardware systems, or one or more software systems operating on a suitable processing platform. As used herein, a hardware system can be one or more semiconductor devices, an application specific integrated circuit, a field programmable gate array, or other suitable systems or components. A software system can include one or more objects, agents, lines of code, threads, subroutines, databases, application programming interfaces (APIs), or other suitable data structures, source code (human readable), object code (machine readable), and can include two or more different lines of code or suitable data structures operating in two or more separate software applications, on two or more different processing platforms, or in other suitable architectures. In one exemplary embodiment, a software system can include one or more lines of code or other suitable software structures operating in a general purpose software application, such as an operating system, and one or more lines of code or other suitable software structures operating in a specific purpose software application. In another exemplary embodiment, a software system can be implemented as a distributed software system, on a different processing platform than that shown in the exemplary embodiments herein, or in other suitable manners.","Pixel analysis system  is coupled to pixel data input and pixel data output. As used herein, the term \u201ccouple\u201d and its cognate terms such as \u201ccoupled\u201d and \u201ccouples\u201d can include a physical connection (such as through a conducting layer of a semiconductor device), a virtual connection (such as through randomly assigned memory locations of a data memory device), a logical connection (such as through one or more logical devices of a semiconducting circuit), other suitable connections, or a suitable combination of such connections. In one exemplary embodiment, systems and components are coupled to other systems and components through intervening systems and components, such as through an operating system of a digital signal processor.","Pixel analysis system  includes dynamic range detection system , dynamic range correction system , minimum characteristic system , maximum characteristic system , color zone system , threshold system , pixel testing system , non-color zone system , min\/max correction system , and threshold correction system , each of which can be implemented in hardware, software, or a suitable combination of hardware and software, and which can be one or more hardware systems or one or more software systems operating on a suitable processing platform.","Dynamic range detection system  receives pixel data for a plurality of pixels and determines whether each pixel is \u201cbad,\u201d meaning that it has characteristic data that is defined in error. In one exemplary embodiment, a pixel can include an eight-bit characteristic, such as intensity, as well as a color spectral content or other suitable data. Bad pixels can be created by data compression processes, noise introduced during data transmission, or in other manners. Dynamic range detection system  determines whether a test pixel is bad based on characteristic data from as few as two adjacent pixels and generates bad pixel flag data.","Dynamic range correction system  receives the bad pixel flag data from dynamic range detection system  for a test pixel and modifies the test pixel characteristic data to correct the bad pixel. In one exemplary embodiment, dynamic range correction system  can select pixel correction data based on the pixel characteristic data from one adjacent pixel.","Minimum characteristic system  and maximum characteristic system  of dynamic range detection system  determine the minimum and maximum pixel characteristic, respectively, for a set of adjacent pixels. In one exemplary embodiment, a set of adjacent pixels can be identified and minimum characteristic system  can determine the minimum characteristic value of the set, such as intensity. Likewise, maximum characteristic system  can determine the maximum characteristic value. The set of adjacent pixels can be selected by color zone system , non-color zone system , or other suitable systems. In this exemplary embodiment, color zone system  can select a set of adjacent pixels based on the color of the test pixel, on the pixel color distribution pattern type (such as a Bayer pattern), or other suitable data. Likewise, non-color zone system can select a set of adjacent pixels based on the proximity of the adjacent pixels to the test pixel, regardless of color. Other suitable processes can be used to select a set of adjacent pixels from which to select the maximum and minimum characteristic value.","Threshold system  can add or subtract a threshold from the minimum and maximum characteristic value determined by minimum characteristic system  and maximum characteristic system , respectively. In one exemplary embodiment, threshold system  can add the same quantity to the maximum characteristic value as is subtracted from the minimum characteristic value. In another exemplary embodiment, threshold system  can add a different quantity to the maximum characteristic value from what is subtracted from the minimum characteristic value. In yet another exemplary embodiment, threshold system  can add a quantity to the maximum characteristic value and subtract a different quantity from the minimum characteristic value based on user-entered values, values from two or more adjacent pixel zones, or other suitable criteria.","Pixel testing system  receives the test pixel data, the minimum characteristic data, and the maximum characteristic data, and determines whether the test pixel data is greater than the maximum characteristic data or less than the minimum characteristic data. In one exemplary embodiment, pixel testing system  can use the maximum characteristic data and minimum characteristic data that has been offset by the threshold data generated by threshold system . Pixel testing system  can then generate test result data that indicates whether the test pixel was within the maximum characteristic data and the minimum characteristic data, was greater than the maximum characteristic data, or less than the minimum characteristic data.","Min\/max correction system  and threshold correction system  receive the test result data and modify the test pixel data depending on the test result data. In one exemplary embodiment, min\/max correction system  and threshold correction system  receive operating mode data, such that min\/max correction system  is used to generate the modified test pixel data in a first mode and threshold correction system  is used to generate the modified test pixel data in a second mode. Min\/max correction system  decreases the value of the test pixel data to the maximum characteristic data if the value of the test pixel data is greater than the maximum characteristic data. Likewise, min\/max correction system  increases the value of the test pixel data to the minimum characteristic data if the value of the test pixel data is less than the minimum characteristic data. Threshold correction system  decreases the value of the test pixel data to the maximum characteristic data or the maximum characteristic data plus the threshold data if the value of the test pixel data is greater than the maximum characteristic data plus the threshold data. Likewise, threshold correction system  increases the value of the test pixel data to the minimum characteristic data or the minimum characteristic data minus the threshold data if the value of the test pixel data is less than the minimum characteristic data minus the threshold data.","In operation, system  performs dynamic range bad pixel detection that detects whether a test pixel is a bad pixel based on pixel characteristic data of adjacent pixels, and dynamic range pixel correction that replaces the test pixel with an appropriate adjacent pixel or other suitable data if the test pixel is determined to be a bad pixel. If the pixel characteristic of the test pixel, such as intensity or color spectral content, is greater than the largest characteristic value of an adjacent pixel by more than a predetermined amount, then the test pixel data is replaced with the data for that adjacent pixel. Likewise, if the pixel characteristic of the test pixel is less than the smallest characteristic value of an adjacent pixel by more than a predetermined amount, then the test pixel data is replaced with the data for that adjacent pixel. In this manner, pixels can be analyzed to determine whether they are bad pixels, where the analysis is performed using a small number of operations and in a manner that does not result in a loss of detail.",{"@attributes":{"id":"p-0046","num":"0045"},"figref":"FIG. 2","b":["200","200","1","201","2","202","1","1","201","2","202"]},{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 3","b":["200","200","1","201","2","202","1"]},{"@attributes":{"id":"p-0048","num":"0047"},"figref":"FIG. 4","b":["200","200","210","212"]},{"@attributes":{"id":"p-0049","num":"0048"},"figref":"FIG. 5","b":["200","200","210","212"]},{"@attributes":{"id":"p-0050","num":"0049"},"figref":"FIG. 6","b":["200","201","200","3","203"]},{"@attributes":{"id":"p-0051","num":"0050"},"figref":"FIG. 7","b":["200","201","3","203"]},{"@attributes":{"id":"p-0052","num":"0051"},"figref":"FIG. 8","b":["300","300"]},"Bad pixel correction process  includes exemplary pixel  location , pixel  location , and pixel  location . For pixel  location , maximum  with a corresponding threshold  and minimum  with a corresponding threshold  are used to perform re-mapping of the pixel  location  between a zero intensity level and a saturation level in accordance with the present invention. In this exemplary embodiment, the zero intensity level is shown as having a \u201c0\u201d value, and the saturation level is shown as having a \u201c255\u201d value, such as when an eight bit image data system is used. The difference between the maximum  and threshold  can be equal to the difference between threshold  and minimum . Likewise, the difference between the maximum  and threshold  can be different from the difference between threshold  and minimum , can be selected based on pixel variability characteristics for surrounding pixels, or can otherwise be adjusted to accommodate for local image data variations. Threshold  and threshold  can be user-defined, adaptively calculated using different color adjacent pixels for color-independent pixel characteristics, adaptively calculated using same color adjacent pixels for color-dependent pixel characteristics, or other suitable procedures can be used to select or determine threshold  and .","When the pixel characteristic for pixel  location  is above the threshold  above the maximum , then the characteristic value of the pixel  location  is re-mapped to the maximum . In another exemplary embodiment, the characteristic value of the pixel  location  can be re-mapped to the threshold . Similarly, when the pixel characteristic is below the threshold  below the minimum , then the characteristic value of the pixel  location  is re-mapped to the minimum , or the threshold  in another exemplary embodiment.","Pixel  location  and pixel  location  demonstrate minimum, maximum, and corresponding threshold values for other exemplary pixels. Maximum  and minimum  of pixel  location  are different from maximum  and minimum  of pixel  location, thus demonstrating how the maximum and minimum values can be dynamically assigned based on the values of adjacent pixels. Maximum  and minimum  of pixel  location  demonstrate a potential problem that can be encountered, wherein threshold  of maximum  exceeds the saturation value for a pixel characteristic. In this exemplary embodiment, the threshold  is re-assigned to the saturation value. A similar process is implemented when the threshold  for the minimum  is less than the zero characteristic value.",{"@attributes":{"id":"p-0056","num":"0055"},"figref":"FIG. 9","b":["500","300","500"]},{"@attributes":{"id":"p-0057","num":"0056"},"figref":"FIG. 10","b":["600","600","610","620"]},"At , the test pixel is compared to the dynamic range. In one exemplary embodiment, the characteristic for the test pixel can be compared to the maximum and minimum characteristic values for adjacent pixels, to maximum and minimum characteristic values for adjacent pixels that have been offset by a threshold amount, or other suitable values. The method then proceeds to , where it is determined whether the test pixel is a bad pixel. If it is determined that the test pixel is not a bad pixel, then the method terminates for that pixel, and the next test pixel can be processed. If it is determined at  that the test pixel is a bad pixel, then the method proceeds to .","At , it is determined whether different thresholds or minimum\/maximum values are used to perform bad pixel correction as compared to those that are used to perform bad pixel detection. If the thresholds or minimum\/maximum values are not different, the method either proceeds to , where the pixels are remapped to the threshold values, or to , where the pixels are remapped to the corresponding maximum or minimum value. In one exemplary embodiment, if a pixel has a characteristic that is less than the minimum value for that characteristic or the minimum value minus a threshold, it is mapped to the minimum value or the minimum value minus the threshold. Likewise, if a pixel has a characteristic that is greater than the maximum value for that characteristic or the maximum value plus a threshold, it is mapped to the maximum value or the maximum value plus the threshold.","If it is determined at  that the thresholds are different, then the method proceeds to  where new thresholds or minimum\/maximum values are calculated. The method then proceeds to  where the pixel is mapped to the new threshold or minimum\/maximum value.","In operation, bad pixel correction method  provides for the detection and correction of bad pixels based on dynamic range thresholds. Method  thus allows bad pixel correction to be performed using less processing resources than other methods, and avoids the inadvertent elimination of detail that can be encountered using prior art methods by assigning threshold values at a level that does not remove detail.",{"@attributes":{"id":"p-0062","num":"0061"},"figref":"FIG. 11","b":["700","700","710","720","730"]},"If it is determined that the test pixel is a bad pixel, then the method proceeds to  where it is determined whether any thresholds used to perform bad pixel correction are predetermined or not. If the thresholds are not predetermined the method proceeds to  where a selection is made of the zone, the trajectory, and\/or the pixels that are to be used to perform the necessary calculations to determine the thresholds. The method then proceeds to  where the correlation of the selected pixels is calculated. The method then proceeds to  where the thresholds are then calculated. The method then proceeds to  where it is determined whether the maximums and minimums are predetermined.","In one exemplary embodiment, the method proceeds from 760 to 790 where the new thresholds are re-mapped to the old thresholds. In yet another exemplary embodiment, the pixels outside of the maximums and minimums are re-mapped to the maximums and minimums as shown in .","If it is determined at  that the thresholds are predetermined, then the method proceeds to  where it is determined whether the maximums and minimums are predetermined. If the maximums and minimums are predetermined, then the method proceeds to  and the pixels outside of the thresholds are re-mapped to the maximums and minimums. If the maximums and minimums are not predetermined, then the method proceeds to  where the maximums and minimums are calculated. The pixels outside of the thresholds are then re-mapped to the maximums and minimums as shown in , or the pixels outside of the maximums and minimums are mapped to the maximums and minimums as shown in .","While various embodiments of the invention have been described, it will be apparent to those of ordinary skill in the art that many more embodiments and implementations are possible that are within the scope of this invention."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS","p":["The components in the figures are not necessarily to scale, emphasis instead being placed upon illustrating the principles of the invention. In the figures, like reference numerals designate corresponding parts throughout the different views.",{"@attributes":{"id":"p-0023","num":"0022"},"figref":"FIG. 1"},{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIG. 2"},{"@attributes":{"id":"p-0025","num":"0024"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0026","num":"0025"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0027","num":"0026"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0028","num":"0027"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0031","num":"0030"},"figref":"FIG. 9"},{"@attributes":{"id":"p-0032","num":"0031"},"figref":"FIG. 10"},{"@attributes":{"id":"p-0033","num":"0032"},"figref":"FIG. 11"}]},"DETDESC":[{},{}]}
