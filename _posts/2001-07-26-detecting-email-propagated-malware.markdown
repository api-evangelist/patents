---
title: Detecting e-mail propagated malware
abstract: An e-mail client serves to detect mass mailing malware by detecting if over a threshold number of addressees from within the address book of that e-mail client are being sent an e-mail or over a predetermined number of substantially identical e-mails are being sent by that e-mail client. A quarantine queue may be provided in which e-mail messages are held for a predetermined period prior to being sent out in order that separate e-mail messages being sent to a large proportion of the address book addressees may be identified and linked together.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07673342&OS=07673342&RS=07673342
owner: McAfee, Inc.
number: 07673342
owner_city: Santa Clara
owner_country: US
publication_date: 20010726
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","SUMMARY OF THE INVENTION","DESCRIPTION OF THE PREFERRED EMBODIMENTS"],"p":["1. Field of the Invention","This invention relates to data processing systems. More particularly, this invention relates to the detection of e-mail propagated malware.","2. Description of the Prior Art","Some of the most prolific and damaging computer viruses in recent times have replicated and distributed themselves by use of the victim's e-mail service. The virus is received in an e-mail and when activated serves to replicate and send itself to most, if not all, of the e-mail addresses listed in the victim's e-mail address book. The infected e-mail is then received by another unsuspecting user who again causes it to replicate it propagate.","Network Associates, Inc. provide a server based computer program called Outbreak Manager that operates upon an e-mail server to detect patterns of mail traffic behaviour indicative of such a virus outbreak and progressively to apply counter-measures against that outbreak. This activity necessarily places a data processing load upon the e-mail server and tends to detect a virus outbreak only when this has escalated to at least some extent of mass behaviour.","A further mechanism for suppressing mass mail viruses is described in commonly assigned co-pending Application No.: U.S. Ser. No. 09\/678,688, the disclosure of which is incorporated herein by reference.","Viewed from one aspect the present invention provides a computer program product operable to control an e-mail client computer to detect e-mail propagated malware, said computer program product comprising:\n\n","The invention recognises that an e-mail client computer can act to detect many mass mailing malware problems since this type of malware will often produce characteristic and abnormal behaviour on the e-mail client computer itself which behaviour may be detected and used to trigger action to stop the outbreak at an early stage. Furthermore, placing a processing load upon the client computers rather than the e-mail server distributes the processing load more widely in an advantageous fashion. The characteristic behaviour on the e-mail client computer itself can take a variety of forms, but is at least one of generating an e-mail message sent to greater than a given number of addressees within the address book associated with that client computer (either as a single e-mail or as a series of e-mails sharing substantially the same message content) or as a series of e-mail messages containing substantially the same message content exceeding a predetermined threshold number.","It will be appreciated that the threshold number of addressees within the address book could be defined in a variety of different ways. As an example, it could be defined as an absolute number, but in preferred embodiments is defined as a predetermined (user specified) proportion of the total number of addressees within the address book.","The message content of e-mail messages could be compared in a variety of different ways. E-mail messages could be identified as similar only when they were identical. However, in order to provide protection against malware which seeks to disguise itself, preferred embodiments of the invention identify message content as the same when a predetermined level of similarity is detected, such as for example by using known algorithms like those found within the WinDiff program.","In order to help resist mass mailed malware which propagates itself as a sequence of separate e-mail messages directed to individual addressees (or a relatively small number of addressees), preferred embodiments of the invention utilise a quarantine queue from which outbound messages are held for a predetermined period before being sent on. This allows messages to be compared with one another to identify those having above a predetermined level of similarity in order that they may be identified as potentially carrying malware and appropriate counter-measures triggered.","The non-realtime nature of e-mail delivery and the relatively high processing speeds of e-mail systems are such that the quarantine period may be kept relatively low, say several seconds, without producing a noticeable impact on the system performance for a user and yet sufficient time for a sequence of related e-mails to be generated by a malware program and accordingly detected before the first of those e-mails is sent from the client computer out to the addressee.","It will be appreciated that the characteristics of mass mailed malware discussed above are not necessarily definitive as there may be good reasons why a genuine e-mail message, or sequence of e-mail messages, may be generated by a user and yet have these properties. Accordingly, preferred embodiments of the invention act to trigger user confirmation of the nature of an e-mail message identified as potentially containing malware before it is issued.","Patterns of behaviour within an administered group of computers or patterns of behaviour of an individual user may be more readily recognised in preferred embodiments in which when an item of potential malware is identified a message is sent to an administrator of the system.","Preferred embodiments of the invention may speed processing by seeking to identify potential malware only within e-mail messages that have an executable element (e.g. an executable attachment or HTML body) as an executable payload is required by a virus propagating e-mail.","Further aspects of the invention provide a method for detecting malware within a client computer and an apparatus for detecting malware within a client computer.","The above, and other objects, features and advantages of this invention will be apparent from the following detailed description of illustrative embodiments which is to be read in connection with the accompanying drawings.",{"@attributes":{"id":"p-0024","num":"0029"},"figref":"FIG. 1","b":["2","2","4"]},"Disposed between the e-mail client computer program  and the operating system  is the anti-virus mechanism . In  example this anti-virus mechanism  serves to receive all MAPI requests from the e-mail client computer program  and generate any MAPI responses to the e-mail client computer program . The anti-virus mechanism  has a further interface with the operating system  to which the intercepted messages are sent or from which intercepted messages are received. Having intercepted this traffic, the anti-virus mechanism  can apply the techniques described hereinafter to resist mass mailing malware.",{"@attributes":{"id":"p-0026","num":"0031"},"figref":"FIG. 2","b":["4","8","8","4","2"]},"Both the arrangement of  and  will be familiar to programmers in the application program field as ways of adding new functionality in combination with existing programs and mechanisms by redirecting and intercepting messages passed between those programs and mechanisms.",{"@attributes":{"id":"p-0028","num":"0033"},"figref":"FIG. 3","b":["10","12","14","16","18","20","20","22","20","20"]},"If at step  the user confirmed the message was to be sent then processing proceeds to step  at which the e-mail is sent out from the client computer.","If the test at step  did not indicate that the threshold was exceeded, then processing proceeds to step . Step  determines whether or not e-mail message contains executable material, such as any executable attachments or an HTML body which could be executable. If the e-mail message does not have any executable content, then it may not serve as a vector for a virus and accordingly processing proceeds to step  at which the e-mail message is sent. However, if the test at step  indicates executable content, then processing proceeds to step  at which the e-mail message is added to a quarantine queue as will be described below.","After any one of steps ,  and  processing of the e-mail message generated terminates for this processing flow and the system returns to step  to await generation of the next e-mail message.",{"@attributes":{"id":"p-0032","num":"0037"},"figref":["FIG. 4","FIG. 3"],"b":["30","28","32","34","36","38"]},"At step  the updated score values are compared with threshold values, which again may be user or administrator specified. At step  any message which is now exceeding one of the threshold values is identified. If no message is identified, then processing of this received e-mail message terminates and the system returns to step  to await the next e-mail message. If an e-mail message does cause a threshold to be exceeded at step , then processing proceeds to step  at which a user and\/or administrator warning message is generated giving details of the message exceeding the threshold value. At step  the user's confirmation that the message should be sent is sought. Depending upon the user's input, the message is either sent at step  or deleted at step  before processing again returns to step .",{"@attributes":{"id":"p-0034","num":"0039"},"figref":["FIG. 5","FIG. 5"],"b":["52","54"]},{"@attributes":{"id":"p-0035","num":"0040"},"figref":"FIG. 6","b":["200","200","202","204","206","208","210","212","214","216","218","220","222","202","204","206","208","204","200","212","210","200","216","218","214","220"]},"It will be appreciated that the general purpose computer  operating under control of a suitable computer program may perform the above described techniques and provide apparatus for performing the various tasks described. The general purpose computer  also executes the method described previously. The computer program product could take the form of a computer readable storage medium bearing the computer program, such as a floppy disk, a compact disk or other computer readable storage medium. Alternatively, the computer program could be dynamically downloaded via the network interface unit .","It will be appreciated that the general purpose computer  is only one example of the type of computer architecture that may be employed to carry out the above described techniques. Alternative architectures are envisaged and are capable of use with the above described techniques.","Although illustrative embodiments of the invention have been described in detail herein with reference to the accompanying drawings, it is to be understood that the invention is not limited to those precise embodiments, and that various changes and modifications can be effected therein by one skilled in the art without departing from the scope and spirit of the invention as defined by the appended claims."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0019","num":"0024"},"figref":"FIGS. 1 and 2"},{"@attributes":{"id":"p-0020","num":"0025"},"figref":"FIG. 3"},{"@attributes":{"id":"p-0021","num":"0026"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0022","num":"0027"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0023","num":"0028"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
