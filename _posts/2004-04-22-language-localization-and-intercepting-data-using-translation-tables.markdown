---
title: Language localization and intercepting data using translation tables
abstract: A system for providing translations of applications for operation in a non-native language. The translation makes use of associated tables either existing within the operating system or at locations outside of the operating system. The translation system makes use of application based translations tables that may also interrelate with core translation tables and community translation tables, prior to sending the data to a graphical interface.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07721271&OS=07721271&RS=07721271
owner: Microsoft Corporation
number: 07721271
owner_city: Redmond
owner_country: US
publication_date: 20040422
---

{"@attributes":{"id":"description"},"BRFSUM":[{},{}],"heading":["BACKGROUND OF THE INVENTION","BRIEF SUMMARY","DETAILED DESCRIPTION OF THE DRAWINGS"],"p":["1. Technical Field","Aspects of the present invention relate to software products. More particularly, aspects of the present invention relate to providing users with application content in a local language.","2. Description of Related Art","Computing systems exist in a number of languages. A number of software applications and operating systems are created in a first language then ported over to other languages. This is sometimes referred to as localization of the applications and operating systems. However, a number of software applications are never translated into other languages. These applications remain available only in their source language for a variety of reasons. Sometimes the high cost of localization is not expected to be met by sales of applications in other languages. Other times, the software developer may lack the skills needed to effectively translate or have translated the nuances of an application into other languages. These and other reasons bar users of different languages from using applications that have not been translated into their specific languages.","A conventional process of creating applications in more than one language is shown in . An application is created in a first language in step . Next, a developer may translate the application into a second language in step . The conventional process of creating applications in more than one language is through the use of localization tools. Either resource files are localized and the product is re-compiled, or tools that do not require the re-compiling of the application are used.","Some techniques exist to allow applications to be more easily translated for users of other languages. First, some systems provide links to automated machine translation dictionaries that are accessed in real-time to translate text to be displayed to a user into that user's local language. Here, the automated machine translation dictionaries have no knowledge of terms as used in an application. The selected translation typically has nothing in common with previously translated words. A difficulty with this approach is that mere mechanical dictionary translations are of generally poor quality. File in a source language (relating to the act of accessing a location for a document) may be translated as a metal sharpening device using mere dictionary translations.","Second, as shown in , an application  may include with it an application translation resources . The core of application  may be written in a first language. However, when text is to be output to a display or printer or other device or medium, the application  accesses the application translation text in application translation resources . The application  obtains corresponding entries in text of translation resources  relating to expected text messages and their translated equivalents. The translated equivalents are forwarded to graphic device interface (GDI) , rendered, and output to a display .","Three issues exist with the system of . First, unless the application translation resources  are provided, no robust translation of the application  will exist. Second, some of the information provided by application  may be generated from the operating system, not application  directly. If the operating system supporting application  is localized to a first language and application  is localized to a second language, the user may be forced to receiving messages in both the first and second languages. Third, if an application exists already without translation resources , then potential users may not have the ability to use application  in their language until translation table  is created and integrated into application .","Aspects of the present invention address one or more of the issues mentioned above, thereby providing applications to users of different languages. Aspects of the invention include the use of operating system-level translation tables that may be used alone or in conjunction with other translation tables to provide translations of messages.","These and other aspects are addressed in relation to the Figures and related description.","Aspects of the present invention relate to providing an ability to translate applications and operating systems. Through using an operating system-level translation table alone or in combination with other translations tables (including application-specific translation tables and community translation tables), applications may be able to be used in other languages.","The following is separated into various sections to assist the reader. These headings include: general-purpose computing environment; table-based localization; location of translation tables; operating system integration; and examples of translation table usage.","General-Purpose Computing Environment",{"@attributes":{"id":"p-0024","num":"0023"},"figref":"FIGS. 1 and 2","b":["100","201","100","201"]},"Aspects of the invention may be described in the general context of computer-executable instructions, such as program modules, executed by one or more computers or other devices. Generally, program modules include routines, algorithms, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Typically, the functionality of the program modules may be combined or distributed as desired in various embodiments.","Computing device systems  and  typically include at least some form of computer readable media. Computer readable media can be any available media that can be accessed by server  or system . By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by server  or system . Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.","With reference to , an illustrative system for implementing aspects of the invention includes a computing device, such as device . In its most basic configuration, device  typically includes a processing unit  and memory . Depending on the exact configuration and type of computing device, memory  may be volatile (such as RAM), non-volatile (such as ROM, flash memory, etc.) or some combination of the two. Additionally, device  may also have mass storage (removable and\/or non-removable) such as magnetic or optical disks or tape -. Similarly, device  may also have input devices such  (including a mouse, stylus, keyboard, trackball, and the like) and\/or output devices  such as a display and the like. Other aspects of device  may include network connections  to other devices, computers, networks, servers, etc. using either wired or wireless media . All these devices are well know in the art and need not be discussed at length here.","Table-Based Localization","Applications may provide translations to users using aspects of the present invention. In some aspects of the present application, the operations of the present may be described as occurring at one or more levels: an application level and\/or an operating system level.","The operating system may provide an engine that allows fast translations by comparing intercepted text destined for a system resource loader or GDI with a stored table of translated text. The stored table may have translations of each term individually and\/or may include only strings of text. The strings may be the entire content or sentences displayed to a user in a menu\/button\/dialog box and the like. One advantage of having corresponding translations of strings of text is that the meaning of terms in the strings is maintained. This way the resulting translation will always correspond to the source text.","The engine may reside in the operating system or elsewhere. Where there is no translation table designated, the engine may pass on the intercepted system resource loader or GDI calls to their intended destinations. One advantage of placing the engine at the operating system level is that application developers may need to modify their code less if at all to provide translations of their applications. In some situations, the application developers may desire to use only the translation table accessed by the operating system. In other situations, the application developers may desire to provide additional or alternative translation tables in order to accomplish the following:\n\n",{"@attributes":{"id":"p-0031","num":"0033"},"figref":"FIG. 4","b":["401","403","402","402","401","402"]},"The redirecting engine allows the interception and eventual redirection of the content of the user interface's resource element data exchanges between the application , the system resource loader  and the system GDI .","The translation tables (including the operating system's translation tables(s) and the application(s) translation tables) take advantage of the engine's functionality to offer an alternative source of data containing UI elements in the desired target language. The operating system's translation table may include items from the generic operating system. It may or may not also include terminologies from popular applications. For simplicity, the operating system's translation table whether or not including terminologies from popular applications is referred to as a \u201ccore translation table\u201d. Application developers may supplement the operating system's translation table by including application specific translation tables.","The nature of the translation tables may be a unidirectional mapping from a single source language to a single target language. Alternatively, the translation tables may a bi-directional mapping between the source and target languages. Further, the translation tables may be mappings (unidirectional or bidirectional) between a single source language and multiple target languages. The specification of the target language helps determine which of the target languages to use.",{"@attributes":{"id":"p-0035","num":"0037"},"figref":["FIGS. 5A and 5B","FIG. 5A"],"b":["501","501","502","503","504","505","503","504","506","507","501"]},"If no match is found in step  (because of no match or no application translation table exists), then the system looks up the data against core translation tables in the target language in step . If a match is found in step , then the system performs step  and continues from there. If no match is found in step , then the application is redirected to the resource loader or GDI for normal processing.",{"@attributes":{"id":"p-0037","num":"0039"},"figref":["FIG. 5B","FIG. 5A"],"b":["509","511","512","506","5","512","513","514","506","514","510"]},"Step  is shown in greater detail in . The simplification and normalization processes may include one or more of the following:\n\n","The results, modifications, or description of modifications made to data in the simplify and normalize step  as shown in  may be stored in storage . For example, the modification from \u201cOpen\u201d to \u201copen\u201d may be stored as any of \u201cOpen\u201d and \u201copen\u201d, \u201cO\u201d and \u201co\u201d, or some representation of the first character being changed to lower case. Similarly, the removal of the control characters and the cross referencing may be stored as well for future use.","Referring again to , community-built translation tables in step  may be generated by entities to be used when the developer has not created an application translation table. Alternatively, communities may develop translation tables to supplement or augment existing translation tables. For instance, users may determine that provided translation tables are insufficient in some instances. The community may create a translation table for use with the application. A user may be able to designate the order in which the translation tables are used. In this example of a community creating a translation table, the user may designate the community translation table to be use prior to an application specific translation table then the core translation table.","Communities may provide the community-built translation tables, for instance, to address new translation of uncovered terminology or translation for new languages through a community effort via a community glossary. As described above,  is optional in that applications may be competently localized into another language using the process in .","Machine translation  may or may not be an option. In some instances, machine translation dictionaries may not exist that bridge source and target languages.","Step  may include the restoration of hotkeys by using the source or target language. One benefit of using the source language to regenerate hotkeys is that associations in the application or operating system may remain.","The engine that intercepts the data exchange in step  may be embodied in a number of ways including as combination of a dynamic link library and a database. For example, the dynamic link library may be responsible for one or more of the following tasks:\n\n","If using the Microsoft Windows\u00ae operating system, a registry key may be created, for example under HKEY_CURRENT_USER\\Software\\MAT\\ to store one or more of the following values:\n\n","For other implementations, different storage locations may be used.","In some cases, for instance with non-Unicode applications, a matching system locale may be needed to properly display the user interface elements in the language desired by the user. In these cases, if the target language is not handled by the currently set system locale, the system may attempt to simulate the matching system locale. These processes may occur in the background to a user when a list of target applications is predefined and non-Unicode applications are identified.","The database component of the engine may include a file that includes the list of applications and also tags non-Unicode applications.","The system may provide a user interface to a user to modify how data to be translated is addressed.  shows a user interface that provides these options including whether or not an application should be translated, the source and destination languages, and the size by which to enlarge windows. Further, the process by default may launch approved applications in the same language as the running operating system.","Here, end users can decide either not to localize the target language or to launch the application in an alternative language. Also, as above, the resizing value for windows and dialog boxes to compensate for text size increase induced by translation. A further editor may be provided to developers that allow them to extract their application's UI elements and provide new\/alternative translation for them. The editor allows the developer to create a translation table binary file to be shipped along their application.","Location of Translation Tables","The location of translation tables may vary.  shows various examples of where the translation tables may be located. Application translation table(s) , core translation table(s) , and community translation table(s)  may be located locally or remotely as shown my dividing line . Remotely may include over the internet or other remote location.","The user's system  with processor  may use the translation tables - in a variety of ways. First, the user's system may access the translation tables directly and use them while running an application (as shown by the arrows between the translation tables - and system . Second, the translation tables may be installed locally in system  as  and accessed directly. Third, the translation tables may be placed at a local location as represented by local translation table(s) . These three approaches may be used in varying combinations.","Operating System Integration",{"@attributes":{"id":"p-0053","num":"0070"},"figref":"FIG. 8","b":["801","802","804","803","804","801","805","806","807"]},"Examples of Translation Table Usage",{"@attributes":{"id":"p-0054","num":"0071"},"figref":["FIGS. 9-11","FIG. 9"],"sub":["1 ","1","N "],"b":["901","902","903","904","905","906"]},"In , application translation table(s)  is added to the example of .","In , the system only uses the community table(s)  and real-time translation  to translate the application .","Aspects of the present invention have been described in terms of illustrative embodiments thereof. Numerous other embodiments, modifications and variations within the scope and spirit of the appended claims will occur to persons of ordinary skill in the art from a review of this disclosure."],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":["Various aspects of the present invention are illustrated in the attached figures.",{"@attributes":{"id":"p-0013","num":"0012"},"figref":"FIGS. 1 and 2"},{"@attributes":{"id":"p-0014","num":"0013"},"figref":"FIGS. 3A and 3B"},{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIGS. 5A and 5B"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 6"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 7"},{"@attributes":{"id":"p-0019","num":"0018"},"figref":"FIG. 8"},{"@attributes":{"id":"p-0020","num":"0019"},"figref":"FIGS. 9 through 11"},{"@attributes":{"id":"p-0021","num":"0020"},"figref":"FIG. 12"}]},"DETDESC":[{},{}]}
