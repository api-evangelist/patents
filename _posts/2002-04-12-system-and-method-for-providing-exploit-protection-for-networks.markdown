---
title: System and method for providing exploit protection for networks
abstract: A method and system for providing protection from exploits to devices connected to a network. The system and method include a component for determining whether an encapsulation has been applied to an attachment and unencapsulating such encapsulated attachments, a component that performs at least one decompression of the attachment when the attachment is compressed, a component that determines whether a header, body, and/or attachment of a message includes an exploit, and a component that holds and optionally cleans messages that include exploits. A device that receives messages that are directed to the network employs the components above to provide exploit protection for at least one of the messages.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07134142&OS=07134142&RS=07134142
owner: Nokia Inc.
number: 07134142
owner_city: Irving
owner_country: US
publication_date: 20020412
---

{"@attributes":{"id":"description"},"RELAPP":[{},{}],"heading":["RELATED APPLICATION","FIELD OF THE INVENTION","BACKGROUND","SUMMARY","DETAILED DESCRIPTION"],"p":["This application is a Utility Patent application based on a previously filed U.S. Provisional Patent application, U.S. Ser. No. 60\/283,757 filed on Apr. 13, 2001, the benefit of the filing date of which is hereby claimed under 35 U.S.C. \u00a7 119(e).","The present invention relates to computer network security, and in particular to exploit protection for networks.","The Internet connects millions of nodes located around the world. With the click of a button, a user in one part of the world can access a file on another computer thousands of miles away. In addition, the Internet has facilitated the exchange of information in the form of electronic messages known as email. Although, first used to transfer short text messages, email can now be used to send digital pictures, sound files, documents, spreadsheets, executable programs, and other electronic files. Sending such files is as easy as attaching them to an email message and clicking a send button.","The ease of transmitting information, however, has also been exploited by some for other purposes. One of the first well-publicized cases of exploitation involved using email servers to propagate a program. Once an email server became \u201cinfected\u201d with the program, it would begin sending email messages containing the program to other email servers that it was aware of. Like a virus, the program spread from email server to email server with amazing speed. Although the program did not erase files or harm data on the email servers, because of the volume of email messages sent by the infected email servers, the program caused retrieval of email messages from email servers to slow to an excruciating pace.","Now, the news reports virus-like programs (hereinafter \u201cexploits\u201d) on an almost daily basis. Some of these exploits are relatively benign; others destroy data or capture sensitive information. Unless properly protected against, these exploits can bring a company's network or email system to its knees or steal sensitive information, even if only a few computers are infected.","The most prevalent method for dealing with these exploits is to install virus protection software on every computer. As soon as a version of virus protection software is released, those seeking to circumvent the exploit protection software create new exploits that are not recognized by the virus protection software. This prompts virus protection software developers to create updates for their virus protection software to detect these new exploits. Previously, updating the virus protection software on each computer required obtaining the updates on disk and going from computer to computer to install the updates. Now, virus protection software allows computer users to download updates using the Internet. Since installing updates requires effort on the part of each user (or a computer support team), quite often the virus protection software is not brought up-to-date on every computer. In addition, there is often a significant delay between the introduction of a new virus and the creation and distribution of an update aimed to protect against the new virus. Additionally, virus protection software typically does not protect against the more general class of virus-like programs known as exploits.","In accordance with the present invention, there is provided a method and system for providing protection from exploits to devices connected to a network. The system and method include a component for determining whether an encapsulation has been applied to an attachment and unencapsulating such encapsulated attachments, a component that performs at least one decompression of the attachment when the attachment is compressed, a component that determines whether a header, body, and\/or attachment of a message includes an exploit, and a component that holds and optionally cleans messages that include exploits. A device that receives messages that are directed to the network employs the components above to provide exploit protection for at least one of the messages.","In one aspect of the invention, the message includes a header, a body, and an attachment. The header includes at least one field having a defined size. When the size of data in the field is other than the defined size, an exploit is found. Exploits may also be found in the body and\/or attachment of a message.","In another aspect of the invention, a client executing on the system determines when an update is available by polling servers associated with vendors of exploit protection software. When the client determines that an update is available, it automatically retrieves the update.","In another aspect of the invention, the system employs exploit protection software from at least two vendors to determine whether an attachment includes an exploit.","In anther aspect of the invention, components of the system are implemented in software and may be included on at least one of a firewall, router, switch, and traffic manager.","In another aspect of the invention an encapsulation includes at least one of Multipurpose Internet Mail Extensions (MIME), Base 64, and uuencode.","These and various other features as well as advantages, which characterize the present invention, will be apparent from a reading of the following detailed description and a review of the associated drawings.","In the following detailed description of exemplary embodiments of the invention, reference is made to the accompanied drawings, which form a part hereof, and which are shown by way of illustration, specific exemplary embodiments of which the invention may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention, and it is to be understood that other embodiments may be utilized, and other changes may be made, without departing from the spirit or scope of the present invention. The following detailed description is, therefore, not to be taken in a limiting sense, and the scope of the present invention is defined by the appended claims.","In the following description, first definitions of some terms that are used throughout this document are given. Then, illustrative components of an illustrative operating environment in which the invention may be practiced is disclosed. Next, an illustrative operating environment in which the invention may be practiced is disclosed. Finally, a method of detecting and removing exploits is provided.","Definitions","The definitions in this section apply to this document, unless the context clearly indicates otherwise. The phrase \u201cthis document\u201d means the specification, claims, and abstract of this application.","\u201cIncluding\u201d means including but not limited to. Thus, a list including A is not precluded from including B.","A \u201cpacket\u201d refers to an arbitrary or selectable amount of data which may be represented by a sequence of one or more bits. A packet may correspond to a data unit found in any layer of the Open Systems Interconnect (OSI) model, such as a segment, message, packet, datagram, frame, symbol stream, or stream, a combination of data units found in the OSI model, or a non OSI data unit.","\u201cClient\u201d refers to a process or set of processes that execute on one or more electronic devices, such as computing device  of . A client is not constrained to run on a workstation; it may also run on a server such as a WWW server, file server, or other server, other computing device, or be distributed over a group of such devices. Where appropriate, the term \u201cclient\u201d should be construed, in addition or in lieu of the definition above, to be a device or devices upon which one or more client processes execute, for example, a computing device, such as computing device , configured to function as a World Wide Web (WWW) server, a computing device configured as a router, gateway, workstation, etc.","Similarly, \u201cserver\u201d refers to a process or set of processes that execute on one or more electronic devices, such as computing device  configured as a WWW server. Like a client, a server is not limited to running on a computing device that is configured to predominantly provide services to other computing devices. Rather, it may also execute on what would typically be considered a client computer, such as computing device  configured as a user's workstation, or be distributed among various electronic devices, wherein each device might include one or more processes that together constitute a server application. Where appropriate, the term \u201cserver\u201d should be construed, in addition or in lieu of the definition above, to be a device or devices upon which one or more server processes execute, for example, a computing device configured to operate as a WWW server, router, gateway, workstation, etc.","An exploit is any procedure and\/or software that may be used to improperly access a computer through email. Exploits include what are commonly known as computer viruses but may also include other methods for inappropriately gaining access to a computer. For example, computer viruses are typically included in an attachment to an email message. Some exploits, however, are contained in the header or body of an email message. For example, some exploits attempt to overflow buffers allotted for portions or all of a header or body of an email message. In bytes of data contained in the overflow, these exploits often contain executable code. This executable code is arranged in such a fashion as to be executed by the host computer. The executable code may then improperly access data and\/or execute unauthorized programs on the host computer.","Referring to the drawings, like numbers indicate like parts throughout the figures and this document.","Definitions of terms are also found throughout this document. These definitions need not be introduced by using \u201cmeans\u201d or \u201crefers\u201d to language and may be introduced by example and\/or function performed. Such definitions will also apply to this document, unless the context clearly indicates otherwise.","Illustrative Operating Environment",{"@attributes":{"id":"p-0029","num":"0028"},"figref":"FIGS. 1\u20133"},{"@attributes":{"id":"p-0030","num":"0029"},"figref":"FIG. 1","b":["105","110","115","120","130","130","200","130","130","140","140","130","130"]},"Wireless networks  and  transports information and voice communications to and from devices capable of wireless communication, such as such as cell phones, smart phones, pagers, walkie talkies, radio frequency (RF) devices, infrared (IR) devices, CBs, integrated devices combining one or more of the preceding devices, and the like. Wireless networks  and  may also transport information to other devices that have interfaces to connect to wireless networks, such as a PDA, POCKET PC, wearable computer, personal computers, multiprocessor systems, microprocessor-based or programmable consumer electronics, network PCs, and other properly-equipped devices. Wireless networks  and  may include both wireless and wired components. For example, wireless network  may include a cellular tower (not shown) that is linked to a wired telephone network, such as telephone network . Typically, the cellular tower carries communication to and from cell phones, pagers, and other wireless devices, and the wired telephone network carries communication to regular phones, long-distance communication links, and the like.","Similarly phone networks  and  transport information and voice communications to and from devices capable of wired communications, such as regular phones and devices that include modems or some other interface to communicate with a phone network. A phone network, such as phone network , may also include both wireless and wired components. For example, a phone network may include microwave links, satellite links, radio links, and other wireless links to interconnect wired networks.","Gateways A\u2013D interconnect wireless networks  and  and telephone networks  and  to WAN\/LAN . A gateway, such as gateway A, transmits data between networks, such as wireless network  and WAN\/LAN . In transmitting data, the gateway may translate the data to a format appropriate for the receiving network. For example, a user using a wireless device may begin browsing the Internet by calling a certain number, tuning to a particular frequency, or selecting a browsing feature of the device. Upon receipt of information appropriately addressed or formatted, wireless network  may be configured to send data between the wireless device and gateway A. Gateway A may translate requests for web pages from the wireless device to hypertext transfer protocol (HTTP) messages which may then be sent to WAN\/LAN . Gateway A may then translate responses to such messages into a form compatible with the wireless device. Gateway A may also transform other messages sent from wireless devices into message suitable for WAN\/LAN , such as email, voice communication, contact databases, calendars, appointments, and other messages.","Before or after translating the data in either direction, the gateway may pass the data through a firewall, such as firewall A, for security, filtering, or other reasons. A firewall, such as firewall A, may include or send messages to an exploit detector. Firewalls and their operation in the context of embodiments of the invention are described in more detail in conjunction with . Briefly, a gateway may pass data through a firewall to determine whether it should forward the data to a receiving network. The firewall may pass some data, such as email messages, through an exploit detector which may detect and remove exploits from the data. If data contains an exploit, the firewall may stop the data from passing through the gateway.","In other embodiments of the invention, exploit detectors are located on components separate from gateways and\/or firewalls. For example, in some embodiments of the invention, an exploit detector may be included within a router inside a wireless network, such as wireless network , that receives messages directed to and coming from the wireless network, such as wireless network . This may negate or make redundant an exploit detector on a gateway between networks, such as gateway A. Ideally, exploit detectors are placed at ingress locations to a network so that all devices within the network are protected from exploits. Exploit detectors may, however, be located at other locations within a network, integrated with other devices such as switches, hubs, servers, routers, traffic managers, etc., or separate from such devices.","In another embodiment of the invention, an exploit detector is accessible from a device that seeks to provide exploit protection, such as a gateway. Accessible, in this context, may mean that exploit protector is physically located on the server or computing device implementing the gateway or that the exploit detector is on another server or computing device accessible from the gateway. In this embodiment, a gateway, may access the exploit detector through an application programming interface (API). Ideally, a device seeking exploit protection directs all messages through an associated exploit detector so that exploit detector is \u201clogically\u201d between the networks that the device interconnects. In some instances, a device may not send all messages through an exploit detector. For example, an exploit detector may be disabled or certain messages may be explicitly or implicitly designated to avoid the exploit detector.","Typically, WAN\/LAN  transmits information between computing devices as described in more detail in conjunction with . One example of a WAN is the Internet which connects millions of computers over a host of gateways, routers, switches, hubs, and the like. An example of a LAN is a network used to connect computers in a single office. A WAN may be used to connect multiple LANs.","It will be recognized that the distinctions between WANs\/LANs, phone networks, and wireless networks are blurring. That is, each of these types of networks may include one or more portions that would logically belong to one or more other types of networks. For example, WAN\/LAN  may include some analog or digital phone lines to transmit information between computing devices. Phone network  may include wireless components and packet-based components, such as voice over IP. Wireless network  may include wired components and\/or packet-based components. Network means a WAN\/LAN, phone network, wireless network, or any combination thereof.",{"@attributes":{"id":"p-0039","num":"0038"},"figref":["FIG. 2","FIG. 3"],"b":["220","230","210","210","300"]},"Communication links within LANs typically include twisted pair, fiber optics, or coaxial cable, while communication links between networks may utilize analog telephone lines, full or fractional dedicated digital lines including T, T, T, and T, Integrated Services Digital Networks (ISDNs), Digital Subscriber Lines (DSLs), wireless links, or other communications links known to those skilled in the art. Furthermore, computers, such as remote computer , and other related electronic devices can be remotely connected to either LANs  or WAN  via a modem and temporary telephone link. The number of WANs, LANs, and routers in  may be increased or decreased arbitrarily without departing from the spirit or scope of this invention.","As such, it will be appreciated that the Internet itself may be formed from a vast number of such interconnected networks, computers, and routers. Generally, the term \u201cInternet\u201d refers to the worldwide collection of networks, gateways, routers, and computers that use the Transmission Control Protocol\/Internet Protocol (\u201cTCP\/IP\u201d) suite of protocols to communicate with one another. At the heart of the Internet is a backbone of high-speed data communication lines between major nodes or host computers, including thousands of commercial, government, educational, and other computer systems, that route data and packets. An embodiment of the invention may be practiced over the Internet without departing from the spirit or scope of the invention.","The media used to transmit information in communication links as described above illustrates one type of computer-readable media, namely communication media. Generally, computer-readable media includes any media that can be accessed by a computing device. Computer-readable media may include computer storage media, communication media, or any combination thereof.","Communication media typically embodies computer-readable instructions, data structures, program modules, or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term \u201cmodulated data signal\u201d means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, communication media includes wired media such as twisted pair, coaxial cable, fiber optics, wave guides, and other wired media and wireless media such as acoustic, RF, infrared, and other wireless media.","The Internet has recently seen explosive growth by virtue of its ability to link computers located throughout the world. As the Internet has grown, so has the WWW. Generally, the WWW is the total set of interlinked hypertext documents residing on HTTP (hypertext transport protocol) servers around the world. Documents on the WWW, called pages or Web pages, are typically written in HTML (Hypertext Markup Language) or some other markup language, identified by URLs (Uniform Resource Locators) that specify the particular machine and pathname by which a file can be accessed, and transmitted from server to end user using HTTP. Codes, called tags, embedded in an HTML document associate particular words and images in the document with URLs so that a user can access another file, which may literally be halfway around the world, at the press of a key or the click of a mouse. These files may contain text (in a variety of fonts and styles), graphics images, movie files, media clips, and sounds as well as Java applets, ActiveX controls, or other embedded software programs that execute when the user activates them. A user visiting a Web page also may be able to download files from an FTP site and send packets to other users via email by using links on the Web page.","A computing device that may provide a WWW site is described in more detail in conjunction with . When used to provide a WWW site, such a computing device is typically referred to as a WWW server. A WWW server is a computing device connected to the Internet having storage facilities for storing hypertext documents for a WWW site and running administrative software for handling requests for the stored hypertext documents. A hypertext document normally includes a number of hyperlinks, i.e., highlighted portions of text which link the document to another hypertext document possibly stored at a WWW site elsewhere on the Internet. Each hyperlink is associated with a URL that provides the location of the linked document on a server connected to the Internet and describes the document. Thus, whenever a hypertext document is retrieved from any WWW server, the document is considered to be retrieved from the WWW. As is known to those skilled in the art, a WWW server may also include facilities for storing and transmitting application programs, such as application programs written in the JAVA programming language from Sun Microsystems, for execution on a remote computer. Likewise, a WWW server may also include facilities for executing scripts and other application programs on the WWW server itself.","A user may retrieve hypertext documents from the WWW via a WWW browser application program located on a wired or wireless device. A WWW browser, such as Netscape's NAVIGATOR\u00ae or Microsoft's INTERNET EXPLORER\u00ae, is a software application program for providing a graphical user interface to the WWW. Upon request from the user via the WWW browser, the WWW browser accesses and retrieves the desired hypertext document from the appropriate WWW server using the URL for the document and HTTP. HTTP is a higher-level protocol than TCP\/IP and is designed specifically for the requirements of the WWW. HTTP is used to carry requests from a browser to a Web server and to transport pages from Web servers back to the requesting browser or client. The WWW browser may also retrieve application programs from the WWW server, such as JAVA applets, for execution on a client computer.",{"@attributes":{"id":"p-0047","num":"0046"},"figref":"FIG. 3","b":["300","300","300","100"]},"It will be appreciated that computing device  may include many more components than those shown in . However, the components shown are sufficient to disclose an illustrative environment for practicing the present invention. As shown in , computing device  may be connected to WAN\/LAN , or other communications network, via network interface unit . Network interface unit  includes the necessary circuitry for connecting computing device  to WAN\/LAN , and is constructed for use with various communication protocols including the TCP\/IP protocol. Typically, network interface unit  is a card contained within computing device .","Computing device  also includes processing unit , video display adapter , and a mass memory, all connected via bus . The mass memory generally includes random access memory (\u201cRAM\u201d) , read-only memory (\u201cROM\u201d) , and one or more permanent mass storage devices, such as hard disk drive , a tape drive (not shown), optical drive , such as a CD-ROM\/DVD-ROM drive, and\/or a floppy disk drive (not shown). The mass memory stores operating system  for controlling the operation of computing device . It will be appreciated that this component may comprise a general purpose operating system including, for example, UNIX, LINUX\u2122, or one produced by Microsoft Corporation of Redmond, Wash. Basic input\/output system (\u201cBIOS\u201d)  is also provided for controlling the low-level operation of computing device .","The mass memory as described above illustrates another type of computer-readable media, namely computer storage media. Computer storage media may include volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information, such as computer readable instructions, data structures, program modules or other data. Examples of computer storage media include RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by a computing device.","The mass memory may also store program code and data for providing a WWW site. More specifically, the mass memory may store applications including special purpose software , and other programs . Special purpose software  may include a WWW server application program that includes computer executable instructions which, when executed by computing device , generate WWW browser displays, including performing the logic described above. Computing device  may include a JAVA virtual machine, an SMTP handler application for transmitting and receiving email, an HTTP handler application for receiving and handing HTTP requests, JAVA applets for transmission to a WWW browser executing on a client computer, and an HTTPS handler application for handling secure connections. The HTTPS handler application may be used for communication with an external security application to send and receive sensitive information, such as credit card information, in a secure fashion.","Computing device  may also comprise input\/output interface  for communicating with external devices, such as a mouse, keyboard, scanner, or other input devices not shown in . In some embodiments of the invention, computing device does not include user input\/output components. For example, computing device  may or may not be connected to a monitor. In addition, computing device  may or may not have video display adapter  or input\/output interface . For example, computing device  may implement a network appliance, such as a router, gateway, traffic management device, etc., that is connected to a network and that does not need to be directly connected to user input\/output devices. Such a device may be accessible, for example, over a network.","Computing device  may further comprise additional mass storage facilities such as optical drive  and hard disk drive . Hard disk drive  is utilized by computing device  to store, among other things, application programs, databases, and program data used by a WWW server application executing on computing device . A WWW server application may be stored as special purpose software  and\/or other programs . In addition, customer databases, product databases, image databases, and relational databases may also be stored in mass memory or in RAM .","As will be recognized from the discussion below, aspects of the invention may be embodied on routers , on computing device , on a gateway, on a firewall, on other devices, or on some combination of the above. For example, programming steps protecting against exploits may be contained in special purpose software  and\/or other programs .","Exemplary Configuration of System to Protect from Exploits",{"@attributes":{"id":"p-0055","num":"0054"},"figref":"FIG. 4","b":["405","500","415","420","425","430","435","440","445","450","450","500","415","420","425","430","435","440","445","500","450","405"]},"Network appliance , workstation , file server , mail server , mobile device , application server , and telephony device  are devices capable of connecting with network . The set of such devices may include devices that typically connect using a wired communications medium such as personal computers, multiprocessor systems, microprocessor-based or programmable consumer electronics, network PCs, and the like. The set of such devices may also include devices that typically connect using a wireless communications medium such as cell phones, smart phones, pagers, walkie talkies, radio frequency (RF) devices, infrared (IR) devices, CBs, integrated devices combining one or more of the preceding devices, and the like. Some devices may be capable of connecting to network  using a wired or wireless communication medium such as a PDA, POCKET PC, wearable computer, or other device mentioned above that is equipped to use a wired and\/or wireless communications medium. An exemplary device that may implement any of the devices above is computing device  of  configured with the appropriate hardware and\/or software.","Network appliance  may be, for example, a router, switch, or some other network device. Workstation  may be a computer used by a user to access other computers and resource reachable through network , including outside network . File server  may, for example, provide access to mass storage devices. Mail server  may store and provide access to email messages. Mobile device  may be a cell phone, PDA, portable computer, or some other device used by a user to access resources reachable through network . Application server  may store and provide access to applications, such as database applications, accounting applications, etc. Telephony device  may provide means for transmitting voice, fax, and other messages over network . Each of these devices may represent many other devices capable of connecting with network  without departing from the spirit or scope of the invention.","Outside network  and Network  are networks as previously defined in this document. Outside network may be, for example, the Internet or some other WAN\/LAN.","Firewall  provides a pathway for messages from outside network  to reach network . Firewall  may or may not provide the only pathway for such messages. Furthermore, there may be other computing devices (not shown) in the pathway between outside network  and network  without departing from the spirit or scope of the invention. Firewall may be included on a gateway, router, switch, or other computing device or simply accessible to such devices.","Firewall  may provides exploit protection for devices coupled to network  by including and\/or accessing an exploit detector (not shown) as described in more detail in conjunction with . Firewall  may be configured to send certain types of messages through an exploit detector. For example, firewall  may be configured to perform normal processing on non-email data while passing all email messages through an exploit detector.","Exemplary Exploit Detector",{"@attributes":{"id":"p-0061","num":"0060"},"figref":"FIG. 5","b":["500","505","510","545","550","510","515","520","525","530","535","540","555"]},"Firewall  may receive many types of messages sent between devices coupled to network  and outside network  of . Some messages may relate to WWW traffic or data transferred between two computers engaged in a communication while other messages may relate to email. Message listener  listens for a message and, upon receipt of an appropriate message, such as an email or file, sends the message to exploit detector  to scan for exploits. Some messages may be inappropriate for exploit detection. Such messages are passed by message listener  to other firewall components .","When processing email messages, exploit detector  provides exploit protection, in part, by scanning and verifying the fields of an email message. An email message typically includes a header (which may include certain fields), a body (which typically contains the text of an email), and one or more optional attachments. As described earlier, some exploits are crafted to overflow buffers in a header or body. Exploit detector  may examine the lengths of the fields of an email message to determine whether they are longer than they should be. Being \u201clonger than they should be\u201d may be defined by standards, mail server specifications, or selected by a firewall administrator. If an email message includes any fields that are longer than they should be, the message may be sent to quarantine component  as described in more detail below.","Exploit detector  may utilize exploit protection software from many vendors. For example, a client may execute on exploit detector  that connects to a virus protection update server. Periodically, the client may poll a server associated with each vendor and look for a flag to see if an exploit protection update is available. If there is an update available, the client may automatically retrieve the update and check it for authenticity. For example, the update may include a digital signature that incorporates a hash of the files sent. The digital signature may be verified to make sure that the files came from a trusted sender, and the hash may be used to make sure than none of the files have been modified in transit. Another process may unpack the update, stop the execution of exploit detector , install the update, and restart exploit detector .","Exploit detector  may be configured to poll for customized exploit protection updates created by, for example, an information technology team. This process may execute in a manner similar to the polling for vendor updates described above.","In addition to, or in lieu of polling, updates may be pushed to exploit detector . That is, a client may execute on exploit detector  that listens for updates from exploit protection update servers. To update the exploit protection executing on firewall , such servers may open a connection with the client and send exploit protection updates. A server sending an update may be required to authenticate itself. Furthermore, the client may check the update sent to make sure that files have not changed in transit by using a hash as described above.","The components of exploit detector  will now be explained. Upon receipt of a message to scan for exploits, exploit detector  stores the message in message queue . Content filter  processes messages from message queue  to determine encapsulation methods that have been applied to the message prior to its entry into the system. For example, a message may be encapsulated using Multipurpose Internet Mail Extensions (MIME), Base 64, and uuencode. Content filter  may also strip out attachments from email in order to examine them more closely. A message or attachment (hereinafter each referred to as a \u201cmessage\u201d) that is output from content filter  is then processed by decompression component .","Decompression component  determines whether a message is compressed. If the message is not compressed, the bits that make up the message are sent serially to scanner component . If the message is compressed, decompression component  may decompress the message one or more times before sending it to scanner component . Decompressions may be done in a nested fashion if a message has been compressed multiple times. For example, a set of files included in a message may first be zipped and then tarred using the UNIX \u201ctar\u201d command. After untarring a file, decompression component  may determine that the untarred file was previously compressed by zipping software such as WinZip. To obtain the unzipped file(s), decompression component  may then unzip the untarred file. There may be more than two levels of compression that decompression component  decompresses to obtain decompressed file(s).","Scanner component  receives decompressed messages and messages that were not compressed from decompression component . Scanner component  includes software that scans the message for exploits. Scanner component  may scan messages using exploit protection software from many vendors. For example, scanner component  may pass a message through software from virus protection software vendors such as Norton, MacAfee, Network Associates, Inc., Kaspersky Lab, Sophos, etc. In addition, scanner component  may apply proprietary or user-defined algorithms to the message to scan for exploits. For example, a user-defined algorithm testing for buffer overflows may be used to detect exploits.","Scanner component  may also include an internal mechanism that creates digital signatures for messages and content that an administrator wants to prevent from being distributed outside a network. For example, referring to , a user on one of the computing devices may create a message or try to forward a message that is confidential to outside network . Scanner component  may examine each message it receives (including outbound messages) for such digital signatures. When a digital signature is found that indicates that the message should not be forwarded, scanner component  may forward the message to quarantine component together with information as to who sent the message, the time the message was sent, and other data related to the message.","When a message is determined to have an exploit, the message is sent to quarantine component . Quarantine component  may store messages that contain exploits for further examination by, for example, a network administrator. In addition, quarantine component  may send an infected message to exploit remover  to remove an exploit.","When scanner component  does not find an exploit in a message, the message may be forwarded to output component . Output component  forwards a message towards its recipient. Output component  may be hardware and\/or software operative to forward messages over a network. For example, output component  may include a network interface such as network interface unit .","Exploit remover  may remove exploits from a message. Some exploits may be removed from a message after detection yielding a cleaned message. The cleaned message, now free from exploits, may then be forwarded to its intended recipient. After cleaning a message, exploit remover may forward the message to output component . If exploit remover cannot remove an exploit, it may send the message back to quarantine component .","A firewall may perform other tasks besides passing messages to an exploit detector. For example, a firewall may block messages to or from certain addresses. Such other tasks may be accomplished by other firewall components . When other firewall components  determines that a message should be passed through firewall , other firewall components  forwards the message to output component .","Message transport agent  is a computing device that receives email. Email receiving devices include mail servers. Examples of mail servers include Microsoft Exchange, Q Mail, Lotus Notes, etc. Referring to , firewall  may forward a message to mail server .","Illustrative Method of Scanning for Exploits",{"@attributes":{"id":"p-0076","num":"0075"},"figref":["FIG. 6","FIG. 5"],"b":["605","505"]},"At block , the message is received by a listener. The listener determines whether the message should be scanned for exploits. If the message is to be scanned for exploits, processing continues at block ; otherwise other processing (not shown) may be performed on the message. For example, referring to , a message including an email message is received by message listener . Message listener  determines that the message should be scanned for exploits and sends the message to message queue .","At block  the message is unencapsulated, if necessary. A message may be encapsulated in many ways, including MIME, Base , and uuencode. To retrieve the message, the message may be unencapsulated. For example, referring to , the email message may include an attachment that is encoded using MIME. Content filter  may unencapsulate the attachment. After block , processing continues at block .","At block , the message and\/or its attachment, if any, may be decompressed one or more times. For example, referring to , an email message may include an attachment that has been compressed by WinZip. Decompression component  may determine the compression algorithm used and then decompress the attachment. After block , processing continues at block .","At block , a message is scanned for exploits. The message may be scanned using conventional exploit detection software and\/or proprietary or user-defined exploit detection software. For example, referring to , the header, body, and attachment fields of an email message may be scanned to determine if they are less than or equal to the maximum length of such fields. In addition, the attachments of an email, if any, may be passed through virus detection software from various vendors to determine if they include any exploits. After block , processing continues at block .","At block , a determination is made as to whether the scan detected any exploits. If exploits are found, processing continues at block ; otherwise processing continues at block .","At block , a message is quarantined and optionally one or more exploits are removed. Quarantined may mean that the message is stored together with other information regarding the message, such as who sent the message, to whom it was addressed, and when the message arrived. This may be done for further examination or analysis. Alternatively, quarantined may mean that the message is discarded. When exploits are removed from a message processing, may continue at block ; otherwise, processing finishes for a particular message and another message may be scanned for exploits. For example, referring to , quarantine component receives an email including exploits and stores the email for further examination.","At block , a message is forwarded towards its recipient. The message may be an original message received by an exploit detector or may be a message from which exploits have been removed. For example, referring to , output component  forwards a message to message transport agent .","At block , processing ends. At this point a message has been scanned for exploits. If any part of the message has been encapsulated, the message has been unencapsulated. If the message was compressed one or more time, the message has been decompressed one or more time. A scan for exploits has occurred on the message. If exploits were found they have been quarantined and\/or optionally been removed from the message. The message or cleaned message has then been forwarded towards the recipient. The process outlined above may be repeated for each message received.","The various embodiments of the invention may be implemented as a sequence of computer implemented steps or program modules running on a computing system and\/or as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance requirements of the computing system implementing the invention. In light of this disclosure, it will be recognized by one skilled in the art that the functions and operation of the various embodiments disclosed may be implemented in software, in firmware, in special purpose digital logic, or any combination thereof without deviating from the spirit or scope of the present invention.","The above specification, examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention, the invention resides in the claims hereinafter appended."],"BRFSUM":[{},{}],"brief-description-of-drawings":[{},{}],"description-of-drawings":{"heading":"BRIEF DESCRIPTION OF THE DRAWINGS","p":[{"@attributes":{"id":"p-0015","num":"0014"},"figref":"FIGS. 1\u20133"},{"@attributes":{"id":"p-0016","num":"0015"},"figref":"FIG. 4"},{"@attributes":{"id":"p-0017","num":"0016"},"figref":"FIG. 5"},{"@attributes":{"id":"p-0018","num":"0017"},"figref":"FIG. 6"}]},"DETDESC":[{},{}]}
